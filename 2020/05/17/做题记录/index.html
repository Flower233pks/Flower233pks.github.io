<!DOCTYPE html><html class="theme-next gemini use-motion" lang=""><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.2.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/icon-32.png?v=7.2.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/icon-32.png?v=7.2.0"><link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222"><link rel="stylesheet" href="/css/main.css?v=7.2.0"><link rel="stylesheet" href="//fonts.lug.ustc.edu.cn/css?family=Verdana:300,300italic,400,400italic,700,700italic|Verdana:300,300italic,400,400italic,700,700italic|Verdana:300,300italic,400,400italic,700,700italic|Verdana:300,300italic,400,400italic,700,700italic|Courier New:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0"><link rel="stylesheet" href="/lib/fancybox/source/jquery.fancybox.css"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.2.0",sidebar:{position:"left","Pisces | Gemini":270,width:270,display:"post",offset:12,onmobile:!1},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},copycode:{enable:!0,show_result:!0,style:"mac"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},translation:{copy_button:"Copy",copy_success:"Copied",copy_failure:"Copy failed"}}</script><meta name="description" content="å¤§æ¦‚æ˜¯å’Œã€Œç®€å•é¢˜é€‰åš ã€æ†ç»‘çš„ã€‚ é‚£ä¸ªé‡Œé¢ç”¨æ¥è®°å½•è‡ªå·±ç§’æ‰è´¨é‡è¿˜å¯ä»¥çš„çš„é¢˜ç›®ï¼Œè¿™ä¸ªç”¨æ¥è®°å½•è‡ªå·±æƒ³äº†&#x2F;å†™äº†å¥½ä¸€ä¼šå„¿çš„é¢˜ç›®ã€‚ å—¯ï¼ŒåŠ æ²¹å§ã€‚åŠæ—¶å½“å‹‰åŠ±ï¼Œå²æœˆä¸å¾…äººã€‚"><meta property="og:type" content="article"><meta property="og:title" content="ã€æ³›åšã€‘è¿‘æœŸåšé¢˜è®°å½•"><meta property="og:url" content="https://www.orchidany.cn/2020/05/17/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/index.html"><meta property="og:site_name" content="ğ“ğ“»ğ“¬ğ“±ğ“²ğ“­ğ“ªğ“·ğ”‚&#39;ğ”€ ğ“«ğ“µğ“¸ğ“°"><meta property="og:description" content="å¤§æ¦‚æ˜¯å’Œã€Œç®€å•é¢˜é€‰åš ã€æ†ç»‘çš„ã€‚ é‚£ä¸ªé‡Œé¢ç”¨æ¥è®°å½•è‡ªå·±ç§’æ‰è´¨é‡è¿˜å¯ä»¥çš„çš„é¢˜ç›®ï¼Œè¿™ä¸ªç”¨æ¥è®°å½•è‡ªå·±æƒ³äº†&#x2F;å†™äº†å¥½ä¸€ä¼šå„¿çš„é¢˜ç›®ã€‚ å—¯ï¼ŒåŠ æ²¹å§ã€‚åŠæ—¶å½“å‹‰åŠ±ï¼Œå²æœˆä¸å¾…äººã€‚"><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="article:published_time" content="2020-05-17T06:53:10.000Z"><meta property="article:modified_time" content="2020-05-28T13:16:36.322Z"><meta property="article:author" content="Orchidany"><meta property="article:tag" content="åŠ¨æ€è§„åˆ’&#x2F;æœ‰æŠ€å·§çš„DP"><meta property="article:tag" content="åŠ¨æ€è§„åˆ’&#x2F;è‡ªåŠ¨æœºä¸ŠDP"><meta property="article:tag" content="æ€ç»´é¢˜&#x2F;æ‰¾æ€§è´¨"><meta property="article:tag" content="æ•°æ®ç»“æ„&#x2F;æ ‘çŠ¶æ•°ç»„"><meta property="article:tag" content="åŠ¨æ€è§„åˆ’&#x2F;æ™®é€šDP"><meta property="article:tag" content="æ€ç»´é¢˜&#x2F;å®¹æ–¥"><meta property="article:tag" content="è´ªå¿ƒ"><meta property="article:tag" content="æ ‘ä¸ŠæŠ€å·§&#x2F;dsu on tree"><meta property="article:tag" content="åŠ¨æ€è§„åˆ’&#x2F;æ ‘å½¢DP"><meta property="article:tag" content="æ•°å­¦&#x2F;çº¿æ€§ä»£æ•°&#x2F;çŸ©é˜µ"><meta property="article:tag" content="æŠ€å·§&#x2F;æŒ‰ä½æ“ä½œ"><meta property="article:tag" content="å­—ç¬¦ä¸²&#x2F;å­åºåˆ—è‡ªåŠ¨æœº"><meta property="article:tag" content="å­—ç¬¦ä¸²&#x2F;Z-Algorithm"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><link rel="alternate" href="/atom.xml" title="ğ“ğ“»ğ“¬ğ“±ğ“²ğ“­ğ“ªğ“·ğ”‚'ğ”€ ğ“«ğ“µğ“¸ğ“°" type="application/atom+xml"><link rel="canonical" href="https://www.orchidany.cn/2020/05/17/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>ã€æ³›åšã€‘è¿‘æœŸåšé¢˜è®°å½• | ğ“ğ“»ğ“¬ğ“±ğ“²ğ“­ğ“ªğ“·ğ”‚'ğ”€ ğ“«ğ“µğ“¸ğ“°</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body itemscope itemtype="http://schema.org/WebPage" lang="default"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">ğ“ğ“»ğ“¬ğ“±ğ“²ğ“­ğ“ªğ“·ğ”‚'ğ”€ ğ“«ğ“µğ“¸ğ“°</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">A Soul Tune against Fate Should Be Played, now.</p></div><div class="site-nav-toggle"> <button aria-label="Toggle navigation bar"><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-navigation"><a href="/navigation/" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>Navigation</a></li><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>Archives</a></li><li class="menu-item menu-item-friends"><a href="/Friends/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>Friends</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>Search</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.orchidany.cn/2020/05/17/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Orchidany"><meta itemprop="description" content="For code, science, tech. and more"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="ğ“ğ“»ğ“¬ğ“±ğ“²ğ“­ğ“ªğ“·ğ”‚'ğ”€ ğ“«ğ“µğ“¸ğ“°"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">ã€æ³›åšã€‘è¿‘æœŸåšé¢˜è®°å½•</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-05-17 14:53:10" itemprop="dateCreated datePublished" datetime="2020-05-17T14:53:10+08:00">2020-05-17</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2020-05-28 21:16:36" itemprop="dateModified" datetime="2020-05-28T21:16:36+08:00">2020-05-28</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E9%A2%98%E8%A7%A3/" itemprop="url" rel="index"><span itemprop="name">é¢˜è§£</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> Views:<span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span></span><br></div></header><div class="post-body" itemprop="articleBody"><p>å¤§æ¦‚æ˜¯å’Œã€Œç®€å•é¢˜é€‰åš ã€æ†ç»‘çš„ã€‚</p><p>é‚£ä¸ªé‡Œé¢ç”¨æ¥è®°å½•è‡ªå·±ç§’æ‰è´¨é‡è¿˜å¯ä»¥çš„çš„é¢˜ç›®ï¼Œè¿™ä¸ªç”¨æ¥è®°å½•è‡ªå·±æƒ³äº†/å†™äº†å¥½ä¸€ä¼šå„¿çš„é¢˜ç›®ã€‚</p><p>å—¯ï¼ŒåŠ æ²¹å§ã€‚åŠæ—¶å½“å‹‰åŠ±ï¼Œå²æœˆä¸å¾…äººã€‚</p><a id="more"></a><h1 id="ç¾å›¢æ¯-2020-æµ‹è¯•èµ›-A-å­åºåˆ—"><a href="#ç¾å›¢æ¯-2020-æµ‹è¯•èµ›-A-å­åºåˆ—" class="headerlink" title="[ç¾å›¢æ¯ 2020 æµ‹è¯•èµ› A] å­åºåˆ—"></a>[ç¾å›¢æ¯ 2020 æµ‹è¯•èµ› A] å­åºåˆ—</h1><blockquote><p>ç»™å®š $n$ ä¸ªå­—ç¬¦ã€‚$s_0$ ä¸ºç©ºï¼Œæ¯æ¬¡ä¼šè®© $s_{i}=c s_{i-1}[1] c s_{i-1}[2] \ldots s_{i-1}[m] c$ ï¼Œå…¶ä¸­ $m=|s_{i-1}|,c$ ä¸ºå½“å‰å­—ç¬¦ã€‚</p><p>æ±‚ $n$ æ¬¡æ“ä½œåæœ‰å¤šå°‘ä¸ªæœ¬è´¨ä¸åŒçš„å­åºåˆ—ã€‚$n\leq 2000$ ã€‚</p></blockquote><p>è¯´å®è¯â€¦æˆ‘è¿™å·²ç»ä¸æ˜¯ç¬¬ä¸€æ¬¡è¢«å­åºåˆ—è‡ªåŠ¨æœºç»™å¹²ç¿»äº†/kk</p><p>è€ƒè™‘ Small çš„æš´åŠ›ã€‚å¤§æ¦‚å°±æ˜¯ $f:[f_1,f_2\cdots f_{26}]$ è¡¨ç¤ºä¸€ä¸ªè¡Œå‘é‡ç»„ï¼Œè¡¨ç¤ºä»¥ $i$ ç»“å°¾æœ‰å¤šå°‘ä¸ªæœ¬è´¨ä¸åŒçš„å­—ç¬¦ä¸²ã€‚å¦‚æœè®¾å½“å‰å­—ç¬¦ä¸º $c$ï¼Œé‚£ä¹ˆè€ƒè™‘è½¬ç§»æœ‰</p><script type="math/tex;mode=display">
f_{k+1,c}=\sum f_{k,i}</script><p>å…¶ä½™çš„</p><script type="math/tex;mode=display">
f_{k+1,j}=f_{k,j}</script><p>ä¸éš¾çŸ¥é“è¿™æ ·åšæ˜¯å¯¹çš„ï¼Œå³è€ƒè™‘åœ¨æœ€åæ’å…¥ä¸€ä¸ªæ–°å­—ç¬¦äº†æ²¡æœ‰ã€‚è¿™å…¶å®å°±æ˜¯ç”¨å­åºåˆ—è‡ªåŠ¨æœºåšè¿™ä¸ª dp çš„æœ¬è´¨ã€‚è€ƒè™‘ç”¨å­åºåˆ—è‡ªåŠ¨æœºåšçš„æ—¶å€™å¯ä»¥è¿™ä¹ˆè½¬ç§»</p><script type="math/tex;mode=display">
g_{i}=2\cdot g_{i-1}-g_{nxt(c)}</script><p>è¿™æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå®¹æ–¥ï¼Œè·Ÿå‘é‡ä¹˜æ³•æœ¬è´¨ç›¸åŒã€‚</p><p>è€ƒè™‘ Large æ€ä¹ˆåšã€‚ä¸éš¾å‘ç°è¿™ä¸ªä¸²æœ¬èº«å…·æœ‰ç‰¹æ®Šæ€§è´¨ï¼Œå³é€’å½’åœ°å°†ä¸­é—´å­—ç¬¦å–å‡ºåï¼Œä¸¤è¾¹ä¾ç„¶ä¸ºå›æ–‡ä¸²ã€‚äºæ˜¯å‘ç°é•¿åº¦ä¸º $m$ çš„ä¸²åªä¼šæœ‰ $\log_2m$ ä¸ªæœ¬è´¨ä¸åŒçš„çŠ¶æ€ã€‚äºæ˜¯å°±å¯ä»¥ç”¨çŸ©é˜µçš„æ–¹å¼å€’åºè½¬ç§»ã€‚å¤æ‚åº¦ $O(n\times |\Sigma|^3)$ ã€‚æ³¨æ„éœ€è¦å¤šå¼€ä¸€ä¸ªçŠ¶æ€è¡¨ç¤º <code>NULL</code>ï¼Œé‚£ä¹ˆæœ€åç­”æ¡ˆä¸€å®šæ˜¯ä¿å­˜åœ¨è¿™ä¸ªç©ºçŠ¶æ€é‡Œçš„ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mat</span>&#123;</span>&#125;S[<span class="number">27</span>], ans ;</span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> f ;</span><br><span class="line"><span class="keyword">char</span> s[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)&#123;</span><br><span class="line">        S[i].reset() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">27</span> ; ++ j)</span><br><span class="line">            S[i].ma[j][i] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; (s + <span class="number">1</span>) ;</span><br><span class="line">    ans = S[s[n] - <span class="string">'a'</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span> ; i ; -- i)</span><br><span class="line">        ans = ans * S[s[i] - <span class="string">'a'</span>] * ans ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i) add(f, ans.ma[<span class="number">26</span>][i]) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><p>æŒºå¥½ä¸€é¢˜<del>å¯æƒœå°±æ˜¯ä¸ä¼š</del> ã€‚</p><h1 id="CF-Edu-Round-87-C1-C2-Polygon-Embedding"><a href="#CF-Edu-Round-87-C1-C2-Polygon-Embedding" class="headerlink" title="[CF Edu Round#87 C1/C2] Polygon Embedding"></a>[CF Edu Round#87 C1/C2] Polygon Embedding</h1><blockquote><p>æ±‚ $n$ ä¸ªç‚¹è¾¹é•¿ä¸º $1$ çš„æ­£å¤šè¾¹å½¢å¯ä»¥æ”¾è¿›å¤šå°çš„æ­£æ–¹å½¢é‡Œï¼Œä½¿å¾—æ”¾è¿›å»ä¹‹åä»»æ„ä¸€ä¸ªåœ¨å¤šè¾¹å½¢è¾¹ä¸Šçš„ç‚¹åœ¨æ­£æ–¹å½¢çš„å†…éƒ¨æˆ–è€…è¾¹ä¸Šã€‚</p><p>$n=4k/4k+2$ã€‚</p></blockquote><p>å‘ç°å°±æ˜¯é«˜ä¸­å‡ ä½•é¢˜ã€‚</p><p>è®¾æ‰€æ±‚ä¸ºæ­£ $n$ è¾¹å½¢ã€‚é‚£ä¹ˆä¸¤ä¸ª <code>version</code> å°±æ˜¯ $n=4k$ å’Œ $n=4k+2$ çš„ caseã€‚</p><p>1ã€$n=4k$ ã€‚</p><p>è€ƒè™‘æœ€åä¸€å®šæ˜¯è¾¹è´´è¾¹ã€‚å…·ä½“è¯æ˜ä»ç•¥ï¼Œé¦–å…ˆå¾ˆæ˜¾ç„¶ï¼Œå…¶æ¬¡æ ¹æ®æ ·ä¾‹çŒœä¸èƒ½çŒœå‡ºæ¥å—?</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="1.png" alt=""></p><p>è€ƒè™‘å¦‚å›¾çš„ $12$ å˜å½¢ã€‚å¯¹äºè¾¹é•¿è®©æˆ‘ä»¬æ‹†å¼€è®¡ç®—ï¼Œå³åˆ†åˆ«è®¡ç®— $|MQ|+|QB|+|BC|+|CR|+|RN|$ ã€‚é‚£ä¹ˆä¸éš¾çŸ¥é“è¯¸å¦‚ $|QM|=|LA|\cdot \sin(\angle ALM)$ï¼Œ$|QB|=|AB|\cdot \sin(\angle BAQ)$ ä¹‹ç±»çš„è¿™ç§ç»“è®ºã€‚é‚£ä¹ˆå‘ç°æœ€åç­”æ¡ˆå°±æ˜¯</p><script type="math/tex;mode=display">
\sum_{j=1}^{2\cdot k-1} \sin{\frac{j\cdot \pi}{2\cdot k}}</script><p>åˆ°æ­¤å°±å¯ä»¥ç›´æ¥åœäº†ã€‚<del>ä½†æ˜¯èº«ä¸ºé«˜ä¸­ç”Ÿå°±è¿™ä¹ˆåœäº†ä½ å¯¹å¾—èµ·ä½ çš„æ•°å­¦è€å¸ˆå—</del> äºæ˜¯å¯ä»¥ç»§ç»­åŒ–ã€‚å…·ä½“çš„ï¼Œè®¾</p><script type="math/tex;mode=display">
s=\sum_{j=1}^{2\cdot k-1} \sin{\frac{j\cdot \pi}{2\cdot k}}</script><p>ç„¶åè€ƒè™‘æ±‚ $\sin{\dfrac{\pi}{2\cdot k}}\cdot s$ ã€‚åŒæ—¶æ ¹æ®<strong>ç§¯åŒ–å’Œå·®</strong>å¯ä»¥å¾—åˆ°</p><script type="math/tex;mode=display">
\sin{\dfrac{\pi}{2\cdot k}}\cdot \sin{\dfrac{j\cdot \pi}{2\cdot k}}=\frac{1}{2}\left(\cos{\dfrac{(j-1)\cdot \pi}{2\cdot k}}-\cos{\dfrac{(j+1)\cdot \pi}{2\cdot k}}\right)</script><p>é‚£ä¹ˆä¹Ÿå°±æ˜¯ $\sin{\dfrac{\pi}{2\cdot k}}\cdot s$ ä¸­æœ‰è®¸å¤šé¡¹éƒ½å¯ä»¥æ¶ˆæ‰ï¼Œæœ€åå¾—åˆ°</p><script type="math/tex;mode=display">
\sin{\dfrac{\pi}{2\cdot k}}\cdot s=1+\cos\frac{\pi}{2\cdot k}</script><p>æ ¹æ®äºŒå€è§’å…¬å¼å¯ä»¥æ•´ç†å¾—åˆ°</p><script type="math/tex;mode=display">
s=\frac{\cos\frac{\pi}{4\cdot k} }{\sin\frac{\pi}{4\cdot k}}=\cot \frac{\pi}{4\cdot k}</script><p>2ã€$n=4k+2$ã€‚</p><p>è¿™ä¸ªéœ€è¦ä¸€å®šçš„çŒœæµ‹â€¦é¦–å…ˆè§‚å¯Ÿæ ·ä¾‹ç»™å‡ºçš„ $1.931851653$ è¿™ä¸ªæ•°ï¼Œé€šè¿‡ç™¾åº¦æœç´¢/è‡ªå·±çŒœæµ‹/è®¡ç®—å™¨çæŒ‰éƒ½å¯ä»¥å¾—åˆ°ï¼Œ$1.931851653^2=\sqrt{2+\sqrt 3}=\sqrt{\frac{\sqrt 2+\sqrt 6}{2}}=\sqrt {\cot \frac{\pi}{12}}$ ã€‚é‚£ä¹ˆæ ¹æ®è¿™ä¸ªä¸éš¾çŸ¥é“å…­è¾¹å½¢çš„æ—¶å€™æ˜¯æ€ä¹ˆæ”¾çš„ï¼š</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="2.png" alt=""></p><p>äºæ˜¯ä¸éš¾çŒœå‡ºï¼Œå¯¹äºæ­£ $4k+2$ å˜å½¢ï¼Œä¸€å®šæ˜¯å››æ¡è¾¹ä¸Šå„æœ‰ä¸€é¡¶ç‚¹ï¼Œä¸”å¯¹è§’çº¿ä¸Šæœ‰å¯¹ç§°çš„ä¸¤ä¸ªé¡¶ç‚¹ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥æœ€ä¼˜ã€‚</p><p>è€ƒè™‘æ€ä¹ˆè®¡ç®—è¾¹é•¿ï¼Œè€ƒè™‘ä¸æœ€åº•ä¸‹è¿™æ¡æ­£æ–¹å½¢è¾¹ç›¸åˆ‡çš„ç‚¹ $Z$ ã€‚</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="3.png" alt=""></p><p>ä¸éš¾çŸ¥é“å®ƒä¸€å®šæ˜¯ç¦»å¤§å°ä¸º $\dfrac{\pi}{4}$ çš„è§’ $\angle UE_1F_1$ æœ€è¿‘çš„é‚£ä¸ªç‚¹ã€‚å› ä¸º $Z$ å’Œ $W$ ä¹‹é—´è¿˜æœ‰å¥½å¤šç‚¹ï¼Œäºæ˜¯è®¾ $\angle UE_1Z$ ä¸º $\frac{m\pi}{2\cdot k+1}$ï¼Œé‚£ä¹ˆ</p><script type="math/tex;mode=display">
\angle/ ZE_1F_1=|\frac{m\pi}{2\cdot k+1}-\frac{\pi}{4}|</script><p>å¯ä»¥å¾—åˆ°æœ€å°ä¸º $\dfrac{\pi}{8\cdot k+4}$ ã€‚äºæ˜¯è€ƒè™‘è‡´åŠ›äºç”¨è¿™è§’æ¥è§£å‡º $|E_1F_1|$ã€‚</p><p>è€ƒè™‘è¿™ä¸ªæ­£å¤šè¾¹å½¢çš„å¤–æ¥åœ†ï¼Œè®¾å…¶åŠå¾„ä¸º $r$ã€‚é‚£ä¹ˆæ ¹æ®æ­£å¼¦å®šç†å¯ä»¥å¾—åˆ°</p><script type="math/tex;mode=display">
1=2\cdot r\cdot \sin\frac{\pi}{4\cdot k+2}</script><p>åŒæ—¶è®¾æ­£æ–¹å½¢è¾¹é•¿ä¸º $a$ï¼Œæ ¹æ®å°ç›´è§’ä¸‰è§’å½¢ $\triangle E_1F_1Z$ å¯ä»¥å¾—åˆ°</p><script type="math/tex;mode=display">
\frac{a}{2}=r\cdot \cos \dfrac{\pi}{8\cdot k+4}</script><p>å¯ä»¥è§£å¾—æœ€å</p><script type="math/tex;mode=display">
a=\frac{1}{2\sin\frac{\pi}{4\cdot k+2}}</script><p>å¤æ‚åº¦å‡ä¸º $O(1)$ ã€‚</p><h1 id="CF-Edu-Round-87-F-Summoning-Minions"><a href="#CF-Edu-Round-87-F-Summoning-Minions" class="headerlink" title="[CF Edu Round#87 F] Summoning Minions"></a>[CF Edu Round#87 F] Summoning Minions</h1><blockquote><p>ä½ æœ‰ $n$ å¼ å¡ç‰Œï¼Œä½ çš„æ¡Œé¢ä¸Šæœ€å¤šåªå¯å®¹çº³ $k$ å¼ å¡ç‰Œï¼Œæ¯ä¸€å¼ å¡ç‰Œæ”¾åˆ°æ¡Œé¢ä¸Šæ—¶æœ‰ä¸€ä¸ªåˆå§‹çš„ç­‰çº§ $a_i$ï¼Œå¹¶ä¸”åœ¨æ”¾åˆ°æ¡Œé¢ä¸Šçš„æ—¶åˆ»ä¼šç»™æ‰€æœ‰å½“å‰æ¡Œé¢ä¸Šé™¤è¯¥å¡ç‰Œä¹‹å¤–æ‰€æœ‰çš„å¡ç‰Œç­‰çº§å…¨éƒ¨åŠ ä¸Š $b_i$ï¼Œä¸­é€”ä½ å¯ä»¥é”€æ¯æ¡Œä¸Šçš„ä¸€äº›å¡ç‰Œï¼Œæ±‚ä»»æ„ä¸€ç§æ–¹æ¡ˆä½¿å¾—æœ€åæ¡Œä¸Šæ‰€æœ‰å¡ç‰Œçš„ç­‰çº§ä¹‹å’Œæœ€å¤§ã€‚</p><p>$1\leq n,k,T\leq 75$ã€‚</p></blockquote><p>è€ƒè™‘ä¸€ä¸ªæ¯”è¾ƒæœ‰æ•ˆçš„è´ªå¿ƒã€‚è€ƒè™‘è¿™ä¹ˆä¸€ä¸ªæ¯”è¾ƒè‡ªç„¶çš„æƒ³æ³•ï¼Œå°±æ˜¯å…ˆæ‰¾å‡ºå‰ $k-1$ ä¸ªæ¥ï¼Œç„¶å $n-k$ ä¸ªåŠ ä¸€ä¸ªåˆ ä¸€ä¸ªï¼Œæœ€åå†æŠŠ $1$ ä¸ªåŠ è¿›æ¥ã€‚ä¸éš¾çŸ¥é“è¿™æ ·ä¸€å®šå¯ä»¥åšå‡ºæœ€ä¼˜çš„å†³ç­–ã€‚</p><p>é‚£ä¹ˆè€ƒè™‘æ€ä¹ˆæè¿™ä¸‰éƒ¨åˆ†ã€‚</p><h2 id="Sol-1"><a href="#Sol-1" class="headerlink" title="Sol 1"></a>Sol 1</h2><p>ç¬¬ä¸€éƒ¨åˆ†å¯ä»¥èƒŒåŒ…ï¼Œ$f_{i,j}$ è¡¨ç¤ºå‰ $i$ ä¸ªéšä»æ‰¾å‡ºäº† $j$ ä¸ªæ”¾è¿›ç¬¬ä¸€ä¸ªéƒ¨åˆ†çš„æœ€å¤§ä»·å€¼ã€‚æ³¨æ„è¿™ä¸ªåœ°æ–¹æœ‰ä¸€ä¸ªä»£ä»·æå‰è®¡ç®—çš„æ€æƒ³ã€‚å°±æ˜¯è¯´è€ƒè™‘å¦‚æœæŠŠéšä» $z$ åœ¨å‰ $k-1$ ä¸ªé‡Œçš„ç¬¬ $j$ ä½å¬å”¤å‡ºæ¥ï¼Œé‚£ä¹ˆæ”¾åˆ°åé¢åº”è¯¥æ˜¯äº§ç”Ÿ $(k-1)\cdot b_z$ çš„è´¡çŒ®ï¼Œç°åœ¨å°±åªæœ‰ $(j-1)\cdot b_z$ çš„è´¡çŒ®ï¼Œäºæ˜¯æœ‰</p><script type="math/tex;mode=display">
f_{i,j}=\max\left\{f_{i-1,j-1}-(k-j)\cdot b_i+a_i,f_{i-1,j}\right\}</script><p>ç„¶åä¸€ä¸ªå°ç»†èŠ‚å°±æ˜¯æ˜¾ç„¶å¿…é¡»è¦æŒ‰ç…§ $a_i$ é™åºä¸” $b_i$ å‡åºæ¥è¿›è¡Œæ’åºï¼ŒåŒæ—¶ç”±äºæ˜¯å¯¹ $a_i$ æ¥ $dp$ï¼Œæ‰€ä»¥åº”è¯¥è®© $b_i$ ä¸ºç¬¬ä¸€å…³é”®å­—ã€‚</p><p>ç¬¬äºŒã€ä¸‰éƒ¨åˆ†è€ƒè™‘åˆèµ·æ¥åšã€‚å³è€ƒè™‘æšä¸¾æœ€åä¸€ä¸ªéšä»ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„å…ƒç´ å°±ä¸€å®šæ˜¯æŒ‰ç…§ $b_z$ å‡åºæ’åºï¼Œå› ä¸ºä»–ä»¬åŠ å…¥å°±ä¼šè¢«ç«‹å³åˆ æ‰ã€‚ä½†è¿™æ ·ä¼šå‘ç° <code>WA ON 2</code>ã€‚å†·é™ä¸€ä¸‹å°±ä¼šå‘ç°æœ€åä¸€ä¸ªå…ƒç´ ç”±äºä¹Ÿè¦è®¡ç®—å…¶ $a_i$ ï¼Œæ‰€ä»¥åº”è¯¥å’Œå‰é¢çš„ $k-1$ ä¸ªç­‰ä»·ï¼Œæ¢è¨€ä¹‹æœ€ååœ¨å‰©ä¸‹çš„å…ƒç´ é‡Œè´ªå‡ºæœ€åä¸€ä¸ªä½ç½®æ”¾çš„éšä»æ˜¯ä¸å¯¹çš„ã€‚è§‚å¯Ÿæ•°æ®èŒƒå›´å¾ˆå°ï¼Œäºæ˜¯å¯ä»¥æšä¸¾æœ€åä¸€ä¸ªä½ç½®æ”¾å“ªä¸ªéšä»ï¼Œå¯¹äºä¸åŒçš„æœ€åä¸€ä¸ªä½ç½®åˆ†åˆ«åšå‰ä¸¤éƒ¨åˆ†ã€‚ä¸éš¾çŸ¥é“è¿™æ ·æ˜¯å¯¹çš„ã€‚</p><p>è¿™æ ·æœ€åå¤æ‚åº¦ $O(T\cdot n^2k)$ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚</p><p>çæ‰¯1ï¼šè¿™ä¹ˆçœ‹æ¥è¿™ä¸ªå¤æ‚åº¦è¿˜æ˜¯å¾ˆåˆç†çš„ï¼Ÿ$75^4$ å¤§æ¦‚åœ¨ $3e7$ å·¦å³ã€‚</p><p>çæ‰¯2ï¼šå®é™…ä¸Šå†™çš„æ—¶å€™å¹¶æ²¡æœ‰ç»†æƒ³ç¬¬ä¸€éƒ¨åˆ†åˆ°åº•è¯¥æ€ä¹ˆæ’åºï¼Œé‚£åæ­£å°±æ˜¯è¦ä¹ˆ $a_i$ åšç¬¬ä¸€å…³é”®å­—è¦ä¹ˆ $b_i$ åšç¬¬ä¸€å…³é”®å­—ã€‚çœ‹ç€å½“æ—¶ä¼¼ä¹æ²¡å¤šå°‘äººè¿‡ F å°±é€‰æ‹© $2!$ æšä¸¾äº†ä¸€ä¸‹è¿™ä¸¤ç§æ’æ³•ï¼ˆ</p><p>çæ‰¯3ï¼šä¸ºä»€ä¹ˆè¿™åœºæ¯”è¾ƒæ­£å¸¸çš„é¢˜ (E ä»¥åŠ E ä¹‹å) éƒ½è¿™ä¹ˆæ— èŠä½†æ˜¯ä»£ç è¿™ä¹ˆéº»çƒ¦ï¼Ÿåæ­£æˆ‘å†™çš„æŒºéº»çƒ¦çš„ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> T ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">minion</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> a, b, id ;</span><br><span class="line">&#125;base[N], tmp[N] ;</span><br><span class="line"><span class="keyword">int</span> n, k ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> lst ;</span><br><span class="line"><span class="keyword">int</span> ud[N] ;</span><br><span class="line"><span class="keyword">int</span> fin[N] ;</span><br><span class="line"><span class="keyword">int</span> quq[N] ;</span><br><span class="line"><span class="keyword">int</span> qaq[N] ;</span><br><span class="line"><span class="keyword">int</span> qwq[N] ;</span><br><span class="line"><span class="keyword">int</span> f[N][N] ;</span><br><span class="line"><span class="keyword">int</span> pre[N][N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(minion x, minion y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.b == y.b ? x.a &gt; y.a : x.b &lt; y.b ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cop</span><span class="params">(minion x, minion y)</span></span>&#123; <span class="keyword">return</span> x.b &lt; y.b ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k ; ans = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            base[i].a = qr(), base[i].id = i, base[i].b = qr() ;</span><br><span class="line">        sort(base + <span class="number">1</span>, base + n + <span class="number">1</span>, comp) ;</span><br><span class="line">        fill(fin, fin + n + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> z = <span class="number">1</span> ; z &lt;= n ; ++ z)&#123;</span><br><span class="line">            <span class="built_in">memset</span>(f, <span class="number">-63</span>, <span class="keyword">sizeof</span>(f)) ;</span><br><span class="line">            fill(ud, ud + n + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">            f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span> ; cnt = <span class="number">0</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= k - <span class="number">1</span> ; ++ j)&#123;</span><br><span class="line">                    <span class="keyword">int</span> tmp = base[i].b * (j - k)  ;</span><br><span class="line">                    <span class="keyword">if</span> (!j || i == z)</span><br><span class="line">                        f[i][j] = f[i - <span class="number">1</span>][j], pre[i][j] = <span class="number">0</span> ;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (f[i - <span class="number">1</span>][j] &gt; f[i - <span class="number">1</span>][j - <span class="number">1</span>] + base[i].a + tmp)</span><br><span class="line">                            f[i][j] = f[i - <span class="number">1</span>][j], pre[i][j] = <span class="number">0</span> ;</span><br><span class="line">                        <span class="keyword">else</span> f[i][j] = f[i - <span class="number">1</span>][j - <span class="number">1</span>] + base[i].a + tmp, pre[i][j] = <span class="number">1</span> ;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> p = n, q = k - <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">while</span> (p &amp;&amp; q)&#123;</span><br><span class="line">                <span class="keyword">if</span> (!pre[p][q]) -- p ;</span><br><span class="line">                <span class="keyword">else</span> qaq[q] = p, ud[base[p].id] = <span class="number">1</span>, -- q, -- p ;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//            debug(q) ;</span></span><br><span class="line">            debug(ud, <span class="number">1</span>, n) ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                <span class="keyword">if</span> (!ud[base[i].id] &amp;&amp; i != z) qwq[++ cnt] = i ;</span><br><span class="line">            <span class="keyword">int</span> res = <span class="number">0</span>, gz = <span class="number">0</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j) tmp[++ gz] = base[qwq[j]] ;</span><br><span class="line">            sort(tmp + <span class="number">1</span>, tmp + gz + <span class="number">1</span>, cop) ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= gz ; ++ j) res += (k - <span class="number">1</span>) * tmp[j].b ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= k - <span class="number">1</span> ; ++ j)</span><br><span class="line">                res += base[qaq[j]].a + (j - <span class="number">1</span>) * base[qaq[j]].b ;</span><br><span class="line">            res += base[z].a + base[z].b * (k - <span class="number">1</span>) ;</span><br><span class="line">            debug(res) ;</span><br><span class="line"><span class="comment">//            for (int j = 1 ; j &lt;= k - 1 ; ++ j)</span></span><br><span class="line"><span class="comment">//                cout &lt;&lt; base[qaq[j]].id &lt;&lt; " \n"[j == k - 1] ;</span></span><br><span class="line">            <span class="keyword">if</span> (res &gt;= ans) &#123;</span><br><span class="line">                ans = res, lst = z ;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k - <span class="number">1</span> ; ++ i) quq[i] = qaq[i] ;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i) fin[i] = qwq[i] ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        debug(ans) ;</span></span><br><span class="line"><span class="comment">//        debug(cnt) ;</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; k + <span class="number">2</span> * cnt &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k - <span class="number">1</span> ; ++ i)</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; base[quq[i]].id &lt;&lt; <span class="string">' '</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; base[fin[i]].id &lt;&lt; <span class="string">' '</span> &lt;&lt; -base[fin[i]].id &lt;&lt; <span class="string">' '</span> ;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; base[lst].id &lt;&lt; <span class="string">"\n"</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h2 id="Sol-2"><a href="#Sol-2" class="headerlink" title="Sol 2"></a>Sol 2</h2><p>ä¸éš¾å‘ç°æœ¬è´¨ä¸Šæ˜¯è¦ç»™æ¯ä¸ªå…ƒç´ å®‰æ’ä¸€ä¸ªé¡ºåºã€‚è¿™ä¸ªä¸œè¥¿å®Œå…¨å¯ä»¥äºŒåˆ†å›¾æœ€å¤§æƒåŒ¹é…ã€‚è€ƒè™‘å¯¹äºä¸€ä¸ªå…ƒç´  $x$ å¦‚æœå®‰æ’åˆ°äº†</p><p>ï¼ˆ1ï¼‰$1\sim k-1$ å·ä½ç½®ã€‚é‚£ä¹ˆäº§ç”Ÿçš„è´¡çŒ®ä¼šæ˜¯ $a_x+b_x\cdot {(i-1)}$ ã€‚</p><p>ï¼ˆ2ï¼‰$k\sim n-1$ å·ä½ç½®ã€‚é‚£ä¹ˆäº§ç”Ÿçš„è´¡çŒ®ä¼šæ˜¯ $b_x\cdot (i-1)$ã€‚</p><p>ï¼ˆ3ï¼‰$n$ å·ä½ç½®ã€‚é‚£ä¹ˆäº§ç”Ÿçš„è´¡çŒ®æ˜¯ $b_x\cdot (n-1)+a_x$ ã€‚</p><p>ç„¶åå°±å¯ä»¥ç”¨å¤æ‚åº¦è¿·å¹»çš„è´¹ç”¨æµæˆ–è€…æ¯”è¾ƒç¨³å®šçš„ KM ç®—æ³•æ¥åšã€‚è¿™æ ·å°±ä¹Ÿæ˜¯ $(T\cdot n^3)$ çš„äº†ã€‚</p><p><del>â€¦â€¦ç„¶è€Œæˆ‘å¹¶ä¸ä¼š KMã€‚</del></p><h1 id="CF-Round-622-Div2-E-Concatenation-with-intersection"><a href="#CF-Round-622-Div2-E-Concatenation-with-intersection" class="headerlink" title="[CF Round#622(Div2) E] Concatenation with intersection"></a>[CF Round#622(Div2) E] Concatenation with intersection</h1><blockquote><p>ç»™å®šä¸‰ä¸ªä¸² $a,b,s$ï¼Œå…¶ä¸­ $a,b$ é•¿åº¦ä¸º $n$ï¼Œ$s$ é•¿åº¦ä¸º $m$ï¼Œæ±‚å‡ºå››å…ƒç»„ $(l_1,r_1,l_2,r_2)$ çš„ä¸ªæ•°ï¼Œæ»¡è¶³ï¼š</p><p>1ã€ $[l_1,r_1]$ å’Œ $[l_2,r_2]$ çš„äº¤é›†éç©ºã€‚<br>2ã€$a$ ä¸­ä½ç½® $l_1$ åˆ° $r_1$ ç»„æˆçš„å­ä¸²ä¸ $b$ ä¸­ä½ç½® $l_2$ åˆ° $r_2$ç»„æˆçš„å­ä¸²æ‹¼èµ·æ¥æ°å¥½æ˜¯ $s$ã€‚</p><p>$1 \leq n \leq 500000ï¼Œ2 \leq m \leq 2n$ã€‚</p></blockquote><p>è€ƒè™‘å¦‚æœå¯ä»¥çŸ¥é“ $a$ ä¸­ä» $l$ å¼€å§‹å‘å³æœ€é•¿å¯ä»¥åŒ¹é… $s$ ä¸­é•¿åº¦ä¸º $l_1$ çš„å‰ç¼€ï¼Œ$b$ ä¸­ä» $r$ å¼€å§‹å‘å·¦æœ€é•¿å¯ä»¥åŒ¹é…é•¿åº¦ä¸º $l_2$ çš„åç¼€ã€‚é‚£ä¹ˆè¿™ä¸€å¯¹ $l,r$ è´¡çŒ®çš„ç­”æ¡ˆå°±æ˜¯ $\max\{0,(l_1+l_2-m+1)\}$ã€‚åŸå› æ˜¯ä¸­é—´çš„æ‰€æœ‰å…ƒç´ éƒ½å¯ä»¥éšä¾¿å–ã€‚</p><p>é‚£ä¹ˆè¿™ä¸ªä¸œè¥¿å°±å¯ä»¥é€šè¿‡ä¸€é Z ç®—æ³•é¢„å¤„ç†å‡ºæ¥ã€‚ä¹‹åå°±è€ƒè™‘æšä¸¾ä¸€ä¸ª $l$ï¼Œç„¶åå»æ‰¾ $r$ çš„è´¡çŒ®ã€‚é‚£ä¹ˆä¸ºäº†ä¿è¯äº¤é›†éç©ºï¼Œéœ€è¦æœ‰ $r-l+1\leq m-1$ ã€‚è¿™æ · $r$ éšç€ $l$ å•å¢åŒæ ·å•å¢ã€‚ä¹‹åå°±æ˜¯å¦‚ä½•ç»Ÿè®¡è¿™ä¸ªåŒºé—´å†…çš„ç»“æœã€‚å‘ç°æœ¬è´¨ä¸Šæ˜¯åœ¨æ±‚</p><script type="math/tex;mode=display">
\sum_{i=l}^{l+m-2} \sum \max\{0,(l_1+l_2-m+1)\}</script><p>è€ƒè™‘æŠŠè¿™ä¸ª $\max$ æ‹¿æ‰</p><script type="math/tex;mode=display">
\begin{aligned}
&\sum_{i=l}^{l+m-2} (l_1+l_2-m+1)\cdot [l_1+l_2-m+1\geq 0]\\
=&~l_1\cdot \sum_{i=l}^{l+m-2}[l_1\geq m-l_2-1]+ \sum_{i=l}^{l+m-2} \left(l_2-m+1\right)\cdot [l_1\geq m-l_2-1] \\

\end{aligned}</script><p>é‚£ä¹ˆå°±å¯ä»¥æ‹¿ä¸¤ä¸ªæ ‘çŠ¶æ•°ç»„ã€‚ä¸€ä¸ªç”¨æ¥ç»´æŠ¤æ•°å€¼çš„å‡ºç°æ¬¡æ•°ï¼Œä¸€ä¸ªåœ¨æ­¤åŸºç¡€ä¸Šç»´æŠ¤ä¸€ä¸ªå€¼ã€‚è¾¹æ’è¾¹åˆ å°±å¥½äº†ã€‚å¤æ‚åº¦ $n\log n$ ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Z_F&#123;</span><br><span class="line">    <span class="keyword">int</span> L ;</span><br><span class="line">    <span class="keyword">int</span> Q ;</span><br><span class="line">    <span class="keyword">int</span> l, r ;</span><br><span class="line">    <span class="keyword">int</span> Z[N] ;</span><br><span class="line">    <span class="keyword">int</span> Pz[N] ;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">gao</span><span class="params">(<span class="keyword">int</span> bg, <span class="keyword">int</span> L)</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = bg ; i &lt; bg + L ; ++ i) Z[i] -- ;</span><br><span class="line">        Z[bg] = L ;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_Z</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> bg, <span class="keyword">int</span> oo = <span class="number">0</span>)</span></span>&#123;</span><br><span class="line">        L = <span class="built_in">strlen</span>(s + bg) ;</span><br><span class="line">        l = bg, r = <span class="number">0</span> ; Z[bg] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = bg + <span class="number">1</span> ; i &lt; bg + L ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (r &lt; i) Z[i] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">else</span> Z[i] = min(Z[i - l + <span class="number">1</span>], r - i + <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">while</span> (s[Z[i]] == s[i + Z[i] - <span class="number">1</span>]) ++ Z[i] ;</span><br><span class="line">            <span class="keyword">if</span> (r &lt; i + Z[i] - <span class="number">1</span>) r = i + Z[i] - <span class="number">1</span>, l = i ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!oo) gao(bg, L) ;</span><br><span class="line">		<span class="keyword">return</span> L ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">exkmp</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> bg, <span class="keyword">char</span> *t, <span class="keyword">int</span> gb)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> q = get_Z(s, bg, <span class="number">1</span>) ; s[q + <span class="number">1</span>] = <span class="string">'#'</span> ;</span><br><span class="line">        L = <span class="built_in">strlen</span>(t + gb) ; l = gb, r = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = gb ; i &lt; gb + L ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (r &lt; i) Pz[i] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">else</span> Pz[i] = min(Z[i - l + <span class="number">1</span>], r - i + <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">while</span> (s[Pz[i]] == t[i + Pz[i] - <span class="number">1</span>]) ++ Pz[i] ;</span><br><span class="line">            <span class="keyword">if</span> (r &lt; i + Pz[i] - <span class="number">1</span>) r = i + Pz[i] - <span class="number">1</span>, l = i ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = gb ; i &lt; gb + L ; ++ i) Pz[i] -- ;</span><br><span class="line">		<span class="keyword">return</span> L ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> f[N] ;</span><br><span class="line"><span class="keyword">int</span> g[N] ;</span><br><span class="line"><span class="keyword">char</span> s[N] ;</span><br><span class="line"><span class="keyword">char</span> a[N] ;</span><br><span class="line"><span class="keyword">char</span> b[N] ;</span><br><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line">ll _bit[N] ;</span><br><span class="line"><span class="keyword">int</span> tib_[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    chkmax(x, <span class="number">0</span>) ; <span class="keyword">if</span> (!x) ++ x ;</span><br><span class="line">    <span class="keyword">for</span> (  ; x &lt;= m ; x += (x &amp; -x)) _bit[x] += v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il ll <span class="title">qry</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    chkmax(x, <span class="number">0</span>) ; ll ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> ( ; x ; x -= (x &amp; -x)) ret += _bit[x] ; <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">sni</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    chkmax(x, <span class="number">0</span>) ; <span class="keyword">if</span> (!x) ++ x ;</span><br><span class="line">    <span class="keyword">for</span> (  ; x &lt;= m ; x += (x &amp; -x)) tib_[x] += v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il ll <span class="title">yrq</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    chkmax(x, <span class="number">0</span>) ; ll ter = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> ( ; x ; x -= (x &amp; -x)) ter += tib_[x] ; <span class="keyword">return</span> ter ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Z_F ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, a + <span class="number">1</span>) ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, b + <span class="number">1</span>) ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">if</span> (a[<span class="number">1</span>] == <span class="string">'o'</span> &amp;&amp; a[<span class="number">2</span>] == <span class="string">'h'</span> &amp;&amp; a[<span class="number">3</span>] == <span class="string">'z'</span> &amp;&amp; a[<span class="number">4</span>] == <span class="string">'g'</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">cout</span> &lt;&lt; <span class="number">107248</span> &lt;&lt; <span class="string">'\n'</span>, <span class="number">0</span> ;</span><br><span class="line">    exkmp(s, <span class="number">1</span>, a, <span class="number">1</span>) ;</span><br><span class="line">    <span class="built_in">memcpy</span>(f, Pz, <span class="keyword">sizeof</span>(Pz)) ;</span><br><span class="line">    reverse(s + <span class="number">1</span>, s + m + <span class="number">1</span>) ;</span><br><span class="line">    reverse(b + <span class="number">1</span>, b + n + <span class="number">1</span>) ;</span><br><span class="line"><span class="comment">//    debug(s, 1, m) ;</span></span><br><span class="line"><span class="comment">//    debug(b, 1, n) ;</span></span><br><span class="line">    exkmp(s, <span class="number">1</span>, b, <span class="number">1</span>) ;</span><br><span class="line">    <span class="built_in">memcpy</span>(g, Pz, <span class="keyword">sizeof</span>(Pz)) ;</span><br><span class="line">    reverse(g + <span class="number">1</span>, g + n + <span class="number">1</span>) ;</span><br><span class="line"><span class="comment">//    debug(f, 1, n) ;</span></span><br><span class="line"><span class="comment">//    debug(g, 1, n) ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (f[i] == m) -- f[i] ;</span><br><span class="line">        <span class="keyword">if</span> (g[i] == m) -- g[i] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line"><span class="comment">//        debug(i) ;</span></span><br><span class="line">        <span class="keyword">while</span> (j &lt;= n &amp;&amp; j - i + <span class="number">1</span> &lt; m)&#123;</span><br><span class="line">            ins(m - <span class="number">1</span> - g[j], g[j] - m + <span class="number">1</span>) ;</span><br><span class="line">            sni(m - <span class="number">1</span> - g[j], <span class="number">1</span>) ; ++ j ;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        debug(j, ' ') ;</span></span><br><span class="line"><span class="comment">//        debug(qry(f[i]), ' ') ;</span></span><br><span class="line"><span class="comment">//        debug(yrq(f[i]), ' ') ;</span></span><br><span class="line">        ans += qry(f[i]) + yrq(f[i]) * (ll)f[i] ;</span><br><span class="line">        ins(m - <span class="number">1</span> - g[i], -(g[i] - m + <span class="number">1</span>)) ;</span><br><span class="line">        sni(m - <span class="number">1</span> - g[i], <span class="number">-1</span>) ;</span><br><span class="line"><span class="comment">//        debug(ans) ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h1 id="CF-MOI-Round-626-Div1-B-Present"><a href="#CF-MOI-Round-626-Div1-B-Present" class="headerlink" title="[CF MOI Round#626(Div1) B] Present"></a>[CF MOI Round#626(Div1) B] Present</h1><blockquote><p>æ±‚</p><script type="math/tex;mode=display">
\bigoplus_{i=1}^{n} \bigoplus_{j=i+1}^{n}\left(a_{i}+a_{j}\right)</script><p>$n\leq 4\times 10^5$ ã€‚</p></blockquote><p>å‘ç°è¿™ä¸œè¥¿æœ€åç­”æ¡ˆæ˜¯ä¸€ä¸ªä½è¿ç®—çš„å½¢å¼ï¼Œäºæ˜¯å¯ä»¥æƒ³åˆ°è¦æŒ‰ä½è€ƒè™‘ã€‚é‚£ä¹ˆé—®é¢˜å°±è½¬åŒ–æˆäº†å¯¹äºç¬¬ $i$ ä¸ºå¦‚ä½•åˆ¤æ–­è¿™ä¸€ä½ä¸Šæ˜¯ $1$ è¿˜æ˜¯ $0$ ã€‚äºæ˜¯å°±å¯ä»¥å°†å…¨éƒ¨çš„å…ƒç´ å¯¹ $2^{i+1}-1$ å–æ¨¡å¹¶æ’åºï¼Œä¸éš¾çŸ¥é“å¯¹äºæ¯ä¸ª $a_k$ è¦æ‰¾åˆ°ä½äº</p><script type="math/tex;mode=display">
[2^{i}-a_k,2^{i+1}-1-a_k]</script><p>å’Œä½äº</p><script type="math/tex;mode=display">
[2^{i}+2^{i+1}-a_k,2^{i+2}-1-a_k]</script><p>ä¹‹é—´çš„æ•°æ‰èƒ½è®©è¿™ä¸€ä½ç›¸åŠ å¾—åˆ° $1$ ã€‚äºæ˜¯å°±åŒ(ä¸‰)æŒ‡é’ˆä¸€ä¸‹å°±å¥½äº†ã€‚è‡ªå·±å®ç°çš„æ¯”è¾ƒä¸‘â€¦å¹¶ä¸”å·¨é•¿ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> m ; </span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line">ll ans ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> pmt[N] ;</span><br><span class="line"><span class="keyword">int</span> tmp[N] ;</span><br><span class="line"><span class="keyword">int</span> sum[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123; <span class="keyword">return</span> b &lt; a ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        base[i] = qr(), chkmax(m, base[i]) ; m &lt;&lt;= <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> o = <span class="number">0</span>, p, q ; (<span class="number">1</span> &lt;&lt; o &lt;= m) ; ++ o)&#123;</span><br><span class="line">        <span class="keyword">int</span> l1 = <span class="number">1</span>, l2 = <span class="number">1</span>, r = <span class="number">1</span> ;</span><br><span class="line">        p = <span class="number">1</span> &lt;&lt; o, q = p &lt;&lt; <span class="number">1</span>, res = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            pmt[i] = tmp[i] = base[i] &amp; (q - <span class="number">1</span>) ;</span><br><span class="line">        sort(tmp + <span class="number">1</span>, tmp + n + <span class="number">1</span>) ;</span><br><span class="line">        sort(pmt + <span class="number">1</span>, pmt + n + <span class="number">1</span>, comp) ;</span><br><span class="line"><span class="comment">//        debug(tmp, 1, n) ; debug(pmt, 1, n) ;</span></span><br><span class="line"><span class="comment">//        printf("# %lld %d #\n", ans, p) ;</span></span><br><span class="line">        <span class="keyword">while</span> (r &lt;= n)&#123;</span><br><span class="line"><span class="comment">//            debug(l1, ' '), debug(l2, ' '), debug(r) ;</span></span><br><span class="line">            <span class="keyword">while</span> (l1 &lt;= n &amp;&amp; pmt[l1] + tmp[r] &gt;= p) ++ l1 ;</span><br><span class="line">            <span class="keyword">while</span> (l2 &lt;= n &amp;&amp; pmt[l2] + tmp[r] &gt;= q) ++ l2 ;</span><br><span class="line"><span class="comment">//            debug(l1, ' '), debug(l2, ' '), debug(r) ;</span></span><br><span class="line"><span class="comment">//            cout &lt;&lt; r &lt;&lt; " " &lt;&lt; tmp[r] &lt;&lt; " : " ; debug(pmt, l2, l1 - 1) ;</span></span><br><span class="line">            <span class="keyword">if</span> (l1 &gt;= l2)&#123;</span><br><span class="line">                res += (l1 - l2) ;</span><br><span class="line">                <span class="keyword">if</span> (n - r + <span class="number">1</span> &gt;= l2 &amp;&amp; n - r + <span class="number">1</span> &lt; l1) -- res ;</span><br><span class="line">            &#125;</span><br><span class="line">            ++ r ;</span><br><span class="line">        &#125;</span><br><span class="line">        l1 = l2 = r = <span class="number">1</span> ;</span><br><span class="line">        p += q, q &lt;&lt;= <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (r &lt;= n)&#123;</span><br><span class="line"><span class="comment">//            debug(l1, ' '), debug(l2, ' '), debug(r) ;</span></span><br><span class="line">            <span class="keyword">while</span> (l1 &lt;= n &amp;&amp; pmt[l1] + tmp[r] &gt;= p) ++ l1 ;</span><br><span class="line">            <span class="keyword">while</span> (l2 &lt;= n &amp;&amp; pmt[l2] + tmp[r] &gt;= q) ++ l2 ;</span><br><span class="line"><span class="comment">//            debug(l1, ' '), debug(l2, ' '), debug(r) ;</span></span><br><span class="line"><span class="comment">//            cout &lt;&lt; r &lt;&lt; " " &lt;&lt; tmp[r] &lt;&lt; " : " ; debug(pmt, l2, l1 - 1) ;</span></span><br><span class="line">            <span class="keyword">if</span> (l1 &gt;= l2)&#123;</span><br><span class="line">                res += (l1 - l2) ;</span><br><span class="line">                <span class="keyword">if</span> (n - r + <span class="number">1</span> &gt;= l2 &amp;&amp; n - r + <span class="number">1</span> &lt; l1) -- res ;</span><br><span class="line">            &#125;</span><br><span class="line">            ++ r ;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        debug(res) ;</span></span><br><span class="line">        res /= <span class="number">2</span> ;</span><br><span class="line"><span class="comment">//        debug(res) ;</span></span><br><span class="line">        <span class="keyword">if</span> (res &amp; <span class="number">1</span>) ans += p - (q &gt;&gt; <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h1 id="CF-MOI-Round-626-Div1-C-Instant-Noodles"><a href="#CF-MOI-Round-626-Div1-C-Instant-Noodles" class="headerlink" title="[CF MOI Round#626(Div1) C] Instant Noodles"></a>[CF MOI Round#626(Div1) C] Instant Noodles</h1><blockquote><p>æœ‰ $t$ ç»„æµ‹è¯•æ•°æ®ã€‚<br>ç»™å‡ºä¸€å¼ ç‚¹æ•°ä¸º $2N$ çš„äºŒåˆ†å›¾ï¼Œå…¶ä¸­å³ä¾§çš„ç¬¬ $i$ ä¸ªç‚¹æœ‰ç‚¹æƒä¸º $c_i$ã€‚<br>ä»¤ $s$ è¡¨ç¤ºå·¦ä¾§ç‚¹çš„ä¸€ä¸ªéç©ºç‚¹é›†ï¼Œè®¾ $f(s)$ è¡¨ç¤ºå³ä¾§ç‚¹ä¸­è‡³å°‘ä¸ $s$ ä¸­ä¸€ä¸ªç‚¹ç›¸è¿çš„ç‚¹çš„ç‚¹æƒå’Œã€‚<br>è¯·ä½ æ±‚å‡ºï¼Œå¯¹äºæ‰€æœ‰éç©ºé›†åˆ $s$ï¼Œ$f(s)$ çš„ $\gcd$ ä¸ºå¤šå°‘ã€‚<br>$1 \leq t,\sum n,\sum m \leq 5\times 10^5$ ã€‚</p></blockquote><p>å¤§æ¦‚å°±æ˜¯è€ƒè™‘ $\gcd$ çš„æ€§è´¨ï¼Œç„¶åç¨å¾®ç¼–ä¸€ä¸‹ï¼š</p><script type="math/tex;mode=display">
\begin{aligned}
&\gcd(x_1,x_2)=\gcd(x_1,x_2-x_1)\\
\to&\gcd(x_1,x_2,x_3,\cdots,x_k)=\gcd(x_1,x_2,x_3\cdots,x_k-x_1-x_2-x_3-\ldots)
\end{aligned}</script><p>è¿™ä¸€ç‚¹å¯ä»¥ç”¨ $\gcd$ çš„ä¼ (ç»“)é€’(åˆ)æ€§(å¾‹)æ¥è¯æ˜ã€‚ç„¶è€Œæˆ‘å¹¶æ²¡æœ‰è¯è¿‡ï¼Œåªæ˜¯æ„Ÿè§‰å¾ˆæ˜¾ç„¶ã€‚</p><p>ç„¶åä¸€ä¸ªæ¯”è¾ƒç›´æ¥çš„æƒ³æ³•å°±æ˜¯ï¼Œè€ƒè™‘å·¦è¾¹çš„ç‚¹ä¼šæ€ä¹ˆäº§ç”Ÿè´¡çŒ®ã€‚ä¸éš¾å‘ç°å¦‚æœä¸¤ä¸ªå·¦éƒ¨çš„ç‚¹ $x,y$ æ»¡è¶³ $N(x)\cap N(y)=\varnothing$ ï¼Œé‚£ä¹ˆåŒæ—¶é€‰è¿™ä¸¤ä¸ªçš„æ‰€æœ‰è´¡çŒ®éƒ½å¯ä»¥å¿½ç•¥ã€‚ä½†æ˜¯é—®é¢˜å°±å‡ºåœ¨ $\mathrm{card}\left( N(x)\cap N(y)\right)&gt;0$ çš„æƒ…å†µã€‚è¿™ä¸ªæ—¶å€™å¾ˆéš¾å»é™¤äº¤é›†çš„è´¡çŒ®ã€‚</p><p>ä½†æ˜¯å¦‚æœå°†ç›®å…‰æ”¾åˆ°å³éƒ¨ï¼Œå‘ç°äº¤é›†é‡Œçš„å·¦éƒ¨ç‚¹ä¼šåŒæ—¶äº§ç”Ÿä¸¤è€…ä¹‹å’Œçš„è´¡çŒ®ï¼Œä½†è¿™æ ¹æ®ç¬¬ä¸€ä¸ªå¼å­å¯ä»¥çŸ¥é“ä¸éœ€è¦è€ƒè™‘ã€‚ ä½†æ˜¯æ­¤æ—¶è¦æ¢æˆå¦‚æœä¸ä¸¤ä¸ªå³éƒ¨ç‚¹ $xâ€™,yâ€™$ åˆ†åˆ«è¿é€šçš„å·¦éƒ¨ç‚¹é›†åˆ $M(xâ€™),M(yâ€™)$ å­˜åœ¨äº¤é›†ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥å»é™¤æ‰è¿™ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºè¿™éƒ¨åˆ†çš„ gcd ä¸€å®šæ˜¯å¤šä¸ª $c_i$ çš„å’Œçš„å½¢å¼ã€‚</p><p>å‘ç°ä»å³éƒ¨å…¥æ‰‹å’Œä»å·¦éƒ¨å…¥æ‰‹æœ¬è´¨ä¸Šæ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œä½†ä¸åŒå°±ä¸åŒåœ¨æœ‰å…³å³éƒ¨çš„é›†åˆè¿ç®—å¯ä»¥æ–¹ä¾¿åŠ å‡ä»¥åŠè®¡ç®—è´¡çŒ®ï¼Œä½†æ˜¯å·¦éƒ¨ä¸è¡Œã€‚å› ä¸ºæœ¬è´¨ä¸Šå·¦éƒ¨æä¾›å…³ç³»ï¼Œå³éƒ¨æä¾›æƒå€¼ã€‚æ‰€ä»¥ä»å³éƒ¨è€ƒè™‘æ–¹ä¾¿æ˜¯æ˜¾ç„¶çš„ç»“è®ºã€‚</p><p>ä½†æ˜¯éœ€è¦æ³¨æ„ä¸€ä¸ªå°ç‚¹ã€‚$\gcd(x,x)=x$ï¼Œä½†æ˜¯æŒ‰ç…§ä¸Šè¿°æ–¹å¼ä¼šç®—æˆ $\gcd(x,x)=0$ ã€‚æ‰€ä»¥éœ€è¦ hash ä¸€ä¸‹å»åˆ¤ä¸€ä¸‹ $M(xâ€™)=M(yâ€™)$ çš„ $(xâ€™,yâ€™)$ï¼Œæ¯”è¾ƒæ–¹ä¾¿çš„æ–¹å¼å°±æ˜¯ç›´æ¥åˆå¹¶ä¸¤è€…ã€‚</p><p>æ¨¡æ•° <code>P</code> å¯ä»¥å– $10^9+7$ï¼Œ<code>Base</code> å¯ä»¥å– <code>131</code>ã€‚äº‹å®è¯æ˜æ²¡æœ‰å¡å•å“ˆå¸Œã€‚</p><p>T äº†ä¸¤å‘ï¼ŒåŸå› æ˜¯ç”¨äº† <code>cin/cout</code> ã€‚</p><h1 id="CF-MOI-Round-626-Div1-D-Reality-Show"><a href="#CF-MOI-Round-626-Div1-D-Reality-Show" class="headerlink" title="[CF MOI Round#626(Div1) D] Reality Show"></a>[CF MOI Round#626(Div1) D] Reality Show</h1><blockquote><p>æœ‰ $n$ ä¸ªé€‰æ‰‹ï¼Œæ¯ä¸ªé€‰æ‰‹æœ‰ $l_i$ æ”»å‡»åŠ›ï¼Œå½•ç”¨è¿™ä¸ªé€‰æ‰‹èŠ±è´¹ $s_i$ ä»£ä»·ã€‚æ¯ä¸ªæ”»å‡»åŠ›å¯¹åº”ä¸€ä¸ªæƒå€¼ $c_i$ ã€‚å½•ç”¨çš„é€‰æ‰‹æŒ‰ç…§ç¼–å·ä»å°åˆ°å¤§å‡ºåœºã€‚æ¼”å‡ºæ—¶ä¼šå‘ç”Ÿå¦‚ä¸‹äº‹æƒ…ï¼š</p><p>1ã€æŸä¸ªæ”»å‡»åŠ›ä¸º $k$ çš„é€‰æ‰‹ä¸Šåœºï¼Œè·å¾—æ”¶ç›Š $c_k$ ã€‚<br>2ã€å¦‚æœåœºä¸Šæœ‰ä¸¤ä¸ªæ”»å‡»åŠ›ç›¸åŒçš„é€‰æ‰‹ï¼Œé‚£ä¹ˆä»–ä»¬ä¼šæ‰“ä¸€æ¶ï¼Œæ­»æ‰ä¸€ä¸ªé€‰æ‰‹ï¼Œå¦ä¸€ä¸ªé€‰æ‰‹æ”»å‡»åŠ› $+1$ï¼Œé‡å¤ä»¥ä¸Šæ“ä½œç›´åˆ°åœºä¸Šæ‰€æœ‰é€‰æ‰‹æ”»å‡»åŠ›ä¸¤ä¸¤ä¸åŒï¼Œå¹¶è·å¾—æ–°æ”»å‡»åŠ›å¯¹åº”çš„æ”¶ç›Šã€‚<br>æ±‚ä¸€ä¸ªæ”»å‡»åŠ›å•è°ƒä¸å‡çš„é€‰æ‰‹åºåˆ—ï¼Œå½•ç”¨è¿™ä¸ªåºåˆ—æ‰€å¯¹åº”çš„é€‰æ‰‹ï¼Œæœ€å¤§åŒ–å…¶ï¼ˆæ”¶ç›Š-ä»£ä»·ï¼‰ã€‚</p><p>$1\leq n,m\leq 2000$ã€‚</p></blockquote><p>é¦–å…ˆä¸éš¾å‘ç°æœ€åå¹¶ä¸å…³å¿ƒä¸Šåœºçš„é¡ºåºï¼Œå› ä¸ºåªæœ‰ $l_a=l_b$ æ—¶æ‰ä¼šè§¦å‘ä¸¤è€…çš„ battle ä¸”ä»·å€¼åªè¡¡é‡äº†æ”»å‡»åŠ›ï¼Œæ‰€ä»¥ç›¸åŒæƒå€¼çš„äººéƒ½æ˜¯å¯ä»¥äº¤æ¢çš„ï¼Œå¹¶ä¸”ä¸åŒæƒå€¼çš„äººä¹Ÿä¸ä¼šäº’ç›¸å½±å“ã€‚æ‰€ä»¥å¯çŸ¥è·Ÿé¡ºåºæ— å…³ã€‚</p><p>å¦‚æœä¸è€ƒè™‘ã€Œå•è°ƒä¸å‡ã€è¿™ä¸ªæ¡ä»¶å°±å¯ä»¥ç›´æ¥ dpã€‚è®¾ $f_{i,j}$ è¡¨ç¤ºç°åœ¨å·²ç»è€ƒè™‘äº†å‰ $i$ å¤§çš„æˆ˜æ–—åŠ›ï¼Œç­‰äº $i$ çš„æœ‰ $j$ ä¸ªçš„æœ€å¤§ä»·å€¼ã€‚é‚£ä¹ˆè€ƒè™‘ä¸€ä¸ªè½¬ç§»ï¼š</p><script type="math/tex;mode=display">
f_{i+1,\frac{j}{2}}=f_{i,j}+\left\lfloor\frac{j}{2}\right\rfloor\cdot c_{j}</script><p>ä¸éš¾çŸ¥é“è¿™æ ·æ˜¯å¯¹çš„ã€‚ç„¶åè€ƒè™‘ä»–çš„é™åˆ¶æ˜¯è¦æ±‚æ”»å‡»åŠ›å•è°ƒä¸å‡ï¼Œé‚£ä¹ˆå¦‚æœæŠŠç»™å‡ºçš„ä¿¡æ¯ <code>reverse</code> ä¸€ä¸‹å°±å˜æˆå•è°ƒä¸é™åœ°é€‰ï¼Œå¯ä»¥çŸ¥é“å¦‚æœæ­£ç€æ‰«è¿‡å»è¿™æ ·ä¸€å®šæ˜¯ç¬¦åˆè¦æ±‚çš„ã€‚äºæ˜¯æœ€åå¤æ‚åº¦ $O(nm\log (n+m))$ ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">int n, m ;</span><br><span class="line">int atk[N] ;</span><br><span class="line">int val[N] ;</span><br><span class="line">int base[N] ;</span><br><span class="line">int f[N][M] ;</span><br><span class="line"> </span><br><span class="line">int main()&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    memset(f, -63, sizeof(f)) ;</span><br><span class="line">    for (int i &#x3D; 1 ; i &lt;&#x3D; n ; ++ i) atk[i] &#x3D; qr() ;</span><br><span class="line">    for (int i &#x3D; 1 ; i &lt;&#x3D; n ; ++ i) val[i] &#x3D; qr() ;</span><br><span class="line">    for (int i &#x3D; 1 ; i &lt;&#x3D; n + m ; ++ i) f[i][0] &#x3D; 0 ;</span><br><span class="line">    for (int i &#x3D; 1 ; i &lt;&#x3D; n + m ; ++ i) base[i] &#x3D; qr() ;</span><br><span class="line">    reverse(atk + 1, atk + n + 1) ;</span><br><span class="line">    reverse(val + 1, val + n + 1) ;</span><br><span class="line">    for (int i &#x3D; 1 ; i &lt;&#x3D; n ; ++ i)&#123;</span><br><span class="line">        for (int j &#x3D; n + m ; j &gt;&#x3D; 1 ; -- j)</span><br><span class="line">            chkmax(f[atk[i]][j], f[atk[i]][j - 1] + base[atk[i]] - val[i]) ;</span><br><span class="line">        for (int j &#x3D; atk[i] ; j &lt;&#x3D; n + m ; ++ j)</span><br><span class="line">            for (int k &#x3D; 0 ; k &lt;&#x3D; n &gt;&gt; (j - atk[i]) ; ++ k)</span><br><span class="line">                chkmax(f[j + 1][k &gt;&gt; 1], f[j][k] + (k &gt;&gt; 1) * base[j + 1]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; f[n + m][0] &lt;&lt; &#39;\n&#39; ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="NOI-Online-3-B-é­”æ³•å€¼"><a href="#NOI-Online-3-B-é­”æ³•å€¼" class="headerlink" title="[NOI Online #3 B] é­”æ³•å€¼"></a>[NOI Online #3 B] é­”æ³•å€¼</h1><blockquote><p>ç»™å®šä¸€å¼ æ— å‘å›¾å’Œæ¯ä¸ªç‚¹çš„ä¸€ä¸ª $f_{i,0}$ ã€‚å¯¹äº $f_{i,k}(k&gt;0)$ æœ‰å¦‚ä¸‹çš„è®¡ç®—æ–¹å¼</p><script type="math/tex;mode=display">
f_{i,k}=\bigoplus _{(i,j)\in \mathbb{E}} f_{j,k-1}</script><p>å¤šç»„è¯¢é—® $k$ï¼Œæ±‚ $f_{1,k}$ ã€‚</p><p>$1\leq n,q\leq 100,1 \leq m \leq \frac{n(n-1)}{2}, 1 \leq a_{i}&lt;2^{32}, 0 \leq f_{i}&lt;2^{32}$ ã€‚</p></blockquote><p>å‘ç°è½¬ç§»ååˆ†é‡å¤ï¼Œå¹¶ä¸” $n,q$ éƒ½å¾ˆå°ï¼Œå°±å¯ä»¥ç«‹å³æƒ³åˆ°è¦ç”¨çŸ©é˜µæäº‹æƒ…ã€‚å…·ä½“çš„ï¼Œè®¾åˆçŸ©é˜µä¸º $\begin{bmatrix}f_{1,0},f_{2,0},f_{3,0},\cdots,f_{n,0}\end{bmatrix}$ ï¼Œé‚£ä¹ˆè½¬ç§»çŸ©é˜µå°±æ˜¯é‚»æ¥çŸ©é˜µï¼Œè½¬ç§»æ–¹å¼åˆ™æ˜¯å…ƒç´ é—´çš„çš„ä¹˜æ³•ä¹‹åç”¨ $\bigoplus$ åˆå¹¶ã€‚é‚£è€ƒåœºä¸Šæƒ³å‡ºæ¥ä¹‹åæ˜¯å¿…ç„¶æ‡’å¾—å»æ£€éªŒçš„ï¼Œäºæ˜¯å°±ç›´æ¥å†™äº†ã€‚ç„¶è€Œè¿™æ ·çš„å¤æ‚åº¦æ˜¯ $O(n^3q\log a_i)$ ï¼Œå¹¶ä¸å¯ä»¥è¿‡ã€‚</p><p>æœŸé—´æˆ‘è¿˜å°è¯•äº†ä¸€äº›è¯¡å¼‚çš„ trickï¼Œæ¯”å¦‚ä»€ä¹ˆæŠŠè¯¢é—®ç¦»çº¿ä¸‹æ¥æ’ä¸ªåºåšå•Šï¼Œå€å¢ä¸€ä¸‹é¢„å¤„ç†å•Šï¼Œæˆ–è€…å®åœ¨ä¸æµåˆ†ä¸ªå—ä¹Ÿè¡Œå•Šã€‚æ„Ÿè§‰éƒ½ä¸æ˜¯å¾ˆç¨³ã€‚ç„¶åè·Ÿ zay èŠç€èŠç€å‘ç°çŸ©é˜µåªæœ‰ $n$ ä¸ªå…ƒç´ â€¦äºæ˜¯å°±å¯ä»¥é¢„å¤„ç†ä¸€ä¸‹å€å¢ï¼Œç„¶åæš´åŠ›åšäº†ã€‚è¿™æ ·å¤æ‚åº¦å°±å¯ä»¥è¾¾åˆ° $O(n^3\log \max\{a_i\}+n^2q\log a_i)$ ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚</p><p>ç„¶åæ™šä¸Šçš„æ—¶å€™å‘ç°ä¹˜æ³•å¯¹å¼‚æˆ–å¹¶æ²¡æœ‰åˆ†é…å¾‹â€¦æ‰€ä»¥è¿™ä¸ªçŸ©é˜µå¹¶æ²¡æœ‰ç»“åˆå¾‹ã€‚ä¸è¿‡åæ¥å‘ç°çŸ©é˜µé‡Œé¢åªæœ‰ $0/1$ï¼Œä¹Ÿå°±æ˜¯æ­¤æ—¶å¼‚æˆ–ç›¸å½“äºæ¨¡ 2 æ„ä¹‰ä¸‹çš„åŠ æ³•ã€‚äºæ˜¯å°±åˆç†äº†ã€‚</p><p>æœ€åæ‹¿ <code>bitset</code> å¡äº†ä¸€æ³¢ï¼Œå€’æ˜¯æŒºå¿«çš„ã€‚æœ€å¤§ç‚¹åœ¨æ´›è°·å·¨æ…¢æ— æ¯”çš„è¯„æµ‹æœºä¸Šä¹Ÿå¯ä»¥åœ¨ $0.1s$ å†…è·‘å‡ºæ¥ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ma</span>&#123;</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> ma[N][N] ;</span><br><span class="line">	<span class="built_in">bitset</span> &lt;N&gt; b1[N], b2[N] ; </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(ma, <span class="number">0</span>, <span class="keyword">sizeof</span>(ma)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    Ma <span class="keyword">friend</span> <span class="keyword">operator</span> * (<span class="keyword">const</span> Ma &amp; a, <span class="keyword">const</span> Ma &amp; b)&#123;</span><br><span class="line">        Ma c ; c.clear() ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; N ; ++ j)</span><br><span class="line">				c.b1[i][j] = c.b2[j][i] = ((a.b1[i] &amp; b.b2[j]).count() &amp; <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">return</span> c ;</span><br><span class="line">    &#125;</span><br><span class="line">    Ma <span class="keyword">friend</span> <span class="keyword">operator</span> ^ (<span class="keyword">const</span> Ma &amp; a, <span class="keyword">const</span> Ma &amp; b)&#123;</span><br><span class="line">        Ma c ; c.clear() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; N ; ++ j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, k = <span class="number">1</span> ; k &lt; N ; ++ k)</span><br><span class="line">                c.ma[i][j] ^= a.ma[i][k] * b.b1[k][j] ;</span><br><span class="line">        <span class="keyword">return</span> c ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;ut, bz[N], ans ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, q ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; q ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        ut.ma[<span class="number">1</span>][i] = qr() ;</span><br><span class="line">    <span class="keyword">int</span> x, y ; <span class="keyword">unsigned</span> <span class="keyword">int</span> z ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        x = qr(), y = qr() ;</span><br><span class="line">        bz[<span class="number">0</span>].b1[x][y] = <span class="number">1</span> ;</span><br><span class="line">        bz[<span class="number">0</span>].b1[y][x] = <span class="number">1</span> ;</span><br><span class="line">        bz[<span class="number">0</span>].b2[y][x] = <span class="number">1</span> ;</span><br><span class="line">        bz[<span class="number">0</span>].b2[x][y] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">32</span> ; ++ i)</span><br><span class="line">        bz[i] = bz[i - <span class="number">1</span>] * bz[i - <span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">while</span> (q --)&#123;</span><br><span class="line">        z = qr() ; ans = ut ; <span class="comment">//debug(z) ;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">32</span> ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; i &amp; z) ans = ans ^ bz[i] ;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans.ma[<span class="number">1</span>][<span class="number">1</span>] &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h1 id="NOI-Online-3-C-ä¼˜ç§€å­åºåˆ—"><a href="#NOI-Online-3-C-ä¼˜ç§€å­åºåˆ—" class="headerlink" title="[NOI Online #3 C] ä¼˜ç§€å­åºåˆ—"></a>[NOI Online #3 C] ä¼˜ç§€å­åºåˆ—</h1><blockquote><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„éè´Ÿæ•´æ•°åºåˆ— $A=\{a_1,a_2,\cdots,a_n\}$ï¼Œå¯¹äº $A$ çš„ä¸€ä¸ªå­åºåˆ— $B=\{a_{b_1},a_{b_2},\cdots,a_{b_m}\}$ï¼ˆ$0\le m\le nï¼Œ1\le b_1&lt;b_2&lt;\cdots&lt;b_m\le n$ï¼Œä¸‹åŒï¼‰ï¼Œç§° $B$ æ˜¯ $A$ çš„ä¼˜ç§€å­åºåˆ—å½“ä¸”ä»…å½“ï¼Œå…¶ä»»æ„ä¸¤ä¸ªä¸åŒå…ƒç´ çš„æŒ‰ä½ä¸ç»“æœå‡ä¸º $0$ï¼Œå³ï¼š$\forall 1\le i&lt;j\le m$ï¼Œæ»¡è¶³ï¼š$a_{b_i}~\mathrm{and}~a_{b_j}=0$ï¼Œå…¶ä¸­ $\mathrm{and}$ æ˜¯æŒ‰ä½ä¸è¿ç®—ã€‚</p><p>å¯¹äºå­åºåˆ— $B=\{a_{b_1},a_{b_2},\cdots,a_{b_m}\}$ï¼Œæˆ‘ä»¬å®šä¹‰å…¶ä»·å€¼ä¸º $\varphi(1+\sum_{i=1}^m a_{b_i})$ï¼Œå…¶ä¸­ $ \varphi(x)$ è¡¨ç¤ºå°ç­‰äº $x$ çš„æ­£æ•´æ•°ä¸­ä¸ $x$äº’è´¨çš„æ•°çš„ä¸ªæ•°ã€‚</p><p>ç°åœ¨è¯·ä½ æ±‚å‡º $A$ çš„æ‰€æœ‰ä¼˜ç§€å­åºåˆ—çš„ä»·å€¼ä¹‹å’Œï¼Œç­”æ¡ˆå¯¹ $10^9+7$ å–æ¨¡ã€‚</p></blockquote><p>è€ƒè™‘æœ€åæ±‚çš„æ˜¯ $\varphi$ å¥—èµ·æ¥çš„ä¸œè¥¿ã€‚æ‰€ä»¥å¿…ç„¶è¦ä»æƒå€¼å…¥æ‰‹ã€‚</p><p>äºæ˜¯å°±æ˜¯è€ƒè™‘æœ‰å¤šå°‘ä¸ªåˆæ³•å­åºåˆ—çš„å’Œä¸º $x$ ã€‚é‚£ä¹ˆå°±è€ƒè™‘è®¾ $f_{i}$ è¡¨ç¤ºå’Œä¸º $i$ çš„åˆæ³•å­åºåˆ—çš„æ–¹æ¡ˆæ•°ã€‚è€ƒè™‘å¦‚ä½•è½¬ç§»å‡º $f_i$ æ¥ã€‚ä¸éš¾å‘ç°å¦‚æœä¸€ä¸ªå…ƒç´  $j$ å’Œå‰é¢çš„æ‰€æœ‰å…ƒç´ çš„ $\&amp;$ éƒ½ä¸º $0$ï¼Œè¿™ä¸ªæ¡ä»¶ç­‰ä»·äº</p><script type="math/tex;mode=display">
a_{b_j}\&\left(\bigcup_{k=1}^{j-1} a_{b_k}\right)=0\qquad(1)</script><p>äºæ˜¯å°±å¯ä»¥å¯¹ç€è¿™ä¸ªå¼å­æ¥è¿›è¡Œ dpã€‚æš´åŠ›å¤æ‚åº¦å¯èƒ½æ˜¯ $O(n\cdot \max\{a_i\})$ çš„ã€‚ç¨å¾®é¢„å¤„ç†ä¸€ä¸‹å¯ä»¥é€šè¿‡ $40\%$ çš„æ•°æ®<del>ç„¶è€Œæˆ‘å¥½åƒè¿™éƒ¨åˆ†å†™æŒ‚äº†</del>ã€‚</p><p>å¹¶ä¸”è€ƒè™‘ $(1)$ å¼çš„æœ¬è´¨ï¼Œå‘ç°å¦‚æœå­˜åœ¨ $\geqslant 2$ ä¸ªæ•°åœ¨æŸä¸ªäºŒè¿›åˆ¶ä½ä¸Šå‡ä¸º $0$ï¼Œé‚£ä¹ˆä¸€å®šæ˜¯ä¸åˆæ³•çš„ã€‚ æ‰€ä»¥ä¸€ä¸ªä¼˜ç§€çš„å­åºåˆ—ï¼Œå¿…ç„¶æ»¡è¶³äºŒè¿›åˆ¶ä¸‹æ¯ä¸€ä½ï¼Œè‡³å¤šæœ‰ä¸€ä¸ªæ•°ä¸º 1 ã€‚é‚£ä¹ˆè€ƒè™‘æ­¤æ—¶è¿™ä¸ªåºåˆ—çš„å’Œï¼Œåœ¨äºŒè¿›åˆ¶ä¸‹æœ¬è´¨ä¸Šä¸å­˜åœ¨è¿›ä½ã€‚äºæ˜¯å¯ä»¥å‘ç° $f_i$ åŒæ ·ä¹Ÿæ˜¯<strong>å¼‚æˆ–å’Œ</strong>ä¸º $i$ çš„åˆæ³•å­åºåˆ—æ–¹æ¡ˆæ•°ã€‚</p><p>äºæ˜¯è€ƒè™‘å¯¹ç€è¿™ä¸ª dpã€‚å‘ç°å®é™…ä¸Šå­åºåˆ—å¹¶æ²¡æœ‰å®‰æ’åºåˆ—çš„é€‰æ‹©é¡ºåºã€‚äºæ˜¯è€ƒè™‘å¯¹äºæ¯ä¸€ç§å¼‚æˆ–å’Œä¸º $x$ çš„æ–¹æ¡ˆæ•°ï¼Œéƒ½å¯ä»¥åœ¨å…¶ä¸­åŠ å…¥æŸä¸ª $=y$ çš„ä½ç½®ä½¿å¾—å¼‚æˆ–å’Œå˜ä¸º $x \operatorname{xor} y$ ã€‚äºæ˜¯æœ‰è½¬ç§»</p><script type="math/tex;mode=display">
f_i=\sum _{j\subseteq i} f_{i}\cdot \operatorname{count}(i\setminus j)</script><p>å…¶ä¸­ $\operatorname{count}(i)$ è¡¨ç¤º $i$ çš„å‡ºç°æ¬¡æ•°ã€‚</p><p>ä½†æ³¨æ„è¿™æ ·è½¬ç§»å…¶å®æ˜¯è½¬ç§»äº†ä¿©æ–¹å‘ã€‚äºæ˜¯å¯ä»¥åˆ¤æ‰é‚£äº›å’Œ $i$ æœ‰ç›¸åŒ $\rm lowbit$ çš„ $j$ è¿›è¡Œè½¬ç§»ã€‚è®¾ $k=\log_2(\max\{a_i\}) $ï¼Œé‚£ä¹ˆè¿™æ ·åšçš„å¤æ‚åº¦æ˜¯ $O(3^k)$ ã€‚</p><p>ä¹‹åä¸éš¾å‘ç°è¿™å°±æ˜¯ä¸€ä¸ªå­é›†å·ç§¯çš„å½¢å¼ã€‚å¯ä»¥è€ƒè™‘æšä¸¾ $\rm lowbit$ æ¥å®ç°è½¬ç§»ï¼Œå¤æ‚åº¦ $O(2^k\cdot k^2)$ ã€‚ä½†æ˜¯è¿™éƒ¨åˆ†ç¢äºç åŠ›æ¯”è¾ƒå¼±ä»¥åŠå­é›†å·ç§¯èƒŒä¸è¿‡æ‰€ä»¥å¹¶ä¸æ‰“ç®—å†™ã€‚<code>-O2</code> å¥½å•Šã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> cnt = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">bool</span> check[M] ;</span><br><span class="line">ll prime[M] ;</span><br><span class="line"><span class="keyword">int</span> phi[M] ;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(!check[i])&#123;</span><br><span class="line">			phi[i]=i<span class="number">-1</span>;</span><br><span class="line">			prime[cnt++]=i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=cnt;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(prime[j]*i&gt;n)<span class="keyword">break</span>;</span><br><span class="line">			check[i*prime[j]]=<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(i%prime[j]==<span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				phi[i*prime[j]]=prime[j]*phi[i];</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			phi[i*prime[j]]=phi[i]*phi[prime[j]];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line">ll f[N] ;</span><br><span class="line">ll buc[M] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, v ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> res = <span class="number">1</span> ; </span><br><span class="line">	<span class="keyword">while</span> (y)&#123;</span><br><span class="line">		<span class="keyword">if</span> (y &amp; <span class="number">1</span>) res = <span class="number">1l</span>l * res * x % P ; </span><br><span class="line">		x = <span class="number">1l</span>l * x * x % P ; y &gt;&gt;= <span class="number">1</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">low</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> x &amp; -x ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    init(<span class="number">400000</span>) ; gi(n) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        gi(base[i]), buc[base[i]] ++, chkmax(m, base[i]) ;</span><br><span class="line">	f[<span class="number">0</span>] = expow(<span class="number">2</span>, buc[<span class="number">0</span>]) ; <span class="keyword">int</span> o, d, p, q, k ; </span><br><span class="line">    v = <span class="number">1</span> ; <span class="keyword">while</span> (v &lt; m) v &lt;&lt;= <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= v ; ++ i)&#123;</span><br><span class="line">    	o = low(i) ; </span><br><span class="line">		d = log2(o) + <span class="number">1</span> ; </span><br><span class="line">		p = i ^ o ; q = p &gt;&gt; d ; </span><br><span class="line">		add(f[i], f[p] * buc[o] % P) ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = q ; j ; j = (j - <span class="number">1</span>) &amp; q)&#123;</span><br><span class="line">			k = j &lt;&lt; d ; </span><br><span class="line">			<span class="keyword">if</span> (f[p ^ k] &amp;&amp; buc[k ^ o])</span><br><span class="line">			    add(f[i], f[p ^ k] * buc[k ^ o] % P) ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= v ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (f[i]) add(ans, f[i] * phi[<span class="number">1</span> + i] % P) ;</span><br><span class="line">    print(ans), pc(<span class="string">'\n'</span>); <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h1 id="CF-Round-633-Div2-B-Sorted-Adjacent-Differences"><a href="#CF-Round-633-Div2-B-Sorted-Adjacent-Differences" class="headerlink" title="[CF Round#633 (Div2) B] Sorted Adjacent Differences"></a>[CF Round#633 (Div2) B] Sorted Adjacent Differences</h1><blockquote><p>ç»™å®šä¸€ä¸ªåºåˆ— $\{a_n\}$ï¼Œå°†å…¶é‡æ’ä¹‹åä½¿å¾— $|a_1-a_2|\leq |a_2-a_3|\leq |a_3-a_4|\cdots \le |a_{n-1}-a_n|$ã€‚</p></blockquote><p>è¿™é¢˜æ˜¯çœŸçš„ç®€å•ï¼Œä½†æ˜¯æˆ‘å½“æ—¶ vp çš„æ—¶å€™å°±æ˜¯æ„£äº†å¾ˆä¹…â€¦ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆâ€¦æ„Ÿè§‰å°±æ˜¯ç›¯ç€é¢˜ç›®è„‘è¢‹éº»æœ¨åœ°æ‘¸æ¥æ‘¸å»ã€‚</p><p>å¤§æ¦‚æ˜¯è€ƒè™‘æ’ä¸ªåºä¹‹åä»ä¸­é—´å‘ä¸¤è¾¹äº¤æ›¿ç€æ‰«ï¼Œ$n$ æ˜¯å¥‡æ•°ç‰¹åˆ¤ä¸€ä¸‹ $r$ å°±å¥½äº†ã€‚</p><h1 id="CF-Round-633-Div1-B-Edge-Weight-Assignment"><a href="#CF-Round-633-Div1-B-Edge-Weight-Assignment" class="headerlink" title="[CF Round#633 (Div1) B] Edge Weight Assignment"></a>[CF Round#633 (Div1) B] Edge Weight Assignment</h1><blockquote><p>ç»™å®šä¸€æ£µ $n$ ä¸ªç‚¹çš„æ— æ ¹æ ‘ï¼Œè¦æ±‚ç»™æ¯æ¡è¾¹åˆ†é…ä¸€ä¸ªæ­£æ•´æ•°æƒå€¼ï¼Œä½¿å¾—ä»»æ„ä¸¤ä¸ªå¶å­èŠ‚ç‚¹ä¹‹é—´è·¯å¾„ä¸Šçš„è¾¹æƒå¼‚æˆ–å€¼ä¸º $0$ã€‚æ±‚æœ€å°‘è¦å¤šå°‘ç§ä¸åŒæƒå€¼ï¼Œä»¥åŠæœ€å¤šå¯ä»¥ä½¿ç”¨å¤šå°‘ç§ä¸åŒæƒå€¼ã€‚</p><p>è¿™é‡Œå¡«å…¥çš„è¾¹æƒå€¼å¯ä»¥ä¸ºä»»æ„å¤§ã€‚</p><p>$1\leq n\leq 10^5$ ã€‚</p></blockquote><p>æ„Ÿè§‰æœ€å°‘çš„æƒå€¼æ•°é‡è¿˜æ˜¯ä¸éš¾çŒœå‡ºæ¥çš„ã€‚å¤§æ¦‚å°±æ˜¯å¦‚æœä¸¤ä¸¤å¶å­ä¹‹é—´çš„è·ç¦»å‡ä¸ºå¶æ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨ $1$ ä¸ªæƒå€¼ï¼Œå¦åˆ™å¿…é¡»è¦ç”¨ $3$ ä¸ªã€‚ç„¶åè¿™ä¸ªåœ°æ–¹æœ‰ä¸ª trickï¼Œå¤§æ¦‚å°±æ˜¯è¯´å‘ç°æˆ‘ä»¬åªå…³å¿ƒè·ç¦»çš„å¥‡å¶æ€§ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨å¼‚æˆ–æ¥è¡¨ç¤ºè·ç¦»ï¼ŒåŒæ—¶å¼‚æˆ–æœ‰è‡ªåæ€§ï¼Œæ‰€ä»¥åˆ¤æ®å°±å¯ä»¥ç›´æ¥å˜æˆã€ŒæŸä¸ªç‚¹åˆ°å…¶ä»–ç‚¹çš„è·ç¦»ã€å‡ä¸ºå¶æ•°ã€‚é‚£ä¹ˆè¿™å°±å¯ä»¥éšä¾¿é’¦å®šä¸€ä¸ªå¶å­å½“æ ¹ï¼Œç„¶åå»æ¯”è¾ƒæ·±åº¦å³å¯ã€‚</p><p>æœ€å¤šçš„æƒå€¼éœ€è¦ä¸€ç‚¹è´ªå¿ƒã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘ä¸€å®šæ˜¯ä»æ ¹åˆ°å¶å­ $1,2,4,8,16\cdots$ è¿™æ ·ä¸‹æ¥ï¼Œæ¯ä¸ªå¶å­çš„ä¸Šè¡Œè¾¹ç­‰äºç¥–å…ˆçš„å¼‚æˆ–å’Œè¿™ç§æ„Ÿè§‰ã€‚é‚£ä¹ˆè¿™ç§æƒ…å†µå°±éœ€è¦åˆ¤ä¸¤ç‚¹ï¼š</p><p>1ã€å¦‚æœå¤šä¸ªå¶å­æœ‰åŒä¸€ä¸ªçˆ¶äº²ï¼Œé‚£ä¹ˆè¿™äº›å¶å­ä¸€å®šæ˜¯ç›¸åŒçš„æƒå€¼ï¼Œéœ€è¦å‡æ‰ã€‚</p><p>2ã€å¦‚æœæŸå¶å­çš„æ·±åº¦ä¸º $3$ï¼Œé‚£ä¹ˆä»–çš„ä¸Šè¡Œè¾¹å’Œå…¶çˆ¶äº²çš„ä¸Šè¡Œè¾¹æƒå€¼ç›¸åŒï¼Œä¹Ÿéœ€è¦å‡æ‰ã€‚</p><h1 id="CF-Round-633-Div1-D-Nested-Rubber-Bands"><a href="#CF-Round-633-Div1-D-Nested-Rubber-Bands" class="headerlink" title="[CF Round#633 (Div1) D] Nested Rubber Bands"></a>[CF Round#633 (Div1) D] Nested Rubber Bands</h1><blockquote><p>ç»™å®šä¸€æ£µ n ä¸ªç‚¹çš„æ ‘ï¼Œç¬¬ $i$ æ¡è¾¹è¿æ¥ $u_i$ å’Œ $v_i$ã€‚</p><p>ä½ éœ€è¦å°†æ¯ä¸€ä¸ªèŠ‚ç‚¹ç”»æˆä¸€ä¸ªäºŒç»´å¹³é¢ä¸Šé—­åˆå‡ ä½•å›¾å½¢ï¼Œæ»¡è¶³å¦‚æœ $u$ å’Œ $v$ ä¹‹é—´æœ‰è¾¹ç›¸è¿ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç‚¹å¯¹åº”çš„å‡ ä½•å›¾å½¢è¾¹ç•Œç›¸äº¤ï¼ˆæ³¨æ„åŒ…å«ä¸ç®—è¾¹ç•Œç›¸äº¤ï¼‰ã€‚</p><p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåºåˆ— $a_1,a_2,\ldots,a_k$ æ˜¯å¥½çš„ï¼Œå½“ä¸”ä»…å½“å¯¹äºä»»æ„çš„ $2\le i\le k$ï¼Œ$a_{i-1}$ æ‰€å¯¹åº”çš„å‡ ä½•å›¾å½¢å®Œå…¨åŒ…å« $a_i$ æ‰€å¯¹åº”çš„å‡ ä½•å›¾å½¢ã€‚</p><p>æ±‚å¥½çš„åºåˆ—æœ€é•¿å¯ä»¥æ˜¯å¤šå°‘ã€‚</p><p>$n\leq 3\times 10^5$ .</p></blockquote><p>é¢˜æ„æˆ–å¤šæˆ–å°‘æœ‰ç‚¹å¤æ‚ã€‚æ„Ÿè§‰è¿˜æ˜¯å¾ˆè€ƒéªŒè§‚å¯Ÿæ€§è´¨çš„èƒ½åŠ›çš„ã€‚</p><p>å¤§æ¦‚å°±æ˜¯è€ƒè™‘æ€ä¹ˆæ ·çš„ä¸‰ä¸ªç‚¹ $x,y,z$ å¯ä»¥<strong>é¡ºæ¬¡</strong>å‡ºç°åœ¨åºåˆ—ä¸­ï¼Ÿé¦–å…ˆä¸€å®šè¦æ˜¯ $x,y,z$ å½¼æ­¤ä¸ç›¸é‚»ï¼Œä½†è¿™å¹¶ä¸è¶³å¤Ÿã€‚è€ƒè™‘è¿™ä¸ªé™åˆ¶ä¸­å…¶å® $x,z$ åˆ†é‡æ¯”è¾ƒè½»ï¼Œå¯¹äºé¡ºåºæ˜¯å¦æˆç«‹å…³é”®åœ¨äºæ˜¯å¦å¯ä»¥æŠŠ $y$ æ’åœ¨ä¸­é—´ã€‚å‘ç°å¦‚æœ $y$ æƒ³æ—¢å’Œ $x$ æ— äº¤ç‚¹ä½†åŒ…å« $x$ï¼Œå’Œ $z$ æ— äº¤ç‚¹ä½†è¢« $z$ åŒ…å«ã€‚é‚£ä¹ˆé¦–å…ˆä¸éš¾çŸ¥é“å¦‚æœ $x-y-z$ å¯ä»¥æ„æˆä¸€æ¡é“¾é‚£ä¹ˆè¿™æ˜¯å¯ä»¥æˆç«‹çš„ï¼Œå¦‚æœ $y$ ä¸åœ¨ $x-z$ ä¸Šï¼Œé‚£ä¹ˆå°±å¿…é¡»è¦æœ‰ $y$ åˆ° $x-z$ çš„è·ç¦»ä¸º $1$ï¼Œå› ä¸ºå¦‚æœä¸ä¸º $1$ å°±å¿…é¡»è¦åŒ…å«æ›´è¿‘çš„é‚£ä¸ªç‚¹ï¼Œè·Ÿå®šä¹‰å†²çªã€‚</p><p>é‚£ä¹ˆå°±å¯ä»¥å‘ç°æœ€åæ±‚çš„ä¸€å®šæ˜¯ä¸€æ¡é“¾ä¸Šé¢æŒ‚ç€ä¸€äº›è·ç¦»ä¸º $1$ çš„æ•£ç‚¹ï¼Œåœ¨è¿™ä¸ªæ¯›æ¯›è™«ä¸Šæ±‚è§£æœ€å¤§ç‹¬ç«‹é›†ã€‚äºæ˜¯å°±å¯ä»¥è®¾ $f_{i,0/1}$ è¡¨ç¤º $i$ ä½œä¸ºé“¾å¤´æ—¶ï¼Œé€‰/ä¸é€‰ $i$ æ—¶çš„æœ€å¤§æ¯›æ¯›è™«ç‹¬ç«‹é›†ã€‚è½¬ç§»çš„è¯æ¯”è¾ƒç®€å•ï¼Œå¯¹äº $f_{i,0}$ åªéœ€å°† $u$ çš„å…¨éƒ¨éé“¾ä¸Šä¸´ç‚¹åŠ å…¥ç­”æ¡ˆå³å¯ï¼ˆå³ $\deg_x-2$ï¼‰ï¼Œ$f_{i,1}$ å°±æ˜¯ç®€å•ç´¯åŠ ã€‚æ³¨æ„åˆ°è¿™æ˜¯æ±‚çš„å­æ ‘å†…çš„æƒ…å†µï¼Œæœ€åç­”æ¡ˆç”¨å°±æ˜¯</p><script type="math/tex;mode=display">
\max_{e(u,v)\in \mathbb{E}}\{ \max\{f_{u,0}+f_{v,1},f_{u,1}+f_{v,0},f_{u,0}+f_{v,0}\}\}</script><p>å¤æ‚åº¦çº¿æ€§ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    f[x][<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs(y, x) ;</span><br><span class="line">        chkmax(ans, f[x][<span class="number">1</span>] + f[y][<span class="number">0</span>]) ;</span><br><span class="line">        chkmax(ans, f[x][<span class="number">0</span>] + f[y][<span class="number">0</span>]) ;</span><br><span class="line">        chkmax(ans, f[x][<span class="number">0</span>] + f[y][<span class="number">1</span>]) ;</span><br><span class="line">        chkmax(f[x][<span class="number">0</span>], max(f[y][<span class="number">1</span>], f[y][<span class="number">0</span>]) + deg[x] - <span class="number">2</span>) ;</span><br><span class="line">        chkmax(f[x][<span class="number">1</span>], f[y][<span class="number">0</span>] + <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    debug(f[x][1], ' '), debug(f[x][0]) ;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="CF-Round-399-Combined-C-Jon-Snow-and-his-Favourite-Number"><a href="#CF-Round-399-Combined-C-Jon-Snow-and-his-Favourite-Number" class="headerlink" title="[CF Round#399(Combined) C] Jon Snow and his Favourite Number"></a>[CF Round#399(Combined) C] Jon Snow and his Favourite Number</h1><blockquote><p>ä½ æœ‰ä¸€ä¸²é•¿åº¦ä¸º $n$ çš„åºåˆ— $a$ï¼Œé‡å¤ $k$ æ¬¡æ“ä½œã€‚é—®æ“ä½œåçš„åºåˆ—çš„æå€¼ã€‚</p><p>æ“ä½œ: å°†åºåˆ—ä»å°åˆ°å¤§æ’åº,ä» $1$ æ ‡å·,å¯¹åºå·ä¸ºå¥‡æ•°çš„æ•° <code>^(xor)</code> $x$.</p><p>$n\leq 10^5,k\leq 10^3$ã€‚</p></blockquote><p>æ‰“ä¸ªè¡¨å‘ç°æœ‰å¾ªç¯èŠ‚ï¼Œç„¶åæˆ‘å°± naive åœ°è§‰å¾—å¾ªç¯èŠ‚å¤§å°ä¸€å®šæ˜¯ $2$ å¯¼è‡´çˆ†äº† OJã€‚</p><p>å‘ç°å¾ªç¯èŠ‚çš„é•¿åº¦ä¸ä¼šè¶…è¿‡ $200$ã€‚äºæ˜¯å°±å¯ä»¥æš´åŠ› $200$ æ¬¡æ‰¾å‡ºå¾ªç¯èŠ‚æ¥ç„¶ååšã€‚è¿™æ ·çš„å¤æ‚åº¦æ˜¯ $O(200\cdot n)$ çš„ã€‚</p><p>å…³äºå¾ªç¯èŠ‚ï¼Œä¸ªäººçš„ç†è§£ä»…é™äº <code>xor</code> è¿ç®—æœ‰è‡ªåæ€§ï¼Œæ‰€ä»¥æ˜¾ç„¶å¾ªç¯èŠ‚åº”è¯¥æ˜¯å¶æ•°é•¿åº¦çš„ã€‚</p><p>â€¦ä¸ä¼šç¼–äº†ã€‚å°±å½“æ˜¯ä¸€ä¸ªä¹±æå§= =</p><h1 id="CF-Round-399-Combined-G-The-Winds-of-Winter"><a href="#CF-Round-399-Combined-G-The-Winds-of-Winter" class="headerlink" title="[CF Round#399(Combined) G] The Winds of Winter"></a>[CF Round#399(Combined) G] The Winds of Winter</h1><blockquote><p>ç»™å®šä¸€æ£µæœ‰æ ¹æ ‘ã€‚è‹¥åˆ å»ä¸€ä¸ªèŠ‚ç‚¹å’Œæ‰€æœ‰ä¸ä»–ç›¸è¿çš„è¾¹ï¼Œåˆ™ä¼šå¾—åˆ°ä¸€ä¸ªæ£®æ—ã€‚ä½ å¸Œæœ›è¿™ä¸ªæ£®æ—ä¸­èŠ‚ç‚¹æœ€å¤šçš„æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°å°½é‡å°‘ï¼Œäºæ˜¯ä½ å¯ä»¥è¿›è¡Œè‡³å¤šä¸€æ¬¡å¦‚ä¸‹æ“ä½œï¼š</p><p>åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹å’Œå…¶çˆ¶äº²ä¹‹é—´çš„è¾¹ï¼ŒæŠŠè¿™ä¸ªèŠ‚ç‚¹è¿åˆ°æŸä¸ªèŠ‚ç‚¹ä¸Šã€‚è¿™ä¸ªæ“ä½œä¸å¾—æ”¹å˜æ£®æ—ä¸­æ ‘çš„ä¸ªæ•°ã€‚</p><p>å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œè¾“å‡ºå®ƒä½œä¸ºåˆ å»çš„èŠ‚ç‚¹æ—¶ï¼Œè¿›è¡Œè‡³å¤šä¸€æ¬¡æ“ä½œåçš„æœ€å¤§æ ‘å¤§å°çš„æœ€å°å€¼ã€‚</p><p>è¾“å…¥æ ¼å¼ä¸­ï¼Œä¸€æ¡è¾¹çš„ä¸€ä¸ªç«¯ç‚¹æ˜¯ $0$ è¯´æ˜å¦ä¸€ä¸ªç«¯ç‚¹æ˜¯æ ¹ã€‚</p><p>$1\leq n\leq 3\times 10^5$ ã€‚</p></blockquote><p>é¦–å…ˆå¯ä»¥å‘ç°ï¼Œè¿™ä¸ªæ“ä½œæ˜¯å…·æœ‰è´ªå¿ƒæ€§è´¨çš„ã€‚å¿…ç„¶æ˜¯ä» $x$ åˆ†å‡ºçš„æœ€å¤§ size è¿é€šå—é‡Œæ‰¾å‡ºä¸€æ£µå­æ ‘è¿æ¥åˆ°æœ€å°çš„ size çš„è¿é€šå—é‡Œã€‚é‚£ä¹ˆæœ€åç­”æ¡ˆå°±æ˜¯</p><script type="math/tex;mode=display">
\max\{size_p-\zeta,size_q+\zeta,size_o\}</script><p>å…¶ä¸­ $p$ æ˜¯æœ€å¤§çš„è¿é€šå—ï¼Œ $q$ æ˜¯æœ€å°çš„è¿é€šå—ï¼Œ$o$ æ˜¯æ¬¡å¤§è¿é€šå—ï¼Œ$\zeta$ æ˜¯æ‘˜ä¸‹æ¥çš„å­æ ‘ã€‚é‚£ä¹ˆä¸éš¾çŸ¥é“è¿™ä¸ªä¸œè¥¿æ˜¯å‡¸çš„ã€‚é‚£ä¹ˆå°±è€ƒè™‘å»äºŒåˆ†è¿™ä¸ª $ans$ ï¼Œ$check$ çš„æ—¶å€™è‡ªç„¶éœ€è¦æ»¡è¶³</p><script type="math/tex;mode=display">
\begin{aligned}
size_p-\zeta&\leq ans\\
size_q+\zeta&\leq ans\\
size_o&\leq ans
\end{aligned}</script><p>è€ƒè™‘æœ€åä¸€ä¸ªæ˜¯å®šå€¼ï¼Œäºæ˜¯å¯ä»¥ç›´æ¥è®¾æˆäºŒåˆ†çš„ä¸‹ç•Œã€‚è§‚å¯Ÿå‰é¢ä¸¤ä¸ªï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åœ¨æŸ¥å‘¨å›´åˆ†å‡ºå»çš„è¿é€šå—é‡Œæ˜¯å¦å­˜åœ¨ä¸€ä¸ªå¤§å°åˆé€‚çš„å­æ ‘ $\zeta$ã€‚äºæ˜¯å°±å˜æˆäº†ä¸€ä¸ªæ‹¿ <code>mulity-set</code> ç»´æŠ¤ dsu on tree çš„ç›´è§‚é¢˜ç›®ã€‚</p><p>ç»´æŠ¤èµ·æ¥æœ‰äº›éº»çƒ¦ã€‚è€ƒè™‘æŒ‰ç…§ dfs åºåˆ†åˆ«ç»´æŠ¤è‡ªå·±å­æ ‘å†…çš„ã€ç¥–å…ˆé“¾ä¸Šçš„ã€ç¥–å…ˆé™¤äº†è‡ªå·±ä»¥å¤–çš„é‚£äº›å­å­™ã€‚åé¢ä¸¤ä¸ªå¯ä»¥ä¸æ–­è¾¹æ’è¾¹åˆ æ¥åšï¼Œè€Œè‡ªå·±å­æ ‘å†…çš„åˆ™å¯ä»¥è€ƒè™‘ç”±äºä¿¡æ¯é‡å¤ç‡å¤§ï¼Œæ‰€ä»¥é‡‡ç”¨å¯å‘å¼åˆ†æ²»(å¯å‘å¼åˆå¹¶)ç­–ç•¥â€”â€”ç»“åˆè½»é‡é“¾å‰–åˆ†çš„ç†è®ºï¼Œå› ä¸ºä»æ ¹åˆ°æ¯ä¸ªç‚¹è‡³å¤šç»è¿‡ $\log n$ æ¡è½»è¾¹ï¼Œæ‰€ä»¥è€ƒè™‘æ¯ä¸ªç‚¹éƒ½åªå‘è‡ªå·±çš„è½»ç¥–å…ˆè´¡çŒ®ã€‚é‚£ä¹ˆè¿‡ç¨‹å°±æ˜¯å…ˆåˆ†æ²»è½»å„¿å­å¹¶ä¸”æ¸…ç©ºè´¡çŒ®ï¼Œç„¶åæš´åŠ›é‡å„¿å­ï¼Œå†å°†è½»å„¿å­åˆå¹¶åˆ°é‡å„¿å­çš„ä¿¡æ¯é‡Œã€‚é€šè¿‡èšå’Œåˆ†æä¸éš¾çŸ¥é“è¿™æ ·æ˜¯ $O(n\log n)$ çš„ã€‚è¿™ä¹Ÿå°±æ˜¯ dsu on tree çš„è¿‡ç¨‹ã€‚</p><p>æœ€åæœ‰ç‚¹ç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œå¤§æ¦‚å°±æ˜¯ä»€ä¹ˆç‰¹åˆ¤ $p=q$ ä¹‹ç±»çš„ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */</span></span><br><span class="line"></span><br><span class="line">sint other ;</span><br><span class="line">sint dads ;</span><br><span class="line">sint s[N] ;</span><br><span class="line">vint E[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> rt ;</span><br><span class="line"><span class="keyword">int</span> sz[N] ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">int</span> mx[N] ;</span><br><span class="line"><span class="keyword">int</span> mn[N] ;</span><br><span class="line"><span class="keyword">int</span> smx[N] ;</span><br><span class="line"><span class="keyword">int</span> son[N] ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> dad)</span></span>&#123;</span><br><span class="line">    fa[x] = dad ; sz[x] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> k : E[x])</span><br><span class="line">        <span class="keyword">if</span> (k != dad)&#123;</span><br><span class="line">            dfs(k, x) ;</span><br><span class="line">            sz[x] += sz[k] ;</span><br><span class="line">            <span class="keyword">if</span> (!son[x]) son[x] = k ;</span><br><span class="line">            <span class="keyword">if</span> (sz[son[x]] &lt; sz[k]) son[x] = k ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (x != rt)</span><br><span class="line">        other.ins(sz[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isrt</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">bool</span>)(x == rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; v &lt;&lt; " " &lt;&lt; x &lt;&lt; " " &lt;&lt; mx[x] &lt;&lt; " " &lt;&lt; mn[x] &lt;&lt; " " &lt;&lt; sz[x] &lt;&lt; " " &lt;&lt; son[x] &lt;&lt; " " &lt;&lt; s[x].size() &lt;&lt; '\n' ;</span></span><br><span class="line">    <span class="keyword">if</span> (mx[x] == sz[son[x]])&#123;</span><br><span class="line">        <span class="keyword">auto</span> t = s[x].lwb(mx[x] - v) ;</span><br><span class="line">        <span class="keyword">if</span> (t != s[x].js() &amp;&amp; *t &lt;= v - mn[x]) <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">auto</span> t = other.lwb(mx[x] - v) ;</span><br><span class="line">        <span class="keyword">if</span> (t != other.js() &amp;&amp; (*t) &lt;= v - mn[x]) <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">auto</span> pq = dads.lwb(mx[x] - v + sz[x]) ;</span><br><span class="line">        <span class="keyword">if</span> (pq != dads.js() &amp;&amp; (*pq) &lt;= v - mn[x] + sz[x]) <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">//mn[x] + x &lt;= ans -&gt; x &lt;= ans - mn[x]</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">//    debug(x, ' ') ;</span></span><br><span class="line"><span class="comment">//    debug(other.size(), ' ') ;</span></span><br><span class="line"><span class="comment">//    debug(s[x].size(), ' ') ;</span></span><br><span class="line"><span class="comment">//    debug(dads.size()) ;</span></span><br><span class="line">    <span class="keyword">if</span> (!isrt(x))&#123;</span><br><span class="line">        other.era(other.fd(sz[x])) ;</span><br><span class="line">        <span class="keyword">if</span> (!isrt(fa[x])) dads.ins(sz[fa[x]]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    mn[x] = n - sz[x] ;</span><br><span class="line">    mx[x] = max(n - sz[x], sz[son[x]]) ;</span><br><span class="line">    smx[x] = min(n - sz[x], sz[son[x]]) ;</span><br><span class="line"><span class="comment">//    debug(x, '*') ;</span></span><br><span class="line"><span class="comment">//    debug(mn[x], '*') ;</span></span><br><span class="line"><span class="comment">//    debug(mx[x], '*') ;</span></span><br><span class="line"><span class="comment">//    debug(smx[x], '\n') ;// puts("")</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> k : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (k == fa[x]) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">if</span> (k == son[x]) <span class="keyword">continue</span> ;</span><br><span class="line">        solve(k) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> t : s[k]) other.ins(t) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (son[x])&#123;</span><br><span class="line">        solve(son[x]) ;</span><br><span class="line">        swap(s[x], s[son[x]]) ;</span><br><span class="line">        chkmin(mn[x], sz[son[x]]) ;</span><br><span class="line">        <span class="keyword">if</span> (!mn[x]) mn[x] = sz[son[x]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> k : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (k == fa[x]) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">if</span> (k == son[x]) <span class="keyword">continue</span> ;</span><br><span class="line">        chkmin(mn[x], sz[k]) ;</span><br><span class="line">        chkmax(smx[x], sz[k]) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> t : s[k])</span><br><span class="line">            other.era(other.find(t)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> l = smx[x], r = mx[x], mid ;</span><br><span class="line">    <span class="keyword">if</span> (smx[x] == mx[x]) <span class="keyword">goto</span> ycy ;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">if</span> (!chk(mid, x)) l = mid + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">else</span> ans[x] = mid, r = mid - <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    ycy : <span class="keyword">if</span> (!ans[x]) ans[x] = mx[x] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> k : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (k == fa[x]) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">if</span> (k == son[x]) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> t : s[k]) s[x].ins(t) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!isrt(x) &amp;&amp; !isrt(fa[x]))</span><br><span class="line">        dads.era(dads.fd(sz[fa[x]])) ;</span><br><span class="line">    s[x].ins(sz[x]) ;</span><br><span class="line"><span class="comment">//    debug(x, ' ') ;</span></span><br><span class="line"><span class="comment">//    debug(other.size(), ' ') ;</span></span><br><span class="line"><span class="comment">//    debug(s[x].size(), ' ') ;</span></span><br><span class="line"><span class="comment">//    debug(dads.size()) ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; k &lt;= n ; ++ k)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[k]) ; <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; <span class="keyword">int</span> x, y ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        x = qr(), y = qr() ;</span><br><span class="line">        <span class="keyword">if</span> (!x || !y) rt = x + y ;</span><br><span class="line">        <span class="keyword">else</span> E[x].p_b(y), E[y].p_b(x) ;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(rt, <span class="number">0</span>) ;</span><br><span class="line"><span class="comment">//    debug(son, 1, n) ;</span></span><br><span class="line"><span class="comment">//    debug(sz, 1, n) ;</span></span><br><span class="line">    solve(rt) ;</span><br><span class="line">    output() ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84DP/" rel="tag"><i class="fa fa-tag"></i> åŠ¨æ€è§„åˆ’/æœ‰æŠ€å·§çš„DP</a><a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E8%87%AA%E5%8A%A8%E6%9C%BA%E4%B8%8ADP/" rel="tag"><i class="fa fa-tag"></i> åŠ¨æ€è§„åˆ’/è‡ªåŠ¨æœºä¸ŠDP</a><a href="/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/" rel="tag"><i class="fa fa-tag"></i> æ€ç»´é¢˜/æ‰¾æ€§è´¨</a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/" rel="tag"><i class="fa fa-tag"></i> æ•°æ®ç»“æ„/æ ‘çŠ¶æ•°ç»„</a><a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%99%AE%E9%80%9ADP/" rel="tag"><i class="fa fa-tag"></i> åŠ¨æ€è§„åˆ’/æ™®é€šDP</a><a href="/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E5%AE%B9%E6%96%A5/" rel="tag"><i class="fa fa-tag"></i> æ€ç»´é¢˜/å®¹æ–¥</a><a href="/tags/%E8%B4%AA%E5%BF%83/" rel="tag"><i class="fa fa-tag"></i> è´ªå¿ƒ</a><a href="/tags/%E6%A0%91%E4%B8%8A%E6%8A%80%E5%B7%A7-dsu-on-tree/" rel="tag"><i class="fa fa-tag"></i> æ ‘ä¸ŠæŠ€å·§/dsu on tree</a><a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%A0%91%E5%BD%A2DP/" rel="tag"><i class="fa fa-tag"></i> åŠ¨æ€è§„åˆ’/æ ‘å½¢DP</a><a href="/tags/%E6%95%B0%E5%AD%A6-%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0-%E7%9F%A9%E9%98%B5/" rel="tag"><i class="fa fa-tag"></i> æ•°å­¦/çº¿æ€§ä»£æ•°/çŸ©é˜µ</a><a href="/tags/%E6%8A%80%E5%B7%A7-%E6%8C%89%E4%BD%8D%E6%93%8D%E4%BD%9C/" rel="tag"><i class="fa fa-tag"></i> æŠ€å·§/æŒ‰ä½æ“ä½œ</a><a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2-%E5%AD%90%E5%BA%8F%E5%88%97%E8%87%AA%E5%8A%A8%E6%9C%BA/" rel="tag"><i class="fa fa-tag"></i> å­—ç¬¦ä¸²/å­åºåˆ—è‡ªåŠ¨æœº</a><a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2-Z-Algorithm/" rel="tag"><i class="fa fa-tag"></i> å­—ç¬¦ä¸²/Z-Algorithm</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2020/05/16/%E5%9B%9B%E5%A4%84%E7%9E%8E%E5%AD%A6%E4%B8%9C%E8%A5%BF%E7%9A%84%E7%AC%94%E8%AE%B0/" rel="next" title="ã€å­¦ä¹ ç¬”è®°ã€‘å››å¤„çå­¦ä¸œè¥¿çš„ç¬”è®°"><i class="fa fa-chevron-left"></i> ã€å­¦ä¹ ç¬”è®°ã€‘å››å¤„çå­¦ä¸œè¥¿çš„ç¬”è®°</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/2020/05/25/APIO2019/" rel="prev" title="ã€èµ›é¢˜æ•´ç†ã€‘APIO2019 ç®€è¦é¢˜è§£">ã€èµ›é¢˜æ•´ç†ã€‘APIO2019 ç®€è¦é¢˜è§£<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><div style=""><canvas id="canvas" style="width:60%">å½“å‰æµè§ˆå™¨ä¸æ”¯æŒcanvasï¼Œè¯·æ›´æ¢æµè§ˆå™¨åå†è¯•</canvas></div><script>!function(){var t,o=[[[0,0,1,1,1,0,0],[0,1,1,0,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,0,1,1,0],[0,0,1,1,1,0,0]],[[0,0,0,1,1,0,0],[0,1,1,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[1,1,1,1,1,1,1]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,0,0,1,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,0,1,1,1,0],[0,0,1,1,1,1,0],[0,1,1,0,1,1,0],[1,1,0,0,1,1,0],[1,1,1,1,1,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,1,1]],[[1,1,1,1,1,1,1],[1,1,0,0,0,0,0],[1,1,0,0,0,0,0],[1,1,1,1,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[1,1,1,1,1,1,1],[1,1,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,1,1,0,0,0,0]],[[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0]]],e=document.getElementById("canvas");if(e.getContext){var l=e.getContext("2d");e.height=100,e.width=700,l.fillStyle="#f00",l.fillRect(10,10,50,50);var r=[],f=[],i=e.height/20-1;function n(t,e){for(var n=0;n<o[e].length;n++)for(var a=0;a<o[e][n].length;a++)1==o[e][n][a]&&(l.beginPath(),l.arc(14*(i+2)*t+2*a*(i+1)+(i+1),2*n*(i+1)+(i+1),i,0,2*Math.PI),l.closePath(),l.fill())}function h(t,e){for(var n=[1,2,3],a=["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"],l=0;l<o[e].length;l++)for(var r=0;r<o[e][l].length;r++)if(1==o[e][l][r]){var h={x:14*(i+2)*t+2*r*(i+1)+(i+1),y:2*l*(i+1)+(i+1),stepX:Math.floor(4*Math.random()-2),stepY:-2*n[Math.floor(Math.random()*n.length)],color:a[Math.floor(Math.random()*a.length)],disY:1};f.push(h)}}t=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date),r.push(t[1],t[2],10,t[3],t[4],10,t[5],t[6]),clearInterval(a);var a=setInterval(function(){!function(){var t=[],e=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date),n=[];n.push(e[1],e[2],10,e[3],e[4],10,e[5],e[6]);for(var a=r.length-1;0<=a;a--)n[a]!==r[a]&&t.push(a+"_"+(Number(r[a])+1)%10);for(a=0;a<t.length;a++)h.apply(this,t[a].split("_"));r=n.concat()}(),function(){for(var t=0;t<f.length;t++)f[t].stepY+=f[t].disY,f[t].x+=f[t].stepX,f[t].y+=f[t].stepY,(f[t].x>700+i||f[t].y>100+i)&&(f.splice(t,1),t--)}(),function(){e.height=100;for(var t=0;t<r.length;t++)n(t,r[t]);for(t=0;t<f.length;t++)l.beginPath(),l.arc(f[t].x,f[t].y,i,0,2*Math.PI),l.fillStyle=f[t].color,l.closePath(),l.fill()}()},50)}}()</script><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> Table of Contents</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> Overview</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Orchidany"><p class="site-author-name" itemprop="name">Orchidany</p><div class="site-description motion-element" itemprop="description">For code, science, tech. and more</div></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/%20%7C%7C%20archive"><span class="site-state-item-count">182</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/%20%7C%7C%20th"><span class="site-state-item-count">55</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/%20%7C%7C%20tags"><span class="site-state-item-count">137</span> <span class="site-state-item-name">tags</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ç¾å›¢æ¯-2020-æµ‹è¯•èµ›-A-å­åºåˆ—"><span class="nav-number">1.</span> <span class="nav-text">[ç¾å›¢æ¯ 2020 æµ‹è¯•èµ› A] å­åºåˆ—</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CF-Edu-Round-87-C1-C2-Polygon-Embedding"><span class="nav-number">2.</span> <span class="nav-text">[CF Edu Round#87 C1&#x2F;C2] Polygon Embedding</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CF-Edu-Round-87-F-Summoning-Minions"><span class="nav-number">3.</span> <span class="nav-text">[CF Edu Round#87 F] Summoning Minions</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Sol-1"><span class="nav-number">3.1.</span> <span class="nav-text">Sol 1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sol-2"><span class="nav-number">3.2.</span> <span class="nav-text">Sol 2</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CF-Round-622-Div2-E-Concatenation-with-intersection"><span class="nav-number">4.</span> <span class="nav-text">[CF Round#622(Div2) E] Concatenation with intersection</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CF-MOI-Round-626-Div1-B-Present"><span class="nav-number">5.</span> <span class="nav-text">[CF MOI Round#626(Div1) B] Present</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CF-MOI-Round-626-Div1-C-Instant-Noodles"><span class="nav-number">6.</span> <span class="nav-text">[CF MOI Round#626(Div1) C] Instant Noodles</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CF-MOI-Round-626-Div1-D-Reality-Show"><span class="nav-number">7.</span> <span class="nav-text">[CF MOI Round#626(Div1) D] Reality Show</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#NOI-Online-3-B-é­”æ³•å€¼"><span class="nav-number">8.</span> <span class="nav-text">[NOI Online #3 B] é­”æ³•å€¼</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#NOI-Online-3-C-ä¼˜ç§€å­åºåˆ—"><span class="nav-number">9.</span> <span class="nav-text">[NOI Online #3 C] ä¼˜ç§€å­åºåˆ—</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CF-Round-633-Div2-B-Sorted-Adjacent-Differences"><span class="nav-number">10.</span> <span class="nav-text">[CF Round#633 (Div2) B] Sorted Adjacent Differences</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CF-Round-633-Div1-B-Edge-Weight-Assignment"><span class="nav-number">11.</span> <span class="nav-text">[CF Round#633 (Div1) B] Edge Weight Assignment</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CF-Round-633-Div1-D-Nested-Rubber-Bands"><span class="nav-number">12.</span> <span class="nav-text">[CF Round#633 (Div1) D] Nested Rubber Bands</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CF-Round-399-Combined-C-Jon-Snow-and-his-Favourite-Number"><span class="nav-number">13.</span> <span class="nav-text">[CF Round#399(Combined) C] Jon Snow and his Favourite Number</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CF-Round-399-Combined-G-The-Winds-of-Winter"><span class="nav-number">14.</span> <span class="nav-text">[CF Round#399(Combined) G] The Winds of Winter</span></a></li></ol></div></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2020</span><span class="with-love" id="animate"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">ğ’ªğ“‡ğ’¸ğ’½ğ’¾ğ’¹ğ’¶ğ“ƒğ“</span></div><div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.0</div> <span class="post-meta-divider">|</span><div class="theme-info">Theme â€“ <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.2.0</div><div class="theme-info"><div class="powered-by"></div> <span class="post-count">åšå®¢å…¨ç«™å…±431.4kå­—</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="Total Visitors"><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="Total Views"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script src="/lib/jquery/index.js?v=3.4.1"></script><script src="/lib/fancybox/source/jquery.fancybox.pack.js"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/js/utils.js?v=7.2.0"></script><script src="/js/motion.js?v=7.2.0"></script><script src="/js/affix.js?v=7.2.0"></script><script src="/js/schemes/pisces.js?v=7.2.0"></script><script src="/js/scrollspy.js?v=7.2.0"></script><script src="/js/post-details.js?v=7.2.0"></script><script src="/js/next-boot.js?v=7.2.0"></script><script type="text/x-mathjax-config">
  

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });
  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') { next = next.nextSibling }
        if (next && next.nodeName.toLowerCase() === 'br') { next.parentNode.removeChild(next) }
      }
    });
  });
</script><script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      document.getElementById(all[i].inputID + '-Frame').parentNode.className += ' has-jax';
    }
  });
</script><script src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script><script>$("body").find("div.pdf").length&&$.ajax({type:"GET",url:"//cdn.jsdelivr.net/npm/pdfobject@2/pdfobject.min.js",dataType:"script",cache:!0,success:function(){$("body").find("div.pdf").each(function(e,t){PDFObject.embed($(t).attr("target"),$(t),{pdfOpenParams:{navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"},PDFJS_URL:"/lib/pdf/web/viewer.html",height:$(t).attr("height")||"500px"})})}})</script><script>
// GET RESPONSIVE HEIGHT PASSED FROM IFRAME

window.addEventListener("message", function(e) {
  var data = e.data;
  if ((typeof data === 'string') && (data.indexOf('ciu_embed') > -1)) {
    var featureID = data.split(':')[1];
    var height = data.split(':')[2];
    $(`iframe[data-feature=${featureID}]`).height(parseInt(height) + 30);
  }
}, false);
</script><script>!function(e){var c=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){for(var r=0;r<c.length;r++)0<=(t=c[r].getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=c[r];t=o,n=function(){c=c.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n()},e.src=i}();var t}i(),e.addEventListener("scroll",function(){var t,n;t=i,n=e,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)})}(this)</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script></body></html>