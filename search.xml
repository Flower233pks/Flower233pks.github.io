<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>éšæƒ³ Â· ç›®æ¬¡è¡¨</title>
    <url>/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç»ˆäºåˆå¼€å§‹äº†ã€‚</p>
<a id="more"></a>
<p>æˆ‘æ˜¯èŠ±ï¼Œä¸€ä¸ªä¸ç†æ™ºçš„$\rm{Oier}$ã€‚æˆ‘ä¹Ÿæƒ³æ¯å¤©24å°æ—¶æ‹¼å‡º48å°æ—¶çš„æ•ˆç‡ä¸€å¿ƒåšé¢˜ï¼Œä½†æ˜¯æˆ‘åšä¸åˆ°ï¼Œæˆ‘è¡€æ¶²ä¸­å‡ç»“ç€çš„ï¼Œåœ¨å‚¬ä¿ƒæˆ‘å†™ä¸‹æ¥ï¼Œå¿…é¡»è¦å†™ä¸‹æ¥ã€‚</p>
<p>åœ¨è¿™äº›æ–‡ç« é‡Œï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªè¿·èŒ«çš„é’å¹´å¦‚ä½•æ»¡æ€€çƒ­è¡€ä¸ç»æœ›ï¼Œçœ¼é‡Œé—ªçƒç€æ²§æ¡‘ä¸å¸Œæœ›ï¼Œæ€€é‡Œæ£ç€åæ‰çš„ç²®é£Ÿå’Œå´­æ–°çš„è®ºæ–‡ï¼Œè„šä¸‹è¸ç€å´å²–ä¸å¹³çš„è·¯ï¼Œå‘æ˜å¤©èµ°å»ã€‚</p>
<p>æ˜¯çš„ï¼Œæˆ‘æ˜¯èŠ±ï¼Œæ¥è‡ªå±±ä¸œï¼Œä½ ç›´æ¥å«æˆ‘èŠ±è¿™ä¸ªIDæˆ–è®¸æˆ‘ä¼šå¾ˆé«˜å…´ï¼Œä½†æ˜¯å¦‚æœä½ è®¤è¯†æˆ‘ä¹Ÿå¯ä»¥ä¸è¿™ä¹ˆæ‹˜æŸã€‚</p>

        <div id="aplayer-Sczowyap" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">
            <pre class="aplayer-lrc-content"></pre>
        </div>
        <script>
          var ap = new APlayer({
            element: document.getElementById("aplayer-Sczowyap"),
            narrow: false,
            autoplay: false,
            showlrc: false,
            music: {
              title: "èŠ±",
              author: "Hello Nico",
              url: "Hello Nico-èŠ±.flac",
              pic: "/2050/12/31/éšæƒ³Â·ç›®æ¬¡è¡¨/qwq.png",
              lrc: ""
            }
          });
          window.aplayers || (window.aplayers = []);
          window.aplayers.push(ap);
        </script>
<p>ä»¥ä¸‹æ˜¯ç›®å½•ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">ç¯‡ç›®</th>
<th style="text-align:center">é“¾æ¥ï¼ˆç‚¹å‡»å³å¯ï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">éšæƒ³ä¸€ Â· å±±ä¸˜</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2018/08/02/%E9%9A%8F%E6%83%B3%E4%B8%80/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">éšæƒ³äºŒ Â· ä¸˜å‰å°”</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2018/08/08/%E9%9A%8F%E6%83%B3%E4%BA%8C/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">éšæƒ³ä¸‰ Â· æœ¬èµ›å­£æœ€åçš„éšæƒ³/å¯ç¤ºå½•</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2019/02/14/%E9%9A%8F%E6%83%B3%E4%B8%89%C2%B7NOIP/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">éšæƒ³å›› Â· æ•…äºº</td>
<td style="text-align:center"><a href="[https://www.orchidany.cn/2019/03/01/%E9%9A%8F%E6%83%B3%E5%9B%9B%C2%B7%E6%95%85%E4%BA%BA/](https://www.orchidany.cn/2019/03/01/éšæƒ³å››Â·æ•…äºº/">$Link$</a>)</td>
</tr>
<tr>
<td style="text-align:center">éšæƒ³äº” Â· æ‰‹ä¸­æ²¡æœ‰çº¢ç«ç‘°</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2019/02/14/%E9%9A%8F%E6%83%B3%E4%BA%94%C2%B7%E6%83%85%E4%BA%BA%E8%8A%82/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">éšæƒ³å…­ Â· éš¾</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2019/03/10/%E9%9A%8F%E6%83%B3%E5%85%AD%C2%B7Hard/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">éšæƒ³ä¸ƒ Â· è¨€å¶ä¹‹åº­</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2019/03/28/%E9%9A%8F%E6%83%B3%E4%B8%83%C2%B7%E8%A8%80%E5%8F%B6%E4%B9%8B%E5%BA%AD/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">éšæƒ³å…« Â· é€ƒå§</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2019/06/11/8/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">éšæƒ³ä¹ Â· æ„ä¹‰</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2019/07/18/Nine/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">éšæƒ³å Â· ç¹æ˜Ÿ</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2019/08/20/10/">$Link$</a></td>
</tr>
</tbody>
</table>
</div>
<p>ç¬¬ä¸€ç¯‡å¤§æ¦‚æ˜¯å¼€å§‹ï¼Ÿ</p>
<p>ç¬¬äºŒç¯‡å¤§æ¦‚æ˜¯åœ¨è€æ ¡æœºæˆ¿å†™çš„ã€‚å½“æ—¶è‡ªå·±å’Œå‘¨å›´äººçš„å…³ç³»å¹¶ä¸å¥½ã€‚</p>
<p>ç¬¬ä¸‰ç¯‡å°±æ˜¯2018è€ƒå®ŒNOIPå†™çš„å•¦ã€‚</p>
<p>ç¬¬å››ç¯‡ç”±äºä¸ªäººååˆ†å–œçˆ±å›å¿†å¾€äº‹ï¼Œæ‰€ä»¥æ˜¯æ¯”è¾ƒé‡è¦çš„ä¸€ç¯‡ï¼Œä½†ç°åœ¨è¿˜æ²¡æœ‰æ›´å®Œã€‚ï¼ˆå› ä¸ºè¦è¯´çš„å¤ªå¤šäº†</p>
<p>ç¬¬äº”ç¯‡æ˜¯è°ˆæ„Ÿæƒ…çš„å•¦ï¼Œä¼¼ä¹æ˜¯æ¯”è¾ƒå‡ºåçš„ä¸€ç¯‡(?)</p>
<p>ç¬¬å…­ç¯‡å¤§æ¦‚æ˜¯çå†™çš„ã€‚å¦‚æœæ¯æ¬¡è§‰å¾—å¾ˆéš¾éƒ½è¦å†™ä¸€ç¯‡ï¼Œé‚£ä¼°è®¡åªæœ‰ä¸“èŒä½œå®¶æ‰èƒ½å†™å®Œã€‚</p>
<p>ç¬¬ä¸ƒç¯‡å¤§æ¦‚æ˜¯çœ‹å®Œã€Šè¨€å¶ä¹‹åº­ã€‹å°±ç«‹å³åœ¨æœºæˆ¿å†™çš„ï¼Œä»£è¡¨çš„å¤§æ¦‚æ˜¯æˆ‘ç†æƒ³ä¸­çˆ±æƒ…çš„æ¨¡æ ·å§ã€‚</p>
<p>ç¬¬å…«ç¯‡ä¹Ÿå¾ˆé‡è¦ï¼Œæˆ‘çš„å…¨éƒ¨å‹æŠ‘æƒ…ç»ªéƒ½ä¼šå†™è¿›å»ã€‚å½“ç„¶ï¼Œå’Œç¬¬å››ç¯‡ä¸€æ ·ï¼Œè¦è¯´çš„è¯å¤ªå¤šäº†ï¼Œæ‰€ä»¥å†™ä¸å®Œ/kk</p>
<p>ç¬¬ä¹ç¯‡å¤§æ¦‚æ˜¯ã€Œå¥‡å¼‚äººç”Ÿã€çš„è¯»/è§‚åæ„Ÿï¼Ÿ</p>
<p>æœ€åä¸€ç¯‡â€¦æ˜¯ç§˜å¯†ï¼</p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>éšæƒ³/ä¸‹ä¸‹ç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å…¬å‘Šã€‘å…³äºè¿™ä¸ªblog</title>
    <url>/2050/02/05/%E3%80%90%E5%85%AC%E5%91%8A%E3%80%91%E5%8D%9A%E5%AE%A2%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚æ˜¯ä¸€ä¸ªæœ¬blogçš„è§‚å…‰æŒ‡å—ï¼Ÿ<del>è™½ç„¶å¯èƒ½å¹¶æ²¡æœ‰äººæ¥é€›QAQ</del></p>
<p>å¦‚æœå¯ä»¥çš„è¯ï¼Œè°¢è°¢ä½ å–œæ¬¢æˆ‘ï¼</p>
<p>2020.3.25 upd: æœ€è¿‘å› ä¸ºæœ‰æ–°çš„ä¸œè¥¿æƒ³ç½®é¡¶ï¼Œäºæ˜¯å°±æŠŠç•™è¨€æ¿æ¢ä¸‹æ¥äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æ¬¢è¿å¤§å®¶æ¥ç•™è¨€ï¼š<a href="https://www.orchidany.cn/2019/08/09/ç•™è¨€æ¿/#more">æˆ³æˆ‘</a> ï¼</p>
<a id="more"></a>
<h1 id="å…³äºè‡ªå·±"><a href="#å…³äºè‡ªå·±" class="headerlink" title="å…³äºè‡ªå·±"></a>å…³äºè‡ªå·±</h1><p>ç°åœ¨é«˜äºŒå•¦ï¼Œåæ ‡SDå¼±æ ¡ï¼Œé©¬ä¸Šé€€å½¹å•¦ã€‚</p>
<p>CSP-2019è€ƒçš„å¤ªèœï¼Œå¯¼è‡´ç°åœ¨ååˆ†è¢«åŠ¨ã€‚</p>
<p>å¹³æ—¶åœ¨å­¦æ ¡å¤„äºåœè¯¾çŠ¶æ€ã€‚ç”±äºæˆ‘ä»¬ç­å¤§æ¦‚éƒ½åœè¯¾äº†ï¼Œæ‰€ä»¥ä¸æ˜¯å¾ˆæ‹…å¿ƒã€‚</p>
<p>å…¶å®æŒºçƒ­çˆ±ç®—æ³•çš„å§ï¼Ÿ</p>
<p>CFå¹³æ—¶çœŸçš„ä¸æ˜¯å¾ˆå¸¸æ‰“ï¼Œæ‰€ä»¥å¹¶ä¸æƒ³ç»™CFçš„IDã€‚sorryå•¦ã€‚</p>
<p>ä¼¼ä¹å…·æœ‰é²œæ˜çš„å–·å­å±æ€§ï¼Œååˆ†æƒ³æ‘†è„±è¿™ä¸ª <code>tag</code> ã€‚</p>
<p>QQ:2836531293</p>
<h1 id="å…³äºé—²æ‰¯"><a href="#å…³äºé—²æ‰¯" class="headerlink" title="å…³äºé—²æ‰¯"></a>å…³äºé—²æ‰¯</h1><p><del>å…³äºå¦‚ä½•åˆ·è®¿é—®é‡</del></p>
<p>é¦–å…ˆæ˜¯<strong>ã€Œéšæƒ³ã€</strong> ç³»åˆ—ã€‚è¿™ä¸ªç³»åˆ—ï¼Œä»ç”Ÿç†å­¦ä¸Šåˆ†æï¼Œå¤§æ¦‚æ˜¯ä½“å†…é›Œæ€§æ¿€ç´ æ°´å¹³æé«˜çš„æ—¶å€™æ‰ä¼šå†™å‡ºæ¥çš„ä¸œè¥¿ï¼Œéƒ½å¾ˆæ„Ÿæ€§ï¼Œéƒ½æœ‰ç€ä¸°å¯Œçš„æƒ…æ„Ÿå–·è–„ã€‚æ‰€ä»¥å†™è¿™äº›ä¸œè¥¿çš„æ—¶å€™ï¼Œæˆ‘å¤§æ¦‚éƒ½è«å¾—ç†æ™ºã€‚</p>
<p>ã€Œéšæƒ³ã€ç³»åˆ—ç›®å½•ï¼š<a href="https://www.orchidany.cn/2050/12/31/éšæƒ³Â·ç›®æ¬¡è¡¨">æˆ³</a></p>
<p>ç„¶åæ˜¯æ–°å¼€çš„ã€Œç”Ÿæ´»ç¢ç‰‡ã€ç³»åˆ—ã€‚å¤§æ¦‚è¿˜æ˜¯é—²æ‰¯ã€‚ä½†æ˜¯è¿™å…¶ä¸­ä¸ä¼šè¿‡å¤šåœ°æºæ‚å¾ˆå¤æ‚çš„æ„Ÿæƒ…ï¼Œæ›´åƒæ˜¯æµæ°´è´¦ã€‚ä»¥åå¤§éƒ¨åˆ†æ—¶é—´å¯èƒ½åªæœ‰è¿™ä¸ªä¼šæ›´æ–°äº†ã€‚</p>
<p>ã€Œç”Ÿæ´»ç¢ç‰‡ã€ç³»åˆ—ç›®å½•ï¼š<a href="https://www.orchidany.cn/2020/02/07/ç”Ÿæ´»ç¢ç‰‡ç›®å½•/">æˆ³</a></p>
<p>3.22upd: æœ€è¿‘åˆæŠŠæ›¾ç»è¿ç»­è®°äº†å¥½é•¿ä¸€æ®µæ—¶é—´ã€åŸæ¥æ˜¯ç½®é¡¶çš„ã€Œé—²æ‰¯ã€ç»™å½’æ¡£äº†ï¼š<a href="[https://www.orchidany.cn/2019/12/15/%E9%97%B2%E6%89%AF/](https://www.orchidany.cn/2019/12/15/é—²æ‰¯/">æˆ³</a>)</p>
<h1 id="å…³äºOI"><a href="#å…³äºOI" class="headerlink" title="å…³äºOI"></a>å…³äºOI</h1><p>å¤§æ¦‚ä»¥åç®—æ³•å­¦ä¹ å°±ä¸ä¼šå¾ˆæ¶‰åŠäº†ï¼Ÿå¤§éƒ¨åˆ†éƒ½ä¼šæ˜¯åšé¢˜ã€‚æœ‰äº› blog å¯èƒ½æœ‰å¯†ç ï¼Œéœ€è¦çš„è¯å¯ä»¥æ¥æ‰¾æˆ‘è¦ã€‚</p>
<p>ä¸ªäººæ¯”è¾ƒè®¨åŒä¸€ä¸ªé¢˜çœ‹ä¸€ç¯‡blogï¼Œå¤ªæµªè´¹ç©ºé—´<del>é™¤äº†æˆ‘æƒ³æ°´blogçš„æ—¶å€™ç¡®å®ä¼šè¿™ä¹ˆåš</del>ã€‚</p>
<h1 id="å…³äºå‹é“¾"><a href="#å…³äºå‹é“¾" class="headerlink" title="å…³äºå‹é“¾"></a>å…³äºå‹é“¾</h1><p>å‹é“¾çš„è¯ï¼Œå¯ä»¥åŠ æˆ‘çš„ä¼é¹…å·ç”³è¯·ï¼Œæˆ–è€…ç›´æ¥å»ä¾§è¾¹æ çš„ <code>Friends</code> é‚£ä¸€æ è¯„è®ºç”³è¯·ã€‚</p>
<p>æ‰€æœ‰çš„æœ‹å‹éƒ½ä¼šå¾…åœ¨ä¾§è¾¹æ  <code>Friends</code> çš„é¡µé¢ä¸­å“¦ã€‚</p>
<h1 id="å…³äºç•™è¨€"><a href="#å…³äºç•™è¨€" class="headerlink" title="å…³äºç•™è¨€"></a>å…³äºç•™è¨€</h1><p>è¯·è®¿é—®è¿™ä¸ªblogçš„äººï¼ŒåŠ¡å¿…å»ç•™è¨€æ¿ç•™ä¸ªè¨€å•ŠQAQ</p>
<p>æˆ‘ä¸€ä¸ªäººå¾ˆæ— èŠçš„è¯´QAQ</p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>ç¬”å°–ç”ŸèŠ±</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘[æ¹–åŒ—çœé˜Ÿäº’æµ‹2014week1 B] ä¸€ä¸ªäººçš„æ•°è®º</title>
    <url>/2020/04/01/%E4%B8%80%E4%B8%AA%E4%BA%BA%E7%9A%84%E6%95%B0%E8%AE%BA/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>ç»™å®š $n$ çš„è´¨å› æ•°åˆ†è§£ $n= \prod _{i=1}^kp^{a_{i}}$ï¼Œæ±‚æ‰€æœ‰å°äº $n$ ä¸”ä¸ $n$ äº’è´¨çš„æ­£æ•´æ•°çš„ $m$ æ¬¡æ–¹ä¹‹å’Œæ¨¡ $10^9 +7$ çš„å€¼ã€‚å…¶ä¸­ $p_i$ ä¸ºè´¨æ•°ä¸”ä¸è¶…è¿‡ $10^9$ ã€‚</p>
<p>$a_i â‰¤ 10^9,k â‰¤ 1000,m â‰¤ 100$ã€‚</p>
</blockquote>
<a id="more"></a>
<p>å†™å‡ºå¼å­æ¥</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum_{i=1}^n[(i,n)=1]i^m\\
=&\sum_{i=1}^ni^m\sum_{d|i,d|n}\mu(d)\\
=&\sum_{d=1}^nd^m\mu(d)\sum_{i=1}^{\lfloor \frac{n}{d}\rfloor}  i^m
\end{aligned}</script><p>ç„¶åå‘ç°è¿™ä¸œè¥¿å¥½åƒä¸æ˜¯å®¹æ˜“æå‰é¢„å¤„ç†ã€‚æ ¹æ®ä¼¯åŠªåˆ©æ•°çš„æ¨è®ºï¼Œå¯ä»¥çŸ¥é“ $\sum i^m$ è¿™ä¸œè¥¿æ˜¯ä¸€ä¸ªå…³äºä¸Šç•Œ $n$ çš„ $m+1$ æ¬¡å¤šé¡¹å¼ã€‚å‘ç° $m$ å¹¶ä¸å¤§äºæ˜¯å¯ä»¥ $O(m^2)$ æ’å‡ºæ¥ã€‚ è‹¥è®°è¿™ä¸ªå¤šé¡¹å¼æ˜¯ $f$ ï¼Œé‚£ä¹ˆåŸå¼å°±ç­‰ä»·äº</p>
<script type="math/tex; mode=display">
\sum_{d=1}^nd^m\mu(d)\sum_{i=1}^{m+1} f_i\left(\lfloor\frac{n}{d}\rfloor\right) ^ i</script><p>ç¨å¾®åŒ–ä¸€ä¸‹å°±æ˜¯</p>
<script type="math/tex; mode=display">
=\sum_{i=0}^{m+1} f_{i} \sum_{d | n} d^{m} \mu(d)\left(\frac{n}{d}\right)^{i}</script><p>å‘ç°å¯¹äºåé¢çš„ $\sum $ åªéœ€è¦æ±‚å‡ºæ¯ä¸ª $p_i^{a_i}$ å¤„çš„å€¼ï¼Œç„¶åæ¯æ¬¡ $O(k)$ æš´åŠ›åˆå¹¶ï¼Œä¼¼ä¹ä¹Ÿæ²¡å•¥é—®é¢˜ã€‚è€ƒè™‘å¯¹äºæ¯ä¸ª $p_i^{a_{i}}$ æ€ä¹ˆæ±‚ã€‚è¿™ä¸ªåœ°æ–¹å¤§æ¦‚éœ€è¦æ¶¨ä¸ªç»éªŒï¼Œå°±æ˜¯ $\mu(d)$ è¿™ä¸œè¥¿åªæœ‰å½“ $d=1$ å’Œ $d=p_i$ çš„æ—¶å€™æ‰æœ‰å€¼(æ— å¹³æ–¹å› å­,å‰©ä¸‹çš„å› å­éƒ½æ˜¯ $p_i$ çš„æŸä¸ªæ¬¡æ•° $&gt;2$ çš„å¹‚)ï¼Œæ‰€ä»¥æ¯ä¸ªåªéœ€è¦ç®—ä¸¤æ¬¡ï¼Œæ˜¯ $O(1)$ çš„ã€‚äºæ˜¯æœ€åçš„å¤æ‚åº¦ $O(m(m+k))$ ã€‚</p>
<p>å¥½ç¥å•Šå¥½ç¥å•Šã€‚</p>
<p>å“ˆå“ˆå“ˆå“ˆå“ˆè‰è¿™ä¸ªé¢˜å±…ç„¶å…è®¸ç”¨é«˜æ–¯æ¶ˆå…ƒæ¥ä»£æ›¿æ’å€¼ã€‚æ¯•ç«Ÿ $m$ åªæœ‰ $100$ ã€‚</p>
<p>ç„¶åå…³äºæ‹‰æ’ï¼Œæ„Ÿè§‰å¾ˆggï¼Œå› ä¸ºä¸€å…±æœ‰ä¸‰ä¸ªç‰ˆæœ¬çš„æ‹‰æ’ï¼Œæ±‚å€¼å’Œæ±‚ç³»æ•°ï¼Œæ±‚å€¼çš„åˆåˆ†ä¸º $x$ è¿ç»­/ä¸è¿ç»­çš„ã€‚äºæ˜¯ä»Šå¤©å°±æŠŠä¸‰ä¸ªç‰ˆæœ¬éƒ½å†™äº†ä¸€éâ€¦â€¦</p>
<p>ä¸è¿‡æœ‰ä¸€è¯´ä¸€ï¼Œæ±‚ç³»æ•°çš„æ‹‰æ’æ„Ÿè§‰å°±æ˜¯åœ¨æ¨¡æ‹Ÿã€‚ç„¶åæˆ‘è¿˜å¯¹ç€å¤šé¡¹å¼é™¤æ³•(æ•´é™¤ä»¥ä¸€ä¸ªå½¢å¦‚ $(x+t)$ çš„å¤šé¡¹å¼)æ‘¸äº†å¥½ä¹…ï¼Œä¸€ç›´æ„Ÿè§‰å¾ˆè¿·ä¹±ï¼Œåæ¥ç”¨äº†ç”¨å¤§é™¤æ³•ï¼Œå‘ç°å°±æ˜¯åœ¨æ¨¡æ‹Ÿå¤§é™¤æ³•çš„è¿‡ç¨‹ç½¢äº†ã€‚</p>
<p>ç„¶åä¸€å¼€å§‹æˆ‘è¿˜æ†¨æ†¨çš„å†™äº†ä¸ªçº¿æ€§ç­›ï¼Œç„¶åå‘ç° $\mu(d)$ çš„ $d$ æ˜¯ $1e9$ çš„ï¼Œå°±æ‡µåœˆäº†ï¼Œç„¶ååˆå‘ç° $\mu(d)$ åªä¼šæ˜¯ $1/-1$ å¹¶ä¸”å¾ˆå¥½åˆ¤æ–­ï¼Œäºæ˜¯æ„Ÿè§‰è‡ªå·±æ˜¯ä¸ªsbã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ; </span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000010</span> ; </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1000000007</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, k ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">int</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Interpolation&#123;</span><br><span class="line">	<span class="keyword">int</span> ans ; </span><br><span class="line">	<span class="keyword">int</span> now ; </span><br><span class="line">	<span class="keyword">int</span> x[N] ;</span><br><span class="line">	<span class="keyword">int</span> y[N] ;</span><br><span class="line">	<span class="keyword">int</span> fac[N] ; </span><br><span class="line">	<span class="keyword">int</span> inv[N] ; </span><br><span class="line">	<span class="keyword">int</span> pres[N] ; </span><br><span class="line">	<span class="keyword">int</span> sufs[N] ; </span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> res = <span class="number">1</span> ;</span><br><span class="line">		a = (a % P + P) % P ;</span><br><span class="line">		<span class="keyword">while</span> (b)&#123;</span><br><span class="line">			<span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">				res = (ll)res * a % P ; </span><br><span class="line">			a = (ll)a * a % P ; b &gt;&gt;= <span class="number">1</span> ; </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> fz[N] ;</span><br><span class="line">	<span class="keyword">int</span> fm[N] ; </span><br><span class="line">	<span class="keyword">int</span> tmp[N] ;</span><br><span class="line">	<span class="keyword">int</span> res[N] ;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">		a += b ;</span><br><span class="line">		<span class="keyword">if</span> (a &gt; P) a -= P ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">		(a -= b) %= P ;</span><br><span class="line">		<span class="keyword">if</span> (a &lt; <span class="number">0</span>) a += P ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">fmul</span><span class="params">(<span class="keyword">int</span> *t, <span class="keyword">int</span> deg, <span class="keyword">int</span> opt)</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = deg + <span class="number">1</span> ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">			tmp[i] = t[i], t[i] = t[i - <span class="number">1</span>] ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= deg + <span class="number">1</span> ; ++ i)</span><br><span class="line">			add(t[i], (ll)opt * tmp[i] % P) ;   </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">fdiv</span><span class="params">(<span class="keyword">int</span> *t, <span class="keyword">int</span> *ret, <span class="keyword">int</span> deg, <span class="keyword">int</span> opt)</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= deg ; ++ i) tmp[i] = t[i] ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = deg - <span class="number">1</span> ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">			ret[i] = tmp[i + <span class="number">1</span>], dec(tmp[i], (ll)tmp[i + <span class="number">1</span>] * opt % P) ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">get_xs</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">		fz[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">			fmul(fz, i, (-x[i] + P) % P) ;</span><br><span class="line">		<span class="comment">//debug(fz, 1, n + 1, '\n') ;</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">			<span class="keyword">int</span> fenmu = <span class="number">1</span> ; </span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">				<span class="keyword">if</span> (i != j) fenmu = (ll)fenmu * (x[i] - x[j] + P) % P ;</span><br><span class="line">			fdiv(fz, fm, n + <span class="number">1</span>, -x[i]) ; </span><br><span class="line">			fenmu = (ll)y[i] * expow(fenmu, P - <span class="number">2</span>) % P ;</span><br><span class="line">		<span class="comment">//	cout &lt;&lt; fenmu &lt;&lt; endl ; </span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">				add(res[j], (ll)fenmu * fm[j] % P) ;</span><br><span class="line">		<span class="comment">//	debug(res, 1, n, '\n') ;</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">pre_do</span><span class="params">(<span class="keyword">int</span> U)</span></span>&#123;</span><br><span class="line">		fac[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line">			fac[i] = (ll)fac[i - <span class="number">1</span>] * i % P ;</span><br><span class="line">		inv[U] = expow(fac[U], P - <span class="number">2</span>) ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = U ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">			inv[i - <span class="number">1</span>] = (ll)inv[i] * i % P ;</span><br><span class="line">		<span class="comment">//debug(fac, 1, U, '\n') ;</span></span><br><span class="line">		<span class="comment">//debug(inv, 1, U, '\n') ;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">evenmark</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (x &amp; <span class="number">1</span>) ? <span class="number">-1</span> : <span class="number">1</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">get_dnx</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">bool</span> m)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (m)&#123;</span><br><span class="line">			pre_do(n) ;</span><br><span class="line">			pres[<span class="number">0</span>] = <span class="number">1</span>, sufs[n + <span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">				pres[i] = ((ll)pres[i - <span class="number">1</span>] * (k - x[i]) % P + P) % P ;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">				sufs[i] = ((ll)sufs[i + <span class="number">1</span>] * (k - x[i]) % P + P) % P ; </span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">				now = (ll)pres[i - <span class="number">1</span>] * sufs[i + <span class="number">1</span>] % P ;</span><br><span class="line">				now = (ll)now * expow((ll)fac[i - <span class="number">1</span>] * fac[n - i] % P, P - <span class="number">2</span>) % P ;</span><br><span class="line">				now = (ll)evenmark(n - i) * y[i] % P * now % P ; ans = (ll)(ans + now) % P ; </span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">int</span> inow = <span class="number">1</span> ;</span><br><span class="line">			pres[<span class="number">0</span>] = <span class="number">1</span>, sufs[n + <span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">				pres[i] = ((ll)pres[i - <span class="number">1</span>] * (k - x[i]) % P + P) % P ;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">				sufs[i] = ((ll)sufs[i + <span class="number">1</span>] * (k - x[i]) % P + P) % P ; </span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">				inow = <span class="number">1</span>, now = (ll)pres[i - <span class="number">1</span>] * sufs[i + <span class="number">1</span>] % P ;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">					<span class="keyword">if</span> (i != j) inow = (ll)inow * ((x[i] - x[j]) % P + P) % P ; </span><br><span class="line">				ans = (ans + (ll)now * expow(inow, P - <span class="number">2</span>) % P * y[i] % P) % P ; </span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;<span class="comment">/*</span></span><br><span class="line"><span class="comment">namespace Linear_sieve&#123;</span></span><br><span class="line"><span class="comment">	int cnt ;</span></span><br><span class="line"><span class="comment">	int pr[N] ; </span></span><br><span class="line"><span class="comment">	int mu[N] ;</span></span><br><span class="line"><span class="comment">	int vis[N] ;</span></span><br><span class="line"><span class="comment">	void sieve(int U)&#123;</span></span><br><span class="line"><span class="comment">		mu[1] = 1 ;</span></span><br><span class="line"><span class="comment">		for (int i = 2 ; i &lt;= U ; ++ i)&#123;</span></span><br><span class="line"><span class="comment">			if (!vis[i]) mu[i] = -1, pr[++ cnt] = i ; </span></span><br><span class="line"><span class="comment">			for (int j = 1 ; j &lt;= cnt ; ++ j)&#123;</span></span><br><span class="line"><span class="comment">				if (i * pr[j] &gt; U) break ; </span></span><br><span class="line"><span class="comment">				vis[i * pr[j]] = 1 ; </span></span><br><span class="line"><span class="comment">				if (i % pr[j] == 0) break ; </span></span><br><span class="line"><span class="comment">				mu[i * pr[j]] = -mu[i] ; </span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="keyword">int</span> d, w, num ;</span><br><span class="line"><span class="keyword">int</span> base[N], cs[N] ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; d &gt;&gt; w ; n = d + <span class="number">2</span> ; </span><br><span class="line"><span class="comment">//	using namespace Linear_sieve ; </span></span><br><span class="line">	<span class="keyword">using</span> <span class="keyword">namespace</span> Interpolation ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) </span><br><span class="line">		x[i] = i, y[i] = (y[i - <span class="number">1</span>] + expow(x[i], d)) % P ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= w ; ++ i)</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; base[i] &gt;&gt; cs[i] ; get_xs(n) ; </span><br><span class="line"><span class="comment">//	debug(y, 1, n + 1, '\n') ;</span></span><br><span class="line"><span class="comment">//	debug(res, 1, n + 1, '\n') ;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n + <span class="number">1</span> ; ++ i)&#123;</span><br><span class="line">		now = <span class="number">0</span>, num = <span class="number">1</span> ;   </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= w ; ++ j)&#123;</span><br><span class="line">			now = expow(expow(base[j], cs[j] - <span class="number">1</span>), i - <span class="number">1</span>) ;</span><br><span class="line">			now = ((<span class="number">-1l</span>l * now * expow(base[j], d) % P) + P) % P ; </span><br><span class="line">			now = (now + expow(expow(base[j], cs[j]), i - <span class="number">1</span>)) % P ; </span><br><span class="line">			num = <span class="number">1l</span>l * num * now % P ; </span><br><span class="line">		&#125;</span><br><span class="line">		ans = (ans + (ll)num * res[i] % P) % P ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>BZOJ</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°/è«æ¯”ä¹Œæ–¯åæ¼”</tag>
        <tag>å¤šé¡¹å¼çš„åº”ç”¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘[bzoj3853] GCD Array</title>
    <url>/2020/03/31/GCD-Array/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>ç»´æŠ¤ä¸€ä¸ªåºåˆ—ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>1ã€ç»™å®š $n,d,v$ ï¼Œå¯¹æ¯ä¸ª $(x,n)=d$ çš„ $a_x\text{+=}v$ ã€‚</p>
<p>2ã€è¯¢é—® $\sum _{i=1}^k a_i$</p>
<p>$n\leq 10^5$</p>
</blockquote>
<p>å¾ˆæœ‰æ„æ€çš„é¢˜ç›®ï¼Œè§£æ³•ä¹Ÿå¾ˆç®€æ´ã€‚</p>
<a id="more"></a>
<hr>
<p>å¦™å¦™é¢˜ï¼Œå»ºç«‹ä¸€ä¸ªè¾…åŠ©æ•°ç»„ $f$ï¼Œè®© $a_i=\sum _{d|i}f_d$ ã€‚</p>
<p>è€ƒè™‘æ¯æ¬¡åŠ çš„æ“ä½œï¼Œå¯¹äºæ¯ä¸ª $i$ å®é™…ä¸Šæ˜¯åŠ ä¸Šè¿™ä¸ªä¸œè¥¿ï¼š</p>
<script type="math/tex; mode=display">
\begin{align*}&[(n,i)=d]v\\= &[(\frac{n}{d},\frac{n}{i})=1]v\\= &\sum_{k|\frac{n}{d},k|\frac{n}{i}}\mu(k)v\end{align*}</script><p>è€ƒè™‘å¯¹ $f$ åæ¼”:</p>
<script type="math/tex; mode=display">
f_d=\sum_{k|d}\mu(k)a_{\frac{d}{k}}</script><p>é‚£ä¹ˆå¯ä»¥çœ‹å‡ºï¼Œå…¶å®æ¯æ¬¡æ“ä½œå°±æ˜¯å¯¹æ‰€æœ‰çš„ $k | \frac{n}{d}$ çš„ $f_{kd}$ åŠ ä¸Šäº† $\mu(k)\cdot v$ .</p>
<p>è€ƒè™‘è¯¢é—®æ“ä½œå°±æ˜¯åœ¨è¯¢é—®</p>
<script type="math/tex; mode=display">
\sum_{i=1}^x\sum_{d|i}f_d=\sum_{d=1}^{x}\left[\frac{x}{d}\right] f_d</script><p>è¿™ä¸ªå¯ä»¥ $\sqrt n$ åˆ†å—æ¥åšã€‚äºæ˜¯æœ€åä¿®æ”¹å¤æ‚åº¦ $\sqrt[3] n\log n$ï¼Œè¯¢é—®å¤æ‚åº¦ $\sqrt n\log n$ ã€‚ æ³¨æ„åˆ°å¯ä»¥è°ƒæ•´å—çš„å¤§å°ï¼Œå¯¹äºæ‰€æœ‰ $&lt;\sqrt {x\log x}$ çš„ä½ç½®æš´åŠ›åŠ ï¼Œå¯¹äºæ‰€æœ‰ $&gt;\sqrt {x\log x}$ çš„ä½ç½®ï¼Œè‡³å¤šæœ‰ $\sqrt \frac{x}{\log x}$ ä¸ªã€‚æ‰€ä»¥å¯ä»¥æŠŠ $\log $ æ”¾åˆ°é‡Œé¢å»ã€‚</p>
<p>å½“ç„¶æˆ‘è‚¯å®šæ˜¯å†™ $\sqrt n\log n$ çš„å•¦ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200110</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> L_s&#123;</span><br><span class="line">	<span class="keyword">int</span> cnt ;</span><br><span class="line">	<span class="keyword">int</span> pr[N] ; </span><br><span class="line">	<span class="keyword">int</span> mu[N] ;</span><br><span class="line">	<span class="keyword">int</span> smu[N] ;</span><br><span class="line">	<span class="keyword">int</span> vis[N] ;</span><br><span class="line">	<span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; fc[N] ;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> U)</span></span>&#123;</span><br><span class="line">		mu[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= U ; ++ i)&#123;</span><br><span class="line">			<span class="keyword">if</span> (!vis[i]) mu[i] = <span class="number">-1</span>, pr[++ cnt] = i ; </span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">				<span class="keyword">if</span> (i * pr[j] &gt; U) <span class="keyword">break</span> ; </span><br><span class="line">				vis[i * pr[j]] = <span class="number">1</span> ; </span><br><span class="line">				<span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ; </span><br><span class="line">				mu[i * pr[j]] = -mu[i] ; </span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line">			smu[i] = smu[i - <span class="number">1</span>] + mu[i] ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; i * j &lt;= U ; ++ j)</span><br><span class="line">				fc[i * j].push_back(i) ; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T ; </span><br><span class="line">ll _bit[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, p ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">low</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (x &amp; (-x)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> ( ; x &lt;= n ; x += low(x)) _bit[x] += v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	ll ret = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> ( ; x ; x -= low(x)) ret += (ll)_bit[x] ;</span><br><span class="line">	<span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> opt, x, d, v ; </span><br><span class="line">	L_s :: sieve(N - <span class="number">10</span>) ; </span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; ++ T ;</span><br><span class="line">		<span class="keyword">if</span> (!(m + n)) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Case #"</span> &lt;&lt; T &lt;&lt; <span class="string">": "</span> &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">		fill(_bit + <span class="number">1</span>, _bit + n + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">		<span class="keyword">while</span> (m --)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;opt, &amp;x) ; </span><br><span class="line">			<span class="keyword">if</span> (opt == <span class="number">1</span>)&#123;</span><br><span class="line">				<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;d, &amp;v) ; <span class="keyword">if</span> (x % d != <span class="number">0</span>) <span class="keyword">continue</span> ; </span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L_s :: fc[x / d].size() ; ++ i)</span><br><span class="line">					add(L_s :: fc[x / d][i] * d, L_s :: mu[L_s :: fc[x / d][i]] * v) ; </span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				ll ans = <span class="number">0</span> ;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r ; l &lt;= x ; l = r + <span class="number">1</span>)</span><br><span class="line">					r = x / (x / l), ans += (ask(r) - ask(l - <span class="number">1</span>)) * (ll)(x / l) ;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>BZOJ</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ </tag>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°/è«æ¯”ä¹Œæ–¯åæ¼”</tag>
        <tag>åˆ†æ²»</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘[UR#5 C]æ€æ ·è·‘çš„æ›´å¿«</title>
    <url>/2020/03/31/UR5-%E6%80%8E%E6%A0%B7%E8%B7%91%E7%9A%84%E6%9B%B4%E5%BF%AB/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>ç»™å®š $n â‰¤ 10^5;c,d â‰¤ 10^9$ ã€‚</p>
<p>ç°æœ‰é•¿åº¦ä¸º $n$ çš„åºåˆ— $b$ æ»¡è¶³ $b_{i} \equiv \sum_{i=1}^{n} \operatorname{gcd}(i, j)^{c}  \mathrm{lcm}(i, j)^{d} z_{j}(\bmod 998244353)$ ã€‚</p>
<p>æ±‚ $\{z_n\}$ ã€‚</p>
</blockquote>
<p>è‰ï¼Œè¿™çœŸæ˜¯ä¸€é“ç¥ä»™é¢˜ã€‚é’›é’›é’›é’›æœ‰è¶£è¾£ï¼sto vfk .</p>
<a id="more"></a>
<p>å…ˆè½¬åŒ–ä¸€ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
b_{i} \equiv \sum_{i=1}^{n} \operatorname{gcd}(i, j)^{c-d}\cdot i^d\cdot j^d\cdot  z_{j}(\bmod 998244353)</script><p>è€ƒè™‘å½¢å¦‚ $\sum_{j=1}^{n}f(\gcd(i,j))\cdot g(i)\cdot h(j)\cdot z_j$ ç­‰äºæŸä¸ªå€¼çš„ä¸œè¥¿ï¼Œå¤§æ¦‚éƒ½æ˜¯å¯åšçš„ã€‚è€ƒè™‘å…ˆæ„é€ ä¸€ä¸ª $fâ€™$ æ»¡è¶³</p>
<script type="math/tex; mode=display">
f(n)=\sum_{d|n}f'(d)</script><p>é‚£ä¹ˆå°±å¯ä»¥åŒ–ä¸€ä¸‹</p>
<script type="math/tex; mode=display">
\begin{aligned}&\sum_{j=1}^{n}f(\gcd(i,j))\cdot g(i)\cdot h(j)\cdot z_j\\=&\sum_{j=1}^n\sum_{d}[d|i]\cdot [d|j]\cdot f'(d)\cdot g(i)\cdot h(j)\cdot z_j\\=&\sum_{d|i}f'(d)\sum_{j=1}^n[d|j]\cdot g(i)\cdot h(j)\cdot z_j\end{aligned}</script><p>é‚£ä¹ˆå°±ç›¸å½“äºè¦éªŒè¯</p>
<script type="math/tex; mode=display">
\sum_{d|i}f'(d)\sum_{j=1}^n[d|j]\cdot h(j)\cdot z_j =\frac{b_i}{g(i)}</script><p>å¦‚æœèƒ½å¿«é€Ÿç®— $\zeta(d)=\sum_{j=1}^n[d|j]\cdot h(j)\cdot z_j $ çš„è¯ï¼Œé‚£ä¹ˆæœ‰</p>
<script type="math/tex; mode=display">
\sum_{d|i}f'(d)\zeta(d)=\frac{b_i}{g(i)}</script><p>è€ƒè™‘å¯¹äºä¸€ä¸ªäºŒå…ƒå…³ç³»</p>
<script type="math/tex; mode=display">
\sum_{d|n} p(d)=q(n)</script><p>è¿™ä¸œè¥¿ï¼ŒçŸ¥é“ $q$ ä¹‹åæ˜¯å¯ä»¥å¾ˆå®¹æ˜“åœ°å®¹æ–¥å‡º $p$ çš„ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´å¯ä»¥å¾ˆå®¹æ˜“åœ°å¾—åˆ° $fâ€™(k)\zeta(k)$ ã€‚é‚£ä¹ˆåŒæ—¶ç”±äºçŸ¥é“äº† $f(k)=k^{c-d}$ ï¼Œæ˜¯å¾ˆå®¹æ˜“ç›´æ¥å®¹æ–¥å‡º $fâ€™(k)$ çš„ã€‚ä¹Ÿå°±æ˜¯ç°åœ¨ $\zeta$ å˜æˆäº†å·²çŸ¥ã€‚</p>
<p>è€ƒè™‘å¦‚ä½•ä» $\zeta(d)=\sum_{j=1}^n[d|j]\cdot h(j)\cdot z_j $ åæ¨å‡º $z_j$ æ¥ï¼Œå‘ç°æœ¬è´¨ä¸Šæ˜¯è¿™æ ·çš„ï¼š</p>
<script type="math/tex; mode=display">
\zeta(d)=\sum_{d|j} h(j)z_j</script><p>æ ¹æ®è«æ¯”ä¹Œæ–¯åæ¼”çš„å¦ä¸€ç§å½¢å¼</p>
<script type="math/tex; mode=display">
F(n)=\sum_{n | d} f(d)\Longrightarrow f(n)=\sum_{n | d} \mu\left(\frac{d}{n}\right) F(d)</script><p>åæ¼”ä¸€ä¸‹å˜æˆ</p>
<script type="math/tex; mode=display">
h(d)z_d=\sum_{d|j} \mu(\frac{j}{d})\zeta_j</script><p>ç„¶åå°±å¯ä»¥ç›´æ¥åšäº†ã€‚</p>
<p>æ³¨æ„åˆ°ä»¥ä¸Šæ¯ä¸ªæ¨å®Œçš„å¼å­ï¼Œæ±‚çš„æ—¶å€™éƒ½æ˜¯ $nH(n)$ çš„å¤æ‚åº¦ï¼Œ$O(n\ln n)$ ã€‚</p>
<p>ç¥é¢˜ç¥é¢˜ï¼Œå¯èƒ½è¿™æ˜¯æˆ‘æ¥è§¦è¿‡çš„æœ€åƒè«æ¯”ä¹Œæ–¯åæ¼”çš„è«æ¯”ä¹Œæ–¯é¢˜ã€‚å¹¶ä¸”æŠŠåæ¼”çš„å®¹æ–¥ä½œç”¨å¾ˆå¥½åœ°è¯ é‡Šäº†å‡ºæ¥ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>uoj</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°/è«æ¯”ä¹Œæ–¯åæ¼”</tag>
        <tag>æ•°å­¦/æ•°å€¼åˆ†æ/è°ƒå’Œçº§æ•°</tag>
        <tag>æ€ç»´é¢˜/å®¹æ–¥</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å¬è¯¾ç¬”è®°ã€‘MobiÃ¼såæ¼”å¬è¯¾ç¬”è®°</title>
    <url>/2020/03/30/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸»è¦æ˜¯è«æ¯”ä¹Œæ–¯åæ¼”è¿™ä¸€å—çš„å¬è¯¾ç¬”è®°ï¼Œç”±äºè®°å½•çš„å¤ªé•¿äº†<del>(ä¸ä¼šçš„å¤ªå¤šäº†)</del> æ‰€ä»¥å°±åˆ†äº†ä¸€ä¸‹ã€‚</p>
<p>åæ¼”å¥½å•Šï¼Œæœ‰è¶£å•Šï¼Œä¸ä¼šå•Šï¼</p>
<a id="more"></a>
<h1 id="å…³äº-mu-çš„æœ‰è¶£è¯æ˜"><a href="#å…³äº-mu-çš„æœ‰è¶£è¯æ˜" class="headerlink" title="å…³äº $\mu$ çš„æœ‰è¶£è¯æ˜"></a>å…³äº $\mu$ çš„æœ‰è¶£è¯æ˜</h1><p>æ€è€ƒ $\mu$ çš„æœ¬è´¨ï¼Œå½“ $n$ å«æœ‰å¹³æ–¹å› å­çš„æ—¶å€™ï¼Œ$\mu(n)=0$ï¼›å¦åˆ™ $\mu(n)=(-1)^k$ï¼Œå…¶ä¸­ $k$ æ˜¯ $n$ çš„æœ¬è´¨ä¸åŒè´¨å› å­ä¸ªæ•°ã€‚</p>
<p>æ¥ä¸‹æ¥è€ƒè™‘ä¸€æ­¥è½¬åŒ–ã€‚è®¾ $n=\sum p_i^{e_i},nâ€™=\sum{p_i}$ ã€‚é‚£ä¹ˆæœ‰</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum_{d|n}\mu(d)\\ 
= &\sum_{d|n'}\mu(d)\\
= &\sum_{i=0}^k \binom{k}{i}(-1)^i\\
= & ~(1+(-1))^k\\
= & ~[k=0]
\end{aligned}</script><h1 id="çåæ¼”è®°å½•"><a href="#çåæ¼”è®°å½•" class="headerlink" title="çåæ¼”è®°å½•"></a>çåæ¼”è®°å½•</h1><p>é‚£å¤§æ¦‚ä½¿ç”¨æ¥çƒ­èº«çš„ã€‚</p>
<ul>
<li>åæ¼”1</li>
</ul>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum _{i=1}^n\sum_{j=1}^m[i,j]
\\&=\sum _{d=1}^n\sum _{i=1}^n\sum_{j=1}^m\frac{i\cdot j}{d}[(i,j)=d]
\\&=\sum _{d=1}^n\sum _{i=1}^{\lfloor\frac{n}{d} \rfloor}\sum_{j=1}^{\lfloor\frac{m}{d} \rfloor}i\cdot j\cdot d\cdot \sum_{p|i~\mathrm{and}~p|j}\mu(p) 
\\&=\sum _{d=1}^n d\sum_{p=1}^{\lfloor\frac{n}{d} \rfloor}\mu(p) \cdot p^2\sum_{i=1}^{\lfloor\frac{n}{pd} \rfloor}i\sum_{j=1}^{\lfloor\frac{m}{pd} \rfloor} j
\end{aligned}</script><ul>
<li>åæ¼”2</li>
</ul>
<script type="math/tex; mode=display">
\sum [n,i]\\
= \sum \frac{n\cdot i}{(n,i)}\\
= \sum_{d=1}^n\sum\frac{n\cdot i}{d}\cdot [(n,i)=d]\\
= \sum_{d=1}^n n\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor} i \sum \mu(k)\\
= \sum_{d=1}^nn\sum_{k=1}^{\lfloor\frac{n}{d}\rfloor}\mu(k)\cdot k\cdot \sum_{i=1}^{\lfloor\frac{n}{dk}\rfloor} i</script><h1 id="å„ç§é¢˜"><a href="#å„ç§é¢˜" class="headerlink" title="å„ç§é¢˜"></a>å„ç§é¢˜</h1><h2 id="SPOJ-LCMSUM"><a href="#SPOJ-LCMSUM" class="headerlink" title="SPOJ LCMSUM"></a>SPOJ LCMSUM</h2><blockquote>
<p>æ±‚ $\sum _{i=1}^n \mathrm{lcm}(n,i)$ .</p>
<p>$n\leq 10^6,T\leq 10^5$ </p>
</blockquote>
<p>è‰ï¼Œè¿™çœŸæ˜¯ä¸ªç¥ä»™é¢˜ã€‚è€ƒè™‘ $\rm lcm$ è‡ªç„¶æ˜¯è¦è½¬åŒ–æˆ</p>
<script type="math/tex; mode=display">
\sum_{i=1}^{n} \operatorname{lcm}(i, n)=\sum_{i=1}^{n} \frac{i\cdot n}{\operatorname{gcd}(i, n)}</script><p>é‚£ä¹ˆè€ƒè™‘å¿«é€Ÿè®¡ç®—è¿™ä¸ªä¸œè¥¿ã€‚ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•è€ƒè™‘èƒ½ä¸èƒ½ç­›ï¼Œç­›å°±è¦æ±‚å¿…é¡»è¦æ˜¯ç‹„åˆ©å…‹é›·å·ç§¯çš„å½¢ä¼¼ã€‚æƒ³è¦è½¬åŒ–è¿‡å»çš„è¯å¿…é¡»æ˜¯å¯¹ $n$ çš„å› å­æ±‚å’Œï¼Œäºæ˜¯æƒ³åˆ°è¦æŒ‰ç…§ $\gcd $ åˆ†ç±»ï¼Œé‚£ä¹ˆ $\gcd(n,i)=d$ çš„ $i$ æ€»å…±æœ‰ $\varphi(\frac{n}{d})$ ä¸ªã€‚</p>
<p>ä½†æ˜¯æ³¨æ„åˆ°åˆ†ç±»ä¹‹åï¼Œç”±äºæ¯ä¸€é¡¹éƒ½å¸¦æœ‰ $i$ æ‰€ä»¥æ— æ³•å¿«é€Ÿè®¡ç®—ã€‚è€ƒè™‘ä¸€ä¸ªæ€§è´¨ï¼Œ$\gcd(n,k)=\gcd(n,n- k)$ ã€‚é‚£ä¹ˆå°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
n\sum_{i=1}^n\frac{i}{\gcd(i,n)}=n\cdot \frac{1}{2}\left(\sum_{i=1}^n\frac{i}{\gcd(i,n)}+\sum_{i=1}^n\frac{n-i}{\gcd(n-i,n)}\right)=\frac{n}{2}\left(\sum_{i=1}^n\frac{i+(n-i)}{\gcd(i,n)}\right)=\frac{n^2}{2}\left(\sum_{i=1}^n\frac{1}{\gcd(i,n)}\right)</script><p>å‘ç°åé¢é‚£ä¸€é¡¹å°±å¯ä»¥å¿«é€Ÿæ±‚å’Œäº†ï¼š</p>
<script type="math/tex; mode=display">
\sum_{i=1}^{n} \frac{1}{\operatorname{gcd}(i, n)}=\sum_{d|n} \frac{\varphi(\frac{n}{d})}{d}</script><p>é‚£ä¹ˆç­”æ¡ˆå°±æ˜¯</p>
<script type="math/tex; mode=display">
\frac{n}{2}\left(\sum_{d|n} \frac{n\cdot\varphi(\frac{n}{d})}{d}\right)=\frac{n}{2}\left(\sum_{d|n} d\cdot\varphi(d)\right)</script><p>å°±å¯ä»¥å¿«é€Ÿç­›å‡ºæ¥äº†ã€‚å¤æ‚åº¦ $O(n)-O(1)$ ã€‚</p>
<h2 id="HDU-4944"><a href="#HDU-4944" class="headerlink" title="HDU 4944"></a>HDU 4944</h2><blockquote>
<p>æ±‚</p>
<script type="math/tex; mode=display">
\sum_{i=1}^{n} \sum_{j=i}^{n} \sum_{d | i, d|j} \frac{i j}{\operatorname{gcd}\left(\frac{i}{d}, \frac{j}{d}\right)}</script><p>$n,T\leq 5\times 10^5$</p>
</blockquote>
<p>é¦–å…ˆçœ‹åˆ° $d$ çŸ¥é“è¦æå‡ºæ¥</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum_{i=1}^{n} \sum_{j=i}^{n} \sum_{d | i, d|j} \frac{i j}{\operatorname{gcd}\left(\frac{i}{d}, \frac{j}{d}\right)}\\
=&\sum_{i=1}^{n} \sum_{j=i}^{n} \mathrm{lcm}(i,j)\sum_{d|i,d|j}d\\
=&\sum_{d=1}^{n}d^2\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\sum_{j=i}^{\lfloor\frac{n}{d}\rfloor} \mathrm{lcm}(i,j)
\end{aligned}</script><p>å‘ç°å¯¹äº $f(n)=\sum_{i=1}^n\sum_{j=i}^n \mathrm{lcm}(i,j)$ å¯ä»¥è½¬åŒ–æˆ</p>
<script type="math/tex; mode=display">
\sum_{i=1}^n\sum_{j=1}^i \mathrm{lcm}(i,j)</script><p> ä¹Ÿå°±æ˜¯ä¸Šé¢LCMSUMé‡Œé¢æ±‚å¾—çš„ä¸œè¥¿ã€‚äºæ˜¯å°±å¯ä»¥æ•´é™¤åˆ†å—åšäº†ã€‚å¤æ‚åº¦ $O(n+T\sqrt n)$ ã€‚</p>
<p>æ³¨æ„åˆ°ï¼Œé¢„å¤„ç†çš„æ—¶å€™è¿˜å¯ä»¥è®¡ç®—æ¯ä¸ª $d$ å¯¹äºæ¯ä¸ª $n$ çš„è´¡çŒ®ã€‚å…·ä½“ä¸€ç‚¹ï¼Œè€ƒè™‘æœ¬è´¨ä¸Šå¯¹äºæ¯ä¸ª $n$ï¼Œ$d$ çš„è´¡çŒ®éƒ½æ˜¯ $d^{2} f\left(\left\lfloor\frac{n}{d}\right\rfloor\right)$ ï¼Œè‡³å¤šæœ‰ $\left\lfloor\frac{n}{d}\right\rfloor$ ç§ä¸åŒçš„å–å€¼ï¼Œä¸”æ¯ä¸ªå–å€¼å¯¹åº”çš„ $n$ çš„åŒºé—´æ˜¯è¿ç»­çš„ã€‚äºæ˜¯å°±ç”¨ä¸€äº›å·®åˆ†æŠ€å·§å·®åˆ†ä¸€ä¸‹è¿™ä¸ªä¿®æ”¹ã€‚æ³¨æ„åˆ°è¿™ä¸ªçš„å¤æ‚åº¦æ˜¯è°ƒå’Œçº§æ•°çš„ï¼Œæ‰€ä»¥æ€»å¤æ‚åº¦ $O(n\ln n)-O(1)$ ã€‚</p>
<p>å…¶å®è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹é¢˜ï¼Œä½†æ˜¯å› ä¸ºè§‰å¾—å¾ˆæœ‰è¶£å°±å•æ‹¿å‡ºæ¥äº†ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°/è«æ¯”ä¹Œæ–¯åæ¼”</tag>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°/æ¬§æ‹‰åæ¼”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘åŒä½™</title>
    <url>/2020/03/29/%E6%95%B0%E8%AE%BA%E5%90%8C%E4%BD%99%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å‘ç°å½“å¹´å­¦æ•°è®ºï¼Œ4-6é‚£æœ¬ä¹¦ç¬¬äºŒä¸‰ç« åŸºæœ¬ä¸Šå°±æ˜¯æ²¡å­¦ä¼šï¼Œäºæ˜¯ä»Šå¤©æ‰“ç®—é‡å­¦ä¸€éã€‚</p>
<p>å‘ç°è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ã€‚å¹¶ä¸”å‘ç°è¯»è¿‡çš„MOğŸ“šè¶Šå¤šï¼Œè¿™ç§ä¸œè¥¿å°±è¶Šå¥½ç†è§£ã€‚</p>
<p>å—¯ï¼Œå¯“å¿«äºæ…¢ï¼Œè—å·§äºæ‹™ã€‚</p>
<a id="more"></a>
<p>å…ˆå®šä¹‰ä¸€ä¸‹è§£çš„ã€Œæœ¬è´¨ç›¸åŒã€ï¼šé€šå¸¸è®¤ä¸ºåœ¨æ¨¡ $m$ æ„ä¹‰ä¸‹çš„åŒä½™æ–¹ç¨‹ä¸­ $x$ å’Œ $x+km(k\in\mathbb{Z_+})$ æ˜¯æœ¬è´¨ç›¸åŒçš„ã€‚ </p>
<h1 id="ä¸€æ¬¡åŒä½™æ–¹ç¨‹"><a href="#ä¸€æ¬¡åŒä½™æ–¹ç¨‹" class="headerlink" title="ä¸€æ¬¡åŒä½™æ–¹ç¨‹"></a>ä¸€æ¬¡åŒä½™æ–¹ç¨‹</h1><blockquote>
<p>å½¢å¦‚</p>
<script type="math/tex; mode=display">
ax\equiv b\pmod m\qquad (1)</script><p>çš„æ–¹ç¨‹ã€‚</p>
</blockquote>
<h2 id="å®šç†1"><a href="#å®šç†1" class="headerlink" title="å®šç†1"></a>å®šç†1</h2><blockquote>
<p>è‹¥ $(a,m)=1$ ï¼Œåˆ™è¯¥å¼åªæœ‰ $1$ è§£ã€‚</p>
</blockquote>
<p>è¿™æ˜¯ä¸éš¾ç†è§£çš„ã€‚å› ä¸ºå¯ä»¥çŸ¥é“ $(1,2,3,\cdots m)$ æ„æˆäº†æ¨¡ $m$ çš„ä¸€ä¸ªå®Œå…¨å‰©ä½™ç³»ï¼ŒåŒæ—¶ $(a,2\cdot a,3\cdot a\cdots m\cdot a)$ åŒæ ·æ„æˆäº†æ¨¡ $m$ çš„ä¸€ä¸ªå®Œå…¨å‰©ä½™ç³»ã€‚é‚£ä¹ˆæ˜¾ç„¶æ°å¥½ä¸€ä¸ªæ•´æ•°ä½¿å¾— $aq\equiv b\pmod m$ . æ‰€ä»¥è§£å”¯ä¸€ã€‚</p>
<h2 id="å®šç†2"><a href="#å®šç†2" class="headerlink" title="å®šç†2"></a>å®šç†2</h2><blockquote>
<p>(2.1) è‹¥è®° $(a,m)=d$ ï¼Œä¸” $d|b$ ï¼Œé‚£ä¹ˆ(1)å¼å­˜åœ¨è§£ã€‚</p>
<p>(2.2) åœ¨(2.1)çš„å‡è®¾ä¸‹ï¼Œè‹¥(1)å¼å­˜åœ¨è§£ï¼Œé‚£ä¹ˆè§£çš„ä¸ªæ•°ä¸º $d$ ä¸ªã€‚</p>
</blockquote>
<p>é¦–å…ˆä¸éš¾çŸ¥é“(1)ç­‰ä»·äº $ax+my=b$ è¿™ä¸ªä¸å®šæ–¹ç¨‹ã€‚é‚£ä¹ˆ(2.1)æ˜¯æ˜¾ç„¶çš„ã€‚</p>
<p>å¯¹äº(2.2)ï¼Œè€ƒè™‘å°†(1)è½¬åŒ–æˆ</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{a}{d}x+\frac{m}{d}y&=\frac{b}{d}\\
\frac{a}{d}x&\equiv\frac{b}{d}\pmod {\frac{m}{d}}\qquad (2)\\
\end{aligned}</script><p>å¯çŸ¥(1)å’Œ(2)çš„è§£æ˜¯ç›¸åŒçš„ã€‚ç”±å®šç†1ï¼Œä¸” $(\frac{a}{(a,m)},\frac{m}{(a,m)})=1$ å¯çŸ¥(2)çš„è§£æ˜¯å”¯ä¸€çš„ï¼Œè®¾ä¸º $t_0$</p>
<script type="math/tex; mode=display">
x_0\equiv t_0\pmod{\frac{m}{d}}</script><p>å¯çŸ¥ä¸€å®šæœ‰ $0\leq t_0&lt;\frac{m}{d}$ ã€‚</p>
<p>å› æ­¤(1)çš„å…¨éƒ¨è§£ä¸€å®šéƒ½æ˜¯ $t_0+k\frac{m}{d} (k\in \mathbb{Z_+})$ çš„å½¢å¼ã€‚è€ƒè™‘ $k=0,1,2\cdots d-1$ çš„æ—¶å€™ï¼Œæœ‰</p>
<script type="math/tex; mode=display">
t_0+k\frac{m}{d}<\frac{m}{d}</script><p>ä¸”ç”±äºå…¶å•è°ƒæ€§å¯çŸ¥è¿™å‡ ä¸ªè§£äº’å¼‚ã€‚å› æ­¤è¿™ $d$ ä¸ªæ•°åœ¨æ¨¡ $m$ ä¸‹ä¸åŒä½™ã€‚ï¼ˆè¯æ˜äº†è§£è‡³å°‘æœ‰ $d$ ä¸ªï¼‰</p>
<p>å¦ä¸€æ–¹é¢ï¼Œå¯¹(1)çš„ä»»æ„ä¸€è§£ $t_0+k_0\frac{m}{d}$ ï¼Œä»¤ $k_0=qd+r,0\leq r&lt;d$ ä»£å…¥å¾—ï¼š</p>
<script type="math/tex; mode=display">
t_0+k_0\frac{m}{d}\equiv t_0+(qd+r)\frac{m}{d}\equiv t_0+r\frac{m}{d} \pmod m</script><p>å¯çŸ¥å¯¹äºæ¯ä¸ª $k_0$ï¼Œå‡ä¸æŸä¸ª $0\leq k&lt;d$ æ—¶çš„è§£æœ¬è´¨ç›¸åŒã€‚ï¼ˆè¯æ˜äº†è§£è‡³å¤šæœ‰ $d$ ä¸ªï¼‰ã€‚</p>
<p>å› æ­¤ï¼Œè¯¥å¼å…±æœ‰æ°å¥½ $d$ ä¸ªè§£ã€‚</p>
<h2 id="ä¸€èˆ¬è§£æ³•æŠ€å·§"><a href="#ä¸€èˆ¬è§£æ³•æŠ€å·§" class="headerlink" title="ä¸€èˆ¬è§£æ³•æŠ€å·§"></a>ä¸€èˆ¬è§£æ³•æŠ€å·§</h2><p>æœ‰ä¸¤ç§å¸¸ç”¨çš„æŠ€å·§ï¼Œéƒ½æ˜¯åŸºäºå°† $ax\equiv b\pmod m$ è½¬åŒ–ä¸ºå½¢å¼åˆ†å¼ $x\equiv \frac{b}{a}\pmod m$ çš„åŸºç¡€ä¸Šï¼š </p>
<blockquote>
<p>1ã€åˆ†å­åˆ†æ¯åŒä¹˜ä¸€ä¸ªä¸ $m$ äº’è´¨çš„æ•°ã€‚</p>
<p>2ã€å½“ $(a,m)=1$ æ—¶ï¼Œåˆ†å­å¯ä»¥åŠ ä¸Š $m$ çš„å€æ•°ã€‚</p>
</blockquote>
<p>æ³¨æ„åˆ°ï¼Œé™åˆ¶ã€Œä¸ $m$ äº’è´¨ã€çš„ç›®çš„æ˜¯ä¸ºäº†ä¿è¯å½¢å¼åˆ†å¼æœ‰æ„ä¹‰ï¼Œå³åªæœ‰ $(a,m)=1$ï¼Œ$a$ åœ¨æ¨¡ $m$ æ„ä¹‰ä¸‹çš„é€†å…ƒæ‰æœ‰æ„ä¹‰ã€‚</p>
<h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p>ä¸€é“æ¯’ç˜¤é¢˜</p>
<blockquote>
<p> è®¾ $p$ ä¸ºå¥‡ç´ æ•°ï¼Œ$1&lt;a&lt;p$ï¼Œåˆ™ $ax\equiv b\pmod p$ çš„è§£ä¸º</p>
<script type="math/tex; mode=display">
x\equiv b (-1)^{a-1} \frac{(p-1)(p-2)\cdots (p-a+1)}{a!}\pmod p</script></blockquote>
<p>è€ƒè™‘æŠŠ $(-1)^{a-1}$ ä¹˜åˆ°ä¸Šé¢çš„æ‹¬å·é‡Œå»</p>
<script type="math/tex; mode=display">
\begin{aligned}
&(-1)^{a-1} \frac{(p-1)(p-2)\cdots (p-a+1)}{a!}\\ \equiv&\frac{(1-p)(2-p)\cdots (a-1-p)}{a!}\\\equiv&\frac{(1)\cdot (2)\cdots (a-1)}{a!} \equiv\frac{1}{a}\pmod p
\end{aligned}</script><p>ç„¶åå°±è¯å®Œäº†ã€‚æ¯’ç˜¤å°±æ¯’ç˜¤åœ¨â€¦æˆ‘å¤ªä¸ä¼šâ€¦/dk</p>
<p>ä¸ªäººè®¤ä¸ºå†™æˆè¿™æ ·å¸…ä¸€ç‚¹</p>
<script type="math/tex; mode=display">
x\equiv b (-1)^{a-1} \binom{p}{a}\pmod p</script><h1 id="ä¸­å›½å‰©ä½™å®šç†"><a href="#ä¸­å›½å‰©ä½™å®šç†" class="headerlink" title="ä¸­å›½å‰©ä½™å®šç†"></a>ä¸­å›½å‰©ä½™å®šç†</h1><blockquote>
<p>è‹¥ $m_1,m_2\cdots m_k$ ä¸ºä¸¤ä¸¤äº’ç´ çš„æ­£æ•´æ•°ï¼Œè®° $M=\prod m$ ï¼Œ$r_i=\frac{M}{m_i}$ ï¼Œåˆ™ä¸€æ¬¡åŒä½™æ–¹ç¨‹</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{cc}
x \equiv a_{1} & \left(\bmod m_{1}\right) \\
x \equiv a_{2} & \left(\bmod m_{2}\right) \\
\vdots \\
x \equiv a_{k} & \left(\bmod m_{k}\right)
\end{array}\right.</script><p>æœ‰å”¯ä¸€è§£ $x\equiv t$ ï¼Œä¸”</p>
<script type="math/tex; mode=display">
t\equiv\sum _{i=1}^ka_ir_iq_i\pmod M</script><p>å…¶ä¸­ $q_i=\frac{1}{r_i}\pmod {m_i}$ ã€‚</p>
</blockquote>
<p><del>å¥½éš¾èƒŒå•Š</del></p>
<p>ä¸è¿‡æ„é€ æ–¹å¼æ˜¯å¾ˆæœ‰è¶£çš„ã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘ç±»ä¼¼æ‹‰æ ¼æœ—æ—¥æ’å€¼çš„æ„é€ æ–¹æ³•ï¼Œè¦æ‰¾ä¸€å † $\zeta_i$ æ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
\zeta_i\equiv\left\{\begin{array}{cc}
1\pmod {m_j},\qquad j=i\\
0\pmod {m_j},\qquad j\not=i\\
\end{array}\right.</script><p>åˆ™å¯å–</p>
<script type="math/tex; mode=display">
x_0=\sum_{i=1}^k\zeta_ia_i</script><p>ä½œä¸ºä¸€ç»„è§£ã€‚é‚£ä¹ˆæ˜¾ç„¶æ®æ­¤æ„é€ çš„æ–¹æ¡ˆæ»¡è¶³è¿™ä¸ªæ¡ä»¶ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œå¯¹äºå¦ä¸€ä¸ªè§£ $x_1$ æœ‰</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{cc}
x_0 \equiv x_{1} & \left(\bmod m_{1}\right) \\
x_0 \equiv x_{1} & \left(\bmod m_{2}\right) \\
\vdots \\
x_0 \equiv x_{1} & \left(\bmod m_{k}\right)
\end{array}\right.</script><p>ç”±äº $m_1,m_2\cdots m_k$ ä¸¤ä¸¤äº’ç´ ï¼Œå¯çŸ¥ $x_1\equiv x_0\pmod M$ã€‚å³å…¨éƒ¨çš„è§£éƒ½å¯ä»¥è¡¨ç¤ºæˆ</p>
<script type="math/tex; mode=display">
x\equiv x_0\pmod M</script><p>â€‹                                                                              </p>
<h1 id="exCRT"><a href="#exCRT" class="headerlink" title="exCRT"></a>exCRT</h1><blockquote>
<p>å¤§æ¦‚å°±æ˜¯ç»™å‡ºçš„ $m_i$ ä¸å†äº’è´¨çš„æƒ…å†µã€‚</p>
</blockquote>
<p>è€ƒè™‘æ­¤æ—¶æ™®é€šçš„crtä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ã€‚åœ¨ $m_i$ å½¼æ­¤äº’è´¨çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥çŸ¥é“ $r_i=\frac{M}{m_i}$ ä¿è¯ $(m_i,r_i)=1$ï¼Œé‚£ä¹Ÿå°±ä¿è¯äº† $r_i$ åœ¨æ¨¡ $m_i$ æ„ä¹‰ä¸‹å­˜åœ¨é€†å…ƒã€‚ä½†æ˜¯å½“ $(m_i,r_i)&gt;1$ æ—¶ï¼Œ$q_i$ å°±æ²¡æœ‰æ„ä¹‰äº†ã€‚</p>
<p>è€ƒè™‘å¢é‡æ³•ã€‚ä¸€å¼€å§‹æœ‰ä¸¤ä¸ªæ–¹ç¨‹</p>
<script type="math/tex; mode=display">
x\equiv a\pmod b\\
x\equiv c\pmod d \\</script><p>é‚£ä¹ˆæœ‰ $bt+aâ‰¡c \pmod d$ ç”¨ exgcd è§£å‡º $tâ‰¡t_0 \pmod{\frac{d}{(b,d)}}$</p>
<p>ä»£å›å¾— $x â‰¡ x_0 \pmod{[b, d]} $ã€‚è¿™æ ·è¿­ä»£åšä¸‹å»å°±å¥½äº†ã€‚æ„Ÿè§‰å†™è¿™ç§ä»£ç è¿˜æ˜¯è¦æŠŠå˜é‡åˆ†æ¸…ï¼Œå°½é‡å†™çš„æ¸…æ¥šã€æ¾æ•£ä¸€ç‚¹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ; </span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line">ll A[N] ;</span><br><span class="line">ll m[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll &amp;x, ll &amp;y, ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b)&#123; x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> a ; &#125;</span><br><span class="line">    ll g = exgcd(x, y, b, a % b), tmp = x ;</span><br><span class="line">    x = y ; y = tmp - a / b * y ; <span class="keyword">return</span> g ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">exmul</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">	ll res = <span class="number">0</span> ; </span><br><span class="line">	<span class="keyword">while</span> (b)&#123;</span><br><span class="line">		<span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">			(res += a) %= mod ;</span><br><span class="line">		(a += a) %= mod ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">excrt</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll res, mod ;</span><br><span class="line">    ll a, b, c, d, M ;</span><br><span class="line">    ll x, y, t0, t, g, z ;</span><br><span class="line">    res = A[<span class="number">1</span>] ; mod = m[<span class="number">1</span>] ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)&#123;	</span><br><span class="line">        a = res, b = mod ;</span><br><span class="line">        c = A[i], d = m[i] ;</span><br><span class="line">        g = exgcd(x, y, b, d) ;</span><br><span class="line">		z = ((c - a) % d + d) % d ;</span><br><span class="line">		M = d / g ; <span class="keyword">if</span> (z % g &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">        t = exmul(x, (z / g), M) ; mod = mod * M ;</span><br><span class="line">        res = ((res + exmul(t, b, mod)) % mod + mod) % mod ;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios :: sync_with_stdio(<span class="number">0</span>) ;</span><br><span class="line">    <span class="built_in">cin</span>.tie(<span class="number">0</span>) ; <span class="built_in">cout</span>.tie(<span class="number">0</span>) ; <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">cin</span> &gt;&gt; m[i] &gt;&gt; A[i] ;</span><br><span class="line">    ll op = excrt() ; <span class="keyword">if</span> (op &lt; <span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">"hahaha"</span>) ; <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; op ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ç¥å¥‡çš„ä¾‹é¢˜"><a href="#ç¥å¥‡çš„ä¾‹é¢˜" class="headerlink" title="ç¥å¥‡çš„ä¾‹é¢˜"></a>ç¥å¥‡çš„ä¾‹é¢˜</h1><h2 id="CF338D"><a href="#CF338D" class="headerlink" title="CF338D"></a>CF338D</h2><blockquote>
<p>ç»™å‡ºä¸€ä¸ª $n Ã— m$ çš„æ•°è¡¨, å…¶ä¸­ç¬¬ $i$ è¡Œç¬¬ $j$ ä¸ªæ•°æ˜¯ $\gcd(i, j)$ï¼Œå†ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $k$ çš„æ•°åˆ— $\{a_n\}$, åˆ¤æ–­å…¶æ˜¯å¦åœ¨æ•°è¡¨çš„æŸä¸€è¡Œå‡ºç°è¿‡ã€‚</p>
<p>$n,m â‰¤ 10^{12},k â‰¤ 10^4$</p>
</blockquote>
<p>ä¸€é“æœ‰æ„æ€çš„é¢˜ã€‚è€ƒè™‘ç”±äºæ˜¯è¦å»å¯»æ‰¾ä¸€è¡Œï¼Œæ‰€ä»¥è¡Œå·æ˜¯å›ºå®šçš„ã€‚é‚£ä¹ˆå¿…é¡»è¦æœ‰ $\mathrm{lcm}(a_1,a_2\cdots a_k)|x$ ã€‚</p>
<p>è€ƒè™‘æ˜¯å¦å¯ä»¥é€‰ç”¨ $x=\mathrm{lcm}(a_1,a_2\cdots a_k)$ åšç­”æ¡ˆã€‚æ³¨æ„åˆ°å¦‚æœ $x=p\cdot \mathrm{lcm}(a_1,a_2\cdots a_k)$ å¯è¡Œï¼Œé‚£ä¹ˆä¸€å®šæœ‰</p>
<script type="math/tex; mode=display">
\gcd(p,y) = 1</script><p>é‚£ä¹ˆå‘ç°ï¼Œå¯¹äº $p$ çš„ä»»æ„ä¸€ä¸ªå› å­ï¼Œéƒ½æ»¡è¶³è¯¥æ€§è´¨ã€‚æ‰€ä»¥å– $p=1$ å®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚</p>
<p>ä¹‹åè€ƒè™‘å»æ£€éªŒ $y$ çš„åˆæ³•æ€§ã€‚ä»¤ç¬¬ä¸€ä¸ªå…ƒç´ ä¹‹å‰çš„é‚£ä¸ªå…ƒç´ (è·Ÿç­”æ¡ˆæ²¡å…³ç³»çš„)ä¸º $(x,y)$ ã€‚å‘ç° $y$ éœ€è¦æ»¡è¶³</p>
<script type="math/tex; mode=display">
\gcd(y+1,x)=a_1,\gcd(y+2,x)=a_2,\gcd(y+3,x)=a_3\cdots</script><p>æ³¨æ„åˆ° $x$ æ˜¯æ‰€æœ‰ $a_i$ çš„ $\rm lcm$ ã€‚é‚£ä¹ˆå¯ä»¥çŸ¥é“ $y+i$ ä¸€å®šéœ€è¦æ˜¯ $a_i$ çš„å€æ•°ï¼Œä¹Ÿå°±æ˜¯</p>
<script type="math/tex; mode=display">
\left\{\begin{array}{l}
y+1\equiv 0\left(\bmod a_{1}\right) \\
y+2\equiv 0\left(\bmod a_{2}\right) \\
\vdots \\
y+k\equiv 0\left(\bmod a_{k}\right)
\end{array}\right.</script><p>é‚£ä¹ˆç”¨ excrt æ±‚å‡ºè¿™ä¸ª $y$ æ¥å³å¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™æ ·å¹¶ä¸ä»£è¡¨ $y$ åˆæ³•ï¼Œå› ä¸º $y+i$ æ˜¯ $a_i$ çš„å€æ•°ç­‰ä»·äº $\gcd(y+i,x)=a_i\cdot q$ ã€‚ æ‰€ä»¥ä¸ºäº†éªŒè¯æ˜¯å¦åˆæ³•ï¼Œéœ€è¦å†ä»å¤´åˆ¤ä¸€éã€‚</p>
<p>æ³¨æ„åˆ°å¦‚æœæ­¤æ—¶ä¸å­˜åœ¨ç­”æ¡ˆï¼Œé‚£ä¹ˆä¹Ÿä¸€å®šä¸å­˜åœ¨å…¶ä»–çš„ç­”æ¡ˆã€‚è¿™ä¸€ç‚¹æ˜¯æ¯”è¾ƒæ˜¾ç„¶çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Sunzi&#123;</span><br><span class="line">    ll A[N] ;</span><br><span class="line">    ll m[N] ;</span><br><span class="line">    <span class="function">ll <span class="title">exgcd</span><span class="params">(ll &amp;x, ll &amp;y, ll a, ll b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!b)&#123; x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> a ; &#125;</span><br><span class="line">        ll g = exgcd(x, y, b, a % b), tmp = x ;</span><br><span class="line">        x = y ; y = tmp - a / b * y ; <span class="keyword">return</span> g ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">exmul</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">	    ll res = <span class="number">0</span> ;</span><br><span class="line">	    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">		    <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">			    (res += a) %= mod ;</span><br><span class="line">	    	(a += a) %= mod ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">excrt</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ll res, mod ;</span><br><span class="line">        ll a, b, c, d, M ;</span><br><span class="line">        ll x, y, t0, t, g, z ;</span><br><span class="line">        res = A[<span class="number">1</span>] ; mod = m[<span class="number">1</span>] ;</span><br><span class="line">	    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= k ; ++ i)&#123;</span><br><span class="line">            a = res, b = mod ;</span><br><span class="line">            c = A[i], d = m[i] ;</span><br><span class="line">            g = exgcd(x, y, b, d) ;</span><br><span class="line">		    z = ((c - a) % d + d) % d ;</span><br><span class="line">		    M = d / g ; <span class="keyword">if</span> (z % g &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">            t = exmul(x, (z / g), M) ; mod = mod * M ;</span><br><span class="line">            res = ((res + exmul(t, b, mod)) % mod + mod) % mod ;</span><br><span class="line">        &#125;</span><br><span class="line">	    <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Sunzi ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; p &gt;&gt; k ; ll t = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i]), m[i] = base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i) A[i] = -i ; lcm = m[<span class="number">1</span>] ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= k ; ++ i)&#123;</span><br><span class="line">		t = m[i] * lcm, lcm = __gcd(lcm, m[i]), lcm = t / lcm  ;</span><br><span class="line">		<span class="keyword">if</span> (lcm &gt; n) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>), <span class="number">0</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//cout &lt;&lt; lcm &lt;&lt; " " &lt;&lt; t &lt;&lt; endl ; </span></span><br><span class="line">    t = excrt() ; <span class="keyword">if</span> (t &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (ll i = t + <span class="number">1</span> ; i &lt;= t + k ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (__gcd(i, lcm) != base[i - t]) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (t + k &lt;= p) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"YES"</span>), <span class="number">0</span> ; <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>), <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/æ•°è®º</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å¬è¯¾ç¬”è®°ã€‘æ•°è®ºå¬è¯¾ç¬”è®°</title>
    <url>/2020/03/28/%E6%95%B0%E8%AE%BA%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¬æ–¯ç»™æ™®è®²çš„æœ‰è¶£çš„æ•°è®ºé—®é¢˜ï¼Œæ„Ÿè§‰æµ·æ˜Ÿï¼Ÿ</p>
<p>é¡ºä¾¿åŠ ä¸Šäº†ä¸€ç‚¹è‡ªå·±ä¹‹å‰éšä¾¿æ•´ç†çš„ä¸œè¥¿ã€‚</p>
<a id="more"></a>
<h1 id="çæ•´ç†ç³»åˆ—"><a href="#çæ•´ç†ç³»åˆ—" class="headerlink" title="çæ•´ç†ç³»åˆ—"></a>çæ•´ç†ç³»åˆ—</h1><h2 id="gcd-çš„å®ç°"><a href="#gcd-çš„å®ç°" class="headerlink" title="gcd çš„å®ç°"></a>gcd çš„å®ç°</h2><h3 id="ä¸€ä¸ªå¿…è¦çš„å¼å­"><a href="#ä¸€ä¸ªå¿…è¦çš„å¼å­" class="headerlink" title="ä¸€ä¸ªå¿…è¦çš„å¼å­"></a>ä¸€ä¸ªå¿…è¦çš„å¼å­</h3><blockquote>
<p> $a\geq b\to (a,b)=(b,a \bmod ~b)$</p>
</blockquote>
<p>ä»¤$a=bp+q~(0\leq 1&lt;b)$ ã€‚è‹¥ $\exists d|a,d|b$ï¼Œåˆ™æœ‰ $daâ€™=dbâ€™p+q$ï¼Œç§»é¡¹å¾— $q=d(aâ€™-bâ€™p)$ï¼Œæ•…$d|q\Longrightarrow d|(a\bmod~b)$ã€‚</p>
<p>è€ƒè™‘æœ€åï¼Œ$bâ€™=0$ï¼Œæ­¤æ—¶æœ‰$aâ€™=q$ï¼Œåˆå› ä¸º $\forall d$ æ»¡è¶³ $d|a,d|b$, $\exists d|q\to d|aâ€™$ï¼Œå³æ­¤æ—¶$aâ€™$æ˜¯æ‰€æœ‰å› å­çš„å€æ•°ï¼Œæ•… $aâ€™$ ä¸ºæœ€å¤§å…¬å› æ•°ã€‚</p>
<h3 id="å¤æ‚åº¦è¯æ˜"><a href="#å¤æ‚åº¦è¯æ˜" class="headerlink" title="å¤æ‚åº¦è¯æ˜"></a>å¤æ‚åº¦è¯æ˜</h3><p>è€ƒè™‘åˆ†ç±»è®¨è®ºï¼Œä¸å¦¨ä»¤ $a&gt;b$.</p>
<ul>
<li>å½“ $\frac{a}{2}&gt;b$ æ—¶ï¼Œæœ‰ $a\bmod b&lt;b&lt;\frac{a}{2}$</li>
<li>å½“ $\frac{a}{2}\leq b$ æ—¶ï¼Œæœ‰ $a\bmod ~b=a-b&lt;\frac{a}{2}$</li>
</ul>
<p>æ‰€ä»¥å¤æ‚åº¦æ˜¯ $\log(\max(a,b))$ çš„ã€‚</p>
<h2 id="exgcd-çš„å®ç°"><a href="#exgcd-çš„å®ç°" class="headerlink" title="exgcd çš„å®ç°"></a>exgcd çš„å®ç°</h2><p>è€ƒè™‘ä¸¢ç•ªå›¾æ–¹ç¨‹ $ax+by=(a,b)$ ã€‚</p>
<p>å‘ç°è¿­ä»£åˆ° $x=1,y=0$ æ—¶ï¼Œä¸Šå¼ä¾æ—§æˆç«‹ã€‚</p>
<p>åŒæ—¶ï¼Œæœ‰ $bx+y\cdot (a\bmod ~b)=(a,b)$ ï¼ŒåŒ–ç®€ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
bx+y\cdot (a-b\cdot \lfloor \frac{a}{b}\rfloor)&= (a,b)\\
ay+b(x-y\cdot \lfloor \frac{a}{b}\rfloor) &=(a,b)
\end{aligned}</script><p>æŒ‰ç…§è¿™ç§å½¢å¼å‘ä¸Šé€’å½’åï¼Œå°±ä¼šå°‘ä¸€å±‚$\bmod$ ç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚ </p>
<h2 id="é˜¶"><a href="#é˜¶" class="headerlink" title="é˜¶"></a>é˜¶</h2><blockquote>
<p>ä½¿å¾—</p>
<script type="math/tex; mode=display">
a^x\equiv 1(\bmod p)</script><p>çš„æœ€å°çš„ $x$ ç§°ä¸º $a$ å…³äº $p$ çš„<strong>é˜¶</strong>ã€‚</p>
</blockquote>
<p>é‚£ä¹ˆæœ‰ç»“è®º $x|\varphi(p)$ ã€‚</p>
<p>è€ƒè™‘åè¯æ³•ã€‚å› ä¸º</p>
<script type="math/tex; mode=display">
a^x\equiv 1(\bmod p)\\
a^{\varphi(p)} \equiv 1(\bmod p)</script><p>ä¸” $x$ æœ€å°ï¼Œåˆå› ä¸ºå‡è®¾ $x$ ä¸æ˜¯ $\varphi(p)$ çš„çº¦æ•°ï¼Œæ•… $x&lt;\varphi(p)$ ã€‚</p>
<p>é‚£ä¹ˆä¼šæœ‰ä¸å¦¨ä»¤ $\varphi(p)\equiv kx+q(0\leq q&lt;x)$ ï¼Œåˆ™æœ‰</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{a^{\varphi(p)}}{(a^{x})^k}& \equiv a^q\\&\equiv 1(\bmod p)
\end{aligned}</script><p>ä½†è¿™æ˜¾ç„¶ä¸åˆç†ï¼Œå› ä¸º $x&gt;q$ ä½†æ ¹æ®å®šä¹‰ $x$ åº”è¯¥æ˜¯æœ€å°çš„æ»¡è¶³ $a^o\equiv 1(\bmod p)$ çš„æ•°ï¼ŒQEDã€‚</p>
<h2 id="å¨å°”é€Šå®šç†"><a href="#å¨å°”é€Šå®šç†" class="headerlink" title="å¨å°”é€Šå®šç†"></a>å¨å°”é€Šå®šç†</h2><blockquote>
<p>å¯¹äºç´ æ•° $p$ï¼Œæœ‰</p>
<script type="math/tex; mode=display">
(p-1)!\equiv -1 (\bmod p)</script></blockquote>
<p>è¯æ˜å¤§æ¦‚å°±æ˜¯è€ƒè™‘ï¼Œåœ¨$2,3,â€¦,n-3,n-2$ä¸­ï¼Œæ¯ä¸ªæ•°æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªé€†å…ƒï¼Œä¸ä¼š $\geq p$ ä¸”å”¯ä¸€ï¼Œæ‰€ä»¥ä¼šäº’ç›¸æŠµæ¶ˆã€‚</p>
<h1 id="exgcdçš„åº”ç”¨"><a href="#exgcdçš„åº”ç”¨" class="headerlink" title="exgcdçš„åº”ç”¨"></a>exgcdçš„åº”ç”¨</h1><h2 id="ç±»æ¬§å‡ é‡Œå¾—é—®é¢˜"><a href="#ç±»æ¬§å‡ é‡Œå¾—é—®é¢˜" class="headerlink" title="ç±»æ¬§å‡ é‡Œå¾—é—®é¢˜"></a>ç±»æ¬§å‡ é‡Œå¾—é—®é¢˜</h2><script type="math/tex; mode=display">
\sum_{x=1}^{n}\lfloor \frac{ax+b}{c}\rfloor</script><p>å‘ç°å…¶å®æœ¬è´¨ä¸Šæ±‚çš„æ˜¯ä¸€æ¡ç›´çº¿åœ¨ $x$ æ­£åŠè½´å’Œ $y$ çš„æ­£åŠè½´çš„æ•´ç‚¹æ•°é‡ã€‚é‚£ä¹ˆè€ƒè™‘å¯¹äºçŸ©å½¢åŒºåŸŸå¯ä»¥éšä¾¿æ±‚ï¼Œå¯¹äºä¸‰è§’å½¢åŒºåŸŸï¼Œå¯ä»¥è®© $a$ å¯¹ $c$ å–æ¨¡ä¹‹åä¾æ—§ä¸å½±å“ç»“æœï¼Œæ‰€ä»¥è€ƒè™‘æ²¿ç€ $y=x$ å¯¹ç§°ï¼Œé‚£ä¹ˆä¼šä½¿å¾— $\frac{a}{c}$ å˜æˆ $\frac{c}{a}$ ï¼Œè¿™æ ·å°±å¯ä»¥è¾¾åˆ°ä¸€ä¸ªè¾—è½¬ç›¸é™¤çš„æ•ˆæœï¼Œå¤æ‚åº¦ $\log n$ ã€‚</p>
<h2 id="æ‚é¢˜1"><a href="#æ‚é¢˜1" class="headerlink" title="æ‚é¢˜1"></a>æ‚é¢˜1</h2><p>å·²çŸ¥ $a_x=a_{x-1}+a_{x-2}$ ï¼Œç»™å®š $a_1$, æ±‚æœ‰å¤šå°‘ä¸ª $a_2\in[l,r]$ ä½¿å¾— $a_k=b~(\bmod p)$. $k,p=O(10^9)$ ã€‚</p>
<p>å‘ç°æœ€åçš„ $a_k$ ä¸€å®šå¯ä»¥å†™æˆ $ca_1+da_2=a_k=b(\mod p)$ ï¼Œç„¶åå°±è½¬åŒ–æˆä¸€ä¸ªç $exgcd$ é—®é¢˜äº†ã€‚</p>
<h1 id="å¤šé¡¹å¼å¤åˆ"><a href="#å¤šé¡¹å¼å¤åˆ" class="headerlink" title="å¤šé¡¹å¼å¤åˆ"></a>å¤šé¡¹å¼å¤åˆ</h1><blockquote>
<p> å·²çŸ¥ $f(x), g(x)$ï¼Œæ±‚ $f(g(x))\mod x^n$ ï¼Œ$1\leq n,m\leq 4000$ã€‚</p>
</blockquote>
<p>å› ä¸º</p>
<script type="math/tex; mode=display">
f(g(x))=\sum_{i=0}^{n} f_{i} g(x)^{i}</script><p>äºæ˜¯è€ƒè™‘é¢„å¤„ç† $g(x),g^2(x)\cdots g^p(x)$ ï¼Œå’Œ $g^{2p}(x),g^{3p}(x)\cdots$ è¿™æ ·ï¼Œæ¯å—å…ˆå¯¹ $f_{i+kp}g(x)^i$ æ±‚å’Œå†åšå¤šé¡¹å¼ä¹˜æ³•ã€‚</p>
<p>æœ€åå¤æ‚åº¦å°±æ˜¯ $O(nm+\sqrt mn\log n)$</p>
<h1 id="Stern-brocot-Tree"><a href="#Stern-brocot-Tree" class="headerlink" title="Stern-brocot Tree"></a>Stern-brocot Tree</h1><p>å¤§æ¦‚æ˜¯æŠŠ $\frac{0}{1}$ å’Œ $\frac{1}{0}$ å½“åšä¸¤ä¸ªè™šæ ¹ã€‚ç„¶åæ¯æ¬¡åœ¨ä¸¤ä¸ªç‚¹ $\frac{n}{m}$ å’Œ $\frac{nâ€™}{mâ€™}$ ä¸­é—´æ’å…¥ä¸€ä¸ª $\frac{nâ€™+n}{mâ€™+m}$ ã€‚ä¹‹åå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="1.png" alt></p>
<blockquote>
<p>bzoj 2852</p>
<p>ç»™ä¸¤ä¸ªæœ‰ç†æ•° $a,b$ï¼Œæ±‚æœ€å°çš„æ­£æ•´æ•° $k$, ä½¿å¾— $(ak,bk)$ é‡Œæœ‰æ•´æ•°ã€‚</p>
<p>$a$, $b$ æ•´æ•°éƒ¨åˆ†ä¸è¶…è¿‡ $2^{31}$ , å°æ•°ä½æ•°ä¸è¶…è¿‡ $300$ ä½ã€‚</p>
</blockquote>
<p>å‘ç° $(a,b)$ çš„ç­”æ¡ˆå’Œ $(a-1,b-1)$ çš„ç­”æ¡ˆä¸€æ ·ã€‚æ‰€ä»¥è€ƒè™‘å°† $(ak,bk)$ ç§»åŠ¨åˆ° $[0,1)$ è¿™ä¸ªåŒºé—´ã€‚æ­¤æ—¶å¦‚æœ $b\geq 1$ æˆ–è€… $a=0$ é‚£ä¹ˆå°±å¯ä»¥æ‰¾ $0/1$ ã€‚å¦åˆ™å°±å˜æˆäº†è§£è¿™æ ·ä¸€ä¸ªä¸ç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
a \times k \leq t \leq b \times k</script><p>ä¹Ÿå°±æ˜¯</p>
<script type="math/tex; mode=display">
a \leq \frac{t}{k} \leq b</script><p>é‚£ä¹ˆå°±æ˜¯æ‰¾ä¸€ä¸ªåˆ†æ¯æœ€å°çš„å¤¹åœ¨ $a,b$ ä¹‹é—´çš„åˆ†æ•°ã€‚å¹¶ä¸”ç”±äº $b&lt;1$ æ‰€ä»¥ä¸€å®šæ˜¯ä¸ªçœŸåˆ†æ•°ã€‚é‚£ä¹ˆå°±å¯ä»¥åœ¨stern-brocot Treeæ ‘ä¸Šæ‰¾LCAå³å¯ã€‚</p>
<p>è¿™ä¸ªåœ°æ–¹ä¼¼ä¹æ˜¯ä¸ç”¨çœŸçš„å»ºå‡ºæ¥æ ‘ï¼Œå› ä¸ºå­˜åœ¨æŸç§ç¥ç§˜çš„æ ‘ä¸ŠäºŒåˆ†æ–¹å¼ï¼Œååˆ†é«˜å¦™ã€‚</p>
<h1 id="å¢å¡æ–¯å®šç†"><a href="#å¢å¡æ–¯å®šç†" class="headerlink" title="å¢å¡æ–¯å®šç†"></a>å¢å¡æ–¯å®šç†</h1><script type="math/tex; mode=display">
\left(\begin{array}{l}
n \\
m
\end{array}\right) \equiv\left(\begin{array}{l}
n \bmod p \\
m \bmod p
\end{array}\right) \times\left(\begin{array}{l}
\left\lfloor\frac{n}{p}\right\rfloor \\
\left\lfloor\frac{m}{p}\right\rfloor
\end{array}\right) \quad(\bmod p)</script><h2 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h2><p>ä»Šå¤©é‡å­¦äº†ä¸€éï¼Œå‘ç°è¯æ˜å¥½ç®€å•ï¼Ÿ</p>
<p>å¯¹äº $p$ æ˜¯è´¨æ•°è€Œè¨€ï¼Œæ ¹æ®è´¹é©¬å°å®šç†ä¸€å®šæœ‰</p>
<script type="math/tex; mode=display">
(1+x)^p\equiv (1+x) \pmod p</script><p>å’Œ</p>
<script type="math/tex; mode=display">
x\equiv x^p  \pmod p</script><p>æ‰€ä»¥æœ‰</p>
<script type="math/tex; mode=display">
(1+x)^p\equiv 1+x^p \pmod p</script><p>å¦‚æœè®¾ $n=sp+t,~0\leq t&lt;p$ ã€‚é‚£ä¹ˆå°±æœ‰</p>
<script type="math/tex; mode=display">
\begin{aligned}
(1+x)^n\equiv &(1+x)^{sp+t}\\
\equiv &(1+x)^{sp}\cdot (1+x)^t\\
\equiv &(1+x^p)^s\cdot (1+x)^t\\
\equiv &(1+x^p)^{\left\lfloor\frac{n}{p}\right\rfloor}\cdot (1+x)^{x\bmod p}
\end{aligned}\pmod p</script><p>è€ƒè™‘ä¸¤è¾¹éƒ½æš´åŠ›äºŒé¡¹å¼å±•å¼€</p>
<script type="math/tex; mode=display">
\sum_{i=0}^n\binom{n}{i}x^i=\left(\sum_{j=0}^{\left\lfloor\frac{n}{p}\right\rfloor}\binom{n}{j}x^{j\cdot p}\right)\times \left(\sum_{k=0}^{n\bmod p}\binom{n}{k}x^{k}\right)\pmod p</script><p>è§‚å¯Ÿå³è¾¹ã€‚å‘ç°å› ä¸ºåé¢é‚£ä¸ªæ‹¬å·é‡Œ $x$ çš„æ¬¡æ•° $&lt;p$ï¼Œå‰é¢ä¸€ä¸ªæ‹¬å·å†… $x$ çš„æ¬¡æ•°ä¸€å®šæ˜¯ $p$ çš„å€æ•° ã€‚æ‰€ä»¥å¯¹äºæ¯ä¸ª $i$ ï¼Œéƒ½æœ‰å”¯ä¸€çš„ $j\cdot p+k=i$ ï¼ˆå¸¦ä½™é™¤æ³•çš„å”¯ä¸€æ€§ï¼‰ã€‚æ‰€ä»¥å¯çŸ¥</p>
<script type="math/tex; mode=display">
\left(\begin{array}{l}
n\\
m
\end{array}\right) \equiv\left(\begin{array}{l}
n \bmod p \\
m \bmod p
\end{array}\right) \times\left(\begin{array}{l}
\left\lfloor\frac{n}{p}\right\rfloor \\
\left\lfloor\frac{m}{p}\right\rfloor
\end{array}\right) \quad(\bmod p)</script><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Lucas_T&#123;</span><br><span class="line">	<span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line">	ll ans, tn, tm, tp, fac[N], inv[N] ;</span><br><span class="line">	<span class="function">ll <span class="title">expow</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">		ll ret = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">while</span> (b)&#123;</span><br><span class="line">			<span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">				(ret *= a) %= mod ;</span><br><span class="line">			(a *= a) %= mod ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ret ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">my_assign</span><span class="params">(ll x, ll y, ll z)</span></span>&#123;</span><br><span class="line">		tn = x ; tm = y ; tp = z ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">pre_do</span><span class="params">(<span class="keyword">int</span> U)</span></span>&#123;</span><br><span class="line">		fac[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line">			fac[i] = fac[i - <span class="number">1</span>] * (ll)i % tp ;</span><br><span class="line">		inv[U] = expow(fac[U], tp - <span class="number">2</span>, tp) ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = U ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">			inv[i - <span class="number">1</span>] = inv[i] * (ll)i % tp ;</span><br><span class="line">		<span class="comment">//debug(fac, 1, U, '\n') ;</span></span><br><span class="line">		<span class="comment">//debug(inv, 1, U, '\n') ;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">ll <span class="title">comb</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> fac[a] * inv[b] % tp * inv[a - b] % tp ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">ll <span class="title">do_do</span><span class="params">(ll x, ll y)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (x &lt; y) <span class="keyword">return</span> <span class="number">0l</span>l ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x &lt; tp) <span class="keyword">return</span> comb(x, y) ; </span><br><span class="line">		<span class="keyword">return</span> do_do(x % tp, y % tp) * do_do(x / tp, y / tp) % tp ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Lucas</span><span class="params">()</span></span>&#123;</span><br><span class="line">		my_assign(n + m, n, p) ; </span><br><span class="line">		pre_do(tp - <span class="number">1</span>) ; ans = do_do(tn, tm) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çŸ¥é“çš„æ˜¯ï¼ŒLucaså®šç†è¿˜æœ‰å¦ä¸€ç§è¡¨ç¤ºæ–¹å¼ã€‚å¦‚æœæŠŠ $m,n$ éƒ½çœ‹ä½œ $p$ è¿›åˆ¶æ•°çš„è¯ï¼Œå³</p>
<script type="math/tex; mode=display">
m=(\overline{m_1m_2\cdots m_k})_p\\
n=(\overline{n_1n_2n_3\cdots n_k})_p</script><p>é‚£ä¹ˆæœ‰</p>
<script type="math/tex; mode=display">
\binom{n}{m}\equiv\prod _{i=1}^k \binom{n_i}{m_i} \pmod p</script><p>å…¶å®ä¸éš¾ç†è§£ï¼Œå¯ä»¥è”æƒ³åè¿›åˆ¶æ•°æ‹†åˆ†å‡ºæ¯ä¸€ä½çš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯ $\bmod 10$ ä¹‹åå†é™¤ä»¥ $10$ ã€‚</p>
<h2 id="ä¾‹é¢˜ï¼šå¤ä»£çŒªæ–‡"><a href="#ä¾‹é¢˜ï¼šå¤ä»£çŒªæ–‡" class="headerlink" title="ä¾‹é¢˜ï¼šå¤ä»£çŒªæ–‡"></a>ä¾‹é¢˜ï¼šå¤ä»£çŒªæ–‡</h2><blockquote>
<p>æ±‚ $g^\sum\textstyle_{d|n}\binom{n}{d}\bmod 999911659$ ã€‚</p>
</blockquote>
<p>å‘ç° $999911658=2\times 3\times 4679\times 35617$ ï¼Œç„¶ååˆ†åˆ«åš Lucas å†æ‹¿crtåˆå¹¶èµ·æ¥å°±å¥½äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">999911659</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(ll *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">int</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000110</span> ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Lucas_T&#123;</span><br><span class="line">	ll ans ;</span><br><span class="line">    ll tp, tn, tm ;</span><br><span class="line">    ll fac[N], inv[N] ;</span><br><span class="line">	<span class="function">ll <span class="title">expow</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">		ll ret = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">while</span> (b)&#123;</span><br><span class="line">			<span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">				(ret *= a) %= mod ;</span><br><span class="line">			(a *= a) %= mod ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ret ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">my_assign</span><span class="params">(ll x, ll y, ll z)</span></span>&#123;</span><br><span class="line">		tn = x ; tm = y ; tp = z ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">pre_do</span><span class="params">(<span class="keyword">int</span> U)</span></span>&#123;</span><br><span class="line">		fac[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line">			fac[i] = fac[i - <span class="number">1</span>] * (ll)i % tp ;</span><br><span class="line">		inv[U] = expow(fac[U], tp - <span class="number">2</span>, tp) ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = U ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">			inv[i - <span class="number">1</span>] = inv[i] * (ll)i % tp ;</span><br><span class="line">		<span class="comment">//debug(fac, 1, U, '\n') ;</span></span><br><span class="line">		<span class="comment">//debug(inv, 1, U, '\n') ;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">ll <span class="title">comb</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> fac[a] * inv[b] % tp * inv[a - b] % tp ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">ll <span class="title">do_do</span><span class="params">(ll x, ll y)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (x &lt; y) <span class="keyword">return</span> <span class="number">0l</span>l ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x &lt; tp) <span class="keyword">return</span> comb(x, y) ;</span><br><span class="line">		<span class="keyword">return</span> do_do(x % tp, y % tp) * do_do(x / tp, y / tp) % tp ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">ll <span class="title">Lucas</span><span class="params">(ll x, ll y, ll z)</span></span>&#123;</span><br><span class="line">        my_assign(x, y, z) ;</span><br><span class="line">        ans = do_do(tn, tm) ; <span class="keyword">return</span> ans ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Sunzi&#123;</span><br><span class="line">    ll A[N], m[N] ;</span><br><span class="line">    <span class="function">ll <span class="title">exgcd</span><span class="params">(ll &amp;x, ll &amp;y, ll a, ll b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!b)&#123; x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> a ; &#125;</span><br><span class="line">        ll g = exgcd(x, y, b, a % b), tmp = x ;</span><br><span class="line">        x = y ; y = tmp - a / b * y ; <span class="keyword">return</span> g ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">exmul</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">	    ll res = <span class="number">0</span> ;</span><br><span class="line">	    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">		    <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">			    (res += a) %= mod ;</span><br><span class="line">	    	(a += a) %= mod ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">excrt</span><span class="params">(<span class="keyword">int</span> pn)</span></span>&#123;</span><br><span class="line">        ll res, mod ;</span><br><span class="line">        ll a, b, c, d, M ;</span><br><span class="line">        ll x, y, t0, t, g, z ;</span><br><span class="line">        res = A[<span class="number">1</span>] ; mod = m[<span class="number">1</span>] ;</span><br><span class="line">	    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= pn ; ++ i)&#123;</span><br><span class="line">            a = res, b = mod ;</span><br><span class="line">            c = A[i], d = m[i] ;</span><br><span class="line">            g = exgcd(x, y, b, d) ;</span><br><span class="line">		    z = ((c - a) % d + d) % d ;</span><br><span class="line">		    M = d / g ; <span class="keyword">if</span> (z % g &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">            t = exmul(x, (z / g), M) ; mod = mod * M ;</span><br><span class="line">            res = ((res + exmul(t, b, mod)) % mod + mod) % mod ;</span><br><span class="line">        &#125;</span><br><span class="line">	    <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> k ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line">ll n, g ;</span><br><span class="line">ll res[N] ;</span><br><span class="line">ll base[N] ;</span><br><span class="line">ll p[<span class="number">4</span>] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4679</span>, <span class="number">35617</span>&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; g ;</span><br><span class="line">    <span class="keyword">if</span> (g % P == <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"0"</span>), <span class="number">0</span> ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="built_in">sqrt</span>(n) ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) base[++ cnt] = i ;</span><br><span class="line">    <span class="keyword">int</span> t = cnt ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= t ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (n / base[i] &gt; <span class="built_in">sqrt</span>(n))</span><br><span class="line">            base[++ cnt] = n / base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= <span class="number">3</span> ; ++ i)&#123;</span><br><span class="line">        Lucas_T :: tp = p[i] ;</span><br><span class="line">		Lucas_T :: pre_do(p[i] - <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)</span><br><span class="line">            (res[i] += Lucas_T :: Lucas(n, base[j], p[i])) %= (P - <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= <span class="number">3</span> ; ++ i)</span><br><span class="line">        Sunzi :: A[i + <span class="number">1</span>] = res[i], Sunzi :: m[i + <span class="number">1</span>] = p[i] ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; Lucas_T :: expow(g, Sunzi :: excrt(<span class="number">4</span>), P) &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¾‹é¢˜ï¼šç»„åˆæ•°é—®é¢˜"><a href="#ä¾‹é¢˜ï¼šç»„åˆæ•°é—®é¢˜" class="headerlink" title="ä¾‹é¢˜ï¼šç»„åˆæ•°é—®é¢˜"></a>ä¾‹é¢˜ï¼šç»„åˆæ•°é—®é¢˜</h2><blockquote>
<p>æ±‚ $0â‰¤jâ‰¤iâ‰¤n$ ä¸” $jâ‰¤m$ çš„æ•°å¯¹ $(i,j)$ é‡Œæœ‰å¤šå°‘æ»¡è¶³ $\binom{i}{j}â‰¡0 \pmod p$</p>
<p>$T â‰¤ 100,n,m â‰¤ 10^{18},p â‰¤ 100$ ä¸”æ˜¯ä¸€ä¸ªè´¨æ•°.</p>
</blockquote>
<p>æ ¹æ®ä¸Šé¢é‚£ä¸ªæ€§è´¨ï¼Œåªè¦ $p$ è¿›åˆ¶ä¸‹ $i$ çš„ä»»ä½•ä¸€ä½ $&lt;j$ å°± $\equiv 0$ ã€‚ç„¶åå°±ç›´æ¥æ•°ä½dpå°±å®Œäº†ã€‚</p>
<h2 id="å°-Q-çš„é›†åˆ"><a href="#å°-Q-çš„é›†åˆ" class="headerlink" title="å° Q çš„é›†åˆ"></a>å° Q çš„é›†åˆ</h2><blockquote>
<p>æ±‚ä» $n$ å…ƒé›†åˆ $\rm S$ ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå­é›† $\rm T$ ã€‚æ±‚ $|\mathrm{Sâˆ’T}|^k âˆ’|\mathrm{T}|^k$ çš„æ–¹å·®ã€‚</p>
<p>$nâ‰¤10^{10^6},kâ‰¤10$ï¼Œç­”æ¡ˆå¯¹è´¨æ•° $mâ‰¤10^6$ å–æ¨¡ã€‚</p>
</blockquote>
<p>å—¯ï¼Œå­¦ä¹ äº†ä¸€ä¸‹æ–¹å·®çš„å®šä¹‰ã€‚è®°è¿™ä¸ªä¸œè¥¿çš„æœŸæœ›æ˜¯ $E(x)$ ï¼Œé‚£ä¹ˆæ–¹å·®å°±æ˜¯ $E([x-E(x)]^2)=E(x^2)-E^2(x)$ã€‚</p>
<p>å—¯ï¼Œå¾—å‡ºç»“è®ºï¼Œæ¦‚ç‡è®ºè¿™ä¸€å¥—æ˜¯å­¦ä¸æ‡‚çš„ã€‚</p>
<p>è¯´åšæ³•å§ã€‚æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§ï¼Œå¯ä»¥å¾—åˆ°è¿™ä¸ªä¸œè¥¿çš„æœŸæœ›æ˜¯</p>
<script type="math/tex; mode=display">
E(|\mathrm{Sâˆ’T}|^k âˆ’|\mathrm{T}|^k)= E(|\mathrm{Sâˆ’T}|^k)-E(|\mathrm{T}|^k)</script><p>é‚£ä¹ˆæ˜¾ç„¶è¿™ä¸¤é¡¹æ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥è¿™ä¸ªä¸œè¥¿çš„æœŸæœ›å°±æ˜¯ $0$ ã€‚æ‰€ä»¥å°±åªéœ€è¦æ±‚ $|\mathrm{Sâˆ’T}|^k âˆ’|\mathrm{T}|^k$ çš„å¹³æ–¹çš„æœŸæœ›å°±å¯ä»¥äº†ã€‚é‚£ä¹ˆç­”æ¡ˆä¹Ÿå°±æ˜¯</p>
<script type="math/tex; mode=display">
\frac{\sum\limits_{i=0}^{n}\binom{n}{i}\left(i^{k}-(n-i)^{k}\right)^{2}}{2^n}</script><p>emmmç„¶è€Œå¹¶ä¸å¯ä»¥ç›´æ¥åšã€‚ç„¶åæœ‰ä¸ªå¾ˆç¥ä»™çš„ç‚¹å°±æ˜¯è€ƒè™‘æ‹¿Lucaså®šç†æ¥å±•å¼€ä¸€å±‚å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\sum_{i=0}^{\lfloor \frac{n}{m}\rfloor}\left(\begin{array}{c}
\left\lfloor\frac{n}{m}\right\rfloor \\
i
\end{array}\right) \sum_{j=0}^{n \bmod m}\left(\begin{array}{c}
n \bmod m \\
j
\end{array}\right)\left(j^{k}-(n-j)^{k}\right)^{2}</script><p>è¿™ä¹ˆåšæ˜¯å¯¹çš„å°±åœ¨äºæ¯ä¸ª $\binom{n}{j}$ éƒ½è¢«åˆ†è§£æˆäº†å”¯ä¸€çš„ $\binom{\lfloor \frac{n}{m}\rfloor}{i}\cdot \binom{n\bmod m}{j}$ ï¼Œé‚£ä¹ˆè¿™ä¸¤éƒ¨åˆ†å°±å¯ä»¥<strong>åˆ†åˆ«ç®—äº†</strong>ã€‚ç¬¬ä¸€éƒ¨åˆ†å¾ˆæ˜¾ç„¶å°±æ˜¯ $2^n$ ï¼Œç¬¬äºŒéƒ¨åˆ†ç›´æ¥åšå°±å¯ä»¥äº†ã€‚</p>
<p>å—¯ï¼Œè¿™é¢˜çœŸæ˜¯ååˆ†é«˜å¦™ã€‚</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ•°è®ºæœ‰æ„æ€ï¼</p>
<p>exLucasæ˜¯ä¸å¯èƒ½å­¦çš„â€¦</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/æ‰©å±•æ¬§å‡ é‡Œå¾·</tag>
        <tag>æ•°å­¦/æ•°è®º</tag>
        <tag>æ•°å­¦/é˜¶ä¸åŸæ ¹</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å¬è¯¾ç¬”è®°ã€‘å¸¦æƒäºŒåˆ†(wqsäºŒåˆ†)</title>
    <url>/2020/03/25/%E5%B8%A6%E6%9D%83%E4%BA%8C%E5%88%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¿™ä¸ªä¸œè¥¿å¤§æ¦‚å¥½æ—©å°±æƒ³å­¦äº†ï¼Œä½†æ˜¯ä¸€ç›´æ²¡å­¦ã€‚è¿™æ¬¡å°±è®¤çœŸå­¦ä¸€ä¸‹å§ã€‚</p>
<a id="more"></a>
<h1 id="åŸºç¡€æ“ä½œ"><a href="#åŸºç¡€æ“ä½œ" class="headerlink" title="åŸºç¡€æ“ä½œ"></a>åŸºç¡€æ“ä½œ</h1><p>å½“é¢˜ç›®ç»™äº†ä¸€ä¸ªé€‰ç‰©å“çš„é™åˆ¶æ¡ä»¶ï¼Œè¦æ±‚åˆšå¥½é€‰ $m$ ä¸ªï¼Œè¦æ±‚æœ€å¤§åŒ–/æœ€å°åŒ–æƒå€¼ï¼Œç„¶åå…¶ç‰¹ç‚¹å°±æ˜¯å½“é€‰çš„ç‰©å“è¶Šå¤šçš„æ—¶å€™æƒå€¼è¶Šå¤§(è¶Šå°)ã€‚</p>
<p><del>ç„¶åå¤§æ¦‚è¿™ä¸ªå‡¸æ€§ä¸€èˆ¬éƒ½æ˜¯é çŒœçš„</del></p>
<p>è€ƒè™‘å»äºŒåˆ†ä¸€ä¸ª $w$ï¼Œè¡¨ç¤ºé€‰ä¸€ä¸ªæ»¡è¶³é™åˆ¶çš„ç‰©å“æ—¶é™„åŠ çš„æƒå€¼ï¼Œå¦‚æœ $w$ è¶Šå¤§ï¼Œé‚£ä¹ˆé€‰çš„ç‰©å“ä¸ªæ•°å°±ä¼šè¶Šå¤š/è¶Šå°‘ï¼Œæƒå€¼è¶Šå¤§/å°ã€‚è€ƒè™‘å½“è¿™ä¸ªå‡½æ•°æ˜¯å‡¸çš„æ—¶å€™ï¼Œäºæ˜¯å½“é€‰çš„ç‰©å“ä¸ªæ•°å¤§äº $m$ æ—¶ï¼Œå‡å° $w$ï¼Œå¦åˆ™å¢å¤§ $w$ï¼Œæœ€åè®¡ç®—ç­”æ¡ˆçš„æ—¶å€™å»æ‰ $w$ å€¼çš„å½±å“å³å¯ã€‚</p>
<p>è€ƒè™‘è¿™ä¹ˆåšçš„åŸç†ã€‚å¦‚æœè®¾ $f(x)$ è¡¨ç¤ºé€‰äº† $x$ ä¸ªæ»¡è¶³é™åˆ¶çš„ç‰©å“æ—¶çš„æœ€ä¼˜è§£ã€‚é‚£ä¹ˆæ ¹æ®å‡¸æ€§ï¼Œ$f(x)$ éšç€ $x$ çš„å¢å¤§ï¼Œæ–œç‡å•è°ƒï¼Œæ‰€ä»¥ä¸€å®šä¼šæ˜¯ä¸€ä¸ªä¸‹å‡¸å£³æˆ–è€…ä¸Šå‡¸å£³ã€‚ä½†é—®é¢˜å°±åœ¨äºå”¯ä¸€çŸ¥é“çš„ä¿¡æ¯åªæ˜¯å…¶å‡¸æ€§ï¼Œæ— æ³•æ±‚å‡º $f(m)$ çš„å‡†ç¡®å€¼ã€‚</p>
<p>è€ƒè™‘å‡¸å£³çš„ä¸€ä¸ªç‰¹ç‚¹ã€‚å‡è®¾è¿™ä¸ªå‡¸å£³æ˜¯å…‰æ»‘çš„ï¼Œé‚£ä¹ˆå¯¹äºæ¯ä¸ªæ–œç‡ $k$ ï¼Œå‡¸å£³ä¸Šä¸€å®šå­˜åœ¨ä¸€ç‚¹ä¸æŸæ¡è¯¥æ–œç‡çš„ç›´çº¿ç›¸åˆ‡ã€‚åŒæ—¶å‡è®¾æ–œç‡ä¸º $k$ ä½†ä¸é™åˆ¶æˆªè·çš„ç›´çº¿ $l$ ä¸è¯¥å‡¸å£³æœ‰äº¤æ—¶ï¼Œæˆªè·çš„æå€¼ä¸€å®šæ˜¯å–åˆ° $l$ ä¸å‡¸å£³ç›¸åˆ‡çš„æ—¶å€™ã€‚</p>
<p>è®°æˆªè·ä¸º $b$ ã€‚å¯çŸ¥æœ‰ $b=f(x) - kx$ ã€‚è€ƒè™‘æ„é€ è¿™ä¸ªå¼å­ä¸­ $b$ çš„å«ä¹‰ï¼Œå‘ç°æœ¬è´¨ä¸Šç­‰ä»·äºæ¯é€‰ä¸€ä¸ªç‰©å“ï¼Œ$f(x)$ å°±è¦å‡æ‰ $k$ ï¼Œæœ€ç»ˆé€‰äº† $x$ ä¸ªç‰©å“ï¼Œæ€»ç­”æ¡ˆå°±è¦å‡å° $kx$ ã€‚ æ‰€ä»¥è€ƒè™‘å¦‚æœæŠŠæ‰€æœ‰ç‰©å“çš„æƒå€¼ä¸€å¼€å§‹å°±å‡æ‰ $k$ï¼Œé‚£ä¹ˆå½“ $f(x)$ æœ€å¤§æ—¶ï¼Œ$b$ ä¹Ÿä¸€å®šæœ€å¤§ã€‚æ‰€ä»¥æ­¤æ—¶å¯¹äºæŸä¸ªæ–œç‡ $k$ï¼Œéƒ½å¯ä»¥çº¿æ€§æˆ–è€…ä½æ¬¡ $poly(\log)$ æ±‚å‡º $\min\{f(x)\}$ å¹¶ä¸”æ±‚å‡ºå†³ç­–ç‚¹ $x$ã€‚</p>
<p>è€ƒè™‘å¦‚ä½•åŠ é€Ÿè¿™ä¸ªè¿‡ç¨‹ã€‚å‘ç°åœ¨å‡¸çš„æ—¶å€™ï¼Œæ–œç‡ $k$ å’Œ $x$ åŒæ—¶å•è°ƒï¼Œäºæ˜¯è€ƒè™‘äºŒåˆ†è¿™ä¸ªæ–œç‡ã€‚ä¾‹å¦‚åœ¨æŸä¸ªæ–œç‡ $kâ€™$ ä¸‹é€‰æ‹©çš„ç‰©å“ $&gt;m$ ï¼Œé‚£ä¹ˆå°±éœ€è¦è®© $x$ å˜å°ï¼Œæ ¹æ® $k$ å’Œ $x$ çš„ç›¸å¯¹å•è°ƒå…³ç³»è°ƒæ•´å³å¯ã€‚</p>
<h1 id="12å¹´é›†è®­é˜Ÿèƒ¡ç­–-Tree-I"><a href="#12å¹´é›†è®­é˜Ÿèƒ¡ç­–-Tree-I" class="headerlink" title="12å¹´é›†è®­é˜Ÿèƒ¡ç­– Tree I"></a>12å¹´é›†è®­é˜Ÿèƒ¡ç­– Tree I</h1><blockquote>
<p>ç»™ä½ â¼€ä¸ªâ½†å‘å¸¦æƒè¿é€šå›¾ï¼Œæ¯æ¡è¾¹æ˜¯â¿Šâ¾Šæˆ–â½©â¾Šã€‚è®©ä½ æ±‚â¼€æ£µæœ€â¼©æƒçš„æ°å¥½æœ‰ $need$ æ¡â½©â¾Šè¾¹çš„â½£æˆæ ‘ã€‚</p>
<p>$1\leq n\leq 50000,1\leq m\leq 100000$ ã€‚</p>
</blockquote>
<p>å‘ç°å°±æ˜¯ $wqs$ äºŒåˆ†çš„è£¸é¢˜ã€‚é‚£ä¹ˆè€ƒè™‘ç›´æ¥å»äºŒåˆ†æ¯æ¡ç™½è¾¹åŠ ä¸Šçš„æƒå€¼ $w$ å³å¯ã€‚æ³¨æ„åˆ°ç™½è¾¹æ— è®º $w$ æ˜¯å¤šå°‘ï¼Œé€‰å–æ—¶çš„å•è°ƒæ€§ä¸å˜ã€‚æ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ªå°†å¤æ‚åº¦ä» $m(\log m+\log n) \log V$ ä¼˜åŒ–åˆ° $m\log n\log v+m\log m $ã€‚æ³¨æ„åˆ°å¹¶æŸ¥é›†çš„ $\log $ æ˜¯æå°çš„ã€‚</p>
<p>ä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é¢˜æ„é€ æ–¹æ¡ˆçš„è¯å¹¶ä¸å­˜åœ¨ä¸€ä¸ªå¾ˆç®€å•çš„æ–¹æ³•ã€‚</p>
<p>è¿˜æœ‰ä¸€ç‚¹ç»†èŠ‚éœ€è¦æ³¨æ„ã€‚å°±æ˜¯å‡è®¾å­˜åœ¨æŸå‡ æ¡é»‘è¾¹ä¸åŠ æƒä¹‹åçš„ç™½è¾¹æƒå€¼ç›¸åŒçš„è¯ï¼Œä¸èƒ½éšä¾¿é€‰ã€‚æœ¬è´¨ä¸Šï¼Œä¼˜å…ˆé€‰é»‘è¾¹å’Œä¼˜å…ˆé€‰ç™½è¾¹éƒ½ä¸€æ ·ã€‚ä¹Ÿå°±æ˜¯éœ€è¦è§„å®šä¼˜å…ˆé€‰ç™½è¾¹æˆ–è€…ä¼˜å…ˆé€‰é»‘è¾¹ï¼Œä½†æ˜¯ä¸¤è€…çš„å¤„ç†æ–¹å¼æ˜¯ä¸åŒçš„ã€‚å¦‚æœä¼˜å…ˆé€‰é»‘è¾¹çš„è¯ï¼Œé‚£ä¹ˆåˆ¤çš„æ—¶å€™å°±è¦åˆ¤ $\leq$ ï¼Œä¼˜å…ˆé€‰ç™½è¾¹åˆ™éœ€è¦åˆ¤ $\geq$ ã€‚</p>
<p>äº²æµ‹ä¼¼ä¹ä¼˜å…ˆé€‰ç™½è¾¹ä¼šå¿«ä¸€ç‚¹ã€‚ä¸‹é¢æ˜¯ä¼˜å…ˆé€‰é»‘è¾¹çš„ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> fr ;</span><br><span class="line">	<span class="keyword">int</span> to ;</span><br><span class="line">	<span class="keyword">int</span> clr ;</span><br><span class="line">	<span class="keyword">int</span> val ; </span><br><span class="line">	<span class="keyword">int</span> next ;</span><br><span class="line">&#125;E[N &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt ; </span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ; </span><br><span class="line"><span class="keyword">int</span> n, m, k ;</span><br><span class="line"><span class="keyword">int</span> head[N] ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> w, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">	to(++ cnt) = y ;  </span><br><span class="line">	nxt(cnt) = head[x] ; head[x] = cnt ;</span><br><span class="line">	fr(cnt) = x ; val(cnt) = w ; clr(cnt) = c ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> fa[x] == x ? x : fa[x] = find(fa[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(Edge a, Edge b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.val == b.val ? a.clr &gt; b.clr : a.val &lt; b.val ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">mst</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> re = <span class="number">0</span>, ret = <span class="number">0</span>, y = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">		<span class="keyword">if</span> (!clr(i)) val(i) += x ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) fa[i] = i ;</span><br><span class="line">	sort(E + <span class="number">1</span>, E + cnt + <span class="number">1</span>, comp) ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">int</span> f1 = find(fr(i)) ;</span><br><span class="line">		<span class="keyword">int</span> f2 = find(to(i)) ;</span><br><span class="line">		<span class="keyword">if</span> (f1 == f2) <span class="keyword">continue</span> ; </span><br><span class="line">		ret += val(i) ; fa[f1] = f2 ;  </span><br><span class="line">		re += (clr(i) ^ <span class="number">1</span>) ; ++ y ; </span><br><span class="line">		<span class="keyword">if</span> (y == n - <span class="number">1</span>) <span class="keyword">break</span> ;  </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">		<span class="keyword">if</span> (!clr(i)) val(i) -= x ; </span><br><span class="line">	<span class="comment">//cout &lt;&lt; x &lt;&lt; " " &lt;&lt; re &lt;&lt; " " &lt;&lt; ret &lt;&lt; endl ;</span></span><br><span class="line">	<span class="keyword">if</span> (re &lt;= k)&#123;</span><br><span class="line">		ans = ret - k * x ;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> u, v, w, c ;</span><br><span class="line">	ios:: sync_with_stdio(<span class="literal">false</span>) ;</span><br><span class="line">	<span class="built_in">cin</span>.tie(<span class="number">0</span>) ; <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; w &gt;&gt; c, add(++ u, ++ v, w, c) ;</span><br><span class="line">	<span class="keyword">int</span> l = <span class="number">-10000</span>, r = <span class="number">10000</span>, mid, res ;</span><br><span class="line">	<span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">		mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">		<span class="comment">//cout &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; endl ;</span></span><br><span class="line">		<span class="keyword">if</span> (mst(mid)) r = mid - <span class="number">1</span> ; <span class="keyword">else</span> l = mid + <span class="number">1</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//cout &lt;&lt; res &lt;&lt; endl ; mst(res) ;</span></span><br><span class="line">	<span class="built_in">cout</span>.tie(<span class="number">0</span>) ; <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="IOI2000-é‚®å±€"><a href="#IOI2000-é‚®å±€" class="headerlink" title="IOI2000 é‚®å±€"></a>IOI2000 é‚®å±€</h1><blockquote>
<p>â¼€æ¡è·¯æœ‰ $n$ ä¸ªæ‘åº„ï¼Œä½ è¦å»º $k$ ä¸ªé‚®å±€ï¼Œæ¯ä¸ªæ‘åº„åˆ°æœ€è¿‘é‚®å±€è·ç¦»æœ€å°ã€‚</p>
<p>$k\leq 300,n\leq 3000$ ã€‚</p>
</blockquote>
<p>è¿™ä¸ªä¸œè¥¿ï¼Œå°±æ˜¾ç„¶æ˜¯ $f_{i,j}$ è®°ä¸€ä¸‹ï¼Œç„¶åæ”¾ $k\to i$ çš„ä¸­ç‚¹å°±å¥½äº†ã€‚è¿™æ ·å¤æ‚åº¦æ˜¯ $n^2k$ çš„ã€‚ç„¶åç¼–ä¸€ä¸‹å‘ç°æœ‰å†³ç­–å•è°ƒæ€§ï¼Œå°±å¯ä»¥ $O(nk\log n)$ ç”šè‡³ $O(nk)$ äº†ã€‚</p>
<p>ç„¶è€Œè¿™ä¸ªåœ°æ–¹æ‰“ç®—è®°å½•ä¸€ä¸‹æ€ä¹ˆ $wqs$ åšã€‚è€ƒè™‘å»ä¼˜åŒ–ä¸€ä¸‹ä¸Šé¢é‚£ç§è§£æ³•ï¼Œå‘ç° $k$ è¿™ä¸ªé™åˆ¶å¯ä»¥é€šè¿‡wqsäºŒåˆ†ç»™æ¶ˆæ‰ï¼Œå°±å˜æˆäº†å¦‚æœå»ºä¸€æ¬¡é‚®å±€éœ€è¦é¢å¤–æ”¯ä»˜ $mid$ çš„ä»£ä»·ï¼Œä½†æ˜¯ä¸é™åˆ¶å»ºçš„æ¬¡æ•°æ—¶çš„æœ€çŸ­è·ç¦»å’Œã€‚è¿™ä¸ªä¸œè¥¿å°±å˜æˆäº†ä¸€ä¸ª1D/1Dçš„ $dp$ ï¼Œå¹¶ä¸”ä¹Ÿå…·æœ‰å†³ç­–å•è°ƒæ€§ã€‚è¿™ä¸€éƒ¨åˆ†å°±å¯ä»¥ç»§ç»­å•è°ƒæ ˆ+äºŒåˆ†åšåˆ° $n\log V\log n$ </p>
<p>ä¼¼ä¹æœ‰ä»€ä¹ˆå¾ˆä¼˜ç§€çš„å•è°ƒé˜Ÿåˆ—åšæ³•å¯ä»¥åšåˆ°çº¿æ€§ã€‚ä¸è¿‡å†™äº†å†™å‘ç°ä¼¼ä¹äºŒåˆ†çš„å¸¸æ•°è¿˜æ˜¯å¾ˆå°çš„ï¼Œ$n=5\times 10^5$ ä¹Ÿåªéœ€è¦è°· $2.7s$ ã€uoj $2s$ å·¦å³ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">//#define int long long </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tp ;</span><br><span class="line">ll res ;</span><br><span class="line">ll f[N] ;</span><br><span class="line">ll sum[N] ;</span><br><span class="line"><span class="keyword">int</span> lrg[N] ;</span><br><span class="line"><span class="keyword">int</span> cnt[N] ;</span><br><span class="line"><span class="keyword">int</span> stk[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, k ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IPT &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">1</span> &lt;&lt; <span class="number">21</span>;</span><br><span class="line"><span class="keyword">char</span> buf[L], *front=buf, *end=buf;</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">GetChar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (front == end) end = buf + fread(front = buf, <span class="number">1</span>, L, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">return</span> (front == end) ? <span class="number">-1</span> : *(front++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">qr</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> ch = GetChar(), lst = x = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch)) lst = ch, ch = GetChar();</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch)) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = GetChar();</span><br><span class="line">  <span class="keyword">if</span> (lst == <span class="string">'-'</span>) x = -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qra</span><span class="params">(T *<span class="keyword">const</span> __ary, <span class="keyword">int</span> __n)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= __n; ++i) qr(__ary[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qrs</span><span class="params">(T *p)</span> </span>&#123;</span><br><span class="line">  T *beg = p;</span><br><span class="line">  <span class="keyword">do</span> *p = GetChar(); <span class="keyword">while</span> (!<span class="built_in">isalnum</span>(*p));</span><br><span class="line">  <span class="keyword">do</span> *(++p) = GetChar(); <span class="keyword">while</span> (<span class="built_in">isalnum</span>(*p));</span><br><span class="line">  *p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> p - beg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qrdb</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> ch = GetChar(), lst = x = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch)) lst = ch, ch = GetChar();</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch)) &#123; x = x * <span class="number">10</span> + (ch - <span class="string">'0'</span>); ch = GetChar(); &#125;</span><br><span class="line">  <span class="keyword">if</span> (ch == <span class="string">'.'</span>) &#123;</span><br><span class="line">    ch = GetChar();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span> t = <span class="number">0.1</span>; <span class="built_in">isdigit</span>(ch); t *= <span class="number">0.1</span>) &#123;</span><br><span class="line">      x += (t * (ch - <span class="string">'0'</span>));</span><br><span class="line">      ch = GetChar();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (lst == <span class="string">'-'</span>) x = -x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OPT &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">char</span> buf[L];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">qw</span><span class="params">(T x, <span class="keyword">const</span> <span class="keyword">char</span> aft = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123; x = -x, <span class="built_in">putchar</span>(<span class="string">'-'</span>); &#125;</span><br><span class="line">  <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123; buf[++top] = <span class="keyword">static_cast</span>&lt;<span class="keyword">char</span>&gt;(x % <span class="number">10</span> + <span class="string">'0'</span>); &#125; <span class="keyword">while</span> (x /= <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">while</span> (top) <span class="built_in">putchar</span>(buf[top--]);</span><br><span class="line">  <span class="keyword">if</span> (aft) <span class="built_in">putchar</span>(aft);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qwa</span><span class="params">(T *<span class="keyword">const</span> __ary, <span class="keyword">int</span> __n, <span class="keyword">const</span> <span class="keyword">char</span> e1, <span class="keyword">const</span> <span class="keyword">char</span> e2)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; __n; ++i) qw(__ary[i], e1);</span><br><span class="line">  qw(__ary[__n], e2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qws</span><span class="params">(T *p, <span class="keyword">const</span> <span class="keyword">int</span> __n, <span class="keyword">const</span> <span class="keyword">char</span> ed)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; __n; ++i) <span class="built_in">putchar</span>(p[i]);</span><br><span class="line">  <span class="keyword">if</span> (ed) <span class="built_in">putchar</span>(ed);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qws</span><span class="params">(T *p, <span class="keyword">const</span> <span class="keyword">char</span> ed)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (*p) <span class="built_in">putchar</span>(*p++);</span><br><span class="line">  <span class="keyword">if</span>(ed) <span class="built_in">putchar</span>(ed);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> IPT::qr;</span><br><span class="line"><span class="keyword">using</span> IPT::qra;</span><br><span class="line"><span class="keyword">using</span> IPT::qrs;</span><br><span class="line"><span class="keyword">using</span> IPT::qrdb;</span><br><span class="line"><span class="keyword">using</span> OPT::qw;</span><br><span class="line"><span class="keyword">using</span> OPT::qwa;</span><br><span class="line"><span class="keyword">using</span> OPT::qws;</span><br><span class="line"></span><br><span class="line"><span class="function">il ll <span class="title">calc</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    ll h = (l + r + <span class="number">1</span>) / <span class="number">2</span> ;</span><br><span class="line">    ll ret = sum[r] - sum[h] ;</span><br><span class="line">    ll d1 = <span class="number">1l</span>l * (h - l) * base[h] ;</span><br><span class="line">    ll d2 = <span class="number">1l</span>l * (r - h) * base[h] ;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> ret - d2 + d1 - sum[h] + sum[l] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il ll <span class="title">trans</span><span class="params">(ll p, ll x)</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> f[p] + calc(p, x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    stk[tp = <span class="number">0</span>] = <span class="number">0</span> ; </span><br><span class="line">Â Â Â Â <span class="keyword">int</span> h = <span class="number">0</span> ; lrg[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">Â Â Â Â <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (h &lt; tp &amp;&amp; lrg[h] &lt; i)</span><br><span class="line">            ++ h ; <span class="keyword">if</span> (lrg[h] &gt; i) -- h ;</span><br><span class="line">Â Â Â Â Â Â Â Â f[i] = trans(stk[h], i) + x, cnt[i] = cnt[stk[h]] + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (tp &amp;&amp; trans(stk[tp], lrg[tp]) &gt;= trans(i, lrg[tp]))</span><br><span class="line">            stk[tp] = <span class="number">0</span>, lrg[tp] = n + <span class="number">1</span>, -- tp ;</span><br><span class="line">        <span class="keyword">int</span> l = lrg[tp], r = n, mid, ans = n + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">            <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (trans(stk[tp], mid) &gt;= trans(i, mid))</span><br><span class="line">                ans = mid, r = mid - <span class="number">1</span> ; <span class="keyword">else</span> l = mid + <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ans &lt;= n) stk[++ tp] = i, lrg[tp] = ans ;</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â res = f[n] - x * m ; <span class="keyword">return</span> (<span class="keyword">bool</span>)(cnt[n] &lt; m) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â Â qr(n) ; qr(m) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        qr(base[i]), sum[i] = sum[i - <span class="number">1</span>] + (ll)base[i] ;  </span><br><span class="line">    ll l = <span class="number">0</span>, r = <span class="number">1e9</span>, mid, ans ; </span><br><span class="line">Â Â Â Â lrg[<span class="number">0</span>] = <span class="number">1</span> ; sum[n + <span class="number">1</span>] = sum[n] ; </span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">if</span> (check(mid)) r = mid - <span class="number">1</span> ; </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">else</span> ans = mid, l = mid + <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">Â Â Â Â check(ans) ; qw(res) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="LG4983-å¿˜æƒ…"><a href="#LG4983-å¿˜æƒ…" class="headerlink" title="LG4983 å¿˜æƒ…"></a>LG4983 å¿˜æƒ…</h1><blockquote>
<p>å°†ä¸€ä¸ªé•¿ä¸º $n$ çš„åºåˆ—åˆ’åˆ†æˆ $m$ æ®µï¼Œæ¯æ®µ $[l,r]$ çš„ä»£ä»·æ˜¯</p>
<script type="math/tex; mode=display">
\frac{\left(\left(\sum_\limits{i=l}^{r} x_{i} \times \bar{x}\right)+\bar{x}\right)^{2}}{\bar{x}^{2}}</script><p>æœ€å°åŒ–è¿™ä¸ªä»£ä»·ã€‚</p>
<p>$1\leq n\leq 10^5$ ã€‚</p>
</blockquote>
<p>é¦–å…ˆæä¸€ä¸‹å¹³æ–¹åŒ–ä¸€ä¸‹å¼å­å¾—åˆ°ä»£ä»·æœ¬è´¨ä¸Šæ˜¯</p>
<script type="math/tex; mode=display">
\left(1+\sum_{i=l}^rx_i\right)^2</script><p>ç„¶åå‘ç°ï¼Œè¿™æ˜¾ç„¶å°±æ˜¯åˆ†çš„æ®µè¶Šå¤šè¶Šå¥½ï¼Œç†æƒ³æƒ…å†µä¸‹(ä»£ä»·æœ€å°)å°±æ˜¯åˆ† $n$ æ®µã€‚é‚£ä¹ˆè¿™ä¸ªä¸œè¥¿å°±æ˜¾ç„¶æ˜¯å‡¸çš„ï¼Œè™½ç„¶æ˜¯åŠå‡¸å£³ä½†è‡³å°‘ä¹Ÿæ˜¯å‡¸çš„ã€‚äºæ˜¯å°±å»äºŒåˆ†æ¯åˆ†ä¸€æ®µåº”è¯¥æ”¯ä»˜å¤šå°‘ä»£ä»·å³å¯ï¼Œä¼¼ä¹è½¬ç§»éš¾åº¦æ¯”ä¸Šä¸€é“é¢˜è¿˜ç®€å•ä¸å°‘ï¼Ÿ</p>
<p>æ³¨æ„åˆ°äºŒåˆ†å†…éƒ¨å†™å†³ç­–å•è°ƒæ€§æ˜¯å¸¦ $\log$ çš„ï¼Œè™½ç„¶æˆ‘æ€»è§‰å¾—åº”è¯¥å¯ä»¥çº¿æ€§(ä½†æ®dlsè¯´é‚£ç§çº¿æ€§åšæ³•å¸¸æ•°å¾ˆå¤§)ï¼Œäºæ˜¯å¤æ‚åº¦å°±æ˜¯ $n\log n\log V$ çš„ã€‚ä¸å¼€ <code>-O2</code> åœ¨è°·çš„è¡¨ç°å¹¶ä¸å¥½ï¼Œå¼€äº†ä¹‹åæ€§èƒ½æœ‰äº†è¶…å¤§çš„é£è·ƒã€‚</p>
<p>ä»£ç æ²¡å•¥å¯è´´çš„ï¼Œæˆ‘å°±æ˜¯copyäº†ä¸Šé“é¢˜çš„ä»£ç ç„¶åæ”¹äº†æ”¹è½¬ç§»ï¼ˆ</p>
<h1 id="CF958E2"><a href="#CF958E2" class="headerlink" title="CF958E2"></a>CF958E2</h1><blockquote>
<p>ç»™å®š $n$ ä¸ªæ—¶é—´ç‚¹ã€‚æ¯ä¸ªåŒºé—´éƒ½ä»¥æŸä¸¤ä¸ªæ—¶é—´ç‚¹ä¸ºå·¦å³ç«¯ç‚¹ï¼Œä¸”æ¯ä¸ªåŒºé—´çš„ã€Œä»£ä»·ã€å®šä¹‰ç«¯ç‚¹çš„æ—¶é—´ä¹‹å·®ã€‚ä½ è¦é€‰æ‹© $k$ ä¸ªè¿ç»­çš„åŒºé—´ï¼Œä¿è¯è¿™ä¸ª $k$ ä¸ªè¿ç»­çš„åŒºé—´æ²¡æœ‰äº¤é›†ï¼Œä¸”ä»£ä»·æ€»å’Œæœ€å°ã€‚</p>
<p>$1\leq n\leq 500000,1\leq k\leq 5000$</p>
</blockquote>
<p>è€ƒè™‘ä¸€èˆ¬ $dp$ çš„è¯å°±æ˜¯ $f_{i,j}$ ï¼Œè¿™ä¸ªåœ°æ–¹ç”±äºä¸é™åˆ¶ä¸€å®šè¦å–æ»¡ï¼Œæ‰€ä»¥å°±å¯ä»¥æœ‰å¦‚ä¸‹è½¬ç§»ï¼š</p>
<script type="math/tex; mode=display">
f_{i,j}=\min\{f_{i-1,j},f_{i-2,j-1}+len(i-1,i)\}</script><p>ä¼¼ä¹å¸¸æ•°å°ä¸€ç‚¹ï¼Œæš´åŠ› $O(nk)$ ä¹Ÿæ˜¯å¯ä»¥è¿‡çš„ã€‚äºæ˜¯å°±ç›´æ¥wqsäºŒåˆ†ä¸€ä¸‹ï¼Œæ³¨æ„åˆ°ç”±äºæ­¤æ—¶æœ€ä¼˜çš„å†³ç­–ä¸€å®šæ˜¯å°‘é€‰ï¼Œæ‰€ä»¥æ¯é€‰ä¸€æ¬¡å°±éœ€è¦å‡å» $mid$ æ¥ç»´æŠ¤è¿™ä¸ªé™åˆ¶ã€‚äºæ˜¯æœ€åå¤æ‚åº¦ $n\log V$ ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºç”¨äº† $cnt_i$ è®°å½•è½¬ç§»åˆ° $i$ è¿™ä¸ªçŠ¶æ€è‡³å°‘è¦åˆ†æˆå¤šå°‘æ®µï¼Œæ‰€ä»¥è¿™ä¸ªåœ°æ–¹è¿˜æ˜¯ç‰µæ‰¯åˆ°ä¸€ä¸ªï¼Œå¦‚æœæˆ‘å¯ä»¥æœ‰ $6/7/8$ ä¸‰ç§åˆ’åˆ†æ–¹å¼è½¬ç§»åˆ°æœ€ä¼˜è§£ï¼Œé‚£ä¹ˆåˆ°åº•åº”è¯¥ç”¨å“ªä¸ªã€‚å¾ˆæ˜¾ç„¶çš„æ˜¯è¦ä¹ˆç”¨ $max$ è¦ä¹ˆç”¨ $min$ï¼Œè¿™å–å†³äºäºŒåˆ†çš„æ–¹å¼ã€‚å¦‚æœæ˜¯å– $max$ çš„è¯ï¼Œé‚£ä¹ˆå¯èƒ½ $cnt_n&gt;m$ ï¼›å– $min$ çš„è¯åˆ™ä¼š $\leq m$ ã€‚æ‰€ä»¥æ ¹æ®è¿™ä¸ªè°ƒæ•´ä»£ç ç»†èŠ‚å°±å¥½äº†ã€‚</p>
<p>â”®ï¹â”­è¿™ä¸ªåœ°æ–¹çœŸçš„æ˜¯å‘äº†æˆ‘å¥½ä¹…ã€‚<del>ç”»å¤–éŸ³: ä½ Tree Ié‚£é¢˜ç™½åšäº†ï¼Ÿï¼Ÿ</del></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">ll res ;</span><br><span class="line">ll f[N] ;</span><br><span class="line"><span class="keyword">int</span> m, n ;</span><br><span class="line"><span class="keyword">int</span> df[N] ;</span><br><span class="line"><span class="keyword">int</span> cnt[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	x *= <span class="number">-1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (f[i - <span class="number">1</span>] &lt; f[i - <span class="number">2</span>] + df[i] + x)</span><br><span class="line">			f[i] = f[i - <span class="number">1</span>], cnt[i] = cnt[i - <span class="number">1</span>] ; </span><br><span class="line">		<span class="keyword">else</span> f[i] = f[i - <span class="number">2</span>] + (ll)df[i] + (ll)x, cnt[i] = cnt[i - <span class="number">2</span>] + <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">if</span> (f[i - <span class="number">1</span>] == f[i - <span class="number">2</span>] + df[i] + x) cnt[i] = max(cnt[i - <span class="number">1</span>], cnt[i - <span class="number">2</span>] + <span class="number">1</span>) ;</span><br><span class="line">	&#125;</span><br><span class="line">	res = f[n] - (ll)x * m ; <span class="keyword">return</span> (<span class="keyword">bool</span>)(cnt[n] &gt;= m) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; m &gt;&gt; n ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) </span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; </span><br><span class="line">	sort(base + <span class="number">1</span>, base + n + <span class="number">1</span>) ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) </span><br><span class="line">		df[i] = base[i] - base[i - <span class="number">1</span>] ;</span><br><span class="line">	<span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">1e9</span>, mid, ans ; </span><br><span class="line">	<span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">		mid = (l + r) &gt;&gt; <span class="number">1</span> ; </span><br><span class="line"><span class="comment">//		cout &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; endl ; </span></span><br><span class="line">		<span class="keyword">if</span> (check(mid)) ans = mid, r = mid - <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">else</span> l = mid + <span class="number">1</span> ;</span><br><span class="line">	&#125;	</span><br><span class="line">	check(ans) ; <span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="å›½å®¶é›†è®­é˜Ÿ-ç§æ ‘"><a href="#å›½å®¶é›†è®­é˜Ÿ-ç§æ ‘" class="headerlink" title="[å›½å®¶é›†è®­é˜Ÿ]ç§æ ‘"></a>[å›½å®¶é›†è®­é˜Ÿ]ç§æ ‘</h1><blockquote>
<p>å°±æ˜¯é‚£ä¸ªå›´ç€å‘ç§æ ‘. è¦æ±‚å¿…é¡»ç§ K æ£µã€‚</p>
</blockquote>
<p>é¦–å…ˆç”±äº $m$ çš„é™åˆ¶ï¼ŒåŠ ä¸Šæƒå€¼ä¼šæœ‰è´Ÿæ•°æ‰€ä»¥å¤šé€‰å’Œå°‘é€‰éƒ½æœ‰å¯èƒ½å¯¼è‡´ç»“æœä¸ä¼˜ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“æƒ³åˆ°è¦å»wqsäºŒåˆ†ã€‚äºŒåˆ†ä¹‹åå°±å˜æˆäº†æ±‚è§£æ²¡æœ‰ $m$ çš„é™åˆ¶çš„æœ€å¤§å€¼é—®é¢˜ã€‚è‡ªç„¶çš„æƒ³æ³•æ˜¯è€ƒè™‘ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªå‘ç§æ ‘çš„æœ€å¤§æ”¶ç›Šï¼Œé‚£ä¹ˆè½¬ç§»å°±æ˜¯è€ƒè™‘ç¬¬ $i$ ä¸ªå‘ç§ä¸ç§ï¼Œå³ $f_i=\max\{f_{i-1},f_{i-2}+val_i\} $ ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸ªåœ°æ–¹å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ç¬¬ $n$ ä¸ªå’Œç¬¬ $1$ ä¸ªä¹‹é—´å¯èƒ½å­˜åœ¨ä¸åˆæ³•ã€‚äºæ˜¯å°±ç†æ‰€åº”å½“åœ°å†è®°ä¸€ç»´ $0/1$ è¡¨ç¤ºç¬¬ $1$ ä¸ªå‘åˆ°åº•ç§ä¸ç§æ ‘ï¼Œè½¬ç§»åˆ° $n$ çš„æ—¶å€™ç‰¹åˆ¤ä¸€ä¸‹ã€‚ è¿™æ ·å°±å¯ä»¥è§£å†³äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">ll res ;</span><br><span class="line"><span class="keyword">int</span> m, n ;</span><br><span class="line"><span class="keyword">int</span> df[N] ;</span><br><span class="line">ll f[N][<span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> cnt[N][<span class="number">2</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	f[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span> ; cnt[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span> ;</span><br><span class="line">	f[<span class="number">1</span>][<span class="number">1</span>] = base[<span class="number">1</span>] + x, cnt[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (f[i - <span class="number">1</span>][<span class="number">0</span>] &gt; f[i - <span class="number">2</span>][<span class="number">0</span>] + x + base[i])</span><br><span class="line">			f[i][<span class="number">0</span>] = f[i - <span class="number">1</span>][<span class="number">0</span>], cnt[i][<span class="number">0</span>] = cnt[i - <span class="number">1</span>][<span class="number">0</span>] ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (f[i - <span class="number">1</span>][<span class="number">0</span>] &lt; f[i - <span class="number">2</span>][<span class="number">0</span>] + x + base[i]) </span><br><span class="line">			f[i][<span class="number">0</span>] = f[i - <span class="number">2</span>][<span class="number">0</span>] + x + base[i], cnt[i][<span class="number">0</span>] = cnt[i - <span class="number">2</span>][<span class="number">0</span>] + <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">else</span> </span><br><span class="line">			f[i][<span class="number">0</span>] = f[i - <span class="number">1</span>][<span class="number">0</span>], cnt[i][<span class="number">0</span>] = max(cnt[i - <span class="number">1</span>][<span class="number">0</span>], cnt[i - <span class="number">2</span>][<span class="number">0</span>] + <span class="number">1</span>) ;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (f[i - <span class="number">1</span>][<span class="number">1</span>] &gt; f[i - <span class="number">2</span>][<span class="number">1</span>] + x + base[i])</span><br><span class="line">			f[i][<span class="number">1</span>] = f[i - <span class="number">1</span>][<span class="number">1</span>], cnt[i][<span class="number">1</span>] = cnt[i - <span class="number">1</span>][<span class="number">1</span>] ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (f[i - <span class="number">1</span>][<span class="number">1</span>] &lt; f[i - <span class="number">2</span>][<span class="number">1</span>] + x + base[i]) </span><br><span class="line">			f[i][<span class="number">1</span>] = f[i - <span class="number">2</span>][<span class="number">1</span>] + x + base[i], cnt[i][<span class="number">1</span>] = cnt[i - <span class="number">2</span>][<span class="number">1</span>] + <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">else</span> </span><br><span class="line">			f[i][<span class="number">1</span>] = f[i - <span class="number">1</span>][<span class="number">1</span>], cnt[i][<span class="number">1</span>] = max(cnt[i - <span class="number">1</span>][<span class="number">1</span>], cnt[i - <span class="number">2</span>][<span class="number">1</span>] + <span class="number">1</span>) ;</span><br><span class="line">	&#125;</span><br><span class="line">	f[n][<span class="number">1</span>] = f[n - <span class="number">1</span>][<span class="number">1</span>] ; </span><br><span class="line">	cnt[n][<span class="number">1</span>] = cnt[n - <span class="number">1</span>][<span class="number">1</span>] ;</span><br><span class="line">	<span class="keyword">if</span> (f[n - <span class="number">1</span>][<span class="number">0</span>] &gt; f[n - <span class="number">2</span>][<span class="number">0</span>] + x + base[n])</span><br><span class="line">		f[n][<span class="number">0</span>] = f[n - <span class="number">1</span>][<span class="number">0</span>], cnt[n][<span class="number">0</span>] = cnt[n - <span class="number">1</span>][<span class="number">0</span>] ;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (f[n - <span class="number">1</span>][<span class="number">0</span>] &lt; f[n - <span class="number">2</span>][<span class="number">0</span>] + x + base[n]) </span><br><span class="line">		f[n][<span class="number">0</span>] = f[n - <span class="number">2</span>][<span class="number">0</span>] + x + base[n], cnt[n][<span class="number">0</span>] = cnt[n - <span class="number">2</span>][<span class="number">0</span>] + <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">else</span> 			</span><br><span class="line">		f[n][<span class="number">0</span>] = f[n - <span class="number">1</span>][<span class="number">0</span>], cnt[n][<span class="number">0</span>] = max(cnt[n - <span class="number">1</span>][<span class="number">0</span>], cnt[n - <span class="number">2</span>][<span class="number">0</span>] + <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">if</span> (f[n][<span class="number">0</span>] &gt; f[n][<span class="number">1</span>])&#123;</span><br><span class="line">		res = f[n][<span class="number">0</span>] - (ll)x * m ; </span><br><span class="line">		<span class="keyword">return</span> (<span class="keyword">bool</span>)(cnt[n][<span class="number">0</span>] &gt;= m) ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		res = f[n][<span class="number">1</span>] - (ll)x * m ; </span><br><span class="line">		<span class="keyword">return</span> (<span class="keyword">bool</span>)(cnt[n][<span class="number">1</span>] &gt;= m) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) </span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; </span><br><span class="line">	<span class="keyword">if</span> (m &gt; n / <span class="number">2</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"Error!"</span>), <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">int</span> l = <span class="number">-2e9</span>, r = <span class="number">2e9</span>, mid, ans ; </span><br><span class="line">	<span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">		mid = (l + r) &gt;&gt; <span class="number">1</span> ; </span><br><span class="line"><span class="comment">//		cout &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; endl ; </span></span><br><span class="line">		<span class="keyword">if</span> (check(mid)) ans = mid, r = mid - <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">else</span> l = mid + <span class="number">1</span> ;</span><br><span class="line">	&#125;	</span><br><span class="line">	check(ans) ; <span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å—¯ï¼Œç„¶åå°±æ²¡æœ‰ç„¶åäº†ï¼Œæ„Ÿè§‰wqsäºŒåˆ†è¿˜æ˜¯åå¥—è·¯çš„ã€‚</p>
<p>btwï¼Œæˆ‘æ‰å‘ç°åŸæ¥LGä¸Šç§æ ‘è¿™é¢˜çš„ä¸¤ä¸ªç‰ˆæœ¬ä¸æ˜¯åŒä¸€é“é¢˜ï¼Œé‚£ä¸ªè“è‰²è¦æ±‚è‡³å¤škä¸ªï¼Œæ‰€ä»¥ä¸å¯ä»¥wqséšä¾¿æ.jpg</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>wqsäºŒåˆ†</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/å†³ç­–å•è°ƒæ€§</tag>
        <tag>wqsäºŒåˆ†</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å¬è¯¾ç¬”è®°ã€‘å†³ç­–å•è°ƒæ€§</title>
    <url>/2020/03/25/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7and%E5%B8%A6%E6%9D%83%E4%BA%8C%E5%88%86%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å†³ç­–å•è°ƒæ€§æ˜¯è€æœ‹å‹äº†ï¼Œè¿™æ¬¡ç¨å¾®ç³»ç»Ÿåœ°é‡å­¦äº†ä¸€æ¬¡ï¼Œé¡ºä¾¿åšäº†åšä¹‹å‰æ²¡åšçš„é¢˜ã€‚</p>
<a id="more"></a>
<h1 id="å››è¾¹å½¢ä¸ç­‰å¼"><a href="#å››è¾¹å½¢ä¸ç­‰å¼" class="headerlink" title="å››è¾¹å½¢ä¸ç­‰å¼"></a>å››è¾¹å½¢ä¸ç­‰å¼</h1><p>å¦‚æœæ˜¯æœ€å°å€¼é—®é¢˜ï¼Œé‚£å¤§æ¦‚é•¿è¿™æ ·ï¼š</p>
<script type="math/tex; mode=display">
a\leq b<c\leq d\\
w(a,c)+w(b,d)\le w(a,d)+w(b,c)</script><p>é‚£ä¹ˆå¦‚æœæ»¡è¶³è¿™ä¸ªï¼Œå°±è¯´æ˜å…¶æ»¡è¶³æœ€å°å€¼æ—¶çš„å†³ç­–å•è°ƒæ€§ã€‚è¯æ˜èµ·æ¥å¾ˆç®€å•ï¼Œå› ä¸º $a\to d,b\to c$ çš„è½¬ç§»çš„å€¼è¦æ›´å¤§äº›ï¼Œæ‰€ä»¥ $a\to c,b\to d$ çš„è½¬ç§»ä¼šæ›´ä¼˜ï¼Œæ®æ­¤å¯å¾— $f$ æœ‰å†³ç­–å•è°ƒæ€§ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¯¥ä¸ç­‰å¼å­˜åœ¨ä¸€ä¸ªå˜å½¢ã€‚è€ƒè™‘å¯¹äº $a&lt;b$ çš„å¦‚ä¸‹ $4$ ä¸ªé‡ $a,a+1,b,b+1$ ï¼Œå¦‚æœæ»¡è¶³ä¸‹å¼ï¼š</p>
<script type="math/tex; mode=display">
w(a,b)+w(a+1,b+1)\le w(a,b+1)+w(a+1,b)</script><p>é‚£ä¹ˆä¹Ÿè¯´æ˜æ˜¯æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼çš„ã€‚è¯æ˜çš„è¯å¯ä»¥è€ƒè™‘æš´åŠ›å½’çº³ä¹Ÿå¥½ã€æ¢å…ƒæ¶ˆå…ƒä¹Ÿå¥½ï¼Œåæ­£æŒºæ˜¾ç„¶çš„ã€‚</p>
<h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><h2 id="CF321E"><a href="#CF321E" class="headerlink" title="CF321E"></a>CF321E</h2><blockquote>
<p>ä½ æœ‰â¼€ä¸ª $n\times n$ çš„å¯¹ç§°çŸ©é˜µè¡¨ç¤ºä¸ç†Ÿæ‚‰ç¨‹åº¦ã€‚</p>
<p>ä½ è¦å°†å®ƒ $1\sim n$ æŒ‰é¡ºåºåˆ†æˆ $k$ ç»„ï¼Œæ¯ç»„çš„ä»£ä»·ä¸ºä¸¤ä¸¤ä¹‹é—´ä¸ç†Ÿæ‚‰ç¨‹åº¦çš„å’Œã€‚æœ€å°åŒ–è¿™ä¸ªä¸œè¥¿ã€‚</p>
<p> $n \le 4000,k \le 800$</p>
</blockquote>
<p>è€ƒè™‘æ‹¿å››è¾¹å½¢ä¸ç­‰å¼æ¥è¯æ˜ã€‚å¯¹äº $a\leq b&lt;c\leq d$ è€Œè¨€ï¼Œè®° $s(a,c)$ è¡¨ç¤ºçŸ©é˜µä¸­å·¦ä¸Šè§’ä¸º $(a,a)$ å³ä¸‹è§’ä¸º $(c,c)$ çš„è¿™ä¹ˆä¸€ä¸ªçŸ©é˜µä¸­å…ƒç´ çš„å’Œï¼Œé‚£ä¹ˆ </p>
<script type="math/tex; mode=display">
w(a,c)+w(b,d)=\frac{s(a,c)+s(b,d)}{2}\\
w(a,d)+w(b,c)=\frac{s(a,d)+s(b,c)}{2}</script><p>æ³¨æ„åˆ°</p>
<script type="math/tex; mode=display">
s(a,d) = s(a,c)+s(b,d)-s(b,c)+s(a,b)+s(c,d)</script><p>é‚£ä¹ˆå°±æ˜¾ç„¶</p>
<script type="math/tex; mode=display">
w(a,c)+w(b,d)\le w(a,d)+w(b,c)</script><p>ååˆ†æ»¡è¶³å†³ç­–å•è°ƒæ€§ï¼ˆå…¶å®ç”»å‡ºå›¾æ¥æ›´æ˜¾ç„¶ï¼Œå°±æ˜¯å¤šäº†ä¸¤å—çŸ©é˜µï¼‰ã€‚</p>
<p>è¿™ä¸ªä¸œè¥¿å¯ä»¥ç”¨åˆ†æ²»æ¥åšã€‚å› ä¸ºæ¯ä¸€å±‚å†³ç­–ä¸æœ¬å±‚æ— å…³ï¼Œå³ $k-1\to k$ ã€‚äºæ˜¯å°±å¯ä»¥ <code>solve(l,r,ql,qr)</code> è¡¨ç¤º $l\sim r$ æ˜¯ä»åŒºé—´ $(ql\sim qr)$ è½¬ç§»è¿‡æ¥çš„ã€‚é‚£ä¹ˆæ¯æ¬¡å– $mid=\frac{l+r}{2}$ï¼Œç„¶åæ‰¾å‡º $f_{mid}$ å¯¹åº”çš„æœ€ä¼˜å†³ç­–æ‰€åœ¨ä½ç½®ï¼Œè¿™æ ·å°±å¯ä»¥åˆ†æ²»äº†ã€‚å¤æ‚åº¦ $O(nk\log n)$ ã€‚</p>
<p>è¿™é¢˜å±…ç„¶å¡cinï¼Œæ°”æ­»æˆ‘äº†</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_b push_back </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> upb upper_bound</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">int</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ; <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, k ;</span><br><span class="line"><span class="keyword">int</span> s[N][N] ;</span><br><span class="line"><span class="keyword">int</span> f[N][K] ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> res = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">char</span> c = getchar() ;</span><br><span class="line">	<span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) </span><br><span class="line">		(res *= <span class="number">10</span>) += c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">	<span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">do_do</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (s[r][r] + s[l - <span class="number">1</span>][l - <span class="number">1</span>] - s[r][l - <span class="number">1</span>] - s[l - <span class="number">1</span>][r]) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, <span class="keyword">int</span> g)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> ; </span><br><span class="line">	<span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, pos = ql ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = ql ; i &lt;= qr &amp;&amp; i &lt;= mid ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (f[i][g - <span class="number">1</span>] + do_do(i + <span class="number">1</span>, mid) &lt; f[mid][g])</span><br><span class="line">			f[mid][g] = f[i][g - <span class="number">1</span>] + do_do(i + <span class="number">1</span>, mid), pos = i ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//cout &lt;&lt; mid &lt;&lt; " " &lt;&lt; pos &lt;&lt; " " &lt;&lt; g &lt;&lt; endl ; </span></span><br><span class="line">	solve(l, mid - <span class="number">1</span>, ql, pos, g) ; </span><br><span class="line">	solve(mid + <span class="number">1</span>, r, pos, qr, g) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k ;</span><br><span class="line">	<span class="built_in">memset</span>(f, <span class="number">63</span>, <span class="keyword">sizeof</span>(f)) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">			s[i][j] = qr() ; f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span> ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">			s[i][j] += s[i - <span class="number">1</span>][j] + s[i][j - <span class="number">1</span>] - s[i - <span class="number">1</span>][j - <span class="number">1</span>] ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i) solve(<span class="number">1</span>, n, <span class="number">0</span>, n, i) ;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; f[n][k] &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="CF321E-çš„-O-n-2-åšæ³•"><a href="#CF321E-çš„-O-n-2-åšæ³•" class="headerlink" title="CF321E çš„ $O(n^2)$ åšæ³•"></a>CF321E çš„ $O(n^2)$ åšæ³•</h2><p>è€ƒè™‘è®°å½•ä¸€ä¸‹æ¯ä¸ªç‚¹çš„å†³ç­–èŒƒå›´ã€‚å‘ç°è®¾çŠ¶æ€ $(n,k)$ æœ€ä¼˜å†³ç­–ä½ç½®è®°ä½œ $opt(n,k)$ çš„è¯ï¼Œä¸€å®šæœ‰</p>
<script type="math/tex; mode=display">
opt(n,k-1)\leq opt(n,k)\leq opt(n+1,k)</script><p>é‚£ä¹ˆå¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> j : <span class="number">1</span> to k</span><br><span class="line">  <span class="keyword">for</span> i : n to <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> p : opt(i, j - <span class="number">1</span>) <span class="function">to <span class="title">opt</span><span class="params">(i + <span class="number">1</span>, j)</span></span></span><br><span class="line">      if [f(p, j - 1) &lt; f(i, j)] opt(i, j) = p, f(i, j) := f(p, j - 1) ;</span><br></pre></td></tr></table></figure>
<p>è€ƒè™‘è¿™ä¹ˆåšçš„æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p>å‘ç°å¯¹äºè¿™ä¸ªå†³ç­–çŸ©é˜µçš„æ¯ä¸€æ¡ç©¿è¿‡ $opt(i,j)$  å’Œ $opt(i+1,j+1)$ çš„æ–œçº¿ï¼Œæ¯æ¡æ–œçº¿çš„ä»£ä»·æ˜¯ $O(n)$ çš„ï¼ŒåŸå› æ˜¯è€ƒè™‘æ–œçº¿ $opt(i,j),opt(i+1,j+1)$ è¿™æ¡æ–œçº¿çš„å†³ç­–æ¥è‡ªäº $opt(i,j-1),opt(i+1,j)$ è¿™æ¡æ–œçº¿ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªæ–œçº¿çš„è½¬ç§»éƒ½æ˜¯ $O(n)$ çš„ï¼Œå…±æœ‰ $O(n+k)$ æ¡æ–œçº¿ï¼Œæ‰€ä»¥å¤æ‚åº¦ $O(n^2)$ ã€‚</p>
<h2 id="NOI2009-è¯—äººå°G"><a href="#NOI2009-è¯—äººå°G" class="headerlink" title="[NOI2009]è¯—äººå°G"></a>[NOI2009]è¯—äººå°G</h2><blockquote>
<p>æœ‰Nä¸ªè¯—å¥éœ€è¦è¢«æ’ç‰ˆä¸ºè‹¥â¼²â¾ï¼Œé¡ºåºä¸èƒ½æ”¹å˜ã€‚â¼€â¾å†…å¯ä»¥æœ‰è‹¥â¼²ä¸ªè¯—å¥ï¼Œç›¸é‚»è¯—å¥ä¹‹é—´æœ‰â¼€ä¸ªç©ºæ ¼ã€‚</p>
<p>å®šä¹‰â¾æ ‡å‡†â»“åº¦Lï¼Œæ¯â¾çš„ä¸åè°ƒåº¦ä¸º|å®é™…â»“åº¦-L|^Pï¼Œæ•´â¾¸è¯—çš„ä¸åè°ƒåº¦å°±æ˜¯æ¯â¾ä¸åè°ƒåº¦ä¹‹å’Œã€‚</p>
<p>ä»»åŠ¡æ˜¯å®‰æ’â¼€ç§æ’ç‰ˆâ½…æ¡ˆï¼Œä½¿å¾—æ•´â¾¸è¯—çš„ä¸åè°ƒåº¦æœ€â¼©ã€‚</p>
<p>$n\leq 10^5$ ã€‚</p>
</blockquote>
<p>è€ƒè™‘è¿˜æ˜¯ $dp$ å˜›ã€‚ä»¥ä¸‹åˆ†ææš‚ä¸è€ƒè™‘ä»€ä¹ˆ $\pm1$ çš„å¸¸æ•°é—®é¢˜ã€‚</p>
<p>$f_{i} $ è¡¨ç¤ºè€ƒè™‘äº†å‰ $i$ ä¸ªå¥å­çš„æœ€å°ä¸åè°ƒåº¦ã€‚é‚£ä¹ˆå°±æœ‰ $f_{i}=\min\{f_{j-1}+|s(i,j)-L|^P\}$ã€‚</p>
<hr>
<p>è€ƒè™‘è¿™ä¸ªä¸œè¥¿çš„æ€§è´¨ã€‚è¿˜æ˜¯è®¾ $a\leq b&lt;c\leq d$ ï¼Œé‚£ä¹ˆå¯çŸ¥ $|s(a,c)-L|^P+|s(b,d)-L|^P$  </p>
<script type="math/tex; mode=display">
|s(a,d)-L|^P+|s(b,c)-L|^P=|s(a,c)+s(c,d)-L|^P+|s(b,d)-s(c,d)-L|^P</script><p><del>è‰ä¸ºä»€ä¹ˆæˆ‘æƒ³ç›´æ¥æ‰“ä¸ªè¡¨èµ°äºº</del> æ¥è®©æˆ‘çç¼–ä¸€ä¸‹ã€‚ä»¤ $x=s(a,c)-L,y=s(b,d)-L$ã€‚é‚£ä¹ˆè¦è¯æ˜</p>
<script type="math/tex; mode=display">
|x+s(c,d)|^P+|y-s(c,d)|^P\geq |x|^P+|y|^P</script><p>è€ƒè™‘å½“ $|P|$ ä¸ºå¶æ•°çš„æ—¶å€™â€¦â€¦</p>
<hr>
<p>å¥½çš„ï¼Œä¸Šé¢çš„è¯æ˜å´©æ‰äº†ã€‚è€ƒè™‘å¦ä¸€ç§è¯æ˜æ–¹æ³•ã€‚è€ƒè™‘å¯¹äº $a&lt;b$ çš„å¦‚ä¸‹ $4$ ä¸ªé‡ $a,a+1,b,b+1$ ï¼Œè€ƒè™‘å»è¯æ˜ </p>
<script type="math/tex; mode=display">
|s(a,b)-L|^P+|s(a+1,b+1)-L|^P\le |s(a,b+1)-L|^P+|s(a+1,b)-L|^P</script><p>å‘ç°ä»¤ $p = len_a,q=len_b,x=s(a,b)$æœ¬è´¨ä¸Šå°±æ˜¯åœ¨è¯æ˜</p>
<script type="math/tex; mode=display">
|x|^P+|x-p+q|^P\le |x+q|^P+|x-p|^P</script><p>å³</p>
<script type="math/tex; mode=display">
|x|^P-|x-p|^P\le|x+q|^P-|x+q-p|^P</script><p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¦è¯æ˜ $f(x)=|x|^z-|x-p|^z$ è¿™ä¸ªå‡½æ•°æ˜¯å•è°ƒä¸é™çš„ã€‚å¯çŸ¥ä¸€å®šæœ‰ $s(a,b)&gt;p+q$ ï¼Œæ‰€ä»¥å¯çŸ¥æ‹¬å·å†…å‡ $&gt;0$ï¼Œæ¢è¨€ä¹‹ $f(x)=x^z-(x-p)^z$ ï¼Œè¿™æ˜¾ç„¶æ˜¯å•è°ƒä¸é™çš„ã€‚äºæ˜¯è¯æ¯•ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸ªåœ°æ–¹å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è½¬ç§»æœ‰ç€ä¸¥æ ¼çš„é¡ºåºï¼Œä¸èƒ½åƒä¸Šä¸€é“é¢˜ä¸€æ ·æ¥åˆ†æ²»ï¼Œå› ä¸º $l$ å¿…é¡»è¦å…ˆäº $mid$ æ¥è½¬ç§»ã€‚<del>äºæ˜¯è¿™æ˜¾ç„¶å°±éœ€è¦CDQåˆ†æ²»äº†</del> ç„¶è€ŒCDQåˆ†æ²»æ˜¯ $\log ^2$ çš„å¹¶ä¸å¯ä»¥è¿‡å¾—å»(å¹¶ä¸”æ˜¾ç„¶æ²¡äººä¼šè¿™ä¹ˆå†™)ã€‚</p>
<p>æ‰€ä»¥æ­¤å¤„å°±éœ€è¦ç”¨äºŒåˆ†+å•è°ƒæ ˆçš„æ–¹å¼æ¥ç»´æŠ¤ã€‚è¿™ä¸¤ä¸ªè¿‡ç¨‹ä¸¥æ ¼æ„ä¹‰ä¸Šæ˜¯åˆ†å¼€çš„ã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘å¯¹äºæ¯ä¸ªè½¬ç§»å®Œçš„ $i$ ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ªå»æ›´æ–°åé¢çš„ç‚¹çš„å†³ç­–åŒºé—´ï¼Œæ›´æ–°æ–¹æ³•æ˜¯ï¼š1ã€å…ˆä¸æ–­æ¯”è¾ƒå½“å‰çš„å†³ç­–åŒºé—´å’Œä¹‹å‰æ¯ä¸ªæ•°çš„å†³ç­–åŒºé—´å“ªä¸ªæ›´ä¼˜ï¼Œç»´æŠ¤ä¸€ä¸ªä»åº•éƒ¨åˆ°é¡¶éƒ¨å•è°ƒé€’å‡çš„æ ˆï¼Œä¾æ¬¡å¼¹æ‰è¿™äº›ä¸ä¼˜çš„ï¼›2ã€ä¹‹åè€ƒè™‘äºŒåˆ†æ ˆé¡¶çš„è¿™ä¸€æ®µï¼Œç¡®å®šæ–°ä¸€ä¸ªå†³ç­–ç‚¹çš„å·¦åŒºé—´ã€‚</p>
<p>ç„¶åæ˜¯å®ç°ç»†èŠ‚æ–¹é¢ã€‚æ³¨æ„éœ€è¦åœ¨ç»´æŠ¤å•è°ƒæ ˆçš„æ—¶å€™é¡ºä¾¿ç»´æŠ¤æ¯ä¸ªå…ƒç´ çš„å†³ç­–å·¦åŒºé—´ï¼Œå¹¶ä¸”è¿˜è¦ç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆï¼Œç”¨æ¥å¯»æ‰¾å½“å‰ç‚¹çš„å†³ç­–ç‚¹ã€‚</p>
<p>ç„¶åè¿˜æœ‰ååˆ†ç¥å¿…çš„ä¸€ç‚¹ï¼Œå°±æ˜¯è¦è®°å¾—ä¸å°†é‚£äº›æ— æœ‰æ•ˆå†³ç­–åŒºé—´çš„å†³ç­–ç‚¹å…¥æ ˆã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> T ;</span><br><span class="line"><span class="keyword">int</span> top ;</span><br><span class="line">ll f[N] ;</span><br><span class="line"><span class="keyword">int</span> kts[N] ;</span><br><span class="line"><span class="keyword">int</span> stk[N] ;</span><br><span class="line"><span class="keyword">int</span> pos[N] ;</span><br><span class="line"><span class="keyword">int</span> sum[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> n, p, k ;</span><br><span class="line"><span class="keyword">char</span> s[N][<span class="number">40</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">expow</span><span class="params">(ll a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            ret *= a ;</span><br><span class="line">        a *= a ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">mabs</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &gt; <span class="number">0</span> ? x : -x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">calc</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> expow(mabs(sum[r] - sum[l - <span class="number">1</span>] - k), p) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">trans</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> calc(p + <span class="number">1</span>, x) + f[p] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">int</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k &gt;&gt; p ;</span><br><span class="line">        stk[top = <span class="number">0</span>] = <span class="number">0</span> ; ++ k ;</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f)) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">            pos[i] = <span class="number">0</span> ;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s[i] + <span class="number">1</span>) ;</span><br><span class="line">            base[i] = <span class="built_in">strlen</span>(s[i] + <span class="number">1</span>) ;</span><br><span class="line">            sum[i] = sum[i - <span class="number">1</span>] + base[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) sum[i] += i ;</span><br><span class="line">        <span class="comment">//debug(sum, 1, n, '\n') ;</span></span><br><span class="line">        kts[<span class="number">0</span>] = <span class="number">1</span> ; <span class="keyword">int</span> h = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">while</span> (h &lt; top &amp;&amp; kts[h] &lt; i) ++ h ;</span><br><span class="line">            <span class="keyword">if</span> (kts[h] &gt; i) -- h ;</span><br><span class="line">            f[i] = trans(stk[h], i) ; pos[i] = stk[h] ;</span><br><span class="line">            <span class="keyword">while</span> (top &amp;&amp; trans(stk[top], kts[top]) &gt;= trans(i, kts[top]))</span><br><span class="line">                stk[top] = <span class="number">0</span>, kts[top] = n + <span class="number">1</span>, -- top ;</span><br><span class="line">            <span class="keyword">int</span> l = kts[top], r = n + <span class="number">1</span>, mid, ans = n + <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">                <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">                <span class="keyword">if</span> (trans(stk[top], mid) &gt;= trans(i, mid))</span><br><span class="line">                    ans = mid, r = mid - <span class="number">1</span> ; <span class="keyword">else</span> l = mid + <span class="number">1</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//cout &lt;&lt; ans &lt;&lt; " * " &lt;&lt; endl ;</span></span><br><span class="line">            <span class="keyword">if</span> (ans &lt;= n) stk[++ top] = i, kts[top] = ans ;</span><br><span class="line">            <span class="comment">//cout &lt;&lt; i &lt;&lt; " " &lt;&lt; ans &lt;&lt; endl ;</span></span><br><span class="line">            <span class="comment">//debug(stk, 1, top, '\n') ;</span></span><br><span class="line">            <span class="comment">//debug(kts, 1, top, '\n') ;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//debug(pos, 1, n, '\n') ;</span></span><br><span class="line">        <span class="keyword">if</span>(f[n] &gt; <span class="number">1e18</span>) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"Too hard to arrange"</span>) ;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"--------------------"</span>) ; <span class="keyword">continue</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; (<span class="keyword">long</span> <span class="keyword">long</span>)f[n] &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">        <span class="keyword">int</span> t ; stk[top = <span class="number">0</span>] = t = n ;</span><br><span class="line">        <span class="keyword">while</span> (t) stk[++ top] = t = pos[t] ;</span><br><span class="line">        <span class="keyword">while</span> (top)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = stk[top] + <span class="number">1</span> ; i &lt; stk[top - <span class="number">1</span>] ; ++ i)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%s "</span>, s[i] + <span class="number">1</span>) ; <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, s[stk[top - <span class="number">1</span>]] + <span class="number">1</span>) ; -- top ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"--------------------"</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ€»ä¹‹å‘¢ï¼Œå•è°ƒæ ˆ+äºŒåˆ†è¿™ä¸ªåšæ³•æ˜¯æ¯”è¾ƒæ™®é€‚çš„ï¼Œä½†æ˜¯æœ‰æ—¶å€™ä¹Ÿå¯ä»¥å†™åˆ†æ²»ï¼Œå› ä¸ºåˆ†æ²»æ¯”è¾ƒå¥½å†™ã€‚</p>
<h2 id="IOI2013-wombats"><a href="#IOI2013-wombats" class="headerlink" title="IOI2013 wombats"></a>IOI2013 wombats</h2><blockquote>
<p>é¢˜æ„â¼¤æ¦‚æ˜¯ï¼Œæœ‰ $r\times c$ çš„â½¹æ ¼å›¾ï¼Œæ¯æ¬¡åªèƒ½æœå·¦å³ä¸‹ä¸‰ä¸ªâ½…å‘ã€‚</p>
<p>æ“ä½œåŒ…æ‹¬ä¿®æ”¹â¼€æ¡è¾¹çš„è¾¹æƒï¼Œç„¶åæŸ¥è¯¢æŸä¸¤ç‚¹ä¹‹é—´æœ€çŸ­è·¯ã€‚</p>
<p>$r\leq 5000,c\leq 200,q\leq 200000,m\leq 500$ å…¶ä¸­ $m$ æ˜¯ä¿®æ”¹æ¬¡æ•°ï¼Œ$q$ æ˜¯è¯¢é—®æ¬¡æ•°ã€‚</p>
</blockquote>
<p>è‰ï¼Œè¿™é¢˜çœŸæ˜¯ä»ä¸€å¼€å§‹å°±ä¸ä¼šqaq</p>
<p>å¤§æ¦‚å°±æ˜¯è€ƒè™‘ä»¥åˆ—ä¸ºæ ‡å·å»ºçº¿æ®µæ ‘ï¼Œç„¶åæ¯ä¸ªåŒºé—´ç»´æŠ¤æœ€å·¦è¾¹çš„ç‚¹åˆ°æœ€å³è¾¹çš„æ‰€æœ‰ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚ç„¶ååˆå¹¶æ˜¾ç„¶å°±æ˜¯ $c^3$ çš„ï¼Œæ€»å¤æ‚åº¦ $O(rc^3+q\log r+mc^3\log r)$ ã€‚(å¥½åƒæœçˆ·å†™çš„æ˜¯ $O(rc^3+q+mc^3\log r)$</p>
<p>ç„¶åè€ƒè™‘è¿™ä¸œè¥¿ç”±äºåªèƒ½å‘å³å’Œå‘ä¸‹èµ°ï¼Œæ‰€ä»¥æ˜¯æœ‰å•è°ƒæ€§çš„ï¼Œä¹Ÿå°±æ˜¯å¯¹äºå³ä¾§çš„ä¸¤ä¸ªç‚¹ $(x,y)$ å’Œ $(x,y+1)$ ï¼Œä»–ä¿©çš„å†³ç­–è·¯çº¿ä¸€å®šæ˜¯ä¸ç›¸äº¤çš„ã€‚è¿™ä¸ªå¥½åƒè¿˜æ˜¯æ¯”è¾ƒæ˜¾ç„¶çš„ï¼Ÿç„¶åå°±å¯ä»¥æš´åŠ› $O(rc^3+q+mc^2\log c\log r)$ åšäº†ã€‚</p>
<p>ä¸è¿‡æ˜¾ç„¶æ ¹æ®ä¸Šé¢é‚£ä¸ª trick ï¼ŒäºŒç»´çš„å†³ç­–å•è°ƒæ€§æ˜¯å¯ä»¥æ¶ˆæ‰ $\log $ çš„ï¼Œè¿˜æ˜¯ä¸Šé¢é‚£ç§åšæ³•ã€‚ä»”ç»†æƒ³äº†æƒ³ï¼Œå…¶å® $nk$ åº”è¯¥ç®—æ˜¯ä¸¤ç»´çš„å†³ç­–å•è°ƒæ€§ï¼Œæ‰€ä»¥æˆ–è®¸è¿™ç¡®å®æ˜¯äºŒç»´å†³ç­–å•è°ƒæ€§çš„é€šç”¨è§£å†³æ–¹æ³•å§ã€‚ </p>
<p>å—¯ï¼Œä»£ç æ˜¯ä¸æƒ³å†™äº†ï¼Œå°±è¿™æ ·å§ã€‚</p>
<h2 id="IOI2014-Holiday"><a href="#IOI2014-Holiday" class="headerlink" title="IOI2014 Holiday"></a>IOI2014 Holiday</h2><blockquote>
<p>æœ‰ n ä¸ªåŸå¸‚ï¼Œæ¯ä¸ªåŸå¸‚æœ‰â¼€ä¸ªæƒå€¼ï¼Œèµ·ç‚¹åœ¨ s ã€‚ æ¯â¼€å¤©ä½ å¯ä»¥å¾€å·¦æˆ–è€…å¾€å³â¾›â¼€æ­¥ï¼Œæˆ–è€…é€‰æ‹©æ¸¸è§ˆè¿™ä¸ªåŸå¸‚ã€‚é—® d å¤©èƒ½è·å¾—çš„æœ€â¼¤æƒå€¼å’Œæ˜¯å¤šå°‘ï¼Ÿ</p>
</blockquote>
<p>å‘ç°ä¸€å…±è‡³å¤šæœ‰å››ç§èµ°æ³•ï¼Œå°±æ˜¯ä¸€ç›´å‘å³èµ°ã€ä¸€ç›´å‘å·¦èµ°ã€å‘å·¦èµ°æŠ˜å›èµ·ç‚¹ç„¶åå‘å³èµ°ã€å‘å³èµ°æŠ˜å›èµ·ç‚¹ç„¶åå‘å·¦èµ°ã€‚å‰ä¸¤ç§å°±æ˜¾ç„¶æ˜¯æšä¸¾èµ°äº† $k$ ä¸ªåŸå¸‚ï¼Œç„¶åæ‰¾å…¶ä¸­çš„å‰ $d-k$ å¤§çš„åŸå¸‚æ¸¸è§ˆå³å¯ã€‚ </p>
<p>è€ƒè™‘å¦å¤–ä¸¤ç§çš„åšæ³•ã€‚å…ˆç»™å‡ºç»“è®ºï¼Œå‡è®¾æˆ‘å‘å³èµ°åˆ°äº†ç‚¹ $i$ ï¼Œå†å‘å·¦èµ°åˆ°ç‚¹ $j$ ï¼Œé‚£ä¹ˆéšç€ $i$ å¢å¤§ï¼Œ$j$ æ˜¯ä¸é™çš„ã€‚</p>
<p>ä½†è¿™ä¸ªåœ°æ–¹å¾ˆè¿·ï¼Œè¿·åœ¨ç½‘ä¸Šå¾ˆå¤šé¢˜è§£å†™çš„æ˜¯å†³ç­–å•è°ƒæ€§ä¸æ˜¯è¿™ä¸œè¥¿å•è°ƒï¼Œæ˜¯å‰ä¸¤ç§é‚£ä¸ªèµ°æ³•å•è°ƒï¼Œæˆ‘å¯»æ€è¿™ä¸æ˜¯æ˜¾ç„¶â€¦</p>
<p>å“¦ï¼Œæƒ³äº†æƒ³ï¼Œå‘ç°æœ¬è´¨æ˜¯ä¸€æ ·çš„ã€‚å°±æ˜¯å‘å³èµ° $0$ å†å‘å·¦å³æ˜¾ç„¶ä¹Ÿæœ‰å•è°ƒæ€§ã€‚é‚£ä¹ˆç°åœ¨å”¯ä¸€çš„é—®é¢˜å°±åœ¨äºè¿™ä¸ªå•è°ƒæ€§ä¼¼ä¹ä¸æ˜¯é‚£ä¹ˆæ˜¾ç„¶â€¦</p>
<p>å¥½çš„ï¼Œé‚£çœ‹èµ·æ¥æ˜¯ï¼Œéšç€ $l$ ä¸æ–­å‘å³ï¼Œ$r$ ä¸ä¼šå‘å·¦(é¬¼çŸ¥é“æˆ‘åˆšæ‰æ€ä¹ˆç†è§£çš„)ã€‚è¿™æ ·å°±éå¸¸åˆç†äº†ã€‚äºæ˜¯å°±å¯ä»¥åˆ†æ²»å»åšäº†ã€‚å¤æ‚åº¦ $m \log n$ ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å†³ç­–å•è°ƒæ€§</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/å†³ç­–å•è°ƒæ€§</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces [Gym 102354B] Yet Another Convolution</title>
    <url>/2020/03/25/gym102354B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>ç»™å‡ºä¸¤ä¸ªé•¿ä¸º $n$ çš„åºåˆ— $\{a_n\}$ å’Œ $\{b_n\}$ ã€‚å¯¹äºæ‰€æœ‰çš„ $k\in[1,n]\cap\mathbb Z_{+}$ ï¼Œæ±‚è¿™æ ·çš„ $c_k$ï¼š</p>
<script type="math/tex; mode=display">
c_k=\max_{\gcd(i,j)=k}\{a_i-b_j\}</script><p>$1\leq n\leq 10^5$</p>
</blockquote>
<p>é¢˜ç›®æ¥æºäº 2018-2019 Summer Petrozavodsk Camp, Oleksandr Kulkov Contest 2 ã€‚</p>
<p>å‘ç°è¿™é¢˜å±…ç„¶è¿˜æ˜¯é‚£ä¸€åœºé€šè¿‡äººæ•°æœ€å¤šçš„é¢˜ç›®ä¹‹ä¸€â€¦æ·±æ·±åœ°æ„Ÿè§‰åˆ°äº†è‡ªå·±çš„å¼±å°ã€‚</p>
<a id="more"></a>
<p>ç„¶åæ­£ç‰‡éƒ¨åˆ†ã€‚è€ƒè™‘è¿™ä¸ªå¼å­å¯ä»¥æ€ä¹ˆåŒ–ï¼Œå‘ç°å¯¹äºä¸€ä¸ªç»™å®šçš„ $k$ ï¼Œè¦æ‰¾çš„ $a_i$ å’Œ $b_i$ åº”è¯¥è‡³å°‘æ˜¯è¿™æ ·çš„ï¼š</p>
<script type="math/tex; mode=display">
a_k,a_{2k},a_{3k}\cdots a_{pk}</script><script type="math/tex; mode=display">
b_k,b_{2k},b_{3k}\cdots b_{pk}</script><p>äºæ˜¯ç›´æ¥æŠŠè¿™äº›æ‹¿å‡ºæ¥é‡ç¼–å·ä¸º $1,2,3\cdots p$ã€‚é‚£ä¹ˆä¸ºäº†ä¿è¯ $\gcd(i,j)=k$ï¼Œå°±éœ€è¦æ»¡è¶³å–å‡ºçš„ä¸€ä¸ª <code>pair</code> æ»¡è¶³ $\gcd(i,j)=1$ ã€‚ä¹Ÿå°±æ˜¯ç°åœ¨è½¬åŒ–æˆäº†è¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼š</p>
<script type="math/tex; mode=display">
\max_{i=1}^p\{(a_i-b_j)[(i,j)=1]\}</script><p>ä¹Ÿå°±æ˜¯</p>
<script type="math/tex; mode=display">
\max_{i=1}^p\{a_i-\min_{j=1}^p\{b_j\cdot[(i,j)=1]\}\}</script><p>ç„¶åä¼¼ä¹å°±æ²¡æ³•åšäº†ã€‚å‘ç°æœ¬é¢˜è¦æ±‚ $poly(\log)$ çš„åšæ³•ï¼Œä½†æ˜¯æœ¬è´¨ä¸Šå¯¹äºæ¯ä¸ª $k$ ï¼Œéƒ½æœ‰ $O(\frac{n}{k})$ ç»„è¯¢é—®ï¼Œè¿™ä¸ªè¯¢é—®é‡æ˜¯ååˆ†å·¨å¤§çš„ã€‚äºæ˜¯è€ƒè™‘æœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥ä¸€èµ·å¤„ç†å…¨éƒ¨è¯¢é—®çš„æ–¹æ³•ã€‚å‘ç°ä¼¼ä¹æ•´ä½“äºŒåˆ†å¯è¡Œã€‚</p>
<p>é¦–å…ˆæŠŠé‡Œé¢çš„ $\min$ é€šè¿‡å°† $b$ å…¨éƒ¨å–åå˜æˆ $\max$ï¼š</p>
<script type="math/tex; mode=display">
\max_{i=1}^p\{a_i+\min_{j=1}^p\{-b_j\cdot[(i,j)=1]\}\}</script><p>ä¹‹åè€ƒè™‘æ•´ä½“äºŒåˆ†ã€‚å…·ä½“çš„æ¥è®²ï¼Œå…ˆè€ƒè™‘ä¸€ç»„è¯¢é—®ï¼ˆå³ä¸€ä¸ªå›ºå®šçš„ $i$ï¼‰æ€ä¹ˆäºŒåˆ†ã€‚å¯¹äºä¸€ä¸ª $\min_{j=1}^p\{b_j\cdot[(i,j)=1]\}$ ï¼Œå°†å…¶è½¬åŒ–æˆåˆ¤å®šæ€§é—®é¢˜ã€‚å‡è®¾å½“å‰äºŒåˆ†åˆ°çš„å€¼æ˜¯ $ans$ ï¼Œé‚£ä¹ˆè€ƒè™‘ï¼Œå¦‚æœ $\sum_{j=1}^p[ans<b_j][(i,j)=1]>0$ï¼Œé‚£å°±ä»£è¡¨å­˜åœ¨ä¸€ä¸ªå€¼æ¯” $ans$ å¤§ï¼Œç¬¦åˆäºŒåˆ†æ€§è´¨ã€‚</b_j][(i,j)=1]></p>
<p>é‚£ä¹ˆå¯¹äºè¿™ä¸ª $\sum$ è€Œè¨€ï¼Œå°±å¯ä»¥å˜ä¸€ä¸‹å½¢äº†ï¼š</p>
<script type="math/tex; mode=display">
\sum_{j=1}^p[ans<b_j]\sum_{d|i\operatorname{and}d|j} \mu(d)>0</script><p>åæ¼”ä¸€ä¸‹ä¹Ÿå°±æ˜¯</p>
<script type="math/tex; mode=display">
\sum_{d|i} \mu(d)\sum_{d|j}^p[ans<b_j]>0</script><p>é‚£ä¹ˆè€ƒè™‘æ•´ä½“äºŒåˆ†çš„æ—¶å€™ï¼Œå¯¹äºæ¯ä¸€å±‚éƒ½å¯ä»¥æŠŠ $<vmid$ çš„ä½ç½®èµ‹ä¸º $1$ ï¼Œæˆ–è€…åè¿‡æ¥ï¼Œæœ¬è´¨éƒ½ä¸€æ ·ã€‚ä¹‹åå°±åªéœ€è¦æŸ¥è¯¢æŸä¸ª $i$ çš„ä¸Šå¼å€¼ã€‚å‘ç°è¿™ä¸œè¥¿éœ€è¦ç»´æŠ¤æ¯ä¸ªå€¼çš„å€æ•°å¤„çš„å€¼ï¼ˆåä¸€ä¸ª $\sum$ï¼‰ï¼Œå¹¶ä¸”ä¸æ˜¯å¾ˆå¥½æ¸…ç©ºã€‚äºæ˜¯è€ƒè™‘ä¸€ä¸ªæœ‰è¶£çš„åšæ³•ã€‚å‡è®¾ä»¥æŠŠ $>vmid$ çš„ä½ç½®éƒ½èµ‹å€¼ä¸º $1$ åšä¾‹å­ã€‚æ¯æ¬¡æ‰‹åŠ¨å°†ä¸€ä¸ªæŒ‡é’ˆç§»åŠ¨ $vmid+1$ å¤„ï¼Œç„¶åå¯¹äºé€”å¾„çš„æ‰€æœ‰ $b_j$ï¼Œå¦‚æœ $&gt;vmid$ çš„è¯å°± $+1$ ï¼Œå¦åˆ™ $-1$ ã€‚è¿™æ ·åšä¹‹åï¼Œ<strong>ç›´æ¥æŠŠè‡ªå·±çš„æ ‡è®°ä¸‹ä¼ ç»™æ‰€æœ‰è‡ªå·±çš„çº¦æ•°</strong>ã€‚è¿™æ ·æœ€åå» $check(i)$ çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥æšä¸¾æ‰€æœ‰çº¦æ•°è€Œä¸éœ€è¦å†å»æšä¸¾çº¦æ•°çš„å€æ•°ã€‚å‘ç°ç§»åŠ¨æŒ‡é’ˆæ¯å±‚éƒ½æ˜¯ $O(r-l)$ çš„ã€‚</vmid$></p>
<p>äºæ˜¯æœ€åè€ƒè™‘ç®—ä¸€ä¸‹å¤æ‚åº¦ã€‚å¤§æ¦‚æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\sum _{i=1}^n(\frac{n}{i} \log \frac{n}{i} d(\frac{n}{i}))</script><p>çš„å¤æ‚åº¦ã€‚emmmï¼Œè¿™å¤§æ¦‚æ˜¯ä¸ªä»€ä¹ˆå¤æ‚åº¦å‘¢â€¦è€ƒè™‘ $d(n)&lt;O(\sqrt[3]n)$ ï¼Œæ‰€ä»¥æœ€ååº”è¯¥ä¸ä¼šè¶…è¿‡ $(n\log n)^{\frac{4}{3}}\log n$</p>
<p>åé¢ä¸€ä¸ª $\log$ æ˜¯å› ä¸ºï¼š</p>
<script type="math/tex; mode=display">
\int \frac{n}{x} \log \left(\frac{n}{x}\right) \mathrm{dx}=-\frac{n(\log x)^{2}-2 n \log n \log x+n(\log n)^{2}}{2}</script><p>ä¼¼ä¹æ˜¯å› ä¸º $\log (\frac{n}{x})&lt;0$ çš„é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦å¿½ç•¥æ‰ç¬¦å·ã€‚æœ€åå¤§æ¦‚ä¹Ÿå°±æ˜¯ $n\log^2 n$ çš„çº§åˆ«ã€‚</p>
<p>ç„¶è€Œå®é™…ç§¯åˆ†å‡ºæ¥ä¹Ÿå·®ä¸å¤šï¼Ÿ</p>
<script type="math/tex; mode=display">
\int \frac{n^{\frac{4}{3}} \log \left(\frac{n}{x}\right)}{x^{\frac{4}{3}}} \mathrm{d x}=\frac{n^{\frac{1}{3}}(3 n \log x-3 n \log n+9 n)}{x^{\frac{1}{3}}}</script><p>çœ‹ä¸Šå»å°±æ˜¯ $(n\log n)^{\frac{4}{3}}\log n$ çš„äºšå­ã€‚ä¸è¿‡è¯è¯´å›æ¥ $d(n)=O(\sqrt[3] n)$ çš„è¿‘ä¼¼è¯¯å·®æœ‰ã€å¤§ï¼Œæ‰€ä»¥è¿˜æ˜¯ $O($èƒ½è¿‡$)$ æ¯”è¾ƒé è°±.jpg ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300010</span> ;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_b push_back </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> upb upper_bound</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">int</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;	<span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> xq ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> q[N] ;</span><br><span class="line"><span class="keyword">int</span> A[N] ;</span><br><span class="line"><span class="keyword">int</span> B[N] ;</span><br><span class="line"><span class="keyword">int</span> lq[N] ;</span><br><span class="line"><span class="keyword">int</span> rq[N] ;</span><br><span class="line"><span class="keyword">int</span> pr[N] ;</span><br><span class="line"><span class="keyword">int</span> ta[N] ;</span><br><span class="line"><span class="keyword">int</span> tb[N] ;</span><br><span class="line"><span class="keyword">int</span> Mu[N] ;</span><br><span class="line"><span class="keyword">int</span> sum[N] ;</span><br><span class="line"><span class="keyword">int</span> res[N] ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> tmp[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; d[N] ;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p = d[x].size() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; p ; ++ i)</span><br><span class="line">        sum[d[x][i]] += y ;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (xq &gt; x) add(base[-- xq], <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (x &gt; xq) add(base[xq ++], <span class="number">-1</span>) ;</span><br><span class="line">	<span class="comment">//debug(sum, 1, 50, '\n') ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">int</span> p = d[x].size() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; p ; ++ i)</span><br><span class="line">        ret += Mu[d[x][i]] * sum[d[x][i]] ;</span><br><span class="line">  	<span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_it</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> vl, <span class="keyword">int</span> vr)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (vl == vr)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">            ans[q[i]] = vl ; <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> vmid = (vl + vr) &gt;&gt; <span class="number">1</span> ; </span><br><span class="line">    <span class="keyword">int</span> tl = <span class="number">0</span>, tr = <span class="number">0</span> ; upd(vmid + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (calc(q[i]) &lt;= <span class="number">0</span>)</span><br><span class="line">            lq[++ tl] = q[i] ;</span><br><span class="line">        <span class="keyword">else</span> rq[++ tr] = q[i] ;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//cout &lt;&lt; tl &lt;&lt; " " &lt;&lt; tr &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tl ; ++ i) q[l + i - <span class="number">1</span>] = lq[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tr ; ++ i) q[l + tl + i - <span class="number">1</span>] = rq[i] ;</span><br><span class="line">    do_it(l, l + tl - <span class="number">1</span>, vl, vmid) ; do_it(l + tl, r, vmid + <span class="number">1</span>, vr) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">do_do</span><span class="params">(<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        tmp[q[i] = i] = tb[i], sum[i] = <span class="number">0</span> ; </span><br><span class="line">    sort(tmp + <span class="number">1</span>, tmp + k + <span class="number">1</span>) ; <span class="keyword">int</span> x ; xq = k + <span class="number">1</span> ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)&#123;</span><br><span class="line">          x = upb(tmp + <span class="number">1</span>, tmp + k + <span class="number">1</span>, tb[i]) - tmp ;</span><br><span class="line">          x -- ; base[x] = i ; tmp[x] ++ ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">-2333333</span> ; do_it(<span class="number">1</span>, k, <span class="number">1</span>, k) ; <span class="comment">//debug(q, 1, k, '\n') ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        ret = max(ret, ta[i] + tmp[ans[i]] - <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; i * j &lt;= n ; ++ j)</span><br><span class="line">            ta[j] = A[i * j], tb[j] = B[i * j] ;</span><br><span class="line">        res[i] = max(res[i], do_do(n / i)) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    vis[<span class="number">0</span>] = vis[<span class="number">1</span>] = Mu[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= k ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i]) </span><br><span class="line">			pr[++ cnt] = i, Mu[i] = <span class="number">-1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (pr[j] * i &gt; k) <span class="keyword">break</span> ;</span><br><span class="line">            vis[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">            Mu[i * pr[j]] = - Mu[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; i * j &lt;= k ; ++ j)</span><br><span class="line">            d[i * j].p_b(i) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    sieve(N - <span class="number">10</span>) ;</span><br><span class="line">    ios :: sync_with_stdio(<span class="literal">false</span>) ;</span><br><span class="line">    <span class="built_in">cin</span>.tie(<span class="number">0</span>) ; <span class="built_in">cout</span>.tie(<span class="number">0</span>) ; <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">cin</span> &gt;&gt; A[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">cin</span> &gt;&gt; B[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) B[i] = -B[i] ;</span><br><span class="line">    solve() ;</span><br><span class="line">    <span class="comment">//for (int i = 1 ; i &lt;= n ; ++ i)</span></span><br><span class="line">    <span class="comment">//    cout &lt;&lt; res[i] &lt;&lt; " \n"[i == n] ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        A[i] = -A[i], B[i] = -B[i] ;</span><br><span class="line">    solve() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; res[i] &lt;&lt; <span class="string">" \n"</span>[i == n] ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
        <category>gym</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°/è«æ¯”ä¹Œæ–¯åæ¼”</tag>
        <tag>å¥½å¤šå¥½å¤šç»†èŠ‚</tag>
        <tag>æ•°å­¦/æ•°å€¼åˆ†æ/è°ƒå’Œçº§æ•°</tag>
        <tag>ç¦»çº¿ç®—æ³•/æ•´ä½“äºŒåˆ†</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å¬è¯¾ç¬”è®°ã€‘åˆ†æ²»é€‰æ•´</title>
    <url>/2020/03/24/%E5%88%86%E6%B2%BB%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸»è¦æ˜¯ä¸€äº›å¬dlsè®²è¯¾çš„ç¬”è®°ã€‚æ„Ÿè§‰å¥½ç¥ä»™å•Š<del>ï¼Œè¿™æˆ‘æ€ä¹ˆå¯èƒ½ä¼šã€‚</del></p>
<a id="more"></a>
<h1 id="Part1-ç¥å¥‡çš„æš´åŠ›"><a href="#Part1-ç¥å¥‡çš„æš´åŠ›" class="headerlink" title="Part1 ç¥å¥‡çš„æš´åŠ›"></a>Part1 ç¥å¥‡çš„æš´åŠ›</h1><h2 id="bitsetåš-K-ç»´æ•°ç‚¹"><a href="#bitsetåš-K-ç»´æ•°ç‚¹" class="headerlink" title="bitsetåš $K$ ç»´æ•°ç‚¹"></a>bitsetåš $K$ ç»´æ•°ç‚¹</h2><p>ä»¤  $f(k,w)=\{i|x_{i,k}&lt; w\}$.</p>
<p>å³ç¬¬ $k$ ç»´å°äº $w$ çš„é›†åˆã€‚</p>
<p>ç„¶åæŸ¥è¯¢çš„è¯ï¼Œå¯¹äºç¬¬ $p$ ä¸ªç‚¹ï¼Œå°±æ±‚ä¸€ä¸‹ </p>
<script type="math/tex; mode=display">
\operatorname{and}_{i=1}^Kf_{i,x_{p,i}}</script><p>è¿™ä¸œè¥¿å³å¯ã€‚</p>
<p>é¢„å¤„ç†çš„è¯ï¼Œè€ƒè™‘å…ˆ $O(Kn)$ è®©æ¯ä¸ª $x_{i,k}$ éƒ½èµ‹å€¼åˆ° $f_{k,x_{i,k}+1}$ ä¸Šï¼Œç„¶åä»å¤´åˆ°å°¾ $or$ ä¸‹æ¥ï¼Œå°±å˜æˆäº† $K\frac{n^2}{w}$ çš„å¤æ‚åº¦ã€‚æŸ¥è¯¢å¤æ‚åº¦å°±æ˜¯ $O(K\frac{n}{w})$ ã€‚</p>
<p>æ€è€ƒç©ºé—´å¤æ‚åº¦ï¼Œå¤§æ¦‚æ˜¯ $O(K\frac{n^2}{w})$ ã€‚å‘ç°ä¼¼ä¹æœ‰ç‚¹å¡ç©ºé—´ã€‚äºæ˜¯è€ƒè™‘è®¾ç½®ä¸€ä¸ªé˜ˆå€¼ $T$ï¼Œæ¢è®¾ä¸€ä¸ª $f_{k,iT}$ ç”¨æ¥åªè®°å½• $T$ çš„å€æ•°çš„æƒ…å†µï¼Œè¿™æ ·ç©ºé—´å¤æ‚åº¦å°±ä¼šé™ä¸º $\frac{Kn^2}{Tw}$ ï¼›æŸ¥è¯¢çš„æ—¶å€™å°±å¯ä»¥æŸ¥è¯¢ç¦» $x_{p,i}$ æœ€è¿‘çš„å—ï¼Œç„¶åæŠŠåé¢çš„ä¸‹è„šæ–™æš´åŠ›åŠ è¿›å»ï¼Œæ—¶é—´å¤æ‚åº¦å˜æˆäº† $O(Kn(\frac{n}{w}+T))$ ã€‚ </p>
<h1 id="Part2-CDQåˆ†æ²»"><a href="#Part2-CDQåˆ†æ²»" class="headerlink" title="Part2 CDQåˆ†æ²»"></a>Part2 CDQåˆ†æ²»</h1><h1 id="åŠ¨æ€å‡¸å£³"><a href="#åŠ¨æ€å‡¸å£³" class="headerlink" title="åŠ¨æ€å‡¸å£³"></a>åŠ¨æ€å‡¸å£³</h1><blockquote>
<p>ç»™å‡ºä¸€ä¸ªå¹³é¢ï¼Œæ”¯æŒåŠ ç‚¹ $(x,y)$ ï¼Œç»™å‡º $(a,b)$ æŸ¥è¯¢æœ€å¤§çš„ $ax+by$ ã€‚</p>
</blockquote>
<p>å‘ç°æœ¬è´¨ä¸Šæ˜¯åœ¨æ±‚æŸä¸ªæ–¹å‘ä¸Šæœ€å¤§çš„ç‚¹ç§¯ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åœ¨åŠ¨æ€ç»´æŠ¤å‡¸å£³ã€‚äºæ˜¯æœ‰ä¸¤ç§åšæ³•ï¼š</p>
<p>ï¼ˆ1ï¼‰ç›´æ¥ <code>set&lt;point&gt;</code> ç»´æŠ¤ï¼Œæ”¯æŒæŒ‰ $x$ æŸ¥è¯¢å’ŒæŒ‰æ–œç‡æŸ¥è¯¢ã€‚æ’å…¥çš„æ—¶å€™æŒ‰ $x$ æ’åºï¼Œè¯¢é—®æŒ‰æ–œç‡æ’åºã€‚å¯ä»¥åœ¨ <code>cmp</code> é‡Œè®°ç”¨ä¸ªå…¨å±€å˜é‡æ¥åˆ¤æ–­å½“å‰æŒ‰ä»€ä¹ˆæ’åº(ç¥å¥‡çš„æ˜¯è¿™æ ·å¤æ‚åº¦æ˜¯å¯¹çš„)ã€‚åæ­£å°±æ˜¯ç»´æŠ¤å‡¸å£³å°±å¯¹äº†ã€‚</p>
<p>è¿™ä¸ªåœ°æ–¹å¾ˆè¿·çš„å°±æ˜¯ï¼Œå¦‚æœæ¯æ¬¡æŸ¥è¯¢çš„æ˜¯ $kx+y$ è¿™ç§å½¢å¼ï¼Œé‚£ä¹ˆæ–œç‡å¯ä»¥ä¸‹å–æ•´ã€‚</p>
<p>ï¼ˆ2ï¼‰CDQåˆ†æ²»ï¼Œå˜æˆäº†é™æ€ç»´æŠ¤å‡¸åŒ…ã€‚å‘ç°ä¸¤è¾¹éƒ½æ’å®Œåºä¹‹åï¼Œä¸­é—´å°±å¯ä»¥ç›´æ¥å¤§åŠ›å½’å¹¶äº†ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥åšåˆ° $n\log n$ çš„ã€‚</p>
<h2 id="CF-848C"><a href="#CF-848C" class="headerlink" title="CF 848C"></a>CF 848C</h2><blockquote>
<p>ç»™â¼€ä¸ªæ•°åˆ—ï¼Œå®šä¹‰â¼€æ®µçš„æƒå€¼ä¸ºæ¯ä¸ªä¸åŒçš„æ•°å€¼æœ€åâ¼€æ¬¡å‡ºç°çš„ä½ç½®å‡å»ç¬¬â¼€æ¬¡å‡ºç°çš„ä½ç½®å’Œã€‚</p>
<p>è¦æ±‚å•ç‚¹ä¿®æ”¹/æ±‚æŸâ¼€æ®µçš„æƒå€¼å’Œã€‚</p>
</blockquote>
<p>ç¥ä»™æ‰¾æ€§è´¨é¢˜ã€‚è€ƒè™‘ä»¤æ¯ä¸ª $i$ çš„è´¡çŒ®æ˜¯ $i-\mathrm{pre}_{a_i}$ï¼Œé‚£ä¹ˆå°±æ˜¯åœ¨äºŒç»´æ•°ç‚¹ï¼š $\sum_{l \leq \text { pre}_{a_{i}}&lt;i\leq r} i-\text {pre}_{a_i}$ ã€‚äºæ˜¯å¯ä»¥ç›´æ¥CDQåˆ†æ²»ã€‚</p>
<h2 id="UOJ-50-é“¾å¼ååº”"><a href="#UOJ-50-é“¾å¼ååº”" class="headerlink" title="UOJ#50 é“¾å¼ååº”"></a>UOJ#50 é“¾å¼ååº”</h2><blockquote>
<p>æ±‚è§£å¾®åˆ†æ–¹ç¨‹</p>
<script type="math/tex; mode=display">
f'(x)=f^2(x)p(x)+1</script><p>çš„å‰ $m$ é¡¹ã€‚</p>
</blockquote>
<p>åŒ–ä¸€ä¸‹å¼å­</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum nf_{n}x^{n-1}&=\sum \sum_{0\leq i+j<n}f_{i}\cdot f_j\cdot p_{n-1-i-j}\\
f_{n}&=\frac{1}{n} \sum_{0 \leq i+j \leq n-1} f_{i} \cdot f_{j} \cdot p_{n-1-i-j}
\end{aligned}</script><p>ç„¶åè€ƒè™‘å¤§æ¦‚æ˜¯ä¸€ä¸ªåˆ†æ²»FFTå½¢å¼ã€‚äºæ˜¯è€ƒè™‘CDQåˆ†æ²»ã€‚ç„¶åè€ƒè™‘æ€ä¹ˆçœ‹å·¦è¾¹ç³»æ•°å¯¹å³è¾¹çš„è´¡çŒ®ã€‚</p>
<p>è€ƒè™‘å¦‚æœ $l=0$ ã€‚é‚£ä¹ˆæœ¬è´¨ä¸Šå°±æ˜¯ $f_{0\sim mid}^2* p_{0\sim r-1}$ å·èµ·æ¥ï¼Œç„¶åæŠŠ $&gt;mid$ çš„é‚£äº›è´¡çŒ®å…¨éƒ¨ç´¯åŠ ã€‚</p>
<p>å¦åˆ™ä¸€å®šæœ‰ $2l&gt;r$ ã€‚å‘ç° $i\in [l,mid]$ æˆ–  $j\in [l,mid]$ ï¼Œå› ä¸ºå¯¹äºä»»æ„ $i\in [l,mid]$ï¼Œå‡æœ‰ $r-1-i&lt;l$ ã€‚æ‰€ä»¥æœ€åå°±å˜æˆäº† $f_{0\sim r-1-l},p_{0\sim r-1-l}$ å’Œ $f_{l\sim mid}$ çš„å·ç§¯ã€‚</p>
<p>å¤æ‚åº¦ $m\log ^2 m$ ã€‚</p>
<h1 id="Part3-çº¿æ®µæ ‘åˆ†æ²»"><a href="#Part3-çº¿æ®µæ ‘åˆ†æ²»" class="headerlink" title="Part3 çº¿æ®µæ ‘åˆ†æ²»"></a>Part3 çº¿æ®µæ ‘åˆ†æ²»</h1><h2 id="åŠ¨æ€å›¾è¿é€šæ€§"><a href="#åŠ¨æ€å›¾è¿é€šæ€§" class="headerlink" title="åŠ¨æ€å›¾è¿é€šæ€§"></a>åŠ¨æ€å›¾è¿é€šæ€§</h2><blockquote>
<p>å›æº¯çš„æ—¶å€™ä»ç„¶éœ€è¦åˆ é™¤æŸäº›è¾¹ï¼Œä½†æ˜¯å‘ç°åˆ è¾¹çš„é¡ºåºç­‰äºåŠ è¾¹çš„é¡ºåºçš„å€’åºã€‚å³ï¼Œæˆ‘ä»¬å°†æ— åºçš„åˆ é™¤è½¬åŒ–ä¸ºäº†æ“ä½œæ ˆçš„å‹å…¥å’Œå¼¹å‡ºã€‚æ­¤æ—¶åªéœ€ç»´æŠ¤ä¸€ä¸ªå¯å›é€€å¹¶æŸ¥é›†å³å¯ã€‚æ³¨æ„æ­¤å¤„çš„å¹¶æŸ¥é›†éœ€è¦æŒ‰ç§©åˆå¹¶ï¼Œå› ä¸ºè·¯å¾„å‹ç¼©çš„å¤æ‚åº¦æ˜¯å‡æ‘Šçš„ï¼Œæ— æ³•ä¿è¯å›é€€æ—¶çš„å¤æ‚åº¦ã€‚</p>
</blockquote>
<h2 id="ä¸åŒ…å«æŸä¸ªç‰©å“çš„èƒŒåŒ…"><a href="#ä¸åŒ…å«æŸä¸ªç‰©å“çš„èƒŒåŒ…" class="headerlink" title="ä¸åŒ…å«æŸä¸ªç‰©å“çš„èƒŒåŒ…"></a>ä¸åŒ…å«æŸä¸ªç‰©å“çš„èƒŒåŒ…</h2><p>æ™®é€šçš„èƒŒåŒ…åŠ å…¥æ˜¯ $O(m)$ï¼Œåˆå¹¶æ˜¯ $O(m^2)$ï¼Œåˆ é™¤æ˜¯ $O(nm)$ çš„ã€‚</p>
<p>è€ƒè™‘çº¿æ®µæ ‘åˆ†æ²»ã€‚ä¸€ä¸ªç‰©å“çš„å­˜æ´»æ—¶é—´æ˜¯ $[1,k-1]$ å’Œ $[k+1,n]$ ã€‚ä»¤ <code>solve(l,r,f)</code> è¡¨ç¤ºæŠŠ $[l,r]$ ä¹‹å¤–çš„ç‰©å“åŠ å…¥èƒŒåŒ…æ—¶å¾—åˆ°çš„æ˜¯ $f$ ã€‚äºæ˜¯å°±è€ƒè™‘åˆ†æ²»ä¸‹å»ï¼Œå¯¹äº <code>solve(l,mid,g)</code> è€Œè¨€ï¼Œ<code>g</code> æ˜¯ <code>f</code> å’Œ $mid+1\sim r$ ä¹‹é—´ä¿¡æ¯çš„åˆå¹¶ï¼›åä¹‹ <code>solve(mid + 1,r,h)</code> ä¸­ <code>h</code> éœ€è¦æ—¶ <code>f</code> å’Œ $l\sim mid$ çš„ä¿¡æ¯çš„åˆå¹¶ã€‚åˆ†æ²»ä¸‹å»å³å¯ã€‚</p>
<p>æœ€ç»ˆå¤æ‚åº¦ $O(nm\log n)$ .</p>
<h2 id="ä¸ç»è¿‡æŸä¸ªç‚¹çš„æœ€çŸ­è·¯-æ–¹æ¡ˆæ•°"><a href="#ä¸ç»è¿‡æŸä¸ªç‚¹çš„æœ€çŸ­è·¯-æ–¹æ¡ˆæ•°" class="headerlink" title="ä¸ç»è¿‡æŸä¸ªç‚¹çš„æœ€çŸ­è·¯/æ–¹æ¡ˆæ•°"></a>ä¸ç»è¿‡æŸä¸ªç‚¹çš„æœ€çŸ­è·¯/æ–¹æ¡ˆæ•°</h2><p>è·Ÿä¸Šä¸ªé¢˜æœ¬è´¨ä¸€æ ·ï¼Ÿ ç›´æ¥åšæ˜¾ç„¶æ˜¯ $n^4$ çš„å˜›ï¼Œæ‰€ä»¥å°±çº¿æ®µæ ‘åˆ†æ²»ä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<h2 id="HNOIåŸå¸‚å»ºè®¾"><a href="#HNOIåŸå¸‚å»ºè®¾" class="headerlink" title="HNOIåŸå¸‚å»ºè®¾"></a>HNOIåŸå¸‚å»ºè®¾</h2><blockquote>
<p>æ”¯æŒä¿®æ”¹è¾¹æƒå’ŒæŸ¥è¯¢MSTã€‚</p>
</blockquote>
<p>è¿˜æ˜¯è€ƒè™‘çº¿æ®µæ ‘åˆ†æ²»å˜›ï¼Œä½†æ˜¯ LCT åšå°±æ˜¾ç„¶å¤æ‚åº¦ä¸æ˜¯é‚£ä¹ˆé è°±ã€‚</p>
<p>è€ƒè™‘ä¸€ç§ä¸ç”¨ LCT çš„åšæ³•ã€‚å‘ç°å‡è®¾è¦ä¿®æ”¹ $1$ æ¡è¾¹ï¼Œé‚£ä¹ˆè¿™ä¸ªä¿®æ”¹è‡³å¤šä¼šå½±å“ä¸€æ¡è¾¹ï¼Œä¹Ÿå°±æ˜¯å¯¹äº <code>solve(l,r)</code> æœ€å¤šä¼šå½±å“ $O(r-l)$ æ¡è¾¹ã€‚å‘ç°è¿™ä¸ªå˜åŒ–é‡å¹¶ä¸å¤§ï¼Œæ­£å¥½æ»¡è¶³åˆ†æ²»çš„å¤æ‚åº¦ã€‚äºæ˜¯è€ƒè™‘å›¾å’ŒæŠŠæ¯ä¸€å±‚çš„æ“ä½œæ•°éƒ½é™åˆ° $O(r-l)$ ã€‚</p>
<p>è€ƒè™‘å¯¹äºä¸åœ¨å½“å‰åŒºé—´çš„è¾¹é›†çš„è¾¹è¿›è¡Œåˆ†ç±»ï¼Œä¸€ç±»æ˜¯ä¸€å®šä¸ä¼šåœ¨MSTä¸­çš„ï¼Œä¸€ç±»æ˜¯ä¸€å®šä¼šåœ¨MSTä¸­çš„ã€‚å…·ä½“çš„ï¼Œå¯¹äºåˆ†æ²»çš„æ¯ä¸€å±‚ï¼Œè®¾å½“å‰å±‚éœ€è¦ä¿®æ”¹çš„è¾¹é›†ä¸º $E$ï¼Œé‚£ä¹ˆé¦–å…ˆæŠŠ $E$ ä¸­çš„è¾¹æƒå‡è®¾ä¸º $-\infty$ è·‘ä¸€æ¬¡MSTï¼Œè¿™æ ·MSTä¸­ $\not \in E$ ä»¥å¤–çš„è¾¹å°±æ˜¯å¿…é€‰è¾¹ï¼›å†è®¾ä¸º $+\infty$ ï¼Œè¿™æ ·MSTä¸­ $\not \in E$ çš„å°±æ˜¯å¿…ä¸é€‰è¾¹ã€‚</p>
<p>æ³¨æ„åˆ°ï¼Œå¦‚æœæ¯æ¬¡å°†å¿…é€‰è¾¹è¿æˆçš„è¿é€šå—ç¼©èµ·æ¥ï¼Œè¿™æ ·åˆ†æ²»ä¸‹å»æ¯å±‚çš„ç‚¹æ•°å°±æ˜¯ $O(r-l)$ çš„ï¼›å¦‚æœæ¯æ¬¡å°†æ‰€æœ‰å¿…ä¸é€‰è¾¹åˆ æ‰ï¼Œé‚£ä¹ˆç”±äºè‡³å¤šæ˜¯ç”Ÿæˆæ ‘ä¸Šé‚£äº›è¾¹ï¼Œè·Ÿç‚¹æ•°åŒé˜¶ï¼Œä¹Ÿæ˜¯ $O(r-l)$ çš„ï¼Œå†åŠ ä¸Šæœ¬å±‚çš„ $O(r-l)$ çš„è¾¹ï¼Œæœ€ç»ˆè¾¹é›†ä¹Ÿæ˜¯ $O(r-l)$ çš„ã€‚è¿™æ ·å¤æ‚åº¦å°±å¯¹äº†ã€‚æœ€ç»ˆå¤æ‚åº¦ä¸º $n\log^2 n$ ï¼Œå…¶ä¸­å¦ä¸€ä¸ª $\log$ æ˜¯å¯å›é€€å¹¶æŸ¥é›†çš„ã€‚</p>
<p>æ”¹å¤©å†™ä¸€ä¸‹è¿™é¢˜å§quq</p>
<h2 id="å«–æ¥çš„ç¬”è®°"><a href="#å«–æ¥çš„ç¬”è®°" class="headerlink" title="å«–æ¥çš„ç¬”è®°"></a>å«–æ¥çš„ç¬”è®°</h2><p>å±±ä¸œé˜Ÿé•¿swkå†™çš„å¼å“‡ï¼</p>
<p><img src="236.png" alt></p>
<h2 id="UOJ-191-Unknown"><a href="#UOJ-191-Unknown" class="headerlink" title="UOJ#191 Unknown"></a>UOJ#191 Unknown</h2><blockquote>
<p>ç»´æŠ¤å‘é‡åºåˆ—ï¼Œæ”¯æŒæœ«å°¾æ’å…¥/åˆ é™¤å…ƒç´ ï¼Œè¯¢é—®åŒºé—´ä¸è¾“å…¥çš„å‘é‡ç‚¹ç§¯æœ€å¤§å€¼ã€‚</p>
</blockquote>
<p>å‘ç°åªæœ‰æœ«å°¾æ’å…¥å’ŒåŒºé—´æŸ¥è¯¢çš„è¯å¤§æ¦‚å¯ä»¥ <code>2048</code> ç€åšã€‚è¿™ä¸ª <code>2048</code> å¤§æ¦‚æ˜¯æŒ‡æ¯æ’å…¥ä¸€ä¸ªå…ƒç´ ï¼Œéƒ½åˆå¹¶åˆ°æœ€å°çš„é‚£ä¸€å †é‡Œï¼Œç„¶åå°†è¿™ä¸€å †äºŒè¿›åˆ¶æ‹†åˆ†ï¼Œå¦‚æœåˆå¹¶åå­˜åœ¨å’Œä»–ä¸€æ ·å¤§å°çš„ä¸€å †å°±ç»§ç»­åˆå¹¶ã€‚æŸ¥è¯¢çš„æ—¶å€™å°±æ¯ä¸€å †åˆ†åˆ«æŸ¥è¯¢ï¼Œæ€»æŸ¥è¯¢å¤æ‚åº¦ä¼šå¤šä¸€ä¸ª $\log $ã€‚ä»è¿™ä¸ªåœ°æ–¹ä¹Ÿå¯çœ‹å‡ºï¼Œç”±äºåªéœ€è¦é‡æ„ï¼Œæ‰€ä»¥ä¸éœ€è¦æ’å…¥åˆ é™¤ååˆ†ä¼˜ç§€ã€‚</p>
<p>è€ƒè™‘é‡æ„å¤æ‚åº¦ã€‚é‡æ„çš„å¤æ‚åº¦åˆ†ææ—¶å¤§å¤šéƒ½æ˜¯å‡æ‘Šåˆ†æï¼šæ¯ä¸ªå…ƒç´ æœ€å¤šè¢«é‡æ„ $\log n$ æ¬¡ï¼Œæ‰€ä»¥æœ€å¤šæ˜¯ $n\log n$ çš„ã€‚</p>
<p>ç”±äºçº¿æ®µæ ‘çš„åˆå¹¶æ“ä½œæœ‰ç€è¾ƒä¼˜çš„å¤æ‚åº¦ï¼Œäºæ˜¯è€ƒè™‘ç”¨çº¿æ®µæ ‘æ¥ç»´æŠ¤ã€‚è¿™æ ·å¤§æ¦‚æ˜¯ $O(n\log^2 n)$ çš„å¤æ‚åº¦ã€‚</p>
<p>æ¥ä¸‹æ¥è€ƒè™‘å¸¦åˆ é™¤æ“ä½œçš„é—®é¢˜ã€‚</p>
<p>å¦‚æœæ˜¯ç¦»çº¿ï¼Œç”±äºåªæœ‰æœ«å°¾çš„æ’å…¥å’Œåˆ é™¤ï¼Œå¯ä»¥ç”¨ç‰ˆæœ¬æ ‘çš„æ€æƒ³æ¥åšï¼Œå¤§æ¦‚æ˜¯éšç€åºåˆ—é€’å¢ï¼Œå»ºå‡ºä¸€æ£µæ·±åº¦é€’å¢çš„æ ‘ï¼Œå¯¹äº $i$ å·ç»“ç‚¹åé¢çš„ <code>Ins</code>, <code>Del</code> , <code>Ins</code>, <code>Ins</code> , <code>Del</code>, <code>Del</code>, <code>Ins</code> è€Œè¨€ï¼Œä»£è¡¨ç€è¯¥ç»“ç‚¹çš„ä¸‰ä¸ªåˆ†æ”¯(å„¿å­)ï¼Œç„¶åæ¯æ¬¡ç®—å¤§æ¦‚å°±æ˜¯æ ‘å‰–ä¸€ä¸‹ï¼Œè¿™æ ·å°±æ˜¯ $\log ^ 3n$ çš„å¤æ‚åº¦äº†ï¼šçº¿æ®µæ ‘é‡Œé¢ä¸¤ä¸ª $\log $ï¼Œå‡¸åŒ…äºŒåˆ†å†è¦ä¸€ä¸ª $\log$ ã€‚ï¼ˆè¿™ä¸ªåœ°æ–¹å¤æ‚åº¦è¿˜æ˜¯ä¸å¾ˆä¼šç®—ï¼Œå¥½åƒæ˜¯å¦‚æœå°†è¯¢é—®æ’åºå°±å¯ä»¥å°‘ä¸€ä¸ª $\log$ æ‰€ä»¥æœ€åæ˜¯ $3$ ä¸ª $\log$ï¼Œå¥½åƒå¾ˆnbçš„æ ·å­ï¼‰ã€‚</p>
<p>è€ƒè™‘åœ¨çº¿å¦‚ä½•ç”¨äºŒè¿›åˆ¶åˆ†ç»„æ¥åšã€‚å¦‚æœç›´æ¥æš´åŠ›åšï¼Œå°±ä¸èƒ½ä¿è¯æ¯ä¸ªå…ƒç´ éƒ½è¢«åˆå¹¶ $\log n$ æ¬¡ï¼Œæ‰€ä»¥åœ¨æŸä¸ªå—æœ«å°¾åå¤æ’å…¥åˆ é™¤å°±ä¼šäººæ²¡äº†ã€‚</p>
<p>äºæ˜¯è€ƒè™‘ä¸¤ç§æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>ç¬¬ä¸€ç§æ˜¯ç±»ä¼¼ $\rm Treap$ çš„éšæœºåŒ–ï¼Œæ’å…¥æ¯ä¸ªå…ƒç´ æ—¶éšæœºä¸€ä¸ªæƒå€¼ï¼Œå¹¶ä½œä¸ºç‹¬ç«‹ä¸€ç»„ã€‚è‹¥æœ€åä¸€ç»„çš„æœ€å°æƒå€¼å°äºå‰ä¸€ç»„çš„æœ€å°æƒå€¼ï¼Œåˆ™å°†ä¸¤ç»„åˆå¹¶ã€‚åˆ é™¤æ—¶æš´åŠ›å°†æœ€åä¸€å—æ‹†æ•£ï¼Œå¹¶æŒ‰ç…§æ’å…¥çš„è§„åˆ™é‡æ„å³å¯ã€‚å¯ä»¥è¯æ˜æœŸæœ›å¤æ‚åº¦ä»æ˜¯ $O(n\log^2n)$ã€‚</p>
<p>ç¬¬äºŒç§æ˜¯æ‰“æ ‡è®°ã€‚è€ƒè™‘å¯¹äºæ¯ä¸ªè¢«å»ºå‡ºæ¥çš„å—ï¼Œå› ä¸ºè¢«åˆ é™¤çš„å…ƒç´ ä¸ä¼šå‡ºç°åœ¨åŒºé—´è¯¢é—®å†…ã€‚é—®é¢˜å‡ºç°åœ¨è¢«åˆ é™¤çš„ä½ç½®é‡æ–°è¢«å¡«æ»¡æ—¶ï¼Œæ­¤æ—¶å¯¹è¿™ä¸ªå—æ‰“ä¸€ä¸ªã€Œåã€æ ‡è®°ã€‚æŸ¥è¯¢çš„æ—¶å€™ï¼Œå¦‚æœè¿™ä¸ªå—æ˜¯åçš„å°±å‘ä¸¤è¾¹çš„å„¿å­é€’å½’æŸ¥ã€‚è€ƒè™‘å¦‚ä½•è®©è¿™ä¸ªç»“æ„ä¸é€€åŒ–ï¼Œæˆ‘ä»¬çº¦å®šæ¯ä¸€å±‚è‡³å¤šæœ‰ä¸€ä¸ªåçš„å—ï¼Œå¹¶ä¸”è¦æœ€é å³ã€‚å¦åˆ™å°±å¤§åŠ›é‡æ„å…¶ä¸­çš„å¦ä¸€ä¸ªå—ã€‚</p>
<p>è¿™æ ·å°±ä¿è¯æ¯ä¸€å±‚åªå‘ä¸€ä¾§é€’å½’ï¼Œè¯¢é—®çš„å¤æ‚åº¦æ˜¯å¯¹çš„ã€‚æ’å…¥ã€åˆ é™¤éƒ½æ˜¯åœ¨åºåˆ—æœ«å°¾è¿›è¡Œï¼Œå› æ­¤è¢«æ‰“æ ‡è®°çš„èŠ‚ç‚¹ä¹Ÿåªå­˜åœ¨äºåºåˆ—æœ«å°¾ã€‚å› æ­¤ï¼Œè¦è¾¾åˆ°é•¿åº¦ä¸º $len$ çš„åŒºé—´çš„é‡æ„æ ‡å‡†ï¼Œè‡³å°‘éœ€è¦è¿›è¡Œ $O(len)$ æ¬¡æ“ä½œï¼Œé‡æ„çš„å‡æ‘Šå¤æ‚åº¦ä¸º $O(1)$ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¦»çº¿ç®—æ³•/CDQåˆ†æ²»</tag>
        <tag>ç¦»çº¿ç®—æ³•/çº¿æ®µæ ‘åˆ†æ²»</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘Codeforces [Global Round 7F] Wise Men</title>
    <url>/2020/03/22/GlobalRound7F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>æœ‰ $n$ ä¸ªäººã€‚ç»™å‡º $n$ ä¸ªäººçš„ã€Œè®¤è¯†æƒ…å†µã€(åŒå‘ä¸”ä¿è¯åˆæ³•)ã€‚</p>
<p>å®šä¹‰ <code>bool</code> å€¼å‡½æ•° $K(i,j)$ è¡¨ç¤ºä¸¤ä¸ªäººæ˜¯å¦è®¤è¯†ã€‚è€ƒè™‘ä¸€ä¸ª $n$ ä¸ªäººç¼–å·çš„æ’åˆ— $p$ ï¼Œå®šä¹‰å…¶ç”Ÿæˆçš„ $01$ ä¸² $\{s_{n-1}\}$ ä¸º $\forall i\in[1,n-1]\cap\mathbb{Z_+},s_i=K(p_{i},p_{i+1})$ã€‚</p>
<p>ç»Ÿè®¡å¯¹äº $2^{n-1}$ ç§ä¸åŒçš„ $01$ ä¸²ï¼Œæœ‰å¤šå°‘ç§æ’åˆ—å¯ä»¥ç”Ÿæˆå®ƒã€‚</p>
<p>F1: $2\leq n\leq 14$ ã€‚</p>
<p>F2 : $2\leq n\leq 18$ ã€‚</p>
</blockquote>
<p>ç¥ä»™è®¡æ•°é¢˜ï¼Œå†ä¸€æ¬¡æ·±æ·±åœ°æ˜ç™½äº†è‡ªå·±çš„å¼±å°ã€‚</p>
<a id="more"></a>
<p>é¦–å…ˆè€ƒè™‘ï¼Œå¯¹äºä¸€ä¸ªä¸² $s$ è€Œè¨€ï¼Œç›´æ¥ç»Ÿè®¡æ¯”è¾ƒéº»çƒ¦ï¼Œéº»çƒ¦åœ¨éš¾ä»¥ä½“ç°ã€Œä¸è®¤è¯†ã€è¿™ä¸ªé™åˆ¶ä¸Šã€‚æ‰€ä»¥è€ƒè™‘å¦‚ä½•å¿½ç•¥è¿™ä¸ªé™åˆ¶ã€‚è€ƒè™‘å¿½ç•¥é™åˆ¶åï¼Œå°±å˜æˆäº†ç»Ÿè®¡ $ans(s)$ è¡¨ç¤º<strong>è‡³å°‘</strong>å«æœ‰é›†åˆ $s$ çš„æ’åˆ—æ•°ã€‚</p>
<p>é‚£ä¹ˆå¯¹äº $ans(s)$ å­˜åœ¨ä¸€ä¸ªæ€§è´¨ï¼šå¦‚æœ $s$ å’Œ $sâ€™$ ä¸­ï¼Œè¿é€šåˆ†é‡çŠ¶æ€ç›¸åŒï¼Œé‚£ä¹ˆä¸¤ä¸ªé›†åˆçš„ $ans$ æ˜¯ç­‰ä»·çš„ã€‚æ­¤å¤„è¿é€šåˆ†é‡æŒ‡çš„æ˜¯è¿ç»­ä¸€æ®µäº’ç›¸è®¤è¯†çš„äººï¼ŒçŠ¶æ€ç›¸åŒæŒ‡çš„æ˜¯ $s$ å’Œ $sâ€™$ çš„è¿™äº›æ®µå¤§å°ç›¸åŒï¼Œæ’å¸ƒå¯ä»¥ä¸åŒã€‚ï¼ˆæ¯”å¦‚ $0100111\Longleftrightarrow0011101\Longleftrightarrow1000111$ï¼‰ ã€‚</p>
<p>è¯æ˜å¾ˆç®€å•ï¼Œå› ä¸ºå¯¹äºç”Ÿæˆ $01$ çš„ä¸²è€Œè¨€ï¼Œå…¶æ–¹æ¡ˆæ•°åªåœ¨äºæœ‰å¤šå°‘æ’åˆ—å¯ä»¥å‡‘å‡ºè¿™äº› $1$ çš„è¿ç»­æ®µè€Œå·²ã€‚æ¢è¨€ä¹‹å°±æ˜¯ç”±äºæ˜¯å…¨æ’åˆ—ï¼Œæ‰€ä»¥å¯¹ç§°ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºä¸€ä¸ªé•¿åº¦ä¸º $k$ çš„ $1$ è¿ç»­æ®µï¼Œå…¶åŒ…å« $k+1$ ä¸ªäº’ç›¸è®¤è¯†çš„äººï¼Œä¹Ÿå°±æ˜¯è¯¥è¿é€šå—å¤§å°ä¸º $k+1$ ã€‚</p>
<p>è€ƒè™‘å¦‚ä½•æ±‚ $ans(s)$ ã€‚æ³¨æ„åˆ°ç°åœ¨å·²ç»è½¬åŒ–æˆäº†ç»Ÿè®¡æ¯ä¸€ç§å¯¹ $n$ çš„æ‹†åˆ†æ–¹å¼ï¼Œæœ‰å¤šå°‘ç§æ’åˆ—æ•°ã€‚é‚£ä¹ˆä¸€ä¸ªæ¯”è¾ƒè‡ªç„¶çš„æƒ³æ³•å°±æ˜¯æ±‚ä¸‹å¼</p>
<script type="math/tex; mode=display">
\sum_{\begin{aligned}&t_1,t_2,t_3\cdots t_p\\ &\forall i,j,t_i\cap t_j=\empty \\&|t_1|+|t_2|+\cdots +|t_p|=n\end{aligned}} \prod_{k=1}^p f(t_k,|s_k|)</script><p>å…¶ä¸­ $t_i$ è¡¨ç¤ºæšä¸¾çš„ç¬¬ $i$ ä¸ªç‚¹é›†ï¼Œ$s_i$ è¡¨ç¤ºç»„æˆ $s$ è¿™ä¸ª $01$ ä¸²çš„ç¬¬ $i$ ä¸ªè¿é€šå—(é“¾å½¢æ€çš„ç‚¹é›†) ï¼Œ$f_{i,j}$ è¡¨ç¤ºä» $size(i)=j$ çš„é›†åˆ $i$ é‡Œé¢é€‰å‡ºä¸€ä¸ªå¤§å°ä¸º $j$ çš„<strong>é“¾</strong>çš„æ–¹æ¡ˆæ•°ã€‚ä¸éš¾çŸ¥é“è¿™äº›é™åˆ¶çš„æ„ä¹‰ï¼šåˆ’åˆ†å¿…é¡»æ°å¥½åˆ’åˆ†æ‰ $n$ ä¸ªç‚¹ï¼Œä¸”ç‚¹é›†ä¹‹é—´ä¸å­˜åœ¨äº¤é›†(å¦åˆ™éœ€è¦åˆå¹¶)ã€‚</p>
<p>ä¸Šå¼çš„æ„ä¹‰åœ¨äºï¼Œå¯¹äº $s$ çš„ä¸€ä¸ªåˆ’åˆ†ï¼Œæ¯ä¸ªè¿é€šå—éƒ½éœ€è¦ä»æŸä¸ªç‚¹é›†ä¸­é€‰å‡ºï¼Œè€Œç‚¹é›†ä¹‹é—´æ˜¯äº’ä¸ç›¸äº¤çš„ï¼Œæ‰€ä»¥ $size$ å¿…é¡»æ°å¥½æ˜¯é“¾é•¿ã€‚äºæ˜¯å¯ä»¥ä»è¿™ä¸ªè§’åº¦å…¥æ‰‹æ¥æ±‚æ’åˆ—æ•°ã€‚åŒæ—¶éœ€è¦æ³¨æ„ï¼Œç”±äºæˆ‘ä»¬æ˜¯ç¡¬ç”Ÿç”Ÿåˆ’å®šäº† $p$ ä¸ªé›†åˆï¼Œå¹¶ä¸å…³å¿ƒé›†åˆä¹‹é—´æ˜¯å¦æœ‰è¿è¾¹ï¼Œä¹Ÿå°±ä»£è¡¨äº†å…¶ä¸­æœ‰äº›å•ç‚¹(ä¹Ÿå°±æ˜¯ $s$ ä¸­çš„ $0$ ä½ç½®)å¯èƒ½æ˜¯ä¸å…¶ä»–è¿é€šå—æ˜¯ä¸€ä½“çš„ï¼Œè¿™ä¹Ÿå°±ç¬¦åˆäº†æˆ‘ä»¬å¯¹ $ans(s)$ çš„å®šä¹‰ï¼š<strong>è‡³å°‘</strong>å«æœ‰é›†åˆ $s$ çš„æ’åˆ—æ•°ã€‚</p>
<p>æ³¨æ„åˆ° $f$ æ˜¯æ¯”è¾ƒå®¹æ˜“æ±‚å¾—çš„ã€‚è€ƒè™‘ $g_{i,j}$ è¡¨ç¤ºé›†åˆ $i$ ä»¥ $j$ ç»“å°¾çš„é“¾çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆå°±æ˜¯ $n^2$ è½¬ç§»ï¼Œä¿è¯æ¯æ¬¡éƒ½ç”¨æœ€åä¸€ä¸ªç‚¹è½¬ç§»å°±å¯ä»¥ä½¿å¾—å½¢æ€æ˜¯ä¸€æ¡é“¾ã€‚$f$ å°±æ˜¯å¯¹ $g$ çš„ä¸€ä¸ªç´¯åŠ ã€‚è¿™ä¸€éƒ¨åˆ†å¤æ‚åº¦ $O(n^22^n)$ ã€‚</p>
<p>è€ƒè™‘æ±‚å‡º $f$ ä¹‹åå¦‚ä½•è®¡ç®—è¿™ä¸ªå¼å­ã€‚ä¸€ä¸ªæ¯”è¾ƒç›´æ¥çš„æƒ³æ³•æ˜¯æš´åŠ›æšä¸¾å­é›†çš„å­é›†æ¥è½¬ç§»ï¼Œç”±äº $\Pi$ å¯¹ $\Sigma$ æœ‰åˆ†é…å¾‹ï¼Œå¯çŸ¥è½¬ç§»æ˜¯ä¸éš¾çš„ã€‚å¤æ‚åº¦ $P(n)3^n$ï¼Œå…¶ä¸­ $P(n)$ æ˜¯æœ¬è´¨ä¸åŒçš„åˆ’åˆ†æ•°ã€‚å¯ä»¥è¿‡æ‰ $n=14$ çš„ $\rm F1$ ã€‚</p>
<p>å¯¹äº $\rm F2$ ï¼Œè€ƒè™‘è¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•ä¿è¯ä¸€ç»„ç›¸åŠ èµ·æ¥ $size$ ç­‰äºå…¨é›†çš„å­é›†äº’ä¸ç›¸äº¤ï¼Ÿå¾ˆæ˜¾ç„¶æ˜¯å¦‚æœä»–ä»¬çš„<strong>å¹¶</strong>å°±æ˜¯å…¨é›†ï¼Œé‚£ä¹ˆå½¼æ­¤ä¹‹é—´ä¸€å®šä¸ä¼šæœ‰äº¤ã€‚äºæ˜¯å¯ä»¥çŸ¥é“ç”¨ FMT æ¥ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚å…·ä½“çš„ï¼Œæ ¹æ®åˆ†é…å¾‹ï¼Œå¯ä»¥å¯¹æ¯ä¸ª $s_i$ åˆ†å¼€è®¡ç®—å…¶è´¡çŒ®ï¼Œè¿›è¡Œ $p$ æ¬¡ FMT ä¹‹åï¼Œç­”æ¡ˆå°±æ˜¯ç¬¬ $2^n-1$ é¡¹ç³»æ•°ã€‚</p>
<p>é‚£ä¹ˆå°±åšå®Œäº†ã€‚æœ€ååªéœ€å¯¹äºæ¯ä¸ª $01$ ä¸²ï¼Œæ±‚å‡ºä»–çš„åˆ’åˆ†å³å¯ã€‚æ³¨æ„åˆ°ä¸€å¼€å§‹ $ans$ çš„å®šä¹‰ï¼Œéœ€è¦æˆ‘ä»¬åšä¸€æ¬¡å­é›†å·®å˜æ¢ã€‚å¤§æ¦‚ç±»ä¼¼äºFMTå¤„ç†andçš„é€†è¿‡ç¨‹ã€‚æœ€ç»ˆå¤æ‚åº¦ $O(2^n(P(n)+n+n^2))$ ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_p pop_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_b push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vint vector<span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1200000</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> m ;</span><br><span class="line"><span class="keyword">int</span> tot ;</span><br><span class="line">ll I[M] ;</span><br><span class="line">ll t[M] ;</span><br><span class="line">ll ans[M] ;</span><br><span class="line">ll f[M][N] ;</span><br><span class="line">ll g[N][M] ;</span><br><span class="line">ll res[N * N] ;</span><br><span class="line"><span class="keyword">int</span> know[N][N] ;</span><br><span class="line"><span class="built_in">map</span>&lt;vint, <span class="keyword">int</span>&gt; Id ;</span><br><span class="line">vint part[N * N], now ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fmt_or</span><span class="params">(ll *f, <span class="keyword">int</span> g)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= m ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (j &gt;&gt; i &amp; <span class="number">1</span>) f[j] = f[j] + (ll)g * f[j ^ (<span class="number">1</span> &lt;&lt; i)] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs_part</span><span class="params">(<span class="keyword">int</span> st, <span class="keyword">int</span> big)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (st == n + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>(part[Id[now] = ++ tot] = now) ;</span><br><span class="line">    <span class="keyword">if</span> (n - st + <span class="number">1</span> &gt;= big)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = big ; i &lt;= n - st + <span class="number">1</span> ; ++ i)</span><br><span class="line">            now.p_b(i), dfs_part(st + i, i), now.p_p() ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i) f[<span class="number">1</span> &lt;&lt; i][i + <span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> len = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>) &amp; ~i) <span class="keyword">continue</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; k &lt;= n ; ++ k)&#123;</span><br><span class="line">                <span class="keyword">if</span> (!know[j][k]) <span class="keyword">continue</span> ;</span><br><span class="line">                <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>) &amp; i) <span class="keyword">continue</span> ;</span><br><span class="line">                f[i | (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>))][k] += f[i][j] ;</span><br><span class="line">            &#125;</span><br><span class="line">            ++ len ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>) &amp; i) g[len][i] += f[i][j] ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">memcpy</span>(t, I, <span class="keyword">sizeof</span>(I)) ;</span><br><span class="line">        <span class="keyword">int</span> o = (<span class="keyword">int</span>)part[i].size() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; o ; ++ j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt;= m ; ++ k)</span><br><span class="line">                t[k] *= g[part[i][j]][k] ;</span><br><span class="line">        fmt_or(t, <span class="number">-1</span>) ; res[i] = t[m] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//for (int i = 1 ; i &lt;= tot ; ++ i) cout &lt;&lt; res[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">revalue</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        now.clear() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>, r ; l &lt; n ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">            r = l ;</span><br><span class="line">            <span class="keyword">while</span> ((<span class="number">1</span> &lt;&lt; r) &amp; i &amp;&amp; r &lt; n)</span><br><span class="line">                ++ r ; now.p_b(r - l + <span class="number">1</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(now.begin(), now.end()) ;</span><br><span class="line">        ans[i] = res[Id[now]] ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    m = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span> ;</span><br><span class="line">    I[<span class="number">0</span>] = <span class="number">1</span> ; fmt_or(I, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%1d"</span>, &amp;know[i][j]) ; dp1() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) fmt_or(g[i], <span class="number">1</span>) ;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    for (int i = 1 ; i &lt;= n ; ++ i)</span></span><br><span class="line"><span class="comment">        for (int j = 1 ; j &lt;= m ; ++ j)</span></span><br><span class="line"><span class="comment">            cout &lt;&lt; g[i][j] &lt;&lt; " \n"[j == m] ;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    dfs_part(<span class="number">1</span>, <span class="number">1</span>) ; dp2() ; revalue() ;</span><br><span class="line">    <span class="comment">//for (int j = 1 ; j &lt;= m ; ++ j)</span></span><br><span class="line">    <span class="comment">//    cout &lt;&lt; I[j] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">    ((m += <span class="number">1</span>) &gt;&gt;= <span class="number">1</span>) -= <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = m ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">            <span class="keyword">if</span> (~j &gt;&gt; i &amp; <span class="number">1</span>)&#123;</span><br><span class="line">                ans[j] = ans[j] - ans[j | (<span class="number">1</span> &lt;&lt; i)] ;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="string">" \n"</span>[i == m] ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ’’èŠ±æ’’èŠ±ï¼ï¼</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/çŠ¶å‹DP</tag>
        <tag>æ€ç»´é¢˜/è®¡æ•°</tag>
        <tag>å¥½å¤šå¥½å¤šç»†èŠ‚</tag>
        <tag>å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢(FMT)</tag>
        <tag>å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢(FWT)</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘Codeforces[Global Round 7] $\rm A\to E$</title>
    <url>/2020/03/20/CFGlobalRound7/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¿™ä¸€åœºç›¸å¯¹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè‡³å°‘ $A\to E$ éƒ½æ˜¯æ¯”è¾ƒä¼ ç»Ÿçš„é¢˜ç›®ã€‚</p>
<p>å› ä¸ºFå¯¹æˆ‘æ¥è¯´ä¸æ˜¯å¾ˆgeneralï¼Œäºæ˜¯å•å¼€äº†ä¸€ç¯‡æ–‡ç« æ•´ç†Fäº†ã€‚</p>
<p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæ„Ÿè§‰æ‰€æœ‰Global Roundé‡Œé¢ï¼Œæœ€å–œæ¬¢çš„è¿˜æ˜¯ç¬¬ä¸€åœºã€‚</p>
<p>å”‰ï¼Œè¿‡å»çš„äº‹æƒ…ï¼Œä¹Ÿå°±åªèƒ½è®©å®ƒè¿‡å»äº†å§ã€‚</p>
<a id="more"></a>
<h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><blockquote>
<p>æ„é€ ä¸€ä¸ª $n$ ä½åè¿›åˆ¶æ•°ï¼Œä¿è¯ä¸è¢«è¯¥æ•°çš„ä»»æ„ä¸€ä½æ•´é™¤ã€‚</p>
<p>$1\leq n\leq 100000$</p>
</blockquote>
<p>æ„Ÿè§‰å°±æ˜¯ä¸€ä¸ªè€ƒååº”èƒ½åŠ›çš„ï¼Ÿï¼Ÿå¤§æ¦‚å°±æ˜¯çæ„é€ ã€‚æ­£ç¡®æ€§ä¼¼ä¹ä¸æ˜¯é‚£ä¹ˆæ˜¾ç„¶ï¼Ÿå”¯ä¸€çš„ä¸ç¡®å®šæ€§å°±æ˜¯è¿™ç§åšæ³•å¯èƒ½å‡ºç°æœ«å°¾æ¥ä¸Š $ 3\sim 9$ éƒ½ä¸åˆæ³•çš„æƒ…å†µï¼Œç„¶è€Œä¼¼ä¹æ•°æ®å¡ä¸äº†è¿™ä¸€ç‚¹ã€‚</p>
<p>ä»”ç»†æƒ³ä¸€æƒ³çš„è¯ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹çš„æ¡ä»¶ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
(n-1)*7+3 \equiv0\pmod 3\\
\cdots
\end{aligned}</script><p>å¥½çš„ï¼Œæˆ‘åˆšåˆšå†™å®Œå…³äº $3$ çš„å°±å‘ç°äº†ï¼Œåªè¦æ˜¯ $77777â€¦7774$ å°±ä¸€å®šåˆæ³•ã€‚æˆ‘å¤ªå¼Ÿå¼Ÿäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123; </span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T ; </span><br><span class="line">	<span class="keyword">while</span> (T --)&#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; n ; </span><br><span class="line">		<span class="keyword">if</span> (n == <span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"-1"</span>) ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n - <span class="number">1</span> ; ++ i)	<span class="built_in">printf</span>(<span class="string">"7"</span>) ;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="number">4</span> &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote>
<p>å¯¹äºä¸€ä¸ªåºåˆ— $\{a_n\}$ï¼Œå®šä¹‰åºåˆ— $\{c_n\}$ ï¼š$c_i=\max\{0,a_1,\cdots,a_{i-1}\}$ ã€‚åŒæ—¶å®šä¹‰åºåˆ— $\{b_n\} :b_i=a_i-c_i$ ã€‚</p>
<p>ç»™å®š $\{b_n\}$ ï¼Œæ±‚ $\{a_n\}$ ã€‚</p>
<p>$1\leq n\leq 200,000$</p>
</blockquote>
<p>è°”è°”ï¼Œå®Œå…¨å°±æ˜¯ä¸€é“æ¨¡æ‹Ÿé¢˜ï¼Œä¸çŸ¥é“è¿™ç§é¢˜æ˜¯æ€ä¹ˆå½“Bçš„ï¼Œä¸€ç‚¹æŠ€æœ¯å«é‡ä¹Ÿæ²¡æœ‰å•Šï¼Ÿï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> n, m ;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans[<span class="number">500010</span>] ;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> base[<span class="number">500010</span>] ;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i]) ; </span><br><span class="line">	ans[<span class="number">1</span>] = base[<span class="number">1</span>] ; m = ans[<span class="number">1</span>] ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)</span><br><span class="line">		ans[i] = base[i] + m, m = max(ans[i], m) ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%lld "</span>, ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„<strong>æ’åˆ—</strong> $\{a_n\}$ã€‚è¦æ±‚å°†è¿™ä¸ªåºåˆ—åˆ†æˆäº’ä¸ç›¸äº¤çš„ $k$ æ®µã€‚è®°ç¬¬ $p$ æ®µçš„å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹åˆ†åˆ«ä¸º $l_p,r_p$ ã€‚è¦æ±‚æœ€å¤§åŒ– </p>
<script type="math/tex; mode=display">
\sum_{i=1}^k\max_{j=l_i}^{r_i}\{a_j\}</script><p>åŒæ—¶è¾“å‡ºæœ€å¤§åŒ–è¯¥å€¼çš„æ–¹æ¡ˆæ•°ã€‚å¯¹ $998,244,353$ å–æ¨¡ã€‚</p>
</blockquote>
<p>å‘ç°æ˜¾ç„¶ $n-k+1\sim n$ è¿™å‡ ä¸ªæ•°æ˜¯ä¸€å®šèƒ½å–åˆ°çš„ã€‚ä¹˜æ³•åŸç†ç®—ä¸€ç®—åŒºé—´æ€ä¹ˆæ‹†å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k ; res = <span class="number">1l</span>l ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">		ans += (ll)(n - i + <span class="number">1</span>) ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (base[i] &gt; n - k)&#123; </span><br><span class="line">			<span class="keyword">if</span> (lst) </span><br><span class="line">				(res *= (ll)(i - lst)) %= P ; </span><br><span class="line">			lst = i ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">" "</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D1"><a href="#D1" class="headerlink" title="D1"></a>D1</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¦æ±‚é€‰å–ä»–çš„ä¸€ä¸ªå‰ç¼€(å¯ä»¥ä¸ºç©º)å’Œä¸è¯¥å‰ç¼€ä¸ç›¸äº¤çš„ä¸€ä¸ªåç¼€(å¯ä»¥ä¸ºç©º)æ‹¼æ¥æˆå›æ–‡ä¸²ï¼Œä¸”è¯¥å›æ–‡ä¸²é•¿åº¦æœ€å¤§ã€‚æ±‚è¯¥æœ€å¤§é•¿åº¦ã€‚</p>
<p>å¤šç»„æ•°æ®ã€‚ä¿è¯ $\sum n\leq 5000$ ã€‚</p>
</blockquote>
<p>è‰ï¼Œæˆ‘åšè¿™é¢˜çš„æ—¶å€™å°±æ˜¯nmç¦»è°±ã€‚æ„Ÿè§‰è‡ªå·±å®Œå…¨æ²¡å¸¦è„‘å­ã€‚ä¸€å¼€å§‹è¯»é”™é¢˜äº†ï¼Œä»¥ä¸ºæ˜¯ä¸ªæ„é€ é¢˜ï¼Œåªè¦æ„é€ ä¸€ä¸ªç”¨äº†éç©ºå‰ç¼€å’Œéç©ºåç¼€æ‹¼å‡ºæ¥å›æ–‡ä¸²å°±å¥½äº†ï¼Œç„¶åå†™å®Œä¹‹åçœ‹å®Œæ ·ä¾‹å°±è’™äº†ã€‚æ€è€ƒäº†åŠå¤©æ‰å‘ç°æ˜¯æœ€ä¼˜åŒ–é—®é¢˜ã€‚ç„¶åæ­¤æ—¶è¿˜æœ‰å¤§æ¦‚2hå·¦å³ï¼Œæˆ‘å°±è§‰å¾—å¤§æ¦‚ä¸ç”¨ä»”ç»†æ€è€ƒå¯ä»¥çå†™å†™ã€‚äºæ˜¯æˆ‘å°±æˆåŠŸåœ°ç”¨KMPå¾ˆéº»çƒ¦åœ°æ±‚äº†è¿™ä¸ªä¸²ã€Œæœ€é•¿çš„ã€æ‹¼åœ¨ä¸€èµ·å¯ä»¥å›æ–‡çš„å‰ç¼€å’Œåç¼€ã€ï¼Œç„¶åå‘ç°å°±æ˜¯ä¸ªManacheræ¿å­é¢˜ï¼Œç„¶ååˆå¾ˆéº»çƒ¦åœ°å»åˆ¤è¾¹ç•Œ(ä¸å¾—ä¸è¯´è¿™ä¸ªmanacheråˆ¤è¾¹ç•Œçš„éº»çƒ¦ç¨‹åº¦ä¹Ÿæ˜¯ä¸€ç»)ã€‚</p>
<p>ç„¶ååœ¨æˆ‘WAäº†å¥½å‡ å‘ä¹‹åæ‰å‘ç°ã€Œæœ€é•¿çš„ã€æ‹¼åœ¨ä¸€èµ·å¯ä»¥å›æ–‡çš„å‰ç¼€å’Œåç¼€ã€åªè¦æšä¸¾ä¸€ä¸‹å°±å¥½äº†â€¦æƒ¨æƒ¨â€¦</p>
<p>ç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚ä¸è¿‡å¥½åœ¨è¿˜æ˜¯æŠ¢æ•‘å›æ¥äº†ã€‚ä¸­é—´å¾ˆæ— å¥ˆD1å†™äº†ä¸ªæš´åŠ›ï¼Œä¸è¿‡è¿˜æ˜¯æœ€åç»æ€äº†D2â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> S[N] ;</span><br><span class="line"><span class="keyword">char</span> I[N] ;</span><br><span class="line"><span class="keyword">int</span> Len[N] ;</span><br><span class="line"><span class="keyword">int</span> len[N], st ; </span><br><span class="line"><span class="keyword">int</span> T, L, n, res ; </span><br><span class="line"><span class="keyword">int</span> ns[N], base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T ; </span><br><span class="line">	<span class="keyword">while</span> (T --)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, S + <span class="number">1</span>) ; </span><br><span class="line">		n = <span class="built_in">strlen</span>(S + <span class="number">1</span>) ; </span><br><span class="line">		res = <span class="number">0</span> ; st = <span class="number">0</span> ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">			<span class="keyword">if</span> (S[i] != S[n - i + <span class="number">1</span>]) <span class="keyword">break</span> ; <span class="keyword">else</span> st = i ;</span><br><span class="line">		<span class="keyword">int</span> p = n - st ; <span class="keyword">int</span> db = <span class="number">0</span> ; <span class="keyword">int</span> q = <span class="number">0</span> ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = st + <span class="number">1</span> ; i &lt;= p ; ++ i)&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = st + <span class="number">1</span> ; j &lt;= i ; ++ j)</span><br><span class="line">				I[j - st] = S[j] ; <span class="keyword">int</span> k = i - st ;</span><br><span class="line">			reverse(I + <span class="number">1</span>, I + k + <span class="number">1</span>) ; <span class="keyword">bool</span> fg = <span class="number">0</span> ; </span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= k ; ++ j)</span><br><span class="line">				<span class="keyword">if</span> (I[j] != S[j + st]) &#123; fg = <span class="number">1</span> ; <span class="keyword">break</span> ;&#125;</span><br><span class="line">			<span class="keyword">if</span> (!fg &amp;&amp; k &gt; res) res = i - st, db = <span class="number">1</span> ;  </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = p ; i &gt;= st + <span class="number">1</span> ; -- i)&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = i ; j &lt;= p ; ++ j)</span><br><span class="line">				I[j - i + <span class="number">1</span>] = S[j] ; <span class="keyword">int</span> k = p - i + <span class="number">1</span> ;</span><br><span class="line">			reverse(I + <span class="number">1</span>, I + k + <span class="number">1</span>) ; <span class="keyword">bool</span> fg = <span class="number">0</span> ; </span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= k ; ++ j)</span><br><span class="line">				<span class="keyword">if</span> (I[j] != S[j + i - <span class="number">1</span>]) &#123; fg = <span class="number">1</span> ; <span class="keyword">break</span> ;&#125;</span><br><span class="line">			<span class="keyword">if</span> (!fg &amp;&amp; k &gt; res) res = k, db = <span class="number">2</span> ;  </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!db)&#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; (S + <span class="number">1</span>) &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">			<span class="keyword">continue</span> ; </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (db == <span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= st + res ; ++ i) <span class="built_in">printf</span>(<span class="string">"%c"</span>, S[i]) ;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = n - st + <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">printf</span>(<span class="string">"%c"</span>, S[i]) ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (db == <span class="number">2</span>)&#123; </span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= st ; ++ i) <span class="built_in">printf</span>(<span class="string">"%c"</span>, S[i]) ;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = n - st - res + <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">printf</span>(<span class="string">"%c"</span>, S[i]) ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D2"><a href="#D2" class="headerlink" title="D2"></a>D2</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¦æ±‚é€‰å–ä»–çš„ä¸€ä¸ªå‰ç¼€(å¯ä»¥ä¸ºç©º)å’Œä¸è¯¥å‰ç¼€ä¸ç›¸äº¤çš„ä¸€ä¸ªåç¼€(å¯ä»¥ä¸ºç©º)æ‹¼æ¥æˆå›æ–‡ä¸²ï¼Œä¸”è¯¥å›æ–‡ä¸²é•¿åº¦æœ€å¤§ã€‚æ±‚è¯¥æœ€å¤§é•¿åº¦ã€‚</p>
<p>å¤šç»„æ•°æ®ã€‚ä¿è¯ $\sum n\leq 10^6$ ã€‚</p>
</blockquote>
<p>å—¯ï¼Œjianglyç¡®å®æ˜¯ç¥ä»™ã€‚ä»£ç å†™çš„åˆå¿«åˆæ•´æ´åˆæœ‰æ¡ç†ï¼Œæ¯”æˆ‘é«˜åˆ°ä¸çŸ¥é“å“ªé‡Œå»äº†â€¦</p>
<p>æ„Ÿè§‰è¿˜æ˜¯å¾ˆéš¾åœ¨åšé¢˜çš„æ—¶å€™è®©è‡ªå·±ä¿æŒæ¸…é†’çš„å¤´è„‘ã€‚è¿˜éœ€è¦å¤šåŠ ç»ƒä¹ ã€‚</p>
<p>å“¦å¯¹ï¼Œæœ‰ä¸ªå°ç»†èŠ‚éœ€è¦è¯´ä¸€ä¸‹ã€‚å°±æ˜¯ç”¨Manacheræšä¸¾æ¯ä¸ªä½ç½®ï¼Œåˆ¤æ–­å·¦ç•Œå’Œå³ç•Œèƒ½ä¸èƒ½æ‹¼èµ·æ¥çš„æ—¶å€™ï¼Œæ˜¯éœ€è¦å– $min$ çš„ã€‚è¿™ä¹Ÿå±äºç»†èŠ‚å§ï¼Ÿï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3000010</span> ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">char</span> S[N] ;</span><br><span class="line"><span class="keyword">int</span> ns[N], base[N] ;</span><br><span class="line"><span class="keyword">int</span> T, L, n, res, st ; </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Manacher</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> id, fars, i ; </span><br><span class="line">	id = <span class="number">0</span>, fars = <span class="number">0</span> ; L = <span class="number">-1</span> ;</span><br><span class="line">	ns[++ L] = <span class="string">'$'</span>, ns[++ L] = <span class="string">'#'</span> ;</span><br><span class="line">	<span class="comment">//id : æœ€é å³çš„å›æ–‡ä¸²çš„ä¸­å¿ƒä½ç½® </span></span><br><span class="line">	<span class="comment">//fars : è¿„ä»Šä¸ºæ­¢æœ€é å³çš„å›æ–‡ä¸²çš„æœ€å³ä¾§ </span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">		ns[++ L] = (<span class="keyword">int</span>)s[i], ns[++ L] = <span class="string">'#'</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= L ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (fars &lt;= i) base[i] = <span class="number">1</span> ; </span><br><span class="line">		<span class="keyword">else</span> base[i] = min(fars - i + <span class="number">1</span>, base[id * <span class="number">2</span> - i]) ;</span><br><span class="line">		<span class="keyword">while</span> (ns[i + base[i]] == ns[i - base[i]]) base[i] ++ ;</span><br><span class="line"> 		<span class="keyword">if</span> (i + base[i] &gt; fars) id = i, fars = i + base[i] - <span class="number">1</span> ;	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T ; <span class="keyword">int</span> op = T ; </span><br><span class="line">	<span class="keyword">while</span> (T --)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, S + <span class="number">1</span>) ; </span><br><span class="line">		n = <span class="built_in">strlen</span>(S + <span class="number">1</span>) ; res = st = <span class="number">0</span> ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">			<span class="keyword">if</span> (S[i] != S[n - i + <span class="number">1</span>]) <span class="keyword">break</span> ; <span class="keyword">else</span> st = i ;</span><br><span class="line">		<span class="keyword">int</span> p = n - st ; <span class="keyword">int</span> db = <span class="number">0</span> ; </span><br><span class="line">		Manacher(S) ; <span class="comment">//cout &lt;&lt; st &lt;&lt; endl ;</span></span><br><span class="line">		<span class="comment">//for (int i = 1 ; i &lt;= L ; ++ i) cout &lt;&lt; base[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= L ; ++ i)&#123;</span><br><span class="line">			<span class="keyword">int</span> l = i / <span class="number">2</span> - base[i] / <span class="number">2</span> + <span class="number">1</span> ; </span><br><span class="line">			<span class="keyword">int</span> r = i / <span class="number">2</span> + base[i] / <span class="number">2</span> - <span class="number">1</span> + (<span class="keyword">bool</span>)(ns[i] == <span class="string">'#'</span>) ;</span><br><span class="line">			<span class="keyword">int</span> p = base[i] - <span class="number">1</span>, q = base[i] - <span class="number">1</span> ; </span><br><span class="line">			<span class="comment">//cout &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; " " &lt;&lt; base[i] &lt;&lt; " " &lt;&lt; p &lt;&lt; " " &lt;&lt; q &lt;&lt; endl ;</span></span><br><span class="line">			<span class="keyword">if</span> (l &lt;= st) p -= <span class="number">2</span> * (st - l + <span class="number">1</span>) ;</span><br><span class="line">			<span class="keyword">if</span> (r &gt;= n - st + <span class="number">1</span>) p = min(p, q -= <span class="number">2</span> * (r - n + st)) ;</span><br><span class="line">			<span class="comment">//cout &lt;&lt; base[i] &lt;&lt; " " &lt;&lt; p &lt;&lt; " " &lt;&lt; q &lt;&lt; endl ;</span></span><br><span class="line">			l = i / <span class="number">2</span> - (p + <span class="number">1</span>) / <span class="number">2</span> + <span class="number">1</span> ; </span><br><span class="line">			r = i / <span class="number">2</span> + (p + <span class="number">1</span>) / <span class="number">2</span> - <span class="number">1</span> + (<span class="keyword">bool</span>)(ns[i] == <span class="string">'#'</span>) ;</span><br><span class="line">			<span class="keyword">if</span> (p &gt; res &amp;&amp; l &lt;= st + <span class="number">1</span>) db = <span class="number">1</span>, res = p ; </span><br><span class="line">			<span class="keyword">if</span> (p &gt; res &amp;&amp; r &gt;= n - st) db = <span class="number">2</span>, res = p ;</span><br><span class="line"> 		&#125;</span><br><span class="line">		<span class="comment">//cout &lt;&lt; db &lt;&lt; endl ;</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= L + <span class="number">2</span> ; ++ i) </span><br><span class="line">			ns[i] = <span class="number">0</span>, base[i] = <span class="number">0</span> ;</span><br><span class="line">		<span class="keyword">if</span> (!db)&#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; (S + <span class="number">1</span>) &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">			<span class="keyword">continue</span> ; </span><br><span class="line">		&#125; </span><br><span class="line">		<span class="comment">//cout &lt;&lt; res &lt;&lt; endl ; </span></span><br><span class="line">		<span class="keyword">if</span> (db == <span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= st + res ; ++ i) <span class="built_in">printf</span>(<span class="string">"%c"</span>, S[i]) ;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = n - st + <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">printf</span>(<span class="string">"%c"</span>, S[i]) ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (db == <span class="number">2</span>)&#123; </span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= st ; ++ i) <span class="built_in">printf</span>(<span class="string">"%c"</span>, S[i]) ;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = n - st - res + <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">printf</span>(<span class="string">"%c"</span>, S[i]) ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><blockquote>
<p>ç»™å®šä¸¤ä¸ªé•¿åº¦å‡ä¸º $n$ çš„æ’åˆ— $p,q$ ã€‚å¯¹ä¸€ä¸ªåˆå§‹ä¸ºç©ºçš„é›†åˆ $s$ è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼šå¯¹äºæ¯ä¸ª $i$ ï¼Œå°† $p_i$ æ”¾å…¥é›†åˆï¼›å¦‚æœ $i$ è¢«<strong>æ ‡è®°</strong>äº†ï¼Œåˆ™æ­¤æ—¶å†å°†é›†åˆä¸­æœ€å¤§çš„æ•°åˆ é™¤ã€‚æ±‚ $n$ æ¬¡æ“ä½œåé›†åˆä¸­æœ€å¤§çš„æ•°ã€‚</p>
<p>æ’åˆ— $q$ çš„æ„ä¹‰æ˜¯ï¼Œå¯¹äºæ¯ä¸ª $i$ ï¼Œè¯¢é—®å°† $q_1,q_2\cdots q_{i-1}$ éƒ½æ ‡è®°ä¹‹åçš„ä¸Šè¿°æ“ä½œçš„ç»“æœã€‚</p>
<p>$1\leq n\leq 300,000$ã€‚</p>
</blockquote>
<p>è¿™æ˜¯ä¸ªç¥é¢˜ã€‚å…¶å®ä¹Ÿä¸ç®—ä¸¥æ ¼æ„ä¹‰ä¸Šçš„ç¥ï¼Œåªæ˜¯æˆ‘æ²¡æ³¨æ„åˆ°å¾ˆå¤šæ€§è´¨å¯¼è‡´ggã€‚</p>
<p>é¦–å…ˆè€ƒè™‘ç­”æ¡ˆæœ€åä¸€å®šæ˜¯å•è°ƒçš„ã€‚äºæ˜¯æ ¹æ®è¿™ä¸ªæ€§è´¨è€ƒè™‘ä½•æ—¶åº”å½“æŠŠç­”æ¡ˆ $-1$ ã€‚å‘ç°å¦‚æœå¯¹äºå½“å‰çš„ä¸€ä¸ªç­”æ¡ˆ $x$ ï¼Œæ‰€æœ‰ $&gt;x$ çš„æ•°å³è¾¹å‡æœ‰ä¸€ä¸ªç‚¸å¼¹ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±éœ€è¦ $-1$ ã€‚æ‰€ä»¥æ‹†åˆ†ä¸‹æ¥çš„è¯ï¼Œæ¯æ¬¡åªéœ€è¦è€ƒè™‘ $x$ çš„å³è¾¹æ˜¯å¦å­˜æ‰ä¸€ä¸ªæœªè¢«å çš„ç‚¸å¼¹å³å¯ã€‚</p>
<p>è€ƒè™‘å¦‚ä½•å®ç°è¿™ä¸ªè¿‡ç¨‹ã€‚å¯¹äºæ¯ä¸ª $i$ è®°å½•åŒ…æ‹¬ $i $ åœ¨å†…çš„å³è¾¹æœ‰å¤šå°‘ $&gt;x$ çš„æ•°ï¼Œä¸”æœ‰å¤šå°‘ç‚¸å¼¹ã€‚å¦‚æœå‰è€…å‡åè€…å¯¹äºæ‰€æœ‰ $i$ è€Œè¨€å‡ $\leq 0$ ï¼Œ$ans$ å°± $-1$  ã€‚</p>
<p>äºæ˜¯å¯çŸ¥è¿™å°±å˜æˆäº†ä¸€ä¸ªåŒºé—´åŠ +å…¨å±€æœ€å¤§å€¼çš„é—®é¢˜ã€‚çº¿æ®µæ ‘ç»´æŠ¤å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">600010</span> ; </span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> n ; </span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> pos[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> s[N * <span class="number">3</span>] ; </span><br><span class="line"><span class="keyword">int</span> tg[N * <span class="number">3</span>] ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">void</span> _up(<span class="keyword">int</span> x)&#123;</span><br><span class="line">	s[x] = max(s[x &lt;&lt; <span class="number">1</span>], s[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _down(<span class="keyword">int</span> x)&#123;</span><br><span class="line">	<span class="keyword">if</span> (tg[x])&#123;</span><br><span class="line">		s[x &lt;&lt; <span class="number">1</span>] += tg[x] ; </span><br><span class="line">		s[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += tg[x] ;</span><br><span class="line">		tg[x &lt;&lt; <span class="number">1</span>] += tg[x] ;</span><br><span class="line">		tg[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += tg[x] ;</span><br><span class="line">		tg[x] = <span class="number">0</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (ul &lt;= l &amp;&amp; r &lt;= ur)</span><br><span class="line">		<span class="keyword">return</span> s[rt] += v, tg[rt] += v, <span class="keyword">void</span>() ;</span><br><span class="line">	<span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt) ;</span><br><span class="line">	<span class="keyword">if</span> (ul &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, l, mid, ul, ur, v) ;</span><br><span class="line">	<span class="keyword">if</span> (ur &gt; mid) update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ul, ur, v) ;</span><br><span class="line">	_up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n ; <span class="keyword">int</span> q ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), pos[base[i]] = i ; </span><br><span class="line">	ans = n ; update(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>, pos[ans], <span class="number">1</span>) ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">' '</span> ; <span class="built_in">cin</span> &gt;&gt; q ; </span><br><span class="line">		<span class="keyword">if</span> (i == n) <span class="keyword">return</span> <span class="number">0</span> ; update(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>, q, <span class="number">-1</span>) ; </span><br><span class="line">		<span class="keyword">for</span> ( ; s[<span class="number">1</span>] &lt;= <span class="number">0</span> ; ) update(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>, pos[-- ans], <span class="number">1</span>) ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>å¥½å¤šå¥½å¤šç»†èŠ‚</tag>
        <tag>å­—ç¬¦ä¸²/Manacher</tag>
        <tag>æ€ç»´é¢˜/æ„é€ </tag>
        <tag>æ€ç»´é¢˜/æ‰¾æ€§è´¨</tag>
        <tag>æ•°æ®ç»“æ„/çº¿æ®µæ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘[ARC103] C~F</title>
    <url>/2020/03/18/ARC103/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>åšä¹‹å‰ä¸çŸ¥é“è¿™å¥—é¢˜æ€ä¹ˆæ ·ã€‚åšåˆ°ä¸€åŠå‘ç°åé¢ä¸‰é“éƒ½æ˜¯æ„é€ é¢˜â€¦éƒ½æ˜¯æ„é€ â€¦æ„é€ æ²™æˆ‘.jpg</p>
<p>è¿™å¥½åƒå°±æ˜¯ARCæ­£å¼èµ›çš„æœ€åä¸€åœºäº†ã€‚å¯æƒœæˆ‘ä¸€åœºARCéƒ½æ²¡ç°åœºæ‰“è¿‡ã€‚</p>
<p>éš¾åº¦å¤§æ¦‚æ˜¯ $\rm B&gt;C&gt;D&gt;A$ ï¼Ÿ</p>
<a id="more"></a>
<h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªå¶æ•°é•¿åº¦çš„åºåˆ— $\{a_n\}$ï¼Œå®šä¹‰ã€Œåˆæ³•ã€è¡¨ç¤º $\forall i&lt;n-1,a_{i}=a_{i+2}$ ä¸”æ•´ä¸ªåºåˆ—å…±æœ‰ä¸¤ç§æ•°å­—ã€‚</p>
<p>å®šä¹‰æ“ä½œï¼šæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªæ•°æ›¿æ¢æ‰æŸä¸ªä½ç½®ã€‚</p>
<p>æ±‚æœ€å°‘éœ€è¦æ“ä½œå¤šå°‘æ¬¡ä½¿å¾—åºåˆ—åˆæ³•ã€‚</p>
<p>$1\leq n\leq 100000,1\leq a_i\leq 100000$ã€‚</p>
</blockquote>
<p>æ¯”è¾ƒå¸¸è§„çš„æœ€ä¼˜åŒ–é¢˜ç›®ã€‚ä¸éš¾å‘ç°å¦‚æœæŸä¸ªæ•°å‡ºç°æ¬¡æ•°å¾ˆå¤šï¼Œå°±è¦ç”¨è¿™ä¸ªå»æ›¿æ¢åˆ«çš„æ•°è€Œä¸æ˜¯è¢«æ¢æ‰ã€‚æ‰€ä»¥ä¸éš¾æƒ³åˆ°åˆ†åˆ«æ‹¿æ¡¶è®°å½•å¥‡å¶ä½ç½®çš„å‡ºç°æ¬¡æ•°ï¼Œç„¶åä¸¤ä¸ªéƒ½é€‰æœ€å¤šçš„å³å¯ã€‚</p>
<p>ç„¶è€Œæ˜¾ç„¶è¿™ä¸ªåšæ³•æ˜¯ä¸å¯¹çš„ã€‚å› ä¸ºé™åˆ¶äº†å¿…é¡»æœ‰ä¸¤ç§æ•°å­—ï¼Œæ‰€ä»¥å¥‡å¶ä½ç½®çš„å–å€¼å¿…é¡»ä¸åŒã€‚å®šä¸€æ‰¾äºŒå³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> t[N] ;</span><br><span class="line"><span class="keyword">int</span> s[N] ;</span><br><span class="line"><span class="keyword">int</span> _odd[N] ;</span><br><span class="line"><span class="keyword">int</span> _eve[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compo</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _odd[x] &gt; _odd[y] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compe</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _eve[x] &gt; _eve[y] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; res = n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; base[i] ;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>) _odd[base[i]] ++ ;</span><br><span class="line">        <span class="keyword">else</span> _eve[base[i]] ++ ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; N ; ++ i) s[i] = t[i] = i ;</span><br><span class="line">    sort(s + <span class="number">1</span>, s + N, compo) ;</span><br><span class="line">    sort(t + <span class="number">1</span>, t + N, compe) ;</span><br><span class="line">    ans = n / <span class="number">2</span> - _odd[s[<span class="number">1</span>]] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (t[i] != s[<span class="number">1</span>])&#123; ans += n / <span class="number">2</span> - _eve[t[i]] ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">    res = min(res, ans) ;</span><br><span class="line">    ans = n / <span class="number">2</span> - _eve[t[<span class="number">1</span>]] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (s[i] != t[<span class="number">1</span>])&#123; ans += n / <span class="number">2</span> - _odd[s[i]] ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">    res = min(res, ans) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote>
<p>ç»™å®š $n$ ç»„åæ ‡ã€‚æ„é€ é•¿åº¦ä¸º $m$ çš„åºåˆ— $\{c_n\}$ å’Œ $n$ ç»„åŒ…å« <code>LRUD</code> çš„è·¯å¾„ï¼Œæ»¡è¶³å¯¹äºæ¯ä¸€ç»„åæ ‡ï¼š</p>
<ul>
<li>$c_i$ è¡¨ç¤ºç¬¬ $i$ æ­¥ã€Œæ­¥é•¿ã€ã€‚</li>
<li>å¯¹äºæ¯ä¸ªåæ ‡ï¼Œä» $(0,0)$ å¼€å§‹èµ°ï¼Œå…±èµ° $m$ æ­¥ã€‚ç¬¬ $i$ æ­¥å¯ä»¥è®© $(x,y)$ å˜æˆ $(xÂ±c_i,y)$ æˆ– $(x,yÂ±c_i)$ ã€‚</li>
<li>èµ°å®Œ $m$ æ¬¡ä¹‹åï¼Œæ°å¥½èµ°åˆ°è¿™ç»„åæ ‡ã€‚</li>
<li>è¦æ±‚ $m\leq 40,c_i\leq 10^{12}$ ã€‚</li>
</ul>
<p>$1\leq n\leq 1000$</p>
</blockquote>
<p>ä¸ä¼šå•Šâ€¦æ„Ÿè§‰å¯èƒ½æ˜¯å¯¹è¿™ç§å¥—è·¯ä¸æ˜¯å¾ˆç†Ÿå•Šã€‚</p>
<p>é¦–å…ˆæ— è§£å¾ˆå®¹æ˜“åˆ¤æ–­ã€‚å› ä¸ºå¤šèµ°ä¸€æ­¥å’Œå°‘èµ°ä¸€æ­¥ä¹‹é—´çš„å·®å€¼æ€»æ˜¯ $2\times$æ­¥é•¿ ï¼Œæ‰€ä»¥å¦‚æœ $x_i+y_i$ çš„å¥‡å¶æ€§ä¸åŒçš„è¯ï¼Œå°±ä¸èƒ½åŒæ—¶æ»¡è¶³æ¡ä»¶ã€‚</p>
<p>åæ¥å°±ä¸ä¼šäº†x</p>
<p>å‘ç°è¿™ä¸ªé¢˜çš„æœ¬è´¨æ˜¯æ‹†åˆ†é—®é¢˜ã€‚é‚£ä¹ˆå¤§æ¦‚å¯ä»¥å¼•å¯¼åˆ°ã€ŒäºŒè¿›åˆ¶æ‹†åˆ†ã€è¿™ç§æ³›å¼çš„æ‹†åˆ†æ–¹å¼ä¸Šã€‚ä¸å¦¨è€ƒè™‘å¯¹äºä¸€ç»„ $\{1,2,4\cdots 2^k\}$ å¯ä»¥æ‹¼å‡ºå“ªäº›åæ ‡ã€‚é‚£ä¹ˆè€ƒè™‘å¯¹äºä¸€ç»„åæ ‡ $(x,y)$ ï¼Œä»–å¯ä»¥è¢«é€šè¾¾ï¼Œé‚£ä¹ˆå¯ä»¥çŸ¥é“å¦‚æœæƒ³è¦å‡å°æŸä¸€ç»´åæ ‡ï¼Œæ¯”å¦‚ $x\to xâ€™$ï¼Œé‚£æœ‰ä¸¤ç§æƒ…å†µï¼š</p>
<p>1ã€åªæ˜¯å•çº¯åœ°æ‹¿æ‰å‡ ä¸ªå…ƒç´ ã€‚æ¯”å¦‚ $16\to11$ å°±æ˜¯ç®€å•åœ°æ‹†å‡º $4$ å’Œ $1$ ã€‚</p>
<p>2ã€æ‹¿å‡ºå‡ ä¸ªå…ƒç´ å¹¶ä¸”æ¢è¿›å»å‡ ä¸ªå…ƒç´ ã€‚æ¯”å¦‚ $12\to11$ å°±æ˜¯æ‹†å‡º $2$ å’Œ $1$ æ”¾è¿›ä¸€ä¸ª $4$ ã€‚</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯å¯ä»¥ç›¸äº’é€šè¾¾çš„ã€‚</p>
<p>æ›´è¯¦ç»†ä¸€ç‚¹ã€‚å› ä¸ºå¯¹äºå››ä¸ªè±¡é™ï¼Œæƒ…å†µéƒ½æ˜¯ç­‰ä»·çš„ã€‚æ‰€ä»¥åªè€ƒè™‘ç¬¬ä¸€è±¡é™ã€‚å‘ç°å¯¹äº $\{1,2,4\cdots 2^k\}$ ï¼Œå®ƒå¯ä»¥ç»´æŠ¤åˆ°çš„ä½ç½®è‡³å°‘æ˜¯æ‰€æœ‰ $|x+y|=\sum _{i=0}^k 2^i=2^{k+1}-1$ã€‚ä½†æ˜¯ä¸ä»…é™äºæ­¤ã€‚å‘ç°å¦‚æœå°†å°†å…¶ä¸­æŸä¸ªå…ƒç´ çš„è´¡çŒ®å–è´Ÿï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¿é—®åˆ°æ‰€æœ‰ $|x+y| - \sum 2^p$ çš„æ ¼å­ã€‚æ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæ–¹å¼å¯ä»¥è®¿é—®åˆ°æ‰€æœ‰ä¸ $2^{k+1}-1$ å¥‡å¶æ€§ç›¸åŒçš„æ ¼å­ã€‚</p>
<p>åˆ°è¿™ä¸€æ­¥å°±å·²ç»å¾ˆå®Œç¾äº†ï¼Œä½†æ˜¯ä¾ç„¶å­˜åœ¨é—®é¢˜ã€‚å¦‚æœ $|x+y|$ éƒ½æ˜¯å¶æ•°ï¼Œè¿™å°±æŒ‚äº†ã€‚æ‰€ä»¥æ­¤æ—¶å¯ä»¥éšä¾¿å‘ $x$ è½´æˆ–è€… $y$ è½´åç§» $1$ ï¼Œæ¯”å¦‚æŠŠ $(1,0)$ å˜æ¢æˆåŸç‚¹ï¼Œå°±è§£å†³äº†ã€‚</p>
<p>å®ç°æ–¹é¢ï¼Œå‘ç°æœ€åˆæ³•åŒºåŸŸåæ˜¯ä¸ªå†…éƒ¨é•‚ç©ºçš„è±å½¢ã€‚æ‰¾å‡ºæ¥ä¹‹åï¼Œå¯¹äºä¸€ç»„åæ ‡ $(x,y)$ ï¼Œè€ƒè™‘å¯¹ç§°ç€æ‰¾ã€‚åå‘ä»å¤§åˆ°å°æšä¸¾æ¯ä¸€ä¸ªæ­¥é•¿ï¼Œå¦‚æœæ–°çš„ç‚¹çš„ $|x|+|y|$ ä¹‹å’Œä¸¥æ ¼å°äºå½“å‰çš„æ­¥é•¿ï¼Œå°±æ˜¯å¯ä»¥æ‹¼å‡ºæ¥çš„ã€‚ä¸éš¾çŸ¥é“è¿™æ ·åšæ˜¯å¯¹çš„ã€‚ </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> _eve ;</span><br><span class="line">ll nx, ny ;</span><br><span class="line"><span class="keyword">int</span> bc[N] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">rg</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l ;</span><br><span class="line">    <span class="keyword">int</span> r ;</span><br><span class="line">    <span class="keyword">int</span> t ;</span><br><span class="line">&#125;base[N] ; <span class="comment">//D  R  U  L</span></span><br><span class="line"><span class="keyword">int</span> dx[<span class="number">4</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>&#125; ;</span><br><span class="line"><span class="keyword">int</span> dy[<span class="number">4</span>] = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125; ;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">4</span>] = &#123;<span class="string">'U'</span>, <span class="string">'L'</span>, <span class="string">'D'</span>, <span class="string">'R'</span>&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    bc[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; base[i].l &gt;&gt; base[i].r ;</span><br><span class="line">        base[i].t = <span class="built_in">abs</span>(base[i].l + base[i].r) &amp; <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (base[i].t != base[<span class="number">1</span>].t) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">30</span> ; ++ i) bc[++ cnt] = <span class="number">1</span> &lt;&lt; i ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; cnt + <span class="number">1</span> + (<span class="keyword">bool</span>)(!(base[<span class="number">1</span>].t &amp; <span class="number">1</span>)) &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    <span class="keyword">if</span> (!(base[<span class="number">1</span>].t &amp; <span class="number">1</span>)) <span class="built_in">cout</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">" "</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = cnt ; ~i ; -- i) <span class="built_in">printf</span>(<span class="string">"%d%c"</span>, bc[i], <span class="string">" \n"</span>[!i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        nx = base[i].l ;</span><br><span class="line">        ny = base[i].r ;</span><br><span class="line">        <span class="keyword">if</span> (!(base[i].t &amp; <span class="number">1</span>))</span><br><span class="line">            ny -= <span class="number">1</span>, <span class="built_in">putchar</span>(<span class="string">'U'</span>) ;</span><br><span class="line">		<span class="comment">//cout &lt;&lt; nx &lt;&lt; " " &lt;&lt; ny &lt;&lt; endl ;</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = cnt ; ~j ; -- j)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; <span class="number">4</span> ; ++ k)&#123;</span><br><span class="line">                ll kx = nx + (ll)dx[k] * bc[j] ;</span><br><span class="line">                ll ky = ny + (ll)dy[k] * bc[j] ;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">abs</span>(kx) + <span class="built_in">abs</span>(ky) &lt; bc[j])&#123;</span><br><span class="line">                    nx = kx ; ny = ky ;</span><br><span class="line">					<span class="comment">//cout &lt;&lt; nx &lt;&lt; " " &lt;&lt; ny &lt;&lt; endl ;</span></span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"%c"</span>, s[k]) ; <span class="keyword">break</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„ $01$ åºåˆ— $\{s_n\}$ã€‚å°è¯•æ„é€ ä¸€æ£µå…·æœ‰å¦‚ä¸‹æ€§è´¨çš„ $n$ ä¸ªç»“ç‚¹çš„æ ‘ï¼š</p>
<p>$\forall i\in[1,n]\cap\mathbb{Z_+}$ï¼Œ$s_i$ è‹¥ä¸º $1$ ï¼Œåˆ™ä¸€å®šå­˜åœ¨å¤§å°ä¸º $i$ çš„è¿é€šå—ï¼›$s_i$ è‹¥ä¸º $0$ ï¼Œåˆ™ä¸€å®šä¸å­˜åœ¨å¤§å°ä¸º $i$ çš„è¿é€šå—ã€‚</p>
<p>$1\leq n\leq10^5$ ã€‚</p>
</blockquote>
<p>ç¥ä»™æ„é€ orzã€‚</p>
<p>é¦–å…ˆæ˜¾ç„¶çš„æ˜¯ $s_n=0$ï¼Œ$s_1=1$ ï¼Œå¦åˆ™æ— è§£ã€‚å¹¶ä¸”è¿™ä¸œè¥¿æ˜¯æœ‰å¯¹ç§°æ€§çš„ï¼Œå‰²æ‰ä¸€ä¸ªå¤§å°ä¸º $k$ çš„è¿é€šå—ä¸€å®šä¹Ÿä¼šå‰²å‡ºä¸€ä¸ªå¤§å°ä¸º $n-k$ çš„è¿é€šå—ã€‚æ‰€ä»¥å¯ä»¥å¦‚æ­¤åˆ¤æ–­æ˜¯å¦å­˜åœ¨è§£ã€‚</p>
<p>è¿™ç§æ„é€ ï¼Œå¦‚æœå¼ºè¡Œå®šä¹‰çš„è¯ï¼Œå¯èƒ½å­˜åœ¨æŸç§å¥—è·¯ã€‚æ€è€ƒè¿™ä¸€ç§æ¯”è¾ƒè‡ªç„¶çš„æ„é€ æ–¹å¼ï¼šæ‰¾åˆ°æœ€å¤§çš„è¿é€šå—ï¼Œè®©å…¶æˆä¸º $1$ çš„ä¸€æ£µå­æ ‘ï¼Œè¿™æ ·è¿­ä»£åšä¸‹å»ï¼Œæœ€åå†æ‹¿æ•£ç‚¹è¿ä¸Šå»ï¼Œçœ‹ä¸Šå»æœ‰ç‚¹åˆç†ï¼Œå› ä¸º $1$ çš„è¿é€šå—å¿…ç„¶å­˜åœ¨ã€‚ä½†ä»”ç»†æ€è€ƒå°±ä¼šå‘ç°è¿™æ ·åšä¼šä½¿å¾—å¾ˆå¤šä¸åº”è¯¥å­˜åœ¨çš„å¤§å°çš„è¿é€šå—å‡ºç°ã€‚</p>
<p>ä½†æ˜¯è‡³å°‘å‘ç°ï¼Œè¿æ•£ç‚¹æ˜¯ä¸ªæ¯”è¾ƒå¥½çš„æ–¹å¼ï¼Œè€Œä¸Šä¸€ä¸ªæ–¹æ³•æ¬ ç¼ºçš„å°±æ˜¯éš¾ä»¥å‡†ç¡®æ„é€ è¿é€šå—ã€‚è¿™å°±å¯ä»¥æŠŠæ€è·¯å¼•åˆ°ã€ŒèŠèŠ±ã€ä¸Šã€‚å‘ç°å¯¹äºä¸€ä¸ª $k$ é˜¶èŠèŠ±ï¼Œåªä¼šäº§ç”Ÿå¤§å°ä¸º $k-1$ å’Œ $1$ çš„è¿é€šå—ã€‚é‚£ä¹ˆå¯ä»¥çŸ¥é“å¤§æ¦‚å¯ä»¥å¦‚æ­¤è®¾è®¡æ€è·¯ï¼šæšä¸¾è¿é€šå—å¤§å° $p$ ï¼Œå¦‚æœ $s_p=0$ ï¼Œé‚£ä¹ˆå°±åº”è¯¥æŠŠ $p+2$ å·ç‚¹ä¹Ÿè¿åœ¨ä¹‹å‰çš„æŸä¸ªèŠèŠ±ä¸Š ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç° $size=p$ çš„è¿é€šå—ï¼›å¦åˆ™æŠŠ $p+2$ è¿å‘å•ç‹¬æ‹¿å‡ºæ¥ä½œä¸ºä¸€ä¸ªæ–°çš„æ–°çš„èŠèŠ±çš„é‡å¿ƒè¿å‘ $p+1$ ï¼Œè¿™æ ·å°±ä¼šæœ‰ $size=p$ çš„è¿é€šå—äº†ã€‚</p>
<p>å½¢å¼åŒ–åœ°è®²ï¼Œè€ƒè™‘è®¾ $1&lt;q_1&lt;q_2&lt;\cdots &lt;q_m&lt;n$ è¡¨ç¤º $\{s_n\}$ ä¸­é‚£äº›å€¼ä¸º $1$ çš„ä½ç½®ã€‚é‚£ä¹ˆæ„é€ å‡ºæ¥çš„åªéœ€è¦æ˜¯ä¸€ä¸ªé“¾å¥—èŠèŠ±ï¼Œæ¯ä¸ªèŠèŠ±å¤§å°æ˜¯ $q_k-q_{k-1}$ å³å¯ï¼ˆå·®åˆ†ï¼‰ã€‚</p>
<p>æ˜¾ç„¶è¿™ç§æ„é€ æ–¹å¼èƒ½å‡‘å‡ºæ‰€æœ‰ $s_p=1$ çš„ $p$ æ¥ã€‚æ¥ä¸‹æ¥åªéœ€è¦è€ƒè™‘è¿™æ ·åšä¸ºä»€ä¹ˆä¹Ÿå¯ä»¥ä¿è¯ $s_p=0$ çš„ä½ç½®ä¸æ„é€ å‡ºæ¥ã€‚å‘ç°å¦‚æœç æ‰çš„è¾¹æ˜¯èŠèŠ±è¾¹è€Œä¸æ˜¯é“¾è¾¹ï¼Œé‚£ä¹ˆåªä¼šæœ‰ $n-1$ å’Œ $1$ è¿™ä¸¤ç§è¿é€šå—ï¼›å¦‚æœæ˜¯é“¾è¾¹ï¼Œé‚£ä¹ˆåªä¼šæ˜¯æŸä¸ª $q_k$ å’Œ $n-q_k$ ï¼Œç”±äºä¹‹å‰å·²ç»åˆ¤è¿‡äº†å¯¹ç§°æ€§ï¼Œæ‰€ä»¥ä¸éš¾è¯æ˜è¿™æ ·åšæ˜¯å¯¹çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> m ;</span><br><span class="line"><span class="keyword">int</span> top ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">char</span> s[N] ;</span><br><span class="line"><span class="keyword">int</span> sz[N] ;</span><br><span class="line"><span class="keyword">int</span> stk[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; (s + <span class="number">1</span>) ;</span><br><span class="line">    n = <span class="built_in">strlen</span>(s + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">if</span> (s[<span class="number">1</span>] == <span class="string">'0'</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (s[n] == <span class="string">'1'</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (s[i] != s[n - i]) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    for (int i = 1 ; i &lt; n ; ++ i)</span></span><br><span class="line"><span class="comment">        if (s[i] == '1') stk[++ top] = i ;</span></span><br><span class="line"><span class="comment">    stk[++ top] = n ; int k ; cnt = 0 ;</span></span><br><span class="line"><span class="comment">    while (top) sz[++ cnt] = stk[top --] ;</span></span><br><span class="line"><span class="comment">    for (int i = 1 ; i &lt; cnt ; ++ i)</span></span><br><span class="line"><span class="comment">        printf("%d %d\n", i, i + 1), sz[i] -= sz[i + 1] ;</span></span><br><span class="line"><span class="comment">    k = cnt ;</span></span><br><span class="line"><span class="comment">    for (int i = 1 ; i &lt;= cnt ; ++ i)</span></span><br><span class="line"><span class="comment">        for (int j = 1 ; j &lt;= sz[i] ; ++ j)</span></span><br><span class="line"><span class="comment">            printf("%d %d\n", i, ++ cnt) ;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    m = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; m &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">'1'</span>) m = i + <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><blockquote>
<p>ç»™å®šä¸€æ£µæ ‘ä¸Šæ¯ä¸ªç‚¹åˆ°å…¶ä»–ç‚¹çš„è·ç¦»å’Œã€‚ä¿è¯å‡ä¸ç›¸åŒã€‚æ„é€ è¿™æ ·çš„ä¸€æ£µæ ‘ã€‚</p>
<p>$1\leq n\leq 200,000$ </p>
</blockquote>
<p>å—¯ã€‚å…¶å®æ ‘ä¸Šå¦‚æœæ˜¯è€ƒè™‘è·ç¦»çš„è¯ï¼Œä¹Ÿå°±é‚£ä¹ˆç‚¹äº‹å„¿ã€‚</p>
<p>é¦–å…ˆè¦çŸ¥é“çš„æ˜¯ï¼Œä¸€ä¸ªç»å…¸çš„ $dp$ ã€‚æ ¹æ® $f_u$ æ¨å‡º $f_v$ ï¼Œæ­¤å¤„å‡è®¾ $fa_v=u$ ã€‚é‚£ä¹ˆæœ‰ï¼š</p>
<script type="math/tex; mode=display">
f_u=f_v+size_v-(n-size_v)=f_v-n+2\cdot size_v</script><p>å¹¶ä¸”è€ƒè™‘ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æ€è·¯ã€‚å¯¹äºæ ‘è€Œè¨€ï¼Œå…¶æœ€ç‰¹æ®Šçš„èŠ‚ç‚¹å°±æ˜¯æ ¹å’Œå¶å­ã€‚</p>
<p>å‘ç° $f$ å€¼æœ€å°çš„é‚£ä¸ªæ˜¯é‡å¿ƒã€‚é‚£ä¹ˆå¦‚æœä»¤é‡å¿ƒå½“æ ¹ï¼Œé‚£ä¹ˆéšæ·±åº¦å¢å¤§ï¼Œ$f$ æ˜¯å•å¢çš„ã€‚åŒæ—¶å¯ä»¥çŸ¥é“ï¼Œå¦‚æœæ ¹æ˜¯é‡å¿ƒçš„è¯ï¼Œä¸€å®šä¸ä¼šå­˜åœ¨æŸæ£µå­æ ‘çš„ $size&gt;\lfloor \frac{n}{2}\rfloor$ ï¼Œè¿™å°±å¯ä»¥ä½œä¸ºåˆ¤æ–­æ— è§£çš„ä¾æ®ã€‚</p>
<p>äºæ˜¯å°±ä»åº•å‘ä¸Šä¸æ–­åˆ å¶å­å°±å¯ä»¥äº†ã€‚åˆæ³•éšä¾¿åˆ¤ä¸€åˆ¤å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fuck_it_up return !puts(<span class="meta-string">"-1"</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line">ll minx ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> sz[N] ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line">ll dis[N] ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">tree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id ;</span><br><span class="line">    ll val ;</span><br><span class="line">&#125;base[N] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;E[N * <span class="number">2</span>] ;</span><br><span class="line"><span class="built_in">map</span> &lt;ll, <span class="keyword">int</span>&gt; s ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(tree a, tree b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.val &gt; b.val ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v ;</span><br><span class="line">    next(cnt) = head[u] ;</span><br><span class="line">    head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))</span><br><span class="line">        dis[to(k)] = dis[x] + n - <span class="number">2</span> * sz[to(k)], dfs(to(k)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) sz[i] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i].val) ;</span><br><span class="line">        s[base[i].val] = base[i].id = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(base + <span class="number">1</span>, base + n + <span class="number">1</span>, comp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> x = base[i].id ;</span><br><span class="line">        ll y = base[i].val ;</span><br><span class="line">        <span class="keyword">int</span> delta = n - <span class="number">2</span> * sz[x] ;</span><br><span class="line">        <span class="keyword">if</span> (delta &lt;= <span class="number">0</span>) fuck_it_up ;</span><br><span class="line">        <span class="keyword">if</span> (!s.count(y - delta)) fuck_it_up ;</span><br><span class="line">        fa[x] = s[y - delta] ; minx += sz[x] ;</span><br><span class="line">        sz[fa[x]] += sz[x] ; add(fa[x], x) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">cout</span> &lt;&lt; fa[i] &lt;&lt; <span class="string">" "</span> ;</span><br><span class="line">    dis[base[n].id] = minx ; dfs(base[n].id) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (dis[base[i].id] != base[i].val) fuck_it_up ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; base[i].id &lt;&lt; <span class="string">" "</span> &lt;&lt; fa[base[i].id] &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>atcoder</category>
      </categories>
      <tags>
        <tag>æ€ç»´é¢˜/æ„é€ </tag>
        <tag>æ€ç»´é¢˜/æ‰¾æ€§è´¨</tag>
        <tag>è´ªå¿ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç½‘ç»œæµ24é¢˜ä¸“é¢˜ã€‘6 Â· æœ‰è¶£çš„è´¹ç”¨æµ</title>
    <url>/2020/03/15/%E8%B4%B9%E7%94%A8%E6%B5%81Hard/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>24é¢˜ä¸­æ¯”è¾ƒæ–°é¢–æœ‰è¶£çš„è´¹ç”¨æµé¢˜ç›®ï¼š</p>
<p>åˆ†åˆ«æ˜¯ <code>loj#6014</code> æœ€é•¿å¯é‡åŒºé—´é›†ã€<code>loj#6227</code> æœ€é•¿å¯é‡çº¿æ®µé›†é—®é¢˜ å’Œ  <code>loj#6008</code> é¤å·¾è®¡åˆ’ã€‚</p>
<p>å•Šï¼Œ24é“é¢˜é‡Œé¢ï¼Œ1é“å‡é¢˜ï¼Œè¿˜æœ‰ä¸¤é“çŠ¶å‹bfsï¼Œå› ä¸ºä¸ç½‘ç»œæµæ— ç“œå°±å¿½ç•¥äº†ã€‚</p>
<p>æ€»ä¹‹å‘¢ï¼Œæ€»ç®—æ˜¯åšå®Œäº†å•Šã€‚</p>
<a id="more"></a>
<h1 id="æœ€é•¿-k-å¯é‡åŒºé—´é›†"><a href="#æœ€é•¿-k-å¯é‡åŒºé—´é›†" class="headerlink" title="æœ€é•¿ k å¯é‡åŒºé—´é›†"></a>æœ€é•¿ k å¯é‡åŒºé—´é›†</h1><blockquote>
<p>ç»™å®šå®ç›´çº¿ $ L $ ä¸Š $ n $ ä¸ªå¼€åŒºé—´ç»„æˆçš„é›†åˆ $ I $ï¼Œå’Œä¸€ä¸ªæ­£æ•´æ•° $ k $ï¼Œè¯•è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œä»å¼€åŒºé—´é›†åˆ $ I $ ä¸­é€‰å–å‡ºå¼€åŒºé—´é›†åˆ $ S \subseteq I $ï¼Œä½¿å¾—åœ¨å®ç›´çº¿ $ L $ çš„ä»»ä½•ä¸€ç‚¹ $ x $ï¼Œ$ S $ ä¸­åŒ…å«ç‚¹ $ x $ çš„å¼€åŒºé—´ä¸ªæ•°ä¸è¶…è¿‡ $ k $ã€‚ä¸” $ \sum\limits_{z \in S} | z | $ è¾¾åˆ°æœ€å¤§ã€‚è¿™æ ·çš„é›†åˆ $ S $ ç§°ä¸ºå¼€åŒºé—´é›†åˆ $ I $ çš„æœ€é•¿ $ k $ å¯é‡åŒºé—´é›†ã€‚$ \sum\limits_{z \in S} | z | $ ç§°ä¸ºæœ€é•¿ $ k $ å¯é‡åŒºé—´é›†çš„é•¿åº¦ã€‚</p>
<p>å¯¹äºç»™å®šçš„å¼€åŒºé—´é›†åˆ $ I $ å’Œæ•´æ•° $ k $ï¼Œè®¡ç®—å¼€åŒºé—´é›†åˆ $ I $ çš„æœ€é•¿ $ k $ å¯é‡åŒºé—´é›†çš„é•¿åº¦ã€‚</p>
<p>$ 1 \leq n \leq 500, 1 \leq k \leq 3 $</p>
</blockquote>
<p>é¦–å…ˆä¸€æ‹¿å‡ºæ¥ï¼Œè¿™ä¸å°±æ˜¯åŒ¹é…é—®é¢˜å˜›ï¼Ÿä¸€ä¸ªç‚¹æœ€å¤šåŒ¹é… $k$ ä¸ªåŒºé—´ã€‚äºæ˜¯æ¯ä¸ªä½ç½®å»ºä¸€ä¸ªç‚¹ï¼Œç„¶åè¿å‘è¦†ç›–è‡ªå·±çš„ç‚¹ï¼Œç„¶åâ€¦å¥½åƒä¸å¤ªå¯¹ï¼Ÿå…¶ä¸€ä»–æ²¡ç»™ä¸‹æ ‡çš„å–å€¼èŒƒå›´ï¼Œå…¶äºŒä¸€ä¸ªçº¿æ®µè¦†ç›–å¤šä¸ªç‚¹ï¼Œè¦ä¹ˆéƒ½è¦†ç›–è¦ä¹ˆéƒ½ä¸è¦†ç›–ï¼Œè¿™ä¸ªé™åˆ¶å¾ˆéš¾è¡¨ç¤ºâ€¦</p>
<p>äºæ˜¯å¥½åƒä¸çŸ¥é“ä»ä½•å¤„å…¥æ‰‹äº†ã€‚å‘ç°ä¸€ä¸ªè¿™æ ·çš„æ€§è´¨ï¼Œå°±æ˜¯æ°¸è¿œä¸ä¼šé€‰æ‹© $k$ ä¸ªä»¥ä¸Šäº¤äº $1$ ç‚¹çš„åŒºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸¤ä¸ªåŒºé—´å½¼æ­¤ä¹‹é—´æ²¡æœ‰äº¤ï¼Œå°±å¯ä»¥åŒæ—¶é€‰ï¼›å¦åˆ™èƒ½ä¸èƒ½åŒæ—¶é€‰ï¼Œçœ‹æƒ…å†µã€‚è¿™åƒæäº†ã€Œé™åˆ¶ã€ï¼Œä¹Ÿå°±æ˜¯å¦‚æœä¸¤ä¸ªåŒºé—´ä¹‹é—´æ²¡æœ‰äº¤ï¼Œé‚£ä¸¤è€…ä¸å­˜åœ¨é™åˆ¶ï¼›å¦åˆ™å­˜åœ¨ $k$ çš„é™åˆ¶ã€‚</p>
<p>æ ¹æ®ä¸€å¼€å§‹çš„åŒ¹é…ï¼Œå¯ä»¥çŒœåˆ°å¤§è‡´ä¸Šç”¨ç½‘ç»œæµæ˜¯å¯è¡Œçš„ã€‚å¹¶ä¸”ä¼¼ä¹ç½‘ç»œæµå¾ˆé€‚åˆç”¨æµé‡æ¥è¡¨å¾é™åˆ¶ã€‚é‚£ä¹ˆè€ƒè™‘ï¼Œå¦‚æœä¸¤ä¸ªåŒºé—´ä¸å­˜åœ¨é™åˆ¶ï¼Œé‚£ä¹ˆåº”è¯¥æ€ä¹ˆåŠâ€”â€”ç½‘ç»œæµç±»ä¼¼ç”µæµï¼Œæ‰€ä»¥æ­¤æ—¶å¦‚æœä¸²è”çš„è¯ï¼Œå°±ä»£è¡¨ç€å¯ä»¥åŒæ—¶é€‰ï¼›é‚£ä¹ˆå¦‚æœå­˜åœ¨é™åˆ¶ï¼Œå°±æ„å‘³ç€ä¸èƒ½ä¸²è”ã€‚æ ¹æ®è¿™ä¸€ç‚¹ï¼Œè€ƒè™‘å¦‚ä½•ä¸²è”ã€‚å‘ç°æœ¬è´¨ä¸Šæ˜¯å°†ä¸¤ä¸ªä¸äº¤çš„åŒºé—´ä¸­é—´è¿ $f=\infty,c=0$ çš„è¾¹ã€‚</p>
<p>è¿™ä¸€ç‚¹å°±å¼•ç”³å‡ºä¸¤ä¸ªå»ºå›¾æ–¹æ³•ï¼Œå…¶æœ¬è´¨æ˜¯ç›¸åŒçš„ï¼š</p>
<p>1ã€å»ºç«‹ä¸€ä¸ªè¶…çº§æº $\rm S$ å’Œä¸€ä¸ªæº $\rm Sâ€™$ ï¼Œä¸­é—´è¿ $f=k,c=0$ çš„è¾¹ï¼Œç›®çš„æ˜¯æä¾›åˆå§‹æµé‡ã€‚$\rm Sâ€™$ å‘æ¯ä¸ªåŒºé—´çš„å·¦ç«¯ç‚¹è¿ä¸€æ¡ $f=1,c=-1$ è¾¹ã€‚ç„¶ååŒºé—´å·¦ç«¯ç‚¹å‘å³ç«¯ç‚¹è¿è¾¹ $f=1,c=-len$ è¡¨ç¤ºè´¡çŒ®ï¼Œæ¯ä¸ªå³ç«¯ç‚¹å†å‘ $\rm T $ è¿è¾¹å³å¯ã€‚å¦‚æœä¸¤ä¸ªåŒºé—´ä¸äº¤ï¼Œå°±ç”±ä¸€ä¸ªåŒºé—´çš„ $r$ è¿å‘å¦ä¸€ä¸ªåŒºé—´çš„ $l$ ï¼ˆå½“ç„¶è¦æŒ‰ç§©å•¦ï¼‰ã€‚æ€è€ƒè¿™æ ·åšçš„åˆç†æ€§ï¼Œå¯¹äºç›¸äº¤çš„åŒºé—´ï¼Œä¸€å®šæ˜¯å¹¶è”ï¼›å¦åˆ™çš„è¯å°±æ˜¯ä¸²è”ï¼ˆå…¶å®å«åšæ··è¿ï¼Œä½†æ˜¯é—®é¢˜ä¸å¤§ï¼‰ã€‚</p>
<p>2ã€å»ºç«‹ä¸€ä¸ªæº $\rm S$ è¿å‘æ•°è½´ä¸Šçš„ $0$ ä½ç½®ï¼Œ$f=k,c=0$ã€‚ç„¶åæ•°è½´ä¸Šæ¯ä¸ª $i&gt;0$ å‘ $i+1$ è¿è¾¹ $f=k,c=0$ã€‚æœ€å $maxright$ å‘ $\rm T$ è¿è¾¹ã€‚å¯¹äºä¸€ä¸ªåŒºé—´ï¼Œè¿æ³•è·Ÿ1ç›¸åŒã€‚</p>
<p>æ³¨æ„ï¼š</p>
<p>1ã€ä¸ºä»€ä¹ˆè¦æ‹†ç‚¹ï¼Ÿæ­¤å¤„æ‹†ç‚¹çš„ä½œç”¨å€¼å¾—æ³¨æ„ã€‚å¯¹äºä¸€ä¸ªåŒºé—´ï¼Œæœ¬è´¨ä¸Šåº”è¯¥æŠ½è±¡æˆä¸€ä¸ªç‚¹ã€‚ä½†æ˜¯åœ¨æµå›¾é‡Œæ˜¯ä¸å­˜åœ¨ã€Œç‚¹æƒã€è¿™ä¸ªæ¦‚å¿µçš„ã€‚æ‰€ä»¥éœ€è¦æŠŠç‚¹æƒè½¬è¾¹æƒï¼Œæ‹†ç‚¹çš„ä½œç”¨ä¾¿åœ¨äºæ­¤ã€‚</p>
<p>2ã€å…¶å®ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡åˆä¸­ç‰©ç†é‡Œé¢ä»€ä¹ˆã€Œåˆ¤æ–­ä¸¤ä¸ªç”µè·¯å›¾æ˜¯å¦ç­‰ä»·ã€çš„çŸ¥è¯†æ¥è§£å†³çš„233</p>
<p>3ã€ç”±äºæœ¬é¢˜ä¿è¯äº†ã€Œå¼€åŒºé—´ã€ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ $l\to r,len=r-l$ ã€‚å½“ç„¶å¦‚æœæ˜¯é—­åŒºé—´ï¼Œåªéœ€è¦æ”¹æˆ $l\to r+1$ å³å¯ã€‚</p>
<p>4ã€ä¸Šé¢çš„ç¬¬äºŒä¸ªæ–¹æ¡ˆï¼Œå‘ç°æœ€ç»ˆå¯èƒ½å­˜åœ¨å¾ˆå¤šæ•°è½´ä¸Šçš„ç‚¹ $i$ åªä¸ $i-1,i+1$ è¿äº† $f=k,c=0$ çš„è¾¹ï¼Œæ‰€ä»¥æ˜¯æ²¡ç”¨çš„ï¼Œç¦»æ•£åŒ–æ‰å°±å¥½äº†ã€‚ </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> I = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ft first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) e[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr(k) e[k].from</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fw(k) e[k].flow</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ct(k) e[k].cost</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) e[k].next</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pint pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> from ;</span><br><span class="line">    <span class="keyword">int</span> flow ;</span><br><span class="line">    <span class="keyword">int</span> cost ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;e[N * <span class="number">2</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> _s ;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">_t</span> ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> g[N] ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> dis[N] ;</span><br><span class="line"><span class="keyword">int</span> pre[N] ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"><span class="keyword">int</span> _last[N] ;</span><br><span class="line"><span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> f, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v ;</span><br><span class="line">    next(cnt) = head[u] ;</span><br><span class="line">    fw(cnt) = f ; ct(cnt) = c ;</span><br><span class="line">    fr(cnt) = u ; head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fill(g, g + n + <span class="number">1</span>, I) ;</span><br><span class="line">    fill(dis, dis + n + <span class="number">1</span>, I) ;</span><br><span class="line">    fill(vis, vis + n + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    q.push(_s) ; vis[_s] = <span class="number">1</span> ; dis[_s] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front() ;</span><br><span class="line">        q.pop() ; vis[x] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; ~k ; k = next(k))</span><br><span class="line">            <span class="keyword">if</span> (dis[to(k)] &gt; dis[x] + ct(k) &amp;&amp; fw(k))&#123;</span><br><span class="line">                dis[to(k)] = dis[x] + ct(k) ;</span><br><span class="line">                g[to(k)] = min(fw(k), g[x]) ;</span><br><span class="line">                pre[to(k)] = x ; _last[to(k)] = k ;</span><br><span class="line">                <span class="keyword">if</span> (!vis[to(k)])&#123;</span><br><span class="line">                    q.push(to(k)) ;</span><br><span class="line">                    vis[to(k)] = <span class="number">1</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">bool</span>)(dis[<span class="keyword">_t</span>] &lt; I) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ek</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (spfa())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = <span class="keyword">_t</span> ;</span><br><span class="line">        res += g[<span class="keyword">_t</span>] ;</span><br><span class="line">        ans += g[<span class="keyword">_t</span>] * dis[<span class="keyword">_t</span>] ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; g[_t] &lt;&lt; " " &lt;&lt; ans &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">while</span> (x != _s)&#123;</span><br><span class="line">            fw(_last[x]) -= g[<span class="keyword">_t</span>] ;</span><br><span class="line">            fw(_last[x] ^ <span class="number">1</span>) += g[<span class="keyword">_t</span>] ;</span><br><span class="line">            x = pre[x] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> len[N] ;</span><br><span class="line">pint base[N] ;</span><br><span class="line"><span class="keyword">int</span> _n, _k, tot ;</span><br><span class="line"><span class="built_in">map</span> &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; Id, buc ;</span><br><span class="line"><span class="built_in">map</span> &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; :: iterator t ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u, v, f, c ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; _n &gt;&gt; _k ; cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; base[i].ft &gt;&gt; base[i].sc ;</span><br><span class="line">        len[i] = base[i].sc - base[i].ft ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!Id.count(base[i].ft)) buc[base[i].ft] ++ ;</span><br><span class="line">        <span class="keyword">if</span> (!Id.count(base[i].sc)) buc[base[i].sc] ++ ;</span><br><span class="line">    &#125;</span><br><span class="line">    add(<span class="number">0</span>, <span class="number">1</span>, _k, <span class="number">0</span>) ; add(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (t = buc.begin() ; t != buc.end() ; ++ t)</span><br><span class="line">        Id[t-&gt;ft] = ++ tot ; _s = <span class="number">0</span> ; <span class="keyword">_t</span> = tot + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i)</span><br><span class="line">        add(i, i + <span class="number">1</span>, I, <span class="number">0</span>), add(i + <span class="number">1</span>, i, <span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)&#123;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; Id[base[i].ft] &lt;&lt; " " &lt;&lt; Id[base[i].sc] &lt;&lt; endl ;</span></span><br><span class="line">        add(Id[base[i].ft], Id[base[i].sc], <span class="number">1</span>, -len[i]) ;</span><br><span class="line">        add(Id[base[i].sc], Id[base[i].ft], <span class="number">0</span>, len[i]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    n = <span class="keyword">_t</span> + <span class="number">1</span> ; ek() ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; -ans &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æœ€é•¿-k-å¯é‡çº¿æ®µé›†é—®é¢˜"><a href="#æœ€é•¿-k-å¯é‡çº¿æ®µé›†é—®é¢˜" class="headerlink" title="æœ€é•¿ k å¯é‡çº¿æ®µé›†é—®é¢˜"></a>æœ€é•¿ k å¯é‡çº¿æ®µé›†é—®é¢˜</h1><blockquote>
<p>ç»™å®šå¹³é¢ $\text{x-o-y}$ä¸Š $n$ ä¸ªå¼€çº¿æ®µç»„æˆçš„é›†åˆ $\text{I}$ï¼Œå’Œä¸€ä¸ªæ­£æ•´æ•° $\rm k$ ä»å¼€çº¿æ®µé›†åˆ $\text{I}$ ä¸­é€‰å–å‡ºå¼€çº¿æ®µé›†åˆ $\text{S}\in \text{I}$, ä½¿å¾—åœ¨ x è½´ä¸Šçš„ä»»ä½•ä¸€ç‚¹ $\text{p}$ ï¼Œ $\text{S}$ ä¸­ä¸ç›´çº¿ $\text{x}=\text{p}$ ç›¸äº¤çš„å¼€çº¿æ®µä¸ªæ•°ä¸è¶…è¿‡ $\text{k}$ ï¼Œä¸” $\sum_{\text{z} \in \text{S}}|z|$ è¾¾åˆ°æœ€å¤§ã€‚è¿™æ ·çš„é›†åˆ $\text{S}$ ç§°ä¸ºå¼€çº¿æ®µé›†åˆ $\text{I}$ çš„æœ€é•¿ $\text{k}$ å¯é‡çº¿æ®µé›†çš„é•¿åº¦ã€‚</p>
<p>å¯¹äºä»»ä½•å¼€çº¿æ®µ $\text{z}$ï¼Œè®¾å…¶ç«¯ç‚¹åæ ‡ä¸º $( x_0 , y_0 )$ å’Œ $( x_1 , y_1 )$ï¼Œåˆ™å¼€çº¿æ®µ $\text{z}$ çš„é•¿åº¦ $|\text{z}|$ å®šä¹‰ä¸ºï¼š $|z| = \lfloor \sqrt{ ( x_1 - x_0 ) ^ 2 + ( y_1 - y_0 )^2 } \rfloor$ã€‚å¯¹äºç»™å®šçš„å¼€çº¿æ®µé›†åˆ $\text{I}$ å’Œæ­£æ•´æ•° $\text{k}$ ï¼Œè®¡ç®—å¼€çº¿æ®µé›†åˆ $\text{I}$ çš„æœ€é•¿ $\text{k}$ å¯é‡çº¿æ®µé›†çš„é•¿åº¦ã€‚</p>
<p>$1\leq n\leq500,$ $1 \leq k \leq 13$.</p>
</blockquote>
<p>å‘ç°å’Œã€ŒåŒºé—´é›†ã€é‚£é¢˜æ²¡å•¥åŒºåˆ«ï¼Œåªç”¨å…³å¿ƒ $x$ è½´ï¼Œæ¢ä¸€ä¸‹é•¿åº¦çš„æ±‚æ³•â€¦å¥½åƒæœ‰ç‚¹ä¸å¯¹ï¼Ÿå› ä¸ºå¦‚æœå­˜åœ¨ä¸¤æ¡çº¿æ®µå‡å‚ç›´äº $x$ è½´ï¼Œä¸”ä¸¤æ¡çº¿çš„å·¦å³ç«¯ç‚¹åˆ†åˆ«éƒ½æ˜¯ $x_i$ ï¼Œè¿™æ ·çš„è¯ï¼Œå»ºå‡ºå›¾æ¥è¿™ä¿©çº¿æ®µæ˜¯ä¸²åœ¨ä¸€èµ·ä¸äº¤çš„ï¼Œä½†æ˜¯æœ¬è´¨ä¸Šåº”è¯¥äº¤ã€‚</p>
<p>äºæ˜¯è‡ªç„¶æƒ³åˆ°ï¼Œè¦æ¢ç§è¡¨ç¤ºæ–¹æ³•åœ¨ $x$ è½´ä¸Šè¡¨ç¤ºä¸€ä¸ªçº¿æ®µã€‚é‚£ä¹ˆå¦‚æœæ˜¯åœ¨æ•°è½´ä¸Šï¼Œæ¯”è¾ƒç®€å•çš„æ–¹å¼å°±æ˜¯æ‰©åŸŸã€‚æ¯ä¸ªçº¿æ®µ $i$ çš„å·¦å³ç«¯ç‚¹ $(l_i,r_i)$ å˜æ¢æˆ $(2\times l_i,2\times r_i)$â€”â€”å¬ä¸Šå»å¾ˆä¸é”™ï¼Œè¿™æ ·çš„è¯å°±ç›¸å½“äºæ¯ä¸ªä¸‹æ ‡å¤šäº†ä¸€ä¸ªç©ºé—´ã€‚é‚£ä¹ˆå¯¹äºä¸€ä¸ªå·¦å³ç«¯ç‚¹ç›¸åŒçš„åŒºé—´ $(x,x)$ ï¼Œå°±å¯ä»¥è¿è¾¹æˆ $(2\cdot x,2\cdot x + 1)$ã€‚è¿™æ ·çš„è¯ï¼ŒåŸæœ¬å·¦å³ç«¯ç‚¹ä¸ç”¨çš„åŒºé—´ä¹Ÿè¦æ”¹â€”â€”ç”±äºé‚£äº›ç›¸åŒçš„åŒºé—´å³ç«¯ç‚¹åŠ äº† $1$ï¼Œæ‰€ä»¥å¦‚æœå­˜åœ¨è¿™æ ·ä¸¤ä¸ªçº¿æ®µ $(p,p)$ ã€ $(p,q)$ ï¼Œé‚£ä¹ˆåŸæœ¬ä¸äº¤çš„ä¸¤ä¸ªåŒºé—´ï¼Œåœ¨æ‰©åŸŸä¹‹åå˜æˆäº†ç›¸äº¤çš„ $(2p,2p+1)$ã€$(2p,2q)$ ã€‚</p>
<p>å¤„ç†æ–¹å¼å¾ˆç®€å•ï¼Œå¯¹äºä¸€ä¸ª $p\not=q$ çš„åŒºé—´ $(p,q)$ï¼Œè¿è¾¹ $(2p+1,2q)$ å³å¯ã€‚æ€è€ƒè¿™ä¹ˆåšä¸ºå•¥æ˜¯å¯¹çš„ã€‚å¯¹äºåŸæœ¬å­˜åœ¨çš„ä¸¤ä¸ªå‡ä¸å‚ç›´ $x$ è½´çš„çº¿æ®µï¼Œä»–ä»¬å¦‚æœç›¸äº¤ï¼Œé‚£ä¹ˆäº¤çš„é‚£ä¸€ç«¯ï¼Œ$r_1-l_2\geq 1$ ï¼›å¦‚æœä¸äº¤ï¼Œé‚£ä¹ˆæœ‰ $l_2-r_1\geq 1$ ã€‚æ‰©åŸŸä¹‹åå°±å˜æˆäº† $\geq 2$ ã€‚æ‰€ä»¥å¦‚æœåªæ˜¯å·¦ç«¯ç‚¹å¢åŠ  $1$ ï¼Œæ ¹æœ¬ä¸å½±å“åˆ¤å®šã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> len[N] ;</span><br><span class="line">pint base[N] ;</span><br><span class="line"><span class="keyword">int</span> _n, _k, tot ;</span><br><span class="line"><span class="built_in">map</span> &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; Id, buc ;</span><br><span class="line"><span class="built_in">map</span> &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; :: iterator t ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>)<span class="built_in">sqrt</span>((ll)(a - c) * (a - c) + (ll)(b - d) * (b - d)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a, b, c, d ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; _n &gt;&gt; _k ; cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d ;</span><br><span class="line">        len[i] = calc(a, b, c, d) ;</span><br><span class="line">        base[i].ft = a &lt;&lt; <span class="number">1</span> ;</span><br><span class="line">        base[i].sc = c &lt;&lt; <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">if</span> (a == c)</span><br><span class="line">            ++ base[i].sc ;</span><br><span class="line">        <span class="keyword">else</span> ++ base[i].ft ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!Id.count(base[i].ft)) buc[base[i].ft] ++ ;</span><br><span class="line">        <span class="keyword">if</span> (!Id.count(base[i].sc)) buc[base[i].sc] ++ ;</span><br><span class="line">    &#125;</span><br><span class="line">    add(<span class="number">0</span>, <span class="number">1</span>, _k, <span class="number">0</span>) ; add(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (t = buc.begin() ; t != buc.end() ; ++ t)</span><br><span class="line">        Id[t -&gt; ft] = ++ tot ; _s = <span class="number">0</span> ; <span class="keyword">_t</span> = tot + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i)</span><br><span class="line">        add(i, i + <span class="number">1</span>, I, <span class="number">0</span>), add(i + <span class="number">1</span>, i, <span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)&#123;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; Id[base[i].ft] &lt;&lt; " " &lt;&lt; Id[base[i].sc] &lt;&lt; endl ;</span></span><br><span class="line">        add(Id[base[i].ft], Id[base[i].sc], <span class="number">1</span>, -len[i]) ;</span><br><span class="line">        add(Id[base[i].sc], Id[base[i].ft], <span class="number">0</span>, len[i]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    n = <span class="keyword">_t</span> + <span class="number">1</span> ; ek() ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; -ans &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="é¤å·¾è®¡åˆ’"><a href="#é¤å·¾è®¡åˆ’" class="headerlink" title="é¤å·¾è®¡åˆ’"></a>é¤å·¾è®¡åˆ’</h1><blockquote>
<p>ä¸€ä¸ªé¤å…åœ¨ç›¸ç»§çš„ $ n $ å¤©é‡Œï¼Œæ¯å¤©éœ€ç”¨çš„é¤å·¾æ•°ä¸å°½ç›¸åŒã€‚å‡è®¾ç¬¬ $ i $ å¤©éœ€è¦ $ r_i $ å—é¤å·¾ã€‚é¤å…å¯ä»¥è´­ä¹°æ–°çš„é¤å·¾ï¼Œæ¯å—é¤å·¾çš„è´¹ç”¨ä¸º $ P $ åˆ†ï¼›æˆ–è€…æŠŠæ—§é¤å·¾é€åˆ°å¿«æ´—éƒ¨ï¼Œæ´—ä¸€å—éœ€ $ M $ å¤©ï¼Œå…¶è´¹ç”¨ä¸º $ F $ åˆ†ï¼›æˆ–è€…é€åˆ°æ…¢æ´—éƒ¨ï¼Œæ´—ä¸€å—éœ€ $ N $ å¤©ï¼Œå…¶è´¹ç”¨ä¸º $ S $ åˆ†ï¼ˆ$ S &lt; F $ï¼‰ã€‚</p>
<p>æ¯å¤©ç»“æŸæ—¶ï¼Œé¤å…å¿…é¡»å†³å®šå°†å¤šå°‘å—è„çš„é¤å·¾é€åˆ°å¿«æ´—éƒ¨ï¼Œå¤šå°‘å—é¤å·¾é€åˆ°æ…¢æ´—éƒ¨ï¼Œä»¥åŠå¤šå°‘å—ä¿å­˜èµ·æ¥å»¶æœŸé€æ´—ã€‚ä½†æ˜¯æ¯å¤©æ´—å¥½çš„é¤å·¾å’Œè´­ä¹°çš„æ–°é¤å·¾æ•°ä¹‹å’Œï¼Œè¦æ»¡è¶³å½“å¤©çš„éœ€æ±‚é‡ã€‚</p>
<p>è¯•è®¾è®¡ä¸€ä¸ªç®—æ³•ä¸ºé¤å…åˆç†åœ°å®‰æ’å¥½ $ n $ å¤©ä¸­é¤å·¾ä½¿ç”¨è®¡åˆ’,ä½¿æ€»çš„èŠ±è´¹æœ€å°ã€‚</p>
<p>$ 1 \leq n \leq 1000 $</p>
</blockquote>
<p>ä¸€é“æœ‰è¶£çš„é¢˜ã€‚</p>
<p>å—¯ï¼Œæœ¬æ¥æƒ³æ•´ç†ä¸€ä¸‹è‡ªå·±é”™çš„é‚£å‡ ç‰ˆæ˜¯æ€ä¹ˆé”™çš„ï¼Œç„¶åå‘ç°æˆ‘å¿˜äº†â€¦</p>
<p>ç„¶åæœ€è¿‘é”™çš„ä¸€ç‰ˆæˆ‘æ˜¯è¿™ä¹ˆå»ºçš„è¾¹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ; </span><br><span class="line">	<span class="keyword">int</span> p, m, f, n, s ; </span><br><span class="line">	S = <span class="number">0</span>, T = N &lt;&lt; <span class="number">1</span> | <span class="number">1</span> ; </span><br><span class="line">	<span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; </span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d%d"</span>, &amp;p, &amp;m, &amp;f, &amp;n, &amp;s) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		Add(S, i, Inf, <span class="number">0</span>), Add(i + N, T, base[i], <span class="number">0</span>) ; </span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt; N ; ++ i) Add(i, i + <span class="number">1</span>, Inf, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		Add(i, i + N, base[i], p) ;</span><br><span class="line">		<span class="comment">//Add(S, i + N, base[i], p) ;</span></span><br><span class="line">		<span class="keyword">if</span> (i + m &lt;= N) Add(i, i + m + N, base[i], f) ; </span><br><span class="line">		<span class="keyword">if</span> (i + n &lt;= N) Add(i, i + n + N, base[i], s) ;</span><br><span class="line">	&#125;</span><br><span class="line">	MCMF() ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/Users/pengkunshuo/Desktop/pks/blogggg/source/_posts/233.png" alt></p>
<p>é‚£ä¹ˆå®è´¨ä¸Šè¿™ä¸ªé¢˜åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿzayé¸½é¸½æ•™è‚²æˆ‘ï¼š</p>
<p><img src="/Users/pengkunshuo/Desktop/pks/blogggg/source/_posts/233.jpg" alt></p>
<p>å¤§æ¦‚å°±æ˜¯ $\rm S$ åˆ°æ™šä¸Šçš„è¾¹å®é™…ä¸Šæ˜¯å½“å¤©é¤å·¾ç”¨å®Œä¹‹åè¦æä¾› $r_i$ å—è„çš„é¤å·¾â€”â€”è¿™ä¸ªæ€è·¯ï¼Œæ˜¯é€†å¸¸è¯†çš„ï¼Œå•çº¯æ˜¯ä¸ºäº†è®©æ¯ä¸ªç‚¹åˆ° $T$ çš„è¾¹æ»¡æµæ‰è¿™ä¹ˆåšã€‚</p>
<p>äºæ˜¯æœ€åå°±æ˜¯</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ; </span><br><span class="line">	<span class="keyword">int</span> p, m, f, n, s ; </span><br><span class="line">	S = <span class="number">0</span>, T = N &lt;&lt; <span class="number">1</span> | <span class="number">1</span> ; </span><br><span class="line">	<span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; </span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d%d"</span>, &amp;p, &amp;m, &amp;f, &amp;n, &amp;s) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		Add(S, i + N, base[i], <span class="number">0</span>), Add(i, T, base[i], <span class="number">0</span>) ; </span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt; N ; ++ i) Add(i, i + <span class="number">1</span>, Inf, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt; N ; ++ i) Add(i + N, i + N + <span class="number">1</span>, Inf, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		<span class="comment">//Add(i, i + N, base[i], p) ;</span></span><br><span class="line">		Add(S, i, base[i], p) ;</span><br><span class="line">		<span class="keyword">if</span> (i + m &lt;= N) Add(i + N, i + m, Inf, f) ; </span><br><span class="line">		<span class="keyword">if</span> (i + n &lt;= N) Add(i + N, i + n, Inf, s) ;</span><br><span class="line">	&#125;</span><br><span class="line">	MCMF() ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å”‰ï¼Œé’æ˜¥ä¸å†ï¼Œçºªå¿µä¸€ä¸‹å¥½ä¹…ä¹‹å‰å†™è¿‡çš„ä»£ç ï¼Œä¹Ÿä¸ºè¿™ç¯‡æ–‡ç« ç”»ä¸Šä¸ªå¥å·å§ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 1005000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Inf 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next, f, c ;</span><br><span class="line">&#125;E[MAXN] ;<span class="keyword">int</span> head[MAXN], cnt = <span class="number">-1</span>, x ;</span><br><span class="line"><span class="keyword">int</span> Ans, S, T, N, base[MAXN], i, j, k, dist[MAXN], F[MAXN] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">state</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> dist, num ;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> state &amp; now) <span class="keyword">const</span>&#123; <span class="keyword">return</span> dist &gt; now.dist ; &#125;</span><br><span class="line">&#125; ; priority_queue &lt;state&gt; q ; <span class="keyword">bool</span> vis[MAXN] ; <span class="keyword">int</span> H[MAXN], Pre[MAXN], Last[MAXN] ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">dijks</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= T ; ++ i) </span><br><span class="line">        dist[i] = F[i] = Inf, vis[i] = <span class="number">0</span> ;</span><br><span class="line">    dist[S] = <span class="number">0</span> ; q.push((state)&#123;dist[S], S&#125;) ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        state now = q.top() ; q.pop() ; </span><br><span class="line">        <span class="keyword">int</span> num = now.num, dis = now.dist ;</span><br><span class="line">        <span class="keyword">if</span> (vis[num]) <span class="keyword">continue</span> ; vis[num] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (k = head[num] ; k != <span class="number">-1</span> ; k = E[k].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> qwq = dis + H[num] - H[to(k)] + E[k].c ;</span><br><span class="line">            <span class="keyword">if</span> (qwq &lt; dist[to(k)] &amp;&amp; !vis[to(k)] &amp;&amp; E[k].f)&#123;</span><br><span class="line">                dist[to(k)] = qwq, F[to(k)] = min(F[num], E[k].f), </span><br><span class="line">                q.push((state)&#123;dist[to(k)], to(k)&#125;), Pre[to(k)] = num, Last[to(k)] = k ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> 	&#125;</span><br><span class="line"> 	<span class="keyword">return</span> dist[T] &lt; Inf ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> f, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    E[++ cnt].to = v, E[cnt].c = c ;</span><br><span class="line">    E[cnt].f = f, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">    E[++ cnt].to = u, E[cnt].c = -c ;</span><br><span class="line">    E[cnt].f = <span class="number">0</span>, E[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">MCMF</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Ans = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (dijks())&#123;</span><br><span class="line">        <span class="keyword">int</span> Ed = T ; Ans += (dist[T] - H[S] + H[T]) * F[T] ;</span><br><span class="line">        <span class="keyword">while</span> (Ed) E[Last[Ed]].f -= F[T], E[Last[Ed] ^ <span class="number">1</span>].f += F[T], Ed = Pre[Ed] ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= T ; ++ i) H[i] = dist[i] ; <span class="comment">/*cout &lt;&lt; dist[T] &lt;&lt; endl ; */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> p, m, f, n, s ; <span class="built_in">cin</span> &gt;&gt; N ; <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ; S = <span class="number">0</span>, T = N &lt;&lt; <span class="number">1</span> | <span class="number">1</span> ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d%d"</span>, &amp;p, &amp;m, &amp;f, &amp;n, &amp;s), i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; </span><br><span class="line"><span class="comment">//	for (scanf("%d%d%d%d%d", &amp;p, &amp;m, &amp;f, &amp;n, &amp;s), i = 1 ; i &lt;= N ; ++ i) Add(S, i, base[i], 0), Add(i + N, T, base[i], 0) ; </span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) Add(S, i, base[i], <span class="number">0</span>),  Add(i + N, T, base[i], <span class="number">0</span>) ; <span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt; N ; ++ i) Add(i, i + <span class="number">1</span>, Inf, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) &#123;Add(S, i + N, Inf, p), Add(i, i + N, Inf, p) ; <span class="keyword">if</span> (i + m &lt;= N) Add(i, i + m + N, Inf, f) ; <span class="keyword">if</span> (i + n &lt;= N) Add(i, i + n + N, Inf, s) ;&#125;</span><br><span class="line">	<span class="comment">/*for (i = 1 ; i &lt; N ; ++ i) Add(i, i + 1, Inf, 0) ; //1</span></span><br><span class="line"><span class="comment">	for (i = 1 ; i &lt;= N ; ++ i) &#123;Add(S, i + N, Inf, p), Add(i, i + N, base[i], p) ; if (i + m &lt;= N) Add(i, i + m + N, Inf, f) ; if (i + n &lt;= N) Add(i, i + n + N, Inf, s) ;&#125;</span></span><br><span class="line"><span class="comment">	*/</span>MCMF() ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>ç½‘ç»œæµ24é¢˜</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œæµ24é¢˜</tag>
        <tag>ç½‘ç»œæµ/è´¹ç”¨æµ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç½‘ç»œæµ24é¢˜ä¸“é¢˜ã€‘5 Â· è´¹ç”¨æµè¿›é˜¶</title>
    <url>/2020/03/15/%E8%B4%B9%E7%94%A8%E6%B5%81%E8%BF%9B%E9%98%B6/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¼¼ä¹æ˜¯æ¯”è¾ƒè¿›é˜¶çš„è´¹ç”¨æµé—®é¢˜ã€‚</p>
<p>åˆ†åˆ«æ˜¯ <code>loj#6013</code> è´Ÿè½½å¹³è¡¡ã€<code>loj#6122</code> èˆªç©ºè·¯çº¿ ã€ <code>loj#6010</code> æ•°å­—æ¢¯å½¢ å’Œ <code>loj#6223</code> æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜ã€‚</p>
<a id="more"></a>
<h1 id="è´Ÿè½½å¹³è¡¡"><a href="#è´Ÿè½½å¹³è¡¡" class="headerlink" title="è´Ÿè½½å¹³è¡¡"></a>è´Ÿè½½å¹³è¡¡</h1><blockquote>
<p>G å…¬å¸æœ‰ $ n $ ä¸ªæ²¿é“è·¯è¿è¾“çº¿ç¯å½¢æ’åˆ—çš„ä»“åº“ï¼Œæ¯ä¸ªä»“åº“å­˜å‚¨çš„è´§ç‰©æ•°é‡ä¸ç­‰ã€‚å¦‚ä½•ç”¨æœ€å°‘æ¬è¿é‡å¯ä»¥ä½¿ $ n $ ä¸ªä»“åº“çš„åº“å­˜æ•°é‡ç›¸åŒã€‚æ¬è¿è´§ç‰©æ—¶ï¼Œåªèƒ½åœ¨ç›¸é‚»çš„ä»“åº“ä¹‹é—´æ¬è¿ã€‚</p>
<p>$n\leq 100$ã€‚</p>
</blockquote>
<p>ä¸€é“ä¸ªäººæ„Ÿè§‰æœ‰ç‚¹ä¸œè¥¿çš„å»ºå›¾é¢˜ã€‚é¦–å…ˆä¸éš¾å‘ç°è¿™æ˜¯ä¸ªå‡åˆ†çº¸ç‰Œé—®é¢˜ã€‚è¿™ä¸ªè´ªå¿ƒè¯´å®è¯æˆ‘ç†è§£çš„è¿˜ä¸å¤Ÿæ·±å…¥ã€‚äºæ˜¯è€ƒè™‘æ€ä¹ˆå»ºå›¾ã€‚</p>
<p>é¦–å…ˆä¸éš¾æƒ³åˆ°ï¼Œç”±äºæ¯ä¸ªç‚¹æœ€åéƒ½è¦å›åˆ°å¹³å‡å€¼ï¼Œå³ä¸€éƒ¨åˆ†ç‚¹éœ€è¦å°†å€¼ç»™å‡ºå»ï¼Œä¸€éƒ¨åˆ†éœ€è¦æ¥å—ï¼Œé‚£ä¹ˆå°±åº”è¯¥æ˜¯ä¸€ä¸ªç±»äºŒåˆ†å›¾çš„æ ·å­ã€‚ä½†é—®é¢˜åœ¨äºï¼Œæ€ä¹ˆæ·»åŠ æµé‡å’Œ(å¯èƒ½æœ‰çš„)è´¹ç”¨å‘¢ï¼Ÿä¸€å¼€å§‹æƒ³çš„æ˜¯ä¸¤ä¸ªç‚¹ä¹‹é—´å·®å€¼ä¸º $k$ çš„è¯å°±è¿ $f=k,c=1$ çš„è¾¹ï¼Œç„¶åè¶…çº§æºå’Œè¶…çº§æ±‡éƒ½è¿ $+\infty,0$ çš„è¾¹ã€‚ä½†æ˜¯è¿™æ ·æ ¹æœ¬æ— æ³•é™åˆ¶æ¯ä¸ªç‚¹çš„æµé‡ã€‚</p>
<p>ç°åœ¨è€ƒè™‘æ€è·¯åŒ–åœ°å»æ€è€ƒè¿™é“é¢˜ã€‚</p>
<p>é¦–å…ˆè€ƒè™‘æµé‡ä¹‹äºè¿™ä¸€é¢˜æ˜¯ä»€ä¹ˆå­˜åœ¨â€”â€”æµé‡å³é™åˆ¶ï¼Œé‚£ä¹ˆæ­¤é¢˜çš„é™åˆ¶å°±åœ¨äºæ¯ä¸ªç‚¹æœ€å¤šåªè¦å¢/å‡ $|\overline{a}-a_i|$ çš„å€¼ï¼›è´¹ç”¨å°±æ˜¾ç„¶æ˜¯ $1$ äº†ã€‚</p>
<p>é‚£ä¹ˆè€ƒè™‘æ€ä¹ˆè¿è¾¹ã€‚æ³¨æ„åˆ°ç‚¹ä¹‹é—´æ€ä¹ˆæµï¼Œæ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œä¹Ÿå°±æ˜¯è¯´é™åˆ¶æµå›¾çš„ä¸­éƒ¨æ˜¯é”™çš„ã€‚äºæ˜¯è€ƒè™‘é™åˆ¶æµå›¾çš„å‰éƒ¨å’Œåéƒ¨ï¼Œå‘ç°åªéœ€è¦è®© $\rm S$ è¿å‘æ¯ä¸ª $a_i&gt;\overline{a}$ çš„ç‚¹ $i$ ï¼Œå®¹é‡ä¸º $a_i-\overline{a}$ ï¼›è®©æ¯ä¸ª $a_j\leq \overline{a}$ çš„ç‚¹ $j$ è¿å‘ $\rm T$ ï¼Œå®¹é‡ä¸º $\overline{a}-a_j$ ã€‚ä¸­éƒ¨çš„è¿æ³•éœ€è¦è€ƒè™‘å®é™…æ„ä¹‰ï¼Œç”±äºåªè¦æ˜¯ç›¸é‚»å°±å¯ä¼ é€’ï¼Œæ‰€ä»¥ç›´æ¥å‘æ¯ä¸ªä¸è‡ªå·±ç›¸é‚»çš„ç‚¹è¿è¾¹å³å¯ã€‚</p>
<p>å—¯ï¼Œå°¤å…¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯ä¸ªç‚¹éƒ½éœ€è¦æœ‰ä¸€ä¸ªæ›¿èº«(ä¹Ÿå°±æ˜¯éœ€è¦æ‹†ç‚¹)ã€‚æ­¤å¤„æ‹†ç‚¹çš„ç›®çš„ä¸å†æ˜¯é™åˆ¶äº†(å› ä¸ºè‡ªèº«å’Œè‡ªèº«ä¹‹é—´ä¸è¿è¾¹)ï¼Œè€Œæ˜¯é¢˜ç›®æ„ä¹‰(æ¯ä¸ªç‚¹å¯ä»¥ä½œä¸ºä¸­ä»‹æ¥å—æ¯”è‡ªå·±å°çš„ç‚¹çš„è½¬è¿)ã€‚</p>
<p>ç„¶åè¿™é‡Œæ”¾ä¸€ä¸‹æ–°ç‰ˆçš„ MCMF çš„æ¿å­å§ã€‚ä¸Šé¢çš„éƒ½æ˜¯å¥½ä¹…ä¹‹å‰å†™çš„äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> I = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) e[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr(k) e[k].from</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fw(k) e[k].flow</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ct(k) e[k].cost</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) e[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> from ;</span><br><span class="line">    <span class="keyword">int</span> flow ;</span><br><span class="line">    <span class="keyword">int</span> cost ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;e[N * <span class="number">2</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> _s ;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">_t</span> ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> g[N] ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> dis[N] ;</span><br><span class="line"><span class="keyword">int</span> pre[N] ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"><span class="keyword">int</span> _last[N] ;</span><br><span class="line"><span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> f, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v ;</span><br><span class="line">    next(cnt) = head[u] ;</span><br><span class="line">    fw(cnt) = f ; ct(cnt) = c ;</span><br><span class="line">    fr(cnt) = u ; head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fill(g, g + n + <span class="number">1</span>, I) ;</span><br><span class="line">    fill(dis, dis + n + <span class="number">1</span>, I) ;</span><br><span class="line">    fill(vis, vis + n + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    q.push(_s) ; vis[_s] = <span class="number">1</span> ; dis[_s] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front() ;</span><br><span class="line">        q.pop() ; vis[x] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; ~k ; k = next(k))</span><br><span class="line">            <span class="keyword">if</span> (dis[to(k)] &gt; dis[x] + ct(k) &amp;&amp; fw(k))&#123;</span><br><span class="line">                dis[to(k)] = dis[x] + ct(k) ;</span><br><span class="line">                g[to(k)] = min(fw(k), g[x]) ;</span><br><span class="line">                pre[to(k)] = x ; _last[to(k)] = k ;</span><br><span class="line">                <span class="keyword">if</span> (!vis[to(k)])&#123;</span><br><span class="line">                    q.push(to(k)) ;</span><br><span class="line">                    vis[to(k)] = <span class="number">1</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">bool</span>)(dis[<span class="keyword">_t</span>] &lt; I) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ek</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (spfa())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = <span class="keyword">_t</span> ;</span><br><span class="line">        res += g[<span class="keyword">_t</span>] ;</span><br><span class="line">        ans += g[<span class="keyword">_t</span>] * dis[<span class="keyword">_t</span>] ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; g[_t] &lt;&lt; " " &lt;&lt; ans &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">while</span> (x != _s)&#123;</span><br><span class="line">            fw(_last[x]) -= g[<span class="keyword">_t</span>] ;</span><br><span class="line">            fw(_last[x] ^ <span class="number">1</span>) += g[<span class="keyword">_t</span>] ;</span><br><span class="line">            x = pre[x] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> _n ;</span><br><span class="line"><span class="keyword">int</span> sum ;</span><br><span class="line"><span class="keyword">int</span> bbar ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u, v, f, c ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; _n ; cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; base[i], sum += base[i] ;</span><br><span class="line">    bbar = sum / _n ;</span><br><span class="line">    _s = <span class="number">0</span>, <span class="keyword">_t</span> = <span class="number">2</span> * _n + <span class="number">1</span> ;</span><br><span class="line">    add(<span class="number">1</span>, _n, I, <span class="number">1</span>) ;</span><br><span class="line">    add(_n, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>) ;</span><br><span class="line">    add(<span class="number">1</span>, <span class="number">2</span> * _n, I, <span class="number">1</span>) ;</span><br><span class="line">    add(<span class="number">2</span> * _n, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>) ;</span><br><span class="line">    add(_n, <span class="number">1</span>, I, <span class="number">1</span>) ;</span><br><span class="line">    add(<span class="number">1</span>, _n, <span class="number">0</span>, <span class="number">-1</span>) ;</span><br><span class="line">    add(_n, <span class="number">1</span> + _n, I, <span class="number">1</span>) ;</span><br><span class="line">    add(<span class="number">1</span> + _n, _n, <span class="number">0</span>, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            add(i, i - <span class="number">1</span>, I, <span class="number">1</span>) ;</span><br><span class="line">            add(i - <span class="number">1</span>, i, <span class="number">0</span>, <span class="number">-1</span>) ;</span><br><span class="line">            add(i, i + _n - <span class="number">1</span>, I, <span class="number">1</span>) ;</span><br><span class="line">            add(i + _n - <span class="number">1</span>, i, <span class="number">0</span>, <span class="number">-1</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; _n)&#123;</span><br><span class="line">            add(i, i + <span class="number">1</span>, I, <span class="number">1</span>) ;</span><br><span class="line">            add(i + <span class="number">1</span>, i, <span class="number">0</span>, <span class="number">-1</span>) ;</span><br><span class="line">            add(i, i + _n + <span class="number">1</span>, I, <span class="number">1</span>) ;</span><br><span class="line">            add(i + _n + <span class="number">1</span>, i, <span class="number">0</span>, <span class="number">-1</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (base[i] &gt; bbar)&#123;</span><br><span class="line">            add(i, _s, <span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line">            add(_s, i, base[i] - bbar, <span class="number">0</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            add(<span class="keyword">_t</span>, i + _n, <span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line">            add(i + _n, <span class="keyword">_t</span>, - base[i] + bbar, <span class="number">0</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; cnt &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    for (int k = 0 ; k &lt;= cnt ; ++ k)</span></span><br><span class="line"><span class="comment">        cout &lt;&lt; fr(k) &lt;&lt; " " &lt;&lt; to(k) &lt;&lt; " " &lt;&lt; fw(k) &lt;&lt; " " &lt;&lt; ct(k) &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    n = <span class="keyword">_t</span> + <span class="number">1</span> ; ek() ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="èˆªç©ºè·¯çº¿é—®é¢˜"><a href="#èˆªç©ºè·¯çº¿é—®é¢˜" class="headerlink" title="èˆªç©ºè·¯çº¿é—®é¢˜"></a>èˆªç©ºè·¯çº¿é—®é¢˜</h1><blockquote>
<p>ç»™å®šä¸€å¼ èˆªç©ºå›¾ï¼Œå›¾ä¸­é¡¶ç‚¹ä»£è¡¨åŸå¸‚ï¼Œè¾¹ä»£è¡¨ä¸¤ä¸ªåŸå¸‚é—´çš„ç›´é€šèˆªçº¿ã€‚ç°è¦æ±‚æ‰¾å‡ºä¸€æ¡æ»¡è¶³ä¸‹è¿°é™åˆ¶æ¡ä»¶çš„ä¸”é€”ç»åŸå¸‚æœ€å¤šçš„æ—…è¡Œè·¯çº¿ã€‚  </p>
<ol>
<li>ä»æœ€è¥¿ç«¯åŸå¸‚å‡ºå‘ï¼Œå•å‘ä»è¥¿å‘ä¸œé€”ç»è‹¥å¹²åŸå¸‚åˆ°è¾¾æœ€ä¸œç«¯åŸå¸‚ï¼Œç„¶åå†å•å‘ä»ä¸œå‘è¥¿é£å›èµ·ç‚¹ï¼ˆå¯é€”ç»è‹¥å¹²åŸå¸‚ï¼‰ã€‚  </li>
<li>é™¤èµ·ç‚¹åŸå¸‚å¤–ï¼Œä»»ä½•åŸå¸‚åªèƒ½è®¿é—®ä¸€æ¬¡ã€‚</li>
</ol>
<p>å¯¹äºç»™å®šçš„èˆªç©ºå›¾ï¼Œè¯•è®¾è®¡ä¸€ä¸ªç®—æ³•æ‰¾å‡ºä¸€æ¡æ»¡è¶³è¦æ±‚çš„æœ€ä½³èˆªç©ºæ—…è¡Œè·¯çº¿ã€‚</p>
<p>å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œ$n &lt; 100$</p>
</blockquote>
<p>å…¶å®è¿™é¢˜ä¸æ˜¯å¾ˆéš¾ã€‚ä½†æ˜¯å¥½åƒå¾ˆå¤šé¢˜è§£ä¸æ˜¯å¾ˆè´Ÿè´£ä»»ï¼Œäºæ˜¯è‡ªå·±å†™äº†ä¸€ä¸‹Solè¡¨ç¤ºæƒ³è¦då…¶ä»–é¢˜è§£ï¼ˆé›¾</p>
<p>æ„Ÿè§‰æ˜¯ä¸ªå¾ˆå¦™(æ„Ÿè§‰è‡ªå·±åº”è¯¥ä¼šï¼Œä½†æ˜¯å°±æ˜¯æƒ³ä¸èµ·æ¥)çš„è½¬åŒ–ï¼Œå°±æ˜¯å¦‚æœè®©æ‰¾ä¸€æ¡ä» $1$ å‡ºå‘ç»è¿‡ $n$ å›åˆ° $1$ çš„æ— é‡å¤ç‚¹å›è·¯ï¼Œé‚£æœ¬è´¨å°±æ˜¯åœ¨æ‰¾ä¸¤æ¡ $1$ åˆ° $n$ çš„ä¸ç›¸äº¤è·¯å¾„ã€‚</p>
<hr>
<p>è¯´ä¸€ç‚¹å®ç°ä¸Šçš„å°ç»†èŠ‚å§ã€‚ä¸»è¦å†…å®¹æ˜¯ã€Œè·Ÿå…¶ä»–é¢˜è§£ä¸ä¸€æ ·çš„ä¸œè¥¿ã€ã€‚</p>
<p>å‘ç°å¤§å®¶åœ¨åšè¿™ä¸ªé¢˜çš„æ—¶å€™ï¼Œéƒ½æ˜¯ç‰¹åˆ¤çš„ã€Œæ˜¯å¦å­˜åœ¨ä¸€æ¡ç›´æ¥è¿é€š $1$ å’Œ $n$ã€ çš„è·¯å¾„ï¼Œç„¶åç›´æ¥è¾“å‡ºã€‚é¦–å…ˆè¿™ä¹ˆåšï¼Œè¾ƒä¸ºéº»çƒ¦(è™½ç„¶ä¹Ÿå°±åªå¤šäº†ä¸€ä¸¤äºŒä¸‰è¡Œ)ï¼Œå…¶æ¬¡æ­£ç¡®æ€§æœ‰å¾…è€ƒç©¶ã€‚</p>
<p>è¿™ä¸ªåœ°æ–¹å°±éœ€è¦æ€è€ƒï¼Œä¸ºä»€ä¹ˆå¤§å®¶çš„å®ç°éœ€è¦ç‰¹åˆ¤è¿™ä¸ªç»†èŠ‚ï¼ŸåŸå› æ˜¯å‡è®¾åªæœ‰ $1\leftrightarrow n$ è¿™ä¸€æ¡è¾¹ï¼Œé‚£ä¹ˆè¿™æ¡è·¯éœ€è¦èµ°ä¸¤æ¬¡ã€‚ä½†æ˜¯è¿è¾¹ $(u,v)$ çš„æ—¶å€™å¤§å®¶éƒ½æ˜¯å†™çš„ <code>add(u&#39;,v,1,0)</code>ï¼Œå¯¼è‡´åªèƒ½èµ°ä¸€æ¬¡ã€‚ä¸ªäººè®¤ä¸ºï¼Œç”±äºè¿™æ˜¯ä¸ªåŸºç¡€é¢˜ï¼Œæ‰€ä»¥æ¯ä¸ªç»†èŠ‚éƒ½éœ€è¦å†™çš„ååˆ†åˆç†ï¼Œä½†è¿™ä¸ªåœ°æ–¹æ˜¾ç„¶å°±ä¸åˆç†ã€‚</p>
<p>ç½‘ç»œæµé¢˜è®²ç©¶å¯¹ç€é™åˆ¶æ‰¾<code>flow</code>ï¼Œå¯¹ç€ä»£ä»·æ‰¾<code>cost</code>ã€‚è¿™ä¸ªé¢˜ç›®é‡Œæ˜¾ç„¶åªé™åˆ¶äº†ä¸€ä¸ªç‚¹è‡³å¤šèµ°ä¸€æ¬¡ï¼Œä½†æ˜¯æ²¡é™åˆ¶ä¸€æ¡è¾¹è‡³å¤šèµ°ä¸€æ¬¡â€”â€”è™½ç„¶æœ¬è´¨ä¸Šï¼Œæ²¡å•¥å¾ˆå¤§åŒºåˆ«ï¼Œå› ä¸ºç‚¹è‡³å¤šä¸€æ¬¡å†³å®šäº†è¾¹è‡³å¤šä¸€æ¬¡â€”â€”ä½†æ˜¯è¿™ä»æŸç§ç¨‹åº¦ä¸Šå†³å®šäº†å¯¹è¿™ä¸ªé¢˜å»ºæ¨¡çš„ç†è§£ç¨‹åº¦ã€‚æ‰€ä»¥æˆ‘è®¤ä¸ºï¼Œä¸ºäº†æ›´å¥½åœ°å®ç°ã€Œç½‘ç»œæµ24é¢˜ã€çš„ç½‘ç»œæµæ•™å­¦ä»»åŠ¡ï¼Œåº”è¯¥åœ¨è¿è¾¹ $(u,v)$ æ—¶å¦‚æ˜¯å†™ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">add(u',v,Inf,<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æœ‰ä¸¤ä¸ªå¥½å¤„ï¼š</p>
<p>1ã€åªéœ€è¦ç‰¹åˆ¤æ— è§£ï¼Œæ ¹æœ¬ä¸éœ€è¦é‚£äº›æ— èŠçš„åˆ¤æ¥åˆ¤å»åˆ¤æµé‡å¤šå°‘ï¼Œå½±å“ä»£ç çš„ç¾è§‚å’Œç®€ç»ƒã€‚</p>
<p>2ã€ä½“ç°äº†è¿™ä¸ªé¢˜å»ºæ¨¡çš„æœ¬è´¨æ„ä¹‰ã€‚å› ä¸ºå·²ç»æœ‰æ‹†ç‚¹ä¿è¯äº†é¢˜ç›®ä¸­çš„è¦æ±‚çš„é™åˆ¶ï¼Œå¦‚æœå†ç¡¬ç”Ÿç”ŸåŠ ä¸Šä¸€ä¸ªã€Œè¾¹ä¹Ÿè‡³å¤šèµ°ä¸€æ¬¡ã€ï¼Œå°±æ˜¯åœ¨æ— ä¸­ç”Ÿæœ‰ã€æš—åº¦é™ˆä»“(é›¾)ã€‚è€Œç²¾å‡†çš„å»ºæ¨¡æ˜¯ç½‘ç»œæµå­¦ä¹ é˜¶æ®µæ‰€å¿…é¡»æŒæ¡çš„ä¸œè¥¿ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; _n &gt;&gt; _m ;</span><br><span class="line">    x = _n * <span class="number">2</span> ; y = <span class="number">1</span> + _n ;</span><br><span class="line">    _s = <span class="number">0</span> ; <span class="keyword">_t</span> = _n + _n + <span class="number">1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    add(_s, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>) ; add(x, <span class="keyword">_t</span>, <span class="number">2</span>, <span class="number">0</span>) ;</span><br><span class="line">    add(<span class="number">1</span>, y, <span class="number">2</span>, <span class="number">-1</span>) ; add(_n, x, <span class="number">2</span>, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; s, rt[t[s] = i] = s ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)</span><br><span class="line">        add(i, i + _n, <span class="number">1</span>, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _m ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; s &gt;&gt; ss ;</span><br><span class="line">        <span class="keyword">int</span> p = t[s] ;</span><br><span class="line">        <span class="keyword">int</span> q = t[ss] ;</span><br><span class="line">        <span class="keyword">if</span> (p &gt; q) swap(p, q) ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; p &lt;&lt; " " &lt;&lt; q &lt;&lt; endl ;</span></span><br><span class="line">        add(p + _n, q, I, <span class="number">0</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    buc[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    n = <span class="keyword">_t</span> + <span class="number">1</span> ; ek() ;</span><br><span class="line">    <span class="keyword">if</span> (!ret)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"No Solution!"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; -res - <span class="number">2</span> &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    dfs(<span class="number">1</span>, l) ; <span class="built_in">cout</span> &lt;&lt; rt[<span class="number">1</span>] &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; l ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; rt[ans[i]] &lt;&lt; <span class="string">'\n'</span> ; l = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (ct(i) == <span class="number">-1</span> &amp;&amp; !fw(i) &amp;&amp; !buc[fr(i)])</span><br><span class="line">            ans[++ l] = fr(i) ;</span><br><span class="line">    sort(ans + <span class="number">1</span>, ans + l + <span class="number">1</span>, comp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= l ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; rt[ans[i]] &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cout</span> &lt;&lt; rt[<span class="number">1</span>] &lt;&lt; <span class="built_in">endl</span>, <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>btwï¼Œå…¶å®åªéœ€è¦dfsä¸€éå³å¯ã€‚ç”±äºè®¿é—®è¿‡ç¨‹ä¸€å®šæ˜¯å•è°ƒçš„ï¼Œæ‰€ä»¥å°†èµ°å®Œä¸€éåé‚£äº›æ²¡èµ°è¿‡çš„èŠ‚ç‚¹æ’åºè¾“å‡ºå³å¯ã€‚</p>
<hr>
<p>ç„¶åéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæœ¬èº« $1$ å’Œ $n$ éƒ½å¯ä»¥ç»è¿‡å¤šæ¬¡ï¼Œæ‰€ä»¥å’Œè‡ªå·±çš„æ›¿èº«è¿è¾¹è¦è¿ $f=2$ çš„ã€‚</p>
<p>å“¦ï¼Œå¯¹äº†ï¼Œè¿™é¢˜å…¶å®è·Ÿã€ŒåŒè°ƒå·¡æ¸¸(bitonic tour)ã€å·®ä¸å¤šï¼Œå”¯ç‹¬å°±æ˜¯æ‰¾çš„ä¸æ˜¯å“ˆå¯†é¡¿å›è·¯ä¸”ä¸ä¿è¯æ˜¯å®Œå…¨å›¾ã€‚å¤šåŠ ä¸€ç»´æšä¸¾å’Œ $i,j$ è¿é€šçš„ç‚¹å³å¯ã€‚</p>
<h1 id="æ•°å­—æ¢¯å½¢é—®é¢˜"><a href="#æ•°å­—æ¢¯å½¢é—®é¢˜" class="headerlink" title="æ•°å­—æ¢¯å½¢é—®é¢˜"></a>æ•°å­—æ¢¯å½¢é—®é¢˜</h1><blockquote>
<p>ç»™å®šä¸€ä¸ª $n$ è¡Œçš„æ•°å­—æ¢¯å½¢ï¼Œä»ç¬¬ä¸€è¡Œåˆ°æœ€åä¸€è¡Œåˆ†åˆ«æœ‰ $2,3,\cdots,n+1$ ä¸ªæ•°å­—ã€‚æ¯ä¸ªæ•°å­—å¯ä»¥å‘å·¦ä¸‹æˆ–è€…å³ä¸‹ç¬¬ä¸€ä¸ªæ•°å­—çš„åœ°æ–¹ç§»åŠ¨ã€‚æ±‚ï¼š</p>
<p>1ã€$m$ æ¡äº’ä¸ç›¸äº¤è·¯å¾„çš„æ•°å€¼æœ€å¤§æ€»å’Œï¼›</p>
<p>2ã€$m$ æ¡å¯ä»¥å­˜åœ¨ç‚¹ç›¸äº¤æ—¶çš„è·¯å¾„æ•°å€¼æœ€å¤§æ€»å’Œï¼›</p>
<p>3ã€$m$ æ¡å¯ä»¥å­˜åœ¨ç‚¹ç›¸äº¤æˆ–è€…è¾¹ç›¸äº¤æ—¶çš„è·¯å¾„æ•°å€¼æœ€å¤§æ€»å’Œï¼›</p>
</blockquote>
<h2 id="ç¬¬ä¸€é—®-Â·-å®Œå…¨ä¸ç›¸äº¤çš„è·¯å¾„"><a href="#ç¬¬ä¸€é—®-Â·-å®Œå…¨ä¸ç›¸äº¤çš„è·¯å¾„" class="headerlink" title="ç¬¬ä¸€é—® Â· å®Œå…¨ä¸ç›¸äº¤çš„è·¯å¾„"></a>ç¬¬ä¸€é—® Â· å®Œå…¨ä¸ç›¸äº¤çš„è·¯å¾„</h2><p>å‘ç°æœ¬è´¨ä¸Šï¼Œå°±æ˜¯æœ€å°æƒè·¯å¾„è¦†ç›–é—®é¢˜ã€‚é‚£ä¹ˆå¸¸è§„åšæ³•æ˜¯ï¼Œé™åˆ¶é€‰çš„æ¬¡æ•°è¦é€šè¿‡é™åˆ¶æµé‡æ¥æ¨¡æ‹Ÿï¼Œä½†æ˜¯ä¸€ä¸ªå•ç‚¹ä¸å­˜åœ¨æµé‡ï¼Œæ‰€ä»¥éœ€è¦æ‹†ç‚¹ã€‚</p>
<p>å¤§æ¦‚å°±æ˜¯æ¯ä¸ªç‚¹æ‹†æˆä¸¤ä¸ªç‚¹ï¼Œç„¶åå¯¹äºæŸä¸ªç‚¹å’Œå®ƒçš„å‰¯æœ¬è¿ä¸€æ¡ $f=1,c=-base[x]$ çš„è¾¹è¡¨ç¤ºé€‰äº†ï¼Œæ¯•ç«Ÿæ˜¯æ±‚æœ€å¤§å€¼ã€‚ç„¶å $\rm S$ å’Œæœ€é¡¶ä¸Šçš„è¿ $f=1,c=0$ çš„è¾¹ï¼Œ$\rm T$ å’Œæœ€ä¸‹é¢ä¸€å±‚è¿ $f=1,c=0$ï¼ŒåŸå›¾ä¸­ç‚¹ $i,j$ ç›¸è¿ç”¨ $iâ€™\to j$ åˆ»ç”»å³å¯ã€‚ </p>
<h2 id="ç¬¬äºŒé—®-Â·-è¾¹ä¸ç›¸äº¤çš„è·¯å¾„"><a href="#ç¬¬äºŒé—®-Â·-è¾¹ä¸ç›¸äº¤çš„è·¯å¾„" class="headerlink" title="ç¬¬äºŒé—® Â· è¾¹ä¸ç›¸äº¤çš„è·¯å¾„"></a>ç¬¬äºŒé—® Â· è¾¹ä¸ç›¸äº¤çš„è·¯å¾„</h2><p>æˆ‘ä»¬è€ƒè™‘æ­¤æ—¶å…¶å®æ˜¯åˆ é™¤äº†æ¯ä¸ªç‚¹è¢«é€‰å–æ¬¡æ•°çš„é™åˆ¶ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å°†æ¯ä¸ªç‚¹å’Œè‡ªå·±çš„å‰¯æœ¬ä¹‹é—´çš„è¾¹å®¹é‡æ”¹æˆ$+ \infty$ï¼Œå¹¶æŠŠ $\rm T$ ä¸æœ€åº•ä¸‹çš„æ‰€æœ‰ç‚¹çš„å®¹é‡æ‰©ä¸º $+ \infty$ å³å¯ã€‚æ³¨æ„ååŠéƒ¨åˆ†çš„æ‰©å®¹ï¼Œ<strong>å…¶ç›®çš„åœ¨äºé˜²æ­¢ä¸­é—´èŠ‚ç‚¹çš„æ‰©å®¹è¢«é™åˆ¶</strong>ã€‚</p>
<h2 id="ç¬¬ä¸‰é—®-Â·-éšä¾¿çš„è·¯å¾„"><a href="#ç¬¬ä¸‰é—®-Â·-éšä¾¿çš„è·¯å¾„" class="headerlink" title="ç¬¬ä¸‰é—® Â· éšä¾¿çš„è·¯å¾„"></a>ç¬¬ä¸‰é—® Â· éšä¾¿çš„è·¯å¾„</h2><p>æ—¢ç„¶éƒ½éšä¾¿äº†ï¼Œå°±ç›´æ¥æŠŠæ‰€æœ‰çš„è¾¹éƒ½è®¾ç½®æˆ$+ \infty$ï¼Œä½†æ˜¯æ˜¾ç„¶çš„æ˜¯æˆ‘ä»¬ä¸èƒ½æ‰© $\rm S$ è¿å‡ºå»çš„è¾¹ã€‚è¿™æ ·å°±æ°¸è¿œä¿è¯äº†ï¼Œä» $\rm S$ èµ°å‡ºæ¥ä¸€å®šæ˜¯ä¸€ç³»åˆ—é“¾ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç±»æ ‘å½¢å›¾ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> L1, R1, L ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; M &gt;&gt; N ; S = <span class="number">0</span>, T = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt; M + i ; ++ j) </span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; base[i][j], Id[i][j] = (tot += <span class="number">2</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) Add(S, Id[<span class="number">1</span>][i], <span class="number">1</span>, <span class="number">0</span>) ; L = cnt + <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (L1 = cnt + <span class="number">1</span>, i = <span class="number">1</span> ; i &lt;= N + M ; ++ i) Add(Id[N][i] + <span class="number">1</span>, T, <span class="number">1</span>, <span class="number">0</span>) ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt; M + i ; ++ j)</span><br><span class="line">			Add(Id[i][j], Id[i][j] + <span class="number">1</span>, <span class="number">1</span>, -base[i][j]) ; R1 = cnt ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt; M + i ; ++ j)</span><br><span class="line">			<span class="keyword">if</span> (i &lt; N) Add(Id[i][j] + <span class="number">1</span>, Id[i + <span class="number">1</span>][j], <span class="number">1</span>, <span class="number">0</span>), Add(Id[i][j] + <span class="number">1</span>, Id[i + <span class="number">1</span>][j + <span class="number">1</span>], <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">	MCMF() ; <span class="built_in">cout</span> &lt;&lt; -Ans &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= cnt ; ++ i) E[i].f = t[i] ; </span><br><span class="line">	<span class="keyword">for</span> (i = L1 ; i &lt; R1 ; i += <span class="number">2</span>) E[i].f = Inf ; </span><br><span class="line">	<span class="keyword">for</span> (i = L1 + <span class="number">1</span> ; i &lt;= R1 ; i += <span class="number">2</span>) E[i].f = <span class="number">0</span> ;</span><br><span class="line">	MCMF() ; <span class="built_in">cout</span> &lt;&lt; -Ans &lt;&lt; <span class="built_in">endl</span> ;  </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= cnt ; ++ i) E[i].f = t[i] ;</span><br><span class="line">	<span class="keyword">for</span> (i = L ; i &lt; cnt ; i += <span class="number">2</span>) E[i].f = Inf ; </span><br><span class="line">	<span class="keyword">for</span> (i = L + <span class="number">1</span> ; i &lt;= cnt ; i += <span class="number">2</span>) E[i].f = <span class="number">0</span> ; </span><br><span class="line">	MCMF() ; <span class="built_in">cout</span> &lt;&lt; -Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line"><span class="comment">/*  ä»¥ä¸‹æ˜¯é”™è¯¯çš„å»ºè¾¹ </span></span><br><span class="line"><span class="comment">	for (i = 1 ; i &lt;= M ; ++ i) </span></span><br><span class="line"><span class="comment">		cin &gt;&gt; base[++ tot], Add(S, tot, 1, -base[tot]) ;</span></span><br><span class="line"><span class="comment">	for (i = 1 ; i &lt; N ; ++ i)</span></span><br><span class="line"><span class="comment">		for (j = 1 ; j &lt;= M + i ; ++ j)&#123;</span></span><br><span class="line"><span class="comment">			cin &gt;&gt; base[++ tot] ; int sd = (2 * M + i - 2) * (i - 1) / 2 + 1 ;</span></span><br><span class="line"><span class="comment">			for (int k = sd ; k &lt;= (2 * M + i - 1) * i / 2 ; ++ k) Add(k, tot, + Inf, -base[tot]) ;</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">	for (T = tot + 1, i = tot - (N + M - 1) + 1 ; i &lt;= tot ; ++ i) Add(i, T, 1, 0) ; ++ tot, MCMF() ; cout &lt;&lt; -Ans &lt;&lt; endl ;  */</span></span><br><span class="line">	<span class="comment">/*MCMF() ; cout &lt;&lt; -Ans &lt;&lt; endl ;  */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜"><a href="#æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜" class="headerlink" title="æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜"></a>æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜</h1><blockquote>
<p>ç»™å®šä¸€ä¸ª $\text{N}\times \text{N}$ çš„æ–¹å½¢ç½‘æ ¼ï¼Œè®¾å…¶å·¦ä¸Šè§’ä¸ºèµ·ç‚¹â—ï¼Œåæ ‡ä¸º  $\text{(1,1)} $ ï¼Œ$\text{X}$ è½´å‘å³ä¸ºæ­£ï¼Œ $\text{Y}$ è½´å‘ä¸‹ä¸ºæ­£ï¼Œæ¯ä¸ªæ–¹æ ¼è¾¹é•¿ä¸º <code>1</code> ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚</p>
<p>ä¸€è¾†æ±½è½¦ä»èµ·ç‚¹â—å‡ºå‘é©¶å‘å³ä¸‹è§’ç»ˆç‚¹â–²ï¼Œå…¶åæ ‡ä¸º $(\text{N},\text{N})$ ã€‚</p>
<p>åœ¨è‹¥å¹²ä¸ªç½‘æ ¼äº¤å‰ç‚¹å¤„ï¼Œè®¾ç½®äº†æ²¹åº“ï¼Œå¯ä¾›æ±½è½¦åœ¨è¡Œé©¶é€”ä¸­åŠ æ²¹ã€‚æ±½è½¦åœ¨è¡Œé©¶è¿‡ç¨‹ä¸­åº”éµå®ˆå¦‚ä¸‹è§„åˆ™:</p>
<ul>
<li>æ±½è½¦åªèƒ½æ²¿ç½‘æ ¼è¾¹è¡Œé©¶ï¼Œè£…æ»¡æ²¹åèƒ½è¡Œé©¶ $\text{K}$ æ¡ç½‘æ ¼è¾¹ã€‚</li>
<li>å‡ºå‘æ—¶æ±½è½¦å·²è£…æ»¡æ²¹ï¼Œåœ¨èµ·ç‚¹ä¸ç»ˆç‚¹å¤„ä¸è®¾æ²¹åº“ã€‚</li>
<li>æ±½è½¦ç»è¿‡ä¸€æ¡ç½‘æ ¼è¾¹æ—¶ï¼Œè‹¥å…¶ $\text{X}$ åæ ‡æˆ– $\text{Y}$ åæ ‡å‡å°ï¼Œåˆ™åº”ä»˜è´¹ç”¨ $\text{B}$ ï¼Œå¦åˆ™å…ä»˜è´¹ç”¨ã€‚</li>
<li>æ±½è½¦åœ¨è¡Œé©¶è¿‡ç¨‹ä¸­é‡æ²¹åº“åˆ™åº”åŠ æ»¡æ²¹å¹¶ä»˜åŠ æ²¹è´¹ç”¨ $\text{A} $ã€‚</li>
<li>åœ¨éœ€è¦æ—¶å¯åœ¨ç½‘æ ¼ç‚¹å¤„å¢è®¾æ²¹åº“ï¼Œå¹¶ä»˜å¢è®¾æ²¹åº“è´¹ç”¨ $\text{C} $ (ä¸å«åŠ æ²¹è´¹ç”¨ $\text{A} $ )ã€‚</li>
<li>$\rm N , K , A , B , C$ å‡ä¸ºæ­£æ•´æ•°ï¼Œ ä¸”æ»¡è¶³çº¦æŸ: $2\leq \text{N} \leq 100, 2 \leq \text{K} \leq 10$ã€‚</li>
</ul>
<p>è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œæ±‚å‡ºæ±½è½¦ä»èµ·ç‚¹å‡ºå‘åˆ°è¾¾ç»ˆç‚¹çš„ä¸€æ¡æ‰€ä»˜è´¹ç”¨æœ€å°‘çš„è¡Œé©¶è·¯çº¿ã€‚</p>
<p><img src="https://www.oj.swust.edu.cn/upload/image/problem/1750.png" alt="233"></p>
</blockquote>
<p>è¿™é¢˜ç¬¬ä¸€çœ¼çœ‹ä¸Šå»æ¡ä»¶å¾ˆå¤šã€‚è€ƒè™‘çŠ¶æ€çš„è®¾è®¡ã€‚å‘ç°å¯¹äºæ¯ä¸ªçŠ¶æ€ $(i,j)$ ï¼Œå½“å‰çš„æ²¹é‡ $k$ éƒ½å†³å®šäº†æ¯ä¸€æ­¥çš„å†³ç­–ï¼Œæ‰€ä»¥ä¸éš¾çœ‹å‡ºåº”è¯¥æŠŠ $k$ ä¹Ÿæ”¾åˆ°çŠ¶æ€é‡Œå½¢æˆåˆ†å±‚å›¾ã€‚é‚£ä¹ˆå°±ç›´æ¥æ¨¡æ‹Ÿä¸€ä¸‹èµ°çš„è¿‡ç¨‹ï¼ŒæŒ‰åˆ†å±‚å›¾å»ºå›¾ï¼Œæµä¸€ä¸‹å³å¯ã€‚</p>
<p>ç„¶è€Œæ­¤é¢˜å°±æ˜¯è€ƒäº†ä¸ªåˆ†å±‚å›¾ã€‚å› ä¸ºæœ¬èº«æ‰€æœ‰è¾¹æµé‡éƒ½æ˜¯ $1$ï¼Œæ‰€ä»¥è´¹ç”¨æµå°±æ˜¯åœ¨åšæœ€çŸ­è·¯233</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cnt = <span class="number">-1</span> ;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K &gt;&gt; A &gt;&gt; B &gt;&gt; C ;</span><br><span class="line">  <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head))  ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; Ma[i][j] ;</span><br><span class="line">			<span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt;= K ; ++ k) Id[i][j][k] = ++ tot ;	</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">			<span class="keyword">if</span> (Ma[i][j]) </span><br><span class="line">				<span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt; K ; ++ k)&#123;</span><br><span class="line">					<span class="keyword">if</span> (i &lt; N) Add(Id[i][j][k], Id[i + <span class="number">1</span>][j][K - <span class="number">1</span>], <span class="number">1</span>, A) ;</span><br><span class="line">					<span class="keyword">if</span> (j &lt; N) Add(Id[i][j][k], Id[i][j + <span class="number">1</span>][K - <span class="number">1</span>], <span class="number">1</span>, A) ;</span><br><span class="line">					<span class="keyword">if</span> (i &gt; <span class="number">1</span>) Add(Id[i][j][k], Id[i - <span class="number">1</span>][j][K - <span class="number">1</span>], <span class="number">1</span>, A + B) ;</span><br><span class="line">					<span class="keyword">if</span> (j &gt; <span class="number">1</span>) Add(Id[i][j][k], Id[i][j - <span class="number">1</span>][K - <span class="number">1</span>], <span class="number">1</span>, A + B) ;</span><br><span class="line">				&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt; K ; ++ k) Add(Id[i][j][k], Id[i][j][K], <span class="number">1</span>, A + C) ;</span><br><span class="line">				<span class="keyword">for</span> (k = <span class="number">1</span> ; k &lt;= K ; ++ k)&#123;</span><br><span class="line">					<span class="keyword">if</span> (i &lt; N) Add(Id[i][j][k], Id[i + <span class="number">1</span>][j][k - <span class="number">1</span>], <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">					<span class="keyword">if</span> (j &lt; N) Add(Id[i][j][k], Id[i][j + <span class="number">1</span>][k - <span class="number">1</span>], <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">					<span class="keyword">if</span> (i &gt; <span class="number">1</span>) Add(Id[i][j][k], Id[i - <span class="number">1</span>][j][k - <span class="number">1</span>], <span class="number">1</span>, B) ;</span><br><span class="line">					<span class="keyword">if</span> (j &gt; <span class="number">1</span>) Add(Id[i][j][k], Id[i][j - <span class="number">1</span>][k - <span class="number">1</span>], <span class="number">1</span>, B) ;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">	S = <span class="number">0</span>, T = tot + <span class="number">1</span>, Add(S, Id[<span class="number">1</span>][<span class="number">1</span>][K], <span class="number">1</span>, <span class="number">0</span>) ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= K ; ++ i) Add(Id[N][N][i], T, <span class="number">1</span>, <span class="number">0</span>) ; </span><br><span class="line">	MFMC() ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>ç½‘ç»œæµ24é¢˜</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œæµ24é¢˜</tag>
        <tag>ç½‘ç»œæµ/è´¹ç”¨æµ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘[ARC100]C~E</title>
    <url>/2020/03/09/arc100c-e/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ•´ç† ARC100 çš„ C~Eã€‚Fé¢˜ç”±äºå¤ªç¥ä»™è¢«æˆ‘æ‹¿å‡ºå»å•åˆ—äº†ä¸€ç¯‡ã€‚</p>
<p>å†™å®Œæ‰å‘ç°ï¼Œè¿™ä»¨é¢˜ä¹Ÿå¤ªæ°´äº†å§ï¼Ÿä¸€ç‚¹æ„æ€éƒ½æ²¡æœ‰å•Šï¼Ÿ<del>ä¸ç®¡äº†ï¼Œèƒ½æ°´ä¸€ç¯‡æ˜¯ä¸€ç¯‡ã€‚</del></p>
<a id="more"></a>
<h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªé•¿ä¸º $n$ çš„åºåˆ— $\{A\}$ï¼Œæ‰¾ä¸€ä¸ª $b$ ä½¿å¾—ä¸‹å¼æœ€å°ï¼š</p>
<script type="math/tex; mode=display">
a b s\left(A_{1}-(b+1)\right)+a b s\left(A_{2}-(b+2)\right)+\ldots+a b s\left(A_{N}-(b+N)\right)</script></blockquote>
<p>æ ¹æ®å°å­¦ç”Ÿç»“è®ºï¼Œä¸€æ¡æ•°è½´ä¸Šç¦»æ¯ä¸ªç‚¹è·ç¦»å’Œæœ€å°çš„é‚£ä¸ªç‚¹å°±æ˜¯è¿™äº›ç‚¹æœ€ä¸­é—´é‚£ä¸ªç‚¹ã€‚è¯æ˜çš„è¯ç”¨å¾®æ‰°æ³•å°±å¯ä»¥å‘ç°è¿™æ˜¯ä¸ªä¸‹å‡¸å‡½æ•°ã€‚</p>
<p>nmdï¼Œä¸€å¼€å§‹è®°æˆäº†å¹³å‡æ•°WAäº†ä¸¤æ¬¡ï¼Œå®é™…ä¸Šåº”è¯¥æ˜¯ä¸­ä½æ•°å•¦ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; <span class="keyword">int</span> p ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), k[i] = base[i] - i ;</span><br><span class="line">    sort(k + <span class="number">1</span>, k + n + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">if</span> (n &amp; <span class="number">1</span>) p = k[n / <span class="number">2</span> + <span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">else</span> p = (k[n / <span class="number">2</span>] + k[n / <span class="number">2</span> + <span class="number">1</span>]) / <span class="number">2</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        ans += <span class="number">1l</span>l * <span class="built_in">abs</span>(base[i] - p - i) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªåºåˆ—ã€‚è¦æ±‚æŠŠè¿™ä¸ªåºåˆ—åˆ†æˆè¿ç»­çš„å››ä»½ï¼Œè®°è¿™å››ä»½å†…æ•°å­—å’Œåˆ†åˆ«ä¸º $a,b,c,d$ ï¼Œæœ€å°åŒ– $a,b,c,d$ çš„æå·®ã€‚</p>
</blockquote>
<p>znmï¼Œé•¿å¾—ä¸€è„¸å¯ä¸‰åˆ†çš„æ ·å­ç„¶è€Œå¹¶ä¸å¯ä¸‰åˆ†ï¼Œå› ä¸ºå¾ˆå®¹æ˜“çŸ¥é“åœ¨è¿™ç§å¤šå³°å‡½æ•°ä¸‰åˆ†æœ¬è´¨ä¸Šå’Œçˆ¬å±±æ²¡å•¥åŒºåˆ«ã€‚å¯èƒ½ä¼šæœ‰ä»€ä¹ˆç¥å¿…çš„é€€ç«æˆ–è€…é—ä¼ åšæ³•ã€‚ä½†æ˜¯ä¸ªäººæ„Ÿè§‰è¿™ä¸ªæ•°æ®èŒƒå›´ä¼¼ä¹ä¸æ˜¯å¾ˆå…è®¸ã€‚</p>
<p>è€ƒè™‘æš´åŠ›æ€ä¹ˆåšã€‚å°è¯•å»æšä¸¾ä¸­é—´çš„ç¬¬äºŒæ®µçš„å³ç«¯ç‚¹ï¼Œè¿™æ ·å†å»æšä¸¾ $a,c,d$ ï¼Œå¤æ‚åº¦æ˜¯ $O(n^3)$ çš„ã€‚</p>
<p>è§‚å¯Ÿé¢˜ç›®æ‰€ç»™çš„æ€§è´¨ã€‚å‘ç°æ‰€æœ‰æ•°éƒ½ $&gt;0$ã€‚äºæ˜¯è€ƒè™‘æšä¸¾ç¬¬äºŒæ®µçš„æ—¶å€™ï¼Œå¯¹äºä¸€ä¸ªä¸è‡ªå·±æå·®æœ€å°çš„ç¬¬ä¸€æ®µï¼Œç”±äºç¬¬äºŒæ®µæ•°ä¸€ç›´åœ¨å¢å¤šï¼Œæ‰€ä»¥ç¬¬ä¸€æ®µçš„å³ç«¯ç‚¹ä¸‹æ ‡å¿…ç„¶æ˜¯ä¸é™çš„ï¼›å¯¹äºç¬¬ä¸‰ã€å››æ®µï¼Œè¿™ä¸ªæ€§è´¨åŒæ ·æˆç«‹ã€‚</p>
<p>äºæ˜¯å¯ä»¥æƒ³åˆ°æšä¸¾ç¬¬äºŒæ®µï¼Œç¬¬ä¸€æ®µå’Œç¬¬ä¸‰æ®µéƒ½å˜æˆäº† $O(1)$ ã€‚æœ€ç»ˆå¤æ‚åº¦ $O(n)$ ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line">ll ans ;</span><br><span class="line">ll S[<span class="number">4</span>] ;</span><br><span class="line">ll minx ;</span><br><span class="line">ll maxx ;</span><br><span class="line">ll sum[N] ;</span><br><span class="line">ll base[N] ;</span><br><span class="line"> </span><br><span class="line"><span class="function">ll <span class="title">gt</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &lt; <span class="number">0</span> ? -x : x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">chkmin</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    minx = x &gt;= minx ? minx : x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">chkmax</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    maxx = x &gt;= maxx ? x : maxx ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    ans = (<span class="number">1l</span>l &lt;&lt; <span class="number">62</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i]) ;</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + base[i] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">2</span>, r = <span class="number">4</span> ;</span><br><span class="line">    S[<span class="number">0</span>] = base[<span class="number">1</span>] ; S[<span class="number">2</span>] = base[<span class="number">3</span>] ;</span><br><span class="line">    S[<span class="number">1</span>] = base[<span class="number">2</span>] ; S[<span class="number">3</span>] = sum[n] - sum[<span class="number">3</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; i &amp;&amp; gt(S[<span class="number">0</span>] - S[<span class="number">1</span>]) &gt; gt(S[<span class="number">0</span>] + base[l] - S[<span class="number">1</span>] + base[l]))&#123;</span><br><span class="line">            S[<span class="number">0</span>] += base[l], S[<span class="number">1</span>] -= base[l], ++ l ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (r &lt;= n &amp;&amp; gt(S[<span class="number">3</span>] - S[<span class="number">2</span>]) &gt; gt(S[<span class="number">2</span>] + base[r] - S[<span class="number">3</span>] + base[r]))&#123;</span><br><span class="line">            S[<span class="number">2</span>] += base[r], S[<span class="number">3</span>] -= base[r], ++ r ;</span><br><span class="line">        &#125;</span><br><span class="line">        minx = (<span class="number">1l</span>l &lt;&lt; <span class="number">61</span>) ; maxx = -(<span class="number">1l</span>l &lt;&lt; <span class="number">61</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= <span class="number">3</span> ; ++ j) chkmin(S[j]), chkmax(S[j]) ;</span><br><span class="line">        ans = min(ans, maxx - minx) ; S[<span class="number">1</span>] += base[i] ; S[<span class="number">2</span>] -= base[i] ;</span><br><span class="line">        <span class="comment">//for (int j = 0 ; j &lt;= 3 ; ++ j) cout &lt;&lt; S[j] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $2^k-1$ çš„åºåˆ— $\{a_n\}$ã€‚å¯¹äºæ¯ä¸ª $1\leq p\leq 2^k-1$ ï¼Œæ±‚</p>
<script type="math/tex; mode=display">
\max_{i \operatorname{or} j\operatorname{\leq} p}\{a_i+a_j\}</script><p>$k\leq 18$</p>
</blockquote>
<p>å‘ç°ä¼¼ä¹æ˜¯åœ¨åšä¸€ä¸ªFMTï¼Œä½†æ˜¯ç›´æ¥è½¬ç§»æœ€å¤§å€¼éœ€è¦ $k ^2$ ç”šè‡³æ›´é«˜çš„ä»£ä»·ã€‚æ‰€ä»¥è€ƒè™‘å¯¹äºæ¯ä¸ªé›†åˆ $s$ è®°ä¸€ä¸‹è¿™ä¸ªé›†åˆä¸­çš„æœ€æœ€å¤§æ•°å’Œæ¬¡å¤§æ•°ï¼Œä¸éš¾å‘ç°è¿™æ ·è½¬ç§»æ˜¯æ–¹ä¾¿çš„ã€‚å¤æ‚åº¦ $2^kk$ ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">ll ans ;</span><br><span class="line"><span class="keyword">int</span> m, n ;</span><br><span class="line">pint f[N] ;</span><br><span class="line">ll base[N] ;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> base[x] &gt; base[y] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m ; n = (<span class="number">1</span> &lt;&lt; m) - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; base[i] ;</span><br><span class="line">        f[i] = make_pair(i, n + <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    base[n + <span class="number">1</span>] = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; m ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (!((<span class="number">1</span> &lt;&lt; j) &amp; i))&#123;</span><br><span class="line">                <span class="keyword">int</span> k = (<span class="number">1</span> &lt;&lt; j) | i ;</span><br><span class="line">                <span class="keyword">int</span> t[<span class="number">4</span>] = &#123;fr(i), sc(i), fr(k), sc(k)&#125; ;</span><br><span class="line">                sort(t, t + <span class="number">4</span>, comp) ; unique(t, t + <span class="number">4</span>) ;</span><br><span class="line">                f[k] = make_pair(t[<span class="number">0</span>], t[<span class="number">1</span>]) ;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        ans = max(ans, base[fr(i)] + base[sc(i)]) ;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>atcoder</category>
      </categories>
      <tags>
        <tag>å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢(FMT)</tag>
        <tag>è´ªå¿ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘[ARC100F]Colorful Sequences</title>
    <url>/2020/03/08/ARC100F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>ç»™å®šä¸€ä¸ªé•¿ä¸º $m$ çš„åºåˆ—ï¼Œä¿è¯æ¯ä¸ªæ•°éƒ½ $\leq k$ã€‚åŒæ—¶å®šä¹‰ï¼Œå¦‚æœä¸€ä¸ªå…¨éƒ¨å…ƒç´ å‡ $\leq x$ çš„åºåˆ—ä¸­å­˜åœ¨ä¸€ä¸ªé•¿åº¦ä¸º $x$ å­åºåˆ—ï¼Œæ°å¥½æ˜¯ $1\sim x$ çš„æ’åˆ—ï¼Œé‚£ä¹ˆç§°è¿™ä¸ªåºåˆ—ä¸º ã€Œ$x-$å¥½åºåˆ—ã€ã€‚</p>
<p>ç»™å®šé•¿åº¦ $n$ ã€‚æ±‚æ‰€æœ‰é•¿åº¦ä¸º $n$ çš„ $k-$å¥½åºåˆ—å…±åŒ…å«äº†å¤šå°‘ä¸ªé•¿åº¦ä¸º $m$ çš„å­åºåˆ—ã€‚</p>
<p>$1\leq n\leq 25000,1\leq k\leq 400$ ã€‚</p>
</blockquote>
<p>ç¥ä»™è®¡æ•°é¢˜ï¼Œè€ƒå¯Ÿäº†è®¸å¤šå¾ˆ(æˆ‘)æœ‰(ä¸)è¶£(ç†Ÿ)çš„æŠ€æœ¯æŠ€å·§ã€‚</p>
<a id="more"></a>
<p>è®°è¿™ä¸ªç»™å®šçš„åºåˆ—ä¸º $s$ .</p>
<p>é¦–å…ˆå‘ç°ï¼Œå¦‚æœæš´åŠ›è®¡æ•°ç»Ÿè®¡çš„è¯ä¼¼ä¹ä¸æ˜¯å¾ˆç®€å•ï¼Œå¯èƒ½åªå…è®¸çŠ¶å‹ã€‚æ‰€ä»¥æ­£éš¾åˆ™å( <code>trick1</code>) ï¼Œè€ƒè™‘ä¸åŠ  ã€Œå¥½åºåˆ—ã€çš„é™åˆ¶ï¼Œç­”æ¡ˆå°±æ˜¯å¹³å‡¡çš„ $k^{n-m}(n - m + 1)$ï¼Œ$n-m+1$ ç”¨æ¥ç¡®å®š $s$ æ”¾åœ¨å“ªä¸ªä½ç½®ã€‚</p>
<p>æ¥ä¸‹æ¥éœ€è¦åˆ†ç±»è®¨è®ºï¼š</p>
<p>1ã€$s$ æœ¬èº«å°±æ˜¯ä¸€ä¸ª $k-$å¥½åºåˆ—ã€‚</p>
<p>é‚£ä¹ˆæ‰€æœ‰åŒ…å« $s$ çš„åºåˆ—ï¼Œä¸€å®šåŒ…å« $k$ ã€‚æ­¤æ—¶æ‰€æœ‰æƒ…å†µéƒ½æ˜¯åˆæ³•çš„ã€‚</p>
<p>2ã€$s$ ä¸­å«æœ‰ä¸€å¯¹é‡å¤å…ƒç´ ã€‚</p>
<p>æ­¤æ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç»å¯¹ä¸ä¼šæœ‰è·¨è¿‡ $s$ çš„ $k-$è¿ç»­æ®µã€‚æ‰€ä»¥æƒ³åˆ°åœ¨å·¦å³ä¸¤è¾¹åˆ†åˆ«è®¡ç®—æœ‰å¤šå°‘ä¸ªåºåˆ—ä½¿å¾—ä¸ $s$ æ‹¼æ¥ä¹‹åï¼Œä¸å­˜åœ¨ $k-$è¿ç»­æ®µã€‚</p>
<p>å…·ä½“ä¸€ç‚¹ã€‚è€ƒè™‘è®° $f_{i,j}$ è¡¨ç¤ºå·²ç»è€ƒè™‘äº† $i$ ä¸ªæ•°ï¼Œæœ«å°¾å­˜åœ¨ä¸€ä¸ª $j$ è¿ç»­æ®µçš„åºåˆ—æ’åˆ—æ•°ã€‚å‘ç°ä¸€å…±ä¸¤ç§è½¬ç§»ï¼š</p>
<script type="math/tex; mode=display">
\begin{align*}
(k-j)\cdot f_{i,j}\to f_{i+1,j+1}\\
f_{i,j}\to f_{i+1,p}\quad (p\leq j)
\end{align*}</script><p>ç¬¬ä¸€ä¸ªè½¬ç§»æ˜¾ç„¶æ˜¯æ‰¾ä¸€ä¸ªæ–°çš„å…ƒç´ æ”¾è¿›æ¥ï¼Œç¬¬äºŒä¸ªè½¬ç§»åˆ™è¡¨ç¤ºæ°¸è¿œå¯ä»¥é€‰ä¸€ä¸ª $k-$è¿ç»­æ®µä¸­çš„æ•°å­—æ¥è°ƒæ•´é•¿åº¦ã€‚æœ´ç´ çš„ $dp$ æ˜¯ $nk^2$ çš„ï¼Œè€ƒè™‘å¦‚ä½•å¿«é€Ÿè®¡ç®—ç¬¬äºŒä¸ªè½¬ç§»ã€‚å‘ç°å¯¹äº $i$ ä¸‹çš„ä¸€ä¸ªç¬¬äºŒç»´ $j$ï¼Œæ ¹æ®ç¬¬äºŒä¸ªè½¬ç§»éœ€è¦åŠ ä¸Šæ‰€æœ‰ $i-1$ ä¸” $q\geq i$ çš„ $f_{i-1,q}$ çš„å’Œï¼Œæ˜¯ä¸€ä¸ªåç¼€å’Œçš„å½¢å¼ã€‚</p>
<p>è€ƒè™‘å¦‚ä½•åœ¨åˆ·è¡¨çš„æ—¶å€™ç»´æŠ¤åç¼€å’Œ(<code>trick2</code>)ï¼šå‡è®¾å½“å‰çŠ¶æ€ $(i,j)$ è¦è½¬ç§»åˆ° $(i+1,j+1)$ ï¼Œè½¬ç§»äº† $v$ ã€‚é‚£ä¹ˆè€ƒè™‘å†ä» $(i,j)$ è½¬ç§»åˆ° $(i+1,j+2)$ï¼Œè½¬ç§» $-v$ ã€‚è¿™æ ·å¯¹äºæ¯ä¸ªçŠ¶æ€ $(i,j)$ï¼Œå…¶çœŸå®å€¼éƒ½æ˜¯ä¸€ä¸ª $1\to j$ çš„ç´¯åŠ è¿‡ç¨‹ï¼Œå¯ä»¥å‰ç¼€å’Œï¼Œä¹Ÿå°±æ˜¯æŠŠç¬¬ä¸€ä¸ªè½¬ç§»ç»™å‰ç¼€å’ŒåŒ–ï¼›å¯¹äºç¬¬äºŒä¸ªè½¬ç§»ï¼Œè€ƒè™‘å‘ $(i+1,1)$ è¿™ä¸ªçŠ¶æ€è½¬ç§» $\sum _jf_{i,j}$ ï¼Œç„¶ååœ¨æ¯ä¸ª $(i+1,j)$ å¤„å‡æ‰ $(i,j-1)$ ã€‚åŸå› æ˜¯æ ¹æ®ç¬¬äºŒä¸ªè½¬ç§»ï¼Œå¯¹äº $i$ è€Œè¨€ï¼Œåªæœ‰ $\geq j$  çš„ $f_{i,p}$ æ‰èƒ½äº§ç”Ÿè´¡çŒ®ï¼Œæ‰€ä»¥ç›¸å½“äºæå‰å‡æ‰äº†è¿™ä¸€éƒ¨åˆ†ã€‚  </p>
<p>è½¬ç§»çš„æ—¶å€™ä¿è¯ä¸è®© $j=k$ å‚ä¸è¿›æ¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¿è¯åˆæ³•ã€‚</p>
<p>æ‰¯å›æ­£é¢˜ã€‚å‘ç°è®¡ç®—è¿™ä¸ªä¸œè¥¿ï¼Œå¦‚æœä¸€å¼€å§‹åœ¨ $s$ ä¸­ç¡®å®šäº† $f_0$ çš„å“ªä¸ªçŠ¶æ€åˆæ³•ï¼Œå°±åº”å½“å¯¹å…¶è®¾åˆå€¼ã€‚å…·ä½“çš„ï¼Œä»¥å·¦åŠè¾¹ä¸ºä¾‹ï¼Œæ‰¾å‡ºå·¦åŠè¾¹æœ€é•¿çš„è¿ç»­æ®µé•¿åº¦ä¸º $l$ï¼Œé‚£ä¹ˆ $f_{0,l}$ åˆå€¼ä¾¿åº”è¯¥ä¸º $1$ ã€‚æ•´ä¸ªè®¡ç®—è¿‡ç¨‹ç›¸å½“äºä» $s_1$ å‘å·¦å»¶ä¼¸å’Œä» $s_m$ å‘å³å»¶ä¼¸ã€‚æœ€åçš„åˆå¹¶æ˜¾ç„¶æ˜¯ä¸€ä¸ªå·ç§¯çš„å½¢å¼ã€‚</p>
<p>3ã€$s$ ä¸­ä¸å«æœ‰é‡å¤å…ƒç´ ã€‚</p>
<p>ä¸€ä¸ªå¾ˆç¥ä»™çš„ç‚¹ã€‚è€ƒè™‘ä¸å«é‡å¤å…ƒç´ ï¼Œå¯ä»¥è½¬åŒ–æˆéšä¾¿ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„<strong>é</strong> $k-$å¥½åºåˆ—ï¼Œå«æœ‰å¤šå°‘ $m-$å¥½åºåˆ—çš„æ–¹æ¡ˆæ•°ï¼Œé™¤ä»¥ $A_{k}^m$ã€‚å› ä¸ºæ˜¾ç„¶æ¯ä¸ªåºåˆ—éƒ½æ˜¯ç­‰ä»·çš„ï¼Œæ‰€ä»¥å¯ä»¥å¦‚æ˜¯è½¬åŒ–ã€‚è¿™ä¸ªä¸œè¥¿çš„ $dp$ è¿‡ç¨‹å’Œ <code>2ã€</code> ä¸­çš„å·®ä¸å¤šï¼Œä¹Ÿæ˜¯ã€Œè®° $f_{i,j}$ è¡¨ç¤ºå·²ç»è€ƒè™‘äº† $i$ ä¸ªæ•°ï¼Œæœ«å°¾å­˜åœ¨ä¸€ä¸ª $j$ è¿ç»­æ®µçš„åºåˆ—æ’åˆ—æ•°ã€â€”â€”ä¸åŒç‚¹åœ¨äºè¿™ä¸ª $dp$ è®°å½•çš„æ˜¯ä¸ªæ•°ï¼Œé‚£ä¹ˆå†æ‹¿ä¸€ä¸ªæ•°ç»„ï¼Œå’Œ $f$ ä¸€æ ·è½¬ç§»ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½éœ€è¦åŠ ä¸Š $f$ å¯¹åº”çš„æ–¹æ¡ˆæ•°ï¼Œè¡¨ç¤ºè®¡ç®—å¤šæ¬¡ã€‚</p>
<p>ç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚æ³¨æ„å¯èƒ½å­˜åœ¨ $k&gt;n$ çš„sbæƒ…å†µï¼Œåˆ¤æ‰å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> K = <span class="number">410</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">30010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1000000007</span> ;</span><br><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line">ll X[N] ;</span><br><span class="line">ll Y[N] ;</span><br><span class="line">ll I[N] ;</span><br><span class="line">ll fac[N] ;</span><br><span class="line">ll g[N][K] ;</span><br><span class="line">ll f[N][K] ;</span><br><span class="line"><span class="keyword">int</span> buc[N] ;</span><br><span class="line"><span class="keyword">int</span> n, k, m ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(ll &amp;x, ll y)</span></span>&#123;</span><br><span class="line">    (x += y) %= P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dec</span><span class="params">(ll &amp;x, ll y)</span></span>&#123;</span><br><span class="line">    (x -= y) %= P ;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) x += P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">expow</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            (res *= a) %= P ;</span><br><span class="line">        (a *= a) %= P ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = <span class="number">0</span>, j = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!buc[base[i]]) now ++ ; buc[base[i]] ++ ;</span><br><span class="line">        <span class="keyword">while</span> (buc[base[j]] &gt; <span class="number">1</span>) -- buc[base[j ++]] ;</span><br><span class="line">        <span class="keyword">if</span> (i - j + <span class="number">1</span> == k &amp;&amp; now == k) <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(buc, <span class="number">0</span>, <span class="keyword">sizeof</span>(buc)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (buc[base[i]]) <span class="keyword">return</span> <span class="number">1</span> ; <span class="keyword">else</span> ++ buc[base[i]] ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">dp1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    g[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ; ll ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p, q, j = <span class="number">0</span> ; j &lt; k ; ++ j)&#123;</span><br><span class="line">            p = f[i][j] * (k - j) % P ;</span><br><span class="line">            q = g[i][j] * (k - j) % P ;</span><br><span class="line">            <span class="keyword">if</span> (j + <span class="number">1</span> &lt; k)&#123;</span><br><span class="line">                add(f[i + <span class="number">1</span>][j + <span class="number">1</span>], p) ;</span><br><span class="line">                add(g[i + <span class="number">1</span>][j + <span class="number">1</span>], q) ;</span><br><span class="line">                dec(f[i + <span class="number">1</span>][j + <span class="number">2</span>], p) ;</span><br><span class="line">                dec(g[i + <span class="number">1</span>][j + <span class="number">2</span>], q) ;</span><br><span class="line">            &#125;</span><br><span class="line">            add(f[i + <span class="number">1</span>][<span class="number">1</span>], f[i][j]) ;</span><br><span class="line">            add(g[i + <span class="number">1</span>][<span class="number">1</span>], g[i][j]) ;</span><br><span class="line">            dec(f[i + <span class="number">1</span>][j + <span class="number">1</span>], f[i][j]) ;</span><br><span class="line">            dec(g[i + <span class="number">1</span>][j + <span class="number">1</span>], g[i][j]) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; k ; ++ j)&#123;</span><br><span class="line">            add(g[i + <span class="number">1</span>][j], g[i + <span class="number">1</span>][j - <span class="number">1</span>]) ;</span><br><span class="line">            add(f[i + <span class="number">1</span>][j], f[i + <span class="number">1</span>][j - <span class="number">1</span>]) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = m ; j &lt; k ; ++ j)</span><br><span class="line">            add(f[i + <span class="number">1</span>][j], g[i + <span class="number">1</span>][j]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; k ; ++ i) add(ret, f[n][i]) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp2</span><span class="params">(ll res[N], ll s[N][K], <span class="keyword">int</span> mk)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(buc, <span class="number">0</span>, <span class="keyword">sizeof</span>(buc)) ;</span><br><span class="line">    <span class="keyword">if</span> (!mk)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (!buc[base[i]]) buc[base[i]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">else</span> &#123; s[<span class="number">0</span>][i - <span class="number">1</span>] = <span class="number">1</span> ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = m ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">            <span class="keyword">if</span> (!buc[base[i]]) buc[base[i]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">else</span> &#123; s[<span class="number">0</span>][m - i] = <span class="number">1</span> ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n - m ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t, j = <span class="number">1</span> ; j &lt; k ; ++ j)&#123;</span><br><span class="line">            t = s[i][j] * (k - j) % P ;</span><br><span class="line">            <span class="keyword">if</span> (j + <span class="number">1</span> &lt; k)&#123;</span><br><span class="line">                add(s[i + <span class="number">1</span>][j + <span class="number">1</span>], t) ;</span><br><span class="line">                dec(s[i + <span class="number">1</span>][j + <span class="number">2</span>], t) ;</span><br><span class="line">            &#125;</span><br><span class="line">            add(s[i + <span class="number">1</span>][<span class="number">1</span>], s[i][j]) ;</span><br><span class="line">            dec(s[i + <span class="number">1</span>][j + <span class="number">1</span>], s[i][j]) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; k ; ++ j)&#123;</span><br><span class="line">            add(s[i + <span class="number">1</span>][j], s[i + <span class="number">1</span>][j - <span class="number">1</span>]) ;</span><br><span class="line">            add(res[i + <span class="number">1</span>], s[i + <span class="number">1</span>][j]) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = I[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">int</span> mx = max(n, max(k, m)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= mx + <span class="number">1</span> ; ++ i)</span><br><span class="line">        fac[i] = fac[i - <span class="number">1</span>] * (ll)i % P ;</span><br><span class="line">    I[mx + <span class="number">1</span>] = expow(fac[mx + <span class="number">1</span>], P - <span class="number">2</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = mx ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">        I[i] = (ll)(i + <span class="number">1</span>)* I[i + <span class="number">1</span>] % P ;</span><br><span class="line">    ans = expow(k, n - m) * (ll)(n - m + <span class="number">1</span>) % P ;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; ans &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">if</span> (check()) <span class="keyword">return</span> <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>, <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (check2())&#123; <span class="comment">//there is a same pair of number</span></span><br><span class="line">        X[<span class="number">0</span>] = Y[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">        dp2(X, f, <span class="number">0</span>) ; dp2(Y, g, <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n - m ; ++ i)</span><br><span class="line">            dec(ans, X[i] * Y[n - m - i] % P) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> dec(ans, dp1() * I[k] % P * fac[k - m] % P) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>atcoder</category>
      </categories>
      <tags>
        <tag>æ€ç»´é¢˜/è®¡æ•°</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘CF OTC2020 A~F Sol</title>
    <url>/2020/03/05/Ozon-Tech-Challenge-2020/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç¢äºè‡ªèº«å®åŠ›ï¼Œåªèƒ½æ•´ç†åˆ° $\rm F$ äº†233.</p>
<a id="more"></a>
<h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><blockquote>
<p>ç»™å®šä¸¤ä¸ªå‡ä¸å«ç›¸åŒæ•°å­—çš„åºåˆ—ï¼Œåˆ†åˆ«é‡æ’ä¹‹åä½¿å¾— $\forall i,a_i+b_i$ å‡ä¸åŒã€‚</p>
</blockquote>
<p>æ’åºã€‚æ’åºçš„æ­£ç¡®æ€§åœ¨äºä»¤ $c_i=a_i+b_i$ï¼Œ$\forall i&gt;1,c_i&gt;c_{i-1}$ ä¿è¯äº†ä¸åŒã€‚</p>
<h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªæ‹¬å·åºåˆ—ï¼Œæ±‚è‡³å°‘åˆ é™¤å¤šå°‘æ¬¡ä½¿å¾—åŸåºåˆ—ä¸­ä¸å­˜åœ¨ã€Œå¥½å­åºåˆ—ã€å¹¶è¾“å‡ºåˆ é™¤æ–¹æ¡ˆï¼Œå¦‚æœæœ¬èº«å°±æ²¡æœ‰ã€Œå¥½å­åºåˆ—ã€åˆ™è¾“å‡º $0$ã€‚</p>
<p>ã€Œå¥½å­åºåˆ—ã€çš„å®šä¹‰æ˜¯é•¿åº¦ä¸º $2k$ ä¸” $1\sim k$ éƒ½ä¸º <code>(</code> ï¼Œ$k+1\sim 2k$ éƒ½æ˜¯ <code>)</code> çš„å­åºåˆ—ã€‚åˆ é™¤æ“ä½œè§„å®šæ¯æ¬¡åªèƒ½é€‰æ‹©åŸåºåˆ—ä¸­çš„ä¸€ä¸ªã€Œå¥½å­åºåˆ—ã€å¹¶åˆ é™¤å…¶ä¸­çš„å…¨éƒ¨å…ƒç´ ã€‚</p>
<p>$n\leq 5000$</p>
</blockquote>
<p>å‘ç°æ˜¾ç„¶è‡³å°‘åˆ é™¤ä¸€æ¬¡å³å¯ã€‚é‚£ä¹ˆåªéœ€è¦è®°å½•æ¯ä¸ªå·¦æ‹¬å·å’Œå³æ‹¬å·çš„ä½ç½®ï¼Œæ‰¾ä¸€ä¸ªä½ç½® $p$ ä½¿å¾—å‰é¢çš„å·¦æ‹¬å·å’Œå³é¢çš„å³æ‹¬å·ä¸€æ ·å¤šä¸”æœ€å¤§ã€‚$0$ çš„æƒ…å†µæ˜¯å­˜åœ¨æŸä¸ª $p$ ä½¿å¾— $p$ å‰ç¼€éƒ½æ˜¯ <code>)</code> å¹¶ä¸” $p+1$ åç¼€éƒ½æ˜¯ <code>(</code> ã€‚åˆ¤æ–­ä¸€ä¸‹å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; (s + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">'('</span>) l[++ l[<span class="number">0</span>]] = i, sum[i] = sum[i - <span class="number">1</span>] ;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">')'</span>) r[++ r[<span class="number">0</span>]] = i, sum[i] = sum[i - <span class="number">1</span>] + <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (sum[i] == i &amp;&amp; sum[i] == sum[n]) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"0"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">int</span> L = <span class="number">1</span>, R = r[<span class="number">0</span>] ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (l[L] &gt; r[R]) <span class="keyword">break</span> ; ++ ans;</span><br><span class="line">        stk[++ tp] = l[L], stk[++ tp] = r[R] ;</span><br><span class="line">        L ++ ; R -- ; <span class="keyword">if</span> (L &gt; l[<span class="number">0</span>] || !R) <span class="keyword">break</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(stk + <span class="number">1</span>, stk + tp + <span class="number">1</span>) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="built_in">endl</span> &lt;&lt; ans * <span class="number">2</span> &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= ans * <span class="number">2</span> ; ++ i) <span class="built_in">cout</span> &lt;&lt; stk[i] &lt;&lt; <span class="string">" "</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote>
<p>ç»™å®šåºåˆ— $a_i$ï¼Œæ±‚ $\prod _{1\leq i&lt;j\leq n}|a_i-a_j|\bmod m$ ã€‚</p>
<p>$1\leq n\leq 10^5,m\leq 1000$ ã€‚</p>
</blockquote>
<p>å¦™å¦™é¢˜ã€‚å‘ç°ç›´æ¥åšä¸å®¹æ˜“å¹¶ä¸” $m$ å¾ˆå°ï¼Œäºæ˜¯é€‰æ‹©è§‚å¯Ÿæ€§è´¨ã€‚è€ƒè™‘é¸½ç¬¼åŸç†ï¼Œå½“ $n&gt;m$ æ—¶ï¼Œå¿…æœ‰ä¸¤é¡¹ $a_i,a_j$ æ¨¡ $m$ åŒä½™ã€‚æ‰€ä»¥å¦‚æœ $n&gt;m$ ç­”æ¡ˆå°±æ˜¯ $0$ï¼Œå¦åˆ™æš´åŠ›å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i]) ;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; m) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"0"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">            (ans *= (LL)<span class="built_in">abs</span>(base[i] - base[j])) %= m ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><blockquote>
<p>äº¤äº’é¢˜ã€‚ç»™å®šä¸€ä¸ªæ ‘ï¼Œæ¯æ¬¡å¯ä»¥éšä¾¿è¯¢é—®ä¸¤ä¸ªç‚¹ $p,q$ çš„ $lca$ ã€‚åœ¨è¯¢é—®è‡³å¤š $\frac{n}{2}$ æ¬¡åæ‰¾å‡ºæ ‘çš„æ ¹ã€‚</p>
<p>$1\leq n\leq 1000$</p>
</blockquote>
<p>è€ƒè™‘ä»ä½•å¤„å…¥æ‰‹ã€‚å‘ç°å¯¹äºä¸€æ£µæ— æ ¹æ ‘ï¼Œæœ€å®¹æ˜“è¾¨åˆ«çš„å°±æ˜¯å¶å­ã€‚é‚£ä¹ˆåªéœ€è¦æ¯æ¬¡æ‰¾å‡ºä¸¤ä¸ªå½“å‰ $\deg$ ä¸º $1$ çš„ç‚¹ï¼Œè¯¢é—® $lca$ å¹¶åˆ é™¤å³å¯ã€‚è¿™æ ·æ¬¡æ•°ä¸€å®šæ˜¯ $\lfloor\frac{n}{2}\rfloor$ã€‚å¦‚æœ $p,q$ æœ‰ä¸€ä¸ªç‚¹ä¸ºæ ¹ï¼Œé‚£ä¹ˆå­˜åœ¨ä¸€ä¸ªæ˜¯ä¸¤ä¸€ä¸ªçš„ç¥–å…ˆï¼Œè¿™æ—¶è¾“å‡ºå³å¯ã€‚</p>
<p><del>è¿™è¿˜æ˜¯ç¬¬ä¸€æ¬¡åœ¨CFå†™äº¤äº’é¢˜233</del></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> ctn ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;E[N &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">int</span> deg[N] ;</span><br><span class="line"><span class="keyword">int</span> cnt, n ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"><span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v ;</span><br><span class="line">    next(cnt) = head[u] ;</span><br><span class="line">    head[u] = cnt ; ++ deg[v] ;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>.tie(<span class="number">0</span>) ; <span class="built_in">cout</span>.tie(<span class="number">0</span>) ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; <span class="keyword">int</span> u, v ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v) ;</span><br><span class="line">        add(u, v) ; add(v, u) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (deg[i] == <span class="number">1</span>) q.push(i) ;</span><br><span class="line">    <span class="keyword">while</span> (q.size() &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front() ; q.pop() ;</span><br><span class="line">        <span class="keyword">int</span> y = q.front() ; q.pop() ; <span class="keyword">int</span> w ;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"? "</span> &lt;&lt; x &lt;&lt; <span class="string">" "</span> &lt;&lt; y &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">        <span class="comment">//cout.flush() ;</span></span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; w ;</span><br><span class="line">        <span class="keyword">if</span> (w == x || w == y)&#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"! "</span> &lt;&lt; w &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">            <span class="built_in">cout</span>.flush() ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = head[x] ; i ; i = next(i))</span><br><span class="line">            <span class="keyword">if</span> ((-- deg[to(i)]) == <span class="number">1</span>) q.push(to(i)) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = head[y] ; i ; i = next(i))</span><br><span class="line">            <span class="keyword">if</span> ((-- deg[to(i)]) == <span class="number">1</span>) q.push(to(i)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"! "</span> &lt;&lt; q.front() &lt;&lt; <span class="built_in">endl</span> ;<span class="comment">// cout.flush() ; return 0 ;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><blockquote>
<p>æ„é€ ä¸€ä¸ªåºåˆ— $a$ æ»¡è¶³å¦‚ä¸‹ï¼š</p>
<p>1ã€é•¿åº¦ä¸º $n$ ã€‚</p>
<p>2ã€$\forall i, 1\leq a_i\leq 10^9$ ã€‚</p>
<p>3ã€$\forall i&gt;1,a_i&gt;a_{i-1}$ã€‚</p>
<p>4ã€æ»¡è¶³ $i&lt;j&lt;k$ ä¸” $a_i+a_j=a_k$ çš„ä¸‰å…ƒç»„ $(i,j,k)$ æ•°é‡æ°å¥½ä¸º $m$ã€‚</p>
<p>$n\leq 5000,m\leq 10^9$ ã€‚</p>
</blockquote>
<p>æ¯”è¾ƒè‡ªç„¶çš„æƒ³æ³•æ˜¯ä»å¤´å¼€å§‹å¡« $1,2,3\cdots$ï¼Œå› ä¸ºè¿™æ ·å®¹æ˜“å¡«ä¸”æ»¡è¶³æ¡ä»¶ã€‚åŒæ—¶å¯ä»¥å‘ç°ï¼Œè¿™ç§æ„é€ æ–¹å¼æ˜¯ä½¿å¾—æ¯ä¸ªä½ç½®ä½œä¸º $k$ æ—¶ï¼Œè´¡çŒ®ä¸‰å…ƒç»„æœ€å¤šçš„æ–¹å¼ï¼šç”±äºåºåˆ—æ»¡è¶³å•è°ƒæ€§ï¼Œæ‰€ä»¥ä¸€å®šä¸å­˜åœ¨å‰é¢çš„ $i,j$ å½¼æ­¤æœ‰äº¤ã€‚é‚£ä¹ˆå¯¹äºä¸€ä¸ª $a_k=k$ ä»–å¯ä»¥è´¡çŒ® $\lfloor \frac{k-1}{2}\rfloor$ çš„ç­”æ¡ˆã€‚</p>
<p>è€ƒè™‘å¦‚æœè¶…å‡º $m$ å¦‚ä½•å¤„ç†ã€‚å‡è®¾å½“å‰ç­”æ¡ˆè¶…å‡ºäº† $x$ ã€‚å¯¹äºä¸€ä¸ª $k$ ï¼ŒæŒ‰ç…§ä¸Šè¿°æ–¹å¼èƒ½å¤Ÿè´¡çŒ® $\lfloor \frac{k-1}{2}\rfloor$ çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆå¦‚æœæƒ³è¦åªè´¡çŒ® $\lfloor \frac{k-1}{2}\rfloor-x$ çš„ç­”æ¡ˆï¼Œå°±éœ€è¦è®©å…¶ä¸­çš„ $x$ å¯¹ $(i,j)$ æ— æ•ˆã€‚å…·ä½“çš„ï¼Œè€ƒè™‘ä»¤å½“å‰çš„ $k$ å˜ä¸º $k+2x$ ï¼Œé‚£ä¹ˆè€ƒè™‘å‰ $k-1$ ä¸ªæ•°é‡Œé¢æœ€å¤§çš„æ˜¯ $k-1$ ï¼Œåªèƒ½å»åŒ¹é… $2x+1$ï¼Œè¿™æ ·å°±ä¼šå°‘æ‰ $2x$ ä¸ªå¯ä»¥ç”¨çš„æ•°ï¼Œç­”æ¡ˆå˜æˆäº† $\lfloor\frac{k-1-2x}{2}\rfloor=\lfloor \frac{k-1}{2}\rfloor-x$ ã€‚</p>
<p>é‚£ä¹ˆè¡¥é½ $n$ ä¸ªæ•°ä¹Ÿå¾ˆç®€å•ã€‚åªéœ€è¦è€ƒè™‘å¦‚æœå½“å‰å¡«äº†çš„æœ€å¤§çš„æ•°æ˜¯ $j$ ï¼Œä» $10^9$ å‘ä¸‹æŒ‰ç…§ $2\cdot j$ çš„æ­¥é•¿é€’å‡å³å¯ã€‚ä¸éš¾è¯æ˜è¿™æ ·åšæ˜¯å¯¹çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">std</span> :: <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        ans[i] = i ; cnt += (i - <span class="number">1</span>) / <span class="number">2</span> ;</span><br><span class="line">        <span class="keyword">if</span> (cnt &gt;= m)&#123;</span><br><span class="line">            <span class="keyword">int</span> s = <span class="number">1000000000</span> ;</span><br><span class="line">            ans[i] += <span class="number">2</span> * (cnt - m) ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = n ; j &gt; i ; -- j)</span><br><span class="line">                ans[j] = (s -= (ans[i] + <span class="number">1</span>)) ;</span><br><span class="line">            gf = <span class="number">1</span> ; <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (gf)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[i]) ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="F"><a href="#F" class="headerlink" title="F"></a>F</h1><blockquote>
<p>ç»™å®š $n$ ä¸ªæ•°ã€‚æ¯æ¬¡å¯ä»¥é€‰æ‹©å°†ä¸€ä¸ªæ•° $+1$ æˆ– $-1$ ã€‚æ±‚è‡³å°‘å¤šå°‘æ¬¡ä½¿å¾—æ•´ä¸ªåºåˆ—çš„ $\gcd&gt;1$ ã€‚</p>
<p>$n\leq 10^5,a_i\leq 10^{12}$ ã€‚</p>
</blockquote>
<p>é¦–å…ˆæœ‰ä¸€ä¸ªç»“è®ºï¼Œå°±æ˜¯è‡³å¤šéœ€è¦ $O(\frac{n}{2})$ æ¬¡æ“ä½œå°±å¯ä»¥ä½¿å¾—æ•´ä¸ªåºåˆ—çš„ $\gcd&gt;1$ï¼Œå› ä¸ºæ°¸è¿œå¯ä»¥æŠŠ $2$ å½“åšå› å­ã€‚é‚£ä¹ˆå°±å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼Œè‡³å¤šåªä¼šæœ‰ $\frac{n}{2}$ ä¸ªæ•°ä¼šè¢«æ”¹æ‰ï¼Œé‚£ä¹ˆä¹Ÿå°±è¯´æ˜å¦‚æœéšæœºä¸€ä¸ªæ•°çš„è¯ï¼Œæœ‰ $\frac{1}{2}$ çš„æ¦‚ç‡ä¸ä¼šè¢«æ”¹ã€‚æ‰€ä»¥å¯ä»¥å°†æ•´ä¸ªåºåˆ— <code>shuffle</code> ä¸€ä¸‹å–å‰å‡ åä¸ªcheckä¸€ä¸‹å³å¯ã€‚</p>
<p>è¿˜æœ‰ï¼Œcfçš„è¯„æµ‹ç³»ç»Ÿæ˜¯windowsï¼Œ<code>rand()</code> åšç§å­çš„æ—¶å€™åªèƒ½æ‰“ä¹±å‰ $32767$ é¡¹ã€‚æ‰€ä»¥éœ€è¦ <code>mt19937</code> åšç§å­ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1000100</span> ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line">LL ans ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> pr[M] ;</span><br><span class="line">LL base[N] ;</span><br><span class="line"><span class="keyword">bool</span> chk[M] ;</span><br><span class="line"><span class="built_in">set</span> &lt;LL&gt; facs ;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt; M ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!chk[i]) pr[++ cnt] = i ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (pr[j] * i &gt;= M) <span class="keyword">break</span> ;</span><br><span class="line">            chk[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Ins</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt;= <span class="number">1</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (x % pr[i] == <span class="number">0</span>)&#123;</span><br><span class="line">            facs.insert(pr[i]) ;</span><br><span class="line">            <span class="keyword">while</span> (!(x % pr[i])) x /= pr[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) facs.insert(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">calc</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    LL ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        ret += base[i] &gt;= x ? min(base[i] % x, - (base[i] % x) + x) : x - base[i] ;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; ret &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    sieve() ; ans = n ;</span><br><span class="line">    random_device seed ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i]) ;</span><br><span class="line">    <span class="function">mt19937 <span class="title">gg</span><span class="params">(seed())</span></span>; shuffle(base + <span class="number">1</span>, base + n + <span class="number">1</span>, gg);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">30</span> &amp;&amp; i &lt;= n ; ++ i)</span><br><span class="line">        Ins(base[i]), Ins(base[i] + <span class="number">1</span>), Ins(base[i] - <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (LL res : facs) ans = min(ans, calc(res)) ; <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ </tag>
        <tag>æ€ç»´é¢˜/æ„é€ </tag>
        <tag>æ€ç»´é¢˜/éšæœºåŒ–</tag>
        <tag>æ€ç»´é¢˜/æ‰¾æ€§è´¨</tag>
        <tag>äº¤äº’é¢˜/å¾®å…ƒæ’•è£‚æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘ARC099 Sol</title>
    <url>/2020/03/04/ARC099/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä»atcoderæŸå¤©virtualçš„ä¸€åœºæ¯”èµ›ã€‚å‘ç°æ¯”èµ·ä¹‹å‰åšè¿‡çš„åœºæ¬¡ï¼Œä¼¼ä¹ $\rm A$ è¿˜æ˜¯æœ‰ç‚¹å¼±èœï¼Œ$\rm B$ è¿˜æ˜¯æœ‰ç‚¹å¥‡æ€ªï¼Œ$\rm C$ è¿˜æ˜¯æ¯”è¾ƒä¸­è§„ä¸­çŸ©<del>æ¯”è¾ƒä¸ä¼š</del> ï¼Œ$\rm D$ è¿˜æ˜¯ä¸å¾ˆä¼šâ€¦</p>
<p>é—®é¢˜ä¸å¤§.jpg</p>
<a id="more"></a>
<h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><blockquote>
<p>ç»™å®š $n,k$ ï¼Œä¸€ä¸ª $1\sim n$ çš„æ’åˆ— $\{a_n\}$ã€‚æ¯æ¬¡é€‰æ‹©ä¸€ä¸ªé•¿åº¦ä¸º $k$ çš„åŒºé—´ $[l,r]$ï¼Œå‘ä¸‹æ¨å¹³ä¸º $\min_{i=l}^r\{a_i\}$ ã€‚æ±‚æœ€å°‘å¤šå°‘æ¬¡æ“ä½œå¯ä»¥ä½¿å¾—æ‰€æœ‰å€¼ç›¸åŒã€‚</p>
<p>$n\leq 100,000$ </p>
</blockquote>
<p>å¾ˆå¤šäººå†™çš„æ¯”è¾ƒéº»çƒ¦ã€‚è¦å»æ‰«æ•´ä¸ª $\{a_n\}$ ã€‚ç„¶è€Œè¿™é¢˜ $n$ æ˜¯å¯ä»¥å¼€åˆ° $1e18$ çš„ã€‚</p>
<p>è€ƒè™‘ç”±äºæ‰€æœ‰æ•°ä¸ç›¸åŒï¼Œæ‰€ä»¥æœ€ä¼˜å†³ç­–ä¸€å®šæ˜¯ä»æœ€å°çš„é‚£ä¸ªä½ç½®å¼€å§‹æ‹“å±•ã€‚ä¹‹åæ¯æ¬¡é€‰æ‹©åŒºé—´ï¼Œå¿…ç„¶æ˜¯é€‰æ‹©ä¸€ä¸ªæœ€å¤šä¸ä¹‹å‰é‚£ä¸ªåŒºé—´ç›¸äº¤ä¸º $1$ ä¸ªå…ƒç´ çš„åŒºé—´å¼€å§‹ã€‚æ‰€ä»¥æœ€åç­”æ¡ˆå°±æ˜¯ $1+\lceil\frac{n-k}{k-1}\rceil$ã€‚è·Ÿ $\{a_n\}$ æ— å…³ã€‚</p>
<h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote>
<p>å®šä¹‰å‡½æ•° $\rm S(x)$ è¡¨ç¤º $x$ å„ä¸ªä½ä¸Šæ•°å­—ä¹‹å’Œã€‚æ±‚å‰ $k$ ä¸ªè¿™æ ·çš„ $n$ï¼š</p>
<script type="math/tex; mode=display">
\forall m>n,\frac{n}{\mathrm{S}(n)}\leq \frac{m}{\mathrm{S}(m)}</script><p>$k$ çš„èŒƒå›´â€¦$\geq 1$ã€‚</p>
</blockquote>
<p>é¦–å…ˆè¿™ä¸ªæ˜¯å¯ä»¥çŒœå‡ºä¸€éƒ¨åˆ†ç»“è®ºçš„ï¼Œå¤§æ¦‚å°±æ˜¯è€ƒè™‘å¦‚æœæ•°å­—é‡Œé¢ $9$ æ¯”è¾ƒå¤šçš„è¯è‚¯å®šä¼šæ¯”è¾ƒç¬¦åˆï¼Œå› ä¸ºè¿™æ · $\rm S$ å€¼å°±ä¼šæ˜¾ç„¶æ›´å¤§ã€‚å…¶æ¬¡ä¹Ÿæ˜¯å¯ä»¥æ‰“è¡¨çš„ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸ªé¢˜æœ¬è´¨ä¸Šä¸å­˜åœ¨è§„å¾‹ã€‚æ‰€ä»¥ä»¥ä¸Šä¸¤ç§æ–¹å¼å¯èƒ½ä¼šæŒ‚çš„å¾ˆæƒ¨ã€‚</p>
<p>è€ƒè™‘ä¸€ç§å¯è¡Œçš„æ„é€ æ–¹å¼ã€‚é¦–å…ˆçŸ¥é“ï¼Œ$1$ ä¸€å®šæ˜¯å¯è¡Œçš„ã€‚å¯¹äºæ¯ä¸ªå½“å‰çš„ $x$ ï¼Œé€‰æ‹©é‚£ä¸ªä½¿å¾— $y&gt;x$ ä¸” $\frac{y}{\rm S(y)}$ æœ€å°çš„ $y$ æ¥æ›¿ä»£å½“å‰çš„ $x$ ã€‚ä¸éš¾ç†è§£è¿™æ ·åšæ˜¯å¯è¡Œçš„ã€‚</p>
<p>é‚£å¤§æ¦‚è€ƒè™‘å¦‚ä½•å»è¯æ˜ç¬¬ä¸€ä¸ªæ€§è´¨ï¼Œæˆ–è€…ç¨å¾®å½¢å¼åŒ–ä¸€ç‚¹ï¼š</p>
<blockquote>
<p>å‡è®¾ $y$ æ˜¯ $&gt;x$ ä¸” $\frac{y}{\rm S(y)}$ æœ€å°çš„é‚£ä¸ª $y$ï¼Œä¸”å‡è®¾ä»é«˜ä½åˆ°ä½ä½ï¼Œ$x$ å’Œ $y$ ç¬¬ä¸€æ¬¡å‡ºç°ä¸åŒçš„åœ°æ–¹æ˜¯<strong>ä»ä½åˆ°é«˜çš„</strong> ç¬¬ $p$ ä½ï¼Œé‚£ä¹ˆä¼šæœ‰ $y$ çš„ä»ä½åˆ°é«˜ $1\sim p$ ä½å‡ä¸º $9$ ã€‚ </p>
</blockquote>
<p>è¯æ˜æ—¶è€ƒè™‘å¦‚ä¸‹ï¼š</p>
<p>1ã€å¯¹äº $1\sim p-1$ ä½çš„è¯æ˜æ˜¯ä¸éš¾çš„ã€‚è€ƒè™‘å‡è®¾ $y$ ä¸ç¬¦åˆä¸Šè¿°è§„åˆ™ï¼Œé‚£ä¹ˆè®¾å‡ºä¸€ä¸ª $yâ€™$ ï¼Œå…¶ä¸­ $1\sim p-1$ å‡æ˜¯ $9$ ï¼Œä¸” $yâ€™$ çš„ç¬¬ $p$ ä½æ˜¯ $y$ çš„ç¬¬ $p$ ä½ $-1$ çš„æ•°å€¼ã€‚é‚£ä¹ˆå¯ä»¥çŸ¥é“ $x\leq yâ€™&lt;y$ ä¸” $\mathrm{S}(yâ€™)\geq \mathrm S(y)$ ã€‚è¿™æ ·çš„è¯ $\frac{y}{\mathrm S(y)}&gt;\frac{yâ€™}{\mathrm S(yâ€™)}$ ä¸ $y$ çš„å®šä¹‰çŸ›ç›¾ã€‚æ‰€ä»¥ $1\sim p-1$ å‡ä¸º $9$ã€‚</p>
<p>2ã€å†è€ƒè™‘ç¬¬ $p$ ä½ã€‚è®¾ $y$ çš„ç¬¬ $p$ ä½å€¼ä¸º $s$ï¼Œè®¾ $yâ€™=y-10^{p-1}\cdot s$ ï¼Œé‚£ä¹ˆæœ‰</p>
<script type="math/tex; mode=display">
\frac{y}{\mathrm S(y)}=\frac{y'+10^{p-1}s}{\mathrm S(y')+s}</script><p>é‚£ä¹ˆè€ƒè™‘æ­¤æ—¶ $yâ€™$ ä¸å˜ï¼Œç­‰å¼å³è¾¹æ˜¯ä¸€ä¸ªå‡¹å‡½æ•°(å…ˆä¸è€ƒè™‘æ€ä¹ˆå‡¹)ï¼Œåœ¨ $s=9$ æˆ–è€… $s=0$ æ—¶å–å¾—æœ€å€¼ã€‚æ ¹æ®å®šä¹‰å¯çŸ¥æ­¤å¤„åº”è¯¥é€‰æ‹© $s=9$ ï¼ˆå› ä¸º $y$ çš„ç¬¬ $p$ ä½è‡³å°‘è¦æ¯” $x$ çš„ç¬¬ $p$ ä½å¤§ $1$ï¼‰</p>
<hr>
<p>ç»¼ä¸Šï¼Œå¯çŸ¥åç¼€å¿…ç„¶æ˜¯æŸäº› $999â€¦999$ çš„å½¢å¼ã€‚ä»ä¸ªä½æ•°å‘ä¸Šæ¨å°±å¥½äº†ã€‚å¤æ‚åº¦åœ¨ $\Omega(n)\sim O(n\log n)$ å·¦å³ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans ;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> base = <span class="number">1</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">s</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ; <span class="keyword">long</span> <span class="keyword">long</span> y = x ;</span><br><span class="line">    <span class="keyword">while</span> (x) ret += (x % <span class="number">10l</span>l), x /= <span class="number">10l</span>l ;</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1.0</span> * y) / (<span class="number">1.0</span> * ret) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">while</span> (n --)&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (s(ans + base) &gt; s(ans + base * <span class="number">10l</span>l))</span><br><span class="line">                base *= <span class="number">10l</span>l ; <span class="keyword">else</span> <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        ans += base ;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote>
<p>ç»™å®šä¸€å¼ å›¾ã€‚æ±‚å°†è¿™å¼ å›¾åˆ†æˆä¸¤ä¸ªå®Œå…¨å­å›¾åï¼Œæœ€å°‘ä¼šæœ‰å¤šå°‘æ¡è¾¹çš„ç«¯ç‚¹å±äºåŒä¸€ä¸ªå®Œå…¨å­å›¾ã€‚</p>
<p>$n\leq 700$</p>
</blockquote>
<p>ä¸€é“æ¯”è¾ƒå¦™çš„é¢˜ã€‚é¦–å…ˆè€ƒè™‘å»ºå‡ºè¡¥å›¾æ¥ï¼Œé‚£ä¹ˆå‘ç°ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªç‚¹è¿é€šï¼Œå°±è¯´æ˜ä¸èƒ½åˆ†åœ¨ä¸€ä¸ªå­å›¾é‡Œé¢ï¼Œæ°å¥½æ˜¯äºŒåˆ†å›¾æŸ“è‰²çš„æµç¨‹ã€‚</p>
<p>ä¹‹åè€ƒè™‘æŒ‰è¡¥å›¾çš„è¿é€šå— $dp$ã€‚æ³¨æ„åˆ°å¦‚æœè¡¥å›¾ä¸­è¿é€šå— $A$ å’Œ $B$ ä¸è¿é€šï¼Œè¯´æ˜åŸå›¾ä¸­æ‰€æœ‰ç‚¹éƒ½è¿é€šã€‚æ‰€ä»¥æ ¹æœ¬ä¸éœ€è¦è€ƒè™‘è¿é€šå—ä¹‹é—´çš„è¿è¾¹ã€‚å…·ä½“çš„ï¼Œè®¾çŠ¶æ€ $f_{i,j}$ è¡¨ç¤ºè€ƒè™‘äº†å‰ $i$ ä¸ªè¿é€šå—ï¼Œæ˜¯å¦å­˜åœ¨äºŒåˆ†å›¾é›†åˆçš„æŸä¸€éƒ¨ï¼ˆå·¦éƒ¨orå³éƒ¨ï¼‰å¤§å°æ˜¯ $j$ ã€‚æ ¹æ®å‰é¢çš„æ€§è´¨è¿™å°±æ˜¯ä¸ªèƒŒåŒ…ã€‚æ‰€ä»¥ <code>bitset</code> ä¼˜åŒ–è½¬ç§»ä¸€ä¸‹å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;E[N * N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> ctn ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> nienie ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> clr[N] ;</span><br><span class="line"><span class="keyword">int</span> cnt[<span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"><span class="keyword">bool</span> A[N][N] ;</span><br><span class="line"><span class="built_in">bitset</span> &lt;N * N&gt; ans ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    to(++ ctn) = y ;</span><br><span class="line">    next(ctn) = head[x] ;</span><br><span class="line">    head[x] = ctn ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    vis[x] = <span class="number">1</span> ; clr[x] = c ; cnt[c] ++ ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))</span><br><span class="line">        <span class="keyword">if</span> (!vis[to(k)]) dfs(to(k), c ^ <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (clr[to(k)] == c) <span class="keyword">return</span> nienie = <span class="number">1</span>, <span class="keyword">void</span>() ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * (x - <span class="number">1</span>) + (n - x) * (n - x - <span class="number">1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; ans[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">int</span> u, v ; res = <span class="number">1000000000</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v) ;</span><br><span class="line">        A[u][v] = A[v][u] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (!A[i][j] &amp;&amp; (i ^ j)) add(i, j) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])&#123;</span><br><span class="line">            cnt[<span class="number">0</span>] = cnt[<span class="number">1</span>] = <span class="number">0</span> ; dfs(i, <span class="number">0</span>) ;</span><br><span class="line">            ans = (ans &lt;&lt; cnt[<span class="number">0</span>]) | (ans &lt;&lt; cnt[<span class="number">1</span>]) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (nienie) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (ans[i]) res = min(res, calc(i)) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cout</span> &lt;&lt; res / <span class="number">2</span> &lt;&lt; <span class="built_in">endl</span>, <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªä¸‹æ ‡èŒƒå›´åœ¨ $[-\infty,\infty]$ çš„æ•°ç»„ã€‚ä¸€å¼€å§‹æŒ‡é’ˆåœ¨ $0$ å¤„ã€‚ç»™å®šä¸€æ®µæ“ä½œåºåˆ—ã€‚æ±‚æœ‰å¤šå°‘ä¸ªå­åºåˆ—çš„æ“ä½œç»“æœç­‰ä»·äºæ•´ä¸ªåºåˆ—çš„æ“ä½œç»“æœã€‚æ“ä½œæœ‰å››ç§ï¼Œå·¦ç§»/å³ç§»/æŸä¸ªä½ç½®$+1$/æŸä¸ªä½ç½®$-1$ ã€‚</p>
<p>$1\leq n\leq 250,000$</p>
</blockquote>
<p>ä¸€æ‹¿åˆ°é¢˜é¦–å…ˆè€ƒè™‘ $dp$ ï¼Œå‘ç° $dp$ ä¸æ˜¯å¾ˆå¯åšâ€¦</p>
<p>äºæ˜¯å°±å‘ç°ï¼Œç±»ä¼¼è¿™ç§é¢˜ç›®å¯ä»¥ä½¿ç”¨å“ˆå¸Œã€‚å››ç§æ“ä½œåˆ†åˆ«å¯¹åº” $\times base^{-1}$ã€$\times base$ã€$+base$ã€$-base$ ã€‚</p>
<p>è€ƒè™‘è¿™æ ·åšå¦‚ä½•å»æ±‚æŸä¸€æ®µçš„å“ˆå¸Œå€¼ã€‚æ™®é€šçš„æ±‚æ³•åŸç†å¦‚ä¸‹ï¼š</p>
<p>å¯¹äºæ¯ä¸ª $p$ ï¼Œæˆªæ­¢åˆ° $p$ çš„å“ˆå¸Œå€¼ï¼Œå¦‚æœå°† $x$ çœ‹åš $base$ çš„ä¸€ä¸ªç­‰ä»·ï¼Œé‚£ä¹ˆå°±æ˜¯æ˜¯</p>
<script type="math/tex; mode=display">
\sum_{i=1}^ps_ix^{p-i}</script><p>è€ƒè™‘å°†ä¸Šå¼è®°ä½œ $o(p)$ ã€‚åˆ™ç‰‡æ®µ $[l,r]$ çš„å“ˆå¸Œå€¼å¯ä»¥å¦‚æ­¤å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
&o(r)-o(l-1)\times x^{r-l+1}\\
=&\sum_{i=1}^rs_ix^{r-i}-x^{r-l+1}\sum_{i=1}^{l-1}s_ix^{l-i-1}\\
=&\sum_{i=1}^rs_ix^{r-i}-\sum_{i=1}^{l-1}s_ix^{r-i}\\
=&\sum_{i=1}^rs_ix^{r-i}-\sum_{i=1}^{l-1}s_ix^{r-i}\\
=&\sum_{i=l}^rs_ix^{r-i}\\
=&\sum_{i=1}^{t}s_ix^{t-i}\quad (t=r-l+1)
\end{aligned}</script><p>è€ƒè™‘å¦‚æœæ•´ä¸ªä¸²çš„å“ˆå¸Œå€¼ä¸º $q$ï¼Œé‚£ä¹ˆéœ€è¦ç»Ÿè®¡çš„æ˜¯ $o(r)-o(l-1)\cdot x^{r-l+1}=q$ ã€‚è€ƒè™‘ä»å‰è‡³åç”¨ $map$ å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚ç”±äºä¸çŸ¥é“å³ç«¯ç‚¹çš„ä¿¡æ¯ï¼Œéœ€è¦å¯¹åŸå¼è¿›è¡Œå˜å½¢ï¼Œå³ï¼š</p>
<script type="math/tex; mode=display">
\frac{q+o(r)}{x^r}=\frac{o(l-1)}{x^{l-1}}</script><p>è¿™æ ·å°±å¯ä»¥åšåˆ° $l,r$ æ— å…³äº†ã€‚éšä¾¿é€‰å‰ç¼€æˆ–è€…åç¼€ç»Ÿè®¡å°±å¥½äº†ã€‚</p>
<p>ä½†æ˜¯æ³¨æ„åˆ°æœ¬é¢˜æœ‰ä¸ªé¢å¤–é™åˆ¶ï¼Œæœ€ååªéœ€è¦ç»“æœç›¸åŒè€Œä¸éœ€è¦æŒ‡é’ˆä½ç½®ç›¸åŒã€‚æ‰€ä»¥éœ€è¦ç¨å¾®å¤„ç†ä¸€ä¸‹å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mkp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pll pair<span class="meta-string">&lt;LL, LL&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL B1 = <span class="number">237l</span>l ;</span><br><span class="line"><span class="keyword">const</span> LL B2 = <span class="number">637l</span>l ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300010</span> ;</span><br><span class="line"><span class="keyword">const</span> LL P1 = <span class="number">998244353</span> ;</span><br><span class="line"><span class="keyword">const</span> LL P2 = <span class="number">1004535809</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line">LL ans ;</span><br><span class="line"><span class="keyword">char</span> s[N] ;</span><br><span class="line">LL I1, I2 ;</span><br><span class="line">LL g[N][<span class="number">2</span>] ;</span><br><span class="line">LL S[N], T[N] ;</span><br><span class="line"><span class="built_in">map</span> &lt;pll, LL&gt; buc ;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">expow</span><span class="params">(LL a, LL b, LL p)</span></span>&#123;</span><br><span class="line">    LL ret = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            (ret *= a) %= p ;</span><br><span class="line">        (a *= a) %= p ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; (s + <span class="number">1</span>) ;</span><br><span class="line">    g[<span class="number">0</span>][<span class="number">0</span>] = g[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1l</span>l ;</span><br><span class="line">    I1 = expow(B1, P1 - <span class="number">2</span>, P1) ;</span><br><span class="line">    I2 = expow(B2, P2 - <span class="number">2</span>, P2) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">'-'</span>)&#123;</span><br><span class="line">            g[i][<span class="number">0</span>] = g[i - <span class="number">1</span>][<span class="number">0</span>] ;</span><br><span class="line">            g[i][<span class="number">1</span>] = g[i - <span class="number">1</span>][<span class="number">1</span>] ;</span><br><span class="line">            S[i] = (S[i - <span class="number">1</span>] - g[i][<span class="number">0</span>] + P1) % P1 ;</span><br><span class="line">            T[i] = (T[i - <span class="number">1</span>] - g[i][<span class="number">1</span>] + P2) % P2 ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">'+'</span>)&#123;</span><br><span class="line">            g[i][<span class="number">0</span>] = g[i - <span class="number">1</span>][<span class="number">0</span>] ;</span><br><span class="line">            g[i][<span class="number">1</span>] = g[i - <span class="number">1</span>][<span class="number">1</span>] ;</span><br><span class="line">            S[i] = (S[i - <span class="number">1</span>] + g[i][<span class="number">0</span>]) % P1 ;</span><br><span class="line">            T[i] = (T[i - <span class="number">1</span>] + g[i][<span class="number">1</span>]) % P2 ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">'&lt;'</span>)&#123;</span><br><span class="line">            g[i][<span class="number">0</span>] = g[i - <span class="number">1</span>][<span class="number">0</span>] * I1 % P1 ;</span><br><span class="line">            g[i][<span class="number">1</span>] = g[i - <span class="number">1</span>][<span class="number">1</span>] * I2 % P2 ;</span><br><span class="line">            S[i] = S[i - <span class="number">1</span>] ; T[i] = T[i - <span class="number">1</span>] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">'&gt;'</span>)&#123;</span><br><span class="line">            g[i][<span class="number">0</span>] = g[i - <span class="number">1</span>][<span class="number">0</span>] * B1 % P1 ;</span><br><span class="line">            g[i][<span class="number">1</span>] = g[i - <span class="number">1</span>][<span class="number">1</span>] * B2 % P2 ;</span><br><span class="line">            S[i] = S[i - <span class="number">1</span>] ; T[i] = T[i - <span class="number">1</span>] ;</span><br><span class="line">        &#125;</span><br><span class="line">        ++ buc[mkp(S[i], T[i])] ;</span><br><span class="line">    &#125;</span><br><span class="line">    ++ buc[mkp(<span class="number">0</span>, <span class="number">0</span>)] ; LL x, y ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line">        buc[mkp(S[i] , T[i])] -- ;</span><br><span class="line">        x = (S[i] + S[n] * g[i][<span class="number">0</span>] % P1) % P1 ;</span><br><span class="line">        y = (T[i] + T[n] * g[i][<span class="number">1</span>] % P2) % P2 ;</span><br><span class="line">        ans += buc[mkp(x, y)] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>atcoder</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ </tag>
        <tag>å­—ç¬¦ä¸²/å“ˆå¸Œ</tag>
        <tag>åŠ¨æ€è§„åˆ’/èƒŒåŒ…æ¨¡å‹</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘CodeForces Round#625</title>
    <url>/2020/03/02/CFround625/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚æ˜¯èµ›æ—¶æ•´ç†ï¼Ÿä½†æ˜¯èµ›æ—¶å‘æŒ¥çš„ä¸€ç‚¹ä¹Ÿä¸å¥½â€¦ç¬¬äºŒå¤©æ—©ä¸Šä¸€èµ·æ¥å°±Aæ‰äº†èµ›æ—¶æ²¡Açš„ä¸¤ä¸ªé¢˜â€¦</p>
<p>æ€»ç»“ï¼šè¿˜æ˜¯å¤ªèœã€‚</p>
<p>æ²¡æ•´ç†1Eå’Œ1Fã€‚é¡ºåºæŒ‰ç…§Div2çš„é¡ºåºå†™çš„â€”â€”</p>
<a id="more"></a>
<h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><blockquote>
<p>ç»™å®šä¸¤ä¸ª $01$ ä¸²ã€‚è®¾ç»™æ¯ä¸ªä½ç½®ä¸€ä¸ªæ­£æ•´æ•°æƒ $p_i$ ï¼Œæƒè¢«ç®—åˆ°è´¡çŒ®é‡Œå½“ä¸”ä»…å½“å¯¹åº”ä½ç½®ä¸º <code>true</code> ã€‚è¦æ±‚ç¬¬ä¸€ä¸ªä¸²çš„æƒå’Œè¦ä¸¥æ ¼å¤§äºç¬¬äºŒä¸²ã€‚æ„é€ è¿™æ ·çš„ $p_i$ ï¼Œæ±‚ $\min\{\max_{i=1}^n\{p_i\}\}$ ï¼Œæˆ–è€…è¾“å‡ºä¸å¯èƒ½ã€‚</p>
</blockquote>
<p>ç­¾åˆ°é¢˜ã€‚æ„Ÿè§‰å¯èƒ½ç›´æ¥æ”¾ä»£ç æ¯”å˜´å·´æ›´å¥½ç”¨ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">cin</span> &gt;&gt; b[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">cin</span> &gt;&gt; c[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (c[i] &gt; b[i]) ++ t1 ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (c[i] &lt; b[i]) ++ t2 ;</span><br><span class="line">    <span class="keyword">if</span> (!t2 || t1 == n) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ;</span><br><span class="line">    t1 ++ ; <span class="built_in">cout</span> &lt;&lt; (<span class="keyword">int</span>)<span class="built_in">ceil</span>(<span class="number">1.0</span> * t1 / (<span class="number">1.0</span> * t2)) &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªåºåˆ— $\{a_n\}$ ï¼Œè¦æ±‚é€‰å‡ºæ¥ä¸€ä¸ªä¸‹æ ‡åºåˆ— $\{s_m\} ~ s.t. \forall i &lt; n,s_{i+1}-s_{i}=a_{s_{i+1}}-a_{s_i}$ã€‚</p>
<p>æœ€å¤§åŒ–é€‰å‡ºæ¥çš„ $a_i$ çš„æ•°å€¼å’Œã€‚</p>
<p>$\{a_n\}&gt;0$</p>
</blockquote>
<p>å¤§æ¦‚æ˜¯å’Œå·®åˆ†é‚£ç§é¢˜å·®ä¸å¤šçš„æ€è·¯ã€‚ä»¤ $b_i=a_i-i$ ï¼Œé‚£ä¹ˆå‘ç° $b_i$ åŒæ ·çš„ä½ç½®äº§ç”ŸåŒä¸€ç»„è´¡çŒ®ã€‚ç”±äºæ¯ä¸ªä½ç½®çš„ $a_i$ éƒ½ $&gt;0$ ï¼Œæ‰€ä»¥æ‹¿ä¸€ä¸ªæ¡¶è®°ä¸€ä¸‹å³å¯ã€‚</p>
<h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªå°å†™å­—æ¯ä¸² $s$ï¼Œå¯¹äºä¸€ä¸ªä½ç½® $c$ï¼Œå¦‚æœç›¸é‚»ä½ç½®æœ‰éŸ³åºæå¥½æ¯”å®ƒå° $1$ çš„å­—æ¯å°±å¯ä»¥åˆ ã€‚é—®æœ€å¤šåˆ å¤šå°‘ä¸ªã€‚</p>
<p>$1\leq |s|\leq 100$</p>
</blockquote>
<p>nmdï¼Œè¿™é¢˜çœŸæ˜¯ååˆ†sbã€‚ç»™äº†ä¸ª $|s|=100$ çš„èŒƒå›´è¿™æ˜¯åœ¨å‘é¬¼ï¼Ÿäºæ˜¯æˆ‘å°±å†™äº†ä¸ª <code>while(1)</code> æ— é™åˆ é™¤ï¼Œæ„Ÿè§‰è¿™ä¸ªå¤æ‚åº¦åº”è¯¥å¾ˆå¯¹ã€‚ä½†æ˜¯ä¸€ç›´ <code>WA on 11</code> ï¼ŒæœŸé—´ç¼–äº†ç¼–æ„Ÿè§‰å¾ˆå¯¹â€¦å†·é™äº†ä¸€ä¼šå„¿å‘ç°ï¼Œ<code>dcbcd</code> è¿™ç§å°±å¯ä»¥å¡æ‰ï¼Œåªæœ‰ä»å¤§åˆ°å°åˆ æ‰æ˜¯å¥½çš„ã€‚æ‰€ä»¥å°±æ˜¯ä¸ªè´ªå¿ƒã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> a[N] ;</span><br><span class="line"><span class="keyword">char</span> S[N] ;</span><br><span class="line"><span class="keyword">int</span> pd[N] ;</span><br><span class="line"><span class="keyword">int</span> sd[N] ;</span><br><span class="line"><span class="keyword">int</span> pre[N] ;</span><br><span class="line"><span class="keyword">int</span> nxt[N] ;</span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"><span class="comment">//int f[N][N][27][27] ;</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">1</span> ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; (S + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        a[i] = S[i] - <span class="string">'a'</span> ; nxt[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        pre[i] = i - <span class="number">1</span>, nxt[i] = i + <span class="number">1</span> ;</span><br><span class="line">    a[<span class="number">0</span>] = a[n + <span class="number">1</span>] = <span class="number">23333333</span> ; nxt[n] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="string">'z'</span> ; c &gt;= <span class="string">'a'</span> ; -- c)&#123;</span><br><span class="line">        flag = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (flag)&#123;</span><br><span class="line">            flag = <span class="number">0</span> ;<span class="comment">// cout &lt;&lt; nxt[1] &lt;&lt; endl ;</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = nxt[<span class="number">0</span>] ; i ; i = nxt[i])</span><br><span class="line">                <span class="keyword">if</span> (a[i] == c - <span class="string">'a'</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (a[pre[i]] + <span class="number">1</span> == a[i] || a[nxt[i]] + <span class="number">1</span> == a[i])</span><br><span class="line">                        ans ++, flag = <span class="number">1</span>, pre[nxt[i]] = pre[i], nxt[pre[i]] = nxt[i] ;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="comment">/*for (int i = 1 ; i &lt;= n ; ++ i)&#123;</span></span><br><span class="line"><span class="comment">                if (!vis[i])&#123;</span></span><br><span class="line"><span class="comment">                    pd[i] = a[i] - a[pre[i]] ;</span></span><br><span class="line"><span class="comment">                    sd[i] = a[i] - a[nxt[i]] ;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">                else pd[i] = sd[i] = -1 ;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">            int ret = 0 ;</span></span><br><span class="line"><span class="comment">            for (int i = 1 ; i &lt;= n ; ++ i)&#123;</span></span><br><span class="line"><span class="comment">                //for (in i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; pre[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line"><span class="comment">                if (vis[i]) continue ;</span></span><br><span class="line"><span class="comment">                if (a[nxt[i]] != a[i])&#123;</span></span><br><span class="line"><span class="comment">                    for (int j = nxt[i] ; j ; j = nxt[j])</span></span><br><span class="line"><span class="comment">                        if (j &amp;&amp; pd[j] &lt;= 1 &amp;&amp; pd[j] &gt;= 0)</span></span><br><span class="line"><span class="comment">                            ++ ret, pre[nxt[j]] = pre[j], nxt[pre[j]] = nxt[j], vis[j] = 1 ; else break ;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">                ans += ret ; //cout &lt;&lt; i &lt;&lt; " " &lt;&lt; ret &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">                if (ret) flag = 1 ; ret = 0 ;</span></span><br><span class="line"><span class="comment">                if (a[pre[i]] != a[i])&#123;</span></span><br><span class="line"><span class="comment">                    for (int j = pre[i] ; j ; j = pre[j])</span></span><br><span class="line"><span class="comment">                        if (j &amp;&amp; sd[j] &lt;= 1 &amp;&amp; sd[j] &gt;= 0)</span></span><br><span class="line"><span class="comment">                            ++ ret, pre[nxt[j]] = pre[j], nxt[pre[j]] = nxt[j], vis[j] = 1 ; else break ;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">                ans += ret ; //cout &lt;&lt; i &lt;&lt; " " &lt;&lt; ret &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">                if (ret) flag = 1 ; ret = 0 ;*/</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><p>å¼±æ™ºé¢˜ã€‚æ˜¯çœŸçš„æ²¡æœ‰ä¸€ç‚¹æ„æ€çš„å¼±æ™ºé¢˜ã€‚ç”šè‡³æ¯”ä¸ä¸ŠAã€‚</p>
<h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><blockquote>
<p>ç»™å®šä¸€ç³»åˆ—æœ‰ä»£ä»·çš„è£…å¤‡ï¼Œç¬¬ä¸€ç§æä¾› $x$ å€¼ï¼Œç¬¬äºŒç§æä¾› $y$ å€¼ã€‚ç»™å‡ºä¸€äº›æ€ªå…½ï¼Œå¦‚æœæ€ªå…½çš„ $x_i$ å’Œ $y_i$ éƒ½å°äºé€‰å®šçš„ $x$ å’Œ $y$ ï¼Œé‚£ä¹ˆä¼šæœ‰ $z_i$ çš„å¥–åŠ±ã€‚æœ€å¤§åŒ–æ”¶ç›Šã€‚</p>
<p>$1\leq n\leq 2\times 10^5$ ã€‚</p>
</blockquote>
<p>ä¸€ä¸ªæ¯”è¾ƒè‡ªç„¶çš„æƒ³æ³•æ˜¯æ’åºä¹‹åæšä¸¾ä¸€ç»´åæ ‡ï¼Œç„¶åå»ç®—å¦ä¸€ç»´ã€‚ç„¶è€Œå¦ä¸€ç»´å¹¶ä¸å…·å¤‡å•è°ƒæ€§ã€‚è€ƒè™‘å¯¹äºä¸€ä¸ªç¡®åˆ‡çš„ $x$ ï¼Œå¦‚ä½•é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜çš„ $y$ å–åˆ°æœ€å¤§å€¼ã€‚è€ƒè™‘å¿«é€ŸæŸ¥æ‰¾ä¸€ä¸ª $y$ çš„æœ€ä¼˜å€¼ï¼Œéœ€è¦å¿«é€Ÿè®¡ç®—å½“å‰ $y$ å¯ä»¥æä¾›å‡»è´¥å“ªäº›æ€ªå…½çš„è´¡çŒ®ã€‚</p>
<p>è€ƒè™‘å°†è¯¢é—®æŒ‰ç…§ $x$ æ’åºï¼Œå°±è½¬åŒ–å’Œæˆäº†ä¸€ä¸ªäºŒç»´æ‰«æçº¿é—®é¢˜ã€‚è€ƒè™‘ç”¨çº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ª $y$ å€¼å¤„çš„æœ€å¤§å€¼ã€‚æšä¸¾ç¬¬ä¸€ç§è£…å¤‡ï¼Œæ¯æ¬¡ç”¨åŒæŒ‡é’ˆæ‰«åˆ°å½“å‰çš„ $x_i$ï¼Œæå‰ç”¨çº¿æ®µæ ‘è¿›è¡Œ $y$ åæ ‡çš„åç¼€åŠ è®¡ç®—è´¡çŒ®ã€‚æœ€åç­”æ¡ˆå°±æ˜¯æ‰€æœ‰ $y$ çš„æœ€å¤§å€¼å‡å»ä½¿ç”¨å½“å‰ $x$ çš„ä»£ä»·ã€‚</p>
<p>æ„Ÿè§‰ç°åœ¨è¯­è¨€è¶Šæ¥è¶Šè‹ç™½æ— åŠ›ï¼Œè¿˜æ˜¯ä»£ç æ¯”è¾ƒå®¹æ˜“è¯´æ˜é“ç†ã€‚</p>
<p>æ„Ÿè§‰è‡ªå·±æ²¡åšè¿‡å¤ªå¤šè¿™ç§ç±»ä¼¼çš„é¢˜ï¼Œå¯èƒ½è§å¤šäº†å°±æ˜¯å¥—è·¯äº†å§233</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowb lower_bound</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> uppb upper_bound</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> S = <span class="number">1000000101</span> ;</span><br><span class="line"> </span><br><span class="line">LL ans ;</span><br><span class="line"><span class="keyword">int</span> len ;</span><br><span class="line"><span class="keyword">int</span> tmp[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, k ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">arm</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x ;</span><br><span class="line">    <span class="keyword">int</span> c ;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> arm &amp; t)</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="keyword">return</span> t.x == x ? t.c &gt; c : t.x &gt; x ; &#125;</span><br><span class="line">&#125;a[N], b[N] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">monster</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y, v ;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> monster &amp; t)</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="keyword">return</span> t.y == y ? t.x &gt; x : t.y &gt; y ; &#125;</span><br><span class="line">&#125;base[N] ;</span><br><span class="line">LL s[N * <span class="number">3</span>] ;</span><br><span class="line">LL tag[N * <span class="number">3</span>] ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">void</span> _up(<span class="keyword">int</span> x)&#123;</span><br><span class="line">    s[x] = max(s[x &lt;&lt; <span class="number">1</span>], s[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _down(<span class="keyword">int</span> x)&#123;</span><br><span class="line">    <span class="keyword">if</span> (tag[x])&#123;</span><br><span class="line">        s[x &lt;&lt; <span class="number">1</span>] += tag[x] ;</span><br><span class="line">        s[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += tag[x] ;</span><br><span class="line">        tag[x &lt;&lt; <span class="number">1</span>] += tag[x] ;</span><br><span class="line">        tag[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += tag[x] ;</span><br><span class="line">    &#125;</span><br><span class="line">    tag[x] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">chkmax</span><span class="params">(LL&amp; a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    a = b &gt; a ? b : a ; <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> v, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) </span><br><span class="line">		<span class="keyword">return</span> chkmax(s[rt], v) ;</span><br><span class="line">	<span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, l, mid, v, p) ;</span><br><span class="line">    <span class="keyword">else</span> update (rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, v, p) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> v, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= l &amp;&amp; r &lt;= ur)&#123;</span><br><span class="line">        <span class="keyword">return</span> s[rt] += v, tag[rt] += v, <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt) ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, l, mid, v, ul, ur) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid) update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, v, ul, ur) ;</span><br><span class="line">    _up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k ;</span><br><span class="line">    <span class="built_in">memset</span>(s, <span class="number">-63</span>, <span class="keyword">sizeof</span>(s)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a[i].x, &amp;a[i].c) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;b[i].x, &amp;b[i].c) ;</span><br><span class="line">    sort(b + <span class="number">1</span>, b + m + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;base[i].x, &amp;base[i].y, &amp;base[i].v) ;</span><br><span class="line">    sort(base + <span class="number">1</span>, base + k + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) tmp[i] = a[i].x ;</span><br><span class="line">    sort(tmp + <span class="number">1</span>, tmp + n + <span class="number">1</span>) ; </span><br><span class="line">    len = unique(tmp + <span class="number">1</span>, tmp + n + <span class="number">1</span>) - (tmp + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        base[i].x = uppb(tmp + <span class="number">1</span>, tmp + len + <span class="number">1</span>, base[i].x) - tmp ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        a[i].x = lowb(tmp + <span class="number">1</span>, tmp + len + <span class="number">1</span>, a[i].x) - tmp ;</span><br><span class="line">        update(<span class="number">1</span>, <span class="number">1</span>, len, - a[i].c, a[i].x) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//cout &lt;&lt;s[1]&lt;&lt;endl;//, cout &lt;&lt; base[i].y&lt;&lt;endl;</span></span><br><span class="line">    <span class="keyword">int</span> now = <span class="number">1</span> ; ans = - (S + S) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">		<span class="comment">//cout &lt;&lt; b[i].x &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">while</span> (now &lt;= k &amp;&amp; base[now].y &lt; b[i].x)</span><br><span class="line">            update(<span class="number">1</span>, <span class="number">1</span>, len, base[now].v, base[now].x, len), ++ now ;</span><br><span class="line">		<span class="comment">//cout &lt;&lt; now &lt;&lt; endl, cout &lt;&lt; s[1] &lt;&lt; " ---------- " &lt;&lt; endl ;</span></span><br><span class="line">        ans = max(ans, s[<span class="number">1</span>] - b[i].c) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="F"><a href="#F" class="headerlink" title="F"></a>F</h1><blockquote>
<p>ç»™å®šä¸€ä¸ª $01$ ä¸²ã€‚æ¯æ¬¡è¯¢é—®ä¸¤ä¸ªç­‰é•¿çš„å­ä¸²ï¼Œè¯¢é—®æ˜¯å¦å¯ä»¥ä»ä¸€ä¸ªå˜æ¢åˆ°å¦ä¸€ä¸ªã€‚å˜æ¢æ“ä½œçš„å®šä¹‰æ˜¯æ¯æ¬¡é€‰å®šä¸€ä¸ªå­æ®µï¼Œè®© $110\to 011$ æˆ–è€… $011\to110$ ã€‚</p>
<p>$n,q\leq 2\times 10^5$</p>
</blockquote>
<p>å¾ˆæœ‰è¶£çš„ä¸€é“è§‚å¯Ÿæ€§è´¨é¢˜ã€‚è€ƒè™‘å¯¹äºä¸€æ¬¡å˜æ¢ä¹‹åï¼Œä½äº $p$ ä½ç½®çš„ $0$ ä¼šå˜åˆ° $p-2$ æˆ–è€… $p+2$ ï¼Œä¹Ÿå°±æ˜¯ <strong>å‰ç¼€ $1$ çš„å¥‡å¶æ€§æ²¡æœ‰å‘ç”Ÿæ”¹å˜</strong>ã€‚æ‰€ä»¥å®è´¨ä¸Šæ¯æ¬¡æ˜¯åœ¨æŸ¥è¯¢ï¼Œå¯¹äºä¸¤ä¸ªä¸²ï¼Œæ˜¯å¦æœ‰ç›¸åŒæ•°é‡çš„ $0$ ï¼Œä¸”å¯¹åº”ä½ç½®çš„ $0$ ä¹‹å‰ $1$ çš„æ•°é‡çš„å¥‡å¶æ€§æ˜¯å¦ç›¸åŒã€‚è¿™ä¸€éƒ¨åˆ†å¯ä»¥ç”¨å“ˆå¸Œå®ç°ã€‚å“ˆå¸Œæ—¶æŒ‰å¥‡å¶æ€§åˆ†ç±»å“ˆå¸Œï¼Œå³å¯ä¿è¯åŒºé—´å“ˆå¸Œçš„æ­£ç¡®æ€§ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> len ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> a[N] ;</span><br><span class="line"><span class="keyword">int</span> sum[N] ;</span><br><span class="line">LL base[N] ;</span><br><span class="line">LL S[N], T[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL Base = <span class="number">217l</span>l ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ((a - b) % P + P) % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q, <span class="keyword">int</span> L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p0 = p + L - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">int</span> q0 = q + L - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">int</span> e1 = p0 - sum[p0] ;</span><br><span class="line">    <span class="keyword">int</span> e2 = q0 - sum[q0] ;</span><br><span class="line">    <span class="keyword">int</span> s1 = p - <span class="number">1</span> - sum[p - <span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">int</span> s2 = q - <span class="number">1</span> - sum[q - <span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">if</span> (sum[p0] - sum[p - <span class="number">1</span>] != sum[q0] - sum[q - <span class="number">1</span>]) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> ((sum[p - <span class="number">1</span>] &amp; <span class="number">1</span>) ^ (sum[q - <span class="number">1</span>] &amp; <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">bool</span>)(sub(T[e1], T[s1] * base[e1 - s1] % P) == sub(S[e2], S[s2] * base[e2 - s2] % P)) ;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">bool</span>)(sub(S[e1], S[s1] * base[e1 - s1] % P) == sub(S[e2], S[s2] * base[e2 - s2] % P)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">int</span> x, y, l ; base[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%1d"</span>, &amp;a[i]), sum[i] = sum[i - <span class="number">1</span>] + a[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!a[i])&#123;</span><br><span class="line">            ++ len ; base[len] = (base[len - <span class="number">1</span>] * Base) % P ;</span><br><span class="line">            S[len] = (S[len - <span class="number">1</span>] * Base % P + (sum[i] &amp; <span class="number">1</span>)) % P ;</span><br><span class="line">            T[len] = (T[len - <span class="number">1</span>] * Base % P + ((sum[i] &amp; <span class="number">1</span>) ^ <span class="number">1</span>)) % P ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">while</span> (m --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;x, &amp;y, &amp;l) ;</span><br><span class="line">        <span class="keyword">if</span> (check(x, y, l)) <span class="built_in">puts</span>(<span class="string">"Yes"</span>) ; <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"No"</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ„Ÿè§‰è¿™åœºCFåŠçš„å°±è·Ÿé—¹ç€ç©ä¸€æ ·.jpg</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>æ€ç»´é¢˜/æ‰¾æ€§è´¨</tag>
        <tag>è´ªå¿ƒ</tag>
        <tag>æ•°æ®ç»“æ„/çº¿æ®µæ ‘</tag>
        <tag>å­—ç¬¦ä¸²/å“ˆå¸Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç½‘ç»œæµ24é¢˜ä¸“é¢˜ã€‘4 Â· æœ€å¤§æµæ¨¡å‹è¿›é˜¶</title>
    <url>/2020/02/29/%E7%BD%91%E7%BB%9C%E6%B5%8124%E9%A2%98%C2%B7%E6%9C%80%E5%A4%A7%E6%B5%81%E6%A8%A1%E5%9E%8B%E8%BF%9B%E9%98%B6/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>åŒ…æ‹¬ä»¥ä¸‹ç¨å¾®è¿›é˜¶ä¸€ç‚¹çš„ã€å¯ä»¥ç”¨æœ€å¤§æµè§£å†³çš„é—®é¢˜ï¼š</p>
<p><code>loj#6003 é­”æœ¯çƒ</code> ã€ <code>loj#6005 æœ€é•¿é€’å¢å­åºåˆ—</code> å’Œ <code>loj#6015 æ˜Ÿé™…è½¬ç§»</code>.</p>
<a id="more"></a>
<h1 id="é­”æœ¯çƒé—®é¢˜"><a href="#é­”æœ¯çƒé—®é¢˜" class="headerlink" title="é­”æœ¯çƒé—®é¢˜"></a>é­”æœ¯çƒé—®é¢˜</h1><blockquote>
<p>å‡è®¾æœ‰ $n$ æ ¹æŸ±å­ï¼Œç°è¦æŒ‰ä¸‹è¿°è§„åˆ™åœ¨è¿™ $n$ æ ¹æŸ±å­ä¸­ä¾æ¬¡æ”¾å…¥ç¼–å·ä¸º $1, 2,3, . . .$ çš„çƒã€‚</p>
<p>(1) æ¯æ¬¡åªèƒ½åœ¨æŸæ ¹æŸ±å­çš„æœ€ä¸Šé¢æ”¾çƒã€‚</p>
<p>(2) åœ¨åŒä¸€æ ¹æŸ±å­ä¸­ï¼Œä»»ä½• 2 ä¸ªç›¸é‚»çƒçš„ç¼–å·ä¹‹å’Œä¸ºå®Œå…¨å¹³æ–¹æ•°ã€‚</p>
<p>è¯•è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œè®¡ç®—å‡ºåœ¨ $n$ æ ¹æŸ±å­ä¸Šæœ€å¤šèƒ½æ”¾å¤šå°‘ä¸ªçƒ.</p>
<p>$n\leq 55$</p>
</blockquote>
<p>è€ƒè™‘å¯¹äºä¸€ç»„ $(i,j)$ ï¼Œå¦‚æœ $i+j$ æ˜¯å®Œå…¨å¹³æ–¹æ•°ï¼Œå°±ç”±è¾ƒå°çš„é‚£ä¸ªå‘è¾ƒå¤§çš„é‚£ä¸ªè¿ä¸€æ¡è¾¹ã€‚ä¹‹åè€ƒè™‘æœ¬è´¨ä¸Šæ¯æ ¹æŸ±å­ä¸Šå°±æ˜¯ä¸€ä¸ªè·¯å¾„è¦†ç›–ï¼Œæ‰€ä»¥æŒç»­åŠ è¾¹ï¼Œä¸€ç›´åŠ åˆ°æœ€å°è·¯å¾„è¦†ç›–æ•° $&gt; $ æŸ±å­æ•°ä¸ºæ­¢ã€‚</p>
<p>æœ‰ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„æ€§è´¨ï¼Œå°±æ˜¯ç½‘ç»œæµå¯ä»¥åœ¨çº¿åŠ è¾¹å¹¶ä¸”ä¸ç”¨è€ƒè™‘ä¹‹å‰çš„å†³ç­–ã€‚</p>
<p>è¿™é¢˜çœŸnmæ˜¯å†™åˆ°åè¡€ã€‚æ¿å­ä¹Ÿæ”¹äº†ä¸€ä¸‹å¦‚æœä¸å®Œå…¨è¿é€šæ—¶çš„å†™æ³•ï¼Œéœ€è¦ç‰¹åˆ¤æ¯ä¸ªç‚¹æ˜¯å¦è¿é€šã€‚è¿™é¢˜ç¥çƒ¦çš„æ˜¯éœ€è¦ä¸€éä¸€éåœ°æ¸…ç©ºï¼Œç„¶åè¾¹çš„ç¼–å·å¾ˆå®¹æ˜“å°±å†™é”™ã€‚</p>
<p>æœ€åzayæ•™è‚²æˆ‘åªéœ€è¦äºŒåˆ†å°±å¯ä»¥äº†ï¼Œè¿™æ ·æ¯æ¬¡å°±å¯ä»¥æŠŠå…¨éƒ¨çš„è¾¹éƒ½åŠ è¿›å»ï¼Œè¿™æ ·å°±å¯ä»¥çæ¸…ç©ºã€‚æˆ‘å¤ªddäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) e[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr(k) e[k].from</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fw(k) e[k].flow</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) e[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">100010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-9</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> h[N] ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">int</span> gap[N] ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> _s, <span class="keyword">_t</span> ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"><span class="keyword">int</span> extra[N] ;</span><br><span class="line"><span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ed</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> from ;</span><br><span class="line">    <span class="keyword">int</span> flow ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;e[N * <span class="number">2</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">state</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> h, num ;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> state &amp; now)</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="keyword">return</span> h &lt; now.h ; &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">priority_queue &lt;state&gt; p ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = b ;</span><br><span class="line">    fw(cnt) = c ; fr(cnt) = a ;</span><br><span class="line">    next(cnt) = head[a] ; head[a] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    q.push(<span class="keyword">_t</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front() ; q.pop() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; ~k ; k = next(k))</span><br><span class="line">            <span class="keyword">if</span> (h[to(k)] &gt;= n + <span class="number">1</span>)</span><br><span class="line">                h[to(k)] = h[x] + <span class="number">1</span>, q.push(to(k)) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">HLPP</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; cnt &lt;&lt; endl ;</span></span><br><span class="line">    h[_s] = <span class="number">100000000</span> ; h[<span class="keyword">_t</span>] = <span class="number">0</span> ; bfs() ;</span><br><span class="line">    <span class="keyword">if</span> (h[_s] &gt;= <span class="number">10000000</span>) <span class="keyword">return</span> extra[<span class="keyword">_t</span>] ; <span class="keyword">else</span> h[_s] = n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[_s] ; ~k ; k = next(k))&#123;</span><br><span class="line">        extra[to(k)] += fw(k) ;</span><br><span class="line">        fw(k ^ <span class="number">1</span>) = fw(k), fw(k) = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">if</span> (to(k) != <span class="keyword">_t</span> &amp;&amp; h[to(k)] &lt;= n)</span><br><span class="line">            vis[to(k)] = <span class="number">1</span>, p.push((state)&#123;h[to(k)], to(k)&#125;) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (h[i] &lt;= n + <span class="number">1</span>) gap[h[i]] ++ ;</span><br><span class="line">    <span class="keyword">while</span> (!p.empty())&#123;</span><br><span class="line">        state y = p.top() ;</span><br><span class="line">        <span class="keyword">int</span> minh = <span class="number">1000000000</span> ;</span><br><span class="line">        <span class="keyword">int</span> x = y.num ; p.pop() ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; x &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">if</span> (h[x] == <span class="number">100000000</span>) <span class="keyword">break</span> ; vis[x] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; ~k ; k = next(k))&#123;</span><br><span class="line">            <span class="keyword">int</span> val = min(fw(k), extra[x]) ;</span><br><span class="line">            <span class="keyword">if</span> (val &gt; <span class="number">0</span> &amp;&amp; h[to(k)] + <span class="number">1</span> == h[x])&#123;</span><br><span class="line">                fw(k) -= val ;</span><br><span class="line">                extra[x] -= val ;</span><br><span class="line">                fw(k ^ <span class="number">1</span>) += val ;</span><br><span class="line">                extra[to(k)] += val ;</span><br><span class="line">                <span class="keyword">if</span> (to(k) == _s || to(k) == <span class="keyword">_t</span>) <span class="keyword">continue</span> ;</span><br><span class="line">                <span class="keyword">if</span> (!vis[to(k)]) vis[to(k)] = <span class="number">1</span>,</span><br><span class="line">                    p.push((state)&#123;h[to(k)], to(k)&#125;) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!extra[x]) <span class="keyword">break</span> ;</span><br><span class="line">            <span class="keyword">if</span> (fw(k)) minh = min(minh, h[to(k)]) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (extra[x] &amp;&amp; minh&lt;=n+<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (! -- gap[h[x]])&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                    <span class="keyword">if</span> (i != _s &amp;&amp; i != <span class="keyword">_t</span> &amp;&amp; h[i] &gt; h[x] &amp;&amp; h[i] &lt; n + <span class="number">1</span>)</span><br><span class="line">                        h[i] = n + <span class="number">1</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            gap[h[x] = minh + <span class="number">1</span>] ++ ; p.push((state)&#123;h[x], x&#125;) ; vis[x] = <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> extra[<span class="keyword">_t</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == fa[x]) <span class="keyword">return</span> x ; <span class="keyword">return</span> fa[x] = find(fa[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[p] ; ~k ; k = e[k].next)</span><br><span class="line">        <span class="keyword">if</span> (!fw(k) &amp;&amp; to(k) != <span class="number">2</span> &amp;&amp; !(to(k) &amp; <span class="number">1</span>))</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">" %d"</span>, (to(k) - <span class="number">2</span>) / <span class="number">2</span>), output(to(k) - <span class="number">1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m ;</span><br><span class="line">    _s = <span class="number">1</span>, <span class="keyword">_t</span> = n = <span class="number">2</span> ; cnt = <span class="number">-1</span> ;</span><br><span class="line">    h[<span class="number">1</span>] = <span class="number">1</span>, h[<span class="number">2</span>] = <span class="number">0</span>, head[<span class="number">1</span>] = head[<span class="number">2</span>] = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (res = <span class="number">1</span> ; ; ++ res)&#123;</span><br><span class="line">        head[++ n] = <span class="number">-1</span> ;</span><br><span class="line">        h[n] = <span class="number">100000000</span> ;</span><br><span class="line">        add(<span class="number">1</span>, n, <span class="number">1</span>), add(n, <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">        head[++ n] = <span class="number">-1</span> ;</span><br><span class="line">        h[n] = <span class="number">100000000</span> ;</span><br><span class="line">        add(n, <span class="number">2</span>, <span class="number">1</span>), add(<span class="number">2</span>, n, <span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; res ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">sqrt</span>(res + j) == (<span class="keyword">int</span>)(<span class="built_in">sqrt</span>(res + j)))</span><br><span class="line">                add(<span class="number">2</span> * j + <span class="number">1</span>, n, <span class="number">1</span>), add(n, <span class="number">2</span> * j + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n + <span class="number">1</span> ; ++ i)</span><br><span class="line">            h[i] = <span class="number">100000000</span>, vis[i] = gap[i] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">int</span> ans = HLPP() ; <span class="keyword">if</span> (res - ans &gt; m) <span class="keyword">break</span> ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; "--------------------" &lt;&lt; endl ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    res -- ; <span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= res ; ++ i) fa[i] = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (fr(i) &gt; <span class="number">1</span> &amp;&amp; (fr(i) &amp; <span class="number">1</span>) &amp;&amp; !(to(i) &amp; <span class="number">1</span>)  &amp;&amp; to(i) != <span class="number">2</span> &amp;&amp; !fw(i))</span><br><span class="line">            fa[find((to(i) - <span class="number">2</span>) / <span class="number">2</span>)] = find(fa[(fr(i) - <span class="number">1</span>) / <span class="number">2</span>]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= res ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (fa[i] == i) <span class="built_in">printf</span>(<span class="string">"%d"</span>, i), output(i * <span class="number">2</span> + <span class="number">1</span>), <span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æœ€é•¿é€’å¢å­åºåˆ—"><a href="#æœ€é•¿é€’å¢å­åºåˆ—" class="headerlink" title="æœ€é•¿é€’å¢å­åºåˆ—"></a>æœ€é•¿é€’å¢å­åºåˆ—</h1><blockquote>
<p>ç»™å®šæ­£æ•´æ•°åºåˆ— $x_1 \ldots, x_n$ã€‚</p>
<p>1ã€è®¡ç®—å…¶æœ€é•¿ä¸ä¸‹é™å­åºåˆ—çš„é•¿åº¦ $s$ã€‚</p>
<p>2ã€å¦‚æœæ¯ä¸ªå…ƒç´ åªå…è®¸ä½¿ç”¨ä¸€æ¬¡ï¼Œè®¡ç®—ä»ç»™å®šçš„åºåˆ—ä¸­æœ€å¤šå¯å–å‡ºå¤šå°‘ä¸ªé•¿åº¦ä¸º $s$ çš„ä¸ä¸‹é™å­åºåˆ—ã€‚</p>
<p>3ã€å¦‚æœå…è®¸åœ¨å–å‡ºçš„åºåˆ—ä¸­å¤šæ¬¡ä½¿ç”¨ $x_1$ å’Œ $x_n$ï¼ˆå…¶ä»–å…ƒç´ ä»ç„¶åªå…è®¸ä½¿ç”¨ä¸€æ¬¡ï¼‰ï¼Œåˆ™ä»ç»™å®šåºåˆ—ä¸­æœ€å¤šå¯å–å‡ºå¤šå°‘ä¸ª<strong>ä¸åŒçš„</strong>é•¿åº¦ä¸º $s$ çš„ä¸ä¸‹é™å­åºåˆ—ã€‚</p>
<p>$n\leq 500$</p>
</blockquote>
<p>è€ƒè™‘ç¬¬ä¸€é—®å¯ä»¥ç›´æ¥æ‹¿æ¥è·‘ä¸€ä¸ª $n^2$ çš„ $dp$ ã€‚å¯¹äºç¬¬äºŒé—®ï¼Œè€ƒè™‘ç½‘ç»œæµã€‚å¯¹äºæ¯ä¸ªæ•°ï¼Œæœ‰é™åˆ¶åªèƒ½ç”¨ $1$ æ¬¡ï¼Œä¸”å¿…é¡»è¦ä¿è¯æ¯ä¸ª LIS é•¿åº¦éƒ½ä¸º $s$ ã€‚æ‰€ä»¥å¦‚æœå•çº¯åœ°æ‹¿æ¯ä¸ª $i$ ä¸èµ·ç‚¹å’Œç»ˆç‚¹è¿è¾¹ï¼Œå¯¹äºä¸€ç»„ $i&lt;j$ ä¸” $a_i&lt;a_j$ ä¸” $f_j=f_{i}+1$ çš„ $(i,j)$ ï¼Œä¸­é—´è¿æµé‡ä¸º $1$ çš„è¾¹ã€‚</p>
<p>è¿™æ ·å»ºå›¾å°±å¾ˆæœ‰é—®é¢˜ï¼š</p>
<p>1ã€è€ƒè™‘è¿™æ ·å»ºå›¾ï¼ŒåŠ è°ä¸€ä¸ªç‚¹çš„å…¥åº¦ä¸º $d_1$ï¼Œå‡ºåº¦ä¸º $d_2$ ï¼Œé‚£ä¹ˆå®è´¨ä¸Šå®ƒä¼šè¢«ä½¿ç”¨ $\min\{d_1,d_2\}$ æ¬¡ã€‚ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µå‡ºç°ï¼Œæ‰€ä»¥æŠŠä¸€ä¸ªç‚¹æ‹†æˆä¸¤ä¸ªç‚¹ï¼Œä¸€ä¸ªç‚¹ç”¨æ¥æ¥æ”¶å…¥åº¦ï¼Œä¸€ä¸ªç‚¹ç”¨æ¥æ¥æ”¶å‡ºåº¦ï¼Œ$i\to iâ€™$ è¿æµé‡ä¸º $1$ çš„è¾¹ã€‚</p>
<p>2ã€åŒæ—¶ï¼Œç”±äºå¹¶ä¸èƒ½å¾ˆå®¹æ˜“åœ°ç¡®å®šä¸€æ¡æµç»è¿‡å¤šå°‘æ¡è¾¹ï¼Œæ‰€ä»¥ä¸æ˜¯å¾ˆå®¹æ˜“å¾—åˆ°é•¿åº¦ä¸º $s$ çš„ LISã€‚æ‰€ä»¥è€ƒè™‘æ¢ä¸€ç§å»ºå›¾æ–¹å¼ã€‚å³åªè®© $f_i=s$ çš„æ¯ä¸ª $i$ ä¸ $\rm T$ è¿è¾¹ã€‚è¿™æ ·å°±ä¿è¯èµ°å‡ºæ¥çš„åªä¼šæ˜¯é•¿åº¦ä¸º $s$ çš„ LISã€‚</p>
<p>é‚£ä¹ˆç¬¬ä¸‰é—®ï¼Œè€ƒè™‘å†åŠ ä¸Š $s\stackrel{f = +\infty}{\longrightarrow}1,1\stackrel{f = +\infty}{\longrightarrow}1â€™$ è¿™ç§è¾¹ã€‚å¦‚æœ $f_n=s$ çš„è¯ä¹Ÿç±»ä¼¼å¤„ç†å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    _s = <span class="number">2</span> * n + <span class="number">1</span>, <span class="keyword">_t</span> = <span class="number">2</span> * n + <span class="number">2</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; base[i], f[i] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; i ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (base[j] &lt;= base[i])</span><br><span class="line">                f[i] = max(f[i], f[j] + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) res = max(res, f[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        add(i, i + n, <span class="number">1</span>), add(i + n, i, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (f[i] == <span class="number">1</span>) add(<span class="number">2</span> * n + <span class="number">1</span>, i, <span class="number">1</span>), add(i, <span class="number">2</span> * n + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (f[i] == res) add(i + n, <span class="number">2</span> * n + <span class="number">2</span>, <span class="number">1</span>), add(<span class="number">2</span> * n + <span class="number">2</span>, i + n, <span class="number">0</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (base[i] &lt;= base[j] &amp;&amp; f[i] + <span class="number">1</span> == f[j])</span><br><span class="line">                add(i + n, j, <span class="number">1</span>), add(j, i + n, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">int</span> t = n ; n = <span class="number">2</span> * n + <span class="number">2</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n + <span class="number">1</span> ; ++ i)</span><br><span class="line">        h[i] = <span class="number">100000000</span>, vis[i] = <span class="number">0</span>, gap[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span> &lt;&lt; HLPP() &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    <span class="keyword">if</span> (f[t] == res)&#123;</span><br><span class="line">        add(t, <span class="keyword">_t</span>, <span class="number">100000000</span>), add(<span class="keyword">_t</span>, t, <span class="number">0</span>) ;</span><br><span class="line">        add(t, t + t, <span class="number">100000000</span>), add(t + t, t, <span class="number">0</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    add(_s, <span class="number">1</span>, <span class="number">100000000</span>), add(<span class="number">1</span>, _s, <span class="number">0</span>) ;</span><br><span class="line">    add(<span class="number">1</span>, t + <span class="number">1</span>, <span class="number">100000000</span>), add(t + <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n + <span class="number">1</span> ; ++ i)</span><br><span class="line">        h[i] = <span class="number">100000000</span>, vis[i] = <span class="number">0</span>, gap[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (t == <span class="number">1</span>) <span class="built_in">cout</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; HLPP() &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ˜Ÿé™…è½¬ç§»"><a href="#æ˜Ÿé™…è½¬ç§»" class="headerlink" title="æ˜Ÿé™…è½¬ç§»"></a>æ˜Ÿé™…è½¬ç§»</h1><blockquote>
<p>ç°æœ‰ $n$ ä¸ªå¤ªç©ºç«™ä½äºåœ°çƒä¸æœˆçƒä¹‹é—´ï¼Œä¸”æœ‰ $m$ è‰˜å…¬å…±äº¤é€šå¤ªç©ºèˆ¹åœ¨å…¶é—´æ¥å›ç©¿æ¢­ã€‚æ¯ä¸ªå¤ªç©ºç«™å¯å®¹çº³æ— é™å¤šçš„äººï¼Œè€Œæ¯è‰˜å¤ªç©ºèˆ¹ $i$ åªå¯å®¹çº³ $p_i$ ä¸ªäººã€‚æ¯è‰˜å¤ªç©ºèˆ¹å°†å‘¨æœŸæ€§åœ°åœé ä¸€ç³»åˆ—çš„å¤ªç©ºç«™ï¼Œä¾‹å¦‚ï¼š$\{1,3,4\}$ è¡¨ç¤ºè¯¥å¤ªç©ºèˆ¹å°†å‘¨æœŸæ€§åœ°åœé å¤ªç©ºç«™ 134134134 â€¦</p>
<p>æ¯ä¸€è‰˜å¤ªç©ºèˆ¹ä»ä¸€ä¸ªå¤ªç©ºç«™é©¶å¾€ä»»ä¸€å¤ªç©ºç«™è€—æ—¶å‡ä¸º $1$ã€‚äººä»¬åªèƒ½åœ¨å¤ªç©ºèˆ¹åœé å¤ªç©ºç«™ï¼ˆæˆ–æœˆçƒã€åœ°çƒï¼‰æ—¶ä¸Šã€ä¸‹èˆ¹ã€‚</p>
<p>åˆå§‹æ—¶æ‰€æœ‰äººå…¨åœ¨åœ°çƒä¸Šï¼Œå¤ªç©ºèˆ¹å…¨åœ¨åˆå§‹ç«™ã€‚è¯•è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œæ‰¾å‡ºè®©æ‰€æœ‰äººå°½å¿«åœ°å…¨éƒ¨è½¬ç§»åˆ°æœˆçƒä¸Šçš„è¿è¾“æ–¹æ¡ˆã€‚</p>
<p>$n,m\leq 50$ ã€‚</p>
</blockquote>
<p>å¾ˆç¥å¥‡çš„åˆ†å±‚å›¾å»ºå›¾ã€‚è€ƒè™‘æœ¬èº«ä¼¼ä¹æ˜¯è·¯å¾„è§„åˆ’é—®é¢˜ï¼Œä½†æ˜¯å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š1ã€è¾¹çš„é™åˆ¶è·Ÿç½‘ç»œæµå›¾çš„é™åˆ¶å‡ ä¹ç›¸åŒï¼›2ã€æ¯æ¡è¾¹çš„ä»£ä»·éƒ½æ˜¯ $1$  ; 3ã€æ•°æ®èŒƒå›´ $n,m\leq 50$ ï¼Œå¯ä»¥çŸ¥é“å¦‚æœæœ‰è§£ï¼Œæœ€å¤šå°±æ˜¯åœ¨ $0\to -1$ è·¯å¾„ä¸Šçš„æ¯ä¸ªç‚¹éƒ½åœä¸€éï¼Œè€ƒè™‘æ¯æ¬¡åœæœ€å¤šåœ $n$ ä¸ªå¸‚åœºï¼Œé‚£ä¹ˆæœ€ç»ˆç­”æ¡ˆçš„ä¸Šç•Œå°±æ˜¯ $O(n^2)$ ã€‚</p>
<p>æ ¹æ®ä»¥ä¸Šæ€§è´¨ï¼Œå¯ä»¥å‘ç°ä¼¼ä¹æšä¸¾ç­”æ¡ˆå¤æ‚åº¦ä¸é«˜ï¼Œå¯ä»¥è½¬åŒ–ä¸ºåˆ¤å®šæ€§é—®é¢˜ã€‚è€Œç½‘ç»œæµæ°å¥½å¯ä»¥è§£å†³åˆ¤å®šæ€§é—®é¢˜ã€‚æ‰€ä»¥è€ƒè™‘ç°åœ¨è¦åšçš„å°±æ˜¯å¦‚ä½•å»ºä¸€ä¸ªæµå›¾ï¼Œä½¿å¾—è·‘å‡ºæ¥çš„æœ€å¤§æµå°±æ˜¯å½“å‰èƒ½å¤Ÿè¿è¾“çš„æœ€å¤šçš„äººæ•°ã€‚</p>
<p>å‘ç°å†³ç­–å¯¹æ—¶é—´è´Ÿè´£ï¼Œé‚£ä¹ˆæ¯ä¸ªæ—¶é—´ï¼Œä¸€ä¸ªç‚¹å¯ä»¥èµ°å‡ºå»æˆ–è€…åŸåœ°å‚»æ„£ã€‚æ ¹æ®çŠ¶æ€æœ€åŸå§‹çš„è¡¨ç¤ºæ–¹å¼ï¼Œå¯çŸ¥å¦‚æœå°†æ¯ä¸ªæ—¶åˆ»çš„æ¯ä¸ªç‚¹éƒ½å•åˆ—ä¸€ä¸ªçŠ¶æ€ï¼Œæ°å¥½å¯ä»¥è½¬ç§»ã€‚</p>
<p>æ‰€ä»¥å»ºä¸€ä¸ªè¶…çº§ $\rm S$ è¿å‘æ¯ä¸ª $t$ çš„ $0$ ï¼Œå»ºä¸€ä¸ªè¶…çº§ $\rm T $ è®©æ¯ä¸ª $t$ çš„ $-1$ è¿å‘å®ƒï¼Œå‰©ä¸‹çš„å°±æŒ‰ç…§è½¬ç§»æ¥å»ºå°±å¥½äº†ã€‚</p>
<p>æœ€åå†™äº†ä¸ª dinicâ€¦è¿˜æ˜¯dinicå¥½â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) e[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr(k) e[k].from</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fw(k) e[k].flow</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) e[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">4010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-9</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> s ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> dis[N] ;</span><br><span class="line"><span class="keyword">int</span> cur[N] ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> _s, <span class="keyword">_t</span> ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"><span class="keyword">int</span> extra[N] ;</span><br><span class="line"><span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ed</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> from ;</span><br><span class="line">    <span class="keyword">int</span> flow ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;e[N * <span class="number">2</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = b ;</span><br><span class="line">    fw(cnt) = c ; fr(cnt) = a ;</span><br><span class="line">    next(cnt) = head[a] ; head[a] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        dis[i] = <span class="number">0</span>, cur[i] = head[i] ; dis[<span class="keyword">_t</span>] = <span class="number">0</span> ;</span><br><span class="line">    dis[_s] = <span class="number">1</span> ; q.push(_s) ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front() ; q.pop() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; ~k ; k = next(k))</span><br><span class="line">            <span class="keyword">if</span> (!dis[to(k)] &amp;&amp; fw(k) &gt; <span class="number">0</span>)</span><br><span class="line">                dis[to(k)] = dis[x] + <span class="number">1</span>, q.push(to(k)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">bool</span>)(dis[<span class="keyword">_t</span>]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> aim, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>, minf ;</span><br><span class="line">    <span class="keyword">if</span> (x == aim || !f) <span class="keyword">return</span> f ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> &amp;k = cur[x] ; ~k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (dis[to(k)] != dis[x] + <span class="number">1</span>) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">if</span> (( minf = dfs(to(k), aim, min(f, fw(k))) ) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            ret += minf, fw(k) -= minf, fw(k ^ <span class="number">1</span>) += minf ;</span><br><span class="line">            f -= minf ; <span class="keyword">if</span> (f &lt;= <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">int</span> rn[N] ;</span><br><span class="line"><span class="keyword">int</span> ctn[N] ;</span><br><span class="line"><span class="keyword">int</span> ways[M][M] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = find(fa[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> nn, mm ;</span><br><span class="line">    _s = <span class="number">0</span> ; <span class="keyword">_t</span> = <span class="number">50000</span> ; cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; nn &gt;&gt; mm &gt;&gt; s ; n = nn + <span class="number">2</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n ; ++ i) fa[i] = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= mm ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; rn[i] &gt;&gt; ctn[i] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; ctn[i] ; ++ j)&#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; ways[i][j] ; ways[i][j] += <span class="number">2</span> ;</span><br><span class="line">            <span class="keyword">if</span> (j &gt; <span class="number">0</span>) fa[find(ways[i][j])] = find(ways[i][j - <span class="number">1</span>]) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (find(<span class="number">2</span>) != find(<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"0"</span>), <span class="number">0</span> ; <span class="keyword">else</span> nn += <span class="number">2</span> ;</span><br><span class="line">    <span class="keyword">for</span> (res = <span class="number">0</span> ; ; ++ res)&#123;</span><br><span class="line">        add(<span class="keyword">_t</span>, res * nn + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">        add(res * nn + <span class="number">2</span>, _s, <span class="number">0</span>) ;</span><br><span class="line">        add(res * nn + <span class="number">1</span>, <span class="keyword">_t</span>, <span class="number">100000000</span>) ;</span><br><span class="line">        add(_s, res * nn + <span class="number">2</span>, <span class="number">100000000</span>) ;</span><br><span class="line">		<span class="keyword">if</span> (res)&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= nn ; ++ i)&#123;</span><br><span class="line">    	        add(res * nn + i, (res - <span class="number">1</span>) * nn + i, <span class="number">0</span>) ;</span><br><span class="line">    	        add((res - <span class="number">1</span>) * nn + i, res * nn + i, <span class="number">100000000</span>) ;</span><br><span class="line">    	    &#125;</span><br><span class="line">   	   		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= mm ; ++ i)&#123;</span><br><span class="line">        	    <span class="keyword">int</span> r = ctn[i] ;</span><br><span class="line">        	    <span class="keyword">int</span> x = ways[i][res % r] ;</span><br><span class="line">        	    <span class="keyword">int</span> y = ways[i][(res - <span class="number">1</span>) % r] ;</span><br><span class="line">            	x += nn * res, y += nn * (res - <span class="number">1</span>) ;</span><br><span class="line">            	add(y, x, rn[i]), add(x, y, <span class="number">0</span>) ;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">        n = <span class="number">1</span> + (res + <span class="number">1</span>) * nn ;</span><br><span class="line">		<span class="keyword">while</span> (bfs()) ans += dfs(_s, <span class="keyword">_t</span>, <span class="number">100000000</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (ans &gt;= s) <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, res), <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>ç½‘ç»œæµ24é¢˜</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œæµ24é¢˜</tag>
        <tag>ç½‘ç»œæµ/æœ€å¤§æµ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç½‘ç»œæµ24é¢˜ä¸“é¢˜ã€‘3 Â· æœ€å°å‰²æ¨¡å‹</title>
    <url>/2020/02/29/%E7%BD%91%E7%BB%9C%E6%B5%8124%E9%A2%98%C2%B7%E6%9C%80%E5%B0%8F%E5%89%B2%E6%A8%A1%E5%9E%8B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸»è¦æ˜¯æ¯”è¾ƒç¥å¥‡çš„æœ€å°å‰²æ¨¡å‹ã€‚</p>
<p>æ¶‰åŠçš„é¢˜ç›®æœ‰ <code>loj#6007 æ–¹æ ¼å–æ•°</code> ã€ <code>loj#6001 å¤ªç©ºé£è¡Œè®¡åˆ’</code> å’Œ <code>loj#6226 éª‘å£«å…±å­˜é—®é¢˜</code>ã€‚ </p>
<a id="more"></a>
<h1 id="æ–¹æ ¼å–æ•°"><a href="#æ–¹æ ¼å–æ•°" class="headerlink" title="æ–¹æ ¼å–æ•°"></a>æ–¹æ ¼å–æ•°</h1><blockquote>
<p>æœ‰ä¸€ä¸ª $m$ è¡Œ $n$ åˆ—çš„æ–¹æ ¼å›¾ï¼Œæ¯ä¸ªæ–¹æ ¼ä¸­éƒ½æœ‰ä¸€ä¸ªæ­£æ•´æ•°ã€‚ç°è¦ä»æ–¹æ ¼ä¸­å–æ•°ï¼Œä½¿ä»»æ„ä¸¤ä¸ªæ•°æ‰€åœ¨æ–¹æ ¼æ²¡æœ‰å…¬å…±è¾¹ï¼Œä¸”å–å‡ºçš„æ•°çš„æ€»å’Œæœ€å¤§ï¼Œè¯·æ±‚å‡ºæœ€å¤§çš„å’Œã€‚</p>
</blockquote>
<p>è€ƒè™‘å¯¹äºæ–¹æ ¼ä¸­ï¼Œå–æ ¼å­è¦æ±‚â€œæ²¡æœ‰å…¬å…±è¾¹â€ï¼Œé‚£ä¹ˆéœ€è¦æƒ³åˆ°å°±æ˜¯åœ¨è¿›è¡Œä¸€ä¸ªé»‘ç™½æŸ“è‰²ï¼Œä¸èƒ½é€‰ä¸ä¹‹å››è¿é€šçš„æ ¼å­ã€‚æ‰€ä»¥æœ€åæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªäºŒåˆ†å›¾ï¼Œä¸èƒ½é€‰æœ‰è¾¹ç›¸è¿çš„ç‚¹ï¼Œä¹Ÿå°±æ˜¯å¯¹äºæ¯ä¸€æ¡è¾¹ $\rm e$ï¼Œ ä¸¤ä¸ªç«¯ç‚¹è‡³å¤šé€‰ä¸€ä¸ªã€‚</p>
<p>ç„¶åå°±æ˜¯å¾ˆç¥å¥‡çš„å»ºå›¾æ–¹å¼ã€‚è€ƒè™‘ä¸ºäº†æ¨¡æ‹Ÿå‡ºè¿™ä¸ªè¿‡ç¨‹ï¼Œå»ºä¸€ä¸ª $\rm S$ è¿å‘æ‰€æœ‰é»‘ç‚¹ï¼Œæµé‡å³ä¸ºç‚¹æƒï¼›å»ºä¸€ä¸ª $\rm T$ è®©æ‰€æœ‰ç™½ç‚¹è¿å‘å®ƒï¼Œæµé‡åŒæ ·æ˜¯ç‚¹æƒã€‚ä¸­é—´æ ¹æ®è¿é€šæ€§æ¥è¿æµé‡ä¸º $+\infty$ çš„è¾¹ã€‚è¿™æ ·å»ºæ¨¡ä¹‹åï¼Œè€ƒè™‘æœ€å°å‰²çš„æœ¬è´¨å«ä¹‰ã€‚å¯¹äºä¸€æ¡è¾¹ $(u,v)$ ï¼Œ$\mathrm S\to u$ å’Œ $v\to\rm T$ å¿…å®šæœ‰ä¸€ä¸ªéœ€è¦è¢«å‰²ï¼Œæ»¡è¶³ã€Œä¸¤ä¸ªç«¯ç‚¹è‡³å¤šé€‰ä¸€ä¸ªã€çš„é™åˆ¶ã€‚é‚£ä¹ˆå¦‚æœç”¨æœ€å°å‰²çš„è¯ï¼Œå°±å¯ä»¥å°†æŒ‘å‡ºæ¥çš„è¾¹ä½œä¸ºåˆ å»çš„ç‚¹ä»æ€»æƒä¸­å‡å»å³ä¸ºç­”æ¡ˆã€‚</p>
<p>é‚£ä¹ˆå¤§æ¦‚æœ€å°å‰²çš„å»ºæ¨¡æŠ€å·§ï¼Œå°±æ˜¯è€ƒè™‘ç”¨è¿é€šæ€§è¿™ä¸ªä¸œè¥¿æ¥æ“ä½œã€‚æ¯”å¦‚ä»€ä¹ˆã€ŒAå’ŒBè‡³å¤šé€‰ä¸€ä¸ªä½¿å¾—æœ€ç»ˆæƒå€¼æœ€å¤§/å°ã€ï¼Œå°±å¯ä»¥ç”¨ç±»ä¼¼çš„æŠ€å·§æ¥å»ºæ¨¡ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="built_in">map</span>[MAXN][MAXN] ;</span><br><span class="line"><span class="keyword">int</span> dx[<span class="number">4</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>&#125; ;</span><br><span class="line"><span class="keyword">int</span> dy[<span class="number">4</span>] = &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>&#125; ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; tot = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[++ tot]), Ans += base[tot],</span><br><span class="line">            (i + j &amp; <span class="number">1</span>) ? white[++ w] = tot : black[++ b] = tot, <span class="built_in">map</span>[i][j] = tot ;</span><br><span class="line">    S = <span class="number">1</span>, T = tot + <span class="number">1</span> ; <span class="comment">/*cout &lt;&lt; tot &lt;&lt; endl ;*/</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= w ; ++ i) Add(S, white[i], base[white[i]])  ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= w ; ++ i) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = <span class="built_in">ceil</span>((<span class="keyword">double</span>)(white[i] - <span class="number">1</span>) / M) ;</span><br><span class="line">        <span class="keyword">int</span> y = (white[i] - <span class="number">1</span>) - (x - <span class="number">1</span>) * M ;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; x &lt;&lt; " " &lt;&lt; y &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= <span class="number">4</span> ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">int</span> kx = x + dx[j], ky = y + dy[j] ;</span><br><span class="line">            <span class="keyword">if</span> (kx &lt;= <span class="number">0</span> || ky &lt;= <span class="number">0</span> || ky &gt; M || kx &gt; N) <span class="keyword">continue</span> ;</span><br><span class="line">            Add(white[i], <span class="built_in">map</span>[kx][ky], INF) ;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= b ; ++ i) </span><br><span class="line">      Add(black[i], T, base[black[i]]) ; </span><br><span class="line">  	<span class="built_in">cout</span> &lt;&lt; Ans - HLPP() &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="å¤ªç©ºé£è¡Œè®¡åˆ’"><a href="#å¤ªç©ºé£è¡Œè®¡åˆ’" class="headerlink" title="å¤ªç©ºé£è¡Œè®¡åˆ’"></a>å¤ªç©ºé£è¡Œè®¡åˆ’</h1><blockquote>
<p>ç°å·²ç¡®å®šäº†ä¸€ä¸ªå¯ä¾›é€‰æ‹©çš„å®éªŒé›†åˆ $E = \{ E_1, E_2, \cdots, E_m \}$ï¼Œå’Œè¿›è¡Œè¿™äº›å®éªŒéœ€è¦ä½¿ç”¨çš„å…¨éƒ¨ä»ªå™¨çš„é›†åˆ$ I = \{ I_1, I_2, \cdots, I_n \}$ã€‚å®éªŒ $E_j$ éœ€è¦ç”¨åˆ°çš„ä»ªå™¨æ˜¯ $I$ çš„å­é›† $R_j \subseteq I$ã€‚</p>
<p>é…ç½®ä»ªå™¨ $I_k$ çš„è´¹ç”¨ä¸º $c_k$ ç¾å…ƒã€‚å®éªŒ $E_j$ çš„èµåŠ©å•†å·²åŒæ„ä¸ºè¯¥å®éªŒç»“æœæ”¯ä»˜ $p_j$ ç¾å…ƒã€‚W æ•™æˆçš„ä»»åŠ¡æ˜¯æ‰¾å‡ºä¸€ä¸ªæœ‰æ•ˆç®—æ³•ï¼Œç¡®å®šåœ¨ä¸€æ¬¡å¤ªç©ºé£è¡Œä¸­è¦è¿›è¡Œå“ªäº›å®éªŒå¹¶å› æ­¤è€Œé…ç½®å“ªäº›ä»ªå™¨æ‰èƒ½ä½¿å¤ªç©ºé£è¡Œçš„å‡€æ”¶ç›Šæœ€å¤§ã€‚è¿™é‡Œå‡€æ”¶ç›Šæ˜¯æŒ‡è¿›è¡Œå®éªŒæ‰€è·å¾—çš„å…¨éƒ¨æ”¶å…¥ä¸é…ç½®ä»ªå™¨çš„å…¨éƒ¨è´¹ç”¨çš„å·®é¢ã€‚</p>
<p>å¯¹äºç»™å®šçš„å®éªŒå’Œä»ªå™¨é…ç½®æƒ…å†µï¼Œç¼–ç¨‹æ‰¾å‡ºå‡€æ”¶ç›Šæœ€å¤§çš„è¯•éªŒè®¡åˆ’ã€‚</p>
</blockquote>
<p>è¿™ä¸ªé¢˜çš„æ¨¡å‹ä¼¼ä¹æ˜¯ä»€ä¹ˆã€Œæœ€å¤§æƒé—­åˆå­å›¾ã€ï¼Œå¤§æ¦‚å°±æ˜¯å¦‚æœé€‰äº†æŸä¸ªç‚¹ $v$ ï¼Œé‚£ä¹ˆ $v$ æŒ‡å‘çš„æ‰€æœ‰ç‚¹éƒ½å¿…é¡»è¦é€‰ï¼Œæœ€å¤§åŒ–ç‚¹æƒå’Œã€‚</p>
<p>è€ƒè™‘ä»¥è¿™ä¹ˆä¸€ç§æ–¹å¼å»ºå›¾ã€‚$\rm S$ è¿å‘æ‰€æœ‰æ­£æƒç‚¹ï¼Œæµé‡ä¸ºè¯¥ç‚¹çš„ç‚¹æƒï¼›æ‰€æœ‰è´Ÿæƒç‚¹è¿å‘ $\rm T$ ï¼Œæµé‡ä¸ºè¯¥ç‚¹çš„ç»å¯¹å€¼ï¼›åŸæœ¬å›¾ä¸­çš„ç‚¹æŒ‰ç…§åŸæ¥çš„æ–¹å¼è¿ä¸Šå»ï¼Œæµé‡ä¸º ã€‚è·‘ä¸€ä¸ªæœ€å°å‰²ï¼Œç„¶åæ­£æƒç‚¹å’Œ-æœ€å°å‰²å°±æ˜¯æœ€ç»ˆçš„ç­”æ¡ˆã€‚</p>
<p>è€ƒè™‘è¿™ä¹ˆåšçš„æ­£ç¡®æ€§ã€‚å¯¹äºæœ€å°å‰²è€Œè¨€ï¼Œæ—¢ç„¶æ˜¯å‰²ï¼Œé‚£ä¹ˆè¦ä¹ˆä¼šå»å‰²ä¸€ä¸ªæ­£æƒç‚¹ï¼Œä»£è¡¨æ­£æƒç‚¹è¿æ¥ç‚¹é›†éƒ½ä¸é€‰ï¼›æˆ–è€…é€‰æ‹©å‰²æ‰ä¸ä¹‹ç›¸è¿çš„æ‰€æœ‰è´Ÿæƒç‚¹ï¼Œä»£è¡¨é€‰äº†è¿™ä¸ªç‚¹é›†ã€‚é‚£ä¹ˆè¿™æ ·ä¸¤ç§å†³ç­–çš„æœ¬è´¨ä¸Šéƒ½æ˜¯åœ¨å€’æ‰£ä»£ä»·ã€‚æ‰€ä»¥æ˜¯æˆç«‹çš„ã€‚</p>
<p>è¿™é¢˜è¿˜è¦æ†¨æ†¨åœ°è¾“å‡ºæ–¹æ¡ˆã€‚è¿™ä¸ªåœ°æ–¹æœ‰ä¸ªç¥å¥‡çš„è¾“å‡ºæ–¹å¼ï¼Œå°±æ˜¯åˆ¤æ–­æ¯ä¸ªç‚¹æ˜¯å¦ä¸ $\rm S$ ç›¸è¿ï¼Œå¦‚æœä¸€ä¸ªç‚¹æŒ‡å‘çš„æŸä¸ªç‚¹ä¸ä¸ $\rm S$ è¿é€šï¼Œé‚£ä¹ˆä»–å°±å®ƒä¿©ä¹‹é—´çš„è¾¹å°±æ˜¯ä¸€æ¡å‰²è¾¹ã€‚</p>
<p>é¦–å…ˆä¸éš¾çŸ¥é“ï¼Œè¿™äº›è¾¹éƒ½æ˜¯æ»¡æµçš„ã€‚è€ƒè™‘ä¹‹æ‰€ä»¥è¿™äº›æ»¡æµçš„è¾¹å°±æ˜¯è¢«å‰²çš„è¾¹ï¼ŒåŸå› æ˜¯ä»–ä»¬æ°å¥½æ˜¯ $\rm S$ åˆ° $\rm T$ æ¯æ¡è·¯å¾„çš„ç“¶é¢ˆè¾¹ï¼Œæ‰€ä»¥ä»–ä»¬çš„æµé‡åŠ èµ·æ¥å°±æ˜¯æœ€å¤§æµ(å› ä¸ºå³ä½¿æœ‰æ›´å¤šä¹Ÿä¸èƒ½æµäº†)ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯æœ€å°å‰²ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> sum ;</span><br><span class="line"><span class="keyword">int</span> newline ;</span><br><span class="line"><span class="keyword">int</span> E[M * <span class="number">2</span>] ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch = <span class="string">' '</span> ; <span class="keyword">int</span> res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch)) ch = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch))</span><br><span class="line">        res = res * <span class="number">10</span> + ch - <span class="number">48</span> , ch = getchar() ;</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">'\n'</span>) newline = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x, y ;</span><br><span class="line">    <span class="keyword">int</span> nn, mm ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; nn &gt;&gt; mm ;</span><br><span class="line">    _s = <span class="number">0</span>, <span class="keyword">_t</span> = <span class="number">100000</span> ; cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= nn ; ++ i)&#123;</span><br><span class="line">        x = read() ;</span><br><span class="line">        sum += x ; newline = <span class="number">0</span> ;</span><br><span class="line">        add(_s, i, x) ; add(i, _s, <span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">while</span> (!newline)&#123;</span><br><span class="line">            y = read() ;</span><br><span class="line">            add(y + nn, i, <span class="number">0</span>) ;</span><br><span class="line">            add(i, y + nn, <span class="number">100000000</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= mm ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; y, add(i + nn, <span class="keyword">_t</span>, y), add(<span class="keyword">_t</span>, i + nn, <span class="number">0</span>) ;</span><br><span class="line">    n = nn + mm ; res = sum - dinic() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= nn ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (dis[i]) <span class="built_in">printf</span>(<span class="string">"%d "</span>, i) ;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = nn + <span class="number">1</span> ; i &lt;= mm + nn ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (dis[i]) <span class="built_in">printf</span>(<span class="string">"%d "</span>, i - nn) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"\n%d\n"</span>, res), <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="éª‘å£«å…±å­˜"><a href="#éª‘å£«å…±å­˜" class="headerlink" title="éª‘å£«å…±å­˜"></a>éª‘å£«å…±å­˜</h1><blockquote>
<p>ç»™å®š $n^2$ ä¸ªæ–¹æ ¼çš„å›½é™…è±¡æ£‹æ£‹ç›˜å’Œéšœç¢æ ‡å¿—ï¼Œæœ‰éšœç¢çš„ä¸èƒ½æ”¾ï¼Œè®¡ç®—æ£‹ç›˜ä¸Šæœ€å¤šå¯ä»¥æ”¾ç½®å¤šå°‘ä¸ªéª‘å£«ï¼Œä½¿å¾—å®ƒä»¬å½¼æ­¤äº’ä¸æ”»å‡»ã€‚</p>
<p>$n\leq 200$ </p>
</blockquote>
<p>å¤§æ¦‚è¿™ç§é¢˜ä¸€å¼€å§‹è¢«æˆ‘å½“ä½œä¸€èˆ¬å›¾æœ€å¤§ç‹¬ç«‹é›†åšäº†â€¦ç„¶åä¸ä¼šâ€¦</p>
<p>æ„Ÿè§‰åœ¨ç½‘æ ¼å›¾æäº‹æƒ…ï¼Œè¿˜æ˜¯éœ€è¦æœ‰ç§è§‚å¯Ÿæ€§è´¨çš„ç›´è§‰çš„ã€‚æ¯”å¦‚å°±ä¼šå‘ç°ï¼Œéª‘å£«è·³çš„æ¯ä¸¤æ­¥ï¼Œéƒ½ä¸ä¼šæ˜¯åŒä¸€ä¸ªé¢œè‰²ã€‚é‚£ä¹ˆè¿™å°±ä¼šè½¬åŒ–æˆä¸€ä¸ªäºŒåˆ†å›¾é—®é¢˜ï¼ŒåŒç§é¢œè‰²ä¹‹é—´æ²¡æœ‰è¾¹ç›¸è¿ï¼Œæœ‰ä¸¤ç§é¢œè‰²ï¼Œç¬¦åˆäºŒåˆ†å›¾çš„é™åˆ¶ã€‚æ‰€ä»¥æœ€ååªéœ€è¦æ±‚ä¸€å‘äºŒåˆ†å›¾æœ€å¤§ç‹¬ç«‹é›†å³å¯ã€‚</p>
<p>è€ƒè™‘æŠŠåŸäºŒåˆ†å›¾è½¬ä¸ºæµå›¾ï¼Œä¸­é—´çš„è¾¹æµé‡ä¸º inf ï¼Œå…¶ä½™ä¸º 1 ã€‚è¿™ä¸ªç½‘ç»œçš„æœ€å°å‰²æ»¡è¶³ï¼Œå¯¹äºä¸­é—´æ¯ä¸€æ¡è¾¹ï¼Œä¸¤ç«¯çš„ç‚¹å¿…å®šé€‰æ‹©äº†ä¸€ä¸ªï¼Œå¦åˆ™ S ä¸ T ä»è¿é€šã€‚æ•…æœ€å°å‰²å¯¹åº”æœ€å°ç‚¹è¦†ç›–ã€‚è€Œæœ€å°ç‚¹è¦†ç›–ä¸æœ€å¤§ç‹¬ç«‹é›†äº’ä¸ºå¯¹å¶é—®é¢˜ï¼Œæ‰€ä»¥ç®—ä¸€ä¸‹å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">int</span> x, y, kx, ky ;</span><br><span class="line">    _s = <span class="number">0</span>, <span class="keyword">_t</span> = <span class="number">60001</span>, cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y, mark[x][y] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">1</span> ; x &lt;= n ; ++ x)</span><br><span class="line">        <span class="keyword">for</span> (y = <span class="number">1</span> ; y &lt;= n ; ++ y)&#123;</span><br><span class="line">            <span class="keyword">if</span> (mark[x][y]) <span class="keyword">continue</span> ;</span><br><span class="line">            <span class="keyword">if</span> ((x + y) % <span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt;= <span class="number">7</span> ; ++ k)&#123;</span><br><span class="line">                    kx = x + dx[k] ;</span><br><span class="line">                    ky = y + dy[k] ;</span><br><span class="line">                    <span class="keyword">if</span> (mark[kx][ky]) <span class="keyword">continue</span> ;</span><br><span class="line">                    <span class="keyword">if</span> (kx &lt; <span class="number">1</span> || ky &lt; <span class="number">1</span> || ky &gt; n || kx &gt; n) <span class="keyword">continue</span> ;</span><br><span class="line">                    add(kx * (n + <span class="number">1</span>) + ky, x * (n + <span class="number">1</span>) + y, <span class="number">0</span>) ;</span><br><span class="line">                    add(x * (n + <span class="number">1</span>) + y, kx * (n + <span class="number">1</span>) + ky, <span class="number">100000000</span>) ;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//cout &lt;&lt; x &lt;&lt; " " &lt;&lt; y &lt;&lt; endl ;</span></span><br><span class="line">                add(x * (n + <span class="number">1</span>) + y, _s, <span class="number">0</span>) ;</span><br><span class="line">                add(_s, x * (n + <span class="number">1</span>) + y, <span class="number">1</span>) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                add(<span class="keyword">_t</span>, x * (n + <span class="number">1</span>) + y, <span class="number">0</span>) ;</span><br><span class="line">                add(x * (n + <span class="number">1</span>) + y, <span class="keyword">_t</span>, <span class="number">1</span>) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">int</span> t = n ; n = (n + <span class="number">1</span>) * (n + <span class="number">1</span>) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; t * t - m - dinic() &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªåœ°æ–¹å¤§æ¦‚éœ€è¦æ³¨æ„ï¼Œä¸¤ä¸ªç‚¹ä¹‹é—´ä¸è¦è¿åŒå‘çš„è¾¹ã€‚è¿™æ ·æœ€å°å‰²å°±ä¼šé”™ï¼Œå› ä¸ºæœ€å¤§æµçš„æ„ä¹‰ä¸å¯¹äº†ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>ç½‘ç»œæµ24é¢˜</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œæµ24é¢˜</tag>
        <tag>ç½‘ç»œæµ/æœ€å¤§æµ</tag>
        <tag>ç½‘ç»œæµ/æœ€å°å‰²</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç½‘ç»œæµ24é¢˜ä¸“é¢˜ã€‘2 Â· è¾ƒç®€å•çš„æœ€å¤§æµ</title>
    <url>/2020/02/28/%E7%BD%91%E7%BB%9C%E6%B5%8124%E9%A2%982%C2%B7%E7%AE%80%E5%8D%95%E7%9A%84%E6%9C%80%E5%A4%A7%E6%B5%81%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>åŒ…æ‹¬ä»¥ä¸‹è¾ƒä¸ºç®€å•çš„å¯ä»¥ç”¨æœ€å¤§æµè§£å†³çš„é—®é¢˜ï¼š</p>
<p><code>loj#6000 æ­é…é£è¡Œå‘˜</code>ã€<code>loj#6006 è¯•é¢˜åº“</code>ã€ <code>loj#6004 åœ†æ¡Œèšé¤</code> å’Œ <code>loj#6002 æœ€å°è·¯å¾„è¦†ç›–</code> ã€‚</p>
<a id="more"></a>
<h1 id="æ­é…é£è¡Œå‘˜"><a href="#æ­é…é£è¡Œå‘˜" class="headerlink" title="æ­é…é£è¡Œå‘˜"></a>æ­é…é£è¡Œå‘˜</h1><blockquote>
<p>é£è¡Œå¤§é˜Ÿæœ‰è‹¥å¹²ä¸ªæ¥è‡ªå„åœ°çš„é©¾é©¶å‘˜ï¼Œä¸“é—¨é©¾é©¶ä¸€ç§å‹å·çš„é£æœºï¼Œè¿™ç§é£æœºæ¯æ¶æœ‰ä¸¤ä¸ªé©¾é©¶å‘˜ï¼Œéœ€ä¸€ä¸ªæ­£é©¾é©¶å‘˜å’Œä¸€ä¸ªå‰¯é©¾é©¶å‘˜ã€‚ç”±äºç§ç§åŸå› ï¼Œä¾‹å¦‚ç›¸äº’é…åˆçš„é—®é¢˜ï¼Œæœ‰äº›é©¾é©¶å‘˜ä¸èƒ½åœ¨åŒä¸€æ¶é£æœºä¸Šé£è¡Œï¼Œé—®å¦‚ä½•æ­é…é©¾é©¶å‘˜æ‰èƒ½ä½¿å‡ºèˆªçš„é£æœºæœ€å¤šã€‚</p>
<p>å› ä¸ºé©¾é©¶å·¥ä½œåˆ†å·¥ä¸¥æ ¼ï¼Œä¸¤ä¸ªæ­£é©¾é©¶å‘˜æˆ–ä¸¤ä¸ªå‰¯é©¾é©¶å‘˜éƒ½ä¸èƒ½åŒæœºé£è¡Œã€‚</p>
</blockquote>
<p>è¿™æ˜¾è€Œæ˜“è§çš„å°±æ˜¯ä¸€ä¸ªäºŒåˆ†å›¾åŒ¹é…çš„é—®é¢˜ã€‚è€ƒè™‘ $\rm S$ å‘å·¦éƒ¨æ¯ä¸ªç‚¹è¿ $f=1$ çš„è¾¹ï¼Œå³éƒ¨çš„å‘ $\rm T$ è¿ $f=1$ çš„è¾¹ã€‚è€ƒè™‘ä¸€ç»„åŒ¹é…ä¼šè´¡çŒ® $1$ çš„æµé‡ï¼Œä¸”æ¯ä¸ªç‚¹åªæœ‰ $1$ çš„åŸå§‹æµä¿è¯äº†åªå¯ä½¿ç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸éš¾è¯æ˜æ˜¯ä½†ä¿ºå°±æ˜¯æœ€å¤§æµã€‚ </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;  </span><br><span class="line">	fill(head, head + N + <span class="number">30</span>, <span class="number">-1</span>); S = <span class="number">0</span>, T = N + <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; A &gt;&gt; B)  add(A, B, <span class="number">23333</span>), add(B, A, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= M ; i ++) add(S, i, <span class="number">1</span>), add(i, S, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span>(i = M + <span class="number">1</span>; i &lt;= N ; i ++) add(i, T, <span class="number">1</span>), add(T, i, <span class="number">0</span>) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; Dinic() &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="è¯•é¢˜åº“"><a href="#è¯•é¢˜åº“" class="headerlink" title="è¯•é¢˜åº“"></a>è¯•é¢˜åº“</h1><blockquote>
<p>å‡è®¾ä¸€ä¸ªè¯•é¢˜åº“ä¸­æœ‰ $n$ é“è¯•é¢˜ã€‚æ¯é“è¯•é¢˜éƒ½æ ‡æ˜äº†æ‰€å±ç±»åˆ«ã€‚åŒä¸€é“é¢˜å¯èƒ½æœ‰å¤šä¸ªç±»åˆ«å±æ€§ã€‚ç°è¦ä»é¢˜åº“ä¸­æŠ½å– $m$ é“é¢˜ç»„æˆè¯•å·ã€‚å¹¶è¦æ±‚è¯•å·åŒ…å«æŒ‡å®šç±»å‹çš„è¯•é¢˜ã€‚è¯•è®¾è®¡ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„ç»„å·ç®—æ³•ã€‚</p>
</blockquote>
<p>å¾ˆæ°´çš„å»ºæ¨¡ï¼Œ$\rm S$ å‘æ¯ä¸ªé¢˜è¿ $f=1$ çš„è¾¹è¡¨ç¤ºåªèƒ½ç”¨ä¸€æ¬¡ï¼Œæ¯ä¸ªé¢˜å‘å¯¹åº”çš„ç±»å‹è¿è¾¹ï¼Œæ¯ä¸ªç±»å‹å‘ $\rm T$ è¿ $f=need_x$ çš„è¾¹ã€‚ç„¶åè¾“å‡ºæ–¹æ¡ˆå°±åªéœ€è¦çœ‹ä¸€ä¸‹æ¯ä¸ªç±»å‹è¿çš„è¾¹æœ‰è° $f$ è¢«æµæˆ $0$ äº†å³å¯ã€‚</p>
<p>å¾ˆä¹…ä¹‹å‰çš„ Dinic ä»£ç ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; K &gt;&gt; N, T = N + K + <span class="number">1</span> ;</span><br><span class="line">	cnt = <span class="number">-1</span>, <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) Add(S, i, <span class="number">1</span>) ; L1 = cnt + <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = N + <span class="number">1</span> ; i &lt;= N + K ; ++ i) </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), w1 += x, Add(i, T, x) ; </span><br><span class="line">	R1 = cnt ; L2 = R1 + <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123; </span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x) ; </span><br><span class="line">		<span class="keyword">while</span> (x --) <span class="built_in">cin</span> &gt;&gt; y, Add(i, N + y, <span class="number">1</span>) ; </span><br><span class="line">	&#125; R2 = cnt ;</span><br><span class="line">	<span class="keyword">while</span>(BFS())&#123; </span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= T ; ++ i) cur[i] = head[i] ;</span><br><span class="line">		w += dfs(S, T, Inf) ; </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">if</span> (w != w1) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"No Solution!"</span>), <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = L2 ; i &lt; R2 ; i += <span class="number">2</span>) </span><br><span class="line">    <span class="keyword">if</span> (!E[i].f) Ans[to(i) - N].push_back(E[i].fr) ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= K ; ++ i, <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>) </span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">": "</span>, j = <span class="number">0</span> ; j &lt; Ans[i].size() ; ++ j) <span class="built_in">cout</span> &lt;&lt; Ans[i][j] &lt;&lt; <span class="string">" "</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="åœ†æ¡Œèšé¤"><a href="#åœ†æ¡Œèšé¤" class="headerlink" title="åœ†æ¡Œèšé¤"></a>åœ†æ¡Œèšé¤</h1><blockquote>
<p>å‡è®¾æœ‰æ¥è‡ª $n$ ä¸ªä¸åŒå•ä½çš„ä»£è¡¨å‚åŠ ä¸€æ¬¡å›½é™…ä¼šè®®ã€‚æ¯ä¸ªå•ä½çš„ä»£è¡¨æ•°åˆ†åˆ«ä¸º $r_i$ã€‚ä¼šè®®é¤å…å…±æœ‰ $m$ å¼ é¤æ¡Œï¼Œæ¯å¼ é¤æ¡Œå¯å®¹çº³ $c_i$ ä¸ªä»£è¡¨å°±é¤ã€‚</p>
<p>ä¸ºäº†ä½¿ä»£è¡¨ä»¬å……åˆ†äº¤æµï¼Œå¸Œæœ›ä»åŒä¸€ä¸ªå•ä½æ¥çš„ä»£è¡¨ä¸åœ¨åŒä¸€ä¸ªé¤æ¡Œå°±é¤ã€‚</p>
</blockquote>
<p>å‘ç°æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„åŒ¹é…é—®é¢˜ï¼Œè€ƒè™‘ä» $\rm S$ åˆ°æ¯ä¸ªå•ä½è¿ $f=r_i$ çš„è¾¹ï¼Œæ¯ä¸ªæ¡Œå­å‘ $\rm T$ è¿ä¸€æ¡ $f=c_i$ çš„è¾¹ï¼ŒåŒæ—¶æ¯ä¸ªå•ä½å’Œæ¯å¼ æ¡Œå­ä¹‹é—´è¿ $f=1$ çš„è¾¹ã€‚è¿™æ ·å°±å¯ä»¥æ§åˆ¶æ¯ä¸ªå•ä½è‡³å¤šä¸€ä¸ªåœ¨æŸä¸ªé¤æ¡Œã€‚åŒæ ·ï¼Œå¦‚æœé™åˆ¶åŒä¸€å¼ é¤æ¡Œä¸èƒ½åšè¶…è¿‡ $k$ ä¸ªåŒä¸€å•ä½çš„äººï¼Œåªéœ€è¦æŠŠ $f$ ä» $1$ æ”¹æˆ $k$ å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) e[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fw(k) e[k].flow</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) e[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> h[N] ;</span><br><span class="line"><span class="keyword">int</span> gap[N] ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> _s, <span class="keyword">_t</span> ;</span><br><span class="line"><span class="keyword">int</span> A[M][M] ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"><span class="keyword">int</span> extra[N] ;</span><br><span class="line"><span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ed</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> flow ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;e[N * <span class="number">2</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">state</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> h, num ;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> state &amp; now)</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="keyword">return</span> h &lt; now.h ; &#125;</span><br><span class="line">&#125; ;</span><br><span class="line">priority_queue &lt;state&gt; p ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = b ; fw(cnt) = c ;</span><br><span class="line">    next(cnt) = head[a] ; head[a] = cnt ;</span><br><span class="line">    <span class="keyword">return</span> cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    q.push(<span class="keyword">_t</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front() ; q.pop() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; ~k ; k = next(k))</span><br><span class="line">            <span class="keyword">if</span> (h[to(k)] &gt;= n + <span class="number">1</span>)</span><br><span class="line">                h[to(k)] = h[x] + <span class="number">1</span>, q.push(to(k)) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">HLPP</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; cnt &lt;&lt; endl ;</span></span><br><span class="line">    h[<span class="keyword">_t</span>] = <span class="number">0</span> ; bfs() ; h[_s] = n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[_s] ; ~k ; k = next(k))&#123;</span><br><span class="line">        extra[to(k)] += fw(k) ;</span><br><span class="line">        fw(k ^ <span class="number">1</span>) = fw(k), fw(k) = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">if</span> (to(k) != <span class="keyword">_t</span>) vis[to(k)] = <span class="number">1</span>,</span><br><span class="line">            p.push((state)&#123;h[to(k)], to(k)&#125;) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (h[i] &lt;= n + <span class="number">1</span>) gap[h[i]] ++ ;</span><br><span class="line">    <span class="comment">//for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; h[i] &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">while</span> (!p.empty())&#123;</span><br><span class="line">        state y = p.top() ;</span><br><span class="line">        <span class="keyword">int</span> minh = <span class="number">1000000000</span> ;</span><br><span class="line">        <span class="keyword">int</span> x = y.num ; vis[x] = <span class="number">0</span> ; p.pop() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; ~k ; k = next(k))&#123;</span><br><span class="line">            <span class="keyword">int</span> val = min(fw(k), extra[x]) ;</span><br><span class="line">            <span class="keyword">if</span> (val &gt; <span class="number">0</span> &amp;&amp; h[to(k)] + <span class="number">1</span> == h[x])&#123;</span><br><span class="line">                fw(k) -= val ;</span><br><span class="line">                extra[x] -= val ;</span><br><span class="line">                fw(k ^ <span class="number">1</span>) += val ;</span><br><span class="line">                extra[to(k)] += val ;</span><br><span class="line">                <span class="keyword">if</span> (to(k) == _s || to(k) == <span class="keyword">_t</span>) <span class="keyword">continue</span> ;</span><br><span class="line">                <span class="keyword">if</span> (!vis[to(k)]) vis[to(k)] = <span class="number">1</span>,</span><br><span class="line">                    p.push((state)&#123;h[to(k)], to(k)&#125;) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!extra[x]) <span class="keyword">break</span> ;</span><br><span class="line">            <span class="keyword">if</span> (fw(k)) minh = min(minh, h[to(k)]) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (extra[x])&#123;</span><br><span class="line">            <span class="keyword">if</span> (! -- gap[h[x]])&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                    <span class="keyword">if</span> (i != _s &amp;&amp; i != <span class="keyword">_t</span> &amp;&amp; h[i] &gt; h[x] &amp;&amp; h[i] &lt; n + <span class="number">1</span>)</span><br><span class="line">                        gap[h[i]] --, h[i] = n + <span class="number">1</span>, gap[h[i]] ++ ;</span><br><span class="line">            &#125;</span><br><span class="line">            gap[h[x] = minh + <span class="number">1</span>] ++ ; p.push((state)&#123;h[x], x&#125;) ; vis[x] = <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> extra[<span class="keyword">_t</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        head[i] = <span class="number">-1</span>, h[i] = <span class="number">1000000000</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> nn, mm ;</span><br><span class="line">    <span class="keyword">int</span> u, v, w ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; nn &gt;&gt; mm ;</span><br><span class="line">    n = nn + mm + <span class="number">2</span> ;</span><br><span class="line">    _s = <span class="number">1</span>, <span class="keyword">_t</span> = n ; Init() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= nn ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; w, res += w,</span><br><span class="line">        add(_s, i + <span class="number">1</span>, w), add(i + <span class="number">1</span>, _s, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= mm ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; w, add(i + nn + <span class="number">1</span>, <span class="keyword">_t</span>, w), add(<span class="keyword">_t</span>, i + nn + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= nn ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= mm ; ++ j)</span><br><span class="line">            A[i][j] = add(i + <span class="number">1</span>, j + nn + <span class="number">1</span>, <span class="number">1</span>), add(j + nn + <span class="number">1</span>, i + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">if</span> (HLPP() &lt; res)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"0"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"1"</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= nn ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= mm ; ++ j)</span><br><span class="line">                <span class="keyword">if</span> (fw(A[i][j]) == <span class="number">0</span>) <span class="built_in">cout</span> &lt;&lt; j &lt;&lt; <span class="string">" "</span> ;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜"><a href="#æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜" class="headerlink" title="æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜"></a>æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜</h1><blockquote>
<p>ç»™å®šæœ‰å‘å›¾ $\rm G=\{V,E\}$ã€‚è®¾ $\rm P$ æ˜¯ $\rm G$ çš„ä¸€ä¸ªç®€å•è·¯ï¼ˆé¡¶ç‚¹ä¸ç›¸äº¤ï¼‰çš„é›†åˆã€‚å¦‚æœ $\rm V$ ä¸­æ¯ä¸ªé¡¶ç‚¹æ°å¥½åœ¨ $\rm P$ çš„ä¸€æ¡è·¯ä¸Šï¼Œåˆ™ç§° $\rm P$ æ˜¯ $\rm G$ çš„ä¸€ä¸ªè·¯å¾„è¦†ç›–ã€‚ $\rm P$ ä¸­è·¯å¾„å¯ä»¥ä» $\rm V$ çš„ä»»ä½•ä¸€ä¸ªé¡¶ç‚¹å¼€å§‹ï¼Œé•¿åº¦ä¹Ÿæ˜¯ä»»æ„çš„ï¼Œç‰¹åˆ«åœ°ï¼Œå¯ä»¥ä¸º $0$ã€‚ çš„æœ€å°è·¯å¾„è¦†ç›–æ˜¯ $\rm G$ çš„æ‰€å«è·¯å¾„æ¡æ•°æœ€å°‘çš„è·¯å¾„è¦†ç›–ã€‚</p>
</blockquote>
<p>å—¯ï¼Œè¿™é“é¢˜å¤§æ¦‚æ˜¯æ•™äº†ä¸€ä¸‹æ€ä¹ˆæ‹†ç‚¹ã€‚è€ƒè™‘å¯¹äºæ¯ä¸ªç‚¹ $v$ï¼Œæ–°å»ºä¸€ä¸ªæ›¿èº«ç‚¹ $vâ€™$ ã€‚åŸå›¾ä¸­çš„è·¯å¾„ $(u,v)$ å˜æ¢ä¸º $(u,vâ€™)$ ï¼Œç„¶å $\rm S$ å‘æ‰€æœ‰ $v$ è¿è¾¹ï¼Œæ‰€æœ‰ $vâ€™$ å‘ $\rm T$ è¿è¾¹ã€‚æ€è€ƒè¿™ä¹ˆåšæœ¬è´¨ä¸Šæ˜¯åœ¨æ±‚ä¸€ä¸ªåŒ¹é…ï¼Œæœ€åæ²¡æœ‰åŒ¹é…çš„åˆ°å·¦éƒ¨çš„ä¸€ä¸ªæœ‰éƒ¨ç‚¹å¯ä»¥çœ‹åšæ˜¯ä¸€æ¡è·¯å¾„çš„ç»“å°¾ã€‚é‚£ä¹ˆè€ƒè™‘è¿™æ ·è·‘å®Œä¸€ç»„åŒ¹é…ä¹‹åï¼Œæ‰€æœ‰æ²¡æœ‰åŒ¹é…ä¸Šçš„ç‚¹éƒ½æ˜¯ä¸€æ¡è·¯å¾„çš„ç»“å°¾ï¼Œä¹Ÿå°±æ˜¯è·¯å¾„çš„æ•°é‡ã€‚æ‰€ä»¥è·‘ä¸€ä¸ªæœ€å¤§æµï¼Œå°±å¯ä»¥å¾—åˆ°æœ€å°‘çš„è·¯å¾„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯æœ€å°è·¯å¾„åŒ¹é…ã€‚</p>
<p>è¿™ä»£ç è¿˜æ˜¯ä¸Šå¤æ—¶æœŸæ‹¿ dinic å†™çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M, T = N &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, S = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">    Add(S, i, <span class="number">1</span>), Add(i + N, T, <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B), Add(A, B + N, <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">while</span> (BFS()) &#123; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= T ; ++ i) cur[i] = head[i] ; </span><br><span class="line">    Ans += dfs(S, T, Inf) ; </span><br><span class="line">  &#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) fa[i] = i ; </span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span> ; i &lt;= cnt ; ++ i) </span><br><span class="line">		<span class="keyword">if</span> (fr(i) &gt;= <span class="number">1</span> &amp;&amp; fr(i) &lt;= N &amp;&amp; to(i) &lt; T &amp;&amp; to(i) &gt; N &amp;&amp; !E[i].f) </span><br><span class="line">			fa[find(to(i) - N)] = find(fa[fr(i)]) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">    <span class="keyword">if</span> (fa[i] == i) begin_output(i), <span class="built_in">puts</span>(<span class="string">""</span>) ; </span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; N - Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆä¸éš¾çœ‹å‡ºå»ºè™šç‚¹è¿™ä¸ªæ“ä½œçš„ç›®çš„ï¼Œå°±æ˜¯é™åˆ¶æ¯ä¸ªç‚¹çš„ç»è¿‡æ¬¡æ•°ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>ç½‘ç»œæµ24é¢˜</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œæµ24é¢˜</tag>
        <tag>ç½‘ç»œæµ/æœ€å¤§æµ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘[ARC066]C/D/E Sol</title>
    <url>/2020/02/26/ARC066C-E/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸»è¦æ˜¯æ­£å¥½åšåˆ°äº†è¿™ä¸€åœºçš„Fï¼Œå°±é¡ºä¾¿æŠŠå‰ä¸‰ä¸ªé¢˜ç»™åšäº†ã€‚</p>
<p>å—¯ï¼Œæ„Ÿè§‰æ€ç»´èƒ½åŠ›è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚æ‰€ä»¥ä¸èƒ½å†è¿™ä¹ˆæ²‰æ²¦äº†å•Šã€‚</p>
<a id="more"></a>
<h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote>
<p>æœ‰ç¼–å·ä¸º $1\sim N$ å·çš„ $N$ ä¸ªäººï¼Œç»™ä½ ç¬¬ $i$ ä¸ªäººçš„ã€Œè‡ªå·±çš„å·¦æ’åˆ—çš„äººæ•°å’Œè‡ªå·±çš„å³æ’åˆ—çš„äººæ•°çš„å·®çš„ç»å¯¹å€¼ã€$A_i$ã€‚ è¯·æ ¹æ®ä»–ä»¬çš„æŠ¥å‘Šï¼Œæ±‚å‡ºåŸæ¥çš„æ’åˆ—æ–¹æ³•æœ‰å‡ ç§ã€‚å¯¹ $10^9+7$ å–æ¨¡ ã€‚</p>
<p>$A_i\leq 10^9,N\leq 10^5$</p>
</blockquote>
<p>æˆ–è®¸å¯ä»¥æ ¹æ®æ ·ä¾‹çŒœå‡ºæ¥ï¼Œå¤§æ¦‚æ˜¯ä¸€ç‚¹æ€§è´¨å§ï¼Œæ¯”å¦‚ä»€ä¹ˆæ•°å€¼å¿…é¡»å¯¹ç§°åˆ†å¸ƒã€‚é‚£ä¹ˆæƒ³åˆ°è¿™ä¸€ç‚¹ï¼Œå†æ·±å…¥æƒ³ä¸€ä¸‹å°±å¯ä»¥å‘ç°å¯¹äºæ¯ä¸ª $n$ è€Œè¨€ï¼Œä»–ä»¬çš„ $A_i$ æ˜¯å›ºå®šçš„ã€‚æ‰€ä»¥ç›´æ¥ç”Ÿæˆè¿™ä¸ªæ ‡å‡†ç­”æ¡ˆåºåˆ—ï¼Œç„¶åæŠŠç»™å‡ºçš„ $A$ æ’ä¸€éåºï¼Œæ¯”è¾ƒæ˜¯å¦ç›¸åŒå³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">    sort(base + <span class="number">1</span>, base + n + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">if</span> (n &amp; <span class="number">1</span>)&#123;</span><br><span class="line">        yes[<span class="number">1</span>] = <span class="number">0</span> ; <span class="keyword">int</span> cnt = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; i += <span class="number">2</span>)</span><br><span class="line">            yes[i] = yes[i + <span class="number">1</span>] = <span class="number">2</span> * (++ cnt) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (base[i] != yes[i]) <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"0\n"</span>), <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span> ;</span><br><span class="line">        yes[<span class="number">1</span>] = yes[<span class="number">2</span>] = ++ cnt ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span> ; i &lt;= n ; i += <span class="number">2</span>)</span><br><span class="line">            yes[i] = yes[i + <span class="number">1</span>] = (cnt += <span class="number">2</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (base[i] != yes[i]) <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"0\n"</span>), <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, expow(<span class="number">2</span>, n / <span class="number">2</span>)), <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><blockquote>
<p>æ±‚å‡ºæ•´æ•°å¯¹ $u$ å’Œ $v$ $(0â‰¤u,vâ‰¤N)$ çš„æ•°ç›®ï¼Œä½¿å¾—å­˜åœ¨ä¸¤ä¸ªéè´Ÿæ•´æ•° $a$ å’Œ $b$ æ»¡è¶³ $a xor b = u$ å’Œ $a + b= v$.</p>
<p>è¦æ±‚å¯¹ç­”æ¡ˆå–æ¨¡ $10^9 + 7$ ã€‚$N\leq 10^{18}$ã€‚</p>
</blockquote>
<p>è¿™ä¸ªé¢˜å¥½åƒæœ‰ä¸€å †ååˆ†æœ‰è¶£çš„åšæ³•â€¦ä½†æ˜¯ç¢äºæ™ºå•†å¹¶ä¸æ˜¯å¾ˆæƒ³å»å­¦qaqï¼Œå°±æ”¾ä¸ªé“¾æ¥å§ <a href="https://qiita.com/259_Momone/items/86e90d17e4efe3b22433" target="_blank" rel="noopener">æˆ³</a> ã€‚</p>
<p>ç„¶åè‡ªå·±å°±å¯¹ç€ä¸€ä¸ªç¥å¥‡çš„åšæ³•ç¼–äº†ä¸€ä¸‹åŸç†ã€‚<del>å‘ç°è‡ªå·±æœç„¶æ˜¯é©¬åç‚®é€‰æ‰‹</del> ã€‚</p>
<p>è€ƒè™‘ </p>
<script type="math/tex; mode=display">
a+b=((a~\mathrm{and}~b)<<1)+(a~\mathrm{xor}~b)</script><p>è¿™ä¸ªå¼å­çš„æ„ä¹‰åœ¨äºï¼ŒååŠéƒ¨åˆ†æ˜¯å› ä¸ºå¼‚æˆ–è¿ç®—æ˜¯äºŒè¿›åˆ¶ä¸‹ä¸è¿›ä½çš„åŠ æ³•ï¼Œå‰åŠéƒ¨åˆ†åˆ™æ˜¯åœ¨æè¿°äºŒè¿›åˆ¶ä¸‹çš„è¿›ä½ã€‚åæ­£æ— è®ºæ€ä¹ˆæ ·ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å¾—åˆ° $a+b\geq  a~\mathrm{xor}~b$ è¿™æ ·çš„ç»“è®ºã€‚</p>
<p>é‚£ä¹ˆå¦‚æœç”±äº $u\leq v$ï¼Œæ‰€ä»¥å¦‚æœ $v$ ä¸è¶Šç•Œé‚£ä¹ˆ $u$ ä¸€å®šä¸è¶Šç•Œã€‚äºæ˜¯è€ƒè™‘æŒ‰ $v$ è¿›è¡Œ $dp$ã€‚å…·ä½“çš„ï¼Œè€ƒè™‘çŠ¶æ€ $f_{i,j}$ è¡¨ç¤ºè€ƒè™‘äº† $a$ å’Œ $b$ äºŒè¿›åˆ¶ä¸‹çš„å‰ $i$ ä½ï¼Œå½“å‰ $v=a+b=j$ çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>è€ƒè™‘å¦‚ä½•è½¬ç§»ã€‚å¯¹äº $a$ å’Œ $b$ è€Œè¨€ï¼Œç¬¬ $i$ ä½æœ‰ä¸‰ç§æƒ…å†µï¼Œ$(0,0),(0,1),(1,1)$ ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯å‡è®¾åŸæ¥çš„å’Œä¸º $jâ€™$ï¼Œå’Œå½“å‰çš„å’Œ $j$ å¯èƒ½æœ‰ä»¥ä¸‹å…³ç³»ï¼š</p>
<p>1ã€$2\cdot (jâ€™+1)=j$ï¼Œå¯¹åº”ç€éƒ½è¡¥ä¸€ä½ $1$ã€‚</p>
<p>2ã€$2\cdot jâ€™=j$ï¼Œå¯¹åº”ç€éƒ½è¡¥ä¸€ä½ $0$ ã€‚</p>
<p>3ã€$jâ€™+ (jâ€™ + 1)=j$ï¼Œå¯¹åº”ç€ä¸€ä¸ªè¡¥ $1$ ä¸€ä¸ªè¡¥ $0$ ã€‚</p>
<p>é‚£ä¹ˆä¹Ÿå°±æ˜¯</p>
<script type="math/tex; mode=display">
f_{i,j}=f_{i-1,\lfloor\frac{j}{2}\rfloor}+f_{i-1,\lfloor\frac{(j-1)}{2}\rfloor}+f_{i-1,\lfloor\frac{(j-2)}{2}\rfloor}</script><p>å‘ç°æœ¬è´¨ä¸Šï¼Œç¬¬ä¸€ç»´çŠ¶æ€éšç€ç¬¬äºŒç»´é€’å‡ï¼Œä¸”éƒ½æ˜¯ $\Delta(\log)$ çº§åˆ«ï¼Œå¹¶ä¸”æ¯æ¬¡è®¡ç®—ï¼Œå¿…å®šå­˜åœ¨ä¸‰é¡¹ä¸­æœ‰ä¸¤é¡¹æ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥å¯çŸ¥æœ€åçŠ¶æ€æ•°ä¸€å®šä»‹äº $\Omega(2\log N)\sim O(\log N)$ ä¹‹é—´ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚</p>
<p>ç„¶åç¬¬ä¸€ç»´å°±å¯ä»¥ç›´æ¥å‹æ‰äº†ã€‚</p>
<p>ä¸è¿‡è¯è¯´å›æ¥ï¼Œå…³äºè¿™ä¸ªçŠ¶æ€æ•°ï¼Œæˆ‘è¿˜æ˜¯ä¸çŸ¥é“è¯¥æ€ä¹ˆç®—ï¼Œæœ€ç»ˆè¿˜æ˜¯æ‰“è¡¨æ‰“å‡ºæ¥çš„è¿™ä¹ˆä¸€ä¸ªç•Œï¼Œå¤§æ¦‚æ˜¯åœ¨ $2^k-1$ æ—¶è¾¾åˆ°ä¸‹ç•Œï¼Œ$2^k$ æ—¶è¾¾åˆ°ä¸Šç•Œã€‚æƒ³äº†æƒ³è¿™ä¹ˆåˆ†å¸ƒä¼¼ä¹å¾ˆåˆç†ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸çŸ¥é“ä¸ºå•¥ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">LL <span class="title">f</span><span class="params">(<span class="keyword">int</span> p, LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m.count(x)) <span class="keyword">return</span> m[x] ; <span class="keyword">if</span> (x == <span class="number">0</span>) <span class="keyword">return</span> m[x] = <span class="number">1</span> ; <span class="keyword">if</span> (x == <span class="number">1</span>) <span class="keyword">return</span> m[x] = <span class="number">2</span> ;</span><br><span class="line">    <span class="keyword">return</span> m[x] = ((f(p - <span class="number">1</span>, x / <span class="number">2</span>) + f(p - <span class="number">1</span>, (x - <span class="number">1</span>) / <span class="number">2</span>)) % P + f(p - <span class="number">1</span>, (x - <span class="number">2</span>) / <span class="number">2</span>)) % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f(log2(n) + <span class="number">1</span>, n) &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><blockquote>
<p>ç»™ä½ ä¸€ä¸ªåªåŒ…å« $â€™+â€™$ ã€$â€™-â€˜$ã€æ­£æ•´æ•°çš„å¼å­ï¼Œä½ éœ€è¦åœ¨å¼å­ä¸­æ·»åŠ ä¸€äº›æ‹¬å·ï¼Œä½¿è¿ç®—ç»“æœæœ€å¤§ï¼Œè¾“å‡ºæœ€å¤§çš„ç»“æœã€‚</p>
<p>$n\leq 10^5,a_i\leq 10^9$ ã€‚ </p>
</blockquote>
<p>å¤§æ¦‚æ˜¯ä¸ªè§‚å¯Ÿæ€§è´¨é¢˜ã€‚é¦–å…ˆå¯ä»¥çŸ¥é“ï¼ŒåŠ å·åé¢ä¸ä¼šå³æ‹¬å·ï¼Œæˆ–è€…è¯´å¯ä»¥è¢«å¿½ç•¥æ‰ï¼›å…¶æ¬¡ï¼Œæœ€å¤šæœ‰ä¸¤å±‚æ‹¬å·åµŒå¥—ï¼Œå¤šäº†æ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºæ¯”å¦‚ $-((a-b)-(a-(a-b)-b))$ è¿™ä¸ªå°±å¯ä»¥å†™æˆ $-((a-b)-(a-a)-(b-b))$ çš„å½¢å¼ã€‚</p>
<p>è€ƒè™‘ $dp$ å®ç°ï¼ŒçŠ¶æ€å¤§æ¦‚è®¾è®¡ä¸º $f_{i,j}$ è¡¨ç¤ºè€ƒè™‘äº†å‰ $i$ ä¸ªæ•°ï¼Œä¸€å…±æœ‰ $j$ ä¸ªå·¦æ‹¬å·æ²¡æœ‰é—­åˆçš„æœ€å¤§ç»“æœã€‚å¯ä»¥çŸ¥é“ç¬¬äºŒç»´åªä¼šæ˜¯ $0,1,2$ ã€‚æ€è€ƒå¦‚ä½•è½¬ç§»ï¼Œå¤§æ¦‚å°±æ˜¯åˆ†ç±»è®¨è®ºå·¦æ‹¬å·æ•°é‡ã€‚ä¸€å¼€å§‹å¸¦ç¬¦å·åœ°è¯»å…¥ $x$ ï¼Œé‚£ä¹ˆå¯çŸ¥å¯ä»¥å…ˆèµ‹åˆå€¼ï¼š $f_{i,0}=x,f_{i,1}=-x,f_{i,2}=x$ è¿™æ ·ã€‚ç„¶åè€ƒè™‘è½¬ç§»ã€‚å‘ç°æˆ‘ä»¬å¯ä»¥é€šè¿‡åŠ ä¸€ä¸ªå³æ‹¬å·ä½¿å¾—æœªåŒ¹é…çš„å·¦æ‹¬å·æ•°é‡å‡å°‘ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯ $f_{i,0}$ å¯ä»¥åŠ ä¸Š $\max\{f_{i-1,0},f_{i-1,1},f_{i-1,2}\}$ ï¼Œ$f_{i,1}$ å¯ä»¥åŠ ä¸Š $\max\{f_{i-1,1},f_{i-1,2}\}$ ï¼Œ $f_{i,2}$ å°±åªèƒ½åŸåœ°è½¬ç§»ã€‚ç„¶åå°±æ˜¯è€ƒè™‘ï¼Œå¦‚æœå½“å‰çš„ $x &lt;0$ ï¼Œä¹Ÿå°±æ˜¯è¯»è¿›æ¥ä¸€ä¸ªç¬¦å·ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘æ”¾ä¸€ä¸ªå·¦æ‹¬å·ï¼Œæ‰€ä»¥éœ€è¦ <code>chkmax</code> ä¸€ä¸‹ <code>(f[i][2],f[i][1]),(f[i][1],f[i][0])</code> ã€‚ </p>
<p>æ³¨æ„æœ€åè¦è¾“å‡º $\max\{f_{i-1,0},f_{i-1,1},f_{i-1,2}\}$ ï¼ŒåŸå› æ˜¯æ ¹æ®çŠ¶æ€çš„å®šä¹‰ï¼Œæˆ‘ä»¬æ²¡æœ‰è€ƒè™‘åœ¨ç¬¬ $n$ ä¸ªæ•°æœ€åæ·»ä¸Šå³æ‹¬å·çš„æƒ…å†µã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; LL x ;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">1</span>] = f[<span class="number">0</span>][<span class="number">2</span>] = -(<span class="number">1l</span>l &lt;&lt; <span class="number">52</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        x = qr() ;</span><br><span class="line">        f[i][<span class="number">0</span>] = x ;</span><br><span class="line">        f[i][<span class="number">2</span>] = x ;</span><br><span class="line">        f[i][<span class="number">1</span>] = -x ;</span><br><span class="line">        f[i][<span class="number">2</span>] += f[i - <span class="number">1</span>][<span class="number">2</span>] ;</span><br><span class="line">        f[i][<span class="number">1</span>] += max(f[i - <span class="number">1</span>][<span class="number">1</span>], f[i - <span class="number">1</span>][<span class="number">2</span>]) ;</span><br><span class="line">        f[i][<span class="number">0</span>] += max(f[i - <span class="number">1</span>][<span class="number">0</span>], max(f[i - <span class="number">1</span>][<span class="number">1</span>], f[i - <span class="number">1</span>][<span class="number">2</span>])) ;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            f[i][<span class="number">2</span>] = max(f[i][<span class="number">2</span>], f[i][<span class="number">1</span>]) ;</span><br><span class="line">            f[i][<span class="number">1</span>] = max(f[i][<span class="number">1</span>], f[i][<span class="number">0</span>]) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; max(f[n][<span class="number">1</span>], max(f[n][<span class="number">0</span>], f[n][<span class="number">2</span>])) &lt;&lt; <span class="built_in">endl</span>  ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ€è·¯é¢˜è¿˜æ˜¯è¦è‡ªå·±å…ˆè®¤çœŸæƒ³ï¼Œä¸ç„¶çœŸçš„åšäº†æ•ˆæœä¸å¤§ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>atcoder</category>
      </categories>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘[AGC012E]Camel and Oases</title>
    <url>/2020/02/25/AGC012E/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>ç»™å®š $n$ ä¸ªç»¿æ´²ï¼Œç¬¬ $i$ ä¸ªç»¿æ´²çš„åæ ‡ä¸º $x_i$ï¼Œä¿è¯ $-10^{9}\le x_1&lt;x_2â€¦&lt;x_n\le 10^9$</p>
<p>ç°åœ¨æœ‰ä¸€ä¸ªäººåœ¨æ²™æ¼ ä¸­è¿›è¡Œæ—…è¡Œï¼Œä»–åˆå§‹çš„èƒŒåŒ…çš„æ°´å®¹ç§¯ä¸º $V$ å‡ï¼ŒåŒæ—¶ä»–åˆå§‹æ‹¥æœ‰ $V$ å‡æ°´ï¼Œæ¯æ¬¡åˆ°è¾¾ä¸€ä¸ªç»¿æ´²æ—¶ï¼Œä»–æ‹¥æœ‰çš„æ°´çš„é‡å°†è‡ªåŠ¨é‡ç½®ä¸ºå®¹ç§¯ä¸Šé™ã€‚ä»–ç°åœ¨å¯ä»¥é€‰æ‹©ä¸¤ä¸ªæ“ä½œæ¥è¿›è¡Œæ—…è¡Œï¼š</p>
<ol>
<li><p>èµ°è·¯ï¼Œè¡Œèµ°è·ç¦»ä¸º $d$ æ—¶ï¼Œéœ€è¦æ¶ˆè€— $d$ å‡æ°´ã€‚æ¸…æ³¨æ„ï¼Œä»»æ„æ—¶åˆ»ä½ æ‹¥æœ‰çš„æ°´çš„æ•°é‡ä¸èƒ½ä¸ºè´Ÿæ•°ã€‚</p>
</li>
<li><p>è·³è·ƒï¼Œä»¤ $v$ ä¸ºä½ å½“å‰æ‹¥æœ‰çš„æ°´é‡ï¼Œè‹¥ $v&gt;0$ï¼Œåˆ™ä½ å¯ä»¥è·³è·ƒè‡³ä»»æ„ä¸€ä¸ªç»¿æ´²ï¼Œç„¶åé‡ç½®å®¹ç§¯ä¸Šç•Œå’Œæ‰€æ‹¥æœ‰çš„æ°´é‡ä¸º $v/2$ ï¼ˆå››èˆäº”å…¥å–æ•´ï¼‰ã€‚</p>
</li>
</ol>
<p>å¯¹äºæ¯ä¸€ä¸ª $i$ æ»¡è¶³ $1\le i\le n$ï¼Œä½ éœ€è¦æ±‚å½“ä½ åœ¨ç¬¬ $i$ ä¸ªç»¿æ´²ä½œä¸ºèµ·ç‚¹æ—¶ï¼Œä½ èƒ½å¦ä¾æ¬¡éå†å…¶ä»–æ‰€æœ‰ç»¿æ´²ã€‚å¦‚æœå¯ä»¥ï¼Œè¾“å‡º <code>Possible</code>ï¼Œå¦åˆ™è¾“å‡º <code>Impossible</code>ã€‚</p>
<p>$1\leq n,v\leq 2\times10^5$ã€‚</p>
</blockquote>
<p>ç¥ä»™çŠ¶æ€è®¾è®¡é¢˜orz</p>
<a id="more"></a>
<p>å®šä¹‰ $G$ ä¸ºå…¨é›†ï¼Œå…·ä½“å®šä¹‰åæ–‡è¯¦è°ˆã€‚</p>
<p>é¦–å…ˆè€ƒè™‘ä¸€ç‚¹ï¼Œå°±æ˜¯æœ¬è´¨ä¸Šæœ€å¤šæœ‰ $\log V$ ç§å®¹ç§¯ï¼Œå¯ä»¥æŠŠè¿™ä¸ªçœ‹åš $\log V$ å±‚ï¼Œæ¯å±‚éƒ½æœ‰ $n$ ä¸ªç‚¹ã€‚å®šä¹‰å±‚ä¸å±‚ä¹‹é—´çš„æ–¹å‘ã€Œä»ä¸Šè‡³ä¸‹ã€ä»£è¡¨å®¹ç§¯ä¸æ–­å˜å°ï¼ŒåŒä¸Šä»ä¸Šè‡³ä¸‹ç»™æ¯ä¸€å±‚ä¸€ä¸ªé€’å¢çš„ç¼–å·ã€‚è€ƒè™‘å¯¹äºæ¯ä¸€å±‚ï¼Œå¯ä»¥æŠŠæ‰€æœ‰èƒ½å¤Ÿäº’ç›¸åˆ°è¾¾çš„è¿é€šå—ç¼©æˆå‡ æ¡çº¿æ®µï¼Œè¿™æ ·æ¯å±‚å°±æ˜¯å‡ æ¡çº¿æ®µäº†ã€‚é‚£ä¹ˆé¢˜ç›®è¦æ±‚çš„å°±æ˜¯ï¼Œåœ¨é™åˆ¶ç¬¬ä¸€å±‚é€‰æŸä¸ªçº¿æ®µæ—¶ï¼Œæ¯å±‚è‡³å¤šé€‰ä¸€ä¸ªçº¿æ®µï¼Œæ˜¯å¦å¯ä»¥è®²æ•´ä¸ª $[1,n]$ è¦†ç›–ã€‚</p>
<p>è€ƒè™‘é¦–å…ˆé¢„å¤„ç†å‡ºæ¥ $L[s][1\sim n]$ å’Œ $R[s][1\sim n]$ ï¼Œåˆ†åˆ«è¡¨ç¤ºåœ¨ç¬¬ $s$ å±‚å†…ï¼ŒæŸä¸ªç‚¹æ‰€åœ¨çº¿æ®µçš„å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹ã€‚ç„¶åè€ƒè™‘é¢„å¤„ç†å‡ºè¿™ä¹ˆä¸¤ä¸ªçŠ¶æ€ï¼š$expanL_t$ å’Œ $expanR_t$ ï¼Œè¡¨ç¤ºåªè€ƒè™‘é›†åˆ $t$ å†…çš„é‚£å‡ å±‚ï¼Œæœ€å¤šä» $1$ å‘å³æ‰©å±•è‡³ä»€ä¹ˆåœ°æ–¹å’Œæœ€å¤šä» $n$ å‘å·¦æ‰©å±•åˆ°ä»€ä¹ˆåœ°æ–¹ã€‚è€ƒè™‘å…ˆæŠŠæ‰€æœ‰åŒ…å«ç¬¬ä¸€å±‚çš„é›†åˆå¿½ç•¥ï¼Œé‚£ä¹ˆå­˜åœ¨è½¬ç§»ï¼š</p>
<script type="math/tex; mode=display">
expanL_t=\max_{s\in t}\{R[t][expanL_{t-\{s\}} +1] \}\\
expanR_t=\min_{s\in t}\{L[t][expanR_{t-\{s\}} -1] \}\\</script><p>è¿™ä¸ªè½¬ç§»ååˆ†ç¥å¥‡ã€‚ä»¥ $expanL$ çš„è½¬ç§»ä¸ºä¾‹ï¼Œæœ¬è´¨ä¸Šå¯¹äºä¸€ä¸ªé›†åˆ $t-\{s\}$ï¼Œä¸ºäº†æ±‚å‡ºè¿ç»­å—ï¼Œåº”è¯¥å»æšä¸¾ç¬¬  $s$ å±‚å†…ç¬¬ä¸€ä¸ªä¸åŒ…å«åœ¨ $expanL_{t-\{s\}}$ å†…çš„çº¿æ®µï¼Œç„¶åç”¨è¿™ä¸ªçº¿æ®µæ˜¯å³ç«¯ç‚¹æ¥æ›´æ–°ï¼Œæ‰€ä»¥æˆ–è®¸éœ€è¦ä¸€ä¸ªäºŒåˆ†ã€‚ä½†æ˜¯å…¶å®æ ¹æœ¬ä¸éœ€è¦ï¼Œç›´æ¥å¯ä»¥ç”¨ä¸Šé¢æ¨å‡ºæ¥çš„ $L[s][1\sim n]$ å’Œ $R[s][1\sim n]$ è¿›è¡Œè½¬ç§»ï¼Œè¿˜æ˜¯å¾ˆå·§å¦™çš„ã€‚</p>
<p>æœ€åå°±å¯ä»¥æšä¸¾æ¯æ¡çº¿æ®µï¼Œå»æ‰¾æ˜¯å¦å­˜åœ¨ä¸€ä¸ªä¸åŒ…å«ç¬¬ä¸€å±‚çš„çŠ¶æ€ $t$ ï¼Œ $expanL_t$ è¦†ç›–äº† $1\sim l_t$ ï¼ŒåŒæ—¶ $expanR_{G-t}$ è¦†ç›–äº† $r_{G-t}\sim n$ ï¼Œé‚£ä¹ˆå¦‚æœè¿™ä¸ªçº¿æ®µçš„å·¦å³ç«¯ç‚¹ $l,r$ åˆ†åˆ«æ»¡è¶³ $l-1\leq l_t$ å’Œ $r+1\geq r_{G-t}$ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿æ®µå†…éƒ¨çš„ç‚¹éƒ½æ˜¯åˆæ³•çš„ã€‚</p>
<p>æœ€ç»ˆå¤æ‚åº¦ $O(\max\{(n+v)\log v, n\log n\})$ ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">40</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">1001000001</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dep ;</span><br><span class="line"><span class="keyword">int</span> maxn ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, k ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> L[M][N] ;</span><br><span class="line"><span class="keyword">int</span> R[M][N] ;</span><br><span class="line"><span class="keyword">int</span> farfrl[N] ;</span><br><span class="line"><span class="keyword">int</span> farfrr[N] ;</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; rg[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init_dp</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = m ; j &gt;= <span class="number">0</span> ; j &gt;&gt;= <span class="number">1</span>)&#123;</span><br><span class="line">        R[++ dep][n + <span class="number">1</span>] = n + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            L[dep][i] = (base[i] - base[i - <span class="number">1</span>] &gt; j) ? i : L[dep][i - <span class="number">1</span>] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">            R[dep][i] = (base[i + <span class="number">1</span>] - base[i] &gt; j) ? i : R[dep][i + <span class="number">1</span>] ;</span><br><span class="line">        <span class="keyword">if</span> (!j) <span class="keyword">break</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Auxiliary_dp</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= maxn ; i += <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= dep ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>) &amp; i)&#123;</span><br><span class="line">                farfrl[i] = max(farfrl[i], R[j][ farfrl[i ^ (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))] + <span class="number">1</span>]) ;</span><br><span class="line">                farfrr[i] = min(farfrr[i], L[j][ farfrr[i ^ (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))] - <span class="number">1</span>]) ;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    base[<span class="number">0</span>] = -MAX ;</span><br><span class="line">    base[n + <span class="number">1</span>] = MAX ; k = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; Init_dp() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        rg[i].l = L[<span class="number">1</span>][i], rg[i].r = R[<span class="number">1</span>][i] ;</span><br><span class="line">    sort(rg + <span class="number">1</span>, rg + n + <span class="number">1</span>) ; maxn = (<span class="number">1</span> &lt;&lt; dep) - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= maxn ; ++ i) farfrr[i] = n + <span class="number">1</span> ;</span><br><span class="line">    k += unique(rg + <span class="number">1</span>, rg + n + <span class="number">1</span>) - rg ; Auxiliary_dp() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= maxn ; j += <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">if</span> (farfrl[j] + <span class="number">1</span> &gt;= rg[i].l &amp;&amp; farfrr[(maxn ^ j) ^ <span class="number">1</span>] - <span class="number">1</span> &lt;= rg[i].r)</span><br><span class="line">                &#123; <span class="keyword">for</span> (<span class="keyword">int</span> o = rg[i].l ; o &lt;= rg[i].r ; ++ o) ans[o] = <span class="number">1</span> ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">puts</span>(ans[i] ? <span class="string">"Possible"</span> : <span class="string">"Impossible"</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">0 8</span></span><br><span class="line"><span class="comment">0 8</span></span><br><span class="line"><span class="comment">1 7</span></span><br><span class="line"><span class="comment">0 8</span></span><br><span class="line"><span class="comment">1 7</span></span><br><span class="line"><span class="comment">0 8</span></span><br><span class="line"><span class="comment">2 6</span></span><br><span class="line"><span class="comment">0 8</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>atcoder</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/çŠ¶å‹DP</tag>
        <tag>åŠ¨æ€è§„åˆ’/æœ‰æŠ€å·§çš„DP</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘loj#6433 [PKUSC2018]æœ€å¤§å‰ç¼€å’Œ</title>
    <url>/2020/02/25/PKUSC2018%E6%9C%80%E5%A4%A7%E5%89%8D%E7%BC%80%E5%92%8C/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>ä¸€ä¸ªé•¿ä¸º $n$ çš„åºåˆ— $a_n$ï¼Œæ±‚è¿™ä¸ªåºåˆ—éšæœºæ‰“ä¹±åæœ€å¤§å‰ç¼€å’Œçš„æœŸæœ›å€¼ã€‚</p>
<p> $n â‰¤ 20, |a_i | â‰¤ 10^9$</p>
</blockquote>
<p>ä¸€é“è®©äººæ›´é€å½»åœ°ç†è§£åŠ¨æ€è§„åˆ’çš„å¥½é¢˜orz</p>
<a id="more"></a>
<p>è¿™æ˜¯ä¸ªç¥ä»™é¢˜â€¦</p>
<p>è€ƒè™‘ä»è¿™ä¸ª $dp$ çš„æœ¬è´¨å…¥æ‰‹ã€‚ä»¥ä¸‹è®° $\{a_m\}$ è¡¨ç¤ºé•¿åº¦ä¸º $m$ çš„åºåˆ— $a_1,a_2,\cdots a_m$ ã€‚</p>
<p>é¦–å…ˆï¼Œå¯¹äºä¸€ä¸ªæœ€å¤§å‰ç¼€å’Œ $(p,\{s_n\})$ è¡¨ç¤ºçš„æ˜¯ $s_1,s_2\cdots s_p$ æ„æˆè¿™ä¸ªåºåˆ—çš„æœ€å¤§å‰ç¼€å’Œï¼Œé‚£ä¹ˆæœ‰ä¸¤ä¸ªæ€§è´¨ï¼š</p>
<p>1ã€å¯¹äº $\{s_n\}$ çš„ä»»æ„ $k&gt;p$ çš„ $k\sim n$ åç¼€ï¼Œéƒ½æœ‰ $sum(k\sim n) \leq 0$ ã€‚</p>
<p>2ã€å¯¹äº $\{s_p\}$ ï¼ˆå³ $\{s_n\}$ çš„ $1\sim p$ å‰ç¼€ï¼‰çš„ä»»æ„ $k&gt;1$ çš„ $k\sim p$ åç¼€ï¼Œæœ‰ $sum(k\sim p)\geq 0$ ã€‚</p>
<p>é‚£ä¹ˆè€ƒè™‘æšä¸¾é›†åˆ $t$ï¼Œè¡¨ç¤ºè¿™ä¸ªé›†åˆçš„å…¨éƒ¨å…ƒç´ éƒ½ç”¨æ¥è´¡çŒ®æœ€å¤§å‰ç¼€å’Œï¼Œè®° $f_t$ ä¸ºæ»¡è¶³æ¡ä»¶2çš„æ’åˆ—æ–¹æ¡ˆæ•°ï¼Œ$g_t$ ä¸ºæ»¡è¶³æ¡ä»¶1çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆè€ƒè™‘å¦‚ä½•æŒ‰ç§©è½¬ç§»ã€‚å¯¹äºå·²ç»æœ‰çš„ä¸€ä¸ªæ’åˆ—ï¼Œè€ƒè™‘åœ¨åºåˆ—æœ€å‰ç«¯åŠ ä¸€ä¸ªæ•°oråœ¨åºåˆ—æœ€åç«¯åŠ ä¸€ä¸ªæ•°ï¼Œè¿™æ ·æˆ‘ä»¬ä¿è¯äº†æŒ‰ç§©çš„åŒæ—¶ï¼Œå¯ä»¥æ¯”è¾ƒæ–¹ä¾¿åœ°è®¨è®ºï¼š</p>
<p>1ã€å¦‚æœ $sum_t&lt;0$ ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‘ $\forall \{k\}\operatorname{and} t=\empty,k$ çš„ $g_{t\cup\{k\}}$ è´¡çŒ® $g_t$ çš„æ–¹æ¡ˆæ•°ï¼Œä¹Ÿå°±æ˜¯å‘åºåˆ—åæ–¹æ·»ä¸€ä¸ªæ•°ã€‚</p>
<p>2ã€å¦‚æœ $sum_t\geq 0$ ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‘ $\forall \{k\}\operatorname{and} t=\empty,k$ çš„ $f_{t\cup\{k\}}$ è´¡çŒ® $f_{t}$ çš„æ–¹æ¡ˆæ•°ï¼Œä¹Ÿå°±æ˜¯å‘åºåˆ—å‰ç«¯æ·»ä¸€ä¸ªæ•°ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸ªåœ°æ–¹æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœæœ€å¤§çš„å‰ç¼€å’Œä¸ºè´Ÿï¼Œä»–ä¾ç„¶æœ‰è´¡çŒ®ï¼Œä½†æ˜¯æ²¡æœ‰ç»Ÿè®¡ã€‚è€ƒè™‘ä¸€ä¸ªè´ªå¿ƒçš„æ€§è´¨å¦‚æœæœ€å¤§å‰ç¼€å’Œä¸ºè´Ÿï¼Œé‚£ä¹ˆè‚¯å®šæœ€å¤§å‰ç¼€å’Œåªæœ‰ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚æ‰€ä»¥ä¸€å¼€å§‹æŠŠæ‰€æœ‰åªæœ‰ä¸€ä¸ªå…ƒç´ çš„ $f$ éƒ½ç½®ä¸º $1$ å³å¯ã€‚</p>
<p>è¿™ä¸ªåœ°æ–¹æœ‰ä¸ªå¾ˆéœ€è¦å­¦ä¹ çš„åœ°æ–¹ï¼Œå°±æ˜¯ <strong>åˆ·è¡¨æ³•åœ¨æ­¤å¤„ç”±äºå’Œdpçš„æ¨æ³•ä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯åœ¨æ¨¡æ‹ŸåŠ å…¥ä¸€ä¸ªæ•°çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥åˆ·è¡¨ä¼šæ¯”è¾ƒè‡ªç„¶ï¼Œè€Œæœ´ç´ åœ°å¡«è¡¨å°±ä¼šå‡ºé”™</strong>ã€‚</p>
<p>å—¯ï¼Œæ‹¿å°æœ¬æœ¬è®°ä¸‹æ¥äº†/kel</p>
<p>äºæ˜¯æœ€åç­”æ¡ˆå°±æ˜¯ï¼š </p>
<script type="math/tex; mode=display">
\sum_{tâŠ† m} sum_{\mathrm{t}}\cdot f_{\mathrm{t}}\cdot g_{\mathrm{m}-\mathrm{t}}</script><p>ä»¥ä¸‹æ˜¯å‘srzå­¦ä¹ çš„dpæ–¹å¼ï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯åœ¨æšä¸¾ $&gt;0$ åç¼€ï¼š</p>
<p>è€ƒè™‘å¦ä¸€ç§æ¨ $f$ çš„æ–¹å¼ï¼Œè€ƒè™‘æœ¬è´¨ä¸Š $f_t$ è®¡ç®—çš„æ˜¯æœ‰å¤šå°‘ç§æ–¹æ¡ˆä½¿å¾— $sum_t$ æˆä¸ºæœ€å¤§å‰ç¼€å’Œï¼Œé‚£ä¹ˆå°±å¯ä»¥è¿™ä¹ˆè½¬ç§»ï¼š</p>
<script type="math/tex; mode=display">
f_t=|t|!-\sum_{sâŠ†t}f_s\cdot g_{t-s}</script><p>ä¹Ÿå°±æ˜¯æšä¸¾æœ‰å¤šå°‘ç§ä¸åˆæ³•çš„æ–¹æ¡ˆï¼Œé€šè¿‡å­é›†è½¬ç§»ã€‚è£¸çš„è½¬ç§»æ˜¯ $3^n$ çš„ï¼Œä½†è§‚å¯Ÿåˆ°æœ¬è´¨ä¸Šæ˜¯åœ¨åšä¸€ä¸ªé›†åˆçš„å¯¹ç§°å·®ï¼Œäºæ˜¯å¯ä»¥ç”¨ $\rm FWT$ ä¼˜åŒ–åˆ° $2^nn^2$ ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> low(x) (x &amp; (-x))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">22</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2000010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> m ;</span><br><span class="line">LL ans ;</span><br><span class="line">LL f[M] ;</span><br><span class="line">LL g[M] ;</span><br><span class="line">LL sum[M] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">expow</span><span class="params">(LL a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            (res *= a) %= P ;</span><br><span class="line">        (a *= a) %= P ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    m = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span> ; g[<span class="number">0</span>] = <span class="number">1l</span>l ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i) f[<span class="number">1</span> &lt;&lt; i] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; base[i], sum[<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>)] = base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        sum[i] = (sum[low(i)] + sum[i ^ low(i)]) % P ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (sum[i] &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; n ; ++ j)</span><br><span class="line">                <span class="keyword">if</span> (!((<span class="number">1</span> &lt;&lt; j) &amp; i)) (f[i | (<span class="number">1</span> &lt;&lt; j)] += f[i]) %= P ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; n ; ++ j)</span><br><span class="line">                <span class="keyword">if</span> ((<span class="number">1</span> &lt;&lt; j) &amp; i) (g[i] += g[(<span class="number">1</span> &lt;&lt; j) ^ i]) %= P ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        (ans += sum[i] * f[i] % P * g[m ^ i] % P) %= P ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; (((ans % P) + P) % P) &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>loj</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/çŠ¶å‹DP</tag>
        <tag>åŠ¨æ€è§„åˆ’/æœ‰æŠ€å·§çš„DP</tag>
        <tag>æ•°å­¦/æ¦‚ç‡,æœŸæœ›</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘[ARC066F]Contest with Drinks(Hard)</title>
    <url>/2020/02/23/ARC066F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>æœ‰ $n$ ä¸ªç‚¹ï¼Œé€‰æ‹©ç¬¬ $i$ ä¸ªç‚¹æœ‰ $a_i$ çš„ä»£ä»·ã€‚å¦‚æœä¸€ä¸ªæå¤§çš„ã€é•¿åº¦ä¸º $L$ çš„åŒºé—´å†…çš„ç‚¹éƒ½è¢«é€‰äº†ï¼Œè¿™ä¸ªåŒºé—´ä¼šå¸¦æ¥$\frac{L^2+L}{2}$ çš„æ”¶ç›Šã€‚</p>
<p>è¯¢é—®å…± $q$ ç»„ï¼Œä¸ºå¯¹ $a_i$ çš„å•ç‚¹ä¿®æ”¹ã€‚ è¯¢é—®å½¼æ­¤ç‹¬ç«‹ã€‚</p>
<p>å½¢å¼åŒ–åœ°è®²ï¼Œç»™å®š $\{t_n\}$ ï¼Œæ±‚ä¸€ç»„ $\{x_n\},\forall i \in[1, n], x_{i} \in[0,1]$ ä½¿å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\max \left\{\sum_{i=1}^{n} \sum_{j=i}^{n}\left(\prod_{k=i}^{j} x_{k}\right)-\sum_{i=1}^{n} x_{i} t_{i}\right\}</script><p>$n, q â‰¤ 3 Ã— 10^5$</p>
</blockquote>
<p>ä¸€é“ç¥é¢˜â€¦æœ¬è´¨ä¸Šè™½ç„¶ä¸æ˜¯å¾ˆéš¾ï¼Œä½†æ˜¯ç¢äºä¸ªäººå¯¹æ–œç‡ä¼˜åŒ–è¿™ä¸ªä¸œè¥¿æŒæ¡çš„å®åœ¨ååˆ†å·®åŠ²ï¼Œæ‰€ä»¥å‡ ä¹æŠŠæ‰€æœ‰èƒ½è¸©çš„å‘å…¨è¸©äº†ä¸€éã€‚</p>
<a id="more"></a>
<h1 id="rm-Sol"><a href="#rm-Sol" class="headerlink" title="$\rm Sol$"></a>$\rm Sol$</h1><p>é¦–å…ˆè€ƒè™‘å¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œä¸»è¦æ€æƒ³æ˜¯ç»´æŠ¤ä¸€ä¸ªå‰ç¼€çš„ $f_i$ è¡¨ç¤ºä¸é€‰ $i$ ï¼Œå‰ $i-1$ ä¸ªå…ƒç´ çš„æœ€ä¼˜è§£ï¼›$g_i$ åˆ™æ˜¯ç”¨æ¥ç»´æŠ¤ä¸€ä¸ªåç¼€ï¼Œè¡¨ç¤ºä¸é€‰ $i$ï¼Œ$i+1\sim n$ ä¸­å…ƒç´ çš„æœ€ä¼˜è§£ã€‚åŒæ—¶ï¼Œå†ç»´æŠ¤ä¸€ä¸ª $h_i$ è¡¨ç¤ºé€‰äº† $i$ çš„å…¨å±€æœ€ä¼˜è§£ã€‚é‚£ä¹ˆè¿™æ ·å°±å¯ä»¥å¦‚æ­¤å›ç­”è¯¢é—®ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> (m --)&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;p, &amp;x) ;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, max(f[p] + g[p], o[p] + base[p] - x)) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯è€ƒè™‘è¿™ä¸‰ä¸ªä¸œè¥¿åº”è¯¥æ€ä¹ˆè½¬ç§»ã€‚å…ˆè€ƒè™‘ $f$ :</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_i&=\max\{f_j+\frac{(i-j)(i-j-1)}{2}-(s_i-s_j)\}\\
f_i&=\max\{f_i,f_{i-1}\}
\end{aligned}</script><p>æšä¸¾çš„æ˜¯ $[j,i-1]$ è¿™æ®µåŒºé—´ã€‚</p>
<p>å˜å½¢å¯å¾—</p>
<script type="math/tex; mode=display">
f_j+s_j+\frac{j^2+j}{2}=i\cdot j+f_i+s_i- \frac{i^2-i}{2}</script><p>äºæ˜¯å°±å‘ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªä»¥ $f_j+s_j+\frac{j^2+j}{2}$ ä¸ºçºµåæ ‡ï¼Œ$i$ ä¸ºæ–œç‡çš„æ–œç‡ä¼˜åŒ–ã€‚è§‚å¯Ÿå¯çŸ¥ï¼Œæ¨ªåæ ‡ $j$ å•å¢ï¼ŒåŒæ—¶æ–œç‡ $i$ ä¹Ÿå•å¢ã€‚æ‰€ä»¥å¯¹äºè¿™ç§ç±»å‹çš„ $dp$ åªèƒ½ç”¨<strong>å•è°ƒæ ˆ</strong>æ¥ç»´æŠ¤ã€‚</p>
<p>åŒæ—¶ï¼Œå…³äº $g$ï¼Œåªéœ€è¦å€’ç€åšä¸€é $f$ çš„ $dp$ å³å¯ã€‚ </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">LL <span class="title">calc0</span><span class="params">(LL x, LL y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x - y) * (x - y - <span class="number">1</span>) / <span class="number">2l</span>l ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">Y</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> f[x] + s[x] + (x * x + x) / <span class="number">2l</span>l ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">YY</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> g[x] + s[x] + (x * x + x) / <span class="number">2l</span>l ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1.0</span> * (<span class="number">1.0</span> * Y(x) - <span class="number">1.0</span> * Y(y)) / (<span class="number">1.0</span> * x - <span class="number">1.0</span> * y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1.0</span> * (<span class="number">1.0</span> * YY(x) - <span class="number">1.0</span> * YY(y)) / (<span class="number">1.0</span> * x - <span class="number">1.0</span> * y) ;</span><br><span class="line">&#125;</span><br><span class="line">......</span><br><span class="line">stk[++ t] = <span class="number">0</span> ; s[n + <span class="number">1</span>] = s[n] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n + <span class="number">1</span> ; ++ i)&#123;</span><br><span class="line">    <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; slope1(stk[t], stk[t - <span class="number">1</span>]) &lt;= i) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">    f[i] = max(f[i - <span class="number">1</span>], f[stk[t]] + calc0(i, stk[t]) - s[i - <span class="number">1</span>] + s[stk[t]]) ;</span><br><span class="line">    <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; slope1(stk[t], stk[t - <span class="number">1</span>]) &lt;= slope1(i, stk[t])) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">    stk[++ t] = i ;</span><br><span class="line">&#125;</span><br><span class="line">reverse(base + <span class="number">1</span>, base + n + <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n + <span class="number">1</span> ; ++ i) s[i] = s[i - <span class="number">1</span>] + base[i] ;</span><br><span class="line"><span class="keyword">while</span> (t) stk[t --] = <span class="number">0</span> ; t = <span class="number">0</span> ; stk[++ t] = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n + <span class="number">1</span> ; ++ i)&#123;</span><br><span class="line">    <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; slope2(stk[t], stk[t - <span class="number">1</span>]) &lt;= i) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">    g[i] = max(g[i - <span class="number">1</span>], g[stk[t]] + calc0(i, stk[t]) - s[i - <span class="number">1</span>] + s[stk[t]]) ;</span><br><span class="line">    <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; slope2(stk[t], stk[t - <span class="number">1</span>]) &lt;= slope2(i, stk[t])) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">    stk[++ t] = i ;</span><br><span class="line">&#125;</span><br><span class="line">reverse(g + <span class="number">1</span>, g + n + <span class="number">1</span>) ;</span><br></pre></td></tr></table></figure>
<p>è€ƒè™‘å…³äºäº $h$ çš„è½¬ç§»ï¼Œæœ´ç´ çš„è½¬ç§»æ˜¯ $O(n^3)$ çš„ï¼Œç±»ä¼¼è¿™æ ·ï¼š</p>
<script type="math/tex; mode=display">
h_i=\max_{x\leq i\leq y}\{f_x+\frac{(y-x+1)(y-x+2)}{2}-s_y+s_x+g_y\}</script><p>å‘ç°å¹¶ä¸å¯ä»¥è¿‡ã€‚å‘ç°è½¬ç§»æ˜¯ä¸€ä¸ªåŒºé—´çš„å½¢å¼ï¼Œäºæ˜¯è€ƒè™‘åˆ†æ²»ã€‚ä½†æ˜¯è¿™ä¸ªåˆ†æ²»æœ‰ä¸ª $bug$ ï¼Œå°±æ˜¯ä¸æ˜¯å¾ˆå®¹æ˜“ç»´æŠ¤è·¨è¿‡ $mid$ çš„ä¿¡æ¯ã€‚</p>
<p>ä½†å‘ç°ä¸€ä¸ªæ€§è´¨ï¼Œå¯¹äº $[mid+1,r]$ ä¹‹é—´çš„æ‰€æœ‰ $h$ å€¼ï¼Œå·¦è¾¹çš„æ‰€æœ‰ç‚¹ä»…ä»…æ˜¯å¸®åŠ©å…¶æˆä¸ºæœ€ä¼˜è§£ï¼Œä¹Ÿå°±æ˜¯å·¦è¾¹å¯¹å³è¾¹çš„ç‚¹æ»¡è¶³å•è°ƒæ€§ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨å•è°ƒæ ˆæ¥ç»´æŠ¤ä¸Šä¸€ä¸ªä¸é€‰çš„ï¼ˆå³ç»´æŠ¤ $x$ï¼‰åŒæ—¶æšä¸¾æœ€åé€‰çš„ï¼ˆæšä¸¾ $y$ï¼‰ï¼Œå³ç”¨ $[l,mid]$ çš„å€¼å»æ›´æ–° $[mid+1,r]$ï¼›åŒç†å¯¹äºå³åŠè¾¹æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™ä¹ˆåšã€‚</p>
<p>å…·ä½“çš„ï¼Œä»¥ç”¨ $[l,mid]$ çš„å€¼å»æ›´æ–° $[mid+1,r]$ ä¸ºä¾‹ï¼Œåœ¨ç®—å·¦åŠè¾¹çš„å†³ç­–é›†åˆçš„æ—¶å€™ï¼Œä¸éœ€è¦è€ƒè™‘ $g_y$ çš„è´¡çŒ®ï¼Œæ‰€ä»¥å°±æ˜¯ä¸€ä¸ªè£¸çš„æ–œç‡ä¼˜åŒ–ï¼›ä¹‹åè½¬ç§»å°±åªéœ€è¦å¼¹æ ˆè½¬ç§»å³å¯ã€‚</p>
<p>å‘ç°åœ¨è½¬ç§» $h$ çš„æ—¶å€™ï¼Œç”±äºå›ºå®šäº†å…¶ä¸­ä¸€ä¸ªç«¯ç‚¹ï¼Œä¾ç„¶æ»¡è¶³æ–œç‡ä¼˜åŒ–ï¼Œäºæ˜¯å¤æ‚åº¦ä¸º $\max\{n\log n, Q\}$ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å‘ç‚¹ï¼š</p>
<p>1ã€æ³¨æ„å¦‚æœæŒ‰ç…§ä¸Šè¿°æ–¹å¼æ¥è½¬ç§»ï¼Œä¸¤ä¸ªè½¬ç§»å¸¸æ•°æœ‰äº›å¾®ä¸åŒï¼ˆä½†æ˜¯è¿™äº›ä¸åŒå¾ˆè‡´å‘½</p>
<p>2ã€æ³¨æ„å› ä¸ºä¸€å¼€å§‹ $\{g_n\}$ è¿™ä¸ªä¸œè¥¿æ˜¯æŒ‰ç…§ <code>reverse</code> çš„å‰ç¼€å’Œæ¥è½¬ç§»çš„ï¼Œæ‰€ä»¥åœ¨åˆ†æ²»çš„æ—¶å€™éœ€è¦é‡æ–°è®¡ç®—å‰ç¼€å’Œã€‚</p>
<p>3ã€åœ¨åˆ†æ²»çš„æ—¶å€™ï¼Œæ–œç‡å•Šä»€ä¹ˆçš„å˜æ¢é¢‘ç¹ï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦æ¨æ˜ç™½ï¼Œå¯ä»¥åœ¨ç»´æŠ¤ä¸Šå‡¸å£³çš„æ—¶å€™å·æ‡’è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define tranl(b,a) g[a + 1] - s[a] + S[b] + F[b] + 1ll * ((a - b)*(a - b + 1)/ 2ll)</span><br><span class="line">#define tranr(b,a) f[a - 1] - s[a] + S[b] + G[b] + 1ll * ((b - a)*(b - a + 1)/ 2ll)</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ¯æ¬¡æ¯”è¾ƒå°±ä¸éœ€è¦æ–œç‡äº†ï¼Œåªéœ€è¦ <code>while (top &gt; 1 &amp;&amp; tranl(stk[top], i) &lt;= tranr(stk[top - 1], i)) -- top</code> ;  è™½ç„¶æ˜¾ç„¶æœ¬è´¨ä¸Šæ²¡ä»€ä¹ˆä¸åŒï¼Œä½†è¿™æ ·æˆ–è®¸ä¼šç®€å•å¾ˆå¤šã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">600010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL ;</span><br><span class="line"></span><br><span class="line">LL f[N] ;</span><br><span class="line">LL g[N] ;</span><br><span class="line">LL o[N] ;</span><br><span class="line">LL s[N] ;</span><br><span class="line">LL tmp[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> t ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> stk[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">calc</span><span class="params">(LL x, LL y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x - y) * (x - y + <span class="number">1</span>) / <span class="number">2l</span>l ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">calc0</span><span class="params">(LL x, LL y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x - y) * (x - y - <span class="number">1</span>) / <span class="number">2l</span>l ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">Y</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> f[x] + s[x] + (x * x + x) / <span class="number">2l</span>l ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">YY</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> g[x] + s[x] + (x * x + x) / <span class="number">2l</span>l ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1.0</span> * (<span class="number">1.0</span> * Y(x) - <span class="number">1.0</span> * Y(y)) / (<span class="number">1.0</span> * x - <span class="number">1.0</span> * y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1.0</span> * (<span class="number">1.0</span> * YY(x) - <span class="number">1.0</span> * YY(y)) / (<span class="number">1.0</span> * x - <span class="number">1.0</span> * y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">Y2</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> f[x] + s[x] + (x * x - x) / <span class="number">2l</span>l ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">YY2</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> g[x] + s[x] + (x * x - x) / <span class="number">2l</span>l ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Slope1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1.0</span> * (<span class="number">1.0</span> * Y2(x) - <span class="number">1.0</span> * Y2(y)) / (<span class="number">1.0</span> * x - <span class="number">1.0</span> * y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Slope2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1.0</span> * (<span class="number">1.0</span> * YY2(x) - <span class="number">1.0</span> * YY2(y)) / (<span class="number">1.0</span> * x - <span class="number">1.0</span> * y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> o[l] = max(o[l], f[l - <span class="number">1</span>] + g[r + <span class="number">1</span>] + <span class="number">1</span> - base[l]), <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; LL ans ;</span><br><span class="line">    solve(l, mid) ; solve(mid + <span class="number">1</span>, r) ;</span><br><span class="line">    s[l - <span class="number">1</span>] = s[r + <span class="number">1</span>] = <span class="number">0</span> ; t = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">        tmp[i] = -(<span class="number">1l</span>l &lt;&lt; <span class="number">62</span>), s[i] = s[i - <span class="number">1</span>] + base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l - <span class="number">1</span> ; i &lt;= mid ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; slope1(stk[t], stk[t - <span class="number">1</span>]) &lt;= slope1(i, stk[t])) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">        stk[++ t] = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = mid + <span class="number">1</span> ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; Slope1(stk[t], stk[t - <span class="number">1</span>]) &lt;= i) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">        tmp[i] = f[stk[t]] + calc(i, stk[t]) - s[i] + s[stk[t]] + g[i + <span class="number">1</span>] ;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = -(<span class="number">1l</span>l &lt;&lt; <span class="number">62</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = r ; i &gt;= mid + <span class="number">1</span> ; -- i)</span><br><span class="line">        ans = max(ans, tmp[i]), o[i] = max(o[i], ans) ;</span><br><span class="line">    t = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = r ; i &gt;= l ; -- i) s[i] = s[i + <span class="number">1</span>] + base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = r + <span class="number">1</span> ; i &gt; mid ; -- i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; slope2(stk[t], stk[t - <span class="number">1</span>]) &gt;= slope2(i, stk[t])) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">        stk[++ t] = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = mid ; i &gt;= l ; -- i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; Slope2(stk[t], stk[t - <span class="number">1</span>]) &gt;= i) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">        tmp[i] = g[stk[t]] + calc(stk[t], i) - s[i] + s[stk[t]] + f[i - <span class="number">1</span>] ;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = -(<span class="number">1l</span>l &lt;&lt; <span class="number">62</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= mid ; ++ i)</span><br><span class="line">        ans = max(ans, tmp[i]), o[i] = max(o[i], ans) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    freopen(<span class="string">"2.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>) ;</span><br><span class="line">    freopen(<span class="string">"1.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>) ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    t = <span class="number">0</span> ; <span class="keyword">int</span> p, x ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]),</span><br><span class="line">        o[i] = - (<span class="number">1l</span>l  &lt;&lt;  <span class="number">62</span>),</span><br><span class="line">        s[i] = s[i - <span class="number">1</span>] + base[i] ;</span><br><span class="line">    &#125;</span><br><span class="line">    stk[++ t] = <span class="number">0</span> ; s[n + <span class="number">1</span>] = s[n] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n + <span class="number">1</span> ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; slope1(stk[t], stk[t - <span class="number">1</span>]) &lt;= i) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">        f[i] = max(f[i - <span class="number">1</span>], f[stk[t]] + calc0(i, stk[t]) - s[i - <span class="number">1</span>] + s[stk[t]]) ;</span><br><span class="line">        <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; slope1(stk[t], stk[t - <span class="number">1</span>]) &lt;= slope1(i, stk[t])) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">        stk[++ t] = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    reverse(base + <span class="number">1</span>, base + n + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n + <span class="number">1</span> ; ++ i) s[i] = s[i - <span class="number">1</span>] + base[i] ;</span><br><span class="line">    <span class="keyword">while</span> (t) stk[t --] = <span class="number">0</span> ; t = <span class="number">0</span> ; stk[++ t] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n + <span class="number">1</span> ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; slope2(stk[t], stk[t - <span class="number">1</span>]) &lt;= i) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">        g[i] = max(g[i - <span class="number">1</span>], g[stk[t]] + calc0(i, stk[t]) - s[i - <span class="number">1</span>] + s[stk[t]]) ;</span><br><span class="line">        <span class="keyword">while</span> (t &gt; <span class="number">1</span> &amp;&amp; slope2(stk[t], stk[t - <span class="number">1</span>]) &lt;= slope2(i, stk[t])) stk[t --] = <span class="number">0</span> ;</span><br><span class="line">        stk[++ t] = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    reverse(g + <span class="number">1</span>, g + n + <span class="number">1</span>) ;</span><br><span class="line">    g[<span class="number">0</span>] = g[n + <span class="number">1</span>], g[n + <span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">    reverse(base + <span class="number">1</span>, base + n + <span class="number">1</span>) ;</span><br><span class="line">    <span class="comment">//for (int i = 0 ; i &lt;= n + 1 ; ++ i) cout &lt;&lt; f[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">    <span class="comment">//for (int i = 0 ; i &lt;= n + 1 ; ++ i) cout &lt;&lt; g[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">    solve(<span class="number">1</span>, n) ; <span class="built_in">cin</span> &gt;&gt; m ;</span><br><span class="line">    <span class="comment">//for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; o[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">    <span class="keyword">while</span> (m --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;p, &amp;x) ;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, max(f[p] + g[p], o[p] + base[p] - x)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>è¿™é¢˜æˆ‘ä» <code>2020.2.22</code> çš„æ™šä¸Š7ç‚¹å¼€å§‹å†™ï¼Œ<del>ä¸­é—´çœ‹äº†ä¸¤ä¸ªå°æ—¶CèŒç›´æ’­è¡Œå°¸èµ°è‚‰å¹¶ä¸”ç¡äº†ä¸€ä¸ªå°æ—¶</del>ï¼Œæœ¬æ¥å†™çš„å¾ˆé¡ºï¼Œåæ¥å‘ç°ä¸€å †ç»†èŠ‚æ²¡è€ƒè™‘å°±å¼€å§‹è‡ªé—­äº†ï¼Œ<del>æ„Ÿè§‰å°±æ˜¯è¡Œå°¸èµ°è‚‰å¤ªå¸¦åŠ²äº†æ€è·¯æ–­äº†</del>ï¼Œ$1$ ç‚¹å‚æ­»æ¢¦ä¸­æƒŠåèµ·ä¹‹ååœ¨é»‘é»‘çš„æˆ¿é—´é‡Œ <code>debug</code> åˆ°äº†æ—©ä¸Š4ç‚¹ï¼Œç¡äº†3.5hä¹‹åèµ·æ¥å‘ç°åªå‰©ä¸€ä¸ªã€Œ $g$ å½“æ—¶æ˜¯å€’ç€æ±‚çš„ã€è¿™ä¹ˆä¸€ä¸ªé—®é¢˜äº†ï¼Œä½†ä¸å¹¸èµ°äº†å¾ˆå¤šå¼¯è·¯ï¼Œä¸è¿‡æœ€ç»ˆè¿˜æ˜¯ACäº†â€¦</p>
<p>å…¶å®æœ‰æ—¶å€™æ ¹æœ¬ä¸çŸ¥é“è‡ªå·±ä¸ºå•¥è¦è¿™ä¹ˆåšï¼Œè¿™ä¹ˆåšçš„æ„ä¹‰ä¼¼ä¹ä¹Ÿä¸æ˜¯å¾ˆå¤§ï¼Œä¸­é€”ç ´åäº†è‡ªå·±æœ¬æ¥æƒ³æ—©ç¡æ—©èµ·çš„è®¡åˆ’ã€æµªè´¹äº†ä¸€åœº300iqå‡ºçš„æ¯”èµ›å¤–åŠ å’Œè€å¦ˆåµäº†ä¸€æ¶ã€‚</p>
<p>ä½†å¯èƒ½äººç”Ÿä¸­æ²¡æ„ä¹‰çš„äº‹æƒ…è¿˜å¤šçš„å¤šï¼Œå¹¶ä¸”ä¸€ä»¶æ›´æ¯”ä¸€ä»¶æ²¡æ„ä¹‰ï¼Œæ‰€ä»¥å¯èƒ½ä¹Ÿä¸éœ€è¦è¿™ä¹ˆä¼¤å¿ƒã€‚</p>
<p>å®‰å•¦å®‰å•¦ï¼Œè¿˜è¦ç»§ç»­èµ°ä¸‹å»å•Šã€‚</p>
<p><img src="1.png" alt></p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>atcoder</category>
      </categories>
      <tags>
        <tag>åˆ†æ²»</tag>
        <tag>ç”Ÿæ´»ç¢ç‰‡</tag>
        <tag>åŠ¨æ€è§„åˆ’/æ–œç‡ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ³›å­¦ç¬”è®°ã€‘åŠ¨æ€è§„åˆ’æ‚é¡¹</title>
    <url>/2020/02/22/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E6%9D%82%E9%A1%B9/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å…¶å®å°±æ˜¯å¬è¯¾ç¬”è®°ï¼Œä½†åæ¥å‘ç°æ²¡å•¥å¯å¬çš„å°±å˜æˆäº†åšé¢˜ç¬”è®°(?)</p>
<a id="more"></a>
<h1 id="å•è°ƒé˜Ÿåˆ—éƒ¨åˆ†"><a href="#å•è°ƒé˜Ÿåˆ—éƒ¨åˆ†" class="headerlink" title="å•è°ƒé˜Ÿåˆ—éƒ¨åˆ†"></a>å•è°ƒé˜Ÿåˆ—éƒ¨åˆ†</h1><p>å•è°ƒé˜Ÿåˆ—ä¸»è¦ç”¨æ¥ä¼˜åŒ–ï¼Œå¯¹äºçŠ¶æ€ $\rm S$ çš„æŸä¸ªåç»§çŠ¶æ€ $\rm Sâ€™$ï¼Œå¦‚æœ $\rm Sâ€™$ æ¯” $\rm S$ æ›´ä¼˜å°±å¯ä»¥èˆå¼ƒæ‰ $\rm S$ çš„è½¬ç§»ã€‚é€šå¸¸è¡¨ç°å½¢å¼ä¸ºä¼šæœ‰é™åˆ¶ï¼Œæ¯”å¦‚</p>
<script type="math/tex; mode=display">
f_{i}=\max\{f_j\}+w_i \quad(j\in[L_i,i-1]\cap\mathbb Z)</script><p>å…¶ä¸­ $\{L\}$ æ˜¯ä¸€ä¸ªç»™å®šå¸¸æ•°ï¼Œä¸” $\forall i, L_i\geq L_{i-1}$ ã€‚é‚£ä¹ˆå¯çŸ¥å¯¹äºåç»­çŠ¶æ€ $s_i$ ï¼Œä»–çš„å¯è½¬ç§»èŒƒå›´ä¸€å®šæ›´å¤§ï¼Œè‡³å°‘æ¯” $s_j$ å¤§ï¼Œæ‰€ä»¥å¯ä»¥åˆ é™¤ $s_j$.</p>
<h2 id="å¤šé‡èƒŒåŒ…"><a href="#å¤šé‡èƒŒåŒ…" class="headerlink" title="å¤šé‡èƒŒåŒ…"></a>å¤šé‡èƒŒåŒ…</h2><p>è€ƒè™‘åŸæœ¬çš„è½¬ç§»</p>
<script type="math/tex; mode=display">
f_{i,j}=\max\{f_{i-1,j-k\cdot w_i}\}+k\cdot v_i\quad (1\leq k\leq c_i)</script><p>å…¶ä¸­éœ€è¦ä¼˜åŒ–æ‰çš„æ˜¯ $k$ è¿™ä¸€ç»´ï¼Œå‘ç°ä»–åŸæœ¬å¹¶æ²¡æœ‰ä»»ä½•å¯¹äºè½¬ç§»å•è°ƒçš„é™åˆ¶ï¼Œäºæ˜¯è€ƒè™‘å˜ä¸€ä¸‹å½¢ã€‚</p>
<p>ä»¤ $d=j\bmod w_i$ï¼Œ$s=\lfloor\frac{j}{w_i}\rfloor$ï¼Œé‚£ä¹ˆè½¬ç§»å°±å¯ä»¥å†™ä½œ</p>
<script type="math/tex; mode=display">
f_{i,j}=\max\{f_{i-1,d+k\cdot w_i}-k\cdot v_i\}+s\cdot v_i \quad (s-k\leq c_i)</script><p>å‘ç°è½¬ç§»æ¡ä»¶ $s-k\leq c_i\Longrightarrow k\geq s-c_i=\lfloor\frac{j}{w_i}\rfloor-c_i$ ï¼Œå¯çŸ¥ $L_i$ ä¸é™ï¼Œäºæ˜¯å°±å¯¹æ¯ä¸ª $d$ ç”¨å•è°ƒé˜Ÿåˆ—å³å¯ã€‚</p>
<h1 id="æ–œç‡ä¼˜åŒ–éƒ¨åˆ†"><a href="#æ–œç‡ä¼˜åŒ–éƒ¨åˆ†" class="headerlink" title="æ–œç‡ä¼˜åŒ–éƒ¨åˆ†"></a>æ–œç‡ä¼˜åŒ–éƒ¨åˆ†</h1><p>è¿™éƒ¨åˆ†è™½ç„¶ç®€å•ä½†æ˜¯ä¸ç†Ÿï¼Œæ‰€ä»¥å¯èƒ½éœ€è¦å¤šåšç‚¹é¢˜ã€‚</p>
<h2 id="å‚»ç‹—é¢˜"><a href="#å‚»ç‹—é¢˜" class="headerlink" title="å‚»ç‹—é¢˜"></a>å‚»ç‹—é¢˜</h2><blockquote>
<p>æŠŠä¸€ä¸ªé•¿ä¸º $n$ çš„æ­£æ•´æ•°åºåˆ—åˆ’åˆ†æˆè‹¥å¹²æ®µï¼Œæ¯ä¸€æ®µçš„ä»£ä»·æ˜¯å†…éƒ¨å…ƒç´ å’Œçš„å¹³æ–¹åŠ ä¸Šä¸€ä¸ªå®šå€¼ $m$ã€‚æ±‚åˆ’åˆ†æ•´ä¸ªåºåˆ—çš„æœ€å°ä»£ä»·ã€‚</p>
</blockquote>
<p>å¯çŸ¥è½¬ç§»</p>
<script type="math/tex; mode=display">
f_i=\min\{f_j+(s_i-s_j)^2\}+m</script><script type="math/tex; mode=display">
f_j+s_j^2=2s_is_j+f_i-s_i^2-m</script><p>äºæ˜¯å°±å˜æˆäº†æœ‰ä¸€ä¸ªä»¥ $s_i$ ä¸ºæ–œç‡ï¼Œ$f_j+s_j^2$ ä¸ºçºµåæ ‡ï¼Œ$s_i$ ä¸ºæ¨ªåæ ‡çš„æ–œç‡ä¼˜åŒ–ã€‚è€ƒè™‘æ¨ªåæ ‡å’Œæ–œç‡éƒ½æ˜¯å•è°ƒçš„ï¼Œå°±å¯ä»¥ç›´æ¥é˜Ÿå°¾åˆ /é˜Ÿå°¾æ’å…¥ã€‚</p>
<h2 id="USACO08MAR-Land-Acquisition"><a href="#USACO08MAR-Land-Acquisition" class="headerlink" title="[USACO08MAR]Land Acquisition"></a>[USACO08MAR]Land Acquisition</h2><blockquote>
<p>æœ‰ $n$ å—é•¿æ–¹å½¢çš„åœŸåœ°éœ€è¦è´­ä¹°ï¼Œä½ æ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€ç»„åœŸåœ°ä¸€èµ·è´­ä¹°ï¼Œä»· æ ¼ä¸ºè¿™äº›åœŸåœ°ä¸­æœ€å¤§çš„é•¿ä¹˜ä»¥æœ€å¤§çš„å®½ã€‚æ±‚è´­ä¹°æ‰€æœ‰åœŸåœ°çš„æœ€å°è´¹ç”¨ã€‚ </p>
<p>$n â‰¤ 50000$</p>
</blockquote>
<p>è€ƒè™‘å…ˆæ’åºï¼Œç„¶åè€ƒè™‘å¦‚æœç›´æ¥ $dp$ï¼Œé‚£ä¹ˆæœ¬èº«éœ€è¦æšä¸¾ $i\sim j$ ä¹‹é—´çš„å…ƒç´ å– $\max$ï¼Œè¿™æ ·æ˜¾ç„¶å¤æ‚åº¦å°±å¤šäº†ä¸€ç»´ $n$ã€‚ä»”ç»†æ€è€ƒåå‘ç°ï¼Œå¦‚æœå¯¹äºä¸€ç»„ $(i,j)$ï¼Œæ»¡è¶³ $w_i\geq w_j$ ä¸” $h_i\geq j_j$ ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ æ‰ $j$ ã€‚å…·ä½“çš„ï¼Œè€ƒè™‘æŒ‰ç…§ $h$ æ’åºä¹‹åï¼Œç”¨ä¸€ä¸ªå•è°ƒæ ˆæ¥ç»´æŠ¤è¿™ä¸ªä¸œè¥¿ã€‚</p>
<p>é‚£ä¹ˆè¿™æ ·æœ€åå‰©ä¸‹çš„ä¸€å®šæ»¡è¶³ $w$ å•è°ƒã€‚æ‰€ä»¥å°±ä¼šå¾—åˆ°ç±»ä¼¼</p>
<script type="math/tex; mode=display">
f_i=\min\{f_{j}+h_{j+1}\cdot w_i\}\\
f_j=-h_{j+1}\cdot w_i+f_i</script><p>é‚£ä¹ˆä»¤ $h_{j+1}$ ä½œä¸ºæ¨ªåæ ‡ï¼Œæ¨ªåæ ‡å•è°ƒï¼›$w_i$ ä½œä¸ºæ–œç‡ï¼Œæ–œç‡å•è°ƒã€‚äºæ˜¯å°±å˜æˆäº†æœ€ <code>general</code> çš„æ–œç‡ä¼˜åŒ–é—®é¢˜ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> top ;</span><br><span class="line">LL f[N] ;</span><br><span class="line"><span class="built_in">deque</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">grid</span>&#123;</span></span><br><span class="line">    LL x, y ;</span><br><span class="line">&#125;base[N], t[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(grid a, grid b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.x == b.x ? a.y &gt; b.y : a.x &gt; b.x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;base[i].x, &amp;base[i].y) ;</span><br><span class="line">    sort(base + <span class="number">1</span>, base + n + <span class="number">1</span>, comp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (!top || t[top].y &lt; base[i].y) t[++ top] = base[i] ;</span><br><span class="line"><span class="comment">//	for (int i = 1 ; i &lt;= 50 ; ++ i) cout &lt;&lt; t[i].x &lt;&lt; " " &lt;&lt; t[i].y &lt;&lt; endl ;</span></span><br><span class="line">    n = top ; q.push_back(<span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">         <span class="keyword">while</span> (q.size() &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> o, p ; p = q.front() ; q.pop_front() ; o = q.front() ;</span><br><span class="line">            <span class="keyword">if</span> (f[p] - f[o] &lt;= t[i].y * (t[o + <span class="number">1</span>].x - t[p + <span class="number">1</span>].x))</span><br><span class="line">                &#123; q.push_front(p) ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         f[i] = f[q.front()] + t[q.front() + <span class="number">1</span>].x * t[i].y ;</span><br><span class="line">         <span class="keyword">while</span> (q.size() &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> o, p ; p = q.back() ; q.pop_back() ; o = q.back() ;</span><br><span class="line">            <span class="keyword">if</span> ((f[p] - f[o]) * (t[p + <span class="number">1</span>].x - t[i + <span class="number">1</span>].x) &lt;= (f[i] - f[p]) * (t[o + <span class="number">1</span>].x - t[p + <span class="number">1</span>].x))</span><br><span class="line">                &#123; q.push_back(p) ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         q.push_back(i) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[n] &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>BTWï¼Œå¦‚ä½•æ¨å‡¸åŒ…çš„ç»´æŠ¤æ–¹å¼ï¼Œå¯ä»¥è€ƒè™‘æ˜¯ç»´æŠ¤ä¸‹å‡¸å£³è¿˜æ˜¯ä¸Šå‡¸å£³ï¼Œä½†æ˜¯ä¼¼ä¹åˆä¸€ç§æ–¹å¼æ›´ç®€ä¾¿ï¼š</p>
<p>ä»¤ $0\leq k&lt;j&lt;i$ ï¼Œé‚£ä¹ˆå¦‚æœ $j$ æ¯” $k$ å¥½ï¼Œé‚£ä¹ˆéœ€è¦æ»¡è¶³</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{j}+w_{j+1} \times l_{i} & \leq f_{k}+w_{k+1} \times l_{i} \\
f_{j}-f_{k} & \leq l_{i} \times\left(w_{k+1}-w_{j+1}\right)\\
l_{i} &\geq \frac{f_{j}-f_{k}}{w_{k+1}-w_{j+1}}
\end{aligned}</script><p>è¿™ä¹ˆåšå°±ä¼šæ¯”è¾ƒç›´è§‚ï¼Ÿ</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ–œç‡ä¼˜åŒ–çš„æ—¶å€™å¾ˆå¯èƒ½ä¼šå› ä¸ºç§»é¡¹çš„æ—¶å€™ç¬¦å·å˜é”™äº†è€ŒGGã€‚</p>
<p>è¿˜æœ‰ï¼Œä¼¼ä¹å¦‚æœæ–œç‡å’Œæ¨ªåæ ‡çš„å•è°ƒæ–¹å¼ç›¸åŒï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨å•è°ƒæ ˆæ›¿æ¢æ‰å•è°ƒé˜Ÿåˆ—ã€‚è™½ç„¶â€¦æ²¡å•¥ç”¨233</p>
<h1 id="æœŸæœ›ç›¸å…³"><a href="#æœŸæœ›ç›¸å…³" class="headerlink" title="æœŸæœ›ç›¸å…³"></a>æœŸæœ›ç›¸å…³</h1><h2 id="Red-is-Good"><a href="#Red-is-Good" class="headerlink" title="Red is Good"></a>Red is Good</h2><blockquote>
<p>$n$ å¼ çº¢ç‰Œï¼Œ$m$ å¼ é»‘ç‰Œéšæœºæ‰“ä¹±é¡ºåºæ”¾åœ¨æ¡Œé¢ä¸Šï¼Œä½ å¯ä»¥ç¿»ç‰Œï¼Œç¿»åˆ°çº¢è‰²åˆ™å¾—åˆ° $1$ å…ƒï¼Œé»‘è‰²åˆ™å¤±å» $1$ å…ƒã€‚æ±‚åœ¨æœ€ä¼˜ç­–ç•¥ä¸‹å¹³å‡èƒ½å¾—åˆ°å¤šå°‘é’±ã€‚</p>
<p>$n,m\leq 5000$</p>
</blockquote>
<p>è€ƒè™‘å¦‚ä½•è®¾çŠ¶æ€ä¸º â€œå·²ç»xxxäº†â€ï¼Œä¸æ˜¯å¾ˆå®¹æ˜“è½¬ç§»ã€‚äºæ˜¯è€ƒè™‘ä»¤ $f_{i,j}$ ä¸ºå‰©ä¸‹ $i$ å¼ çº¢çš„ï¼Œ$j$ å¼ é»‘çš„æ—¶çš„æœ€å¤§å€¼ã€‚æ³¨æ„åˆ°ç”±äºæ˜¯æœ€ä¼˜å†³ç­–ï¼Œæ‰€ä»¥æœ‰</p>
<script type="math/tex; mode=display">
f_{i,j}=\max\{0,\frac{i}{i+j}(f_{i-1,j}+1)+\frac{j}{i+j}(f_{i,j-1}-1)\}</script><h2 id="HNOI2015-äºšç‘Ÿç‹"><a href="#HNOI2015-äºšç‘Ÿç‹" class="headerlink" title="[HNOI2015]äºšç‘Ÿç‹"></a>[HNOI2015]äºšç‘Ÿç‹</h2><blockquote>
<p>æœ‰ $n$ å¼ å¡ç‰Œï¼Œç© $r$ è½®æ¸¸æˆã€‚æ¯è½®æ¸¸æˆä»å·¦å‘å³è½®æµè€ƒè™‘æ¯å¼ æ²¡æœ‰å‘åŠ¨è¿‡çš„å¡ç‰Œï¼Œè€ƒè™‘åˆ°ç¬¬ $i$ å¼ å¡æ—¶ï¼Œå®ƒæœ‰ $p_i$ çš„æ¦‚ç‡å‘åŠ¨å¹¶äº§ç”Ÿ $d_i$ çš„è´¡çŒ®ï¼Œ ç„¶åæœ¬è½®ç«‹å³ç»“æŸå¹¶è¿›å…¥ä¸‹ä¸€è½®ã€‚è‹¥æ²¡æœ‰å¡ç‰Œå‘åŠ¨åˆ™ç›´æ¥è¿›å…¥ä¸‹ä¸€è½®ã€‚ $T$ ç»„æ•°æ®ï¼Œæ±‚æœŸæœ›è´¡çŒ®ã€‚</p>
<p>$T\leq 500, n\leq 300,r\leq 200$</p>
</blockquote>
<p>è€ƒè™‘åˆ†åˆ«è®¡ç®—å‡ºæ¯å¼ å¡ç‰Œçš„å‘åŠ¨æ¦‚ç‡ï¼Œç„¶ååˆ†åˆ«ä¹˜ä¸Šæ¯å¼ å¡ç‰Œçš„æƒå€¼å¾—åˆ°ç­”æ¡ˆã€‚</p>
<p>å…·ä½“çš„ï¼Œä»¤ $f_{i,j}$ è¡¨ç¤ºå½“å‰åªåœ¨è€ƒè™‘ç¬¬ $i$ å¼ ç‰Œï¼Œè¿˜å‰© $j$ æ¬¡æ¸¸æˆæ²¡æœ‰å¼€å§‹çš„æ¦‚ç‡ã€‚è€ƒè™‘è½¬ç§»ï¼š</p>
<script type="math/tex; mode=display">
f_{i,j}=f_{i-1,j+1}\cdot(1-(1-p_{i-1})^{j+1})+f_{i-1,j}\cdot(1-p_{i-1})^j</script><p>å…¶å®å°±æ˜¯åœ¨è®¡ç®—ç‰Œ $i-1$ æ˜¯å¦è¢«å‘åŠ¨äº†ï¼Œå‰åŠéƒ¨åˆ†è®¡ç®—äº†ç¬¬ $i$ å¼ ç‰Œåœ¨ä¹‹åçš„ $j$ æ¬¡ä»¥åŠå½“å‰è¿™ä¸€æ¬¡ä¸­ä»»æ„ä¸€æ¬¡å‘åŠ¨æˆåŠŸçš„æ¦‚ç‡ï¼Œæ‰€ä»¥æ˜¯ $1-ä¸€æ¬¡ä¹Ÿæ²¡å‘åŠ¨æˆåŠŸçš„æ¦‚ç‡$ï¼›ååŠéƒ¨åˆ†ä»¥æ­¤ç±»æ¨ã€‚æ³¨æ„ï¼Œæ­¤å¤„å¿½ç•¥äº†é¢˜ç›®ä¸­ã€Œç›´æ¥ç»“æŸæœ¬è½®ã€çš„çº¦æŸã€‚æœ¬è´¨ä¸Šï¼Œ$f$ ä¿è¯äº†è¿˜æœ‰ $j$ è½®æ—¶ï¼Œå‰ $i$ å¼ å¡ç‰Œä¸ä¼šè¢«é€‰ã€‚</p>
<p>é‚£ä¹ˆè€ƒè™‘å¦‚ä½•è®¡ç®—ç¬¬ $i$ å¼ ç‰Œæ˜¯å¦å‘åŠ¨äº†çš„æ¦‚ç‡ï¼š</p>
<script type="math/tex; mode=display">
P_i=\sum_{j=1}^rf_{i,j}\cdot (1-(1-p_i)^j)</script><p>ä¹‹åç”¨çº¿æ€§æ€§ç®—ä¸€ä¸‹å°±å¥½äº†ã€‚å¤æ‚åº¦ $O(nTr)$ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> T ;</span><br><span class="line"><span class="keyword">int</span> n, r ;</span><br><span class="line"><span class="keyword">double</span> ans ;</span><br><span class="line"><span class="keyword">double</span> d[N] ;</span><br><span class="line"><span class="keyword">double</span> p[N] ;</span><br><span class="line"><span class="keyword">double</span> f[N][N] ;</span><br><span class="line"><span class="keyword">double</span> xs[N][N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; r ; <span class="keyword">double</span> res ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>, &amp;p[i], &amp;d[i]) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n + <span class="number">1</span> ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= r + <span class="number">1</span> ; ++ j)</span><br><span class="line">                f[i][j] = xs[i][j] = <span class="number">0</span> ;</span><br><span class="line">        f[<span class="number">0</span>][r] = <span class="number">1</span> ; ans = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">            res = <span class="number">1.0</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= r ; ++ j)</span><br><span class="line">                xs[i][j] = res, res *= (<span class="number">1.0</span> - p[i]) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = r ; j &gt;= <span class="number">1</span> ; -- j)</span><br><span class="line">                f[i][j] = f[i - <span class="number">1</span>][j + <span class="number">1</span>] * (<span class="number">1.0</span> - xs[i - <span class="number">1</span>][j + <span class="number">1</span>]) + f[i - <span class="number">1</span>][j] * xs[i - <span class="number">1</span>][j] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= r ; ++ j)</span><br><span class="line">                ans += d[i] * f[i][j] * (<span class="number">1.0</span> - xs[i][j]) ;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.9lf\n"</span>, ans) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>æ³›åš</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/æ¦‚ç‡,æœŸæœ›</tag>
        <tag>åŠ¨æ€è§„åˆ’/å•è°ƒé˜Ÿåˆ—</tag>
        <tag>åŠ¨æ€è§„åˆ’/æ–œç‡ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘bzoj1559 [JSOI2009]å¯†ç </title>
    <url>/2020/02/20/JSOI2009%E5%AF%86%E7%A0%81/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>ç»™å®šé•¿åº¦ $L$ ä¸ª $m$ ä¸ªå­ä¸²ï¼Œè¦æ±‚æ‹¼å‡ºä¸€ä¸ªé•¿åº¦ä¸º $L$ çš„é•¿ä¸²ä½¿ä¹‹åŒ…å«æ‰€æœ‰çš„å­ä¸²ã€‚</p>
<p>å¦‚æœæ–¹æ¡ˆæ•° $\leq42$ åˆ™è¾“å‡ºå…¨éƒ¨æ–¹æ¡ˆï¼Œå¦åˆ™åªè¾“å‡ºæ–¹æ¡ˆæ•°ã€‚</p>
<p>$L\leq 25,m\leq 10$ã€‚</p>
</blockquote>
<a id="more"></a>
<p>â€¦è¿™é¢˜å¤§æ¦‚ä¹Ÿå°±æ˜¯è“~ç´«å·¦å³ï¼Œè¿™ä¸ªé»‘å®åœ¨å¤ªè™šäº†ã€‚</p>
<p>ä½†è¿™ä¸å½±å“æˆ‘è¿˜æ˜¯ä¸å¤ªä¼š233</p>
<p>è§‚å¯Ÿé¢˜æ„ï¼Œç”± <code>good+day=gooday</code> å¯çŸ¥åº”è¯¥æ”¾åœ¨ $\rm AC$ è‡ªåŠ¨æœºä¸Šåšï¼Œå› ä¸ºå­˜åœ¨é‡åˆã€‚è§‚å¯ŸèŒƒå›´å¯çŸ¥æ˜¯çŠ¶å‹ã€‚äºæ˜¯è€ƒè™‘åœ¨ $\rm$ AC è‡ªåŠ¨æœºä¸Š $dp$ã€‚</p>
<p>è®° $f_{i,j,s}$ è¡¨ç¤ºåŒ¹é…åˆ°ä¸²çš„ç¬¬ $i$ ä½ï¼Œèµ°åˆ°äº†è‡ªåŠ¨æœºä¸Šçš„ç¬¬ $j$ ä¸ªèŠ‚ç‚¹ï¼Œå½“å‰å·²ç»æ‹¼å®Œäº†é›†åˆ $s$ ä¸­çš„æ¨¡å¼ä¸²çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»çš„è¯å°±è€ƒè™‘ç›´æ¥æšä¸¾å½“å‰çŠ¶æ€çš„æ‰€æœ‰å­çŠ¶æ€ï¼Œæš´åŠ›è½¬ç§»å³å¯ï¼ˆç”¨æ¥è®¡æ•°çš„çŠ¶å‹ $dp$ è¿˜èƒ½æ€ä¹ˆè½¬ç§»å•Šå–‚ï¼‰ã€‚å€¼å¾—æä¸€å¥çš„çš„æ˜¯ï¼Œç”±äºæœ¬èº« $\rm AC$ è‡ªåŠ¨æœºå­˜åœ¨è·¯å¾„å‹ç¼©ï¼Œæ‰€ä»¥æ˜¯ <code>è®¤å­ä¸è®¤çˆ¶</code> çš„ç»“æ„ï¼Œåªèƒ½åˆ·è¡¨è€Œä¸èƒ½å¡«è¡¨ã€‚</p>
<p>ä¹‹åè€ƒè™‘è¾“å‡ºæ–¹æ¡ˆã€‚å‘ç°å¦‚æœç›´æ¥æœ $\rm AC$ è‡ªåŠ¨æœºä¸Šçš„æ¯ä¸ªæ–¹æ¡ˆååˆ†æš´åŠ›ï¼Œäºæ˜¯è€ƒè™‘åŠ ä¸€ä¸ªå¯è¡Œæ€§å‰ªæã€‚å³ç”±äºå¾ˆå®¹æ˜“ $dfs$ å‡ºæ¯ä¸ªçŠ¶æ€ $(i,j,s)$ æ˜¯å¦å¯ä»¥è½¬ç§»åˆ°ç»ˆç‚¹ï¼Œæ‰€ä»¥ä¸éœ€è¦è€ƒè™‘ $42$ çš„é™åˆ¶ï¼Œé¢„å¤„ç†ä¸€ä¸ª $g_{i,j,s}$æ˜¯å¦å¯ä»¥æ‹¼å‡ºæœ€ç»ˆçŠ¶æ€ï¼Œå‰ªå®Œæç›´æ¥è¾“å‡ºå³å¯ã€‚</p>
<p>åŒæ—¶ï¼Œåªè¦åœ¨ $\rm AC$ è‡ªåŠ¨æœºä¸Šä¿è¯æ¯æ¬¡èµ°æœ€å°çš„å­—æ¯ï¼Œå°±ä¸€å®šæ˜¯å­—å…¸åºæœ€ä¼˜çš„æ–¹æ¡ˆã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> o ;</span><br><span class="line">LL ans ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> t[N] ;</span><br><span class="line"><span class="keyword">char</span> s[N] ;</span><br><span class="line">LL f[N][W][Z] ;</span><br><span class="line"><span class="keyword">bool</span> g[N][W][Z] ;</span><br><span class="line"><span class="keyword">bool</span> v[N][W][Z] ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ACAM</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> size ;</span><br><span class="line">    <span class="keyword">int</span> _ed[W] ;</span><br><span class="line">    <span class="keyword">int</span> fail[W] ;</span><br><span class="line">    <span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line">    <span class="keyword">int</span> trans[W][<span class="number">26</span>] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Ins</span><span class="params">(<span class="keyword">char</span> *t, <span class="keyword">int</span> num)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rt = <span class="number">0</span>, len ;</span><br><span class="line">        len = <span class="built_in">strlen</span>(t + <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x, i = <span class="number">1</span> ; i &lt;= len ; ++ i)&#123;</span><br><span class="line">            x = t[i] - <span class="string">'a'</span> ;</span><br><span class="line">            <span class="keyword">if</span> (!trans[rt][x])</span><br><span class="line">                trans[rt][x] = ++ size ;</span><br><span class="line">            rt = trans[rt][x] ;</span><br><span class="line">        &#125;</span><br><span class="line">        _ed[rt] |= (<span class="number">1</span> &lt;&lt; num) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (trans[<span class="number">0</span>][i]) q.push(trans[<span class="number">0</span>][i]) ;</span><br><span class="line">        <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">            <span class="keyword">int</span> x = q.front() ;</span><br><span class="line">            q.pop() ; _ed[x] |= _ed[fail[x]] ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)&#123;</span><br><span class="line">                <span class="keyword">if</span> (!trans[x][i]) trans[x][i] = trans[fail[x]][i] ;</span><br><span class="line">                <span class="keyword">else</span> fail[trans[x][i]] = trans[fail[x]][i], q.push(trans[x][i]) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;S ;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == n)&#123;</span><br><span class="line">        v[x][y][z] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">return</span> g[x][y][z] = (<span class="keyword">bool</span>)(z == o) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> p = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (v[x][y][z])</span><br><span class="line">        <span class="keyword">return</span> g[x][y][z] ;</span><br><span class="line">    <span class="keyword">else</span> v[x][y][z] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)</span><br><span class="line">        p |= search(x + <span class="number">1</span>, S.trans[y][i], z | S._ed[S.trans[y][i]]) ;</span><br><span class="line">    <span class="keyword">return</span> g[x][y][z] = p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!g[x][y][z]) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x == n)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%c"</span>, t[i] + <span class="string">'a'</span>) ;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">""</span>), <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)</span><br><span class="line">        t[x + <span class="number">1</span>] = i, output(x + <span class="number">1</span>, S.trans[y][i], z | S._ed[S.trans[y][i]]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; S.size = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>), S.Ins(s, i - <span class="number">1</span>) ;</span><br><span class="line">    S.build() ; f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ; o = (<span class="number">1</span> &lt;&lt; m) - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= S.size ; ++ j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt;= o ; ++ k)</span><br><span class="line">                <span class="keyword">if</span> (f[i][j][k])</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span> ; l &lt; <span class="number">26</span> ; ++ l)</span><br><span class="line">                        f[i + <span class="number">1</span>][S.trans[j][l]][k | S._ed[S.trans[j][l]]] += f[i][j][k] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= S.size ; ++ i) ans += f[n][i][o] ;</span><br><span class="line">    <span class="keyword">if</span> (ans &gt; <span class="number">42</span>) <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span>, search(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), output(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>BZOJ</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/çŠ¶å‹DP</tag>
        <tag>å­—ç¬¦ä¸²/ACè‡ªåŠ¨æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘bzoj2555 Substring</title>
    <url>/2020/02/20/bzoj2555/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>è¦æ±‚å®ç°ä¸¤ç§æ“ä½œï¼š</p>
<p>(1): åœ¨å½“å‰å­—ç¬¦ä¸²çš„åé¢æ’å…¥ä¸€ä¸ªå­—ç¬¦ä¸²</p>
<p>(2): è¯¢é—®å­—ç¬¦ä¸² $s$ åœ¨å½“å‰å­—ç¬¦ä¸²ä¸­å‡ºç°äº†å‡ æ¬¡ï¼Ÿ(ä½œä¸ºè¿ç»­å­ä¸²)</p>
<p>ä½ å¿…é¡»åœ¨çº¿æ”¯æŒè¿™äº›æ“ä½œã€‚</p>
<p>é•¿åº¦ $\leq 600000$ï¼Œè¯¢é—®æ¬¡æ•° $\leq 10000$ï¼Œè¯¢é—®æ€»é•¿åº¦ $\leq 3,000,000$ã€‚ </p>
</blockquote>
<a id="more"></a>
<p>ä¸€ç›´å¬è¯´æœ‰ $\rm LCT$ ç»´æŠ¤ $parent$ æ ‘çš„é¢˜ï¼Œæ²¡æƒ³åˆ°çœŸåšåˆ°äº†233ã€‚</p>
<p>è€ƒè™‘å­—ç¬¦ä¸² $s$ å‡ºç°çš„æ¬¡æ•°ï¼Œåœ¨SAMä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹é‡Œé¢çš„æŸä¸ªå­ä¸²çš„å‡ºç°æ¬¡æ•°å°±æ˜¯å®ƒçš„å­æ ‘çš„å‡ºç°æ¬¡æ•°å’Œï¼Œå› ä¸ºé•¿çš„åç¼€ä¸çŸ­çš„åç¼€ä¹‹é—´ä¿¡æ¯ä¸å…±äº«ï¼Œæ‰€ä»¥ä¿®æ”¹æ“ä½œæœ¬è´¨ä¸Šæ˜¯åœ¨è¿›è¡Œ $parent$ æ ‘ä¸Šçš„é“¾åŠ ã€‚</p>
<p>è€ƒè™‘ä¸€ç§ç¥å¥‡çš„å†™æ³•ã€‚æ¯æ¬¡å¯¹äºæ–°å»ºçš„èŠ‚ç‚¹ $np$ ï¼Œä»–çš„è´¡çŒ®åº”è¯¥æ˜¯ $parent$ æ ‘ä¸Š $1\sim np$ è¿™æ¡è·¯å¾„ä¸Šçš„æ‰€æœ‰ç‚¹ã€‚äºæ˜¯è€ƒè™‘å…ˆ <code>merge(1, np)</code> ï¼ŒæŠŠ $np$ ç»™ <code>splay</code> ä¸Šå»ä¹‹åå†…éƒ¨å°±å˜æˆäº†ä¸€æ£µä»¥ $np$ ä¸ºæ ¹çš„ä¸€æ¡é“¾ï¼Œè¿™æ ·å°±å¯ä»¥ä¸ç”¨è€ƒè™‘é“¾åŠ ï¼Œç›´æ¥åœ¨ $np$ å¤„æ‰“æ ‡è®°å³å¯ã€‚</p>
<p>ä¼¼ä¹æŸ¥è¯¢æ“ä½œæ›´ä¸ºç¥å¥‡ã€‚å› ä¸ºæŸ¥è¯¢çš„æ—¶å€™åªéœ€è¦å¯¹äºèµ°åˆ°çš„ä¸€ä¸ªç‚¹ $x$ ï¼Œç›´æ¥æŠŠä»– <code>splay</code> æ‰å°±å¯ä»¥ç»´æŠ¤ä¿¡æ¯ã€‚çœ‹ä¸Šå»ä¼¼ä¹ä¸æ˜¯å¾ˆå¯¹ï¼Œå› ä¸ºå¯¹ $x$ äº§ç”Ÿè´¡çŒ®çš„æ˜¯ä¸€é¢—å­æ ‘è€Œä¸æ˜¯ä¸€æ¡é“¾ã€‚ä½†è¿™æ ·åšå…¶å®æœ‰ä»–ç‹¬ç‰¹çš„æ­£ç¡®æ€§ä¿è¯ï¼Œå³æ¯ä¸ªç‚¹éƒ½å­˜åœ¨ä¸”ä»…å­˜åœ¨äºä¸€æ£µ <code>splay</code> ï¼Œæ¢ <code>splay</code> çš„æ—¶å€™åŠ¿å¿…è¦ <code>access</code>ï¼Œè€Œ <code>access</code> æ—¶æœ¬è´¨ä¸Šå°±å·²ç»æŠŠåŸæ¥çš„æ ‡è®°ç»™ä¸‹æ”¾å¹²å‡€äº†ï¼Œæ‰€ä»¥æ¯æ¬¡åªæœ‰å¯èƒ½æ˜¯å½“å‰çš„ <code>splay</code> è¿˜æœ‰ä¿¡æ¯æ²¡æœ‰ç»´æŠ¤æ¸…æ¥šã€‚ä¹Ÿå°±æ˜¯æ¯æ¬¡åªéœ€è¦ç®¡ä¸€æ¡é“¾ï¼Œå‰©ä¸‹çš„é“¾çš„æ ‡è®°å·²ç»æ¸…å®Œäº†ã€‚è¿™æ ·å°±åªéœ€è¦ <code>splay</code> ä¸€ä¸‹å³å¯ã€‚</p>
<p>å†™çš„æ—¶å€™ï¼Œä¸ºäº†å¡å¸¸å‘ç°äº†ä¸ªæ›´ç¥å¥‡çš„åœ°æ–¹ï¼Œå°±æ˜¯åœ¨SAMé‡Œé¢æŠ ç‚¹æ’å­æ ‘/æ’ç‚¹è¿™ä¸¤ä¸ªæ“ä½œï¼Œç”±äºéƒ½ä¿è¯äº†çˆ¶äº²ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ <code>Link</code> è¿™ä¸ªæ“ä½œï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸éœ€è¦ <code>make_root</code> çš„ï¼Œå®æµ‹è¿™æ ·å°±ä¼šå¿«å¾ˆå¤šå¾ˆå¤šã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fa(x) t[x].fa</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rv(x) t[x].rev</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vl(x) t[x].val</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> tg(x) t[x].tag</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc(x) t[x].son[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc(x) t[x].son[1]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1500010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LCT</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> fa ;</span><br><span class="line">    <span class="keyword">int</span> rev ;</span><br><span class="line">    <span class="keyword">int</span> val ;</span><br><span class="line">    <span class="keyword">int</span> tag ;</span><br><span class="line">    <span class="keyword">int</span> son[<span class="number">2</span>] ;</span><br><span class="line">&#125;t[M] ;</span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> m ;</span><br><span class="line"><span class="keyword">int</span> tp ;</span><br><span class="line"><span class="keyword">int</span> len ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">char</span> s[N] ;</span><br><span class="line"><span class="keyword">char</span> o[N] ;</span><br><span class="line"><span class="keyword">int</span> stk[M] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">nroot</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ((lc(fa(x)) == x) || (rc(fa(x)) == x)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    rv(x) ^= <span class="number">1</span> ; swap(lc(x), rc(x)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _down(<span class="keyword">int</span> x)&#123;</span><br><span class="line">    <span class="keyword">if</span> (rv(x))&#123;</span><br><span class="line">        rv(x) = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">if</span> (lc(x)) reverse(lc(x)) ;</span><br><span class="line">        <span class="keyword">if</span> (rc(x)) reverse(rc(x)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tg(x))&#123;</span><br><span class="line">        <span class="keyword">if</span> (lc(x)) vl(lc(x)) += tg(x), tg(lc(x)) += tg(x) ;</span><br><span class="line">        <span class="keyword">if</span> (rc(x)) vl(rc(x)) += tg(x), tg(rc(x)) += tg(x) ;</span><br><span class="line">        tg(x) = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> w = x == rc(fa(x)) ;</span><br><span class="line">    <span class="keyword">int</span> f1 = fa(x), f2 = fa(f1) ;</span><br><span class="line">    <span class="keyword">if</span> (nroot(f1))</span><br><span class="line">        t[f2].son[f1 == rc(f2)] = x ;</span><br><span class="line">    t[f1].son[w] = t[x].son[w ^ <span class="number">1</span>] ;</span><br><span class="line">    fa( t[x].son[w ^ <span class="number">1</span>] ) = f1 ;</span><br><span class="line">    fa(x) = f2 ; fa(f1) = x ;</span><br><span class="line">    t[x].son[w ^ <span class="number">1</span>] = f1 ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = x ;</span><br><span class="line">    stk[++ tp] = y ;</span><br><span class="line">    <span class="keyword">while</span> (nroot(y))</span><br><span class="line">        stk[++ tp] = (y = fa(y)) ;</span><br><span class="line">    <span class="keyword">while</span> (tp) _down(stk[tp --]) ;</span><br><span class="line">    <span class="keyword">while</span> (nroot(x))&#123;</span><br><span class="line">        <span class="keyword">int</span> f1 = fa(x) ;</span><br><span class="line">        <span class="keyword">int</span> f2 = fa(f1) ;</span><br><span class="line">        <span class="keyword">if</span> (nroot(f1))&#123;</span><br><span class="line">            <span class="keyword">if</span> ((rc(f1) == x) == (rc(f2) == f1))</span><br><span class="line">                rotate(f1) ; <span class="keyword">else</span> rotate(x) ;</span><br><span class="line">        &#125;</span><br><span class="line">        rotate(x) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> ( ; x ; x = fa(y = x))</span><br><span class="line">        splay(x), rc(x) = y ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">make_root</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    access(x) ;</span><br><span class="line">    splay(x) ; reverse(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">find_root</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    access(x) ; splay(x) ;</span><br><span class="line">    <span class="keyword">while</span>(lc(x)) x = lc(x) ;</span><br><span class="line">    <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    make_root(x) ;</span><br><span class="line">    access(y) ; splay(y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    fa(x) = y ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">cut</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    merge(x, y) ;</span><br><span class="line">    fa(x) = t[y].son[<span class="number">0</span>] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">Input</span><span class="params">(<span class="keyword">int</span> mk)</span> </span>&#123;</span><br><span class="line">    len = <span class="built_in">strlen</span>(s) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; len ; ++ j)</span><br><span class="line">        mk = (mk * <span class="number">131</span> + j) % len, swap(s[j], s[mk]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SAM</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> size ;</span><br><span class="line">    <span class="keyword">int</span> last ;</span><br><span class="line">    <span class="keyword">int</span> len[M] ;</span><br><span class="line">    <span class="keyword">int</span> fal[M] ;</span><br><span class="line">    <span class="keyword">int</span> trans[M][<span class="number">2</span>] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        last = ++ size ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Ins</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> np = ++ size ;</span><br><span class="line">        <span class="keyword">int</span> q, nq, p = last ;</span><br><span class="line">        len[last = np] = len[p] + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (p &amp;&amp; !trans[p][x])</span><br><span class="line">            trans[p][x] = np, p = fal[p] ;</span><br><span class="line">        <span class="keyword">if</span> (!p)&#123;</span><br><span class="line">            fal[np] = <span class="number">1</span> ;</span><br><span class="line">            link(np, <span class="number">1</span>), merge(<span class="number">1</span>, np) ;</span><br><span class="line">            vl(np) ++, tg(np) ++ ; <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        q = trans[p][x] ;</span><br><span class="line">        <span class="keyword">if</span> (len[q] == len[p] + <span class="number">1</span>)&#123;</span><br><span class="line">            fal[np] = q ;</span><br><span class="line">            link(np, q), merge(<span class="number">1</span>, np) ;</span><br><span class="line">            vl(np) ++, tg(np) ++ ; <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        nq = ++ size ;</span><br><span class="line">        cut(fal[q], q) ;</span><br><span class="line">        fal[nq] = fal[q] ;</span><br><span class="line">        link (q, nq) ;</span><br><span class="line">        link (np, nq) ;</span><br><span class="line">        link (nq, fal[q]) ;</span><br><span class="line">        len[nq] = len[p] + <span class="number">1</span> ;</span><br><span class="line">        fal[q] = fal[np] = nq ;</span><br><span class="line">        splay(q) ; vl(nq) = vl(q) ;</span><br><span class="line">        <span class="built_in">memcpy</span>(trans[nq], trans[q], <span class="number">8</span>) ;</span><br><span class="line">        <span class="keyword">while</span> (p &amp;&amp; trans[p][x] == q)</span><br><span class="line">            trans[p][x] = nq, p = fal[p] ;</span><br><span class="line">        merge(<span class="number">1</span>, np), vl(np) ++, tg(np) ++ ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;S ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>) ;</span><br><span class="line">    len = <span class="built_in">strlen</span>(s + <span class="number">1</span>) ; S.Init() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= len ; ++ i) S.Ins(s[i] - <span class="string">'A'</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (m --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, o + <span class="number">1</span>) ;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s), Input(ans) ;</span><br><span class="line">        <span class="keyword">if</span> (o[<span class="number">1</span>] == <span class="string">'A'</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; len ; ++ i)</span><br><span class="line">                S.Ins(s[i] - <span class="string">'A'</span>) ; <span class="comment">//, cout &lt;&lt; i &lt;&lt; endl ;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> rt = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; len ; ++ i)&#123;</span><br><span class="line">                rt = S.trans[rt][s[i] - <span class="string">'A'</span>] ;</span><br><span class="line">                <span class="keyword">if</span> (!rt) <span class="keyword">break</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!rt) res = <span class="number">0</span> ;</span><br><span class="line">            <span class="keyword">else</span> splay(rt), res = vl(rt) ;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, res) ; ans = ans ^ res ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>BZOJ</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ä¸²/åç¼€è‡ªåŠ¨æœº(SAM)</tag>
        <tag>LCT</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘loj#2059 [HEOI/TJOI2016]å­—ç¬¦ä¸²</title>
    <url>/2020/02/20/HEOI-TJOI2016%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>ç»™å®šä¸€ä¸ªä¸²ï¼Œæ¯æ¬¡ç»™å‡ºåŒºé—´ $[a,b]$ å’Œ $[c,d]$ï¼Œè¯¢é—® $[a,b]$ ä¸­çš„å­ä¸²ä¸ $s[câ€¦d]$ çš„ $lcp$ æœ€å¤§å€¼ã€‚</p>
<p>è¦æ±‚åšæ³• $n~\mathrm{poly}(\log)$ï¼Œå…¶ä¸­ $\deg(\mathrm{poly}(\log))\leq 3$ ã€‚ </p>
</blockquote>
<a id="more"></a>
<p>è€ƒè™‘äºŒåˆ†ï¼Œé‚£ä¹ˆå°±å˜æˆäº†ä¸€ä¸ªåˆ¤å®šæ€§é—®é¢˜ï¼Œå³è€ƒè™‘ $s[câ€¦c+mid-1]$ åœ¨ $[aâ€¦b]$ ä¸­æ˜¯å¦å‡ºç°è¿‡ã€‚é‚£ä¹ˆè€ƒè™‘å€å¢ï¼Œå¯¹äºæ¯ä¸ªç‚¹å¯ä»¥å€å¢å‡º $s[1â€¦c+mid-1]$ çš„ $endpos$ æ‰€åœ¨çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆç°åœ¨å°±æ˜¯è¦æ±‚è¿™ä¸ª $endpos$ ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå…ƒç´  $\in$ $[a+mid-1,b]$ ã€‚ é‚£ä¹ˆè¿™ä¸ªä¸œè¥¿å°±å¯ä»¥æ’å…¥æ—¶ç»´æŠ¤æ¯ä¸ªç‚¹å½“å‰çš„ $endpos$ï¼Œä¹‹åå¯¹å½“å‰çš„ $parent$ æ ‘åšä¸€æ¬¡çº¿æ®µæ ‘åˆå¹¶å³å¯ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯è¿™ç§å†™æ³•çš„çº¿æ®µæ ‘åˆå¹¶å¯èƒ½ä¼šç‚¸ç©ºé—´ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> Id[N] ;</span><br><span class="line"><span class="keyword">char</span> t[N] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EdgE</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;E[N &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"><span class="keyword">int</span> dad[N][<span class="number">21</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Seg</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> size ;</span><br><span class="line">    <span class="keyword">int</span> lc[N * <span class="number">15</span>] ;</span><br><span class="line">    <span class="keyword">int</span> rc[N * <span class="number">15</span>] ;</span><br><span class="line">    <span class="keyword">int</span> rt[N * <span class="number">15</span>] ;</span><br><span class="line">    <span class="keyword">int</span> sum[N * <span class="number">15</span>] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Ins</span><span class="params">(<span class="keyword">int</span> &amp;rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!rt) rt = ++ size ;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">        sum[rt] ++ ; <span class="keyword">if</span> (l == r) <span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">if</span> (v &lt;= mid) Ins(lc[rt], l, mid, v) ;</span><br><span class="line">        <span class="keyword">else</span> Ins(rc[rt], mid + <span class="number">1</span>, r, v) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) <span class="keyword">return</span> sum[rt] ;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; <span class="keyword">int</span> res = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid) res += query(lc[rt], l, mid, ql, qr) ;</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid) res += query(rc[rt], mid + <span class="number">1</span>, r, ql, qr) ;</span><br><span class="line">        <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p = ++ size ;</span><br><span class="line">        <span class="keyword">if</span> (!x) <span class="keyword">return</span> y ;</span><br><span class="line">        <span class="keyword">if</span> (!y) <span class="keyword">return</span> x ;</span><br><span class="line">        <span class="keyword">if</span> (l == r) <span class="keyword">return</span> p ;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">        sum[p] = sum[x] + sum[y] ;</span><br><span class="line">        lc[p] = merge(lc[x], lc[y], l, mid) ;</span><br><span class="line">        rc[p] = merge(rc[x], rc[y], mid + <span class="number">1</span>, r) ;</span><br><span class="line">        <span class="keyword">return</span> p ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;T ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v ;</span><br><span class="line">    next(cnt) = head[u] ;</span><br><span class="line">    head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; k &lt;= <span class="number">20</span> ; ++ k)</span><br><span class="line">        dad[x][k] = dad[dad[x][k - <span class="number">1</span>]][k - <span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))&#123;</span><br><span class="line">        dad[to(k)][<span class="number">0</span>] = x, dfs(to(k)) ;</span><br><span class="line">        T.rt[x] = T.merge(T.rt[x], T.rt[to(k)], <span class="number">1</span>, n) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SAM</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> fa[N] ;</span><br><span class="line">    <span class="keyword">int</span> len[N] ;</span><br><span class="line">    <span class="keyword">int</span> last, size ;</span><br><span class="line">    <span class="keyword">int</span> trans[N][<span class="number">26</span>] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        last = ++ size ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Ins</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> np = ++ size ;</span><br><span class="line">        <span class="keyword">int</span> p = last, q, nq ;</span><br><span class="line">        len[last = np] = len[p] + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (p &amp;&amp; !trans[p][x])</span><br><span class="line">            trans[p][x] = np, p = fa[p] ;</span><br><span class="line">        <span class="keyword">if</span> (!p)</span><br><span class="line">            <span class="keyword">return</span> fa[np] = <span class="number">1</span>, last ;</span><br><span class="line">        q = trans[p][x] ;</span><br><span class="line">        <span class="keyword">if</span> (len[q] == len[p] + <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> fa[np] = q, last ;</span><br><span class="line">        nq = ++ size ;</span><br><span class="line">        fa[nq] = fa[q] ;</span><br><span class="line">        fa[q] = fa[np] = nq ;</span><br><span class="line">        len[nq] = len[p] + <span class="number">1</span> ;</span><br><span class="line">        <span class="built_in">memcpy</span>(trans[nq], trans[q], <span class="number">104</span>) ;</span><br><span class="line">        <span class="keyword">while</span> (n &amp;&amp; trans[p][x] == q)</span><br><span class="line">            trans[p][x] = nq, p = fa[p] ;</span><br><span class="line">        <span class="keyword">return</span> last ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= size ; ++ i) add(fa[i], i) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;S ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">// freopen("str5.in", "r", stdin) ;</span></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">int</span> a, b, c, d ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; (t + <span class="number">1</span>), S.Init() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        Id[i] = S.Ins(t[i] - <span class="string">'a'</span>) ;</span><br><span class="line">        T.Ins(T.rt[Id[i]], <span class="number">1</span>, n, i) ;</span><br><span class="line">    &#125;</span><br><span class="line">    S.Add() ; dfs(<span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;a, &amp;b, &amp;c, &amp;d) ;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">1</span>, r = min(b - a + <span class="number">1</span>, d - c + <span class="number">1</span>), mid, ans = <span class="number">0</span> ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; l &lt;&lt; r &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">            mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">int</span> x = Id[c + mid - <span class="number">1</span>] ;</span><br><span class="line">           <span class="comment">// cout &lt;&lt; mid &lt;&lt; endl ;</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">20</span> ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">                <span class="keyword">if</span> (dad[x][j] &amp;&amp; S.len[dad[x][j]] &gt;= mid)</span><br><span class="line">                    x = dad[x][j] ;</span><br><span class="line">           <span class="comment">// cout &lt;&lt; x &lt;&lt; endl ;</span></span><br><span class="line">            <span class="keyword">if</span> (T.query(T.rt[x], <span class="number">1</span>, n, a + mid - <span class="number">1</span>, b))</span><br><span class="line">                ans = mid, l = mid + <span class="number">1</span> ; <span class="keyword">else</span> r = mid - <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>loj</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ä¸²/åç¼€è‡ªåŠ¨æœº(SAM)</tag>
        <tag>æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/çº¿æ®µæ ‘åˆå¹¶</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ³›åšã€‘çŸ©é˜µåŠ é€Ÿè½¬ç§»</title>
    <url>/2020/02/20/%E7%9F%A9%E9%98%B5%E5%BF%AB%E9%80%9F%E5%B9%82dp%E6%B3%9B%E5%81%9A/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚æ˜¯æ•´ç†â€œ[HNOI2008]GTè€ƒè¯•â€å’Œâ€œ[SNOI2017]ç¤¼ç‰©â€ä¸¤é“é¢˜ã€‚ç”±äºå®åœ¨æ‰¾ä¸å‡ºä»€ä¹ˆå…±åŒç‚¹æ¥ï¼Œæ‰€ä»¥å°±éšä¾¿æ‰¾äº†ä¸ªç†ç”±æŠŠä¸¤é“é¢˜æ”¾åœ¨ä¸€èµ·äº†233</p>
<p>ä»å„ä¸ªè§’åº¦æ¥çœ‹ï¼Œéƒ½ç®—æ˜¯æ¯”è¾ƒå¦™çš„è®¾è®¡æ–¹å¼äº†ï¼Ÿ</p>
<a id="more"></a>
<h1 id="HNOI2008-GTè€ƒè¯•"><a href="#HNOI2008-GTè€ƒè¯•" class="headerlink" title="[HNOI2008]GTè€ƒè¯•"></a>[HNOI2008]GTè€ƒè¯•</h1><blockquote>
<p>æ±‚ $n$ ä½æ•°å­—ä¸²ä¸è¿ç»­åŒ…æ‹¬æŸä¸ªé•¿åº¦ä¸º $m$ çš„æ•°å­—ä¸²çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>$n\leq 10^9,m\leq 20$</p>
</blockquote>
<p>è€ƒè™‘ç›´æ¥ $dp$ ã€‚ä¸ªäººè®¤ä¸ºè¿™ä¸ªåœ°æ–¹è¿˜æ˜¯æœ‰ä¸€ç‚¹ trivial çš„ã€‚é¦–å…ˆå°±æ˜¯è€ƒè™‘ä¸€ç§çŠ¶æ€è®¾è®¡ï¼Œè®° $f_{i,j}$ è¡¨ç¤ºé•¿ä¸²åŒ¹é…åˆ°ç¬¬ $i$ ä½ï¼ŒçŸ­ä¸²åŒ¹é…åˆ°ç¬¬ $j$ ä½çš„åˆæ³•æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆè€ƒè™‘å¯ä»¥è½¬ç§»ï¼š</p>
<script type="math/tex; mode=display">
f_{i,j}=\sum_{k=0}^{9}f_{i-1,o}</script><p>å…¶ä¸­ $o=0\sim j-1$ï¼Œå–å†³äºæ€ä¹ˆä¸ªå¤±é…æ³•ã€‚è¿™æ ·è½¬ç§»ä¼¼ä¹å¹¶ä¸å¯ä»¥ã€‚äºæ˜¯è€ƒè™‘å¦ä¸€ç§æ–¹å¼è½¬ç§»</p>
<script type="math/tex; mode=display">
f_{i,j}=\sum_{k=0}^{m-1}f_{i-1,k}\cdot g_{k,j}</script><p>å…¶ä¸­ $g_{x,y}$ è¡¨ç¤ºç°åœ¨å·²ç»åŒ¹é…åˆ°äº†ç¬¬ $x$ ä½ï¼Œæœ‰å¤šå°‘ç§æ–¹æ¡ˆä½¿å¾—åœ¨åŠ äº†ä¸€ä¸ªæ•°å­—åå˜æˆåŒ¹é…åˆ° $y$ ä½çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>å‘ç°æœ¬è´¨ä¸Šè¿™å°±æ˜¯åœ¨åšä¸€ä¸ª KMPã€‚äºæ˜¯å¯ä»¥ç”¨ KMP é¢„å¤„ç†å¤„è¿™æ ·çš„ä¸€å¼ æ•°è¡¨ $\{g\}$ ã€‚åŒæ—¶ï¼Œå‘ç°å¯¹äºåŸæ¥çš„å¼å­ï¼Œå³è¾¹çš„ $g$ ä¸å˜ï¼Œä¸”è½¬ç§»æ–¹å¼å°±æ˜¯çŸ©é˜µçš„è½¬ç§»æ–¹å¼ï¼Œäºæ˜¯è€ƒè™‘ç›´æ¥ç”¨çŸ©é˜µä¼˜åŒ–æ‰ã€‚æœ€ç»ˆå¤æ‚åº¦ $m^3\log n$ã€‚</p>
<p>btwï¼Œç”±äºæœ¬è´¨ä¸Šè½¬ç§»å·²ç»å†™åœ¨é‚£é‡Œäº†ï¼Œæ‰€ä»¥ä¸ç”¨è´¹åŠ²å»æ„é€ ä¸€ä¸ªçŸ©é˜µäº†â€¦wsdd</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> fail[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, p ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> M[N][N] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(M, <span class="number">0</span>, <span class="keyword">sizeof</span>(M)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span></span>&#123;</span><br><span class="line">        clear() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; N ; ++ i) M[i][i] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">friend</span> <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix &amp;a, <span class="keyword">const</span> Matrix &amp;b)&#123;</span><br><span class="line">        Matrix ans ; ans.clear() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; N ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; N ; ++ j)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; N ; ++ k)</span><br><span class="line">                    (ans.M[i][j] += a.M[i][k] * b.M[k][j] % p) %= p ;</span><br><span class="line">        <span class="keyword">return</span> ans ;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">friend</span> <span class="keyword">operator</span> ^ (Matrix a, <span class="keyword">int</span> b)&#123;</span><br><span class="line">        Matrix res ; res.reset() ;</span><br><span class="line">        <span class="keyword">while</span> (b)&#123;</span><br><span class="line">            <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">                res = res * a ;</span><br><span class="line">            a = a * a ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; g ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; p ; <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, j = <span class="number">0</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (j &amp;&amp; s[j + <span class="number">1</span>] != s[i]) j = fail[j] ;</span><br><span class="line">        <span class="keyword">if</span> (s[j + <span class="number">1</span>] == s[i]) ++ j ; fail[i] = j ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>, i = <span class="number">0</span> ; i &lt; m ; j = ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="string">'0'</span> ; c &lt;= <span class="string">'9'</span> ; j = i, ++ c)&#123;</span><br><span class="line">            <span class="keyword">while</span> (j &amp;&amp; (<span class="keyword">int</span>)s[j + <span class="number">1</span>] != c) j = fail[j] ;</span><br><span class="line">            <span class="keyword">if</span> ((<span class="keyword">int</span>)s[j + <span class="number">1</span>] == c) ++ j ; g.M[i][j] ++ ;</span><br><span class="line">        &#125;</span><br><span class="line">    g = g ^ n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; m ; ++ i)</span><br><span class="line">        (ans += g.M[<span class="number">0</span>][i]) %= p ;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>, <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="SNOI2017-ç¤¼ç‰©"><a href="#SNOI2017-ç¤¼ç‰©" class="headerlink" title="[SNOI2017]ç¤¼ç‰©"></a>[SNOI2017]ç¤¼ç‰©</h1><blockquote>
<p> ç»™å®š $k$ï¼Œè®¾ $f_i$ çš„é€’æ¨å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
f_{i}=i^k+\sum_{j=1}^{i-1}f_j</script><p>$k\leq 500,n\leq 10^{18}$</p>
</blockquote>
<p>å½“ç„¶è¿™é¢˜æœ‰ä»€ä¹ˆå…¶ä½™çš„å¤§åŠ›å¤šé¡¹å¼ç®—æ³•ï¼Œå¤æ‚åº¦æ˜¯ä»€ä¹ˆ $O(k+\log n)$ çš„â€¦è¦çŸ¥é“åŸåŸæœ¬æœ¬è¿™é¢˜ $k$ åªæœ‰ $10$ è¿™ä¹ˆå¤§å•Š/kk</p>
<p>è€ƒè™‘å…ˆè®¾ $s_n=\sum_{i=1}^nf_i$ ï¼Œé‚£ä¹ˆå‘ç°</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_n&=s_{n-1}+n^k\\
s_n&=s_{n-1}+f_n\\
&=2\cdot s_{n-1}+n^k
\end{aligned}</script><p>äºæ˜¯å‘ç°å¯ä»¥é€’æ¨ $s_n$ã€‚é‚£ä¹ˆå‘ç°è¿™ä¸ªåœ°æ–¹æœ‰ä¸€ä¸ªå¸¸ç³»æ•° $n^k$ï¼Œå°è¯•ä¾é </p>
<script type="math/tex; mode=display">
(m+1)^k=\sum_{i=1}^k\binom{k}{i}m^i</script><p>è¿™ä¸ªä¸œè¥¿æ¥å¾—åˆ°ï¼Œå³</p>
<script type="math/tex; mode=display">
\left[\begin{array}{cccccc}
{2} & {\binom{k}{0}} & {\binom{k}{1}} & {\binom{k}{2}} & {\cdots} & {\binom{k}{k}} \\
{0} & {\binom{k}{0}} & {\binom{k}{1}} & {\binom{k}{2}} & {\cdots} & {\binom{k}{k}} \\
{0} & {0} & {\binom{k-1}{0}} & {\binom{k-1}{1}} & {\cdots} & {\binom{k-1}{k-1}} \\
{0} & {0} & {0} & {\binom{k-2}{0}} & {\cdots} & {\binom{k-2}{k-1}} \\
{\vdots} & {\vdots} & {\vdots} & {\vdots} & {\vdots} & {\vdots} \\
{0} & {0} & {0} & {0} & {0} & {\binom{0}{0}}
\end{array}\right]
\times\left[\begin{array}{c}
{s_n} \\
{n^{k}} \\
{n^{k-1}} \\
{n^{k-2}} \\
{\vdots} \\
{n^{0}}
\end{array}\right]=\left[\begin{array}{c}
{s_{n+1}} \\
{(n+1)^{k}} \\
{(n+1)^{k-2}} \\
{\vdots} \\
{(n+1)^{0}}
\end{array}\right]</script><p>ç„¶åå°±å¯ä»¥æ„‰å¿«åœ°çŸ©ä¹˜äº†ã€‚</p>
<p>ä¸è¿‡ä¼¼ä¹æœ‰ä¸ªæ€§è´¨å€¼å¾—æ³¨æ„ï¼Œå°±æ˜¯æœ¬èº«è¿™ä¸ªè½¬ç§»çŸ©é˜µå°±æ˜¯ä¸€ä¸ªä¸Šä¸‰è§’çš„å½¢å¼ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå­˜åœ¨ä»€ä¹ˆæœ‰è¶£çš„ä¸œè¥¿â€¦ä¸å¾—è€ŒçŸ¥ä¸å¾—è€ŒçŸ¥â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAK 43</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line">ll N, K, Ans, T, C[MAK][MAK]; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">expow</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	ll res = <span class="number">1</span> ; x %= Mod ;  </span><br><span class="line">	<span class="keyword">while</span> (y)&#123;</span><br><span class="line">		<span class="keyword">if</span> (y &amp; <span class="number">1</span>) res = res * x % Mod ; </span><br><span class="line">		x = x * x % Mod, <span class="comment">/* pks */</span> y &gt;&gt;= <span class="number">1</span> ;   </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">Solve1</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		Ans = (T + expow(i, K)) % Mod, T = (T + Ans) % Mod ;</span><br><span class="line">	<span class="keyword">return</span> Ans ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Ma&#123;</span><br><span class="line">	<span class="keyword">int</span> i, j, k ; </span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span>&#123;</span></span><br><span class="line">		<span class="keyword">int</span> M[<span class="number">50</span>][<span class="number">50</span>] ; </span><br><span class="line">		<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123; <span class="built_in">memset</span>(M, <span class="number">0</span>, <span class="keyword">sizeof</span>(M)) ; &#125;</span><br><span class="line">		<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span></span>&#123; clear() ; <span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt;= K + <span class="number">1</span> ; ++ i) M[i][i] = <span class="number">1</span> ; &#125;</span><br><span class="line">		Matrix <span class="keyword">friend</span> <span class="keyword">operator</span> *(<span class="keyword">const</span> Matrix&amp;A, <span class="keyword">const</span> Matrix &amp;B)&#123;</span><br><span class="line">     	   Matrix Ans ; Ans.clear() ; <span class="keyword">int</span> P = K + <span class="number">2</span> ;</span><br><span class="line">     	   <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= P ; ++ i)</span><br><span class="line">     	       <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= P ; ++ j)</span><br><span class="line">     	           <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; k &lt;= P ; ++ k)</span><br><span class="line">     	               Ans.M[i][j] = (Ans.M[i][j] + <span class="number">1l</span>l * A.M[i][k] * B.M[k][j] % Mod ) % Mod ;</span><br><span class="line">     	   <span class="keyword">return</span> Ans ;</span><br><span class="line">    	&#125;</span><br><span class="line">   		Matrix <span class="keyword">friend</span> <span class="keyword">operator</span> +(<span class="keyword">const</span> Matrix&amp;A, <span class="keyword">const</span> Matrix &amp;B)&#123;</span><br><span class="line">        	Matrix Ans ; Ans.clear() ; </span><br><span class="line">        	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= K + <span class="number">2</span> ; ++ i)</span><br><span class="line">            	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= K + <span class="number">2</span> ; ++ j)</span><br><span class="line">                    Ans.M[i][j] = (A.M[i][j] + B.M[i][j]) % Mod ;</span><br><span class="line">        	<span class="keyword">return</span> Ans ;</span><br><span class="line">    	&#125;</span><br><span class="line">	&#125;P, Ans ; <span class="keyword">int</span> C[MAK][MAK] ;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">		P.M[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">2</span>, C[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= K + <span class="number">2</span> ; ++ i) C[i][<span class="number">0</span>] = <span class="number">1</span> ; </span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= K + <span class="number">2</span> ; ++ i)</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= K + <span class="number">2</span> ; ++ j)</span><br><span class="line">				C[i][j] = (<span class="number">1l</span>l * C[i - <span class="number">1</span>][j] + <span class="number">1l</span>l * C[i - <span class="number">1</span>][j - <span class="number">1</span>]) % Mod ;</span><br><span class="line"> 		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= K + <span class="number">2</span> ; ++ i) P.M[<span class="number">1</span>][i + <span class="number">1</span>] = C[K][i - <span class="number">1</span>] ;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= K + <span class="number">2</span> ; ++ i)</span><br><span class="line">			<span class="keyword">for</span> (j = i ; j &lt;= K + <span class="number">2</span> ; ++ j)</span><br><span class="line">				P.M[i][j] = C[K + <span class="number">2</span> - i	][j - i] ;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> (i = K + <span class="number">2</span> ; i &gt;= <span class="number">1</span> ; -- i) Ans.M[i][<span class="number">1</span>] = <span class="number">1</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> Matrix <span class="title">expow</span><span class="params">(Matrix x, <span class="keyword">long</span> <span class="keyword">long</span> y)</span></span>&#123;</span><br><span class="line">		Matrix res ; res.reset() ;</span><br><span class="line">		<span class="keyword">while</span> (y)&#123;</span><br><span class="line">			<span class="keyword">if</span> (y &amp; <span class="number">1</span>) res = res * x ;</span><br><span class="line">			x = x * x, <span class="comment">/*pkspkspks*/</span> y &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> res = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">while</span> (y)&#123;</span><br><span class="line">			<span class="keyword">if</span> (y &amp; <span class="number">1</span>) res = <span class="number">1l</span>l * res * x % Mod ;</span><br><span class="line">			x = <span class="number">1l</span>l * x * x % Mod, <span class="comment">/*pkspkspks*/</span> y &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Solve2</span><span class="params">()</span></span>&#123;</span><br><span class="line">		P.clear() ; Init() ; </span><br><span class="line">		Matrix A1, A2, N1, N2 ;</span><br><span class="line">		N1 = expow(P, N - <span class="number">2</span>), N2 = N1 * P ;  <span class="comment">/*</span></span><br><span class="line"><span class="comment">		for (i = 1 ; i &lt;= K + 2 ; ++ i, cout &lt;&lt; endl)</span></span><br><span class="line"><span class="comment">			for (j = 1 ; j &lt;= K + 2 ; ++ j)</span></span><br><span class="line"><span class="comment">				 cout &lt;&lt; P.M[i][j] &lt;&lt; " " ; */</span></span><br><span class="line"><span class="comment">//		Matrix t = Ans * P ; 	</span></span><br><span class="line">		A1 = N1 * Ans, A2 = N2 * Ans ; </span><br><span class="line">		<span class="keyword">return</span> (A2.M[<span class="number">1</span>][<span class="number">1</span>] - A1.M[<span class="number">1</span>][<span class="number">1</span>] + Mod) % Mod ; </span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K ; </span><br><span class="line">	<span class="keyword">if</span> (N &lt;= <span class="number">1000000</span>) <span class="built_in">cout</span> &lt;&lt; Solve1() ;</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; (Ma :: Solve2()) &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å”‰ï¼Œæ¯”äººä¼šçš„æˆ‘éƒ½ä¸ä¼šï¼Œæ²¡æœ‰å‰é€”å•Šã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>æ³›åš</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/æœ‰æŠ€å·§çš„DP</tag>
        <tag>æ•°å­¦/çº¿æ€§ä»£æ•°/çŸ©é˜µ</tag>
        <tag>å­—ç¬¦ä¸²/KMP</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘uoj#221 [NOI2016]å¾ªç¯ä¹‹ç¾</title>
    <url>/2020/02/18/NOI2016%E5%BE%AA%E7%8E%AF%E4%B9%8B%E7%BE%8E/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>ç»™å®š $n, m, k$ï¼Œæ±‚æœ‰å¤šå°‘æ•°å€¼ä¸Šäº’ä¸ç›¸ç­‰çš„å¯ä»¥è¡¨ç¤ºæˆ $\frac{x}{y}$ çš„æ•°ï¼Œ æ»¡è¶³ $1 â‰¤ x â‰¤ n$ï¼Œ$1 â‰¤ y â‰¤ m$ï¼Œä¸”å…¶åœ¨ $k$ è¿›åˆ¶ä¸‹æ˜¯çº¯å¾ªç¯å°æ•°ã€‚ </p>
<p>ç‰¹åˆ«çš„ï¼Œæ•´æ•°æ˜¯çº¯å¾ªç¯å°æ•°ã€‚  $1 â‰¤ n, m â‰¤ 10^9,2 â‰¤ k â‰¤ 2000$ ã€‚</p>
</blockquote>
<a id="more"></a>
<p>è€ƒè™‘æœ¬è´¨ä¸Šå°æ•°æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œå‘ç°å°±æ˜¯å½“ $x/y$ é™¤åˆ°ä¸èƒ½é™¤æ—¶ï¼Œ$k$ è¿›åˆ¶ä¸‹ï¼Œ$x\times k$ ä¹‹åç»§ç»­é™¤ä¸‹å»ã€‚é‚£ä¹ˆå‡è®¾å¾ªç¯èŠ‚é•¿åº¦ä¸º $L$ ï¼Œé‚£ä¹ˆä¼šæœ‰ $x\bmod y=x\cdot k^L\bmod y$ ã€‚ä¹Ÿå°±æ˜¯è§£å¾— $k^L\equiv1(\bmod y)$ ã€‚é‚£ä¹ˆç”±äºé€†å…ƒå”¯ä¸€ï¼Œæ‰€ä»¥å­˜åœ¨è¿™æ ·çš„ä¸€ä¸ª $L$ï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨é€†å…ƒçš„å……è¦æ¡ä»¶å°±æ˜¯ $k \perp y$ ã€‚</p>
<p>å¹¶ä¸”ç”±äºä¸ç®—é‡ï¼Œè¿˜è¦æ±‚ $x\perp y$ ã€‚æ‰€ä»¥æœ€åæœ¬è´¨ä¸Šæ˜¯è¦æ±‚ï¼š</p>
<script type="math/tex; mode=display">
\sum_{i=1}^{n} \sum_{j=1}^{m}[j \perp k][i \perp j]</script><p>éšä¾¿åæ¼”ä¸€ä¸‹</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum_{i=1}^{n} \sum_{j=1}^{m}[j \perp k][i \perp j]\\
=&\sum_{i=1}^n\sum_{j=1}^m[j\perp k]\sum_{d|i\operatorname{and}d|j} \mu(d)\\
=&\sum_{d=1}^n\mu(d)\cdot \lfloor\frac{n}{d}\rfloor\cdot [d\perp k] \cdot \sum_{j=1}^{\lfloor\frac{m}{d}\rfloor} [j\perp k]
\end{aligned}</script><p>è€ƒè™‘åé¢é‚£ä¸ª $\sum$ ã€‚è‹¥ä»¤</p>
<script type="math/tex; mode=display">
f_n=\sum_{i=1}^n[i\perp k]</script><p>é‚£ä¹ˆç”±äº $\gcd$ çš„ä¼˜ç§€æ€§è´¨ $\gcd(a,b)=\gcd(b,a\bmod b)$ æ‰€ä»¥</p>
<script type="math/tex; mode=display">
f_n=\lfloor\frac{n}{k}\rfloor\cdot f_{k}+f_{n\bmod k}</script><p>è¿™ä¸ªè½¬ç§»æœ¬è´¨ä¸Šæ˜¯åœ¨åšä¸€ä¸ªåˆ†å—ã€‚</p>
<p>é‚£ä¹ˆè€ƒè™‘å‰åŠéƒ¨åˆ†è¿™ä¸ª $\sum $ ã€‚å‘ç°å¦‚æœè¦æ•°è®ºåˆ†å—çš„è¯ï¼Œéœ€è¦å¿«é€Ÿæ±‚</p>
<script type="math/tex; mode=display">
s(n,k)=\sum_{i=1}^n\mu(i)\cdot [i\perp k]</script><p>è¿™ä¸ªä¸œè¥¿ã€‚æ ¹æ®ä¸€ä¸ªç¥å¥‡çš„ $\mu$ å‡½æ•°çš„æ€§è´¨ $\mu(ab)=[a\perp b]\mu(a)\mu(b)$ï¼Œå¯ä»¥å¾—åˆ°</p>
<script type="math/tex; mode=display">
\begin{aligned}
s(n,k)&=\sum_{i=1}^n\mu(i)\cdot [i\perp k]\\
&=\sum_{i=1}^n\mu(i)\sum_{d|i\operatorname{and}d|k} \mu(d)\\
&=\sum_{d|k} \mu(d) \sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\mu(d\cdot i) \\
&=\sum_{d|k} \mu(d) \sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\mu(d)\cdot \mu(i)\cdot[i\perp d]\\
&=\sum_{d|k} \mu^2(d) \sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\mu(i)\cdot[i\perp d] \\
&=\sum_{d|k} \mu^2(d) \cdot s(\lfloor\frac{n}{d}\rfloor,d) 
\end{aligned}</script><p>é‚£ä¹ˆè¿™ä¸œè¥¿æ˜¾ç„¶å¯ä»¥ç”¨ä¸€ä¸ªç±»æœæ•™ç­›çŠ¶ç‰©æ¥åšï¼Œå¤§è‡´å°±æ˜¯å½“ $k=1$ æ—¶æœ¬è´¨ä¸Šå°±æ˜¯åœ¨åšä¸€ä¸ªæœæ•™ç­›ï¼Œå½“ $k&gt;1$ æ—¶åªéœ€è¦æšä¸¾ $x$ çš„å…¨éƒ¨å› å­ï¼Œè¿™æ ·è½¬ç§»æœ€å¤šæœ‰ $\sigma_0(k)$ ç§ï¼Œ$k$ ä¹Ÿåªä¼šæœ‰ $\sigma_0(k)$ ä¸ªï¼Œé€’å½’åšä¸‹å»å°±å¥½äº†ã€‚è¿™æ ·å¤æ‚åº¦çš„ä¸Šç•Œæ˜¯ $O(n^{\frac{2}{3}}+\sigma_0^2(k)\sqrt n)$ ï¼Œæ˜¯ä¸€ä¸ªæå…¶æ¾çš„ä¸Šç•Œã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mkp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pint pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1001000</span> ;</span><br><span class="line"></span><br><span class="line">LL f[N] ;</span><br><span class="line">LL G[N] ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> mu[M] ;</span><br><span class="line"><span class="keyword">int</span> pr[M] ;</span><br><span class="line"><span class="keyword">int</span> smu[M] ;</span><br><span class="line"><span class="keyword">int</span> chk[M] ;</span><br><span class="line"><span class="keyword">int</span> n, m, k ;</span><br><span class="line"><span class="built_in">map</span>&lt;pint, <span class="keyword">int</span>&gt; S ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (!y) ? x : gcd(y, x % y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">F</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1l</span>l * ((n / k) * f[k] + f[n % k]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= x ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!chk[i])</span><br><span class="line">            pr[++ cnt] = i, mu[i] = <span class="number">-1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i * pr[j] &gt; x) <span class="keyword">break</span> ;</span><br><span class="line">            chk[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">            mu[i * pr[j]] = -mu[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= x ; ++ i)</span><br><span class="line">        smu[i] = smu[i - <span class="number">1</span>] + mu[i] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">s</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!n || (k == <span class="number">1</span> &amp;&amp; n &lt; M))</span><br><span class="line">        <span class="keyword">return</span> smu[n] ; <span class="keyword">int</span> ans = <span class="number">0</span> ;</span><br><span class="line">    pint t = mkp(n, k) ;</span><br><span class="line">    <span class="keyword">if</span> (S.count(t)) <span class="keyword">return</span> S[t] ;</span><br><span class="line">    <span class="keyword">if</span> (k == <span class="number">1</span>)&#123;</span><br><span class="line">        ans = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>, r ; l &lt;= n ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">            r = n / (n / l) ;</span><br><span class="line">            ans -= (r - l + <span class="number">1</span>) * s(n / r, k) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        ans = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i * i &lt;= k ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (k % i == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span> (mu[i]) ans += s(n / i, i) ;</span><br><span class="line">                <span class="keyword">if</span> (i * i != k &amp;&amp; mu[k / i])</span><br><span class="line">                    ans += s(n / (k / i), k / i) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    S[t] = ans ; <span class="keyword">return</span> ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    LL ans = <span class="number">0</span>, last = <span class="number">0</span>, now ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r ; l &lt;= n ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">        r = min(n / (n / l), m / (m / l)) ; now = s(r, k) ;</span><br><span class="line">        ans += (now - last) * (LL)(n / l) * F(m / l, k) ; last = now ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    sieve(M - <span class="number">1</span>) ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k ;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; m) swap(n, m) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        f[i] = f[i - <span class="number">1</span>] + (<span class="keyword">bool</span>)(gcd(i, k) == <span class="number">1</span>) ;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, solve()) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>uoj</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°/è«æ¯”ä¹Œæ–¯åæ¼”</tag>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°æ±‚å’Œ/æœæ•™ç­›</tag>
        <tag>æ•°å­¦/æ•°è®º</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ³›å­¦ç¬”è®°ã€‘ç»„åˆè®¡æ•°æ‚é¡¹</title>
    <url>/2020/02/17/%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0%E6%9D%82%E9%A1%B9/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚æ˜¯å¬è¯¾å¬æ¥çš„ç»„åˆè®¡æ•°ç›¸å…³.jpg</p>
<a id="more"></a>
<h2 id="å¹¿ä¹‰äºŒé¡¹å¼å®šç†"><a href="#å¹¿ä¹‰äºŒé¡¹å¼å®šç†" class="headerlink" title="å¹¿ä¹‰äºŒé¡¹å¼å®šç†"></a>å¹¿ä¹‰äºŒé¡¹å¼å®šç†</h2><p>$a\in \mathbb{R}$</p>
<script type="math/tex; mode=display">
(x+y)^{a}=\sum_{k=0}^{\infty} \frac{a^{\underline k}}{k!} x^{k} y^{a-k}\\\</script><p>æ³°å‹’å±•å¼€è¯æ˜ã€‚</p>
<h2 id="æŠ½å±‰åŸç†ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„è¡¨è¾¾"><a href="#æŠ½å±‰åŸç†ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„è¡¨è¾¾" class="headerlink" title="æŠ½å±‰åŸç†ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„è¡¨è¾¾"></a>æŠ½å±‰åŸç†ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„è¡¨è¾¾</h2><p>æŠŠ $kx+b$ ä¸ªç‰©å“æ”¾è¿› $x$ ä¸ªç›’å­é‡Œ $(0&lt;b\leq k)$ï¼Œå¿…æœ‰ $1$ ä¸ªç›’å­é‡Œé¢è‡³å°‘æœ‰ $k+1$ ä¸ªç‰©å“ã€‚</p>
<h2 id="å¡ç‰¹å…°æ•°"><a href="#å¡ç‰¹å…°æ•°" class="headerlink" title="å¡ç‰¹å…°æ•°"></a>å¡ç‰¹å…°æ•°</h2><script type="math/tex; mode=display">
h_n=\binom{2n}{n}-\binom{2n}{n-1}</script><p>æ–¹æ ¼è¡Œèµ°æ•°ã€‚</p>
<p>çjbèµ°ï¼Œä»$0,0$åˆ°$n,0$ï¼Œå…±$2n$æ¬¡å†³ç­–ï¼Œé€‰$n$æ¬¡å‘ä¸‹ã€‚</p>
<p>å‡å»èµ°é”™äº†çš„ï¼Œè€ƒè™‘æˆ‘ä»¬ç¬¬ä¸€æ¬¡èµ°åˆ° $y=-1$ è¿™æ¡ç›´çº¿ä¸Šï¼Œå…³äºè¿™æ¡ç›´çº¿æŠŠ $(n,0)$ å¯¹ç§°ä¸‹æ¥ï¼Œç„¶åå°±å˜æˆäº†ä» $(0,0)$ èµ°åˆ° $(n,-2)$ çš„é—®é¢˜ï¼Œå³é€‰æ‹© $n-1$ æ­¥å‘ä¸Šï¼Œ$n+1$ æ­¥å‘ä¸‹ã€‚</p>
<p>ç„¶åï¼Œæˆ‘sdäº†ï¼ŒåŸå› åœ¨äºæˆ‘æ€è€ƒäº†åŠå¤©ä¸ºä»€ä¹ˆå‡å»çš„è´¡çŒ®ä¸ç”¨ $\times 2$ï¼Œå› ä¸ºè¿™ä¸å¯¹ç§°ï¼Œç»“æœå‘ç°åŸæ¥èµ°åˆ° $y=1$ æ˜¯åˆæ³•çš„ï¼Œè‰¹ï¼Œè„‘è¢‹è«å¾—äº†ã€‚</p>
<h2 id="ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°"><a href="#ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°" class="headerlink" title="ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°"></a>ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°</h2><p>æœ‰ç¬¦å·çš„ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°è®°ä½œ$\rm \mathrm{S}_s$ï¼Œæ— ç¬¦å·è®°ä½œ$\rm \mathrm{S}_u$ã€‚</p>
<script type="math/tex; mode=display">
\mathrm{S}_s(n,m)=(-1)^{n+m}\mathrm{S}_u(n,m)</script><p>åœ†æ’åˆ—æ–¹æ¡ˆæ•°ã€‚</p>
<p>åŒæ—¶ $\rm \mathrm{S}_s$ çš„ç”Ÿæˆå‡½æ•°æ˜¯ $x^{\underline{n}}$ï¼Œå³å›ºå®š $n$ ä¸å˜æ—¶ï¼Œ$\rm \mathrm{S}_s$ çš„ $m$ åœ¨ $1\to \infty$ æ—¶çš„ç”Ÿæˆå‡½æ•°æ˜¯ $x$ çš„ $n$ æ¬¡ä¸‹é™å¹‚ã€‚</p>
<p>ï¼ˆ$n$ å›ºå®šä¸‹æ¥ä¹‹åçš„æŸä¸€è¡Œï¼‰</p>
<h2 id="ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ï¼š"><a href="#ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ï¼š" class="headerlink" title="ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ï¼š"></a>ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ï¼š</h2><script type="math/tex; mode=display">
\begin{array}{l}{\mathrm{S}(n, m)=\mathrm{S}(n-1, m-1)+m * \mathrm{S}(n-1, m)} \\\ {\mathrm{S}(n, m)=\frac{1}{m !} \sum(-1)^{k}\left(\begin{array}{c}{m} \\ {k}\end{array}\right)(m-k)^{n}}\end{array}</script><p>è´å°”æ•°ä¸ºç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ä¹‹å’Œï¼Œå³æŠŠ $n$ ä¸ªæ•°æ‹†æˆ $k~(k\in \mathbb{N+})$ é›†åˆçš„æ–¹æ¡ˆæ•°ä¹‹å’Œã€‚</p>
<p>psï¼šäºŒæ–¯éƒ½æ˜¯ä¸å¸¦æ ‡å·çš„ï¼Œä¼¼ä¹å› ä¸ºå®šä¹‰å‡ºæ¥ä¹Ÿæ²¡å•¥æ„ä¹‰å§ã€‚</p>
<h2 id="æ‹†åˆ†æ•°çš„éOGFåšæ³•"><a href="#æ‹†åˆ†æ•°çš„éOGFåšæ³•" class="headerlink" title="æ‹†åˆ†æ•°çš„éOGFåšæ³•"></a>æ‹†åˆ†æ•°çš„éOGFåšæ³•</h2><p>ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°å®é™…ä¸Šæ˜¯<strong>$\boldsymbol{n}$å¸¦æ ‡å·ï¼ˆnä¸ªä¸åŒç‰©å“ï¼‰ï¼Œ$\boldsymbol{m}$ä¸å¸¦æ ‡å·</strong>ã€‚</p>
<p>å½“$n,m$éƒ½æ— æ ‡å·æ—¶ï¼Œè¿™ä¸ªé—®é¢˜å®é™…ä¸Šå°±æ˜¯<strong>æ‹†åˆ†æ•°</strong>é—®é¢˜ï¼Œå³$3=2+1$åªä»£è¡¨ä¸€ç§æƒ…å†µï¼Œè€Œå¦‚æœæœ‰æ ‡å·çš„è¯åº”è¯¥æ˜¯ä¸‰ç§æƒ…å†µï¼ˆ$C_3^2$ï¼‰.</p>
<p>é‚£ä¹ˆå¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œè€ƒè™‘ä¸¤ç§$dp$.</p>
<ul>
<li>1ã€ä»¤ $f_{i,j}$ è¡¨ç¤ºå¯¹äº $i$ æ‹†åˆ†æˆè‹¥å¹²ä¸ªä¸å¤§äº $j$ çš„æ•°çš„æ–¹æ¡ˆæ•°ã€‚åˆ™æœ‰è½¬ç§»ï¼š<script type="math/tex; mode=display">
f_{i,j}=f_{i,j-1}+f_{i-j,j}</script>åé¢ä¸€é¡¹ $f_{i-j,j}$ å¯ä»¥çœ‹æˆä¸€ä¸ªèƒŒåŒ…ä¸€æ ·ï¼Œåé¢çš„çŠ¶æ€å¯¹å‰é¢çš„çŠ¶æ€æœ‰å¤©ç„¶çš„ç´¯åŠ æ•ˆåº”ï¼Œæ‰€ä»¥åªéœ€è¦è€ƒè™‘ä¸¢åˆ°ä¸€ä¸ª $j$ çš„æƒ…å†µï¼›è€Œå‰é¢ä¸€é¡¹åˆ™æŠŠæˆ‘ä»¬è½¬ç§»ä»åä¸€é¡¹çš„<strong>ç­‰äº</strong> $j$ å‡çº§æˆä¸º<strong>ä¸å¤§äº</strong> $j$ ã€‚</li>
<li>2ã€ä»¤ $g_{i,j}$ è¡¨ç¤ºå¯¹äº $i$ æ‹†åˆ†æˆ $j$ ä¸ªæ•°çš„æ–¹æ¡ˆæ•°ã€‚åˆ™æœ‰è½¬ç§»ï¼š<script type="math/tex; mode=display">
g_{i,j}=g_{i-1,j-1}+g_{i-j,j}</script>å‰é¢ä¸€é¡¹è¡¨ç¤ºæ–°æ‹†å‡ºä¸€ä¸ª $1$ æ¥ï¼Œè¿˜æ˜¯èƒŒåŒ…çš„é‚£ç§â€œç´¯åŠ â€æ€æƒ³ï¼Œæ‰€ä»¥åªéœ€è¦è€ƒè™‘æ‹†å‡ºä¸€ä¸ª $1$ çš„æƒ…å†µï¼›åé¢ä¸€é¡¹åˆ™è¡¨ç¤ºä¸æ‹†ï¼Œè€Œæ˜¯æŠŠæ‹†å‡ºçš„æ•°å…¨ä½“éƒ½ $+1$ï¼Œå³æœ¬æ¥çš„ $5=3+1+1$ è½¬ç§»åˆ° $8=4+2+2$ ã€‚æ³¨æ„æ­¤å¤„ä¸ä¼šå­˜åœ¨â€œéƒ¨åˆ†æ‹†å‡ºæ¥çš„æ•°åŠ äº†ä½†æ˜¯å‰©ä¸‹çš„æ²¡åŠ â€æˆ–è€…â€œåŠ çš„ä¸ä¸€æ ·â€ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªçŠ¶æ€éƒ½æ˜¯å¯ä»¥å½’çº¦åˆ° $i$ è¾ƒå°çš„ $g$ ä¸Šå»æ‰€ä»¥ä¸éœ€è¦é¢å¤–è½¬ç§»ã€‚</li>
</ul>
<p>å—¯ï¼Œæ‰€ä»¥æœ‰æ—¶å€™çŠ¶æ€çš„è½¬ç§»ä¸è®¾è®¡å­˜åœ¨â€œé«˜é˜¶çŠ¶æ€å¯¹ä½é˜¶çŠ¶æ€æœ‰å¤©ç„¶çš„ç´¯åŠ æ•ˆåº”â€ï¼Œæ¢ä¸ªä¸ä¸¥è°¨çš„æªè¾å°±æ˜¯<code>+</code>è¿ç®—ä½¿å¾—å­˜åœ¨çŠ¶æ€é—´çš„çš„ç›¸äº’å½’çº¦ã€‚è¿™æ˜¯è®¾è®¡çŠ¶æ€ä¸­éœ€è¦è€ƒè™‘çš„ä¸€ä¸ªæ–°å¥‡çš„ä¸œè¥¿ã€‚</p>
<p>psï¼šä¼¼ä¹æŸç¡¬å¸xxçš„å®¹æ–¥é¢˜å°±ç”¨åˆ°äº†è¿™ä¸ªæ€æƒ³æ¥ç€ã€‚ã€‚ã€‚å®é™…ä¸Šå°±æ˜¯ä¸ªèƒŒåŒ…å§qaq</p>
<h2 id="LOJ-6268-åˆ†æ‹†æ•°"><a href="#LOJ-6268-åˆ†æ‹†æ•°" class="headerlink" title="LOJ 6268 åˆ†æ‹†æ•°"></a>LOJ 6268 åˆ†æ‹†æ•°</h2><p>å‘ç°æ˜¯ <code>#6</code> çš„å‡çº§ç‰ˆã€‚</p>
<p>è€ƒè™‘æ ¹å·åˆ†æ²»ã€‚å…ˆç”¨ $f$ æ±‚å‡ºæ¥ $j\leq \sqrt n$ çš„æ–¹æ¡ˆæ•°ï¼Œå†é­”æ”¹ä¸€ä¸‹ $g$ï¼Œè®© $g$ åªè½¬ç§»é‚£äº› $\geq \sqrt n$ çš„æ•°å­—ï¼Œå…·ä½“å°±æ˜¯ç¬¬ä¸€ç»´æŠŠ $\sqrt n$ å½“ä½œæ­¥é•¿è½¬ç§»å³å¯ã€‚</p>
<p>ä¹‹åè€ƒè™‘åˆå¹¶è¿™ä¸¤ä¸ªè½¬ç§»ã€‚å‘ç°æœ€åè½¬ç§»å®Œåšä¸€ä¸ªç´¯åŠ ï¼Œç»Ÿè®¡å‡ºä¸¤ä¸ªå¤šé¡¹å¼æ¥ï¼Œåˆ†åˆ«ä»£è¡¨å‡‘å‡ºä½“ç§¯ $i$ çš„æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆä¸¤ä¸ªå¤šé¡¹å¼çš„åˆå¹¶å°±æ˜¯ä¸€ä¸ªå·ç§¯çš„å½¢å¼ï¼Œå°±ç›´æ¥ $\rm NTT$ åšå°±å®Œäº†ã€‚</p>
<h2 id="è¿é€šå›¾è®¡æ•°"><a href="#è¿é€šå›¾è®¡æ•°" class="headerlink" title="è¿é€šå›¾è®¡æ•°"></a>è¿é€šå›¾è®¡æ•°</h2><p>å®šä¹‰è¿é€šå›¾çš„ $\rm EGF$ ä¸º $F(x)$ï¼Œä»»æ„å›¾çš„ $\rm EGF$ ä¸º $G(x)$ ã€‚</p>
<p>è€ƒè™‘</p>
<script type="math/tex; mode=display">
G(x)=\sum_{n \geq 0} \frac{2^{n(n-1) / 2}}{n !} x^{n}</script><p>é‚£ä¹ˆè€ƒè™‘ä¸€å®šæœ‰ $G(x)=e(F(x))$ ï¼Œå³ $F(x)=\ln G(x)$ ã€‚</p>
<p>è¿™æ˜¯å› ä¸ºä»»æ„å›¾æœ¬èº«ç”±ä»»æ„ä¸ªè¿é€šå›¾æ„æˆï¼Œå³è€ƒè™‘ $G$ çš„å¦ä¸€ç§ç»„æˆæ–¹å¼ï¼Œä»åˆ†æˆçš„è¿é€šå—ä¸ªæ•°è¿›è¡Œè®¨è®ºã€‚é‚£ä¹ˆç”± $n$ ä¸ªè¿é€šå—æ„æˆçš„å›¾ï¼Œåº”è¯¥è‡³å°‘æœ‰ $F^n$ ï¼Œå¹¶ä¸”ç”±äºå¸¦æ ‡å·ä¸”æ— åºï¼Œæ‰€ä»¥ $F$ åº”è¯¥ç”¨æŒ‡æ•°ç”Ÿæˆå‡½æ•°æ¥åˆ»ç”»ã€‚</p>
<p>ä¹Ÿå°±æ˜¯ä»è¿é€šå—çš„è§’åº¦æ¥è€ƒè™‘ï¼š</p>
<script type="math/tex; mode=display">
G=\sum\frac{F^n}{n!}</script><p>ç„¶åå°±å¯ä»¥è‚¥å®…å¿«ä¹ $\exp$ äº†ã€‚</p>
<p>å¤§æ¦‚ç±»ä¼¼äºå˜æ¢ç»„åˆå¯¹è±¡æ„é€ æ’ç­‰å¼è¿™ç§æ“ä½œã€‚</p>
<h2 id="Best-Theorem"><a href="#Best-Theorem" class="headerlink" title="Best Theorem"></a>Best Theorem</h2><p>ä¸€ä¸ªæœ‰å‘å›¾Gï¼Œæ¬§æ‹‰å›è·¯çš„æ•°é‡æ˜¯</p>
<script type="math/tex; mode=display">
t_{1}(G) * \prod_{i=1}^{n}(\operatorname{deg}(i)-1) !</script><p>å…¶ä¸­ $t_1(G)$ è¡¨ç¤º $G$ ä¸­ä»¥ $1$ ä¸ºæ ¹çš„ç”Ÿæˆæ ‘çš„æ•°é‡ã€‚</p>
<h2 id="æ‚é¢˜"><a href="#æ‚é¢˜" class="headerlink" title="æ‚é¢˜"></a>æ‚é¢˜</h2><h3 id="A"><a href="#A" class="headerlink" title="A"></a>A</h3><blockquote>
<p>ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„å›¾ï¼Œæ¯æ¡è¾¹æœ‰é•¿åº¦ $d_i$ å’Œä»·å€¼ $v_i$ã€‚ éšæœºé€‰å‡ºä¸€ä¸ªé•¿åº¦å’Œæœ€å°çš„ç”Ÿæˆæ ‘ï¼Œæ±‚ä»·å€¼å’Œçš„æœŸæœ›ã€‚ </p>
<p>$n, m â‰¤ 50$</p>
</blockquote>
<p>è€ƒè™‘å¦‚æœé•¿åº¦éƒ½æ˜¯ $1$ï¼ˆæˆ–è€…æ‰€æœ‰è¾¹é•¿åº¦å‡ç›¸åŒï¼Œæœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä»æ¯æ¡è¾¹çš„è´¡çŒ®å…¥æ‰‹ã€‚å¤§è‡´å°±æ˜¯è€ƒè™‘åˆ æ‰ä¸€æ¡è¾¹ï¼Œç”¨å‰©ä¸‹çš„æ±‚ä¸€éç”Ÿæˆæ ‘è®¡æ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç®—å‡ºè¿™æ¡è¾¹è¢«é€‰ä¸Šçš„æ¦‚ç‡ï¼Œè¿™æ ·å°±å¯ä»¥ä¸€æ¡è¾¹ä¸€æ¡è¾¹çš„è®¡ç®—è´¡çŒ®ã€‚å¤æ‚åº¦ $mn^3$ã€‚</p>
<p>å¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆè€ƒè™‘æŒ‰ç…§æƒå€¼é€’å¢çš„é¡ºåºåšå¦‚ä¸‹è¿‡ç¨‹ï¼šæŠŠå½“å‰æœ€å°çš„è¾¹æ‹¿å‡ºæ¥ï¼Œè¿™æ ·ä¼šæ˜¯å¤šä¸ªè”é€šå—ã€‚è€ƒè™‘åœ¨æœ€åçš„ç”Ÿæˆæ ‘ä¸­ï¼Œè¿™æ ·çš„è¾¹çš„æƒå€¼ä¸€å®šä¼šä½“ç°åœ¨å…¶ä¸­ï¼Œæ‰€ä»¥ç›¸å½“äºæ¯ä¸ªè”é€šå—å†…é€‰å‡ºä¸€æ£µæ ‘ï¼Œç”±äºç°åœ¨è¾¹æƒç›¸ç­‰æ‰€ä»¥åšæ³•å¯ä»¥å…ˆç”¨ä¸Šä¸€æ®µé‡Œçš„æ–¹æ³•ã€‚ä¹‹åè€ƒè™‘æŠŠè¿™ä¸ªè”é€šå—ç¼©æˆä¸€ä¸ªç‚¹ï¼Œç»§ç»­åšä¸‹å»ï¼Œç›´åˆ°è¾¹æ»¡äº†ä¸ºæ­¢ã€‚</p>
<p>ä¼¼ä¹è¿™æ ·åšä¸æ˜¯å¾ˆéœ€è¦æ³¨æ„ç»†èŠ‚ã€‚å› ä¸ºæœ¬è´¨ä¸Šå°±æ˜¯åœ¨é‡å¤ä¸€ä¸ªè´ªå¿ƒMSTçš„è¿‡ç¨‹ã€‚</p>
<h3 id="B"><a href="#B" class="headerlink" title="B"></a>B</h3><blockquote>
<p>ç»™å®šä¸€å¼  $n$ ä¸ªç‚¹ï¼Œ$m$ æ¡è¾¹çš„æ— å‘å›¾ï¼Œæ¯æ¡è¾¹æœ‰çº¢ç»¿è“ä¸‰ç§é¢œè‰²ï¼Œè¦æ±‚ç»¿è¾¹æ•°é‡ä¸è¶…è¿‡ $g$, è“è¾¹ä¸è¶…è¿‡ $b$ çš„ç”Ÿæˆæ ‘æ•°é‡ï¼Œç­”æ¡ˆå¯¹ $10^9 + 7$ å–æ¨¡ </p>
<p>$n â‰¤ 40$</p>
</blockquote>
<p>è€ƒè™‘ç»™æ¯æ¡ç»¿è¾¹ä¸€ä¸ªæƒå€¼å˜é‡ $x$, æ¯æ¡è“è¾¹ä¸€ä¸ªæƒå€¼å˜é‡ $y$ï¼Œæ ¹æ®æ‰©å±• MT å®šç†ï¼Œæœ€ç»ˆåªéœ€è¦å¯¹ç€ $xy$ çš„æ¬¡æ•°æ‰¾ç³»æ•°å³å¯ã€‚</p>
<p>è€Œé—®é¢˜åœ¨äºå¦‚ä½•æ±‚è¿™æ ·ä¸€ä¸ªè¡Œåˆ—å¼ã€‚è€ƒè™‘å¸¦å…¥ $n^2$ å¯¹ç‚¹å€¼ç»™ $x$ å’Œ $y$ï¼Œæœ€ç»ˆä½¿ç”¨è¿™äº›ç‚¹å€¼è¿›è¡ŒäºŒç»´æ’å€¼ï¼Œæ¢å¤å‡ºæœ¬æ¥çš„å¤šé¡¹å¼ã€‚å¤æ‚åº¦ä¼¼ä¹æ˜¯ $O(n^5)+O(n^4\sim n^6)$ ã€‚</p>
<p><del>äºŒç»´æ’å€¼æ€ä¹ˆå¯èƒ½ä¼šçš„å˜›ï¼Œæ‰€ä»¥å¤æ‚åº¦ä¸é‡è¦ï¼Œåæ­£æˆ‘ä¹Ÿä¸ä¼šå»å†™ã€‚</del></p>
<h3 id="C"><a href="#C" class="headerlink" title="C"></a>C</h3><blockquote>
<p>ç»™å®šä¸€ä¸ªå¸¦æƒæ— å‘å›¾ï¼Œå®šä¹‰ä¸€æ£µç”Ÿæˆæ ‘çš„æƒå€¼æ˜¯è¾¹æƒå’Œçš„ $k$ æ¬¡æ–¹ï¼Œæ±‚æ‰€æœ‰ç”Ÿæˆæ ‘çš„æƒå€¼å’Œï¼Œç­”æ¡ˆå¯¹ $10^9 + 7$ å–æ¨¡ã€‚ </p>
<p>$n, k â‰¤ 50$</p>
</blockquote>
<p>ä¸€æ­¥è½¬åŒ–ï¼Œè€ƒè™‘ä¸€å †æ•°çš„ $k$ æ¬¡æ–¹ç­‰ä»·äºä»è¿™å †æ•°é‡Œé€‰å‡º $k$ ä¸ªå¯é‡å¤çš„æ•°å­—çš„ç§¯ (è€ƒè™‘é¡ºåº)ï¼Œå†æ±‚å’Œã€‚ </p>
<p>é‚£ä¹ˆå¯ä»¥å°†æ¯æ¡è¾¹çš„è¾¹æƒé‡æ–°å®šä¹‰ä¸€ä¸ªå¤šé¡¹å¼ </p>
<script type="math/tex; mode=display">
âˆ‘^k_{i=0}\frac{(vx)^i}{i!}</script><p>è¡¨ç¤ºä¸€æ¡è¾¹æ‰€ä»£è¡¨çš„æƒå€¼å…·ä½“è¢«é€‰äº†è‹¥å¹²æ¬¡çš„æƒå€¼ã€‚å¯¹æ–°çš„æƒå€¼ä½¿ç”¨ <code>Matrix-tree</code>, å¾—åˆ°ä¸€ä¸ª $nk$ æ¬¡çš„å¤šé¡¹å¼ï¼Œ$x_k$ çš„ç³»æ•°ä¹˜ä¸Š $k!$ å°±æ˜¯ç­”æ¡ˆã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>æ³›å­¦</category>
      </categories>
      <tags>
        <tag>æ€ç»´é¢˜/è®¡æ•°</tag>
        <tag>ç»„åˆè®¡æ•°/ç”Ÿæˆå‡½æ•°</tag>
        <tag>ç»„åˆè®¡æ•°/æœ‰æŠ€å·§çš„è®¡æ•°</tag>
        <tag>ç»„åˆè®¡æ•°/æ–¯ç‰¹æ—æ•°</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ¯å‡½æ•°Part3</title>
    <url>/2020/02/15/%E3%80%8A%E6%AF%8D%E5%87%BD%E6%95%B0%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚å°±æ˜¯æ•´ç†ä¸€ä¸‹ã€Œä¼¯åŠªåˆ©æ•°ã€å§â€¦</p>
<p>å…¶å®è¿˜æœ‰ä¸€å—å…³äºåˆ‡æ¯”é›ªå¤«ä¸ç­‰å¼çš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä¸æ˜¯å¾ˆæœ‰æ„æ€ï¼Œå†³å®šä¸æ•´ç†äº†.jpg</p>
<a id="more"></a>
<h1 id="ä¼¯åŠªåˆ©æ•°"><a href="#ä¼¯åŠªåˆ©æ•°" class="headerlink" title="ä¼¯åŠªåˆ©æ•°"></a>ä¼¯åŠªåˆ©æ•°</h1><h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>è€ƒè™‘ç”¨æ¯å‡½æ•°çš„æ–¹å¼å®šä¹‰ã€‚æ­¤å¤„ç›´æ¥å®šä¹‰ä¼¯åŠªåˆ©æ•°çš„æŒ‡æ•°å‹æ¯å‡½æ•°æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\mathbf B=\frac{x}{e(x)-1}</script><p>é‚£ä¹ˆè€ƒè™‘å¦‚ä½•å±•å¼€ã€‚è®°ä¼¯åŠªåˆ©æ•°ä¸º $\{B_n\}$ã€‚å‘ç°ç§»ä¸€ä¸‹é¡¹</p>
<script type="math/tex; mode=display">
x=\left(B_0+B_1x+\frac{B_2}{2!}x^2\cdots\right) * \left(e(x)-1\right)</script><p>å¦‚æœè®°å³è¾¹å·å‡ºæ¥çš„ç»“æœæ˜¯ $\{a_n\}$ï¼Œé‚£ä¹ˆå‘ç°</p>
<script type="math/tex; mode=display">
a_n=\sum_{k=0}^{n-1}\binom{n}{k}B_k</script><p>æ­¤å¤„ä¸Šç•Œä¸º $n-1$ çš„åŸå› æ˜¯ $\left(e(x)-1\right)_0=0$ ï¼Œå…¶ä½™é¡¹å‡ä¸º $1$ ã€‚ </p>
<p>æ¯”è¾ƒåŒæ¬¡é¡¹ç³»æ•°å¯çŸ¥</p>
<script type="math/tex; mode=display">
B_0=1\\
\sum_{k=0}^{n-1}\binom{n}{k}B_k=0\qquad (n=2,3,4\cdots)</script><p>è€ƒè™‘ç”¨è¿™ä¸ªæ–¹ç¨‹å»é€’æ¨æ¯ä¸€é¡¹ã€‚å¤§è‡´æ€è·¯æ˜¯å·¦å³ä¸¤è¾¹åŒæ—¶åŠ ä¸Š $B_n$ ã€‚</p>
<script type="math/tex; mode=display">
\sum_{k=0}^{n}\binom{n}{k}B_k=B_n</script><p>ç„¶åå°±å¯ä»¥å‘ç°ï¼Œæ¯”å¦‚æ‹¿ $n=2$ ä¸¾ä¾‹ï¼š</p>
<script type="math/tex; mode=display">
B_0+2B_1+B_2=B_2</script><p>å°±å¯ä»¥æ¶ˆæ‰ $B_2$ æ±‚å‡º $B_1$ã€‚ä»¥æ­¤ç±»æ¨ï¼Œæ¯æ¬¡ç”¨ $n$ å¯ä»¥æ¶ˆå‡º $B_{n-1}$ ã€‚</p>
<h2 id="ä¸€ä¸ªå°æ€§è´¨"><a href="#ä¸€ä¸ªå°æ€§è´¨" class="headerlink" title="ä¸€ä¸ªå°æ€§è´¨"></a>ä¸€ä¸ªå°æ€§è´¨</h2><p>è€ƒè™‘ $B_n$ çš„æ€§è´¨ï¼Œå‘ç°æ¨å‡ºæ¥çš„å¤§æ¦‚é•¿è¿™æ ·ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
&B_0=1\\
&B_1=-\frac{1}{2}\\
&B_2=\frac{1}{6}\\
&B_3=0\\
&B_4=-\frac{1}{30}\\
&B_5=0\\
&B_6=\frac{1}{42}\\
&B_7=0\\
&B_8=-\frac{1}{30}\\
&B_9=0\\
&B_{10}=\frac{5}{66}\\
&\cdots
\end{aligned}</script><p>å‘ç°ä¼¼ä¹ï¼Œé™¤äº† $B_1$ ä¹‹å¤–ï¼Œå…¶ä½™ $n$ ä¸ºå¥‡æ•°çš„æ—¶å€™å‡ä¸º $0$ ã€‚è¯æ˜è€ƒè™‘ï¼š</p>
<script type="math/tex; mode=display">
\frac{x}{e(x)-1}=\sum \frac{B_n}{n!}x^n=1-\frac{x}{2}+\sum_{k=2}^{\infty}\frac{B_k}{k!}x^k</script><p>é‚£ä¹ˆå¦‚æœä»¤</p>
<script type="math/tex; mode=display">
f(x)=\frac{x}{e(x)-1}+\frac{x}{2}</script><p>é‚£ä¹ˆ</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(-x)&=\frac{-x}{e(-x)-1}-\frac{x}{2}\\
&=\frac{-x}{\frac{1}{e(x)}-1}-\frac{x}{2}\\
&=\frac{-xe(x)}{1-e(x)}-\frac{x}{2}\\
&=x-\frac{x}{1-e(x)}-\frac{x}{2}\\
&=\frac{x}{e(x)-1}+\frac{x}{2}\\
&=f(x)
\end{aligned}</script><p>å¯çŸ¥ $f(x)$ æ˜¯å¶å‡½æ•°ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯ </p>
<script type="math/tex; mode=display">
1+\sum_{k=2}^{\infty}\frac{B_k}{k!}x^k</script><p>æ˜¯å¶å‡½æ•°ã€‚è€ƒè™‘ä»–æ˜¯å¶å‡½æ•°çš„æ¡ä»¶ï¼Œå½“ä¸”ä»…å½“æ‰€æœ‰å¥‡æ¬¡å¹‚ç³»æ•°éƒ½ä¸º $0$ çš„æ—¶å€™ï¼Œæ‰ä¼šæ˜¯å¶å‡½æ•°ã€‚æ‰€ä»¥å¯ä»¥è¯æ˜ä¸Šé¢çš„ç»“è®ºã€‚</p>
<h2 id="ä¼¯åŠªåˆ©å¤šé¡¹å¼"><a href="#ä¼¯åŠªåˆ©å¤šé¡¹å¼" class="headerlink" title="ä¼¯åŠªåˆ©å¤šé¡¹å¼"></a>ä¼¯åŠªåˆ©å¤šé¡¹å¼</h2><p>è€ƒè™‘è§‚å¯Ÿä¸‹åˆ—ä¸¤ä¸ªEGFçš„å·ç§¯ï¼š</p>
<script type="math/tex; mode=display">
\frac{x}{e(x)-1}*e(tx)</script><p>å…¶ä¸­ $t$ æ˜¯ä»»æ„å¸¸æ•°ã€‚è€ƒè™‘è®°å·ç§¯ç»“æœä¸º $\beta(t)$ ã€‚é‚£ä¹ˆæ˜¾ç„¶</p>
<script type="math/tex; mode=display">
\beta_n(t)=\sum_{k=0}^n\binom{n}{k}B_kt^{n-k}</script><p>è®°è¿™æ ·çš„å¤šé¡¹å¼ä¸ºä¼¯åŠªåˆ©å¤šé¡¹å¼ã€‚è¿™ä¸ªå¤šé¡¹å¼æœ‰ä¸ªå¾ˆæœ‰ç”¨çš„æ€§è´¨ï¼š</p>
<script type="math/tex; mode=display">
\beta_{n+1}(t + 1)-\beta_{n+1}(t)=t^n(n+1)\qquad(n=0,1,2,3\cdots)</script><p>è€ƒè™‘ç›´æ¥åšå·®æ³•è¯æ˜ã€‚é¦–å…ˆè®¾å‡ºä¸¤ä¸ªå¼å­ï¼š</p>
<script type="math/tex; mode=display">
\frac{xe(tx)}{e(x)-1}=\sum\frac{\beta_n(t)}{n!}x^n\qquad(1)\\
\frac{xe((t+1)x)}{e(x)-1}=\sum\frac{\beta_n(t+1)}{n!}x^n\qquad(2)\\</script><p>$(2)-(1)$ å¾—åˆ°</p>
<script type="math/tex; mode=display">
\frac{xe(tx)[e(x)-1]}{e(x)-1}=\sum\frac{\beta_n(t+1)-\beta_n(t)}{n!}x^n</script><p>å³</p>
<script type="math/tex; mode=display">
xe(tx)=\sum\frac{\beta_n(t+1)-\beta_n(t)}{n!}x^n</script><p>æ¯”è¾ƒç³»æ•°å¯çŸ¥</p>
<script type="math/tex; mode=display">
\frac{\beta_n(t+1)-\beta_n(t)}{n!}=\frac{t^{n-1}}{(n-1)!}</script><p>å˜ä¸€ä¸‹å½¢å°±å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\beta_{n+1}(t + 1)-\beta_{n+1}(t)=t^n(n+1)</script><h2 id="ç”¨ä¼¯åŠªåˆ©å¤šé¡¹å¼æ±‚è‡ªç„¶æ•°çš„-k-æ¬¡æ–¹å’Œ"><a href="#ç”¨ä¼¯åŠªåˆ©å¤šé¡¹å¼æ±‚è‡ªç„¶æ•°çš„-k-æ¬¡æ–¹å’Œ" class="headerlink" title="ç”¨ä¼¯åŠªåˆ©å¤šé¡¹å¼æ±‚è‡ªç„¶æ•°çš„ $k$ æ¬¡æ–¹å’Œ"></a>ç”¨ä¼¯åŠªåˆ©å¤šé¡¹å¼æ±‚è‡ªç„¶æ•°çš„ $k$ æ¬¡æ–¹å’Œ</h2><p>è€ƒè™‘å†³å®šè‡ªç„¶æ•° $k$ æ¬¡æ–¹çš„è¦ç´ åœ¨äºä¸‹æ ‡ $n$ ã€‚äºæ˜¯è€ƒè™‘æ‰€æœ‰è‡ªç„¶æ•°çš„ $k$ æ¬¡æ–¹å’Œå°±æ˜¯è¿™æ ·ï¼š</p>
<script type="math/tex; mode=display">
(k+1)\mathbf S^{(k)}=\sum_{i=1}^{\infty}\left(\beta_{k+1}(i+1)-\beta_{k+1}(i)\right)</script><p>å±•å¼€ä¹‹å</p>
<script type="math/tex; mode=display">
\mathbf S_n^{(k)}=\frac{\left(\beta_{k+1}(n+1)-\beta_{k+1}(1)\right)}{k+1}</script><p>ä¹Ÿå°±æ˜¯</p>
<script type="math/tex; mode=display">
\mathbf S_n^{(k)}=\frac{1}{k+1}\sum_{r=1}^{k+1}\binom{k+1}{r}B_{k+1-r}(n+1)^{r}</script><p>å…¶ä¸­ $r=0$ æ—¶å‡æ‰äº† $\beta_{k+1}(1)$ è¿™ä¸€é¡¹ã€‚</p>
<p>å‘ç°æœ¬è´¨ä¸Šå¯ä»¥ $k\log k$ ç”¨ $\exp$ æ¥é¢„å¤„ç†ä¼¯åŠªåˆ©æ•°ï¼Œç„¶åå°±å¯ä»¥ $O(k)$ ç®—ä¸é™åˆ¶ $n$ æ—¶çš„ $k$ æ¬¡æ–¹å’Œäº†ã€‚</p>
<p>emmmä¼¼ä¹é¢„å¤„ç†ä¹Ÿä¸ç”¨ $\rm exp$ ï¼Œ$e(x)-1$ ç›´æ¥å†™å‡ºæ¥ï¼Œç„¶åç›´æ¥å¤šé¡¹å¼æ±‚é€†å°±å¯ä»¥äº†ï¼Ÿ</p>
<p>ä½†æ˜¾ç„¶è¿™ä¸ªæ–¹æ³•è¢«çº¿æ€§æ’å€¼ç»™çˆ†é”¤äº†ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>ç”Ÿæˆå‡½æ•°</category>
      </categories>
      <tags>
        <tag>ç»„åˆè®¡æ•°/ç”Ÿæˆå‡½æ•°</tag>
        <tag>æ•°å­¦/ä¼¯åŠªåˆ©æ•°</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ¯å‡½æ•°Part2</title>
    <url>/2020/02/14/%E3%80%8A%E6%AF%8D%E5%87%BD%E6%95%B0%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¿™ä¸€éƒ¨åˆ†å¤§æ¦‚æ˜¯ä»ã€Œç‰¹å¾å¤šé¡¹å¼ã€æ•´ç†åˆ°ã€ŒæŒ‡æ•°å‹æ¯å‡½æ•°åŠå…¶åº”ç”¨ã€ã€‚</p>
<a id="more"></a>
<h1 id="ç‰¹å¾å¤šé¡¹å¼"><a href="#ç‰¹å¾å¤šé¡¹å¼" class="headerlink" title="ç‰¹å¾å¤šé¡¹å¼"></a>ç‰¹å¾å¤šé¡¹å¼</h1><h2 id="é½æ¬¡"><a href="#é½æ¬¡" class="headerlink" title="é½æ¬¡"></a>é½æ¬¡</h2><p>è€ƒè™‘å¯¹äºä¸€ä¸ªä»¥ $\{c_i\}$ ä¸ºé€’æ¨è½¬ç§»çš„ $k$ é˜¶çº¿æ€§å¾ªç¯æ•°åˆ— $\{a_i\}$ çš„æ¯å‡½æ•°ï¼Œæ ¹æ®æ„é€ ä¼¼ä¹å¯ä»¥è¢«å†™æˆè¿™æ ·çš„å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
\frac{b_0+b_1x+b_2x^2\cdots b_{m}x^{m}}{1-c_1x-c_2x^2-c_3x^3\cdots -c_kx^k}</script><p>$\{b_i\},m$ éƒ½æ˜¯æ ¹æ®å®é™…æƒ…å†µä¼šå˜çš„å‚æ•°ã€‚</p>
<p>é‚£ä¹ˆå¯ä»¥å‘ç°è¿™æ ·çš„æ’ç­‰çš„å…³ç³»ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{b_0+b_1x+b_2x^2\cdots b_{m}x^{m}}{1-c_1x-c_2x^2-c_3x^3\cdots -
c_kx^k}&=a_0+a_1x+a_2x^2\cdots +a_nx^n+\cdots\\
b_0+b_1x+b_2x^2\cdots b_{m}x^{m}&=(a_0+a_1x+a_2x^2\cdots +a_nx^n+\cdots)\times(1-c_1x-c_2x^2-c_3x^3\cdots -
c_kx^k)\\
\end{aligned}</script><p>å³</p>
<script type="math/tex; mode=display">
\begin{aligned}
&b_0=a_0,\\
&b_1=a_1-c_1a_0,\\
&b_2=a_2-c_1a_1-c_2a_0\\
&\cdots,\\
&b_{k-1}=a_{k-1}-\sum_{i=1}^{k-1}c_ia_{k-1-i},\\
&\cdots,\\ 
&b_p=a_p-\sum_{i=1}^{k}c_i=0\quad \mathrm{if}~(p\geq k) 
\end{aligned}":</script><p>å¯ä»¥å‘ç°åˆ†å­ä¸Šçš„å¤šé¡¹å¼è‡³å¤šæœ‰ $k-1$ æ¬¡.</p>
<p>åƒè¿™ç§æ ¹æ®é€’æ¨æ–¹å¼å¿«é€Ÿç¡®å®šçš„ä¸€ä¸ªçº¿æ€§å¾ªç¯æ•°åˆ—æ¯å‡½æ•°çš„æ–¹æ³•ï¼Œç§°ä¸ºç‰¹å¾æ³•ã€‚è€Œå¤šé¡¹å¼</p>
<script type="math/tex; mode=display">
1-c_1x-c_2x^2-\cdots c_kx^k</script><p>åˆ™ç§°ä¸º $\{a_i\}$ çš„ç‰¹å¾å¤šé¡¹å¼ã€‚</p>
<p>e.g.</p>
<blockquote>
<p>æ±‚</p>
<script type="math/tex; mode=display">
a_n=a_{n-1}+9a_{n-2}-9a_{n-3},a_0=1,a_1=1,a_2=2</script><p>çš„é€šé¡¹ã€‚</p>
</blockquote>
<hr>
<p>é¦–å…ˆåˆ†è§£å› å¼</p>
<script type="math/tex; mode=display">
(1-x-9x^2-9x^3)=(1-3x)(1+3x)(1-x)</script><p>å¹¶ä¸”è§‚å¯Ÿåˆ° $b_0=1,b_1=0,b_2=-8$ã€‚</p>
<p>é‚£ä¹ˆä¸å¦¨è®¾</p>
<script type="math/tex; mode=display">
\frac{a}{1-3x}+\frac{b}{1+3x}+\frac{c}{1-x}=\frac{1-8x^2}{1-x-9x^2-9x^3}</script><p>è§£å¾—</p>
<script type="math/tex; mode=display">
a=\frac{1}{12},b=\frac{1}{24},c=\frac{7}{8}</script><p>é‚£ä¹ˆå°±å¯ä»¥çŸ¥é“ $\frac{1-8x^2}{1-x-9x^2-9x^3}$ çš„å±•å¼€æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\sum_{n=1}^{\infty}(\frac{1}{12}\cdot 3^n+\frac{1}{24}(-1)^n3^n+\frac{7}{8})x^n</script><p>é‚£ä¹ˆé€šé¡¹å°±æ˜¯</p>
<script type="math/tex; mode=display">
a_n=\frac{1}{12}\cdot 3^n+\frac{1}{24}(-1)^n3^n+\frac{7}{8}</script><h2 id="éé½æ¬¡"><a href="#éé½æ¬¡" class="headerlink" title="éé½æ¬¡"></a>éé½æ¬¡</h2><p>éé½æ¬¡çš„è¯ï¼Œå¯ä»¥ç›´æ¥æŠŠå¸¸æ•°æ„é€ åœ¨ç³»æ•°é‡Œï¼Œæœ¬è´¨ä¸Šæ²¡ä»€ä¹ˆä¸åŒçš„ã€‚</p>
<h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><blockquote>
<p>ï¼ˆ1ï¼‰ç”¨ $1,2,3$ ä¸‰ä¸ªæ•°æ¥æ„é€ ä¸€ä¸ª $n$ ä½æ•°ã€‚ä¸å…è®¸ä¸¤ä¸ª $1$ ç›¸é‚»ï¼Œæ±‚æ–¹æ¡ˆæ•°ã€‚</p>
</blockquote>
<p>å‘ç°å¦‚æœç¬¬ä¸€ä½æ”¾ $2$ æˆ– $3$ ï¼Œé‚£ä¹ˆæœ‰ $2\cdot a_{n-1}$ çš„æ–¹æ¡ˆï¼›å¦‚æœæ”¾ $1$ï¼Œé‚£ä¹ˆç¬¬äºŒç»´åªèƒ½æ”¾ $2$ æˆ– $3$ ï¼Œé‚£ä¹ˆæœ‰ $2\cdot a_{n-2}$ çš„æ–¹æ¡ˆã€‚æ‰€ä»¥æœ‰ $a_n=2a_{n-1}+2a_{n-2}$ ã€‚</p>
<blockquote>
<p>ï¼ˆ2ï¼‰æœ‰ä¸€è¡Œæ–¹æ ¼ï¼Œæ¯ä¸ªæ ¼å­å¯ä»¥æ”¾é»‘è‰²æˆ–è€…ç™½è‰²ï¼Œç™½è‰²ä¸èƒ½ç›¸é‚»åœ°æ”¾ã€‚æ±‚æ–¹æ¡ˆæ ‘ã€‚</p>
</blockquote>
<p>å‘ç°è¿˜æ˜¯è®¨è®ºç¬¬ä¸€ä¸ªä½ç½®æ”¾çš„æ˜¯ä¸æ˜¯ç™½è‰²ã€‚$f_n=f_{n-1}+f_{n-2}$ ã€‚</p>
<h1 id="é«˜é˜¶å·®åˆ†"><a href="#é«˜é˜¶å·®åˆ†" class="headerlink" title="é«˜é˜¶å·®åˆ†"></a>é«˜é˜¶å·®åˆ†</h1><h2 id="ä¸€ç‚¹å®šä¹‰"><a href="#ä¸€ç‚¹å®šä¹‰" class="headerlink" title="ä¸€ç‚¹å®šä¹‰"></a>ä¸€ç‚¹å®šä¹‰</h2><p>å®šä¹‰ $\{a_i\}$ çš„ä¸€é˜¶å·®åˆ† $\Delta^1\{a_i\}$ æ˜¯è¿™æ ·çš„æ•°åˆ— $\{a_1-a_0,a_2-a_1,\cdots,a_n-a_{n-1}\}$ ã€‚</p>
<p>é‚£ä¹ˆ $k$ é˜¶å·®åˆ†æŒ‡çš„æ˜¯ $\Delta^k\{a_i\}=\Delta\{\Delta^{k-1}\{a_i\}\}$ ã€‚</p>
<p>å‡è®¾ä¸€ä¸ªæ•°åˆ— $\{a_i\}$ åœ¨ $k$ é˜¶å·®åˆ†æ—¶ä¸æ˜¯å…¨ $0$ æ•°åˆ—ï¼Œåœ¨ $k+1$ é˜¶å·®åˆ†æ—¶æ˜¯å…¨ $0$ æ•°åˆ—ï¼Œé‚£ä¹ˆç§°è¿™ä¸ªæ•°åˆ—ä¸º $k$ é˜¶ç­‰å·®æ•°åˆ—ã€‚</p>
<h2 id="ä¸€ä¸ªå®šç†"><a href="#ä¸€ä¸ªå®šç†" class="headerlink" title="ä¸€ä¸ªå®šç†"></a>ä¸€ä¸ªå®šç†</h2><blockquote>
<p> å¦‚æœè®° $\Delta^k\{a_i\}:\{a_0^{(k)},a_1^{(k)},a_2^{(k)},\cdots,a_n^{(k)}\cdots \}$ï¼Œé‚£ä¹ˆæœ‰ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
a_n^{(k)}&=a_{n+k}-\binom{k}{1}a_{n+k-1}+\binom{k}{2}a_{n+k-2}-\cdots+(-1)^ka^n\\
&=\sum_{i=0}^k(-1)^i\binom{k}{i}a_{n+k-i}
\end{aligned}</script></blockquote>
<p>è¿™ä¸ªæ˜¾ç„¶å¯ä»¥ç›´æ¥å½’çº³ã€‚å°±æ‡’å¾—è¯äº†ã€‚</p>
<h2 id="k-é˜¶ç­‰å·®æ•°åˆ—-a-n-çš„å‰-n-é¡¹å’Œã€‚"><a href="#k-é˜¶ç­‰å·®æ•°åˆ—-a-n-çš„å‰-n-é¡¹å’Œã€‚" class="headerlink" title="$k$ é˜¶ç­‰å·®æ•°åˆ— $\{a_n\}$ çš„å‰ $n$ é¡¹å’Œã€‚"></a>$k$ é˜¶ç­‰å·®æ•°åˆ— $\{a_n\}$ çš„å‰ $n$ é¡¹å’Œã€‚</h2><p>è€ƒè™‘å¯¹äºæ•°åˆ— $\{s_n\}$ ï¼Œæ»¡è¶³ $s_i=\sum_{j=0}^ia_i$ï¼Œé‚£ä¹ˆå‘ç°å¯ä»¥ç›´æ¥è®© $\{a_n\}*(\frac{1}{1-x})$ å¾—åˆ° $\{s_n\}$</p>
<script type="math/tex; mode=display">
\left(\sum a_nx^n\right)*\left(\sum x^n\right)=\sum_{n=0}^{\infty}\left(\sum_{j=0}^n a_j\right)x=\sum s_nx^n</script><p>æ‰€ä»¥å‡è®¾ $\{a_n\}$ çš„æ¯å‡½æ•°æ˜¯ $f(x)$ï¼Œé‚£ä¹ˆ $\{s_n\}$ çš„æ¯å‡½æ•°å°±æ˜¯ $\frac{f(x)}{1-x}$ã€‚</p>
<p>é‚£ä¹ˆè€ƒè™‘å¦‚ä½•è®¡ç®— $f(x)$ ã€‚æ ¹æ®æ€§è´¨å¯çŸ¥ï¼š</p>
<script type="math/tex; mode=display">
a_n^{(k+1)}=a_{n+k+1}-\binom{k+1}{1}a_{n+k}+\binom{k+1}{2}a_{n+k-1}-\cdots+(-1)^{k+1}a^n</script><p>é‚£ä¹ˆç”±äº $a_{n}^{(k+1)}=0$ ï¼Œæ‰€ä»¥å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
a_{n+k+1}=\binom{k+1}{1}a_{n+k}-\binom{k+1}{2}a_{n+k-1}+\cdots-(-1)^{k+1}a^n</script><p>å‘ç°æœ¬è´¨ä¸Š $\binom{k+1}{x}$ å±äºå¸¸æ•°é¡¹ã€‚æ‰€ä»¥å¯ä»¥çŸ¥é“ $\{a_n\}$ æ˜¯ä¸€ä¸ª $k+1$ ä¸ªçº¿æ€§å¾ªç¯æ•°åˆ—ã€‚æ‰€ä»¥å¯ä»¥ç”¨ç‰¹å¾æ³•ç›´æ¥æ±‚å‡ºã€‚</p>
<p>ä½†å…¶å®è¿™ç§æ–¹æ³•æœ‰æ—¶å€™æ¯”å½’çº³è¦éº»çƒ¦å¾ˆå¤šã€‚è¿™ç§æ–¹æ³•ä¸»è¦ç”¨æ¥è§£å†³ä¸€äº›æ¯”è¾ƒå¦™çš„é—®é¢˜ã€‚</p>
<h2 id="ä¸€ç‚¹åº”ç”¨"><a href="#ä¸€ç‚¹åº”ç”¨" class="headerlink" title="ä¸€ç‚¹åº”ç”¨"></a>ä¸€ç‚¹åº”ç”¨</h2><p>e.g.</p>
<blockquote>
<p> ç»™å®š $n$ ï¼Œæ±‚åæ ‡ç³»ä¸­ $|x|+|y|=m,(m=0,1,2,3\cdots n)$ çš„ $(x,y)$ ç‚¹å¯¹æ•°ã€‚</p>
</blockquote>
<p>è€ƒè™‘è®¾ $\{a_i\}$ è¡¨ç¤º $i=m$ æ—¶çš„æ–¹æ¡ˆæ•°ï¼Œ$\{s_i\}$ å³ä¸ºæ‰€æ±‚ã€‚é‚£ä¹ˆå¯ä»¥çŸ¥é“ $a_i$ çš„æ¯å‡½æ•°ä¸ºï¼š</p>
<script type="math/tex; mode=display">
f(x)=(1+2x+2x^2+2x^3+\cdots +2x^n+\cdots)^2</script><p>çœ‹ä¸Šå»ååˆ† $easy$ï¼Œå› ä¸ºæ¯ä¸ªåæ ‡æœ‰$+-$ ä¸¤ç§å–å€¼ï¼Œæ‰€ä»¥åŠ ä¸€ä¸ªç³»æ•° $2$ ã€‚</p>
<p>é‚£ä¹ˆå‘ç°å¯ä»¥è¿™ä¹ˆè½¬åŒ–ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(x)&=(1+2x+2x^2+2x^3+\cdots +2x^n+\cdots)^2\\
&=(1+2x(1+x+x^2+\cdots+x^n+\cdots))^2\\
&=(1+\frac{2x}{1-x})^2\\
&=(\frac{1+x}{1-x})^2
\end{aligned}</script><p>æ‰€ä»¥ $\{s_n\}$ çš„æ¯å‡½æ•° $f_s(x)$ ä¸º</p>
<script type="math/tex; mode=display">
f_s(x)=\frac{f(x)}{1-x}=\frac{(x+1)^2}{(1-x)^3}</script><p>å‘ç° $(1-x)$ æ˜¯å®ƒçš„ $3$ é‡æ ¹ï¼Œæ‰€ä»¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
f_s(x)=\frac{4}{(1-x)^3}-\frac{4}{(1-x)^2}+\frac{1}{1-x}</script><p>é‚£ä¹ˆå¯ä»¥å±•å¼€å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
f_s(x)=\sum_{i=0}^{\infty}\left[4\binom{n+2}{2}-4(n+1)+1\right]x^n</script><p>äºæ˜¯å¯çŸ¥ $s_n=2n^2+2n+1$ ã€‚</p>
<h1 id="å¡ç‰¹å…°æ•°"><a href="#å¡ç‰¹å…°æ•°" class="headerlink" title="å¡ç‰¹å…°æ•°"></a>å¡ç‰¹å…°æ•°</h1><p>é¦–å…ˆå‘ç°å¡ç‰¹å…°æ•°çš„å®šä¹‰å¼å°±æ˜¯</p>
<script type="math/tex; mode=display">
a_n=\sum_{k=1}^{n}a_{n-k}a_{k}</script><p>é‚£ä¹ˆè¿™ä¸œè¥¿çš„æ¯å‡½æ•°å¤§æ¦‚å¯ä»¥è¿™ä¹ˆæ±‚ï¼ˆé»˜è®¤ç¬¬ $0$ ä¸ºä½æ˜¯ $0$ è€Œä¸è€ƒè™‘ï¼‰ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
f^2(x)&=\left(\sum a_ix^i\right)^2\\
&= a_1^2x^2+(a_1a_2+a_2a_1)x^3+(a_1a_3+a_2a_2+a_3a_1)x^4\cdots+\left(\sum_{i=1}^{n}a_{i}a_{n-i}\right) x^n+\cdots\\
&=f(x)-a_1x

\end{aligned}</script><p>é‚£ä¹ˆè§£ä¸€ä¸‹æ–¹ç¨‹å¯ä»¥å¾—åˆ°ä¿©æ ¹ï¼š</p>
<script type="math/tex; mode=display">
f_1(x)=\frac{1-\sqrt{1-4x}}{2},f_2(x)=\frac{1+\sqrt{1-4x}}{2}</script><p>éªŒä¸€ä¸‹å‘ç°åº”è¯¥å– $f_1$.</p>
<p>åœ¨ä¸è€ƒè™‘ç‰›é¡¿è¿­ä»£çš„æƒ…å†µä¸‹ï¼Œä¸åŠ è¯æ˜åœ°ç»™å‡ºä¸€ä¸ªç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">
\sqrt{1+x}=1+\sum_{n=1}^{\infty} \frac{(-1)^{n-1}}{n 2^{2 n-1}} \binom{2(n-1)}{n-1} x^{n}</script><p>é‚£ä¹ˆä»£æ¢ä¸€ä¸‹å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sqrt{1-4 x} &=1+\sum_{n=1}^{\infty} \frac{(-1)^{n-1}}{n 2^{2 n-1}} \binom{2(n-1)}{n-1}(-4 x)^{n} \\
&=1+\sum_{n=1}^{\infty} \frac{(-1)^{2 n-1}}{n 2^{2 n-1}} 4^{n} \binom{2(n-1)}{n-1} x^{n} \\
&=1-\sum_{n=1}^{\infty} \frac{2}{n} \binom{2(n-1)}{n-1} x^{n}
\end{aligned}</script><p>å†å¸¦å›å»å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
f(x)=\sum_{n=1}^{\infty}\frac{\binom{2(n-1)}{n-1}}{n} x^n</script><p>é‚£ä¹ˆå¯çŸ¥å¡ç‰¹å…°æ•°ç¬¬ $n$ é¡¹ $\mathrm{Cat}_n=\frac{\binom{2(n-1)}{n-1}}{n}$ã€‚</p>
<p>å½“ç„¶ä¸€èˆ¬æƒ…å†µä¸‹ $\rm Cat$ çš„å®šä¹‰æœ‰ä» $0$ å¼€å§‹çš„ï¼Œåªæ˜¯æŠŠè¿™ç§æ–¹å¼å‘å‰å¹³ç§»äº†ä¸€é¡¹è€Œå·²ã€‚</p>
<h1 id="æŒ‡æ•°å‹æ¯å‡½æ•°"><a href="#æŒ‡æ•°å‹æ¯å‡½æ•°" class="headerlink" title="æŒ‡æ•°å‹æ¯å‡½æ•°"></a>æŒ‡æ•°å‹æ¯å‡½æ•°</h1><h2 id="åŸºç¡€å®šä¹‰"><a href="#åŸºç¡€å®šä¹‰" class="headerlink" title="åŸºç¡€å®šä¹‰"></a>åŸºç¡€å®šä¹‰</h2><p>å‡ºäºéœ€è¦ï¼Œå®šä¹‰å¦ä¸€ç§ç”Ÿæˆå‡½æ•°ï¼Œå³æŒ‡æ•°å‹æ¯å‡½æ•° $(\mathbf{EGF})$ ã€‚å¯¹äºæ•°åˆ— $\{a\}$ï¼Œä»–çš„ $\rm EGF$  æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\sum_{n=0}^{\infty}\frac{a_n}{n!}x^n</script><p>é‚£ä¹ˆå¯ä»¥å¾—å‡ºä¸¤ä¸ª $\rm EGF$ å·ç§¯çš„ç»“æœæ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{n=0}^{\infty}\frac{a_n}{n!}x^n
&= \left(\sum_{n=0}^{\infty}\frac{a_n}{n!}x^n\right)\cdot \left(\sum_{n=0}^{\infty}\frac{b_n}{n!}x^n\right)\\
&= \sum_{n=0}^{\infty} x^n\sum_{i+j=n}\frac{a_ib_j}{i!j!}\\
&= \sum_{n=0}^{\infty} \frac{1}{n!}x^n\sum_{i+j=n}\left(a_ib_j\cdot\frac{n!}{i!j!}\right)\\
\end{aligned}</script><p>å¯ä»¥å‘ç°æœ‰</p>
<script type="math/tex; mode=display">
c_n=\sum_{k=0}^n\binom{n}{k}a_kb_{n-k}</script><p>é‚£ä¹ˆä¹‹æ‰€ç§°ä¹‹ä¸ºæŒ‡æ•°å‹æ¯å‡½æ•°ï¼Œåˆ™ä¾èµ–äºä¸‹é¢çš„æ€§è´¨ï¼š</p>
<p>ä»¤</p>
<script type="math/tex; mode=display">
e(x)=1+x+\frac{x^2}{2!}+\cdots +\frac{x^n}{n!}+\cdots</script><p>å¯ä»¥å‘ç°æœ‰</p>
<script type="math/tex; mode=display">
e(x)e(y)=e(x+y)</script><p>è¯æ˜å¤§æ¦‚æ˜¯å¯ä»¥æŠŠ $e(y)$ æ”¹å†™æˆ</p>
<script type="math/tex; mode=display">
e(y)=\sum \frac{1}{n!}(\frac{y}{x})^nx^n</script><p>ç„¶å</p>
<script type="math/tex; mode=display">
\begin{aligned}
e(x)e(y)&=\left(\sum \frac{1}{n!}x^n\right)\cdot \left[\sum \frac{1}{n!}(\frac{y}{x})^nx^n\right]\\
&=\sum \frac{\sum_{k=0}^n\binom{n}{k}\cdot (\frac{y}{x})^k}{n!}x^n\\
&=\sum \frac{(1+\frac{y}{x})^n}{n!}x^n\\
&=\sum \frac{\frac{1}{x^n}(x+y)^n}{n!}x^n\\
&=\sum \frac{(x+y)^n}{n!}\\
&= e(x+y)
\end{aligned}</script><p>å‘ç°è¿™ç§æ€§è´¨ç±»ä¼¼äºæŒ‡æ•°è¿ç®—çš„æ€§è´¨ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºæŒ‡æ•°å‹æ¯å‡½æ•°ã€‚</p>
<p>åŒæ—¶å¯çŸ¥ï¼Œä»¤ $y=-x$ åˆ™æœ‰ $e(x)=\frac{1}{e(-x)}$ ã€‚</p>
<h2 id="äºŒé¡¹å¼åæ¼”"><a href="#äºŒé¡¹å¼åæ¼”" class="headerlink" title="äºŒé¡¹å¼åæ¼”"></a>äºŒé¡¹å¼åæ¼”</h2><blockquote>
<p>è®¾ $\{a_n\}$ ç»™å®šï¼Œä¸”</p>
<script type="math/tex; mode=display">
b_n=\sum_{i=0}^n\binom{n}{i}(-1)^ia_i</script><p>åˆ™å¿…æœ‰</p>
<script type="math/tex; mode=display">
a_n=\sum_{i=0}^n\binom{n}{i}(-1)^ib_i</script></blockquote>
<p>è€ƒè™‘è®©æ•°åˆ— $\{(-1)^na_n\}$ çš„æ¯å‡½æ•°å·ä¸Š $e(x)$ å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
e(x)*\sum\frac{(-1)^na_n}{n!}x^n=\sum\frac{\sum_{k=0}^n\binom{n}{k}(-1)^ka_k}{n!}x^n=\sum\frac{b_n}{n!}x^n</script><p>ä¹Ÿå°±æ˜¯</p>
<script type="math/tex; mode=display">
\sum\frac{(-1)^na_n}{n!}x^n=\frac{1}{e(x)}*\sum\frac{b_n}{n!}x^n</script><p>å› ä¸º $\frac{1}{e(x)}=e(-x)$ ï¼Œæ‰€ä»¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\sum\frac{(-1)^na_n}{n!}x^n=\sum(-1)^n\frac{\sum_{k=0}^n\binom{n}{k}(-1)^kb_k}{n!}x^n</script><p>å¯¹æ¯”ç¬¬ $n$ é¡¹å³å¯å¾—åˆ°</p>
<script type="math/tex; mode=display">
a_n=\sum_{k=0}^n\binom{n}{k}(-1)^kb_k</script><h2 id="ä¸€ä¸ªä¾‹å­"><a href="#ä¸€ä¸ªä¾‹å­" class="headerlink" title="ä¸€ä¸ªä¾‹å­"></a>ä¸€ä¸ªä¾‹å­</h2><script type="math/tex; mode=display">
\sum_{k=1}^n(-1)^k\binom{n}{k}\left(1+\frac{1}{2}+\frac{1}{3}+\cdots+\frac{1}{k}\right)=-\frac{1}{n}</script><p>é¦–å…ˆæœ‰ä¸€ä¸ªæ¯”è¾ƒ <code>general</code> çš„ç»“è®ºï¼š</p>
<script type="math/tex; mode=display">
\sum_{k=0}^n\frac{(-1)^k}{k+1}\binom{n}{k}=\frac{1}{n+1}\qquad(1)</script><p>è¿™æ˜¯ç”±äº</p>
<script type="math/tex; mode=display">
\binom{n+1}{k+1}=\frac{n+1}{k+1}\binom{n}{k}</script><p>é‚£ä¹ˆç¨å¾®å˜ä¸€ä¸‹å½¢æ€ï¼š</p>
<script type="math/tex; mode=display">
\sum_{k=0}^n(-1)^k\frac{n+1}{k+1}\binom{n}{k}=\sum_{k=1}^{n+1}(-1)^k\binom{n+1}{k}=1+(1-1)^n=1</script><p>ç§»ä¸ªé¡¹å°±å®Œäº†ã€‚</p>
<p>é‚£ä¹ˆæ ¹æ®è¿™ä¸ªå¯ä»¥å†è¯æ˜å‡ºä¸€ä¸ªæ›´å¼ºä¸€ç‚¹çš„ç»“è®ºï¼š</p>
<script type="math/tex; mode=display">
\sum_{k=1}^n\frac{(-1)^{k-1}}{k}\binom{n}{k}=1+\frac{1}{2}+\frac{1}{3}+\cdots+\frac{1}{n}\qquad (2)</script><p>è€ƒè™‘ç›´æ¥å½’çº³ã€‚ä¸éš¾éªŒè¯ $n=1$ æˆç«‹ã€‚é‚£ä¹ˆè€ƒè™‘ $n\to n+1$ çš„è¿‡ç¨‹</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum_{k=1}^{n+1}\frac{(-1)^{k-1}}{k}\binom{n+1}{k}
\\=&\sum_{k=1}^{n+1}\frac{(-1)^{k-1}}{k}\left(\binom{n}{k}+\binom{n}{k-1}\right)
\\=&\sum_{k=1}^{n}\frac{(-1)^{k-1}}{k}\binom{n}{k}+\sum_{k=0}^{n}\frac{(-1)^{k+1}}{k}\binom{n}{k}
\\=&\left(1+\frac{1}{2}+\frac{1}{3}+\cdots+\frac{1}{n}\right)+\frac{1}{n+1}
\end{aligned}</script><p>å…¶ä¸­æœ€åä¸€æ­¥ç”¨çš„å°±æ˜¯ä¸Šé¢çš„ $(1)$ã€‚</p>
<p>é‚£ä¹ˆå›åˆ°æœ¬é¢˜ï¼Œè€ƒè™‘è®¾ $a_0=0, a_n=-\frac{1}{n}\quad (n=1,2,3\cdots )$ ã€‚åŒæ—¶è®¾ $b_0=0$ï¼Œ</p>
<script type="math/tex; mode=display">
b_n=\sum_{i=0}^n\binom{n}{i}(-1)^ia_i=\sum_{i=0}^n\frac{(-1)^{i+1}}{i}\binom{n}{i}</script><p>é‚£ä¹ˆæ ¹æ® $(2)$ å’ŒäºŒé¡¹å¼åæ¼”å¯ä»¥å¾—åˆ°</p>
<script type="math/tex; mode=display">
b_n=\left(1+\frac{1}{2}+\frac{1}{3}+\cdots+\frac{1}{n}\right)\\
\sum_{k=1}^n(-1)^k\binom{n}{k}\left(1+\frac{1}{2}+\frac{1}{3}+\cdots+\frac{1}{k}\right)=\sum_{k=1}^n(-1)^kb_k=a_n=-\frac{1}{n}</script><h1 id="æŒ‡æ•°å‹æ¯å‡½æ•°çš„åº”ç”¨"><a href="#æŒ‡æ•°å‹æ¯å‡½æ•°çš„åº”ç”¨" class="headerlink" title="æŒ‡æ•°å‹æ¯å‡½æ•°çš„åº”ç”¨"></a>æŒ‡æ•°å‹æ¯å‡½æ•°çš„åº”ç”¨</h1><h2 id="æœ‰é™åˆ¶çš„å¯é‡æ’åˆ—é—®é¢˜"><a href="#æœ‰é™åˆ¶çš„å¯é‡æ’åˆ—é—®é¢˜" class="headerlink" title="æœ‰é™åˆ¶çš„å¯é‡æ’åˆ—é—®é¢˜"></a>æœ‰é™åˆ¶çš„å¯é‡æ’åˆ—é—®é¢˜</h2><blockquote>
<p>ç»™å®š $n$ ä¸ªç‰©å“ï¼Œä»ä¸­å– $r$ ä¸ªè¿›è¡Œæ’åˆ—ï¼Œç¬¬ $k~(k=1,2,3\cdots m)$ ç§ç‰©å“æœ‰ $n_k$ ä¸ªï¼Œæ±‚æ’åˆ—æ–¹æ¡ˆæ•°ã€‚</p>
</blockquote>
<p>é¦–å…ˆç»™å‡ºè¿™ä¸œè¥¿çš„æ¯å‡½æ•°ï¼š</p>
<script type="math/tex; mode=display">
f_e(x)=\left(1+x+\frac{x^2}{2!}+\cdots+\frac{x^{n_1}}{n_1!}\right)*\left(1+x+\frac{x^2}{2!}+\cdots+\frac{x^{n_2}}{n_2!}\right)*\cdots*\left(1+x+\frac{x^2}{2!}+\cdots+\frac{x^{n_m}}{n_m!}\right)</script><p>è€ƒè™‘è¿™æ ·è¡¨ç¤ºçš„æ„ä¹‰ã€‚å¯¹äº $f_e(x)$ çš„ç¬¬ $r+1$ é¡¹ï¼Œæœ‰ï¼š</p>
<script type="math/tex; mode=display">
[x^r]f_e(x)=\frac{x^{d_1}}{d_1!}\cdot\frac{x^{d_2}}{d_2!}\cdot\frac{x^{d_3}}{d_3}\cdots\frac{x^{d_m}}{d_m!}</script><p>å…¶ä¸­ $\{d_m\}$ å¯ä»¥çœ‹åšæ˜¯æ»¡è¶³ $d_1+d_2+\cdots+d_m=r$ çš„ä¸€ç»„æšä¸¾é‡ã€‚</p>
<p>è€ƒè™‘è¿™æ ·åšçš„å¯è¡Œæ€§ã€‚é¦–å…ˆå˜ä¸€ä¸‹å½¢</p>
<script type="math/tex; mode=display">
\begin{aligned}
&[x^r]f_e(x)\\
&=\frac{x^{d_1}}{d_1!}\cdot\frac{x^{d_2}}{d_2!}\cdot\frac{x^{d_3}}{d_3}\cdots\frac{x^{d_m}}{d_m!}\\
&=\frac{r!}{\prod d_i!}\cdot\frac{x^r}{r!}
\end{aligned}</script><p>å‘ç°ç¬¬ $r+1$ é¡¹çš„ç³»æ•° $\frac{r!}{\prod d_i!}$ï¼Œæ­£å¥½æ˜¯ä» $r$ ä¸ªç‰©å“ä¸­ï¼Œå…± $m$ ä¸­ï¼Œæ¯ç§åˆ†åˆ«æœ‰ $d_i$ ä¸ªï¼Œå–æ»¡ $r$ ä¸ªçš„æ–¹æ¡ˆæ•°ã€‚æ‰€ä»¥æ­£ç¡®æ€§æ˜¾ç„¶ã€‚</p>
<h2 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h2><blockquote>
<p>ç”¨ $1,2,3,4$ å››ä¸ªæ•°å­—èƒ½ç»„æˆå¤šå°‘äº”ä½æ•°ï¼Ÿè¦æ±‚ $1$ åªèƒ½å‡ºç° $2$ æˆ– $3$ æ¬¡ï¼Œ$2$ å‡ºç° $0$ æˆ– $1$ æ¬¡ï¼Œ$3$ æ²¡æœ‰é™åˆ¶ï¼Œ $4$ å‡ºç°å¶æ•°æ¬¡ã€‚</p>
</blockquote>
<p>è¿™ä¸ªé—®é¢˜çš„æ¯å‡½æ•°æ˜¾ç„¶å°±æ˜¯è¿™ä¸ªï¼š</p>
<script type="math/tex; mode=display">
f_e(x)=\left(\frac{x^2}{2!}+\frac{x^3}{3!}\right)\cdot \left(1+x\right)\cdot e(x)\cdot \left[1+\frac{x^2}{2!}+\frac{x^4}{4!}+\cdots+\frac{x^{2n}}{(2n)!}+\cdots\right]</script><p>è€ƒè™‘ä¸€ä¸ªæ€§è´¨</p>
<script type="math/tex; mode=display">
1+\frac{x^2}{2!}+\frac{x^4}{4!}+\cdots+\frac{x^{2n}}{(2n)!}+\cdots=\frac{e(x)+\frac{1}{e(x)}}{2}</script><p>é‚£ä¹ˆåŸå¼å°±å˜æˆäº†</p>
<script type="math/tex; mode=display">
\begin{aligned}f_e(x)&=\left(\frac{x^2}{2!}+\frac{x^3}{3!}\right)\cdot\left(1+x\right)\cdot e(x)\cdot \frac{1}{2}\left(e(x)+\frac{1}{e(x)}\right)\\&=\frac{e(2x)}{2}\left(\frac{x^2}{2!}+\frac{x^3}{3!}\right)\cdot\left(1+x\right)+\frac{1}{2}\left(\frac{x^2}{2!}+\frac{x^3}{3!}\right)\cdot\left(1+x\right)\end{aligned}</script><p>å‘ç°æœ¬è´¨ä¸Šå³è¾¹ä¸å­˜åœ¨ $x^5$ è¿™ä¸€é¡¹ï¼Œæ‰€ä»¥å¿½ç•¥ã€‚</p>
<p>äºæ˜¯æœ€åé€šè¿‡åŒ–ç®€å¯çŸ¥ç­”æ¡ˆæ˜¯ $140$ .</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>ç”Ÿæˆå‡½æ•°</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨</tag>
        <tag>ç»„åˆè®¡æ•°/ç”Ÿæˆå‡½æ•°</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ¯å‡½æ•°Part1</title>
    <url>/2020/02/13/%E3%80%8A%E6%AF%8D%E5%87%BD%E6%95%B0%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚æ˜¯å¥½ä¹…ä¹‹å‰çš„å­¦ä¹ ç¬”è®°ï¼Ÿ</p>
<p>è¾¹å¤ä¹ è¾¹å‘å§ã€‚å…¶å®MOå†ä¸åšé¢˜çš„æ—¶å€™ï¼Œæ‹¿æ¥ç£¨ç£¨è„‘å­ä¹ŸæŒºæœ‰æ„æ€çš„ã€‚</p>
<p>è¿™ä¸€éƒ¨åˆ†å¤§æ¦‚æ˜¯ä»ã€ŒåŸºç¡€ç»„åˆè®¡æ•°ã€åˆ°ã€Œä¸€èˆ¬å‹æ¯å‡½æ•°ã€ï¼Œå†åˆ°ã€Œçº¿æ€§å¾ªç¯æ•°åˆ—ã€ã€‚</p>
<a id="more"></a>
<h1 id="äºŒé¡¹å¼å®šç†"><a href="#äºŒé¡¹å¼å®šç†" class="headerlink" title="äºŒé¡¹å¼å®šç†"></a>äºŒé¡¹å¼å®šç†</h1><h2 id="ä¸€ç‚¹çæ‰¯"><a href="#ä¸€ç‚¹çæ‰¯" class="headerlink" title="ä¸€ç‚¹çæ‰¯"></a>ä¸€ç‚¹çæ‰¯</h2><p>è€ƒè™‘äºŒé¡¹å¼å®šç† $(x+y)^n=\sum\binom{n}{i}x^iy^{n-i}$ï¼Œç”±äºå±•å¼€æˆäº†äºŒå…ƒå¤šé¡¹å¼çš„å½¢å¼ï¼Œæ‰€ä»¥å­˜åœ¨å·ç§¯æ€§è´¨ã€‚åˆ©ç”¨æ­¤æˆ–å¯è¯æ˜ä¸€äº›ä¸œè¥¿ã€‚</p>
<h2 id="ä¸€ç‚¹æœ‰è¶£çš„è¯æ˜é¢˜"><a href="#ä¸€ç‚¹æœ‰è¶£çš„è¯æ˜é¢˜" class="headerlink" title="ä¸€ç‚¹æœ‰è¶£çš„è¯æ˜é¢˜"></a>ä¸€ç‚¹æœ‰è¶£çš„è¯æ˜é¢˜</h2><h3 id="A"><a href="#A" class="headerlink" title="A"></a>A</h3><blockquote>
<p>è¯æ˜ï¼š</p>
<script type="math/tex; mode=display">
\sum_{x=1}^n x\cdot\binom{n}{x}=n\cdot 2^{n-1}</script></blockquote>
<p>è€ƒè™‘ä¸€ä¸ªå¼å­ï¼š$\binom{n}{k}=\frac{n}{k}\binom{n-1}{k-1}$ã€‚é‚£ä¹ˆå¯¹äºåŸå¼çš„å³è¾¹å°±å¯ä»¥åŒ–æˆ</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum_{x=1}^n x\cdot\binom{n}{x}\\
=&\sum_{x=1}^n n\cdot \binom{n-1}{x-1}\\
=&n\cdot 2^{n-1}
\end{aligned}</script><h3 id="B"><a href="#B" class="headerlink" title="B"></a>B</h3><blockquote>
<p>è¯æ˜</p>
<script type="math/tex; mode=display">
\binom{n}{k}=\binom{n-1}{k-1}+\binom{n-1}{k}</script></blockquote>
<p>è€ƒè™‘ $(1+x)^{n+1}$ çš„ä¸¤ç§å±•å¼€æ–¹å¼ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
(1+x)^{n+1}=&\sum \binom{n+1}{i+1}x^{i+1}\\
(1+x)^{n+1}
=&(1+x)\sum \binom{n}{i}x^{i}\\
=&\sum \binom{n}{i}\left(x^{i}+x^{i+1}\right)\\
=&\sum \left(\binom{n}{i}+\binom{n}{i+1}\right)x^{i+1}
\end{aligned}</script><p>æ¯”è¾ƒä¸¤ä¸ªå¤šé¡¹å¼ä¸­ $i+1$ é¡¹çš„ç³»æ•°ï¼Œå¯çŸ¥è¯æ¯•ã€‚</p>
<h1 id="å½¢å¼å¹‚çº§æ•°"><a href="#å½¢å¼å¹‚çº§æ•°" class="headerlink" title="å½¢å¼å¹‚çº§æ•°"></a>å½¢å¼å¹‚çº§æ•°</h1><h2 id="å…³äº-frac-1-1-x"><a href="#å…³äº-frac-1-1-x" class="headerlink" title="å…³äº $\frac{1}{1-x}$"></a>å…³äº $\frac{1}{1-x}$</h2><p>è®¾è¯¥å•†ä¸º $\sum c_nx^n$ã€‚é‚£ä¹ˆæœ‰</p>
<script type="math/tex; mode=display">
1=(1-x)\sum c_ix^i\\
1=c_0+\sum(c_i-c_{i-1})x^i\\</script><p>å¯çŸ¥ $c_0=1,c_i=c_{i-1}$ ã€‚æ‰€ä»¥æ¯ä¸€é¡¹çš„ç³»æ•°éƒ½ä¸º $1$ ã€‚æ•…æœ‰å½¢å¼å¹‚çº§æ•°åŸºæœ¬å®šç†ï¼š</p>
<script type="math/tex; mode=display">
1+x+x^2+x^3\cdots=\frac{1}{1-x}</script><h2 id="ä¸€ç³»åˆ—æ±‚æ¯å‡½æ•°ä¾‹å­"><a href="#ä¸€ç³»åˆ—æ±‚æ¯å‡½æ•°ä¾‹å­" class="headerlink" title="ä¸€ç³»åˆ—æ±‚æ¯å‡½æ•°ä¾‹å­"></a>ä¸€ç³»åˆ—æ±‚æ¯å‡½æ•°ä¾‹å­</h2><script type="math/tex; mode=display">
\begin{aligned}
\{C_n^{n},C_{n+1}^n,C_{n+2}^{n}\cdots\}&\to\sum \binom{n+i}{n}x^i=\frac{1}{(1-x)^{n+1}}\\
\{1,5,25,125\cdots\}&\to\sum 5^ix^i=\sum{5x^i}=\frac{1}{(1-5x)}\\
\{0,1\times 2,2\times 3,3\times 4\cdots\}&\to\sum (i+1)\cdot i\cdot x^i=\sum x^i\cdot 2\sum_{j=1}^ij=(\sum i\cdot x^i)*(\sum 2x^i)=\frac{2}{1-x}\cdot\frac{x}{(1-x)^2}\\
\{0,0,0,-1,1,-1,1\cdots\} & \to \sum_{i=3}^{\infty}(-1)^ix^i=x^3\sum(-x)^i=\frac{x^3}{1+x}\\

\end{aligned}</script><h1 id="éƒ¨åˆ†åˆ†å¼"><a href="#éƒ¨åˆ†åˆ†å¼" class="headerlink" title="éƒ¨åˆ†åˆ†å¼"></a>éƒ¨åˆ†åˆ†å¼</h1><p>è¿™ä¸€ç« çš„ä½œç”¨åœ¨äºæŠŠä¸€ä¸ªå¤æ‚çš„è®¡æ•°é—®é¢˜è½¬åŒ–ä¸ºè®¸å¤šä¸ªç®€å•çš„ $\rm OGF$ çš„å½¢å¼ã€‚</p>
<h2 id="é¢„å¤‡å®šç†"><a href="#é¢„å¤‡å®šç†" class="headerlink" title="é¢„å¤‡å®šç†"></a>é¢„å¤‡å®šç†</h2><blockquote>
<p>è®¾ $\frac{P(x)}{Q(x)}$ æ˜¯ä¸€ä¸ªçœŸåˆ†å¼ï¼Œ$a$ æ˜¯ $Q(x)$ çš„ä¸€ä¸ª $k$ é‡æ ¹ï¼Œé‚£ä¹ˆå­˜åœ¨ä¸€ä¸ªæ•°åˆ— $A_{1\sim k}$ ä½¿å¾—</p>
<script type="math/tex; mode=display">
\frac{P(x)}{Q(x)}=\sum_{i=1}^k\frac{A_i}{(x-a)^i}+\frac{P'(x)}{Q'(x)}</script><p>å…¶ä¸­ $\frac{Pâ€™(x)}{Qâ€™(x)}$ ä¾æ—§æ˜¯çœŸåˆ†å¼ã€‚</p>
</blockquote>
<p>æ‡’å¾—è¯äº†ã€‚æ„Ÿæ€§ç†è§£ã€‚</p>
<h2 id="éƒ¨åˆ†åˆ†å¼å®šç†"><a href="#éƒ¨åˆ†åˆ†å¼å®šç†" class="headerlink" title="éƒ¨åˆ†åˆ†å¼å®šç†"></a>éƒ¨åˆ†åˆ†å¼å®šç†</h2><blockquote>
<p>è®¾ $\frac{P(x)}{Q(x)}$ æ˜¯ä¸€ä¸ªçœŸåˆ†å¼ï¼Œå¦‚æœ $a_1,a_2,\cdots a_m$ åˆ†åˆ«æ˜¯å¤šé¡¹å¼ $Q(x)$ çš„ $k_1,k_2,\cdots k_m$ é‡æ ¹ã€‚é‚£ä¹ˆå­˜åœ¨ä¸€å¼ æ•°è¡¨ $\mathbf A$ ï¼Œä½¿å¾—</p>
<script type="math/tex; mode=display">
\frac{P(x)}{Q(x)}=\sum_{i=1}^m\sum_{j=1}^{k_i}\frac{\mathbf A_{i,j}}{(x-a_i)}</script></blockquote>
<p>ç”±é¢„å¤‡å®šç†å¯çŸ¥æ˜¾ç„¶ã€‚</p>
<h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h3 id="ï¼ˆ1ï¼‰"><a href="#ï¼ˆ1ï¼‰" class="headerlink" title="ï¼ˆ1ï¼‰"></a>ï¼ˆ1ï¼‰</h3><blockquote>
<p> åˆ†è§£ $\frac{1}{x^3-x^2-x+1}$ ä¸ºéƒ¨åˆ†åˆ†å¼ã€‚</p>
</blockquote>
<p>é¦–å…ˆå› å¼åˆ†è§£å¯ä»¥çŸ¥é“ $1$ æ˜¯ä»–çš„äºŒé‡æ ¹ï¼Œ$-1$ æ˜¯ä»–çš„ä¸€é‡æ ¹ã€‚é‚£ä¹ˆå¯ä»¥æ ¹æ®éƒ¨åˆ†åˆ†å¼å®šç†å¾—åˆ°</p>
<script type="math/tex; mode=display">
\frac{1}{x^3-x^2-x+1}=\frac{a}{(x-1)^2}+\frac{b}{x-1}+\frac{c}{x-1}</script><p>ä¸¤è¾¹é€šåˆ†åå‘ç°æ˜¯ä¸ªæ’ç­‰å¼ï¼Œäºæ˜¯å°±å¯ä»¥å¯¹ $x$ ç”¨ç‰¹æ®Šå€¼æ³•å¾—åˆ° </p>
<script type="math/tex; mode=display">
a=\frac{1}{2},b=-\frac{1}{4},c=\frac{1}{4}</script><p>ç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚</p>
<h3 id="ï¼ˆ2ï¼‰"><a href="#ï¼ˆ2ï¼‰" class="headerlink" title="ï¼ˆ2ï¼‰"></a>ï¼ˆ2ï¼‰</h3><blockquote>
<p>å°†åˆ†è§£ $\frac{6x^2+22x+18}{x^3+6x^2+11x+6}$ ä¸ºéƒ¨åˆ†åˆ†å¼</p>
</blockquote>
<p>ç»§ç»­è€ƒè™‘å°†åˆ†æ¯å› å¼åˆ†è§£ã€‚å³</p>
<script type="math/tex; mode=display">
x^3+6x^2+11x+6=(x+1)\cdot (x+2)\cdot (x+3)</script><p>é‚£ä¹ˆä¹‹åå°±å˜æˆsbé¢˜äº†ï¼Œåˆ†è§£ä¸º $\frac{1}{x+1}+\frac{2}{x+2}+\frac{3}{x+3}$ã€‚</p>
<h1 id="ç®€å•ç»„åˆé—®é¢˜"><a href="#ç®€å•ç»„åˆé—®é¢˜" class="headerlink" title="ç®€å•ç»„åˆé—®é¢˜"></a>ç®€å•ç»„åˆé—®é¢˜</h1><h2 id="ä¸€èˆ¬ç»„åˆé—®é¢˜"><a href="#ä¸€èˆ¬ç»„åˆé—®é¢˜" class="headerlink" title="ä¸€èˆ¬ç»„åˆé—®é¢˜"></a>ä¸€èˆ¬ç»„åˆé—®é¢˜</h2><blockquote>
<p> è®¾æœ‰ $n$ ç§ä¸åŒçš„ç‰©ä½“ï¼Œåˆ†åˆ«åªèƒ½å– $a_1,a_2,a_3\cdots a_n$ ä¸ªï¼Œå¦‚æœè¦å– $r$ ä¸ªï¼Œæœ‰å¤šå°‘ç§æ–¹æ¡ˆã€‚</p>
</blockquote>
<p>å½¢å¼å¹‚çº§æ•°å¤§æ¦‚å°±æ˜¯</p>
<script type="math/tex; mode=display">
\prod _{i=1}^n(1+x+x^2+\cdots+x^{a_i})</script><p>è¿™æ ·ã€‚æˆ–è€…è€ƒè™‘ä¸€ä¸ªæ›´ç‰¹æ®Šçš„é—®é¢˜ï¼Œä» $n$ ä¸ªä¸åŒç‰©å“é‡Œå¯ä»¥é‡å¤åœ°å–å‡º $r$ ä¸ªçš„æ–¹æ¡ˆæ•°ï¼š</p>
<script type="math/tex; mode=display">
\prod_{i=1}^n(1+x+x^2+\cdots)=\frac{1}{(1-x)^n}</script><p>ç”±ä¸Šé¢çš„å½¢å¼å¹‚çº§æ•°å±•å¼€å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªä¸œè¥¿çš„ç¬¬ $r$ é¡¹æ˜¯ $\binom{n-1+r}{n-1}=\binom{n+r-1}{r}$ï¼Œæ˜¯ä¸ªå¸¸è§çš„ç»“è®ºã€‚</p>
<h2 id="ç ç æ¨¡å‹"><a href="#ç ç æ¨¡å‹" class="headerlink" title="ç ç æ¨¡å‹"></a>ç ç æ¨¡å‹</h2><blockquote>
<p>è®¾æœ‰ $n$ ç§ç ç ï¼Œè´¨é‡åˆ†åˆ«ä¸º $c_1,c_2\cdots c_n$ï¼Œåˆ†åˆ«æœ‰ $b_1,b_2\cdots b_n$ æšï¼Œæ±‚ä¸€å…±å¯ä»¥ç§°å‡ºå¤šå°‘ç§ä¸åŒè´¨é‡çš„ç‰©å“ã€‚</p>
</blockquote>
<p>è¿™ä¸ªä¸œè¥¿çš„å½¢å¼å¹‚çº§æ•°å¤§æ¦‚æ˜¯</p>
<script type="math/tex; mode=display">
\prod_{i=1}^n (1+x^{c_i}+x^{2\cdot c_i}+x^{3\cdot c_i}+\cdots+x^{b_i\cdot c_i})</script><h2 id="ä¸å®šæ–¹ç¨‹ç›¸å…³"><a href="#ä¸å®šæ–¹ç¨‹ç›¸å…³" class="headerlink" title="ä¸å®šæ–¹ç¨‹ç›¸å…³"></a>ä¸å®šæ–¹ç¨‹ç›¸å…³</h2><blockquote>
<p>æ±‚</p>
<script type="math/tex; mode=display">
p_1x_1+p_2x_2+\cdots+p_nx_n=r</script><p>çš„éè´Ÿæ•´æ•°è§£ä¸ªæ•°ã€‚</p>
</blockquote>
<p>å¾ˆæ˜¾ç„¶æ˜¯ </p>
<script type="math/tex; mode=display">
\prod_{i=1}^n (1+x^{p_i}+x^{2\cdot p_i}+\cdots)</script><p>è¿™é‡Œç»§ç»­æŠŠ $1$ å½“ä½œä¸€ä¸ªç‰©å“ï¼Œæ¯ä¸ªå˜é‡åªèƒ½æ‹¿ $p_i$ çš„å€æ•°ä¸ªå°±å¾ˆå¥½ç†è§£äº†ã€‚</p>
<p>é‚£ä¹ˆè¿™ä¸œè¥¿çš„æ¯å‡½æ•°æ˜¾ç„¶æ˜¯</p>
<script type="math/tex; mode=display">
\frac{1}{(1-x^{p_1})(1-x^{p_2})(1-x^{p_3})\cdots(1-x^{p_n})}</script><h2 id="æœ‰å…³åˆ†æ‹†æ•°çš„æ‹“å±•"><a href="#æœ‰å…³åˆ†æ‹†æ•°çš„æ‹“å±•" class="headerlink" title="æœ‰å…³åˆ†æ‹†æ•°çš„æ‹“å±•"></a>æœ‰å…³åˆ†æ‹†æ•°çš„æ‹“å±•</h2><p>åœ¨æ­£æ•´æ•° $r$ çš„æ‰€æœ‰åˆ†æ‹†ä¸­ï¼Œ ä¸è¶…è¿‡ $n$ çš„æœ‰å‡ ç§ï¼Ÿ</p>
<p>å‘ç°æœ¬è´¨ä¸Šæ˜¯åœ¨æ±‚è¿™æ ·ä¸€ä¸ªä¸å®šæ–¹ç¨‹</p>
<script type="math/tex; mode=display">
1\cdot x_1+2\cdot x_2+3\cdot x_3+\cdots+n\cdot x_n=r</script><p>çš„éè´Ÿæ•´æ•°è§£ä¸ªæ•°ã€‚</p>
<p>é‚£ä¹ˆæ˜¾ç„¶å°±æ˜¯ $\frac{1}{(1-x)(1-x^2)\cdots(1-x)^n}$</p>
<h2 id="åˆä¸€ä¸ªæ‹“å±•-OIä¸­çš„åº”ç”¨"><a href="#åˆä¸€ä¸ªæ‹“å±•-OIä¸­çš„åº”ç”¨" class="headerlink" title="åˆä¸€ä¸ªæ‹“å±•(OIä¸­çš„åº”ç”¨)"></a>åˆä¸€ä¸ªæ‹“å±•(OIä¸­çš„åº”ç”¨)</h2><blockquote>
<p>ç»™å®š $n$ å’Œ $c_i(1\leq c_i\leq \rm m)$ï¼Œæ±‚ $0\leq x_i\leq c_i$ æ—¶ï¼Œ$\sum x_i=s$ çš„è§£çš„æ•°é‡ã€‚</p>
<p>å¯¹äºå‰ $30\%$ çš„æ•°æ®ï¼Œæœ‰ $n\leq 16,0\leq m,s\leq 10^9$  ã€‚</p>
<p>å¯¹äºå‰ $70\%$ çš„æ•°æ®ï¼Œæœ‰ $n\leq 35ï¼Œ0\leq m,s\leq 10^9$ ã€‚</p>
<p>å¯¹äºå¦å¤– $30\%$ çš„æ•°æ®ï¼Œæœ‰ $1\leq n\leq 5\cdot 10^5,0\leq m,s\leq 100$ã€‚</p>
</blockquote>
<p>å‘ç°å¤§æ¦‚ $30\%$ çš„å¯ä»¥ç›´æ¥å¤§åŠ›å®¹æ–¥ï¼Œæœ€å $30\%$ çš„å¯ä»¥ç”Ÿæˆå‡½æ•°ï¼Œä¸­é—´ $40\%$ çš„å°±éœ€è¦ç¥ç§˜çš„ $\rm Meet~in~Middle$ äº†ã€‚æƒ³äº†æƒ³å¤§æ¦‚å°±æ˜¯åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œæšä¸¾ç¬¬äºŒéƒ¨åˆ†çš„æ—¶å€™é¡ºä¾¿ä¹˜æ³•åŸç†ä¸€ä¸‹ç¬¬ä¸€éƒ¨åˆ†çš„ç»“æœå°±å®Œäº†ã€‚</p>
<h1 id="çº¿æ€§å¾ªç¯æ•°åˆ—"><a href="#çº¿æ€§å¾ªç¯æ•°åˆ—" class="headerlink" title="çº¿æ€§å¾ªç¯æ•°åˆ—"></a>çº¿æ€§å¾ªç¯æ•°åˆ—</h1><h2 id="æ–æ³¢é‚£å¥‘æ•°åˆ—é€šé¡¹"><a href="#æ–æ³¢é‚£å¥‘æ•°åˆ—é€šé¡¹" class="headerlink" title="æ–æ³¢é‚£å¥‘æ•°åˆ—é€šé¡¹"></a>æ–æ³¢é‚£å¥‘æ•°åˆ—é€šé¡¹</h2><p>è€ƒè™‘æ–æ³¢é‚£å¥‘æ•°åˆ— $\{a_n\}$ çš„æ¯å‡½æ•°å¯ä»¥è¿™ä¹ˆå¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
f(x)=a_0+a_1x+\cdots+a_nx^n+\cdots\\
-xf(x)=-a_0x-a_1x^2-\cdots-a_nx^{n+1}\cdots\\
-x^2f(x)=-a_0x^2-a_1x^3-\cdots-a_nx^{n+2}\cdots\\</script><p>è€ƒè™‘ â‘  + â‘¡ + â‘¢ å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
(1-x-x^2)f(x)=a_0+(a_1-a_0)x+(a_2-a_1-a_0)x^2\cdots</script><p>å¯çŸ¥</p>
<script type="math/tex; mode=display">
f(x)=\frac{1}{1-x-x^2}</script><p>é‚£ä¹ˆè€ƒè™‘å¦‚ä½•å±•å¼€è¿™ä¸ªä¸œè¥¿ã€‚ä»¤ $r_1,r_2$ ä¸ºæ–¹ç¨‹ $1-x-x^2$ çš„ä¸¤ä¸ªæ ¹ã€‚é‚£ä¹ˆæœ‰</p>
<script type="math/tex; mode=display">
\frac{1}{1-x-x^2}=\frac{1}{r_2-r_1}\left(\frac{1}{x-r_1}-\frac{1}{x-r_2}\right)</script><p>å˜ä¸€ä¸‹å½¢ï¼š</p>
<script type="math/tex; mode=display">
\frac{1}{1-x-x^2}=\frac{1}{r_2-r_1}\left(\frac{1}{r_2\left(1-\frac{1}{r_2}x\right)}-\frac{1}{r_1\left(1-\frac{1}{r_1}x\right)}\right)</script><p>ç„¶åæœ‰ä¸€æ­¥å¾ˆç¥ä»™çš„è½¬åŒ–ã€‚ç”±</p>
<script type="math/tex; mode=display">
\frac{1}{1-\frac{1}{r_1}x}=\sum\left(\frac{1}{r_1}\right)^ix^i\\
\frac{1}{1-\frac{1}{r_2}x}=\sum\left(\frac{1}{r_2}\right)^ix^i</script><p>å¾—åˆ°</p>
<script type="math/tex; mode=display">
\frac{1}{1-x-x^2}=\sum\left[\frac{1}{r_2-r_1}\left(\frac{1}{r_2^{i+1}}-\frac{1}{r_1^{i+1}}\right)\right]x^i</script><p>å¯çŸ¥</p>
<script type="math/tex; mode=display">
a_n=\frac{1}{\left(r_1r_2\right)^n}\cdot\frac{r_2^{n+1}-r_1^{n+1}}{r_1-r_2}</script><p>ç»§è€Œå¯ä»¥å¾—åˆ°</p>
<script type="math/tex; mode=display">
a_n=\frac{1}{\sqrt 5}\left[\left(\frac{1+\sqrt 5}{2}\right)^{n+1}-\left(\frac{1-\sqrt 5}{2}\right)^{n+1}\right]</script><h2 id="ä¸€èˆ¬çº¿æ€§å¾ªç¯æ•°åˆ—"><a href="#ä¸€èˆ¬çº¿æ€§å¾ªç¯æ•°åˆ—" class="headerlink" title="ä¸€èˆ¬çº¿æ€§å¾ªç¯æ•°åˆ—"></a>ä¸€èˆ¬çº¿æ€§å¾ªç¯æ•°åˆ—</h2><p>ç”±ä¸Šä¾‹å¯çŸ¥ï¼Œå¯¹äºä¸€ä¸ªç»™å®šçš„ $k$ é˜¶çº¿æ€§å¾ªç¯æ•°åˆ—ï¼Œæ±‚æ¯å‡½æ•°åªéœ€è¦æ„é€ å‡ºé™¤äº†å‰ $k$ é¡¹ä¹‹å¤–ç³»æ•°éƒ½ä¸º $0$ çš„å¹‚çº§æ•°å³å¯ã€‚</p>
<p>æ¯”å¦‚ç»™å®šæ•°åˆ— $\{a_n\}$ æ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
a_0=0,a_1=1,a_2=-1\\
a_n=-a_{n-1}+16a_{n-2}-20a_{n-3}\quad(n=3,4,5\cdots)\\</script><p>é‚£ä¹ˆè€ƒè™‘æ„é€ å¦‚ä¸‹å››ä¸ªï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(x)&=a_0+a_1x+\cdots+a_nx^n+\cdots\\
xf(x)&=a_0x+a_1x^2+\cdots + a_nx^{n+1}\cdots\\
-16x^2f(x)&=-16a_0x^2-16a_1x^3-\cdots-16a_nx^{n+2}\cdots\\
20x^3f(x)&=-20a_0x^3+20a_1x^4+\cdots+20a_nx^{n+3}\cdots\\
\end{aligned}</script><p>è¿˜æ˜¯ â‘  + â‘¡ + â‘¢ + â‘£ï¼š</p>
<script type="math/tex; mode=display">
(1+x-16x^2+20x^3)f(x)=x\\
f(x)=\frac{x}{1+x-16x^2+20x^3}</script><p>å°±å®Œäº†ã€‚</p>
<p>å—¯ï¼Œå‰©ä¸‹çš„å†…å®¹å°±ç•™ç»™ä¸‹ä¸€ç¯‡äº†ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>ç”Ÿæˆå‡½æ•°</category>
      </categories>
      <tags>
        <tag>ç»„åˆè®¡æ•°/ç”Ÿæˆå‡½æ•°</tag>
        <tag>ç»„åˆè®¡æ•°/äºŒé¡¹å¼å®šç†</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç»ƒä¹ è®°å½•ã€‘å¹³æ—¥é‡Œå£èƒ¡çš„é¢˜ç›®ç³»åˆ—1</title>
    <url>/2020/02/09/%E5%B9%B3%E6%97%A5%E9%87%8C%E5%8F%A3%E8%83%A1%E7%9A%84%E9%A2%98%E7%9B%AE%E7%B3%BB%E5%88%971/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚å°±æ˜¯æœ‰äº›é¢˜å®åœ¨ä¸æƒ³å†™ï¼Œå°±æŠŠè¿™äº›é¢˜ç»™å˜´äº†ã€‚</p>
<p>ç”±äºåŒä¸€ç¯‡æ–‡ç« å¤ªé•¿ä¼šé€ æˆå¾ˆå·®çš„è§‚æ„Ÿã€‚æ‰€ä»¥å°±åˆ†æˆå¾ˆå¤š $parts$ äº†ã€‚</p>
<p>å¯¹äºä¸ªäººè®¤ä¸ºæ¯”è¾ƒå¦™çš„é¢˜ï¼Œä¼šæ‰“ä¸Š <code>*</code> çš„å›¾æ ‡ã€‚</p>
<a id="more"></a>
<h1 id="MdOI2020"><a href="#MdOI2020" class="headerlink" title="MdOI2020"></a>MdOI2020</h1><p>å½“æˆæœˆèµ›æ‰“äº†ã€‚T1å†™äº†ä¸ªè¯¡å¼‚çš„ç®—æ³•ç»“æœå› ä¸ºç‰¹åˆ¤æ—¶æ²¡è¾“å‡ºæ¢è¡Œæ‹¿äº†64ï¼Œç„¶åå°±æ²¡æœ‰æ‰“çš„å…´è¶£äº†ï¼ˆ</p>
<h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><p>è€ƒè™‘å¯¹äºä¸€ç§æ‹†åˆ†æ˜¯æœ€ä¼˜çš„ã€‚å³ $(a,b,c)=d$ï¼Œ$d$ ä¸ºæ‰€æ±‚ï¼Œé‚£ä¹ˆå‘ç°ä¼šæœ‰ $d\cdot (\frac{a}{d}+\frac{b}{d}+\frac{c}{d})=n$ã€‚å‘ç°å½“ $\frac{a}{d},\frac{b}{d},\frac{c}{d}$ ä¸‰è€…ä¸åŒæ—¶ï¼Œä¸€å®šå¯ä»¥è½¬åŒ–æˆå…¶ä¸­ä¸€ä¸ªæ•° $=d$ çš„æ„é€ æ–¹å¼ã€‚</p>
<p>æ‰€ä»¥è€ƒè™‘è´¨å› æ•°åˆ†è§£ä¹‹åæšä¸¾ $\frac{n}{d}$ã€‚å‘ç°å½“ $\frac{n}{d}\leq 5$ çš„æ—¶å€™ï¼Œå½“å‰æšä¸¾çš„ $d$ ä¸å¯ä»¥è®© $\frac{a}{d},\frac{b}{d},\frac{c}{d}$ ä¸‰è€…ä¸åŒã€‚æ‰€ä»¥åˆ¤æ‰è¿™äº›æ•°æ®ï¼Œå‰©ä¸‹çš„å– $\rm max$ å³å¯ã€‚</p>
<p>å‘ç°ç°åœ¨è¦æ±‚çš„ï¼Œå°±æ˜¯ä» $n$ çš„æ‰€æœ‰åˆ†è§£é‡Œé¢ï¼ŒæŒ‘å‡ºä¸€ä¸ªæœ€æ¥è¿‘ $6$ ä¸” $\geq 6$ çš„æ„é€  $\frac{n}{d}$ çš„æ–¹æ¡ˆã€‚å‘ç°æœ€å¤šéœ€è¦ä¸‰ä¸ªç´ å› å­æ‰å¯ä»¥è¶…è¿‡ $6\to (2,2,2)$ï¼Œæœ€å°‘çš„è¯ä¸€ä¸ªå°±è¶³å¤Ÿäº†ã€‚æ‰€ä»¥è€ƒè™‘ $\log ^3n$ ä¸‰é‡å¾ªç¯æšä¸¾æ‰€æœ‰çš„è´¨å› å­å³å¯ã€‚</p>
<p>è´¨å› æ•°åˆ†è§£å®Œå…¨å¯ä»¥ $\rm pollard-rho$ã€‚æœ€åå¤æ‚åº¦ $O(T\max(\log^3 n,n^\frac{1}{4}))$</p>
<p>(è¿™ä¸ªé¢˜å†™çš„é•¿æ˜¯å› ä¸ºç›´æ¥æŠŠè‡ªå·±å†™çš„é¢˜è§£ç»™ç²˜è¿‡æ¥äº†)</p>
<h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><p>è€ƒè™‘ä¸€ä¸ªæ€§è´¨ï¼Œæ’å¥½åºåï¼Œæœ€åä¸å˜çš„ä¸€å®šæ˜¯ä¸€ä¸ªè¿ç»­åŒºé—´ã€‚æ‰€ä»¥è€ƒè™‘æšä¸¾è¿™ä¸ªè¿ç»­åŒºé—´ï¼Œå°ºå–æˆ–è€…äºŒåˆ†å‡ºå³ç«¯ç‚¹ï¼Œæ£€éªŒä¸€ä¸‹å°±å¯ä»¥äº†ã€‚å¤æ‚åº¦ $O(n)$ã€‚</p>
<h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><p>è€ƒè™‘ä¸€ä¸ªæ€§è´¨ã€‚å‘ç°å…¶å®å·¦ä¸Šè§’çš„æ•°å®šä½ä¹‹åï¼Œä¹‹åçš„æ•°éƒ½ç¡®å®šäº†ã€‚æ‰€ä»¥å¯ä»¥éšä¾¿ç”¨ç‚¹å·®åˆ† $trick$ å®ç° $n^2$ .</p>
<h2 id="D"><a href="#D" class="headerlink" title="D*"></a>D*</h2><p>æ¯”è¾ƒæœ‰è¶£çš„é¢˜ã€‚æ ¹æ®ç¬¬äºŒä¸ªå­ä»»åŠ¡çš„æç¤ºå¯ä»¥å‘ç°ï¼Œå¯¹äºæ¯ä¸ªè¯¢é—®å¯ä»¥æŠŠå½“å‰ç‚¹æ—‹åˆ°æ ¹ï¼Œç„¶åæ±‚çš„å°±æ˜¯ä¸€ä¸ªåŒºé—´å†…ç‚¹çš„ $lca$ çš„æ·±åº¦ã€‚å‘ç°è¿™ä¸ªä¸œè¥¿æœ‰ç»“åˆå¾‹ï¼Œæ¯”è¾ƒå®¹æ˜“ç”¨çº¿æ®µæ ‘ç»´æŠ¤ã€‚</p>
<p>ç„¶è€Œæ¯æ¬¡æ¢æ ¹å¤æ‚åº¦æ˜¾ç„¶ä¸å¯¹ã€‚è€ƒè™‘è¿›ä¸€æ­¥åˆ†ææ€§è´¨ï¼Œå½“è¯¢é—®ç‚¹ $q$ ä¸åœ¨åŸæ ‘ä¸Šçš„ $lca$ çš„å­æ ‘å†…æ—¶ï¼Œæ¢æ ¹ä¸ä¼šå½±å“è·ç¦»ï¼Œæ‰€ä»¥ç›´æ¥ç»Ÿè®¡å³å¯ï¼›å½“è¯¢é—®ç‚¹ $q$ ä¸åœ¨ $lca$ çš„å­æ ‘å†…æ—¶ï¼Œè€ƒè™‘æ¢æ ¹ä¹‹åçš„ $lcaâ€™$ ä¸€å®šä¹Ÿæ˜¯åŸæ ‘é‡Œ $p$ çš„æŸä¸ªç¥–å…ˆã€‚é€šè¿‡ç”»å›¾å¯ä»¥çŸ¥é“ï¼Œåªéœ€è¦å€å¢æ‰¾å‡º $p$ çš„ç¬¬ä¸€ä¸ªåŒ…å« $[l,r]$ å†…ç‚¹çš„ç¥–å…ˆå³å¯ã€‚æ±‚äº¤é›†å¯ä»¥ç”¨ä¸»å¸­æ ‘æ¥ç»´æŠ¤ã€‚å¤æ‚åº¦ $(n\log^2n+q\log^2n)$ã€‚</p>
<h2 id="E"><a href="#E" class="headerlink" title="E*"></a>E*</h2><p>å‘ç°å¯ä»¥è½¬åŒ–æˆæšä¸¾ä¸€ä¸ªç‚¹ $x$ ï¼Œä» $x$ çš„å­æ ‘å†…å¤–å„é€‰ä¸€å¯¹ç‚¹ä½¿å¾— xor å€¼æœ€å¤§ï¼Œå‘ç°ç›´æ¥æ‹¿Trieç»´æŠ¤ä¸€ä¸ªå›æ»šè«é˜ŸçŠ¶ç‰©å³å¯ã€‚å¤æ‚åº¦ $n\sqrt n\log V$ ã€‚</p>
<p>ä¼¼ä¹å¯ä»¥ç”¨ä»€ä¹ˆå€¼åŸŸåˆ†å—çš„é»‘ç§‘æŠ€ä¼˜åŒ–ä¸€ä¸‹ã€‚emmmä½†æˆ‘è¿˜ä¸ä¼šã€‚</p>
<h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><p>æ˜¯ä¸ªæ¨å¼å­é¢˜ï¼Œæš‚æ—¶ä¸æ˜¯å¾ˆæƒ³æ¨ã€‚</p>
<h1 id="EAçš„ç»ƒä¹ èµ›"><a href="#EAçš„ç»ƒä¹ èµ›" class="headerlink" title="EAçš„ç»ƒä¹ èµ›"></a>EAçš„ç»ƒä¹ èµ›</h1><p>å‘ç°è‡ªå·±è¢«å«å»éªŒé¢˜ç»“æœå•¥éƒ½ä¸ä¼šååˆ†ä¸¢äºº.jpg</p>
<h2 id="A-1"><a href="#A-1" class="headerlink" title="A"></a>A</h2><p>å‘ç°å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦å’Œåé¢çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ç›¸åŒï¼Œé‚£ä¹ˆå°±ä¸€å®šä¸åˆæ³•ï¼›åä¹‹ä¸€å®šåˆæ³•ã€‚æ‰€ä»¥ç­”æ¡ˆæ˜¯ $26\times 25^{n-1}$ ã€‚</p>
<h2 id="B-1"><a href="#B-1" class="headerlink" title="B*"></a>B*</h2><p>æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§ï¼Œå‘ç°å¯ä»¥å°†æ¯ä¸ªç‚¹çš„ç­”æ¡ˆè½¬åŒ–ä¸€ä¸‹ï¼š$E=\sum_{i=1}^{n-1}P(x\geq i)$ ã€‚</p>
<p>è€ƒè™‘æ¯ä¸ªç‚¹ä»€ä¹ˆæ—¶å€™è¢«åˆ é™¤ã€‚å‘ç°åªè·Ÿç¦»ä»–æœ€è¿‘çš„å‰åä¸¤ä¸ªæ¯”ä»–å¤§çš„æ•°æœ‰å…³ï¼Œæ¯å½“æœ‰ä¸€ä¸ªä¸ $x$ ç›¸é‚»æ—¶ $x$ å°±ä¼šæŒ‚ã€‚æ‰€ä»¥ç”¨å®¹æ–¥åŸç†ç®—ä¸€ä¸‹ï¼Œ$P(x\geq i)=1-P(pre\sim x)-P(x\sim~nxt)+P(pre\sim nxt)$ ã€‚å‘ç°è¿™ä¸œè¥¿æ˜¾ç„¶æœ‰ç»„åˆæ„ä¹‰ï¼Œæ‰€ä»¥ç®—ä¸€æ³¢ç»„åˆæ•°å³å¯ã€‚å¤æ‚åº¦ $O(n^2)$ ã€‚</p>
<h2 id="C-1"><a href="#C-1" class="headerlink" title="C"></a>C</h2><p>æœ‰æ„æ€çš„é¢˜ã€‚å‘ç°åˆ‡å‰²æ–¹å¼ä¸¥æ ¼è¦æ±‚ä»å·¦åˆ°å³ï¼Œé‚£ä¹ˆå¯¹äºä¸¤æ ¹å¼¦ï¼Œå¦‚æœä»¥ $u_j\geq u_i,v_j\leq v_i$ çš„æ–¹å¼ç›¸äº¤ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠ $j$ è¿™æ¡å¼¦ç»™åˆ æ‰ã€‚æ‰€ä»¥åˆ æ‰ä¹‹åé‡æ–°æ’åºï¼Œç„¶åæŒ‰å¼¦ $dp$ã€‚$f_i$ è¡¨ç¤ºå¤„ç†å®Œå‰ $i$ æ ¹å¼¦çš„ $\min$ ã€‚é‚£ä¹ˆè½¬ç§»å°±æšä¸¾ä¸€ä¸‹æŠŠå“ªä¸ª $j\sim i$ çš„è¿ç»­åŒºé—´ç»™åˆ æ‰ã€‚</p>
<p>é‚£ä¹ˆè½¬ç§»å¤§æ¦‚æ˜¯ $f_i=\min_{0\leq j&lt;i}(f_j+A_{u_{j+1}-1}\times B_{v_i+1})$ ã€‚å…¶ä¸­ $A,B$ åˆ†åˆ«æ˜¯ $a_i,b_i$ çš„å‰åç¼€æœ€å°å€¼ã€‚</p>
<p>å‘ç°ç¨å¾®å˜ä¸€ä¸‹å½¢ï¼Œå°±æ˜¯ $f_j=-A_{u_{j+1}-1}\times B_{v_i+1}+f_i$ã€‚å‘ç°æ–œç‡ $B$ å•è°ƒï¼Œ$x$ åæ ‡ $A$ å•è°ƒé€’å‡ã€‚æ‰€ä»¥å°±æ˜¯åœ¨ç»´æŠ¤ä¸€ä¸ªä¸‹å‡¸å£³ï¼Œç›´æ¥æœ€è£¸çš„æ–œç‡ä¼˜åŒ–å°±å¥½äº†ã€‚</p>
<h2 id="D-1"><a href="#D-1" class="headerlink" title="D**"></a>D**</h2><p>å¾ˆæœ‰æ„æ€çš„ç»„åˆé¢˜ã€‚å‘ç°å¯¹äºæ¯ä¸ªç‚¹ï¼Œå¦‚æœåœ¨è®¿é—®ä»–ä¹‹å‰è®¿é—®äº†æ¯”ä»–æ·±åº¦æ›´å°çš„å¶å­èŠ‚ç‚¹ï¼Œä»–å°±ä¸ä¼šè¢«è®¿é—®ã€‚æ‰€ä»¥è€ƒè™‘å¯¹äºä¸€ä¸ªç‚¹ $x$ çš„æ¯ä¸ªç¥–å…ˆ $anc_x$ ï¼Œè®¾ $anc_x$ æœ‰ $nâ€™$ ä¸ªå„¿å­ï¼Œå…¶ä¸­æœ‰ $mâ€™$ ä¸ªå­æ ‘å†…å¶èŠ‚ç‚¹çš„æœ€å°æ·±åº¦å°äº $x$ çš„æ·±åº¦ï¼Œé‚£ä¹ˆè¿™ä¸€å±‚ä¸ä¼šè¿›å…¥æ­»äº¡åˆ†å‰çš„æ–¹æ¡ˆæ•°å°±æ˜¯ $\binom{nâ€™}{mâ€™+1}\cdot (nâ€™-mâ€™-1)!\cdot (mâ€™)!$ ï¼Œè®¡æ•°æ€è·¯å¤§æ¦‚å°±æ˜¯é€‰å‡º $mâ€™+1$ ä¸ªä½ç½®æ¥ï¼Œæ¯æ¬¡é€‰éƒ½æŠŠè¿™ $mâ€™+1$ ä½ç½®ä¸­çš„ç¬¬ä¸€ä¸ªä½ç½®ç•™ç»™å½“å‰çš„ $x$ æ‰€åœ¨å­æ ‘æ”¾ï¼Œå‰©ä¸‹å°±æ˜¯æ’åˆ—æ•°ã€‚</p>
<p>ç„¶åè€ƒè™‘è¿›å…¥ $x$ çš„æ¦‚ç‡å°±æ˜¯å¾ˆç¥å¥‡çš„ $\prod \frac{1}{m_{anc_i}â€™+1}$ã€‚è€ƒè™‘è¿™ä¸ªä¸œè¥¿æ€ä¹ˆå¿«é€Ÿç®—ã€‚å‘ç°å¯¹äºåŒä¸€æ£µå­æ ‘ï¼Œ$lca$ ä¸Šæ–¹çš„ä¿¡æ¯éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ”¹å˜çš„åªæœ‰å­æ ‘å†…éƒ¨çš„æ–¹æ¡ˆã€‚é‚£ä¹ˆè€ƒè™‘å¯¹äºæ¯ä¸ªå„¿å­ï¼Œç›´æ¥æŒ‰ç…§ã€Œå­æ ‘å†…å¶å­çš„æœ€å°æ·±åº¦ã€æ’åºï¼Œå°±å¯ä»¥é¡ºåºå¤„ç†å‡ºç»“æœã€‚</p>
<p>ç±»ä¼¼äºç”¨æ ˆæ¥ç»´æŠ¤ $k$ çº§ç¥–å…ˆçš„è¿‡ç¨‹ï¼Œå‘ç°åªéœ€è¦ä¸€ä¸ªå¯æ’¤é”€çš„æ ‘çŠ¶æ•°ç»„å³å¯ã€‚å¤æ‚åº¦ $n\log n$ã€‚</p>
<h2 id="E-1"><a href="#E-1" class="headerlink" title="E"></a>E</h2><p>ä¼¼ä¹æ˜¯ä¸€é“ç¥ç§˜çš„æ’å€¼é¢˜ã€‚é¸½äº†é¸½äº†ã€‚</p>
<h1 id="LGäºŒæœˆæœˆèµ›-Â·-åŠ æ²¹æ­¦æ±‰"><a href="#LGäºŒæœˆæœˆèµ›-Â·-åŠ æ²¹æ­¦æ±‰" class="headerlink" title="LGäºŒæœˆæœˆèµ› Â· åŠ æ²¹æ­¦æ±‰"></a>LGäºŒæœˆæœˆèµ› Â· åŠ æ²¹æ­¦æ±‰</h1><p>æ²¡å‚åŠ çš„ä¸€åœºæœˆèµ›ï¼Œä¼¼ä¹è¢«çˆ†ç ´äº†.jpg</p>
<h2 id="A-2"><a href="#A-2" class="headerlink" title="A**"></a>A**</h2><p>è¿™é¢˜æœ¬æ¥æƒ³æšä¸¾æœ€åé€‰çš„å“ªä¸ªæ•°æ¥åšï¼Œä½†æ˜¯å‘ç°æ ¹æœ¬ä¸ç§‘å­¦ï¼Œè‡ªé—­äº†åŠå¤©ã€‚å°±æ˜¯è€ƒè™‘é’¦å®šäº†ä¸€ä¸ªæ•°ï¼Œå¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªå–ä»–ï¼Œé‚£ä¹ˆå‰ $k$ ä¸ªä¸€å®šéƒ½æ”¾æ¯”ä»–å°çš„æ•°ï¼ŒåŒæ—¶å¯ä»¥åœ¨ä»–çš„ä½ç½®å’Œ $k$ ä¸ªä¹‹é—´ä¹Ÿæ”¾ä¸€äº›æ¯”ä»–å°çš„æ•°ï¼Œä½†æ˜¯è¿™äº›æ–¹æ¡ˆå¯¹äºä¸åŒçš„å‰ $k$ ä¸ªå…ƒç´ çš„æœ€å¤§å€¼ï¼Œæ–¹æ¡ˆæ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥å¤æ‚åº¦å¾ˆå‡ä¹Ÿå¾ˆéº»çƒ¦ã€‚</p>
<p>å‘ç°ä¼¼ä¹ç›´æ¥æšä¸¾å‰ $k$ ä¸ªå…ƒç´ çš„æœ€å¤§å€¼æ¯”è¾ƒå®¹æ˜“åšã€‚åˆ†æˆä¸¤ç±»æ¥è®¨è®ºï¼Œä¸€ç±»æƒ…å†µæ˜¯å–åˆ°äº†æŸä¸ª $x$ï¼Œå¦ä¸€ç±»æƒ…å†µæ˜¯ä¸å¾—ä¸å–æœ€åä¸€ä¸ªï¼Œå‘ç°å½“ä¸”ä»…å½“é›†åˆé‡Œçš„æœ€å¤§å€¼åœ¨å‰ $k$ ä¸ªæ‰ä¼šå‘ç”Ÿã€‚</p>
<p>1ã€ç¬¬ä¸€ç§æƒ…å†µã€‚å¯¹äºæ¯ä¸ªæœ€å¤§å€¼ $x$ï¼Œå–åˆ°ä»–çš„æ¦‚ç‡æ˜¯ $\frac{\binom{x-1}{k-1}}{\binom{n}{k}}$ï¼Œåœ¨å–åˆ°æœ€å¤§å€¼ä¸º $x$ çš„æƒ…å†µä¸‹ï¼ŒæœŸæœ›å°±å†ä¹˜ä¸Šä¸€ä¸ª $\frac{\mathrm{S-S_{p_x}}}{n-p_x}$ã€‚å…¶ä¸­ $\rm S$ è¡¨ç¤ºé›†åˆå…ƒç´ çš„æ€»å’Œï¼Œ$\rm S_x$ è¡¨å‰ $x$ å°çš„å…ƒç´ çš„å’Œï¼Œ$p_x$ è¡¨ç¤º $x$ æ˜¯ç¬¬å‡ å°çš„ã€‚ä¸éš¾å‘ç°è¿™æ ·æ˜¯å¯¹çš„ã€‚</p>
<p>2ã€ç¬¬äºŒç§æƒ…å†µã€‚ä¸éš¾å‘ç°æ¦‚ç‡æ˜¯ $\frac{\binom{n-1}{k-1}}{\binom{n}{k}}=\frac{k}{n}$ ã€‚é‚£ä¹ˆæœŸæœ›çš„è¯ï¼Œå‘ç°è¿™ç§æƒ…å†µä¸‹æœ€åä¸€ä¸ªæ•°æ˜¯è°æƒ…å†µç›¸åŒã€‚æ‰€ä»¥ä¹˜ä¸Šä¸€ä¸ª $\frac{\mathrm{S}-x_{\max}}{n-1}$ å°±å®Œäº†ã€‚</p>
<p>å—¯ã€‚è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬æœ‰æ—¶å€™æœŸæœ›é¢˜å¹¶ä¸å¯ä»¥ç›´æ¥å¤§åŠ›å»ç»„åˆæ‰€æœ‰æƒ…å†µæ¥ç®—ï¼Œè¿˜æ˜¯éœ€è¦ä¸€å®šæŠ€å·§çš„ã€‚</p>
<p>å•Šâ€¦ä¸ä¼šè½¬æ¢ç»„åˆå¯¹è±¡â€¦æˆ‘å¤ªå¼±äº†â€¦</p>
<h2 id="B-2"><a href="#B-2" class="headerlink" title="B"></a>B</h2><p>ç”±äºæ˜¯å®Œå…¨å›¾ï¼Œé‚£ä¹ˆæ¯ä¸ªç‚¹è´¡çŒ®çš„å¼‚è‰²ä¸‰è§’å½¢ä¸ªæ•°å°±æ˜¯ $(n-1-b)\cdot b$ ã€‚</p>
<p>æ‰€ä»¥æœ€åç®—ä¸€ä¸‹è¡¥ï¼Œç­”æ¡ˆå°±æ˜¯ $\binom{n}{3}-\frac{1}{2}\sum_{i=1}^n(n-1-b_i)\cdot b_i$ ã€‚åšå®Œæ‰å‘ç°æ˜¯ä¸€é“åšçƒ‚äº†çš„é¢˜.jpg</p>
<h2 id="C-2"><a href="#C-2" class="headerlink" title="C"></a>C</h2><p>sbè´¹ç”¨æµã€‚å‘ç°æœ€å¤§æµçš„æƒ…å†µä¸‹ï¼Œä¸ä¼šå‡ºç°ä¸€ä¸ªç‚¹è¦†ç›–äº†å¦ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ä¸­çš„æŸä¸ªç‚¹ã€‚æ‰€ä»¥å¯ä»¥ç›´æ¥æµã€‚ç”¨ä¸€äº›è´ªå¿ƒçš„ $trick$ å°±å¯ä»¥è¾¹æ•°æ¶ˆæ‰ä¸€ä¸ª $n$ äº† ã€‚</p>
<h2 id="D-2"><a href="#D-2" class="headerlink" title="D*"></a>D*</h2><p>å¾ˆæœ‰æ„æ€ä¸€é“é¢˜ã€‚é¦–å…ˆå‘ç°åŸæ¥ $min_25$ ç­›å¹¶ä¸å¯ä»¥è¿‡å¾—å»ã€‚ä¹‹åå‘ç° </p>
<script type="math/tex; mode=display">
\begin{aligned}
\sigma_0(n)&=\prod(e_i+1)\\
\sigma_0(n^k)&= \prod(k\times e_i+1)
\end{aligned}</script><p>äºæ˜¯å¯ä»¥å‘ç°ï¼Œå¤§æ¦‚å¯¹äºæ¯ä¸ª $n$ï¼Œä»–çš„ $\sigma_0$ éƒ½æ˜¯ä¸€ä¸ªå…³äº $k$ çš„ $\omega(n)$ æ¬¡å¤šé¡¹å¼ã€‚äºæ˜¯å°±å¯ä»¥ç­›å‡ºå¤šé¡¹å¼æ¥ï¼Œå‰ç¼€å’Œä¸€ä¸‹ã€‚ç„¶åå°±åšå®Œäº†ã€‚å¤æ‚åº¦å¤§æ¦‚ $O(\max(\omega\cdot n, \omega\cdot q))$ ã€‚</p>
<p>å¯èƒ½ç­›å¤šé¡¹å¼éœ€è¦ä¸€äº›è¯¡ç§˜çš„ $trick$ å§ã€‚ä¸è¿‡å¤§æ¦‚è¿˜æ˜¯é€šè¿‡è®°å½•æœ€å°è´¨å› å­æ¥è½¬ç§»ã€‚</p>
<p>ç”±äºä»¥å‰æ²¡è§è¿‡è¿™ç§é¢˜ï¼Œäºæ˜¯å†™äº†ä¸ªä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    poly[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!chk[i])&#123;</span><br><span class="line">            frm[i] = <span class="number">1</span> ;</span><br><span class="line">            chk[i] = <span class="number">1</span> ;</span><br><span class="line">            mind[i] = i ;</span><br><span class="line">            mindc[i] = <span class="number">1</span> ;</span><br><span class="line">            pr[++ cnt] = i ;</span><br><span class="line">            poly[i][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">            poly[i][<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> m, j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            m = <span class="number">1l</span>l * pr[j] * i ; </span><br><span class="line">            <span class="keyword">if</span> (m &gt; n) <span class="keyword">break</span> ; chk[m] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j]) &#123;</span><br><span class="line">                mind[m] = pr[j] ;</span><br><span class="line">                mindc[m] = <span class="number">1</span>, frm[m] = i ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                mindc[m] = mindc[i] + <span class="number">1</span> ;</span><br><span class="line">                mind[m] = mind[i] ; frm[m] = frm[i] ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt;= <span class="number">8</span> ; ++ k)</span><br><span class="line">                poly[m][k] = poly[frm[m]][k] ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">8</span> ; k &gt;= <span class="number">1</span> ; -- k)</span><br><span class="line">                (poly[m][k] += <span class="number">1l</span>l * mindc[m] * poly[m][k - <span class="number">1</span>] % P) %= P ;</span><br><span class="line">            <span class="keyword">if</span> (!(i % pr[j])) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= <span class="number">8</span> ; ++ j)</span><br><span class="line">            poly[i][j] -= (poly[i][j] += poly[i - <span class="number">1</span>][j]) &gt;= P ? P : <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="E-2"><a href="#E-2" class="headerlink" title="E"></a>E</h2><p>æœ‰å¾ˆé•¿çš„é¢˜é¢ä»¥åŠçº¢è‰²çš„éš¾åº¦æ ‡ç­¾ã€‚äºæ˜¯å†³å®šè·³è¿‡ã€‚</p>
<h2 id="F-1"><a href="#F-1" class="headerlink" title="F"></a>F</h2><p>è¾£é¸¡äºŒåˆ†ç­”æ¡ˆé¢˜ã€‚éš¾ç‚¹åœ¨äºçŸ¥é“è¦å»äºŒåˆ†ç­”æ¡ˆã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>æ³›åš</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç´ æ•°/ç´ æ•°ç­›æ³•</tag>
        <tag>æ•°å­¦/æ•°è®º</tag>
        <tag>æ•°å­¦/æ¦‚ç‡,æœŸæœ›</tag>
        <tag>å¤šé¡¹å¼çš„åº”ç”¨</tag>
        <tag>æœ‰è¶£çš„äºŒåˆ†ç­”æ¡ˆ</tag>
        <tag>åŠ¨æ€è§„åˆ’/æ–œç‡ä¼˜åŒ–</tag>
        <tag>æ•°æ®ç»“æ„/å¯æŒä¹…åŒ–/å¯æŒä¹…åŒ–çº¿æ®µæ ‘</tag>
        <tag>æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è«é˜Ÿ</tag>
        <tag>ç»„åˆè®¡æ•°/æœ‰æŠ€å·§çš„è®¡æ•°</tag>
        <tag>æœ‰æŠ€å·§çš„å·®åˆ†</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç”Ÿæ´»ç¢ç‰‡4ã€‘ç”ŸåŒ–å±æœºResident Evil</title>
    <url>/2020/02/08/Life4/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¿™é‡Œå¯æ˜¯ã€Šç”ŸåŒ–å±æœºã€‹ç³»åˆ—çš„æ­»å¿ ï¼</p>
<p>å…¶å®è¿™é‡Œæ”¾çš„æ˜¯é«˜ä¸€ä¸‹å­¦æœŸæŸæ¬¡è¯­æ–‡è¯¾æ¼”è®²çš„æ¼”è®²ç¨¿äº†å•¦ã€‚</p>
<a id="more"></a>
<div class="pdf" target="./Lecture.pdf" height></div>
<p>æ‰å‘ç°åŸæ¥å¼ºåˆ¶ç”¨WPSè¿›è¡Œpptè½¬wordï¼ŒåŠ¨ç”»æ•ˆæœæ˜¯è«å¾—çš„ï¼Œæ‰€ä»¥æœ‰äº›å›¾ç‰‡åªèƒ½æ‹¼ä¸€èµ·äº†ï¼Œsadã€‚</p>
<p>å¦‚æœpdfåŠ è½½ä¸å‡ºæ¥ï¼Œæ¨è <code>firefox</code> æµè§ˆå™¨æˆ–è€…ç­‰ä¸Šé‚£ä¹ˆä¸€äºŒä¸‰å››â€¦äº”å…­ååˆ†é’Ÿï¼ˆhuaji</p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>ç”Ÿæ´»ç¢ç‰‡</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œç”Ÿæ´»ç¢ç‰‡ã€ç³»åˆ—ç›®å½•</title>
    <url>/2020/02/07/%E7%94%9F%E6%B4%BB%E7%A2%8E%E7%89%87%E7%9B%AE%E5%BD%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å‡ºè¿™ä¸ªç³»åˆ—ï¼ŒåŸå› æ˜¯æƒ³çå†™ç‚¹ä¸œè¥¿è®°å½•ç”Ÿæ´»ã€‚æœ‰åˆ«äºã€Œéšæƒ³ã€ç³»åˆ—ï¼Œè¿™äº›æ–‡ç« çš„æ„Ÿæƒ…ä¸æ˜¯é‚£ä¹ˆæµ“åšï¼Œå¤§æ¦‚æ˜¯è®°å½•æ¯”è¾ƒæ­£å¸¸çš„ç”Ÿæ´»ç‚¹æ»´ã€‚</p>
<a id="more"></a>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">ç¯‡ç›®</th>
<th style="text-align:center">é“¾æ¥ï¼ˆç‚¹å‡»å³å¯ï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ã€Œç”Ÿæ´»ç¢ç‰‡0ã€CSP2019æ¸¸è®°</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2019/12/20/CSP-S2019%E6%B8%B8%E8%AE%B0/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">ã€Œç”Ÿæ´»ç¢ç‰‡1ã€ä¸€ä¸ªå°å¼€å§‹</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2020/01/15/Life1/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">ã€Œç”Ÿæ´»ç¢ç‰‡2ã€åŸæ¥æˆ‘è¿˜ä»€ä¹ˆéƒ½ä¸æ‡‚</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2020/01/23/Life2/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">ã€Œç”Ÿæ´»ç¢ç‰‡3ã€Life is strange</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2020/01/24/Life3/">$Link$</a></td>
</tr>
<tr>
<td style="text-align:center">ã€Œç”Ÿæ´»ç¢ç‰‡4ã€ç”ŸåŒ–å±æœºResident Evil</td>
<td style="text-align:center"><a href="https://www.orchidany.cn/2020/02/08/Life4/#more">$Link$</a></td>
</tr>
</tbody>
</table>
</div>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>ç”Ÿæ´»ç¢ç‰‡</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æœæ•™ç­›</title>
    <url>/2020/01/24/%E6%9D%9C%E6%95%99%E7%AD%9B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚æ˜¯ä¸€ç§æ¯”è¾ƒå¿«çš„ç­›æ³•ï¼Ÿ</p>
<p>ç”¨äºç§¯æ€§å‡½æ•°æ±‚å’Œã€‚æ¯”å¦‚ç»™å®šäº†ä¸€ä¸ªå‡½æ•° $\boldsymbol{\rm f} $ ï¼Œè€ƒè™‘æ„é€ å‡ºè¿™æ ·çš„ä¸€ä¸ª $\boldsymbol{\rm g}$ ï¼Œä½¿å¾—åœ¨å¦‚æ­¤è½¬åŒ–ä¹‹åï¼š</p>
<script type="math/tex; mode=display">
\mathbf{S}(n)=\sum_{i=1}^{n} \mathbf{f}(i)\\
\sum_{i=1}^{n}(\mathbf{f} * \mathbf{g})(i)=\sum_{i=1}^{n} \sum_{x y=i} \mathbf{f}(x) \mathbf{g}(y)=\sum_{y=1}^{n} \mathbf{g}(y) \sum_{x y \leq n} \mathbf{f}(x)=\sum_{y=1}^{n} \mathbf{g}(y) \mathbf{S}\left(\left\lfloor\frac{n}{y}\right\rfloor\right)</script><p>å¾—å‡ºæ¥çš„ï¼š</p>
<script type="math/tex; mode=display">
\mathbf{g}(1) \mathbf{S}(n)=\sum_{i=1}^{n}(\mathbf{f} * \mathbf{g})(i)-\sum_{y=2}^{n} \mathbf{g}(y) \mathbf{S}\left(\left\lfloor\frac{n}{y}\right\rfloor\right)</script><p>å¦‚æœå…¶ä¸­ $\bf f*g$ æ¯”è¾ƒå®¹æ˜“è®¡ç®—ï¼Œå°±å¯ä»¥è¾¾åˆ°å¿«é€Ÿè®¡ç®— $\mathbf{S}$ çš„ç›®çš„äº†ã€‚</p>
<a id="more"></a>
<p>ä¼¼ä¹å¾ˆç®€å•ï¼Ÿå› ä¸ºè¿™ç§é¢˜çš„éš¾ç‚¹åœ¨äºæ„é€ ï¼Œæ„é€ å®Œäº†å°±å¯ä»¥åˆ†å—åšäº†</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll n)</span></span>&#123;</span><br><span class="line">	ll s = sum(<span class="number">1</span>, n, f * g) ;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r ; l &lt;= n ; l = r + <span class="number">1</span>) </span><br><span class="line">    r = n / (n / l), s -= solve(n / l) * sum(<span class="number">1</span>, l, g) ;</span><br><span class="line"> 	<span class="keyword">return</span> (s /= g(<span class="number">1</span>)) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œè¿™ä¹ˆåšçš„å¤æ‚åº¦ä¸å¯¹ã€‚è€ƒè™‘è¿™æ ·ä¸€ä¸ªå¼•ç†ï¼š</p>
<script type="math/tex; mode=display">
\forall x,y,z\in\mathbb{Z},\quad \left\lfloor\frac{\left\lfloor\frac{z}{x}\right\rfloor}{y}\right\rfloor=\left\lfloor\frac{z}{x y}\right\rfloor</script><p>è¯æ˜å¤§æ¦‚æ˜¯æŠŠ $z$ è®¾æˆå¸¦ä½™é™¤æ³•çš„æ ‡å‡†å½¢å¼ï¼Œç„¶åæä¸€ä¸‹å°±å¯ä»¥äº†ã€‚æ­¤å¤„ç•¥å»ã€‚</p>
<p>äºæ˜¯å‘ç°ï¼Œå…¶å®æ¯æ¬¡è¦è®¡ç®—çš„ $nâ€™$ ï¼Œéƒ½æ˜¯æŸä¸ª $\lfloor \frac{n}{x}\rfloor$ ï¼Œå› ä¸ºå‡è®¾è¿™æ¬¡æ˜¯ $\lfloor \frac{n}{x}\rfloor$ ï¼Œä¸‹æ¬¡æ˜¯ $\lfloor \frac{\lfloor \frac{n}{x}\rfloor}{y}\rfloor=\lfloor \frac{n}{x\cdot y}\rfloor$ ã€‚æ‰€ä»¥ $\sqrt n$ ä¸ºä¸Šç•Œï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ $\lfloor \frac{n}{x}\rfloor $ è®°å¿†åŒ–æ‰€æœ‰çš„ $x$ ã€‚</p>
<p>åŒæ—¶ï¼Œå‘ç°å¯¹äº $x$ çš„è°ƒç”¨ï¼Œéƒ½åªä¼šæ˜¯ </p>
<script type="math/tex; mode=display">
1,2,3\dots \sqrt n,\lfloor{\frac{n}{1}}\rfloor,\lfloor{\frac{n}{2}}\rfloor,\lfloor{\frac{n}{3}}\rfloor\dots\lfloor{\frac{n}{\sqrt n}}\rfloor</script><p>è¿™äº›æ•°ï¼Œä¸”æ¯æ¬¡è®¡ç®— $\mathbf{S}$ çš„å¤æ‚åº¦éƒ½æ˜¯ $\sqrt n$ ã€‚æ‰€ä»¥æœ€ç»ˆå¤æ‚åº¦æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
O\left(\sum_{i=1}^{\sqrt{n}} \sqrt{i}+\sum_{i=1}^{\sqrt{n}} \sqrt{\left\lfloor\frac{n}{i}\right\rfloor}\right)=O\left(\sum_{i=1}^{\sqrt{n}} \sqrt{\left\lfloor\frac{n}{i}\right\rfloor}\right)=O\left(\int_{1}^{\sqrt{n}} \sqrt{\frac{n}{x}} \mathrm{d} x\right)=O\left(n^{\frac{3}{4}}\right)</script><p>å…¶å®å°±æ˜¯ä¸¤æ­¥è¿‘ä¼¼ã€‚</p>
<p>ç„¶è€Œå¯ä»¥åšåˆ°æ›´ä¼˜ï¼Œå³å‘ç°å¯¹äºä¸€äº›å¾ˆå°çš„ $nâ€™$ ï¼Œå®Œå…¨å¯ä»¥ç›´æ¥é¢„å¤„ç†å‡ºæ¥ã€‚æ‰€ä»¥å‡è®¾å¯¹äºå‰ $p(0&lt;p&lt;1)$ çš„ $\mathbf S$ ç›´æ¥é¢„å¤„ç†ï¼Œé‚£ä¹ˆå¤æ‚åº¦ä¼šå˜æˆï¼š</p>
<script type="math/tex; mode=display">
O\left(n^{p}+\sum_{i=1}^{n^{1-p}} \sqrt{\left\lfloor\frac{n}{i}\right\rfloor}\right)=O\left(n^{p}+\int_{1}^{n^{1-p}} \sqrt{\frac{n}{x}} \mathrm{d} x\right)=O\left(n^{p}+n^{1-\frac{1}{2} p}\right)</script><p>å‘ç°æ­¤æ—¶å– $p=\frac{2}{3}$ ä¸ºæœ€ä¼˜ï¼Œæ‰€ä»¥å¤æ‚åº¦ $O(n^{\frac{2}{3}})$ã€‚</p>
<p>è‰ï¼Œæ®è¯´è¿™ä¸œè¥¿æ˜¯ xudyh åœ¨è€ƒåœºä¸Šæ„é€ å‡ºæ¥çš„ï¼Œè¿™ä¹Ÿå¤ªç¥äº†å§â€¦</p>
<h1 id="1-ä¾‹é¢˜"><a href="#1-ä¾‹é¢˜" class="headerlink" title="$1$ ä¾‹é¢˜"></a>$1$ ä¾‹é¢˜</h1><h2 id="LG4213-ã€æ¨¡æ¿ã€‘æœæ•™ç­›ï¼ˆSumï¼‰"><a href="#LG4213-ã€æ¨¡æ¿ã€‘æœæ•™ç­›ï¼ˆSumï¼‰" class="headerlink" title="LG4213 ã€æ¨¡æ¿ã€‘æœæ•™ç­›ï¼ˆSumï¼‰"></a>LG4213 ã€æ¨¡æ¿ã€‘æœæ•™ç­›ï¼ˆSumï¼‰</h2><blockquote>
<p>æ±‚</p>
<script type="math/tex; mode=display">
\begin{aligned}
&a n s_{1}=\sum_{i=1}^{n} \varphi(i)\\
&a n s_{2}=\sum_{i=1}^{n} \mu(i)
\end{aligned}</script><p>$1\leq n\leq 2\times 10^9$</p>
</blockquote>
<p>è€ƒè™‘æœæ•™ç­›ã€‚</p>
<p>è€ƒè™‘å¦‚ä½•æ„é€  $\varphi$ çš„ $g$ ã€‚å‘ç°æœ‰ $\sum_{d|n}\varphi(d)=n$ï¼Œå³ $\varphi <em> \mathbf{1}=\bf Id$ï¼Œé‚£ä¹ˆ $\bf f</em>g$ å°±æ˜¯ $\frac{n\cdot (n+1)}{2}$ã€‚</p>
<p>è€ƒè™‘å¦‚ä½•æ„é€  $\mu$ çš„ $g$ ã€‚å‘ç°æœ‰ $\sum_{d|n}\mu(d)=[n=1]$ï¼Œå³ $\mu <em> \bf 1 = Ïµ$ï¼Œé‚£ä¹ˆ $\bf f</em>g$ å°±æ˜¯ $[n=1]$ã€‚</p>
<p>ç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚å»å¹´ $6$ æœˆæˆ‘å†™çš„æ˜¯ä¸å¸¦è®°å¿†åŒ–çš„ï¼Œæ…¢çš„å¾ˆã€‚ä»Šå¤©é‡å†™åŠ äº†è®°å¿†åŒ–ï¼Œå¤æ‚åº¦çœ‹èµ·æ¥è¿˜å¯ä»¥ï¼Ÿä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥è¢« <code>min_25</code> åŠç€é”¤ã€‚(å…¶å®ä¹Ÿå°±å¿«ä¸€ç‚¹</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXS 100010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 5200010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; </span><br><span class="line"><span class="keyword">int</span> T, N, S ; </span><br><span class="line"><span class="keyword">bool</span> chk[MAXN] ; </span><br><span class="line">LL phi[MAXN], Mu[MAXN] ; </span><br><span class="line">LL Smu[MAXS], Sphi[MAXS] ;</span><br><span class="line"><span class="keyword">int</span> pr[MAXN], t, i, j, x ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	chk[<span class="number">0</span>] = chk[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">	Mu[<span class="number">1</span>] = <span class="number">1</span>, phi[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt; MAXN ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (!chk[i]) </span><br><span class="line">      pr[++ t] = i, Mu[i] = <span class="number">-1</span>, phi[i] = i - <span class="number">1</span> ; </span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= t &amp;&amp; pr[j] * i &lt; MAXN ; ++ j)&#123;</span><br><span class="line">			chk[i * pr[j]] = <span class="number">1</span> ; </span><br><span class="line">			<span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) &#123; </span><br><span class="line">        phi[i * pr[j]] = phi[i] * pr[j] ; </span><br><span class="line">        <span class="keyword">break</span> ; </span><br><span class="line">      &#125;</span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">      	Mu[i * pr[j]] = - Mu[i],</span><br><span class="line">        phi[i * pr[j]] = phi[i] * phi[pr[j]] ;</span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; MAXN ; ++ i) Mu[i] = Mu[i - <span class="number">1</span>] + Mu[i], phi[i] = phi[i - <span class="number">1</span>] + phi[i] ;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">get_Mu</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (p &lt; MAXN) <span class="keyword">return</span> Mu[p] ;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= S &amp;&amp; Smu[p]) <span class="keyword">return</span> Smu[p] ; </span><br><span class="line">    <span class="keyword">if</span> (p &gt; S &amp;&amp; Smu[N / p]) <span class="keyword">return</span> Smu[N / p] ;</span><br><span class="line"></span><br><span class="line">    LL ret = <span class="number">1L</span>L ; rr <span class="keyword">int</span> l, r ;</span><br><span class="line">	<span class="keyword">for</span> (l = <span class="number">2</span> ; l &lt;= p ; l = r + <span class="number">1</span>) </span><br><span class="line">        r = (p / (p / l)), ret -= (r - l + <span class="number">1</span>) * get_Mu(p / l) ; </span><br><span class="line">    <span class="keyword">return</span> (p &gt; S ? (Smu[N / p] = ret) : (Smu[p] = ret)); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">get_phi</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (p &lt; MAXN) <span class="keyword">return</span> phi[p] ; </span><br><span class="line">    <span class="keyword">if</span> (p &lt;= S &amp;&amp; Sphi[p]) <span class="keyword">return</span> Sphi[p] ; </span><br><span class="line">    <span class="keyword">if</span> (p &gt; S &amp;&amp; Sphi[N / p]) <span class="keyword">return</span> Sphi[N / p] ;</span><br><span class="line"></span><br><span class="line">    LL ret = <span class="number">1l</span>l * (<span class="number">1</span> + p) * p / <span class="number">2L</span>L ; rr <span class="keyword">int</span> l, r ;</span><br><span class="line">	<span class="keyword">for</span> (l = <span class="number">2</span> ; l &lt;= p ; l = r + <span class="number">1</span>) </span><br><span class="line">        r = (p / (p / l)), ret -= (r - l + <span class="number">1</span>) * get_phi(p / l) ; </span><br><span class="line">    <span class="keyword">return</span> (p &gt; S ? (Sphi[N / p] = ret) : (Sphi[p] = ret)); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T, init() ;</span><br><span class="line">	<span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; N, S = <span class="built_in">sqrt</span>(N) ;</span><br><span class="line">        <span class="built_in">memset</span>(Smu, <span class="number">0</span>, <span class="keyword">sizeof</span>(Smu)) ;</span><br><span class="line">        <span class="built_in">memset</span>(Sphi, <span class="number">0</span>, <span class="keyword">sizeof</span>(Sphi)) ; </span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; get_phi(N) &lt;&lt; <span class="string">" "</span> &lt;&lt; get_Mu(N) &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-é«˜çº§åº”ç”¨"><a href="#3-é«˜çº§åº”ç”¨" class="headerlink" title="$3$ é«˜çº§åº”ç”¨"></a>$3$ é«˜çº§åº”ç”¨</h1><p> é«˜çº§åº”ç”¨ï¼šæˆ‘ä¸æ˜¯å¾ˆä¼šçš„åº”ç”¨ï¼ˆ</p>
<blockquote>
<p>æ±‚</p>
<script type="math/tex; mode=display">
\left(\sum_{i=1}^{n} \sum_{j=1}^{n} i \cdot j \cdot \operatorname{gcd}(i, j)\right) \bmod p</script><p>$p\in \mathbb{P},1\leq n\leq 10^{10}$ .</p>
</blockquote>
<p>é¦–å…ˆæ˜¯æœ´ç´ åæ¼”ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum_{i=1}^{n} \sum_{j=1}^{n} i\cdot j\cdot \operatorname{gcd}(i, j)\\
=&\sum_{i=1}^n\sum_{j=1}^ni\cdot j\cdot\sum_{d|i\operatorname{and}d|j} \varphi(d)\\
=&\sum_{d=1}^n\varphi(d)\cdot d^2\cdot \sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\sum_{j=1}^{\lfloor\frac{n}{d}\rfloor}i\cdot j\\
=&\sum_{d=1}^n\varphi(d)\cdot d^2\cdot \left(\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}i\right)^2\\
\end{aligned}</script><p>ç„¶åå‘ç°å‰é¢éƒ½æ˜¯å®Œå…¨ç§¯æ€§ï¼Œåé¢é‚£ä¸ªå¹³æ–¹é‡Œé¢è¿˜å¸¦ç€æ±‚å’Œä¸æ˜¯å¾ˆå¥½æâ€¦</p>
<p>è¿™ä¸ªåœ°æ–¹æœ‰ä¸ªå¾ˆç‰›çš„å¼•ç†ï¼š</p>
<script type="math/tex; mode=display">
\left(\sum_{i=1}^xi\right)^2=\sum_{i=1}^{x}i^3</script><p>è¿™ä¸œè¥¿å¤§æ¦‚æ˜¯èƒ½å½’çº³å‡ºæ¥çš„ã€‚ä¼¼ä¹è¿˜æ²¡æœ‰ä»€ä¹ˆæ¯”è¾ƒæœ‰è¶£çš„è¯æ˜<del>çº¦ç­‰äºåªèƒ½é€‰æ‹©èƒŒè¿‡</del></p>
<p>ç„¶åå°±æ˜¯</p>
<script type="math/tex; mode=display">
\sum_{d=1}^n\varphi(d)\cdot d^2\cdot \sum_{p=1}^{\lfloor\frac{n}{d}\rfloor}p^3</script><p><del>å‘ç°éƒ½æ¯”è¾ƒå®¹æ˜“ç®—ï¼Œå¹¶ä¸”éƒ½ç§¯æ€§ï¼Œäºæ˜¯å°±å¯ä»¥ç›´æ¥æœæ•™ç­›äº†ã€‚</del></p>
<p>ä¸Šå¥è¯åœ¨æ‰¯ $p$ã€‚åé¢é‚£ä¸€å¨æ ¹æœ¬æ²¡æ³•ç­›ã€‚äºæ˜¯è€ƒè™‘æ•´é™¤åˆ†å—å¥—ä¸€ä¸ªæœæ•™ç­›ã€‚è¿™æ ·å¤æ‚åº¦è¿˜æ˜¯ $n^{\frac{2}{3}}$ ï¼ï¼è¿™ç‚¹å¾ˆé‡è¦ï¼ï¼å› ä¸ºæœ¬è´¨ä¸Šæˆ‘çš„æ•´é™¤åˆ†å—è¿˜æ˜¯åœ¨æšä¸¾æŸäº› $\lfloor\frac{\lfloor\frac{n}{l}\rfloor}{x}\rfloor$ã€‚äºæ˜¯è¯¥è®°ä¸‹æ¥çš„ä¸å¤šä¸å°‘ï¼Œè¿˜æ˜¯è®°ä¸‹æ¥äº†ï¼Œå¤æ‚åº¦ä¸å˜ã€‚</p>
<p>ä»£ç å®ç°æœ‰ç‚¹ç»†èŠ‚ï¼Œè¿˜éœ€è¦å¤šå­¦ä¹ å¤šç§¯ç´¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 100100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXNN 10000100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>&lt;LL, LL&gt; pq ;</span><br><span class="line"><span class="keyword">bool</span> vis[MAXNN], chk[MAXN] ;</span><br><span class="line">LL Inv6, Inv4, cnt, p[MAXNN] ;</span><br><span class="line">LL P ; LL N, Sp[MAXN], phi[MAXNN] ;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">expow</span><span class="params">(LL a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            (res *= a) %= P ;</span><br><span class="line">        (a *= a) %= P, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">calc</span><span class="params">(LL l, LL r)</span></span>&#123;</span><br><span class="line">    l -- ; l %= P, r %= P ;</span><br><span class="line">    LL r1 = r * (r + <span class="number">1</span>) % P * (<span class="number">2</span> * r + <span class="number">1</span>) % P * Inv6 % P ;</span><br><span class="line">    LL r2 = l * (l + <span class="number">1</span>) % P * (<span class="number">2</span> * l + <span class="number">1</span>) % P * Inv6 % P ;</span><br><span class="line">    <span class="keyword">return</span> ((r1 - r2) % P + P) % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">calcc</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    LL ans ; x %= P ;</span><br><span class="line">    ans = x * x % P ;</span><br><span class="line">    (ans *= Inv4) %= P ;</span><br><span class="line">    (ans *= (x + <span class="number">1</span>) % P * (x + <span class="number">1</span>) % P) %= P ;</span><br><span class="line">    <span class="keyword">return</span> ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">solve</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; MAXNN)</span><br><span class="line">        <span class="keyword">return</span> phi[x] ;</span><br><span class="line">    LL y = N / x ;</span><br><span class="line">    <span class="keyword">if</span> (chk[y]) <span class="keyword">return</span> Sp[y] ;</span><br><span class="line">    chk[y] = <span class="number">1</span> ; LL &amp;ans = Sp[y] ;</span><br><span class="line">    ans = calcc(x) ;</span><br><span class="line">    <span class="keyword">for</span> (LL l = <span class="number">2</span>, r ; l &lt;= x ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">        r = x / (x / l),</span><br><span class="line">        (ans -= calc(l, r) * solve(x / l) % P) %= P ;</span><br><span class="line">        <span class="keyword">if</span> (ans &lt; <span class="number">0</span>) ans += P ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//	cout &lt;&lt; ans &lt;&lt; endl ; </span></span><br><span class="line">    <span class="keyword">return</span> Sp[y] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">work</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (LL l = <span class="number">1</span>, r ; l &lt;= x ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">        r = x / (x / l) ;</span><br><span class="line">        (res += (solve(r) - solve(l - <span class="number">1</span>)) * calcc(x / l) % P) %= P ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (res % P + P) % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; P &gt;&gt; N ; phi[<span class="number">1</span>] = vis[<span class="number">0</span>] = vis[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    Inv4 = expow(<span class="number">4</span>, P - <span class="number">2</span>), Inv6 = expow(<span class="number">6</span>, P - <span class="number">2</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt; MAXNN ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">            p[++ cnt] = i, phi[i] = i - <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (p[j] * i &gt;= MAXNN) <span class="keyword">break</span> ;</span><br><span class="line">            vis[p[j] * i] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                phi[i * p[j]] = phi[i] * p[j] % P ;</span><br><span class="line">                <span class="keyword">break</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> phi[i * p[j]] = phi[i] * phi[p[j]] % P ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; MAXNN ; ++ i) </span><br><span class="line">      (phi[i] = <span class="number">1l</span>l * i * i % P * phi[i] + phi[i - <span class="number">1</span>]) %= P ;</span><br><span class="line">	<span class="comment">//cout &lt;&lt; phi[8000000] &lt;&lt; endl ; </span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, work(N)) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>æœæ•™ç­›</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°æ±‚å’Œ/æœæ•™ç­›</tag>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°/æ¬§æ‹‰åæ¼”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘loj#2353 [NOI2007]è´§å¸å…‘æ¢</title>
    <url>/2020/01/24/%E8%B4%A7%E5%B8%81%E5%85%91%E6%8D%A2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æŸCDQå¥½é¢˜.</p>
<p><del>æ²¡äººçœ‹å‡ºä¸Šé¢è¿™å¥è¯æ˜¯æœ‰ä¿©å«ä¹‰å—</del></p>
<a id="more"></a>
<p>å°Yæœ€è¿‘åœ¨ä¸€å®¶é‡‘åˆ¸äº¤æ˜“æ‰€å·¥ä½œã€‚è¯¥é‡‘åˆ¸äº¤æ˜“æ‰€åªå‘è¡Œäº¤æ˜“ä¸¤ç§é‡‘åˆ¸ï¼š$A$ çºªå¿µåˆ¸ï¼ˆä»¥ä¸‹ç®€ç§° $A$ åˆ¸ï¼‰å’Œ $B$ çºªå¿µåˆ¸ï¼ˆä»¥ä¸‹ç®€ç§° $B$ åˆ¸ï¼‰ã€‚æ¯ä¸ªæŒæœ‰é‡‘åˆ¸çš„é¡¾å®¢éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„å¸æˆ·ã€‚é‡‘åˆ¸çš„æ•°ç›®å¯ä»¥æ˜¯ä¸€ä¸ªå®æ•°ã€‚</p>
<p>æ¯å¤©éšç€å¸‚åœºçš„èµ·ä¼æ³¢åŠ¨ï¼Œä¸¤ç§é‡‘åˆ¸éƒ½æœ‰è‡ªå·±å½“æ—¶çš„ä»·å€¼ï¼Œå³æ¯ä¸€å•ä½é‡‘åˆ¸å½“å¤©å¯ä»¥å…‘æ¢çš„äººæ°‘å¸æ•°ç›®ã€‚æˆ‘ä»¬è®°å½•ç¬¬ $K$ å¤©ä¸­ $A$ åˆ¸å’Œ $B$ åˆ¸çš„ä»·å€¼åˆ†åˆ«ä¸º $A_K$ å’Œ $B_K$ ï¼ˆå…ƒ/å•ä½é‡‘åˆ¸ï¼‰ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿é¡¾å®¢ï¼Œé‡‘åˆ¸äº¤æ˜“æ‰€æä¾›äº†ä¸€ç§éå¸¸æ–¹ä¾¿çš„äº¤æ˜“æ–¹å¼ï¼šæ¯”ä¾‹äº¤æ˜“æ³•ã€‚</p>
<p>æ¯”ä¾‹äº¤æ˜“æ³•åˆ†ä¸ºä¸¤ä¸ªæ–¹é¢ï¼š</p>
<p>a) å–å‡ºé‡‘åˆ¸ï¼šé¡¾å®¢æä¾›ä¸€ä¸ª $[0ï¼Œ100]$ å†…çš„å®æ•° $\rm OP$ ä½œä¸ºå–å‡ºæ¯”ä¾‹ï¼Œå…¶æ„ä¹‰ä¸ºï¼šå°† $\rm OP\%$ çš„ $A$ åˆ¸å’Œ $\rm OP\%$ çš„ $B$ åˆ¸ä»¥å½“æ—¶çš„ä»·å€¼å…‘æ¢ä¸ºäººæ°‘å¸ï¼›</p>
<p>b) ä¹°å…¥é‡‘åˆ¸ï¼šé¡¾å®¢æ”¯ä»˜ $\rm IP$ å…ƒäººæ°‘å¸ï¼Œäº¤æ˜“æ‰€å°†ä¼šå…‘æ¢ç»™ç”¨æˆ·æ€»ä»·å€¼ä¸º $\rm IP$ çš„é‡‘åˆ¸ï¼Œå¹¶ä¸”ï¼Œæ»¡è¶³æä¾›ç»™é¡¾å®¢çš„ $A$ åˆ¸å’Œ $B$ åˆ¸çš„æ¯”ä¾‹åœ¨ç¬¬ $K$ å¤©æ°å¥½ä¸º $\rm Rate_K$ ï¼›</p>
<p>å° Y æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç»æµå¤´è„‘çš„å‘˜å·¥ï¼Œé€šè¿‡è¾ƒé•¿æ—¶é—´çš„è¿ä½œå’Œè¡Œæƒ…æµ‹ç®—ï¼Œä»–å·²ç»çŸ¥é“äº†æœªæ¥ $\rm N$ å¤©å†…çš„ $A$ åˆ¸å’Œ $B$ åˆ¸çš„ä»·å€¼ä»¥åŠ $\rm Rate$ã€‚ä»–è¿˜å¸Œæœ›èƒ½å¤Ÿè®¡ç®—å‡ºæ¥ï¼Œå¦‚æœå¼€å§‹æ—¶æ‹¥æœ‰ $\rm S$ å…ƒé’±ï¼Œé‚£ä¹ˆ $\rm N$ å¤©åæœ€å¤šèƒ½å¤Ÿè·å¾—å¤šå°‘å…ƒé’±ã€‚</p>
<p>å…¶ä¸­ $\rm N\leq 10^5$.</p>
<p>é¦–å…ˆæƒ³åˆ° $dp$ ã€‚è¿™ä¸ªåœ°æ–¹è®¾è®¡çš„ $dp$ ä¸ªäººæ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒ $\rm tricky$ çš„ã€‚å‘ç°æœ¬è´¨ä¸Šæœ€å¤§åŒ– $A$ åˆ¸æˆ–è€… $B$ åˆ¸çš„æ•°é‡å’Œæœ€å¤§åŒ–æ‰‹é‡Œæ‹¿åˆ°çš„rmbéƒ½æ˜¯æŸäº›æœ€ä¼˜å†³ç­–ï¼Œæ‰€ä»¥ä¸èƒ½ä¸€èµ·ç»´æŠ¤ã€‚</p>
<p>å‘ç°é€šè¿‡åˆ¸æ¥ç»´æŠ¤rmbæ¯”è¾ƒæ–¹ä¾¿ï¼Œäºæ˜¯è€ƒè™‘è®¾ $f_i$ è¡¨ç¤ºåœ¨ç¬¬ $i$ å¤©æŠŠrmbéƒ½èŠ±å®Œèƒ½å¾—åˆ°å¤šå°‘ $A$ åˆ¸ã€‚åˆå€¼æ˜¾ç„¶æ˜¯</p>
<script type="math/tex; mode=display">
m=f_1\cdot A_1+\frac{f_1\cdot B_1}{\rm Rate_1}\\
f_1=\frac{m\cdot\mathrm{Rate_1}}{A_1\cdot \mathrm{Rate_1}+B_1}</script><p>é‚£ä¹ˆè€ƒè™‘å¦‚ä½•ä»¥æ­¤è®¡ç®—rmbã€‚å‘ç°ç¬¬ $i$ å¤©å¯èƒ½ä¼šä¿æœ‰ $1\sim i-1$ å¤©æ—¶çš„é‡‘åˆ¸ã€‚äºæ˜¯ä»¤ $g_i$ è¡¨ç¤ºå‰ $i$ å¤©çš„æœ€å¤§è·åˆ©ï¼Œå‘ç°å¯ä»¥è¿™ä¹ˆè½¬ç§»ï¼š</p>
<script type="math/tex; mode=display">
g_i=\max_{1\leq j<i}(g_{i-1},f_j\cdot (A_i+\frac{B_i}{\rm Rate_j}))</script><p>è½¬ç§»çš„æ­£ç¡®æ€§åœ¨äºï¼Œå–å‡ºçš„ $A$ åˆ¸å’Œ $B$ åˆ¸çš„ç™¾åˆ†æ¯”å¿…é¡»ä¸€è‡´ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°åˆ†å¤šæ¬¡å–çš„æƒ…å†µã€‚äºæ˜¯å–œæä¸€ä¸ª $n^2$ ç®—æ³•ã€‚</p>
<p>è€ƒè™‘ä¼˜åŒ–ã€‚å‘ç°å¦‚æœå¯¹äºä¸€ä¸ª $i$ å…¶è½¬ç§»ç‚¹ä¸º $j$ï¼Œé‚£ä¹ˆä¼šæœ‰ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
g_i&=f_j\cdot A_i+f_j\cdot \frac{B_i}{\rm Rate_j}\\
\frac{f_j}{\mathrm{Rate_j}}&=-\frac{A_i}{B_i}\cdot f_j+\frac{g_i}{B_i}
\end{aligned}</script><p>å‘ç°å¯ä»¥ä»¤ $y_i=\frac{f_i}{\mathrm{Rate_i}},x_i=f_i$ ã€‚é‚£ä¹ˆè¿™å°±æ˜¯ä¸€ä¸ªæ–œç‡ä¼˜åŒ–çš„æ ‡å‡†å½¢å¼ã€‚</p>
<p>ä½†é—®é¢˜åœ¨äºï¼Œ$f_j$ å¾ˆæ‚²æƒ¨çš„ç”±äºæ¯å¤©çš„å…‘æ¢é‡æœ‰ä¸åŒï¼Œå®ƒå¹¶ä¸å•å¢ï¼Œå¹¶ä¸”æ–œç‡ä¹Ÿä¸å•å¢ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨åˆ é™¤æœ«å°¾å‡ ä¸ªï¼ˆå³å•è°ƒé˜Ÿåˆ—ï¼‰æ¥ç»´æŠ¤å‡¸å£³ï¼Œå¿…é¡»è¦ç”¨æŸäº›ç¥ç§˜ $\rm splay$ æŠ€å·§æ¥åŠ é€Ÿè¿™ä¸ªè¿‡ç¨‹ã€‚</p>
<p>ç„¶è€Œè¿˜æœ‰å¦ä¸€ç§ $\rm CDQ$ å†™æ³•ã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘ä¸ºäº†ä¿è¯æ¨ªåæ ‡æ˜¯å•è°ƒçš„ï¼Œæ‰€ä»¥è¦æ’åºï¼Œä½†æ˜¯æ’åºä¹‹åè½¬ç§»å°±ä¼šå¤±ç§©ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹æ˜¾ç„¶å¯ä»¥ $\rm CDQ$ æ¥ä¼˜åŒ–ï¼Œäºæ˜¯å°±æ²¡äº†ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæœ´ç´ çš„ $\rm CDQ$ ç”±äºä¸éœ€è¦ä¸¥æ ¼æŒ‰ç§©ï¼Œå³äºŒè¿›åˆ¶æ‹†åˆ†é¡ºåºä¸é™ï¼Œæ‰€ä»¥å¯ä»¥çåˆ†æ²»ã€‚ä½†æ˜¯ç»´æŠ¤ $dp$ çš„æ—¶å€™ç”±äºè½¬ç§»é¡ºåºå¿…é¡»æŒ‰ç§©ï¼Œæ‰€ä»¥æœ‰ä¸¥æ ¼çš„åˆ†æ²»é¡ºåºã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Cash</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y, k ;</span><br><span class="line">    <span class="keyword">double</span> A, B, R ; <span class="keyword">int</span> ID ;</span><br><span class="line">&#125;T[MAXN], Div[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N ; <span class="keyword">double</span> M ; <span class="keyword">double</span> dp[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> DP&#123;</span><br><span class="line">    <span class="keyword">double</span> Ans, t ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Solve1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Ans = M, dp[<span class="number">1</span>] = M * T[<span class="number">1</span>].R / (T[<span class="number">1</span>].A * T[<span class="number">1</span>].R + T[<span class="number">1</span>].B) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; i ; ++ j)</span><br><span class="line">                Ans = max(Ans, dp[j] * T[i].A + dp[j] / T[j].R * T[i].B) ;</span><br><span class="line">            dp[i] = Ans * T[i].R / (T[i].A * T[i].R + T[i].B) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.3lf\n"</span>, Ans) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> CDQ&#123;</span><br><span class="line">    <span class="keyword">int</span> stk[MAXN] ; <span class="keyword">const</span> <span class="keyword">double</span> INF = <span class="number">1e9</span>, eps = <span class="number">1e-6</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Compare</span><span class="params">(<span class="keyword">const</span> Cash &amp; A, <span class="keyword">const</span> Cash &amp; B)</span></span>&#123; <span class="keyword">return</span> A.k &lt; B.k ;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">getr</span><span class="params">(<span class="keyword">int</span> d, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(T[d].x - T[b].x) &lt;= eps) <span class="keyword">return</span> INF ;</span><br><span class="line">        <span class="keyword">return</span> (T[d].y - T[b]. y) / (T[d].x - T[b].x) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Merge_sort</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> Mid)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = L, r = Mid + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = L ; i &lt;= R ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (l &lt;= Mid &amp;&amp; (r &gt; R || T[l].x &lt; T[r].x))</span><br><span class="line">        Div[i] = T[l ++]; <span class="keyword">else</span> Div[i] = T[r ++] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = L ; i &lt;= R ; ++ i) T[i] = Div[i] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dp_CDQ</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (L == R)&#123;</span><br><span class="line">            dp[L] = max(dp[L], dp[L - <span class="number">1</span>]) ;<span class="comment">//?</span></span><br><span class="line">            T[L].y = dp[L] / (T[L].A * T[L].R + T[L].B), T[L].x = T[L].y * T[L].R ;</span><br><span class="line">            <span class="keyword">return</span> ; <span class="comment">//y : f[j] / Rate[j], x : f[j]ã€‚æ­¤å¤„åº”è¯¥ä»¥f[j]å•å¢æ¥æ’åº</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> Mid = (L + R) &gt;&gt; <span class="number">1</span>, l = L - <span class="number">1</span>, r = Mid ; <span class="keyword">int</span> top = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (rr <span class="keyword">int</span> i = L ; i &lt;= R ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (T[i].ID &lt;= Mid) Div[++ l] = T[i] ; <span class="keyword">else</span> Div[++ r] = T[i] ;</span><br><span class="line">        <span class="keyword">for</span> (rr <span class="keyword">int</span> i = L ; i &lt;= R ; ++ i) T[i] = Div[i] ; dp_CDQ(L, Mid) ; <span class="comment">// 2</span></span><br><span class="line">        <span class="keyword">for</span> (rr <span class="keyword">int</span> i = L ; i &lt;= Mid ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; getr(stk[top], stk[top - <span class="number">1</span>]) &lt; getr(stk[top], i)) -- top ;</span><br><span class="line">            stk[++ top] = i ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (rr <span class="keyword">int</span> i = Mid + <span class="number">1</span> ; i &lt;= R ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; getr(stk[top], stk[top - <span class="number">1</span>]) &lt;= T[i].k) -- top ;</span><br><span class="line">            dp[T[i].ID] = max(dp[T[i].ID], T[stk[top]].x * T[i].A + T[stk[top]].y * T[i].B) ;</span><br><span class="line">        &#125;</span><br><span class="line">        dp_CDQ(Mid + <span class="number">1</span>, R), Merge_sort(L, R, Mid) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Solve2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        dp[<span class="number">0</span>] = M ;</span><br><span class="line">          sort(T + <span class="number">1</span>, T + N + <span class="number">1</span>, Compare) ;</span><br><span class="line">          dp_CDQ(<span class="number">1</span>, N) ; <span class="built_in">printf</span>(<span class="string">"%.3lf\n"</span>, dp[N]) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//     freopen("1492.in", "r", stdin) ;</span></span><br><span class="line"><span class="comment">//     freopen("1492.out", "w", stdout) ;</span></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>, &amp;T[i].A, &amp;T[i].B, &amp;T[i].R),</span><br><span class="line">      T[i].k = -T[i].A / T[i].B, T[i].ID = i ;</span><br><span class="line">    <span class="keyword">if</span> (N &lt;= <span class="number">5000</span>) DP :: Solve1() ;</span><br><span class="line">      <span class="keyword">else</span> CDQ :: Solve2() ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>loj</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/æ™®é€šDP</tag>
        <tag>åŠ¨æ€è§„åˆ’/æ–œç‡ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘CDQåˆ†æ²»</title>
    <url>/2020/01/24/CDQ%E5%88%86%E6%B2%BB/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚æ˜¯å¯¹æ“ä½œåˆ†æ²»çš„ç®—æ³•ï¼Œç®—æ˜¯æˆ‘æœ€æ—©å­¦è¿‡çš„ç¦»çº¿åˆ†æ²»ç®—æ³•äº†ï¼Ÿ</p>
<p>å¤§é¢˜æ€æƒ³å°±æ˜¯è€ƒè™‘å¯¹æ“ä½œåˆ†æ²»ï¼Œæ¯æ¬¡ç»Ÿè®¡å·¦è¾¹ä¸€åŠçš„ä¿®æ”¹å¯¹å³è¾¹è¯¢é—®çš„å½±å“ï¼Œç±»ä¼¼äºäºŒè¿›åˆ¶æ‹†åˆ†ï¼Œä½¿å¾—æ¯ä¸ªè¯¢é—®çš„ç­”æ¡ˆç»Ÿè®¡å¯ä»¥åˆ†æˆä¸åŒçš„å‡ å—ã€‚</p>
<p>é‚£ä¹ˆå¤æ‚åº¦å°±æ˜¯ $T(n)=2T(\frac{n}{2})+O(n\log^kn)$ ï¼Œè§£å¾— $T(n)=O(n\log ^{k+1}n)$ ã€‚ </p>
<a id="more"></a>
<h1 id="loj-112-æ¨¡æ¿-ä¸‰ç»´ååº"><a href="#loj-112-æ¨¡æ¿-ä¸‰ç»´ååº" class="headerlink" title="loj#112 [æ¨¡æ¿]ä¸‰ç»´ååº"></a>loj#112 [æ¨¡æ¿]ä¸‰ç»´ååº</h1><blockquote>
<p>æœ‰ $n$ ä¸ªå…ƒç´ ï¼Œç¬¬ $i$ ä¸ªå…ƒç´ æœ‰ $a_i$ã€$b_i$ã€$c_i$ä¸‰ä¸ªå±æ€§ã€‚</p>
<p>è®¾ $f_i$ è¡¨ç¤ºæ»¡è¶³ $a_j\leq a_i$ ä¸” $b_j\leq b_i$ ä¸” $c_j\leq c_i$ çš„ $j$ çš„æ•°é‡ã€‚</p>
<p>å¯¹äº $\forall i \in [0,n)$ ï¼Œæ±‚ $f_j=i$ çš„ $j$ çš„æ•°é‡ã€‚</p>
</blockquote>
<p>è¿™ä¸æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ $\rm CDQ$ ã€‚è€ƒè™‘ $\rm CDQ$ åœ¨ç»´æŠ¤æœ¬è´¨ä¸Šæ˜¯åœ¨ç»´æŠ¤ä¸€ç³»åˆ—æƒå€¼ï¼Œé€šè¿‡åˆ†æ²»ç»Ÿè®¡å‰é¢å¯¹åé¢çš„è´¡çŒ®ï¼Œç±»ä¼¼äºé€šè¿‡åˆ†æ²»å¯¹å…¨å±€çš„è¯¢é—®åšæ—¶é—´ä¸Šçš„äºŒè¿›åˆ¶æ‹†åˆ†ã€‚æ‰€ä»¥å…¶å®å…·æœ‰ç±»ä¼¼æ‹†åˆ†æ€§è´¨çš„ç»Ÿè®¡éƒ½å¯ä»¥è¿™ä¹ˆå®ç°ã€‚</p>
<p>å›åˆ°è¿™é¢˜ï¼Œå‘ç°æœ¬è´¨ä¸Šä¸‰ç»´æ•°ç‚¹ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ $\rm CDQ$ è§£å†³ã€‚è€ƒè™‘åœ¨åˆ†æ²»å®Œåï¼Œéœ€è¦ç»Ÿè®¡æœ¬å±‚å·¦åŒºé—´å¯¹å³åŒºé—´çš„è´¡çŒ®ã€‚è¿™æ—¶ç›´æ¥bit+æ‰«æçº¿å³å¯ï¼Œå³æŒ‰ç…§ä¸€ç»´æ’åºï¼Œå¦ä¸€ç»´ç”¨bitç»´æŠ¤ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 200010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> low(x) (x &amp; (-x))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">int</span> N, K, bit[MAXN], res[MAXN] ; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">nodes</span>&#123;</span> <span class="keyword">int</span> x, y, z, ans ; &#125;base[MAXN], t[MAXN] ;</span><br><span class="line">il <span class="keyword">bool</span> <span class="keyword">operator</span> == (nodes a, nodes b)&#123;</span><br><span class="line">	<span class="keyword">return</span> (a.x == b.x) &amp; (a.y == b.y) &amp; (a.z == b.z) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> c = getchar() ; <span class="keyword">int</span> res = <span class="number">0</span>, fg = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) &#123; <span class="keyword">if</span> (c == <span class="string">'-'</span>) fg = <span class="number">-1</span> ; c = getchar() ;&#125;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) res = (res &lt;&lt; <span class="number">1</span>) + (res &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">	<span class="keyword">return</span> res * fg ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp1</span><span class="params">(nodes a, nodes b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.x == b.x ? (a.y == b.y ? a.z &lt; b.z : a.y &lt; b.y) : a.x &lt; b.x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp2</span><span class="params">(nodes a, nodes b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.y == b.y ? a.z &lt; b.z : a.y &lt; b.y ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> ( ; p &lt;= K ; p += low(p)) bit[p] += v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qry</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> ( ; p ; p -= low(p)) ret += bit[p] ; </span><br><span class="line">	<span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cdq</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L &gt;= R) <span class="keyword">return</span> ; </span><br><span class="line">	<span class="keyword">int</span> Mid = (L + R) &gt;&gt; <span class="number">1</span>, l, r ; </span><br><span class="line">	cdq(L, Mid), cdq(Mid + <span class="number">1</span>, R) ;  </span><br><span class="line">	sort(base + L, base + Mid + <span class="number">1</span>, comp2), l = L ;</span><br><span class="line">	sort(base + Mid + <span class="number">1</span>, base + R + <span class="number">1</span>, comp2), r = Mid + <span class="number">1</span> ; </span><br><span class="line">	<span class="keyword">while</span> (r &lt;= R)&#123;</span><br><span class="line">		<span class="keyword">while</span> (l &lt;= Mid &amp;&amp; base[l].y &lt;= base[r].y) </span><br><span class="line">			upd(base[l].z, <span class="number">1</span>), ++ l ; </span><br><span class="line">		base[r].ans += qry(base[r].z), ++ r ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = L ; i &lt; l ; ++ i) upd(base[i].z, <span class="number">-1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K ; <span class="keyword">int</span> i, j, o ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		base[i].x = qr(), base[i].y = qr(), base[i].z = qr() ; </span><br><span class="line">	sort(base + <span class="number">1</span>, base + N + <span class="number">1</span>, comp1) ; cdq(<span class="number">1</span>, N) ;</span><br><span class="line">	sort(base + <span class="number">1</span>, base + N + <span class="number">1</span>, comp1) ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>, j = o = <span class="number">0</span> ; i &lt;= N ; j = o = <span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">while</span> (base[i] == base[i - <span class="number">1</span>]) ++ i, ++ j ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = i - j - <span class="number">1</span> ; k &lt; i ; ++ k) o = max(o, base[k].ans) ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = i - j - <span class="number">1</span> ; k &lt; i ; ++ k) base[k].ans = o ; <span class="keyword">if</span> (!j) ++ i ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) res[base[i].ans] ++ ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, res[i]) ;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Violet-å¤©ä½¿ç©å¶-SYJæ‘†æ£‹å­"><a href="#Violet-å¤©ä½¿ç©å¶-SYJæ‘†æ£‹å­" class="headerlink" title="[Violet] å¤©ä½¿ç©å¶/SYJæ‘†æ£‹å­"></a>[Violet] å¤©ä½¿ç©å¶/SYJæ‘†æ£‹å­</h1><blockquote>
<p>ç»™å®šä¸€å¼  $n\times m$ çš„ç½‘æ ¼ã€‚</p>
<p>æœ‰ä¸¤ä¸ªæ“ä½œï¼Œæ’å…¥ä¸€ä¸ªæ–°çš„ç‚¹æˆ–è€…è¯¢é—®ç¦»æŸä¸ªç‚¹æ¬§å‡ é‡Œå¾—è·ç¦»æœ€è¿‘çš„ç‚¹ã€‚</p>
<p>$n,m\leq 3\times10^5$ </p>
</blockquote>
<p>å‘ç°æ¬§å‡ é‡Œå¾—è·ç¦»å³ï¼š</p>
<script type="math/tex; mode=display">
|x_i-x_j|+|y_i-y_j|</script><p>é€šè¿‡åˆ†ç±»è®¨è®ºå¯ä»¥å¾—åˆ°æœ‰è¿™ä¹ˆå››ç±»æƒ…å†µï¼š</p>
<script type="math/tex; mode=display">
x_i-x_j+y_i-y_j\\
x_i-x_j-y_i+y_j\\
-x_i+x_j+y_i-y_j\\
-x_i+x_j-y_i+y_j\\</script><p>å‘ç°ï¼Œå…¶ä¸­ç¬¬äºŒç§æƒ…å†µå°±æ˜¯ç¬¬ä¸€ç§æŒ‰ç…§ $x$ è½´å¯¹ç§°äº†ä¸€ä¸‹çš„ç»“æœï¼Œåä¸¤ç§ç±»ä¼¼ã€‚äºæ˜¯å¯ä»¥é€šè¿‡åæ ‡å˜æ¢éƒ½è½¬åŒ–åˆ°ç¬¬ä¸€ç§é—®é¢˜ã€‚</p>
<p>å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå‘ç°è¯¢é—®å¯ä»¥åˆ†æ®µå¤„ç†ï¼Œäºæ˜¯æƒ³åˆ° $\rm CDQ$ ã€‚è€ƒè™‘å¦‚ä½•å¤„ç†ç¦»è‡ªå·±æœ€è¿‘çš„ç‚¹ï¼š</p>
<script type="math/tex; mode=display">
x_i-x_j+y_i-y_j=(x_i+y_i)-(x_j+y_j)</script><p>è¿™æ ·è½¬åŒ–å‡ºæ¥çš„ä¸¤éƒ¨åˆ†å³å…·æœ‰å·®åˆ†æ€§è´¨ï¼ˆå³å¯ä»¥æ‹†ï¼‰ï¼Œå¹¶ä¸”ä¿è¯äº†åªä¸æ—¶é—´è½´æœ‰å…³ï¼ˆä¸å†å’Œç½‘æ ¼å›¾æœ‰å…³ï¼‰ã€‚æ‰€ä»¥å¯ä»¥æŠŠ $x_i+y_i$ æ’å…¥è¿›å»ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨å››é $\rm CDQ$ åšå®Œè¿™é¢˜äº†ã€‚</p>
<p>æ„Ÿè§‰è¿˜æ˜¯å¾ˆç¥ä»™çš„å§â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rg register </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 600010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 2000010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Inf 192608170</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> low(x) (x &amp; (-x))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max(a, b) ((a) &gt; (b) ? (a) : (b))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> min(a, b) ((a) &lt; (b) ? (a) : (b))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">int</span> N, M, K, bit[MAXM], ans[MAXN] ; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qrys</span>&#123;</span> <span class="keyword">int</span> mk, id, x, y ; &#125;t[MAXN], q[MAXN], base[MAXN] ; </span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ch_top 24000001</span></span><br><span class="line"><span class="keyword">char</span> ch[ch_top],*now_r=ch<span class="number">-1</span>,*now_w=ch<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (*++now_r &lt; <span class="number">48</span>) ;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x = *now_r - <span class="number">48</span> ;</span><br><span class="line">    <span class="keyword">while</span> (*++now_r &gt;= <span class="number">48</span>) x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + *now_r - <span class="number">48</span> ;</span><br><span class="line">    <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> st[<span class="number">7</span>] ; <span class="keyword">static</span> <span class="keyword">int</span> top ;</span><br><span class="line">    <span class="keyword">while</span> (st[++ top] = <span class="number">48</span> + x % <span class="number">10</span>, x /= <span class="number">10</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (*++ now_w = st[top], -- top) ; *++ now_w = <span class="string">'\n'</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> ( ; p &lt;= K &amp;&amp; bit[p] ; p += low(p)) bit[p] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">const</span> <span class="keyword">int</span> &amp;v)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> ( ; p &lt;= K ; p += low(p)) bit[p] = max(bit[p], v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qry</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">	rg <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> ( ; p ; p -= low(p)) ret = max(ret, bit[p]) ; </span><br><span class="line">	<span class="keyword">return</span> ret ? ret : -Inf ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cdq</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L == R) <span class="keyword">return</span> ; </span><br><span class="line">	rg <span class="keyword">int</span> Mid = (L + R) &gt;&gt; <span class="number">1</span>, l, r, o = L ; </span><br><span class="line">	cdq(L, Mid), cdq(Mid + <span class="number">1</span>, R), l = L, r = Mid + <span class="number">1</span> ; </span><br><span class="line">	<span class="keyword">while</span> (r &lt;= R)&#123;</span><br><span class="line">		<span class="keyword">while</span> (l &lt;= Mid &amp;&amp; base[l].x &lt;= base[r].x)&#123;</span><br><span class="line">			<span class="keyword">if</span> (base[l].mk &lt; <span class="number">2</span>) </span><br><span class="line">				upd(base[l].y, base[l].x + base[l].y) ; </span><br><span class="line">			t[o ++] = base[l ++] ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (base[r].mk &gt; <span class="number">1</span>) </span><br><span class="line">			ans[base[r].id] = min(ans[base[r].id], </span><br><span class="line">							  base[r].x + base[r].y - qry(base[r].y)) ; </span><br><span class="line">		t[o ++] = base[r ++] ; </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">for</span> (rg <span class="keyword">int</span> i = L ; i &lt; l ; ++ i) </span><br><span class="line">    <span class="keyword">if</span> (base[i].mk &lt; <span class="number">2</span>) del(base[i].y) ;</span><br><span class="line">	<span class="keyword">while</span> (l &lt;= Mid) t[o ++] = base[l ++] ; </span><br><span class="line">  <span class="keyword">for</span> (rg <span class="keyword">int</span> i = L ; i &lt;= R ; ++ i) base[i] = t[i] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;ox, <span class="keyword">const</span> <span class="keyword">int</span> &amp;oy)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N + M ; ++ i)&#123;</span><br><span class="line">		base[i] = q[i] ; </span><br><span class="line">		base[i].x = ox ? q[i].x : K - q[i].x, </span><br><span class="line">		base[i].y = oy ? q[i].y : K - q[i].y ;</span><br><span class="line">	&#125;</span><br><span class="line">	cdq(<span class="number">1</span>, N + M) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//	freopen("data1.in", "r", stdin) ;</span></span><br><span class="line"><span class="comment">//	freopen("data1.out", "w", stdout) ;</span></span><br><span class="line">	fread(ch, <span class="number">1</span>, ch_top, <span class="built_in">stdin</span>) ;</span><br><span class="line">	N = read(), M = read() ; <span class="keyword">int</span> i ;</span><br><span class="line">	<span class="built_in">memset</span>(ans, <span class="number">63</span>, <span class="keyword">sizeof</span>(ans)) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		q[i].mk = <span class="number">1</span>, q[i].id = i, q[i].x = read() + <span class="number">1</span>, </span><br><span class="line">		q[i].y = read() + <span class="number">1</span>, K = max(K, max(q[i].x, q[i].y) + <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = N + <span class="number">1</span> ; i &lt;= N + M ; ++ i) </span><br><span class="line">		q[i].mk = read(), q[i].id = i, q[i].x = read() + <span class="number">1</span>, </span><br><span class="line">		q[i].y = read() + <span class="number">1</span>, K = max(K, max(q[i].x, q[i].y) + <span class="number">1</span>) ;</span><br><span class="line">	solve(<span class="number">1</span>, <span class="number">0</span>), solve(<span class="number">0</span>, <span class="number">1</span>), solve(<span class="number">1</span>, <span class="number">1</span>), solve(<span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = N + <span class="number">1</span> ; i &lt;= N + M ; ++ i) <span class="keyword">if</span> (q[i].mk &gt; <span class="number">1</span>) write(ans[i]) ;</span><br><span class="line">	fwrite(ch, <span class="number">1</span>, now_w - ch, <span class="built_in">stdout</span>) ;  <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>ä¸çŸ¥é“å•¥æ—¶å€™æ‰èƒ½çœŸæ­£åœ°çµæ´»è¿ç”¨â€¦</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>CDQåˆ†æ²»</category>
      </categories>
      <tags>
        <tag>ç¦»çº¿ç®—æ³•/CDQåˆ†æ²»</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç”Ÿæ´»ç¢ç‰‡3ã€‘Â· Life is strange</title>
    <url>/2020/01/24/Life3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>Life is strange, no matter who u are.</p>
</blockquote>
<a id="more"></a>
<p>åˆé€¢ã€Œå¥‡å¼‚äººç”Ÿã€è¿™æ¬¾æ¸¸æˆï¼Œè¿˜æ˜¯ä»CèŒé‚£é‡Œäº†è§£çš„ã€‚ä½†æ˜¯è¿™æ¬¡ä¸åŒä»¥å¾€ï¼Œå‘ç°è¿™ä¸œè¥¿åœ¨Macä¸Šå®Œå…¨å¸¦çš„èµ·æ¥ï¼Œäºæ˜¯å°±å†³å®šè‡ªå·±åœ¨steamä¸Šä¹°æ¥ç©å„¿ã€‚è™½ç„¶æ²¡æœ‰æ±‰åŒ–ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šè¿˜æ˜¯å¾ˆæµç•…çš„ï¼ˆé™¤äº†æœ‰æ—¶å€™ç”±äºä¸çŸ¥é“åœ¨è¯´å“ªå›½è‹±è¯­è€Œç–¯ç‹‚å¡å…³ï¼‰ã€‚æœ€åä»CèŒé‚£é‡Œä¹ŸæˆåŠŸåœ°çœ‹åˆ°äº†ç¬¬äºŒä¸ªç»“å±€ã€‚</p>
<p>è‡³äºã€Œå¥‡å¼‚äººç”ŸäºŒã€ï¼Œåˆ™å®Œå…¨æ˜¯åœ¨çœ‹CèŒçš„å®å†µã€‚ä»19å¹´ $4$ æœˆçš„ç¬¬ä¸‰ç« ç­‰åˆ° $8$ æœˆï¼Œæ¥ç€ç­‰åˆ° $12$ æœˆï¼Œè¿™éƒ¨è¢«å…ˆå…¥ä¸ºä¸»çš„ç²‰ä¸æ‰¹è¯„ã€Œæ²¡æœ‰ç¬¬ä¸€éƒ¨å¥½ã€çš„æ°ä½œï¼Œç»ˆäºè¿æ¥äº†å®ƒçš„ $\rm Ending$ã€‚ç»“å±€å…± $4$ ä¸ªï¼Œéƒ½ä½“ç°äº†å¾ˆé«˜çš„ã€Œè®²æ•…äº‹ã€æ°´å¹³ï¼Œä¸ªäººæ¥è®²è¿™å¯èƒ½æ˜¯æˆ‘èƒ½æƒ³åˆ°æœ€å¥½çš„ç»“å±€ã€‚</p>
<p>ä¼šæœ‰ä¸‰å—ï¼Ÿå¯èƒ½ä¼šæœ‰å§ã€‚å¯¹æˆ‘æ¥è¯´ï¼Œè¿™æ˜¯ä¸ªæœ‰æ¸©åº¦çš„å…¬å¸ï¼Œåˆ¶ä½œçš„æœ‰æ¸©åº¦çš„æ¸¸æˆã€‚æ¯ä¸€å¸§ç”»é¢ã€æ¯ä¸€é¦– $\rm bgm$ éƒ½æ˜¯åœ¨ä¸ç´§ä¸æ…¢åœ°å™äº‹ï¼Œäº¤ç»‡æˆä¸€æ¡ç¼“ç¼“æµæ·Œçš„æ²³ï¼Œæµè¿‡ä¸»äººå…¬çš„å¥‡å¼‚äººç”Ÿï¼Œæµå‘è¿œæ–¹ã€‚</p>
<p>é‚£å…¶ä¸­æˆ–è®¸æ˜­ç¤ºç€ï¼Œæ¯ä¸€ç§ä¸åŒçš„ç”Ÿå‘½çŠ¶æ€éƒ½æœ‰å…¶å­˜åœ¨çš„æ„ä¹‰å’Œä»·å€¼ã€‚æ¢å¥è¯è¯´ï¼Œä¸è®ºä½ æ´»æˆä»€ä¹ˆæ ·ï¼Œéƒ½å€¼å¾—ç»§ç»­æ´»ä¸‹å»ã€‚å› ä¸ºäººç”Ÿçš„æ„ä¹‰ï¼Œå°±åœ¨äºæ´»ç€ã€‚</p>
<!--more-->
<h1 id="1"><a href="#1" class="headerlink" title="$1$"></a>$1$</h1><p>å…¶å® ã€Œå¥‡å¼‚äººç”Ÿ1ã€çš„å‰§æƒ…å·²ç»åœ¨ ã€Œéšæƒ³9ã€é‡Œé¢è¯´äº†å¾ˆå¤šå•¦ã€‚å¤§æ¦‚å°±æ˜¯è®²çš„ä¸¤ä¸ªå¦¹å­ä¹‹é—´æ— å¯æ’¼åŠ¨çš„å‹è°Šé‡ä¸Šäº†æ»¥ç”¨ä¼šå¯¼è‡´å¤©ç¾çš„è¶…èƒ½åŠ›ï¼Œæœ€åï¼ˆæˆ‘é€‰æ‹©ï¼‰æŠŠ $\rm Acadia~ Bay$ æ•´ä¸ªç‰ºç‰²äº†æ¢å¦¹å­çš„æ•…äº‹ã€‚</p>
<p>å…¶å® $1$ é‡Œé¢çš„å‰§æƒ…ä¹Ÿå¥½ã€ä¸–ç•Œä¹Ÿå¥½ï¼Œéƒ½ä»…ä»…æ˜¯å±€é™åœ¨ $\rm Acadia~ Bay$ çš„ä¸€è§’è€Œå·²ï¼Œæ¯”èµ·ã€ŒäºŒã€ä¸­çš„ã€Œç«–è·¨ç¾å›½ã€æ¥è®²ååˆ†çš„ç‹­çª„ã€‚æ‰€ä»¥å¦‚æœè¯´ã€ŒäºŒã€çš„ä¸»é¢˜æ˜¯ã€Œæˆé•¿ã€ä¸ã€Œå‹‡æ°”ã€ï¼Œé‚£ä¹ˆã€Œä¸€ã€çš„ä¸»é¢˜å¯èƒ½ä¼šæ˜¯ã€Œæˆé•¿ã€ä¸ ã€Œèµ‹äºˆæ„ä¹‰ã€ã€‚</p>
<p>$\rm Max$ ç”Ÿæ´»çš„åŸå¸‚å…¶å®å¹¶ä¸å¾ˆå¥½ï¼Œå­¦æ ¡é‡Œçš„ç¯å¢ƒä¹Ÿä¸å®Œç¾ã€‚ç„¶è€Œä» $\rm Max$ æŒæ¡äº†è¶…èƒ½åŠ›å¼€å§‹ï¼Œå¥¹ä¼¼ä¹å¯ä»¥æ‹¯æ•‘å‘¨å›´çš„ä¸€åˆ‡äº†â€”â€”æ•‘ä¸‹è¦è‡ªæ€çš„åŒå­¦ã€è§£å†³äº†äººé™…å…³ç³»çš„æ¼æ´ã€æ•°æ¬¡æ•‘å›äº†åœ¨æ­»äº¡è¾¹ç¼˜ç–¯ç‹‚è¯•æ¢çš„ $\rm Cloye$ ã€‚ä½†æ˜¯æ— è®ºæ€ä¹ˆæ”¹ï¼Œåˆ°æœ€åéƒ½æ— æ³•åˆ›é€ ä¸€ä¸ªå®Œç¾çš„ç»“å±€â€”â€”å¯ä»¥è¯´ï¼Œåˆ°æœ€åï¼Œè®© $\rm Cloye$ æ´»ç€æ‰æ˜¯å¥¹æœ€å¸Œæœ›ä¸”å”¯ä¸€å¸Œæœ›çš„äº‹ã€‚</p>
<p>ä½†å…¶å®ï¼Œä¼¼ä¹åˆ¶ä½œè€…é’¦å®šçš„ç»“å±€æ˜¯ç‰ºç‰² $\rm Cloye$ è€Œä¸æ˜¯ $\rm Acadia~Bay$ã€‚è¿™æˆ–è®¸å°±æ›´å¥½åœ°æ­ç¤ºäº†ã€Œèµ‹äºˆæ„ä¹‰ã€è¿™å±‚å«ä¹‰ï¼šç”Ÿæ´»å…¶å®æœ¬èº«å°±æ˜¯é‚£æ ·åœ°å……æ»¡ â€œ$\rm Obstacles$â€ ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¯ä»¥æ‹¯æ•‘ä¸€åˆ‡çš„è¶…èƒ½åŠ›ï¼ˆå› ä¸º $\rm Max$ çš„è¶…èƒ½åŠ›æ»¥ç”¨ä¼šå¯¼è‡´æ—¥é£Ÿã€åŒæœˆã€é£“é£ç­‰éè‡ªç„¶ç°è±¡ï¼‰ï¼Œæ‰€ä»¥å¤§å®¶éƒ½åªæ˜¯å¹³å‡¡æ´»ç€çš„å¹³å‡¡äººï¼Œåšç€è‡ªå·±å–œæ¬¢çš„å¹³å‡¡çš„äº‹ï¼Œäººç”Ÿæ˜¯å¦ã€Œå¥‡å¼‚ã€ä¸åœ¨äºè‡ªå·±è·å¾—äº†ä»€ä¹ˆå¤©åŠ©çš„èƒ½åŠ›ï¼Œåœ¨äºç»™è‡ªå·±çš„å¹³å‡¡ç”Ÿæ´»èµ‹äºˆäº†ä»€ä¹ˆä¸å‡¡çš„æ„ä¹‰ã€‚ã€Œç¢Œç¢Œæ— ä¸ºã€çš„ç‰¢ç¬¼éœ€è¦è‡ªå·±èµ°å‡ºï¼Œæ‹¥æœ‰å†å¼ºçš„è¶…èƒ½åŠ›ä¹Ÿåªæ˜¯åŠ é€Ÿäº†è‡ªå·±åŸåœ°æ‰“è½¬çš„é€Ÿåº¦è€Œå·²ã€‚æ‰€ä»¥ï¼Œå¯èƒ½å­¦ä¼šã€Œèµ‹äºˆæ„ä¹‰ã€æ‰æ˜¯è®©æ¯å¤©éƒ½å¯ä»¥ã€Œç¿©ç¿©èµ·èˆã€çš„æœ€ä½³æ–¹æ¡ˆã€‚</p>
<p>æ‰€ä»¥æœ€å $\rm Cloye$ è¢«å‰§æƒ…æ€äº†ã€‚å¯èƒ½è¿™ä¹Ÿæ˜¯åœ¨å‘Šè¯‰ $\rm Max$ å’Œæˆ‘ä»¬ï¼Œä¸€åˆ‡ç¾å¥½çš„ä¸œè¥¿éƒ½ä¼šé€å»ï¼Œå¦‚ä½•å¯¹æ¥ä¸‹æ¥çš„ç”Ÿæ´»æ›´å¥½åœ°èµ‹äºˆæ„ä¹‰ï¼Œæ‰æ˜¯çœŸæ­£éœ€è¦æ€è€ƒçš„é—®é¢˜ã€‚</p>
<p>ã€Œä¸€ã€ä¸­æœ€å—å¥½è¯„çš„ï¼Œå¯èƒ½æ˜¯å…¶æœ€åä¸¤ç« çš„å™äº‹æ‰‹æ³•ï¼Œç®€ç›´æ˜¯ç¥æ¥ä¹‹ç¬”ã€‚ä¸€ééå›æº¯ã€ä¸€ééå¯»æ‰¾ï¼Œäº¤å çš„ç©ºé—´ä¸æ—¶é—´ï¼Œ$\rm Max$ æ‹¯æ•‘ $\rm Cloye$ çš„è¿‡ç¨‹ï¼Œè®©äººååˆ†åŠ¨å®¹ã€‚</p>
<h1 id="2"><a href="#2" class="headerlink" title="$2$"></a>$2$</h1><p>ã€Œå¥‡å¼‚äººç”ŸäºŒã€è·Ÿã€Œä¸€ã€ä¸åŒã€‚ä¸»è§’å…„å¼Ÿä¿©ä¸€å¼€å§‹è¿‡ç€å¹³ç¨³å®‰é€¸çš„ç”Ÿæ´»ï¼Œè¢«çªå¦‚å…¶æ¥çš„å†²çªæ‰“ä¹±ã€è¢«è§†ä¸ºé€šç¼‰çŠ¯ï¼Œå†³å®šå—ä¸‹å»å¢¨è¥¿å“¥å¼€å¯æ–°ç”Ÿæ´»ï¼Œå¹¶åœ¨é€”ä¸­ç»å†äº†ä¸€ç³»åˆ—æ³¢æŠ˜ã€‚è¿™å…¶ä¸­æ²¡æœ‰ã€Œä¸€ã€ä¸­å¥‡è¯¡çš„å‰§æƒ…ï¼Œä½†æ˜¯æ¨ªè·¨äº†æ¯”ã€Œä¸€ã€æ›´å¤§çš„æ—¶ç©ºã€‚</p>
<p>å…¶å®å‘¢ï¼Œã€ŒäºŒã€é­äººè¯Ÿç—…ï¼Œæ˜¯å› ä¸ºå‰§æƒ…æ¯”èµ·ã€Œä¸€ã€æ¥æ°´äº†å¾ˆå¤šã€‚ã€ŒäºŒã€ä¸­çš„ä½œç”»å’Œé…ä¹ä¾æ—§ä¼˜ç§€ã€ç»†èŠ‚å¤„ç†ä¾ç„¶åˆ°ä½ï¼Œä½†æ˜¯å‰§æƒ…å¾ˆè–„ã€‚æ¯”èµ·ã€Œä¸€ã€ä¸­ $\rm Max$ å’Œ $\rm Cloye$ æ— æ¯”çœŸæŒšçš„å‹è°Šï¼Œã€ŒäºŒã€ä¸­æ²¡æœ‰æ¿€çƒˆçš„æƒ…æ„Ÿå–·è–„ï¼Œåªæ˜¯åœ¨æ·¡æ·¡åœ°å™äº‹ç½¢äº†ã€‚</p>
<p>ä½†æ˜¯ï¼Œã€ŒäºŒã€çš„å‰§æƒ…ä¼¼ä¹è¢«æœ€åçš„ç»“å±€ç»™æ•‘äº†å›æ¥ã€‚æœ€åä¸€å…±æœ‰å››ä¸ªç»“å±€ï¼š</p>
<ul>
<li>1ï¼šå¼Ÿå¼Ÿç”¨è¶…èƒ½åŠ›ç‚¸æ¯äº†è¾¹å¢ƒå¤§é—¨ï¼Œå’Œå“¥å“¥ä¸€èµ·å»äº†å¢¨è¥¿å“¥ã€‚è¿™ä¸ªç»“å±€éœ€è¦ä¹‹å‰çš„å‰§æƒ…äº¤äº’ä¸­å¯¹å¼Ÿå¼Ÿç®¡æ•™ä¸ä¸¥æ ¼ã€è®©å¼Ÿå¼Ÿè‚†æ„å¦„ä¸ºä¸”æœ€åç©å®¶é€‰æ‹©ã€Œå†²ã€æ‰å¯ä»¥è¾¾æˆã€‚æœ€åä»–ä»¬åœ¨å¢¨è¥¿å“¥å¼€äº†é—´ä¿®è½¦å‚ï¼Œè¿‡ä¸Šäº†é»‘å¸®çš„ç”Ÿæ´»ã€‚ä¸ªäººæ„Ÿè§‰ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç»“å±€ï¼Œå› ä¸ºæœ¬èº«ä»–ä¿©éƒ½æ˜¯å—å®³è€…ï¼Œç»å†åŠ«éš¾ä¹‹åä¼¼ä¹æ ¹æœ¬æ²¡æœ‰èµ°å‡ºé˜´å½±ï¼Œä¹Ÿå°±æ˜¯ã€Œæˆé•¿ã€çš„å‘³é“æ¯”è¾ƒæµ…ã€‚</li>
<li>2ï¼šå“¥å“¥é€‰æ‹©æŠ•é™ï¼Œä½†æ˜¯å¼Ÿå¼Ÿä¸æŠ•é™ï¼Œæ‰§æ„å†²è¿‡è¾¹å¢ƒçº¿ä½†å¯¼è‡´å“¥å“¥è¢«æµå¼¹å‡»æ€ã€‚è¿™ä¸ªç»“å±€éœ€è¦ä¹‹å‰çš„å‰§æƒ…äº¤äº’ä¸­å¯¹å¼Ÿå¼Ÿç®¡æ•™ä¸ä¸¥æ ¼ã€è®©å¼Ÿå¼Ÿè‚†æ„å¦„ä¸ºä¸”æœ€åç©å®¶é€‰æ‹©ã€Œä¸å†²ã€æ‰å¯ä»¥è¾¾æˆã€‚æœ€åå¼Ÿå¼Ÿä¸€ä¸ªäººåœ¨å¢¨è¥¿å“¥å¼€å¯äº†æ–°çš„ã€Œç§§æ­Œstarã€ç”Ÿæ´»â€¦æˆ‘è§‰å¾—åº”è¯¥æ˜¯æœ€çƒ‚çš„ç»“å±€äº†233</li>
<li>3ï¼šå“¥å“¥é€‰æ‹©æŠ•é™ï¼Œå¼Ÿå¼Ÿä¹Ÿé€‰æ‹©æŠ•é™ã€‚è¿™éœ€è¦é€‰æ‹©ã€Œä¸å†²ã€å¹¶ä¸”å¼Ÿå¼Ÿè¢«ç©å®¶æ•™è‚²çš„å¾ˆæ‡‚äº‹æ‰å¯ä»¥ã€‚æœ€åå½“ç„¶æ˜¯å“¥å“¥è¢«å…³äº† $20+$ å¹´ï¼Œå¼Ÿå¼Ÿç”±äºæ˜¯æœªæˆå¹´äººå¹¶ä¸”è‡ªé¦–å•¥äº‹æ²¡æœ‰ï¼Œå‡ºæ¥å·²ç»æ˜¯ä¸­å¹´äººäº†ã€‚ä¹Ÿä¸æ˜¯å¾ˆå¥½å§233</li>
<li>4ï¼šå“¥å“¥é€‰æ‹©å†²ï¼Œå¼Ÿå¼Ÿé€‰æ‹©å¸®ä»–ç‚¸å¼€è¾¹å¢ƒä½†æ˜¯è‡ªå·±ç•™äº†ä¸‹æ¥ã€æ¥å—åˆ¶è£ã€‚è¿™æ˜¯æˆ‘è®¤ä¸ºæœ€å¥½çš„ç»“å±€ã€‚å“¥å“¥è·¯ä¸Šç»å†çš„ä¸€åˆ‡æœ‰äº†æŠ¥å¿ï¼Œå¼Ÿå¼Ÿä¹Ÿä¸å†ä¸€å‘³ç´¢æ±‚ï¼Œé€‰æ‹©ä¸»åŠ¨å¥‰çŒ®ã€‚æœ€åçš„ç»“å±€å¾ˆç¾ã€‚å“¥å“¥åœ¨å¢¨è¥¿å“¥ç»™å¼Ÿå¼Ÿå†™ä¿¡ï¼Œå¼Ÿå¼Ÿåœ¨ç¾å›½çš„å¤–å…¬å¤–å©†å®¶é‡Œè¯»ä¿¡ã€‚ä¸¤äººéƒ½æˆé•¿äº†ã€æ”¶è·äº†è‡ªå·±åº”æœ‰çš„ç”Ÿæ´»ã€‚</li>
</ul>
<p>ã€ŒäºŒã€ä¸­çš„å‰§æƒ…ï¼Œæ˜¯æ…¢æ…¢åœ°è®²è¿°ç€çš„ã€‚æ— è®ºæ˜¯ä»–ä»¬é‡é€¢äº†ä»–ä»¬çš„æ¯äº²ï¼Œè¿˜æ˜¯è·¯ä¸Šé‡åˆ°ä¸€åˆ‡çš„è‰°éš¾é™©é˜»ï¼Œéƒ½å¦‚åŒä¸€æ¡å‡åŒ€åœ°æ´’æ»¡é‡‘ç®”çš„æ²³æµï¼Œæ…¢æ…¢åœ°æµæ·Œï¼Œæ…¢æ…¢åœ°æŠŠé—ªå…‰ç‚¹å±•éœ²å‡ºæ¥ã€‚</p>
<p>è¿™æ˜¯ $\rm B$ ç«™é‡Œé¢å››ä¸ªç»“å±€çš„ $\rm Link$ï¼š<a href="https://www.bilibili.com/video/av78032043?from=search&amp;seid=1274319984559483706" target="_blank" rel="noopener">æˆ³æˆ‘</a></p>
<h1 id="3"><a href="#3" class="headerlink" title="$3$"></a>$3$</h1><p>ã€ŒäºŒã€ä¸­ä¹Ÿæˆ–å¤šæˆ–å°‘ç›´å¾„äº†ç¬¬ä¸€éƒ¨ï¼Œäºæ˜¯ä¼šæ ¹æ®ç©å®¶ç¬¬ä¸€éƒ¨é€‰æ‹©çš„æ˜¯ç‰ºç‰² $\rm Cloye$ è¿˜æ˜¯ $\rm Acadia~Bay$ æµäº†ä¸åŒçš„å½©è›‹ã€‚</p>
<p>æœ€åç•™ä¸ª $\rm Link$ å§ï¼š<a href="https://www.bilibili.com/video/av78454677?from=search&amp;seid=2854200599543211488" target="_blank" rel="noopener">æˆ³æˆ‘</a> </p>
<p>ä½ é—®æˆ‘ä¸ºä»€ä¹ˆä¸åƒä»¥å‰ä¸€æ ·å†™å¾ˆé•¿çš„ç¯‡æœ«æ€»ç»“ï¼Ÿ</p>
<p>å¯¹äºè¿™ç§ååˆ†ç¾å¥½çš„ä¸œè¥¿ï¼Œã€Œè®©å®ƒæ·¡æ·¡çš„æ¥ï¼Œè®©ä»–å¥½å¥½çš„å»ã€æ‰æ˜¯æœ€æ°å½“çš„æ–¹æ¡ˆå§ï¼Ÿ</p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>ç”Ÿæ´»ç¢ç‰‡</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ¢ç©¶ã€‘ç”¨LCTç»´æŠ¤MST</title>
    <url>/2020/01/24/LCT3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸»è¦æ˜¯æ•´ç†äº†ä¸€ä¸‹ $\rm LCT$ ç»´æŠ¤ $\rm min/max~spanning~tree$ ã€‚</p>
<p>è¯´èµ·æ¥å…¶å®å¾ˆç®€å•ï¼Œåªè¦ç»´æŠ¤ä¸€æ¡è·¯å¾„ä¸­æœ€é•¿çš„é‚£æ¡è¾¹ï¼Œç„¶åæ›¿æ¢å³å¯ã€‚</p>
<p>ä¼¼ä¹å¾ˆç®€å•ï¼Ÿå°±æ˜¯å¾ˆç®€å•ã€‚</p>
<a id="more"></a>
<h1 id="LG3366-ã€æ¨¡æ¿ã€‘æœ€å°ç”Ÿæˆæ ‘"><a href="#LG3366-ã€æ¨¡æ¿ã€‘æœ€å°ç”Ÿæˆæ ‘" class="headerlink" title="LG3366 ã€æ¨¡æ¿ã€‘æœ€å°ç”Ÿæˆæ ‘"></a>LG3366 ã€æ¨¡æ¿ã€‘æœ€å°ç”Ÿæˆæ ‘</h1><p>å°±æ˜¯è´´ä¸ªä»£ç ?</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œéœ€è¦æŠŠæ¯ä¸€æ¡è¾¹åŠ å…¥ç‚¹ï¼Œåˆ é™¤çš„è¯å°±åªéœ€è¦æŠŠä¸è¿™æ¡è¾¹ç›¸è¿çš„ç‚¹ä¹‹é—´çš„è¾¹æ–­æ‰ã€‚</p>
<p>ä¼¼ä¹æ²¡å•¥éš¾çš„ï¼ŸLCTè™½ç„¶è¯´å¾ˆé•¿ï¼Œä½†æ˜¯ä¼¼ä¹å†™èµ·æ¥å¾ˆè½»æ¾è¯¶ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gcr getchar</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr(k) e[k].fr</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) e[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vl(k) e[k].vl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fa(x) t[x].fa</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rv(x) t[x].rev</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc(x) t[x].son[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc(x) t[x].son[1]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">400010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">600010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> vl ;</span><br><span class="line">    <span class="keyword">int</span> fr, to ;</span><br><span class="line">&#125;e[M] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LCT</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> fa ;</span><br><span class="line">    <span class="keyword">int</span> rev ;</span><br><span class="line">    <span class="keyword">int</span> son[<span class="number">2</span>] ;</span><br><span class="line">&#125;t[N] ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> val[M] ;</span><br><span class="line"><span class="keyword">int</span> stk[N], tp ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qr</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    x = <span class="number">0</span> ; <span class="keyword">char</span> c = gcr() ;</span><br><span class="line">    <span class="keyword">while</span> (c &gt; <span class="string">'9'</span> || c &lt; <span class="string">'0'</span>) c = gcr() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) x = x * <span class="number">10</span> + c - <span class="number">48</span>, c = gcr() ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">notroot</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ((lc(fa(x)) == x) || (rc(fa(x)) == x)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    rv(x) ^= <span class="number">1</span>, swap(lc(x), rc(x)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _down(<span class="keyword">int</span> x)&#123;</span><br><span class="line">    <span class="keyword">if</span> (rv(x))&#123;</span><br><span class="line">        rv(x) = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">if</span> (lc(x)) reverse(lc(x)) ;</span><br><span class="line">        <span class="keyword">if</span> (rc(x)) reverse(rc(x)) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    val[x] = x ;</span><br><span class="line">    <span class="keyword">if</span> (vl(val[x]) &lt; vl(val[lc(x)])) val[x] = val[lc(x)] ;</span><br><span class="line">    <span class="keyword">if</span> (vl(val[x]) &lt; vl(val[rc(x)])) val[x] = val[rc(x)] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> w = x == rc(fa(x)) ;</span><br><span class="line">    <span class="keyword">int</span> f1 = fa(x), f2 = fa(f1) ;</span><br><span class="line">    <span class="keyword">if</span> (notroot(f1))</span><br><span class="line">        t[f2].son[f1 == rc(f2)] = x ;</span><br><span class="line">    t[f1].son[w] = t[x].son[w ^ <span class="number">1</span>] ;</span><br><span class="line">    fa( t[x].son[w ^ <span class="number">1</span>] ) = f1 ;</span><br><span class="line">    fa(x) = f2 ; fa(f1) = x ;</span><br><span class="line">    t[x].son[w ^ <span class="number">1</span>] = f1 ;</span><br><span class="line">    update(f1) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y ;</span><br><span class="line">    stk[++ tp] = y = x ;</span><br><span class="line">    <span class="keyword">while</span> (notroot(y))</span><br><span class="line">        y = fa(y), stk[++ tp] = y ;</span><br><span class="line">    <span class="keyword">while</span> (tp) _down(stk[tp --]) ;</span><br><span class="line">    <span class="keyword">while</span> (notroot(x))&#123;</span><br><span class="line">        <span class="keyword">int</span> f1 = fa(x) ;</span><br><span class="line">        <span class="keyword">int</span> f2 = fa(f1) ;</span><br><span class="line">        <span class="keyword">if</span> (notroot(f1))&#123;</span><br><span class="line">            <span class="keyword">if</span> ((rc(f1) == x) == (rc(f2) == f1))</span><br><span class="line">                rotate(f1) ; <span class="keyword">else</span> rotate(x) ;</span><br><span class="line">        &#125;</span><br><span class="line">        rotate(x) ;</span><br><span class="line">    &#125;</span><br><span class="line">    update(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> ( ; x ; x = fa(y = x))</span><br><span class="line">        splay(x), rc(x) = y, update(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">make_root</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    access(x) ;</span><br><span class="line">    splay(x) ; reverse(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_root</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    access(x) ; splay(x) ;</span><br><span class="line">    <span class="keyword">while</span>(lc(x)) x = lc(x) ;</span><br><span class="line">    <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    make_root(u), access(v), splay(v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    make_root(u), fa(u) = v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cut</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    split(u, v) ;</span><br><span class="line">    fa(u) = lc(v) = <span class="number">0</span> ;</span><br><span class="line">    update(v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cut</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="comment">//access(to(x)) ; </span></span><br><span class="line">	splay(x) ;</span><br><span class="line">    lc(x) = rc(x) = fa(lc(x)) = fa(rc(x)) = <span class="number">0</span> ;</span><br><span class="line">    update(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        qr(fr(i)),</span><br><span class="line">        qr(to(i)), qr(vl(i)) ;</span><br><span class="line">		<span class="comment">//cout &lt;&lt; vl(i) &lt;&lt; endl ;</span></span><br><span class="line">        fr(i) += m, to(i) += m ;</span><br><span class="line">        make_root(to(i)) ;</span><br><span class="line">        <span class="keyword">if</span> (find_root(fr(i)) != to(i))</span><br><span class="line">            ans += vl(i), link(fr(i), i), link(to(i), i) ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (vl(i) &lt; vl(val[fr(i)]))&#123;</span><br><span class="line">			ans += vl(i) - vl(val[fr(i)]) ;</span><br><span class="line">        	cut(val[fr(i)]), link(fr(i), i), link(to(i), i) ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//cout &lt;&lt; ans &lt;&lt; endl ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="WC2006-æ°´ç®¡å±€é•¿"><a href="#WC2006-æ°´ç®¡å±€é•¿" class="headerlink" title="[WC2006]æ°´ç®¡å±€é•¿"></a>[WC2006]æ°´ç®¡å±€é•¿</h1><blockquote>
<p>è¦æ±‚åŠ¨æ€ç»´æŠ¤ä¸€å¼ å›¾ã€‚</p>
<p>åªæœ‰åˆ è¾¹æ“ä½œã€åŠ¨æ€è¯¢é—® $x$ åˆ° $y$ é—´æ‰€æœ‰è·¯å¾„ä¸Šæœ€å¤§è¾¹æƒçš„æœ€å°å€¼ã€‚</p>
</blockquote>
<p>é‚£æ˜¾ç„¶æ˜¯åœ¨æœ€å°ç”Ÿæˆæ ‘ä¸Šè·‘ã€‚</p>
<p>æ—¢æœ‰åŠ è¾¹ä¹Ÿæœ‰åˆ è¾¹çš„MSTæ˜¯æ²¡æ³•åšçš„ã€‚å› ä¸ºåˆ è¾¹çš„æ—¶å€™å¯èƒ½æœ‰ä¸€å †å€™é€‰é›†åˆï¼Œè¿™æ˜¯æ— æ³•ç®€å•ç»´æŠ¤çš„ã€‚ä½†æ˜¯åªæœ‰åŠ è¾¹æˆ–è€…åªæœ‰åˆ è¾¹çš„MSTå¾ˆç®€å•ã€‚ç”±äºåªæœ‰åˆ è¾¹ï¼Œæ‰€ä»¥å€’ç€åšä¸€éå°±å®Œäº†ã€‚</p>
<p>hiahiahiaï¼Œå¿«æ¥æ¬£èµä¸€ä¸‹æˆ‘ç‰¹åˆ«æ£’çš„ç é£ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> o, u, v ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; q ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        qr(fr(i)) ;</span><br><span class="line">        qr(to(i)) ;</span><br><span class="line">        qr(vl(i)) ;</span><br><span class="line">        fr(i) += (m + q) ;</span><br><span class="line">        to(i) += (m + q) ;</span><br><span class="line">        <span class="keyword">if</span> (fr(i) &gt; to(i))</span><br><span class="line">            swap(fr(i), to(i)) ;</span><br><span class="line">        Id[mk_p(fr(i), to(i))] = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m + <span class="number">1</span> ; i &lt;= m + q ; ++ i)&#123;</span><br><span class="line">        qr(vl(i)) ;</span><br><span class="line">        qr(fr(i)) ;</span><br><span class="line">        qr(to(i)) ;</span><br><span class="line">        fr(i) += (m + q) ;</span><br><span class="line">        to(i) += (m + q) ;</span><br><span class="line">        <span class="keyword">int</span> u = fr(i) ;</span><br><span class="line">        <span class="keyword">int</span> v = to(i) ;</span><br><span class="line">        <span class="keyword">if</span> (vl(i) &lt;= <span class="number">1</span>) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">if</span> (u &gt; v)</span><br><span class="line">            swap(u, v),</span><br><span class="line">            swap(fr(i), to(i)) ;</span><br><span class="line">        o = Id[mk_p(u, v)] ;</span><br><span class="line">        vis[o] = <span class="number">1</span>, mem[i] = o ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; 2333 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[i])</span><br><span class="line">            <span class="keyword">continue</span> ;</span><br><span class="line">        u = fr(i) ;</span><br><span class="line">        v = to(i) ;</span><br><span class="line">        make_root(v) ;</span><br><span class="line">        <span class="keyword">if</span> (find_root(u) != v)&#123;</span><br><span class="line">            link(u, i) ;</span><br><span class="line">            link(v, i) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (vl(i) &lt; vl(val[u]))&#123;</span><br><span class="line">            dcut(val[u]) ;</span><br><span class="line">            link(u, i) ; link(v, i) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m + q ; i &gt; m ; -- i)&#123;</span><br><span class="line">        <span class="keyword">int</span> u = fr(i) ;</span><br><span class="line">        <span class="keyword">int</span> v = to(i) ;</span><br><span class="line">        <span class="keyword">int</span> j = mem[i] ;</span><br><span class="line">        <span class="keyword">if</span> (vl(i) == <span class="number">1</span>)&#123;</span><br><span class="line">            merge(u, v) ;</span><br><span class="line">            ans[i - m] = vl(val[v]) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            u = fr(j) ;</span><br><span class="line">            v = to(j) ;</span><br><span class="line">            make_root(v) ;</span><br><span class="line">            ans[i - m] = <span class="number">-1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (find_root(u) != v)&#123;</span><br><span class="line">                link(u, j) ;</span><br><span class="line">                link(v, j) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (vl(j) &lt; vl(val[fr(j)]))&#123;</span><br><span class="line">                dcut(val[u]) ;</span><br><span class="line">                link(u, j) ; link(v, j) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (~ans[i]) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="NOI2014-é­”æ³•æ£®æ—"><a href="#NOI2014-é­”æ³•æ£®æ—" class="headerlink" title="[NOI2014]é­”æ³•æ£®æ—"></a>[NOI2014]é­”æ³•æ£®æ—</h1><blockquote>
<p>ç»™å‡ºä¸€ä¸ª $n$ ä¸ªç‚¹ï¼Œ$m$ æ¡è¾¹çš„æ— å‘å›¾ï¼Œæ¯æ¡è¾¹éƒ½æœ‰æƒå€¼ $a_i,b_i$ ã€‚</p>
<p>æ±‚ä¸€æ¡ä»ç‚¹ $1$ åˆ°ç‚¹ $n$ çš„è·¯å¾„ï¼Œä½¿å¾—è¿™æ¡è·¯å¾„ä¸Šè¾¹çš„ $a_i,b_i$ æœ€å¤§å€¼ä¹‹å’Œæœ€å°ã€‚</p>
<p>$2 \leq n \leq 5 \times 10^4, 0 \leq m \leq 1 \times 10^5$ã€‚</p>
</blockquote>
<p>å‘ç°å¯ä»¥å…ˆæŠŠè¾¹æƒæŒ‰ç…§ç¬¬ä¸€ç»´æ’ä¸ªåºï¼Œç„¶ååšæ™®é€šçš„lctç»´æŠ¤MSTå°±å®Œäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; ans = MAX ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        qr(fr(i)), qr(to(i)), qr(va(i)), qr(vb(i)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) fr(i) += m, to(i) += m ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n + m + <span class="number">1</span> ; ++ i) f[i] = i ;</span><br><span class="line">    sort(E + <span class="number">1</span>, E + m + <span class="number">1</span>, comp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        rg <span class="keyword">int</span> f1, f2 ;</span><br><span class="line">        rg <span class="keyword">int</span> u = fr(i), v = to(i) ;</span><br><span class="line">        <span class="keyword">if</span> (u == v) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; val[i] &lt;&lt; endl ;</span></span><br><span class="line">        merge(v, u) ;</span><br><span class="line">        f1 = find(u), f2 = find(v) ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; f1 &lt;&lt; " " &lt;&lt; f2 &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">if</span> (f1 != f2)&#123;</span><br><span class="line">            link(u, i), link(v, i) ;</span><br><span class="line">            <span class="keyword">if</span> (sz[f1] &lt; sz[f2])</span><br><span class="line">                f[f1] = f2, sz[f2] += sz[f1] ;</span><br><span class="line">            <span class="keyword">else</span> f[f2] = f1, sz[f1] += sz[f2] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (vb(i) &lt; vb(val[u]))</span><br><span class="line">            cut(val[u]), link(u, i), link(v, i) ;</span><br><span class="line">        <span class="keyword">if</span> (find(m + <span class="number">1</span>) == find(m + n))</span><br><span class="line">            merge(m + <span class="number">1</span>, n + m),</span><br><span class="line">            ans = Min(ans, va(i) + vb(val[n + m]) ) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; (ans == MAX ? <span class="number">-1</span> : ans) &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æˆ‘åœ¨æ°´åšå®¢ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„/LCT</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ³›åšã€‘LCTç®€å•é¢˜é€‰åš</title>
    <url>/2020/01/24/LCT2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚æ˜¯é‡å­¦äº†ä¸€é $\rm LCT$ã€‚ç„¶åæ•´ç†ä¸€ä¸‹ä¹‹å‰åšè¿‡çš„é¢˜ï¼Ÿå¤§å¤šæ•°éƒ½æ¯”è¾ƒå¥—è·¯ã€‚</p>
<a id="more"></a>
<h1 id="SDOI2008-æ´ç©´å‹˜æµ‹"><a href="#SDOI2008-æ´ç©´å‹˜æµ‹" class="headerlink" title="[SDOI2008]æ´ç©´å‹˜æµ‹"></a>[SDOI2008]æ´ç©´å‹˜æµ‹</h1><blockquote>
<p>åŠ¨æ€ç»´æŠ¤å›¾çš„è¿é€šæ€§ã€‚</p>
<p>ä¿è¯ä»»æ„æ—¶åˆ»å›¾çš„è¾¹æ•°ä¸è¶…è¿‡ $n-1$ æ¡ã€‚</p>
</blockquote>
<p>å‘ç°æ˜¯ä¸ªsbçº¿æ®µæ ‘åˆ†æ²»ï¼Œç„¶åéšä¾¿å†™ä¸ªlctå°±è¿‡äº†ï¼ˆ</p>
<h1 id="COCI-2009-OTOCI-æåœ°æ—…è¡Œç¤¾"><a href="#COCI-2009-OTOCI-æåœ°æ—…è¡Œç¤¾" class="headerlink" title="[COCI 2009] OTOCI / æåœ°æ—…è¡Œç¤¾"></a>[COCI 2009] OTOCI / æåœ°æ—…è¡Œç¤¾</h1><blockquote>
<p>ç»™å‡ºä¸€å¼ ç©ºå›¾</p>
<ul>
<li><p><code>bridge u v</code>ï¼šè¯¢é—®ç»“ç‚¹ uä¸ç»“ç‚¹ $v$ æ˜¯å¦è¿é€šã€‚å¦‚æœæ˜¯åˆ™è¾“å‡º <code>no</code>ï¼›å¦åˆ™è¾“å‡º <code>yes</code>ï¼Œå¹¶ä¸”åœ¨ç»“ç‚¹ $u$ å’Œç»“ç‚¹ $v$ ä¹‹é—´è¿ä¸€æ¡æ— å‘è¾¹ã€‚</p>
</li>
<li><p><code>penguins u x</code>ï¼šå°†ç»“ç‚¹ $u$ å¯¹åº”çš„æƒå€¼$ w_u$ ä¿®æ”¹ä¸º $x$ã€‚</p>
</li>
<li><p><code>excursion u v</code>ï¼šå¦‚æœç»“ç‚¹ $u$ å’Œç»“ç‚¹ $v$ ä¸è¿é€šï¼Œåˆ™è¾“å‡º <code>impossible</code>ã€‚å¦åˆ™è¾“å‡ºç»“ç‚¹ $u$ åˆ°ç»“ç‚¹ $v$ çš„è·¯å¾„ä¸Šçš„ç‚¹å¯¹åº”çš„æƒå€¼çš„å’Œã€‚</p>
</li>
</ul>
<p>ä¿è¯ä¸¤ç‚¹å­˜åœ¨è‡³å¤šä¸€æ¡è·¯å¾„ã€‚</p>
</blockquote>
<p>å‘ç°æ˜¯ä¸ªå¼±æ™ºé¢˜ï¼Œéšä¾¿ç»´æŠ¤ä¸€ä¸‹å°±å¯ä»¥ã€‚</p>
<h1 id="BJOI2014-å¤§èåˆ"><a href="#BJOI2014-å¤§èåˆ" class="headerlink" title="[BJOI2014]å¤§èåˆ"></a>[BJOI2014]å¤§èåˆ</h1><blockquote>
<p>ç»™å‡ºä¸€å¼ ç©ºå›¾</p>
<ul>
<li><code>A x y</code> ï¼šè‹¥ $x$ å’Œ $y$ä¸è¿é€šåˆ™è¿è¾¹.</li>
<li><code>Q x y</code> ï¼šè¯¢é—® $a$ å’Œ $b$ åœ¨è¾¹ $(x,y)$ ä¸¤ç«¯çš„ $(a,b)$ ç‚¹å¯¹æ•°ã€‚ </li>
</ul>
</blockquote>
<p>è€ƒè™‘å®å„¿å­å’Œè™šå„¿å­æ•°é‡åˆ†åˆ«ç»´æŠ¤ã€‚å‘ç°åªæœ‰ <code>access</code> å’Œ <code>link</code> éœ€è¦ä¿®æ”¹ã€‚äºæ˜¯é­”æ”¹ä¸€ä¸‹å°±åšå®Œäº†ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Access</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> qwq = <span class="number">0</span> ; x ; x = T[qwq = x].F) </span><br><span class="line">		splay(x), npn[x] += size[rc] - size[qwq], rc = qwq, push_up(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Rooten</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    Access(x), splay(x), reverse(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    Rooten(x), Access(y), splay(y) ;</span><br><span class="line">    T[x].F = y, npn[y] += size[x], push_up(y) ;</span><br><span class="line">&#125;<span class="comment">//npnç»´æŠ¤è™šå„¿å­</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æŸ¥è¯¢çš„æ—¶å€™éœ€è¦è¿™æ ·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span>(M --)&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s%d%d"</span>, O, &amp;A, &amp;B) ; <span class="keyword">if</span> (O[<span class="number">0</span>] == <span class="string">'A'</span>) Link(A, B) ;</span><br><span class="line">    <span class="keyword">else</span> Rooten(A), Access(B), splay(B), <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, <span class="number">1L</span>L * size[A] * (size[B] - size[A])) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€Œä¸æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span>(M --)&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s%d%d"</span>, O, &amp;A, &amp;B) ; <span class="keyword">if</span> (O[<span class="number">0</span>] == <span class="string">'A'</span>) Link(A, B) ;</span><br><span class="line">    <span class="keyword">else</span> Rooten(A), <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, <span class="number">1L</span>L * size[B] * (size[A] - size[B])) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤§æ¦‚å¯ä»¥ç†è§£æˆæœå‘çš„é—®é¢˜ï¼Œå°±æ˜¯Bçš„sizeæ–¹å‘æ²¡æ›´æ–°ï¼Œæ‰€ä»¥è¦æ”¹ä¸€ä¸‹æœå‘ã€‚ä¹Ÿå°±æ˜¯iæœ¬æ¥LCTæ˜¯æ²¡æœ‰æ ¹çš„ï¼Œmake_rootå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ— æ ¹æ ‘è½¬æœ‰æ ¹æ ‘çš„è¿‡ç¨‹ï¼Œä½†æ˜¯è½¬å®Œä¹‹åé™¤äº†å’Œuä¸€ä¸ªsplayé‡Œçš„ç‚¹ï¼Œå‰©ä¸‹çš„ç‚¹éƒ½ä¸çŸ¥é“æ¢æ ¹äº†ã€‚</p>
<p>å—¯ï¼Œæˆ‘è§‰å¾—è¿™ä¹ˆç¼–ååˆ†æœ‰é“ç†ã€‚</p>
<h1 id="å›½å®¶é›†è®­é˜Ÿ-Tree-II"><a href="#å›½å®¶é›†è®­é˜Ÿ-Tree-II" class="headerlink" title="[å›½å®¶é›†è®­é˜Ÿ]Tree II"></a>[å›½å®¶é›†è®­é˜Ÿ]Tree II</h1><blockquote>
<p>ä¸€æ£µ $n$ ä¸ªç‚¹çš„æ ‘ï¼Œæ¯ä¸ªç‚¹çš„åˆå§‹æƒå€¼ä¸º $1$ã€‚</p>
<p>å¯¹äºè¿™æ£µæ ‘æœ‰ $q$ ä¸ªæ“ä½œï¼Œæ¯ä¸ªæ“ä½œä¸ºä»¥ä¸‹å››ç§æ“ä½œä¹‹ä¸€ï¼š</p>
<ul>
<li><code>+ u v c</code>ï¼šå°† $u$ åˆ° $v$ çš„è·¯å¾„ä¸Šçš„ç‚¹çš„æƒå€¼éƒ½åŠ ä¸Šè‡ªç„¶æ•° $c$ ï¼›</li>
<li><code>- u1 v1 u2 v2</code>ï¼šå°†æ ‘ä¸­åŸæœ‰çš„è¾¹ $(u_1,v_1)$ åˆ é™¤ï¼ŒåŠ å…¥ä¸€æ¡æ–°è¾¹ $(u_2,v_2)$ï¼Œä¿è¯æ“ä½œå®Œä¹‹åä»ç„¶æ˜¯ä¸€æ£µæ ‘ ï¼›</li>
<li><code>* u v c</code>ï¼šå°† $u$ åˆ° $v$ çš„è·¯å¾„ä¸Šçš„ç‚¹çš„æƒå€¼éƒ½ä¹˜ä¸Šè‡ªç„¶æ•° $c$ ï¼›</li>
<li><code>/ u v</code>ï¼šè¯¢é—® $u$ åˆ° $v$ çš„è·¯å¾„ä¸Šçš„ç‚¹çš„æƒå€¼å’Œï¼Œå°†ç­”æ¡ˆå¯¹ $51061$ å–æ¨¡ã€‚</li>
</ul>
</blockquote>
<p>å‘ç°å°±æ˜¯å¾ˆæ¿çš„ $\rm LCT$ ï¼Ÿsplayç»´æŠ¤ä¸€ä¸‹åŠ æ³•å’Œä¹˜æ³• <code>tag</code> å°±å¥½äº†ã€‚</p>
<p>ä¸»è¦æ˜¯è®°å½•ä¸€ä¸‹ä»£ç â€¦</p>
<p>å¥½ä¹…ä¹‹å‰åšçš„é¢˜äº†ï¼Œå½“æ—¶ç»™å‡½æ•°çèµ·äº†ä¸€ä¸ª <code>split</code> çš„åå­—ï¼Œå¹¶ä¸”ç é£å¥‡å·®ï¼Œæ„Ÿè§‰è‡ªå·±å¾ˆå¼Ÿå¼Ÿã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> O[<span class="number">3</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LCT</span>&#123;</span></span><br><span class="line">	<span class="keyword">bool</span> R ; <span class="keyword">long</span> <span class="keyword">long</span> tagv, tags ; </span><br><span class="line">	<span class="keyword">int</span> F, Son[<span class="number">2</span>], sz ; <span class="keyword">long</span> <span class="keyword">long</span> s, v  ;</span><br><span class="line">&#125;T[MAXN] ; <span class="keyword">int</span> stk[MAXN], base[MAXN], N, M, A, B, C, i ;</span><br><span class="line">                                                       </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span> </span>;     </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span> </span>; </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x)</span> </span>;   </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span> </span>;                        </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">long</span> <span class="keyword">long</span> y)</span> </span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">long</span> <span class="keyword">long</span> y)</span> </span>;   </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; lc ^= rc ^= lc ^= rc, T[x].R ^= <span class="number">1</span> ;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> T[T[x].F].Son[<span class="number">0</span>] == x || T[T[x].F].Son[<span class="number">1</span>] == x ;  &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Access</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> qwq = <span class="number">0</span> ; x ; x = T[qwq = x].F) splay(x), rc = qwq, update(x) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">long</span> <span class="keyword">long</span> y)</span> </span>&#123; (T[x].s += y * size) %= Mod, (T[x].v += y) %= Mod, (T[x].tags += y) %= Mod ; &#125;  </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; T[x].s = (T[lc].s + T[rc].s + T[x].v) % Mod ; T[x].sz = T[lc].sz + T[rc].sz + <span class="number">1</span> ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">long</span> <span class="keyword">long</span> y)</span> </span>&#123; (T[x].s *= y) %= Mod, (T[x].v *= y) %= Mod, (T[x].tagv *= y) %= Mod ; (T[x].tags *= y) %= Mod ; &#125;  </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> fa = T[x].F, g_fa = T[fa].F, W = x == T[fa].Son[<span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">if</span> (check(fa)) T[g_fa].Son[T[g_fa].Son[<span class="number">1</span>] == fa] = x ; T[x].F = g_fa ;</span><br><span class="line">    T[fa].Son[W] = T[x].Son[W ^ <span class="number">1</span>], T[T[x].Son[W ^ <span class="number">1</span>]].F = fa, T[fa].F = x, T[x].Son[W ^ <span class="number">1</span>] = fa, update(fa), update(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">register</span> <span class="keyword">int</span> qwq = x, t = <span class="number">1</span> ; stk[<span class="number">1</span>] = x ;</span><br><span class="line">	<span class="keyword">while</span>(check(qwq)) stk[++ t] = (qwq = T[qwq].F) ;</span><br><span class="line">	<span class="keyword">while</span>(t) push_down(stk[t --]) ;</span><br><span class="line">	<span class="keyword">while</span>(check(x))&#123;</span><br><span class="line">		<span class="keyword">register</span> <span class="keyword">int</span> fa = T[x].F, g_fa = T[fa].F ;</span><br><span class="line">		<span class="keyword">if</span> (check(fa)) rotate((T[g_fa].Son[<span class="number">1</span>] == fa) == (T[fa].Son[<span class="number">1</span>] == x) ? fa : x) ; rotate(x) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> res = <span class="number">0</span>, k = <span class="number">1</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) &#123; <span class="keyword">if</span> (c == <span class="string">'-'</span>) k = <span class="number">-1</span> ; c = getchar() ;&#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) res = (res &lt;&lt; <span class="number">1</span>) + (res &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> res * k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Rooten</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; Access(x), splay(x), reverse(x) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; Rooten(x), Access(y), splay(y) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; Rooten(x) ;  T[x].F = y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Cut</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; split(x, y) ; T[x].F = T[y].Son[<span class="number">0</span>] = <span class="number">0</span> ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; </span><br><span class="line">	<span class="keyword">if</span> (T[x].tagv != <span class="number">1</span>) Mul(lc, T[x].tagv), Mul(rc, T[x].tagv), T[x].tagv = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">if</span> (T[x].tags)	    Add(lc, T[x].tags), Add(rc, T[x].tags), T[x].tags = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">if</span> (T[x].R) 	&#123; T[x].R = <span class="number">0</span> ; <span class="keyword">if</span> (lc) reverse(lc) ; <span class="keyword">if</span> (rc) reverse(rc) ;&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">	rep(i, <span class="number">1</span>, N) T[i].v = T[i].tagv = T[i].sz = <span class="number">1</span> ;</span><br><span class="line">	rep(i ,<span class="number">1</span>, N - <span class="number">1</span>) A = qr(), B = qr(), Link(A, B) ;</span><br><span class="line">	rep(i, <span class="number">1</span>, M)&#123;</span><br><span class="line">	    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;O) ;</span><br><span class="line">		<span class="keyword">if</span> (O[<span class="number">0</span>] == <span class="string">'+'</span>) A = qr(), B = qr(), C = qr(), split(A, B), Add(B, C) ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (O[<span class="number">0</span>] == <span class="string">'*'</span>) A = qr(), B = qr(), C = qr(), split(A, B), Mul(B, C) ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (O[<span class="number">0</span>] == <span class="string">'/'</span>) A = qr(), B = qr(), split(A, B), <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, T[B].s) ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (O[<span class="number">0</span>] == <span class="string">'-'</span>) A = qr(), B = qr(), Cut(A, B), A = qr(), B = qr(), Link(A, B) ;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„/LCT</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘Cf938G Shortest Path Queries</title>
    <url>/2020/01/24/Cf938G/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç»™å‡ºä¸€ä¸ªè¿é€šå¸¦æƒæ— å‘å›¾,è¾¹æœ‰è¾¹æƒ,è¦æ±‚æ”¯æŒ $q$ ä¸ªæ“ä½œ:</p>
<p><code>1 x y d</code> åœ¨åŸå›¾ä¸­åŠ å…¥ä¸€æ¡ $x$ åˆ° $y$ æƒå€¼ä¸º $b$ çš„è¾¹ã€‚</p>
<p><code>2 x y</code> æŠŠå›¾ä¸­ $x$ åˆ° $y$ çš„è¾¹åˆ æ‰ã€‚</p>
<p><code>3 x y</code> è¡¨ç¤ºè¯¢é—® $x$ åˆ° $y$ çš„å¼‚æˆ–æœ€çŸ­è·¯ã€‚</p>
<p>ä¿è¯ä»»æ„æ“ä½œååŸå›¾è¿é€šæ— é‡è¾¹è‡ªç¯ä¸”æ“ä½œå‡åˆæ³•ã€‚</p>
<p>$1\leq n,m,q\leq 200000$</p>
<a id="more"></a>
<p>è¿™é¢˜å’Œ [HAOI2017] çš„é‚£ä¸ªä¸æ˜¯å¾ˆç›¸åŒã€‚é‚£é¢˜æ¯”è¾ƒå¼±æ™ºï¼Œæ¯æ¬¡è¯¢é—®çš„åªæ˜¯åŒ…æ‹¬ $1$ çš„åœˆï¼Œä½†æ˜¯è¿™é¢˜éœ€è¦ç»´æŠ¤è¿é€šæ€§ï¼Œå¹¶ä¸”æ²¡æœ‰åˆå§‹è¾¹ã€‚æ‰€ä»¥å°±éœ€è¦ç»´æŠ¤ä¸€ä¸ªå¯æ’¤é”€çš„ $dsu$ æ¥é…åˆæ“ä½œã€‚</p>
<p>å—¯ï¼Œåˆå†™äº†ä¸€éå‘ç°è¿™ä¸ªå¯æ’¤é”€å¹¶æŸ¥é›†çš„å®ç°å¯èƒ½éœ€è¦å†é¢†æ‚Ÿä¸€ä¸‹ã€‚</p>
<p>æ„Ÿè§‰ä»£ç å®ç°æ–¹é¢è¿˜æœ‰å¾ˆå¤šéœ€è¦ç†Ÿæ‚‰çš„å•Šâ€¦å°¤å…¶æ˜¯çº¿æ€§åŸºç»´æŠ¤ç”Ÿæˆæ ‘ã€ç›´æ¥ç”¨ <code>query(x) &amp; query(y)</code> å°±å¯ä»¥ç›´æ¥æ±‚å‡ºè¯¢é—®ï¼Œæ„Ÿè§‰å¾ˆç¥å¥‡ã€‚æ…¢æ…¢å­¦ã€æ…¢æ…¢æ¥å§ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gcr getchar</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_b push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mkp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pint pair<span class="meta-string">&lt;int,int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> B = <span class="number">30</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">400010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">800010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, l, r, val ;</span><br><span class="line">&#125;e[M] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qss</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v ;</span><br><span class="line">&#125;qs[N] ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> f[N] ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, q ;</span><br><span class="line"><span class="keyword">int</span> tot, cntq ;</span><br><span class="line"><span class="keyword">int</span> fa[N], sz[N] ;</span><br><span class="line"><span class="built_in">map</span> &lt;pint, <span class="keyword">int</span>&gt; sch ;</span><br><span class="line"><span class="built_in">vector</span> &lt;edge&gt; S[N &lt;&lt; <span class="number">2</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">xxj</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> base[<span class="number">50</span>] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; x &lt;&lt; endl;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = B ; ~k ; -- k)</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1l</span>l &lt;&lt; k &amp; x)&#123;</span><br><span class="line">                <span class="keyword">if</span> (base[k]) x ^= base[k] ;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">return</span> base[k] = x, <span class="keyword">void</span>() ;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Query</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ret = x ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = B ; ~i ; -- i)</span><br><span class="line">            ret = min(ret, ret ^ base[i]) ;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;F ;</span><br><span class="line"><span class="comment">//using namespace xxj ;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qr</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    x = <span class="number">0</span> ; <span class="keyword">char</span> c = gcr() ;</span><br><span class="line">    <span class="keyword">while</span> (c &gt; <span class="string">'9'</span> || c &lt; <span class="string">'0'</span>) c = gcr() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) x = x * <span class="number">10</span> + c - <span class="number">48</span>, c = gcr() ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, edge val)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ul &gt; ur) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= l &amp;&amp; r &lt;= ur)</span><br><span class="line">        <span class="keyword">return</span> S[rt].p_b(val), <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, l, mid, ul, ur, val) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid) update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ul, ur, val) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dofa</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (x != fa[x])</span><br><span class="line">        x = fa[x] ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">doxor</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (x != fa[x])</span><br><span class="line">        ret ^= f[x], x = fa[x] ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, xxj now)</span></span>&#123;</span><br><span class="line">    <span class="built_in">vector</span> &lt;edge&gt; O ; <span class="comment">//O.clear() ;</span></span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; <span class="keyword">bool</span> flag = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; S[rt].size() ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> u = S[rt][i].u ;</span><br><span class="line">        <span class="keyword">int</span> v = S[rt][i].v ;</span><br><span class="line">        <span class="keyword">int</span> w = S[rt][i].val ;</span><br><span class="line">        <span class="keyword">int</span> f1 = dofa(u), f2 = dofa(v) ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; u &lt;&lt; " " &lt;&lt; v &lt;&lt; " " &lt;&lt; w &lt;&lt; endl ;</span></span><br><span class="line">        <span class="comment">//cout &lt;&lt; f1 &lt;&lt; " " &lt;&lt; f2 &lt;&lt; " " &lt;&lt; sz[f1] &lt;&lt; " " &lt;&lt; sz[f2] &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">if</span> (f1 != f2)&#123;</span><br><span class="line">            <span class="keyword">if</span> (sz[f1] &gt; sz[f2])</span><br><span class="line">                swap(f1, f2), swap(u, v) ;</span><br><span class="line">            O.p_b((edge)&#123;f1, f2, sz[f2]&#125;) ;</span><br><span class="line">            fa[f1] = f2, sz[f2] += sz[f1],</span><br><span class="line">            f[f1] = doxor(u) ^ doxor(v) ^ w ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> now.Insert(doxor(u) ^ doxor(v) ^ w) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        ans[l] = now.Query(doxor(qs[l].u) ^ doxor(qs[l].v)) ;</span><br><span class="line">    <span class="keyword">else</span> solve(rt &lt;&lt; <span class="number">1</span>, l, mid, now),</span><br><span class="line">         solve(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, now) ;</span><br><span class="line">    <span class="comment">//for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; f[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = O.size() - <span class="number">1</span> ; ~i ; -- i)</span><br><span class="line">        fa[O[i].u] = O[i].u, sz[O[i].v] = O[i].l, f[O[i].u] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">int</span> u, v, w, mk ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        fa[i] = i, sz[i] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        qr(u), qr(v), qr(w) ;</span><br><span class="line">        e[++ tot] = (edge)&#123;u, v, <span class="number">1</span>, <span class="number">-1</span>, w&#125; ;</span><br><span class="line">        sch[mkp(u, v)] = tot ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; q ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)&#123;</span><br><span class="line">        qr(mk), qr(u), qr(v) ;</span><br><span class="line">        <span class="keyword">if</span> (u &gt; v) swap(u, v) ;</span><br><span class="line">        <span class="keyword">if</span> (mk == <span class="number">1</span>)</span><br><span class="line">            qr(w), ++ tot,</span><br><span class="line">            sch[mkp(u, v)] = tot,</span><br><span class="line">            e[tot] = (edge)&#123;u, v, cntq + <span class="number">1</span>, <span class="number">-1</span>, w&#125; ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (mk == <span class="number">2</span>)</span><br><span class="line">            e[sch[mkp(u,v)]].r = cntq ;</span><br><span class="line">        <span class="keyword">else</span> qs[++ cntq] = (qss)&#123;u, v&#125; ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (e[i].r &lt; <span class="number">0</span>) e[i].r = cntq ;</span><br><span class="line">   <span class="comment">// for (int i = 1 ; i &lt;= tot ; ++ i)</span></span><br><span class="line">    <span class="comment">//    cout &lt;&lt; e[i].l &lt;&lt; " " &lt;&lt; e[i].r &lt;&lt; " " &lt;&lt; e[i].u &lt;&lt; " " &lt;&lt; e[i].v &lt;&lt; " " &lt;&lt; e[i].val &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i)</span><br><span class="line">        update(<span class="number">1</span>, <span class="number">1</span>, cntq, e[i].l, e[i].r, e[i]) ;</span><br><span class="line">    solve(<span class="number">1</span>, <span class="number">1</span>, cntq, F) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cntq ; ++ i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>ç¦»çº¿ç®—æ³•/çº¿æ®µæ ‘åˆ†æ²»</tag>
        <tag>çº¿æ€§ä»£æ•°/çº¿æ€§ç©ºé—´/çº¿æ€§åŸº</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘loj#2312 [HAOI2017]å…«çºµå…«æ¨ª</title>
    <url>/2020/01/24/HAOI2017%E5%85%AB%E7%BA%B5%E5%85%AB%E6%A8%AA/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å…¶å®ä¸æ˜¯ä»€ä¹ˆéš¾é¢˜ï¼Œåªæ˜¯å› ä¸ºã€Œå†™èµ·æ¥å¾ˆéº»çƒ¦ã€+ã€Œå•ç‹¬æ‹¿å‡ºæ¥æ–¹ä¾¿è®°å¿†ã€æ‰€ä»¥å•ç‹¬å¼€ä¸€ç¯‡ã€‚</p>
<a id="more"></a>
<p>Anihc å›½æœ‰ $n$ ä¸ªåŸå¸‚ï¼Œè¿™ $n$ ä¸ªåŸå¸‚ä» $1$ ç¼–å·ï¼Œ$1$ å·åŸå¸‚ä¸ºé¦–éƒ½ã€‚åŸå¸‚é—´åˆå§‹æ—¶æœ‰ $m$ æ¡é«˜é€Ÿå…¬è·¯ï¼Œæ¯æ¡é«˜é€Ÿå…¬è·¯éƒ½æœ‰ä¸€ä¸ªéè´Ÿæ•´æ•°çš„ç»æµå½±å“å› å­ï¼Œæ¯æ¡é«˜é€Ÿå…¬è·¯çš„ä¸¤ç«¯éƒ½æ˜¯åŸå¸‚ï¼ˆå¯èƒ½ä¸¤ç«¯æ˜¯åŒä¸€ä¸ªåŸå¸‚)ï¼Œä¿è¯ä»»æ„ä¸¤ä¸ªåŸå¸‚éƒ½å¯ä»¥é€šè¿‡é«˜é€Ÿå…¬è·¯äº’è¾¾ã€‚</p>
<p>Anihc å›½æ­£åœ¨ç­¹åˆ’ã€Œå…«çºµå…«æ¨ªã€çš„é«˜é“å»ºè®¾è®¡åˆ’ï¼Œè®¡åˆ’è¦ä¿®å»ºä¸€äº›é«˜é€Ÿé“è·¯ï¼Œæ¯æ¡é«˜é€Ÿé“è·¯ä¸¤ç«¯ä¹Ÿéƒ½æ˜¯åŸå¸‚ï¼ˆå¯èƒ½ä¸¤ç«¯æ˜¯åŒä¸€ä¸ªåŸå¸‚)ï¼Œä¹Ÿéƒ½æœ‰ä¸€ä¸ªéè´Ÿæ•´æ•°çš„ç»æµå½±å“å› å­ã€‚å›½å®¶è¿˜è®¡åˆ’åœ¨ã€Œå…«çºµå…«æ¨ªã€è®¡åˆ’å»ºæˆä¹‹åï¼Œå°†ã€Œä¸€å¸¦ä¸€è·¯ã€æ‰©å±•ä¸ºã€Œä¸€å¸¦ä¸€è·¯ä¸€ç¯ã€ï¼Œå¢åŠ ã€Œå†…é™†åŸå¸‚ç»æµç¯ã€å³é€‰æ‹©ä¸€æ¡ä»é¦–éƒ½å‡ºå‘æ²¿è‹¥ä¸€ç³»åˆ—é«˜é“ä¸é«˜é€Ÿå…¬è·¯èµ°çš„è·¯å¾„ï¼Œæ¯æ¡é«˜é“æˆ–é«˜é€Ÿå…¬è·¯å¯ä»¥ç»è¿‡å¤šæ¬¡ï¼Œæ¯åº§åŸå¸‚ä¹Ÿå¯ä»¥ç»è¿‡å¤šæ¬¡ï¼Œæœ€åè·¯å¾„åˆåœ¨é¦–éƒ½ç»“æŸã€‚ä»¤ã€Œå†…é™†åŸå¸‚ç»æµç¯ã€çš„ $\rm GDP$ ä¸ºä¾æ¬¡å°†è¿™æ¡è·¯å¾„ä¸Šæ‰€ç»è¿‡çš„é«˜é“æˆ–é«˜é€Ÿå…¬è·¯çš„ç»æµå½±å“å› å­å¼‚æˆ–èµ·æ¥ï¼ˆä¸€æ¡è·¯ç»è¿‡å¤šæ¬¡åˆ™ä¼šè¢«è®¡ç®—å¤šæ¬¡ï¼‰ã€‚</p>
<p>ç°åœ¨ Anihc åœ¨ä¼šè®®ä¸Šè®¨è®ºã€Œå…«çºµå…«æ¨ªã€çš„å»ºè®¾è®¡åˆ’æ–¹æ¡ˆï¼Œä»–ä»¬ä¼šä¸æ–­åœ°ä¿®æ”¹è®¡åˆ’æ–¹æ¡ˆï¼Œå¸Œæœ›ä½ èƒ½å®æ—¶åé¦ˆå¯¹äºå½“å‰çš„ã€Œå…«çºµå…«æ¨ªã€çš„å»ºè®¾è®¡åˆ’çš„æ–¹æ¡ˆã€Œå†…é™†åŸå¸‚ç»æµç¯ã€çš„æœ€å¤§æ˜¯å¤šå°‘ã€‚</p>
<p>åˆå§‹æ—¶ï¼Œå…«çºµå…«æ¨ªè®¡åˆ’ä¸­ä¸åŒ…å«ä»»ä½•â€”æ¡é«˜é“ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æ“ä½œï¼š</p>
<p><code>Add x y z</code>  åœ¨è®¡åˆ’ä¸­ç»™åœ¨åŸå¸‚ $x$ å’ŒåŸå¸‚ $y$ ä¹‹é—´å»ºè®¾ä¸€æ¡é«˜é“ï¼Œå…¶ç»æµå½±å“å› å­ä¸º $z$ï¼Œå¦‚æœè¿™æ˜¯ç¬¬ $k$ ä¸ª <code>Add</code> æ“ä½œï¼Œåˆ™å°†è¿™æ¡é«˜é“å‘½åä¸º $k$ å·é«˜é“ã€‚</p>
<p><code>Cancel k</code>  å°†è®¡åˆ’ä¸­çš„ $k$ å·é«˜é“å–æ¶ˆæ‰ï¼Œä¿è¯æ­¤æ—¶ $k$ å·é«˜é“ä¸€å®šå­˜åœ¨ã€‚</p>
<p><code>Change k z</code>  è¡¨ç¤ºå°†ç¬¬ $k$ å·é«˜é“çš„ç»æµå½±å“å› å­æ›´æ”¹ä¸º $z$ï¼Œä¿è¯æ­¤æ—¶ $k$ å·é«˜é“ä¸€å®šå­˜åœ¨.</p>
<h2 id="rm-Sol"><a href="#rm-Sol" class="headerlink" title="$\rm Sol$"></a>$\rm Sol$</h2><p>ä¸å¾—ä¸è¯´è¿™é¢˜æœ‰ç‚¹æ¶å¿ƒâ€¦å› ä¸ºä»–éœ€è¦ <code>bitset</code>ï¼Œäºæ˜¯å„ç§æ“ä½œå°±å¾ˆä¸ä¼˜ç¾ã€‚</p>
<p>å¤§æ¦‚å°±æ˜¯è€ƒè™‘ç”¨çº¿æ®µæ ‘åˆ†æ²»å»ç»´æŠ¤è¾¹çš„å­˜åœ¨æ€§ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯ä¸€å¼€å§‹éšä¾¿ $dfs$ å‡ºä¸€ä¸ªç”Ÿæˆæ ‘æ¥ï¼Œç„¶åæ¯æ¬¡è¯¢é—®æ—¶ï¼Œå‘ç°å¯¹äºæ¯ä¸ªåˆæ³•çš„æ–¹æ¡ˆéƒ½æ˜¯ä» $1$ å¼€å§‹çš„ä¸€ä¸ªç¯ã€‚ é‚£ä¹ˆè€ƒè™‘æœ€åä¸€å®šæ˜¯ä¸€äº›ç¯å¥—èµ·æ¥ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åœ¨çº¿æ€§åŸºé‡Œé¢æŸ¥è¯¢ã€‚</p>
<p>åšè¿™é¢˜æ—¶å‘ç°ï¼Œè¿™ä¹ˆåšçš„æ­£ç¡®æ€§åœ¨äºï¼Œå¯ä»¥éšä¾¿ç”Ÿæˆä¸€æ£µæ ‘ã€‚åŒæ—¶ç”Ÿæˆå‡ºæ¥çš„ç¯ä¹Ÿå…·æœ‰ã€Œç”Ÿæˆå­é›†ã€çš„æ€§è´¨ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥æ®æ­¤ç”Ÿæˆæ‰€æœ‰ <strong>å‰©ä¸‹æœªè¢«ç»Ÿè®¡çš„ç¯</strong>ã€‚è¦è¯æ˜å…¶å®ä¹Ÿä¸éš¾ã€‚</p>
<p>æ‰€ä»¥å¯èƒ½è¿™ç§ã€Œçº¿æ€§åŸº+ç”Ÿæˆæ ‘+ç¯ç”Ÿæˆå­é›†ã€çš„ç»“åˆæ˜¯â€œå®Œæ´½â€çš„ï¼Œå³å½¼æ­¤æœ‰ç€å…±åŒçš„æ€§è´¨ï¼Œè¿™ç§æ­é…ä¼¼ä¹ä¸æ˜¯å¾ˆå¸¸è§ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gcr getchar</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_b push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> val(k) E[k].val</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">1010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">6010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">6010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> len ;</span><br><span class="line"><span class="keyword">char</span> s[L] ;</span><br><span class="line"><span class="keyword">int</span> n, m, q ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next ;</span><br><span class="line">    <span class="built_in">bitset</span> &lt;L&gt; val ;</span><br><span class="line">&#125;E[M &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, l, r ;</span><br><span class="line">    <span class="built_in">bitset</span> &lt;L&gt; val ;</span><br><span class="line">&#125;e[M] ;</span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"><span class="built_in">bitset</span> &lt;L&gt; f[N] ;</span><br><span class="line"><span class="built_in">bitset</span> &lt;L&gt; ans[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;edge&gt; S[N * <span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">int</span> head[N], cnt, tot, k ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> xxj&#123;</span><br><span class="line">    <span class="built_in">bitset</span>&lt;L&gt; base[L] ;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Insert</span><span class="params">(<span class="built_in">bitset</span>&lt;L&gt; x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = L - <span class="number">1</span> ; ~i ; -- i)</span><br><span class="line">            <span class="keyword">if</span> (x[i])&#123;</span><br><span class="line">                <span class="keyword">if</span> (base[i][i]) x ^= base[i] ;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">return</span> base[i] = x, i ;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">bitset</span>&lt;L&gt; Query()&#123;</span><br><span class="line">        <span class="built_in">bitset</span>&lt;L&gt; res ; res.reset() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = L - <span class="number">1</span> ; ~i ; -- i)</span><br><span class="line">            <span class="keyword">if</span> (res[i] ^ base[i][i]) res ^= base[i] ;</span><br><span class="line">        <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> xxj ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qr</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    x = <span class="number">0</span> ; <span class="keyword">char</span> c = gcr() ;</span><br><span class="line">    <span class="keyword">while</span> (c &gt; <span class="string">'9'</span> || c &lt; <span class="string">'0'</span>) c = gcr() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) x = x * <span class="number">10</span> + c - <span class="number">48</span>, c = gcr() ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out_put</span><span class="params">(<span class="built_in">bitset</span> &lt;L&gt; x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> flag = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = L - <span class="number">1</span> ; ~i ; -- i)</span><br><span class="line">        <span class="keyword">if</span> (!x[i])</span><br><span class="line">            &#123;<span class="keyword">if</span> (flag) <span class="built_in">putchar</span>(<span class="string">'0'</span>) ;&#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">putchar</span>(<span class="string">'1'</span>), flag = <span class="number">1</span> ;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">bitset</span>&lt;L&gt; get_bit()&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>) ;</span><br><span class="line">    len = <span class="built_in">strlen</span>(s + <span class="number">1</span>) ;</span><br><span class="line">    <span class="built_in">bitset</span> &lt;L&gt; ret ; ret.reset() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= len ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">'1'</span>) ret.<span class="built_in">set</span>(len - i) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="built_in">bitset</span>&lt;L&gt; w)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v, val(cnt) = w ;</span><br><span class="line">    next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line">    to(++ cnt) = u, val(cnt) = w ;</span><br><span class="line">    next(cnt) = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, edge val)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= l &amp;&amp; r &lt;= ur)</span><br><span class="line">        <span class="keyword">return</span> S[rt].p_b(val), <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, l, mid, ul, ur, val) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid) update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ul, ur, val) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; O ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; S[rt].size() ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> u = S[rt][i].u ;</span><br><span class="line">        <span class="keyword">int</span> v = S[rt][i].v ;</span><br><span class="line">        <span class="keyword">int</span> d = Insert(S[rt][i].val ^ f[u] ^ f[v]) ;</span><br><span class="line">        <span class="keyword">if</span> (d &gt;= <span class="number">0</span>) O.p_b(d) ; <span class="comment">//,cout &lt;&lt;d&lt;&lt;endl;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (l == r) ans[l] = Query() ;</span><br><span class="line">    <span class="keyword">else</span> solve(rt &lt;&lt; <span class="number">1</span>, l, mid),</span><br><span class="line">         solve(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; O.size() ; ++ i) base[O[i]].reset() ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    vis[u] = <span class="number">1</span> ; <span class="comment">//cout &lt;&lt; u &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[to(k)])</span><br><span class="line">            Insert(f[u] ^ f[to(k)] ^ val(k)) ;</span><br><span class="line">        <span class="keyword">else</span> f[to(k)] = f[u] ^ val(k), dfs(to(k)) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; q ; <span class="keyword">int</span> u, v ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        qr(u), qr(v), add(u, v, get_bit()) ;</span><br><span class="line">    dfs(<span class="number">1</span>) ;</span><br><span class="line">	<span class="comment">//for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; f[i].count() &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>) ;<span class="comment">// cout &lt;&lt; i &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">if</span> (s[<span class="number">1</span>] == <span class="string">'A'</span>)</span><br><span class="line">            ++ tot, qr(e[tot].u), qr(e[tot].v),</span><br><span class="line">            e[tot].val = get_bit(), e[tot].l = i, e[tot].r = q ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (s[<span class="number">2</span>] == <span class="string">'a'</span>)</span><br><span class="line">            qr(u),</span><br><span class="line">            update(<span class="number">1</span>, <span class="number">0</span>, q, e[u].l, i - <span class="number">1</span>, e[u]), e[u].l = <span class="number">-1</span> ;</span><br><span class="line">        <span class="keyword">else</span> qr(u), update(<span class="number">1</span>, <span class="number">0</span>, q, e[u].l, i - <span class="number">1</span>, e[u]),</span><br><span class="line">             e[u].l = i, e[u].val = get_bit(), e[u].r = q ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//	for (int i = 1 ; i &lt;= tot ; ++ i) </span></span><br><span class="line"><span class="comment">//		cout &lt;&lt; e[i].l &lt;&lt; " " &lt;&lt; e[i].u &lt;&lt; " " &lt;&lt; e[i].v &lt;&lt; " " &lt;&lt; e[i].val.count() &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">//    cout &lt;&lt; 2333 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (~e[i].l) update(<span class="number">1</span>, <span class="number">0</span>, q, e[i].l, q, e[i]) ;</span><br><span class="line">    solve(<span class="number">1</span>, <span class="number">0</span>, q) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= q ; ++ i) out_put(ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>loj</category>
      </categories>
      <tags>
        <tag>ç¦»çº¿ç®—æ³•/çº¿æ®µæ ‘åˆ†æ²»</tag>
        <tag>çº¿æ€§ä»£æ•°/çº¿æ€§ç©ºé—´/çº¿æ€§åŸº</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘çº¿æ®µæ ‘åˆ†æ²»</title>
    <url>/2020/01/24/%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%88%86%E6%B2%BB/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>çº¿æ®µæ ‘åˆ†æ²»ç”¨äºç¦»çº¿å¤„ç†ä¸€äº›å¸¦æœ‰æ—¶é—´å±æ€§çš„æ“ä½œã€‚æœ€å¸¸è§çš„æ˜¯å¯¹äºç»™å®šçš„æ¯ä¸ªæ“ä½œéƒ½åªåœ¨æŸä¸ªæ—¶é—´åŒºé—´å†…å­˜åœ¨æ•ˆåŠ›ï¼Œæ¢è¨€ä¹‹å³æ¯ä¸ªæ“ä½œéƒ½éœ€è¦å¯æ’¤é”€ã€‚</p>
<p>å—¯ï¼ŒåºŸè¯è¯´å®Œäº†ã€‚åšæ³•å¤§æ¦‚å°±æ˜¯æ‹¿çº¿æ®µæ ‘ $+$ <code>vector</code> ç»´æŠ¤ä¸€ä¸‹æ“ä½œåŒºé—´çš„æ‰€æœ‰æ“ä½œï¼Œç„¶åç›´æ¥åœ¨è¯¢é—®é‡ŒæŒ‰æ—¶é—´è·‘åˆ†æ²»ï¼Œé¡ºä¾¿åœ¨çº¿æ®µæ ‘å†…ç»´æŠ¤åˆæ³•ä¿®æ”¹å³å¯ã€‚</p>
<a id="more"></a>
<h1 id="ä¸€é“ä¾‹é¢˜"><a href="#ä¸€é“ä¾‹é¢˜" class="headerlink" title="ä¸€é“ä¾‹é¢˜"></a>ä¸€é“ä¾‹é¢˜</h1><p>ä»¥ä¸‹æ˜¯ $bzoj4025$ :</p>
<blockquote>
<p>ç¥çŠ‡æœ‰ä¸€ä¸ª $n$ ä¸ªèŠ‚ç‚¹çš„å›¾ã€‚</p>
<p>å› ä¸ºç¥çŠ‡æ˜¯ç¥çŠ‡ï¼Œæ‰€ä»¥åœ¨ $\rm T$ æ—¶é—´å†…ä¸€äº›è¾¹ä¼šå‡ºç°åæ¶ˆå¤±ã€‚ç¥çŠ‡è¦æ±‚å‡ºæ¯ä¸€æ—¶é—´æ®µå†…è¿™ä¸ªå›¾æ˜¯å¦æ˜¯äºŒåˆ†å›¾ã€‚è¿™ä¹ˆç®€å•çš„é—®é¢˜ç¥çŠ‡å½“ç„¶ä¼šåšäº†ï¼Œäºæ˜¯ä»–æƒ³è€ƒè€ƒä½ ã€‚</p>
<p>$1\leq n,m,\rm T\leq 10^6$ã€‚</p>
</blockquote>
<p>å¤§æ¦‚å°±æ˜¯é€šè¿‡çº¿æ®µæ ‘+vectorç»´æŠ¤æ¯ä¸ªåŒºé—´åŠ äº†å“ªäº›è¾¹ï¼Œç„¶åé€šè¿‡å¯æ’¤é”€çš„å¹¶æŸ¥é›†æ¥ç»´æŠ¤å½“å‰å›¾å†…æ˜¯å¦æœ‰å¥‡ç¯ã€‚åˆ¤æ–­è¿‡ç¨‹å¤§æ¦‚å°±æ˜¯å¦‚æœå¯ä»¥æœ‰è¾¹åŠ è¿›å»å°±åŠ è¾¹ï¼Œå¦åˆ™åˆ¤æ–­ä¸¤è€…åˆ°æ ¹çš„å®é™…è·ç¦»æ˜¯å¦å¥‡å¶æ€§ç›¸åŒï¼Œå¦‚æœç›¸åŒé‚£ä¹ˆæ·»ä¸Šè¿™æ¡è¾¹ä¸€å®šä¼šä½¿å¾—å‡ºç°ä¸€ä¸ªå¥‡ç¯ã€‚</p>
<p>ç„¶åè¿™é¢˜ç”±äºæœ‰å¥‡ç¯å¯ä»¥æŠŠç­”æ¡ˆè®°ä¸º $0$ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸å†é€’å½’ä¸‹å»ã€‚ä¹Ÿç®—æ˜¯ä¸€ä¸ªå‰ªæï¼Ÿ</p>
<p>å“¦å¯¹ï¼Œç”±äºè¦æ”¯æŒæ’¤é”€ï¼Œæ‰€ä»¥å°±æ¢æˆäº†æŒ‰ $\rm size$ åˆå¹¶çš„å¹¶æŸ¥é›†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> T = <span class="number">400010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, k, ans[T] ;</span><br><span class="line"><span class="keyword">int</span> dis[N], fa[N], sz[N] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edges</span>&#123;</span> <span class="keyword">int</span> u, v ; &#125; ;</span><br><span class="line"><span class="built_in">vector</span> &lt;edges&gt; S[N * <span class="number">3</span>], O ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (x != fa[x])</span><br><span class="line">        x = fa[x] ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">dist</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (x != fa[x])</span><br><span class="line">        ret ^= dis[x], x = fa[x] ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> fr, <span class="keyword">int</span> to)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= ul &amp;&amp; r &lt;= ur)</span><br><span class="line">        <span class="keyword">return</span> S[rt].p_b((edges)&#123;fr, to&#125;), <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, l, mid, ul, ur, fr, to) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid) update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ul, ur, fr, to) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_do</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">bool</span> ret = <span class="number">0</span> ; <span class="built_in">vector</span>&lt;edges&gt;O ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; S[rt].size() ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> u = S[rt][i].u ;</span><br><span class="line">        <span class="keyword">int</span> v = S[rt][i].v ;</span><br><span class="line">        <span class="keyword">int</span> f1 = find(u), f2 = find(v) ;</span><br><span class="line">        <span class="keyword">if</span> (f1 != f2)&#123;</span><br><span class="line">            <span class="keyword">if</span> (sz[f1] &gt; sz[f2])</span><br><span class="line">                swap(f1, f2), swap(u, v) ;</span><br><span class="line">            O.p_b((edges)&#123;f1, f2&#125;) ;</span><br><span class="line">            fa[f1] = f2, sz[f2] += sz[f1] ;</span><br><span class="line">            dis[f1] = dis[u] ^ dis[v] ^ <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (dist(u) == dist(v)) &#123; ret = <span class="number">1</span> ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!ret)</span><br><span class="line">        <span class="keyword">if</span> (l == r) ans[l] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">else</span> do_do(rt &lt;&lt; <span class="number">1</span>, l, mid), do_do(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = O.size() - <span class="number">1</span> ; ~i ; -- i)</span><br><span class="line">        sz[O[i].v] -= sz[O[i].u], dis[O[i].u] = <span class="number">0</span>, fa[O[i].u] = O[i].u ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u, v, l, r ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; l &gt;&gt; r ;</span><br><span class="line">        <span class="keyword">if</span> (l &lt; r) update(<span class="number">1</span>, <span class="number">1</span>, k, l + <span class="number">1</span>, r, u, v) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        fa[i] = i, sz[i] = <span class="number">1</span> ; do_do(<span class="number">1</span>, <span class="number">1</span>, k) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        ans[i] ? <span class="built_in">puts</span>(<span class="string">"Yes"</span>) : <span class="built_in">puts</span>(<span class="string">"No"</span>) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åï¼Œç„¶åå°±æ²¡äº†â€¦</p>
<h1 id="ä¸€äº›æ‹“å±•"><a href="#ä¸€äº›æ‹“å±•" class="headerlink" title="ä¸€äº›æ‹“å±•"></a>ä¸€äº›æ‹“å±•</h1><h2 id="ï¼ˆ1ï¼‰"><a href="#ï¼ˆ1ï¼‰" class="headerlink" title="ï¼ˆ1ï¼‰"></a>ï¼ˆ1ï¼‰</h2><blockquote>
<p>æ±‚ä¸åŒ…å«å…ƒç´  $1\sim n$ çš„ $01$ èƒŒåŒ…ã€‚</p>
<p>$1\leq n,m\leq 2000$</p>
</blockquote>
<p>ç›´æ¥çº¿æ®µæ ‘åˆ†æ²»åšï¼Œç¬¬ $i$ ä¸ªç‰©å“çš„å­˜åœ¨æ—¶é—´æ˜¯ $1\sim i-1$ å’Œ $i+1 \sim n$ .</p>
<p>ä½†æœ‰ä¸ªé—®é¢˜å°±åœ¨äºæ¯æ¬¡è®¡ç®—çš„å¤æ‚åº¦éƒ½æ˜¯ $nw$ çš„ã€‚æ‰€ä»¥æœ€åå¤æ‚åº¦å°±æ˜¯ $nw\log n$ ã€‚</p>
<h2 id="ï¼ˆ2ï¼‰"><a href="#ï¼ˆ2ï¼‰" class="headerlink" title="ï¼ˆ2ï¼‰"></a>ï¼ˆ2ï¼‰</h2><blockquote>
<p>ç»™å®šä¸€å¼ å›¾ï¼Œå¯¹æ‰€æœ‰çš„ $i,j,k$ æ±‚ $i$ åˆ° $j$ ä¸ç»è¿‡ $k$ çš„â½…æ¡ˆæ•°ã€‚</p>
</blockquote>
<p>å‘ç°æœ´ç´ åœ°åšæ˜¯ $n^4$ çš„ã€‚å¯ä»¥é€šè¿‡å’Œä¸Šé¢é‚£é¢˜å·®ä¸å¤šçš„æ–¹æ³•ï¼Œç”¨çº¿æ®µæ ‘åˆ†æ²»ä¼˜åŒ–åˆ° $n^3\log n$ ã€‚</p>
<h1 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h1><p>å…¶å®æˆ‘å…³äºç¦»çº¿ä¸‰å§å¦¹çš„å­¦ä¹ é¡ºåºæ˜¯CDQ-&gt;æ•´ä½“äºŒåˆ†-&gt;çº¿æ®µæ ‘åˆ†æ²»ã€‚æœ€åå­¦çº¿æ®µæ ‘åˆ†æ²»æ˜¯å› ä¸ºç¬¬ä¸€æ¬¡çœ‹è¿™ä¸ªç®—æ³•æ„Ÿè§‰å¾ˆæ‡µâ€¦å°¤å…¶æ˜¯æ‰€æœ‰é¢˜è§£éƒ½åœ¨ç¹å¤å¨å¨é‚£å‡ å¥è¯QAQ</p>
<p>æ€»ä¹‹ï¼Œå¥å·ä¹Ÿæ˜¯ä¸€ä¸ªæ–°çš„å¼€å§‹ï¼Œä¸æ˜¯å—ï¼Ÿ</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>çº¿æ®µæ ‘åˆ†æ²»</category>
      </categories>
      <tags>
        <tag>ç¦»çº¿ç®—æ³•/çº¿æ®µæ ‘åˆ†æ²»</tag>
        <tag>å›¾è®º/äºŒåˆ†å›¾</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘çº¿æ€§åŸº</title>
    <url>/2020/01/24/%E7%BA%BF%E6%80%A7%E5%9F%BA/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>çœŸæ­£çº¿æ€§åŸºçš„å®šä¹‰éœ€è¦æ‰¯åˆ°çº¿ä»£é‚£ä¸€éƒ¨åˆ†ã€‚å› ä¸ºå¿ƒæƒ…ä¸å¥½ï¼Œæ‰€ä»¥é¸½äº†ã€‚</p>
<p>æ­¤å¤„ä¸»è¦è®¨è®ºçš„çº¿æ€§åŸºå®šä¹‰åœ¨å¼‚æˆ–è¿ç®—ä¸Šã€‚å³è€ƒè™‘ç»™å‡ºä¸€ç³»åˆ—æ•´æ•°ï¼Œç§°å…¶ä¸­æŸä¸ªå¯ä»¥é€šè¿‡å¼‚æˆ–è¿ç®—è¡¨å‡ºå…¨éƒ¨å…ƒç´ çš„å­é›†ä¸ºä¸€ç»„<strong>ç”Ÿæˆå­é›†</strong>ï¼Œç§°ä¸€ç»„å½¼æ­¤éƒ½ä¸èƒ½è¢«è¡¨å‡ºå…ƒç´ ä¸º<strong>çº¿æ€§æ— å…³é›†</strong>ã€‚é‚£ä¹ˆ<strong>çº¿æ€§åŸº</strong>å°±æ˜¯ä¸€ç»„<strong>çº¿æ€§æ— å…³ç”Ÿæˆå­é›†</strong>ã€‚</p>
<p>å¦‚æœæŠŠæ¯ä¸ªæ•°çœ‹æˆä¸€ä¸ª $01$ å‘é‡ã€‚å¯ä»¥å¦‚æ˜¯åšçš„åŸå› æ˜¯ä½è¿ç®—æ—¶ä½ä½ç‹¬ç«‹ï¼Œå°±å¦‚åŒç³»æ•°çŸ©é˜µåœ¨åšåˆç­‰å˜æ¢æ—¶è¡Œã€åˆ—åˆ†åˆ«ç‹¬ç«‹ä¸€æ ·ã€‚æ‰€ä»¥è¿™ä¸ªçº¿æ€§ç©ºé—´å†…åŸºçš„ä¸ªæ•°å°±æ˜¯è¿™ä¸ª $01$ çŸ©é˜µçš„ç§©ã€‚æ¢å¥è¯è¯´ï¼Œæ±‚è¿™ä¸ªçš„è¿‡ç¨‹å®Œå…¨å¯ä»¥é€šè¿‡é«˜æ–¯æ¶ˆå…ƒæ¥å®ç°ã€‚</p>
<a id="more"></a> 
<h1 id="1-åŸºæœ¬æ“ä½œ"><a href="#1-åŸºæœ¬æ“ä½œ" class="headerlink" title="$1$ åŸºæœ¬æ“ä½œ"></a>$1$ åŸºæœ¬æ“ä½œ</h1><h2 id="ï¼ˆ1ï¼‰æ’å…¥"><a href="#ï¼ˆ1ï¼‰æ’å…¥" class="headerlink" title="ï¼ˆ1ï¼‰æ’å…¥"></a>ï¼ˆ1ï¼‰æ’å…¥</h2><p>æ™®é€šçš„æ’å…¥é¡ºä¾¿æ¶ˆäº†æ¶ˆå…ƒï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ins</span><span class="params">(LL y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = M ; ~i ; -- i)</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1l</span>l &lt;&lt; i &amp; y) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!x[i]) &#123;</span><br><span class="line">                x[i] = y ;</span><br><span class="line">                ret = <span class="number">1</span> ;</span><br><span class="line">                <span class="keyword">break</span> ;</span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">                y ^= x[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤§æ¦‚æ¶ˆæˆçš„å°±æ˜¯ä¸€ä¸ªå€’ä¸‰è§’çŸ©é˜µã€‚æ˜¾ç„¶æœ€å $x_i$ æœ‰å€¼çš„ä½æ•°å°±æ˜¯è¿™ä¸ªçŸ©é˜µçš„ç§©ã€‚</p>
<p>è™½ç„¶è¿™æ ·æ’å…¥æ²¡é”™ï¼Œä½†æœ‰ä¸€ç§æ›´ç²¾å¦™çš„æ’å…¥æ–¹å¼ã€‚è¿™æ ·æ’å…¥ä¹‹åå¯ä»¥ä¿è¯çº¿æ€§åŸºå†…è‡³å¤šå­˜åœ¨ $1$ ä¸ª $b_i$ ä½ä¸º $1$ çš„æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ins</span><span class="params">(LL y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = M ; ~i ; -- i)</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1l</span>l &lt;&lt; i &amp; y) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!x[i]) &#123;</span><br><span class="line">                x[i] = y ; ret = <span class="number">1</span> ;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span> ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">                	<span class="keyword">if</span> (x[j] &amp;&amp; (y &gt;&gt; j &amp; <span class="number">1</span>)) x[i] ^= x[j] ; </span><br><span class="line">               	<span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span> ; j &lt;= M ; ++ j)</span><br><span class="line">               		<span class="keyword">if</span> (x[j] &gt;&gt; i &amp; <span class="number">1</span>) x[j] ^= x[i] ; </span><br><span class="line">                <span class="keyword">break</span> ;</span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">                y ^= x[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æ¶ˆå‡ºæ¥çš„å°±å¯ä»¥ä¿è¯æ˜¯ä¸€ä¸ªéƒ¨åˆ†å¯¹è§’çš„çŸ©é˜µï¼Œæ¯”ä¸Šä¸‰è§’çŸ©é˜µæœ‰ç€æ›´ä¼˜ç§€çš„æ€§è´¨ã€‚</p>
<h2 id="ï¼ˆ2ï¼‰-è¯¢é—®"><a href="#ï¼ˆ2ï¼‰-è¯¢é—®" class="headerlink" title="ï¼ˆ2ï¼‰ è¯¢é—®"></a>ï¼ˆ2ï¼‰ è¯¢é—®</h2><p>è¯¢é—®æ“ä½œå¸¸(æˆ‘)è§(ä¼š)çš„ï¼Œé¦–å…ˆæ˜¯æ±‚æœ€å¤§å€¼/æœ€å°å€¼ï¼Œè¿™ä¸œè¥¿æ˜¾ç„¶è´ªå¿ƒä¸€éå³å¯ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = M ; ~i ; -- i)</span><br><span class="line">    ans = max/min(ans, ans ^ x[i]) ;</span><br></pre></td></tr></table></figure>
<p>è¿™ç§æ„Ÿè§‰ã€‚ä»å¤§åˆ°å°æšä¸¾ä¸æ˜¯å› ä¸ºè´ªå¿ƒé¡ºåºï¼Œæ˜¯å› ä¸ºè¿™æ ·å¯ä»¥ä¿è¯æ¶ˆå…ƒæ¶ˆå‡ºæ¥æ²¡æœ‰åæ•ˆæ€§ã€‚</p>
<p>ç„¶åæ˜¯è¯¢é—®ç¬¬ $k$ å°/å¤§ã€‚è¿™ä¸œè¥¿çš„è¯ï¼Œè€ƒè™‘å¯¹äºè¿™ä¸ªçº¿æ€§ç©ºé—´ï¼Œä¸€å…±å¯ä»¥å¼ æˆ $2^n$ ä¸ªå€¼ã€‚ç‰¹åˆ¤æ‰ $0$ ä¹‹åï¼Œå‘ç°å¯¹ $k$ äºŒè¿›åˆ¶æ‹†åˆ†å®é™…ä¸Šå°±æ˜¯åœ¨å¯¹è§’çŸ©é˜µé‡Œé¢é€‰æ•°ã€‚æ‰€ä»¥å¦‚æœä¸€å¼€å§‹é€‰æ‹©æ¶ˆæˆå¯¹è§’çŸ©é˜µï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥åšï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">63</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> haha ; LL z ;</span><br><span class="line"><span class="keyword">int</span> n, m, cnt ; LL ans ;</span><br><span class="line">LL base[N], x[M + <span class="number">1</span>], rst[M + <span class="number">1</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ins</span><span class="params">(LL y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = M ; ~i ; -- i)</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1l</span>l &lt;&lt; i &amp; y) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!x[i]) &#123;</span><br><span class="line">                x[i] = y ; ret = <span class="number">1</span> ;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span> ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">                	<span class="keyword">if</span> (x[j] &amp;&amp; (y &gt;&gt; j &amp; <span class="number">1</span>)) x[i] ^= x[j] ; </span><br><span class="line">               	<span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span> ; j &lt;= M ; ++ j)</span><br><span class="line">               		<span class="keyword">if</span> (x[j] &gt;&gt; i &amp; <span class="number">1</span>) x[j] ^= x[i] ; </span><br><span class="line">                <span class="keyword">break</span> ;</span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">                y ^= x[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">query</span><span class="params">(LL k)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (!haha) -- k ;</span><br><span class="line">    <span class="keyword">if</span> (!k) <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">    <span class="keyword">if</span> (k &gt;= (<span class="number">1l</span>l &lt;&lt; cnt)) <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; cnt ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (k &amp; (<span class="number">1l</span>l &lt;&lt; i)) res ^= rst[i] ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; haha = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; base[i], haha &amp;= ins(base[i]) ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m ; <span class="comment">//cout &lt;&lt; haha &lt;&lt; endl ;</span></span><br><span class="line">    cnt = <span class="number">0</span> ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= M ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (x[i]) rst[cnt ++] = x[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;z), <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, query(z)) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æ˜¯ <code>loj#114 kå¤§å¼‚æˆ–å’Œ</code> ã€‚</p>
<h2 id="ï¼ˆ3ï¼‰åˆ é™¤"><a href="#ï¼ˆ3ï¼‰åˆ é™¤" class="headerlink" title="ï¼ˆ3ï¼‰åˆ é™¤"></a>ï¼ˆ3ï¼‰åˆ é™¤</h2><p>è¿™éƒ¨åˆ†æˆ‘å¾ˆè¿·å•Šâ€¦</p>
<p>é¦–å…ˆå¦‚æœå¯ä»¥ç¦»çº¿å°±å¯ä»¥çº¿æ®µæ ‘åˆ†æ²»ï¼Œå‰©ä¸‹çš„å…ˆé¸½ç€ã€‚</p>
<p>å¤§æ¦‚å°±æ˜¯è€ƒè™‘å¦‚æœåˆ é™¤äº†ä¸€ä¸ªä¸åœ¨çº¿æ€§åŸºå†…çš„æ•°ï¼Œé‚£å°±æ— æ‰€è°“äº†ã€‚å¦‚æœåœ¨å…¶ä¸­ï¼Œé‚£ä¹ˆ</p>
<h1 id="2-ç»å…¸åº”ç”¨"><a href="#2-ç»å…¸åº”ç”¨" class="headerlink" title="$2$ ç»å…¸åº”ç”¨"></a>$2$ ç»å…¸åº”ç”¨</h1><blockquote>
<p>[WC2011]æœ€å¤§XORå’Œè·¯å¾„</p>
<p>è€ƒè™‘ä¸€ä¸ªè¾¹æƒä¸ºéè´Ÿæ•´æ•°çš„æ— å‘è¿é€šå›¾ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º $1$ åˆ° $N$ï¼Œè¯•æ±‚å‡ºä¸€æ¡ä» $1$ å·èŠ‚ç‚¹åˆ° $N$ å·èŠ‚ç‚¹çš„è·¯å¾„ï¼Œä½¿å¾—è·¯å¾„ä¸Šç»è¿‡çš„è¾¹çš„æƒå€¼çš„ $\operatorname{XOR}$ å’Œæœ€å¤§ã€‚</p>
<p>$1\leq n,m\leq 10^6$</p>
</blockquote>
<p>ä¸€é“å¾ˆç»å…¸çš„é¢˜ã€‚å¤§æ¦‚æ˜¯ç»´æŠ¤å¼‚æˆ–ç”Ÿæˆæ ‘ã€‚</p>
<p>è€ƒè™‘è¿™é¢˜å…ˆéšä¾¿ç”Ÿæˆä¸€æ¡ $1\sim n$ çš„è·¯å¾„ï¼Œè¿™æ ·å°±æ˜¯é’¦å®šäº†ä¸€é¢—ç”Ÿæˆæ ‘ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„ä¼šæ˜¯ä¸€äº›åœˆã€‚è€ƒè™‘ä»è¿™æ¡è·¯å¾„èµ°å‡ºå»ï¼Œèµ°å®Œå‰©ä¸‹çš„åœˆå†èµ°å›æ¥æ˜¯ä¸€ä¸ªæ¥å›ï¼Œä¸­é—´çš„æ¡¥è¾¹ï¼ˆè£…ä½œï¼‰ä¼šè¢«ç»è¿‡ä¸¤æ¬¡ï¼Œæ‰€ä»¥ä¸éœ€è¦è€ƒè™‘ã€‚</p>
<p>æ‰€ä»¥ <code>dfs</code> ä¸€éå°±è¡Œã€‚é‡åˆ°ç¯å°±ä¸¢åˆ°çº¿æ€§åŸºé‡Œé¢ï¼Œå¦åˆ™è®°å½•ä¸€ä¸‹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Ins</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = B ; ~ i ; -- i)</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1l</span>l &lt;&lt; i &amp; x)&#123;</span><br><span class="line">            <span class="keyword">if</span> (base[i]) x ^= base[i] ;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> base[i] = x, <span class="keyword">void</span>() ;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">Query</span><span class="params">(LL basic)</span></span>&#123;</span><br><span class="line">    LL ret = basic ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = B ; ~i ; -- i)</span><br><span class="line">        ret = max(ret, ret ^ base[i]) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, LL w)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v, val(cnt) = w ;</span><br><span class="line">    next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line">    to(++ cnt) = u, val(cnt) = w ;</span><br><span class="line">    next(cnt) = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, LL res)</span></span>&#123;</span><br><span class="line">    f[u] = res, vis[u] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))</span><br><span class="line">        <span class="keyword">if</span> (!vis[to(k)]) </span><br><span class="line">          dfs(to(k), res ^ val(k)) ;</span><br><span class="line">        <span class="keyword">else</span> Ins(res ^ val(k) ^ f[to(k)]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">int</span> u, v ; LL w ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; w, add(u, v, w) ;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>) ; <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, Query(f[n])) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>çº¿æ€§åŸº</category>
      </categories>
      <tags>
        <tag>çº¿æ€§ä»£æ•°/çº¿æ€§ç©ºé—´/çº¿æ€§åŸº</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘bzoj#3545 Peaks</title>
    <url>/2020/01/24/Peaks/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æœ‰ $n$ åº§å±±å³°ï¼Œæ¯åº§å±±å³°æœ‰ä»–çš„é«˜åº¦ $h_i$ã€‚</p>
<p>æœ‰å±±å³°ä¹‹é—´æœ‰åŒå‘é“è·¯ç›¸è¿ï¼Œå…± $m$ æ¡è·¯å¾„ï¼Œæ¯æ¡è·¯å¾„æœ‰ä¸€ä¸ªå›°éš¾å€¼ã€‚</p>
<p>ç°åœ¨æœ‰ $q$ ç»„è¯¢é—®ï¼Œè¯¢é—®ä»ç‚¹ $v$ å¼€å§‹åªç»è¿‡å›°éš¾å€¼å°äºç­‰äº $x$ çš„è·¯å¾„æ‰€èƒ½åˆ°è¾¾çš„å±±å³°ä¸­ç¬¬ $k$ é«˜çš„å±±å³°ï¼Œå¦‚æœæ— è§£è¾“å‡º $-1$ã€‚</p>
<a id="more"></a>
<p>å‘ç°å¯ä»¥å€å¢ï¼Œå› ä¸º $\leq x$ çš„æƒåœ¨é‡æ„æ ‘ä¸Šæ˜¯ä¸€ä¸ªå­æ ‘ã€‚</p>
<p>å€å¢å®Œäº†å°±å¯ä»¥ç›´æ¥å¥—ä¸»å¸­æ ‘äº†ã€‚ä¸»å¸­æ ‘å¯ä»¥æ¯”è¾ƒç®€å•çš„æŒ‰ç…§å¶å­çš„æ ‡å·å»ºï¼Œæ¯ä¸ªè¾¹ç»“ç‚¹ç»´æŠ¤ä¸€ä¸ª $\rm leftrange$ å’Œ $\rm rightrange$ å³å¯ã€‚</p>
<p>ç­‰ä¼šå„¿ï¼Œæˆ‘å°±æ•´ç†è¿™ä¹ˆç‚¹å„¿ä¸œè¥¿ä¸ºå•¥è¦æ–°å¼€è¿™ä¸€ç¯‡blogå•Šï¼Ÿå¤ªæµªè´¹èµ„æºäº†å§QAQã€‚</p>
<p><del>é‚£çœ‹ä¸Šå»å°±åªèƒ½ç”¨ä»£ç æ¥å ç©ºé—´äº†</del></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr(k) E[k].fr</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> val(k) E[k].val</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">500010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> V = <span class="number">5000010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> fr, to ;</span><br><span class="line">    <span class="keyword">int</span> next, val ;</span><br><span class="line">&#125;E[N &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">int</span> head[N], cnt ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> len ;</span><br><span class="line"><span class="keyword">int</span> dad[N] ;</span><br><span class="line"><span class="keyword">int</span> wth[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, q ;</span><br><span class="line"><span class="keyword">int</span> rg[N][<span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> fa[N][<span class="number">20</span>] ;</span><br><span class="line"><span class="keyword">int</span> base[N], t[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> sum[V], res, sz ;</span><br><span class="line"><span class="keyword">int</span> rt[V], lc[V], rc[V] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = ++ sz ;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> now ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    lc[now] = build(l, mid) ;</span><br><span class="line">    rc[now] = build(mid + <span class="number">1</span>, r) ;</span><br><span class="line">    <span class="keyword">return</span> now ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> last, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = ++ sz ;</span><br><span class="line">    lc[now] = lc[last] ;</span><br><span class="line">    rc[now] = rc[last] ;</span><br><span class="line">    sum[now] = sum[last] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> now ;</span><br><span class="line">    <span class="keyword">if</span> (v &lt;= mid)</span><br><span class="line">        lc[now] = update(lc[last], l, mid, v) ;</span><br><span class="line">    <span class="keyword">else</span> rc[now] = update(rc[last], mid + <span class="number">1</span>, r, v) ;</span><br><span class="line">    <span class="keyword">return</span> now ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rtl, <span class="keyword">int</span> rtr, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">int</span> delta = sum[rc[rtr]] - sum[rc[rtl]] ;</span><br><span class="line">    <span class="keyword">if</span> (v &gt; delta)</span><br><span class="line">        <span class="keyword">return</span> query(lc[rtl], lc[rtr], l, mid, v - delta) ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> query(rc[rtl], rc[rtr], mid + <span class="number">1</span>, r, v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v ;</span><br><span class="line">    val(cnt) = w, fr(cnt) = u ;</span><br><span class="line">    next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x == dad[x] ? x : dad[x] = find(dad[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(Edge A, Edge B)</span></span>&#123; <span class="keyword">return</span> A.val &lt; B.val ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; u &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">18</span> ; ++ i)</span><br><span class="line">        fa[u][i] = fa[fa[u][i - <span class="number">1</span>]][i - <span class="number">1</span>] ;</span><br><span class="line">    rg[u][<span class="number">0</span>] = res ;</span><br><span class="line">    <span class="keyword">if</span> (!head[u])</span><br><span class="line">        rg[u][<span class="number">0</span>] = ++ res,</span><br><span class="line">        rt[res] = update(rt[res - <span class="number">1</span>], <span class="number">1</span>, len, base[u]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k)) dfs(to(k)) ;</span><br><span class="line">    rg[u][<span class="number">1</span>] = res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; q ;</span><br><span class="line">    <span class="keyword">int</span> u, v, w, now, k, tot, op ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), t[i] = base[i] ;</span><br><span class="line">    sort(t + <span class="number">1</span>, t + n + <span class="number">1</span>) ;</span><br><span class="line">    len = unique(t + <span class="number">1</span>, t + n + <span class="number">1</span>) - t - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        base[i] = lower_bound(t + <span class="number">1</span>, t + len + <span class="number">1</span>, base[i]) - t ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;w), add(u, v, w), add(v, u, w) ;</span><br><span class="line">    sort(E + <span class="number">1</span>, E + cnt + <span class="number">1</span>, comp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">2</span> * n ; ++ i) dad[i] = i ;</span><br><span class="line">    fill(head + <span class="number">1</span>, head + n + <span class="number">1</span>, <span class="number">0</span>), op = cnt, tot = n, cnt = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= op ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> f1 = find(fr(i)) ;</span><br><span class="line">        <span class="keyword">int</span> f2 = find(to(i)) ;</span><br><span class="line">        <span class="keyword">if</span> (f1 != f2)&#123;</span><br><span class="line">            now = ++ tot ;</span><br><span class="line">            wth[now] = val(i) ;</span><br><span class="line">            dad[f1] = dad[f2] = now ;</span><br><span class="line">            fa[f1][<span class="number">0</span>] = fa[f2][<span class="number">0</span>] = now ;</span><br><span class="line">            add(now, f1, <span class="number">0</span>),add(now, f2, <span class="number">0</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; tot &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">//for (int i = 1 ; i &lt;= tot ; ++ i) cout &lt;&lt; fa[i][0] &lt;&lt; endl ;</span></span><br><span class="line">    rt[<span class="number">0</span>] = build(<span class="number">1</span>, len) ; dfs(now) ; <span class="comment">//cout &lt;&lt; res &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;w, &amp;k) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">18</span> ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">            <span class="keyword">if</span> (fa[u][j] &amp;&amp; wth[fa[u][j]] &lt;= w) u = fa[u][j] ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; u &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">if</span> (rg[u][<span class="number">1</span>] - rg[u][<span class="number">0</span>] &lt; k) <span class="built_in">puts</span>(<span class="string">"-1"</span>) ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; rg[u][0] &lt;&lt; " " &lt;&lt; rg[u][1] &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, t[query(rt[rg[u][<span class="number">0</span>]], rt[rg[u][<span class="number">1</span>]], <span class="number">1</span>, len, k)]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>BZOJ</category>
      </categories>
      <tags>
        <tag>å›¾è®º/Kruskalé‡æ„æ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘Kruskalé‡æ„æ ‘</title>
    <url>/2020/01/24/%E5%85%8B%E9%B2%81%E6%96%AF%E5%8D%A1%E5%B0%94%E9%87%8D%E6%9E%84%E6%A0%91/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚å°±æ˜¯æ¨¡æ‹Ÿ <code>Kruskal</code> åŠ è¾¹çš„è¿‡ç¨‹ï¼Œé‡æ„æˆä¸€æ£µæ ‘ã€‚</p>
<p>è¿‡ç¨‹å¤§æ¦‚æ˜¯æŠŠåŸå›¾ä¸­æ‰€æœ‰çš„ç‚¹ä½œä¸ºé‡æ„æ ‘çš„å¶å­ï¼Œè¾¹æŒ‰ä¸€å®šçš„ç§©æ’åºï¼Œåˆå¹¶ä¸¤ä¸ªé›†åˆæ—¶æŠŠè¿æ¥ä¸¤ä¸ªé›†åˆçš„è¾¹æƒä½œä¸ºå…¬å…±çˆ¶äº²çš„ç‚¹æƒã€‚</p>
<p>è¿™æ ·çš„å»ºæ ‘æœ‰ä¸€å®šæ€§è´¨ã€‚æ¯”å¦‚åŸºäºæœ€å°ç”Ÿæˆæ ‘çš„é‡æ„ï¼Œä¸¤ä¸ªç‚¹çš„ $lca$ ç‚¹æƒä¸€å®šæ˜¯ã€Œä¸¤ç‚¹ä¹‹é—´æ‰€æœ‰è·¯å¾„ä¸Šæœ€å¤§å€¼çš„æœ€å°å€¼ã€ã€‚</p>
<a id="more"></a>
<h1 id="NOI2018-å½’ç¨‹"><a href="#NOI2018-å½’ç¨‹" class="headerlink" title="[NOI2018] å½’ç¨‹"></a>[NOI2018] å½’ç¨‹</h1><blockquote>
<p>ç»™å®šä¸€å¼ å›¾ï¼Œæ¯æ¡è·¯æœ‰ä¸€ä¸ªé•¿åº¦ä¸€ä¸ªæµ·æ‹”ã€‚</p>
<p>æ¯æ¬¡è¯¢é—®ï¼Œè¯¢é—®ä»ç‚¹ $x$ å‡ºå‘ï¼Œç¬¬ä¸€æ®µåªèµ°æµ·æ‹” $&gt;h$ çš„è¾¹ï¼Œèµ°åˆ°æŸä¸ªç‚¹ï¼Œç„¶åæ— é™åˆ¶åœ°èµ°ç¬¬äºŒæ®µåˆ°è¾¾ $1$ å·ç‚¹ï¼Œç¬¬äºŒæ®µè·¯ç¨‹çš„æœ€å°é•¿åº¦ã€‚</p>
<p>å¼ºåˆ¶åœ¨çº¿ã€‚</p>
</blockquote>
<p>å‘ç°Kruskalé‡æ„æ ‘å…·æœ‰å †æ€§è´¨ï¼Œäºæ˜¯å¦‚æœåŸºäºæœ€å¤§ç”Ÿæˆæ ‘é‡æ„ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªç‚¹èƒ½å¤Ÿç»è¿‡å¤§äº $v$ çš„è¾¹åˆ°è¾¾çš„ç‚¹åº”è¯¥åœ¨æŸä¸ªå­æ ‘å†…ã€‚æ‰€ä»¥å¯ä»¥æŒ‰ç…§è¿™ä¸ªæ–¹å¼å€å¢ã€‚ä¹‹å‰é¢„å¤„ç†ä¸€ä¸‹å­æ ‘å†…åˆ° $1$ çš„ $\rm mindist$ å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr(k) E[k].fr</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> val(k) E[k].val</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> cost(k) E[k].cost</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">400010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">400010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edges</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, w, c ;</span><br><span class="line">&#125;e[M &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> val, cost ;</span><br><span class="line">    <span class="keyword">int</span> fr, to, next ;</span><br><span class="line">&#125;E[M &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> dis, n ;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> Node &amp; neww) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dis &gt; neww.dis ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="keyword">int</span> T ;</span><br><span class="line"><span class="keyword">int</span> ff[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> lastans ;</span><br><span class="line"><span class="keyword">int</span> fa[N][<span class="number">20</span>] ;</span><br><span class="line"><span class="keyword">int</span> n, m, q, s ;</span><br><span class="line"><span class="keyword">int</span> head[N], cnt ;</span><br><span class="line"><span class="keyword">int</span> dis[N], vis[N] ;</span><br><span class="line">priority_queue&lt;Node&gt; Q ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ; <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    E[++ cnt].to = v, E[cnt].fr = u ;</span><br><span class="line">    E[cnt].val = w, E[cnt].cost = c ;</span><br><span class="line">    E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">127</span>, <span class="keyword">sizeof</span>(dis)) ;</span><br><span class="line">    Q.push((Node)&#123;<span class="number">0</span>, <span class="number">1</span>&#125;), dis[<span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span>(!Q.empty())&#123;</span><br><span class="line">        Node qwq = Q.top() ; Q.pop() ;</span><br><span class="line">        <span class="keyword">int</span> x1 = qwq.n, x2 = qwq.dis ;</span><br><span class="line">        <span class="keyword">if</span>(vis[x1]) <span class="keyword">continue</span> ; vis[x1] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = head[x1]; k ; k = next(k))&#123;</span><br><span class="line">            dis[to(k)] = min(dis[E[k].to], x2 + cost(k)) ;</span><br><span class="line">               Q.push((Node)&#123;dis[to(k)], to(k)&#125;) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(edges u, edges v)</span></span>&#123; <span class="keyword">return</span> u.w &gt; v.w ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x == ff[x] ? x : ff[x] = find(ff[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> ffff)</span></span>&#123;</span><br><span class="line">    fa[x][<span class="number">0</span>] = ffff ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">19</span> ; ++ j)</span><br><span class="line">        fa[x][j] = fa[fa[x][j - <span class="number">1</span>]][j - <span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))</span><br><span class="line">        dfs(to(k), x), dis[x] = min(dis[x], dis[to(k)]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//freopen("return.in", "r", stdin);</span></span><br><span class="line">    <span class="comment">//freopen("return.out", "w", stdout);</span></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; <span class="keyword">int</span> tot ;</span><br><span class="line">        <span class="keyword">int</span> u, v, w, c, k, l, now, ok ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; e[i].u &gt;&gt; e[i].v &gt;&gt; e[i].c &gt;&gt; e[i].w,</span><br><span class="line">             add(e[i].u, e[i].v, e[i].w, e[i].c), add(e[i].v, e[i].u, e[i].w, e[i].c) ;</span><br><span class="line">        dijkstra() ;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; q &gt;&gt; k &gt;&gt; s ; tot = n ; ok = <span class="number">0</span> ;</span><br><span class="line">        sort(e + <span class="number">1</span>, e + m + <span class="number">1</span>, comp) ; <span class="comment">//cout &lt;&lt; 233 &lt;&lt; endl ;</span></span><br><span class="line">        fill(head, head + <span class="number">2</span> * n + <span class="number">1</span>, <span class="number">0</span>), cnt = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">2</span> * n + <span class="number">1</span> ; ++ i) ff[i] = i ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">int</span> f1 = find(e[i].u) ;</span><br><span class="line">            <span class="keyword">int</span> f2 = find(e[i].v) ;</span><br><span class="line">            <span class="keyword">if</span> (f1 != f2)&#123;</span><br><span class="line">                ++ ok ;</span><br><span class="line">                now = ++ tot ;</span><br><span class="line">                base[now] = e[i].w ;</span><br><span class="line">                ff[f1] = now, ff[f2] = now ;</span><br><span class="line">                add(now, f1, <span class="number">0</span>, <span class="number">0</span>), add(now, f2, <span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ok == n - <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(now, <span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)&#123;</span><br><span class="line">            u = qr(), l = qr() ; <span class="keyword">int</span> x = u ;</span><br><span class="line">            l = (l + <span class="number">1l</span>l * k * lastans) % (s + <span class="number">1</span>) ;</span><br><span class="line">            x = (x + <span class="number">1l</span>l * k * lastans - <span class="number">1</span>) % n + <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">19</span> ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">                <span class="keyword">if</span> (fa[x][j] &amp;&amp; base[fa[x][j]] &gt; l) x = fa[x][j] ;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, lastans = dis[x]) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memset</span>(fa, <span class="number">0</span>, <span class="keyword">sizeof</span>(fa)) ;</span><br><span class="line">        <span class="built_in">memset</span>(base, <span class="number">0</span>, <span class="keyword">sizeof</span>(base)) ;</span><br><span class="line">        fill(vis + <span class="number">1</span>, vis + tot + <span class="number">1</span>, <span class="number">0</span>), cnt = <span class="number">0</span> ;</span><br><span class="line">        fill(head + <span class="number">1</span>, head + tot + <span class="number">1</span>, <span class="number">0</span>), lastans = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ç¥ç§˜çš„é¢˜ç›®"><a href="#ç¥ç§˜çš„é¢˜ç›®" class="headerlink" title="ç¥ç§˜çš„é¢˜ç›®"></a>ç¥ç§˜çš„é¢˜ç›®</h1><blockquote>
<p>ç»™å‡ºä¸€æ£µ $n$ ä¸ªç‚¹çš„æ ‘ï¼Œæ ‘è¾¹ä¸Šæœ‰è¾¹æƒã€‚ </p>
<p>å®šä¹‰ä¸€ä¸ªç‚¹çš„æƒå€¼ä¸ºå…¶åˆ°å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹çš„è·¯å¾„ä¸Šæœ€å°è¾¹æƒä¹‹å’Œï¼Œæ±‚æƒå€¼æœ€å¤§çš„ç‚¹ã€‚ </p>
</blockquote>
<p>å»ºä¸€æ£µåŸºäºæœ€å¤§ç”Ÿæˆæ ‘çš„é‡æ„æ ‘ï¼Œç„¶åå‘ç°æ¯æ¡è¾¹ä½œä¸º $(u,v)$ æœ€å°è¾¹æƒå½“ä¸”ä»…å½“ $u,v$ åœ¨é‡æ„æ ‘ä¸Šçš„ $lca$ æ˜¯è¿™æ¡è¾¹ã€‚</p>
<p>æ‰€ä»¥å¯ä»¥ç›´æ¥ç¦»çº¿ç»Ÿè®¡æ¯æ¡è¾¹çš„è´¡çŒ®ï¼Œ<code>dfs</code> æ—¶å°†å·¦å³å­æ ‘ä¸­çš„å¶å­ç»“ç‚¹ä¸ªæ•°åŠ æƒäº’åŠ ä¸€ä¸‹å°±å®Œäº†ã€‚å¯ä»¥ç›´æ¥åœ¨ <code>dfn</code> ä¸Šç»´æŠ¤ä¸€ä¸ªå·®åˆ†ï¼Œè¿™æ ·å°±æ˜¯æ’åºå¤–çº¿æ€§äº†ã€‚ </p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>Kruskalé‡æ„æ ‘</category>
      </categories>
      <tags>
        <tag>å›¾è®º/Kruskalé‡æ„æ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ¢ç©¶ã€‘æ¬§æ‹‰åæ¼”</title>
    <url>/2020/01/24/%E6%AC%A7%E6%8B%89%E5%8F%8D%E6%BC%94/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚å°±æ˜¯å¯¹äº $\varphi$ å‡½æ•°æ€§è´¨çš„ä¸€ç‚¹åº”ç”¨ï¼Ÿæ¯”èµ· $\mu$ å…¶å®ä¸æ˜¯é‚£ä¹ˆçš„å¤æ‚ï¼Œå®ç”¨æ€§ä¹Ÿä¸æ˜¯å¾ˆé«˜ã€‚</p>
<p>è€ƒè™‘ $\varphi$ çš„è¿™ä¹ˆä¸€ä¸ªæ€§è´¨ï¼š</p>
<script type="math/tex; mode=display">
\sum _{d|n}\varphi(d)=n</script><p>è¿™å¤§æ¦‚å°±æ˜¯è¿™ç¯‡æ–‡ç« çš„ä¸»è§’ã€‚</p>
<a id="more"></a>
<hr>
<p>è¿™ä¸œè¥¿å¤§æ¦‚å¯ä»¥ç”¨è«æ¯”ä¹Œæ–¯åæ¼”å®šç†æ¥è¯ï¼Ÿ</p>
<p>ä»¤ $f(x)=\varphi(x)$ï¼Œ$g(x)=\boldsymbol{\rm Id}(x)$ ï¼Œåˆ™æ ¹æ®ç‹„åˆ©å…‹é›·å·ç§¯çš„æŸäº›å¸¸è¯†æœ‰</p>
<script type="math/tex; mode=display">
\sum_{d|n}g(d)\mu(\frac{n}{d})=f(n)\\</script><p>åæ¼”ä¸€ä¸‹</p>
<script type="math/tex; mode=display">
g(n)=\sum_{d|n}f(d)</script><p>å³</p>
<script type="math/tex; mode=display">
\sum_{d|n}\varphi(d)=\boldsymbol{\rm Id}(n)=n</script><p>å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡æµ…æ˜¾çš„æ•°è®ºçŸ¥è¯†æ¥è¯æ˜ï¼š</p>
<p>è®¾ $f(n)=\sum_{d|n}\varphi(d)$ ï¼Œåˆ™å®¹æ˜“è¯æ˜ $f$ ä¹Ÿæ˜¯ç§¯æ€§å‡½æ•°ã€‚ï¼ˆæ˜“è¯=æ‡’å¾—è¯XDï¼‰</p>
<p>è€ƒè™‘ $n$ çš„æ ‡å‡†åˆ†è§£å¼ï¼š</p>
<script type="math/tex; mode=display">
n=\sum p_i^{e_i}</script><p>å¹¶ä¸”è€ƒè™‘å½“ $p\in\mathbb{P}$ æ—¶ </p>
<script type="math/tex; mode=display">
\varphi(p^k)=p^k-p^{k-1}=p(p^{k-1}-p^{k-2})</script><p>è¯æ˜å¾ˆç®€å•ï¼Œåœ¨ä¸è¶Šç•Œçš„æƒ…å†µä¸‹ï¼Œ $p^k$ ç”±äºåªæœ‰ $p$ ä¸€ä¸ªè´¨å› å­ï¼Œæ‰€ä»¥ä¸ $p\times1,p\times2\cdots p\times p^{k-1}$ éƒ½ä¸äº’è´¨ï¼Œæ‰€ä»¥æ˜¯ $p^k-p^{k-1}$ ã€‚</p>
<p>é‚£ä¹ˆæœ‰</p>
<script type="math/tex; mode=display">
f\left(p_{i}^{e_{i}}\right)=1+p-1+p(p-1)+p^{2}(p-1) \ldots+p^{e_{i}-1}(p-1)</script><p>é€šè¿‡å‡ ä½•çº§æ•°çš„æ±‚å’Œå…¬å¼å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
f(p_i^{e_i})=p_i^{e_i}</script><p>æ ¹æ®ç§¯æ€§å¯ä»¥å¾—åˆ°</p>
<script type="math/tex; mode=display">
f(n)=n</script><p>æ˜¯ä¸æ˜¯æ¯”ä¸Šä¸€ä¸ªè¯æ˜æ¸…çœŸäº†å¾ˆå¤šï¼</p>
<p>ä»¥ä¸‹é»˜è®¤ $[i,j]$ è¡¨ç¤º $i,j$ çš„ $\rm lcm$ ã€‚ </p>
<h1 id="1"><a href="#1" class="headerlink" title="$1$"></a>$1$</h1><blockquote>
<p>æ±‚ </p>
<script type="math/tex; mode=display">
\sum _{i=1}^n\sum_{j=1}^m(i,j)</script><p>$1\leq n,m\leq 10^6,q\leq 10^5$</p>
</blockquote>
<p>éšä¾¿åšå•¦</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum _{i=1}^n\sum_{j=1}^m(i,j)
\\=&\sum _{i=1}^n\sum_{j=1}^m\sum_{d|n}\varphi(d)
\\=&\sum _{d=1}^n\varphi(d)\cdot \lfloor\frac{n}{d} \rfloor \cdot \lfloor\frac{m}{d} \rfloor
\end{aligned}</script><hr>
<p>æ¥ä¸‹æ¥æ˜¯ä¸€é“ç¿»è½¦é¢˜ï¼š</p>
<h1 id="2"><a href="#2" class="headerlink" title="$2$"></a>$2$</h1><blockquote>
<p>[å›½å®¶é›†è®­é˜Ÿ]Crashçš„æ•°å­—è¡¨æ ¼ </p>
<p>æ±‚</p>
<script type="math/tex; mode=display">
\sum _{i=1}^n\sum_{j=1}^m[i,j]</script><p>$1\leq n,m\leq 10^7$ã€‚</p>
</blockquote>
<p>æ ¹æ®ä»¥å¾€å¥—è·¯å˜å½¢</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum _{i=1}^n\sum_{j=1}^m[i,j]
\\=&\sum _{i=1}^n\sum_{j=1}^m\frac{i\cdot j}{(i,j)}
\\=&\sum _{i=1}^n\sum_{j=1}^m\frac{i\cdot j}{\sum\limits_{d|i~\mathrm{and}~d|j}\varphi(d)}
\\=&\sum _{d=1}^n\frac{1}{\varphi(d)}\sum_{i=1}^{\lfloor\frac{n}{d} \rfloor}i\sum_{j=1}^{\lfloor\frac{m}{d} \rfloor} j
\end{aligned}</script><p>çœ‹ä¸Šå»å¾ˆçœŸï¼Ÿä½†æ˜¯å¹¶ä¸å¯¹ã€‚åŸå› æ˜¯ <strong>å’Œçš„å€’æ•°ä¸ç­‰äºå€’æ•°çš„å’Œ</strong>ï¼Œä¹Ÿå°±æ˜¯ä¸­é—´ $\sum \varphi(d)$ ä¸èƒ½ç›´æ¥æå‡ºæ¥ã€‚</p>
<p>æ‰€ä»¥é‡åˆ°è¿™ç§æƒ…å†µå°±åªèƒ½ç”¨è«æ¯”ä¹Œæ–¯åæ¼”ã€‚è€ƒè™‘å¦‚æ­¤ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum _{i=1}^n\sum_{j=1}^m[i,j]
\\&=\sum _{d=1}^n\sum _{i=1}^n\sum_{j=1}^m\frac{i\cdot j}{d}[(i,j)=d]
\\&=\sum _{d=1}^n\sum _{i=1}^{\lfloor\frac{n}{d} \rfloor}\sum_{j=1}^{\lfloor\frac{m}{d} \rfloor}i\cdot j\cdot d\cdot \sum_{p|i~\mathrm{and}~p|j}\mu(p) 
\\&=\sum _{d=1}^n d\sum_{p=1}^{\lfloor\frac{n}{d} \rfloor}\mu(p) \cdot p^2\sum_{i=1}^{\lfloor\frac{n}{pd} \rfloor}i\sum_{j=1}^{\lfloor\frac{m}{pd} \rfloor} j
\end{aligned}</script><p>ç„¶åè¿™ä¸œè¥¿å°±å¯ä»¥ä¸¤ä¸ªæ•°è®ºåˆ†å—å¥—ä¸€èµ·æ¥è§£å†³ï¼Œå¤æ‚åº¦ $O(\sqrt n)\cdot O(\sqrt n)=O(n)$ã€‚</p>
<p>ç„¶è€Œä¼¼ä¹æœ‰ä¸€åª $\sqrt{n}$ çš„åšæ³•ï¼Ÿæœ‰ç©ºå†å­¦å§233</p>
<p>ä»£ç ä¼¼ä¹æœ‰ä¸å°‘ç»†èŠ‚ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, pr[N], o ;</span><br><span class="line">LL F[N], mu[N], ans ;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">do_do</span><span class="params">(LL u, LL v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (u * (u + <span class="number">1</span>) / <span class="number">2</span> % P) * (v * (v + <span class="number">1</span>) / <span class="number">2</span> % P) % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    LL ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; y) swap(x, y) ;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; x &lt;&lt; " " &lt;&lt; y &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r ; l &lt;= x ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; l &lt;&lt; endl ;</span></span><br><span class="line">        r = min(x / (x / l), y / (y / l)) ;</span><br><span class="line">        <span class="comment">// if (y == 1) cout &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; endl ;</span></span><br><span class="line">        (ret += ((F[r] - F[l - <span class="number">1</span>]) % P + P) % P * do_do(x / l, y / l) % P) %= P ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l, r ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span> ; <span class="keyword">if</span> (n &gt; m) swap(n, m) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">            pr[++ o] = i, mu[i] = <span class="number">-1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= o ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (pr[j] * i &gt; n) <span class="keyword">break</span> ;</span><br><span class="line">            vis[pr[j] * i] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                mu[i * pr[j]] = <span class="number">0</span> ; <span class="keyword">break</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[pr[j] * i] = -mu[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; 233 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        F[i] = ((F[i - <span class="number">1</span>] + <span class="number">1l</span>l * i * i * mu[i] % P) % P + P) % P ;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; 233 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (l = <span class="number">1</span> ; l &lt;= n ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; l &lt;&lt; " " &lt;&lt; n &lt;&lt; endl ;</span></span><br><span class="line">        r = min(n / (n / l), m / (m / l)) ;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; endl ;</span></span><br><span class="line">        (ans += (<span class="number">1l</span>l * (r - l + <span class="number">1</span>) * (l + r) / <span class="number">2</span> % P) * (solve(n / l, m / l) % P) % P) %= P ;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; endl ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; 233 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ((ans % P + P) % P) &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3"><a href="#3" class="headerlink" title="$3$"></a>$3$</h1><blockquote>
<p>LG4917å¤©å®ˆé˜çš„åœ°æ¿/LG5221Product</p>
<p>ç®€åŒ–é¢˜æ„ï¼š</p>
<p>æ±‚</p>
<script type="math/tex; mode=display">
\prod_{i=1}^{n} \prod_{j=1}^{n} \frac{\operatorname{lcm}(i, j)}{\operatorname{gcd}(i, j)}</script><p>$1\leq n\leq 10^6$</p>
</blockquote>
<p>å¤§æ¦‚å°±æ˜¯è½¬åŒ–</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\prod_{i=1}^{n} \prod_{j=1}^{n} \frac{\operatorname{lcm}(i, j)}{\operatorname{gcd}(i, j)}\\
=&\prod_{i=1}^{n} \prod_{j=1}^{n} \frac{i\times j}{\operatorname{gcd}^2(i, j)}\\
\end{aligned}</script><p>ç„¶åè§‚å¯Ÿåˆ° $\prod$ å¯¹äºé™¤æ³•æœ‰ç»“åˆå¾‹ï¼Œå³å¯ä»¥åˆ†åˆ«ç®—åˆ†æ¯å’Œåˆ†å­ã€‚åŒæ—¶æŒ‡æ•°ä¸Šçš„ $2$ ä¹Ÿå¯ä»¥æœ€åå†ç®—ã€‚</p>
<p>äºæ˜¯è€ƒè™‘ä¸‹åŠéƒ¨åˆ†ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\prod_{i=1}^{n} \prod_{j=1}^{n} \operatorname{gcd}(i, j)\\
=&\prod_{d=1}^n\prod_{i=1}^{n} \prod_{j=1}^{n} d\cdot [\operatorname{gcd}(i, j)=d]\\
=&\prod_{d=1}^nd^{\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor} \sum_{j=1}^{\lfloor\frac{n}{d}\rfloor} [\operatorname{gcd}(i, j)=1]}\\
\end{aligned}</script><p>å…¶ä¸­ç¬¬äºŒæ­¥åˆ°ç¬¬ä¸‰æ­¥çš„åŸå› æ˜¯æ ¹æ®ç»“åˆå¾‹ $\prod$ è¦å‡çº§ä¸ºä¹˜æ–¹ï¼ˆå°±åƒ $\sum$ ä¼šå‡çº§ä¸º $\times $ ä¸€æ ·</p>
<p>å‘ç°ä¼¼ä¹åé¢é‚£ä¸ªæ˜¯è€æœ‹å‹äº†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åæ¼”æˆ $\mu$ å½¢å¼æˆ–è€… $\varphi$ å½¢å¼ã€‚</p>
<p>å…¶ä¸­ $\varphi$ å½¢å¼çš„è¯æ˜å¤§æ¦‚æ˜¯è€ƒè™‘æ¯ä¸ªæ•°çš„æ•°çš„è´¡çŒ®ï¼ŒåŒæ—¶ç”±äºæ˜¯æœ‰åºæ•°å¯¹æ‰€ä»¥æ˜¯ $\times 2-1$ ã€‚</p>
<p>å—¯ï¼Œç„¶åå°±ä¼šåæ¼”æˆè¿™ä¸ªæ ·å­ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\prod_{d=1}^nd^{\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor} \sum_{j=1}^{\lfloor\frac{n}{d}\rfloor} [\operatorname{gcd}(i, j)=1]}\\
=&\prod_{d=1}^n{d^{-1+2\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\varphi(i)}}
\end{aligned}</script><p>å‘ç°åé¢çš„å¯ä»¥æ•°è®ºåˆ†å—äºæ˜¯è¿™å°±å¯ä»¥ $\sqrt n$ åšäº†ã€‚</p>
<p>å¯¹äºåˆ†å­ï¼Œå‘ç°å°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\prod_{i=1}^n\prod_{j=1}^n i\cdot j=\prod_{i=1}^n(i^n\cdot n!)=(n!)^n\cdot (n!)^n=(n!)^{2n}</script><p>ç„¶åå°±æ²¡æœ‰ç„¶åäº†233ã€‚</p>
<p>ä¸è¿‡ <code>LG5221</code> å¡äº†ç©ºé—´ï¼Œäºæ˜¯æœ€åæ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000001</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">104857601</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> n, pr[<span class="number">80001</span>], cnt ;</span><br><span class="line"><span class="keyword">int</span> ans1, ans2, phi[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            res = <span class="number">1l</span>l * res * a % P ;</span><br><span class="line">        a = <span class="number">1l</span>l * a * a % P ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; <span class="keyword">int</span> fac = <span class="number">1</span> ;</span><br><span class="line">    pr[<span class="number">0</span>] = phi[<span class="number">1</span>] = <span class="number">1</span>, ans2 = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">            pr[++ cnt] = i, phi[i] = i - <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i * pr[j] &gt; n) <span class="keyword">break</span> ;</span><br><span class="line">            vis[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                phi[i * pr[j]] = phi[i] * pr[j] ;</span><br><span class="line">                <span class="keyword">break</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            phi[i * pr[j]] = phi[i] * (pr[j] - <span class="number">1</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cnt = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r ; l &lt;= n ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">        r = n / (n / l) ;</span><br><span class="line">        pr[++ cnt] = fac ; <span class="comment">//cout &lt;&lt; l - 1 &lt;&lt; " " ;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">            fac = <span class="number">1l</span>l * fac * i % P ;</span><br><span class="line">        pr[++ cnt] = fac ; <span class="comment">//cout &lt;&lt; r &lt;&lt; endl ;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= cnt ; ++ i) cout &lt;&lt; pr[i] &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        phi[i] = phi[i - <span class="number">1</span>] + phi[i] ;</span><br><span class="line">        <span class="keyword">if</span> (phi[i] &gt; P - <span class="number">1</span>) phi[i] -= P - <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    ans1 = expow(pr[cnt], <span class="number">2</span> * n + <span class="number">2</span>) ; cnt = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (LL l = <span class="number">1</span>, r ; l &lt;= n ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">        r = n / (n / l) ; <span class="keyword">int</span> t = ++ cnt ; ++ cnt ;</span><br><span class="line">        ans2 = <span class="number">1l</span>l * ans2 * expow(<span class="number">1l</span>l * pr[cnt] * expow(pr[t], P - <span class="number">2</span>) % P, phi[n / l]) % P ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, <span class="number">1l</span>l * expow(ans2, P - <span class="number">5</span>) * ans1 % P) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>è«æ¯”ä¹Œæ–¯åæ¼”</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°/æ¬§æ‹‰åæ¼”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘$\mu$ å‡½æ•°çš„æ€§è´¨</title>
    <url>/2020/01/24/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¼—æ‰€å‘¨çŸ¥ $\mu$ å‡½æ•°å…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š</p>
<script type="math/tex; mode=display">
\sum_{d|n} \mu(d)=[n=1]</script><p>å¤§éƒ¨åˆ†æœ‰å…³äº $\gcd$ ã€å¸¦æœ‰è‰¾ä½›æ£®æ‹¬å·çš„åæ¼”é¢˜ç›®éƒ½å¯ä»¥ç”¨è¿™ä¸ªæ€§è´¨è§£å†³ã€‚</p>
<a id="more"></a>
<p>è¯æ˜æ–¹å¼æœ‰å¾ˆå¤šï¼Œæ­¤å¤„é‡‡ç”¨ç‹„åˆ©å…‹é›·å·ç§¯çš„æ–¹å¼æ¥æ¯”è¾ƒç®€æ´åœ°è¯æ˜ã€‚</p>
<p>æ ¹æ® $\mu$ çš„å®šä¹‰ï¼Œ$\mu*\boldsymbol{1}=\boldsymbol{I}$ï¼Œé‚£ä¹ˆæœ‰ </p>
<script type="math/tex; mode=display">
\sum _{d|n}\mu(d)=\mu * \boldsymbol{1}=\boldsymbol{I}=[n=1]</script><p>å½“ç„¶ï¼Œå…¶å®è¿˜æœ‰æ›´ä¼˜ç¾çš„è¯æ³•ã€‚æ€è€ƒ $\mu$ çš„æœ¬è´¨ï¼Œå½“ $n$ å«æœ‰å¹³æ–¹å› å­çš„æ—¶å€™ï¼Œ$\mu(n)=0$ï¼›å¦åˆ™ $\mu(n)=(-1)^k$ï¼Œå…¶ä¸­ $k$ æ˜¯ $n$ çš„æœ¬è´¨ä¸åŒè´¨å› å­ä¸ªæ•°ã€‚</p>
<p>æ¥ä¸‹æ¥è€ƒè™‘ä¸€æ­¥è½¬åŒ–ã€‚è®¾ $n=\sum p_i^{e_i},nâ€™=\sum{p_i}$ ã€‚é‚£ä¹ˆæœ‰</p>
<script type="math/tex; mode=display">
\begin{aligned}&\sum_{d|n}\mu(d)\\ = &\sum_{d|n'}\mu(d)\\= &\sum_{i=0}^k \binom{k}{i}(-1)^i\\= & ~(1+(-1))^k\\= & ~[k=0]\end{aligned}</script><p>æ‰€ä»¥åˆ°æœ€å $[k=0]$ å°±æ„å‘³ç€ $[n=1]$ ã€‚$\mathcal{Q.E.D.}$</p>
<p>é»˜è®¤ $(a,b)$ ä»£è¡¨ $a$ ä¸ $b$ çš„æœ€å¤§å…¬çº¦æ•°ï¼Œ$|$ è¡¨ç¤ºæ•´é™¤ã€‚</p>
<h1 id="1"><a href="#1" class="headerlink" title="$1$"></a>$1$</h1><blockquote>
<p>æ±‚</p>
<script type="math/tex; mode=display">
\sum _{i=1}^n\sum_{j=1}^m[(i,j)=1]</script><p>$1\leq n\leq m\leq 10^6,q\leq 50000$</p>
</blockquote>
<p>å…¶å®å°±æ˜¯ä»£æ¢ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum _{i=1}^n\sum_{j=1}^m[(i,j)=1]&=\sum _{i=1}^n\sum_{j=1}^m\sum_{d|(i,j)}\mu(d)
\\&=\sum _{i=1}^n\sum_{j=1}^m\sum_{d|i~\text{and}~d|j}\mu(d)
\\&=\sum _{d=1}^n\mu(d) \sum_{i=1}^n[d|i]\sum_{j=1}^m[d|j]
\\&=\sum _{d=1}^n\mu(d)\cdot \lfloor\frac{n}{d}\rfloor \cdot \lfloor\frac{m}{d}\rfloor
\end{aligned}</script><p>ç„¶åå°±å¯ä»¥ $O(n)+O(q\sqrt n)$ æ¥åšäº†ã€‚</p>
<p>ä½†å…¶å®æœ¬è´¨ä¸Šï¼Œ$n$ å¯ä»¥å‡ºåˆ° $10^9$ ï¼Ÿä½†æ˜¯æ€»æ„Ÿè§‰æœæ•™ç­›å¥—ä¸Šä¸€å±‚æ•°è®ºåˆ†å—å¤æ‚åº¦å°±ä¸æ˜¯å¾ˆå¯¹äº†ã€‚æ­¤å¤„å¯èƒ½è¿˜éœ€è¦æ€è€ƒæ€è€ƒã€‚</p>
<h1 id="2"><a href="#2" class="headerlink" title="$2$"></a>$2$</h1><blockquote>
<p>[POI2007]ZAP-Queries/LG4450åŒäº²æ•°</p>
<p>æ±‚</p>
<script type="math/tex; mode=display">
\sum _{i=1}^n\sum_{j=1}^m[(i,j)=k]</script><p>$1\leq n\leq m\leq 10^6,q\leq 50000$</p>
</blockquote>
<p>å…¶å®æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ã€‚</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum _{i=1}^n\sum_{j=1}^m[(i,j)=k]&=\sum _{i=1}^{\lfloor\frac{n}{k}\rfloor}\sum_{j=1}^{\lfloor\frac{m}{k}\rfloor}\sum_{d|(i,j)}\mu(d)
\\&=\sum _{i=1}^{\lfloor\frac{n}{k}\rfloor}\sum_{j=1}^{\lfloor\frac{m}{k}\rfloor}\sum_{d|i~\text{and}~d|j}\mu(d)
\\&=\sum _{d=1}^{\lfloor\frac{n}{k}\rfloor}\mu(d) \sum_{i=1}^{\lfloor\frac{n}{k}\rfloor}[d|i]\sum_{j=1}^{\lfloor\frac{m}{k}\rfloor}[d|j]
\\&=\sum _{d=1}^{\lfloor\frac{n}{k}\rfloor}\mu(d)\cdot \lfloor\frac{n}{dk}\rfloor \cdot \lfloor\frac{m}{dk}\rfloor
\end{aligned}</script><h1 id="3"><a href="#3" class="headerlink" title="$3$"></a>$3$</h1><blockquote>
<p>$\forall p\in\mathbb{P}$ï¼Œæ±‚</p>
<script type="math/tex; mode=display">
\sum _{i=1}^n\sum_{j=1}^m[(i,j)=p]</script><p>$1\leq n\leq m\leq 10^7,q\leq 10000$</p>
</blockquote>
<p>å‘ç°åˆ°æœ€åå˜æˆäº†è¿™æ ·ï¼š</p>
<script type="math/tex; mode=display">
\sum_{k=1}^{cntp}\sum _{d=1}^{\lfloor\frac{n}{p_k}\rfloor}\mu(d)\cdot \lfloor\frac{n}{p_kd}\rfloor \cdot \lfloor\frac{m}{p_kd}\rfloor</script><p>è€ƒè™‘ç»§ç»­æ¢å…ƒï¼Œä»¤ $q=p_kd$ï¼Œæšä¸¾ $q$:</p>
<script type="math/tex; mode=display">
\sum_{q=1}^{n}\lfloor\frac{n}{q}\rfloor \cdot \lfloor\frac{m}{q}\rfloor\cdot \left(\sum _{k=1}^{cntp}[p_k~|~q]\cdot \mu(\frac{q}{p_k})\right)</script><p>ç„¶åå‘ç°å‰åŠéƒ¨åˆ†å¯ä»¥æ•°è®ºåˆ†å—ï¼ŒååŠéƒ¨åˆ†å¯ä»¥ç›´æ¥åœ¨ç­›ç´ æ•°çš„æ—¶å€™ $dp$ å‡ºæ¥å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">1</span> ; Pr[i] * j &lt;= MAXN - <span class="number">15</span> ; ++ j)</span><br><span class="line">		f[j * Pr[i]] += Mu[j] ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= MAXN - <span class="number">15</span> ; ++ i) S[i] = S[i - <span class="number">1</span>] + f[i] ;</span><br></pre></td></tr></table></figure>
<h1 id="4"><a href="#4" class="headerlink" title="$4$"></a>$4$</h1><blockquote>
<p>é¢˜ç›®æ¥è‡ªç¥ä»™ææ€æ°çš„ $blog$ï¼š</p>
<p>æ±‚</p>
<script type="math/tex; mode=display">
\sum_{i=1}^{n} \sum_{j=1}^{m} i\cdot j\cdot [(i, j)=k] \quad(n<m)</script><p>$1\leq n,m\leq 10^6$</p>
</blockquote>
<p>å‘ç°å¯ä»¥è¿™ä¹ˆåšï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{i=1}^{n} \sum_{j=1}^{m} i \cdot j\cdot[(i, j)=k] 
&=k^2\cdot \sum_{i=1}^{\lfloor\frac{n}{k}\rfloor} \sum_{j=1}^{\lfloor\frac{m}{k}\rfloor} i \cdot j\cdot[(i, j)=1] \\
&=k^2\cdot \sum_{i=1}^{\lfloor\frac{n}{k}\rfloor} \sum_{j=1}^{\lfloor\frac{m}{k}\rfloor} i \cdot j\cdot\sum_{d|i~\mathrm{and}~d|j} \mu(d)\\
&=k^2\cdot \sum_{d=1}^n\mu(d)\cdot d^2\cdot \sum_{i=1}^{\lfloor\frac{n}{kd}\rfloor} i\cdot \sum_{j=1}^{\lfloor\frac{m}{kd}\rfloor} j\\
\end{aligned}</script><p>å‘ç°åé¢æ˜¯ä¸ªç®€å•çš„äºŒé˜¶æ±‚å’Œå½¢å¼ï¼Œæ•…è‡³æ­¤å·²ç»å¯ä»¥åˆ†å¿«äº†ã€‚</p>
<h1 id="5"><a href="#5" class="headerlink" title="$5$"></a>$5$</h1><blockquote>
<p>[SDOI2015]çº¦æ•°ä¸ªæ•°å’Œ</p>
<p>æ±‚ </p>
<script type="math/tex; mode=display">
\sum_{i=1}^n\sum_{j=1}^m\sigma_0(i\times j)</script><p>$1\leq n,m\leq 10^6,1\leq q\leq 10^5$</p>
</blockquote>
<p>é¦–å…ˆè€ƒè™‘ä¸€æ­¥<del>å‡ ä¹æƒ³ä¸å‡ºæ¥çš„</del>è½¬åŒ–ï¼š</p>
<script type="math/tex; mode=display">
\sigma_0(i \cdot j)=\sum_{x | i} \sum_{y | j}[(x, y)=1]</script><p>å¯ä»¥ç±»ä¼¼çº¿æ€§ç­›é‚£æ ·æ„Ÿæ€§ç†è§£ã€‚</p>
<p>ç„¶åå°±å¯ä»¥ç›´æ¥åšäº†ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\sum_{i=1}^n\sum_{j=1}^m\sigma_0(i\times j)\\
=&\sum_{i=1}^n\sum_{j=1}^m\sum_{x | i} \sum_{y | j}[(x, y)=1]\\
=&\sum_{i=1}^n\sum_{j=1}^m\sum_{x | i} \sum_{y | j}\sum_{d|x\operatorname{and} d|y} \mu(d)\\
=&\sum_{x = 1}^n \sum_{y = 1}^m\lfloor\frac{n}{x}\rfloor\cdot \lfloor\frac{m}{y}\rfloor\cdot \sum_{d|x\operatorname{and} d|y} \mu(d)\\
=&\sum_{d = 1}^n \mu(d) \sum_{x = 1}^{\lfloor\frac{n}{d}\rfloor}\sum_{y = 1}^{\lfloor\frac{m}{d}\rfloor}\lfloor\frac{n}{dx}\rfloor\cdot \lfloor\frac{m}{dy}\rfloor\\
\end{aligned}</script><p>å‘ç°åé¢è¿™ä¸œè¥¿å¯ä»¥å¾ˆç®€å•åœ°</p>
<p>é¢„å¤„ç†ï¼Œæ‰€ä»¥å¤æ‚åº¦ $O(q\cdot\sqrt n)$</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>è«æ¯”ä¹Œæ–¯åæ¼”</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°/è«æ¯”ä¹Œæ–¯åæ¼”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å›æ»šè«é˜Ÿ</title>
    <url>/2020/01/23/%E5%9B%9E%E6%BB%9A%E8%8E%AB%E9%98%9F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚æ˜¯ä¸€ç§ç¦»çº¿ç®—æ³•ï¼Œç”¨äºå·§å¦™ç»´æŠ¤æ²¡æœ‰åˆ é™¤æ“ä½œçš„ç¦»çº¿åºåˆ—é—®é¢˜ã€‚ä¸€èˆ¬æƒ…å†µä¸‹éƒ½å¯ä»¥è½¬åŒ–æˆæ™®é€šçš„è«é˜Ÿå¸¦ä¸€ä¸ª ds çš„ $\log$ åšæ³•ï¼Œå¯ä»¥æ¯”è¾ƒç®€å•åœ°å»ç»´æŠ¤æŸäº›ä¸èƒ½å·®åˆ†çš„æ“ä½œï¼ˆå³ <code>del</code> æ¯”è¾ƒéš¾ä»¥å®ç°ï¼Œæ¯”å¦‚ $\max$ï¼‰ã€‚</p>
<a id="more"></a>
<p>è€ƒè™‘ä¸åŒäºæ™®é€šè«é˜Ÿçš„å¦ä¸€ç§åšæ³•ã€‚</p>
<p>é¦–å…ˆè¿˜æ˜¯å°†æ‰€æœ‰è¯¢é—®æ’åºã€‚è€ƒè™‘ä¸€ç§æ ¹å·åˆ†æ²»çš„åšæ³•ï¼š</p>
<ul>
<li><p>å¯¹äºä¸¤ä¸ªç«¯ç‚¹åœ¨åŒä¸€ä¸ªå—å†…çš„ç›´æ¥è·‘æš´åŠ›ï¼Œæ€»å¤æ‚åº¦æ˜¯ $O(qB)$ï¼›</p>
</li>
<li><p>ä¸¤ä¸ªç«¯ç‚¹ä¸åœ¨ä¸€ä¸ªå—å†…çš„ï¼Œè€ƒè™‘æŠŠä¸¤ä¸ªæŒ‡é’ˆéƒ½æŒ‡é’ˆç§»åˆ°ä¸‹ä¸€ä¸ªå—çš„å¼€å¤´ï¼Œé€”ä¸­å¯¹æ¯ä¸ªç‚¹åªæ’¤é”€è´¡çŒ®è€Œä¸åˆ é™¤è´¡çŒ®ï¼Œä¹‹å $r$ å•è°ƒå‘å³ç§»ï¼Œ$l$ å‘å·¦ç§»ï¼Œæ·»åŠ è¿‡ç¨‹ä¸­è®¡ç®—è´¡çŒ®â€”â€”å…¶ä¸­æ§åˆ¶ $r$ å•å¢çš„åŸå› æ˜¯ $r$ çš„ç§»åŠ¨æ­¥é•¿æ˜¯ $O(n)$ çš„ï¼Œä½†æ¯æ¬¡ $l$ çš„ç§»åŠ¨æ­¥é•¿æ˜¯ $O(B)$ çš„ã€‚</p>
</li>
</ul>
<p>è¿™æ ·çš„è¯ï¼Œå¤æ‚åº¦å°±æ˜¯ $O(qB+\frac{n^2}{B})$ ã€‚ç®€å•åœ°å‡å€¼ä¸€ä¸‹å‘ç°è¿˜æ˜¯ $O(n\sqrt q)$ çš„ã€‚</p>
<p>é‚£çœ‹ä¸Šå»é™¤äº†å¤æ‚åº¦åˆ†æå¾ˆè«é˜Ÿï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸ªæ ¹å·åˆ†æ²»å•Šã€‚</p>
<h1 id="AT1219-æ­´å²ã®ç ”ç©¶"><a href="#AT1219-æ­´å²ã®ç ”ç©¶" class="headerlink" title="AT1219 æ­´å²ã®ç ”ç©¶"></a>AT1219 æ­´å²ã®ç ”ç©¶</h1><blockquote>
<p>ç»™å®šä¸€å †äº‹ä»¶ï¼š</p>
<ol>
<li>é€‰æ‹©æ—¥è®°ä¸­è¿ç»­çš„ä¸€äº›å¤©ä½œä¸ºåˆ†æçš„æ—¶é—´æ®µ</li>
<li>äº‹ä»¶ç§ç±» $t$ çš„é‡è¦åº¦ä¸º $t$  $\times$ (è¿™æ®µæ—¶é—´å†…ç§ç±»ä¸º $t$ çš„äº‹ä»¶æ•°)ã€‚</li>
<li>è®¡ç®—å‡ºæ‰€æœ‰äº‹ä»¶ç§ç±»çš„é‡è¦åº¦ï¼Œè¾“å‡ºå…¶ä¸­çš„æœ€å¤§å€¼ ç°åœ¨ä½ è¢«è¦æ±‚åˆ¶ä½œä¸€ä¸ªå¸®åŠ©æ•™æˆåˆ†æçš„ç¨‹åºï¼Œæ¯æ¬¡ç»™å‡ºåˆ†æçš„åŒºé—´ï¼Œä½ éœ€è¦è¾“å‡ºé‡è¦åº¦çš„æœ€å¤§å€¼.</li>
</ol>
</blockquote>
<p>å‘ç°æ’å…¥å¾ˆç®€å•ï¼Œä½†æ˜¯ç”±äºæ±‚çš„æ˜¯ $\max$ï¼Œæ‰€ä»¥æœ´ç´ åœ°åˆ é™¤ä¼šè®©ç­”æ¡ˆéš¾ä»¥ç»Ÿè®¡ã€‚äºæ˜¯è€ƒè™‘ç›´æ¥ä¸Šå›æ»šè«é˜Ÿã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qs</span>&#123;</span> </span><br><span class="line">    <span class="keyword">int</span> l, r, id ;</span><br><span class="line">&#125;q[M] ;</span><br><span class="line">LL res ;</span><br><span class="line"><span class="keyword">int</span> g[N] ;</span><br><span class="line">LL ans[M] ;</span><br><span class="line"><span class="keyword">int</span> buc[M] ;</span><br><span class="line"><span class="keyword">int</span> blg[N] ;</span><br><span class="line"><span class="keyword">int</span> L[N], R[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N], t[N] ;</span><br><span class="line"><span class="keyword">int</span> n, w, m, b, bnum ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(qs p1,qs p2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (blg[p1.l] ^ blg[p2.l] )</span><br><span class="line">        <span class="keyword">return</span> blg[p1.l] &lt; blg[p2.l];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> p1.r &lt; p2.r ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123; buc[base[p]] -- ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p, LL &amp; ret)</span></span>&#123;</span><br><span class="line">    buc[base[p]] ++ ;</span><br><span class="line">    ret = max(ret, <span class="number">1l</span>l * buc[base[p]] * g[p]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> bucc[N] ;</span><br><span class="line"><span class="function">LL <span class="title">brute_force</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    LL ret ; ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i) bucc[base[i]] ++ ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">        ret = max(ret, <span class="number">1l</span>l * bucc[base[i]] * g[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i) bucc[base[i]] -- ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; <span class="keyword">int</span> l, r, lb ;</span><br><span class="line">    b = <span class="built_in">sqrt</span>(<span class="number">1.0</span> * n) ; bnum = n / b + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;g[i]), t[i] = g[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= bnum ; ++ i)</span><br><span class="line">        L[i] = (i - <span class="number">1</span>) * b + <span class="number">1</span>, R[i] = i * b ;</span><br><span class="line">    R[bnum] = min(R[bnum], n) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= bnum ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = L[i] ; j &lt;= R[i] ; ++ j)</span><br><span class="line">            blg[j] = i ; sort(t + <span class="number">1</span>, t + n + <span class="number">1</span>) ;</span><br><span class="line">    w = unique(t + <span class="number">1</span>, t + n + <span class="number">1</span>) - t - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        base[i] = lower_bound(t + <span class="number">1</span>, t + w + <span class="number">1</span>, g[i]) - t ;</span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; base[i] &lt;&lt; '\n' ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;q[i].l, &amp;q[i].r), q[i].id = i ;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + m + <span class="number">1</span>, comp), l = <span class="number">1</span>, r = <span class="number">0</span>, lb = <span class="number">0</span> ;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; 233 &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; blg[i] &lt;&lt; " " ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (blg[q[i].l] == blg[q[i].r])&#123;</span><br><span class="line"><span class="comment">//            cout &lt;&lt; q[i].l &lt;&lt; " " &lt;&lt; q[i].r &lt;&lt; endl ;</span></span><br><span class="line">            ans[q[i].id] = brute_force(q[i].l, q[i].r) ;</span><br><span class="line">            <span class="keyword">continue</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (blg[q[i].l] ^ lb)&#123;</span><br><span class="line">            <span class="keyword">while</span> (r &gt; R[blg[q[i].l]]) del(r --) ;</span><br><span class="line">            <span class="keyword">while</span> (l &lt; R[blg[q[i].l]] + <span class="number">1</span>) del(l ++) ;</span><br><span class="line">            res = <span class="number">0</span> ; lb = blg[q[i].l] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ul = l ; LL anss = res ;</span><br><span class="line">        <span class="keyword">while</span> (r &lt; q[i].r) add(++ r, res) ;</span><br><span class="line">        anss = res ; <span class="keyword">while</span> (ul &gt; q[i].l) add(-- ul, anss) ;</span><br><span class="line">        <span class="keyword">while</span> (ul &lt; l) del(ul ++) ; ans[q[i].id] = anss ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="LG-5906-å›æ»šè«é˜Ÿ"><a href="#LG-5906-å›æ»šè«é˜Ÿ" class="headerlink" title="LG 5906 å›æ»šè«é˜Ÿ"></a>LG 5906 å›æ»šè«é˜Ÿ</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªåºåˆ—ï¼Œå¤šæ¬¡è¯¢é—®ä¸€æ®µåŒºé—´ $[l,r]$ï¼Œæ±‚åŒºé—´ä¸­<strong>ç›¸åŒçš„æ•°çš„æœ€è¿œé—´éš”è·ç¦»</strong>ã€‚</p>
<p>åºåˆ—ä¸­ä¸¤ä¸ªå…ƒç´ çš„<strong>é—´éš”è·ç¦»</strong>æŒ‡çš„æ˜¯<strong>ä¸¤ä¸ªå…ƒç´ ä¸‹æ ‡å·®çš„ç»å¯¹å€¼</strong>ã€‚</p>
<p>$1\leq n,m\leq 2\cdot 10^5$</p>
</blockquote>
<p>æœ¬è´¨ä¸Šç¬¬ä¸€æ¬¡è§è¿™é¢˜æ˜¯æŸæ¬¡æ ¡å†…èƒ¡ç­– <a href="https://www.luogu.com.cn/problem/U96381" target="_blank" rel="noopener">æˆ³æˆ‘</a>ã€‚ä¹‹åå‘ç°åŸæ¥æ˜¯ <code>codechef</code> ä¸Šçš„é¢˜ï¼Œç„¶åå°±è‡ªå·±å‡ºäº†æ•°æ®æ”¾åˆ°äº†è°·ä¸Šâ€¦â€¦ç„¶è€Œæ•°æ®ååˆ†çš„æ°´â€¦â€¦è™½ç„¶æˆ‘è§‰å¾—æˆ‘æ˜¯ç²¾å¿ƒæ„é€ äº†â€¦233</p>
<p>ç„¶åè¿™é¢˜å…¶å®æ˜¯é“å¥½é¢˜â€¦åŸå› å°±æ˜¯ä¸Šä¸€é“é¢˜æ˜¯ä¸å®Œå…¨ç‰ˆçš„å›æ»šè«é˜Ÿï¼šä¸Šä¸€é“é¢˜çš„å·¦ç«¯ç‚¹ <code>add</code> å’Œå³ç«¯ <code>add</code> å¯ä»¥ä¸€æ ·ï¼Œå› ä¸ºç¬¬äºŒå±‚ä¿¡æ¯ <code>buc</code> å¯ä»¥å·®åˆ†ï¼Œå³å¦‚æœç°å‡æˆ $-1$ åæ¥æ˜¯å¯ä»¥åŠ å›æ¥çš„ï¼›ä½†æ˜¯è¿™é“é¢˜çš„è¯ï¼Œå¦‚æœè®°å½•ä¸Šä¸€ä¸ªå’Œä¸‹ä¸€ä¸ªç›¸åŒçš„æ•°å­—çš„ä½ç½®ä¼šæœ‰å¾ˆéº»çƒ¦çš„è¾¹ç•Œï¼Œå¤§éƒ¨åˆ†åšæ³•éƒ½æ˜¯èµ‹å€¼ä¸º $0$ æˆ– $n$ ï¼Œä½†è¿™æ ·å°±ä¼šä¸¢å¤±ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯å·¦ç«¯ç‚¹çš„ <code>add</code> å’Œå³ç«¯ç‚¹çš„ <code>add</code> è¦åˆ†å¼€å¤„ç†ã€‚</p>
<p>æ‰€ä»¥å¦‚æœé“æ†¨æ†¨åœ°æ‹¿å¤´å†™å°±ä¼šç”±å¾ˆå¤šè¾¹ç•Œï¼Œæ‰€ä»¥æ¯”è¾ƒå¥½çš„å¤„ç†æ–¹å¼ï¼š</p>
<h2 id="è¯¢é—®åˆ†å—å¤„ç†"><a href="#è¯¢é—®åˆ†å—å¤„ç†" class="headerlink" title="è¯¢é—®åˆ†å—å¤„ç†"></a>è¯¢é—®åˆ†å—å¤„ç†</h2><p>å¤§æ¦‚å°±æ˜¯æ¯ä¸ªå—æ¸…é›¶ä¸€æ¬¡ï¼Œç›´æ¥è®©ä¸¤ä¸ªæŒ‡é’ˆå›å½’ã€‚è¿™æ ·åšä¸å®¹æ˜“é”™ï¼Œä½†å¤æ‚åº¦æ˜¯æ»¡çš„ $\frac{n^2}{\sqrt m}$ ï¼ˆå› ä¸ºæ¯ä¸ªå—éƒ½æ˜¯ $\Theta(n)$ çš„æ¸…é›¶ï¼‰ã€‚æ‰€ä»¥å¤§æ¦‚å¯ä»¥æ”¹ä¸‹å—å¤§å°æ¥å¾®è°ƒï¼Ÿä½†å…¶å®è¿™é¢˜æˆ‘å‡ºçš„æ‰€æœ‰ $n,m$ å·®ä¸è¶…è¿‡ $5$ â€¦233</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qs</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, id ;</span><br><span class="line">&#125;q[M] ;</span><br><span class="line"><span class="keyword">int</span> len ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> buc[N] ;</span><br><span class="line"><span class="keyword">int</span> blg[N] ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> b, bnum ;</span><br><span class="line"><span class="keyword">int</span> L[N], R[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, x, y ;</span><br><span class="line"><span class="keyword">int</span> val[N], base[N] ;</span><br><span class="line"><span class="keyword">int</span> pre[N], tmp[N], suf[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">const</span> qs &amp;a, <span class="keyword">const</span> qs &amp;b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> blg[a.l] == blg[b.l] ? a.r &lt; b.r : blg[a.l] &lt; blg[b.l] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ; <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Min</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;a, <span class="keyword">const</span> <span class="keyword">int</span> &amp;b)</span></span>&#123; <span class="keyword">return</span> a &lt; b ? a : b ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Max</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;a, <span class="keyword">const</span> <span class="keyword">int</span> &amp;b)</span></span>&#123; <span class="keyword">return</span> a &gt; b ? a : b ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">brute_force</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i) tmp[base[i]] = n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">        tmp[base[i]] = Min(tmp[base[i]], i), ret = Max(ret, i - tmp[base[i]]) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;p)</span></span>&#123;</span><br><span class="line">    suf[base[p]] = Max(suf[base[p]], p) ;</span><br><span class="line">    pre[base[p]] = Min(pre[base[p]], p) ;</span><br><span class="line">    res = Max(res, suf[base[p]] - pre[base[p]]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> bnum)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = s, L = Min(n, bnum * b) ;</span><br><span class="line">    <span class="keyword">int</span> l = L + <span class="number">1</span>, r = L ; res = <span class="number">0</span> ;</span><br><span class="line">    fill(pre + <span class="number">1</span>, pre + len + <span class="number">1</span>, n) ;</span><br><span class="line">    fill(suf + <span class="number">1</span>, suf + len + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span>( ; blg[q[i].l] == bnum ; ++ i )&#123;</span><br><span class="line">        <span class="keyword">if</span> (blg[q[i].l] == blg[q[i].r])&#123;</span><br><span class="line">            ans[q[i].id] = brute_force(q[i].l, q[i].r) ;</span><br><span class="line">            <span class="keyword">continue</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> anss = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (r &lt; q[i].r) add(++ r) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = q[i].l ; j &lt;= l ; ++ j) tmp[base[j]] = n ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = q[i].l ; j &lt;= l ; ++ j)&#123;</span><br><span class="line">            tmp[base[j]] = Min(tmp[base[j]], j) ;</span><br><span class="line">            anss = max(anss, Max(j - tmp[base[j]], suf[base[j]] - j)) ;</span><br><span class="line">        &#125;</span><br><span class="line">        ans[q[i].id] = max(anss, res) ;<span class="comment">// cout &lt;&lt; i &lt;&lt; endl ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        base[i] = qr(), val[i] = base[i] ;</span><br><span class="line">    sort(val + <span class="number">1</span>, val + n + <span class="number">1</span>) ; </span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m ; b = n / <span class="built_in">sqrt</span>(m) ;</span><br><span class="line">    len = unique(val + <span class="number">1</span>, val + n + <span class="number">1</span>) - val - <span class="number">1</span> ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        base[i] = lower_bound(val + <span class="number">1</span>, val + len + <span class="number">1</span>, base[i]) - val ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        q[i].l = qr(), q[i].r = qr(), q[i].id = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) blg[i] = (i - <span class="number">1</span>) / b + <span class="number">1</span> ;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + m + <span class="number">1</span>, comp) ; <span class="keyword">int</span> L = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= blg[n] ; ++ i) &#123;</span><br><span class="line">        L = solve(L, i) ; <span class="keyword">if</span> (L &gt; m) <span class="keyword">break</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]) ;  <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æŠŠæ‰€æœ‰å‡½æ•°å±•å¼€"><a href="#æŠŠæ‰€æœ‰å‡½æ•°å±•å¼€" class="headerlink" title="æŠŠæ‰€æœ‰å‡½æ•°å±•å¼€"></a>æŠŠæ‰€æœ‰å‡½æ•°å±•å¼€</h2><p>æ²¡å†™è¿‡ï¼Œå› ä¸ºä¸ªäººè®¤ä¸ºä¼šæä¹±ç é£ã€‚</p>
<hr>
<h2 id="çå†™"><a href="#çå†™" class="headerlink" title="çå†™"></a>çå†™</h2><p>äºæ˜¯ä¸ªäººæœ€åˆçš„å†™æ³•æ˜¯è¿™æ ·çš„ï¼Œååˆ†åŠè¯¡ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">400100</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">400100</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> len ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> buf[N] ;</span><br><span class="line"><span class="keyword">int</span> tmp[N] ;</span><br><span class="line"><span class="keyword">int</span> blg[N] ;</span><br><span class="line"><span class="keyword">int</span> ans[M] ;</span><br><span class="line"><span class="keyword">int</span> tbuc[N] ;</span><br><span class="line"><span class="keyword">int</span> bucp[N] ;</span><br><span class="line"><span class="keyword">int</span> bucs[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> b, bnum ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qs</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id ;</span><br><span class="line">    <span class="keyword">int</span> l, r ;</span><br><span class="line">&#125;q[M] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(qs a, qs b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (blg[a.l] ^ blg[b.l])</span><br><span class="line">        <span class="keyword">return</span> blg[a.l] &lt; blg[b.l] ;</span><br><span class="line">    <span class="keyword">return</span> a.r &lt; b.r ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">brute_force</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!buf[base[i]]) buf[base[i]] = i ;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ret = max(ret, i - buf[base[i]]) ;</span><br><span class="line">            buf[base[i]] = min(i, buf[base[i]]) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (buf[base[i]]) buf[base[i]] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    bucp[base[x]] = N ;</span><br><span class="line">    bucs[base[x]] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> &amp;val)</span></span>&#123;</span><br><span class="line">    bucs[base[x]] = max(x, bucs[base[x]]) ;</span><br><span class="line">    bucp[base[x]] = min(x, bucp[base[x]]) ;</span><br><span class="line">    val = max(val, bucs[base[x]] - bucp[base[x]]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">0</span>, k = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), tmp[i] = base[i] ;</span><br><span class="line">    sort(tmp + <span class="number">1</span>, tmp + n + <span class="number">1</span>) ;</span><br><span class="line">    len = unique(tmp + <span class="number">1</span>, tmp + n + <span class="number">1</span>) - tmp - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        base[i] = lower_bound(tmp + <span class="number">1</span>, tmp + len + <span class="number">1</span>, base[i]) - tmp ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m ; b = n / <span class="built_in">sqrt</span>(m) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) blg[i] = i / b ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;q[i].l, &amp;q[i].r), q[i].id = i ;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + m + <span class="number">1</span>, comp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) bucs[i] = <span class="number">0</span>, bucp[i] = N ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (blg[q[i].l] == blg[q[i].r])</span><br><span class="line">            ans[q[i].id] = brute_force(q[i].l, q[i].r) ;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (blg[q[i].l] &gt; k)&#123;</span><br><span class="line">                <span class="keyword">while</span> (blg[r] &lt;= blg[q[i].l]) del(r ++)  ;</span><br><span class="line">                <span class="keyword">while</span> (blg[r] &gt; blg[q[i].l]) del(r --) ;</span><br><span class="line">                <span class="keyword">while</span> (blg[l] &lt;= blg[q[i].l]) del(l ++) ;</span><br><span class="line">                add(++ r, res) ; res = <span class="number">0</span> ; k = blg[q[i].l] ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> t, fl = l, ress = <span class="number">0</span> ;</span><br><span class="line">            <span class="keyword">while</span> (r &lt; q[i].r) add(++ r, res) ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = q[i].l ; j &lt;= l ; ++ j) tbuc[base[j]] = N ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = q[i].l ; j &lt;= l ; ++ j)&#123;</span><br><span class="line">                t = base[j] ;</span><br><span class="line">                tbuc[t] = min(j, tbuc[t]) ;</span><br><span class="line">                ress = max(ress, max(j - tbuc[t], bucs[t] - j)) ;</span><br><span class="line">            &#125;</span><br><span class="line">            ans[q[i].id] = max(ress, res) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾¹ç•Œå¾ˆçƒ¦äººâ€¦å¾ˆçƒ¦äººâ€¦å½“ç„¶ä¸ªäººå®åŠ›èœå ä¸»è¦åŸå› â€¦</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>è«é˜Ÿ</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è«é˜Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ ‘ä¸Šè«é˜Ÿ</title>
    <url>/2020/01/23/%E6%A0%91%E4%B8%8A%E8%8E%AB%E9%98%9F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å—¯â€¦å¥½â€¦åºåˆ—æ•°æ®ç»“æ„å°±æ˜¯ç”¨æ¥ä¸Šæ ‘çš„å˜›/kk</p>
<p>å‘ç°é¦–å…ˆæ ‘ä¸Šåˆ†å—å¾ˆå¥½å¤„ç†ï¼Œæ¯”è¾ƒéº»çƒ¦çš„ä¸€ç‚¹åœ¨äºï¼Œå¦‚ä½•ä» $(ou,ov)$ è¿™æ¡è·¯å¾„ç§»åŠ¨åˆ° $(nu,nv)$ã€‚</p>
<p>å‘ç°è«é˜Ÿçš„ç²¾é«“åœ¨äºæ’å®Œåºä¹‹åå·¦å³ç«¯ç‚¹çš„ç§»åŠ¨æ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥è€ƒè™‘å¦‚ä½•è½¬åŒ–æˆ $(ou,nu)$ å’Œ $(ov,nv)$ã€‚</p>
<a id="more"></a>
<h1 id="1-çæ„é€ "><a href="#1-çæ„é€ " class="headerlink" title="$1$ çæ„é€ "></a>$1$ çæ„é€ </h1><p><del>èœœæ±more.jpg</del></p>
<p>æœ‰ä¸€ä¸ªå¾ˆå¸¸è§çš„å®šç†ï¼Œå°±æ˜¯ã€Œæ ‘ä¸Šä¸¤æ¡è·¯å¾„å¦‚æœæœ‰äº¤ç‚¹ï¼Œé‚£ä¹ˆä¸€å®šæ˜¯åœ¨å…¶ä¸­ä¸€æ¡è·¯å¾„ä¸¤ç«¯ç‚¹çš„ $lca$   ã€ã€‚</p>
<p>è¯æ˜æš‚æ—¶ä¸çŸ¥é“ï¼ˆä½†æ˜¯æˆ‘æœ‰åœ¨æ€è€ƒï¼‰ä»€ä¹ˆæ¯”è¾ƒä¼˜ç¾çš„è¯æ˜ã€‚ä½†é‡åˆ°è¿™ç§æƒ…å†µæ€»æ˜¯å¯ä»¥åˆ†ç±»è®¨è®ºçš„â€¦ç•¥äº†ç•¥äº†</p>
<p>äºæ˜¯ä¸ºäº†ä¸å¤„ç†æœ¬æ¥å°±æœ‰äº¤ç‚¹çš„æƒ…å†µï¼Œè«é˜Ÿä¸Šæ ‘é€‰æ‹©ç»´æŠ¤ $p(u,v)=(u,v)\setminus\{lca(u,v)\}$ ã€‚å‘ç°è¿™ä¸œè¥¿æœ‰å¾ˆå¥½çš„æ€§è´¨ï¼Œå³ </p>
<script type="math/tex; mode=display">
p(u,v)~\mathrm{xor}~ p(x,y)=p(x, u) \text { xor } p(v, y)</script><p>å…¶ä¸­ $~\mathrm{xor}~$ å®šä¹‰åœ¨é›†åˆä¸Šã€‚</p>
<p>è¯æ˜å¤§æ¦‚æ˜¯è€ƒè™‘ä»¤ $r(x)$ è¡¨ç¤º $x$ åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„çš„ç‚¹é›†ã€‚é‚£ä¹ˆå°±å¯ä»¥è¿™ä¹ˆåŒ–å¼å­ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
p(u,v)~\mathrm{xor}~ p(x,y)&=p(x, u) \text { xor } p(v, y)\\
(r(u) ~\mathrm{xor}~ r(v))~\mathrm{xor}~(r(x) ~\mathrm{xor}~ r(y))&=(r(u) ~\mathrm{xor}~ r(x))~\mathrm{xor}~(r(v) ~\mathrm{xor}~ r(y))\\

\end{aligned}</script><p>ç„¶åæ¥ä¸‹æ¥æ‡’å¾—å†™äº†ï¼Œå‘ç°å°±æ˜¯ä¸ªäº¤æ¢å¾‹+ç»“åˆå¾‹çš„å¥—è·¯ã€‚</p>
<p>äºæ˜¯è€ƒè™‘æ¯æ¬¡æŠŠ $p(ou,nu)$ å’Œ $p(ov, nv)$ å†…çš„ç‚¹å…¨éƒ¨å–åï¼Œå•ç‹¬å¤„ç†ä¸€ä¸‹ $lca$ å°±å¥½äº†ã€‚</p>
<h1 id="2-å¦‚ä½•åˆ†å—"><a href="#2-å¦‚ä½•åˆ†å—" class="headerlink" title="$2$ å¦‚ä½•åˆ†å—"></a>$2$ å¦‚ä½•åˆ†å—</h1><p>å‘ç°å°±æ˜¯ <code>loj#2151ç‹å®¤è”é‚¦</code> è¿™é¢˜çš„åˆ†å—æ–¹å¼ã€‚ä¼¼ä¹è¿™ä¸œè¥¿è¯æ˜çš„è¯å¯ä»¥ç›´æ¥å½’çº³å‡ºæ¥ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> base = tp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u]; k; k = next(k)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == f)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        dfs(to(k), u);</span><br><span class="line">        <span class="keyword">if</span> (tp - base &gt;= S) &#123;</span><br><span class="line">            cap[++Id] = u;</span><br><span class="line">            <span class="keyword">while</span> (tp &gt; base) </span><br><span class="line">              blg[s[tp--]] = Id;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    s[++tp] = u;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; S;</span><br><span class="line">    <span class="keyword">int</span> i, u, v;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; N; ++i) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), add(u, v);</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span> (tp) blg[s[tp--]] = Id;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; Id &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= N; ++i) <span class="built_in">cout</span> &lt;&lt; blg[i] &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= Id; ++i) <span class="built_in">cout</span> &lt;&lt; cap[i] &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-ä¾‹é¢˜"><a href="#3-ä¾‹é¢˜" class="headerlink" title="$3$ ä¾‹é¢˜"></a>$3$ ä¾‹é¢˜</h1><h2 id="1-SP10707-Count-On-a-Tree-2"><a href="#1-SP10707-Count-On-a-Tree-2" class="headerlink" title="$1$ SP10707 Count On a Tree 2"></a>$1$ SP10707 Count On a Tree 2</h2><blockquote>
<p>ç»™å®šä¸€ä¸ª $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªæ•´æ•°ã€‚</p>
<p>$q$ ç»„è¯¢é—®ï¼Œè¯¢é—® $u$ åˆ° $v$ çš„è·¯å¾„ä¸Šæœ‰å¤šå°‘ä¸ªä¸åŒçš„æ•´æ•°ã€‚</p>
</blockquote>
<p>å¥—è·¯é¢˜ï¼Ÿä¸ç¦æ€è€ƒæˆ‘éƒ½åšäº†äº›ä»€ä¹ˆæµªè´¹æ—¶é—´çš„é¢˜å•Šâ€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;E[M] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qss</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id ;</span><br><span class="line">    <span class="keyword">int</span> u, v ;</span><br><span class="line">&#125;qs[M] ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> buc[N] ;</span><br><span class="line"><span class="keyword">int</span> son[N] ;</span><br><span class="line"><span class="keyword">int</span> blg[N] ;</span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> b, bnum ;</span><br><span class="line"><span class="keyword">int</span> n, q, len ;</span><br><span class="line"><span class="keyword">int</span> stk[N], tp ;</span><br><span class="line"><span class="keyword">int</span> head[N], cnt ;</span><br><span class="line"><span class="keyword">int</span> top[N], sz[N] ;</span><br><span class="line"><span class="keyword">int</span> dep[N], fa[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N], t[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v, next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line">    to(++ cnt) = u, next(cnt) = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">	<span class="comment">//cout &lt;&lt; u &lt;&lt; endl ; </span></span><br><span class="line">    <span class="keyword">int</span> old = tp ; sz[u] = <span class="number">1</span> ;</span><br><span class="line">    fa[u] = f, dep[u] = dep[f] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) != f)&#123;</span><br><span class="line">            dfs(to(k), u), sz[u] += sz[to(k)] ;</span><br><span class="line">            <span class="keyword">if</span> (!son[u] || sz[son[u]] &lt; sz[to(k)]) son[u] = to(k) ;</span><br><span class="line">			<span class="keyword">if</span> (tp - old &gt;= b)&#123;</span><br><span class="line">         	   ++ bnum ;</span><br><span class="line">         	   <span class="keyword">while</span> (tp &gt; old)</span><br><span class="line">				   blg[stk[tp --]] = bnum ;</span><br><span class="line">        	&#125;</span><br><span class="line">		&#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    stk[++ tp] = u ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f, <span class="keyword">int</span> tp)</span></span>&#123;</span><br><span class="line">    top[u] = tp ;</span><br><span class="line">    <span class="keyword">if</span> (son[u]) dfs(son[u], u, tp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))</span><br><span class="line">        <span class="keyword">if</span> (to(k) != f &amp;&amp; to(k) != son[u]) dfs(to(k), u, to(k)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(qss a, qss b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> blg[a.u] == blg[b.u] ? blg[a.v] &lt; blg[b.v] : blg[a.u] &lt; blg[b.u] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (top[u] != top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[top[u]] &lt; dep[top[v]])</span><br><span class="line">            swap(u, v) ; u = fa[top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[u] &lt; dep[v] ? u : v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rev</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!vis[x])</span><br><span class="line">        res += !buc[base[x]] ++ ;</span><br><span class="line">    <span class="keyword">else</span> res -= !-- buc[base[x]] ;</span><br><span class="line">    vis[x] ^= <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">movemove</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v]) swap(u, v) ;</span><br><span class="line">    <span class="keyword">while</span> (dep[u] &gt; dep[v]) rev(u), u = fa[u] ;</span><br><span class="line">    <span class="keyword">while</span> (u != v) rev(u), rev(v), u = fa[u], v = fa[v] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q ; </span><br><span class="line">	<span class="keyword">int</span> u, v, f ; b = <span class="built_in">sqrt</span>(n) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), t[i] = base[i] ;</span><br><span class="line">    sort(t + <span class="number">1</span>, t + n + <span class="number">1</span>) ;</span><br><span class="line">    len = unique(t + <span class="number">1</span>, t + n + <span class="number">1</span>) - t - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        base[i] = lower_bound(t + <span class="number">1</span>, t + n + <span class="number">1</span>, base[i]) - t ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), add(u, v) ;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>) ; dfs(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>) ; bnum ++ ;</span><br><span class="line">	<span class="keyword">while</span> (tp) blg[stk[tp --]] = bnum ; </span><br><span class="line">	<span class="comment">//for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; top[i] &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;qs[i].u, &amp;qs[i].v), qs[i].id = i ;</span><br><span class="line">	<span class="comment">//cout &lt;&lt; lca(5, 8) &lt;&lt; " " &lt;&lt; lca(2, 7) &lt;&lt; " " &lt;&lt; lca(3, 7) &lt;&lt; endl ; </span></span><br><span class="line">    sort(qs + <span class="number">1</span>, qs + q + <span class="number">1</span>, comp) ; u = v = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)&#123;</span><br><span class="line">        movemove(u, qs[i].u) ; u = qs[i].u ;</span><br><span class="line">        movemove(v, qs[i].v) ; v = qs[i].v ;</span><br><span class="line">		<span class="comment">//cout &lt;&lt; u &lt;&lt; " " &lt;&lt; v &lt;&lt; " " &lt;&lt; res &lt;&lt; endl ;</span></span><br><span class="line">        f = lca(u, v) ; rev(f) ;</span><br><span class="line">        ans[qs[i].id] = res ; rev(f) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>btwï¼Œæ„Ÿè§‰è‡ªå·±ç é£å¥½å¤šäº†ï¼Ÿ</p>
<h2 id="2-uoj-53-WC2013-ç³–æœå…¬å›­"><a href="#2-uoj-53-WC2013-ç³–æœå…¬å›­" class="headerlink" title="$2$ uoj#53 [WC2013]ç³–æœå…¬å›­"></a>$2$ uoj#53 [WC2013]ç³–æœå…¬å›­</h2><blockquote>
<p>ç»™å‡ºä¸€æ£µ $n$ ä¸ªç‚¹çš„æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªé¢œè‰²ã€‚</p>
<p>æ¯æ¬¡æˆ–è€…è¯¢é—®ä½ ä¸€æ¡è·¯å¾„æ±‚ $\sum_{c}val_c\sum_{i=1}^{cnt_c}w_i$ï¼Œæˆ–è€…æ›´æ”¹ä¸€ä¸ªç‚¹çš„é¢œè‰²ã€‚</p>
<p>å…¶ä¸­ $val$ è¡¨ç¤ºè¯¥é¢œè‰²çš„ä»·å€¼, $cnt$ è¡¨ç¤ºå…¶å‡ºç°çš„æ¬¡æ•°, $w_i$ è¡¨ç¤ºç¬¬ $i$ æ¬¡å‡ºç°çš„ä»·å€¼ã€‚</p>
<p>å¯ä»¥ç¦»çº¿ã€‚</p>
</blockquote>
<p>å‘ç°å°±æ˜¯æ ‘ä¸Šè«é˜Ÿå¥—äº†ä¸€ä¸ªå¸¦ä¿®ï¼Ÿ</p>
<p>å†™èµ·æ¥æ²¡ä»€ä¹ˆæ„Ÿè§‰â€¦å°±æ˜¯å¾ˆé•¿â€¦å¾ˆé•¿â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Q = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next ;</span><br><span class="line">&#125;E[N &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">uv</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> p, c ;</span><br><span class="line">&#125;us[Q] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qs</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v ;</span><br><span class="line">    <span class="keyword">int</span> t, id ;</span><br><span class="line">&#125;qy[Q] ;</span><br><span class="line">LL res ;</span><br><span class="line">LL ans[Q] ;</span><br><span class="line"><span class="keyword">int</span> n, m, q ;</span><br><span class="line"><span class="keyword">int</span> cntu, cntq ;</span><br><span class="line"><span class="keyword">int</span> stk[N], tp ;</span><br><span class="line"><span class="keyword">int</span> head[N], cnt ;</span><br><span class="line"><span class="keyword">int</span> sz[N], son[N] ;</span><br><span class="line"><span class="keyword">int</span> buc[N], vis[N] ;</span><br><span class="line"><span class="keyword">int</span> b, bnum, blg[N] ;</span><br><span class="line"><span class="keyword">int</span> dep[N], fa[N], top[N] ;</span><br><span class="line"><span class="keyword">int</span> val[M], wth[M], clr[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; u &lt;&lt; endl ;</span></span><br><span class="line">    dep[u] = dep[f] + <span class="number">1</span> ;</span><br><span class="line">    sz[u] = <span class="number">1</span>, fa[u] = f ; <span class="keyword">int</span> t = tp ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs(to(k), u) ; sz[u] += sz[to(k)] ;</span><br><span class="line">        <span class="keyword">if</span> (!son[u] || sz[son[u]] &lt; sz[to(k)]) son[u] = to(k) ;</span><br><span class="line">        <span class="keyword">if</span> (tp - t &gt;= b)&#123;</span><br><span class="line">            ++ bnum ;</span><br><span class="line">            <span class="keyword">while</span> (tp &gt; t)</span><br><span class="line">                blg[stk[tp --]] = bnum ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    stk[++ tp] = u ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v, next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line">    to(++ cnt) = u, next(cnt) = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f, <span class="keyword">int</span> tp)</span></span>&#123;</span><br><span class="line">    top[u] = tp ;</span><br><span class="line">    <span class="keyword">if</span> (son[u]) dfs(son[u], u, tp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))</span><br><span class="line">        <span class="keyword">if</span> (to(k) != son[u] &amp;&amp; to(k) != f) dfs(to(k), u, to(k)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (top[u] != top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[top[u]] &lt; dep[top[v]])</span><br><span class="line">            u ^= v ^= u ^= v ; u = fa[top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[u] &lt; dep[v] ? u : v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(qs a, qs c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (blg[a.u] == blg[c.u]) ?</span><br><span class="line">           ((blg[a.v] == blg[c.v]) ? a.t &lt; c.t : blg[a.v] &lt; blg[c.v]) : (blg[a.u] &lt; blg[c.u]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rev</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (vis[x])</span><br><span class="line">        res -= <span class="number">1l</span>l * wth[buc[clr[x]] --] * val[clr[x]] ;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        res += <span class="number">1l</span>l * wth[++ buc[clr[x]]] * val[clr[x]] ;</span><br><span class="line">    vis[x] ^= <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">movemove</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &lt; dep[y]) swap(x, y) ;</span><br><span class="line">    <span class="keyword">while</span> (dep[x] &gt; dep[y]) rev(x), x = fa[x] ;</span><br><span class="line">    <span class="keyword">while</span> (x != y) rev(x), rev(y), x = fa[x], y = fa[y] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    freopen("in.in", "r", stdin) ;</span></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; q ;</span><br><span class="line">    <span class="keyword">int</span> u, v, f, l, r, mk, t ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;val[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;wth[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), add(u, v) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;clr[i]) ;</span><br><span class="line">    <span class="comment">//for (int i = 1 ; i &lt;= cnt ; ++ i) cout &lt;&lt; E[i].to &lt;&lt; endl ;</span></span><br><span class="line">    b = <span class="built_in">pow</span>(<span class="number">1.0</span> * n, <span class="number">0.6667</span>) ;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>) ; ++ bnum ;</span><br><span class="line">    <span class="keyword">while</span> (tp) blg[stk[tp --]] = bnum ;dfs(<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>) ;</span><br><span class="line">    u = <span class="number">1</span>, v = <span class="number">1</span>, t = <span class="number">0</span> ;</span><br><span class="line"><span class="comment">//  for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; top[i] &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">//    cout &lt;&lt; lca(1, 3) &lt;&lt; " " &lt;&lt; lca(2,4) &lt;&lt; " " &lt;&lt; lca(1, 4) &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">//  for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; fa[i] &lt;&lt; " "  ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;mk, &amp;l, &amp;r) ;</span><br><span class="line">        <span class="keyword">if</span> (mk)</span><br><span class="line">            qy[++ cntq].u = l, qy[cntq].v = r,</span><br><span class="line">            qy[cntq].t = cntu, qy[cntq].id = cntq ;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            us[++ cntu].p = l, us[cntu].c = r ;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(qy + <span class="number">1</span>, qy + cntq + <span class="number">1</span>, comp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cntq ; ++ i)&#123;</span><br><span class="line">        movemove(u, qy[i].u) ;</span><br><span class="line">        movemove(v, qy[i].v) ;</span><br><span class="line">        u = qy[i].u, v = qy[i].v ;</span><br><span class="line">        <span class="keyword">while</span> (t &lt; qy[i].t)&#123;</span><br><span class="line">            ++ t ;</span><br><span class="line">            <span class="keyword">if</span> (vis[us[t].p])</span><br><span class="line">                rev(us[t].p),</span><br><span class="line">                swap(clr[us[t].p], us[t].c),</span><br><span class="line">                rev(us[t].p) ;</span><br><span class="line">            <span class="keyword">else</span> swap(clr[us[t].p], us[t].c) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (t &gt; qy[i].t)&#123;</span><br><span class="line">            <span class="keyword">if</span> (vis[us[t].p])</span><br><span class="line">                rev(us[t].p),</span><br><span class="line">                swap(clr[us[t].p], us[t].c),</span><br><span class="line">                rev(us[t].p) ;</span><br><span class="line">            <span class="keyword">else</span> swap(clr[us[t].p], us[t].c) ;</span><br><span class="line">            t -- ;</span><br><span class="line">        &#125;</span><br><span class="line">        f = lca(u, v) ; rev(f) ;</span><br><span class="line">        ans[qy[i].id] = res ; rev(f) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cntq ; ++ i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>è«é˜Ÿ</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è«é˜Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘ç®€å•è«é˜Ÿçå¹</title>
    <url>/2020/01/23/%E6%99%AE%E9%80%9A%E8%8E%AB%E9%98%9F%E4%B8%8E%E5%B8%A6%E4%BF%AE%E8%8E%AB%E9%98%9F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>â€¦æ„Ÿè§‰è¿™ä¸œè¥¿ä¼¼ä¹ä¹Ÿæ²¡å•¥å¥½è¯´çš„å•Š</p>
<a id="more"></a>
<h1 id="1-ç†è®ºçå¹"><a href="#1-ç†è®ºçå¹" class="headerlink" title="$1$ ç†è®ºçå¹"></a>$1$ ç†è®ºçå¹</h1><p>å¤§æ¦‚å°±æ˜¯ä¸ªåˆ†å—ï¼Ÿä½†æ˜¯æ˜¯å¯¹è¯¢é—®åˆ†å—çš„ã€‚è«é˜Ÿçš„ç²¾é«“åœ¨äºæ’åºï¼Œæ’åºæ—¶å¦‚æœ <code>belong[l]</code> ç›¸åŒå¤æ‚åº¦å°±æŒ‰ç…§å³ç«¯ç‚¹æ’åºï¼Œè¿™æ ·ä¼¼ä¹æ˜¯æœ‰ä¿è¯çš„ï¼Ÿ</p>
<p>ä»¤ $m$ ä¸ºæ“ä½œæ•°ï¼Œ$B$ ä¸ºå—å¤§å°ã€‚è€ƒè™‘å¯¹äºä¸€ä¸ªå—å†…çš„ $l$ï¼Œå…¶ $r$ æ˜¯å•å¢çš„ï¼Œäºæ˜¯è€ƒè™‘å¦‚ä¸‹ï¼š</p>
<ul>
<li>å·¦ç«¯ç‚¹ï¼Œåœ¨å—å†…å¯èƒ½ä¼šä¸€å‰ä¸€åè¿™æ ·è®¾ç½®ï¼Œè¿™æ ·å¤æ‚åº¦è¢«å¡åˆ°æœ€æ»¡ï¼Œä¸º $O(m\cdot B)$ ï¼›</li>
<li>å³ç«¯ç‚¹ï¼Œè€ƒè™‘å„å—å†…çš„è¯¢é—®æ˜¾ç„¶éƒ½å¯ä»¥åšåˆ°å•å— $O(n)$ï¼Œæ‰€ä»¥ä¸éœ€è¦è€ƒè™‘ $m$ çš„è´¡çŒ®ï¼Œå³å³ç«¯ç‚¹ç§»åŠ¨çš„å¤æ‚åº¦å°±æ˜¯ $\frac{n}{B}\cdot n=\frac{n^2}{B}$ã€‚</li>
</ul>
<p>å‡å€¼ä¸€ä¸‹å‘ç° $m\cdot B+\frac{n^2}{B}\geq 2\sqrt{n^2m}=O(n\sqrt m)$ ï¼Œæ­¤æ—¶æœ‰ $m\cdot B=\frac{n^2}{B}$ï¼Œè§£å¾— $B=\frac{n}{\sqrt m}$ .</p>
<p>æ‰€ä»¥å–å—å¤§å°ä¸º $\frac{n}{\sqrt m}$ æ—¶è¾¾åˆ°ç†è®ºæœ€ä¼˜ï¼Œå¤æ‚åº¦ä¸º $O(n\sqrt m)$ ã€‚</p>
<p>â€¦å½“ç„¶è¿™ä¸œè¥¿å¯èƒ½ä¸å‡†ï¼Œæ¯•ç«Ÿå¸¸æ•°ç¨å¾®ä¼˜ä¸€ç‚¹å¯èƒ½å°±å¯ä»¥çåˆ†å—äº†233</p>
<p>ç„¶åè€ƒè™‘å¦‚ä½•å¸¦ä¿®æ”¹(å½“ç„¶åªèƒ½ç¦»çº¿åš)ã€‚å‘ç°å•çº¯åœ°å¹³ç§»è¯¢é—®åŒºé—´ä¸å¯¹ï¼Œäºæ˜¯è€ƒè™‘åŠ ä¸€ç»´æ—¶é—´è½´ï¼Œåœ¨å¹³ç§»å®Œè¯¢é—®ä¹‹åå¹³ç§»ä¿®æ”¹æ“ä½œã€‚æ’åºæ—¶æŠŠã€Œç¦»å½“å‰è¯¢é—®æœ€è¿‘çš„å‰ä¸€ä¸ªä¿®æ”¹æ“ä½œæ˜¯ç¬¬å‡ æ¬¡ä¿®æ”¹ã€ä½œä¸ºç¬¬ä¸‰å…³é”®å­—ï¼Œç¬¬äºŒå…³é”®å­—æ¢æˆã€Œå³ç«¯ç‚¹æ‰€åœ¨å—çš„ç¼–å·ã€ã€‚</p>
<p>ä»¤ $c$ ä¸ºä¿®æ”¹ä¸ªæ•°ï¼Œ $q$ ä¸ºè¯¢é—®ä¸ªæ•°ï¼Œ$B$ ä¾æ—§ä¸ºå—å¤§å°ã€‚é‚£ä¹ˆè€ƒè™‘ä¸‰ç»´æŒ‡é’ˆæ˜¯æ€ä¹ˆç§»åŠ¨çš„ï¼š</p>
<ul>
<li>å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹ä¾æ¬¡è¿˜æ˜¯ $qB+\frac{n^2}{B}$ ï¼›</li>
<li>æ—¶é—´ç«¯ç‚¹ï¼Œè€ƒè™‘æ—¶é—´ç«¯ç‚¹å®é™…ä¸Šæ¯æ¬¡è‡³å¤šç§»åŠ¨ $c$ï¼Œä½†æ˜¯æ—¶é—´ç«¯ç‚¹ä¹‹å¤–æ­¤æ—¶å¥—äº†ä¸€å±‚æŒ‰ <code>belong[r]</code> åˆ†çš„å—ï¼Œæ‰€ä»¥è¿™ä¸€éƒ¨åˆ†çš„å¤æ‚åº¦ä¸º $O(c\times\frac{n^2}{B^2})$ .</li>
</ul>
<p>äºæ˜¯æ€»å¤æ‚åº¦ä¸º $O(\frac{n^2c}{B^2}+qB+\frac{n^2}{B})$ã€‚</p>
<p>è¿™ä¸ªä¸œè¥¿ä»–æ€ä¹ˆæ±‚ $\min$ å‘¢â€¦</p>
<p><del>å—¯ï¼Œä½ çœ‹è¿™ä¸ªå¼å­è¿™ä¹ˆå¯çˆ±ï¼Œæ±‚å¯¼æ€»æ˜¯å¯ä»¥æ±‚å‡ºæ¥çš„å§ï¼Œäºæ˜¯å°±ä¸è¯¦ç»†å†™äº†</del>~</p>
<p>ç›´æ¥ä¸Šç»“è®ºï¼Œ$B=O(n^{\frac{2}{3}})$ æ—¶æœ€ä¼˜ï¼Œæ­¤æ—¶å¤æ‚åº¦ä¸º $O(n^{\frac{2}{3}}c+n^{\frac{2}{3}}q+n^\frac{4}{3})=O(n^{\frac{2}{3}}m)$ã€‚</p>
<p>å‘ç°è¿™ä¸œè¥¿å¾ˆå¥½çš„ä¸€ç‚¹å°±æ˜¯ï¼Œè¿™ä¹ˆåˆ†å—ï¼Œå¤æ‚åº¦ä¸ä¼šå—æ“ä½œç±»å‹å½±å“ï¼Œå› ä¸º $q+c=m$ æ˜¯æ ¹æ®å·²çŸ¥æ¨å‡ºæ¥ï¼Œä¸æ˜¯æ”¾ç¼©æ”¾æ‰çš„ã€‚æ‰€ä»¥æ˜¯ä¸ªå¾ˆæ»¡åˆ†çš„å¤æ‚åº¦ã€‚</p>
<h1 id="2-æ°´é¢˜çåš"><a href="#2-æ°´é¢˜çåš" class="headerlink" title="$2$ æ°´é¢˜çåš"></a>$2$ æ°´é¢˜çåš</h1><h2 id="1-LG2709-å°Bçš„è¯¢é—®"><a href="#1-LG2709-å°Bçš„è¯¢é—®" class="headerlink" title="$1$ LG2709 å°Bçš„è¯¢é—®"></a>$1$ LG2709 å°Bçš„è¯¢é—®</h2><blockquote>
<p>ç»™å‡ºé•¿åº¦ä¸º $n$ çš„åºåˆ—ï¼Œ$q$ ç»„è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®åŒºé—´ $[l,r]$ å†…çš„ $\sum e_i^2$ ã€‚å…¶ä¸­ $e_i$ è¡¨ç¤ºæ•° $i$ çš„å‡ºç°æ¬¡æ•°ã€‚</p>
</blockquote>
<p>ä¼¼ä¹æ˜¯æ†¨æ†¨é¢˜ï¼Ÿå°±æ˜¯é“æ™®é€šçš„è«é˜Ÿã€‚</p>
<p>ä¸è¿‡å­¦äº†ä¸€æ‹›ï¼Œå°±æ˜¯å¥‡å¶å—çš„ $r$ åæ ‡åå‘æ’åºã€‚è¿™æ ·ä¼¼ä¹ç†è®ºåº”è¯¥å¸¦ä¸€ä¸ªä¸‹ç•Œä¸º $\frac{1}{2}$ çš„å¸¸æ•°ã€‚ä½†å®é™…åº”ç”¨å¯èƒ½å¹¶ä¸æ˜æ˜¾ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(querys a, querys b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> blg[a.l] == blg[b.l] ? ((blg[a.l] &amp; <span class="number">1</span>) ? a.r &lt; b.r : a.r &gt; b.r) : blg[a.l] &lt; blg[b.l] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123; ans -= (<span class="number">2l</span>l * buc[base[p]] - <span class="number">1l</span>l), buc[base[p]] -- ; &#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123; ans += (<span class="number">2l</span>l * buc[base[p]] + <span class="number">1l</span>l), buc[base[p]] ++ ; &#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-LG1494-å°Zçš„è¢œå­"><a href="#2-LG1494-å°Zçš„è¢œå­" class="headerlink" title="$2$ LG1494 å°Zçš„è¢œå­"></a>$2$ LG1494 å°Zçš„è¢œå­</h2><blockquote>
<p>ç»™å‡ºä¸€ä¸ªé•¿ä¸º $n$ çš„åºåˆ—ï¼Œæ¯æ¬¡è¯¢é—® $[l,r]$ å†…ï¼Œéšæœºå–ä¸¤ä¸ªæ•°å–åˆ°ç›¸åŒçš„æ•°çš„æ¦‚ç‡ã€‚</p>
</blockquote>
<p>å¤§æ¦‚ä¹Ÿæ˜¯ä¸ªæ†¨æ†¨é¢˜â€¦å‘ç°æœ€åç»“æœå°±æ˜¯ $\frac{\mathrm{cnt(same_pair)}}{\binom{r-l+1}{2}}$ã€‚</p>
<h2 id="3-LG3709-å¤§çˆ·çš„å­—ç¬¦ä¸²é¢˜"><a href="#3-LG3709-å¤§çˆ·çš„å­—ç¬¦ä¸²é¢˜" class="headerlink" title="$3$ LG3709 å¤§çˆ·çš„å­—ç¬¦ä¸²é¢˜"></a>$3$ LG3709 å¤§çˆ·çš„å­—ç¬¦ä¸²é¢˜</h2><p>è¿™é¢˜nmdæ˜¯é“è¯­æ–‡é¢˜â€¦</p>
<blockquote>
<p>åŸé¢˜é¢ï¼š</p>
<p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² $a$ï¼Œæ¯æ¬¡è¯¢é—®ä¸€æ®µåŒºé—´çš„è´¡çŒ®</p>
<p>è´¡çŒ®å®šä¹‰ï¼š</p>
<p>æ¯æ¬¡ä»è¿™ä¸ªåŒºé—´ä¸­æ‹¿å‡ºä¸€ä¸ªå­—ç¬¦ $x$ï¼Œç„¶åæŠŠ $x$ ä»è¿™ä¸ªåŒºé—´ä¸­åˆ é™¤ï¼Œä½ è¦ç»´æŠ¤ä¸€ä¸ªé›†åˆ $\rm S$ï¼šå¦‚æœ $\rm S$ ä¸ºç©ºï¼Œä½  $rp$ å‡ $1$ ; å¦‚æœ $\rm S$ ä¸­æœ‰ä¸€ä¸ªå…ƒç´ ä¸å°äº $x$ï¼Œåˆ™ä½  $rp$  å‡ $1$ï¼Œæ¸…ç©º $\rm S$ï¼›ä¹‹åå°† $x$ æ’å…¥ $\rm S$ ã€‚</p>
<p>ç”±äºä½ æ˜¯å¤§çˆ·ï¼Œå¹³æ—¶åšè¿‡çš„é¢˜è€ƒè¯•éƒ½ä¼šè€ƒåˆ°ï¼Œæ‰€ä»¥æ¯æ¬¡è¯¢é—®ä½ æå®Œè¿™æ®µåŒºé—´çš„å­—ç¬¦ä¹‹åæœ€å¤šè¿˜æœ‰å¤šå°‘ $rp$ ï¼Ÿ$rp$ åˆå§‹ä¸º $0$ï¼Œè¯¢é—®ä¹‹é—´ä¸äº’ç›¸å½±å“ã€‚</p>
</blockquote>
<p>å‘ç°å¤§æ¦‚æ˜¯åœ¨è¯´ï¼Œæ¯æ¬¡ç»™å®šä¸€ä¸ªåŒºé—´ï¼Œè¦ä»ä¸­å–å‡ºæœ€å°‘æ•°é‡çš„ä¸¥æ ¼ä¸Šå‡å­åºåˆ—ä½¿å¾—è¦†ç›–æ‰€æœ‰çš„æ•°ã€‚å‘ç°å…¶å®å°±æ˜¯ã€ŒåŒºé—´å†…å‡ºç°æ¬¡æ•°æœ€å¤šçš„æ•°ã€å‡ºç°çš„æ¬¡æ•°ã€‚</p>
<p>è¿™ä¸œè¥¿ä¹Ÿæ¯”è¾ƒå®¹æ˜“ç»´æŠ¤ï¼Œå†æ‹¿å¦ä¸€ä¸ª $bucbuc$ æ¥ç»´æŠ¤ $buc$ å°±è§£å†³äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;p)</span></span>&#123; </span><br><span class="line">	rg <span class="keyword">int</span> t = ++ buc[base[p]] ; </span><br><span class="line">	bucbuc[t] ++, bucbuc[t - <span class="number">1</span>] --, ans += (t &gt; ans) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;p)</span></span>&#123; </span><br><span class="line">	rg <span class="keyword">int</span> t = -- buc[base[p]] ;</span><br><span class="line">	bucbuc[t] ++, bucbuc[t + <span class="number">1</span>] --, ans -= !bucbuc[ans] ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯ç¦»æ•£åŒ–ä¹‹åçš„ï¼Œå¤æ‚åº¦å°±æ˜¯æ¯”è¾ƒç¨³çš„ $m \sqrt n$ äº†ã€‚</p>
<p>ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªä¸è´¹è„‘å­çš„æ–¹æ³•ï¼Œå°±æ˜¯ç¬¬ä¸€ä¸ª $buc$ ç›´æ¥ç”¨ <code>std:: unordered_map</code> æ¥å®ç°ã€‚ä½†è¿™ä¸œè¥¿é¦–å…ˆå¤æ‚åº¦æ˜¯ä¸ªè°œï¼Œä½ è¯´ä»–æ˜¯ $O(1)$ çš„ï¼Œä½†æ˜¯ç¡®å®å¾ˆæ…¢ï¼›ä½ è¯´ä»–æ˜¯ $\log$ çš„ï¼Œä½†æ¯•ç«Ÿåªæ˜¯ä¸ª $Hash$ è¡¨ï¼Œå®åœ¨æ²¡ç†ç”±æ˜¯ $\log$ çš„ã€‚</p>
<p>å—¯ï¼Œå…·ä½“å®ç°å¯èƒ½æ˜¯ä»€ä¹ˆ ã€Œäºš $\log$ã€ çš„Hashè¡¨å§ã€‚</p>
<h2 id="4-LG1903-å›½å®¶é›†è®­é˜Ÿ-æ•°é¢œè‰²"><a href="#4-LG1903-å›½å®¶é›†è®­é˜Ÿ-æ•°é¢œè‰²" class="headerlink" title="$4$  LG1903 [å›½å®¶é›†è®­é˜Ÿ]æ•°é¢œè‰²"></a>$4$  LG1903 [å›½å®¶é›†è®­é˜Ÿ]æ•°é¢œè‰²</h2><blockquote>
<p>è¯¢é—®åŒºé—´å†…ä¸åŒçš„æ•°çš„ä¸ªæ•°+å¸¦ä¿®ã€‚</p>
</blockquote>
<p>è¿™æœ‰å•¥å¥½è¯´çš„å•Šï¼Ÿ</p>
<p>ä¸è¿‡æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼šç”±äºæ—¶é—´è½´å·¦å³æ¨ªè·³è¦æ¶ˆé™¤è´¡çŒ®ï¼Œæ‰€ä»¥éœ€è¦è®°å½•ä¸€ä¸‹æ¯ä¸ªä½ç½®ä¿®æ”¹ä¹‹å‰çš„å€¼ã€‚è¿™ä¸ªåœ°æ–¹ç›´æ¥ <code>std:swap</code> åšå°±å¥½äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(querys a, querys b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> blg[a.l] == blg[b.l] ? </span><br><span class="line">		  (blg[a.r] == blg[b.r] ? a.t &lt; b.t : blg[a.r] &lt; blg[b.r]) : blg[a.l] &lt; blg[b.l] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123; <span class="keyword">if</span> (!-- buc[base[p]]) -- ans ; &#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123; <span class="keyword">if</span> (!buc[base[p]] ++) ++ ans ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; <span class="keyword">int</span> l, r, v, p, i, j ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, In + <span class="number">1</span>) ;</span><br><span class="line">		<span class="keyword">if</span> (In[<span class="number">1</span>] == <span class="string">'Q'</span>)</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;l, &amp;r), q[++ cntq].t = cntm, </span><br><span class="line">			q[cntq].l = l, q[cntq].r = r, q[cntq].id = cntq ;  </span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;p, &amp;v), m[++ cntm].p = p, m[cntm].c = v ;</span><br><span class="line">	&#125;</span><br><span class="line">	B = <span class="built_in">pow</span>((<span class="keyword">double</span>)N, <span class="number">0.677</span>), </span><br><span class="line">	Bnum = <span class="built_in">ceil</span>((<span class="keyword">double</span>)N / (<span class="keyword">double</span>)B) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Bnum ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = B * i + <span class="number">1</span> ; j &lt;= B * (i + <span class="number">1</span>) ; ++ j) blg[j] = i + <span class="number">1</span> ;</span><br><span class="line">	l = <span class="number">1</span>, r = <span class="number">0</span>, ans = <span class="number">0</span>, T = <span class="number">0</span> ;</span><br><span class="line">	sort(q + <span class="number">1</span>, q + cntq + <span class="number">1</span>, comp) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">while</span> (l &lt; q[i].l) del(l ++) ;</span><br><span class="line">		<span class="keyword">while</span> (l &gt; q[i].l) add(-- l) ;		</span><br><span class="line">		<span class="keyword">while</span> (r &gt; q[i].r) del(r --) ;</span><br><span class="line">		<span class="keyword">while</span> (r &lt; q[i].r) add(++ r) ; </span><br><span class="line">		<span class="keyword">while</span> (q[i].t &gt; T)&#123;</span><br><span class="line">			++ T ;</span><br><span class="line">			<span class="keyword">if</span> (m[T].p &lt;= q[i].r &amp;&amp; m[T].p &gt;= q[i].l)&#123;</span><br><span class="line">				<span class="keyword">if</span> (!-- buc[base[m[T].p]]) -- ans ; </span><br><span class="line">				<span class="keyword">if</span> (!buc[m[T].c] ++) ++ ans ; </span><br><span class="line">			&#125;</span><br><span class="line">			swap(m[T].c, base[m[T].p]) ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (q[i].t &lt; T)&#123;</span><br><span class="line">			<span class="keyword">if</span> (m[T].p &lt;= q[i].r &amp;&amp; m[T].p &gt;= q[i].l)&#123;</span><br><span class="line">				<span class="keyword">if</span> (!-- buc[base[m[T].p]]) -- ans ; </span><br><span class="line">				<span class="keyword">if</span> (!buc[m[T].c] ++) ++ ans ; </span><br><span class="line">			&#125;	</span><br><span class="line">			swap(m[T].c, base[m[T].p]) ;</span><br><span class="line">			-- T ;</span><br><span class="line">		&#125;</span><br><span class="line">		res[q[i].id] = ans ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= cntq ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, res[i]) ;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¼¼ä¹é€‰çš„éƒ½æ˜¯å¾ˆæ°´çš„â€¦å‰©ä¸‹çš„é¢˜éœ€è¦è„‘å­ï¼Œæˆ‘è«å¾—è„‘å­ï¼Œæ‰€ä»¥å°±å…ˆè¿™æ ·å§ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>è«é˜Ÿ</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è«é˜Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°&amp;é¢˜è§£ã€‘çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾</title>
    <url>/2020/01/23/%E7%BA%BF%E6%AE%B5%E6%A0%91%E4%BC%98%E5%8C%96%E5%BB%BA%E5%9B%BE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚å°±æ˜¯æŠŠè¾¹æ•°ä» $n^2$ ä¼˜åŒ–åˆ° $n\log n$ çš„ä¸€ä¸ªæ“ä½œï¼Ÿè¿˜æ˜¯æŒºç®€å•çš„å§ã€‚</p>
<a id="more"></a>
<h1 id="0-çæ‰¯"><a href="#0-çæ‰¯" class="headerlink" title="$0$ çæ‰¯"></a>$0$ çæ‰¯</h1><p>è€ƒè™‘ä¸‰ä¸ªåœºæ™¯ï¼šä» $[l_1,r_1]$ è¿å‘ $x$, ä» $x$ è¿å‘ $[l_2,r_2]$ï¼Œä» $[l_1,r_1]$ è¿å‘ $[l_2,r_2]$ ã€‚</p>
<p>å‘ç°å¯ä»¥ç”¨ä¸¤æ£µçº¿æ®µæ ‘æ¥æ¨¡æ‹Ÿè¿™ä¸ªä¸œè¥¿ï¼Œä¸€æ£µçº¿æ®µæ ‘ä» $rt$ å‘ $lc,rc$ è¿è¾¹ï¼Œä¸€æ£µä» $lc,rc$ å‘ $rt$ è¿è¾¹ã€‚åªè¦æŠŠå¶å­èŠ‚ç‚¹è®¾ç½®ä¸º $1\sim n$ ï¼Œè¿™æ ·æœ€ç»ˆç‚¹æ•°å°±æ˜¯ $O(n\log n)$ çš„ã€‚ç¨³å¾—å¾ˆã€‚</p>
<p>ç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚</p>
<h1 id="1-CF786B-Legacy"><a href="#1-CF786B-Legacy" class="headerlink" title="$1$ CF786B Legacy"></a>$1$ CF786B Legacy</h1><blockquote>
<p>ç»™å®šä¸€å¼  $n$ ä¸ªç‚¹çš„å›¾ï¼Œæœ‰ $m$ ä¸ªä¸‹åˆ—æ“ä½œï¼š</p>
<ul>
<li><p>1.è¿›è¡Œå•ç‚¹ä¸å•ç‚¹è¿æœ‰å‘è¾¹ </p>
</li>
<li><p>2.è¿›è¡Œå•ç‚¹ä¸åŒºé—´è¿æœ‰å‘è¾¹ </p>
</li>
<li><p>3.è¿›è¡ŒåŒºé—´ä¸å•ç‚¹è¿æœ‰å‘è¾¹ã€‚</p>
</li>
</ul>
<p>æ±‚æœ€çŸ­è·¯ã€‚</p>
</blockquote>
<p>å‘ç°å°±æ˜¯ä¸ªæ¿å­ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">400010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NN = <span class="number">2000010</span> ;</span><br><span class="line"><span class="keyword">const</span> LL Inf = (<span class="number">1l</span>l &lt;&lt; <span class="number">60</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> val(k) E[k].val</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> val ;</span><br><span class="line">    <span class="keyword">int</span> to, next ;</span><br><span class="line">&#125;E[NN &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line">LL dis[NN] ;</span><br><span class="line"><span class="keyword">int</span> n, m, s ;</span><br><span class="line"><span class="keyword">bool</span> vis[NN] ;</span><br><span class="line"><span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line"><span class="keyword">int</span> Id, head[NN], cnt ;</span><br><span class="line"><span class="keyword">int</span> rt1, rt2, lc[NN], rc[NN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v, val(cnt) = val,</span><br><span class="line">    next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> &amp;rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> rt = l, <span class="keyword">void</span>() ;</span><br><span class="line">    rt = ++ Id ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    build(lc[rt], l, mid, p) ;</span><br><span class="line">    build(rc[rt], mid + <span class="number">1</span>, r, p) ;</span><br><span class="line">    <span class="keyword">if</span> (!p) add(rt, lc[rt], <span class="number">0</span>), add(rt, rc[rt], <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">else</span> add(lc[rt], rt, <span class="number">0</span>), add(rc[rt], rt, <span class="number">0</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> u, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> w, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= ul &amp;&amp; r &lt;= ur)&#123;</span><br><span class="line">        p ? add(rt, u, w) : add(u, rt, w) ;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) update(lc[rt], l, mid, u, ul, ur, w, p) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid) update(rc[rt], mid + <span class="number">1</span>, r, u, ul, ur, w, p) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    Id = n, <span class="built_in">cin</span> &gt;&gt; m &gt;&gt; s ;</span><br><span class="line">    build(rt1, <span class="number">1</span>, n, <span class="number">0</span>) ;</span><br><span class="line">    build(rt2, <span class="number">1</span>, n, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">int</span> mk, u, v, w, l, r ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mk) ;</span><br><span class="line">        <span class="keyword">if</span> (mk == <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;w), add(u, v, w) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (mk == <span class="number">2</span>)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;u, &amp;l, &amp;r, &amp;w),</span><br><span class="line">            update(rt1, <span class="number">1</span>, n, u, l, r, w, mk - <span class="number">2</span>) ;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;u, &amp;l, &amp;r, &amp;w),</span><br><span class="line">            update(rt2, <span class="number">1</span>, n, u, l, r, w, mk - <span class="number">2</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= cnt ; ++ i) cout &lt;&lt; E[i].to &lt;&lt; " " &lt;&lt; E[i].val &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">//    cout &lt;&lt; cnt &lt;&lt; endl ;</span></span><br><span class="line">    fill(dis, dis + Id + <span class="number">1</span>, Inf) ;</span><br><span class="line">    q.push(s), dis[s] = <span class="number">0</span>, vis[s] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> n = q.front() ;</span><br><span class="line">        vis[n] = <span class="number">0</span>, q.pop() ;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; n &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[n] ; k ; k = next(k))&#123;</span><br><span class="line">            <span class="keyword">if</span> (dis[to(k)] &gt; dis[n] + val(k))&#123;</span><br><span class="line">                dis[to(k)] = dis[n] + val(k) ;</span><br><span class="line">                <span class="keyword">if</span> (!vis[to(k)])</span><br><span class="line">                    vis[to(k)] = <span class="number">1</span>, q.push(to(k)) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld "</span>, dis[i] == Inf ? <span class="number">-1</span> : dis[i]) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-LG3588-POI2015-PUS"><a href="#2-LG3588-POI2015-PUS" class="headerlink" title="$2$ LG3588 [POI2015]PUS"></a>$2$ LG3588 [POI2015]PUS</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ­£æ•´æ•°åºåˆ— $a$ ,æ¯ä¸ªæ•°éƒ½åœ¨ $1$ åˆ° $10^9$ èŒƒå›´å†…,å‘Šè¯‰ä½ å…¶ä¸­ $s$ ä¸ªæ•°.</p>
<p>ç»™å‡º $m$ æ¡ä¿¡æ¯,æ¯æ¡ä¿¡æ¯åŒ…å«ä¸‰ä¸ªæ•° $l,r,k$ ä»¥åŠæ¥ä¸‹æ¥ $k$ ä¸ªæ­£æ•´æ•°,è¡¨ç¤º $a_l..a_{l+1}â€¦a_{r-1}..a_r$ é‡Œè¿™ $k$ ä¸ªæ•°ä¸­çš„ä»»æ„ä¸€ä¸ªéƒ½æ¯”ä»»æ„ä¸€ä¸ªå‰©ä¸‹çš„ $r-l+1-k$ ä¸ªæ•°å¤§ (ä¸¥æ ¼å¤§äºï¼Œå³æ²¡æœ‰ç­‰å·)</p>
<p>æ„é€ ä¸€ç»„åˆæ³•è§£æˆ–è€…è¾“å‡º $-1$ </p>
</blockquote>
<p>ä¼¼ä¹å°±æ˜¯ä¸€ä¸ªå·®åˆ†çº¦æŸï¼Ÿå‘ç°æ¯æ¬¡éœ€è¦ä»æ¯ä¸ª $k_{i,j}$ è¿å‘å‰©ä¸‹çš„å­åŒºé—´ã€‚å¦‚æœç”¨çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ï¼Œè¿™æ ·å°±æ˜¯ $\sum k_i^2\log k_i$ çš„è¾¹æ•°ï¼Œç‚¸çš„å¾ˆæƒ¨ã€‚</p>
<p>è¿™ä¸ªåœ°æ–¹æœ‰ä¸ªå¾ˆå¦™çš„ $\rm Idea$ ï¼Œå³å¯¹æ¯ä¸ªæ“ä½œå»ºç«‹ä¸€ä¸ªæ–°ç‚¹ $p_i$ï¼Œè®©æ¯ä¸ª $k_{i,j}$ è¿å‘ $p_i$ï¼Œå†è®© $p_i$ è¿å‘æ¯ä¸ªåˆ†å‰²å¼€çš„å­åŒºé—´ã€‚è¿™æ ·å°±æˆåŠŸåœ°åªéœ€è¦ $\sum O(k_i\log k_i)$ çš„ç©ºé—´ï¼Œå¾ˆç¨³ã€‚</p>
<p><del>è¯è¯´è¿™è¿˜æ˜¯è‡ªå·±ç¬¬ä¸€æ¬¡çœŸæ­£å»å†™å·®åˆ†çº¦æŸ</del></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v ;</span><br><span class="line">    val(cnt) = val, deg[v] ++ ;</span><br><span class="line">    next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> &amp;rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> rt = l, <span class="keyword">void</span>() ;</span><br><span class="line">    rt = ++ Id ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    build(lc[rt], l, mid) ;</span><br><span class="line">    build(rc[rt], mid + <span class="number">1</span>, r) ;</span><br><span class="line">    add(lc[rt], rt, <span class="number">0</span>), add(rc[rt], rt, <span class="number">0</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> u, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= ul &amp;&amp; r &lt;= ur) <span class="keyword">return</span> add(rt, u, w) ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) update(lc[rt], l, mid, u, ul, ur, w) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid) update(rc[rt], mid + <span class="number">1</span>, r, u, ul, ur, w) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u, v, l, r, k ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; s &gt;&gt; m ;</span><br><span class="line">    Id = n ; build(root, <span class="number">1</span>, n) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= s ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), base[u] = dis[u] = v ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;l, &amp;r, &amp;k) ;</span><br><span class="line">        Id ++, last = l - <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= k ; ++ j)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v) ; add(Id, v, <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">if</span> (last + <span class="number">1</span> &lt; v)</span><br><span class="line">				update(root, <span class="number">1</span>, n, Id, last + <span class="number">1</span>, v - <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">            last = v ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (last &lt; r)</span><br><span class="line">            update(root, <span class="number">1</span>, n, Id, last + <span class="number">1</span>, r, <span class="number">0</span>) ;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= Id ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!dis[i]) dis[i] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">if</span> (!deg[i]) q.push(i) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        u = q.front() ; q.pop() ; vis[u] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))&#123;</span><br><span class="line">            dis[to(k)] = max(dis[to(k)], dis[u] + val(k)) ;</span><br><span class="line">            <span class="keyword">if</span> (base[to(k)] &amp;&amp; dis[to(k)] &gt; base[to(k)])</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NIE"</span>), <span class="number">0</span> ;</span><br><span class="line">            <span class="keyword">if</span> (! -- deg[to(k)]) q.push(to(k)) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= Id ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (!vis[i] || dis[i] &gt; Inf) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NIE"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"TAK"</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d "</span>, dis[i]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-SNOI2017-ç‚¸å¼¹"><a href="#3-SNOI2017-ç‚¸å¼¹" class="headerlink" title="$3$ [SNOI2017]ç‚¸å¼¹"></a>$3$ [SNOI2017]ç‚¸å¼¹</h1><blockquote>
<p>åœ¨ä¸€æ¡ç›´çº¿ä¸Šæœ‰ $n$ ä¸ªç‚¸å¼¹ï¼Œæ¯ä¸ªç‚¸å¼¹çš„åæ ‡æ˜¯ $x_i$ï¼Œçˆ†ç‚¸åŠå¾„æ˜¯ $r_i$ã€‚</p>
<p>å½“ä¸€ä¸ªç‚¸å¼¹çˆ†ç‚¸æ—¶ï¼Œå¦‚æœå¦ä¸€ä¸ªç‚¸å¼¹æ‰€åœ¨ä½ç½® $x_j$ æ»¡è¶³ï¼š $|x_j-x_i| \le r_i$ ï¼Œé‚£ä¹ˆï¼Œè¯¥ç‚¸å¼¹ä¹Ÿä¼šè¢«å¼•çˆ†ã€‚è®¡ç®—å…ˆæŠŠç¬¬ $i$ ä¸ªç‚¸å¼¹å¼•çˆ†ï¼Œå°†å¼•çˆ†å¤šå°‘ä¸ªç‚¸å¼¹ã€‚</p>
<p>ç­”æ¡ˆå¯¹ $10^9+7$ å–æ¨¡ã€‚ä¿è¯ $x_i$ éšç€ $i$ å•å¢ã€‚</p>
</blockquote>
<p>å‘ç°å¯ä»¥å…ˆäºŒåˆ†å‡ºæ¯ä¸ªç‚¹è¦è¿çš„å·¦å³ç«¯ç‚¹ã€‚ç„¶åè€ƒè™‘ç¼©ç‚¹ã€‚ç”±äºæ˜¯ $\rm DAG$ å°±å¯ä»¥ç›´æ¥æ±‚å‡ºæ¯ä¸ªç‚¹èƒ½åˆ°è¾¾çš„ç‚¹çš„ç¼–å·çš„ $\min,\max$ ï¼Œè¿™ä¸œè¥¿å¯ä»¥ä¸€é $\rm topsort$ æ±‚å‡ºæ¥ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4000010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">8000010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1000000007</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr(k) E[k].fr</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> val(k) E[k].val</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">    <span class="keyword">int</span> fr, to ;</span><br><span class="line">&#125;E[M] ;</span><br><span class="line">LL ans ;</span><br><span class="line"><span class="keyword">int</span> tot ;</span><br><span class="line"><span class="keyword">int</span> deg[N] ;</span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> s[N], tp ;</span><br><span class="line"><span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line">LL x[N], r[N] ;</span><br><span class="line"><span class="keyword">int</span> L[N], R[N] ;</span><br><span class="line"><span class="keyword">int</span> SCC, blg[N] ;</span><br><span class="line"><span class="keyword">int</span> n, Id, root ;</span><br><span class="line"><span class="keyword">int</span> head[N], cnt ;</span><br><span class="line"><span class="keyword">int</span> val[N * <span class="number">3</span>][<span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> dfn[N], low[N] ;</span><br><span class="line"><span class="keyword">int</span> lc[N * <span class="number">3</span>], rc[N * <span class="number">3</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v, fr(cnt) = u,</span><br><span class="line">    next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; u &lt;&lt; " " &lt;&lt; v &lt;&lt; endl ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> &amp;rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">        rt = l ;</span><br><span class="line">        val[l][<span class="number">0</span>] = l ;</span><br><span class="line">        val[l][<span class="number">1</span>] = l ;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    rt = ++ Id ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    build(lc[rt], l, mid) ;</span><br><span class="line">    build(rc[rt], mid + <span class="number">1</span>, r) ;</span><br><span class="line">    add(rt, lc[rt]) ; add(rt, rc[rt]) ;</span><br><span class="line">    val[rt][<span class="number">0</span>] = val[lc[rt]][<span class="number">0</span>] ;</span><br><span class="line">    val[rt][<span class="number">1</span>] = val[rc[rt]][<span class="number">1</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul ,<span class="keyword">int</span> ur, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= ul &amp;&amp; r &lt;= ur)</span><br><span class="line">        <span class="keyword">return</span> f == rt ? <span class="keyword">void</span>() : add(f, rt) ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) update(lc[rt], l, mid, ul, ur, f) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid) update(rc[rt], mid + <span class="number">1</span>, r, ul, ur, f) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    s[++ tp] = x, vis[x] = <span class="number">1</span> ;</span><br><span class="line">    dfn[x] = low[x] = ++ tot ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (!dfn[to(k)])</span><br><span class="line">            tarjan(to(k)),</span><br><span class="line">            low[x] = min(low[x], low[to(k)]) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (vis[to(k)])</span><br><span class="line">            low[x] = min(low[x], dfn[to(k)]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (low[x] == dfn[x])&#123;</span><br><span class="line">        <span class="keyword">int</span> now ;</span><br><span class="line">        L[++ SCC] = n + <span class="number">1</span> ;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; x &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">while</span> (tp)&#123;</span><br><span class="line">            now = s[tp --] ;</span><br><span class="line">            L[SCC] = min(L[SCC], val[now][<span class="number">0</span>]) ;</span><br><span class="line">            R[SCC] = max(R[SCC], val[now][<span class="number">1</span>]) ;</span><br><span class="line">            vis[now] = <span class="number">0</span>, blg[now] = SCC ;</span><br><span class="line">            <span class="keyword">if</span> (now == x) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">int</span> lq, rq ; LL xx, oo ;</span><br><span class="line">    Id = n, build(root, <span class="number">1</span>, n) ;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; cnt &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= cnt ; ++ i)</span></span><br><span class="line"><span class="comment">//        cout &lt;&lt; fr(i) &lt;&lt; " " &lt;&lt; to(i) &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;x[i], &amp;r[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        xx = x[i], oo = r[i] ;</span><br><span class="line">        lq = lower_bound(x + <span class="number">1</span>, x + n + <span class="number">1</span>, xx - oo) - x ;</span><br><span class="line">        rq = upper_bound(x + <span class="number">1</span>, x + n + <span class="number">1</span>, xx + oo) - x ;</span><br><span class="line">        rq -- ; <span class="keyword">if</span> (lq &lt;= rq) update(root, <span class="number">1</span>, n, lq, rq, i) ;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; lq &lt;&lt; " " &lt;&lt; rq &lt;&lt; endl ;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    puts("") ;</span></span><br><span class="line"><span class="comment">//    cout &lt;&lt; root &lt;&lt; endl ;</span></span><br><span class="line">    tarjan(root) ;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; cnt &lt;&lt; " " &lt;&lt; SCC &lt;&lt; endl ;</span></span><br><span class="line">    tot = cnt, cnt = <span class="number">0</span> ;</span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; blg[i] &lt;&lt; " " ;</span></span><br><span class="line"><span class="comment">//    puts("") ;</span></span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">0</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (blg[fr(i)] != blg[to(i)])</span><br><span class="line">            add(blg[to(i)], blg[fr(i)]), deg[blg[fr(i)]] ++ ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= SCC ; ++ i) <span class="keyword">if</span> (!deg[i]) q.push(i) ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        oo = q.front() ; q.pop() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[oo] ; k ; k = next(k))&#123;</span><br><span class="line">            L[to(k)] = min(L[to(k)], L[oo]) ;</span><br><span class="line">            R[to(k)] = max(R[to(k)], R[oo]) ;</span><br><span class="line">            <span class="keyword">if</span> (!-- deg[to(k)]) q.push(to(k)) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        (ans += <span class="number">1l</span>l * i * (R[blg[i]] - L[blg[i]] + <span class="number">1</span>) % P) %= P ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; L[blg[i]] &lt;&lt; " " &lt;&lt; R[blg[i]] &lt;&lt; endl ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>å›¾è®º/æ™®é€šå»ºå›¾æŠ€å·§</tag>
        <tag>å›¾è®º/çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°&amp;é¢˜è§£ã€‘çº¿æ®µæ ‘åˆå¹¶çå¹</title>
    <url>/2020/01/23/SegmentTreemerge1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚å°±æ˜¯åˆå¹¶ä¿©çº¿æ®µæ ‘ï¼Ÿé‡å¤çš„ç‚¹ä¸€å—å„¿ç”¨ï¼Œå¦åˆ™ç›´æ¥æ‹‰è¿‡æ¥æŒ‡é’ˆã€‚å¤§å¤šæ•°éƒ½æ˜¯åŠ¨æ€å¼€ç‚¹å†™æ³•ï¼ˆæ¯”è¾ƒä¼˜ç¾ï¼‰ã€‚</p>
<p>ä»¥åˆå¹¶å€¼åŸŸçº¿æ®µæ ‘ä¸ºä¾‹è¯´æ˜ã€‚å…¶å¤æ‚åº¦æ˜¯å‡æ‘Šçš„ï¼Œå³è€ƒè™‘æ¯ä¸€æ¬¡åˆå¹¶æ“ä½œçš„å¤æ‚åº¦å®é™…ä¸Šæ˜¯ä¸¤é¢—çº¿æ®µæ ‘é‡å çš„ç‚¹çš„æ•°é‡ã€‚å› ä¸ºæœ€åä¸€å…±æœ‰ $n\log |V|$ ä¸ªç‚¹ï¼Œæ‰€ä»¥å¤æ‚åº¦æ˜¯ $O(n\log |V|)$ï¼Œå…¶ä¸­ $V$ æ˜¯æ¯ä¸ªè¢«åˆå¹¶å…ƒç´ çš„å€¼åŸŸã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯æœ‰äº›é¢˜åŒæ ·éœ€è¦ç»´æŠ¤åˆå¹¶ä¹‹å‰çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆåˆå¹¶çš„æ—¶å€™å°±éœ€è¦æ–°å»ºèŠ‚ç‚¹å½“æ ¹ã€‚ä½†æ ¹æ®ä¸»å¸­æ ‘é‚£å¥—ç†è®ºï¼Œæœ¬è´¨ä¸Šç©ºé—´å¤æ‚åº¦åªä¼šå¤šä¸ª $\log$ ?ï¼ˆå­˜ç–‘</p>
<a id="more"></a>
<h1 id="1-USACO17JAN-Promotion-Counting"><a href="#1-USACO17JAN-Promotion-Counting" class="headerlink" title="$1$ [USACO17JAN]Promotion Counting"></a>$1$ [USACO17JAN]Promotion Counting</h1><blockquote>
<p>ç»™å®šä¸€æ£µæ ‘ï¼Œå¯¹äºæ‰€æœ‰çš„ $i\in[1,n]âˆ©\mathbb{Z}$ ï¼Œæ±‚ä»¥ $i$ ä¸ºæ ¹çš„å­æ ‘å†…æœ‰å¤šå°‘æƒå€¼ $&gt;i$ çš„ç‚¹ã€‚ </p>
</blockquote>
<p>å¤§æ¦‚æ˜¯æ¯”è¾ƒè£¸çš„çº¿æ®µæ ‘åˆå¹¶äº†ï¼Ÿ</p>
<p>è€ƒè™‘å¦‚æœæŒ‰ç…§æ­£å¸¸åœ°çº¿æ®µæ ‘åˆå¹¶æ–¹å¼ï¼Œä»åº•å‘ä¸Šåˆå¹¶ï¼Œé‚£ä¹ˆç¦»æ•£åŒ–åå¯¹äºæ¯ä¸ªç‚¹åªéœ€è¦æŸ¥è¯¢çº¿æ®µæ ‘å†… $base_i\sim n$ çš„æ•°å­—ä¸ªæ•°å’Œã€‚äºæ˜¯å°±å®Œäº†ã€‚</p>
<p>æœ‰ä¸¤ä¸ªç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>1ã€çº¿æ®µæ ‘åˆå¹¶ä¸åŒäºæ™®é€šçš„å€¼åŸŸçº¿æ®µæ ‘å»ºç«‹ï¼Œæ¯æ¬¡ <code>update</code> å¯èƒ½ä¼šå­˜åœ¨èµ°é‡å¤èŠ‚ç‚¹çš„æƒ…å†µï¼ˆå¦åˆ™å¤æ‚åº¦å°±ä¸å¯¹äº†ï¼‰ã€‚æ‰€ä»¥éœ€è¦ç‰¹åˆ¤ <code>if (!Rt) Rt = ++ Id ;</code> ã€‚</li>
<li>2ã€æœ¬é¢˜ç”±äºä¿è¯äº† $base_i$ äº’å¼‚ï¼Œæ‰€ä»¥ç¦»æ•£åŒ–å¯ä»¥ç”¨ä¸€ç§æ¯”è¾ƒæœ‰è¶£çš„æ–¹å¼è¿›è¡Œï¼š</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> base[a] &lt; base[b] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), t[i] = i ;</span><br><span class="line">sort(t + <span class="number">1</span>, t + n + <span class="number">1</span>, comp), base[t[<span class="number">1</span>]] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;f), add(f, i), base[t[i]] = i ;</span><br></pre></td></tr></table></figure>
<p>å…¶å®ä¹Ÿæ˜¯å¾ˆç®€å•çš„å§ï¼Ÿç±»ä¼¼çš„ $trick$ ä»¥å‰ç”¨è¿‡å¥½å¤šæ¬¡äº†ï¼Ÿ</p>
<p>ç„¶åä»¥ä¸‹æ˜¯æ€»ä»£ç ã€‚å¤§æ¦‚å°±èƒŒä¸€èƒŒ <code>merge</code> å°±å¥½äº†ï¼ˆ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next ;</span><br><span class="line">&#125;E[N] ; <span class="keyword">int</span> head[N], cnt ;</span><br><span class="line"><span class="keyword">int</span> lc[N * <span class="number">15</span>], rc[N * <span class="number">15</span>] ;</span><br><span class="line"><span class="keyword">int</span> rt[N * <span class="number">15</span>], val[N * <span class="number">15</span>] ;</span><br><span class="line"><span class="keyword">int</span> n, m, ans[N], base[N], t[N], Id ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> base[a] &lt; base[b] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v,</span><br><span class="line">    next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> &amp;Rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!Rt) Rt = ++ Id ; val[Rt] ++ ;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> ; <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (v &lt;= mid) update(lc[Rt], l, mid, v) ;</span><br><span class="line">    <span class="keyword">else</span> update(rc[Rt], mid + <span class="number">1</span>, r, v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now = ++ Id ;</span><br><span class="line">    <span class="keyword">if</span> (!(<span class="number">1l</span>l * x * y)) <span class="keyword">return</span> x + y ;</span><br><span class="line">    val[now] = val[x] + val[y] ;</span><br><span class="line">    lc[now] = merge(lc[x], lc[y]),</span><br><span class="line">    rc[now] = merge(rc[x], rc[y]) ;</span><br><span class="line">    <span class="keyword">return</span> now ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= ql &amp;&amp; r &lt;= qr) <span class="keyword">return</span> val[root] ;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= mid) res += query(lc[root], l, mid, ql, qr) ;</span><br><span class="line">    <span class="keyword">if</span> (qr &gt; mid) res += query(rc[root], mid + <span class="number">1</span>, r, ql, qr) ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))</span><br><span class="line">        dfs(to(k)), rt[u] = merge(rt[u], rt[to(k)]) ;</span><br><span class="line">    ans[u] = query(rt[u], <span class="number">1</span>, n, base[u] + <span class="number">1</span>, n), update(rt[u], <span class="number">1</span>, n, base[u]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; <span class="keyword">int</span> f ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), t[i] = i ;</span><br><span class="line">    sort(t + <span class="number">1</span>, t + n + <span class="number">1</span>, comp), base[t[<span class="number">1</span>]] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;f), add(f, i), base[t[i]] = i ;</span><br><span class="line">    dfs(<span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-POI2011-ROT-Tree-Rotations"><a href="#2-POI2011-ROT-Tree-Rotations" class="headerlink" title="$2$ [POI2011]ROT-Tree Rotations"></a>$2$ [POI2011]ROT-Tree Rotations</h1><blockquote>
<p>ç»™å‡ºä¸€æ£µ $n(1â‰¤nâ‰¤200000)$ ä¸ªå¶å­çš„äºŒå‰æ ‘ï¼Œå¯ä»¥äº¤æ¢æ¯ä¸ªç‚¹çš„å·¦å³å­æ ‘ï¼Œè¦æ±‚å‰åºéå†å¶å­çš„é€†åºå¯¹æœ€å°‘ã€‚</p>
</blockquote>
<p>å¾ˆå¦™çš„ä¸€é“çº¿æ®µæ ‘åˆå¹¶é¢˜ã€‚</p>
<p>é¦–å…ˆï¼Œè€ƒè™‘ç”±äºåªèƒ½äº¤æ¢å·¦å³å­æ ‘ï¼Œæ‰€ä»¥å¯¹äºä¸€ä¸ªç‚¹ï¼Œåä»£çš„å­æ ‘æ€ä¹ˆå˜å¯¹å…¶ç­”æ¡ˆæ²¡æœ‰å½±å“ã€‚å‘ç°ç”¨çº¿æ®µæ ‘åˆå¹¶æ¥ç»´æŠ¤ç‰¹åˆ«åˆé€‚ï¼šå¯¹äºæ¯ä¸ªç‚¹æ˜¯å¦äº¤æ¢å·¦å³å­æ ‘ï¼Œåˆ†åˆ«ç®—å‡ºæ–°å¢çš„é€†åºå¯¹ä¸ªæ•°ç„¶åå– $\min$ï¼Œè¯¥è¿‡ç¨‹å¯ä»¥åœ¨ <code>merge</code> ä¸­ç›´æ¥è¿›è¡Œâ€”â€”ç»´æŠ¤å€¼åŸŸçš„ $\rm exist_sum$ ä¹‹åï¼Œæ¯æ¬¡åªéœ€è¦ç”¨ä¹˜æ³•åŸç†æ±‚ä¸€ä¸‹å³å¯ã€‚</p>
<p>ç„¶åå°±æ˜¯è¿™é¢˜è¯»å…¥å¾ˆè¯¡â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200011</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">400011</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NN = <span class="number">6000011</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, cnt ;</span><br><span class="line"><span class="keyword">int</span> lc[NN], rc[NN], rt[NN] ;</span><br><span class="line">LL ans, val[NN], ans1, ans2 ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> ch_top = <span class="number">5e7</span> + <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">char</span> ch[ch_top], *now_r = ch - <span class="number">1</span>, *now_w = ch - <span class="number">1</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (*++now_r &lt; <span class="number">48</span>) ;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x = *now_r - <span class="number">48</span> ;</span><br><span class="line">    <span class="keyword">while</span> (*++now_r &gt;= <span class="number">48</span>) x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + *now_r - <span class="number">48</span> ;</span><br><span class="line">    <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">write</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> st[<span class="number">20</span>] ; <span class="keyword">static</span> <span class="keyword">int</span> top ;</span><br><span class="line">    <span class="keyword">while</span> (st[++ top] = <span class="number">48</span> + x % <span class="number">10</span>, x /= <span class="number">10</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (*++ now_w = st[top], -- top) ; *++ now_w = <span class="string">' '</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> &amp;Rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!Rt)</span><br><span class="line">        Rt = ++ cnt ;</span><br><span class="line">    val[Rt] ++ ;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (v &lt;= mid) update(lc[Rt], l, mid, v) ;</span><br><span class="line">    <span class="keyword">else</span> update(rc[Rt], mid + <span class="number">1</span>, r, v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;x, <span class="keyword">const</span> <span class="keyword">int</span> &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y)</span><br><span class="line">        <span class="keyword">return</span> x + y ;</span><br><span class="line">    val[x] += val[y] ;</span><br><span class="line">    ans1 += val[lc[x]] * val[rc[y]] ;</span><br><span class="line">    ans2 += val[rc[x]] * val[lc[y]] ;</span><br><span class="line">    lc[x] = merge(lc[x], lc[y]) ;</span><br><span class="line">    rc[x] = merge(rc[x], rc[y]) ;</span><br><span class="line">    <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y, ls, rs ;</span><br><span class="line">    y = read() ;</span><br><span class="line">    <span class="keyword">if</span> (!y)&#123;</span><br><span class="line">        ls = rs = <span class="number">0</span> ;</span><br><span class="line">        dfs(ls), dfs(rs) ; ans1 = ans2 = <span class="number">0</span> ;</span><br><span class="line">        x = merge(ls, rs) ; ans += min(ans1, ans2) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> update(x, <span class="number">1</span>, n, y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fread(ch, <span class="number">1</span>, ch_top, <span class="built_in">stdin</span>) ;</span><br><span class="line">    n = read() ; <span class="keyword">int</span> u = <span class="number">0</span> ; dfs(u) ; write(ans) ;</span><br><span class="line">    fwrite(ch, <span class="number">1</span>, now_w - ch, <span class="built_in">stdout</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-Vaniæœ‰çº¦ä¼š-é›¨å¤©çš„å°¾å·´"><a href="#3-Vaniæœ‰çº¦ä¼š-é›¨å¤©çš„å°¾å·´" class="headerlink" title="$3$ [Vaniæœ‰çº¦ä¼š]é›¨å¤©çš„å°¾å·´"></a>$3$ [Vaniæœ‰çº¦ä¼š]é›¨å¤©çš„å°¾å·´</h1><blockquote>
<p>ç»™å‡ºä¸€æ£µ $n$ ä¸ªç»“ç‚¹çš„æ ‘ã€‚å…± $m$ æ¬¡æ“ä½œï¼Œæ¯æ¬¡ç»™å‡ºæ ‘ä¸Šçš„ä¸€æ¡è·¯å¾„ï¼Œç»™è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹æ·»åŠ ä¸€ä¸ªæƒå€¼ä¸º $w$ çš„å…ƒç´ ã€‚æœ€åè¾“å‡ºæ¯ä¸ªç‚¹å‡ºç°æ¬¡æ•°æœ€å¤šçš„å…ƒç´ çš„æƒå€¼ã€‚</p>
</blockquote>
<p>è€ƒè™‘æš´åŠ›å»å‰–ï¼Œå‘ç°è¿™ä¹ˆåšæ˜¯ $\frac{n^2\log^2 n}{\omega}$çš„ï¼Œå³æš´åŠ›åˆå¹¶ bitset.</p>
<p>ä½†æ˜¯å‘ç°å¯ä»¥ç¦»çº¿ï¼Œäºæ˜¯è€ƒè™‘ç›´æ¥ç”¨å‰–å»ç»´æŠ¤æ ‘ä¸Šå·®åˆ†ã€‚é‚£ä¹ˆè€ƒè™‘ï¼Œå¯¹äºæœ€ç»ˆçš„ $m$ ç»„è¯¢é—®ï¼Œå¯ä»¥å¤„ç†ä¸º $n\log n$ æ®µ $dfn$ ä¸Šçš„åºåˆ—å·®åˆ†ã€‚</p>
<p>äºæ˜¯å¯¹è¿™äº›å·®åˆ†å†ç”¨æƒå€¼çº¿æ®µæ ‘ä»å¤´å¼€å§‹æ‰«ä¸€éå°±å®Œäº†ã€‚æœ€ç»ˆå¤æ‚åº¦ $O(n\log n)\times O(\log n)=O(n\log^2n)$ ã€‚</p>
<p>ä½†å…¶å®å‘ç°ï¼Œæ ‘ä¸Šå·®åˆ†ç„¶åæ‹†åŒºé—´è¿™ä¸ªè¿‡ç¨‹å®Œå…¨å¯ä»¥ç”¨dfs+çº¿æ®µæ ‘åˆå¹¶æ¥æ›¿ä»£ï¼Œäºæ˜¯å¤æ‚åº¦é™ä¸º $n\log n$ ã€‚</p>
<p>â€¦ä½†å…¶å®ç¬¬äºŒä¸ªåšæ³•å…¶ä¸­æ‹†è¯¢é—®çš„é‚£ä¸ª $\log$ è·Ÿæœ¬è·‘ä¸æ»¡ï¼Œå†åŠ ä¸Šçº¿æ®µæ ‘åˆå¹¶çš„å¤æ‚åº¦ï¼Œå‡æ‘Šå‡ºæ¥æ˜¯åœ¨æ˜¯æœ‰ç‚¹ $gg$ï¼Œäºæ˜¯ä¼¼ä¹é“¾å‰–è¸©çˆ†äº†çº¿æ®µæ ‘åˆå¹¶çš„äºšå­QAQsã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">    dep[u] = dep[f] + <span class="number">1</span> ;</span><br><span class="line">    fa[u] = f, sz[u] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs(to(k), u), sz[u] += sz[to(k)] ;</span><br><span class="line">        <span class="keyword">if</span> (!son[u] || sz[son[u]] &lt; sz[to(k)]) son[u] = to(k) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f, <span class="keyword">int</span> tp)</span></span>&#123;</span><br><span class="line">    top[u] = tp ;</span><br><span class="line">    <span class="keyword">if</span> (son[u]) dfs(son[u], u, tp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))</span><br><span class="line">        <span class="keyword">if</span> (to(k) != son[u] &amp;&amp; to(k) != f) dfs(to(k), u, to(k)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (top[u] != top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[top[u]] &lt; dep[top[v]]) swap(u, v) ;</span><br><span class="line">        u = fa[top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[u] &gt; dep[v] ? v : u ;</span><br><span class="line">&#125;</span><br><span class="line">il <span class="keyword">void</span> _up(<span class="keyword">const</span> <span class="keyword">int</span> &amp;u)&#123;</span><br><span class="line">    <span class="keyword">if</span> (s[lc[u]] &gt; s[rc[u]])</span><br><span class="line">        s[u] = s[lc[u]], val[u] = val[lc[u]] ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (s[lc[u]] &lt; s[rc[u]])</span><br><span class="line">        s[u] = s[rc[u]], val[u] = val[rc[u]] ;</span><br><span class="line">    <span class="keyword">else</span> s[u] = s[lc[u]], val[u] = min(val[lc[u]], val[rc[u]]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> &amp;u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!u) u = ++ cnt ;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        s[u] += v ;</span><br><span class="line">        val[u] = s[u] ? r : <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid) update(lc[u], l, mid, p, v) ;</span><br><span class="line">    <span class="keyword">else</span> update(rc[u], mid + <span class="number">1</span>, r, p, v) ; _up(u) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y ;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> s[x] += s[y], val[x] = l, x ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    lc[x] = merge(lc[x], lc[y], l, mid) ;</span><br><span class="line">    rc[x] = merge(rc[x], rc[y], mid + <span class="number">1</span>, r) ;</span><br><span class="line">    _up(x) ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_do</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))</span><br><span class="line">        <span class="keyword">if</span> (to(k) != f)</span><br><span class="line">            do_do(to(k), x),</span><br><span class="line">            rt[x] = merge(rt[x], rt[to(k)], <span class="number">1</span>, S) ;</span><br><span class="line">    ans[x] = val[rt[x]] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">int</span> u, v, z, f ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), add(u, v) ;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>) ; dfs(<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>) ; cnt = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        qr(u), qr(v),</span><br><span class="line">        qr(z), f = lca(u, v) ;</span><br><span class="line">        update(rt[u], <span class="number">1</span>, S, z, <span class="number">1</span>) ;</span><br><span class="line">        update(rt[v], <span class="number">1</span>, S, z, <span class="number">1</span>) ;</span><br><span class="line">        update(rt[f], <span class="number">1</span>, S, z, <span class="number">-1</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (fa[f]) update(rt[fa[f]], <span class="number">1</span>, S, z, <span class="number">-1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    do_do(<span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="4-HNOI2012-æ°¸æ— ä¹¡"><a href="#4-HNOI2012-æ°¸æ— ä¹¡" class="headerlink" title="$4 $ [HNOI2012] æ°¸æ— ä¹¡"></a>$4 $ [HNOI2012] æ°¸æ— ä¹¡</h1><blockquote>
<p>ä½ éœ€è¦ç»´æŠ¤è‹¥å¹²è¿é€šå¿«ï¼Œæœ‰ä¸¤ä¸ªæ“ä½œï¼š</p>
<ul>
<li>åˆå¹¶ $x,y$ æ‰€åœ¨çš„è¿é€šå—ã€‚</li>
<li>è¯¢é—® $x$ æ‰€åœ¨è¿é€šå—ä¸­æƒå€¼ä»å°åˆ°å¤§æ’ç¬¬ $k$ çš„ç»“ç‚¹ç¼–å·ã€‚</li>
</ul>
<p>$1\leq n,q\leq 3\cdot 10^5$</p>
</blockquote>
<p>faâ™‚ç°çº¿æ®µæ ‘åˆå¹¶ä¹‹åç›´æ¥åœ¨çº¿æ®µæ ‘ä¸ŠäºŒåˆ†å°±åšå®Œäº†ï¼Œ$n\log n$ ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, I + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">if</span> (I[<span class="number">1</span>] == <span class="string">'B'</span>)&#123;</span><br><span class="line">        u = qr(), v = qr() ;</span><br><span class="line">        <span class="keyword">int</span> f1 = find(u), f2 = find(v) ;</span><br><span class="line">        <span class="keyword">if</span> (f1 != f2) fa[f2] = f1, rt[f1] = merge(rt[f1], rt[f2]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        u = qr(), k = qr(), u = find(u) ;</span><br><span class="line">        <span class="keyword">if</span> (s[rt[u]] &lt; k) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, query(rt[u], <span class="number">1</span>, n, k)) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>çº¿æ®µæ ‘åˆå¹¶</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/çº¿æ®µæ ‘åˆå¹¶</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç”Ÿæ´»ç¢ç‰‡2ã€‘Â· åŸæ¥æˆ‘è¿˜ä»€ä¹ˆéƒ½ä¸æ‡‚</title>
    <url>/2020/01/23/Life2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æœ€è¿‘åœ¨çœ‹ã€Œçˆ±æƒ…å…¬å¯“5ã€ï¼Œæ„Ÿè§¦å¾ˆå¤šã€‚</p>
<a id="more"></a>
<p>è¿˜è®°å¾—è‡ªå·±æ˜¯å°å­¦4å¹´çº§ç¬¬ä¸€æ¬¡å¬åŒå­¦è¯´è¿‡è¿™ä¸ªå‰§ï¼Œå½“æ—¶è¿˜è§‰å¾—åå­—å¾ˆä¿—æ°”ã€‚ä¹‹åå°±å¼€å§‹æ…¢æ…¢åœ°è¿½å•Šè¿½ï¼Œä»å½“æ—¶æ­£åœ¨çƒ­æ’­çš„ç¬¬ä¸‰å­£è¿½åˆ°ç¬¬äºŒå­£ã€ç¬¬ä¸€å­£ï¼Œè€Œååˆç­‰åˆ°ç¬¬å››å­£ï¼Œç­‰åˆ°ç°åœ¨çš„ç¬¬äº”å­£ã€‚</p>
<p>ç„¶è€Œï¼Œæ¯æ¬¡çœ‹ã€Œçˆ±æƒ…å…¬å¯“ã€ä¹‹å‰ï¼Œéƒ½æ˜¯å¾ˆçº ç»“å¾ˆçº ç»“çš„ã€‚çº ç»“åœ¨ï¼Œå‰§é‡Œæç»˜çš„é‚£ä¸ªä¸–ç•Œé‚£ä¹ˆç¾å¥½ç®€å•ï¼Œæ¯æ¬¡çœ‹å®Œæˆ‘éƒ½ä¼šæ„Ÿåˆ°æ— å¥ˆå¥½å‡ å¤©ã€éš¾ä»¥é‡Šæ€€å¥½å‡ å¤©â€”â€”è¿™æ ·çš„ç”Ÿæ´»ææ€•ä¸å±äºæˆ‘å§ã€‚</p>
<p>å¦‚æœè¯´æˆ‘å¿ƒä¸­æœ‰ä¸¤ä¸ªåœ°æ–¹æœ€è„†å¼±ï¼Œé‚£å°±æ˜¯å¯¹å¾€äº‹çš„è¿½æ€è®©æˆ‘æ„Ÿåˆ°æ— å¥ˆä¸æ„ŸåŠ¨ã€å¯¹å¯æœ›è€Œä¸å¯å³çš„ç”Ÿæ´»çš„æœŸç›¼è®©æˆ‘æ„Ÿåˆ°æ¸ºå°ä¸å¸Œæœ›ã€‚</p>
<p>æ‰€ä»¥ï¼Œæœ¬è´¨ä¸Šï¼Œã€Œçˆ±æƒ…å…¬å¯“5ã€è¿™éƒ¨å‰§ï¼Œå°±æ˜¯ä¸€ä¸ªã€Œç§»æƒ…ã€çš„é€”å¾„ã€‚å®ƒæ—¢æ‰¿è½½äº†æˆ‘å¯¹ä»¥å‰è¿½å‰§æ—¶ç®€å•ç”Ÿæ´»çš„è¿½æ€ä¸æ€€å¿µï¼Œåˆæ‰¿è½½äº†ã€Œæœ€å¥½çš„æœ‹å‹å°±åœ¨èº«è¾¹ã€æœ€çˆ±çš„äººå°±åœ¨å¯¹é¢ã€çš„æ¸´æœ›ä¸æ— å¥ˆï¼Œæ‰€ä»¥æˆ‘æ‰ä¼šå¾ˆéš¾ä»¥é‡Šæ€€ã€‚</p>
<p>ç„¶è€Œè¿™å…¶å®åªæ˜¯ä¸ªå°é—®é¢˜ï¼Œä½†ä»¥å‰æˆ‘ä¼¼ä¹ä»æ¥æ²¡å»æƒ³è¿‡ä¸ºä»€ä¹ˆæˆ‘ä¼šé‚£ä¹ˆå½·å¾¨æ— å¥ˆã€‚</p>
<p>æˆ–è®¸æ˜¯ä»åœè¯¾å¼€å§‹çš„ï¼Œæˆ–è®¸æ˜¯ä»è”èµ›å¼€å§‹çš„ï¼Œæˆ–è®¸ä¼šæ›´æ—©äº›â€”â€”æˆ‘ä¼šæ—¶å¸¸æ„Ÿåˆ°ï¼šâ€œå•Šï¼ŒåŸæ¥æˆ‘è¿˜ä»€ä¹ˆéƒ½ä¸æ‡‚ï¼ŒåŸæ¥è¿™ä¸ªä¸–ç•Œå¯¹æˆ‘æ¥è¯´è¿˜æ˜¯é™Œç”Ÿçš„â€ã€‚</p>
<p>å•Šï¼ŒåŸæ¥æˆ‘è¿˜ä»€ä¹ˆéƒ½ä¸æ‡‚ã€‚</p>
<h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p>åˆä¸­æ—¶ï¼Œè·Ÿæœ€è¦å¥½çš„ä¼™ä¼´æœ‰ä¸€å¤©çªç„¶èŠåˆ°äº†å¿ƒç†ã€‚å¥¹è¯´ï¼šâ€œæˆ–è®¸å¤§å®¶åº”è¯¥éƒ½å»çœ‹çœ‹é‚£äº›å¿ƒç†å­¦çš„ä¹¦ï¼Œé‡Œé¢çš„ä¸œè¥¿æˆ–è®¸æŒºå€¼å¾—å­¦ä¹ çš„â€ã€‚</p>
<p>æˆ‘è®°å¾—å½“æ—¶æˆ‘ååˆ†ä¸å±‘åœ°è¯´ï¼šâ€œé‚£ä¸Šé¢é‚£äº›ä¸œè¥¿ï¼Œå¯¹è‡ªå·±è€Œè¨€éƒ½æ²¡å•¥ä»·å€¼å§ï¼Ÿå­¦äº†ä¹‹åå»åˆ«äººæˆ–è®¸æŒºæœ‰ç”¨ï¼Œè¿™ç‚¹å¿ƒç†æš—ç¤ºå¯¹è‡ªå·±æ ¹æœ¬ä¸èµ·ä½œç”¨ã€‚â€</p>
<p>å¥¹æœ¬å°±æ˜¯ä¸ªæ¯”è¾ƒæ–‡é™æ²‰é»˜çš„äººï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰ç»§ç»­è·Ÿæˆ‘äº‰è®ºã€‚</p>
<p>è®°å¾—è‡ªå·±å°æ—¶å€™å¾ˆçˆ±çœ‹å¿ƒç†å­¦çš„ä¹¦ã€‚å¯èƒ½ç¼˜äºåˆšæ¥è§¦å¤§è‡ªç„¶ï¼Œå¯¹ä»€ä¹ˆäº‹æƒ…éƒ½æœ‰ä¸€ç§æ–°é²œçš„æ§åˆ¶æ¬²ï¼Œè‡ªç„¶ä»€ä¹ˆã€Œå¾®è¡¨æƒ…çª¥æ¢ä¸€ä¸ªäººçš„å†…å¿ƒã€ã€ã€Œæµ…è°ˆå¿ƒç†å­¦ã€ä¹‹ç±»çš„ç§‘æ™®ä¹¦ç±æ¯”è¾ƒå—æˆ‘å–œçˆ±ã€‚</p>
<p>ä½†ç›´åˆ°æœ€è¿‘æˆ‘æ‰å‘ç°ï¼ŒåŸæ¥è¿™æ˜¯ä¸€é—¨éœ€è¦ç»éªŒå’Œä¸°å¯Œå­¦è¯†çš„å­¦ç§‘ï¼Œå¹¶ä¸æ˜¯è‰è‰çš„é˜…è¯»å°±èƒ½æ‹¯æ•‘æ¥çš„ã€‚</p>
<p>æ¥ç€æˆ‘å‘ç°ï¼ŒåŸæ¥ä¼¼ä¹æ¯ä¸€è¡Œè¦å¹²å¥½ï¼Œéƒ½ä¸å®¹æ˜“ã€‚è‡ªå·±ä»¥å‰å»ºç«‹èµ·çš„è«åå…¶å¦™çš„è‡ªè´Ÿï¼Œä»é‚£å¼€å§‹ä¾¿æ¸æ¸å¼€å§‹çƒŸæ¶ˆäº‘æ•£äº†ã€‚</p>
<p>åŸæ¥æˆ‘è¿˜ä»€ä¹ˆéƒ½ä¸æ‡‚ã€‚</p>
<p>è®°å¾—æ›¾ç»åœ¨åˆä¸­ï¼Œå¯„å®¿åˆ¶ã€‚æœ€å¥½çš„ä¸¤ä¸ªæœ‹å‹æ¯å¤©éƒ½è¦å»ç»™çˆ¶æ¯æ‰“ä¸€æ¬¡ç”µè¯ã€‚æˆ‘å¾ˆä¸ç†è§£ï¼Œå› ä¸ºè‡ªå·±ä¸¤å‘¨ä¹Ÿæœªå¿…ä¼šæ‰“ä¸€æ¬¡ç”µè¯ã€‚äºæ˜¯å°±å¸¦ç€æœ‰ç‚¹è½»è”‘çš„å£å»é—®ä»–ä»¬ï¼šâ€œæ¯å¤©æ‰“ä¸€æ¬¡ç”µè¯æ˜¯ä¸æ˜¯æœ‰ç‚¹å¤ªä¸ç‹¬ç«‹äº†ï¼Ÿè€å“¥ä»¬ï¼Œæˆ‘ä»¬éƒ½åˆä¸­äº†è¯¶ï¼Œä¹Ÿä¸ç”¨åƒå°å­¦ä¸€æ ·æˆå¤©è·Ÿå®¶é•¿æ²Ÿé€šå§ã€‚è¦ç‹¬ç«‹ï¼Œç‹¬ç«‹ï¼â€</p>
<p>ä¹‹åï¼Œä»–ä»¬ä¹Ÿæ²¡è¯´ä»€ä¹ˆï¼Œåªæ˜¯ç®€å•åœ°æªå¡äº†è¿‡å»ã€‚å½“æ—¶è‡ªå·±è¿˜è§‰å¾—æˆ‘å¾ˆå‰å®³ï¼Œæœ‰ç‚¹ç§ä¸èµ·è¿™ç§æ¯å¤©éƒ½ä¾èµ–çˆ¶æ¯çš„äººã€‚</p>
<p>ç›´åˆ°é«˜ä¸€çš„æš‘å‡ï¼Œå¤–å‡ºåŸ¹è®­æ—¶ï¼Œå’Œåˆ«çš„äººåˆå‘ç”Ÿäº†ç±»ä¼¼çš„äº‰åµâ€”â€”æˆ‘æ‰å‘ç°ï¼Œå¯èƒ½æˆ‘éšæ‰‹æ¯åçš„ã€ä¾®è¾±çš„ï¼Œæ˜¯åˆ«äººçš„äººç”Ÿä¿¡æ¡ã€‚ä¸åŒçš„äººæœ‰ä¸åŒçš„äººç”Ÿä¿¡æ¡ï¼Œå°±å¦‚åŒä¸åŒçš„å¤œæŒ‚ç€ä¸åŒçš„æ˜Ÿã€‚æˆ‘è¯´é‚£å¤œæ²¡æœ‰æ˜Ÿï¼Œåªæ˜¯å› ä¸ºæˆ‘è§‰å¾—æ¯å¤©çš„æ˜Ÿéƒ½ä¸åŒè€Œæ²¡å»çœ‹ï¼Œç»éªŒä¹‹è°ˆç½¢äº†ã€‚</p>
<p>åŸæ¥æˆ‘è¿˜ä»€ä¹ˆéƒ½ä¸æ‡‚ã€‚</p>
<h2 id="2"><a href="#2" class="headerlink" title="$2$"></a>$2$</h2><p>çœ‹å®Œäº†ã€Šçˆ±æƒ…å…¬å¯“5ã€‹ã€‚å…¶å®æœ¬æ¥æˆ‘ä¸€å‘¨å‰å°±çœ‹å®Œäº†å‰ $34$ é›†ï¼Œä¸€ç›´èˆä¸å¾—çœ‹æœ€åä¸¤é›†ï¼Œéª—è‡ªå·±è¯´ã€æ²¡äº‹ï¼Œä¸çœ‹å®Œçš„è¯ï¼Œå°±æ°¸è¿œä¹Ÿä¸ä¼šç»“æŸï¼Œå¯¹å§ï¼Ÿã€ã€‚</p>
<p>è¿™ç§å®¶åº­å¼å–œå‰§æ°¸è¿œæ˜¯æˆ‘çš„ä¼¤ç—›ã€‚æˆ‘æœ‰ç€å¥å…¨ç¾æ»¡çš„å®¶åº­ï¼Œä¸é”™çš„åŒå­¦æœ‹å‹ï¼Œä¼˜ç§€çš„è€å¸ˆã€‚ä½†æˆ‘å°±æ˜¯ä¸æ»¡è¶³ã€‚ä¼¼ä¹æˆ‘çš„å¿«ä¹æ ¹æœ¬æ— æ³•å¯„æ‰˜åœ¨è¿™ç§äººä¸äººä¹‹é—´çš„æƒ…æ„Ÿå…±é¸£ä¸Šã€‚ä½†æ˜¯æ¯å½“çœ‹å®Œä¸€å­£ã€Šçˆ±æƒ…å…¬å¯“ã€‹ä¹Ÿå¥½ã€ã€Šç”Ÿæ´»å¤§çˆ†ç‚¸ã€‹ä¹Ÿç½¢ã€ç­‰å¾…ä¸‹ä¸€å­£çš„æ—¶å€™ï¼Œæˆ‘éƒ½ä¼šæ—¶ä¸æ—¶åœ°åœ¨æƒ³ï¼šä¸ºä»€ä¹ˆæˆ‘å°±ä¸èƒ½è¿›å…¥é‚£ä¸ªä¸–ç•Œå‘¢ï¼Ÿå‘¨å›´çš„ç”Ÿæ´»åº¸ä¿—ä¸”é¢“åºŸï¼Œé«˜ä¸­ä¹‹åå”¯ä¸€çš„å¯„æ‰˜å¯èƒ½å°±æ˜¯OIï¼Œä½†æ˜¯OIè¿™æ¡è·¯ï¼Œæˆ‘å·²ç»ç­‰å¤Ÿäº†å•Šã€‚ä¸€å¤©åˆä¸€å¤©å‘Šè¯‰è‡ªå·±ç­‰å¾…åªæ˜¯å› ä¸ºè‡ªå·±å¤ªå¼±ï¼Œä½†æ˜¯åŸè°…æˆ‘ï¼Œæˆ‘ä¸çŸ¥é“è¯¥æ€ä¹ˆæ”¹å˜è¿™ä¸ªç°çŠ¶å•Šï¼Ÿ</p>
<p>äºæ˜¯è‡ªå·±å°±ä¸€ç›´æƒ³è¦å»é€ƒé¿ï¼Œé€ƒé¿è¿™ä¸€åˆ‡ã€‚</p>
<p>ä½†çœ‹ã€Šçˆ±æƒ…å…¬å¯“ã€‹çš„ç‰‡èŠ±æ—¶ï¼Œæˆ‘å‘ç°ï¼Œæ’•å¼€é‚£ç’€ç’¨çš„å‰§æƒ…ï¼ŒåŸæ¥æ¯ä¸ªæ¼”å‘˜éƒ½æ˜¯ååˆ†åŠªåŠ›çš„åœ¨æ¼”æˆï¼Œä¸€æ¡ä¸è¡Œæ¢ä¸‹ä¸€æ¡ï¼Œæ¯”èµ·æˆ‘è¿™ä¸ªæ•´æ—¥åªä¼šç©ºæƒ³çš„æ­»è‚¥å®…é«˜åˆ°ä¸çŸ¥é“ä»€ä¹ˆåœ°æ–¹å»äº†ã€‚æ‰€ä»¥æˆ‘å°±åœ¨æƒ³å•Šï¼Œä»–ä»¬å…¶å®å°±æ˜¯åœ¨æ— æ¯”åœ°çƒ­çˆ±ç€è‡ªå·±çš„ç”Ÿæ´»å§ï¼Ÿè€Œæˆ‘å‘¢ï¼Ÿä¼¼ä¹ä¸Šäº†é«˜ä¸­ä¹‹åï¼Œå°±å†ä¹Ÿæ²¡æœ‰çƒ­çˆ±è¿‡ç”Ÿæ´»ã€‚</p>
<p>æˆ‘åˆ°åº•æ€ä¹ˆäº†å‘¢ï¼Ÿ</p>
<p>ä½†å…¶å®ï¼Œæˆ‘å¯èƒ½è¿˜æ²¡æœ‰å¿…è¦å»çº ç»“è¿™äº›ä¸œè¥¿ã€‚ã€Šçˆ±æƒ…å…¬å¯“ã€‹åœ¨è½å¹•ä¹‹å‰ï¼Œæ­ç¤ºäº†ä¸»æ—¨ï¼Œå°±æ˜¯ã€é©å‘½ä¹è§‚ä¸»ä¹‰ç²¾ç¥ã€ã€‚å®£ä¼ ç‰‡çš„æ­Œè¯é‡Œä¹Ÿè¯´ã€_äººç”Ÿä¸‹ä¸€å…³ / ç­‰ç€æˆ‘ä»¬å»å¼€å¯ / æˆé•¿éœ€è¦å‘Šåˆ«è¿‡å»è‡ªå·±_ã€ã€‚æ‰€ä»¥ï¼Œè¿™å¯èƒ½å°±æ˜¯æˆ‘éœ€è¦çš„å§ã€‚</p>
<p>çƒ­çˆ±è‡ªå·±çš„ç”Ÿæ´»ï¼Œå°±æ˜¯è¿™æ ·ã€‚æ— è®ºè‡ªå·±ç©ºæƒ³å‡ºæ¥çš„ä¸–ç•Œæœ‰å¤šç¾ï¼Œä¹¦é‡Œã€å‰§é‡Œå‹¾å‹’çš„ä¸–ç•Œæœ‰å¤šå¦™ï¼Œè¿™ä¸€å¹•ç»“æŸä¹‹åï¼Œæˆ‘è¿˜æ˜¯è¦å»èµ°è‡ªå·±çš„äººç”Ÿã€‚é€ƒé¿æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œæ­£é¢Aä¸Šå»æ‰æ˜¯å”¯ä¸€çš„æ•‘èµä¹‹é“ã€‚</p>
<h2 id="3"><a href="#3" class="headerlink" title="$3$"></a>$3$</h2><p>è¿™ä¸€ç¯‡ç®—ä»€ä¹ˆï¼Ÿé¸¡æ±¤ï¼Ÿ</p>
<p>å·®ä¸å¤šå§ã€‚ä½†æˆ‘è§‰å¾—æ¯”èµ·é¸¡æ±¤æ¥ï¼Œè¿™ä¸œè¥¿æ˜¾å¾—æµ‘æµŠçš„å¤šã€‚</p>
<p>æˆ‘èº«å¤„æ— å°½æ·±æ¸Šçš„æœ€åº•éƒ¨ã€‚å‘¨èº«å¼¥æ¼«çš„æ˜¯ç´«é»‘è‰²çš„é›¾æ°”ã€‚æˆ‘çš„åŒçœ¼çäº†ã€ä¸¤è€³è‹äº†ã€å˜´ä¹Ÿå¼ ä¸å¼€äº†ã€‚ä½†æˆ‘èƒ½æ„Ÿå—åˆ°è‡ªå·±èº«ä¸Šåœ¨ç»½æ”¾ç€ç”Ÿå‘½çš„åŠ›é‡ï¼Œå‚¬æˆ‘çˆ¬å‡ºå»ã€‚</p>
<p>å—¯ï¼Œå¾ˆèµåŒçš„ä¸€ä¸ªè§‚ç‚¹ï¼š</p>
<blockquote>
<p>å¾ˆå¤šäººæƒ³çŸ¥é“ï¼Œç”Ÿå‘½çš„æ„ä¹‰åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬æ¯å¤©è¡Œè‰²åŒ†åŒ†ã€å¾—è¿‡ä¸”è¿‡ã€‚æˆ‘ä»¬åˆ°åº•ä¸ºä»€ä¹ˆè€Œæ´»ï¼Ÿ</p>
<p>å…¶å®ï¼Œã€æ´»ç€ã€çš„æ„ä¹‰ï¼Œå°±æ˜¯ã€æ´»ç€ã€æœ¬èº«ã€‚</p>
</blockquote>
<p>æ€»ä¹‹å‘¢ï¼ŒåŸæ¥æˆ‘è¿˜ä»€ä¹ˆéƒ½ä¸æ‡‚ã€‚è¿™ä¸ªä¸–ç•Œï¼Œæˆ‘è¿˜è¦ä¸€ç‚¹ä¸€ç‚¹æ…¢æ…¢åœ°æ¢ç´¢ï¼›è¿™æ¡è·¯ï¼Œæˆ‘è¿˜è¦æ…¢æ…¢çš„èµ°ã€‚</p>
<h2 id="4"><a href="#4" class="headerlink" title="$4$"></a>$4$</h2><p>æœ€åæŒ‚å‡ å¼ çˆ±æƒ…å…¬å¯“çš„å›¾ï¼Œæ¯•ç«Ÿä¹Ÿæ˜¯é™ªäº†æˆ‘äº”å…­å¹´çš„å‰§äº†ã€‚çºªå¿µä¸€ä¸‹å§ï¼</p>
<p>å†è§å•¦ï¼Œæˆ‘çš„é’æ˜¥ã€‚å†è§å•¦ï¼Œçˆ±æƒ…å…¬å¯“ï¼</p>
<p><img src="https://s2.ax1x.com/2020/02/08/1RP91A.jpg" alt><br><img src="https://s2.ax1x.com/2020/02/08/1RPPXt.jpg" alt><br><img src="https://s2.ax1x.com/2020/02/08/1RPppd.jpg" alt><br><img src="https://s2.ax1x.com/2020/02/08/1RCzfH.jpg" alt><br><img src="https://s2.ax1x.com/2020/02/08/1RCxte.jpg" alt><br><img src="https://s2.ax1x.com/2020/02/08/1RPFnP.jpg" alt></p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>ç”Ÿæ´»ç¢ç‰‡</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°/é¢˜è§£ã€‘ACè‡ªåŠ¨æœºçå¹</title>
    <url>/2020/01/17/AC%E8%87%AA%E5%8A%A8%E6%9C%BA1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ACè‡ªåŠ¨æœºç®—æ˜¯è‡ªåŠ¨æœºç³»åˆ—æ¯”è¾ƒæ—©æœŸå¼•å…¥OIçš„ç®—æ³•ï¼Œå…¨ç§°ä¸ºã€Œ$\rm Aho-Corasick ~Automaton$ã€ã€‚</p>
<p>ç„¶è€Œå…¶å®è¿™æ¬¾è‡ªåŠ¨æœºæ˜¯ä»¥ä¸¤ä¸ªç§‘å­¦å®¶çš„åå­—å‘½åçš„ã€‚ï¼ˆè¿™ã€Œæ¬¾ã€ï¼Ÿ</p>
<p>å¹¶ä¸”ä¸Šé¢è¿™ä¸€æ¡ä¿¡æ¯è¿˜æ˜¯æˆ‘ä»æœ‰é“è¯å…¸é‡ŒæŸ¥å‡ºæ¥çš„ï¼Œç™¾åº¦æ ¹æœ¬ç™¾åº¦ä¸åˆ°å¥½å— QAQ</p>
<p>ä¸è¿‡è¯è¯´è¿™ä¸œè¥¿ä¹Ÿæ˜¯å¥½ä¹…ä¹‹å‰å­¦çš„ï¼Œäºæ˜¯è¿™ç¯‡ blog å®é™…ä¸Šæ˜¯åœ¨ç‚’å†·é¥­ã€‚</p>
<a id="more"></a>
<h1 id="1-åŸç†"><a href="#1-åŸç†" class="headerlink" title="$1$ åŸç†"></a>$1$ åŸç†</h1><p>åŸç†è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œå°±æ˜¯æŠŠ KMP çš„ä¸€åŠæ”¾åˆ°äº† Trie ä¸Šã€‚é‚£æ‰¾ fail å°±è‚¯å®šè¦ bfs äº†å¯¹å§ã€‚æ ¹æ® Trie çš„æ€§è´¨ï¼Œä¸€å¼€å§‹è‚¯å®šæ˜¯è¦æŠŠæ ¹èŠ‚ç‚¹æ‰€æœ‰éç©ºå­©å­å½“ä½œèµ·å§‹çŠ¶æ€ã€‚å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)&#123; </span><br><span class="line">    	<span class="keyword">if</span> (tr[<span class="number">0</span>][i]) q.push(tr[<span class="number">0</span>][i]) ; </span><br><span class="line">        <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">            <span class="keyword">int</span> now = q.front() ; q.pop() ;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)</span><br><span class="line">                <span class="keyword">if</span> (!tr[now][i]) tr[now][i] = tr[fail[now]][i] ;</span><br><span class="line">                <span class="keyword">else</span> fail[tr[now][i]] = tr[fail[now]][i], q.push(tr[now][i]) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€ƒè™‘æ±‚ $fail$ çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰å½“å‰çš„å­©å­ï¼Œæ‰§è¡Œä¸€ä¸ªè·¯å¾„å‹ç¼©ã€‚å¦åˆ™ç›´æ¥è½¬ç§»å°±å¯ä»¥äº†ã€‚</p>
<p>å…³äº $fail$ çš„æ„ä¹‰ï¼Œä¸€ä¸ªç‚¹çš„ $fail$ æŒ‡å‘æ˜¯å…¶ä»–æ¨¡å¼ä¸²å’Œä»–çš„æœ€é•¿çš„å…¬å…±åç¼€ï¼Œå¹¶ä¸”å’Œè¿™ä¸ªæœ€é•¿å…¬å…±åç¼€å¿…ç„¶ä»æ ¹å¼€å§‹ï¼Œä¸åŒäº KMP çš„ border ã€‚</p>
<p>å¤§æ¦‚ACè‡ªåŠ¨æœºå°±è¿™ç‚¹çŸ¥è¯†å§ï¼Ÿ</p>
<h1 id="2-æ°´é¢˜æ€æ‰‹"><a href="#2-æ°´é¢˜æ€æ‰‹" class="headerlink" title="$2$ æ°´é¢˜æ€æ‰‹"></a>$2$ æ°´é¢˜æ€æ‰‹</h1><p>å—¯ï¼Œè¿™ä¸ªæ ‡é¢˜å¾ˆç‚«é…·ã€‚</p>
<h2 id="1-LG3808-ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆç®€å•ç‰ˆï¼‰"><a href="#1-LG3808-ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆç®€å•ç‰ˆï¼‰" class="headerlink" title="1 LG3808 ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆç®€å•ç‰ˆï¼‰"></a>1 LG3808 ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆç®€å•ç‰ˆï¼‰</h2><blockquote>
<p>ç»™å®š $n$ ä¸ªæ¨¡å¼ä¸²å’Œ $1$ ä¸ªæ–‡æœ¬ä¸²ï¼Œæ±‚æœ‰å¤šå°‘ä¸ªæ¨¡å¼ä¸²åœ¨æ–‡æœ¬ä¸²é‡Œå‡ºç°è¿‡ã€‚</p>
</blockquote>
<p>å»º Trie æ—¶è®°å½•ä¸€ä¸‹æ¯ä¸ªä¸²çš„ $endpos$ å°±å®Œäº†ã€‚</p>
<h2 id="2-LG3796-ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆåŠ å¼ºç‰ˆï¼‰"><a href="#2-LG3796-ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆåŠ å¼ºç‰ˆï¼‰" class="headerlink" title="2 LG3796 ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆåŠ å¼ºç‰ˆï¼‰"></a>2 LG3796 ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆåŠ å¼ºç‰ˆï¼‰</h2><blockquote>
<p>æœ‰ $\rm N$ ä¸ªç”±å°å†™å­—æ¯ç»„æˆçš„æ¨¡å¼ä¸²ä»¥åŠä¸€ä¸ªæ–‡æœ¬ä¸² $\rm T$ã€‚</p>
<p>æ¯ä¸ªæ¨¡å¼ä¸²å¯èƒ½ä¼šåœ¨æ–‡æœ¬ä¸²ä¸­å‡ºç°å¤šæ¬¡ã€‚ä½ éœ€è¦æ‰¾å‡º<strong>å“ªäº›</strong>æ¨¡å¼ä¸²åœ¨æ–‡æœ¬ä¸² $\rm T$ ä¸­å‡ºç°çš„æ¬¡æ•°æœ€å¤šã€‚</p>
</blockquote>
<p>å—¯ï¼Œè¿™ä¸ªå…¶å®æ˜¯ä¸ªå¼±åŒ–ç‰ˆæœ¬ã€‚è€ƒè™‘è®°å½•æœ€æš´åŠ›çš„è§£æ³•å¤§æ¦‚å°±æ˜¯æ¯åŒ¹é…åˆ°ä¸€ä¸ªç‚¹ï¼Œå°±ä¸æ–­å‘ä¸Šè·³ $fail$ å»æ‰¾æœ‰å“ªäº›ç‚¹æ‰“ä¸Šäº† $endpos$ æ ‡è®°ï¼Œæ¯æ¬¡åŒ¹é…çš„æ—¶å€™ä¸æ–­å‘ä¸Šè·³ï¼Œé‡åˆ° $endpos$ å°± $ ++$ï¼Œæœ€åå†æ‰«ä¸€éã€‚</p>
<p>å½“ç„¶å…¶å®è¿™ä¸ªåœ°æ–¹å­˜åœ¨ä¸€ä¸ªå‰ªæã€‚å®Œå…¨å¯ä»¥è®°å½•ç¦»ç°åœ¨è¿™ä¸ªç‚¹æœ€è¿‘çš„ä¸€ä¸ªæœ‰ $endpos$ çš„ $fail$ã€‚æ¨çš„æ–¹å¼è·Ÿæ¨ $fail$ å¤§åŒå°å¼‚ã€‚</p>
<p>å¤§æ¦‚å¯ä»¥æŠŠ $fail$ ç†è§£ä¸ºä¸€é˜¶å¤±é…æŒ‡é’ˆï¼Œ$last$ ä¸ºäºŒé˜¶çš„ï¼Œæ‰€ä»¥ç†æ‰€åº”å½“åœ¨ä¸€é˜¶ä¸Šé¢è·‘ã€‚ </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BFS</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i) </span><br><span class="line">      <span class="keyword">if</span>(Trie[<span class="number">0</span>][i]) q.push(Trie[<span class="number">0</span>][i]) ; <span class="comment">//1 </span></span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.front() ; q.pop() ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!v(now)) Trie[now][i] = Trie[fail[now]][i] ;</span><br><span class="line">            <span class="keyword">else</span> fail[v(now)] = Trie[fail[now]][i], q.push(v(now)), </span><br><span class="line">            last[v(now)] = Send[fail[v(now)]] ? fail[v(now)] : last[fail[v(now)]] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-LG5357-ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆäºŒæ¬¡åŠ å¼ºç‰ˆï¼‰"><a href="#3-LG5357-ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆäºŒæ¬¡åŠ å¼ºç‰ˆï¼‰" class="headerlink" title="3 LG5357 ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆäºŒæ¬¡åŠ å¼ºç‰ˆï¼‰"></a>3 LG5357 ã€æ¨¡æ¿ã€‘ACè‡ªåŠ¨æœºï¼ˆäºŒæ¬¡åŠ å¼ºç‰ˆï¼‰</h2><blockquote>
<p>æœ‰ $\rm N$ ä¸ªç”±å°å†™å­—æ¯ç»„æˆçš„æ¨¡å¼ä¸²ä»¥åŠä¸€ä¸ªæ–‡æœ¬ä¸² $\rm T$ã€‚</p>
<p>æ¯ä¸ªæ¨¡å¼ä¸²å¯èƒ½ä¼šåœ¨æ–‡æœ¬ä¸²ä¸­å‡ºç°å¤šæ¬¡ã€‚ä½ éœ€è¦æ‰¾å‡º<strong>å“ªäº›</strong>æ¨¡å¼ä¸²åœ¨æ–‡æœ¬ä¸² $\rm T$ ä¸­å‡ºç°çš„æ¬¡æ•°æœ€å¤šã€‚</p>
</blockquote>
<p>enï¼Œå¥½ä¹…ä¹‹å‰rqyå°±æœ‰è®²è¿‡è¿™ä¸ªé—®é¢˜ã€‚å…¶å®ä¸Šé¢é‚£é¢˜æ— è®ºå‰ªä¸å‰ªæï¼Œæœ€åå¤æ‚åº¦éƒ½æ˜¯ $O(n^2)$ çš„ï¼Œåªè¦è¿™ä¹ˆæ„é€ å°±å¯ä»¥ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">a</span><br><span class="line">aa</span><br><span class="line">aaa</span><br><span class="line">aaaa</span><br><span class="line">........(çœç•¥)</span><br><span class="line">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯è€ƒè™‘è¿™ä¸œè¥¿ä¼¼ä¹æ­£ç€ç®—ä¸å¥½ç®—ï¼Œäºæ˜¯è€ƒè™‘å€’ç€è®¡ç®—è´¡çŒ®ã€‚å‘ç°åŸæ¥æ˜¯ä¸ª $dp$ çš„è¿‡ç¨‹ã€‚</p>
<p>å¤§æ¦‚å°±æ˜¯ï¼Œåœ¨ACè‡ªåŠ¨æœºçš„failæ ‘ä¸Šï¼Œè‡ªå·±çš„å­©å­ä¸€å®šå’Œè‡ªå·±æœ‰ç€ç›¸åŒåç¼€ã€‚æ‰€ä»¥åªéœ€è¦æŒ‰ç…§failè¾¹å»ºæ ‘ï¼Œç„¶åç®—ä¸€éå­æ ‘å¤§å°ã€‚ä¹‹å‰éœ€è¦è®°å½•å¯¹åº”ä½ç½®ï¼Œæœ€åè¾“å‡º</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXD 60010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXP 201000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 2000200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">int</span> N ; <span class="keyword">char</span> In[MAXP], S[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Hash&#123;</span><br><span class="line">    <span class="keyword">int</span> f[MAXN] ;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull ;</span><br><span class="line">    <span class="built_in">map</span> &lt;ull, <span class="keyword">int</span>&gt; htble ;</span><br><span class="line">    <span class="keyword">const</span> ull base = <span class="number">137</span> ;</span><br><span class="line">    <span class="function">ull <span class="title">get_h</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="built_in">strlen</span>(s) ;</span><br><span class="line">        ull ret = (s[<span class="number">0</span>] ^ <span class="number">32768</span>) + <span class="number">3</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; l ; ++ i)</span><br><span class="line">            ret = ret * base + (ull)s[i] ;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Hash ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Graph&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">        <span class="keyword">int</span> to, next ;</span><br><span class="line">    &#125;E[MAXP &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> cnt1, head[MAXP] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">        E[++ cnt1].to = v, E[cnt1].next = head[u], head[u] = cnt1 ;</span><br><span class="line">        E[++ cnt1].to = u, E[cnt1].next = head[v], head[v] = cnt1 ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Graph ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> AC&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt, e[MAXP], last[MAXP], ans ;</span><br><span class="line">    <span class="keyword">int</span> tr[MAXP][<span class="number">27</span>], res[MAXP], Id[MAXP], fail[MAXP] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ans = <span class="number">0</span> ;</span><br><span class="line">        <span class="built_in">memset</span>(e, <span class="number">0</span>, <span class="keyword">sizeof</span>(e)) ;</span><br><span class="line">        <span class="built_in">memset</span>(Id, <span class="number">0</span>, <span class="keyword">sizeof</span>(Id)) ;</span><br><span class="line">        <span class="built_in">memset</span>(res, <span class="number">0</span>, <span class="keyword">sizeof</span>(res)) ;</span><br><span class="line">        <span class="built_in">memset</span>(fail, <span class="number">0</span>, <span class="keyword">sizeof</span>(fail)) ;</span><br><span class="line">        <span class="built_in">memset</span>(last, <span class="number">0</span>, <span class="keyword">sizeof</span>(last)) ;</span><br><span class="line">        <span class="built_in">memset</span>(tr, <span class="number">0</span>, <span class="keyword">sizeof</span>(tr)), cnt = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> *p)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rt = <span class="number">0</span>, l = <span class="built_in">strlen</span>(p) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; l ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">int</span> now = p[i] - <span class="string">'a'</span> ;</span><br><span class="line">            <span class="keyword">if</span> (!tr[rt][now]) </span><br><span class="line">              tr[rt][now] = ++ cnt ;</span><br><span class="line">            rt = tr[rt][now] ;</span><br><span class="line">        &#125;</span><br><span class="line">        ++ e[rt] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">idins</span><span class="params">(<span class="keyword">char</span> *p, <span class="keyword">int</span> ID)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rt = <span class="number">0</span>, l = <span class="built_in">strlen</span>(p) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; l ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">int</span> now = p[i] - <span class="string">'a'</span> ;</span><br><span class="line">            <span class="keyword">if</span> (!tr[rt][now]) </span><br><span class="line">              tr[rt][now] = ++ cnt ;</span><br><span class="line">            rt = tr[rt][now] ;</span><br><span class="line">        &#125;</span><br><span class="line">        e[rt] = ID, Id[ID] = rt ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> sz[MAXN] ;</span><br><span class="line">    <span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i) </span><br><span class="line">          <span class="keyword">if</span> (tr[<span class="number">0</span>][i]) q.push(tr[<span class="number">0</span>][i]) ; <span class="comment">// 1</span></span><br><span class="line">        <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">define</span> qwq tr[now][i]</span></span><br><span class="line">            <span class="keyword">int</span> now = q.front() ; q.pop() ;</span><br><span class="line"><span class="comment">//            cout &lt;&lt; q.size() &lt;&lt; endl ;</span></span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)&#123;</span><br><span class="line">                <span class="keyword">if</span> (!qwq) qwq = tr[fail[now]][i] ;</span><br><span class="line">                <span class="keyword">else</span> fail[qwq] = tr[fail[now]][i], q.push(qwq) ;</span><br><span class="line">                <span class="keyword">if</span> (e[fail[qwq]]) last[qwq] = fail[qwq] ;</span><br><span class="line">                <span class="keyword">else</span> last[qwq] = last[fail[qwq]] ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">work1</span><span class="params">(<span class="keyword">char</span> *p)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rt = <span class="number">0</span>, ret = <span class="number">0</span>, i, l = <span class="built_in">strlen</span>(p), q ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; l ; ++ i)&#123;</span><br><span class="line">            rt = tr[rt][p[i] - <span class="string">'a'</span>], q = rt ;</span><br><span class="line">            <span class="keyword">while</span> (q &amp;&amp; (~e[q])) </span><br><span class="line">              ret += e[q], e[q] = <span class="number">-1</span>, q = fail[q] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work2</span><span class="params">(<span class="keyword">char</span> *p)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rt = <span class="number">0</span>, ret = <span class="number">0</span>, i, l = <span class="built_in">strlen</span>(p), q ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; l ; ++ i)&#123;</span><br><span class="line">            rt = tr[rt][p[i] - <span class="string">'a'</span>], q = rt ;</span><br><span class="line">            <span class="keyword">while</span> (q) &#123; <span class="keyword">if</span> (e[q]) res[e[q]] ++ ; q = last[q] ; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work3</span><span class="params">(<span class="keyword">char</span> *p)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rt = <span class="number">0</span>, i, l = <span class="built_in">strlen</span>(p) ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; l ; ++ i)</span><br><span class="line">            rt = tr[rt][p[i] - <span class="string">'a'</span>], sz[rt] ++ ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= cnt ; ++ i) add(i, fail[i]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)&#123;</span><br><span class="line">            <span class="keyword">if</span> (to(k) == v) <span class="keyword">continue</span> ;</span><br><span class="line">            dfs(to(k), u), sz[u] += sz[to(k)] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> AC ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, ans ; <span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) f[i] = i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, In) ;</span><br><span class="line">        ull p = get_h(In) ;</span><br><span class="line">        <span class="keyword">if</span> (!htble.count(p))</span><br><span class="line">            idins(In, i), htble[p] = i ;</span><br><span class="line">        <span class="keyword">else</span> f[i] = htble[p] ;</span><br><span class="line">    &#125;</span><br><span class="line">    bfs() ; <span class="built_in">scanf</span>(<span class="string">"%s"</span>, S) ; work3(S) ; dfs(<span class="number">0</span>, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, sz[Id[f[i]]]) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å”‰ï¼Œå­¦äº†å¥½å‡ éæ‰çœŸæ­£å­¦æ˜ç™½ $fail$ æŒ‡é’ˆæ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œwtcl</p>
<p>btwï¼Œæ„Ÿè§‰ACè‡ªåŠ¨æœºå¦‚æœçœŸè¦èµ·åçš„è¯ï¼Œå«åç¼€è‡ªåŠ¨æœºä¹Ÿå¯ä»¥å•Šï¼ˆ</p>
<h1 id="4-ä¾‹é¢˜"><a href="#4-ä¾‹é¢˜" class="headerlink" title="$4$ ä¾‹é¢˜"></a>$4$ ä¾‹é¢˜</h1><h2 id="rm-POI2000-ç—…æ¯’"><a href="#rm-POI2000-ç—…æ¯’" class="headerlink" title="[$\rm POI2000$] ç—…æ¯’"></a>[$\rm POI2000$] ç—…æ¯’</h2><blockquote>
<p>ç»™å®šä¸€å † $01$ ä¸²ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ä¸€ä¸ªæ— é™é•¿çš„ $01$ ä¸²ä½¿å¾—ä¸åŒ…å«ä»»ä½•ä¸€ä¸ªç»™å‡º $01$ ä¸²ä½œä¸ºå…¶å­ä¸²ã€‚</p>
</blockquote>
<p> è€ƒè™‘æ€æ ·æ‰èƒ½ç®—æ˜¯æ— é™é•¿çš„å®‰å…¨ä»£ç ã€‚</p>
<p>å…ˆç»™å‡ºç»“è®ºï¼šå¯¹æ¯ä¸ªå­˜åœ¨ç—…æ¯’ä»£ç çš„çŠ¶æ€æ‰“ä¸Šæ ‡è®°ã€‚é‚£ä¹ˆå¦‚æœ<strong>å®Œæ•´</strong>çš„trieå›¾é‡Œé¢å­˜åœ¨ä¸€ä¸ªä¸å¸¦æ ‡è®°çš„åœˆï¼Œå°±ä¼šæœ‰æ— é™é•¿çš„å®‰å…¨ä»£ç ã€‚æ­¤å¤„å®Œæ•´æŒ‡çš„æ˜¯ï¼Œå¯¹äºç»™å®šä¸€æ£µtrieæ ‘ï¼Œè¡¥å…¨ä»–çš„æ‰€æœ‰å¶å­ã€‚</p>
<p>å¯çŸ¥è¿™æ˜¯æ˜¾ç„¶çš„ï¼Œå› ä¸ºæœ¬è´¨ä¸Šåªéœ€è¦è€ƒè™‘åˆ°æ·±åº¦=æœ€é•¿çš„ç—…æ¯’ä¸²é•¿åº¦è¿™ä¸€æ­¥å°±okäº†ï¼Œå‰©ä¸‹éƒ½å¯ä»¥å¾ªç¯ç”Ÿæˆã€‚</p>
<p>æ³¨æ„åˆ°æœ¬è´¨ä¸Š trie ä¸ç”¨æ˜¾å¼åœ°å»ºå‡ºæ¥ï¼Œäºæ˜¯æœ€å $dfs$ çš„æ—¶å€™ç»Ÿè®¡ä¸€ä¸‹å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ACAM</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> fail[MAXS], vis[MAXS], sz ;</span><br><span class="line">    <span class="keyword">int</span> _ed[MAXS], trans[MAXS][<span class="number">2</span>], ans[MAXS] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Ins</span><span class="params">(<span class="keyword">char</span> *t)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rt = <span class="number">0</span> ; N = <span class="built_in">strlen</span>(t + <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">            t[i] -= <span class="string">'0'</span> ;</span><br><span class="line">            <span class="keyword">if</span> (!trans[rt][t[i]])</span><br><span class="line">                trans[rt][t[i]] = ++ sz ;</span><br><span class="line">            rt = trans[rt][t[i]] ;</span><br><span class="line">        &#125;</span><br><span class="line">        _ed[rt] ++ ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i, n ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= <span class="number">1</span> ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (trans[<span class="number">0</span>][i]) q.push(trans[<span class="number">0</span>][i]) ;</span><br><span class="line">        <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">            n = q.front() ; q.pop() ;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= <span class="number">1</span> ; ++ i)&#123;</span><br><span class="line">                <span class="keyword">if</span> (!trans[n][i])</span><br><span class="line">                    trans[n][i] = trans[fail[n]][i] ;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    fail[trans[n][i]] = trans[fail[n]][i],</span><br><span class="line">                    _ed[trans[n][i]] |= _ed[fail[trans[n][i]]], q.push(trans[n][i]) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ans[x])</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"TAK"</span>), <span class="built_in">exit</span>(<span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (_ed[x] || vis[x]) <span class="keyword">return</span> ;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; x &lt;&lt; endl ;</span></span><br><span class="line">        vis[x] = ans[x] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= <span class="number">1</span> ; ++ i)</span><br><span class="line">            <span class="comment">//if (trans[x][i]) dfs(trans[x][i]) ;</span></span><br><span class="line">            dfs(trans[x][i]) ;</span><br><span class="line">        ans[x] = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;A ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; (s + <span class="number">1</span>), A.Ins(s) ;</span><br><span class="line">    A.build() ; A.dfs(<span class="number">0</span>) ; <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NIE"</span>), <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°ä»£ç ä¸­ $dfs$ é‡Œé¢æ³¨é‡Šçš„ä¸€è¡Œï¼Œæ˜¾ç„¶æ˜¯é”™çš„ï¼Œå¯ä»¥è¢«ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">11</span></span><br></pre></td></tr></table></figure>
<p>è¿™ç»„æ•°æ®ç›´æ¥ç»™å¡æ‰ã€‚ä½†æ˜¯æ•°æ®å¤ªæ°´å°±ç»™è¿‡æ‰äº†â€¦</p>
<p>â€¦è¯´å®åœ¨çš„æˆ‘æœ¬æ¥æƒ³å°è¯•å»è¯æ˜ä¸ºä»€ä¹ˆé‚£æ ·é”™çš„å†™æ˜¯å¯¹çš„ï¼Œå°è¯•åŠªåŠ›å»ç¼–å‡ºä¸€ä¸ªåˆç†è§£é‡Šï¼Œåˆ°æœ€åæ‰å‘ç°æ˜¯è‡ªå·±åŸæ¥çš„ $code$ é”™äº†QAQ</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>ACè‡ªåŠ¨æœº</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/è‡ªåŠ¨æœºä¸ŠDP</tag>
        <tag>å­—ç¬¦ä¸²/ACè‡ªåŠ¨æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘ACè‡ªåŠ¨æœºæ³›åš</title>
    <url>/2020/01/17/AC%E8%87%AA%E5%8A%A8%E6%9C%BA2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å‡ é“ACè‡ªåŠ¨æœºç®€å•é¢˜qwq</p>
<p>ä»¥ä¸Šæ˜¯åŸæ ‡é¢˜ã€‚ç°åœ¨æ•´ç†ä¸€éå‘ç°é™¤äº†ç¬¬ä¸€é“é¢˜éƒ½ä¸å¤ªä¼šäº†ï¼Œæ‰€ä»¥é¢˜éƒ½æŒºå¥½çš„QAQ</p>
<p><del>æ‰€ä»¥æ˜¯ä¸æ˜¯é—´æ¥è¯æ˜äº†ã€Œå¥½é¢˜ã€=ã€Œç”±äºè‡ªå·±å¤ªèœè€Œæƒ³ä¸å‡ºæ¥çš„é¢˜ã€å•Šï¼Œå¬ä¸Šå»å¥½æ‚²ä¼¤</del></p>
<a id="more"></a>
<h1 id="1-TJOI2013-å•è¯"><a href="#1-TJOI2013-å•è¯" class="headerlink" title="$1$ [TJOI2013]å•è¯"></a>$1$ [TJOI2013]å•è¯</h1><blockquote>
<p>å°å¼ æœ€è¿‘åœ¨å¿™æ¯•è®¾ï¼Œæ‰€ä»¥ä¸€ç›´åœ¨è¯»è®ºæ–‡ã€‚</p>
<p>ä¸€ç¯‡è®ºæ–‡æ˜¯ç”±è®¸å¤šå•è¯ç»„æˆã€‚ä½†å°å¼ å‘ç°ä¸€ä¸ªå•è¯ä¼šåœ¨è®ºæ–‡ä¸­å‡ºç°å¾ˆå¤šæ¬¡ï¼Œä»–æƒ³çŸ¥é“æ¯ä¸ªå•è¯åˆ†åˆ«åœ¨è®ºæ–‡ä¸­å‡ºç°äº†å¤šå°‘æ¬¡ã€‚</p>
</blockquote>
<p>å‘ç°æ€ä¹ˆåšéƒ½å¯ä»¥å•¦ã€‚å½“æ—¶è‡ªå·±ä¼¼ä¹æ˜¯è®°å½•äº†ä¸€ä¸‹å…³é”®ç‚¹(endpos)å’Œæ¯ä¸ªç‚¹çš„ç»è¿‡æ¬¡æ•°ï¼Œç„¶ååå‘topsortå°±dpå®Œäº†ã€‚</p>
<p>å¤šæ”’æ”’ç»éªŒï¼Œä¸‡ä¸€å“ªå¤©å°±å¯ä»¥ä¸€çœ¼ç§’äº†å‘¢ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> ID)</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> rt = <span class="number">0</span>, c ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> k = <span class="number">0</span> ; s[k] ; ++ k)&#123;</span><br><span class="line">        c = s[k] - <span class="string">'a'</span> ;</span><br><span class="line">        <span class="keyword">if</span> (!Trie[rt][c]) </span><br><span class="line">          Trie[rt][c] = ++ tot ; </span><br><span class="line">        rt = Trie[rt][c], ++ res[rt] ;</span><br><span class="line">    &#125;</span><br><span class="line">    cnt[ID] = rt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BFS</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i) </span><br><span class="line">      <span class="keyword">if</span>(Trie[<span class="number">0</span>][i]) q.push(Trie[<span class="number">0</span>][i]) ; </span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.front() ; T[++ n] = now ; q.pop() ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (!v(now)) </span><br><span class="line">              Trie[now][i] = Trie[fail[now]][i] ;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">              fail[v(now)] = Trie[fail[now]][i], q.push(v(now)) ;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">for</span> (i = n ; i &gt;= <span class="number">0</span> ; -- i) res[fail[T[i]]] += res[T[i]] ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-USACO15FEB-Censoring-Gold"><a href="#2-USACO15FEB-Censoring-Gold" class="headerlink" title="$2$ [USACO15FEB]Censoring(Gold)"></a>$2$ [USACO15FEB]Censoring(Gold)</h1><blockquote>
<p>ç»™å‡ºä¸€ä¸ªé•¿ä¸²å’Œä¸€å †å°ä¸²ã€‚æ¯æ¬¡ä»é•¿ä¸²ä¸­æ‰¾å‡ºæœ€é å³çš„å°ä¸²ï¼Œåˆ æ‰ä¹‹åæ‹¼èµ·æ¥ï¼Œç»§ç»­åˆ ã€‚æ±‚åˆ åˆ°æœ€åçš„ä¸²ã€‚</p>
<p>$\rm |S|\leq 10^6$</p>
</blockquote>
<p>ç¬¬ä¸€çœ¼ä¸ä¼šåšï¼Œæˆ‘æ˜¯å¼Ÿå¼ŸQAQ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">char</span> *In)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> rt = <span class="number">0</span>, L = <span class="built_in">strlen</span>(In) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">int</span> now = In[i] - <span class="string">'a'</span> ;</span><br><span class="line">		<span class="keyword">if</span> (!Trie[rt][now]) </span><br><span class="line">		    Trie[rt][now] = ++ cnt ;</span><br><span class="line">		rt = Trie[rt][now] ;<span class="comment">// 1 </span></span><br><span class="line">	&#125;</span><br><span class="line">	Id[rt] = L ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> rt = <span class="number">0</span> ;  </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= Ls ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">int</span> now = S[i] - <span class="string">'a'</span> ;</span><br><span class="line">		rt = Trie[rt][now], R[i] = rt, stk[++ top] = i ;</span><br><span class="line">		<span class="keyword">if</span> (Id[rt]) top -= Id[rt], rt = top ? R[stk[top]] : <span class="number">0</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‘ç°ä¼¼ä¹æ­£è§£å‡ºå¥‡çš„ç®€æ´â€¦</p>
<p>ç„¶åå‘ç°åŸæ¥ã€Œåˆ é™¤ä¸€ä¸ªä¸²å†æ‹¼èµ·æ¥ã€è¿™ä¸œè¥¿å°±ç›´æ¥é¡ºç€æ‰«ä¸€éå¼¹æ ˆå°±å®Œäº†â€¦</p>
<p>è¿™é¢˜ä¼¼ä¹æŒºè€ƒå¯ŸåŸºæœ¬åŠŸçš„å§â€¦åƒæˆ‘è¿™ç§åŸºæœ¬åŠŸä¸è¡Œçš„è€å¹´é€‰æ‰‹åˆè¢«æ— æƒ…åŠé”¤äº†QAQ</p>
<h1 id="3-NOI2011-é˜¿ç‹¸çš„æ‰“å­—æœº"><a href="#3-NOI2011-é˜¿ç‹¸çš„æ‰“å­—æœº" class="headerlink" title="$3$ [NOI2011]é˜¿ç‹¸çš„æ‰“å­—æœº"></a>$3$ [NOI2011]é˜¿ç‹¸çš„æ‰“å­—æœº</h1><blockquote>
<p>æœ‰ä¸€ä¸ªæ‰“å­—æœºï¼Œæ”¯æŒä¸‰ç§æ“ä½œï¼š</p>
<ul>
<li>å­—ç¬¦ä¸²æœ«å°¾åŠ ä¸€ä¸ªå°å†™å­—æ¯</li>
<li>å­—ç¬¦ä¸²æœ«å°¾åˆ ä¸€ä¸ªå­—ç¬¦</li>
<li>è¾“å‡ºè¿™ä¸ªå­—ç¬¦ä¸²</li>
</ul>
<p>ç»è¿‡ä¸è¶…è¿‡ $n$ æ¬¡æ“ä½œåæœ‰ $m$ ç»„è¯¢é—®ï¼š$(x,y)$ï¼Œè¡¨ç¤ºè¯¢é—®ç¬¬ $x$ æ¬¡è¾“å‡ºç¬¬å­—ç¬¦ä¸²åœ¨ç¬¬ $y$ æ¬¡è¾“å‡ºç¬¬å­—ç¬¦ä¸²é‡Œå‡ºç°å‡ æ¬¡</p>
<p>$1\leq n,m \leq 10^5$</p>
</blockquote>
<p>æœ¬æ¥æ²¡åšè¿‡è¿™é“é¢˜ï¼Œä½†æ˜¯ä¸€ç¯‡æ–‡ç« å†™ä¸¤é“é¢˜æ€»è§‰å¾—æœ‰ç‚¹ä¸çˆ½ï¼Œäºæ˜¯å†³å®šåŠ ä¸€é“ã€‚</p>
<p>äºæ˜¯å°±å‘ç°è‡ªå·±è¿›äº†ä¸ªå¤©å‘â€¦â€¦æœ¬æ¥è§‰å¾—è¿™é¢˜åº”è¯¥æŒºç®€å•çš„è¯´ï¼ˆé€šè¿‡é¢˜ç›®åç§°çŒœçš„ï¼ˆï¼ˆï¼ˆ</p>
<p>æ ¹æ® ACAM çš„æ€§è´¨ï¼Œå‘ç°æ‰€æœ‰åŒ…å«æŸä¸ªä¸² $\rm S$ çš„é›†åˆ $O$ å°±æ˜¯ $\rm endpos(S)$ åœ¨ $fail$ æ ‘ä¸Šçš„å­æ ‘ã€‚æ‰€ä»¥æ¯æ¬¡å¯ä»¥çœ‹åšæŸ¥è¯¢ $\rm endpos(S_\mathit{x})$ çš„ $fail$ æ ‘å­æ ‘ä¸­æœ‰å¤šå°‘ä¸ªå•è¯ä¹Ÿåœ¨ $\rm S_\it{y}$ é‡Œé¢ã€‚å‘ç°ã€Œä¹Ÿåœ¨ $\rm S_\it{y}$ é‡Œé¢ã€è¿™ä¸œè¥¿å¯ä»¥é€šè¿‡ã€Œ$\rm endpos(S\mathit{_y})$ åœ¨ Trie ä¸Šåˆ°æ ¹çš„è·¯å¾„ã€æ¥è¡¨ç¤ºï¼Œäºæ˜¯å°±ç›´æ¥æ‹¿ä¸ªæ ‘çŠ¶æ•°ç»„ç»´æŠ¤ $dfs$ åºå°±å¯ä»¥äº†ã€‚</p>
<p>ç„¶åä»¥ä¸‹æ˜¯å†™è¿™ä¸ªé¢˜è¸©çš„å‘ï¼š</p>
<ul>
<li>ACè‡ªåŠ¨æœºç”±äºæ±‚ fail çš„æ—¶å€™è¦è·¯å¾„å‹ç¼©ï¼Œæ‰€ä»¥å¦‚æœå‹å®Œç›´æ¥å» dfs è¿™ä¸ª Trie çš„è¯ä¼šé”™ï¼Œæ‰€ä»¥è¦äº‹å…ˆå¤åˆ¶ä¸€ä»½ï¼ˆå› ä¸ºæ˜¾ç„¶ä¸è·¯å¾„å‹ç¼©å¤æ‚åº¦ä¸å¯¹ï¼‰ã€‚</li>
<li>ä¸è¦å¿˜äº†ACè‡ªåŠ¨æœºæœ‰ 0 å·èŠ‚ç‚¹ï¼Œæ‰€ä»¥ dfn å¯èƒ½ä¼šæ¯”ç¼–å·å¤§ 1ï¼ŒåŠ ä¸Šå³å¯ã€‚</li>
<li>è¿™é¢˜è¯»å…¥ååˆ†é¬¼ç•œï¼Œå¯¼è‡´ä¸èƒ½ä¸€ä¸ªä¸€ä¸ªæ’å…¥ã€‚å‘ç°åˆ é™¤å°±æ˜¯è·³ father ï¼ŒåŠ å…¥å°±æ˜¯èµ° rootï¼Œæ‰€ä»¥ä¹Ÿæ˜¯è€ƒå¯Ÿäº†ACè‡ªåŠ¨æœºçš„çŠ¶æ€ç®€å¹¶æ€§å§ã€‚</li>
</ul>
<p>å”‰ï¼Œæˆ‘å¤ªèœäº†ã€‚ä¸­é—´ç”±äºæ€è€ƒä¸è¶³å¯¼è‡´èµ°äº†ä¸€å †å¼¯è·¯ã€‚ä¸”ä¸€å¼€å§‹ç”±äº TLE è¿˜è§‰å¾—æ˜¯çº¿æ®µæ ‘å¤ªæ…¢äº†åˆå†™äº†ä¸ª BITâ€¦233</p>
<p>ä¸ç®¡ä¸ç®¡ï¼Œè¿™ä¹ˆéš¾å†™çš„ä¸œè¥¿ä¸€å®šè¦ä»£ç å…¨ç¯‡è´´qwqï¼</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> low(x) (x &amp; -x)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pint pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">400010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Sigma = <span class="number">26</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SZ = <span class="number">1000010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;E[M] ;</span><br><span class="line"><span class="keyword">int</span> m ;</span><br><span class="line"><span class="keyword">int</span> Id ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">char</span> S[N] ;</span><br><span class="line"><span class="keyword">char</span> T[N] ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> sz[SZ] ;</span><br><span class="line"><span class="keyword">int</span> _bit[N] ;</span><br><span class="line"><span class="keyword">int</span> dfn[SZ] ;</span><br><span class="line"><span class="keyword">int</span> dep[SZ] ;</span><br><span class="line"><span class="keyword">int</span> head[SZ] ;</span><br><span class="line"><span class="keyword">int</span> t[N * <span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">int</span> tag[N * <span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">bool</span> vis[SZ] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;pint&gt; qs[N] ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ACAM</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> L, rt ;</span><br><span class="line">    <span class="keyword">int</span> fa[SZ] ;</span><br><span class="line">    <span class="keyword">int</span> id[SZ] ;</span><br><span class="line">    <span class="keyword">int</span> sz, tot ;</span><br><span class="line">    <span class="keyword">int</span> _ed[SZ] ;</span><br><span class="line">    <span class="keyword">int</span> _ED[SZ] ;</span><br><span class="line">    <span class="keyword">int</span> fail[SZ] ;</span><br><span class="line">    <span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line">    <span class="keyword">int</span> tr[SZ][Sigma] ;</span><br><span class="line">    <span class="keyword">int</span> trans[SZ][Sigma] ;</span><br><span class="line">    <span class="comment">/*void Insert(char *S, int len)&#123;</span></span><br><span class="line"><span class="comment">        L = len, rt = 0, ++ tot ;</span></span><br><span class="line"><span class="comment">        //cout &lt;&lt; " ** " &lt;&lt; len &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">        for (int i = 1 ; i &lt;= L ; ++ i)&#123;</span></span><br><span class="line"><span class="comment">            //cout &lt;&lt; S[i] ;</span></span><br><span class="line"><span class="comment">            int o = S[i] - 'a' ;</span></span><br><span class="line"><span class="comment">            if (!trans[rt][o])</span></span><br><span class="line"><span class="comment">                trans[rt][o] = ++ sz ;</span></span><br><span class="line"><span class="comment">            rt = trans[rt][o] ;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        _ed[rt] = tot ; _ED[tot] = rt ; //puts("") ;</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Workfail</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; Sigma ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (trans[<span class="number">0</span>][i]) q.push(trans[<span class="number">0</span>][i]) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= sz ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; Sigma ; ++ j)</span><br><span class="line">                tr[i][j] = trans[i][j] ;</span><br><span class="line">        <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">            <span class="keyword">int</span> x = q.front() ; q.pop() ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; Sigma ; ++ i)</span><br><span class="line">                <span class="keyword">if</span> (!tr[x][i]) tr[x][i] = tr[fail[x]][i] ;</span><br><span class="line">                <span class="keyword">else</span> fail[tr[x][i]] = tr[fail[x]][i], q.push(tr[x][i]) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;A ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v,</span><br><span class="line">    next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; x &lt;&lt; endl ;</span></span><br><span class="line">    dfn[x] = ++ Id ; sz[x] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))&#123;</span><br><span class="line">        dep[to(k)] = dep[x] + <span class="number">1</span> ;</span><br><span class="line">        dfs(to(k)), sz[x] += sz[to(k)] ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">void down(int x, int l, int r)&#123;</span></span><br><span class="line"><span class="comment">    if (tag[x])&#123;</span></span><br><span class="line"><span class="comment">        int lc = x &lt;&lt; 1 ;</span></span><br><span class="line"><span class="comment">        int rc = x &lt;&lt; 1 | 1 ;</span></span><br><span class="line"><span class="comment">        int mid = (l + r) &gt;&gt; 1 ;</span></span><br><span class="line"><span class="comment">        tag[lc] += tag[x] ;</span></span><br><span class="line"><span class="comment">        tag[rc] += tag[x] ;</span></span><br><span class="line"><span class="comment">        t[rc] += tag[x] * (r - mid) ;</span></span><br><span class="line"><span class="comment">        t[lc] += tag[x] * (mid - l + 1) ;</span></span><br><span class="line"><span class="comment">        tag[x] = 0 ;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">void update(int rt, int l, int r, int ul, int ur, int v)&#123;</span></span><br><span class="line"><span class="comment">    if (ul &lt;= l &amp;&amp; r &lt;= ur)&#123;</span></span><br><span class="line"><span class="comment">        t[rt] += v * (r - l + 1) ;</span></span><br><span class="line"><span class="comment">        tag[rt] += v ; return void() ;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    int mid = (l + r) &gt;&gt; 1 ; down(rt, l, r) ;</span></span><br><span class="line"><span class="comment">    if (ul &lt;= mid) update(rt &lt;&lt; 1, l, mid, ul, ur, v) ;</span></span><br><span class="line"><span class="comment">    if (mid &lt; ur) update(rt &lt;&lt; 1 | 1, mid + 1, r, ul, ur, v) ;</span></span><br><span class="line"><span class="comment">    t[rt] = t[rt &lt;&lt; 1] + t[rt &lt;&lt; 1 | 1] ;</span></span><br><span class="line"><span class="comment">&#125;*/</span><span class="comment">/*</span></span><br><span class="line"><span class="comment">void update(int rt, int l, int r, int p, int v)&#123;</span></span><br><span class="line"><span class="comment">    int mid = (l + r) &gt;&gt; 1 ;</span></span><br><span class="line"><span class="comment">    if (l == r)</span></span><br><span class="line"><span class="comment">        return t[rt] += v, void() ;</span></span><br><span class="line"><span class="comment">    if (p &lt;= mid)</span></span><br><span class="line"><span class="comment">        update(rt &lt;&lt; 1, l, mid, p, v) ;</span></span><br><span class="line"><span class="comment">    else update(rt &lt;&lt; 1 | 1, mid + 1, r, p, v) ;</span></span><br><span class="line"><span class="comment">    t[rt] = t[rt &lt;&lt; 1] + t[rt &lt;&lt; 1 | 1] ;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">int query(int rt, int l, int r, int ql, int qr)&#123;</span></span><br><span class="line"><span class="comment">    int mid = (l + r) &gt;&gt; 1, ret = 0 ;</span></span><br><span class="line"><span class="comment">    if (ql &lt;= l &amp;&amp; r &lt;= qr) return t[rt] ;</span></span><br><span class="line"><span class="comment">    if (ql &lt;= mid) ret += query(rt &lt;&lt; 1, l, mid, ql, qr) ;</span></span><br><span class="line"><span class="comment">    if (qr &gt; mid) ret += query(rt &lt;&lt; 1 | 1, mid + 1, r, ql, qr) ;</span></span><br><span class="line"><span class="comment">    return ret ;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mdf</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> ( ; p &lt;= A.sz ; p += low(p)) _bit[p] += v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (!p) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> ( ; p ; p -= low(p))</span><br><span class="line">        res += _bit[p] ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_do</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; x &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">if</span> (vis[x]) <span class="keyword">return</span> ; vis[x] = <span class="number">1</span> ;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; t[1] &lt;&lt; endl ;</span></span><br><span class="line">    mdf(dfn[x], <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">if</span> (A._ed[x])&#123;</span><br><span class="line">        <span class="keyword">int</span> n, k = A._ed[x] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i : qs[k])&#123;</span><br><span class="line">            n = A._ED[i.first] ;</span><br><span class="line">            ans[i.second] = ask(dfn[n] + sz[n] - <span class="number">1</span>) ;</span><br><span class="line">            ans[i.second] -= ask(dfn[n] - <span class="number">1</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; Sigma ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (A.trans[x][i]) do_do(A.trans[x][i]) ;</span><br><span class="line">    mdf(dfn[x], <span class="number">-1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, y, rt ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, S + <span class="number">1</span>) ;</span><br><span class="line">    y = <span class="built_in">strlen</span>(S + <span class="number">1</span>) ; A.sz = <span class="number">1</span> ;</span><br><span class="line">    <span class="comment">/*for (int i = 1 ; i &lt;= y ; ++ i)&#123;</span></span><br><span class="line"><span class="comment">        if (S[i] == 'B') x -- ;</span></span><br><span class="line"><span class="comment">        else if (S[i] == 'P') A.Insert(T, x) ;</span></span><br><span class="line"><span class="comment">        else T[++ x] = S[i] ;</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    rt = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= y ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (S[i] == <span class="string">'B'</span>) rt = A.fa[rt] ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (S[i] == <span class="string">'P'</span>)</span><br><span class="line">            A._ed[rt] = ++ A.tot, A._ED[A.tot] = rt ;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> o = S[i] - <span class="string">'a'</span> ;</span><br><span class="line">            <span class="keyword">if</span> (!A.trans[rt][o]) A.trans[rt][o] = ++ A.sz ;</span><br><span class="line">            A.fa[A.trans[rt][o]] = rt, rt = A.trans[rt][o] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; A.sz &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">/*for (int i = 1 ; i &lt;= A.sz ; ++ i, puts(""))</span></span><br><span class="line"><span class="comment">        for (int j = 0 ; j &lt;= 2 ; ++ j)</span></span><br><span class="line"><span class="comment">            cout &lt;&lt; A.trans[i][j] &lt;&lt; " " ;*/</span></span><br><span class="line">    A.Workfail() ;</span><br><span class="line"><span class="comment">/*    for (int i = 1 ; i &lt;= A.sz ; ++ i, puts(""))</span></span><br><span class="line"><span class="comment">        for (int j = 0 ; j &lt;= 2 ; ++ j)</span></span><br><span class="line"><span class="comment">            cout &lt;&lt; A.trans[i][j] &lt;&lt; " " ;*/</span></span><br><span class="line"><span class="comment">//    cout &lt;&lt; A.tot &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= A.sz ; ++ i)</span><br><span class="line">        add(A.fail[i], i) ;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; 233 &lt;&lt; endl ;</span></span><br><span class="line">    dfs(<span class="number">0</span>) ; <span class="built_in">cin</span> &gt;&gt; m ;</span><br><span class="line">    <span class="comment">//for (int i = 0 ; i &lt;= 3 ; ++ i) cout &lt;&lt; dep[i] &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">//cout &lt;&lt; A.fail[9] &lt;&lt; endl ;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//for (int i = 1 ; i &lt;= A.tot ; ++ i) cout &lt;&lt; A._ED[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">    <span class="comment">//for (int i = 1 ; i &lt;= A.sz ; ++ i) cout &lt;&lt; A.fail[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">    <span class="comment">/*for (int i = 1 ; i &lt;= A.sz ; ++ i) cout &lt;&lt; sz[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line"><span class="comment">    for (int i = 1 ; i &lt;= m ; ++ i)&#123;</span></span><br><span class="line"><span class="comment">        scanf("%d%d", &amp;x, &amp;y) ;</span></span><br><span class="line"><span class="comment">        x = A._ed[x], y = A._ed[y] ;</span></span><br><span class="line"><span class="comment">        //cout &lt;&lt; x &lt;&lt; " " &lt;&lt; y &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">        if (dfn[y] &gt;= dfn[x] &amp;&amp; dfn[y] &lt;= dfn[x] + sz[x] - 1)</span></span><br><span class="line"><span class="comment">            printf("%d\n", dep[y] - dep[x] + 1) ; else puts("0") ;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y),</span><br><span class="line">        qs[y].push_back(make_pair(x, i)) ;</span><br><span class="line">    do_do(<span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/è‡ªåŠ¨æœºä¸ŠDP</tag>
        <tag>å­—ç¬¦ä¸²/ACè‡ªåŠ¨æœº</tag>
        <tag>å­—ç¬¦ä¸²/å¤±é…æ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘æ•´ä½“äºŒåˆ†æ³›åš</title>
    <url>/2020/01/17/%E6%95%B4%E4%BD%93%E4%BA%8C%E5%88%86%E6%B3%9B%E5%81%9A/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¯´æ˜¯æ³›åšå…¶å®å°±æ˜¯å¤šåšäº†ä¸‰é“é¢˜ï¼Ÿ</p>
<p>åšæ–‡å†…å®¹çš„æ°´åˆ†æ—¥æ¸å¢å¤š.jpeg</p>
<a id="more"></a>
<h1 id="1-LG1527-å›½å®¶é›†è®­é˜Ÿ-çŸ©é˜µä¹˜æ³•"><a href="#1-LG1527-å›½å®¶é›†è®­é˜Ÿ-çŸ©é˜µä¹˜æ³•" class="headerlink" title="$1$ LG1527 [å›½å®¶é›†è®­é˜Ÿ]çŸ©é˜µä¹˜æ³•"></a>$1$ LG1527 [å›½å®¶é›†è®­é˜Ÿ]çŸ©é˜µä¹˜æ³•</h1><blockquote>
<p>ç»™ä½ ä¸€ä¸ª $N\times N$ çš„çŸ©é˜µï¼Œä¸ç”¨ç®—çŸ©é˜µä¹˜æ³•ï¼Œä½†æ˜¯æ¯æ¬¡è¯¢é—®ä¸€ä¸ªå­çŸ©å½¢çš„ç¬¬ $K$ å°æ•°ã€‚</p>
</blockquote>
<p>æŠŠBITæ¢æˆäºŒç»´çš„å°±åšå®Œäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">query</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> op, x, y, l, r, z ;</span><br><span class="line">&#125;q[MAXM], lq[MAXM], rq[MAXM] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, base[MAXN][MAXN] ;</span><br><span class="line"><span class="keyword">int</span> ans[MAXQ], _bit[MAXN][MAXN], cnt ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;p, <span class="keyword">const</span> <span class="keyword">int</span> &amp;q, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = p ; i &lt;= N ; i += low(i))</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> j = q ; j &lt;= N ; j += low(j))</span><br><span class="line">            _bit[i][j] += x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;p, <span class="keyword">const</span> <span class="keyword">int</span> &amp;q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (!p || !q) <span class="keyword">return</span> ret ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = p ; i ; i -= low(i))</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> j = q ; j ; j -= low(j))</span><br><span class="line">            ret += _bit[i][j] ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> vl, <span class="keyword">int</span> vr, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (vl == vr)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (q[i].op &gt; <span class="number">0</span>) ans[q[i].op] = vl ;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    rg <span class="keyword">int</span> vmid = (vl + vr) &gt;&gt; <span class="number">1</span>, bl = <span class="number">0</span>, br = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!q[i].op)&#123;</span><br><span class="line">            <span class="keyword">if</span> (q[i].z &lt;= vmid)</span><br><span class="line">                upd(q[i].x, q[i].y, <span class="number">1</span>), lq[++ bl] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> rq[++ br] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> res = ask(q[i].l, q[i].r) ;</span><br><span class="line">            res -= ask(q[i].x - <span class="number">1</span>, q[i].r) ;</span><br><span class="line">            res -= ask(q[i].l, q[i].y - <span class="number">1</span>) ;</span><br><span class="line">            res += ask(q[i].x - <span class="number">1</span>, q[i].y - <span class="number">1</span>) ;</span><br><span class="line">            <span class="comment">//cout &lt;&lt; res &lt;&lt; endl ;</span></span><br><span class="line">            <span class="keyword">if</span> (res &gt;= q[i].z) lq[++ bl] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> q[i].z -= res, rq[++ br] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (!q[i].op &amp;&amp; q[i].z &lt;= vmid)</span><br><span class="line">            upd(q[i].x, q[i].y, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= bl ; ++ i) q[l + i - <span class="number">1</span>] = lq[i] ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= br ; ++ i) q[l + bl + i - <span class="number">1</span>] = rq[i] ;</span><br><span class="line">    solve(vl, vmid, l, l + bl - <span class="number">1</span>), solve(vmid + <span class="number">1</span>, vr, l + bl, r) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">    <span class="keyword">int</span> n, x, y, l, r, k ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">            q[++ cnt].op = <span class="number">0</span>, q[cnt].x = i,</span><br><span class="line">            q[cnt].y = j, <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;q[cnt].z) ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        ++ cnt, <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;q[cnt].x, &amp;q[cnt].y) ;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;q[cnt].l, &amp;q[cnt].r, &amp;q[cnt].z), q[cnt].op = i ;</span><br><span class="line">    &#125;<span class="comment">/*</span></span><br><span class="line"><span class="comment">    for (int i = 1 ; i &lt;= cnt ; ++ i)</span></span><br><span class="line"><span class="comment">        cout &lt;&lt; q[i].x &lt;&lt; " " &lt;&lt; q[i].y &lt;&lt; " " &lt;&lt; q[i].l &lt;&lt; " " &lt;&lt; q[i].r &lt;&lt; " " &lt;&lt; q[i].z &lt;&lt; endl ;*/</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; cnt &lt;&lt; endl ;</span></span><br><span class="line">    solve(<span class="number">0</span>, Inf, <span class="number">1</span>, cnt) ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-LG4175-CTSC2008-ç½‘ç»œç®¡ç†"><a href="#2-LG4175-CTSC2008-ç½‘ç»œç®¡ç†" class="headerlink" title="$2$ LG4175 [CTSC2008]ç½‘ç»œç®¡ç†"></a>$2$ LG4175 [CTSC2008]ç½‘ç»œç®¡ç†</h1><blockquote>
<p>ç»™å®šä¸€æ£µæ ‘ï¼Œæ¯æ¬¡æˆ–è€…ä¿®æ”¹ä¸€ä¸ªç‚¹çš„ç‚¹æƒï¼Œæˆ–è€…æŸ¥è¯¢ä¸¤ç‚¹ä¹‹é—´çš„ç¬¬ $k$ å¤§ç‚¹æƒã€‚</p>
</blockquote>
<p>è¿™ä¸œè¥¿æ˜¯çœŸçš„ä¸§å¿ƒç—…ç‹‚å—·233</p>
<p>å‘ç°å†™ä¸ªæ ‘å‰–å°±å˜æˆå‚»é¢˜äº†ã€‚æœ€ç»ˆ $\log ^3$ èƒ½è¿‡ $10^5$ å¯èƒ½æ˜¯åŒ»å­¦å¥‡è¿¹å­ã€‚</p>
<p>è´´ä¸ªä»£ç è®°å½•ä¸€ä¸‹æ­¤æ—¶ç¾å¥½å¿ƒæƒ…ï¼ˆæ¯•ç«Ÿå†™çš„å¾ˆé•¿.jpg</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rg register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 500010</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Inf = <span class="number">100000001</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> o[MAXN] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">query</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> op, x, y, z ;</span><br><span class="line">&#125;q[MAXN], lq[MAXN], rq[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, M, base[MAXN], ans[MAXN], cnt ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Mary&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">        <span class="keyword">int</span> to, next ;</span><br><span class="line">    &#125;E[MAXN] ; <span class="keyword">int</span> head[MAXN], cnt ;</span><br><span class="line">    <span class="keyword">int</span> Id[MAXN], dfn[MAXN], top[MAXN], tot ;</span><br><span class="line">    <span class="keyword">int</span> dep[MAXN], sz[MAXN], faa[MAXN], son[MAXN] ;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line">    <span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;u, <span class="keyword">const</span> <span class="keyword">int</span> &amp;v)</span></span>&#123;</span><br><span class="line">        to(++ cnt) = v, next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line">        to(++ cnt) = u, next(cnt) = head[v], head[v] = cnt ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">        faa[u] = fa ;</span><br><span class="line">        sz[u] = <span class="number">1</span>, dep[u] = dep[fa] + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))&#123;</span><br><span class="line">            <span class="keyword">if</span> (to(k) == fa) <span class="keyword">continue</span> ;</span><br><span class="line">            dfs(to(k), u), sz[u] += sz[to(k)] ;</span><br><span class="line">            <span class="keyword">if</span> (!son[u] || sz[son[u]] &lt; sz[to(k)]) son[u] = to(k) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">int</span> _top)</span></span>&#123;</span><br><span class="line">        top[u] = _top, dfn[u] = ++ tot ;</span><br><span class="line">        <span class="keyword">if</span> (son[u]) dfs(son[u], u, _top) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))</span><br><span class="line">            <span class="keyword">if</span> (to(k) != fa &amp;&amp; to(k) != son[u]) dfs(to(k), u, to(k)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> s[MAXN &lt;&lt; <span class="number">2</span>] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> uv)</span></span>&#123;</span><br><span class="line">        rg <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">if</span> (l == r) <span class="keyword">return</span> s[rt] += uv, <span class="keyword">void</span>() ;</span><br><span class="line">        <span class="keyword">if</span> (p &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, l, mid, p, uv) ;</span><br><span class="line">        <span class="keyword">else</span> update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, p, uv) ;</span><br><span class="line">        s[rt] = s[rt &lt;&lt; <span class="number">1</span>] + s[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= ql &amp;&amp; r &lt;= qr) <span class="keyword">return</span> s[rt] ;</span><br><span class="line">        rg <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; rg <span class="keyword">int</span> res = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid) res += query(rt &lt;&lt; <span class="number">1</span>, l, mid, ql, qr) ;</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid) res += query(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ql, qr) ;</span><br><span class="line">        <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Query</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">        rg <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (top[u] != top[v])&#123;</span><br><span class="line">            <span class="keyword">if</span> (dep[top[u]] &lt; dep[top[v]]) swap(u, v) ;</span><br><span class="line">            ret += query(<span class="number">1</span>, <span class="number">1</span>, N, dfn[top[u]], dfn[u]), u = faa[top[u]] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (dfn[u] &gt; dfn[v]) swap(u, v) ;</span><br><span class="line">        ret += query(<span class="number">1</span>, <span class="number">1</span>, N, dfn[u], dfn[v]) ; <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> vl, <span class="keyword">int</span> vr, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Mary ;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (vl == vr)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (q[i].op &gt; <span class="number">0</span>) ans[q[i].op] = vr ;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    rg <span class="keyword">int</span> vmid = (vl + vr) &gt;&gt; <span class="number">1</span>, bl = <span class="number">0</span>, br = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (q[i].op == <span class="number">-1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (q[i].y &gt; vmid)</span><br><span class="line">                update(<span class="number">1</span>, <span class="number">1</span>, N, dfn[q[i].x], <span class="number">1</span>), rq[++ br] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> lq[++ bl] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (q[i].op == <span class="number">-2</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (q[i].y &gt; vmid)</span><br><span class="line">                update(<span class="number">1</span>, <span class="number">1</span>, N, dfn[q[i].x], <span class="number">-1</span>), rq[++ br] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> lq[++ bl] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            rg <span class="keyword">int</span> res = <span class="number">0</span> ;</span><br><span class="line">            res = Query(q[i].x, q[i].y) ;</span><br><span class="line">            <span class="keyword">if</span> (res &gt;= q[i].z) rq[++ br] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> q[i].z -= res, lq[++ bl] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (q[i].op == <span class="number">-1</span> &amp;&amp; q[i].y &gt; vmid)</span><br><span class="line">            update(<span class="number">1</span>, <span class="number">1</span>, N, dfn[q[i].x], <span class="number">-1</span>) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (q[i].op == <span class="number">-2</span> &amp;&amp; q[i].y &gt; vmid)</span><br><span class="line">            update(<span class="number">1</span>, <span class="number">1</span>, N, dfn[q[i].x], <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= bl ; ++ i) q[l + i - <span class="number">1</span>] = lq[i] ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= br ; ++ i) q[l + bl + i - <span class="number">1</span>] = rq[i] ;</span><br><span class="line">    solve(vl, vmid, l, l + bl - <span class="number">1</span>), solve(vmid + <span class="number">1</span>, vr, l + bl, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l, r, k, u, v ;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>) ;</span><br><span class="line">    <span class="built_in">cin</span>.tie(<span class="number">0</span>), <span class="built_in">cout</span>.tie(<span class="number">0</span>), <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cin</span> &gt;&gt; base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; N ; ++ i) <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v, Mary :: add(u, v) ;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; 23333 &lt;&lt; endl ;</span></span><br><span class="line">    Mary :: dfs(<span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    Mary :: dfs(<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>), cnt = <span class="number">0</span> ;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; 23333 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        q[++ cnt].y = base[i],</span><br><span class="line">        q[cnt].x = i, q[cnt].op = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; k ;</span><br><span class="line">        <span class="keyword">if</span> (k)</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r,</span><br><span class="line">            q[++ cnt].op = i, o[i] = <span class="number">1</span>,</span><br><span class="line">            q[cnt].x = l, q[cnt].y = r, q[cnt].z = k ;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r ;</span><br><span class="line">            q[++ cnt].y = base[l],</span><br><span class="line">            q[cnt].x = l, q[cnt].op = <span class="number">-2</span> ;</span><br><span class="line">            q[++ cnt].y = (base[l] = r),</span><br><span class="line">            q[cnt].x = l, q[cnt].op = <span class="number">-1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; 23333 &lt;&lt; endl ;</span></span><br><span class="line">    solve(<span class="number">0</span>, Inf, <span class="number">1</span>, cnt) ;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; 23333 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (!o[i]) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!ans[i])</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"invalid request!"</span> &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; 23333 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-POI2011-Meteors"><a href="#3-POI2011-Meteors" class="headerlink" title="$3$ [POI2011] Meteors"></a>$3$ [POI2011] Meteors</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªç¯ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªæ‰€å±å›½å®¶ï¼Œ$k$ æ¬¡äº‹ä»¶ï¼Œæ¯æ¬¡å¯¹ $[l,r]$ åŒºé—´ä¸Šçš„æ¯ä¸ªç‚¹ç‚¹æƒåŠ ä¸Šä¸€ä¸ªå€¼ï¼Œæ±‚æ¯ä¸ªå›½å®¶æœ€æ—©å¤šå°‘æ¬¡æ“ä½œä¹‹åæ‰€æœ‰ç‚¹çš„ç‚¹æƒå’Œèƒ½è¾¾åˆ°ä¸€ä¸ªå€¼ã€‚</p>
</blockquote>
<p>æ®è’‹ç¥è¯´æœ‰ $1\log$ çš„å†™æ³•ï¼Œç„¶è€Œå¹¶ä¸æƒ³å»å­¦ï¼Œç­‰æŠ½ä¸ªç©ºè¡¥ä¸Šå§ï¼ˆ</p>
<p>è¿˜æ˜¯æ•´ä½“äºŒåˆ†ï¼ŒäºŒåˆ†æ—¶é—´ã€‚æ€ä¹ˆè¯´å‘¢ï¼Œè¿™é“é¢˜æ¯”ä¹‹å‰åšçš„é¢˜è¦çµæ´»ä¸€ç‚¹ã€‚è€ƒè™‘äºŒåˆ†æ—¶é—´æœ¬è´¨ä¸Šå°±æ˜¯åœ¨äºŒåˆ†æ“ä½œï¼Œæ‰€ä»¥åªéœ€è¦æ‰§è¡Œ $[vl,vmid]$ å†…çš„æ“ä½œå°±å¯ä»¥äº†ã€‚å‘ç°è¿™æ ·éœ€è¦åˆ†æ²»çš„æ˜¯å›½å®¶ï¼ŒæŸ¥è¯¢çš„è¯æ‹¿ä¸€ä¸ªvector+BITå·®åˆ†ç»´æŠ¤ä¸€ä¸‹å³å¯ã€‚</p>
<p>æ„Ÿè§‰â€¦å°±æ˜¯è¿˜æ¬ ç«å€™ã€‚æ˜æ˜æ¯ä¸€éƒ¨åˆ†éƒ½äº†è§£å¾—ä¸€æ¸…äºŒæ¥šï¼Œæ˜æ˜æ¯ä¸€éƒ¨åˆ†éƒ½çŸ¥é“è¯¥æ€ä¹ˆå†™ï¼Œä½†æ˜¯å´ä¸²æ¥ä¸èµ·æ¥â€¦wtcl</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Inf = <span class="number">191981000</span> ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; _be[N] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">met</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, v, id ;</span><br><span class="line">&#125;q[N] ; <span class="keyword">int</span> t[N], lt[N], rt[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, k, s[N], b[N], _bit[N &lt;&lt; <span class="number">1</span>], ans[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> ( ; p &lt;= <span class="number">2</span> * m ; p += low(p)) _bit[p] += x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ; <span class="keyword">for</span> ( ; p ; p -= low(p)) ret += _bit[p] ; <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; _be[p].size() ; ++ i)&#123;</span><br><span class="line">        ret += ask(_be[p][i]) + ask(_be[p][i] + m) ;</span><br><span class="line">        <span class="keyword">if</span> (ret &gt;= s[p]) <span class="keyword">break</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> vl, <span class="keyword">int</span> vr, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (vl == vr)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">            ans[t[i]] = vl ; <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> vmid = (vr + vl) &gt;&gt; <span class="number">1</span>, fl = <span class="number">0</span>, fr = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = vl ; i &lt;= vmid ; ++ i)</span><br><span class="line">        upd(q[i].l, q[i].v), upd(q[i].r + <span class="number">1</span>, -q[i].v) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> res = query(t[i]) ;</span><br><span class="line">        <span class="keyword">if</span> (res &gt;= s[t[i]]) lt[++ fl] = t[i] ;</span><br><span class="line">        <span class="keyword">else</span> s[t[i]] -= res, rt[++ fr] = t[i] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = vl ; i &lt;= vmid ; ++ i)</span><br><span class="line">        upd(q[i].l, -q[i].v), upd(q[i].r + <span class="number">1</span>, q[i].v) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= fl ; ++ i) t[i + l - <span class="number">1</span>] = lt[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= fr ; ++ i) t[i + l + fl - <span class="number">1</span>] = rt[i] ;</span><br><span class="line">    solve(vl, vmid, l, l + fl - <span class="number">1</span>) ; solve(vmid + <span class="number">1</span>, vr, l + fl, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;b[i]), _be[b[i]].pb(i) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) t[i] = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;s[i]) ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; k ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>, &amp;q[i].l, &amp;q[i].r, &amp;q[i].v),</span><br><span class="line">        q[i].r += (q[i].l &gt; q[i].r) ? m : <span class="number">0</span>, q[i].id = i ;</span><br><span class="line">    q[++ k].l = <span class="number">1</span>, q[k].r = <span class="number">2</span> * m, q[k].id = k, q[k].v = Inf ;</span><br><span class="line">    solve(<span class="number">1</span>, k, <span class="number">1</span>, n) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (ans[i] == k) <span class="built_in">puts</span>(<span class="string">"NIE"</span>) ; <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>ç¦»çº¿ç®—æ³•/æ•´ä½“äºŒåˆ†</tag>
        <tag>æ•°æ®ç»“æ„/çº¿æ®µæ ‘</tag>
        <tag>æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è½»é‡é“¾å‰–åˆ†</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ•´ä½“äºŒåˆ†</title>
    <url>/2020/01/16/%E6%95%B4%E4%BD%93%E4%BA%8C%E5%88%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å“‡ï¼Œä¸€ç›´æƒ³å­¦æ•´ä½“äºŒåˆ†è¯¶ï¼Œç»ˆäºå­¦ä¼šäº†233</p>
<p>ååˆ†æ„Ÿè°¢æç…œä¸œçš„è“ä¹¦ï¼æ„Ÿè§‰ä»ç½‘ä¸Šæ‰¾è®²è§£ï¼Œä¸€ç›´çœ‹ä¸æ˜ç™½å‘¢â€¦</p>
<a id="more"></a> 
<p>æ•´ä½“äºŒåˆ†ï¼Œå…¶å®æœ¬è´¨ä¸Šè·Ÿçº¿æ®µæ ‘ä¸ŠäºŒåˆ†ã€splayä¸ŠäºŒåˆ†å¾ˆç›¸ä¼¼ã€‚æ˜¯å¯¹å€¼åŸŸçš„æ•´ä½“åˆ†æ²»ã€‚</p>
<p>é¦–å…ˆè€ƒè™‘ä¸€ä¸ªç®€å•çš„é—®é¢˜ï¼Œå¦‚ä½•æ±‚è§£æ•´ä¸ªåºåˆ—çš„ç¬¬ $k$ å¤§ã€‚æœ‰è¿™ä¹ˆä¸€ç§äºŒåˆ†çš„æ–¹æ³•ã€‚æœ€å¼€å§‹å–ä¸€ä¸ª $L=1$ï¼Œä¸€ä¸ª $R=\rm MAX$ã€‚å¦‚æœå½“å‰ $L\sim mid$ çš„æ•°å­—ä¸ªæ•°ä¸è¶³ $k$ ä¸ªï¼Œé‚£ä¹ˆä»¤ $k$ å‡å»è¿™äº›æ•°é‡ï¼Œå¹¶å°† $mid+1$ ä½œä¸ºæ–°çš„ $L$ ç»§ç»­äºŒåˆ†ã€‚å¯ä»¥è¯æ˜è¿™æ ·åšä¹Ÿæ˜¯ $\log$ çš„ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦è¯´è¿™ç§æ–¹æ³•ï¼Ÿæœ¬è´¨ä¸Šï¼Œæ±‚å‡ºæ•´ä¸ªåºåˆ—çš„ç¬¬ $k$ å¤§äºŒåˆ†æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ä½ å¯ä»¥ç›´æ¥äºŒåˆ†ç­”æ¡ˆã€‚ä½†å®é™…ä¸Šï¼Œåªæœ‰ä¸Šè¿°äºŒåˆ†æ–¹å¼å…·æœ‰è¾ƒå¼ºçš„<strong>å¯åˆ†æ²»æ€§</strong>ï¼Œæ¯æ¬¡å¯ä»¥ç›´æ¥èˆå¼ƒæ‰ $[L,mid]$ çš„å…¨éƒ¨å†…å®¹ï¼Œæ¯æ¬¡é—®é¢˜è§„æ¨¡éƒ½å°ä¸€åŠï¼›ä½†æ˜¾ç„¶ç›´æ¥å»äºŒåˆ†ç¬¬ $k$ å¤§ä¸å…·å¤‡è¿™ä¸ªæ€§è´¨ã€‚</p>
<p>æ‰€ä»¥ä»è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ–è®¸å¯ä»¥å¾—å‡ºä¸€äº›å¯å‘æ€§çš„åˆ†æ²»æ–¹å¼ã€‚</p>
<h1 id="rm-Part1-ç®€è¿°æ•´ä½“äºŒåˆ†"><a href="#rm-Part1-ç®€è¿°æ•´ä½“äºŒåˆ†" class="headerlink" title="$\rm Part1$ ç®€è¿°æ•´ä½“äºŒåˆ†"></a>$\rm Part1$ ç®€è¿°æ•´ä½“äºŒåˆ†</h1><p>è€ƒè™‘ç°åœ¨ç»™å®šä¸€ä¸ªåºåˆ—æœ‰ $n$ ä¸ªæ•°ï¼Œ$m$ ç»„è¯¢é—®ã€‚æ¯æ¬¡è¯¢é—®ä¸€ä¸ªåŒºé—´çš„ç¬¬ $k$ å°çš„æ•°ã€‚ å¯ä»¥ç¦»çº¿</p>
<p>è€ƒè™‘é¦–å…ˆç¦»æ•£åŒ–ï¼Œå¹¶ä¸”æŠŠåºåˆ—ä¸­ä¸€å¼€å§‹ç»™å‡ºçš„æ•°å½“ä½œæ’å…¥æ“ä½œã€‚ç„¶åï¼š</p>
<ul>
<li>1ã€æ¯æ¬¡äºŒåˆ†ï¼Œåœ¨æŠŠç­”æ¡ˆåˆ†æ²»æ‰çš„åŒæ—¶ï¼Œéœ€è¦å¯¹æ•´ä¸ªåºåˆ—çš„å…ƒç´ ä¹Ÿåˆ†æ²»ã€‚æ‰€ä»¥éœ€è¦å¯¹æ•´ä¸ªåºåˆ—è¿›è¡Œé‡æ’ï¼Œå¾ˆç®€å•åœ° $double-l$ æ‰«ä¸€éå†åˆå¹¶å°±å¯ä»¥äº†ã€‚</li>
<li>2ã€è€ƒè™‘é‡‡ç”¨ä¸Šæ–¹è¯´çš„æ–¹æ³•å»å¤„ç†æ’å…¥å’Œè¯¢é—®ã€‚å¯¹äºä¸€ä¸ªæ’å…¥æ“ä½œï¼Œå¦‚æœæ’å…¥çš„æ•°å€¼ $&lt;$ å½“å‰äºŒåˆ†çš„å€¼åŸŸçš„ $mid$ï¼Œé‚£ä¹ˆå°±ç›´æ¥æ’å…¥BITå¹¶ä¸”æ”¾åˆ°å‰ä¸€åŠï¼Œå¦åˆ™æ”¾åˆ°åä¸€åŠä¸ç®¡ï¼›å¯¹äºä¸€ä¸ªè¯¢é—®ï¼Œå¯ä»¥ç”¨æ ‘çŠ¶æ•°ç»„æ±‚å‡ºç°åœ¨åŒºé—´ $[ql,  qr]$ å†…æœ‰å¤šå°‘è¢«æ’å…¥è¿‡çš„æ•°â€”â€”æ ¹æ®ä¸Šæ–‡è®¨è®ºå¾—åˆ°çš„è§£æ³•ï¼Œè€ƒè™‘å¦‚æœ $qk$ æ¯”å½“å‰å€¼å¤§ï¼Œè¯´æ˜ä¹‹å‰è¿˜æœ‰æ¯”å½“å‰å€¼åŸŸçš„ $mid$ å¤§çš„æ•°æ²¡æœ‰è¢«æ’å…¥ï¼Œæ‰€ä»¥æŠŠå½“å‰çš„è¯¢é—®å‡å»å½“å‰çš„ $res$ åæ”¾åˆ°åä¸€åŠï¼›å¦åˆ™ä»€ä¹ˆéƒ½ä¸å¤„ç†ï¼Œæ”¾åˆ°å‰ä¸€åŠã€‚</li>
<li>3ã€è€ƒè™‘è¿™ä¹ˆåšçš„æ­£ç¡®æ€§ã€‚å‘ç°æ’å…¥æ“ä½œä¸€å®šåœ¨è¯¢é—®æ“ä½œä¹‹å‰ï¼Œæ‰€ä»¥ä¸éœ€è¦æ‹…å¿ƒè¯¢é—®æ‰‘ç©ºï¼›åŒæ—¶å‘ç°å¯¹äºä¸€ä¸ªå•ç‹¬çš„è¯¢é—®ï¼Œå®é™…ä¸Šå°±æ˜¯è¿›è¡Œäº†ä¸Šæ–‡ä¸­ç±»ä¼¼å…¨å±€äºŒåˆ†çš„æ“ä½œã€‚</li>
<li>4ã€æ¯æ¬¡ç”¨å®ŒBITè¦æ¸…é›¶ã€‚</li>
<li>5ã€så‘ç°æ¯æ¬¡å€¼åŸŸè§„æ¨¡ã€å…ƒç´ è§„æ¨¡å‡å‡åŠã€‚äºæ˜¯æœ€åå¤æ‚åº¦å°±æ˜¯ $O(m\log^2 n)$ã€‚è€Œå¦‚æœä¸€å¼€å§‹ä¸ç¦»æ•£åŒ–ï¼Œå¤æ‚åº¦å°±ä¼šå˜æˆ $O(m\log \mathrm{SIZE}\log n)$ ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸ç¦»æ•£åŒ–ä¹Ÿæ ¹æœ¬ä¸éœ€è¦æ‹…å¿ƒç©ºé—´ä¼šæŒ‚ï¼Œå› ä¸ºåœ¨åˆ†æ²»æ•´ä¸ªå€¼åŸŸçš„æ—¶å€™ï¼ŒæŠŠå€¼åŸŸä½œä¸ºåˆ†æ²»è½´å¯ä»¥ä½¿å¾—åªç”¨ä¸‹æ ‡å°±å¯ä»¥è®¡ç®—å‡ºè´¡çŒ®ã€‚</li>
</ul>
<p>ç„¶åä»¥ä¸‹æ˜¯ <code>LG3834ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘1 (ä¸»å¸­æ ‘)</code>ï¼Œè£¸çš„åŒºé—´ $k$ å°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 400010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> low(x) (x &amp; (-x))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">query</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> op, x, y, z ;</span><br><span class="line">&#125;q[MAXN], lq[MAXN], rq[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, base[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> ans[MAXN], _bit[MAXN], t[MAXN], cnt ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> ( ; p &lt;= N ; p += low(p)) _bit[p] += x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> ( ; p ; p -= low(p)) ret += _bit[p] ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> vl, <span class="keyword">int</span> vr, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (vl == vr)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (q[i].op &gt; <span class="number">0</span>) ans[q[i].op] = vl ;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> vmid = (vl + vr) &gt;&gt; <span class="number">1</span>, bl = <span class="number">0</span>, br = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!q[i].op)&#123;</span><br><span class="line">            <span class="keyword">if</span> (q[i].y &lt;= vmid)</span><br><span class="line">                upd(q[i].x, <span class="number">1</span>), lq[++ bl] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> rq[++ br] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> res = ask(q[i].y) - ask(q[i].x - <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">if</span> (res &gt;= q[i].z) lq[++ bl] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> q[i].z -= res, rq[++ br] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; " " &lt;&lt; bl &lt;&lt; " " &lt;&lt; br &lt;&lt; endl ; </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (!q[i].op &amp;&amp; q[i].y &lt;= vmid) upd(q[i].x, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= bl ; ++ i) q[l + i - <span class="number">1</span>] = lq[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= br ; ++ i) q[l + bl + i - <span class="number">1</span>] = rq[i] ;</span><br><span class="line">    solve(vl, vmid, l, l + bl - <span class="number">1</span>), solve(vmid + <span class="number">1</span>, vr, l + bl, r) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">    <span class="keyword">int</span> n, val, l, r, k ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), t[i] = base[i] ;</span><br><span class="line">    sort(t + <span class="number">1</span>, t + N + <span class="number">1</span>) ;</span><br><span class="line">    n = unique(t + <span class="number">1</span>, t + N + <span class="number">1</span>) - t - <span class="number">1</span> ;</span><br><span class="line">    <span class="comment">// for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; t[i] &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        val = lower_bound(t + <span class="number">1</span>, t + n + <span class="number">1</span>, base[i]) - t ;</span><br><span class="line">        ++ cnt, q[cnt].op = <span class="number">0</span>, q[cnt].x = i, q[cnt].y = val ;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; q[cnt].y &lt;&lt; endl ; </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;l, &amp;r, &amp;k), ++ cnt ;</span><br><span class="line">        q[cnt].op = i, q[cnt].x = l, q[cnt].y = r, q[cnt].z = k ;</span><br><span class="line">    &#125;</span><br><span class="line">    solve(<span class="number">0</span>, N * <span class="number">2</span>, <span class="number">1</span>, cnt) ;</span><br><span class="line">    <span class="comment">// for (int i = 1 ; i &lt;= N ; ++ i) cout &lt;&lt; ans[i] &lt;&lt; endl ;  </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, t[ ans[i] ]) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-Part2-å¦‚ä½•å¤„ç†ç®€å•å¸¦ä¿®"><a href="#rm-Part2-å¦‚ä½•å¤„ç†ç®€å•å¸¦ä¿®" class="headerlink" title="$\rm Part2$ å¦‚ä½•å¤„ç†ç®€å•å¸¦ä¿®"></a>$\rm Part2$ å¦‚ä½•å¤„ç†ç®€å•å¸¦ä¿®</h1><p>å‘ç°å…¶å®æ¯ä¸ªå¸¦ä¿®æ“ä½œéƒ½æ˜¯å•ç‚¹è¦†ç›–çš„è¯ï¼Œå¯ä»¥æ‹†æˆä¸€ä¸ªæ’å…¥ä¸€ä¸ªåˆ é™¤ï¼Œè€Œåˆ é™¤æ“ä½œæ˜¯BITå¯ç»´æŠ¤çš„ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ <code>bzoj#1901 Dynamic Rankings</code> ï¼Œè£¸çš„åŒºé—´ $k$ å°+å•ç‚¹æ›¿æ¢ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 500010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Inf 1000000009</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> low(x) (x &amp; (-x))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> c[<span class="number">5</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">query</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> op, x, y, z ;</span><br><span class="line">&#125;q[MAXN], lq[MAXN], rq[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, M, base[MAXN], _bit[MAXN], ans[MAXN], cnt ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> ( ; p &lt;= N ; p += low(p)) _bit[p] += x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> ( ; p ; p -= low(p)) ret += _bit[p] ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> vl, <span class="keyword">int</span> vr, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (vl == vr)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (q[i].op &gt; <span class="number">0</span>) ans[q[i].op] = vr ;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> vmid = (vl + vr) &gt;&gt; <span class="number">1</span>, bl = <span class="number">0</span>, br = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (q[i].op == <span class="number">-1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (q[i].y &lt;= vmid)</span><br><span class="line">                upd(q[i].x, <span class="number">1</span>), lq[++ bl] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> rq[++ br] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (q[i].op == <span class="number">-2</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (q[i].y &lt;= vmid)</span><br><span class="line">                upd(q[i].x, <span class="number">-1</span>), lq[++ bl] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> rq[++ br] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> res ;</span><br><span class="line">            res = ask(q[i].y) - ask(q[i].x - <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">if</span> (res &gt;= q[i].z) lq[++ bl] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> q[i].z -= res, rq[++ br] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (q[i].op == <span class="number">-1</span> &amp;&amp; q[i].y &lt;= vmid) upd(q[i].x, <span class="number">-1</span>) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (q[i].op == <span class="number">-2</span> &amp;&amp; q[i].y &lt;= vmid) upd(q[i].x, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= bl ; ++ i) q[l + i - <span class="number">1</span>] = lq[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= br ; ++ i) q[l + bl + i - <span class="number">1</span>] = rq[i] ;</span><br><span class="line">    solve(vl, vmid, l, l + bl - <span class="number">1</span>), solve(vmid + <span class="number">1</span>, vr, l + bl, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l, r, k ;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>) ;</span><br><span class="line">    <span class="built_in">cin</span>.tie(<span class="number">0</span>), <span class="built_in">cout</span>.tie(<span class="number">0</span>), <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cin</span> &gt;&gt; base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        q[++ cnt].y = base[i],</span><br><span class="line">        q[cnt].x = i, q[cnt].op = <span class="number">-1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(ans, <span class="number">-1</span>, <span class="keyword">sizeof</span>(ans)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; (c + <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (c[<span class="number">1</span>] == <span class="string">'Q'</span>)</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r &gt;&gt; k, q[++ cnt].op = i,</span><br><span class="line">            q[cnt].x = l, q[cnt].y = r, q[cnt].z = k ;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; l &gt;&gt; k ;</span><br><span class="line">            q[++ cnt].y = base[l],</span><br><span class="line">            q[cnt].x = l, q[cnt].op = <span class="number">-2</span> ;</span><br><span class="line">            q[++ cnt].y = (base[l] = k),</span><br><span class="line">            q[cnt].x = l, q[cnt].op = <span class="number">-1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    solve(-Inf, Inf, <span class="number">1</span>, cnt) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (ans[i] &gt;= <span class="number">0</span>) <span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-Part3-ä¸€é“æ‹“å±•"><a href="#rm-Part3-ä¸€é“æ‹“å±•" class="headerlink" title="$\rm Part3$ ä¸€é“æ‹“å±•"></a>$\rm Part3$ ä¸€é“æ‹“å±•</h1><blockquote>
<p>ä½ éœ€è¦ç»´æŠ¤ $n$ ä¸ªå¯é‡æ•´æ•°é›†ï¼Œé›†åˆçš„ç¼–å·ä» $1$ åˆ° $n$ã€‚<br>è¿™äº›é›†åˆåˆå§‹éƒ½æ˜¯ç©ºé›†ï¼Œæœ‰ $m$ ä¸ªæ“ä½œï¼š</p>
<p><code>1 l r c</code>ï¼šè¡¨ç¤ºå°† $c$ åŠ å…¥åˆ°ç¼–å·åœ¨ $[l,r]$ å†…çš„é›†åˆä¸­<br><code>2 l r c</code>ï¼š è¡¨ç¤ºæŸ¥è¯¢ç¼–å·åœ¨ $[l,r]$ å†…çš„é›†åˆçš„å¹¶é›†ä¸­ï¼Œç¬¬ $c$ å¤§çš„æ•°æ˜¯å¤šå°‘ã€‚</p>
</blockquote>
<p>å‘ç°è¿™ä¸œè¥¿æœ¬è´¨ä¸Šå°±æ˜¯æŠŠå•ç‚¹æ’å…¥å˜æˆäº†åŒºé—´æ’å…¥ï¼Œæ‰€ä»¥æ‹¿çº¿æ®µæ ‘ç»´æŠ¤ä¸€ä¸‹åŒºé—´å’Œå³å¯ã€‚å¹¶ä¸”ç”±äºæŸ¥è¯¢ $K$ å¤§ï¼ŒåŸæ¥çš„äºŒåˆ†æ–¹å¼éœ€è¦å¯¹ç§°ä¸€ä¸‹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 100010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Inf 1000000009</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">query</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> op, x, y ; LL z ;</span><br><span class="line">&#125;q[MAXN], lq[MAXN], rq[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, M, base[MAXN], ans[MAXN], cnt ;</span><br><span class="line"></span><br><span class="line">LL s[MAXN &lt;&lt; <span class="number">2</span>], cov[MAXN &lt;&lt; <span class="number">2</span>], tag[MAXN &lt;&lt; <span class="number">2</span>] ;</span><br><span class="line"></span><br><span class="line">il <span class="keyword">void</span> _up(<span class="keyword">int</span> rt)&#123; s[rt] = s[rt &lt;&lt; <span class="number">1</span>] + s[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] ; &#125;</span><br><span class="line">il <span class="keyword">void</span> _down(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (cov[rt])&#123;</span><br><span class="line">        tag[rt &lt;&lt; <span class="number">1</span>] = s[rt &lt;&lt; <span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">        tag[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = s[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">        cov[rt &lt;&lt; <span class="number">1</span>] = cov[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="number">1</span>, cov[rt] = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tag[rt])&#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">        tag[rt &lt;&lt; <span class="number">1</span>] += tag[rt] ;</span><br><span class="line">        tag[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += tag[rt] ;</span><br><span class="line">        s[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += <span class="number">1l</span>l * (r - mid) * tag[rt] ;</span><br><span class="line">        s[rt &lt;&lt; <span class="number">1</span>] += <span class="number">1l</span>l * (mid - l + <span class="number">1</span>) * tag[rt] ;</span><br><span class="line">        tag[rt] = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= ul &amp;&amp; r &lt;= ur)</span><br><span class="line">        <span class="keyword">return</span> tag[rt] += v,</span><br><span class="line">               s[rt] += v * (r - l + <span class="number">1</span>), <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt, l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, l, mid, ul, ur, v) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid) update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ul, ur, v) ;</span><br><span class="line">    _up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= ql &amp;&amp; r &lt;= qr) <span class="keyword">return</span> s[rt] ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; LL res = <span class="number">0</span> ; _down(rt, l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= mid) res += query(rt &lt;&lt; <span class="number">1</span>, l, mid, ql, qr) ;</span><br><span class="line">    <span class="keyword">if</span> (qr &gt; mid) res += query(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ql, qr) ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> vl, <span class="keyword">int</span> vr, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (vl == vr)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (q[i].op &gt; <span class="number">0</span>) ans[q[i].op] = vr ;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    cov[<span class="number">1</span>] = <span class="number">1</span>, tag[<span class="number">1</span>] = s[<span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">int</span> vmid = (vl + vr) &gt;&gt; <span class="number">1</span>, bl = <span class="number">0</span>, br = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!q[i].op)&#123;</span><br><span class="line">            <span class="keyword">if</span> (q[i].z &gt; vmid)</span><br><span class="line">                update(<span class="number">1</span>, <span class="number">1</span>, N, q[i].x, q[i].y, <span class="number">1</span>), rq[++ br] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> lq[++ bl] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            LL res ;</span><br><span class="line">            res = query(<span class="number">1</span>, <span class="number">1</span>, N, q[i].x, q[i].y) ;</span><br><span class="line">            <span class="keyword">if</span> (res &gt;= q[i].z) rq[++ br] = q[i] ;</span><br><span class="line">            <span class="keyword">else</span> q[i].z -= res, lq[++ bl] = q[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= bl ; ++ i) q[l + i - <span class="number">1</span>] = lq[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= br ; ++ i) q[l + bl + i - <span class="number">1</span>] = rq[i] ;</span><br><span class="line">    solve(vl, vmid, l, l + bl - <span class="number">1</span>), solve(vmid + <span class="number">1</span>, vr, l + bl, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    LL op, l, r, k ;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>) ;</span><br><span class="line">    <span class="built_in">cin</span>.tie(<span class="number">0</span>), <span class="built_in">cout</span>.tie(<span class="number">0</span>), <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; q[i].op &gt;&gt; q[i].x &gt;&gt; q[i].y &gt;&gt; q[i].z ;</span><br><span class="line">        <span class="keyword">if</span> (q[i].op == <span class="number">1</span>) q[i].op = <span class="number">0</span> ; <span class="keyword">else</span> q[i].op = ++ cnt ;</span><br><span class="line">    &#125;</span><br><span class="line">    solve(-N, N, <span class="number">1</span>, M) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i) <span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>æ•´ä½“äºŒåˆ†</category>
      </categories>
      <tags>
        <tag>ç¦»çº¿ç®—æ³•/æ•´ä½“äºŒåˆ†</tag>
        <tag>æ•°æ®ç»“æ„/æ ‘çŠ¶æ•°ç»„</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘bzoj#4044 [CERC2014]Virus Synthesis</title>
    <url>/2020/01/16/CERC2014-Virus-synthesis/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>åˆå§‹æœ‰ä¸€ä¸ªç©ºä¸²ï¼Œåˆ©ç”¨ä¸‹é¢çš„æ“ä½œæ„é€ ç»™å®šä¸² $\rm S$ ã€‚</p>
<p>1ã€ä¸²å¼€å¤´æˆ–æœ«å°¾åŠ ä¸€ä¸ªå­—ç¬¦</p>
<p>2ã€ä¸²å¼€å¤´æˆ–æœ«å°¾åŠ ä¸€ä¸ªè¯¥ä¸²çš„é€†ä¸²</p>
<p>æ±‚æœ€å°åŒ–æ“ä½œæ•°ï¼Œ $\rm |S| \leq 10^5$ã€‚</p>
</blockquote>
<p>dpæ˜¯ä¸å¯èƒ½ä¼šçš„ï¼Œè¿™è¾ˆå­éƒ½ä¸ä¼šäº†QAQ</p>
<a id="more"></a>
<p>é¦–å…ˆé¢„å¤„ç†å¤„ä¸Šä¸€ç¯‡ $blog$ é‡Œçš„ $fail$ å’Œ $failâ€™$ã€‚</p>
<p>ç„¶åå¼€å§‹<del>ä¸ä¼š</del>dpã€‚å‘ç°å¯¹äºPAMé‡Œæ¯ä¸ªçŠ¶æ€ $x$ï¼Œéƒ½å¯ä»¥ç”± $failâ€™(x)$ æ¨å‡ºã€‚åŸå› æ˜¯ $failâ€™(x)$ ä½œä¸ºåŠå¤±é…æŒ‡é’ˆï¼ˆåå­—è‡ªå·±èµ·çš„233ï¼‰ï¼Œæ­£å¥½æ»¡è¶³å¤åˆ¶ä¸€éçš„éœ€æ±‚ã€‚äºæ˜¯è€ƒè™‘è½¬ç§»ï¼š</p>
<script type="math/tex; mode=display">
f_u=\min(f_{pre_u}+1,f_{fail'(u)}+(\frac{len_u}{2} - len_{fail'(u)}+1))</script><p>å‰åŠéƒ¨åˆ†ç”±äºæˆ‘ä»¬å¯ä»¥æŠŠåŠ ä¸€ä¸ªå­—ç¬¦æ”¾åˆ°å‰é¢å»æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥ $+1$ è€Œä¸ç”¨ $+2$ ã€‚ ååŠéƒ¨åˆ†ç”±äºåŠå¤±é…æŒ‡é’ˆçš„æœ€ä¼˜æ€§å¯ä»¥ç›´æ¥è½¬ç§»ã€‚</p>
<p>è¿™æ ·å°±åšå®Œäº†ï¼Œè€ƒè™‘æœ€åä¸€å®šæ˜¯ä¸€ä¸ªé•¿å›æ–‡ä¸²åŠ ä¸Šä¸€å †ä¸‹è„šæ–™ï¼ˆåŸå› æ˜¯é¢˜ç›®è¦æ±‚ä¸èƒ½å¤šä¸²ä¸€èµ·ç”Ÿæˆï¼Œåªèƒ½ç»´æŠ¤ä¸€ä¸ªå›æ–‡ä¸²ï¼Œæ‰€ä»¥ä¸èƒ½æŠŠä¸¤ä¸ªå›æ–‡ä¸²æ‹¼èµ·æ¥ä¹‹ç±»çš„ï¼‰ã€‚æ‰€ä»¥ç»´æŠ¤ç­”æ¡ˆä¹Ÿå¾ˆå¥½ç»´æŠ¤ã€‚</p>
<p>æŒ‰ç§©è½¬ç§»çš„è¯ï¼Œbfsä¸€éå°±å®Œäº†</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> S[MAXN] ;</span><br><span class="line"><span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line"><span class="keyword">int</span> N, C, ans, dp[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PAM</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> val[<span class="number">300</span>], vis[MAXN] ;</span><br><span class="line">    <span class="keyword">int</span> rt0, rt1, sz, last, f[MAXN] ;</span><br><span class="line">    <span class="keyword">int</span> trans[MAXN][<span class="number">4</span>], fail[MAXN], len[MAXN] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        sz = <span class="number">-1</span> ;</span><br><span class="line">        val[<span class="string">'A'</span>] = <span class="number">0</span>, val[<span class="string">'C'</span>] = <span class="number">1</span>,</span><br><span class="line">        val[<span class="string">'G'</span>] = <span class="number">2</span>, val[<span class="string">'T'</span>] = <span class="number">3</span> ;</span><br><span class="line">        rt0 = ++ sz, rt1 = ++ sz ;</span><br><span class="line">        len[rt0] = <span class="number">0</span>, len[rt1] = <span class="number">-1</span> ;</span><br><span class="line">        fail[last = rt0] = fail[rt1] = rt1 ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Ins</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> pos)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p = last, q, np, nq ;</span><br><span class="line">        <span class="keyword">while</span> (S[pos] != S[pos - len[p] - <span class="number">1</span>]) p = fail[p] ;</span><br><span class="line">        <span class="keyword">if</span> (!trans[p][x])&#123;</span><br><span class="line">            np = ++ sz, q = fail[p] ;</span><br><span class="line">            <span class="keyword">while</span> (S[pos] != S[pos - len[q] - <span class="number">1</span>]) q = fail[q] ;</span><br><span class="line">            len[np] = len[p] + <span class="number">2</span>, fail[np] = trans[q][x], trans[p][x] = np ;</span><br><span class="line">            nq = f[p] ; <span class="keyword">if</span> (len[np] &lt;= <span class="number">2</span>) f[np] = fail[np] ;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (S[pos] != S[pos - len[nq] - <span class="number">1</span>] || len[nq] + <span class="number">2</span> &gt; (len[np] &gt;&gt; <span class="number">1</span>))</span><br><span class="line">                nq = fail[nq] ; f[np] = trans[nq][x] ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        last = trans[p][x] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>, ans = N, q.push(<span class="number">0</span>), vis[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">            <span class="keyword">int</span> x = q.front() ; q.pop() ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= <span class="number">3</span> ; ++ i)&#123;</span><br><span class="line">                <span class="keyword">if</span> (!trans[x][i]) <span class="keyword">continue</span> ;</span><br><span class="line">                <span class="keyword">int</span> y = trans[x][i] ; dp[y] = dp[x] + <span class="number">1</span> ;</span><br><span class="line">                dp[y] = min(dp[y], dp[f[y]] + len[y] / <span class="number">2</span> - len[f[y]] + <span class="number">1</span>) ;</span><br><span class="line">                ans = min(ans, dp[y] + N - len[y]) ; <span class="keyword">if</span> (!vis[y]) q.push(y), vis[y] = <span class="number">1</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= sz ; ++ i) vis[i] = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;T ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; C ;</span><br><span class="line">    <span class="keyword">while</span> (C --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, S + <span class="number">1</span>),</span><br><span class="line">        N = <span class="built_in">strlen</span>(S + <span class="number">1</span>), T.Init() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">            T.Ins(T.val[(<span class="keyword">int</span>)S[i]], i) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= T.sz ; ++ i) dp[i] = T.len[i] ;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; ans &lt;&lt; " " &lt;&lt; T.sz &lt;&lt; endl ;</span></span><br><span class="line">        T.bfs() ; <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans) ; ans = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= T.sz ; ++ i) </span><br><span class="line">          <span class="built_in">memset</span>(T.trans[i], <span class="number">0</span>, <span class="keyword">sizeof</span>(T.trans[i])) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>dpdpdpdpdpdpdpdpdpdpä¸ä¼šä¸ä¼šä¸ä¼šä¸ä¼šå¥½çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦çƒ¦å•ŠQAQ</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>BZOJ</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/è‡ªåŠ¨æœºä¸ŠDP</tag>
        <tag>å­—ç¬¦ä¸²/å›æ–‡è‡ªåŠ¨æœº,PAM</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘loj#2579[SHOI2011]åŒå€å›æ–‡</title>
    <url>/2020/01/16/SHOI2011-%E5%8F%8C%E5%80%8D%E5%9B%9E%E6%96%87/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸€é“PAMæ€ç»´é¢˜â€¦</p>
<p>åƒæˆ‘è¿™ç§åªä¼šå†™æ¿å­ã€è«å¾—è„‘å­çš„é€‰æ‰‹æ³¨å®šè¦æŒ¨æ‰“å•Š/kk</p>
<p>é¢˜é¢ç®€è¿°ï¼š</p>
<blockquote>
<p>ç»™å®šä¸€ä¸ªä¸² $\rm S$ï¼Œæ±‚è¯¥ä¸²æœ€é•¿çš„ã€ŒåŒå€å›æ–‡å­ä¸²ã€ã€‚ã€ŒåŒå€å›æ–‡ã€æŒ‡çš„æ˜¯è¿™ä¹ˆä¸€ç§å­ä¸²ï¼šè‡ªèº«å›æ–‡ï¼Œä¸”å‰åŠéƒ¨åˆ†ã€ååŠéƒ¨åˆ†å‡å›æ–‡ã€‚</p>
<p>$\rm |S|\leq 10^6$</p>
</blockquote>
<a id="more"></a>
<p>è€ƒè™‘PAMã€‚ä½†å‘ç°ä¼¼ä¹ä¸æ˜¯å¾ˆå¥½åšï¼Œå› ä¸ºæ¯æ¬¡è½¬ç§»æ˜¯åƒä¸²çš„ä¸¤ç«¯å„åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œæœ‰ç‚¹ggã€‚ä½†æ˜¯ä»”ç»†æ€è€ƒå°±ä¼šå‘ç°ï¼ŒPAMçš„ $fail$ å®é™…æŒ‡å‘çš„æ˜¯æœ€é•¿çš„å›æ–‡åç¼€ï¼Œè€Œæˆ‘ä»¬çš„æ‰€æ±‚ä¹Ÿæ˜¯è¿™ä¹ˆä¸€ä¸ªå›æ–‡åç¼€çš„å½¢å¼ï¼Œåªä¸è¿‡é™åˆ¶äº†é•¿åº¦ã€‚</p>
<p>æ‰€ä»¥è€ƒè™‘æ±‚PAMçš„æ—¶å€™é¡ºä¾¿ç»´æŠ¤å¦ä¸€ä¸ª $failâ€™$ï¼Œå…¶æ„ä¹‰æ˜¯ã€Œä¸è¶…è¿‡å½“å‰ä¸²é•¿ä¸€åŠçš„å›æ–‡åç¼€ã€ã€‚</p>
<p>æ€è€ƒåŸæ¥PAMçš„æ„é€ æ–¹å¼ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> _insert(PAM &amp;p, <span class="keyword">int</span> x, <span class="keyword">int</span> pos, <span class="keyword">char</span> *s)&#123;</span><br><span class="line">	<span class="keyword">int</span> u = p.last ; </span><br><span class="line">	<span class="keyword">while</span> (s[pos - p.len[u] - <span class="number">1</span>] != s[pos]) u = p.fail[u] ; </span><br><span class="line">	<span class="keyword">if</span> (!p.trie[u][x])&#123;</span><br><span class="line">		<span class="keyword">int</span> fa = p.fail[u] ;</span><br><span class="line">		<span class="keyword">int</span> newn = ++ p.sz ; </span><br><span class="line">		p.len[newn] = p.len[u] + <span class="number">2</span> ; </span><br><span class="line">		<span class="keyword">while</span> (s[pos - p.len[fa] - <span class="number">1</span>] != s[pos]) fa = p.fail[fa] ; </span><br><span class="line">		p.fail[newn] = p.trie[fa][x], p.trie[u][x] = newn ;</span><br><span class="line">	&#125;</span><br><span class="line">	p.last = p.trie[u][x] ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ç±»æ¨å‡ºæ–°çš„æ„é€ ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Ins</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> pos)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p = last, q, np, nq ;</span><br><span class="line">        <span class="keyword">while</span> (S[pos] != S[pos - len[p] - <span class="number">1</span>]) p = fail[p] ;</span><br><span class="line">        <span class="keyword">if</span> (!trans[p][x])&#123;</span><br><span class="line">            np = ++ sz, q = fail[p] ;</span><br><span class="line">            <span class="keyword">while</span> (S[pos] != S[pos - len[q] - <span class="number">1</span>]) q = fail[q] ;</span><br><span class="line">            len[np] = len[p] + <span class="number">2</span>, fail[np] = trans[q][x], trans[p][x] = np ;</span><br><span class="line">            nq = f[p] ; <span class="keyword">if</span> (len[np] &lt;= <span class="number">2</span>) f[np] = fail[np] ;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (S[pos] != S[pos - len[nq] - <span class="number">1</span>] || len[nq] + <span class="number">2</span> &gt; (len[np] &gt;&gt; <span class="number">1</span>))</span><br><span class="line">                nq = fail[nq] ; f[np] = trans[nq][x] ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        last = trans[p][x] ;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸œè¥¿å”¯ä¸€çš„ä¸åŒå°±æ˜¯å¤šäº†ä¸€ä¸ªæ‰¾ $failâ€™$ çš„è¿‡ç¨‹ã€‚é¦–å…ˆå¦‚æœå½“å‰çš„ $\rm len\leq 2$ é‚£ä¹ˆå°±åº”è¯¥æ˜¯ $fail$ï¼ˆæ¯•ç«Ÿéƒ½æ˜¯1ä¸ªå­—æ¯ï¼‰  ï¼Œå¦åˆ™å°±å‘ä¸Šè·³ç€æ‰¾ã€‚</p>
<p>å¤æ‚åº¦è¯æ˜ï¼šå› è·³è·³ $fail$ çš„å¤æ‚åº¦æ˜¯å¯¹çš„æ‰€ä»¥è·³ $failâ€™$ ä¹Ÿæ˜¯å¯¹çš„ï¼ˆé›¾</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> (S[pos] != S[pos - len[nq] - <span class="number">1</span>] || len[nq] + <span class="number">2</span> &gt; (len[np] &gt;&gt; <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€å¥é‡Œç¬¬äºŒä¸ªåˆ¤æ–­å¾ˆå®¹æ˜“å†™é”™ã€‚å› ä¸ºå®é™…ä¸Šæˆ‘ä»¬è·³çš„ $fail$ æ˜¯æœªæ‰©å±•ä¹‹å‰çš„ï¼Œè¿™ä¸€ç‚¹ä» <code>S[pos] != S[pos - len[nq] - 1]</code> è¿™ä¸€å¥å°±å¯ä»¥æ˜æ˜¾åœ°çœ‹å‡ºæ¥ã€‚æ‰€ä»¥å¦‚æœè¦æ¯”è¾ƒçš„è¯ï¼Œåº”è¯¥ $+2$ ä¹‹åå†æ¯”è¾ƒã€‚</p>
<p>äºæ˜¯ä¸ºäº†æ°´å­—æ•°è´´ä¸ªä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; (S + <span class="number">1</span>) ; P.Init() ; <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) P.Ins(S[i] - <span class="string">'a'</span> + <span class="number">1</span>, i) ;</span><br><span class="line"><span class="comment">//    for (i = 1 ; i &lt;= P.sz ; ++ i) cout &lt;&lt; P.len[i] &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= P.sz ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (P.len[i] == (P.len[P.f[i]] &lt;&lt; <span class="number">1</span>) &amp;&amp; (P.len[i] % <span class="number">4</span> == <span class="number">0</span>))</span><br><span class="line">            ans = max(ans, P.len[i]) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶å®æœ¬è´¨ä¸Šä¹Ÿä¸ç®—ä¸€é“éš¾é¢˜ï¼Œå¯¹å§ï¼Ÿ</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>loj</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ä¸²/PAM,å›æ–‡è‡ªåŠ¨æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ /å‡ºé¢˜ç¬”è®°ã€‘å¤±é…æ ‘çå¹</title>
    <url>/2020/01/16/%E5%A4%B1%E9%85%8D%E6%A0%91/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>åŸå› æ˜¯åš <code>[POI2005]SZA-Template</code> è¿™é¢˜æ—¶æ–°å­¦äº†failæ ‘ï¼Œè§‰å¾—å¾ˆç¥çš„äºšå­233.</p>
<p>å…¶å®æœ¬è´¨ä¸Šå°±æ˜¯å¯¹äºæ¯ä¸ªå‰ç¼€ $i$ ï¼Œå‘ $\mathrm{fail}_i$ è¿ä¸€æ¡è¾¹ï¼Œå¯ä»¥çŸ¥é“è¿™æ ·è¿å‡ºæ¥çš„ä¸€å®šæ˜¯ä¸€æ£µ $root$ ä¸º $0$ çš„æ ‘ã€‚</p>
<a id="more"></a>
<h1 id="1-LG5829-ã€æ¨¡æ¿ã€‘å¤±é…æ ‘"><a href="#1-LG5829-ã€æ¨¡æ¿ã€‘å¤±é…æ ‘" class="headerlink" title="$1$ LG5829 ã€æ¨¡æ¿ã€‘å¤±é…æ ‘"></a>$1$ LG5829 ã€æ¨¡æ¿ã€‘å¤±é…æ ‘</h1><p>å½“å½“å½“å½“ï¼æ˜¯æˆ‘å‡ºçš„é¢˜å•¦~</p>
<blockquote>
<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² $s$ï¼Œå®šä¹‰å®ƒçš„ <strong>$k$ å‰ç¼€</strong> $pre_k$ ä¸ºå­—ç¬¦ä¸² $s_{1\dots k}$ï¼Œ<strong>$k$ åç¼€</strong> $suf_k$ ä¸ºå­—ç¬¦ä¸² $s_{|s|-k+1\dots |s|}$ï¼Œå…¶ä¸­ $1 \le k \le |s|$ã€‚</p>
<p>å®šä¹‰ $\boldsymbol{Border}(s)$ ä¸º<strong>å¯¹äº $i \in [1, |s|)$ï¼Œæ»¡è¶³ $pre_i = suf_i$</strong> çš„å­—ç¬¦ä¸² $pre_i$ çš„é›†åˆã€‚$\boldsymbol{Border}(s)$ ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½ç§°ä¹‹ä¸ºå­—ç¬¦ä¸² $s$ çš„ $\operatorname{border}$ã€‚</p>
<p>æœ‰ $m$ ç»„è¯¢é—®ï¼Œæ¯ç»„è¯¢é—®ç»™å®š $p,q$ï¼Œæ±‚ $s$ çš„ <strong>$\boldsymbol{p}$ å‰ç¼€</strong> å’Œ <strong>$\boldsymbol{q}$ å‰ç¼€</strong> çš„ <strong>æœ€é•¿å…¬å…± $\operatorname{border}$</strong>  çš„é•¿åº¦ã€‚</p>
</blockquote>
<p>å‘ç°å…¶å®ï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œä»æ ¹åˆ°æŸä¸ªç‚¹çš„è·¯ä¸Šçš„æ‰€æœ‰ç‚¹ï¼Œä¸€å®šéƒ½æ˜¯å®ƒçš„ $border$ã€‚æ‰€ä»¥å°±å˜æˆäº† $lca$ å‚»é¢˜ã€‚ç„¶è€Œå› ä¸º $border$ å®šä¹‰çš„æ—¶å€™ä¸åŒ…å«æ•´ä¸ªä¸²ï¼Œäºæ˜¯å†åˆ¤ä¸€ä¸‹ä¸€ä¸ªæ˜¯ä¸æ˜¯å¦ä¸€ä¸ª $border$ å³å¯ã€‚</p>
<p>å’‹è¯´å‘¢ï¼Œã€Œåˆ¤æ–­ä¸€ä¸ªç‚¹åœ¨ä¸åœ¨å¦ä¸€ä¸ªç‚¹çš„å­æ ‘ä¸­ã€ï¼Œæ¥åˆ°è¿™ä¸ªé—®é¢˜æˆ‘å±…ç„¶æ„£äº†å‡ ç§’æ‰æƒ³èµ·ç”¨ $dfs$ åºæï¼Œwtclã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> ONLINE_JUDGE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> freopen(a, b, c)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 1000005</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IPT &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">1000000</span>;</span><br><span class="line">  <span class="keyword">char</span> buf[L], *front=buf, *end=buf;</span><br><span class="line">  <span class="function"><span class="keyword">char</span> <span class="title">GetChar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (front == end) &#123;</span><br><span class="line">      end = buf + fread(front = buf, <span class="number">1</span>, L, <span class="built_in">stdin</span>);</span><br><span class="line">      <span class="keyword">if</span> (front == end) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> *(front++);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">qr</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> ch = IPT::GetChar(), lst = <span class="string">' '</span>;</span><br><span class="line">  <span class="keyword">while</span> ((ch &gt; <span class="string">'9'</span>) || (ch &lt; <span class="string">'0'</span>)) lst = ch, ch=IPT::GetChar();</span><br><span class="line">  <span class="keyword">while</span> ((ch &gt;= <span class="string">'0'</span>) &amp;&amp; (ch &lt;= <span class="string">'9'</span>)) x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + (ch ^ <span class="number">48</span>), ch = IPT::GetChar();</span><br><span class="line">  <span class="keyword">if</span> (lst == <span class="string">'-'</span>) x = -x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OPT &#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">120</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">qw</span><span class="params">(T x, <span class="keyword">const</span> <span class="keyword">char</span> aft, <span class="keyword">const</span> <span class="keyword">bool</span> pt)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123;x = -x, <span class="built_in">putchar</span>(<span class="string">'-'</span>);&#125;</span><br><span class="line">  <span class="keyword">int</span> top=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123;OPT::buf[++top] = <span class="keyword">static_cast</span>&lt;<span class="keyword">char</span>&gt;(x % <span class="number">10</span> + <span class="string">'0'</span>);&#125; <span class="keyword">while</span> (x /= <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">while</span> (top) <span class="built_in">putchar</span>(OPT::buf[top--]);</span><br><span class="line">  <span class="keyword">if</span> (pt) <span class="built_in">putchar</span>(aft);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ReadStr</span><span class="params">(<span class="keyword">char</span> *p)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> beg = p;</span><br><span class="line">  <span class="keyword">do</span> *(++p) = IPT::GetChar(); <span class="keyword">while</span> ((*p &gt;= <span class="string">'a'</span>) &amp;&amp; (*p &lt;= <span class="string">'z'</span>));</span><br><span class="line">  *p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> p - beg - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next ;</span><br><span class="line">&#125;E[MAXN] ; <span class="keyword">char</span> S[MAXN] ; <span class="keyword">int</span> fa[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> head[MAXN], dfn[MAXN], son[MAXN], cnt, tot ;</span><br><span class="line"><span class="keyword">int</span> H, N, M, dep[MAXN], fail[MAXN], sz[MAXN], top[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    E[++ cnt].to = v, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    sz[u] = <span class="number">1</span>, dep[u] = dep[fa[u]] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))&#123;</span><br><span class="line">        fa[to(k)] = u, dfs(to(k)), sz[u] += sz[to(k)] ;</span><br><span class="line">        <span class="keyword">if</span> (!son[u] || sz[to(k)] &gt; sz[son[u]]) son[u] = to(k) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> tp)</span></span>&#123;</span><br><span class="line">    top[u] = tp, dfn[u] = ++ tot ;</span><br><span class="line">    <span class="keyword">if</span> (son[u]) dfs2(son[u], tp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))</span><br><span class="line">        <span class="keyword">if</span> (to(k) != son[u]) dfs2(to(k), to(k)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="comment">// qw(u, '\n', true), qw(v, '\n', true) ;</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; u &lt;&lt; " " &lt;&lt; v &lt;&lt; endl ; </span></span><br><span class="line">    <span class="keyword">while</span> (top[u] != top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[top[u]] &gt;= dep[top[v]]) u = fa[top[u]] ;</span><br><span class="line">        <span class="keyword">else</span> v = fa[top[v]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[u] &lt; dep[v] ? u : v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    freopen(<span class="string">"1.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    <span class="keyword">int</span> i, j = <span class="number">0</span> ;</span><br><span class="line">    N = ReadStr(S), qr(M) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (j &amp;&amp; S[j + <span class="number">1</span>] != S[i]) j = fail[j] ;</span><br><span class="line">        <span class="keyword">if</span> (S[j + <span class="number">1</span>] == S[i]) fail[i] = ++ j ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) add(fail[i], i) ;</span><br><span class="line">    dfs(<span class="number">0</span>) ; dfs2(<span class="number">0</span>, <span class="number">0</span>) ; <span class="keyword">int</span> p, q ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        p = <span class="number">0</span>, q = <span class="number">0</span>, qr(p), qr(q) ;</span><br><span class="line">        <span class="keyword">int</span> ans = lca(p, q) ;</span><br><span class="line">        <span class="keyword">if</span> (dep[p] &gt; dep[q]) swap(p, q) ;</span><br><span class="line">        <span class="keyword">if</span> (dfn[q] &gt;= dfn[p] &amp;&amp; dfn[q] &lt;= dfn[p] + sz[p] - <span class="number">1</span>) ans = fa[ans] ;</span><br><span class="line">        qw(ans, <span class="string">'\n'</span>, <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é•¿é•¿çš„ <code>Read</code> æ˜¯å«–çš„zayçš„233ï¼Œæ”¾åˆ°è¿™é‡Œç®—æ˜¯çºªå¿µä¸€ä¸‹ä»–å¸®æˆ‘éªŒé¢˜å§ï¼</p>
<h1 id="2-NOI2014-åŠ¨ç‰©å›­"><a href="#2-NOI2014-åŠ¨ç‰©å›­" class="headerlink" title="$2$ [NOI2014] åŠ¨ç‰©å›­"></a>$2$ [NOI2014] åŠ¨ç‰©å›­</h1><blockquote>
<p>å®šä¹‰ $num[i]$ ä¸ºå­—ç¬¦ä¸² $S$ çš„å‰ç¼€ $S[1\sim i]$ ä¸­ä¸é‡å çš„ç›¸åŒå‰åç¼€çš„ä¸ªæ•°ã€‚ç»™å®š $S$ï¼Œæ±‚æ‰€æœ‰ $(num[i]+1)$ çš„ä¹˜ç§¯ã€‚$L\leq 10^6$</p>
</blockquote>
<p>å‘ç°å…¶å®å°±æ˜¯ $fail$ æ ‘ä¸Šï¼Œè¿™ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„ä¸Šæ‰€æœ‰ $\leq \frac{L_{now}}{2}$ çš„ç‚¹çš„ç¼–å·å’Œã€‚</p>
<p>è¿™ä¸œè¥¿ï¼Œé‚£ä¸æ˜¯éšä¾¿åšï¼Ÿä½ å¯ä»¥éšä¾¿ä¸Šè«é˜Ÿï¼Œä½†æ˜¯æ˜¾ç„¶è¿‡ä¸å»ï¼›ä½ å¯ä»¥ç›´æ¥å‰–ï¼Œå¯èƒ½ä¹Ÿä¸å¤ªè¿‡å¾—å»â€¦ä¸è¿‡å‘ç°ï¼Œæ—¢ç„¶ç»´æŠ¤ä¸€ä¸ªç‚¹åˆ°æ ¹çš„ä¿¡æ¯ï¼Œé‚£å¯ä»¥ç›´æ¥ç”¨æ ˆç»´æŠ¤é“¾+dfs=ç¨³å¾—å¾ˆã€‚æ‰€ä»¥ä¸€çœ¼è‚¯å®šæ˜¯äºŒåˆ†ï¼Œä¸è¿‡éœ€è¦å¸¦ä¸ª $\log$ã€‚</p>
<p>è¿™ä¸ªåœ°æ–¹æœ‰ä¸€ä¸ªå¾ˆnbçš„trickï¼Œå¯ä»¥åšåˆ° $O(n)$ã€‚æ ¹æ®ã€ŒäºŒåˆ†æœ‰å¯èƒ½å¯ä»¥two-pointersã€çš„ç»å…¸ç†è®ºï¼Œå‘ç°éšç€æ·±åº¦é€’å¢ï¼Œæ ˆå†…å¯è¡Œçš„ç‚¹ä¸é™ã€‚äºæ˜¯ç”¨æ ˆå»æ›´æ–°å­æ ‘ä¿¡æ¯å³å¯ã€‚å¤æ‚åº¦ $O(n)$ ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    (ans *= <span class="number">1l</span>l * (res + <span class="number">1</span>)) %= Mod ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x], r ; k ; k = next(k))&#123;</span><br><span class="line">        stk[++ tp] = to(k), r = res ;</span><br><span class="line">        <span class="keyword">while</span> (stk[res + <span class="number">1</span>] * <span class="number">2</span> &lt;= to(k)) ++ res ;</span><br><span class="line">        dfs(to(k)) ; stk[tp --] = <span class="number">0</span>, res = r ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        cnt = <span class="number">0</span> ;</span><br><span class="line">        <span class="built_in">memset</span>(fail, <span class="number">0</span>, <span class="keyword">sizeof</span>(fail)) ;</span><br><span class="line">        <span class="built_in">memset</span>(head, <span class="number">0</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, S + <span class="number">1</span>), N = <span class="built_in">strlen</span>(S + <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, j = <span class="number">0</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">while</span> (j &amp;&amp; S[j + <span class="number">1</span>] != S[i]) j = fail[j] ;</span><br><span class="line">            <span class="keyword">if</span> (S[j + <span class="number">1</span>] == S[i]) fail[i] = ++ j ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) add(fail[i], i) ;</span><br><span class="line">        ans = <span class="number">1</span>, res = <span class="number">0</span>, dfs(<span class="number">0</span>) ; <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-POI2005-SZA-Template"><a href="#3-POI2005-SZA-Template" class="headerlink" title="$3$ [POI2005] SZA-Template"></a>$3$ [POI2005] SZA-Template</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªä¸²ï¼Œæ±‚ä¸€ä¸ªæœ€å°çš„é•¿åº¦ï¼Œä½¿å¾—è¯¥é•¿åº¦çš„å‰ç¼€å¯ä»¥é€šè¿‡å¾ªç¯è¦†ç›–è¦†ç›–æ•´ä¸ªä¸²ã€‚åŒä¸€ä¸ªä½ç½®çš„å­—ç¬¦å¯ä»¥è¦†ç›–å¤šæ¬¡ã€‚æ¯”å¦‚ <code>ababa</code> å°±å¯ä»¥è¢« <code>aba</code> è¦†ç›–æ‰ã€‚</p>
<p>$L\leq 10^6$</p>
</blockquote>
<p>å¾ˆç¥çš„ä¸€é“é¢˜233</p>
<p>è€ƒè™‘å…ˆå»ºå‡º $fail$ æ ‘æ¥ï¼Œé‚£ä¹ˆå¯èƒ½æˆä¸ºç­”æ¡ˆçš„ä¸€å®šæ˜¯ $0\sim n$ è¿™ä¸€æ¡é“¾ä¸Šçš„ç‚¹ï¼Œäºæ˜¯æ‰“æ ‡è®°ã€‚åŒæ—¶è€ƒè™‘ï¼Œå¯¹äºä¸€ä¸ª $border$ ï¼Œåªæœ‰ä¸¤ä¸ª $border$ ç»“å°¾å­—ç¬¦çš„è·ç¦» $\leq$ è¯¥ $border$ çš„é•¿åº¦æ‰æœ‰å¯èƒ½è¢«ç®—å…¥ç­”æ¡ˆã€‚</p>
<p>è€ƒè™‘æ€ä¹ˆç»´æŠ¤è¿™ä¸ªä¸œè¥¿ï¼Œå‘ç°å¯¹äºä¸€æ®µå‰ç¼€ $[1â€¦.i]$ï¼Œä»–çš„æ‰€æœ‰ç»ˆç‚¹éƒ½åœ¨ä»–çš„å­æ ‘ä¸­ã€‚äºæ˜¯åªéœ€è¦çŸ¥é“ï¼Œå­æ ‘ä¸­ç›¸é‚»çš„ç‚¹ï¼Œç¼–å·å·®çš„æœ€å¤§å€¼ï¼Œå°±å¯ä»¥åˆ¤æ–­æ˜¯å¦åˆæ³•ã€‚å‘ç°è¿™ä¸œè¥¿å¯ä»¥ç›´æ¥æ±‚å‰é©±å’Œåç»§ï¼Œæ®è¯´æœ‰ä¸€ç§æš´åŠ›å¯ä»¥æ‹¿å¹³è¡¡æ ‘å»ç»´æŠ¤ï¼Œç„¶è€Œä¸æ˜¯å¾ˆæ‡‚.jpg</p>
<p>è€ƒè™‘ä»ä¸Šåˆ°ä¸‹éå†è¿™æ£µæ ‘ï¼Œé‚£ä¹ˆä¸æ–­åˆ é™¤ä¸åœ¨è·¯å¾„ä¸Šçš„å­æ ‘ï¼Œæ›´æ–°ç­”æ¡ˆå³å¯ã€‚</p>
<p>æ€è€ƒäº†åŠå¤©ï¼Œä¸€ç›´è§‰å¾—è¿™ä¸ªç®—æ³•çœ‹ä¸å¤ªé€ã€‚ä½†ä¼¼ä¹ç¨å¾®æ‰‹ç©/æ€è€ƒä¸€ä¸‹ï¼Œä¹Ÿæ²¡å•¥å¤§é—®é¢˜ã€‚ã€‚</p>
<hr>
<p>å—¯ï¼Œå‡ºå»åƒäº†ä¸ªæ™šé¥­ï¼Œç¼–äº†ä¸ªè‡ªè®¤ä¸ºå¾ˆåˆç†çš„è§£é‡Šï¼šè€ƒè™‘å¯¹äºä¸€ä¸ªå‰ç¼€ $i$ï¼Œåœ¨ $0\sim n$ çš„è·¯å¾„ä¸Šï¼Œä¼šå¯¹å®ƒçš„åˆ¤å®šé€ æˆå½±å“çš„åªä¼šæ˜¯é‚£äº›åŒ…å«ä»–ä½†ä¸æŠŠä»–ä½œä¸º $border$ çš„æ›´é•¿çš„å‰ç¼€ã€‚é‚£ä¹ˆè€ƒè™‘ï¼Œå¦‚æœä¸€ä¸ªå‰ç¼€ä¸ä»¥ $i$ ä¸º $border$ï¼Œé‚£ä¹ˆä¹Ÿä¸€å®šä¸ä»¥ $i+k~(k&gt;0)$ åš $border$ã€‚æ‰€ä»¥å¯¹äºä¸€ä¸ª $i$ è€Œè¨€ï¼Œåªéœ€è¦è€ƒè™‘æ¯”ä»–å°çš„ $border$ äº§ç”Ÿçš„è´¡çŒ®ï¼Œè¿™ä¹Ÿæ­£æ˜¯ä»æ ¹åˆ°å®ƒçš„è·¯å¾„ä¸Šï¼Œé™¤å» $0\sim n$ é“¾ä¹‹å¤–çš„æ‰€æœ‰å­æ ‘ã€‚äºæ˜¯åˆ æ‰å³å¯ã€‚å¤æ‚åº¦ $O(\rm |S|)$ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next ;</span><br><span class="line">&#125;E[MAXN] ; <span class="keyword">int</span> head[MAXN], cnt ;</span><br><span class="line"><span class="keyword">char</span> In[MAXN] ; <span class="keyword">int</span> N, fail[MAXN], ans ;</span><br><span class="line"><span class="keyword">int</span> pre[MAXN], nxt[MAXN], onw[MAXN], val = <span class="number">1</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">//  cout &lt;&lt; x &lt;&lt; endl ;</span></span><br><span class="line">    pre[nxt[x]] = pre[x] ;</span><br><span class="line">    nxt[pre[x]] = nxt[x] ;</span><br><span class="line">    val = max(val, nxt[x] - pre[x]),</span><br><span class="line">    pre[x] = nxt[x] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k)) del(to(k)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    E[++ cnt].to = v, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (val &lt;= u) </span><br><span class="line">      <span class="keyword">return</span> ans = u, <span class="keyword">void</span>() ; <span class="comment">//cout &lt;&lt; u &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">int</span> xyg ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k)) </span><br><span class="line">      <span class="keyword">if</span> (onw[to(k)]) xyg = to(k) ; <span class="keyword">else</span> del(to(k)) ;</span><br><span class="line">    dfs(xyg) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j = <span class="number">0</span> ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; (In + <span class="number">1</span>) ;</span><br><span class="line">    N = <span class="built_in">strlen</span>(In + <span class="number">1</span>), ans = Inf ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (j &amp;&amp; In[j + <span class="number">1</span>] != In[i]) j = fail[j] ;</span><br><span class="line">        <span class="keyword">if</span> (In[j + <span class="number">1</span>] == In[i]) fail[i] = ++ j ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) add(fail[i], i) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) pre[i] = i - <span class="number">1</span>, nxt[i] = i + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = N ; i ; i = fail[i]) onw[i] = <span class="number">1</span> ; </span><br><span class="line">    dfs(<span class="number">0</span>) ; <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¤±é…æ ‘</category>
      </categories>
      <tags>
        <tag>å¥‡æ€ªçš„æŠ€å·§</tag>
        <tag>å­—ç¬¦ä¸²/failæ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘SAMçåš Â· å­—å…¸åºç›¸å…³</title>
    <url>/2020/01/16/SAM2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸ºäº†è¯æ˜è‡ªå·±ä¸æ˜¯ğŸ•Šå¹¶ä¸”è‡ªå·±ç»å¸¸å†™åšå®¢ï¼Œæ‰“ç®—æŠŠæœ¬æ¥å¯ä»¥ $1p$ è®²å®Œçš„åˆ†äº† $4p$ã€‚è¿™æ˜¯ç¬¬äºŒ $p$ï¼Œå˜å˜å˜ã€‚</p>
<a id="more"></a>
<h1 id="1-LG1368-å·¥è‰º"><a href="#1-LG1368-å·¥è‰º" class="headerlink" title="$1$ LG1368 å·¥è‰º"></a>$1$ LG1368 å·¥è‰º</h1><p>ä¼¼ä¹stdæ˜¯ä»€ä¹ˆæœ€å°è¡¨ç¤ºæ³•ï¼Œçœ‹â‘§é€å•Šï¼Œ$O(n)$ çš„SAMå®ƒä¸é¦™å— ï¼Ÿ</p>
<blockquote>
<p>æŠŠä¸€ä¸ªä¸²å¾ªç¯æ’åˆ—ï¼Œæ±‚æœ€å°çš„å­—å…¸åºæ’åˆ—ã€‚</p>
</blockquote>
<p>å‘ç°æŠŠä¸²å‘SAMé‡Œé¢æ’ä¸¤æ¬¡ï¼Œä»å§‹çŠ¶æ€å¼€å§‹ä¸æ–­æ‰¾æœ€å°çš„è½¬ç§»ï¼Œèµ° $n$ æ¬¡å°±å®Œäº†ã€‚</p>
<p>ä¼¼ä¹åªæ˜¯ç”¨åˆ°äº†ä¸€ä¸¢ä¸¢SAMçš„æ€§è´¨å•ŠQAQ</p>
<h1 id="2-SP7258-Lexicographical-Substring-Search"><a href="#2-SP7258-Lexicographical-Substring-Search" class="headerlink" title="$2$ [SP7258] Lexicographical Substring Search"></a>$2$ [SP7258] Lexicographical Substring Search</h1><p>é¢˜ç›®åç§°â€¦å¥½é•¿â€¦</p>
<blockquote>
<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚æœ¬è´¨ä¸åŒæ’åç¬¬kå°çš„å­ä¸²ã€‚</p>
</blockquote>
<p>è€ƒè™‘é¦–å…ˆåœ¨SAMä¸Šç®—å‡ºç°æ¬¡æ•°ï¼Œç„¶åä» $1$ å¼€å§‹èµ°ï¼Œç±»ä¼¼äºäºŒå‰æœç´¢æœ¨æ‰¾ $k-$æå€¼ çš„æ–¹å¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (vis[u]) <span class="keyword">return</span> ; vis[u] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i) </span><br><span class="line">		<span class="keyword">if</span> (S.trans[u][i]) </span><br><span class="line">      dfs2(S.trans[u][i]), </span><br><span class="line">  		g[u] += g[S.trans[u][i]] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_Out</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (s &lt;= f[p]) </span><br><span class="line">    	<span class="keyword">return</span> ; </span><br><span class="line">  <span class="keyword">else</span> s -= f[p] ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)</span><br><span class="line">		<span class="keyword">if</span> (!S.trans[p][i]) <span class="keyword">continue</span> ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (s &gt; g[S.trans[p][i]]) s -= g[S.trans[p][i]] ;</span><br><span class="line">		<span class="keyword">else</span> &#123; <span class="built_in">printf</span>(<span class="string">"%c"</span>, i + <span class="string">'a'</span>), go_Out(S.trans[p][i], s) ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; (In + <span class="number">1</span>) &gt;&gt; T ; </span><br><span class="line">	N = <span class="built_in">strlen</span>(In + <span class="number">1</span>) ; S.Init() ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) S.Ins(In[i] - <span class="string">'a'</span>) ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= S.sz ; ++ i) add(S.fa[i], i) ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= S.sz ; ++ i) g[i] = f[i] = <span class="number">1</span> ; dfs2(<span class="number">1</span>) ;</span><br><span class="line">	dfs2(<span class="number">1</span>) ; <span class="keyword">while</span> (T --) K = qr(), go_Out(<span class="number">1</span>, K), <span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-TJOI2015-å¼¦è®º"><a href="#3-TJOI2015-å¼¦è®º" class="headerlink" title="$3$ [TJOI2015]å¼¦è®º"></a>$3$ [TJOI2015]å¼¦è®º</h1><blockquote>
<p>æ±‚ï¼š</p>
<p>1ã€æœ¬è´¨ä¸åŒçš„ç¬¬ $k$ å°å­ä¸²ã€‚</p>
<p>2ã€ç¬¬ $k$ å°å­ä¸²ã€‚</p>
</blockquote>
<p>å‘ç°ç¬¬ä¸€é—®å°±æ˜¯ä¸Šé¢é‚£ä¸€é“ï¼Œä½†æ˜¯ç¬¬äºŒé—®é‡Œé¢ï¼Œæœ¬è´¨ä¸åŒçš„ä¸²è¦ç®—å¤šæ¬¡ã€‚</p>
<p>ç„¶è€Œå…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆå˜åŒ–ï¼Œ$dfs$ ä¸€éé¡ºä¾¿ç®—ä¸ªå‡ºç°æ¬¡æ•°å°±å¥½äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k)) </span><br><span class="line">		dfs(to(k)), f[u] += f[to(k)] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (vis[u]) <span class="keyword">return</span> ; vis[u] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">26</span> ; ++ i) </span><br><span class="line">		<span class="keyword">if</span> (S.trans[u][i]) </span><br><span class="line">			dfs2(S.trans[u][i]), g[u] += g[S.trans[u][i]] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">go_Out</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (s &lt;= f[p]) <span class="keyword">return</span> ; <span class="keyword">else</span> s -= f[p] ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">26</span> ; ++ i)</span><br><span class="line">		<span class="keyword">if</span> (!S.trans[p][i]) <span class="keyword">continue</span> ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (s &gt; g[S.trans[p][i]]) s -= g[S.trans[p][i]] ;</span><br><span class="line">		<span class="keyword">else</span> &#123; <span class="built_in">printf</span>(<span class="string">"%c"</span>, i + <span class="string">'a'</span> - <span class="number">1</span>), go_Out(S.trans[p][i], s) ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ä¸²/åç¼€è‡ªåŠ¨æœº(SAM)</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘SAMçåš Â· å…¬å…±å­ä¸²ç›¸å…³</title>
    <url>/2020/01/16/SAM3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸ºäº†æ°´blogï¼Œå†³å®šå•æ‹¿å‡ºæ¥å†æ•´ç†ä¸€ç¯‡233</p>
<p>ä¸¥æ ¼æ¥è®²ï¼Œè¿™ä¸œè¥¿ä¼¼ä¹åº”è¯¥ç®—åœ¨å¹¿ä¹‰SAMçš„èŒƒç•´ï¼Ÿ</p>
<a id="more"></a>
<h1 id="1-SP1811-LCS"><a href="#1-SP1811-LCS" class="headerlink" title="$1$ SP1811 LCS"></a>$1$ SP1811 LCS</h1><blockquote>
<p>è¾“å…¥ $2$ ä¸ªé•¿åº¦ä¸å¤§äº $250000$ çš„å­—ç¬¦ä¸²ï¼Œè¾“å‡ºè¿™ $2$ ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²ã€‚</p>
</blockquote>
<p>è€ƒè™‘å¯¹è¿ä¸ªä¸²éƒ½å»ºSAMï¼Œæ–¹æ³•æ˜¯æ’å…¥ä¸€ä¸ªä¸²åéšä¾¿æ’å…¥ä¸€ä¸ª $\not\in \Sigma$ çš„å­—ç¬¦é—´éš”å¼€ï¼Œè¿™æ ·ï¼Œä»æœ¬è´¨ä¸Šå°±æŠŠç¬¬äºŒä¸ªä¸²çš„åç¼€è¿æˆäº†ä¸€æ£µæ–°å­æ ‘æ¥åœ¨è™šæ ¹çš„ä¸‹é¢ã€‚</p>
<p>è¿˜æ˜¯åŸæ¥çš„ $dp$ åŸç†ã€‚æ¯æ¬¡é‡åˆ°ä¸€ä¸ªåœ¨ä¸¤ä¸ªä¸²ä¸­éƒ½å‡ºç°è¿‡çš„ä¸²å°±æŠŠç­”æ¡ˆæ›´æ–°ä¸€ä¸‹ã€‚</p>
<p>å—¯ï¼Œä¸å¾—ä¸è¯´ï¼ŒSAMæŒ‰ç…§ $endpos$ æ„å»ºç­‰ä»·ç±»è¿™ä¸ªæƒ³æ³•å®åœ¨å¤ªå¦™äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))</span><br><span class="line">		dfs(to(k)), f[x][<span class="number">0</span>] += f[to(k)][<span class="number">0</span>], f[x][<span class="number">1</span>] += f[to(k)][<span class="number">1</span>] ;</span><br><span class="line">	<span class="keyword">if</span> (f[x][<span class="number">0</span>] &amp;&amp; f[x][<span class="number">1</span>]) ans = max(ans, sam.len[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	sam.Init() ;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; (S + <span class="number">1</span>) &gt;&gt; (T + <span class="number">1</span>) ; </span><br><span class="line">	N = <span class="built_in">strlen</span>(S + <span class="number">1</span>), M = <span class="built_in">strlen</span>(T + <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) sam.Ins(S[i] - <span class="string">'a'</span> + <span class="number">1</span>, <span class="number">0</span>) ; sam.Ins(<span class="number">27</span>, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i) sam.Ins(T[i] - <span class="string">'a'</span> + <span class="number">1</span>, <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= sam.sz ; ++ i) add(sam.fa[i], i) ; dfs(<span class="number">1</span>) ;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-HAOI2016-æ‰¾ç›¸åŒå­—ç¬¦"><a href="#2-HAOI2016-æ‰¾ç›¸åŒå­—ç¬¦" class="headerlink" title="$2$ [HAOI2016] æ‰¾ç›¸åŒå­—ç¬¦"></a>$2$ [HAOI2016] æ‰¾ç›¸åŒå­—ç¬¦</h1><blockquote>
<p>ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚å‡ºåœ¨ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­å„å–å‡ºä¸€ä¸ªå­ä¸²ä½¿å¾—è¿™ä¸¤ä¸ªå­ä¸²ç›¸åŒçš„æ–¹æ¡ˆæ•°ã€‚ä¸¤ä¸ªæ–¹æ¡ˆä¸åŒå½“ä¸”ä»…å½“è¿™ä¸¤ä¸ªå­ä¸²ä¸­æœ‰ä¸€ä¸ªä½ç½®ä¸åŒã€‚</p>
</blockquote>
<p>æˆ‘æ˜ç™½äº†ï¼Œ$15,16$ å¹´çš„æ—¶å€™æ­£å€¼SAMå˜çš„æ™®åŠçš„é˜¶æ®µï¼Œæ‰€ä»¥è¿™ç§æ²¡æœ‰æ–°æ„çš„é¢˜æ‰ä¼šæœ‰ä¸€å †äººå‡ºã€‚</p>
<p>é¦–å…ˆå°±æ˜¯ä¹˜æ³•åŸç†ï¼Œç„¶åè€ƒè™‘ä¸åŒçš„å­ä¸²æ•°é‡å¯ä»¥ç›´æ¥ $parent$ ä¸Šçˆ¶å­å·®åˆ†ï¼Œç„¶åå°±æ²¡äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))</span><br><span class="line">		dfs(to(k)), f[x][<span class="number">0</span>] += f[to(k)][<span class="number">0</span>], f[x][<span class="number">1</span>] += f[to(k)][<span class="number">1</span>] ;</span><br><span class="line">	<span class="keyword">if</span> (x &gt; <span class="number">1</span> &amp;&amp; f[x][<span class="number">0</span>] &amp;&amp; f[x][<span class="number">1</span>]) </span><br><span class="line">		ans += <span class="number">1l</span>l * f[x][<span class="number">0</span>] * f[x][<span class="number">1</span>] * (sam.len[x] - sam.len[sam.fa[x]]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-å¤šä¸²çš„LCS"><a href="#3-å¤šä¸²çš„LCS" class="headerlink" title="$3$ å¤šä¸²çš„LCS"></a>$3$ å¤šä¸²çš„LCS</h1><p>æ­¤å¤„çš„ â€œSâ€ æŒ‡çš„æ˜¯ â€œSubstringâ€ çš„æ„æ€å•¦ã€‚</p>
<p>æœ¬è´¨ä¸Šæ˜¯SPOJçš„ä¸¤é“é¢˜ï¼Œ<code>SP10570 LONGCS</code> å’Œ <code>SP1812 LCS2</code> ã€‚</p>
<blockquote>
<p>ç»™å®šä¸€äº›å­—ç¬¦ä¸²ï¼Œæ±‚å‡ºå®ƒä»¬çš„æœ€é•¿å…¬å…±å­ä¸²</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> S[MAXN], T[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, L, res, ans[MAXN] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SAM</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> last, sz ;</span><br><span class="line">    <span class="keyword">int</span> fa[MAXN], f[MAXN], len[MAXN] ;</span><br><span class="line">    <span class="keyword">int</span> trans[MAXN][<span class="number">27</span>], buc[MAXN], base[MAXN] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        last = sz = <span class="number">1</span> ;</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">63</span>, <span class="keyword">sizeof</span>(f)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p = last, np = ++ sz ;</span><br><span class="line">        last = np, len[np] = len[p] + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (p &amp;&amp; !trans[p][x])</span><br><span class="line">            trans[p][x] = np, p = fa[p] ;</span><br><span class="line">        <span class="keyword">if</span> (!p)</span><br><span class="line">            <span class="keyword">return</span> fa[np] = <span class="number">1</span>, <span class="keyword">void</span>() ;</span><br><span class="line">        <span class="keyword">int</span> q = trans[p][x] ;</span><br><span class="line">        <span class="keyword">if</span> (len[q] == len[p] + <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> fa[np] = q, <span class="keyword">void</span>() ;</span><br><span class="line">        <span class="keyword">int</span> nq = ++ sz ;</span><br><span class="line">        fa[nq] = fa[q],</span><br><span class="line">        fa[q] = fa[np] = nq ;</span><br><span class="line">        len[nq] = len[p] + <span class="number">1</span> ;</span><br><span class="line">        <span class="built_in">memcpy</span>(trans[nq], trans[q], <span class="keyword">sizeof</span>(trans[q])) ;</span><br><span class="line">        <span class="keyword">while</span> (p &amp;&amp; trans[p][x] == q)</span><br><span class="line">            trans[p][x] = nq, p = fa[p] ;</span><br><span class="line">    &#125;<span class="comment">/*</span></span><br><span class="line"><span class="comment">    void dfs(int x)&#123;</span></span><br><span class="line"><span class="comment">        if (vis[x]) return ; vis[x] = 1 ;</span></span><br><span class="line"><span class="comment">        for (int i = 1 ; i &lt;= 26 ; ++ i) if (trans[x][i]) dfs(trans[x][i]) ;</span></span><br><span class="line"><span class="comment">        ans[fa[x]] = max(ans[fa[x]], min(ans[x], len[fa[x]])) ;</span></span><br><span class="line"><span class="comment">        f[x] = min(f[x], ans[x]), ans[x] = 0 ; </span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= sz ; ++ i) buc[len[i]] ++ ;</span><br><span class="line">      	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= sz ; ++ i) buc[i] += buc[i - <span class="number">1</span>] ;</span><br><span class="line">      	<span class="keyword">for</span> (<span class="keyword">int</span> i = sz ; i &gt;= <span class="number">1</span> ; -- i) base[buc[len[i]] --] = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">char</span> * s)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rt = <span class="number">1</span>, x, l = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= L ; ++ i)&#123;</span><br><span class="line">            x = s[i] - <span class="string">'a'</span> + <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">while</span> (rt &amp;&amp; !trans[rt][x]) rt = fa[rt], l = len[rt] ;</span><br><span class="line">            <span class="keyword">if</span> (rt) ++ l, rt = trans[rt][x], ans[rt] = max(ans[rt], l) ;</span><br><span class="line">            <span class="keyword">else</span> rt = <span class="number">1</span>, l = <span class="number">0</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = sz ; i ; -- i)</span><br><span class="line">            rt = base[i], x = fa[rt], </span><br><span class="line">            ans[x] = max(ans[x], min(ans[rt], len[x])), </span><br><span class="line">            f[rt] = min(f[rt], ans[rt]), ans[rt] = <span class="number">0</span> ; </span><br><span class="line">        <span class="comment">// for (int i = 1 ; i &lt;= sz ; ++ i) cout &lt;&lt; ans[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">        <span class="comment">// dfs(1) ;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;M ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, S + <span class="number">1</span>) ; <span class="keyword">int</span> i ;</span><br><span class="line">    N = <span class="built_in">strlen</span>(S + <span class="number">1</span>), M.Init() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        M.Insert(S[i] - <span class="string">'a'</span> + <span class="number">1</span>) ;</span><br><span class="line">    M.sort() ;</span><br><span class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%s"</span>, T + <span class="number">1</span>))</span><br><span class="line">        L = <span class="built_in">strlen</span>(T + <span class="number">1</span>), M.work(T) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M.sz ; ++ i)</span><br><span class="line">        res = max(res, M.f[i]) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆæ‹¿ç¬¬ä¸€ä¸ªä¸²æœ´ç´ å»º SAMã€‚å¯¹äºä¸€ä¸ªæ–°çš„ä¸²ï¼Œè€ƒè™‘å°†è¿™ä¸ªä¸²æ”¾åˆ° SAM ä¸Šè¿è¡Œï¼ŒåŒæ—¶è®°å½•æ¯ä¸ªä½ç½®èƒ½å¤ŸåŒ¹é…åˆ°çš„æœ€é•¿é•¿åº¦ã€‚å†ç”¨ä¸€ä¸ª $f$ è®°å½•å…¨å±€ï¼Œè€Œ $f$ æ˜¾ç„¶åº”è¯¥å¯¹æ¯ä¸ªä¸²çš„ $rt$ å¤„çš„åŒ¹é…å– $\min$ã€‚</p>
<p>å—¯ï¼Œæ³¨æ„ç”±äº $parent$ æ ‘çš„æ€§è´¨ï¼Œçˆ¶äº²ç­”æ¡ˆçš„ä¸€éƒ¨åˆ†åŒ…å«åœ¨å„¿å­ä¸­ï¼Œä½†ä¹Ÿä¸ä¼šå¤šäºè‡ªèº«çš„é•¿åº¦ã€‚äºæ˜¯ä¸€å¼€å››$topsort$ ä¸€éå°±å¯ä»¥äº†ã€‚å¤æ‚åº¦ä¼¼ä¹æ˜¯ $\sum\rm |S_i|$ ?</p>
<p>enï¼Œä¼¼ä¹è¿™é“é¢˜ä¹Ÿæ˜¯ <code>[POI2000]å…¬å…±ä¸²</code> çš„åŠ å¼ºç‰ˆã€‚ä¸è¿‡è¿™ç§é¢˜ç›®å‡ å€ç»éªŒä¹Ÿä¸å¥‡æ€ªå§ï¼Ÿ</p>
<h1 id="4-SDOI2008-Sandyçš„å¡ç‰‡"><a href="#4-SDOI2008-Sandyçš„å¡ç‰‡" class="headerlink" title="$4$ [SDOI2008] Sandyçš„å¡ç‰‡"></a>$4$ [SDOI2008] Sandyçš„å¡ç‰‡</h1><blockquote>
<p>Sandyå’ŒSueçš„çƒ­è¡·äºæ”¶é›†å¹²è„†é¢ä¸­çš„å¡ç‰‡ã€‚</p>
<p>æ¯ä¸€å¼ å¡ç‰‡éƒ½ç”±ä¸€äº›æ•°å­—è¿›è¡Œæ ‡è®°ï¼Œç¬¬ $i$ å¼ å¡ç‰‡çš„åºåˆ—é•¿åº¦ä¸º $M_i$ï¼Œè¦æƒ³å…‘æ¢äººç‰©æ¨¡å‹ï¼Œé¦–å…ˆå¿…é¡»è¦é›†å¤Ÿ $N$ å¼ å¡ç‰‡ï¼Œå¯¹äºè¿™ $N$ å¼ å¡ç‰‡ï¼Œå¦‚æœä»–ä»¬éƒ½æœ‰ä¸€ä¸ªç›¸åŒçš„å­ä¸²é•¿åº¦ä¸º $k$ï¼Œåˆ™å¯ä»¥å…‘æ¢ä¸€ä¸ªç­‰çº§ä¸º $k$ çš„äººç‰©æ¨¡å‹ã€‚ç›¸åŒçš„å®šä¹‰ä¸ºï¼šä¸¤ä¸ªå­ä¸²é•¿åº¦ç›¸åŒä¸”ä¸€ä¸ªä¸²çš„å…¨éƒ¨å…ƒç´ åŠ ä¸Šä¸€ä¸ªæ•°å°±ä¼šå˜æˆå¦ä¸€ä¸ªä¸²ã€‚</p>
<p>ç°åœ¨åˆä¸€å †å¡ç‰‡ï¼Œè¯·ä½ å¸®åŠ©Sandyå’ŒSueï¼Œçœ‹çœ‹ä»–ä»¬æœ€é«˜èƒ½å¤Ÿå¾—åˆ°å“ªä¸ªç­‰çº§çš„äººç‰©æ¨¡å‹ã€‚</p>
</blockquote>
<p>çœ‹åˆ°è¿™é¢˜è’™äº†åŠå¤©ï¼Œç”šè‡³å†™äº†ä¸€å‘æšä¸¾ã€ŒåŠ ä¸Šçš„æ•°æ˜¯å¤šå°‘ã€ç„¶åå†å»SAMï¼Œç»“æœå‘ç°åŸæ¥ä¸åŒä¸²ä¹‹é—´å¯ä»¥ç”¨ä¸åŒçš„æ•° â€¦â€¦æˆ‘æ˜¯å¼Ÿå¼Ÿã€‚</p>
<p>äºæ˜¯æœ€åè¢«é¢˜è§£æš´å‡»ï¼šå·®åˆ†ä¸€ä¸‹å³å¯ã€‚æˆ‘æ˜¯ddã€‚QAQ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T &gt;&gt; N ; T -- ; <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;S[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) t[i] = S[i] - S[i - <span class="number">1</span>] ; M.Init() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) M.Insert(t[i]) ; M.sort() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= T ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;ss[i][<span class="number">0</span>]) ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= ss[i][<span class="number">0</span>] ; ++ j) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;ss[i][j]);</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">2</span> ; j &lt;= ss[i][<span class="number">0</span>] ; ++ j) t[j] = ss[i][j] - ss[i][j - <span class="number">1</span>] ;</span><br><span class="line"><span class="comment">//        for (j = 1 ; j &lt;= ss[i][0] ; ++ j) cout &lt;&lt; t[j] &lt;&lt; " " ; puts(" ") ;</span></span><br><span class="line">        t[<span class="number">1</span>] = -(i + <span class="number">1</span>) ; M.work(t, ss[i][<span class="number">0</span>]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M.sz ; ++ i) res = max(res, M.f[i]) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; res + <span class="number">1</span> &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªåœ°æ–¹æˆ‘é»˜è®¤æŠŠç¬¬ä¸€ä¸ªå…ƒç´ çç»™äº†ä¸ªå€¼ã€‚</p>
<p>å“¦ï¼Œè¿˜æœ‰ï¼Œå¯èƒ½å¥½ä¹…æ²¡å†™å·®åˆ†äº†ï¼Ÿä¸€å¼€å§‹å†™å·®åˆ†æˆ‘æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) S[i] = S[i] - S[i - <span class="number">1</span>] ;</span><br></pre></td></tr></table></figure>
<p>æ˜¯å¼Ÿä¸­å¼Ÿæœ¬å¼Ÿæ²¡é”™äº†ï¼ˆcry</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ä¸²/åç¼€è‡ªåŠ¨æœº(SAM)</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç”Ÿæ´»ç¢ç‰‡1ã€‘Â· å¼€å§‹å•¦</title>
    <url>/2020/01/15/Life1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å°ç­ç»ˆäºæ¥å•¦ï¼å­¤ç‹¬çš„æœºæˆ¿ç»ˆäºè¦è¿æ¥ä¸€ä¸äº®è‰²äº†ã€‚</p>
<p>è‡ªå·±å‘¢ï¼Ÿä¹Ÿè¦å‡†å¤‡å¥½èƒŒèµ·è¡Œå›Šï¼Œé‡æ–°å‡ºå‘äº†å§ï¼</p>
<p><del>æµæ°´è´¦è­¦å‘Š</del></p>
<a id="more"></a>
<h1 id="rm-Part1"><a href="#rm-Part1" class="headerlink" title="$\rm Part1$"></a>$\rm Part1$</h1><blockquote>
<p>ã€Œæ²‰èˆŸä¾§ç•”åƒå¸†è¿‡ï¼Œç—…æ ‘å‰å¤´ä¸‡æœ¨æ˜¥ã€‚ã€</p>
</blockquote>
<p>ç¬¬ä¸€éƒ¨åˆ†å½“ç„¶è¦è°¦è™šä¸€ç‚¹ï¼Œè‡ªå·±æ˜¯æ²‰èˆŸç—…æ ‘å•¦ã€‚</p>
<p>ç„¶è€Œå…¶å®è°¦ä¸è°¦è™šçš„ï¼Œéƒ½æ˜¯æ²‰èˆŸç—…æ ‘qaq</p>
<p>æœ€è¿‘å°ç­æ¥äº†ï¼Œé‡‘å“¥æŠŠå››ä¸ªæå‰å­¦è¿‡çš„æ”¾åˆ°äº†æˆ‘è¿™å±‹ã€‚è·Ÿä»–ä»¬åœ¨ä¸€å—æ˜¾è‘—æ„Ÿè§‰å‡ºè‡ªå·±æœ‰å¤šä¹ˆé¢“åºŸï¼Œè™½ç„¶ä¸æ˜¯å¾ˆæƒ³æ‰¿è®¤ï¼Œå¯èƒ½é‡‘å“¥çš„ã€Œé”™ä½æ‰“å‡»ã€çœŸçš„ç®¡ç”¨äº†å§ï¼Ÿ</p>
<p>ç„¶åå°±æ˜¯æƒ³è®²è¯¾ï¼Ÿå¯èƒ½æ˜¯å› ä¸ºå­©å„¿ä»¬å¤ªå¯çˆ±äº†ï¼Œæ‰€ä»¥å¿ä¸ä½åœ°å°±åƒå»æ‰¾ä»–ä»¬ç©â€¦ç„¶è€Œä»–ä»¬ç°åœ¨å­¦çš„ä¸å¤šï¼Œæ‰€ä»¥å¯èƒ½ä¸èƒ½è®²å¤ªéš¾çš„å†…å®¹ã€‚æƒ³äº†ä¸€ä¸¤å¤©ï¼Œå†³å®šç»™ä»–ä»¬è®²è´ªå¿ƒå•Šã€éšæœºåŒ–å•Šã€æ„é€ å•Šè¿™ç§æœ‰æ„æ€çš„é¢˜ç›®ã€‚</p>
<p>äºæ˜¯å°±å¼€å§‹å­¦ $\TeX $ å’‹ç”¨ï¼Œå…¶å®æŒºå¥½æ˜ç™½çš„ï¼Œè·Ÿç€ç½‘ä¸Šæ‰¾å‡ ä¸ªæ•™ç¨‹ï¼Œä¸‹ä¸€å †ä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿å°±å¥½äº†ã€‚è¿™é‡Œæ¨èæ¸…åæ­çš„é•œåƒç«™ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œä¸æ„§æ˜¯ä½ æ¸…ã€‚</p>
<p>å†ä¹‹åå°±å¼€å§‹å­¦ $beamer$ï¼Œå‘ç°è¿˜æ˜¯å¾ˆç®€å•çš„ã€‚ç„¶è€Œç”±äºè‡ªå·±æ²¡ç”¨è¿‡ <code>sublime 3</code> ï¼ˆç›®å‰åªç”¨æ¥è¯†åˆ«ç‰¹æ®Šå­—ç¬¦+æ–‡æœ¬æ›¿æ¢+æ–‡æ¡£æš‚å­˜ï¼‰ï¼Œæ‰€ä»¥å°±åªèƒ½ä¸€è¡Œä¸€è¡Œåœ°æ‰‹æ•² $\TeX$ï¼Œç»™çˆ·æ•´è’™äº†â€¦â€¦</p>
<p>ä¸è¿‡ç»å†äº†ä¸€ç•ªè‹¦éš¾è¿˜æ˜¯åšå¥½äº†çš„ï¼Œæœ€åå°±æ˜¯ $42$ é¡µ PPTï¼Œè§‰å¾—è¿˜å¯ä»¥ï¼Ÿä½†ä¸çŸ¥é“ä¸ºå•¥ï¼Œæ€»è§‰å¾—åªæœ‰åƒ $\rm lxl$ å’Œæˆ‘æ ¡åŒ–å­¦å¥¥èµ›æ•™ç»ƒé‚£æ ·ä¸€ä¸ªè¯¾ä»¶åšå¥½å‡ ç™¾é¡µæ‰ç®—åšPPTâ€¦äºæ˜¯åªç»™è‡ªå·±æ‰“ $95$ åˆ†ï¼ˆé›¾</p>
<p>ç„¶è€Œï¼Œåœ¨ç»™ä»–ä»¬è®²è¯¾çš„å‰ä¸€å¤©ä¸‹åˆï¼Œå¬ä»–ä»¬èŠèµ·çš„å†…å®¹ï¼Œå·²ç»æ˜¯ ã€Œ$\rm SPFA$ã€ã€ã€ŒLuoguä¸Šè“è‰²çš„è´ªå¿ƒã€è¿™ç§ä¸œè¥¿ï¼Œäºæ˜¯è§‰å¾—ä»–ä»¬å¾ˆå¼ºï¼Œå°±ä¸´æ—¶åˆåŠ äº†ä¸€ç‚¹ $dp$ çš„å†…å®¹ï¼ŒåŠ åˆ°äº†$84$ é¡µâ€¦andä¸ºäº†é˜²æ­¢è¢«å–·èœï¼Œéšä¾¿æ‰¾äº†ä¸€é“ä½œä¸ºCfdiv2Fçš„dpã€‚<del>æ‰ä¸ä¼šå‘Šè¯‰ä½ æˆ‘è‡ªå·±çœ‹è¿™ä¸ªé¢˜éƒ½è’™äº†åŠå¤©æœ€åè¿˜ç¿»çš„é¢˜è§£</del></p>
<p>ç»“æœâ€¦â€¦å‘ç°å¥½åƒæœ‰ä»€ä¹ˆä¸å¯¹â€¦â€¦</p>
<p>å¤§æ¦‚å°±æ˜¯æœ¬æ¥è§‰å¾— $\rm 2h$ ç»“æŸçš„å†…å®¹è®²äº† $\text{6+}~h$ è¿˜æ²¡è®²å®Œâ€¦</p>
<p>ä¸è¿‡æœ€ç»ˆæ„Ÿè§‰è¿˜å¯ä»¥ï¼Ÿå¯èƒ½æ„é€ å’Œdpæ˜¯ä¸ªäº®ç‚¹ï¼Œå‰é¢è®²è´ªå¿ƒç¿»äº†ä¸€æ¬¡è½¦233ï¼Œæˆ‘è¿˜æ˜¯å¤ªèœå•ŠQAQ</p>
<p>å‘ç°äº†å‡ ä¸ªæ¯”è¾ƒæœ‰å¤©åˆ†çš„å°æœ‹å‹ï¼Œå¸Œæœ›ä»–ä»¬å°†æ¥ä¼šæœ‰æ‰€å»ºæ ‘å§ã€‚</p>
<p>é¦–å…ˆæ˜¯äººç”Ÿç»éªŒï¼š</p>
<div class="pdf" target="./çè®²è®².pdf" height></div>
<p>å…¶æ¬¡æ˜¯è¯¾ä»¶ï¼Œè‡ªæˆ‘æ„Ÿè§‰åšçš„è¿˜ä¸é”™ï¼š</p>
<div class="pdf" target="./æŠ€å·§æ€§é—®é¢˜é€‰è®².pdf" height></div>
<p>ï¼ˆå¦‚æœpdfåŠ è½½ä¸å‡ºæ¥ï¼Œæ¨è <code>firefox</code> æµè§ˆå™¨æˆ–è€…ç­‰ä¸Šé‚£ä¹ˆä¸€äºŒä¸‰å››â€¦äº”å…­ååˆ†é’Ÿã€huaji ï¼‰</p>
<p>æœ€åæŠŠè‡ªå·±ä»MOé‚£é‡Œå«–æ¥çš„æ•°ç«æ•™æäº¤ç»™äº†ä¸‹ä¸€ä»£â€¦233</p>
<p>ä¸è¿‡å‘¢ï¼Œæ„Ÿè§‰è‡ªå·±çœŸæ˜¯è€äº†å•Šã€‚è¡”æ¥ç­çš„æ‡µæ‡‚ï¼Œé«˜ä¸€çš„è¿·èŒ«ï¼Œé«˜äºŒçš„ä»å®¹ï¼Œä¸€è·¯èµ°æ¥ï¼Œç»å†äº†å¾ˆå¤šï¼Œä¹Ÿæ˜ç™½äº†å¾ˆå¤šã€‚</p>
<p>ä½†æ˜¯ï¼Œæ¯”è¾ƒä¼¤æ„Ÿçš„ä¸€ç‚¹æ˜¯ï¼Œæ— è®ºæˆ‘å¯¹è¿™ä¸€çº§åˆä¸‰çš„å°ç­æœ‰å¤šä¹ˆçœŸæŒšçš„æ„Ÿæƒ…ï¼Œæˆ‘éƒ½ä¸å¯èƒ½å†é™ªä»–ä»¬å»å‚åŠ ä¸€å¹´è”èµ›äº†ã€‚ä¹Ÿå°±è¯´è‡ªå·±å¯èƒ½å°±åªæ˜¯ä»–ä»¬OIç”Ÿæ¶¯ä¸­ï¼Œä¸€ä¸ªä¸èµ·çœ¼çš„è¿‡å®¢â€¦</p>
<p>æƒ³æ¥æœ‰ç‚¹ä¼¤æ„Ÿå‘¢ï¼Œä½†è¿™ä¸–ç•Œæœ¬å°±æ˜¯è¿™æ ·å§ï¼Ÿ</p>
<p>æƒ³èµ·è‡ªå·±å‰å‡ å¤©çœ‹å¼ åºšæ–°å­¦é•¿çš„ $blog$ï¼Œé‡Œé¢å¤§å¤šéƒ½æ˜¯ã€Œç»™å°ç­è®²STLã€ä¹‹ç±»çš„ï¼Œå½“æ—¶çš„å°ç­ï¼ˆç°åœ¨æ˜¯æˆ‘çš„2çº§å­¦é•¿ï¼‰ä¹Ÿå¾ˆé«˜å…´åœ°å»å‚¬æ›´ã€‚è™½ç„¶ä¸œè¥¿æ˜æ˜é‚£ä¹ˆç®€å•ï¼Œè®²çš„æ˜æ˜ä¹Ÿé‚£ä¹ˆç®€é™‹ï¼Œä½†æˆ‘æ€»èƒ½æ„Ÿè§‰å‡ºä¸€ç§æ„Ÿæƒ…ã€ä¸€è‚¡åŠ›é‡ï¼ŒåµŒåœ¨æ–‡å­—é—´ã€æµæ·Œåœ¨è¯„è®ºé‡Œã€‚æƒ³åˆ°è¿™é‡Œï¼Œæ„Ÿè§‰å¿ƒè„ä¼¼ä¹ç©ºäº†ä¸€å—å„¿ã€‚</p>
<p>é‚£åŠ›é‡ï¼Œä¼¼ä¹å°±æ˜¯ä»æ²‰èˆŸç—…æ ‘é‡Œé¢å‘å‡ºçš„ï¼Œä¼¼ä¹åœ¨å¤§å£°åœ°å–Šã€Œæˆ‘è¿˜è¦æ´»ç€ã€ã€‚</p>
<p>é‚£æ„Ÿæƒ…ï¼Œå¯èƒ½å°±æ˜¯æœ€è´¨æœ´çš„æ„Ÿæƒ…å§ï¼Ÿ</p>
<h1 id="rm-Part2"><a href="#rm-Part2" class="headerlink" title="$\rm Part2$"></a>$\rm Part2$</h1><p>ç¬¬äºŒéƒ¨åˆ†å‘¢ï¼Œæ‰“ç®—è‡ªå·±å½“ä¸€å›ã€Œåƒå¸†è¿‡ã€ã€ã€Œä¸‡æœ¨æ˜¥ã€233ã€‚</p>
<p>å®ä¸ç›¸ç’ï¼Œæš—æ‹äº†ä¸€å¹´å¤šçš„å¦¹å­çªç„¶æœ‰äº†ç”·ç¥¨ä¹‹åå”¯ä¸€çš„æ„Ÿè§‰å°±æ˜¯ç©ºè™šâ€¦ä¸€ç§ã€Œè¿‡å»æŠŠè‡ªå·±åˆ†åˆ°å¥¹èº«ä¸Šä¸€éƒ¨åˆ†ï¼Œç°åœ¨å¥¹èµ°äº†ï¼Œè‡ªå·±ç©ºäº†ä¸€å¤§å—ã€çš„è®¤çŸ¥ï¼Œä¸€ç§ã€Œä¸ºä»€ä¹ˆæ€»æ„Ÿè§‰ç”Ÿæ´»åªæ˜¯åœ¨ä¸æ–­å…œç€ä¸€ä¸ªä»â€œåšæ¢¦â€åˆ°â€œå¤±è´¥â€å†åˆ°â€œåšæ¢¦â€çš„åœˆå­ã€çš„æƒ…æ„Ÿï¼Œä¸¤è€…å åŠ åœ¨ä¸€èµ·ï¼Œè®©æˆ‘æ„Ÿåˆ°æ¯å¤©éƒ½ååˆ†çš„æµ‘æµ‘å™©å™©â€¦</p>
<p>ä½†ä»”ç»†æƒ³äº†æƒ³ï¼Œè‡ªå·±ä¼¼ä¹åšçš„äº‹è¿˜æœ‰å¾ˆå¤šã€‚æ¯”å¦‚å¯ä»¥å­¦éŸ³ä¹å•Šã€å­¦è‹±è¯­ã€æ³•è¯­ã€ä¿„è¯­ã€æ—¥è¯­å•Šä¹‹ç±»çš„ã€‚ä½†æ€»è§‰å¾—è‡ªå·±æ˜¯ä¸‰åˆ†é’Ÿçƒ­åº¦ã€‚</p>
<p>è™½ç„¶çœ‹ä¸åˆ°ä»€ä¹ˆä¸œè¥¿ï¼Œåœ¨åŒå¤§çš„ä¸–ç•Œä¹Ÿæ€»æ„Ÿè§‰è‡ªå·±æ˜¯å­¤å•ä¸€äººã€‚ä½†ã€Šé£˜ã€‹é‡Œé¢ï¼Œæ–¯å˜‰ä¸½åœ¨æœ€åè¯´çš„è¯ï¼Œä¼¼ä¹æ¯”è¾ƒé€‚åˆç»“å°¾ï¼š</p>
<blockquote>
<p> Tomorrow is another day !</p>
</blockquote>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>ç”Ÿæ´»ç¢ç‰‡</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘åç¼€è‡ªåŠ¨æœºçå­¦</title>
    <url>/2020/01/15/SAM/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç¬¬ä¸€æ¬¡å­¦SAMè¿˜æ˜¯ä¸€å¹´å‰ï¼Œå½“æ—¶åªè®°å¾—æ€ä¹ˆçœ‹æ€ä¹ˆä¸ä¼šorz</p>
<a id="more"></a>
<h1 id="1-åŸºæœ¬å†…å®¹"><a href="#1-åŸºæœ¬å†…å®¹" class="headerlink" title="$1$ åŸºæœ¬å†…å®¹"></a>$1$ åŸºæœ¬å†…å®¹</h1><p>â€¦äºæ˜¯è¿˜æ˜¯åˆ†æ¡é™ˆè¿°</p>
<p>0ã€ä¸€ä¸ªå­ä¸²çš„ $endpos$ é›†åˆæŒ‡çš„æ˜¯å®ƒåœ¨åŸä¸²å†…å‡ºç°çš„æ‰€æœ‰çš„å³ç«¯ç‚¹ä¸‹æ ‡ç»„æˆçš„é›†åˆã€‚æ˜¾ç„¶æœ‰è¿™ä¹ˆä¸€ä¸ªæ€§è´¨ï¼Œå¯¹äºä¸¤ä¸ªå­ä¸²ï¼Œå®ƒä»¬çš„ $endpos$ é›†åˆè¦ä¹ˆå­˜åœ¨åŒ…å«å…³ç³»ï¼Œè¦ä¹ˆæ²¡æœ‰äº¤é›†ã€‚ </p>
<p>1ã€é¦–å…ˆï¼ŒSAMæ˜¯ä¸ªè‡ªåŠ¨æœºã€‚è½¬ç§»æ˜¯å­—æ¯ï¼ŒçŠ¶æ€æ˜¯ <strong>$endpos$ é›†åˆç›¸åŒçš„å­ä¸²</strong>ã€‚æœ‰ä¸€ä¸ªå…¶å®çŠ¶æ€ï¼Œä¸€å †ç»ˆæ­¢çŠ¶æ€ï¼Œæ¯ä¸ªç»ˆæ­¢çŠ¶æ€æ˜¯åŸä¸²çš„ä¸€ä¸ªåç¼€ã€‚</p>
<p>2ã€å¦‚æœè®°æ¯ä¸ªçŠ¶æ€é‡Œé¢æœ€é•¿çš„å­ä¸²çš„é•¿åº¦ä¸º $L_{\max}$ï¼Œæœ€çŸ­çš„å­ä¸²é•¿åº¦ä¸º $L_{\min}$ ï¼Œé‚£ä¹ˆè¿™ä¸ªçŠ¶æ€æ‰¿è½½çš„å­ä¸²é•¿åº¦è¦†ç›– $[L_{\min},L_{\max}]$.</p>
<p>3ã€è€ƒè™‘åç¼€é“¾æ¥ $\rm link$ ã€‚$\mathrm{link}(v)$ æŒ‡å‘çš„æ˜¯ $L_{\max}(u)+1=L_{\min}(v)$ ä¸” $endpos(v)\subset endpos(u)$ çš„è¿™ä¹ˆä¸€ä¸ªèŠ‚ç‚¹ $u$ . å¯ä»¥çœ‹å‡ºï¼Œå…¶å® $u$ é‡Œé¢çš„å­ä¸²å°±æ˜¯ $v$ ä¸­çš„å­ä¸²çš„æŸäº›æ›´çŸ­çš„åç¼€ã€‚</p>
<p>4ã€å‘ç°åç¼€é“¾æ¥ $\rm link$ è”ç³»èµ·æ¥çš„æ¯ä¸ªçŠ¶æ€ä¹‹é—´ï¼Œé•¿åº¦å•è°ƒä¸”å‰é©±å”¯ä¸€ï¼Œå†åŠ ä¸Šæ˜¾ç„¶è¿é€šï¼Œæ‰€ä»¥ $\{\rm S,link\}$ æœ¬è´¨ä¸Šæ˜¯ä¸€æ£µæ ‘ã€‚</p>
<p>5ã€äºæ˜¯è€ƒè™‘æ€ä¹ˆæ„é€ ã€‚å¤§æ¦‚å°±æ˜¯å¢é‡æ„é€ æ³•ã€‚</p>
<p>ï¼ˆ1ï¼‰æ¯æ¬¡åŠ å…¥ä¸€ä¸ªæ–°çš„çŠ¶æ€ $np$ æ—¶ï¼Œè€ƒè™‘ä¸Šä¸€ä¸ªè½¬ç§»åˆ°çš„çŠ¶æ€ $p$ ï¼ŒæŠŠ $L_{max}(np)$ è®¾ç½®ä¸º $L_{\max}(p) + 1$ ï¼ˆæ˜¾ç„¶ï¼‰ã€‚ä¸€ç›´æ²¿ç€åç¼€é“¾æ¥å‘ä¸Šè·³ï¼Œå¹¶ä¸”æŠŠé€”ä¸­çš„è½¬ç§»éƒ½è¿å‘ $np$ï¼Œå› ä¸ºåŸæ¥ä¸å­˜åœ¨å½“å‰å­—æ¯ $c_{now}$ çš„è½¬ç§»ï¼Œæ‰€ä»¥åŠ å…¥ä¸€ä¸ªå­—æ¯ä¹‹åè¦ä¸€èµ·æ”¹ã€‚</p>
<p>ï¼ˆ2ï¼‰è€ƒè™‘ä¸æ–­è·³ $p$ ï¼Œç›´åˆ°è·³åˆ°ä¸€ä¸ª $p$ å…·æœ‰ $c_{now}$ çš„è½¬ç§»ï¼ŒæŠŠè¿™ä¸ªè½¬ç§»åˆ°çš„çŠ¶æ€ç§°ä¹‹ä¸º $q$ã€‚é‚£ä¹ˆæ­¤æ—¶ $endpos(q)$ ä¼šå¤šå‡ºä¸€ä¸ªå…ƒç´ ï¼Œé•¿åº¦ä¸º $L_{\max}+1$ã€‚æ­¤æ—¶ç”±äº $L_{\max}(p)&lt;q$ æœ‰ä¸¤ç§æƒ…å†µéœ€è¦è€ƒè™‘ï¼š</p>
<ul>
<li><ol>
<li>$L_{\max}(q)=L_{\max}(p)+1$ï¼Œè¿™æ—¶ $q$ ä»£è¡¨çš„æ‰€æœ‰ä¸²çš„ $endpos$ ä¸å˜ã€‚è€ƒè™‘ $np$ å…·æœ‰è‡³å°‘ä¸€ä¸ªä¸åŒäº $q$ çš„çŠ¶æ€ï¼Œå³ $[1â€¦now]$ ï¼Œç°åœ¨æ’å…¥çš„æœ€é•¿å‰ç¼€ã€‚æ‰€ä»¥æ­¤æ—¶ä»¤ $\mathrm{link}(np)=q$ è€Œä¸æ˜¯åˆå¹¶ã€‚</li>
</ol>
</li>
<li><ol>
<li>$L_\max(q)&gt;L_\max(p)+1$ï¼Œè¿™æ—¶ $q$ ä¸­çš„ä¸²ï¼Œé•¿åº¦ä¸è¶…è¿‡ $L_\max(p)+1$ çš„ä¸²ä¼šå¤šä¸€ä¸ª $endpos$ï¼Œå³ $now$ï¼›ä½†æ˜¯å¤§äº $L_{\max}(p)+1$ çš„ä¸²åˆ™ä¸ä¼šã€‚æ‰€ä»¥æ­¤æ—¶éœ€è¦<strong>æ‹†å¼€çŠ¶æ€</strong> ã€‚è€ƒè™‘ä¸ºäº†ç»´æŠ¤ä¸€ä¸ªçŠ¶æ€é‡Œé¢æ‰€æœ‰ç‚¹çš„ $endpos$ ç›¸åŒï¼Œéœ€è¦æ–°å»ºä¸€ä¸ªçŠ¶æ€ $nq$ï¼Œä»£è¡¨åŸæ¥ä¸²ä¸­æ‰€æœ‰é•¿åº¦ä¸è¶…è¿‡ $L_\max(p)+1$ çš„ä¸²ã€‚å‘ç°è¿™ä¹ˆæ‹†åˆ†çš„è¯ï¼Œæœ‰ </li>
</ol>
</li>
</ul>
<script type="math/tex; mode=display">
\mathrm{link}(q)=\mathrm{link}(np) = nq</script><ul>
<li>3ã€å¯¹äºç¬¬äºŒç§æƒ…å†µï¼Œå‘ç°å°±ç±»ä¼¼æŠ æ‰ä¸€ä¸ªç‚¹ï¼Œæ¢è¿›å»ä¸€é¢—å­æ ‘ã€‚äºæ˜¯ä¹ä» $p$ å¼€å§‹åˆè¦ä¸æ–­å‘ä¸Šè·³ï¼ŒæŠŠæ‰€æœ‰ $trans=q$ çš„ç‚¹éƒ½æ”¹æˆ $nq$ã€‚</li>
</ul>
<p>å“¦ï¼Œå¯¹ï¼Œæ ‘ $\{\rm S,link\}$ æœ‰ä¸ªå­¦åå«åš $parent$ æ ‘æ¥ç€ã€‚</p>
<p>ç„¶åå°±å®Œäº†ï¼Œå°±å®Œäº†â€¦â€¦</p>
<p>å‘ç°å…¶å®åˆ°æœ€åSAMååˆ†çš„çŸ­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SAM</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> last, sz ;</span><br><span class="line">	<span class="keyword">int</span> trans[MAXN][Sigma] ;</span><br><span class="line">	<span class="keyword">int</span> len[MAXN], fa[MAXN] ;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123; last = sz = <span class="number">1</span> ; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> np = ++ sz ; </span><br><span class="line">		<span class="keyword">int</span> p = last, q, nq ;</span><br><span class="line">		last = np, f[np] = <span class="number">1</span> ;</span><br><span class="line">		len[np] = len[p] + <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">while</span> (p &amp;&amp; !trans[p][x]) </span><br><span class="line">			trans[p][x] = np, p = fa[p] ; </span><br><span class="line">		<span class="keyword">if</span> (!p)</span><br><span class="line">			<span class="keyword">return</span> fa[np] = <span class="number">1</span>, <span class="keyword">void</span>() ; </span><br><span class="line">		q = trans[p][x] ; </span><br><span class="line">		<span class="keyword">if</span> (len[q] == len[p] + <span class="number">1</span>)</span><br><span class="line">			<span class="keyword">return</span> fa[np] = q, <span class="keyword">void</span>() ;</span><br><span class="line">		nq = ++ sz, </span><br><span class="line">		len[nq] = len[p] + <span class="number">1</span>;</span><br><span class="line">		fa[nq] = fa[q], fa[q] = fa[np] = nq ; </span><br><span class="line">		<span class="built_in">memcpy</span>(trans[nq], trans[q], <span class="keyword">sizeof</span>(trans[q])) ; </span><br><span class="line">		<span class="keyword">while</span> (p &amp;&amp; trans[p][x] == q) </span><br><span class="line">			trans[p][x] = nq, p = fa[p] ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;S;</span><br></pre></td></tr></table></figure>
<h1 id="2-ä¾‹é¢˜"><a href="#2-ä¾‹é¢˜" class="headerlink" title="$2$ ä¾‹é¢˜"></a>$2$ ä¾‹é¢˜</h1><p>ç„¶è€Œæœ‰äº›ä¾‹é¢˜å°±æ˜¯å¾ˆæ°´ã€‚ã€‚ã€‚äºæ˜¯æ”¾åˆ°è¿™é‡Œæ¥äº†ã€‚ã€‚</p>
<h2 id="1-SDOI2016-ç”Ÿæˆé­”å’’"><a href="#1-SDOI2016-ç”Ÿæˆé­”å’’" class="headerlink" title="$1$ [SDOI2016]ç”Ÿæˆé­”å’’"></a>$1$ [SDOI2016]ç”Ÿæˆé­”å’’</h2><p>2016å¹´SDå±…ç„¶è€ƒè¿‡è¿™ç§æœ‰è¶£ä¸œè¥¿x</p>
<blockquote>
<p>è¯¢é—®æ¯åŠ å…¥ä¸€ä¸ªå­—ç¬¦æ—¶ï¼Œå½“å‰æ•´ä¸ªä¸²çš„æœ¬è´¨ä¸åŒå­ä¸²æ•°é‡ã€‚</p>
</blockquote>
<hr>
<p>å‘ç°åœ¨SAMé‡Œé¢çš„ $\rm link$ æ ‘ä¸Šï¼Œæœ¬è´¨ä¸åŒçš„å­ä¸²æ•°çš„å¢é‡æ˜¯ $L_{\max}(now)-L_{\max}(fa)$ã€‚</p>
<p>äºæ˜¯ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">è®¾faä¸ºqåŸæ¥çš„çˆ¶äº²ã€‚</span><br><span class="line">åˆ™åŸæ¥çš„è´¡çŒ®æ˜¯len(q) - len(fa) </span><br><span class="line">ç°åœ¨çš„è´¡çŒ®æ˜¯</span><br><span class="line">len(nq) - len(fa) + len(q) - len(nq) + len(np) - len(nq) </span><br><span class="line">= len(q) - len(a) + len(np) - len(nq)</span><br><span class="line">ç›¸å½“äºåªå¢åŠ äº†len(np) - len(nq)</span><br><span class="line">SAMé¢˜ = æ¨å¼å­é¢˜.jpg</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±åšå®Œäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SAM</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> last, sz ; </span><br><span class="line">	<span class="keyword">int</span> len[MAXN], fa[MAXN] ;</span><br><span class="line">	<span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; trans[MAXN] ;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123; last = sz = <span class="number">1</span> ; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> np = ++ sz ;</span><br><span class="line">		<span class="keyword">int</span> p = last, q, copy ; </span><br><span class="line">		len[np] = len[p] + <span class="number">1</span>, last = np ;</span><br><span class="line">		<span class="keyword">while</span> (p &amp;&amp; !trans[p].count(x)) </span><br><span class="line">			trans[p][x] = np, p = fa[p] ;</span><br><span class="line">		<span class="keyword">if</span> (!p) </span><br><span class="line">			<span class="keyword">return</span> fa[np] = <span class="number">1</span>, ans += <span class="number">1l</span>l * len[np], <span class="keyword">void</span>() ; </span><br><span class="line">		q = trans[p][x] ;</span><br><span class="line">		<span class="keyword">if</span> (len[q] == len[p] + <span class="number">1</span>) </span><br><span class="line">			<span class="keyword">return</span> fa[np] = q, ans += <span class="number">1l</span>l * (len[np] - len[q]), <span class="keyword">void</span>() ; </span><br><span class="line">		copy = ++ sz ;</span><br><span class="line">		fa[copy] = fa[q], </span><br><span class="line">		fa[q] = fa[np] = copy, </span><br><span class="line">		len[copy] = len[p] + <span class="number">1</span> ;</span><br><span class="line"><span class="comment">//		memcpy(trans[copy], trans[q], sizeof())</span></span><br><span class="line">		trans[copy] = trans[q] ; </span><br><span class="line">		<span class="keyword">while</span> (p &amp;&amp; trans[p][x] == q) trans[p][x] = copy, p = fa[p] ;</span><br><span class="line">		ans += <span class="number">1l</span>l * (- len[copy] + len[np]) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;S ;</span><br></pre></td></tr></table></figure>
<h2 id="2-LG3804ã€æ¨¡æ¿ã€‘SAM"><a href="#2-LG3804ã€æ¨¡æ¿ã€‘SAM" class="headerlink" title="$2$  LG3804ã€æ¨¡æ¿ã€‘SAM"></a>$2$  LG3804ã€æ¨¡æ¿ã€‘SAM</h2><blockquote>
<p>ç»™å®šä¸€ä¸ªåªåŒ…å«å°å†™å­—æ¯çš„å­—ç¬¦ä¸² $\rm S$,</p>
<p>è¯·ä½ æ±‚å‡º $\rm S$ çš„æ‰€æœ‰å‡ºç°æ¬¡æ•°ä¸ä¸º $1$ çš„å­ä¸²çš„å‡ºç°æ¬¡æ•°ä¹˜ä¸Šè¯¥å­ä¸²é•¿åº¦çš„æœ€å¤§å€¼ã€‚</p>
</blockquote>
<p>äºæ˜¯å‘ç°ï¼Œè¿™ä¸ªå‡ºç°æ¬¡æ•°çš„è¯ï¼Œå¯ä»¥åœ¨ $parent$ æ ‘ä¸Šç›´æ¥ $dp$ ä¸€éã€‚å¯¹äºæ¯ä¸ªå‡†ç¡®æ’å…¥çš„çŠ¶æ€ï¼Œåˆå§‹è®¾ç½®æˆ $1$ï¼Œç„¶å $dp$ å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k)) </span><br><span class="line">		dfs(to(k)), f[x] += f[to(k)] ;</span><br><span class="line">	<span class="keyword">if</span> (f[x] &gt; <span class="number">1</span>) ans = max(ans, f[x] * <span class="number">1l</span>l * S.len[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; (In + <span class="number">1</span>) ;</span><br><span class="line">	N = <span class="built_in">strlen</span>(In + <span class="number">1</span>), S.Init() ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) S.Insert(In[i] - <span class="string">'a'</span> + <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= S.sz ; ++ i) add(S.fa[i], i) ; dfs(<span class="number">1</span>) ; </span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-USACO06DEC-Milk-Patterns"><a href="#3-USACO06DEC-Milk-Patterns" class="headerlink" title="$3$ [USACO06DEC] Milk Patterns"></a>$3$ [USACO06DEC] Milk Patterns</h2><blockquote>
<p>æ‰¾ $\rm S$ ä¸­å‡ºç°æ¬¡æ•°è¶…è¿‡ $k$ çš„æœ€é•¿çš„ä¸²çš„é•¿åº¦ã€‚</p>
</blockquote>
<p>è¿˜æ˜¯ $dp$ ä¸€éï¼Œç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚</p>
<p><del>æˆ‘åœ¨å¹²ä»€ä¹ˆï¼Ÿ</del></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))</span><br><span class="line">		dfs(to(k)), f[u] += f[to(k)] ; </span><br><span class="line">	<span class="keyword">if</span> (f[u] &gt;= K) ans = max(S.len[u], ans) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>SAM</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ä¸²/åç¼€è‡ªåŠ¨æœº(SAM)</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘SPOJæ•°ä¸ªæ•°</title>
    <url>/2020/01/05/count-divisors/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>é¢˜ç›®åç§°æ˜¯æˆ‘çå†™çš„233</p>
<p>äº‹å®ä¸Šæ˜¯ $\rm SPOJ$ çš„ä¸‰<del>å€ç»éªŒ</del>é“é¢˜ï¼Œè§£å†³çš„æ˜¯ä»¥ä¸‹é—®é¢˜ï¼š</p>
<script type="math/tex; mode=display">
\sum _{i=1}^{n}\sigma_0(i^k)</script><p>å…¶ä¸­ $n,k$ ç»™å®šï¼Œ$n\leq 10^{10},\quad k\leq2^{64}$ </p>
<p><del>æˆ‘ä¹Ÿå¿˜äº†æ˜¯ä¸æ˜¯è¿™ä¸ªæ•°æ®èŒƒå›´åæ­£èƒ½è¿‡å°±å¯¹äº†</del></p>
<p>æäº¤é“¾æ¥ ï¼š</p>
<p>1 <a href="http://www.spoj.com/problems/DIVCNTK2/" target="_blank" rel="noopener">$k=2$  DIVCNTK2</a><br>2 <a href="http://www.spoj.com/problems/DIVCNTK3/" target="_blank" rel="noopener">$k=3$  DIVCNTK3</a><br>3 <a href="http://www.spoj.com/problems/DIVCNTK/" target="_blank" rel="noopener">$\mathrm{input} ~k$  DIVTNK(general)</a></p>
<a id="more"></a>
<h2 id="æ­£ç»é¢˜è§£"><a href="#æ­£ç»é¢˜è§£" class="headerlink" title="æ­£ç»é¢˜è§£"></a>æ­£ç»é¢˜è§£</h2><p>å…¶å®å¾ˆæ°´çš„ï¼Œå¯¹å§ï¼Ÿå·²çŸ¥ $\forall p\in \mathbb{P,}~\sigma_0(p^k)=k+1$ï¼Œæ‰€ä»¥æœ‰ $f(p)=k+1,f(p^j)=jk+1$ äºæ˜¯è¿™ä¸œè¥¿çœ‹èµ·æ¥å¯ä»¥æ•ˆä»¿åŸæ¥çš„æ€è·¯ç›´æ¥è®¾ä¸€ä¸ª $f(p)=1,f(p)=k$ æ¥åšï¼Œç„¶åå°±ã€‚ã€‚ã€‚å°±ä¸å¯¹äº†ï¼</p>
<p>ç„¶åæˆ‘å°±å¾ˆå¥‡æ€ªå•Šï¼Œä¸ºå•¥æŒ‰ç…§å…¬å¼æ¨ï¼Œ$g$ åº”è¯¥æ²¡æ¨é”™ï¼Œä½†æ˜¯ç»“æœä¸å¯¹ï¼Ÿè¿·æƒ‘äº†å¤§åŠä¸ªä¸Šåˆã€‚</p>
<p>â€¦åˆ°æœ€åè¿™ä¸ªé¢˜çº ç»“äº†åŠå¤©ï¼ŒåŸå› æ˜¯æˆ‘å¿˜äº† $f(p)=k$ è¿™ä¸œè¥¿ <strong>ä¸æ˜¯ç§¯æ€§å‡½æ•°</strong> ï¼Œæ‰€ä»¥ä¸èƒ½å»æ¨ $f(k)$ï¼Œä¹Ÿå°±æ˜¯è¯´<strong>ä¸èƒ½ç›´æ¥æ‹†</strong>ã€‚</p>
<p>ç„¶åä¸ºäº†è¿™ä¸ªäº‹å„¿è¿˜å» uoj ç¾¤ä¸¢äº†ä¸€ä¸Šåˆäººï¼ŒLife so hard â€¦.</p>
<p>æ‰€ä»¥æ€ä¹ˆè§£å†³ï¼Ÿè€ƒè™‘åªç»´æŠ¤ä¸€ä¸ª $f(p)=1$ï¼Œç„¶åè®¡ç®—çš„æ—¶å€™ $\times ~(k+1)$ å°±å®Œäº†ã€‚</p>
<p>æœ€åè¿˜æ˜¯ <a href="https://www.cnblogs.com/bestwyj" target="_blank" rel="noopener"><code>iostream</code></a> ç¥ä»™åœ¨Luoguçš„è®¨è®ºåŒºå¸®äº†æˆ‘ï¼Œååˆ†æ„ŸåŠ¨555</p>
<p>æ€»ç»“ï¼šæ„Ÿè§‰è‡ªå·±æ˜¯ä¸ªå¼Ÿå¼Ÿqaq</p>
<p>ç„¶åä»¥ä¸‹æ˜¯æ­£ç¡®å†™æ³•ï¼Œåªæ¨ä¸€ä¸ª $h$ å°±å¥½äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">LL n, e ;</span><br><span class="line">LL val[N], h[N] ;</span><br><span class="line"><span class="keyword">int</span> s, tot, cnt ;</span><br><span class="line">LL id1[N], id2[N] ;</span><br><span class="line"><span class="keyword">int</span> T, chk[N], pr[N] ;</span><br><span class="line"><span class="keyword">const</span> LL Inv2 = <span class="number">500000004</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">    chk[<span class="number">0</span>] = chk[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!chk[i])</span><br><span class="line">            pr[++ cnt] = i ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i * pr[j] &gt; m) <span class="keyword">break</span> ;</span><br><span class="line">            chk[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">S</span><span class="params">(LL p, <span class="keyword">int</span> q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pr[q] &gt;= p) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    LL id = p &lt;= s ? id1[p] : id2[n / p] ;</span><br><span class="line">    LL ans = h[id] * (e + <span class="number">1</span>) - q * (e + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = q + <span class="number">1</span> ; k &lt;= cnt ; ++ k)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1l</span>l * pr[k] * pr[k] &gt; p)</span><br><span class="line">            <span class="keyword">break</span> ; LL m = pr[k], t = pr[k] ; <span class="keyword">int</span> o ;</span><br><span class="line">        <span class="keyword">for</span> (o = <span class="number">1</span> ; m &lt;= p ; ++ o, m *= t)</span><br><span class="line">            ans += <span class="number">1u</span>ll * (o * e + <span class="number">1</span>) * (S(p / m, k) + (o &gt; <span class="number">1</span>)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    sieve(N - <span class="number">1</span>) ;</span><br><span class="line">    LL l, r, w, t ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n, e = <span class="number">3</span> ;</span><br><span class="line">        s = <span class="built_in">sqrt</span>(n) ; tot = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (l = <span class="number">1</span> ; l &lt;= n ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">            t = n / l ; r = n / t ;</span><br><span class="line">            val[++ tot] = t ; h[tot] = t - <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (t &lt;= s) id1[t] = tot ; <span class="keyword">else</span> id2[l] = tot ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)&#123;</span><br><span class="line">            LL nowp = <span class="number">1l</span>l * pr[i] * pr[i], w, id ;</span><br><span class="line">            <span class="keyword">if</span> (nowp &gt; n) <span class="keyword">break</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; val[j] &gt;= nowp ; ++ j)&#123;</span><br><span class="line">                w = val[j] / pr[i] ;</span><br><span class="line">                id = (w &lt;= s) ? id1[w] : id2[n / w] ;</span><br><span class="line">                h[j] -= h[id] - (i - <span class="number">1</span>) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; S(n, <span class="number">0</span>) + <span class="number">1</span> &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å½©è›‹"><a href="#å½©è›‹" class="headerlink" title="å½©è›‹"></a>å½©è›‹</h2><p>ä¸Šåˆåœ¨å» uoj ç¾¤é‡Œä¸¢è„¸ä¹‹å‰ï¼Œæ‰¾åˆ°æ¬§ç¥ <code>ouuuyuuu</code> ï¼ˆæ¬§ç¥ï¼šè¯´äº†å¤šå°‘éæˆ‘ä¸æ‰“ç®—èµ·è¿™ä¸ªIDï¼ï¼Ÿï¼‰â€”â€”æˆ‘æ ¡ç°å½¹MOæœ€å¼ºæˆ˜åŠ›ï¼ŒSD-01ï¼ŒCMO2019éé›†è®­é˜Ÿç¬¬ä¸€ã€‚æ‰¾ä»–æ˜¯å› ä¸ºæ›¾ç»ç»™ä»–çœ‹è¿‡æœæ•™ç­›ï¼Œä»–è§‰å¾—ç®€å•ï¼Œäºæ˜¯æˆ‘å°±è®©ä»–ç°åœº $5min$ å­¦å®Œäº† $\rm Min25$ ç­›ï¼ˆå¯èƒ½æ•ˆæœä¸æ˜¯å¾ˆå¥½ï¼‰ç„¶åé—®ä»–ä¸ºä»€ä¹ˆä¸å¯¹ã€‚</p>
<p>ç„¶åæˆ‘ä¿©ï¼š</p>
<blockquote>
<p>å¥½è¿·å•Šï¼ˆé½å£°ï¼‰</p>
</blockquote>
<p>æ‰€ä»¥äº‹å®è¯æ˜ï¼Œå¼±èœå¼±åˆ°ä¸€å®šåœ°æ­¥æ˜¯å¯ä»¥å¸¦é£ç¥ä»™çš„ã€‚qedã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>SPOJ</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°æ±‚å’Œ/Min_25ç­›</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘#loj6053 ç®€å•çš„å‡½æ•°</title>
    <url>/2020/01/05/loj6053/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>ç»™å®šå‡½æ•° $f(x)$ æ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
\begin{array}{l}{\text { 1. } f \left (1\right) =1} \\ {\text { 2. } f\left(p^{c}\right)=p \oplus c} \qquad \oplus\text{ä»£è¡¨å¼‚æˆ–è¿ç®—}\\ {\text { 3. } f\left(a b\right)=f\left(a\right) f\left(b\right) \qquad (a,b)=1}\end{array}</script><p>æ±‚ $\sum f(x)$, $n\leq 10^{10}$</p>
</blockquote>
<p>å•ç‹¬æ‹¿å‡ºä¸€é“é¢˜æ¥æ•´ç†ä¸€ä¸‹ï¼Œä¹Ÿç®—æ˜¯ç†ä¸€ä¸‹ç”¨ Min_25 è§£é¢˜çš„ä¸€ç‚¹æ€è·¯å§ã€‚</p>
<a id="more"></a>
<p>å—¯ï¼Œé¦–å…ˆæ€è€ƒ Min_25 ç­›æœ¬è´¨ä¸Šéœ€è¦åšä»€ä¹ˆï¼š</p>
<p>1ã€å¯¹äºæ¯ä¸ª $x = \lfloor \frac{n}{y}\rfloor$ ï¼Œè¿™æ ·ä¸åŒçš„ $x$ å…±æœ‰ $O(\sqrt n)$ ä¸ªï¼Œéœ€è¦å¿«é€Ÿå¾—åˆ° </p>
<script type="math/tex; mode=display">
\sum_{i=1}^x \boldsymbol{F'}(i)</script><p>çš„å€¼ã€‚</p>
<p>2ã€éœ€è¦æ ¹æ®é€’æ¨å¼æ±‚å‡º $g$ æ¥ï¼ŒåŒæ—¶ç”±äºç©ºé—´ä¸å¤Ÿï¼Œè€Œæˆ‘ä»¬å…¶å®åªéœ€è¦çŸ¥é“ $g(x,j)$ åœ¨æ‰€æœ‰ $x = \lfloor \frac{n}{y}\rfloor$ å¤„çš„å–å€¼å°±å¥½ï¼Œæ‰€ä»¥è€ƒè™‘ç”¨ä¸¤ä¸ª $\sqrt n$ çš„æ ‡å·æ¥å­˜ã€‚</p>
<p>3ã€åœ¨ $\rm S$ ä¸­ï¼Œåˆ†å·¥å¾ˆæ˜ç¡®ï¼Œ<code>for</code> ä¹‹å‰æ±‚çš„æ˜¯æ‰€æœ‰è´¨æ•°å¤„çš„ $f$ å’Œï¼Œç„¶è€Œç”±äºç›´æ¥ç®— $f$ æ±‚å‡ºçš„æ˜¯ $1\sim n$ çš„è´¨æ•°å¤„çš„ $f$ å’Œï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ $j+ 1\sim n$ çš„ï¼Œæ‰€ä»¥æŠŠ $1\sim j$ çš„å‡å»ï¼›å¯¹äºåˆæ•°ï¼Œæˆ‘ä»¬æšä¸¾æ¯ä¸ª $\geq j+1$ çš„è´¨æ•°ï¼Œç„¶å $\log$ æ¬¡å‘ä¸Šè®¡ç®—ï¼š</p>
<script type="math/tex; mode=display">
\sum_{p_{k}^{e} \leq n, k>j} f\left(p_{k}^{e}\right)\left(\mathrm{S}\left(\frac{n}{p_{k}^{e}}, k\right)+[e>1]\right)</script><p>ç›´è§‚ä¸Šå¯ä»¥æ„Ÿè§‰å‡ºæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¸Šç•Œ $n$ï¼Œå³ </p>
<script type="math/tex; mode=display">
\sum_{x=1}^{\lfloor\frac{n}{\ln n}\rfloor} \log_xn<n</script><p>ã€‚ã€‚ã€‚ç„¶è€Œä¼¼ä¹å¹¶æ²¡æœ‰ç”¨ï¼Œå› ä¸ºçº¿æ€§ç­›ä¹Ÿæ˜¯è¿™ä¸ªå¤æ‚åº¦233</p>
<p>ç„¶åè¯´é¢˜ï¼Œè€ƒè™‘è´¨æ•°å¤„çš„å–å€¼ï¼š</p>
<script type="math/tex; mode=display">
f(p)=p \operatorname{xor} 1=\left\{\begin{array}{ll}{p+1} & {p=2} \\ {p-1} & {p\not =2}\end{array}\right.</script><p>ç„¶åå°±å¯ä»¥ç»´æŠ¤ä¸€ä¸ª $n$ ä¸€ä¸ª $1$ï¼Œè´¨æ•°æ¬¡å¹‚å°±æ˜¯ $f(p^c)=p\oplus c$ æ˜“æ±‚ï¼Œæœ€åå†åŠ ä¸Š $2$ å¤„å¤šå‡å»çš„ $2$ å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">LL n ;</span><br><span class="line">LL val[N] ;</span><br><span class="line">LL g[N], h[N] ;</span><br><span class="line"><span class="keyword">int</span> s, tot, cnt ;</span><br><span class="line"><span class="keyword">int</span> chk[N], pr[N] ;</span><br><span class="line">LL id1[N], id2[N], sp[N] ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1000000007</span> ;</span><br><span class="line"><span class="keyword">const</span> LL Inv2 = <span class="number">500000004</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">    chk[<span class="number">0</span>] = chk[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!chk[i])</span><br><span class="line">            pr[++ cnt] = i,</span><br><span class="line">            sp[cnt] = (sp[cnt - <span class="number">1</span>] + i) % P ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i * pr[j] &gt; m) <span class="keyword">break</span> ;</span><br><span class="line">            chk[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">S</span><span class="params">(LL p, <span class="keyword">int</span> q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pr[q] &gt;= p) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    LL id = p &lt;= s ? id1[p] : id2[n / p] ;</span><br><span class="line">    LL ans = ((g[id] - h[id] - sp[q] + q) % P + P) % P ;</span><br><span class="line">    <span class="keyword">if</span> (!q) ans += <span class="number">2</span> ;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; ans &lt;&lt; " " &lt;&lt; p &lt;&lt; " " &lt;&lt; q &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = q + <span class="number">1</span> ; k &lt;= cnt ; ++ k)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1l</span>l * pr[k] * pr[k] &gt; p)</span><br><span class="line">            <span class="keyword">break</span> ; LL m = pr[k], t = pr[k] ; <span class="keyword">int</span> o ;</span><br><span class="line">        <span class="keyword">for</span> (o = <span class="number">1</span> ; m &lt;= p ; ++ o, m *= t)</span><br><span class="line">            ans = (ans + <span class="number">1l</span>l * (pr[k] ^ o) * (S(p / m, k) + (o &gt; <span class="number">1</span>)) % P) % P ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; s = <span class="built_in">sqrt</span>(n) ;</span><br><span class="line">    sieve(s) ; LL l, r, w, t ;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"1"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (l = <span class="number">1</span> ; l &lt;= n ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">        t = n / l ; r = n / t ;</span><br><span class="line">        val[++ tot] = t ; h[tot] = ((t - <span class="number">1</span>) % P + P) % P  ;</span><br><span class="line">        g[tot] = ((t % P * (t % P + <span class="number">1</span>) % P * Inv2 % P - <span class="number">1</span>) % P + P) % P ;</span><br><span class="line">        <span class="keyword">if</span> (t &lt;= s) id1[t] = tot ; <span class="keyword">else</span> id2[l] = tot ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)&#123;</span><br><span class="line">        LL nowp = <span class="number">1l</span>l * pr[i] * pr[i], w, id ;</span><br><span class="line">        <span class="keyword">if</span> (nowp &gt; n) <span class="keyword">break</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; val[j] &gt;= nowp ; ++ j)&#123;</span><br><span class="line">            w = val[j] / pr[i] ;</span><br><span class="line">            id = (w &lt;= s) ? id1[w] : id2[n / w] ;</span><br><span class="line">            (h[j] -= h[id] - (i - <span class="number">1</span>)) %= P ;</span><br><span class="line">            (g[j] -= <span class="number">1l</span>l * pr[i] * (g[id] - sp[i - <span class="number">1</span>]) % P) %= P  ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= tot ; ++ i) cout &lt;&lt; h[i] &lt;&lt; " " &lt;&lt; g[i] &lt;&lt; endl ;</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; (S(n, <span class="number">0</span>) + <span class="number">1</span>) % P &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€æƒ³åˆ° zzq å‡ºè¿™ä¸ªé¢˜çš„å¹´çºªæˆ‘è¿˜åœ¨ç©æ³¥å·´ï¼Œå°±çŸ¥é“è‡ªå·±é€€å½¹é¢„å®šäº†ã€‚</p>
<p>æ˜¯å•Šï¼Œæœ¬æ¥å°±æ˜¯å¼ºè¡Œç»­å‘½ï¼Œæ‰€ä»¥æ— è®ºç»“æœæ€ä¹ˆæ ·ä¹Ÿåªèƒ½æ¬£ç„¶æ¥å—äº†å§ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>loj</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°æ±‚å’Œ/Min_25ç­›</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘Min_25ç­›</title>
    <url>/2020/01/04/min25%E7%AD%9B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æºè‡ªä¸€ä¸ªæ—¥æœ¬è€å“¥ç¥ä»™çº§åˆ«çš„æ„é€ ï¼ŒåŸé“¾æ¥åœ¨è¿™é‡Œï¼š<a href="https://min-25.hatenablog.com/entry/2018/11/11/172216" target="_blank" rel="noopener">$min\_25â€™s~blog$</a></p>
<p>å•Šï¼Œå­¦äº†å¥½ä¹…å•Šâ€¦æ€»æ˜¯å­¦ä¸ä¼šå‘¢ï¼Œå†èªæ˜ä¸€ç‚¹å§ã€‚</p>
<a id="more"></a>
<p>ç„¶å $min25$ ç­›å¤§æ¦‚æ˜¯å¯¹ç§¯æ€§å‡½æ•°æ±‚å’Œçš„ä¸€ç§æ–¹æ³•ã€‚ä»–æ±‚å’Œçš„å‡½æ•°æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š</p>
<p>1ã€$\boldsymbol{F}$ æ˜¯æ•´å€¼ç§¯æ€§å‡½æ•° </p>
<p>2ã€å¹¿ä¹‰ä¸Šè®²ï¼Œéœ€è¦ ${i\in \mathbb{P}},\boldsymbol{F}(i),\boldsymbol{F}(i^k)$ è¿™ä¿©ä¸œè¥¿å¯ä»¥å¾ˆç®€å•åœ°è®¡ç®—</p>
<p>3ã€ç„¶è€Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯ $f$ è¿™ä¸œè¥¿åœ¨ç´ æ•°å¤„å¯ä»¥åŒ–ä½œä¸€ä¸ªä½æ¬¡å¤šé¡¹å¼ï¼ˆå³å®Œå…¨ç§¯æ€§ï¼Œå¦åˆ™ä¸èƒ½æå‡ºæ¥ï¼‰ã€‚</p>
<p>å—¯ï¼Œç¬¬ä¸‰æ¡æ˜¯å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½ä¼šæŠŠåŸå‡½æ•°æ‹†åˆ†ä¸º $\sum _{i\in\mathbb{P}} i^k$ è¿™ç§å½¢å¼ï¼Œå› ä¸ºè¿™ç§å½¢å¼çš„å’Œæ¯”è¾ƒå¥½æ±‚ã€‚ç„¶è€Œå…¶å®è¿™ä¹ˆè¯´æ¥ååˆ†çš„naiveï¼Œæ¯•ç«Ÿ $\varphi,\mu$ ä¹Ÿå¾ˆå¥½æ±‚ã€‚</p>
<p>å¤§æ¦‚æ€æƒ³å°±æ˜¯ç¥ä»™æ„é€ ï¼Œæ¯”æœæ•™ç­›ç¥ä»™è®¸å¤šçš„æ„é€ ã€‚å½“ç„¶ä¹Ÿæœ‰äººç®¡è¿™ä¸ªå«â€œæ‰©å±•åŸƒæ‹‰æ‰˜è‰²å°¼ç­›â€â€¦ä¸è¿‡ä¹Ÿç¡®å®å¾ˆå½¢è±¡ã€‚</p>
<h1 id="1-æ„é€ ä¸€ä¸ª-g-n-j"><a href="#1-æ„é€ ä¸€ä¸ª-g-n-j" class="headerlink" title="$1$ æ„é€ ä¸€ä¸ª $g(n,j)$"></a>$1$ æ„é€ ä¸€ä¸ª $g(n,j)$</h1><p>æœ¬èŠ‚å…ˆå‡è®¾ $f$ ä¸º <strong>å®Œå…¨ç§¯æ€§å‡½æ•°</strong>ã€‚</p>
<p>å—¯ï¼Œè¿™ä¸œè¥¿æ˜¯è¿™ä¹ˆä¸€ç§å½¢å¼ ï¼š</p>
<script type="math/tex; mode=display">
g(n,j)=\sum_{i=1}^{n}f(i)\cdot\max([i\in\mathbb{P}],[\mathrm{minf}(i)> prime_j])</script><p>å…¶ä¸­ $[]$ è¿˜æ˜¯è‰¾ä½›æ£®æ‹¬å·ï¼Œ$prime_j$ è¡¨ç¤ºçº¿æ€§ç­›å‡ºæ¥çš„è´¨æ•°é›†åˆä¸­ç¬¬ $j$ å¤§çš„å…ƒç´ ï¼Œ$\mathrm{minf}(i)$ è¡¨ç¤º $i$ çš„æœ€å°ç´ å› å­ã€‚</p>
<p>ç›´è§‚åœ°æ¥è¯´ï¼Œ$g(n,j)$ è¡¨ç¤ºçš„å°±æ˜¯ $n$ ä»¥å†…çš„åœ¨åŸƒç­›ç®—æ³•è¿›è¡Œç¬¬ $i$ è½®åå°šæœªè¢«ç­›å»çš„æ•°çš„ $f$ çš„å’Œã€‚</p>
<p>ç„¶åæ€è€ƒæ€ä¹ˆè½¬ç§»ï¼Œå‡è®¾æšä¸¾åˆ°äº† $j$ï¼š</p>
<p>1ã€å¦‚æœå½“å‰ $prime_j^2&gt;n$ ï¼Œé‚£ä¹ˆå¯¹äºå½“å‰çš„ $prime$ ä¸å¯èƒ½å­˜åœ¨æ›´å¤šçš„ $\mathrm{minf}(i)&gt; prime_j$ ã€‚æ‰€ä»¥æ­¤æ—¶ $g(n,j)=g(n,j-1)$<br>2ã€å¦‚æœå½“å‰ $prime_j^2\leq n$ï¼Œå³ $\lfloor \frac{n}{prime_j}\rfloor \geq prime_j$ é‚£ä¹ˆè€ƒè™‘åº”è¯¥å‡å»é‚£äº›æœ€å°ç´ å› å­ä¸º $prime_j$ çš„æ•°çš„ $f$ å€¼ã€‚ ç„¶è€Œè¿™ä¸ªå€¼å‘ç°æœ¬è´¨ä¸Šå¯ä»¥é€šè¿‡ $g$ æ•°ç»„æœ¬èº«æ¥åˆ»ç”»ã€‚å³ï¼š</p>
<script type="math/tex; mode=display">
g(n,j)=g(n,j-1) - f(prime_j)\cdot (g(\lfloor \frac{n}{prime_j}\rfloor,j-1)-g(prime_{j-1},j-1))</script><p>ï¼ˆ1ï¼‰é¦–å…ˆï¼Œæ ¹æ®ä¸Šæ–‡å‡è®¾ï¼Œ$f$ åº”è¯¥æ˜¯ä¸€ä¸ªå®Œå…¨ç§¯æ€§å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æå‡ºæ¥ã€‚<br>ï¼ˆ2ï¼‰ç¬¬äºŒé¡¹çš„å‰ä¸€åŠæ˜¯æ‰€æœ‰å‰”é™¤æ‰ $prime_j$ è¿™ä¸€é¡¹ä¹‹åï¼Œæœ€å°è´¨å› å­ $&gt;prime_{j-1}$ å³ $\geq prime_j$ çš„æ•°å­—çš„å’Œï¼Œå› ä¸ºè¿™äº›æ•°å­—æ²¡æœ‰æ¯” $prime_j$ æ›´å°çš„è´¨å› å­ï¼Œæ‰€ä»¥è¦å‡å»ï¼›åé¢æ˜¯è¦å‡å»å‰ä¸€é¡¹é‡Œé¢é¡ºå¸¦è®¡ç®—äº†çš„ $&lt;prime_j$ çš„è´¨æ•°ï¼Œå› ä¸ºæ˜¾ç„¶ $1\sim prime_{j-1}$ ä¸å¯èƒ½å­˜åœ¨ä»¥æ¯” $prime_{j-1}$ å¤§çš„è´¨æ•°ä¸ºæœ€å°è´¨å› å­çš„æ•°ï¼Œæ‰€ä»¥ç´¯åŠ çš„åªæœ‰è´¨æ•°ï¼›è€Œæ®å®šä¹‰è¿™ä¸€éƒ¨åˆ†éœ€è¦å€è®¡ç®—è¿›å»ï¼Œä½†æ˜¯ä»–ä»¬ $ \times ~prime_j$ ä¹‹åçš„æ•°æ˜¾ç„¶æœ€å°è´¨å› å­ä¸æ˜¯ $prime_j$ ã€‚</p>
<p>æ‰€ä»¥æœ€ç»ˆçš„é€’æ¨å¼ï¼Œä¸ºäº†ç®€æ´ç”¨ $p_j$ æ›¿ä»£ $prime_j$:</p>
<script type="math/tex; mode=display">
g_{(n,j)}=\begin{cases}g_{(n,j-1)} - f_{(p_j)}\cdot (g_{(\lfloor \frac{n}{p_j}\rfloor,j-1)}-g_{(p_{j-1},j-1)}) & \mathrm{if}~(p_j^2\leq n) \\\ g_{(n,j-1)} & \mathrm{otherwise}\end{cases}</script><p>â€¦é¬¼çŸ¥é“æˆ‘ä¸ºäº†ç†è§£è¿™éƒ¨åˆ†<del>æ‰“äº†å¤šä¹…çš„æ‘†</del>èŠ±äº†å¤šå°‘æ—¶é—´å’Œç²¾åŠ›233</p>
<p>ä¸è¿‡è§‚å¯Ÿæ•´sä¸ª $g$ çš„é€’æ¨ï¼Œå¯ä»¥å‘ç°åªè·Ÿ $f$ åœ¨è´¨æ•°å¤„çš„å–å€¼æœ‰å…³ã€‚æ‰€ä»¥å¦‚æœå¯¹äºä¸€ä¸ªç§¯æ€§å‡½æ•° $\boldsymbol{F}$ï¼Œ æˆ‘ä»¬å¯ä»¥å°†å…¶æ‹†åˆ†æˆå‡ ä¸ªå®Œå…¨ç§¯æ€§å‡½æ•° $\boldsymbol{Fâ€™,Fâ€™â€™â€¦.}$ åœ¨ $x\in \mathbb{P}$ å¤„çš„ä¹˜ç§¯æˆ–è€…æ˜¯åŠ å’Œï¼Œå°±å¯ä»¥å®ç°å¿«é€Ÿè®¡ç®— $g$ã€‚</p>
<p>è¿™ä¹Ÿæ­£æ˜¯ä¸Šæ–‡ä¸­å¯¹äº $\boldsymbol{F}$ çš„é™åˆ¶ã€‚å¦‚æœ $\boldsymbol{F}$ æ˜¯ä¸ªç®€å•çš„ä½æ¬¡å¤šé¡¹å¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŒ‰ç…§å¹‚æ¬¡æ‹†åˆ†æˆå‡ é¡¹åˆ†åˆ«æ±‚å’Œå†ç›¸åŠ ï¼›æˆ–è€…æ›´å¹¿ä¹‰ä¸€ç‚¹ï¼Œ $\boldsymbol{F}$  å¯ä»¥æ‹†åˆ†æˆè®¸å¤šåœ¨è´¨æ•°å¤„ä»¥æ±‚å¾—çš„å‡½æ•°ï¼Œé‚£ä¹ˆåŒæ ·é€‚ç”¨äº $min25$ ç­›</p>
<h1 id="2-æ±‚å’Œ"><a href="#2-æ±‚å’Œ" class="headerlink" title="$2$ æ±‚å’Œ"></a>$2$ æ±‚å’Œ</h1><p>ç»ˆäºè¦æ±‚å’Œå•¦ï¼</p>
<p>é¦–å…ˆä»¤ $\mathrm{S}(n,j)=\sum_{i}^{n} f(i) [\mathrm{minf}(i)&gt;prime_j]$ ï¼Œé‚£ä¹ˆæœ€ç»ˆç»“æœå°±æ˜¯ $\mathrm{S}(n,0)+f(1)$ ã€‚æœ€åçš„ $1$ æ˜¯å› ä¸º $1$ æ²¡æœ‰è´¨å› å­ã€‚</p>
<p>ï¼ˆps : ç„¶è€Œä¼¼ä¹ $f(1)\equiv 1$ï¼Ÿå› ä¸ºæ¯•ç«Ÿ $f(x)$ æ˜¯ç§¯æ€§å‡½æ•°ï¼Œé‚£ä¹ˆå°±ä¸€å®šæœ‰ $f(x)\cdot f(1)=f(x)$â€¦â€¦é™¤äº† $f(x)\equiv0$ è¿™ç§æƒ…å†µï¼‰</p>
<p>é‚£ä¹ˆå°±å¯ä»¥çŸ¥é“ $\rm S$ å¯ä»¥è¿™ä¹ˆæ¨ï¼š</p>
<script type="math/tex; mode=display">
\mathrm{S}(n,j)= g(n,|\{p \}|) - g(p_{j-1},j-1)+\sum_{p_{k}^{e} \leq n, k>j} f\left(p_{k}^{e}\right)\left(\mathrm{S}\left(\frac{n}{p_{k}^{e}}, k\right)+[e>1]\right)</script><p>å‰åŠéƒ¨åˆ†æ˜¯æ‰€æœ‰è´¨æ•°çš„è´¡çŒ®ï¼ŒåŒæ ·ç”±äºä¸å­˜åœ¨æ¯”æœ€å¤§çš„è´¨æ•° $p_{\max}$ æ›´å¤§çš„è´¨å› å­ï¼Œæ‰€ä»¥ç¬¬ä¸€é¡¹å°±æ˜¯ç»Ÿè®¡äº†æ‰€æœ‰è´¨æ•°ï¼›åä¸€é¡¹åˆ™æ˜¯æ ¹æ®å®šä¹‰å‡æ‰äº†æ¯” $j$ å°çš„è´¨æ•°çš„è´¡çŒ®ã€‚</p>
<p>ååŠéƒ¨åˆ†è®¡ç®—åˆæ•°ã€‚è¿™ä¸ªåœ°æ–¹è€ƒè™‘æšä¸¾åˆæ•°çš„æœ€å°è´¨å› å­ï¼ˆæ­¤å¤„æ˜¾ç„¶ $&gt;prime_j$ï¼Œå³æšä¸¾ $k&gt;j$ï¼‰ï¼Œç„¶ååˆ©ç”¨ç§¯æ€§å‡½æ•°çš„æ€§è´¨æå–ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯æœ€åæœ‰ä¸€ä¸ªè‰¾ä½›æ£®æ‹¬å·ï¼Œ$[e&gt;1]$ï¼Œå…¶æ„ä¹‰æ˜¯å‰æ–‡æåˆ°è¿‡çš„â€œ $1$ æ²¡æœ‰è´¨å› å­â€ï¼Œè€Œå½“ $e=1$ æ—¶ï¼Œ$prime_k^1\in \{prime\}$ , æ˜¯è´¨æ•°, åœ¨å‰åŠéƒ¨åˆ†è®¡ç®—è¿‡äº†ã€‚</p>
<p>å—¯ï¼Œäºæ˜¯è¿™ä¸œè¥¿å°±å¯ä»¥æš´åŠ› $dfs$ äº†ã€‚ç¨³å¾—å¾ˆã€‚</p>
<h1 id="3-å¤æ‚åº¦"><a href="#3-å¤æ‚åº¦" class="headerlink" title="$3$ å¤æ‚åº¦"></a>$3$ å¤æ‚åº¦</h1><p>å¤§å®¶éƒ½è¯´æ˜¯ $\frac{n^{\frac{3}{4}}}{\ln n}$ï¼Œç„¶è€Œç¥ä»™è¯´å…¶å®åº”è¯¥æ˜¯ $O(n^{1-\epsilon})$ï¼Œæ˜¯ä¸€ç§äºšçº¿æ€§ç­›æ³•ï¼Œä½†æ„Ÿè§‰ç”¨åœ¨ $n\leq 1e10$ è¿˜æ˜¯å¯ä»¥ $1.5s$ ä»¥å†…å‡ºç»“æœçš„ã€‚</p>
<p>ç„¶åæœ‰ä¸ªå°ç»†èŠ‚ï¼Œå°±æ˜¯å‘ç°ç®— $g$ è¿™ä¸ªä¸œè¥¿çš„æ—¶å€™ï¼Œç©ºé—´å¼€ä¸ä¸‹ã€‚ç„¶è€Œå…¶å®å‘ç° </p>
<script type="math/tex; mode=display">
\left\lfloor\frac{\left\lfloor\frac{n}{a}\right\rfloor}{b}\right\rfloor=\left\lfloor\frac{n}{a b}\right\rfloor</script><p>è¿™ä¸œè¥¿è¯´æ˜äº†ï¼Œ$n$ é™¤ä»¥æŸä¸ªæ•°å¾—åˆ°çš„å€¼å…¶å®æ˜¯æœ‰é™çš„ã€‚äºæ˜¯å°±å¯ä»¥ç›´æ¥å½“ $k&gt;\sqrt n$ æ—¶ï¼Œç”¨ç¬¬ä¸€å¼ è¡¨å­˜ $\lfloor \frac{n}{k}\rfloor$ ï¼›å½“ $k\leq \sqrt n$ æ—¶ï¼Œç”¨ç¬¬äºŒå¼ è¡¨å­˜ $k$ã€‚åŒæ—¶ $g$ çš„ç¬¬äºŒç»´ä¹Ÿå¯ä»¥ç›´æ¥æ»šæ‰ã€‚å‘ç°è¿™æ ·ç©ºé—´å¤æ‚åº¦å°±åšåˆ°äº† $O(\sqrt n)$ ã€‚</p>
<h1 id="4-ä¾‹é¢˜"><a href="#4-ä¾‹é¢˜" class="headerlink" title="$4$ ä¾‹é¢˜"></a>$4$ ä¾‹é¢˜</h1><h2 id="LG5325-ã€æ¨¡æ¿ã€‘Min-25ç­›"><a href="#LG5325-ã€æ¨¡æ¿ã€‘Min-25ç­›" class="headerlink" title="LG5325 ã€æ¨¡æ¿ã€‘Min_25ç­›"></a>LG5325 ã€æ¨¡æ¿ã€‘Min_25ç­›</h2><blockquote>
<p>ç»™å®šç§¯æ€§å‡½æ•° $f$ï¼Œæ»¡è¶³ $p\in \mathbb{P},f(p^k)=p^k(p^k-1)$ ã€‚æ±‚å’Œ</p>
<p>$n\leq 10^{10}$ã€‚</p>
</blockquote>
<p>å‘ç°è¿™å°±æ˜¯æ¯”è¾ƒå¥—è·¯çš„å¤šé¡¹å¼æ‹†æˆå•é¡¹å¼ï¼Œæ‰€ä»¥å°±ç›´æ¥æ‹†æˆå¹³æ–¹é¡¹å’Œä¸€æ¬¡é¡¹åšå°±å¥½äº†ã€‚</p>
<p>ç„¶åé€’æ¨ $g$ ä¹‹å‰è¦å…ˆæŠŠ $g(n,0)$ ç®—å‡ºæ¥ï¼Œè¿™ä¸œè¥¿å®Œå…¨å¯ä»¥ $\sqrt n$ æ ¹æ®å®šä¹‰ç›´æ¥ç®—ã€‚</p>
<p>ã€‚ã€‚ã€‚è¿˜æœ‰ï¼Œæ³¨æ„å–æ¨¡</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">LL g1[N], g2[N] ;</span><br><span class="line">LL n, s1[N], s2[N] ;</span><br><span class="line">LL dex[<span class="number">2</span>][N] ; <span class="keyword">int</span> tot ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1000000007</span> ;</span><br><span class="line"><span class="keyword">const</span> LL Inv6 = <span class="number">166666668l</span>l ;</span><br><span class="line"><span class="keyword">const</span> LL Inv2 = <span class="number">500000004l</span>l ;</span><br><span class="line"><span class="keyword">int</span> s, pr[N], cnt, chk[N] ; LL Id[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre_sieve</span><span class="params">(<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    chk[<span class="number">0</span>] = chk[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= w ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!chk[i])</span><br><span class="line">            pr[++ cnt] = i,</span><br><span class="line">            s1[cnt] = (s1[cnt - <span class="number">1</span>] + i) % P,</span><br><span class="line">            s2[cnt] = (s2[cnt - <span class="number">1</span>] + <span class="number">1l</span>l * i * i % P) % P ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i * pr[j] &gt; w) <span class="keyword">break</span> ;</span><br><span class="line">            chk[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">calc1</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    x %= P ; </span><br><span class="line">    <span class="keyword">return</span> x * (x + <span class="number">1</span>) % P * Inv2 % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">calc2</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    x %= P ; </span><br><span class="line">    <span class="keyword">return</span> x * (x + <span class="number">1</span>) % P * (<span class="number">2</span> * x + <span class="number">1</span>) % P * Inv6 % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">S</span><span class="params">(LL p, <span class="keyword">int</span> q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pr[q] &gt;= p) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    LL id = (p &lt;= s ? dex[<span class="number">0</span>][p] : dex[<span class="number">1</span>][n / p]) ;</span><br><span class="line">    LL ans = ((g2[id] - g1[id] - s2[q] + s1[q]) % P + P) % P ;</span><br><span class="line">  	<span class="comment">//ä¸Šä¸€å¥æœ¬è´¨ä¸Šå°±æ˜¯ </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = q + <span class="number">1</span> ; k &lt;= cnt ; ++ k)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1l</span>l * pr[k] * pr[k] &gt; p) <span class="keyword">break</span> ; LL o, t, pq ;</span><br><span class="line">        <span class="keyword">for</span> (o = <span class="number">1</span>, pq = pr[k] ; pq &lt;= p ; ++ o, pq = <span class="number">1l</span>l * pr[k] * pq)</span><br><span class="line">            t = pq % P,</span><br><span class="line">            ans = (ans + t * (t - <span class="number">1</span>) % P * (S(p / pq, k) % P + (o &gt; <span class="number">1</span>))) % P ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n,</span><br><span class="line">    s = <span class="built_in">sqrt</span>(n) + <span class="number">1</span>,</span><br><span class="line">    pre_sieve(s) ; LL l, r, w ;</span><br><span class="line">    <span class="keyword">for</span> (l = <span class="number">1</span> ; l &lt;= n ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">        r = n / (n / l),</span><br><span class="line">        Id[++ tot] = n / r ;</span><br><span class="line">        g1[tot] = (calc1(n / l) - <span class="number">1</span> + P) % P ;</span><br><span class="line">        g2[tot] = (calc2(n / l) - <span class="number">1</span> + P) % P ;</span><br><span class="line">        <span class="keyword">if</span> (n / l &gt; s)</span><br><span class="line">            dex[<span class="number">1</span>][l] = tot ;</span><br><span class="line">        <span class="keyword">else</span> dex[<span class="number">0</span>][n / l] = tot ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)&#123;</span><br><span class="line">        w = <span class="number">1l</span>l * pr[i] * pr[i] ; LL now ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; w &lt;= Id[j] ; ++ j)&#123;</span><br><span class="line">            now = Id[j] / pr[i] ;</span><br><span class="line">            now = (now &lt;= s) ? dex[<span class="number">0</span>][now] : dex[<span class="number">1</span>][n / now] ;</span><br><span class="line">            (g1[j] -= <span class="number">1l</span>l * pr[i] * (g1[now] - s1[i - <span class="number">1</span>] + P) % P) %= P ;</span><br><span class="line">            (g2[j] -= <span class="number">1l</span>l * pr[i] * pr[i] % P * (g2[now] - s2[i - <span class="number">1</span>] + P) % P) %= P ;</span><br><span class="line">            g1[j] += (g1[j] &lt; <span class="number">0</span>) ? P : <span class="number">0</span> ;</span><br><span class="line">            g2[j] += (g2[j] &lt; <span class="number">0</span>) ? P : <span class="number">0</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*for (int i = 1 ; i &lt;= tot ; ++ i)</span></span><br><span class="line"><span class="comment">        printf("%lld %lld\n", g1[i], g2[i]) ; */</span></span><br><span class="line"><span class="comment">//    cout &lt;&lt; 233 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; (S(n, <span class="number">0</span>) + <span class="number">1</span>) % P &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="LG4213-ã€æ¨¡æ¿ã€‘æœæ•™ç­›"><a href="#LG4213-ã€æ¨¡æ¿ã€‘æœæ•™ç­›" class="headerlink" title="LG4213 ã€æ¨¡æ¿ã€‘æœæ•™ç­›"></a>LG4213 ã€æ¨¡æ¿ã€‘æœæ•™ç­›</h2><blockquote>
<p>æ±‚ $\sum \varphi(i)$ å’Œ $\sum \mu(i)$ .</p>
<p>$n&lt; 2^{31}$</p>
</blockquote>
<p>å‘ç° $p\in \mathbb{P}$ ï¼Œ$\varphi(p)=p-1,\varphi(p^k)=p^{k-1}(p-1)$ï¼Œå¯ä»¥å¿«é€Ÿæ±‚ï¼Œäºæ˜¯å¯ä»¥ç”¨ä¸€ä¸ª $g$ æ¥æ¨ $f(x)=x$ çš„å‰ç¼€è´¨æ•°å’Œï¼Œä¸€ä¸ª $g$ æ¥æ¨ $1$ ï¼›åŒæ ·å¯¹äº $p\in \mathbb{P},\mu(p)=-1,\mu(p^{k})=0 $ æ‰€ä»¥è¿™ä¸œè¥¿ä¹Ÿå¯ä»¥é€šè¿‡é€’æ¨ $1$ æ¥å®ç°ã€‚</p>
<p>ä»£ç æ–¹é¢ï¼Œè™½ç„¶æ¯”è‡ªå·±å®ç°çš„æœæ•™ç­›è¦å¿«ï¼Œä½†æ˜¯æ¯”å…¶ä»–äººçš„æœæ•™ç­›è¦æ…¢ä¸å°‘ã€‚ã€‚ã€‚awsl</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 200010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rg register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ; LL sp[N] ;</span><br><span class="line">LL gmu[N], gphi[N] ;</span><br><span class="line">LL dex[<span class="number">2</span>][N] ; <span class="keyword">int</span> T, tot ;</span><br><span class="line"><span class="keyword">int</span> s, pr[N], cnt, chk[N] ; LL Id[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre_sieve</span><span class="params">(<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    chk[<span class="number">0</span>] = chk[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= w ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!chk[i])</span><br><span class="line">            pr[++ cnt] = i,</span><br><span class="line">            sp[cnt] = sp[cnt - <span class="number">1</span>] + i ;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i * pr[j] &gt; w) <span class="keyword">break</span> ;</span><br><span class="line">            chk[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">calc1</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * (x + <span class="number">1</span>) / <span class="number">2</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">Sphi</span><span class="params">(LL p, <span class="keyword">int</span> q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pr[q] &gt;= p) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">int</span> id = (p &lt;= s ? dex[<span class="number">0</span>][p] : dex[<span class="number">1</span>][n / p]) ;</span><br><span class="line">    rg LL ans = (gphi[id] - gmu[id]) - (sp[q] - q) ; </span><br><span class="line">  	<span class="comment">//ä¸Šä¸€å¥æœ¬è´¨ä¸Šå°±æ˜¯g(n,|\&#123;prime \&#125;|) - g(prime_&#123;j-1&#125;,j-1)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = q + <span class="number">1</span> ; k &lt;= cnt ; ++ k)&#123;<span class="comment">//ä¹‹åå°±æ˜¯æšä¸¾æ›´å¤§çš„ç´ å› å­ï¼ˆæšä¸¾åˆæ•°ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1l</span>l * pr[k] * pr[k] &gt; p) <span class="keyword">break</span> ; LL o, t, pq ;</span><br><span class="line">        <span class="keyword">for</span> (o = <span class="number">1</span>, pq = pr[k] ; pq &lt;= p ; ++ o, pq = <span class="number">1l</span>l * pr[k] * pq)</span><br><span class="line">            ans = (ans + (pq / pr[k]) * (pr[k] - <span class="number">1</span>) * (Sphi(p / pq, k) + (o &gt; <span class="number">1</span>))) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">Smu</span><span class="params">(LL p, <span class="keyword">int</span> q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pr[q] &gt;= p) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">int</span> id = (p &lt;= s ? dex[<span class="number">0</span>][p] : dex[<span class="number">1</span>][n / p]) ;</span><br><span class="line">    LL ans = -gmu[id] + q ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = q + <span class="number">1</span> ; k &lt;= cnt ; ++ k)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1l</span>l * pr[k] * pr[k] &gt; p) <span class="keyword">break</span> ;</span><br><span class="line">        ans += -(Smu(p / pr[k], k)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    pre_sieve(N - <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) ; tot = <span class="number">0</span> ;</span><br><span class="line">        rg LL l, r, w, t ; s = <span class="built_in">sqrt</span>(n) ;</span><br><span class="line">        <span class="keyword">for</span> (l = <span class="number">1</span> ; l &lt;= n ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="comment">//å…ˆç”¨æ•´é™¤åˆ†å—é¢„å¤„ç†g(n,0)</span></span><br><span class="line">            t = n / l ;</span><br><span class="line">            r = n / t ;</span><br><span class="line">            Id[++ tot] = t ;<span class="comment">//(ä¿å­˜æ¯ä¸€é¡¹ï¼Œæœ€å¤šåªæœ‰2*sqrt(n)ä¸ª)</span></span><br><span class="line">            gmu[tot] = t - <span class="number">1</span> ;<span class="comment">//é¢„å¤„ç†1ï¼Œå³åœ¨j=0æ—¶ï¼Œå°±æ˜¯è¯¥å‡½æ•°åœ¨æ‰€æœ‰çš„ç´ æ•°çš„å–å€¼-1</span></span><br><span class="line">            gphi[tot] = calc1(t) - <span class="number">1</span> ;<span class="comment">//é¢„å¤„ç†n</span></span><br><span class="line">            <span class="keyword">if</span> (n / l &gt; s)</span><br><span class="line">                dex[<span class="number">1</span>][l] = tot ;</span><br><span class="line">            <span class="keyword">else</span> dex[<span class="number">0</span>][n / l] = tot ;<span class="comment">//ç©ºé—´èŠ‚çœ</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)&#123;</span><br><span class="line">            w = <span class="number">1l</span>l * pr[i] * pr[i] ; LL now ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot &amp;&amp; Id[j] &gt;= w ; ++ j)&#123;</span><br><span class="line">                now = Id[j] / pr[i] ;</span><br><span class="line">                now = (now &lt;= s) ? dex[<span class="number">0</span>][now] : dex[<span class="number">1</span>][n / now] ;</span><br><span class="line">                gmu[j] -= gmu[now] - (i - <span class="number">1</span>), <span class="comment">//æŒ‰ç…§é€’æ¨å¼æ±‚g1å’Œg2</span></span><br><span class="line">              	gphi[j] -= <span class="number">1l</span>l * pr[i] * (gphi[now] - sp[i - <span class="number">1</span>]) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld %lld\n"</span>, Sphi(n, <span class="number">0</span>) + <span class="number">1</span>, Smu(n, <span class="number">0</span>) + <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="5-ä¸€ç‚¹åè¯"><a href="#5-ä¸€ç‚¹åè¯" class="headerlink" title="$5$ ä¸€ç‚¹åè¯"></a>$5$ ä¸€ç‚¹åè¯</h1><p>åœ¨å†™é¢˜çš„è¿‡ç¨‹ä¸­å‘ç°äº†å¦ä¸€ç§å†™æ³•ã€‚å¤§æ¦‚å°±æ˜¯åŸæœ¬ $\rm S$ çš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼š</p>
<script type="math/tex; mode=display">
\mathrm{S}(n,j)=\sum_{i}^{n} f(i) [\mathrm{minf}(i)>prime_j]</script><p>ç„¶åä»–ä»¬æ¨å¯¼çš„æ˜¯è¿™æ ·çš„ï¼š</p>
<script type="math/tex; mode=display">
\mathrm{S}(n,j)=\sum_{i}^{n} f(i) [\mathrm{minf}(i)\geq prime_j]</script><p>è¿™æ ·æœ€åçš„ç­”æ¡ˆå°±æ˜¯ $\mathrm{S}(n,1)+1$ ï¼Œåœ¨å†™çš„æ—¶å€™ä¹Ÿéœ€è¦åç§»ä¸€ä½ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>Min_25ç­›</category>
      </categories>
      <tags>
        <tag>åˆ†æ²»</tag>
        <tag>æ•°å­¦/ç§¯æ€§å‡½æ•°æ±‚å’Œ/Min_25ç­›</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘æ ‘çš„ç›´å¾„æ³›åš</title>
    <url>/2019/12/31/%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84%E5%BA%94%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>åšäº†åšå’Œè¿™ä¸€å—å„¿æœ‰å…³çš„é¢˜ã€‚</p>
<p><del>è¯´æ˜¯æ³›åšç„¶è€Œåªåšäº†ä¸‰é“é¢˜</del></p>
<a id="more"></a>
<h1 id="1-åŸºç¡€çŸ¥è¯†"><a href="#1-åŸºç¡€çŸ¥è¯†" class="headerlink" title="1 åŸºç¡€çŸ¥è¯†"></a>1 åŸºç¡€çŸ¥è¯†</h1><p>å—¯ï¼Œé¦–å…ˆå°±æ˜¯è€ƒè™‘ä¸€ç‚¹å®šä¹‰ã€‚</p>
<ul>
<li>æ ‘çš„ç›´å¾„ï¼šä¸€æ£µæ ‘å†…æœ€é•¿çš„ä¸€æ¡ç®€å•è·¯å¾„ã€‚</li>
</ul>
<p>ç„¶åå…³äºç›´å¾„æœ‰ä¸€äº›æ€§è´¨ï¼Œå¤§éƒ¨åˆ†éƒ½å¯ä»¥æ‹¿åè¯æ³•è¯å‡ºæ¥ï¼š</p>
<ul>
<li><p>å¯¹æ ‘ä¸Šéšä¾¿ä¸€ä¸ªç‚¹ $x$ è€Œè¨€ï¼Œä¸ä¹‹ç›¸è·æœ€è¿œçš„ç‚¹ä¸€å®šæ˜¯ç›´å¾„çš„æŸä¸ªç«¯ç‚¹ã€‚</p>
<ul>
<li>è¯æ˜çš„è¯å¯ä»¥åˆ†ç±»è®¨è®º:<ul>
<li><ol>
<li>å¯¹äºç›´å¾„ä¸Šä¸€ç‚¹ $x$ï¼Œç¦»ä»–æœ€è¿œç‚¹è®¾ä¸º $y$ï¼Œä¸åœ¨ç›´å¾„ä¸Šï¼Œé‚£ä¹ˆç›´å¾„å®Œå…¨å¯ä»¥ä»è¿™ä¸ªåœ°æ–¹æ‹åˆ° $y$ ä»è€Œå˜å¾—æ›´å¤§ï¼Œä¸ç›´å¾„çš„æœ€ä¼˜æ€§çŸ›ç›¾ã€‚</li>
</ol>
</li>
<li><ol>
<li>å¯¹äºéç›´å¾„ä¸Šä¸€ç‚¹ $x$ï¼Œç¦»ä»–æœ€è¿œçš„ç‚¹ä¸º $y$ï¼Œä¸åœ¨ç›´å¾„ä¸Šã€‚é‚£ä¹ˆè€ƒè™‘è®¾ $x$ åˆ°ç›´å¾„ä¸Šæœ€è¿‘ä¸€ç‚¹ $u$ çš„è·ç¦»ä¸º $d_u$ï¼Œç›´å¾„è¿œç«¯çš„è·ç¦»ä¸º $d$ï¼Œåˆ° $y$ çš„è·ç¦»ä¸º $d_y$ã€‚é‚£ä¹ˆæœ‰ $d_y+d_u&gt;d$ ã€‚äºæ˜¯è€ƒè™‘å¦‚æœè®©ç›´å¾„ä» $u$ æ‹åˆ° $y$ çš„è¯æ˜¾ç„¶ä¼šæ›´ä¼˜ï¼Œä¸ç›´å¾„çš„æœ€ä¼˜æ€§çŸ›ç›¾ã€‚ </li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li><p>å®šä¹‰ä¸€æ£µæ ‘çš„ <strong>ä¸­å¿ƒ</strong> ä¸º $\max_{v\in T}{d_{u,v}}$ æœ€å°çš„ç‚¹ $u$ï¼Œé‚£ä¹ˆ $u$ åœ¨ç›´å¾„ä¸Šã€‚</p>
<ul>
<li>è¯æ˜çš„è¯è€ƒè™‘å¦‚æœä¸åœ¨ç›´å¾„ä¸Šï¼Œé‚£ä¹ˆè€ƒè™‘åˆ°ç›´å¾„ä¸Šæœ€è¿‘çš„ä¸€ç‚¹ $p$ï¼Œå‘ç° $p$ å¯¹äºç›´å¾„çš„ä¸¤ä¸ªç«¯ç‚¹è·ç¦»è¦å°äº $p$ ã€‚å†ç»“åˆä¸Šé¢è¯æ˜è¿‡çš„ï¼Œå¯¹äº $u$ è€Œè¨€ï¼Œ$\max_{v\in T}{d_{u,v}}$ ä¸€å®šä¼šåœ¨ç›´å¾„ä¸Šé¢å–åˆ°ï¼Œè€Œ $u$ çš„æ¬¡è¿œç‚¹åˆ° $p$ çš„è·ç¦»ä¸€å®šå°äº $p$ åˆ°ç›´å¾„ç«¯ç‚¹çš„è·ç¦»ï¼Œæ‰€ä»¥ä¸­å¿ƒ $u$ ä¸€å®šåœ¨ç›´å¾„ä¸Šã€‚</li>
</ul>
</li>
</ul>
<p>è¿™ä¸¤ä¸ªç»“è®ºæœ‰äº‹è¿˜æ˜¯å¾ˆæœ‰ç”¨çš„2333</p>
<hr>
<p>ä»¥ä¸Šæ˜¯è¯æ˜ç€ç©çš„ã€‚æ¥ä¸‹æ¥è€ƒè™‘ç›´å¾„çš„æ±‚æ³•ã€‚</p>
<p>é¦–å…ˆå°±æ˜¯å–œé—»ä¹è§çš„ä¸¤é $dfs/bfs$ æ±‚ã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘ç¬¬ä¸€ééšä¾¿é€‰ä¸€ä¸ªç‚¹æ‰¾ä¸€ä¸ªä¸ä»–ç›¸è·æœ€è¿œçš„ç‚¹ $u$ï¼Œ é‚£ä¹ˆ $u$ ä¸€å®šä¼šåœ¨ç›´å¾„ä¸Šã€‚ä¹‹åå†dfsæ±‚ä¸€éæœ€è¿œç‚¹å³å¯ã€‚ç”±äºå›ºå®šäº†ç«¯ç‚¹æ‰€ä»¥å°±ç›´æ¥è„‘æ®‹æ±‚å°±å®Œäº†ã€‚</p>
<p>ç„¶è€Œæˆ‘æ˜¯è¿™ä¹ˆ $dfs$ çš„ã€‚å›æƒ³èµ·æ¥è‡ªå·±æ˜¯ä¸ªæ†¨æ†¨ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; n &lt;&lt; endl ;</span></span><br><span class="line">    d[n] = <span class="number">0</span>, pre[n] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[n] ; ~k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == fa) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs(to(k), n) ;</span><br><span class="line">        <span class="keyword">if</span> (d[to(k)] + val(k) &gt; d[n])</span><br><span class="line">            d[n] = d[to(k)] + val(k), pre[n] = to(k) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ç›´æ¥ $dp$ ï¼Œè¿™ä¸ªæ¯”è¾ƒå‚»ï¼Œç»´æŠ¤æœ€é•¿é“¾å’Œæ¬¡é•¿é“¾å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[n] ; ~k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == fa) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs(to(k), n), ans = max(ans, dp[n] + dp[to(k)] + val(k)) ;</span><br><span class="line">        dp[n] = max(dp[n], dp[to(k)] + val(k)) ;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-ä¾‹é¢˜"><a href="#2-ä¾‹é¢˜" class="headerlink" title="2 ä¾‹é¢˜"></a>2 ä¾‹é¢˜</h1><h2 id="1-APIO2010-å·¡é€»"><a href="#1-APIO2010-å·¡é€»" class="headerlink" title="1 [APIO2010]å·¡é€»"></a>1 [APIO2010]å·¡é€»</h2><blockquote>
<p>ç»™å®šä¸€æ£µæ ‘ã€‚å¯ä»¥è¿ $K~(K\in\\{1,2\\})$ æ¡é¢å¤–çš„è¾¹ä½¿å¾—ä» $1$ å·ç‚¹å‡ºå‘ï¼Œéå†æ‰€æœ‰è·¯å¾„ä¸€æ¬¡ï¼Œä½¿èµ°çš„èµ°è·¯ç¨‹æœ€çŸ­ã€‚</p>
<p>åŒæ—¶æœ‰ä»¥ä¸‹çº¦æŸï¼š</p>
<ul>
<li>æ¯æ¡è·¯å¿…é¡»ç»è¿‡<strong>è‡³å°‘</strong>ä¸€æ¬¡ï¼Œç‚¹å¯ä»¥ç»è¿‡å¤šæ¬¡ã€‚</li>
<li>æœ€åè¦å›åˆ°ä¸€å·ç‚¹ã€‚</li>
</ul>
</blockquote>
<p>å‘ç° $K=1$ æ—¶æ¯”è¾ƒå®¹æ˜“è€ƒè™‘ï¼ŒæŠŠç›´å¾„ä¸¤ç«¯è¿èµ·æ¥æ”¾åˆ°æœ€åèµ°ï¼Œè¿™æ ·ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚äºæ˜¯æ­¤æ—¶ç­”æ¡ˆä¸º $2(n-1) - (L-1)=2n-L+1$ ã€‚</p>
<p>ç„¶åè€ƒè™‘ $K=2$ ã€‚å‘ç° $K=2$ æ—¶å’Œ $K=1$ æƒ…å†µå¤§è‡´ç›¸ä¼¼ï¼Œç¬¬ä¸€æ¡è¾¹è¿ç›´å¾„ã€‚ç„¶åè€ƒè™‘ç¬¬äºŒæ¡è¾¹ï¼Œå‘ç°ç¬¬äºŒæ¡è¾¹å¯èƒ½å­˜åœ¨è¿å‡ºçš„åœˆä¸ç¬¬ä¸€ä¸ªåœˆæœ‰ç›¸äº¤ä¸€éƒ¨åˆ†çš„æƒ…å†µã€‚ä½†è§£å†³æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼ŒæŠŠç›´å¾„ä¸Šçš„è¾¹æƒè®¾ç½®ä¸ºå…¶ç›¸åæ•°å³å¯ã€‚</p>
<p>ç„¶åå°±æ˜¯æ±‚ä¸¤éç›´å¾„å°±å®Œäº‹äº†233</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; n &lt;&lt; endl ;</span></span><br><span class="line">    d[n] = <span class="number">0</span>, pre[n] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[n] ; ~k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == fa) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs(to(k), n) ;</span><br><span class="line">        <span class="keyword">if</span> (d[to(k)] + val(k) &gt; d[n])</span><br><span class="line">            d[n] = d[to(k)] + val(k), pre[n] = to(k) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_do</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; n &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[n] ; ~k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[to(k)] || to(k) == fa) <span class="keyword">continue</span> ;</span><br><span class="line">        val(k) = <span class="number">-1</span>, val(k ^ <span class="number">1</span>) = <span class="number">-1</span>, do_do(to(k), n) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_dp</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; ~k ; k = next(k))&#123;</span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa)&#123;</span><br><span class="line">			do_dp(to(k), u), </span><br><span class="line">			L2 = max(L2, d[to(k)] + val(k) + d[u]) ; </span><br><span class="line">			d[u] = max(d[u], d[to(k)] + val(k)) ; </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, u, v, n ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K, cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), add(u, v) ;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>) ; n = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (pre[n]) n = pre[n] ;</span><br><span class="line">    dfs(n, <span class="number">0</span>), L1 = d[n] + (<span class="keyword">bool</span>)(K == <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (pre[n])</span><br><span class="line">        vis[n] = <span class="number">1</span>, n = pre[n] ;</span><br><span class="line">    vis[n] = <span class="number">1</span> ; <span class="comment">//cout &lt;&lt; L1 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">if</span> (K &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        do_do(n, <span class="number">0</span>) ;</span><br><span class="line">		<span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="keyword">sizeof</span>(d)) ; </span><br><span class="line">		do_dp(<span class="number">3</span>, <span class="number">0</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//cout &lt;&lt; L1 &lt;&lt; " " &lt;&lt; L2 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="number">2</span> * N - L1 - L2 &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-NOIp2007-æ ‘ç½‘çš„æ ¸"><a href="#2-NOIp2007-æ ‘ç½‘çš„æ ¸" class="headerlink" title="2 [NOIp2007]æ ‘ç½‘çš„æ ¸"></a>2 [NOIp2007]æ ‘ç½‘çš„æ ¸</h2><blockquote>
<p>ç»™å®šä¸€æ£µæ ‘ $\rm T=(E,V)$ï¼Œæ±‚ä¸€æ®µé•¿åº¦ä¸è¶…è¿‡ $s$ çš„è·¯å¾„ $p=(\rm e, v)$ï¼Œæœ€å°åŒ–ï¼š</p>
<script type="math/tex; mode=display">
\max_{\begin{aligned}u,v & \in \rm T\\\ u\in V, &v\not \in V\end{aligned}} [\forall t \in \mathrm{path}(u,v), t\not \in \mathrm{v}]\times d_{u,v}</script><p>å…¶ä¸­ $\mathrm{path}(u,v)$ è¡¨ç¤º $u,v$ ä¹‹é—´å”¯ä¸€è·¯å¾„ä¸Šï¼Œé™¤å» $u,v$ çš„ç‚¹é›†ã€‚$[~]$ ä¸ºè‰¾ä½›æ£®æ‹¬å·ã€‚</p>
<p>$1\leq n\leq 5,000$</p>
</blockquote>
<p>ç±»æ¯”ä¸€å¼€å§‹å¯¹ä¸­å¿ƒçš„ä½ç½®çš„è¯æ˜ï¼Œå¯ä»¥å‘ç°è¿™æ®µè·¯å¾„ä¸€å®šåœ¨ç›´å¾„ä¸Šï¼ˆäº‹å®ä¸Šå¯ä»¥æŠŠè¿™æ®µè·¯å¾„ç¼©æˆä¸€ä¸ªç‚¹æ¥è€ƒè™‘ï¼‰ã€‚ç„¶åå°±è€ƒè™‘å…ˆæŠŠç›´å¾„æ‰¾å‡ºæ¥ï¼Œç„¶å $n^2$ æšä¸¾è·¯å¾„ç«¯ç‚¹ $(p,q)$ ï¼Œ$O(n)$ ç®—ä¸€ä¸‹æœ€é•¿è·ç¦»ï¼Œè¿™æ ·æ˜¯ $O(n^3)$ çš„ã€‚ç„¶è€Œå‘ç°å¯ä»¥è´ªå¿ƒï¼Œé“¾é•¿æœŸæœ›è¶Šé•¿ï¼Œå¼å­çš„å€¼æœŸæœ›è¶Šå°ã€‚æ‰€ä»¥å¯ä»¥ $n^2$ é¢„å¤„ç†å‡ºæ¥ç›´å¾„ä¸Šç¦»æ¯ä¸ªç‚¹æœ€è¿œä¸”è·ç¦» $\leq s$ çš„ç«¯ç‚¹ï¼Œç„¶å $n^2$ åšå³å¯ã€‚æœ€ç»ˆå¤æ‚åº¦ $n^2$ã€‚</p>
<h2 id="3-SDOI2011-æ¶ˆé˜²"><a href="#3-SDOI2011-æ¶ˆé˜²" class="headerlink" title="3 [SDOI2011]æ¶ˆé˜²"></a>3 [SDOI2011]æ¶ˆé˜²</h2><blockquote>
<p>ç»™å®šä¸€æ£µæ ‘ $\rm T=(E,V)$ï¼Œæ±‚ä¸€æ®µé•¿åº¦ä¸è¶…è¿‡ $s$ çš„è·¯å¾„ $p=(\rm e, v)$ï¼Œæœ€å°åŒ–ï¼š</p>
<script type="math/tex; mode=display">
\max_{\begin{aligned}u,v & \in \rm T\\\ u\in V, &v\not \in V\end{aligned}} [\forall t \in \mathrm{path}(u,v), t\not \in \mathrm{v}]\times d_{u,v}</script><p>å…¶ä¸­ $\mathrm{path}(u,v)$ è¡¨ç¤º $u,v$ ä¹‹é—´å”¯ä¸€è·¯å¾„ä¸Šï¼Œé™¤å» $u,v$ çš„ç‚¹é›†ã€‚$[~]$ ä¸ºè‰¾ä½›æ£®æ‹¬å·ã€‚</p>
<p>$1\leq n\leq 500,000$</p>
</blockquote>
<p>â€¦â€¦æ‰€ä»¥å…¶å®å°±æ˜¯ä¸Šä¸€é“é¢˜çš„åŠ å¼ºç‰ˆã€‚</p>
<p>è€ƒè™‘æ€ä¹ˆä¼˜åŒ–ä¸€ä¸‹ $n^2$ çš„ç®—æ³•ï¼Œå‘ç°ä¸¤éƒ¨åˆ†éƒ½éœ€è¦ä¼˜åŒ–ã€‚é¦–å…ˆè€ƒè™‘ <code>n^2 é¢„å¤„ç†å‡ºæ¥ç›´å¾„ä¸Šç¦»æ¯ä¸ªç‚¹æœ€è¿œä¸”è·ç¦» â‰¤ s ç«¯ç‚¹</code> è¿™ä¸œè¥¿ï¼Œå‘ç°å®Œå…¨å¯ä»¥äºŒåˆ†ï¼Œäºæ˜¯å˜æˆäº† $\log$ ï¼›ç„¶åå‘ç°åä¸€éƒ¨åˆ†ï¼Œå®Œå…¨å¯ä»¥ä¸€é $dp$ æ±‚å‡ºæ¥ â€œç¦»ç›´å¾„ä¸Šæ¯ä¸ªç‚¹æœ€è¿œçš„ç‚¹çš„è·ç¦»â€è¿™ä¸ªä¸œè¥¿ï¼Œç„¶åå°±å¯ä»¥ $\rm rmq$ è§£å†³ã€‚ç„¶åä¸¤éƒ¨åˆ†å°±éƒ½å˜æˆäº† $n\log n$ ã€‚ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥è®¤ä¸º $rmq$ æ˜¯ $O(\rm C)$ çš„ï¼‰</p>
<p>ä½†å®é™…ä¸Šå¯ä»¥ç»§ç»­ä¼˜åŒ–ã€‚é¦–å…ˆå‘ç°çš„æ˜¯é‚£ä¸ªäºŒåˆ†å¯ä»¥æ‹¿å°ºå–æ³•åšæ‰ã€‚ä¹‹åè€ƒè™‘æ‹¿å‡ºä¹‹å‰æ•´è¿‡çš„ç»“è®ºæ“ä½œä¸€ä¸‹ã€‚ä»¤ $d_u$ è¡¨ç¤ºç›´å¾„ä¸Šä¸€ç‚¹ $u$ åœ¨ä¸ç»è¿‡ç›´å¾„çš„æƒ…å†µä¸‹ï¼Œåˆ°æŸä¸ªéç›´å¾„ä¸Šç‚¹çš„æœ€è¿œè·ç¦»ã€‚è®¾ç›´å¾„çš„ç‚¹é›†ä¸º $l$ï¼Œèµ·ç‚¹ä¸º $s$ï¼Œ ç»ˆç‚¹ä¸º $t$ã€‚é‚£ä¹ˆç­”æ¡ˆå°±æ˜¯</p>
<script type="math/tex; mode=display">
\min_{i,j\in l} \\{ \quad \max (dist_{s,i},dist_{j,t},\max_{v\in \mathrm{path}(i,j)} \\{ d_v \\}) \quad \\}</script><p>ä½†æ˜¯å…¶å®é‡Œé¢çš„æœ€åä¸€é¡¹ $\max_{v\in \mathrm{path}(i,j)} \\{ d_v \\}$ å¯ä»¥è¢«æ¢æˆ $\max_{v\in l} \\{ d_v \\}$ã€‚åŸå› æ˜¯è€ƒè™‘å½“å‰æšä¸¾çš„æ®µå¤–ä¸€ç‚¹ï¼ˆæ­¤å¤„é»˜è®¤æ˜¯åœ¨é  $s$ è¿‘çš„ä¸€ä¾§ï¼‰ $w$ çš„ $d_w$ è‚¯å®šä¼šå°äºç­‰äº $dist(s,w)$ï¼Œè€Œç”±äº $i$ åœ¨è¿™ä¸€æ®µå¤–é¢ï¼Œæ‰€ä»¥ $dist(s,w)&lt;dist(s,i)$ ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹ç­”æ¡ˆæ²¡æœ‰è´¡çŒ®ï¼Œå¯ä»¥ç›´æ¥å¿½ç•¥æ‰ã€‚</p>
<p>äºæ˜¯æœ€åå°±å¯ä»¥ $O(n)$ åšäº†ã€‚</p>
<p>ç„¶åå…ˆä¸Šä¸€ä¸‹ $rmq$ çš„ç‰ˆæœ¬ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    d[n] = <span class="number">0</span>, pre[n] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[n] ; ~k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == fa) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs(to(k), n) ;</span><br><span class="line">        <span class="keyword">if</span> (d[to(k)] + val(k) &gt; d[n])</span><br><span class="line">            d[n] = d[to(k)] + val(k), pre[n] = to(k) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_do</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; ~k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == fa) <span class="keyword">continue</span> ;</span><br><span class="line">        do_do(to(k), u) ;</span><br><span class="line">        <span class="keyword">if</span> (vis[to(k)]) <span class="keyword">continue</span> ;</span><br><span class="line">        d[u] = max(d[to(k)] + val(k), d[u]) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> d[l] ;</span><br><span class="line">    <span class="keyword">while</span> ((<span class="number">1</span> &lt;&lt; k) &lt;= r - l) k ++ ;</span><br><span class="line">    k -- ; <span class="keyword">return</span> max(f[l][k], f[r - (<span class="number">1</span> &lt;&lt; k)][k]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u, v, w, n ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; S, cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;w), add(u, v, w) ;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>), n = <span class="number">1</span>, res = Inf ; </span><br><span class="line">    <span class="keyword">while</span> (pre[n]) n = pre[n] ; dfs(n, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (pre[n]) vis[n] = <span class="number">1</span>, s[++ tot] = n, n = pre[n] ;</span><br><span class="line">    s[++ tot] = n, vis[n] = <span class="number">1</span> ; </span><br><span class="line">	  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i) rev[s[i]] = i ; </span><br><span class="line">	  <span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="keyword">sizeof</span>(d)), do_do(n, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; tot ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = head[s[i]] ; ~j ; j = next(j))</span><br><span class="line">            <span class="keyword">if</span> (to(j) == s[i + <span class="number">1</span>]) base[i + <span class="number">1</span>] = val(j) + base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i) f[i][<span class="number">0</span>] = d[s[i]] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">20</span> ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j + (<span class="number">1</span> &lt;&lt; i) &lt;= tot + <span class="number">1</span> ; ++ j)</span><br><span class="line">            f[j][i] = max(f[j][i - <span class="number">1</span>], f[j + (<span class="number">1</span> &lt;&lt; i - <span class="number">1</span>)][i - <span class="number">1</span>]) ;</span><br><span class="line">	  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i) ans = max(ans, d[i]) ; </span><br><span class="line">	  <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">1</span>, l = <span class="number">1</span> ; r &lt;= tot ; ++ r)&#123;</span><br><span class="line">        <span class="keyword">while</span> (base[r] - base[l] &gt; S) ++ l ; <span class="comment">//cout &lt;&lt; base[tot] &lt;&lt; " " ; </span></span><br><span class="line">        res = min(res, max(max(base[l], base[tot] - base[r]), query(l, r))) ;</span><br><span class="line">		&#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ˜¯å¦ä¸€ä¸ªç‰ˆæœ¬ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">Min</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp; a, <span class="keyword">const</span> <span class="keyword">int</span> &amp; b)</span></span>&#123; <span class="keyword">return</span> a &lt; b? a : b ; &#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">Max</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp; a, <span class="keyword">const</span> <span class="keyword">int</span> &amp; b)</span></span>&#123; <span class="keyword">return</span> a &gt; b? a : b ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u, v, w, n ;</span><br><span class="line">    fread(ch, <span class="number">1</span>, ch_top, <span class="built_in">stdin</span>) ;</span><br><span class="line">    N = read(), S = read() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        u = read(), v = read(), w = read(), add(u, v, w) ;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>), n = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (pre[n])</span><br><span class="line">        n = pre[n] ; dfs(n, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (pre[n])</span><br><span class="line">        vis[n] = <span class="number">1</span>, s[++ tot] = n, n = pre[n] ;</span><br><span class="line">    s[++ tot] = n, vis[n] = <span class="number">1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="keyword">sizeof</span>(d)), do_do(n, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; tot ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = head[s[i]] ; j ; j = next(j))</span><br><span class="line">            <span class="keyword">if</span> (to(j) == s[i + <span class="number">1</span>]) base[i + <span class="number">1</span>] = val(j) + base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i) ans = Max(ans, d[s[i]]) ; res = ans ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">1</span>, l = <span class="number">1</span> ; r &lt;= tot ; ++ r)&#123;</span><br><span class="line">        <span class="keyword">while</span> (base[r] - base[l] &gt; S) ++ l ;</span><br><span class="line">        res = Min(res, Max(Max(base[l], base[tot] - base[r]), ans)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    write(res) ; fwrite(ch, <span class="number">1</span>, now_w - ch, <span class="built_in">stdout</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul>
<li>ç¨‹åºçŒ¿çš„ç”Ÿå‘½å¤§å¤šè‘¬é€ç»™äº†è°ƒè¯•ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/æ ‘å½¢DP</tag>
        <tag>æ ‘ä¸ŠæŠ€å·§/æ ‘çš„ç›´å¾„çš„åº”ç”¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘ç­ç»æ ‘</title>
    <url>/2019/12/30/%E7%81%AD%E7%BB%9D%E6%A0%91/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æœ¬æ¥æƒ³å­¦æ”¯é…æ ‘ï¼Œæ®è¯´å’Œç­ç»æ ‘å°±æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œå°±æ»šå»å­¦äº†ç­ç»æ ‘ã€‚</p>
<p>ä¸è¿‡ä¸€è¯´åˆ°ç­ç»æ ‘ï¼Œè„‘æµ·ä¸­å°±ä¼šå‹¾å‹’å‡ºä¸€å‰¯å¥½ä¹…ä¹‹å‰çš„åœºæ™¯ï¼Œè®©äººæ€€å¿µâ€¦â€¦</p>
<a id="more"></a>
<h1 id="1-ZJOI2012-ç¾éš¾"><a href="#1-ZJOI2012-ç¾éš¾" class="headerlink" title="1 [ZJOI2012] ç¾éš¾"></a>1 [ZJOI2012] ç¾éš¾</h1><blockquote>
<p>ç»™å®šä¸€ä¸ª $\rm DAG$ï¼Œå®šä¹‰ç¾éš¾å€¼ï¼šåœ¨ä¸€ä¸ªèŠ‚ç‚¹è¢«åˆ å»åä»¥å®ƒä¸ºæ ¹ä»ä¸Šåˆ°ä¸‹é€æ­¥åˆ å»å…¥åº¦ä¸º $0$ çš„ç‚¹ï¼Œæœ€ç»ˆè¢«åˆ å»çš„ç‚¹çš„æ•°é‡ã€‚æ±‚æ¯ä¸ªç‚¹çš„ç¾éš¾å€¼ã€‚</p>
<p>$n \leq 100,000$</p>
</blockquote>
<p>ä¸è¯´æ„é€ æ–¹é¢çš„ä¸œè¥¿äº†ï¼Œç›´æ¥è€ƒè™‘æ€ä¹ˆåšã€‚ç›´æ¥å»ºä¸€æ£µæ ‘ï¼Œ $fa_x$ è®°å½•çš„æ˜¯è¿™ä¹ˆä¸€ä¸ªç‚¹ $u$ï¼Œè¡¨ç¤ºå¦‚æœ $u$ æŒ‚äº†é‚£ä¹ˆ $x$ è‚¯å®šä¼šæŒ‚ä¸” $dist(u,x)$ æœ€å°ã€‚ç„¶åè€ƒè™‘è¿™ä¸ªä¸œè¥¿å®é™…ä¸Šå°±æ˜¯æ¯ä¸ª $x$ çš„å…¥è¾¹çš„å¦ä¸€ä¸ªç«¯ç‚¹åœ¨è¿™æ£µæ ‘ä¸Šçš„ $\rm LCA$ ï¼Œäºæ˜¯è€ƒè™‘è¾¹ <code>topsort</code> è¾¹å»ºæ ‘ã€‚ç„¶åå­æ ‘å¤§å° $-1$ å°±æ˜¯ç­”æ¡ˆã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next ;</span><br><span class="line">&#125;E[MAXN &lt;&lt; <span class="number">1</span>], e[MAXN &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">int</span> head[MAXN], Head[MAXN], sz[MAXN], cnt1, cnt2 ;</span><br><span class="line"><span class="keyword">int</span> N, deg[MAXN], dep[MAXN], fa[MAXN], anc[MAXN][<span class="number">20</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add1</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    e[++ cnt1].to = v, e[cnt1].next = head[u], head[u] = cnt1 ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    E[++ cnt2].to = v, E[cnt2].next = Head[u], Head[u] = cnt2 ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    sz[u] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = Head[u] ; k ; k = E[k].next)</span><br><span class="line">        dfs(E[k].to), sz[u] += sz[E[k].to] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v]) swap(u, v) ;</span><br><span class="line">    <span class="keyword">int</span> dif = dep[u] - dep[v] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">18</span> ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; j &amp; dif) u = anc[u][j] ;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> u ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">18</span> ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">        <span class="keyword">if</span> (anc[u][j] != anc[v][j])</span><br><span class="line">            u = anc[u][j], v = anc[v][j] ;</span><br><span class="line">    <span class="keyword">return</span> anc[u][<span class="number">0</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios :: sync_with_stdio(<span class="literal">false</span>) ;</span><br><span class="line">    <span class="built_in">cin</span>.tie(<span class="number">0</span>), <span class="built_in">cout</span>.tie(<span class="number">0</span>), <span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) fa[i] = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j, x, y ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; y ;</span><br><span class="line">        <span class="keyword">while</span> (y) add1(y, i), deg[i] ++, <span class="built_in">cin</span> &gt;&gt; y ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= N ; ++ i) cout &lt;&lt; deg[i] &lt;&lt; " " ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (!deg[i]) fa[i] = <span class="number">0</span>, q.push(i) ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> n = q.front() ;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; n &lt;&lt; endl ;</span></span><br><span class="line">        q.pop(), add2(fa[n], n) ;</span><br><span class="line">        anc[n][<span class="number">0</span>] = fa[n], dep[n] = dep[fa[n]] + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">18</span> ; ++ i)</span><br><span class="line">            anc[n][i] = anc[anc[n][i - <span class="number">1</span>]][i - <span class="number">1</span>] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = head[n] ; i ; i = e[i].next)&#123;</span><br><span class="line">            <span class="keyword">if</span> (fa[e[i].to] == <span class="number">-1</span>) fa[e[i].to] = n ;</span><br><span class="line">            <span class="keyword">else</span> fa[e[i].to] = lca(n, fa[e[i].to]) ;</span><br><span class="line">            <span class="keyword">if</span> (!(-- deg[e[i].to])) q.push(e[i].to) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= N ; ++ i) cout &lt;&lt; fa[i] &lt;&lt; " " ;</span></span><br><span class="line">    dfs(<span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; (sz[i] - <span class="number">1</span>) &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜æ˜¯å¾ˆç®€å•çš„å§ï¼Ÿ</p>
<h1 id="2-CF757F-Team-Rocket-Rises-Again"><a href="#2-CF757F-Team-Rocket-Rises-Again" class="headerlink" title="2 CF757F Team Rocket Rises Again"></a>2 CF757F Team Rocket Rises Again</h1><p>ä¸€é“ä¾‹é¢˜ï¼Ÿ</p>
<blockquote>
<p>ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ï¼Œ$m$ æ¡è¾¹çš„å¸¦æƒæ— å‘å›¾å’Œèµ·ç‚¹ $\rm S$ã€‚é€‰æ‹©ä¸€ä¸ªç‚¹ $u$ $(u\not =\rm S)$ï¼Œä½¿åœ¨å›¾ä¸­åˆ æ‰ç‚¹ $u$ åï¼Œæœ‰å°½å¯èƒ½å¤šçš„ç‚¹åˆ° $\rm S$ çš„æœ€çŸ­è·ç¦»æ”¹å˜ã€‚</p>
<p>$n\leq 200,000$</p>
</blockquote>
<p>åœ¨å‘ç°æ±‚å®Œä¸€éæœ€çŸ­è·¯è¿™ä¸ªå›¾å˜æˆ DAGä¹‹åï¼Œè¿™é“é¢˜å°±å˜æˆäº†ä¸€é“å‚»é¢˜ã€‚</p>
<p>å“¦ï¼Œå¿˜äº†ï¼Œæœ‰ä¸ªå‘ç‚¹ã€‚ä»–å¯èƒ½ç»™çš„è¿™ä¸ªå›¾ä¸€å¼€å§‹ä¸è¿é€šï¼Œæ‰€ä»¥è¦åˆ¤ä¸€ä¸‹ <code>vis</code> ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    E[m][++ cnt[m]].to = v, E[m][cnt[m]].val = w,</span><br><span class="line">    E[m][cnt[m]].next = head[m][u], head[m][u] = cnt[m] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    sz[u] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[<span class="number">2</span>][u] ; k ; k = E[<span class="number">2</span>][k].next)</span><br><span class="line">        dfs(E[<span class="number">2</span>][k].to), sz[u] += sz[E[<span class="number">2</span>][k].to] ;</span><br><span class="line">    <span class="keyword">if</span> (vis[u] &amp;&amp; u &amp;&amp; u != S) ans = max(ans, sz[u]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v]) swap(u, v) ;</span><br><span class="line">    <span class="keyword">int</span> dif = dep[u] - dep[v] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">18</span> ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; j &amp; dif) u = anc[u][j] ;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> u ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">18</span> ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">        <span class="keyword">if</span> (anc[u][j] != anc[v][j])</span><br><span class="line">            u = anc[u][j], v = anc[v][j] ;</span><br><span class="line">    <span class="keyword">return</span> anc[u][<span class="number">0</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; S ; <span class="keyword">int</span> u, v, w ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;w),</span><br><span class="line">        add(<span class="number">0</span>, u, v, w), add(<span class="number">0</span>, v, u, w) ;</span><br><span class="line">    q.push(S) ; vis[S] = <span class="number">1</span> ;</span><br><span class="line">    fill(dis + <span class="number">1</span>, dis + N + <span class="number">1</span>, Inf), dis[S] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> n = q.front() ; q.pop() ; vis[n] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[<span class="number">0</span>][n] ; k ; k = E[<span class="number">0</span>][k].next)&#123;</span><br><span class="line">            <span class="keyword">if</span> (dis[E[<span class="number">0</span>][k].to] &gt; dis[n] + E[<span class="number">0</span>][k].val)&#123;</span><br><span class="line">                dis[E[<span class="number">0</span>][k].to] = dis[n] + E[<span class="number">0</span>][k].val ;</span><br><span class="line">                <span class="keyword">if</span> (!vis[E[<span class="number">0</span>][k].to])</span><br><span class="line">                    vis[E[<span class="number">0</span>][k].to] = <span class="number">1</span>, q.push(E[<span class="number">0</span>][k].to) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = head[<span class="number">0</span>][i] ; j ; j = E[<span class="number">0</span>][j].next)</span><br><span class="line">            <span class="keyword">if</span> (dis[i] + E[<span class="number">0</span>][j].val == dis[E[<span class="number">0</span>][j].to])</span><br><span class="line">                add(<span class="number">1</span>, i, E[<span class="number">0</span>][j].to, <span class="number">0</span>), deg[E[<span class="number">0</span>][j].to] ++ ;</span><br><span class="line">    fill(vis, vis + N + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) fa[i] = <span class="number">-1</span> ;</span><br><span class="line">    q.push(S), fa[S] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> n = q.front() ;</span><br><span class="line">        q.pop(), vis[n] = <span class="number">1</span>, add(<span class="number">2</span>, fa[n], n, <span class="number">0</span>) ;</span><br><span class="line">        anc[n][<span class="number">0</span>] = fa[n], dep[n] = dep[fa[n]] + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">18</span> ; ++ i)</span><br><span class="line">            anc[n][i] = anc[anc[n][i - <span class="number">1</span>]][i - <span class="number">1</span>] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[<span class="number">1</span>][n] ; k ; k = E[<span class="number">1</span>][k].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> ww = E[<span class="number">1</span>][k].to ;</span><br><span class="line">            <span class="keyword">if</span> (!(~fa[ww])) fa[ww] = n ;</span><br><span class="line">            <span class="keyword">else</span> fa[ww] = lca(fa[ww], n) ;</span><br><span class="line">            <span class="keyword">if</span> (! -- deg[ww]) q.push(ww) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">0</span>) ; <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-åæ§½"><a href="#3-åæ§½" class="headerlink" title="3 åæ§½"></a>3 åæ§½</h1><p>è¿™ä¸œè¥¿åœ¨ Luogu ä¸Šä¹Ÿèƒ½ç®—ç´«è‰²çš„ï¼Ÿ</p>
<h1 id="4-ä¸€ç‚¹å›å¿†"><a href="#4-ä¸€ç‚¹å›å¿†" class="headerlink" title="4 ä¸€ç‚¹å›å¿†"></a>4 ä¸€ç‚¹å›å¿†</h1><p>é‚£æ˜¯ 18 å¹´çš„ 4 æœˆã€‚æƒ³æ¥å·²ç»æ˜¯å‰å¹´äº†ï¼Œæœ‰äº›ä¼¤æ„Ÿã€‚</p>
<p>å½“æ—¶é‡‘ç‰Œæ•™ç»ƒè®© rqy ç»™æˆ‘ä»¬å‡ºé¢˜è€ƒè¯•ï¼Œé¢˜ç›®å¦‚ä¸‹ï¼š</p>
<div class="pdf" target="./P0.pdf" height></div>
<p>T1æ˜¯ä¸ªæœ‰ç‚¹ tricky çš„æœ€å°å­—å…¸åºæœ€å¤§ç‹¬ç«‹é›†ï¼ŒT2å°±æ˜¯ä¸ªç­ç»æ ‘çš„æ¿å­ï¼ŒT3æ˜¯ä¸ª DLX çš„æ¿å­ã€‚ç„¶è€Œå½“æ—¶å¤§å®¶æœ€é«˜åˆ†åªæœ‰ $60$ åˆ†ä¹Ÿæ˜¯æœ‰ç‚¹æƒ¨æƒ¨ã€‚</p>
<p>è¿˜è®°å¾—å½“æ—¶å¤§å®¶å‡ ä¹éƒ½åœ¨è®¤çœŸåœ°åš T2ï¼Œæˆ‘åœ¨åš T1 çš„å‰ 60 åˆ†ã€‚ç„¶è€Œæœ€å T1 è¿˜æ˜¯å› ä¸ºè¾¹è¡¨æ²¡å¼€ä¸¤å€è€Œ RE æŒ‚äº† 40ï¼Œå¤§å®¶ T2 éƒ½æ˜¯æšä¸¾æ¯ä¸ªç‚¹ç„¶åå†å» topsort , å¯æƒœå½“æ—¶æˆ‘è¿ topsort ä¹Ÿä¸ä¼šã€‚</p>
<p>ç„¶åå¤§å®¶è€ƒå®Œä¹‹åï¼Œå¬å®Œ rqy è®²é¢˜å°±å¼€å§‹ç ”ç©¶ T2ï¼Œå‘ç°åŸæ¥å°±æ˜¯â€œ[ZJOI]ç¾éš¾â€é‚£é¢˜ã€‚ç„¶åå¤§å®¶å°±éƒ½å»åšäº†é‚£é“é¢˜ã€‚</p>
<p>è¿˜è®°å¾—wxåœ¨è€ƒåœºä¸Šå·²ç»æƒ³å‡ºäº†å‡ è¿‘æ­£è§£ï¼Œå½“æ—¶è‡ªå·±åªä¼šè†œã€‚</p>
<p>åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œâ€œç¾éš¾â€è¿™é¢˜åœ¨Luoguçš„é¢˜è§£åŒºï¼Œåœ°ä¸€ç¯‡é¢˜è§£ä¾æ—§æ˜¯wxçš„ï¼Œä»–çš„å‰ä¸‰æ¡è¯„è®ºä¾æ—§æ˜¯æˆ‘çš„ã€‚</p>
<p>æ„Ÿè§‰â€¦â€¦æœ‰ç‚¹ä¼¤æ„Ÿã€‚ä¸çŸ¥é“æ˜¯ä¸æ˜¯æœºæˆ¿å¤ªå†·çš„ç¼˜æ•…ï¼Œæ„Ÿåˆ°å¤§è„‘æœ‰äº›éº»æœ¨ã€‚æ˜¯å•Šï¼Œrqyä¸å†æ˜¯å½“å¹´çš„rqyäº†ï¼ŒLCEZ55çº§æœºæˆ¿ä¹Ÿä¸æ˜¯ä¹‹å‰é‚£ä¸ªLCEZ55çº§æœºæˆ¿äº†ï¼Œä¹Ÿæ¬åˆ°äº†æ–°æ ¡ã€‚æ€»ä¹‹ï¼Œä¸€åˆ‡éƒ½å˜äº†ã€‚</p>
<p>å€’ä¸æ˜¯è¯´æ”¹å˜ä¸å¥½ï¼Œåªæ˜¯é‚£äº›å¤•é˜³ä¸‹çš„åœºæ™¯æ€»æ˜¯è®©ç°å¦‚ä»Šå­‘ç„¶ä¸€èº«çš„æˆ‘æ„Ÿåˆ°æœ‰äº›æ— æ‰€é€‚ä»ã€‚</p>
<p>çœ‹æ¥æˆ‘å°±æ˜¯é‚£è¢«é—å¿˜åœ¨æ—¶å…‰é‡Œçš„è€äººäº†å§ã€‚</p>
<p>è¦è¯´å¯è¿ªä»€ä¹ˆçš„ï¼Œå¤§æ¦‚å°±æ˜¯ä¸è¦å†ç­‰åˆ°å¤±å»ä¹‹åå‘ç°è‡ªå·±å½“æ—¶æœ‰å¤šä¹ˆæ„šè ¢ã€‚</p>
<p>ä»¥å‰æ€»æ˜¯ä¸ç†è§£ä¸ºä»€ä¹ˆ rqy è¦ä¸ºäº†æ²¡æœ‰äººé™ªä»–å­¦OIè€Œå“­ï¼Œç°åœ¨æ‰å‘ç°ï¼Œâ€œå“¦ï¼ŒåŸæ¥æ˜¯è¿™æ ·å­çš„æ„Ÿè§‰å•Šâ€ã€‚</p>
<p>ã€ åˆé—»ä¸è§£æˆä¸­æ„ï¼Œå¦‚ä»Šå·²æ˜¯æˆä¸­äººã€‚ã€</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>ç­ç»æ ‘</category>
      </categories>
      <tags>
        <tag>å€å¢</tag>
        <tag>å›¾è®º/ç­ç»æ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘Cf Round 250</title>
    <url>/2019/12/30/CFR250/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>é¦–å…ˆå‘¢ï¼Œåšè¿™ä¸€åœºçš„åŸå› æ˜¯çœ‹äº† vfk çš„ blogï¼ˆ<a href="https://blog.csdn.net/VFleaKing/article/details/90521383" target="_blank" rel="noopener">æˆ³æˆ‘</a>ï¼‰æ„Ÿè§‰å¾ˆæœ‰è¶£ï¼Œå¹¶ä¸”ä¼¼ä¹ä»¥å‰çš„ CF çš„ <code>div1</code> éš¾åº¦æ¯”ç°åœ¨ä½ä¸€ç‚¹ï¼Œäºæ˜¯å°±æ‰“ç®—åšä¸€ä¸‹ã€‚</p>
<p>å—¯ï¼Œæ˜¯ä¸€åœº CNroundï¼Œå¯èƒ½ä¼šæ›´è´´åˆå›½å†…çš„å‡ºé¢˜æ°›å›´ï¼Ÿæ„Ÿè§‰è´¨é‡è¿˜æ˜¯å¾ˆå¥½çš„233.</p>
<p>é¢˜å·æ˜¯ $\rm CF437/438$ã€‚</p>
<p>å‘å‰è¾ˆä»¬è‡´æ•¬ï¼</p>
<a id="more"></a>
<h1 id="A"><a href="#A" class="headerlink" title="$A$"></a>$A$</h1><blockquote>
<p>ç»™å‡ºä¸€ä¸ªå››é¡¹é€‰æ‹©é¢˜ï¼Œä¸‰é•¿é€‰ä¸€çŸ­ï¼Œä¸‰çŸ­é€‰ä¸€é•¿ï¼Œå¦åˆ™é€‰ $C$ã€‚</p>
<p>å…¶ä¸­â€œçŸ­â€å’Œâ€œé•¿â€é™åˆ¶äº† 2 å€å…³ç³»ã€‚</p>
</blockquote>
<p>æˆ‘ä¸ä¼šå‘Šè¯‰ä½ è¿™é¢˜æˆ‘äº¤äº†5é:(</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; L[<span class="number">4</span>] ;</span><br><span class="line"><span class="keyword">char</span> I[<span class="number">4</span>][MAXN] ; <span class="keyword">int</span> ans ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; (I[<span class="number">0</span>] + <span class="number">1</span>) &gt;&gt; (I[<span class="number">1</span>] + <span class="number">1</span>) &gt;&gt; (I[<span class="number">2</span>] + <span class="number">1</span>) &gt;&gt; (I[<span class="number">3</span>] + <span class="number">1</span>) ;</span><br><span class="line">    L[<span class="number">0</span>].sc = <span class="number">0</span>, L[<span class="number">1</span>].sc = <span class="number">1</span>, L[<span class="number">2</span>].sc = <span class="number">2</span>, L[<span class="number">3</span>].sc = <span class="number">3</span> ;</span><br><span class="line">    L[<span class="number">0</span>].fr = <span class="built_in">strlen</span>(I[<span class="number">0</span>] + <span class="number">1</span>) - <span class="number">2</span>, L[<span class="number">1</span>].fr = <span class="built_in">strlen</span>(I[<span class="number">1</span>] + <span class="number">1</span>) - <span class="number">2</span> ;</span><br><span class="line">    L[<span class="number">2</span>].fr = <span class="built_in">strlen</span>(I[<span class="number">2</span>] + <span class="number">1</span>) - <span class="number">2</span>, L[<span class="number">3</span>].fr = <span class="built_in">strlen</span>(I[<span class="number">3</span>] + <span class="number">1</span>) - <span class="number">2</span> ; </span><br><span class="line">  sort(L, L + <span class="number">4</span>) ;</span><br><span class="line">    <span class="keyword">if</span> (L[<span class="number">3</span>].fr &gt;= L[<span class="number">2</span>].fr * <span class="number">2</span>) ++ ans ;</span><br><span class="line">    <span class="keyword">if</span> (L[<span class="number">0</span>].fr * <span class="number">2</span> &lt;= L[<span class="number">1</span>].fr) ans += <span class="number">2</span> ;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; ans &lt;&lt; endl ; </span></span><br><span class="line">    <span class="keyword">if</span> (ans == <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"%c"</span>, L[<span class="number">3</span>].sc + <span class="string">'A'</span>) ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ans == <span class="number">2</span>) <span class="built_in">printf</span>(<span class="string">"%c"</span>, L[<span class="number">0</span>].sc + <span class="string">'A'</span>) ;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"C"</span>) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="B"><a href="#B" class="headerlink" title="$B$"></a>$B$</h1><blockquote>
<p>ç»™ä½ ä¸¤ä¸ªæ•´æ•°$n$, $m$ï¼Œè¦æ±‚åœ¨ $1\sim m$ ä¸­é€‰ä»»æ„ä¸ªæ•° $x_i$ï¼Œä½¿å¾— $\sum lowbit(x_i)=n$ ã€‚ </p>
</blockquote>
<p>ä¸€å¼€å§‹è„‘æ®‹å†™äº†ä¸€å †å¥‡æ€ªçš„ä¸œè¥¿ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">pair &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; p[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, M, cnt, ans[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> (x &amp; (-x)) ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i)</span><br><span class="line">        p[i] = make_pair(lowbit(i), i) ;</span><br><span class="line">    sort(p + <span class="number">1</span>, p + M + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = M ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">        <span class="keyword">if</span> (N &gt;= p[i].first)</span><br><span class="line">            N -= p[i].first, ans[++ cnt] = p[i].second ;</span><br><span class="line">    <span class="keyword">if</span> (N) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>) ;</span><br><span class="line">    <span class="comment">/*while (N)&#123;</span></span><br><span class="line"><span class="comment">//        cout &lt;&lt; N &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">        if (N == lowbit(N))</span></span><br><span class="line"><span class="comment">            ans[++ cnt] = N ;</span></span><br><span class="line"><span class="comment">        else ans[++ cnt] = lowbit(N) ;</span></span><br><span class="line"><span class="comment">        if (ans[cnt] &gt; M) return puts("-1") ;</span></span><br><span class="line"><span class="comment">        else N -= lowbit(N) ;</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; cnt &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    <span class="keyword">while</span> (cnt) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[cnt --]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C"><a href="#C" class="headerlink" title="$C$"></a>$C$</h1><blockquote>
<p>$n$ ä¸ªå¸¦æƒç‚¹ï¼Œ$m$ æ¡æ— å‘è¾¹ï¼Œåˆ é™¤ä¸€ä¸ªç‚¹å°±è¦ä»˜å‡ºæ‰€æœ‰ä¸ä¹‹æœ‰ç›¸è¿ä¸”æ²¡æœ‰è¢«åˆ é™¤çš„ç‚¹çš„ç‚¹æƒä¹‹å’Œçš„ä»£ä»·ã€‚</p>
<p>æ±‚åˆ é™¤æ‰€æœ‰ç‚¹çš„æœ€å°ä»£ä»·ã€‚</p>
<p>$n,m\leq 200,000$</p>
</blockquote>
<p>å°æ¸…æ–°é¢˜ï¼Œå¯èƒ½éœ€è¦æƒ³ä¸€ä¼šå„¿ã€‚ç”±äºå‘ç°æœ€åæ¯æ¡è¾¹åªä¼šè¢«åˆ ä¸€æ¬¡ï¼Œä¸”æ¯æ¡è¾¹æ˜¾ç„¶éƒ½å¯ä»¥åšåˆ°è¢«å°æƒå€¼çš„ç‚¹åˆ æ‰ï¼Œäºæ˜¯ç­”æ¡ˆå°±æ˜¯ $\sum _{k\in E} \min(val_{from(k)},val_{to(k)})$ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; <span class="keyword">int</span> i, j, u, v ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cin</span> &gt;&gt; base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v, ans += <span class="number">1l</span>l * min(base[u], base[v]) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D"><a href="#D" class="headerlink" title="$D$"></a>$D$</h1><blockquote>
<p>ç»™å®šä¸€å¼ ç‚¹æƒå›¾ï¼Œéšæœºé€‰ä¸¤ä¸ªç‚¹ï¼Œæ±‚ä¸¤ç‚¹é—´æ‰€æœ‰ç®€å•è·¯å¾„ä¸­è·¯å¾„ä¸Šæœ€å°ç‚¹æƒçš„æœ€å¤§å€¼çš„æœŸæœ›ã€‚</p>
<p>$n,m\leq 200,000$</p>
</blockquote>
<p><del>å¼€å§‹æ—¶ä¸€ç›´è¯»ä¸æ‡‚é¢˜æˆ‘å¥½éš¾å•Š</del></p>
<p>å¤§æ¦‚å°±æ˜¯è€ƒè™‘ä¸€éå»ºç”Ÿæˆæ ‘ä¸€è¾¹å»ºç”Ÿæˆæ ‘ä¸€è¾¹åŒè®°ã€‚é¦–å…ˆè€ƒè™‘è·¯å¾„ä¸€å®šä¼šåœ¨æœ€å¤§ç”Ÿæˆæ ‘ä¸Šã€‚ç„¶åå‘ç°ç”±äºæ˜¯æœ€å°ç‚¹æƒï¼Œæ‰€ä»¥è¦ç”¨å°çš„é‚£ä¸ªç‚¹æ¥ç»Ÿè®¡ç­”æ¡ˆã€‚äºæ˜¯æ’å¥½åºåï¼Œå¯¹äºåŠ å…¥ä¸€ä¸ªç‚¹ $u$ ä¹‹å‰çš„é‚£äº›ç‚¹ï¼Œç‚¹æƒéƒ½å¤§äº $u$ ã€‚æ‰€ä»¥æ­¤æ—¶ $u$ å¯ä»¥ä½œä¸ºåªå‰©ä¸‹æƒå€¼æ¯”ä»–å¤§çš„ç‚¹æ—¶çš„å›¾ä¸­çš„ç­”æ¡ˆç‚¹ï¼Œç»Ÿè®¡ä¸€ä¸‹å³å¯ã€‚</p>
<p>å—¯ï¼Œæ˜¯ä¸ª trickã€‚è®°å¾—å½“æ—¶åšâ€œè´§è½¦è¿è¾“â€é‚£é¢˜æ˜¯ä¸ºäº†åº”ä»˜ä½œä¸šç›´æ¥ copy çš„åŒå­¦çš„ä»£ç ï¼Œå¯¼è‡´åæ¥ä¸€ç›´ä¸æ˜¯å¾ˆç†Ÿæ‚‰â€¦â€¦233</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">LL ans ;</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next ;</span><br><span class="line">&#125;E[MAXN] ; <span class="keyword">int</span> head[MAXN], cnt ;</span><br><span class="line"><span class="keyword">int</span> N, M, base[MAXN], fa[MAXN], sz[MAXN], Id[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x == fa[x] ? x : fa[x] = find(fa[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = v, next(cnt) = head[u], head[u] = cnt ;</span><br><span class="line">    to(++ cnt) = u, next(cnt) = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123; <span class="keyword">return</span> base[a] &gt; base[b] ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; <span class="keyword">int</span> u, v ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) sz[i] = <span class="number">1</span>, fa[i] = Id[i] = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), add(u, v) ;</span><br><span class="line">    sort(Id + <span class="number">1</span>, Id + N + <span class="number">1</span>, comp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        LL ctn = <span class="number">0</span> ; <span class="keyword">int</span> n = Id[i], f1, f2 ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = head[n] ; j ; j = next(j))&#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis[to(j)]) <span class="keyword">continue</span> ;</span><br><span class="line">            f1 = find(n), f2 = find(to(j)) ;</span><br><span class="line">            <span class="keyword">if</span> (f1 != f2)&#123;</span><br><span class="line">                ctn += <span class="number">1l</span>l * sz[f1] * sz[f2],</span><br><span class="line">                sz[f1] += sz[f2], fa[f2] = f1 ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans += <span class="number">1l</span>l * base[n] * ctn, vis[n] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> !<span class="built_in">printf</span>(<span class="string">"%lf\n"</span>, ans * <span class="number">2.0</span> / (<span class="number">1.0</span> * N * (N - <span class="number">1</span>))) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="E"><a href="#E" class="headerlink" title="$E$"></a>$E$</h1><blockquote>
<p>ç»™å‡º $n$ ä¸ªç‚¹ï¼Œæ±‚è¿™ä¸ªå¤šè¾¹å½¢çš„ä¸‰è§’å‰–åˆ†çš„æ–¹æ¡ˆæ•°å¯¹ $1e9+7$ å–æ¨¡ã€‚</p>
<p>$n\leq 200$</p>
</blockquote>
<p>æ•æˆ‘ç›´è¨€â€¦æˆ‘å¯¹ä¸‰è§’å‰–åˆ†å”¯ä¸€çŸ¥é“çš„å°±æ˜¯èƒ½å‰å‡ºå¤šè¾¹å½¢é¢ç§¯æ¥233</p>
<p>æ ¹æ®æ•°æ®èŒƒå›´çŒœç®—æ³•ï¼Œå‘ç°åº”è¯¥æ˜¯åŒºé—´ $dp$ çš„å½¢å¼ã€‚$f_{l,r}$ è¡¨ç¤ºåŒºé—´ $l,r$ å†…çš„ç‚¹çš„ä¸‰è§’å‰–åˆ†æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆè½¬ç§»å°±æ˜¯è€ƒè™‘</p>
<script type="math/tex; mode=display">
f_{l,r}=\sum_{k=l}^{r} [\mathrm{convex}(l\to k\to r)]\cdot (f_{l,k}\times f_{k,r})</script><p>å…¶ä¸­ $[]$ è¿˜æ˜¯è‰¾ä½›æ£®æ‹¬å·ï¼Œ$\rm convex$ å‡½æ•°ä¸ºä¸€ä¸ª $0/1$ å‡½æ•°ï¼Œè¿”å›ç»™å®šçš„ä¸‰ä¸ªç‚¹å¯¹äºæ•´ä¸ªå¤šè¾¹å½¢æ˜¯å¦æ˜¯å‡¸çš„ã€‚</p>
<p>ç„¶åä¸ºäº†å¿«é€Ÿåˆ¤æ–­è¿™ä¸ªä¸œè¥¿ï¼Œå¯ä»¥å…ˆæŠŠæ‰€æœ‰ç‚¹æŒ‰ç…§ä¸€ä¸ªæ–¹å‘æ’ä¸€åœˆï¼Œç„¶åå‰ç§¯æ±‚å‡ºæ˜¯å¦åœ¨å¤–ä¾§ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å¦‚ä½•ç”¨å‰ç§¯å»åˆ¤:</p>
<p>å¦‚æœ $a\times b &lt; 0$ è¯´æ˜ $a$ åœ¨ $b$ çš„é€†æ—¶é’ˆæ–¹å‘ï¼Œ $=0$ è¯´æ˜åŒå‘ï¼Œ $&gt;0$ è¯´æ˜ $a$ åœ¨ $b$ çš„é¡ºæ—¶é’ˆæ–¹å‘ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> N ;</span><br><span class="line"><span class="keyword">double</span> s ;</span><br><span class="line">LL f[MAXN][MAXN] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">nodes</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y ;</span><br><span class="line">    nodes <span class="keyword">friend</span> <span class="keyword">operator</span> - (<span class="keyword">const</span> nodes &amp;a, <span class="keyword">const</span> nodes &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> (nodes)&#123;a.x - b.x, a.y - b.y&#125; ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">friend</span> <span class="keyword">operator</span> * (<span class="keyword">const</span> nodes &amp;a, <span class="keyword">const</span> nodes &amp;b)&#123;</span><br><span class="line">        <span class="keyword">return</span> a.x * b.y - a.y * b.x ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;base[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">int</span> i, j, k ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>, &amp;base[i].x, &amp;base[i].y) ;</span><br><span class="line">    s += base[N] * base[<span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        s += base[i] * base[i + <span class="number">1</span>], f[i][i + <span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (s &gt; <span class="number">0</span>) reverse(base + <span class="number">1</span>, base + N + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = i - <span class="number">2</span> ; j &gt;= <span class="number">1</span> ; -- j)</span><br><span class="line">            <span class="keyword">for</span> (k = j ; k &lt;= i ; ++ k)</span><br><span class="line">                <span class="keyword">if</span> ((base[i] - base[j]) * (base[k] - base[j]) &gt; <span class="number">0</span>)</span><br><span class="line">                    (f[j][i] += f[j][k] * f[k][i]) %= Mod ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[<span class="number">1</span>][N] &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="F"><a href="#F" class="headerlink" title="$F$"></a>$F$</h1><blockquote>
<p>ç»™å®šæ•°åˆ—ï¼ŒåŒºé—´æŸ¥è¯¢å’Œï¼ŒåŒºé—´å–æ¨¡ï¼Œå•ç‚¹ä¿®æ”¹ã€‚</p>
<p>$1\leq n,m\leq 100,000,\quad 0\leq a_i\leq 10^9$ã€‚</p>
</blockquote>
<p>å¤§æ¦‚å°±æ˜¯å‘ç°å–æ¨¡çš„ä¸€ä¸ªæ€§è´¨ï¼Œå°±æ˜¯å–æ¨¡æˆåŠŸä¹‹åæ•°å€¼è‡³å°‘å‡åŠã€‚å¯ä»¥åˆ†ç±»è®¨è®º $p&gt;\frac{n}{2}$ å’Œ $p\leq \frac{n}{2}$ ï¼Œå‘ç° $n$ å¯¹  $p$ å–å®Œè†œä¹‹åè‚¯å®š $&lt;\frac{n}{2}$ ã€‚</p>
<p>äºæ˜¯è¿™ä¸œè¥¿å°±æ˜¯ $\log$ çš„ã€‚äºæ˜¯å°±å¯ä»¥ç›´æ¥ $m \log n + m\log a_i$ åšäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> mk, n, m, base[N] ;</span><br><span class="line"><span class="keyword">int</span> val[N &lt;&lt; <span class="number">1</span>] ; LL s[N &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Max</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123; <span class="keyword">return</span> a &gt; b ? a : b ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> val[rt] = s[rt] = base[l], <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    build(rt &lt;&lt; <span class="number">1</span>, l, mid) ;</span><br><span class="line">    build(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r) ;</span><br><span class="line">    s[rt] = s[rt &lt;&lt; <span class="number">1</span>] + s[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] ;</span><br><span class="line">    val[rt] = Max(val[rt &lt;&lt; <span class="number">1</span>], val[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _change(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> v)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> val[rt] = s[rt] = v, <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid) _change(rt &lt;&lt; <span class="number">1</span>, l, mid, p, v) ;</span><br><span class="line">    <span class="keyword">else</span> _change(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, p, v) ;</span><br><span class="line">    s[rt] = s[rt &lt;&lt; <span class="number">1</span>] + s[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] ;</span><br><span class="line">    val[rt] = Max(val[rt &lt;&lt; <span class="number">1</span>], val[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> mod)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> val[rt] %= mod, s[rt] %= mod, <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid &amp;&amp; val[rt &lt;&lt; <span class="number">1</span>] &gt;= mod)</span><br><span class="line">        update(rt &lt;&lt; <span class="number">1</span>, l, mid, ul, ur, mod) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid &amp;&amp; val[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] &gt;= mod)</span><br><span class="line">        update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ul, ur, mod) ;</span><br><span class="line">    s[rt] = s[rt &lt;&lt; <span class="number">1</span>] + s[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] ;</span><br><span class="line">    val[rt] = Max(val[rt &lt;&lt; <span class="number">1</span>], val[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; LL res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= ql &amp;&amp; r &lt;= qr) <span class="keyword">return</span> s[rt] ;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= mid)</span><br><span class="line">        res += query(rt &lt;&lt; <span class="number">1</span>, l, mid, ql, qr) ;</span><br><span class="line">    <span class="keyword">if</span> (qr &gt; mid)</span><br><span class="line">        res += query(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ql, qr) ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; <span class="keyword">int</span> l, r, v ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; build(<span class="number">1</span>, <span class="number">1</span>, n) ;</span><br><span class="line">    <span class="keyword">while</span> (m --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mk) ;</span><br><span class="line">        <span class="keyword">if</span> (mk == <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;l, &amp;r),</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, query(<span class="number">1</span>, <span class="number">1</span>, n, l, r)) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (mk == <span class="number">2</span>)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;l, &amp;r, &amp;v),</span><br><span class="line">            update(<span class="number">1</span>, <span class="number">1</span>, n, l, r, v) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;r, &amp;v), _change(<span class="number">1</span>, <span class="number">1</span>, n, r, v) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="G"><a href="#G" class="headerlink" title="$G$"></a>$G$</h1><blockquote>
<p>æ±‚æ¯ä¸ªç»“ç‚¹éƒ½æœ‰ä¸ªæƒå€¼åªåœ¨ $c_1, c_2, â€¦, c_n$ä¸­å–çš„ï¼Œæ€»ç‚¹æƒä¸º $s$ çš„äºŒå‰æ ‘çš„ä¸ªæ•°ã€‚å¯¹äºæ¯ä¸ª $1 \leq s \leq m$ è®¡ç®—ç­”æ¡ˆã€‚</p>
<p>$1\leq n,m \leq 10^5$ ã€‚</p>
</blockquote>
<p>å‘ç°å…¶å®æ˜¯ä¸€ä¸ªå¡ç‰¹å…°æ•°çš„è½¬ç§»å½¢å¼ã€‚ä»¤ $f_n$ è¡¨ç¤ºæ€»ç‚¹æƒä¸º $n$ çš„äºŒå‰æ ‘ä¸ªæ•°ï¼Œé‚£ä¹ˆè½¬ç§»åº”è¯¥è¿™ä¹ˆè½¬ç§»ï¼š</p>
<script type="math/tex; mode=display">
f_n=[n=0]+\sum_{p=1}^{m}[p\in c] \sum_{q=0}^{m-p}f_{q}f_{m-p-q}</script><p>å‘ç°åé¢æ˜¯ $p + q + m-p-q=m$ ï¼Œæ­£å¥½æ˜¯å·ç§¯çš„å½¢å¼ã€‚</p>
<p>é‚£å¦‚æœè®¾ $\\{ f_n\\}$ çš„ç”Ÿæˆå‡½æ•°ä¸º $\rm F$ï¼Œ $g_x=[x\in c]$ï¼Œ$\\{g_n\\}$ çš„ç”Ÿæˆå‡½æ•°ä¸º $\rm G$ï¼Œåˆ™æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\rm F = G\times F^2+1</script><p>é‚£ä¹ˆè§£ä¸€ä¸‹å¯ä»¥å¾—åˆ°</p>
<script type="math/tex; mode=display">
\rm F=\frac{1Â±\sqrt{1-4G}}{2G}</script><p>å‘ç°æ”¹å˜ä¸€ä¸‹å½¢å¼ä¹‹åï¼š</p>
<script type="math/tex; mode=display">
\rm F=\frac{2}{1Â±\sqrt{1-4G}}</script><p>è¿™ä¸œè¥¿ï¼Œåœ¨å–è´Ÿå·çš„æ—¶å€™ï¼Œåˆ†æ¯æ˜¯ä¸å­˜åœ¨é€†å…ƒçš„ã€‚æ‰€ä»¥åˆ†æ¯å–æ­£å·ã€‚</p>
<p>ç„¶åå°±å¤šé¡¹å¼ä¸€é¡¿å¥—å°±å®Œäº†233ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Gp = <span class="number">3</span> ;</span><br><span class="line"><span class="keyword">int</span> N, M, K, Gi, R[MAXN] ;</span><br><span class="line">LL G[MAXN], H[MAXN], F[MAXN], t[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) (res *= a) %= P ;</span><br><span class="line">        a = <span class="number">1l</span>l * a * a % P, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(LL *J, <span class="keyword">int</span> L, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    rr LL Gn, Gi = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; R[i]) J[i] ^= J[R[i]] ^= J[i] ^= J[R[i]] ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; L ; i &lt;&lt;= <span class="number">1</span>)&#123;</span><br><span class="line">        Gn = expow(Gp, (P - <span class="number">1</span>) / (i &lt;&lt; <span class="number">1</span>)) ;</span><br><span class="line">        <span class="keyword">for</span> (rr <span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; L ; Gi = <span class="number">1</span>, j += (i &lt;&lt; <span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">for</span> (rr <span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; i ; ++ k, Gi = Gi * Gn % P)&#123;</span><br><span class="line">                rr <span class="keyword">int</span> real = J[j + k], iroot = J[j + k + i] * Gi % P ;</span><br><span class="line">                J[j + k] = (real + iroot) % P, J[j + k + i] = (real - iroot + P) % P ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag &gt; <span class="number">0</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> Inv = expow(L, P - <span class="number">2</span>) ;  reverse(J + <span class="number">1</span>, J + L) ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i) J[i] = <span class="number">1l</span>l * J[i] * Inv % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _Inv(LL *f, LL *g, <span class="keyword">int</span> len)&#123;</span><br><span class="line">    <span class="keyword">if</span> (len &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        g[<span class="number">0</span>] = expow(f[<span class="number">0</span>], P - <span class="number">2</span>) ;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    rr <span class="keyword">int</span> i, l = <span class="number">0</span>, Len = <span class="number">1</span> ;</span><br><span class="line">    _Inv(f, g, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (Len &lt; (len &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; len ; ++ i) t[i] = f[i] ; NTT(g, Len, <span class="number">1</span>), NTT(t, Len, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) g[i] = (<span class="number">2l</span>l - t[i] * g[i] % P + P) % P * g[i] % P ;</span><br><span class="line">    NTT(g, Len, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = len ; i &lt; Len ; ++ i) g[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line">LL Ig[MAXN], pf[MAXN] ;</span><br><span class="line"><span class="keyword">void</span> _sqr(LL *f, LL *g, <span class="keyword">int</span> len)&#123;</span><br><span class="line">    <span class="keyword">if</span> (len &lt;= <span class="number">1</span>)&#123; g[<span class="number">0</span>] = <span class="number">1</span> ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">    rr <span class="keyword">int</span> i, l = <span class="number">0</span>, Len = <span class="number">1</span> ;</span><br><span class="line">    _sqr(f, g, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (Len &lt; (len &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = len ; i &lt; Len ; ++ i) pf[i] = Ig[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; len ; ++ i) Ig[i] = <span class="number">0</span>, pf[i] = <span class="number">2</span> * g[i] % P ;</span><br><span class="line">    _Inv(pf, Ig, len) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) <span class="comment">/* */</span> t[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; ( l - <span class="number">1</span> )) ;</span><br><span class="line">    NTT(g, Len, <span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) g[i] = g[i] * g[i] % P ;</span><br><span class="line">    NTT(g, Len, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; len ; ++ i) g[i] = (g[i] + f[i]) % P ;</span><br><span class="line">    NTT(g, Len, <span class="number">1</span>) ; NTT(Ig, Len, <span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) g[i] = g[i] * Ig[i] % P ;</span><br><span class="line">    NTT(g, Len, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = len ; i &lt; Len ; ++ i) g[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, j, l = <span class="number">1</span> ;</span><br><span class="line">    Gi = expow(Gp, P - <span class="number">2</span>) ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K, ++ K, M = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;j), F[j] = <span class="number">1</span> ;</span><br><span class="line">    F[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; K ; ++ i)</span><br><span class="line">        F[i] = (<span class="number">-4l</span>l * F[i] % P + P) % P ;</span><br><span class="line"><span class="comment">//    for (i = 0 ; i &lt; K ; ++ i) cout &lt;&lt; F[i] &lt;&lt; " " ;</span></span><br><span class="line">    _sqr(F, G, K), (G[<span class="number">0</span>] += <span class="number">1</span>) %= P ;</span><br><span class="line"><span class="comment">//    for (i = 0 ; i &lt; K ; ++ i) cout &lt;&lt; G[i] &lt;&lt; " " ;</span></span><br><span class="line">    _Inv(G, H, K) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; K ; ++ i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, H[i] * <span class="number">2l</span>l % P) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>æ€ç»´é¢˜/è®¡æ•°</tag>
        <tag>åŠ¨æ€è§„åˆ’/æ™®é€šDP</tag>
        <tag>è´ªå¿ƒ</tag>
        <tag>å¥‡æ€ªçš„æŠ€å·§</tag>
        <tag>å¤šé¡¹å¼çš„åº”ç”¨</tag>
        <tag>ç»„åˆè®¡æ•°/ç”Ÿæˆå‡½æ•°</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æè¶…æ ‘</title>
    <url>/2019/12/28/%E6%9D%8E%E8%B6%85%E6%A0%91/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æè¶…æ ‘ï¼Œä¸€ç§å¥‡æ€ªçš„æ•°æ®ç»“æ„â€”â€”ç„¶è€Œå…¶å®æ˜¯çº¿æ®µæ ‘ï¼Œç”¨äºç»´æŠ¤å¹³é¢ä¼˜åŠ¿ç›´çº¿ã€‚</p>
<p>é¡ºä¾¿å­¦äº†å­¦æ ‡è®°æ°¸ä¹…åŒ–ã€‚</p>
<a id="more"></a>
<p>è™½ç„¶ä¸çŸ¥é“æ˜¯è°ï¼Œä½†æ˜¯å…ˆorzæè¶…233</p>
<h1 id="1-æ ‡è®°æ°¸ä¹…åŒ–"><a href="#1-æ ‡è®°æ°¸ä¹…åŒ–" class="headerlink" title="$1$ æ ‡è®°æ°¸ä¹…åŒ–"></a>$1$ æ ‡è®°æ°¸ä¹…åŒ–</h1><p>ä¼¼ä¹æè¶…æ ‘ä¸æ˜¯å¾ˆå¥½ <code>push_down</code> çš„æ ·å­ï¼Œäºæ˜¯å»ç½‘ä¸Šå­¦äº†ä¸€å‘ã€‚å¤§æ¦‚æ€æƒ³å°±æ˜¯ï¼Œçº¿æ®µæ ‘åŒºé—´ç»´æŠ¤æ—¶ä¿¡æ¯ä¸å†æ‰“æ ‡è®°ï¼Œè€Œæ˜¯é€‰æ‹©æŠŠæ ‡è®°æ‰“åœ¨è‡ªå·±èº«ä¸Šä¸å†ä¸‹ä¼ ã€‚æŸ¥è¯¢çš„æ—¶å€™ä¸€è·¯æŸ¥ä¸‹å»ï¼Œè®°å½•è¦†ç›–åœ¨è¿™æ¡è·¯å¾„ä¸Šçš„ä¿¡æ¯ï¼Œç„¶ååŸºäºä¿®æ”¹çš„ä¿¡æ¯å¯¹æ•´ä¸ªåŒºé—´çš„ä¿¡æ¯åˆå¹¶ä¸€ä¸‹å³å¯ã€‚</p>
<p>ç„¶åæ˜¯çå†™çš„ä¼ªä»£ç ï¼ŸSumblime 3 çœŸå¥½ç”¨ï¼Œè‡ªåˆ›è¯­æ³•çœŸæœ‰è¶£233</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é»˜è®¤åŒºé—´ä¿®æ”¹ = åŒºé—´çš„æ¯ä¸ªå•ç‚¹æ›´æ–°ä¿¡æ¯ </span></span><br><span class="line">Class Segment_Tree&#123;</span><br><span class="line">	Inform * Tag, Val ;</span><br><span class="line">	<span class="keyword">int</span> : L, R, Mid, Lson, Rson ;</span><br><span class="line">	<span class="function">Function <span class="title">Clear</span><span class="params">()</span> </span>&#123;....&#125; ;</span><br><span class="line">&#125;<span class="comment">//å…¶ä¸­ *Tag æ˜¯å½“å‰ç‚¹ç»´æŠ¤ä¿¡æ¯æ—¶æ‰“çš„æ ‡è®°ï¼Œ*Val æ˜¯å½“å‰èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚</span></span><br><span class="line"></span><br><span class="line">Function[Inform] Merge(Inform * n, Inform * m) &#123;....&#125; ;</span><br><span class="line">Function[<span class="keyword">void</span>] Update(Segment_Tree *T, <span class="keyword">int</span> root, <span class="keyword">int</span> qL, <span class="keyword">int</span> qR, Inform *S)&#123;</span><br><span class="line">	Do_Some_Work(T[root], qL, qR, S) ;</span><br><span class="line">	<span class="keyword">if</span> (T[root] -&gt; L &gt;= qL &amp;&amp; T[root] -&gt; R &lt;= qR)</span><br><span class="line">		<span class="keyword">return</span> T[root].Tag = Merge(S, T[root].tag), <span class="keyword">void</span>() ;  </span><br><span class="line">	<span class="keyword">if</span> (qL &lt;= T[root] -&gt; Mid) </span><br><span class="line">		Update(T, T[root].Lson, qL, qR, S) ;</span><br><span class="line">	<span class="keyword">if</span> (qR &gt; T[root] -&gt; Mid) </span><br><span class="line">		Update(T, T[root].Rson, qL, qR, S) ;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">void</span>() ; </span><br><span class="line">&#125;</span><br><span class="line">Function[Inform] Query(Segment_Tree *T, <span class="keyword">int</span> root, <span class="keyword">int</span> qL, <span class="keyword">int</span> qR, Inform *S)&#123;</span><br><span class="line"><span class="comment">//è¯¢é—®æ“ä½œï¼Œæœ€åä¸€ä¸ªå‚æ•°ä»£è¡¨ä¸€è·¯è¯¢é—®ä¸‹æ¥çš„åˆå¹¶æ ‡è®°</span></span><br><span class="line">	Inform * res ; res = EMPTY ; </span><br><span class="line">	<span class="keyword">if</span> (T[root] -&gt; L &gt;= qL &amp;&amp; T[root] -&gt; R &lt;= qR) </span><br><span class="line">		<span class="keyword">return</span> res = Merge(T[root].Val, S) ; </span><br><span class="line">	<span class="keyword">if</span> (qL &lt;= T[root] -&gt; Mid) </span><br><span class="line">		res = Merge(res, Query(T, T[root].Lson, qL, qR, Merge(S, T[root].tag))) ;</span><br><span class="line">	<span class="keyword">if</span> (qR &gt; T[root] -&gt; Mid) </span><br><span class="line">		res = Merge(res, Query(T, T[root].Rson, qL, qR, Merge(S, T[root].tag))) ;</span><br><span class="line">	<span class="keyword">return</span> res ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-æè¶…æ ‘"><a href="#2-æè¶…æ ‘" class="headerlink" title="$2$ æè¶…æ ‘"></a>$2$ æè¶…æ ‘</h1><p>é¦–å…ˆæè¶…æ ‘çš„æœ€ç®€å•æ“ä½œå°±æ˜¯ï¼š</p>
<ul>
<li>å‘å¹³é¢å†…æ·»åŠ ä¸€æ¡ç›´çº¿</li>
<li>æŸ¥è¯¢è¦†ç›–åœ¨æŸä¸ªåæ ‡ä¸Šçš„ç›´çº¿ä¸­ï¼Œçºµåæ ‡å€¼æœ€å¤§/æœ€å°å€¼</li>
<li>$n,m\leq 200,000$</li>
</ul>
<p>è€ƒè™‘å¦‚ä½•ç»´æŠ¤è¿™ä¸ªä¸œè¥¿ï¼Œè€ƒè™‘ç»´æŠ¤æ¯ä¸ªç‚¹ä»£è¡¨åŒºé—´çš„<strong>ä¼˜åŠ¿ç›´çº¿</strong>ï¼Œå³åœ¨å¤§å¤šæ•°åŒºåŸŸå†…<strong>å¯èƒ½</strong>æ˜¯æœ€ä¼˜è§£çš„é‚£æ¡çº¿â€”â€”æˆ–è€…ï¼Œåœ¨ä»£è¡¨åŒºé—´çš„ä¸­ç‚¹æ˜¯æœ€ä¼˜è§£çš„ç›´çº¿ã€‚è¿™ä¹ˆåšé‡‡ç”¨äº†å¯å‘å¼çš„æ€æƒ³ï¼Œä¿å­˜äº†æœ‰é™å¤šçš„å¤‡é€‰æœ€ä¼˜è§£ã€‚äºæ˜¯å°±å¯ä»¥ä¿è¯æœ€åè¯¢é—®çš„æ—¶å€™ï¼Œé‡‡ç”¨æ ‡è®°æ°¸ä¹…åŒ–çš„æ€æƒ³ï¼Œå–æ‰€æœ‰è¦†ç›–åœ¨ä¸€ä¸ªå•ç‚¹ä¸Šçš„ä¼˜åŠ¿ç›´çº¿çš„æœ€å¤§å€¼å³å¯ï¼Œå¤æ‚åº¦ $\log n$ ã€‚</p>
<p>é‚£ä¹ˆè€ƒè™‘æ€ä¹ˆç»´æŠ¤ä¼˜åŠ¿åŒºé—´ã€‚å‡è®¾åŒºé—´ $\rm [L,R]$ çš„ä¼˜åŠ¿ç›´çº¿ä¸º $l$ ï¼Œç°åœ¨æ’å…¥ä¸€æ¡ç›´çº¿ $lâ€™$ï¼Œå¼€å§‹åˆ†ç±»è®¨è®ºï¼š</p>
<ul>
<li>å¦‚æœå½“å‰åŒºé—´çš„å·¦ç«¯å’Œå³ç«¯éƒ½æ»¡è¶³ $lâ€™$ æ›´ä¼˜ï¼Œé‚£ä¹ˆç›´æ¥æ‹¿ $lâ€™$ æ›¿ä»£ã€‚</li>
<li><p>å¦‚æœå½“å‰å–ä»¶çš„å·¦ç«¯å’Œå³ç«¯éƒ½æ»¡è¶³ $lâ€™$ æ›´åŠ£ï¼Œé‚£ä¹ˆ $lâ€™$ çˆ±æ»šå“ªå»æ»šå“ªå»ã€‚</p>
</li>
<li><p>$\mathrm {slope}(lâ€™)&gt;\mathrm{slope}(l)$</p>
<ul>
<li><p>å½“ $l$ åœ¨ä¸­ç‚¹å¤„çš„å€¼æ¯” $lâ€™$ åŠ£æ—¶ï¼Œé‚£ä¹ˆå·¦åŒºé—´å¯èƒ½è¦ç®—ä¸€æ³¢ï¼Œå³åŒºé—´å°±ä¸€å®šä¼šæ˜¯ $lâ€™$ æ›´ä¼˜ã€‚è¿™ä¸ªæ—¶å€™ä¸ºäº†ä¿è¯ $l$ ä½œä¸ºæ½œåœ¨çš„ä¼˜é€‰æ–¹æ¡ˆä¸ä¸¢å¤±ï¼Œå°±æŠŠ $lâ€™$ ä¿å­˜åœ¨å½“å‰åŒºé—´ï¼ŒæŠŠ $l$ é€åˆ°è‡ªå·±çš„å·¦å„¿å­åŒºé—´ã€‚</p>
</li>
<li><p>$lâ€™$ æ›´åŠ£æ—¶ï¼Œé‚£ä¹ˆå³åŒºé—´å¯èƒ½ç®—ä¸€æ³¢ï¼Œå½“å‰åŒºé—´çš„ä¼˜åŠ¿ç›´çº¿ä¹Ÿä¸ä¼šå˜ï¼Œæ‰€ä»¥åªå»æ”¹å³åŒºé—´å³å¯ã€‚</p>
</li>
</ul>
</li>
<li><p>$\mathrm {slope}(lâ€™)&lt;\mathrm{slope}(l)$</p>
<ul>
<li>åŒç†å¯è¯ï¼Œæ˜¾ç„¶ï¼Œè¯æ¯•ï¼ˆ</li>
</ul>
</li>
</ul>
<p>äºæ˜¯å°±ä¸Šä»£ç ï¼Œæ¨¡æ¿é¢˜ <code>LG4254 JSOI2008 BlueMarryå¼€å…¬å¸</code>ã€‚æ³¨æ„æœ¬é¢˜ç»™çš„ç›´çº¿éœ€è¦å¹³ç§»ä¸€ä¸‹å†ç”¨ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">double</span> b[N &lt;&lt; <span class="number">2</span>], k[N &lt;&lt; <span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">char</span> s[N] ; <span class="keyword">int</span> m, n, v[N &lt;&lt; <span class="number">2</span>], x, cnt ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">double</span> <span class="title">val</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> k[id] * (x - <span class="number">1</span>) + b[id] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">double</span> o, p, q, u, s, t ;</span><br><span class="line">    o = val(l, id), p = val(l, v[rt]) ;</span><br><span class="line">    q = val(r, id), u = val(r, v[rt]) ;</span><br><span class="line">    s = val(mid, id), t = val(mid, v[rt]) ;</span><br><span class="line">    <span class="keyword">if</span> (o &lt;= p &amp;&amp; q &lt;= u) <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">if</span> (o &gt; p &amp;&amp; q &gt; u) <span class="keyword">return</span> v[rt] = id, <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">if</span> (k[v[rt]] &gt; k[id20])</span><br><span class="line">        <span class="keyword">if</span> (s &lt; t) update(rt &lt;&lt; <span class="number">1</span>, l, mid, id) ;</span><br><span class="line">        <span class="keyword">else</span> update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, v[rt]), v[rt] = id ;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">if</span> (s &lt; t) update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, id) ;</span><br><span class="line">        <span class="keyword">else</span> update(rt &lt;&lt; <span class="number">1</span>, l, mid, v[rt]), v[rt] = id ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> val(x, v[rt]) ;</span><br><span class="line">    <span class="keyword">if</span> (x &lt;= mid)</span><br><span class="line">        <span class="keyword">return</span> max(val(x, v[rt]), query(rt &lt;&lt; <span class="number">1</span>, l, mid, x)) ;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> max(val(x, v[rt]), query(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, x)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m, n = <span class="number">50001</span> ;</span><br><span class="line">    <span class="keyword">while</span> (m --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (s[<span class="number">1</span>] == <span class="string">'P'</span>)</span><br><span class="line">            ++ cnt,</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>, &amp;b[cnt], &amp;k[cnt]),</span><br><span class="line">            update(<span class="number">1</span>, <span class="number">1</span>, n, cnt) ;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x),</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, (<span class="keyword">int</span>)query(<span class="number">1</span>, <span class="number">1</span>, n, x) / <span class="number">100</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-ä¸€é“ä¾‹é¢˜"><a href="#3-ä¸€é“ä¾‹é¢˜" class="headerlink" title="$3$ ä¸€é“ä¾‹é¢˜"></a>$3$ ä¸€é“ä¾‹é¢˜</h1><p>ä¾‹é¢˜å°±æ˜¯ <code>HEOI2013 Segment</code> ã€‚æ’å…¥ä¸€æ¡<strong>çº¿æ®µ</strong>ï¼Œç»´æŠ¤æ¯ä¸ªæ¨ªåæ ‡çš„ä¼˜åŠ¿çº¿æ®µç¼–å·ã€‚</p>
<p>å‘ç°é­”æ”¹ä¸€ä¸‹å°±å¯ä»¥ã€‚ç„¶åä¸€ä¸ªå‘ç‚¹å°±æ˜¯æ–œç‡ä¸º $\inf$ çš„çº¿æ®µè¦ç‰¹æ®Šå¤„ç†ä¸€ä¸‹ï¼Œç„¶è€Œä¸€å¼€å§‹è‡ªå·±ç›´æ¥æŠŠè¿™ç§çº¿æ®µçš„ $\max val$ å½“ä½œ $\inf$ ç®—äº†ä¹Ÿæ˜¯å¾ˆé™æ™ºã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Inf 19260817.0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M1 39989</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M2 1000000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> b[N &lt;&lt; <span class="number">2</span>], k[N &lt;&lt; <span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> L, m, mk, n, v[N &lt;&lt; <span class="number">2</span>], x, cnt ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">double</span> <span class="title">val</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1.0</span> * x * k[id] + b[id] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= ul &amp;&amp; r &lt;= ur)&#123;</span><br><span class="line">        <span class="keyword">double</span> o, p, q, u, s, t ;</span><br><span class="line">        o = val(l, id), p = val(l, v[rt]) ;</span><br><span class="line">        q = val(r, id), u = val(r, v[rt]) ;</span><br><span class="line">        s = val(mid, id), t = val(mid, v[rt]) ;</span><br><span class="line">        <span class="keyword">if</span> (o &lt;= p &amp;&amp; q &lt;= u) <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">        <span class="keyword">if</span> (o &gt; p &amp;&amp; q &gt; u) <span class="keyword">return</span> v[rt] = id, <span class="keyword">void</span>() ;</span><br><span class="line">        <span class="keyword">if</span> (k[v[rt]] &gt; k[cnt])</span><br><span class="line">            <span class="keyword">if</span> (s &lt; t) update(rt &lt;&lt; <span class="number">1</span>, l, mid, ul, ur, id) ;</span><br><span class="line">            <span class="keyword">else</span> update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ul, ur, v[rt]), v[rt] = id ;</span><br><span class="line">	    <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">if</span> (s &lt; t) update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ul, ur, id) ;</span><br><span class="line">            <span class="keyword">else</span> update(rt &lt;&lt; <span class="number">1</span>, l, mid, ul, ur, v[rt]), v[rt] = id ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, l, mid, ul, ur, id) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid) update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ul, ur, id) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> v[rt] ;</span><br><span class="line">    <span class="keyword">if</span> (x &lt;= mid)&#123;</span><br><span class="line">        <span class="keyword">int</span> id = query(rt &lt;&lt; <span class="number">1</span>, l, mid, x) ;</span><br><span class="line">        <span class="keyword">if</span> (val(x, id) &gt; val(x, v[rt])) <span class="keyword">return</span> id ; <span class="keyword">else</span> <span class="keyword">return</span> v[rt] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> id = query(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, x) ;</span><br><span class="line">        <span class="keyword">if</span> (val(x, id) &gt; val(x, v[rt])) <span class="keyword">return</span> id ; <span class="keyword">else</span> <span class="keyword">return</span> v[rt] ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">w</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> (x + L - <span class="number">1</span>) % M1 + <span class="number">1</span> ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">g</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> (x + L - <span class="number">1</span>) % M2 + <span class="number">1</span> ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a, e, c, d ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m, n = <span class="number">50001</span> ;</span><br><span class="line">    <span class="keyword">while</span> (m --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mk) ;</span><br><span class="line">        <span class="keyword">if</span> (mk)&#123;</span><br><span class="line">            ++ cnt ;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;a, &amp;e, &amp;c, &amp;d) ;</span><br><span class="line">            a = w(a), e = g(e), c = w(c), d = g(d) ;</span><br><span class="line"><span class="comment">//            cout &lt;&lt; a &lt;&lt; " " &lt;&lt; e &lt;&lt; " " &lt;&lt; c &lt;&lt; " " &lt;&lt; d &lt;&lt; endl ;</span></span><br><span class="line">            <span class="keyword">if</span> (a &gt; c) swap(a, c), swap(d, e) ;</span><br><span class="line">            <span class="keyword">if</span> (c == a) k[cnt] = <span class="number">0</span>, b[cnt] = max(d, e) ;</span><br><span class="line">            <span class="keyword">else</span> k[cnt] = (<span class="keyword">double</span>)(d - e) / (<span class="keyword">double</span>)(c - a),</span><br><span class="line">                 b[cnt] = <span class="number">1.0</span> * d - <span class="number">1.0</span> * c * k[cnt] ;</span><br><span class="line"><span class="comment">//            cout &lt;&lt; k[cnt] &lt;&lt; " " &lt;&lt; b[cnt] &lt;&lt; endl ;</span></span><br><span class="line">            update(<span class="number">1</span>, <span class="number">1</span>, n, a, c, cnt) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), x = w(x),</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, L = query(<span class="number">1</span>, <span class="number">1</span>, n, x)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>æè¶…æ ‘</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„/æè¶…æ ‘</tag>
        <tag>æ•°æ®ç»“æ„/çº¿æ®µæ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å¯¹æŠ—æœç´¢ä¸Alpha-Betaå‰ªæ</title>
    <url>/2019/12/28/%E5%AF%B9%E6%8A%97%E6%90%9C%E7%B4%A2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å­¦äº†ä¸€ä¸‹æ¯”è¾ƒç®€å•çš„åšå¼ˆæ¨¡å‹çš„å¸¸è§„æ±‚è§£æ–¹å¼ï¼Œå‘ç°å°±æ˜¯çˆ†æœã€‚é¡ºä¾¿å­¦äº†æœ‰å¯å‘å¼æ€æƒ³çš„ Alpha-Beta å‰ªæï¼Œç°åœ¨è§‰å¾—æ˜¯ç„å­¦â€¦â€¦å¯èƒ½è¿˜æ˜¯è®°æœæ¯”è¾ƒé è°±ï¼Ÿ</p>
<a id="more"></a>
<h1 id="1-å¯¹æŠ—æœç´¢"><a href="#1-å¯¹æŠ—æœç´¢" class="headerlink" title="1 å¯¹æŠ—æœç´¢"></a>1 å¯¹æŠ—æœç´¢</h1><p>â€¦â€¦ç„¶è€Œå…¶å®å°±æ˜¯æœç´¢ã€‚æ¯æ¬¡å¤§æ¦‚å°±æ˜¯è®°å½•ä¸€ä¸‹åŒæ–¹çš„å†³ç­–ç»“æœå’Œï¼ˆå“ˆå¸Œä¹‹åçš„ï¼‰å±€é¢ï¼Œç„¶åæ”¹è°èµ°è°èµ°å°±å®Œäº†ã€‚ä¼ªä»£ç å¤§æ¦‚å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">Function <span class="title">doMax</span><span class="params">(State S)</span></span>&#123;</span><br><span class="line">	Value res = -Inf ;</span><br><span class="line">	State Moveable_Set = calc(S) ;   </span><br><span class="line">	<span class="keyword">for</span> : s in Moveable_Set&#123;</span><br><span class="line">		Value now = evaluate(doMin(S)) ;</span><br><span class="line">		<span class="keyword">if</span> [now &gt; res] res = now ; </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Function <span class="title">doMin</span><span class="params">(State S)</span></span>&#123;</span><br><span class="line">	Value res = Inf ;</span><br><span class="line">	State Moveable_Set = calc(S) ;   </span><br><span class="line">	<span class="keyword">for</span> : s in Moveable_Set&#123;</span><br><span class="line">		Value now = evaluate(doMax(S)) ;</span><br><span class="line">		<span class="keyword">if</span> [now &lt; res] res = now ; </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> res ;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤§æ¦‚å°±æ˜¯äº¤æ›¿è¿­ä»£çš„æ€æƒ³ã€‚</p>
<p>è€ƒè™‘ä¸€æ£µåšå¼ˆæ ‘ï¼ŒèŠ‚ç‚¹æ‰¿è½½çš„ä¿¡æ¯æ˜¯å±€é¢ ã€‚é‚£ä¹ˆå¯¹äºä¸€ä¸ªé›¶å’Œåšå¼ˆæ¸¸æˆï¼ŒåŒæ–¹å¿…ç„¶æ˜¯è®©è‡ªå·±å¾—ç›Šæ›´å¤šï¼Œäºæ˜¯è€ƒè™‘è½¬åŒ–ä¸€ä¸‹ï¼Œä»¤å±€é¢çš„åˆ†æ•°ä¸ºã€Œå…ˆæ‰‹çš„åˆ†æ•° - åæ‰‹çš„åˆ†æ•°ã€ï¼Œé‚£ä¹ˆå…ˆæ‰‹å°±æ˜¯æœ€å¤§åŒ–å±€é¢åˆ†æ•°ï¼Œåæ‰‹åˆ™æ˜¯æœ€å°åŒ–ã€‚</p>
<p>äºæ˜¯å®šä¹‰è½®åˆ°<strong>æœ€å¤§åŒ–å±€é¢åˆ†æ•°ä¸€æ–¹</strong>èµ°çš„å±€é¢èŠ‚ç‚¹å«åš $\boldsymbol{Max}$<strong>èŠ‚ç‚¹</strong>ï¼Œè½®åˆ°<strong>æœ€å°åŒ–å±€é¢åˆ†æ•°ä¸€æ–¹</strong>èµ°çš„å±€é¢èŠ‚ç‚¹å«åš $\boldsymbol{Min}$<strong>èŠ‚ç‚¹</strong> ã€‚é‚£ä¹ˆæ˜¾ç„¶åœ¨åšå¼ˆæ ‘ä¸ŠåŒç±»èŠ‚ç‚¹é›†åˆæ˜¯ä¸€ä¸ªç‹¬ç«‹é›†ã€‚è¿™ç§åšå¼ˆä¹Ÿå«åš <strong>é›¶å’Œåšå¼ˆå®Œå…¨ä¿¡æ¯å…¬å¹³åšå¼ˆ</strong> ï¼ŒåŒæ–¹çš„ç›®çš„å‡æ˜¯ <strong>æœ€å€¼åŒ–å±€é¢åˆ†æ•°</strong>ã€‚</p>
<h1 id="2-Alpha-Beta-å‰ªæ"><a href="#2-Alpha-Beta-å‰ªæ" class="headerlink" title="2 Alpha-Beta å‰ªæ"></a>2 Alpha-Beta å‰ªæ</h1><p>ç„¶åè¿™ä¸œè¥¿å°±æ˜¯ä¸€ä¸ªå‰ªæï¼Œç»™æ¯ä¸ªèŠ‚ç‚¹ä¸€ä¸ª $\alpha$ ä¸‹ç•Œå’Œ $\beta$ ä¸Šç•Œã€‚ç±»æ¯”çŠ¶æ€è½¬ç§»ï¼Œè€ƒè™‘ç›¸é‚»çš„çŠ¶æ€ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>å‡è®¾å½“å‰èŠ‚ç‚¹ä¸º $\boldsymbol{Max}$ èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¦‚æœå­˜åœ¨ä¸€ç§å†³ç­–ä½¿å¾—è¯¥ $\boldsymbol{Max}$ çŠ¶æ€çš„åˆ†æ•° $&gt;$ <strong>ä¸Šä¸€å±‚</strong>å†³ç­–çš„åˆ†æ•°<strong>ä¸Šé™</strong> $\betaâ€™$ï¼Œé‚£ä¹ˆå½“å‰èŠ‚ç‚¹çš„çˆ¶äº²èŠ‚ç‚¹ï¼Œ$\boldsymbol{Min}$ çŠ¶æ€ï¼Œå°±ä¸€å®šä¸ä¼šåšå‡ºæŸäº›å†³ç­–ï¼Œä½¿å¾—å±€é¢å˜æˆå½“å‰çš„ $\boldsymbol Max$ å†³ç­–ã€‚</p>
</li>
<li><p>å‡è®¾å½“å‰èŠ‚ç‚¹ä¸º $\boldsymbol{Min}$ èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¦‚æœå­˜åœ¨ä¸€ç§å†³ç­–ä½¿å¾—è¯¥ $\boldsymbol{Min}$ çŠ¶æ€çš„åˆ†æ•° $&lt;$ <strong>ä¸Šä¸€å±‚</strong>å†³ç­–çš„åˆ†æ•°<strong>ä¸‹é™</strong> $\alphaâ€™$ï¼Œé‚£ä¹ˆå½“å‰èŠ‚ç‚¹çš„çˆ¶äº²èŠ‚ç‚¹ï¼Œ$\boldsymbol{Max}$ çŠ¶æ€ï¼Œå°±ä¸€å®šä¸ä¼šåšå‡ºæŸäº›å†³ç­–ï¼Œä½¿å¾—å±€é¢å˜æˆå½“å‰çš„ $\boldsymbol Min$ å†³ç­–ã€‚</p>
</li>
<li><p>äºæ˜¯æˆ‘ä»¬è®°å½• $\alpha$ å€¼ä¸ºæ¯ä¸ª $\boldsymbol{Max}$ çŠ¶æ€çš„<strong>å¾—åˆ†ä¸‹ç•Œ</strong>ï¼Œ$\beta$ å€¼ä¸ºæ¯ä¸ª $\boldsymbol{Min}$ çŠ¶æ€çš„å¾—åˆ†ä¸‹ç•Œã€‚åˆå§‹ä¸º $\alpha=-\infty,\beta=+\infty$</p>
</li>
<li><p>è€ƒè™‘ä¼˜åŒ–çš„æ„ä¹‰ã€‚å½“å‰çŠ¶æ€çš„åˆ†æ”¯å¯èƒ½æœ‰å¾ˆå¤šï¼Œä½†æ˜¯å¦‚æœåœ¨æœç¬¬ä¸€ä¸ªåˆ†æ”¯çš„æ—¶å€™å°±å‘ç°å·²ç»æœ‰ $\alpha_n&gt;\beta_{fa_n}$ äº†ï¼Œé‚£ä¹ˆ $fa_n$ å°±ä¸€å®šä¸ä¼šèµ°è¿™ä¸ªå†³ç­–ï¼ˆæ¯•ç«Ÿæœ€æ¬¡ä¹Ÿå¯ä»¥è®©å¯¹æ–¹å¾—ç›Šï¼‰ï¼Œäºæ˜¯å‰©ä¸‹çš„åˆ†æ”¯å°±ä¸ç”¨å†æœäº†ã€‚</p>
</li>
<li><p>æ˜¾ç„¶ï¼Œè¿™ç§å†³ç­–æ˜¯å¯å‘æ€§çš„ã€‚åŒæ—¶æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li><p>å†³ç­–é¡ºåºå½±å“æ—¶é—´æ•ˆç‡ã€‚å¦‚æœæ¯æ¬¡æœéƒ½åœ¨ç¬¬ä¸€æ¬¡è·³å‡ºè‡ªç„¶å¯ä»¥è®©æ—¶é—´ä¸Šåšåˆ°æœ€ä¼˜ï¼Œä½†æ˜¯å¦‚æœæ¯æ¬¡éƒ½åœ¨æœ€åä¸€æ¬¡è·³å‡ºå°±æ˜¯å‹æ ¹æ²¡å‰ªã€‚</p>
</li>
<li><p>ä¸å¯ä»¥è£¸çš„è®°å¿†åŒ–ã€‚è€ƒè™‘æ¯ä¸ªèŠ‚ç‚¹å¦‚æœè¦è®°å¿†åŒ–ï¼Œè®°ä¸‹æ¥çš„åº”è¯¥æ˜¯å½“å‰çŠ¶æ€èƒ½æ‰©å±•åˆ°çš„æœ€ä¼˜å±€é¢ã€‚ä½†æ˜¯ Alpha-Beta å‰ªæçš„ç›®çš„å°±æ˜¯åœ¨æœªå¾—åˆ°è¿™ä¸ªç‚¹çš„æœ€ä¼˜å†³ç­–æ—¶ï¼Œå·²ç»çŸ¥é“è¯¥ä¸è¯¥ç»§ç»­èµ°ã€‚</p>
</li>
</ul>
</li>
</ul>
<p>ç„¶åå°±æ˜¯ä¼ªä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">Function <span class="title">doMax</span><span class="params">(State S, Value alpha, Value beta)</span></span>&#123;</span><br><span class="line">	State Moveable_Set = calc(S) ;   </span><br><span class="line">	<span class="keyword">for</span> : s in Moveable_Set&#123;</span><br><span class="line">		Value now = evaluate(doMin(S)) ;</span><br><span class="line">		<span class="keyword">if</span> [now &gt; alpha] alpha = now ;</span><br><span class="line">		<span class="keyword">if</span> [alpha &gt;= beta] <span class="keyword">return</span> alpha ;  </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> alpha ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Function <span class="title">doMin</span><span class="params">(State S, Value alpha, Value Beta)</span></span>&#123;</span><br><span class="line">	State Moveable_Set = calc(S) ;   </span><br><span class="line">	<span class="keyword">for</span> : s in Moveable_Set&#123;</span><br><span class="line">		Value now = evaluate(doMax(S)) ;</span><br><span class="line">		<span class="keyword">if</span> [now &lt; beta] beta = now ; </span><br><span class="line">		<span class="keyword">if</span> [alpha &gt;= beta] <span class="keyword">return</span> beta ;  </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> beta ;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬é¡¶å¤šæ˜¯èƒ½å¿«é€Ÿè®¡ç®—è°èµ¢è°è¾“è€Œä¸æ˜¯èµ¢å¤šå°‘/è¾“å¤šå°‘ã€‚äºæ˜¯è€ƒè™‘é­”æ”¹ä¸€ä¸‹ï¼š</p>
<p>ç‰ˆæœ¬ä¸€ï¼šæŸä¸€æ–¹è·åˆ©æœ€å¤šã€‚å‚è€ƒé¢˜ç›®ï¼š[ä¹çœè”è€ƒ]ä¸€åŒæœ¨æ£‹ï¼Œå¯ä»¥æ‹¿åˆ° $70pts$</p>
<p>å…¶å®å°±æ˜¯ä¿®æ”¹ä¸€ä¸‹ç»ˆæ€çš„è¿”å›å€¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">battle</span><span class="params">(<span class="keyword">int</span> dep, <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> alp, <span class="keyword">int</span> bet, <span class="keyword">int</span> sa, <span class="keyword">int</span> sb)</span></span>&#123;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; x &lt;&lt; " " &lt;&lt; y &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">if</span> (dep &gt;= N * M) <span class="keyword">return</span> sa - sb ; <span class="keyword">int</span> val, b = dep &amp; <span class="number">1</span>;</span><br><span class="line"><span class="comment">//    memset(R[b], 0, sizeof(R[b])) ;</span></span><br><span class="line">    <span class="keyword">if</span> (!b)&#123;</span><br><span class="line">           <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">               <span class="keyword">for</span> (<span class="keyword">int</span> j = R[i] + <span class="number">1</span> ; j &lt;= M ; ++ j)&#123;</span><br><span class="line"><span class="comment">//                    cout &lt;&lt; "A" &lt;&lt; " " &lt;&lt; dep &lt;&lt; ".." &lt;&lt; i &lt;&lt; " " &lt;&lt; j &lt;&lt; endl ;</span></span><br><span class="line">                   <span class="keyword">if</span> (!base[i][j] &amp;&amp; base[i][j - <span class="number">1</span>] &amp;&amp; base[i - <span class="number">1</span>][j])&#123;</span><br><span class="line">                       base[i][j] = <span class="number">1</span> ; R[i] = j ;</span><br><span class="line">                       val = battle(dep + <span class="number">1</span>, i, j, alp, bet, sa + A[i][j], sb) ;</span><br><span class="line">                       base[i][j] = <span class="number">0</span> ; alp = max(val, alp) ;</span><br><span class="line">                       R[i] = <span class="number">0</span> ; <span class="keyword">if</span> (alp &gt;= bet) <span class="keyword">return</span> alp ;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           <span class="keyword">return</span> alp ;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span> &#123;</span><br><span class="line">           <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">               <span class="keyword">for</span> (<span class="keyword">int</span> j = R[i] + <span class="number">1</span> ; j &lt;= M ; ++ j)&#123;</span><br><span class="line"><span class="comment">//                    cout &lt;&lt; "B" &lt;&lt; " " &lt;&lt; dep &lt;&lt; ".." &lt;&lt; i &lt;&lt; " " &lt;&lt; j &lt;&lt; endl ;</span></span><br><span class="line">                   <span class="keyword">if</span> (!base[i][j] &amp;&amp; base[i][j - <span class="number">1</span>] &amp;&amp; base[i - <span class="number">1</span>][j])&#123;</span><br><span class="line">                       base[i][j] = <span class="number">1</span> ; R[i] = j ;</span><br><span class="line">                       val = battle(dep + <span class="number">1</span>, i, j, alp, bet, sa, sb + B[i][j]) ;</span><br><span class="line">                       base[i][j] = <span class="number">0</span>, bet = min(val, bet) ;</span><br><span class="line">                       R[i] = <span class="number">0</span> ; <span class="keyword">if</span> (alp &gt;= bet) <span class="keyword">return</span> bet ;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           <span class="keyword">return</span> bet ;</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç‰ˆæœ¬äºŒï¼šè´¥æ–¹å­˜æ´»æ—¶é—´æœ€é•¿ã€‚å‚è€ƒé¢˜ç›®ï¼š[CQOI2013]æ£‹ç›˜æ¸¸æˆï¼Œå¯ä»¥æ‹¿åˆ° $40pts$</p>
<p>è¿™ç§çš„è¯å°±ç›´æ¥è¿”å› $-1^{\text{èƒœæ–¹}}\times \text{æ·±åº¦}$ å³å¯ï¼Œæœ€å¤§åŒ–çš„å°±æ˜¯è´¥æ–¹å­˜æ´»çš„æœ€å¤§æ·±åº¦ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> xa, <span class="keyword">int</span> ya, <span class="keyword">int</span> xb, <span class="keyword">int</span> yb, <span class="keyword">bool</span> w, <span class="keyword">int</span> step, <span class="keyword">int</span> alp, <span class="keyword">int</span> bet)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (step &gt; <span class="number">3</span> * N) <span class="keyword">return</span> _d_a_y ;</span><br><span class="line">    <span class="keyword">if</span> (xa == xb &amp;&amp; ya == yb) <span class="keyword">return</span> w ? -step : step ; <span class="keyword">int</span> val ;</span><br><span class="line">    <span class="keyword">if</span> (!w)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">4</span> ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">int</span> kx = xa + dx[i], ky = ya + dy[i] ;</span><br><span class="line">            <span class="keyword">if</span> (kx &lt;= N &amp;&amp; ky &lt;= N &amp;&amp; kx &gt;= <span class="number">1</span> &amp;&amp; ky &gt;= <span class="number">1</span>)&#123;</span><br><span class="line">                val = dfs(kx, ky, xb, yb, w ^ <span class="number">1</span>, step + <span class="number">1</span>, alp, bet) ;</span><br><span class="line">                alp = max(alp, val) ; <span class="keyword">if</span> (alp &gt;= bet) <span class="keyword">return</span> alp ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> alp ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">7</span> ; i &gt;= <span class="number">0</span> ; -- i)&#123;</span><br><span class="line">        <span class="keyword">int</span> kx = xb + dx[i], ky = yb + dy[i] ;</span><br><span class="line">        <span class="keyword">if</span> (kx &lt;= N &amp;&amp; ky &lt;= N &amp;&amp; kx &gt;= <span class="number">1</span> &amp;&amp; ky &gt;= <span class="number">1</span>)&#123;</span><br><span class="line">            val = dfs(xa, ya, kx, ky, w ^ <span class="number">1</span>, step + <span class="number">1</span>, alp, bet) ;</span><br><span class="line">            bet = min(val, bet) ; <span class="keyword">if</span> (bet &lt;= alp) <span class="keyword">return</span> bet ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> bet ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-ä¸¤é“ä¾‹é¢˜"><a href="#3-ä¸¤é“ä¾‹é¢˜" class="headerlink" title="3 ä¸¤é“ä¾‹é¢˜"></a>3 ä¸¤é“ä¾‹é¢˜</h1><p>uvaå¥½å•Šã€‚</p>
<h2 id="1-UVA10111-Find-the-Winning-Move"><a href="#1-UVA10111-Find-the-Winning-Move" class="headerlink" title="$(1$ UVA10111 Find the Winning Move"></a>$(1$ UVA10111 Find the Winning Move</h2><blockquote>
<p>ä¸¤äººä¸‹ $4\times 4$ çš„äº•å­—æ£‹ï¼Œç»™å‡ºä¸€ä¸ªæ®‹å±€ï¼Œé—®æ˜¯å¦æœ‰å…ˆæ‰‹å¿…èƒœç­–ç•¥ã€‚</p>
<p>äº•å­—æ£‹ï¼šå¿…é¡»è¦å››å­è¿ç æ‰èƒ½èµ¢ã€‚</p>
</blockquote>
<p>è¿™ä¸œè¥¿åªé—®èµ¢æ²¡èµ¢ï¼Œäºæ˜¯å°±å¯ä»¥æ„‰å¿«åœ°æŠŠå±€é¢åˆ†æ•°èµ‹ä¸º $1/-1$ã€‚æœå°±å®Œäº‹äº†233</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">4</span> ; ++ i)&#123;</span><br><span class="line">        res = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">4</span> ; ++ j)</span><br><span class="line">            res += (<span class="keyword">bool</span>)(base[i][j] == x) ;</span><br><span class="line">        <span class="keyword">if</span> (res &gt;= <span class="number">4</span>) <span class="keyword">return</span> <span class="number">1</span> ; res = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">4</span> ; ++ j)</span><br><span class="line">            res += (<span class="keyword">bool</span>)(base[j][i] == x) ;</span><br><span class="line">        <span class="keyword">if</span> (res &gt;= <span class="number">4</span>) <span class="keyword">return</span> <span class="number">1</span> ; res = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">4</span> ; ++ i)</span><br><span class="line">        res += (<span class="keyword">bool</span>)(base[i][i] == x) ;</span><br><span class="line">    <span class="keyword">if</span> (res &gt;= <span class="number">4</span>) <span class="keyword">return</span> <span class="number">1</span> ; res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">4</span> ; ++ i)</span><br><span class="line">        res += (<span class="keyword">bool</span>)(base[i][<span class="number">5</span> - i] == x) ;</span><br><span class="line">    <span class="keyword">if</span> (res &gt;= <span class="number">4</span>) <span class="keyword">return</span> <span class="number">1</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">battle</span><span class="params">(<span class="keyword">int</span> step, <span class="keyword">int</span> alp, <span class="keyword">int</span> bet)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> st = (ans - step) &amp; <span class="number">1</span>, val ;</span><br><span class="line">    <span class="keyword">if</span> (!st)&#123;</span><br><span class="line">        <span class="keyword">if</span> (check(<span class="number">2</span>) || !step) <span class="keyword">return</span> -check(<span class="number">2</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">4</span> ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">4</span> ; ++ j)</span><br><span class="line">                <span class="keyword">if</span> (!base[i][j])&#123;</span><br><span class="line">                    base[i][j] = <span class="number">1</span> ;</span><br><span class="line">                    val = battle(step - <span class="number">1</span>, alp, bet) ;</span><br><span class="line">                    base[i][j] = <span class="number">0</span> ;</span><br><span class="line">                    <span class="keyword">if</span> (val &gt; alp)&#123;</span><br><span class="line">                        alp = val ;</span><br><span class="line">                        <span class="keyword">if</span> (step == ans)</span><br><span class="line">                            resx = i - <span class="number">1</span>, resy = j - <span class="number">1</span> ;</span><br><span class="line">                        <span class="keyword">if</span> (alp &gt;= bet) <span class="keyword">return</span> alp ;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        <span class="keyword">return</span> alp ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (check(<span class="number">1</span>) || !step) <span class="keyword">return</span> check(<span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">4</span> ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">4</span> ; ++ j)</span><br><span class="line">                <span class="keyword">if</span> (!base[i][j])&#123;</span><br><span class="line">                    base[i][j] = <span class="number">2</span> ;</span><br><span class="line">                    val = battle(step - <span class="number">1</span>, alp, bet) ;</span><br><span class="line">                    base[i][j] = <span class="number">0</span>, bet = min(val, bet) ;</span><br><span class="line">                    <span class="keyword">if</span> (alp &gt;= bet) <span class="keyword">return</span> bet ;</span><br><span class="line">                &#125;</span><br><span class="line">        <span class="keyword">return</span> bet ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; (s + <span class="number">1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (s[<span class="number">1</span>] == <span class="string">'$'</span>) <span class="keyword">return</span> <span class="number">0</span> ; ans = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">4</span> ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%s"</span>, bc[i] + <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">4</span> ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">4</span> ; ++ j)&#123;</span><br><span class="line">                base[i][j] = bc[i][j] == <span class="string">'x'</span> ? <span class="number">1</span></span><br><span class="line">                          : (bc[i][j] == <span class="string">'.'</span> ? <span class="number">0</span> : <span class="number">2</span>) ;</span><br><span class="line">                ans += (!base[i][j]) ;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">if</span> (ans &gt;= <span class="number">12</span>) &#123; <span class="built_in">puts</span>(<span class="string">"#####"</span>) ; <span class="keyword">continue</span> ;&#125;</span><br><span class="line">        ans = battle(ans, <span class="number">-1</span>, <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (ans &gt; <span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">"(%d,%d)\n"</span>, resx, resy) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"#####"</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-UVA751-Triangle-War"><a href="#2-UVA751-Triangle-War" class="headerlink" title="$(2$ UVA751 Triangle War"></a>$(2$ UVA751 Triangle War</h2><blockquote>
<p>ç»™å‡º $10$ ä¸ªç‚¹ï¼Œå…±æœ‰ $18$ æ¡è¾¹ï¼Œæ¯æ¬¡ $A,B$ ä¸¤ä¸ªäººè½®æµåŠ å…¥ä¸€æ¡è¾¹ã€‚Aå…ˆåŠ ã€‚</p>
<p>å¦‚æœå½¢æˆä¸€ä¸ªä¸‰è§’å½¢ï¼Œåˆ™ä¸‰è§’å½¢å½’ä»–æ‰€æœ‰ï¼Œ<strong>è€Œä¸”è¿˜å¿…é¡»å†èµ°ä¸€æ­¥</strong>ã€‚æœ€åä¸‰è§’å½¢å¤šçš„äººèƒœã€‚</p>
<p>ç°åœ¨å·²ç»ç»™å‡ºä¸€éƒ¨åˆ†å·²ç»å®Œæˆçš„æ­¥æ•°ï¼Œç”±äºä¸¤ä½ç©å®¶éƒ½æ˜¯<strong>æœ€èªæ˜çš„</strong>ï¼Œä»–ä»¬éƒ½ä¼šèµ°<strong>ä¸ºè‡ªå·±å¸¦æ¥æœ€å¤§ä¼˜åŠ¿</strong>çš„æ­¥æ•°ã€‚ä½ éœ€è¦åˆ¤æ–­è°ä¼šèµ¢å¾—æ¸¸æˆã€‚</p>
</blockquote>
<p>ä¸€é“æ†¨æ†¨é¢˜ã€‚å‘ç°å¯ä»¥ç›´æ¥çŠ¶å‹ä¸”æ¯ä¸ªè¯¢é—®å›¾ä¸å˜ï¼Œæ‰€ä»¥æœæ–­<del>æ‰“å¼€é¢˜è§£æ‰¾åˆ°æ€è·¯å·®ä¸å¤šçš„æŠŠæ‰“çš„è¡¨copyè¿‡æ¥</del>æ‰‹æ¨ã€‚ç„¶åå…¶å®å°±æ˜¯ä¸€å¼€å§‹å…ˆæŠŠåˆå§‹çŠ¶æ€èµ°å®Œï¼Œç„¶åå› ä¸ºä¸€å…±ä¹ä¸ªä¸‰è§’å½¢ï¼Œæ‰€ä»¥å¦‚æœä¸€æ–¹æ¯”å¦ä¸€æ–¹å¤š $5$ ä¸ªæ¸¸æˆå°±ç»“æŸäº†ï¼Œäºæ˜¯å‘ç°å¯ä»¥æŠŠè¿™ä¸ªå·®å€¼å½“åšå±€é¢åˆ†æ•°ï¼Œæœå°±å®Œäº‹äº†ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªçƒ‚å¤§è¡—çš„ $trick$ï¼ŒæŒ‰ç§©è½¬ç§»æ¯æ¡è¾¹äºæ˜¯æƒ³åˆ° $\rm lowbit$ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">int</span> Q, T, M, A[N][N], st[<span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> e[<span class="number">11</span>][<span class="number">11</span>]=&#123;</span><br><span class="line">    &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">17</span>&#125;,&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">    &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">16</span>&#125;, &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">17</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">16</span>,<span class="number">0</span>&#125;,</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> t[<span class="number">9</span>] = &#123;<span class="number">7</span>, <span class="number">56</span>, <span class="number">98</span>, <span class="number">448</span>, <span class="number">3584</span>, <span class="number">6160</span>, <span class="number">28672</span>, <span class="number">49280</span>, <span class="number">229376</span>&#125; ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;p, <span class="keyword">const</span> <span class="keyword">int</span> &amp;q)</span></span>&#123;</span><br><span class="line">    rg <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= <span class="number">8</span> ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (((p &amp; t[i]) != t[i]) &amp;&amp; ((q &amp; t[i]) == t[i])) ++ ret ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">battle</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> s, <span class="keyword">int</span> alp, <span class="keyword">int</span> bet)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (st[<span class="number">0</span>] &gt;= <span class="number">5</span>) <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (st[<span class="number">1</span>] &gt;= <span class="number">5</span>) <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">int</span> O = (<span class="number">1</span> &lt;&lt; <span class="number">18</span>) - <span class="number">1</span>, ss ;</span><br><span class="line">    <span class="keyword">int</span> _rest = s ^ O, now, val ;</span><br><span class="line">    <span class="keyword">for</span> ( ; _rest ; _rest -= low(_rest))&#123;</span><br><span class="line">        now = calc(s, ss = s | low(_rest)) ;</span><br><span class="line">        <span class="keyword">if</span> (n)</span><br><span class="line">            st[n] += now,</span><br><span class="line">            val = battle(n ^ (((<span class="keyword">bool</span>)now) ^ <span class="number">1</span>), ss, alp, bet),</span><br><span class="line">            bet = min(bet, val), st[n] -= now ;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            st[n] += now,</span><br><span class="line">            val = battle(n ^ (((<span class="keyword">bool</span>)now) ^ <span class="number">1</span>), ss, alp, bet),</span><br><span class="line">            alp = max(alp, val), st[n] -= now ;</span><br><span class="line">        <span class="keyword">if</span> (alp &gt;= bet) <span class="keyword">break</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n ? bet : alp ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T, Q = T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;M) ;</span><br><span class="line">        st[<span class="number">0</span>] = st[<span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">int</span> _state = <span class="number">0</span>, n = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x, y, z, i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y), </span><br><span class="line">            z = calc(_state, _state | (<span class="number">1</span> &lt;&lt; e[x][y])) ;</span><br><span class="line">            _state |= (<span class="number">1</span> &lt;&lt; e[x][y]), st[n] += z, n ^= (((<span class="keyword">bool</span>)z) ^ <span class="number">1</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; _state &lt;&lt; " " &lt;&lt; n &lt;&lt; endl ;</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Game %d: "</span>, Q - T) ;</span><br><span class="line">        <span class="keyword">if</span> (battle(n, _state, <span class="number">-23333</span>, <span class="number">23333</span>) &gt;= <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"A wins.\n"</span>) ; <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"B wins.\n"</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å­¦è¿™ä¸ªå°±å›¾ä¸€ä¹ã€‚æƒ³å¾—é«˜åˆ†è¯·è®°æœ/kelã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>åšå¼ˆè®º</category>
      </categories>
      <tags>
        <tag>æœç´¢/å‰ªæ</tag>
        <tag>åšå¼ˆè®º/å¯¹æŠ—æœç´¢</tag>
        <tag>åšå¼ˆè®º/Alpha-Betaå‰ªæ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ³›åšã€‘æ„é€ é¢˜é€‰åš Â· 2</title>
    <url>/2019/12/24/%E6%9E%84%E9%80%A02/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ²¡å•¥ç‰¹åˆ«åŸå› ï¼Œå°±æ˜¯åº•ä¸‹é‚£ç¯‡æ–‡ç« é¢˜å¤ªå¤šäº†å°±åˆ†æµå‡ºä¸€éƒ¨åˆ†ã€‚</p>
<a id="more"></a>
<h3 id="1-UVa1697"><a href="#1-UVa1697" class="headerlink" title="$1$ UVa1697"></a>$1$ UVa1697</h3><blockquote>
<p>ç»™å®šä¸€æ’é•¿åº¦ä¸º $4n$ çš„æ ¼å­ï¼Œç¼–å·ä» $-2n+1$ åˆ° $2n$ æ¯ä¸ªç¼–å·ä¸ºæ­£çš„æ ¼å­ä¸­æœ‰ä¸€ä¸ªç‰©å“ï¼Œå…¶ä¸­æ¯ä¸ªç¼–å·ä¸ºå¥‡æ•°çš„æ ¼å­ä¸­æœ‰ä¸€ä¸ª $B$ ç±»ç‰©å“ï¼Œç¼–å·ä¸ºå¶æ•°çš„æ ¼å­ä¸­æœ‰ä¸€ä¸ª $A$ ç±»ç‰©å“ã€‚</p>
<p>ä½ åªèƒ½è¿›è¡Œä¸€ç§æ“ä½œï¼šé€‰æ‹©æŸä¸¤ä¸ªç›¸é‚»çš„éƒ½æœ‰ç‰©å“çš„æ ¼å­ï¼Œç§»åŠ¨åˆ°å¦å¤–ä¸¤ä¸ªç›¸é‚»çš„ç©ºæ ¼å­ä¸­ï¼ŒåŒæ—¶ä¸èƒ½æ”¹å˜ä¸¤ä¸ªæ ¼å­çš„ç›¸å¯¹ä½ç½®ã€‚</p>
<p>è¦æ±‚è¿›è¡Œæœ€å°‘çš„æ“ä½œä½¿å¾—æ‰€æœ‰ç‰©å“ä»¥ <code>AAAâ€¦ABBBâ€¦B</code> ($n$ ä¸ª $A$ å’Œ $n$ ä¸ª $B$) çš„å½¢å¼æ’åˆ—åœ¨ä¸€èµ· è¾“å‡ºä¸€ç§å¯è¡Œæ–¹æ¡ˆ </p>
<p>$3\leq n \leq 100$</p>
</blockquote>
<p>äººç±»æ™ºæ…§å­¦ä¸æ¥äº†orz</p>
<p>è€ƒè™‘ $n=3,4,5,6,7$ çš„æ—¶å€™éƒ½å¯ä»¥äººç±»æ™ºæ…§ã€‚é‚£ä¹ˆå¯¹äº $n &gt; 7$ æ—¶è€ƒè™‘å¢é‡æ„é€ ï¼Œå³ä» $n$ æ„é€ åˆ° $n+4$ã€‚</p>
<p>é‚£ä¹ˆ $n=4$ æ—¶å¯ä»¥è¿™ä¹ˆæ„é€ ï¼š</p>
<blockquote>
<p><code>__babababa</code></p>
<p><code>abbabab__a</code></p>
<p><code>abba__bbaa</code></p>
<p><code>a__abbbbaa</code></p>
<p><code>aaaabbbb__</code></p>
</blockquote>
<p>ç„¶åè€ƒè™‘å¯¹äº $n+4$ï¼Œè®° $|BA|$  è¡¨ç¤ºæœ‰ä¸€å † <code>bababa</code> è¿™ç§ä¸œè¥¿ã€‚</p>
<p>é‚£ä¹ˆè€ƒè™‘ $n+4$ å¯ä»¥è¿™ä¹ˆç©ï¼š</p>
<blockquote>
<p><code>__|BA|</code></p>
<p><code>ab|BA|b__a</code></p>
<p><code>abba__|BA|bbaa</code></p>
</blockquote>
<p>å‘ç°ä¸­é—´é‚£ä¸€æ®µå’Œèµ·å§‹çŠ¶æ€æ˜¯ä¸€æ ·çš„ï¼Œå°±å¯ä»¥å¤§åŠ›é€’å½’ï¼Œå›ä»£çš„æ—¶å€™å›ä»£ä¸€ä¸‹å³å¯ã€‚</p>
<p>$n=3\sim 7$ æˆ‘é€‰æ‹©ç›´æ¥ä»ç½‘ä¸ŠæŠ„æ¥åˆ«äººçš„äººç±»æ™ºæ…§ï¼Œæ¯•ç«Ÿæˆ‘è«å¾—æ™ºæ…§.jpg</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">oo</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">" to "</span> &lt;&lt; y &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = R - L + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">3</span> &lt;&lt; <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> oo(<span class="number">2</span>, <span class="number">-1</span>), oo(<span class="number">5</span>, <span class="number">2</span>), oo(<span class="number">3</span>, <span class="number">-3</span>), <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">4</span> &lt;&lt; <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> oo(L + <span class="number">5</span>, L - <span class="number">2</span>), oo(L + <span class="number">2</span>, L + <span class="number">5</span>), oo(L - <span class="number">1</span>, L + <span class="number">2</span>), oo(L + <span class="number">6</span>, L - <span class="number">1</span>), <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">5</span> &lt;&lt; <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> oo(L + <span class="number">7</span>, L - <span class="number">2</span>), oo(L + <span class="number">2</span>, L + <span class="number">7</span>),</span><br><span class="line">               oo(L + <span class="number">5</span>, L + <span class="number">2</span>), oo(L - <span class="number">1</span>, L + <span class="number">5</span>), oo(L + <span class="number">8</span>, L - <span class="number">1</span>), <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">6</span> &lt;&lt; <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> oo(L + <span class="number">9</span>, L - <span class="number">2</span>), oo(L + <span class="number">6</span>, L + <span class="number">9</span>), oo(L + <span class="number">1</span>, L + <span class="number">6</span>),</span><br><span class="line">               oo(L + <span class="number">5</span>, L + <span class="number">1</span>), oo(L - <span class="number">1</span>, L + <span class="number">5</span>), oo(L + <span class="number">10</span>, L - <span class="number">1</span>), <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">7</span> &lt;&lt; <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> oo(L + <span class="number">7</span>, L - <span class="number">2</span>), oo(L + <span class="number">4</span>, L + <span class="number">7</span>), oo(L + <span class="number">11</span>, L + <span class="number">4</span>),</span><br><span class="line">               oo(L + <span class="number">2</span>, L + <span class="number">11</span>), oo(L + <span class="number">8</span>, L + <span class="number">2</span>), oo(L - <span class="number">1</span>, L + <span class="number">8</span>), oo(L + <span class="number">12</span>, L - <span class="number">1</span>), <span class="keyword">void</span>() ;</span><br><span class="line">    oo(R - <span class="number">2</span>, L - <span class="number">2</span>), oo(L + <span class="number">2</span>, R - <span class="number">2</span>), work(L + <span class="number">4</span>, R - <span class="number">4</span>), oo(L - <span class="number">1</span>, R - <span class="number">5</span>), oo(R - <span class="number">1</span>, L - <span class="number">1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; N) work(<span class="number">1</span>, N * <span class="number">2</span>), <span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-BZOJ4148-Pillars"><a href="#2-BZOJ4148-Pillars" class="headerlink" title="$2$ BZOJ4148 Pillars"></a>$2$ BZOJ4148 Pillars</h3><blockquote>
<p>ç»™å®šä¸€ä¸ª $n\times m$ çš„çŸ©å½¢ï¼Œå…¶ä¸­æœ‰ $f$ ä¸ª $2\times 2$ çš„éšœç¢ç‰©ï¼Œå…¶ä¸­ä»»æ„ä¸¤ä¸ªéšœç¢ç‰©ä¸­å¿ƒä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»è‡³å°‘ä¸º $6$ï¼Œä¸”æ¯ä¸ªéšœç¢ç‰©çš„ä¸­å¿ƒåˆ°è¾¹ç¼˜çš„è·ç¦»è‡³å°‘ä¸º $3$ã€‚</p>
<p>è¯·æ‰¾åˆ°ä¸€æ¡ä»å·¦ä¸‹è§’ $(1,1)$ å‡ºå‘ç»è¿‡æ‰€æœ‰æ²¡æœ‰éšœç¢ç‰©çš„ç‚¹å„ä¸€æ¬¡çš„ä¸”æœ€åå›åˆ°å·¦ä¸‹è§’çš„å›è·¯ã€‚</p>
<p>ä¿è¯ $n,m$ å‡ä¸ºå¶æ•°ï¼Œä¸” $1\leq n,m\leq 1000$ .</p>
</blockquote>
<p>å°±æ˜¯è€ƒè™‘å¦‚æœæ²¡æœ‰éšœç¢çš„èµ°æ³•ï¼Œç”±äº $n,m$ éƒ½æ˜¯å¶æ•°ï¼Œæ‰€ä»¥å¯ä»¥ä» $(1,1)$ ä¸Šåˆ° $(1,n)$ï¼Œç„¶åä» $(1,n)$ åˆ° $(n,n)$ å†åˆ° $(n,n-1)$ å†åˆ° $(2,n-1)$ è¿™ä¹ˆè›‡å½¢èµ°ã€‚</p>
<p>è€ƒè™‘æœ‰äº†éšœç¢ï¼Œå› ä¸ºæ¯ä¸ªéšœç¢å¯ä»¥çœ‹åšæ˜¯ç‹¬ç«‹çš„çš„ï¼Œæ‰€ä»¥å¤§æ¦‚å¯ä»¥è¿™ä¹ˆèµ°ï¼š</p>
<p><img src="qwq.png" alt></p>
<p>å…¶ä¸­ç´«è‰²æ˜¯éšœç¢ï¼Œé»„è‰²æ˜¯åŸæ¥çš„è·¯çº¿ï¼Œçº¢è‰²æ˜¯æ–°çš„ã€‚ç”±äº $6$ çš„é™åˆ¶ï¼Œæ‰€ä»¥å¯ä»¥è¿™ä¹ˆç»•ã€‚</p>
<p>æ‰€ä»¥æ˜¯é“ç»†èŠ‚é¢˜233</p>
<p>ä»£ç å…ˆé¸½ç€ï¼Œä»€ä¹ˆæ—¶å€™æœ‰å¿ƒæƒ…å†å†™ã€‚s</p>
<h3 id="3-ã€UR-6ã€‘-æ™ºå•†é”"><a href="#3-ã€UR-6ã€‘-æ™ºå•†é”" class="headerlink" title="$3$ ã€UR #6ã€‘ æ™ºå•†é”"></a>$3$ ã€UR #6ã€‘ æ™ºå•†é”</h3><blockquote>
<p>æ„é€ ä¸€ä¸ªèŠ‚ç‚¹æ•°ä¸è¶…è¿‡ $100$ çš„æ— å‘å›¾ï¼Œä½¿å…¶ç”Ÿæˆæ ‘ä¸ªæ•°å¯¹ $998244353$ å–æ¨¡çš„ç»“æœä¸º $k$ ã€‚</p>
<p>$k\leq 10^9$</p>
</blockquote>
<p>çœ‹é¢˜ï¼Œä»”ç»†ä¸€æƒ³ï¼Œè«éæ˜¯ä»€ä¹ˆç¥ç§˜çš„ $\boldsymbol{EGF}$ å¤§åŠ›ä¹±æï¼ˆè­¦è§‰ï¼‰ã€‚</p>
<p>ç»“æœäººå‚»äº†â€¦â€¦ä»¥ä¸‹æ˜¯å®˜æ–¹åšæ³•ï¼š</p>
<p>è€ƒè™‘å¦‚æœä¸¤ä¸ªå›¾åªæœ‰ä¸€ä¸ªå…¬å…±ç‚¹ï¼Œé‚£ä¹ˆç”Ÿæˆæ ‘ä¸ªæ•°ä¸ºä¸¤ä¸ªå›¾ç›¸ä¹˜ã€‚é‚£ä¹ˆéšæœº $1000$ ä¸ªéšæœºæ— å‘å›¾ï¼Œä¸¤ä¸¤æ‹¼å‡‘å‡º $10^6$ ä¸ªæ— å‘å›¾ï¼Œç„¶åå¯¹æ¯ä¸€ä¸ªåœ¨ <code>map</code> é‡Œæ‰¾ $k$ çš„é€†å…ƒå³å¯ã€‚<del>å¦‚æœæ²¡æœ‰å°±å†éšæœºä¸€éã€‚</del></p>
<p>å‘ç°è¿™æ ·å®é™…ä¸Šå‡ ä¹ä¸å¯èƒ½æ²¡æœ‰è§£ã€‚ã€‚ã€‚</p>
<p><img src="http://img.uoj.ac/utility/bear-thinking.gif" alt="æ€è€ƒç†Š"></p>
<p>é™æ™ºæ‰“å‡».jpg</p>
<h3 id="4-ã€UNR-1ã€‘Jakarta-Skyscrapers"><a href="#4-ã€UNR-1ã€‘Jakarta-Skyscrapers" class="headerlink" title="$4$  ã€UNR #1ã€‘Jakarta Skyscrapers"></a>$4$  ã€UNR #1ã€‘Jakarta Skyscrapers</h3><blockquote>
<p>æœ‰ä¸€ä¸ªæ•°é›†ï¼Œæœ€åˆå…¶ä¸­åªæœ‰ $a$ å’Œ $b$ã€‚</p>
<p>ä½ å¯ä»¥è¿›è¡Œæœ€å¤š $400$ æ¬¡æ“ä½œï¼Œæ¯æ¬¡é€‰æ‹©é›†åˆä¸­æ»¡è¶³ $i&gt;j$ çš„ $i$ å’Œ $j$ï¼ŒæŠŠ $i-j$ åŠ å…¥é›†åˆä¸­ï¼Œä½¿å¾—æœ€å $c$ åœ¨è¿™ä¸ªé›†åˆä¸­ã€‚</p>
<p>$a,b,c\leq 10^{18}$</p>
</blockquote>
<p>è€ƒè™‘æ„é€ ä¸­é—´çŠ¶æ€ã€‚å‘ç°å¯ä»¥ç”¨ $a-(a-b-c)$ æ„é€  $b+c$ï¼Œ å¯ä»¥ç”¨ $a-(a-b-b)$ æ„é€ å€å¢ï¼Œäºæ˜¯è€ƒè™‘å…ˆè¾—è½¬ç›¸é™¤å¾—åˆ° $1$ï¼Œç„¶åå€å¢ï¼Œç„¶åå°±æ²¡äº†ã€‚æ³¨æ„ï¼Œå¦‚æœä¸€å¼€å§‹ $(a,b) \not|~c$ çš„è¯æ˜¯æ— è§£çš„ã€‚é‚£ä¹ˆè€ƒè™‘åŒé™¤<br>$(a,b)$ å°±å¯ä»¥å¿«ä¹åœ°æ›´ç›¸å‡æŸå¾—åˆ° $1$ äº†ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>æ„é€ </category>
      </categories>
      <tags>
        <tag>æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ </tag>
        <tag>æ€ç»´é¢˜/æ„é€ </tag>
        <tag>å¥‡æ€ªçš„æŠ€å·§</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ³›åšã€‘æ„é€ é¢˜é€‰åš Â· 1</title>
    <url>/2019/12/24/%E6%9E%84%E9%80%A01/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä»ç½‘è¯¾å’Œ <code>uoj</code> ç¾¤é‡Œçš„è¯¾ä»¶æ‰’å‡ºæ¥çš„æ„é€ é¢˜ï¼Œéƒ½æŒº(ä¸)å¥½(ä¼š)çš„(åš)ã€‚</p>
<a id="more"></a>
<h3 id="1-ç¥ç§˜çš„é¢˜ç›®"><a href="#1-ç¥ç§˜çš„é¢˜ç›®" class="headerlink" title="1 ç¥ç§˜çš„é¢˜ç›®"></a>1 ç¥ç§˜çš„é¢˜ç›®</h3><p>è®¾ $f_A$ è¡¨ç¤º $A$ çš„æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°<br>ç»™å‡º $x, y$ï¼Œè¦æ±‚æ„é€ å‡ºä¸¤ä¸ªå­—ç¬¦ä¸² $A, B$<br>æ»¡è¶³ï¼š<br>$f_A = x , f_B = y , f_{A+B} = x + y$</p>
<p>$x, y â‰¤ 5000$</p>
<hr>
<p>è€ƒè™‘ $x$ ä¸ª $a$ï¼Œ$y$ ä¸ª $a$ ï¼Œç„¶åæ‹¼èµ·æ¥å°±å¥½â€¦â€¦</p>
<h3 id="2-CF743C"><a href="#2-CF743C" class="headerlink" title="2 CF743C"></a>2 CF743C</h3><p>ç»™å‡º nï¼Œæ„é€ å‡º x, y, zï¼Œæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
\frac{2}{n} = \frac{1}{x}+\frac{1}{y}+\frac{1}{z}\\\
x\not= y, x\not= z, y\not= z</script><p>æ— è§£è¾“å‡º âˆ’1<br>$n â‰¤ 10^4$</p>
<hr>
<p>è€ƒè™‘é€šåˆ†ï¼ˆåˆ†æ—¶è£‚é¡¹ï¼‰ï¼Œå³</p>
<script type="math/tex; mode=display">
\frac{1}{n}-\frac{1}{n+1}=\frac{1}{n(n+1)}\\\
\frac{1}{n}=\frac{1}{n+1}+ \frac{1}{n(n+1)}\\\
\frac{2}{n}=\frac{1}{n} + \frac{1}{n+1}+ \frac{1}{n(n+1)}</script><p>ç„¶åå°±åšå®Œäº†ã€‚</p>
<p>æ³¨æ„1è¦ç‰¹åˆ¤ã€‚</p>
<h3 id="3-CF359B"><a href="#3-CF359B" class="headerlink" title="3 CF359B"></a>3 CF359B</h3><p>ç»™å‡º $n, k , 2k â‰¤ n$ï¼Œæ„é€ å‡º $2n$ çš„ä¸€ä¸ªæ’åˆ—ï¼Œæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
âˆ‘^n_{i=1} |a_{2iâˆ’1} âˆ’ a_{2i}| âˆ’ |âˆ‘^n_{i=1}(a_{2iâˆ’1} âˆ’ a_{2i})| = 2k</script><p>$n â‰¤ 50000$</p>
<hr>
<p>å¯„å‡ æƒ³äº†ä¸€ç§æ„é€ ï¼Œå°±æ˜¯$a_{i+1} = a_i+k,~i=2p,~p \in \mathbb{N+}$ï¼Œç„¶åéšä¾¿ä¸¤æ¬¡äº¤æ¢ä¸¤é¡¹å°±å¥½äº†ã€‚ç„¶è€Œå¹¶ä¸å¯¹ï¼Œå› ä¸ºè¿™æ ·æ„é€ å‡ºçš„ç»“æœå¹¶ä¸åˆæ³•ï¼›äºæ˜¯é‚å†³å®šæ”¹æˆ$a_{i+1} = a_i+2k,~i=2p,~p \in \mathbb{N+}$ï¼Œä½†ä¹Ÿä¸å¯¹ï¼Œå•æ¬¡äº¤æ¢çš„æ­¥é•¿å¤ªé•¿äº†ï¼Œæ˜¯$4k$ã€‚äºæ˜¯æˆ‘åˆæƒ³èƒ½å¦æœ‰ä»€ä¹ˆè¯¡å¼‚çš„äº¤æ¢æ–¹æ³•å¯ä»¥è¡¥æ•‘å›æ¥$2k$â€¦â€¦å¤±è´¥äº†qaq</p>
<p>ç„¶è€Œå…¶å®å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªè¦æŠŠæ­¥é•¿æ§åˆ¶ä¸º$1$å°±ä¸€å®šèƒ½å‡‘å‡ºæ¥ã€‚æ‰€ä»¥ä¸€å¼€å§‹å…ˆä»¤$a_i=a_{i+1}+1$è¿™ç§æ„Ÿè§‰ï¼Œç„¶åäº¤æ¢$k$æ¬¡å³å¯ã€‚</p>
<h3 id="color-violet-4-rm-CF-it-512E"><a href="#color-violet-4-rm-CF-it-512E" class="headerlink" title="$\color{violet}{4~ \rm{CF}\it{512E}}$"></a>$\color{violet}{4~ \rm{CF}\it{512E}}$</h3><p>å¯¹äºä¸€ä¸ªæ­£ n è¾¹å½¢ï¼Œå¯ä»¥ç”¨ n âˆ’ 3 æ¡è¾¹åˆ†æˆ n âˆ’ 2 ä¸ªä¸‰è§’å½¢<br>ç»™å‡ºä¸¤ç§åˆ’åˆ†ï¼Œä½ éœ€è¦è¿›è¡Œè‹¥å¹²æ¬¡æ“ä½œæŠŠç¬¬ä¸€ç§åˆ’åˆ†å˜æˆç¬¬äºŒç§åˆ’åˆ†<br>æ¯æ¬¡æ“ä½œé€‰æ‹©ä¸€ä¸ªå››è¾¹å½¢åˆ å»å®ƒçš„å¯¹è§’çº¿ï¼Œè¿å¦å¤–ä¸€æ¡å¯¹è§’çº¿<br>n â‰¤ 1000ï¼Œæ“ä½œæ¬¡æ•°ä¸è¶…è¿‡ 20000</p>
<hr>
<p>å¼€å§‹æ‰çº¿â€¦â€¦</p>
<p>å…¶å®ä¸»è¦æ€æƒ³å°±æ˜¯<del>é…±æ²¹ç“¶</del>çŠ¶æ€æ›¿æ¢ï¼ŒæŠŠèµ·å§‹çŠ¶æ€ $s$ å˜æˆå¯¹è§’çº¿éƒ½ä» $1$ å‡ºå‘çš„çŠ¶æ€ $p$ï¼Œå†ä» $p$ å‡ºå‘å˜æˆç»ˆæ€ $t$ã€‚</p>
<p>å…·ä½“æ“ä½œå¥½åƒæ˜¯</p>
<p>åˆ«æƒ³äº†ï¼Œæ‰çº¿äº†æ€ä¹ˆå¯èƒ½è¿˜ä¼šæœ‰ï¼Ÿ</p>
<h3 id="5-ç¥ç§˜çš„é¢˜ç›®"><a href="#5-ç¥ç§˜çš„é¢˜ç›®" class="headerlink" title="$5$ ç¥ç§˜çš„é¢˜ç›®"></a>$5$ ç¥ç§˜çš„é¢˜ç›®</h3><blockquote>
<p>ç»™å‡ºä¸€æ£µæ ‘ï¼Œå®šä¹‰ä¸€ä¸ªç‚¹çš„é‚»å±…é›†åˆä¸ºåˆ°å®ƒè·ç¦» $\leq 2$ çš„æ‰€æœ‰ç‚¹ã€‚</p>
<p>ç»™å‡ºæ‰€æœ‰ç‚¹çš„é‚»å±…é›†åˆï¼Œè¿˜åŸåŸæ ‘ã€‚</p>
<p>$n\leq 1,000$</p>
</blockquote>
<p>è€ƒè™‘ä¸€ä¸ªç»“è®ºï¼Œå¦‚æœä¸¤ä¸ªç‚¹çš„é‚»å±…é›†åˆäº¤é›†å¤§å°ä¸º $2$ï¼Œ é‚£ä¹ˆäº¤é›†ä¸­çš„ç‚¹ä¸€å®šæœ‰è¿è¾¹ã€‚ï¼ˆ$\rm bitset$ åšåˆ° $\frac{n^3}{w}$ï¼‰</p>
<p>äºæ˜¯å°±å¯ä»¥å…ˆæŠŠ <strong>éå¶å­èŠ‚ç‚¹</strong> ä¸¤ä¸¤ä¹‹é—´çš„è¿è¾¹æ±‚å‡ºæ¥</p>
<p>ç„¶åè€ƒè™‘å¦‚ä½•æ±‚å‡ºå¶å­ã€‚å‘ç°å¶å­æœ‰ä¸ªæ€§è´¨ï¼Œå°±æ˜¯å¶å­åˆ°æŸäº›éå¶èŠ‚ç‚¹çš„è·ç¦»ä¸€å®š $=$ ä¸ä¹‹ç›¸é‚»çš„éå¶èŠ‚ç‚¹åˆ°æŸäº›éå¶èŠ‚ç‚¹çš„è·ç¦» $+1$ã€‚æ‰€ä»¥å°±å¯ä»¥å†æŠŠç¦»æ¯ä¸ªéå¶èŠ‚ç‚¹è·ç¦»ä¸º $1$ çš„éå¶èŠ‚ç‚¹æ±‚å‡ºæ¥ï¼Œç§°è¿™ä¸ªç‚¹é›†ä¸º<strong>æ—è¾¹é›†åˆ</strong>ã€‚é‚£ä¹ˆå¦‚æœå¶å­ $u$ çš„é‚»å±…é›†åˆä¸éå¶èŠ‚ç‚¹ $v$ çš„æ—è¾¹é›†åˆç›¸åŒï¼Œé‚£ä¹ˆ $u$ å°±ä¸€å®šæŒ‚åœ¨ $v$ ä¸Šã€‚</p>
<h3 id="6-AT3877"><a href="#6-AT3877" class="headerlink" title="$6$ AT3877"></a>$6$ AT3877</h3><blockquote>
<p>ç»™å®š $\rm X,Y$ï¼Œ ç»™å‡º $[d_{i,j}]$ è¡¨ç¤ºå½“ $\mathrm X=i,\mathrm Y=j$ æ—¶ï¼Œ$\rm S$ åˆ° $\rm T$ çš„æœ€çŸ­è·¯ã€‚</p>
<p>æ„é€ è¿™å¼ å›¾ï¼Œä½¿ä¹‹ç‚¹æ•° $&lt;300$ï¼Œæ— è‡ªç¯å’Œé‡è¾¹ï¼Œæ¯æ¡è¾¹çš„æƒå€¼ $\leq 100$ï¼Œ æƒå€¼å¯ä»¥æ˜¯æ•°ä¹Ÿå¯ä»¥æ˜¯ $\rm X,Y$ï¼Œå¹¶ç»™å‡º $\rm S,T$ ã€‚</p>
</blockquote>
<p>è®¾ $g_{i,j}$ è¡¨ç¤ºä» $\rm S$ åˆ° $\rm T$ ï¼Œç»è¿‡äº†åŒ…å« $i$ æ¡ $\rm X$ è¾¹ï¼Œ $j$ æ¡ $\rm Y$ è¾¹çš„è·¯å¾„ï¼Œå…¶å®ƒè¾¹çš„è¾¹æƒæœ€å°å’Œã€‚</p>
<p>é‚£ä¹ˆå‘ç°è¿™ä¸œè¥¿å¯ä»¥è¿™ä¹ˆè½¬ç§»å‡º $[d_{i,j}]$æ¥</p>
<script type="math/tex; mode=display">
d_{i,j}= \min_{p,q}{(p\cdot i+q\cdot j + g_{p,q})}</script><p>ç„¶åå¯ä»¥å¾—åˆ°æ¾å¼›æ¡ä»¶</p>
<script type="math/tex; mode=display">
\forall p,q, \quad \exists~ d_{i,j}\leq p\cdot i+q\cdot j+g_{p,q}</script><p>ç§»é¡¹å¯ä»¥å¾—åˆ°</p>
<script type="math/tex; mode=display">
g_{p,q}=\max_{i,j}{(d_{i,j}-p\cdot i - q\cdot j)}</script><p>äºæ˜¯è€ƒè™‘æ±‚å‡º $g $ ï¼Œä¹‹ååæ¨å‡º $[d_{i,j}]â€™$ è§‚å¯Ÿæ˜¯å¦å»åˆã€‚å»åˆåˆ™è€ƒè™‘æ ¹æ®ç»è¿‡çš„ $\rm X,Y$ è¿è¾¹å³å¯ã€‚</p>
<h3 id="7-ARC-095F"><a href="#7-ARC-095F" class="headerlink" title="$7$ ARC 095F"></a>$7$ ARC 095F</h3><blockquote>
<p>ç»™å®šä¸€æ£µæ ‘ $\rm T$, è¦æ±‚æ„é€ ä¸€ä¸ªæ’åˆ— $p$ .</p>
<p>å¯¹äºæ¯ä¸€ä¸ª $p_i$ ï¼Œæ‰¾åˆ°æœ€å¤§çš„ $j$ ä½¿å¾— $p_j&lt;p_i$ï¼Œç„¶ååœ¨ $i,j$ é—´è¿è¾¹ã€‚</p>
<p>é—®æ˜¯å¦å¯ä»¥æ„é€ å‡ºä¸ $\rm T$ åŒæ„çš„æ ‘ã€‚</p>
<p>å¦‚æœå¯ä»¥ï¼Œåˆ™ç»™å‡ºå­—å…¸åºæœ€å°çš„æ’åˆ—ã€‚</p>
<p>$n\leq 100,000$ </p>
</blockquote>
<p>è€ƒè™‘å¦‚æœç»™å®šä¸€ä¸ªæ’åˆ—ï¼Œå¦‚ä½•é€šè¿‡è¿™ç§æ–¹å¼ç”Ÿæˆä¸€æ£µæ ‘ã€‚é‚£è‚¯å®šæ˜¯æŒ‰ç…§æƒå€¼ä»å°åˆ°å¤§æšä¸¾æ¯ä¸ªæƒå€¼æ‰€åœ¨çš„ä½ç½®ï¼Œæ¯æ¬¡åœ¨ $\max_right$ å’Œæšä¸¾çš„ $i$ ä¹‹é—´è¿è¾¹ï¼Œå¹¶æ›´æ–° $\max_right$ã€‚</p>
<p>å¯ä»¥å‘ç°ï¼Œç”±äºç»™å®šçš„æ˜¯æ’åˆ—ï¼Œå±€éƒ¨æœ€å¤§å€¼å”¯ä¸€ï¼Œé‚£ä¹ˆåªä¼šå‡ºç°ã€Œéå±€éƒ¨æœ€å¤§å€¼å‘å±€éƒ¨æœ€å¤§å€¼è¿è¾¹ã€å’Œã€Œä¸Šä¸€ä¸ªç‰ˆæœ¬çš„å±€éƒ¨æœ€å¤§å€¼å’Œå½“å‰å±€éƒ¨æœ€å¤§å€¼è¿è¾¹ã€ä¸¤ç§è¿è¾¹æ–¹å¼ã€‚æ‰€ä»¥ä¸éš¾çœ‹å‡ºæœ€åçš„æ ‘çš„å½¢æ€å°±æ˜¯ä¸€ä¸ªä¸€é˜¶æ¯›æ¯›è™«â€”â€”ç›´å¾„æ—è¾¹æŒ‚ç€ä¸€å †ç‚¹ï¼Œæ¯ä¸ªç‚¹ä¸ç›´å¾„çš„è·ç¦»å‡ä¸º $1$ ã€‚æ‰€ä»¥æ˜¯å¦åˆæ³•æ±‚ä¸€ä¸‹ç›´å¾„ç„¶åcheckå³å¯ã€‚</p>
<p>è€ƒè™‘å¦‚ä½•æ„é€ ã€‚å‘ç°åªè¦æ±‚åŒæ„ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯ä» $1$ å¼€å§‹é‡æ–°ç¼–å·ã€‚å¯¹äºæ¯ä¸ªç›´å¾„ä¸Šçš„ $x$ï¼Œè®¾<strong>ä¸å…¶ç›¸è¿ä¸”ä¸åœ¨ç›´å¾„ä¸Š</strong>çš„ç‚¹çš„ä¸ªæ•°ä¸º $\deg_x$ï¼Œè¿„ä»Šä¸ºæ­¢ä¸€å…±æœ‰ $s$ ä¸ªç‚¹å·²ç»ç¼–å®Œå·äº†ï¼Œé‚£ä¹ˆåªè¦è®© $x=s+\deg_x+1$ï¼Œå‰©ä¸‹çš„ç‚¹ä¾æ¬¡èµ‹å€¼ä¸º $s+1,s+2,s+3\cdots s+\deg_x$ å°±å®Œäº†ã€‚å¯ä»¥çŸ¥é“è¿™æ ·ä¸€å®šæ˜¯æœ€ä¼˜çš„æ–¹æ¡ˆã€‚</p>
<p>ä»ç›´å¾„ä¸¤ç«¯åˆ†åˆ«å¤„ç†ä¸€ä¸‹å–ä¸ªå­—å…¸åºæœ€å°å³å¯ã€‚å¤æ‚åº¦ $O(n)$ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> faa)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = u, s ;</span><br><span class="line">    fa[u] = faa, dep[u] = dep[faa] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) != faa)&#123;</span><br><span class="line">            s = dfs(to(k), u) ;</span><br><span class="line">            <span class="keyword">if</span> (dep[ret] &lt; dep[s]) ret = s ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">int</span> rt1, rt2, num, u, v ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), add(u, v) ;</span><br><span class="line">    rt1 = dfs(<span class="number">1</span>, <span class="number">0</span>) ; fa[rt1] = <span class="number">0</span> ;</span><br><span class="line">    dep[rt1] = <span class="number">0</span> ; rt2 = dfs(rt1, <span class="number">0</span>) ;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; rt1 &lt;&lt; " " &lt;&lt; rt2 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> ( ; rt2 ; rt2 = fa[rt2])</span><br><span class="line">        vis[rt2] = <span class="number">1</span>, d[++ tot] = rt2 ;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; tot &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[i]) <span class="keyword">continue</span> ; <span class="keyword">bool</span> ans = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[i] ; k ; k = next(k))</span><br><span class="line">            <span class="keyword">if</span> (vis[to(k)]) &#123; deg[to(k)] ++, ans = <span class="number">1</span> ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">        <span class="keyword">if</span> (!ans) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    num = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= deg[d[i]] ; ++ j)</span><br><span class="line">            p[num + j] = num + j + <span class="number">1</span> ;</span><br><span class="line">        p[num + deg[d[i]] + <span class="number">1</span>] = num + <span class="number">1</span> ; num += deg[d[i]] + <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    num = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = tot ; i &gt;= <span class="number">1</span> ; -- i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= deg[d[i]] ; ++ j)</span><br><span class="line">            q[num + j] = num + j + <span class="number">1</span> ;</span><br><span class="line">        q[num + deg[d[i]] + <span class="number">1</span>] = num + <span class="number">1</span> ; num += deg[d[i]] + <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (p[i] != q[i])&#123;</span><br><span class="line">            <span class="keyword">if</span> (p[i] &lt; q[i])&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"%d "</span>, p[j]) ; <span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"%d "</span>, q[j]) ; <span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, p[j]) ; <span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-å°é¢˜æ•´ç†"><a href="#8-å°é¢˜æ•´ç†" class="headerlink" title="$8$ å°é¢˜æ•´ç†"></a>$8$ å°é¢˜æ•´ç†</h3><p>8.1 è¦†ç›–</p>
<blockquote>
<p>å¹³é¢ä¸Šç»™å®š $n$ ä¸ªç‚¹ï¼Œæ¯ä¸ªç‚¹å¯ä»¥è¦†ç›– $\frac{1}{4}$ çš„å¹³é¢ï¼Œæ±‚æœ€å°‘éœ€è¦å¤šå°‘ä¸ªç‚¹æ‰èƒ½è¦†ç›–æ‰€æœ‰ç‚¹</p>
</blockquote>
<hr>
<p>orzæˆ‘å’Œouuuyuuuä¸€å¼€å§‹è§‰å¾—é¢˜å¾ˆå‚»ï¼Œæœ€å¤šå››ä¸ªï¼Œç»“æœå‘ç°åŸæ¥æœ€å¤šä¸¤ä¸ªå°±å¯ä»¥ï¼Œç„¶åå‘ç°æˆ‘ä»¬å¾ˆå‚»ã€‚ã€‚</p>
<p>æ‰¾æŸä¸€ç»´åæ ‡æœ€å¤§/æœ€å°çš„ä¸¤ä¸ªç‚¹ï¼Œå†åˆ¤ä¸€ä¸‹æ˜¯ä¸æ˜¯åªéœ€è¦ä¸€ä¸ªç‚¹å°±å¯ä»¥æ»¡è¶³ï¼Œå°±åšå®Œäº†ã€‚</p>
<p>8.2 CF477B</p>
<blockquote>
<p>æœ‰ $n$ ä¸ªé›†åˆï¼Œå½¼æ­¤äº¤é›†ä¸ºç©ºã€‚</p>
<p>æ¯ä¸ªé›†åˆæœ‰ $4$ ä¸ªå…ƒç´ ï¼Œä¸¤ä¸¤ä¹‹é—´å‡æœ‰ $\gcd = k$</p>
<p>æ±‚ $4n$ ä¸ªæ•°ä¸­æœ€å¤§å€¼çš„æœ€å°å€¼</p>
<p>$1\leq n\leq 10000$</p>
</blockquote>
<p>å‘ç°å¯ä»¥åŒé™¤ä»¥ $k$ ï¼Œäºæ˜¯å°±å˜æˆä¸¤ä¸¤äº’è´¨äº†ï¼Œäºæ˜¯ $4$ ä¸ªæ•°ä¸­è‡³å¤š $1$ ä¸ªå¶æ•°ã€‚</p>
<p>åŒæ—¶å‘ç°ä¸€ä¸ª<del>é¬¼èƒ½å‘ç°çš„</del>æ€§è´¨ï¼Œå°±æ˜¯ç›¸é‚»ä¸¤ä¸ªå¥‡æ•°ä¸€å®šäº’è´¨ï¼Œé‚£ä¹ˆå°±æ„é€  </p>
<script type="math/tex; mode=display">
\mathrm{S}:\{6i-1,6i-3,6i-5,6i-4 \}</script><p>å¯çŸ¥å®ƒä»¬äº’è´¨ã€‚ç„¶åå°±æ²¡äº†ã€‚</p>
<h3 id="9-CF-527D"><a href="#9-CF-527D" class="headerlink" title="$9$ CF 527D"></a>$9$ CF 527D</h3><blockquote>
<p>æ¯ä¸ªå…ƒç´ æœ‰ä¸€ä¸ª $a_i$ ä¸€ä¸ª $b_i$ .</p>
<p>æ±‚ä¸€ä¸ªæœ€å¤§çš„ç‚¹é›†ä½¿å¾— $\forall p,q\in \mathrm{S},\quad |a_p-a_q|\geq b_p+b_q$</p>
<p>$n\leq 200,000$</p>
</blockquote>
<p>æˆ‘ä¸¢ï¼Œå…¶å®å°±æ˜¯æŠŠæ¯ä¸ªå…ƒç´ çœ‹åš $(a_i-b_i,a_i+b_i)$ è¿™ä¹ˆä¸€æ®µåŒºé—´ï¼Œç„¶åæ±‚çš„å°±æ˜¯æœ€é•¿ä¸ç›¸äº¤çš„åŒºé—´ä¸ªæ•°ã€‚</p>
<p>ç„¶åå°±æ²¡äº†â€¦â€¦å°±æ²¡äº†â€¦â€¦</p>
<h3 id="10-ARC-084D"><a href="#10-ARC-084D" class="headerlink" title="$10$ ARC 084D"></a>$10$ ARC 084D</h3><blockquote>
<p>æ±‚å‡º $K$ çš„å€æ•°ä¸­ï¼Œå„ä½æ•°å­—çš„å’Œæœ€å°çš„é‚£ä¸ªæ•°å­—çš„æ•°å­—å’Œã€‚</p>
<p>$K \leq 100,000$</p>
</blockquote>
<p>è€ƒè™‘ä» $i$ åˆ° $i+1$ è¿ä¸€æ¡é•¿åº¦ä¸º $1$ çš„è¾¹ï¼Œ$i$ åˆ° $10\cdot i$ è¿é•¿åº¦ä¸º $0$ çš„è¾¹ã€‚ç„¶åæŒ‰ç…§$\bmod k$ çš„ä½™æ•°å»ºè¾¹ï¼Œæœ€åå°±æ˜¯  $1\to 0$ çš„æœ€çŸ­è·¯ã€‚</p>
<h3 id="11-ç¥ç§˜çš„é¢˜ç›®"><a href="#11-ç¥ç§˜çš„é¢˜ç›®" class="headerlink" title="$11$ ç¥ç§˜çš„é¢˜ç›®"></a>$11$ ç¥ç§˜çš„é¢˜ç›®</h3><blockquote>
<p>ç»™å‡ºä¸€å¼  $n \cdot m$ çš„ç½‘æ ¼å›¾ï¼Œæ›¼å“ˆé¡¿è·ç¦»ä¸º $2$ æˆ– $3$ çš„ç‚¹ä¹‹é—´è¿ä¸€æ¡è¾¹ï¼Œæ„é€ å‡ºä¸€æ¡å“ˆå¯†å°”é¡¿å›è·¯ã€‚</p>
<p>å¯èƒ½æ— è§£ã€‚å“ˆå¯†å°”é¡¿å›è·¯ï¼šç»è¿‡æ¯ä¸ªç‚¹æ°ä¸€æ¬¡ã€‚</p>
</blockquote>
<p>å‘ç°å¯ä»¥èµ°æ³•å¯ä»¥æ˜¯æ£‹ç›˜æŸ“è‰²ï¼Œå³é»‘ç™½ç›¸é—´æŸ“è‰²ï¼Œå…ˆèµ°å®Œé»‘è‰²å†èµ°å®Œç™½è‰²ã€‚</p>
<p>å‘ç°åªæœ‰ $n=2,m=2$ æ—¶æ— è§£ã€‚å½“ $\min(n,m)=1$ æ—¶ï¼Œè€ƒè™‘ $(1,2),(1,3),(2,4),(2,5)$ éƒ½å¿…é¡»è¿ï¼ˆä¿è¯æœ‰å›è·¯ï¼‰ï¼Œå‰©ä¸‹çš„çæ„é€ å³å¯ã€‚</p>
<h3 id="12-CF-468A"><a href="#12-CF-468A" class="headerlink" title="$12$ CF 468A"></a>$12$ CF 468A</h3><blockquote>
<p>ç”¨ $1\sim n$ çš„æ‰€æœ‰æ•°å‡‘å‡º $24$ï¼Œè¾“å‡ºæ–¹æ¡ˆã€‚</p>
<p>æ¯ä¸ªæ•°éƒ½è¦ç”¨ï¼Œåªèƒ½ç”¨ <code>+</code>ã€<code>-</code>ã€<code>Ã—</code> ä¸‰ç§è¿ç®—ã€‚ $n\leq 100,000$</p>
</blockquote>
<p>å‘ç° $n\leq 3$ æ˜¾ç„¶ä¸è¡Œã€‚</p>
<p>ç„¶å $n=4$ çš„æ—¶å€™é˜¶ä¹˜å³å¯ï¼Œ$n=5$ çš„æ—¶å€™å‘ç°å¯ä»¥ $5\times 3+4\times 2+1$ è¿™ä¹ˆç®—ã€‚</p>
<p>ç„¶åè€ƒè™‘ $n&gt;5$ï¼Œé‚£ä¹ˆ $n$ ä¸€å®šå¯ä»¥ç”± $n-2$ æ¨è¿‡æ¥ï¼Œå› ä¸ºåªè¦ä¹˜ä¸Š $n-(n-1)$ å³å¯ã€‚å‘ç°è¿™æ ·æ€»æ˜¯å¯ä»¥æ„é€ å‡ºæ¥åˆæ³•è§£ã€‚</p>
<h3 id="13-Loj-525"><a href="#13-Loj-525" class="headerlink" title="$13$ Loj #525"></a>$13$ Loj #525</h3><blockquote>
<p>ç»™å®šä¸€ä¸ªæ­£æ•´æ•° $k$ï¼Œä½ éœ€è¦å¯»æ‰¾ä¸€ä¸ªç³»æ•°å‡ä¸º $0$ åˆ° $kâˆ’1$ ä¹‹é—´çš„éé›¶å¤šé¡¹å¼ $f(x)$ï¼Œæ»¡è¶³å¯¹äºä»»æ„æ•´æ•° $x$ å‡æœ‰ $f(x)â‰¡0~(\bmod k)$</p>
<p>è¦æ±‚ $\deg(f)\leq 60000$</p>
<p>$k\leq 30000$<br>é¦–å…ˆå‘ç°åªè¦å¯¹ $0\sim k-1$ æˆç«‹é‚£ä¹ˆå°±æ»¡è¶³æ¡ä»¶ã€‚ <del>ç„¶åå°±å˜æˆå‚»é¢˜äº†ï¼Œåˆ†æ²»FFTï¼åˆ†æ²»FFTï¼</del></p>
</blockquote>
<p>ç„¶è€Œåˆ†æ²»FFTä¼šTã€‚ä¸å¦¨ä»¤ $q\geq \varphi(k)$ï¼Œåˆ™ç”±äºæ‰©å±•æ¬§æ‹‰å®šç†æœ‰ï¼š</p>
<script type="math/tex; mode=display">
x^q\equiv x^{q\bmod \varphi(k)+\varphi(k)}(\mod k)</script><p>é‚£ä¹ˆå¦‚æœä»¤ $v=q+\varphi(k)$ï¼Œå°±ä¼šæœ‰</p>
<script type="math/tex; mode=display">
\begin{aligned}
x^v & \equiv x^{v\bmod \varphi(k)+\varphi(k)} (\bmod k) \\\ &\equiv x^{(q\bmod \varphi(k)+\varphi(k) \bmod \varphi(k))\bmod \varphi(k) +\varphi(k)} (\bmod k)\\\ & \equiv x^{q\bmod \varphi(k)+\varphi(k)}(\bmod k)\\\ & \equiv x^q(\bmod k)
\end{aligned}</script><p>ç„¶åå°±æ„é€ ç¬¬ $\varphi(k)$ é¡¹ç³»æ•°ä¸º $k-1$ï¼Œç¬¬ $2\cdot \varphi(k)$ é¡¹ç³»æ•°ä¸º $1$ å³å¯ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>æ„é€ </category>
      </categories>
      <tags>
        <tag>æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ </tag>
        <tag>æ€ç»´é¢˜/æ„é€ </tag>
        <tag>å¥‡æ€ªçš„æŠ€å·§</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç»ƒä¹ è®°å½•ã€‘ä¹‹å‰çš„æ‚é¢˜æ•´ç†ï¼ˆTo Be Continued....ï¼‰</title>
    <url>/2019/12/22/%E6%9D%82%E9%A2%98%E6%B3%9B%E5%81%9A%C2%B7%E4%B9%8B%E5%89%8D/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸»è¦æ˜¯ <code>CSP-S 2019</code> ä¹‹å‰çš„æ‚é¢˜æ•´ç†ï¼Ÿ</p>
<p>å¤©çŸ¥é“æˆ‘ä¸ºäº†æ•´ç†è¿™äº›ä¸œè¥¿è¦èŠ±è´¹æ€æ ·æ¼«é•¿çš„æ—¶é—´å» read back æˆ‘çš„æäº¤è®°å½•â€¦â€¦</p>
<a id="more"></a>
<hr>
<p>1ã€<a href="https://www.luogu.com.cn/problem/P1357" target="_blank" rel="noopener">LG5317 èŠ±å›­</a></p>
<p>å‘ç°ä¸€å…±åªæœ‰ä¸¤ç§æ–¹æ ¼ï¼Œå¹¶ä¸”è½¬ç§»åªè·Ÿ $\rm M$ æœ‰å…³ï¼Œäºæ˜¯è€ƒè™‘çŠ¶å‹ã€‚è€ƒè™‘ $g(s, t)$ è¡¨ç¤ºä»çŠ¶æ€ $s$ è½¬ç§»åˆ° $t$ çš„æ–¹æ¡ˆæ•°ã€‚å…¶ä¸­è½¬ç§»æŒ‡çš„æ˜¯å‘å³æ‰©å±•ä¸€æ ¼ã€‚</p>
<p>é‚£ä¹ˆæ˜¾ç„¶è¿™ä¸œè¥¿å¯ä»¥ <code>dfs</code> é¢„å¤„ç†å‡ºæ¥ã€‚ç„¶åå‘ç°è¿™ä¸œè¥¿ç±»ä¼¼äº <code>floyd</code> çš„è½¬ç§»çŸ©é˜µï¼Œç„¶åå°±å¿«é€Ÿå¹‚ã€‚è€ƒè™‘ç”±äºèŠ±åœƒæ˜¯ä¸ªç¯ï¼Œé‚£ä¹ˆåˆæ³•çš„æ–¹æ¡ˆå°±æ˜¯ $1â€¦m$ å’Œ $n+1â€¦.n+m$ è¦ç›¸åŒã€‚æ‰€ä»¥å°±ç›´æ¥æŠŠå¼€å¤´ç»“å°¾ç›¸åŒçš„ç´¯åŠ ä¸€æ³¢ã€‚</p>
<p>2ã€<a href="https://www.luogu.com.cn/problem/P4318#submit" target="_blank" rel="noopener">LG4218 å®Œå…¨å¹³æ–¹æ•°</a></p>
<p>ä¸€é“å‚»é¢˜ï¼Œå¤§æ¦‚å°±æ˜¯è€ƒå¯Ÿ $\mu$ çš„æ€§è´¨ã€‚</p>
<ul>
<li><p>$\rm Algorithm~1$</p>
<ul>
<li>å‘ç°å¯ä»¥å®¹æ–¥ï¼Œä¸” $\mu$ å‡½æ•°çš„æ€§è´¨åœ¨äºï¼Œ$\mu (x) = (-1)^k$ï¼Œå½“ä¸”ä»…å½“ $x$ ä¸å«å¹³æ–¹å› å­ä¸” $x$ çš„ä¸åŒç´ å› å­ä¸ªæ•°ä¸º $k$ã€‚æ‰€ä»¥å°±è€ƒè™‘å…ˆäºŒåˆ†ï¼ŒäºŒåˆ†å®Œäº†æ±‚ä¸€ä¸‹ </li>
<li><script type="math/tex; mode=display">
\sum _{i=1}^{\sqrt n} \mu(i)\lfloor \frac{n}{i^2}\rfloor</script><ul>
<li>å°±å˜æˆå‚»é¢˜äº†ã€‚å¤æ‚åº¦ $T \cdot \sqrt n \log n$</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>é¡ºä¾¿è®°å½•ä¸€ä¸ªå¾ˆç»çš„ <code>idea</code></p>
<ul>
<li><p>$\rm Algorithm~2$</p>
<ul>
<li><p>æ ¹æ® $\mu$ çš„æ€§è´¨ï¼Œå‘ç°ä¼¼ä¹åªæœ‰ $\mu(x) = 0$ æ—¶ï¼Œ$x$ æ‰ä¼šè¢«è®¨åŒã€‚æ‰€ä»¥å…¶å®äºŒåˆ†æ±‚çš„å°±æ˜¯ </p>
<ul>
<li><script type="math/tex; mode=display">
\sum _{i=1}^{x}\mu^2(x)\leq K</script><p>ç„¶åæˆ‘ä»¬å‘ç°è¿™ä¸œè¥¿å¯ä»¥ç›´æ¥æœæ•™ç­›ã€‚äºæ˜¯å¤æ‚åº¦å°±å˜æˆäº† $T\cdot n^{\frac{2}{3}} \log n$ã€‚ç„¶è€Œå®é™…è®°å¿†åŒ–äº†ä¼šæ›´å¿«ã€‚</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><del>ä½†æ˜¾ç„¶æœæ•™ç­›è¢«æš´åŠ›ç»™çˆ†é”¤äº†å¥½å—</del></p>
<p>3ã€[]</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>æ³›åš</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/çŠ¶å‹DP</tag>
        <tag>æ€ç»´é¢˜/å®¹æ–¥</tag>
        <tag>æ•°å­¦/çº¿æ€§ä»£æ•°/çŸ©é˜µ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ¸¸è®°ã€‘CSP-S2019æ¸¸è®°</title>
    <url>/2019/12/20/CSP-S2019%E6%B8%B8%E8%AE%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æƒ³ä¸åˆ°å§ï¼Œè¿˜æœ‰è¿™ä¸ªæ—¶å€™å†™æ¸¸è®°çš„ã€‚</p>
<p>åœ¨æœºæˆ¿å•¥é¢˜éƒ½åšä¸åŠ¨äº†ï¼Œéš¾å—ã€‚äºæ˜¯æ‰“ç®—å†™ç¯‡æ¸¸è®°ï¼Ÿä¸è¿‡CSPå·²ç»è¿‡å»å‡ ç™¾å¹´äº†å•Šï¼Œæˆ‘è¿™ç¯‡æ–‡ç« æŒ‰é“ç†åº”è¯¥å·²ç»å±äºâ€œå†å²æ–‡çŒ®â€è€Œä¸æ˜¯â€œæ¸¸è®°â€äº†å§233</p>
<p>è¿™æ˜¯ä¸€ä¸ªä»€ä¹ˆæ•…äº‹å‘¢ï¼Ÿè¿™åªæ˜¯ä¸€ä¸ªæ™®é€šäººåœ¨æŒ£æ‰çš„æ•…äº‹è€Œå·²å§ã€‚</p>
<a id="more"></a>
<h1 id="rm-Day-quad"><a href="#rm-Day-quad" class="headerlink" title="$\rm Day\quad -???$"></a>$\rm Day\quad -???$</h1><p>LCEZæœºæˆ¿ç»ˆäºåªå‰©8ä¸ªäººäº†ã€‚</p>
<p>åˆ†åˆ«æ˜¯ç»å¸¸ä¼šçµå…‰ä¸€ç°çš„wxlï¼Œç¨³å¾—ä¸€æ‰¹çš„yjkï¼Œç»å¸¸è¢«è†œè¢«AKIOIçš„wxï¼Œç©æ¢—å®…ç”·ljpï¼Œçˆ±å ä¾¿å®œçš„lwyï¼Œæ™ºå•†ä¸ä½çš„qcrï¼Œé¦–å¸­é¢“è›‹/ç”µè§†å¯¼è´­lzrå’Œæˆ‘ã€‚</p>
<p>å…¶å®åˆä¸‰åˆšæ¥å®éªŒç­ä¸€å¼€å§‹æ˜¯12ä¸ªäººï¼Œä½†æ˜¯åæ¥1ä¸ªäººå»äº†å‹æ ¡ï¼Œ1ä¸ªäººé€‰æ‹©åœ¨ <code>NOIP2018</code> ä¹‹å‰å»å­¦æ–‡åŒ–è¯¾ï¼Œæˆ‘ä»¬æŠŠå¥¹åœ¨å›¢é˜Ÿé‡Œçš„åå­—æ”¹æˆäº†â€œç­‰ä½ å›æ¥â€ï¼Œä½†æ˜¯æœ€åä¹Ÿæ²¡ç­‰åˆ°ï¼›å‰©ä¸‹ä¸¤ä¸ªäººé€‰æ‹©è€ƒå®ŒNOIP2018å°±é€€å‡ºï¼Œç°åœ¨å…¶ä¸­ä¸€ä¸ªå› ä¸ºé€‰äº†ä¸€ç§‘åœ°ç†å»äº†å¹³è¡Œç­ï¼Œå¦ä¸€ä¸ªé€‰æ‹©ç•™åœ¨æ–‡åŒ–è¯¾ç­ä¸“æ”»æ–‡åŒ–è¯¾ã€‚å½“ç„¶ï¼Œé‚£å°±æ˜¯å¦ä¸€ä¸ªæ•…äº‹äº†ã€‚</p>
<p>NOIP2018ï¼Œæˆ‘ä»¬ä¹‹ä¸­æœ‰äººè€ƒå¾—å¾ˆå¥½ï¼Œæœ‰äººé“©ç¾½è€Œå½’ï¼Œè€Œæˆ‘å±äºåè€…ã€‚æ‰€ä»¥å¤§å®¶éƒ½åœ¨ç§¯æå‡†å¤‡ç€ï¼Œé€‰æ‹©åœ¨å›½åº†ä¹‹åå°±åœè¯¾ã€‚</p>
<p>å›½åº†çš„æ—¶å€™ï¼Œæˆ‘å’Œlzrï¼Œwxå’Œqcrå»äº†é’å²›å‚åŠ æ­£ç¿ï¼Œè‡ªè®¤ä¸ºæ˜¯åœè¯¾æ•ˆæœæ’åæ¯”è¾ƒé å‰çš„ä¸€æ¬¡å¤–å‡ºåŸ¹è®­äº†ã€‚æˆ‘åªè®°å¾—å‰å‡ å¤©æ¯å¤©é—²çš„æ—¶å€™ä¼šé€‰æ‹©å»æ‰“ _This is the police 2_ï¼Œå¹¶ä¸”åœ¨èµ°çš„å‰ä¸€å¤©æˆåŠŸä¸¢äº†èº«ä»½è¯awaï¼Œlzr åˆ™åœ¨ç‹‚é¢“ä¸Šå¤å·è½´Onlineï¼Œwxå’Œqcråœ¨å¦ä¸€ä¸ªå±‹ï¼Œæ‰€ä»¥æˆ‘å¹¶ä¸æ¸…æ¥šã€‚æ— è®ºæ€æ ·ï¼Œé’å²›çš„åŸ¹è®­ä¹Ÿæ˜¯å¾ˆå€¼å¾—å›å¿†çš„å§ã€‚æˆ‘åˆ°ç°åœ¨ä¹Ÿå¯ä»¥å›æƒ³èµ·å¤œé‡Œæ— äººçš„å¤§è¡—ã€æ˜é»„çš„æˆ¿é—´åªæœ‰ä¸€ä»¶å°ç¯ã€æŠ‘éƒçš„æˆ‘ã€ç»å¸¸å»ä¹°çš„å¤§æ¡¶é›ªç¢§å’Œè¾£æ¡<del>å’Œæˆ‘ä¸¢äº†çš„èº«ä»½è¯</del>ã€‚</p>
<p>æ— è®ºæ€æ ·ï¼Œé’å²›çš„å¤–å–æ²¡æœ‰æµå—çš„å¥½åƒï¼Œå˜¿å˜¿ã€‚</p>
<h1 id="rm-Day-quad-1"><a href="#rm-Day-quad-1" class="headerlink" title="$\rm Day\quad -??$"></a>$\rm Day\quad -??$</h1><p>æˆ‘é€‰æ‹©æŠŠæ¯å¤©ä¸Šåˆå®‰æ’ç»™ZRçš„æ¨¡æ‹Ÿèµ›ï¼Œä¸€èˆ¬åæ¬¡éƒ½ä¸ä¼šå¾ˆé«˜ï¼Œå”‰èœæ­»äº†ã€‚</p>
<p>å‰©ä¸‹äººå¯èƒ½åœ¨åšé¢˜ï¼Œå¯èƒ½åœ¨é¢“ã€‚å°è±¡æœ€æ·±åˆ»çš„å°±æ˜¯æˆ‘æ¯äº”æ¬¡å»æ‰¾yjkç©ï¼Œæœ‰ä¸‰æ¬¡ä»–éƒ½åœ¨åˆ·çŸ¥ä¹ã€‚ã€‚ã€‚</p>
<p>å‘ç°è‡ªå·±æ— è®ºä»€ä¹ˆå¤§å‹æ¯”èµ›ä¹‹å‰éƒ½ä¼šå‘ç°è‡ªå·±åŸæ¥æœ‰æ•´ç†ä¸å®Œçš„åšå®¢ï¼Œå¹³æ—¶ä¹ æƒ¯å¤ªå·®å¸¦æ¥çš„åæœçœŸå¯æ€•e</p>
<p>ä¸è¿‡ä¼¼ä¹æ˜¯æœ‰æˆ‘å¼•èµ·çš„ä¸€é˜µé£ï¼Œæœºæˆ¿é‡Œå¤§å®¶éƒ½å¼€å§‹æ™šä¸Šå–_é¦™é£˜é£˜_ï¼Œç”šè‡³è¿é“å…¬é¸¡yjkä¹Ÿæ‹”æ¯›äº†ä¹°è¿‡å‡ æ¬¡å¥¶èŒ¶ï¼Œäºæ˜¯èµ°å»Šä¸Šå°±ä¸€è‚¡æµ“éƒçš„å¥¶èŒ¶å‘³233</p>
<p>ä¹‹å‰å˜›ï¼Œå°±åšäº†åš<code>dp</code>ï¼Œå­¦äº†å­¦<code>odt</code>ï¼Œç¬¬ä¸€æ¬¡å†™è«é˜Ÿç»“æœè¢«é€¼ç€è°ƒäº†åŠå¤©æœ€åå¥—äº†ä¸ªçº¿æ®µæ ‘ã€‚å‰©ä¸‹çš„æˆ–è®¸å°±æ²¡æœ‰ä»€ä¹ˆå°è±¡æ·±åˆ»çš„äº‹æƒ…äº†ã€‚</p>
<p>å“¦ï¼Œèƒœåˆ©ä¸€ä¸­çš„ç¥ä»™ä»¬ä¸€ç›´å¾ˆåœ¨çŠ¶æ€ã€‚æˆ‘å°±å¾ˆå¥‡æ€ªä¸ºä»€ä¹ˆä¼šæœ‰äººæ¯å¤©åšæŒæ‰“æ¯”èµ›è¿˜èƒ½åšæŒæ•´å®Œæ‰€æœ‰é¢˜ç›®çš„â€¦â€¦æœŸé—´æˆ‘æ•´å¤©å¬æ­Œï¼Œè¿˜æŠ½äº†ä¸€ä¸ªæ™šä¸Šçœ‹äº†é›†ã€Šå¥‡è‘©è¯´ã€‹ï¼Œæ„Ÿè§‰æè¯è®¤çœŸèµ·æ¥å®åŠ›ä¹Ÿä¸å¼±è›¤ã€‚</p>
<p>è¦æ¥äº†å—ï¼Ÿè¦æ¥äº†å§ã€‚</p>
<h1 id="rm-Day-quad-3"><a href="#rm-Day-quad-3" class="headerlink" title="$\rm Day\quad-3$"></a>$\rm Day\quad-3$</h1><p>ç»™æœ€å–œæ¬¢çš„è¯­æ–‡è€å¸ˆå†™äº†å°ä¿¡ï¼Œè·Ÿå¥¹è¯´æˆ‘è§‰å¾—æˆ‘å¯èƒ½åœ¨è€ƒå®Œä¹‹åä¸ä¼šç»§ç»­èµ°ä¸‹å»äº†ï¼Œè¿™è®©æˆ‘å¾ˆéš¾è¿‡ï¼Œå› ä¸ºæˆ‘å‰²èˆä¸ä¸‹é‚£äº›å›å¿†ï¼Œè§‰å¾—å¥¹å¯èƒ½ä¼šç†è§£æˆ‘ã€‚å¥¹å›ä¿¡äº†ã€‚æˆ‘å¾ˆé«˜å…´å¥¹æ²¡æœ‰ç¡¬å¡ä»€ä¹ˆå¿ƒçµé¸¡æ±¤ã€‚äºæ˜¯æ¯å¤©æ™šä¸Šæˆ‘éƒ½ä¼šæ‹¿å‡ºä¿¡æ¥è¯»ä¸€éã€‚</p>
<p>å“¦å¯¹ï¼Œå¥¹ä»¥å‰æ˜¯æˆ‘çš„è¯­æ–‡è€å¸ˆï¼Œæ–‡åŒ–è¯¾/å¥¥èµ›åˆ†ç­ä¹‹åå¥¹å°±åªæ•™éš”å£äº†ã€‚</p>
<p>å…¶å®ä½ è¯´ç°åœ¨æˆ‘æœ‰ä»€ä¹ˆæ„Ÿå—å‘¢ï¼Ÿæˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œå°±æ˜¯è”¡ç´å”±è¿‡çš„ _è®©å®ƒå¥½å¥½çš„æ¥ï¼Œè®©å®ƒå¥½å¥½çš„å»_ è¿™ç§æ„Ÿè§‰å§ã€‚</p>
<h1 id="rm-Day-quad-0"><a href="#rm-Day-quad-0" class="headerlink" title="$\rm Day\quad 0$"></a>$\rm Day\quad 0$</h1><p>æŠ¥åˆ°æ—¥ï¼Œç¾¤ä½“ä¹˜å¤§å·´ã€‚å¤§å·´ä¸Šæˆ‘æ•™yjkæ‰“éŸ³æ¸¸å’Œæ‹³çš‡ï¼Œæ‰“deemoä»–èœçš„ä¸€æ‰¹233</p>
<p>åˆ°äº†è€ƒç‚¹ï¼Œæ—¥ç…§ä»€ä¹ˆèŒä¸šæŠ€æœ¯å¤§å­¦ã€‚æ ¡å›­ä¸€èˆ¬ï¼Œå®¿èˆè¿˜è¡Œï¼Œèµ·ç æœ‰æ’å¤´å’Œæ¡Œå­ã€‚</p>
<p>å»è¯•äº†è¯•é¥­èœï¼Œæ„Ÿè§‰è¿˜å¯ä»¥ï¼ŒæŒºä¸°å¯Œçš„ã€‚å‘ç°æ˜¯å…‘æ¢é¤å¸ï¼Œäºæ˜¯å°±æ¢äº†ä¸‰ç§é¢å€¼çš„ç•™ä¸‹ä½œçºªå¿µäº†ã€‚</p>
<p>æ™šä¸Šå»è¯•æœºï¼Œè±ªåå…­è¾¹å½¢æ–¹æ¡Œï¼Œå’Œæœºæˆ¿é‡Œä¸€æ ·ï¼Œæ„Ÿåˆ°å¾ˆå¼€å¿ƒã€‚é”®ç›˜ä¹Ÿå¾ˆè½»ã€‚å¬åˆ«äººè¯´é”®ç›˜éš¾ç”¨ã€åº§ä½ä¹‹é—´é—´è·å¤ªå°ï¼Œæ‰çŸ¥é“åŸæ¥ä¸æ˜¯æ¯ä¸ªè€ƒåœºéƒ½æ˜¯è±ªåå…­è¾¹å½¢æ–¹æ¡Œã€‚æœ‰æŠ½ä¸­å¤§å¥–çš„å–œæ‚¦233</p>
<p>è¯•æœºå›æ¥å°±æ˜¯çå†™äº†å†™æ¿å­ï¼Œå†™äº†å†™åšå®¢ã€‚ç¡å‰å¬çš„æ˜¯å¾·å½ªè¥¿çš„ã€Šæœˆå…‰ã€‹ã€‚</p>
<p>è€ƒå‰å’Œyjkä¼°æ‘¸äº†ä¸€ä¸‹ï¼ŒDay1è¦æ‹¿260å·¦å³æ‰èƒ½ç¨³ï¼Œä¸çŸ¥é“æ˜å¤©ä¼šæ€æ ·ã€‚</p>
<p>å“¦ï¼Œå¯¹ï¼Œå½“æ—¶å¬çš„é‚£ä¸€ç‰ˆã€Šæœˆå…‰ã€‹ï¼Œæ˜¯æˆ‘å¬å®Œå¥½å¤šç‰ˆä¹‹åæœ€å–œæ¬¢çš„ä¸€ä¸ªç‰ˆæœ¬ã€‚ä½†ä¹‹åæˆ‘å°è¯•æ‰¾è¿‡ï¼Œä½†æ— è®ºæ€ä¹ˆæ‰¾éƒ½æ‰¾ä¸åˆ°äº†â€¦</p>
<h1 id="rm-Day-quad-1"><a href="#rm-Day-quad-1" class="headerlink" title="$\rm Day\quad 1$"></a>$\rm Day\quad 1$</h1><p>è€ƒå•¦è€ƒå•¦ã€‚</p>
<p>å¼€é¢˜å‘ç°æœ‰ä¸€äº›å¥‡æ€ªçš„è¯´æ˜ï¼Œæ²¡ç®¡ã€‚</p>
<p>å¼€ $\rm T1$ï¼Œå‘ç°æ˜¯ä¸ªsbé¢˜ï¼Œå†™äº†$\rm [5,10]min$ å·¦å³åˆ‡äº†ï¼Œå¼€è€ƒ $15\min$ çš„æ—¶å€™æ‹ä¸Šäº†ã€‚</p>
<p>å¼€ $\rm T2$ï¼Œå‘ç° $50$ åœ¨é€ï¼Œäºæ˜¯å…ˆå†™äº† $50$ ã€‚ä¹‹åå¯»æ€ç€å»åšåš $\rm T3$ï¼Œå‘ç°ä¸å¤ªä¼šã€‚æœ¬ç€æ±‚ç¨³ï¼Œå†™äº† $10pts$ å°±å›å»å†™ $\rm T2$äº†ã€‚äºæ˜¯å°±å¼€å§‹æ¼”ï¼Œæ¼”äº†åŠå°æ—¶å†™å‡ºäº†ä¸€å †ä¸çŸ¥é“å•¥ä¸œè¥¿ï¼Œç„¶ååˆæ¼”äº†åŠå°æ—¶å‘ç°å¤§æ ·ä¾‹çˆ†æ ˆäº†â€¦â€¦</p>
<p>æˆ‘ä¸ä¼šå‘Šè¯‰ä½ æˆ‘æ¥ä¸‹æ¥æµªè´¹äº†å¿«åŠå°æ—¶å»å›å¿†<code>Dev</code>æ€ä¹ˆå¼€æ ˆâ€¦â€¦ </p>
<p>æœ€åè¿˜æ˜¯å¤±è´¥äº†ï¼Œä½†æ˜¯å‘ç°å…¶å®å¤§æ ·ä¾‹ä¸éœ€è¦ <code>dfs</code> ï¼Œäºæ˜¯å†™äº†ä¸ªåºåˆ—ç‰ˆæœ¬ç»™æ¼”è¿‡å»äº†ã€‚ä¹‹å $\rm T2$ å°±æ‹ä¸Šäº†ã€‚æ­¤æ—¶å¤§æ¦‚æ˜¯ $10:15$ ã€‚</p>
<p>è§‰å¾—å»åˆš $\rm T3$ åº”è¯¥ä¸è‡³äºä¸€åˆ†æ²¡æœ‰ï¼Œç»“æœå°±çœŸçš„ä¸€åˆ†æ²¡æœ‰ï¼Œä¼¤å¿ƒã€‚</p>
<p>ä¹‹åå°±è‡ªé—­äº†ã€‚å‡ºäº†è€ƒåœºï¼Œæˆ‘æˆ´ç´§å†²é”‹è¡£å¸½å­å†²åˆ°äº†ä¸€ä¸ªåƒ»é™çš„å°è·¯é‡Œé¢ï¼Œå‘¨å›´éƒ½æ˜¯å¯†å¯†éº»éº»çš„æ ‘ï¼Œå¼€å§‹æ€è€ƒäººç”Ÿã€‚åœ¨å®¶åº­ç¾¤é‡Œç”¨å¾®ä¿¡å‘äº†å¥ â€œè€ƒæŒ‚äº†ï¼Œæ²¡æ•‘äº†â€ï¼Œè·Ÿå¦¹å­è¯´äº†å£°â€œè¦é€€å½¹äº†â€å°±æ‰¾äº†ä¸ªè§’è½å¼€å§‹æ€è€ƒäººç”Ÿã€‚æ€è€ƒå®Œä¹‹åå¼€å§‹åœ¨æ ¡å›­é‡Œé—²é€›ï¼Œä¸æƒ³å›å®¿èˆã€‚æˆ‘è§‰å¾—ä¸€å®šä¼šæœ‰ sb å­¦å¼Ÿæˆ–è€… sb åŒçº§ç”Ÿåœ¨å¯¹ tnd ç­”æ¡ˆï¼Œç»“æœæœ€åæ‰‹æœºæ²¡ç”µäº†ä¸å¾—ä¸å›å»ã€‚</p>
<p>å›å»ä¹‹åè¦äº†ä»½è„†çš®é¸¡é¥­å«ä¸Š yjk å‡ºå»é€›ï¼Œå‘ç°åŸæ¥å¤§å®¶éƒ½æ˜¯ 210 å·¦å³ï¼Œå¿ƒæ€å¾—åˆ°äº†æ”¾æ¾ã€‚ç»“æœä¸çŸ¥é“ä¸ºå•¥ï¼ŒååŠç¨‹è·Ÿ yjk è¶Šèµ°è¶Šè‡ªé—­ã€‚æˆ‘ä»¬ä¿©å¤§æ¦‚æ˜¯è¿™ä¹ˆèŠå¤©çš„ï¼š</p>
<blockquote>
<p>æˆ‘ï¼šä½ æœ€åè€ƒåˆ°å¤šå°‘åè¿˜å­¦ï¼Ÿ</p>
<p>yjkï¼š20~30å§ã€‚</p>
<p>æˆ‘ï¼šå—¯æˆ‘ä¹Ÿæ˜¯ã€‚é‚£ 70 ä»¥åå‘¢ï¼ˆå› ä¸ºä»–å»å¹´è¿™ä¸ªåæ¬¡ï¼‰ï¼Ÿ</p>
<p>yjkï¼šä¸å­¦äº†å§ã€‚ã€‚</p>
<p>æˆ‘ï¼šå—¯æˆ‘ä¹Ÿæ˜¯ã€‚</p>
<p>yjkï¼šä»Šå¤©çš„é¢˜æ„Ÿè§‰æ²¡æœ‰åŒºåˆ†åº¦å•Š</p>
<p>æˆ‘ï¼šæ˜¯å•Šï¼Œæ²¡æœ‰åŒºåˆ†åº¦å•Šã€‚å›å»è¿˜è¦è¡¥æ–‡åŒ–è¯¾ã€‚å¤§å®¶ä»Šå¤©éƒ½ 210ï¼Œå…¨å¤©ä¸‹éƒ½ 210ï¼Œæ˜å¤©è¿˜ä¼šæ›´éš¾ï¼Œè‚¯å®šä¼šåŠ å¤§åŒºåˆ†åº¦ï¼Œé‚£æˆ‘å¯èƒ½å°±è¢«åŒºåˆ†ä¸‹å»äº†â€¦ï¼ˆå¼€å§‹ç¢ç¢å¿µï¼‰</p>
<p>yjkï¼šæ˜¯å•Šâ€¦â€¦</p>
</blockquote>
<p>äºæ˜¯æˆ‘ä¿©å°±åœ¨å››å­£æ¡¥é‚£é‡Œè‡ªé—­äº†ï¼Œå’Œä¿©äºŒå‚»å­ä¸€æ ·è¹²åœ¨æ¡¥è¾¹ï¼Œå¦‚æœå¿½ç•¥è‚¤è‰²ï¼Œå®›å¦‚ä¸¤å°Šä½›ã€‚</p>
<p>ä¸è¿‡åæ¥èµ°ç€èµ°ç€å¿ƒæ€åˆå›æ¥äº†ã€‚å›åˆ°å®¿èˆåè¢«è¾…å¯¼å‘˜éª‚äº†ä¸€é¡¿ï¼Œå› ä¸ºæ‰‹æœºè½åœ¨å®¿èˆå¹¶ä¸”æ²¡ç­¾åˆ°ï¼Œ233.</p>
<p>ä¹‹åé€‰æ‹©å»åƒæ™šé¥­ï¼Œç¢°åˆ°äº†èƒœåˆ©ä¸€ä¸­çš„ç¥ä»™ï¼Œä½†æ˜¯æ˜¾ç„¶ä»–ä»¬ä¸å¯èƒ½è®¤è¯†æˆ‘ï¼Œæ‰€ä»¥æˆ‘å°±åƒä¸€ä¸ªç‹—ä»”ä¸€æ ·å•æ–¹é¢ç›¯ç€ä»–ä»¬çœ‹â€¦â€¦233</p>
<p>æ™šé¥­æŒºä¸é”™ï¼è¿™æ˜¯çœŸçš„ï¼ä¹‹åå»ä¹°äº†çº¢ç‰›ï¼Œå¸Œæœ›æ˜å¤©èƒ½ç”¨ä¸Šã€‚</p>
<p>æ™šä¸Šå…¶å®ä¸€ç›´åœ¨é¢“ç«å½±å’Œæ‹³çš‡â€¦â€¦ç¡ä¹‹å‰å†™äº†å†™åšå®¢ï¼Œ<code>hexo -d</code> ä¹‹åå°±ç¡äº†ã€‚</p>
<p>è¿˜æ˜¯å¬çš„ã€Šæœˆå…‰ã€‹ã€‚</p>
<h1 id="rm-Day-quad-2"><a href="#rm-Day-quad-2" class="headerlink" title="$\rm Day\quad 2$"></a>$\rm Day\quad 2$</h1><p>â€¦â€¦è‡ªé—­äº†ã€‚</p>
<p>å¼€åœºçœ‹T1ï¼Œå‘ç°æ˜¯è®¡æ•°ï¼Œä¸ä¼šã€‚å»æ T2ï¼Œè§‰å¾—å¾ˆå¯åšï¼Œå‘ç°40åœ¨é€ï¼›å†™å®Œå»çœ‹T3ï¼Œå‘ç°40åœ¨é€ã€‚äºæ˜¯å†³å®šå†™ T2ã€‚ç„¶å T2 çŒœäº†ä¸€æ³¢å•è°ƒæ€§å‘ç°å¯ä»¥ 64ï¼Œäºæ˜¯æ•°æ®åˆ†æ²»äº†ä¸€ä¸‹ï¼Œæ‹ä¸Šäº†ï¼›ä¹‹åå»å†™äº†ä¸ªT3çš„40ã€‚T2æ¨äº†æ¨ï¼Œè§‰å¾—ä¼¼ä¹å¯ä»¥æ–œç‡ä¼˜åŒ–ï¼Œä½†æ˜¯å‘ç°æœ‰äºŒæ¬¡é¡¹ä¼¼ä¹å¾ˆéš¾åŠï¼Œå°±æ²¡ç®¡ã€‚å‰©ä¸‹çš„æ—¶é—´å°±åœ¨åšT1â€¦â€¦</p>
<p>æœ€å¤§çš„å¤±è¯¯æ˜¯å•¥å‘¢ï¼Ÿå¯èƒ½å°±æ˜¯æˆ‘T1<strong>æŠŠ n å’Œ m çœ‹åäº†ï¼Œå¹¶ä¸”è¿‡äº†å‰ä¸¤ä¸ªæ ·ä¾‹</strong>ï¼Œäºæ˜¯è§‰å¾—è¿™é¢˜64åœ¨é€ã€‚ä½†æ˜¯æ­»æ´»è¿‡ä¸å»ç¬¬ä¸‰ä¸ªæ ·ä¾‹ã€‚å¥½ä¹…ä¹‹åæ‰å‘ç°çœ‹åäº†ï¼Œèµ¶ç´§å†™äº†ä¸ªç„å­¦dfsã€‚èµ›åä¸€æµ‹reäº†ã€‚çœŸå¼€å¿ƒã€‚T3å½“æ—¶çœ‹çš„æ—¶å€™è§‰å¾—75éƒ½æ˜¯é€ï¼Œä½†æ˜¯æœ€åä¹Ÿæ²¡æ¥å¾—åŠå†™â€¦â€¦äºæ˜¯ç¬¬äºŒå¤©å°±è¿™ä¹ˆå‡‰äº†ã€‚</p>
<p>ä¸€å‡ºæ¥ï¼Œå°±è‡ªé—­äº†ã€‚é—²é€›äº†å¥½ä¹…ï¼Œç”¨QQè·Ÿå¦¹å­è¯´â€œçœŸé€€å½¹äº†â€ï¼Œç”¨å¾®ä¿¡è·Ÿå®¶é•¿è¯´â€œå·²ç»å‡†å¤‡è¿æ¥æ–°ç”Ÿæ´»äº†â€ï¼Œåæ¥å°±æ²¡æœ‰åæ¥äº†ã€‚å›å»ä¸€é—®å‘ç°å¤§å®¶ä¹Ÿéƒ½æŒ‚äº†â€¦â€¦yjkå“­äº†ï¼Œæˆ‘å¤´ä¸€æ¬¡è§ä»–å“­ã€‚</p>
<p>ä¸ç”¨æƒ³çš„ï¼ŒDay2å°±æ˜¯è€ƒåŒºåˆ†åº¦ã€‚ä¹‹å‰zråšé¢˜çš„æ—¶å€™å°±æ˜ç™½äº†ï¼Œæˆ‘æ˜¯é‚£ç§è¢«åŒºåˆ†ä¸‹å»çš„äººã€‚å®¹æ–¥ã€dpã€è´ªå¿ƒä¹‹ç±»çš„è¿™äº›åŸºæœ¬åŠŸï¼Œæˆ‘éƒ½å¾ˆçƒ‚å¾ˆä¸æ‰å®ï¼Œè¢«åŒºåˆ†ä¸‹å»æ˜¯æˆ‘æ´»è¯¥ã€‚ä½ è¯´æˆ‘ä¼šä¸ºè‡ªå·±ä»¥å‰æ‹¼å‘½å­¦å¤šé¡¹å¼æ„Ÿåˆ°ä¸å€¼å—ï¼Ÿå¯èƒ½ç¡®å®ä¸å€¼ï¼Œä½†æ˜¯è¯´å•¥éƒ½æ²¡ç”¨äº†ã€‚</p>
<p>å›å»çš„è·¯ä¸Šè¿˜æ˜¯æ¯”è¾ƒæ„‰å¿«çš„ã€‚è½¦ä¸Šçš„ç”µè§†ç»ˆäºä¸æ”¾ä¸Š21ä¸–çºªåˆçš„æ‚²æƒ…æ— è„‘ä¹¡æ‘æ‹çˆ±æ­Œæ›²ï¼Œæ”¹æ”¾ã€Šæ¬¢ä¹å–œå‰§äººã€‹ï¼Œäºæ˜¯æœ€ç»ˆå’Œyjkçœ‹äº†ä¸€è·¯233</p>
<p>rqyå“­äº†ï¼Œå¯èƒ½æ˜¯å› ä¸ºè§‰å¾—æˆ‘ä»¬éƒ½é€€å½¹äº†å§ã€‚ä½†æ˜¯æˆ‘æ„Ÿè§‰æˆ‘å’Œä»–å·²ç»ä¸æ˜¯ä¸€ä¸ªä¸–ç•Œçš„äººäº†ã€‚æˆ‘ä¸€ç›´æ„Ÿè§‰ï¼Œå¦‚æœè®©æˆ‘ä»å®åŠ›å’Œé™ªä¼´é‡Œé¢é€‰ä¸€ä¸ªï¼Œæˆ‘è‚¯å®šæ¯«ä¸è¿Ÿç–‘åœ°é€‰æ‹©å‰è€…ã€‚ä½†ï¼Œç»“æŸäº†ã€‚</p>
<p>æ™šä¸Šå›å®¶äº†ï¼Œå°±æ˜¯åœ¨ä¸€ç›´é¢“è€Œå·²ï¼Œæ²¡å•¥åˆ«çš„ï¼ŒæœŸé—´åŠ±å¿—è¦å¼€å¯æ–°ç”Ÿæ´»ï¼Œè§‰å¾—å¾ˆæœ‰æ–—å¿—ã€‚</p>
<h1 id="rm-Day-7"><a href="#rm-Day-7" class="headerlink" title="$\rm Day ~7$"></a>$\rm Day ~7$</h1><p>åœ¨æ ¡çš„å‘¨å…­ï¼Œé€‰æ‹©å»æœºæˆ¿æ”¶æ‹¾ä¸œè¥¿ï¼Œé¡ºä¾¿çœ‹äº†çœ¼æ°‘é—´æ•°æ®æˆç»©å•ã€‚å‘ç°è‡ªå·±å’Œyjkéƒ½æ˜¯çœé‡Œ50å¤šåï¼Œè¿˜ä¸€ä¸ªåˆ†â€¦è¿™å°±å¾ˆéš¾äº†ï¼Œæˆ‘ä»¬ä¹‹å‰æ²¡è®¨è®ºè¿‡è¿™ä¸ªåŒºé—´è¯¥å¹²å•¥å‘€ï¼Ÿ</p>
<h1 id="ç°åœ¨"><a href="#ç°åœ¨" class="headerlink" title="ç°åœ¨"></a>ç°åœ¨</h1><p>ä¹‹åï¼Ÿä¹‹åå°±æ˜¯æˆ‘åˆæ»šå›æ¥è¿½æ¢¦ï¼Œyjkå»æ–‡åŒ–è¯¾äº†ï¼Œå‰©ä¸‹çš„äººéƒ½é€€å½¹äº†ã€‚</p>
<p>LCEZ55 çº§çš„æœºæˆ¿æ•…äº‹ï¼Œä¹Ÿå°±è¿™ä¹ˆç»“æŸäº†å§ï¼Ÿæˆ‘ä¸€ç›´è§‰å¾—ï¼Œæˆ‘ä»¬æœºæˆ¿æ²¡æœ‰å…¶å®ƒæœºæˆ¿å¯çˆ±ï¼Œæˆ‘æ˜¯ç½ªé­ç¥¸é¦–ã€‚æˆ‘èº«ä¸ºé˜Ÿé•¿ï¼Œè¦å¼ ç½—æ—¥å¸¸äº‹åŠ¡ï¼Œä½†æ˜¯ä»æ¥æ²¡çœŸæ­£å…³å¿ƒè¿‡è°ï¼ŒåŠ ä¸Šè„¾æ°”å¾ˆå·®å®¹æ˜“ç€æ€¥ï¼ˆè™½ç„¶ç°åœ¨å¥½å¾ˆå¤šäº†ï¼Ÿï¼‰ã€‚å¹¶ä¸”ä¸€å¼€å§‹æˆ‘å¾ˆèœï¼Œè¦ä¸€ç›´ä¸é—ä½™åŠ›çš„æå‡è‡ªå·±å®åŠ›ï¼Œä¸é¡¾ä»€ä¹ˆâ€åŒå­¦å‹è°Šâ€œå•Šå•¥çš„ï¼ŒåŠŸåˆ©ä¸”æµ®èºã€‚å¤§å®¶å¹³æ—¶ä¹Ÿä¸æ€ä¹ˆæ•¢è·Ÿæˆ‘äº¤æµï¼Œäºæ˜¯æœºæˆ¿å°±å¾ˆå†·æ¸…ã€‚</p>
<p>ä½†æœºæˆ¿é‡Œä¹Ÿæ—¶å¸¸ä¼šæœ‰ç¬‘å£°ï¼Œæ¯”å¦‚è”èµ›å‰ï¼Œæœºæˆ¿é‡Œä¸€ç›´å…¶ä¹èèçš„ã€‚ç°åœ¨çœ‹æ¥é‚£ä¼¼ä¹æ˜¯é¥è¿œçš„å›å¿†äº†ã€‚</p>
<p>ç°åœ¨æœºæˆ¿é‡Œåªæœ‰æˆ‘ä¸€ä¸ªäººäº†ï¼Œæˆ‘å¼€å¿ƒå—ï¼Ÿç»ˆäºç­‰åˆ°äº†æˆ‘å–œæ¬¢çš„æ‚ è¿œçš„å¯‚é™ï¼Œæˆ‘æ›´å¿«ä¹å—ï¼Ÿ</p>
<p>å‘å‰èµ°å§ã€‚</p>
<p>æˆ‘è¿˜å¾ˆèœï¼Œå•¥éƒ½ä¸ä¼šï¼Œè¿·èŒ«ä¸”ä¸çŸ¥æ‰€æªã€‚</p>
<p>ä½†æ˜¯äººç”Ÿä¹Ÿå°±åº”è¯¥æ˜¯è¿™æ ·çš„å§ã€‚</p>
<p>æ˜å¤©ä½ å¥½ã€‚</p>
<h1 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h1><p>å¤§å®¶ä¸€èµ·åŠ æ²¹å§ï¼ä¸ºäº†æ¢¦æƒ³å’Œæ˜å¤©ã€‚</p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>ç”Ÿæ´»ç¢ç‰‡</tag>
        <tag>ç¬”å°–ç”ŸèŠ±</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç½®é¡¶ã€‘é—²è°ˆ</title>
    <url>/2019/12/15/%E9%97%B2%E6%89%AF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><del>åˆ«åï¼šä¸€å¥è¯æ—¥è®°</del></p>
<p>ä¸è¿‡ä¼¼ä¹å†™ç€å†™ç€æ—©å°±ä¸æ­¢ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«å¥è¯äº†/kk</p>
<p>å¯èƒ½å°±æ˜¯ç”¨æ¥éšæ—¶è®°å½•è‡ªå·±æ„Ÿæ‚Ÿçš„ä¸œè¥¿ï¼Ÿ</p>
<p>ç°åœ¨å·²ç»é¸½äº†</p>
<a id="more"></a>
<h3 id="2-8"><a href="#2-8" class="headerlink" title="2.8"></a>2.8</h3><p>æˆ‘å‘ç°ï¼Œåœ¨å®¶é‡Œæ˜¯ä¸å¯èƒ½å†™blogçš„ã€‚æ‰€ä»¥é¸½äº†é¸½äº†ã€‚</p>
<h3 id="1-22"><a href="#1-22" class="headerlink" title="1.22"></a>1.22</h3><p>ä»Šå¤©å†³å®šè¦è¡¥ä¸€è¡¥ä¹‹å‰æ¬ ä¸‹çš„æ—¥è®°ï¼Œå‘ç°ä» $1.5$ å¼€å§‹å°±æ–­æ›´ï¼Œå®åœ¨æ˜¯å¤ªå¤šäº†â€¦å¤šäºäº†å’Œzayçš„èŠå¤©è®°å½•èƒ½å¸®æˆ‘æƒ³èµ·æˆ‘å½“æ—¶åˆ°åº•åœ¨å¹²ä»€ä¹ˆâ€¦</p>
<p>æ™šä¸Šå› ä¸ºä¸€äº›äº‹æƒ…é™·å…¥äº†æ·±æ·±çš„æ€è€ƒâ€¦â€¦</p>
<h3 id="1-21"><a href="#1-21" class="headerlink" title="1.21"></a>1.21</h3><p>ä»Šå¤©å†³å®šå»æ‰¾åŒå­¦ç©ï¼Œä¸Šåˆå› ä¸ºçœ‹ã€Œç¢Ÿä¸­è°3ã€å¹¶ä¸”æ­é”™äº†å…¬äº¤é¸½äº†å¥½ä¹…233</p>
<p>(PS:æˆ‘tmæ‰“å‡ºã€Œç¢Ÿä¸­è°ã€æ‰å‘ç°åŸæ¥ç¬¬ä¸€ä¸ªdieå’Œç¬¬ä¸‰ä¸ªdieä¸æ˜¯ä¸€ä¸ªdieâ€¦</p>
<p>ä¸‹åˆå¥¹è¦å»ä¹¦åº—ç¤¾ä¼šå®è·µï¼Œæœ¬æ¥æƒ³ç»§ç»­è·Ÿå¥¹ä¸€èµ·æ··ï¼Œç»“æœå‘ç°å¥¹é—ºèœœæ¥äº†ä¹‹åæˆ‘å°±æ²¡äººè®¤é¢†äº†â€¦ä¸æ˜¯å¾ˆå¼€å¿ƒåœ°å›äº†å®¶ã€‚ä¸è¿‡ä»”ç»†æƒ³æƒ³çš„è¯ï¼Œå…¶å®ä¹Ÿæ˜¯æ­£å¸¸ã€‚æŠŠå¥‡æ€ªçš„ä¸œè¥¿é€æ¸çœ‹åšæ­£å¸¸ï¼Œä¹Ÿç®—ä¸€ç§è¿›æ­¥å§ã€‚</p>
<p>æ™šä¸Šæ°´ç¾¤+åšé¢˜ï¼Œè¿˜æ˜¯é˜¿ç‹¸é‚£é¢˜ï¼Œè¸©äº†ä¸€å †å‘æ€»ç®—æ˜¯åšå®Œäº†ã€‚</p>
<p>QAQæœ¬æ¥è§‰å¾—è°ƒæ•´å¾—å¾ˆå¥½çš„ä½œæ¯åˆè«å¾—äº†ã€‚ä¸¤ç‚¹æ‰ç¡ï¼Œæ™šå®‰å•¦ã€‚</p>
<h3 id="1-20"><a href="#1-20" class="headerlink" title="1.20"></a>1.20</h3><p>åšé¢˜æ˜¯å› ä¸ºæœ¬æ¥å†³å®šå†™çš„ä¸€ç¯‡blogï¼Œç›¸å…³å†…å®¹åªå†™äº†ä¿©é¢˜ã€‚æˆ‘è§‰å¾—å§ï¼Œè¦ä¹ˆåªæ•´ç†ä¸€é“ï¼Œè¦ä¹ˆå°±ä¸‰é“ï¼Œä¸çŸ¥é“ä¸ºå•¥å¯¹ã€ŒäºŒã€å¾ˆä¸çˆ½ï¼Œäºæ˜¯å°±å†³å®šå†å†™ä¸€é“ã€‚</p>
<h3 id="1-6"><a href="#1-6" class="headerlink" title="1.6"></a>1.6</h3><p>ç¿»äº†ä¸€ç¿»è‡ªå·±çš„ä»»åŠ¡æ¸…å•ï¼Œç²¾æŒ‘ç»†é€‰åœ°åˆ äº†å¥½å¤šä¹‹åå‘ç°è¿˜æ˜¯å¤šåˆ°åšä¸å®Œï¼Ÿäºæ˜¯å¼€å§‹å­¦çº¿æ®µæ ‘åˆå¹¶ï¼Œå‘ç°ä¸æ˜¯å¾ˆéš¾ã€‚ä¸­é€”æ€è€ƒäº†ä¸€ä¸‹çº¿æ®µæ ‘åˆå¹¶çš„æœ¬è´¨ï¼Œå‘ç°è¿™ä¸œè¥¿ä¸æ˜¯å¾ˆéš¾ï¼Œäºæ˜¯å°±ç–¯ç‹‚å†™æ¿å­ã€‚å¹¶ä¸”ç”±äºå¤æ‚åº¦æ˜¯å‡æ‘Šçš„ï¼Œæ‰€ä»¥æ²¡æœ‰ä»€ä¹ˆå¾ˆåˆ›æ–°çš„ç©æ³•ï¼ˆæ¯”å¦‚æŒ‰ç§©åˆå¹¶è¿™ç§ï¼‰ã€‚</p>
<p>æˆåŠŸåœ°æ··è¿›äº†èƒœåˆ©ä¸€ä¸­çš„ç¾¤ï¼Œæœ‰ç§æ‰¾åˆ°ç»„ç»‡çš„å–œæ‚¦ã€‚ä¸è¿‡ä¸ºå•¥æˆ‘é‚£ä¹ˆå–œæ¬¢æ°´ç¾¤å•ŠQAQ</p>
<p>æ™šä¸Šåœ¨pojå†™äº†ä¸€é“æ±‚æ¡¥çš„é¢˜ï¼Œè°ƒäº†å¥½åŠå¤©å‘ç°è‡ªå·±ååˆ†å¼Ÿå¼Ÿåœ°å†™é”™äº†ã€‚ä¹‹åè¢«zayæ‹‰ç€è°ˆæ„Ÿæƒ…â€¦å¯æ€•</p>
<p>ç°åœ¨ä¸çŸ¥é“ä¸ºå•¥ååˆ†æƒ³å›å®¶ï¼Œæ„Ÿè§‰è‡ªå·±ä¸€å¤©å¤©çš„æ˜¯è¦é¢“æ­»åœ¨è¿™å„¿äº†QAQ</p>
<h3 id="1-5"><a href="#1-5" class="headerlink" title="1.5"></a>1.5</h3><p>ä¸Šåˆå°è¯•å»åšäº†ä¸€ä¸‹SPOJçš„ä¸‰é“Min25çš„é¢˜ç›®ï¼Œç„¶åå°±å¼€å§‹å†™åšå®¢ï¼Œè§‰å¾—è‡ªå·±æ•ˆç‡å¾ˆé«˜â€¦â€¦</p>
<p>å…¶ä¸­ç©¿æ’äº†ä¸€ä¸ªæƒ…èŠ‚ï¼Œå°±æ˜¯å†™ç€å†™ç€é¢˜çªç„¶æ„Ÿè§‰è‡ªå·±åˆä¸ä¼šMin25äº†ï¼Œäºæ˜¯å»uojç¾¤é‡Œä¸¢äººï¼Œç»“æœæˆ‘å‡­å€Ÿæˆ‘ç²¾æ¹›çš„æé—®æŠ€å·§è®©å¤§å®¶éƒ½ä¸çŸ¥é“æˆ‘åœ¨è¯´ä»€ä¹ˆï¼Œäºæ˜¯ç¾¤å°±å¾ˆå†·ï¼Œäºæ˜¯æˆ‘å°±å¼€å§‹ç–¯ç‹‚åœ°ã€Œã™ã¿ã¾ã›ã‚“ã€ï¼Œåœºé¢ä¸€åº¦ååˆ†å°´å°¬â€¦</p>
<p>äºæ˜¯å†³å®šä»¥åè¿˜æ˜¯ç‹¬ç«‹æ€è€ƒé—®é¢˜å¥½äº†.jpg</p>
<p>ç„¶åä¸‹åˆä¸å‡ºæ„å¤–åœ°å¼€å§‹é¢“äº†èµ·æ¥ã€‚ä¸´åƒé¥­æ—¶å»æ‹¿äº†zayå¯„æ¥çš„Luoguç½‘æ ¡æ•™æï¼Œçœ‹äº†çœ‹ç¡®å®æŒºå¥½ï¼Œäºæ˜¯ç»™é‡‘å“¥æ¨èäº†ä¸€ä¸‹ï¼Œä½œä¸ºå°ç­çš„æ•™æã€‚ç„¶è€Œé‡‘å“¥ã€ŒæŒºå¥½ã€äº†ä¸€å¥ä¹‹åï¼Œå°±æŠŠæ•™æè¿˜ç»™æˆ‘äº†233.</p>
<p>æ— è®ºæ€æ ·ï¼Œzayæ¬ æˆ‘ä¸€æ¯å¯ä¹äº†å˜å˜å˜å˜ã€‚ç„¶è€Œè‡ªå·±çš„ä½“æ£€ç»“æœï¼Œä½“å†…å°¿ç´ å«é‡è¿‡é«˜ï¼Œæ‰€ä»¥æš‚æ—¶ä¸èƒ½å–å¯ä¹ï¼Œsad</p>
<p>æ™šä¸Šå†³å®šçœ‹çœ‹æç…œä¸œçš„ä¹¦ï¼ŒæŒ‘äº†é“ç‚¹åŒçš„é¢˜ç›®å¼€å§‹å†™ï¼Œç„¶åå†™è‡ªé—­äº†ã€‚æœ€åå‘ç°è‡ªå·±æŠŠ <code>while</code> æ¢æˆ <code>do_while</code> å°±è¿‡äº†ï¼Œäºæ˜¯å»é—®zayã€‚æœ€åå‘ç°æ˜¯æˆ‘ä¸¤åˆ†ä»£ç é™¤äº†è¿™éƒ¨åˆ†ï¼Œå…¶ä½™çš„å¹¶ä¸ä¸¥æ ¼ç›¸åŒï¼Œæ¯”å¦‚è¯´æˆ‘å¿˜äº†æ¸…ç©ºâ€¦â€¦ç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚</p>
<p>æ™šä¸Šé‡‘å“¥å±…ç„¶æ‰˜rqyç»™zayè¯´ï¼š</p>
<p><img src="4.png" alt></p>
<p>æˆ‘åªèƒ½233äº†ã€‚</p>
<h3 id="1-4"><a href="#1-4" class="headerlink" title="1.4"></a>1.4</h3><p>ä»Šå¤©å†³å®šæœ‰å¿ƒåŠ²ä¸€ç‚¹ï¼Œç»“æœåœ¨æœºæˆ¿ä» $7ï¼š30$ ç¡åˆ° $8:30$â€¦â€¦å¯æµ·æ˜Ÿ</p>
<p>å—¯ï¼Œå…¶å®æ˜¯åœ¨å­¦ Min_25ç­›ï¼Œå­¦äº†ä¸€ä¸Šåˆä¹Ÿæ²¡å¤ªæ•´æ˜ç™½ï¼Œå°±æ¯”ç€é¢˜è§£å†™äº†å†™æ¿å­ï¼Œæ„Ÿè§‰ä¸å¤ªå¥½ï¼Œé‚£ç§å›«å›µåæ£çš„æ„Ÿè§‰åˆæ¶Œäº†ä¸Šæ¥ã€‚ä¸è¿‡å¤§è‡´æ˜¯æ‡‚äº†ï¼Ÿ</p>
<p>ä¸‹åˆç»§ç»­Min25ï¼Œé¡ºä¾¿å†™äº†ä¸€ä¸‹ç¬”è®°ã€‚åœ¨çœ‹è¿‡å¤§å¤šæ•°äººè®©äººè¿·æƒ‘çš„blogä¹‹åï¼Œå‘ç°HN-001ç¥ä»™ <code>xzz</code> è®²çš„æœ€æ¸…æ¥šæ˜ç™½ã€‚äºæ˜¯æŠŠå¤§éƒ¨åˆ†çŸ¥è¯†ç‚¹ç»™æ‰£æ¸…æ¥šäº†ï¼Œå‰©ä¸‹çš„å°å—å¯èƒ½è¿˜éœ€è¦ç»§ç»­è¿½ç´¢ã€‚</p>
<p>æ™šä¸Šä¸çŸ¥é“ä¸ºå•¥å¼€å§‹ä¸€ç›´çœ‹ã€Šå·¨äººã€‹ï¼Œä» $90+$ ä¸€ç›´çœ‹åˆ°äº† $123$ è¯ï¼ŒæœŸé—´ç”¨ $\rm Min25$ è¿‡æ‰äº†æœæ•™ç­›çš„æ¿æ¿ï¼Œè§‰å¾—è‡ªå·±å•¥éƒ½ä¸ä¼šæ™ºéšœçš„å¾ˆã€‚</p>
<p>ä¸è¿‡å¥½åœ¨å·¨äººå¿«çœ‹å®Œäº†ï¼Ÿè¯´å®è¯æˆ‘ã€Šå·¨äººã€‹çœ‹çš„æ²¡æœ‰å½“å¹´è¡¥ã€Šæµ·è´¼ã€‹çœ‹çš„è¯¦ç»†ï¼Œå› ä¸ºã€Šæµ·è´¼ã€‹æ˜¯æˆ‘å»ä¸€æœ¬ä¸€æœ¬ä¹°çš„å•è¡Œæœ¬ï¼Œè®¸å¤šæœ¬åå¤çœ‹äº†å¥½å¤šéï¼Œè€Œå·¨äººç”šè‡³è¿æ¯”è¾ƒé•¿çš„å¯¹ç™½éƒ½è·³è¿‡äº†ã€‚åŠ ä¸Šä½œè€…è¯¡å¼‚çš„ç´§å‡‘çš„ç”»é£å¯¼è‡´è§‚æ„Ÿæå·®ã€‚</p>
<p>ä¸è¿‡è¦è¯´å‰§æƒ…ï¼Œæˆ‘æ¯”è¾ƒæ·±çš„æ„Ÿè§‰å°±æ˜¯ï¼Œè‰¾ä¼¦å’Œä¸‰çˆ·ï¼Œä»¥åŠä»–çš„å°ä¼™ä¼´ä»¬éƒ½å›ä¸åˆ°åŸæ¥äº†ã€‚ä»ä»€ä¹ˆæ—¶å€™å¼€å§‹çš„å‘¢ï¼Ÿå¤§æ¦‚æ˜¯ä»é©¬è±å¯¹è‰¾å°”è¿ªäºšäººæ´¾å‡ºé‚£å››ä¸ªæ™ºæ…§å·¨äººå¼€å§‹çš„å§ï¼Œå®¶ä¸å®¶çŸ£ï¼Œå›½ä¸å›½çŸ£ã€‚ä½†æ˜¯ä½ èƒ½è¯´å‡ºåˆ°åº•æ˜¯è°é”™äº†å—ï¼Ÿæ¯ä¸ªäººéƒ½åšæŒç€è‡ªå·±å¿ƒä¸­çš„æ­£ä¹‰è€Œå·²å§â€¦â€¦</p>
<p>æ„Ÿè§‰å·¨äººçš„æ€æƒ³å†…æ ¸è¿˜æ˜¯å¾ˆç°å®çš„ï¼Œå†åŠ ä¸Šä½œè€…æ²¡æœ‰å°¾ç”°é‚£ç§æµªæ¼«ä¸»ä¹‰æƒ…æ€€â€”â€”æ¯•ç«Ÿè¯´åˆ°åº•ï¼Œæµ·è´¼å’Œå·¨äººçš„æ€æƒ³å†…æ ¸éƒ½å¾ˆæ²‰é‡ï¼Œæ¢ç´¢çš„äººæ€§ä¹Ÿå¾ˆå¤æ‚ï¼Œä½†æ˜¯å°¾ç”°å´èƒ½æŠŠæµ·è´¼ç”»çš„å¾ˆæµªæ¼«ã€‚æ¯æ¬¡ç»“æŸæˆ˜æ–—éƒ½è¦åº†ç¥ï¼Œéƒ½ä¼šçœ‹åˆ°ç¬‘å®¹ã€‚æˆ‘æƒ³ï¼Œå…¶å®ä¸¤éƒ¨åŠ¨æ¼«éƒ½æ˜¯åœ¨è§£å‰–è¿™ä¸ªç¤¾ä¼šï¼Œä½†æ˜¯ä¸€ä¸ªæ˜¯ç¬‘ç€è§£å‰–ï¼Œä¸€ä¸ªæ˜¯å“­ç€è§£å‰–å§ã€‚</p>
<p>æœ€è¿‘æ„Ÿè§‰å¾ˆå›°ã€‚å¬è¯´ä¸‹å‘¨äºŒå‘¨ä¸‰ç”±äºé«˜è€ƒå¬åŠ›å è€ƒåœºï¼Œæ‰€ä»¥æ”¾å‡ã€‚ä¸çŸ¥é“æˆ‘ä»¬æ”¾ä¸æ”¾ã€‚ä½†æˆ‘è§‰å¾—ä¸æ”¾çš„å¯èƒ½æ€§æ›´å¤§å§â€¦</p>
<h3 id="1-3"><a href="#1-3" class="headerlink" title="1.3"></a>1.3</h3><p>ä»Šå¤©å‡†å¤‡å­¦æœ€çŸ­è·¯æ ‘ï¼Œä½†æ˜¯ä¸­é€”ç©¿æ’ç€ä¸€ç›´åœ¨çœ‹ã€Šè¿›å‡»çš„å·¨äººã€‹ï¼Œæ‰€ä»¥æ•ˆç‡ä¸é«˜ã€‚</p>
<p>ç»“æœå‘ç°æœ€çŸ­è·¯æ ‘å…¶å®ä¸éš¾ï¼Œéš¾çš„æ˜¯æœ‰ä¸€å †ååˆ†è¯¡å¼‚çš„é¢˜ç›®â€¦æ¯”å¦‚éšæ‰‹å¥—ä¸ªç‚¹åˆ†æ²»ä¹‹ç±»çš„233</p>
<p>ç»“æœä¸‹åˆå°±è‡ªé—­äº†ï¼Œè‡ªé—­åœ¨ $\rm TJOI$ çš„ä¸€é“é¢˜ä¸Šï¼Œå¤§æ¦‚å°±æ˜¯æ¯æ¬¡è¯¢é—®åˆ ä¸€æ¡è¾¹ä¹‹å $\rm S\to T$ çš„æœ€çŸ­è·¯æ˜¯å¤šå°‘ï¼Œè¯¢é—®ä¹‹é—´ç‹¬ç«‹ã€‚çœ‹é¢˜è§£çœ‹äº†å¥½ä¹…ä¹Ÿæ²¡æ•´æ˜ç™½â€¦èœæ­»æˆ‘ç®—äº†ã€‚</p>
<p>ç„¶åä¸‹åˆæ˜ç™½ä¹‹åæ™šä¸Šå°±å†™å•Šï¼Œå†™äº†å¥½ä¹…æ‰å†™å¯¹ã€‚ç„¶åå°±è’™é€¼äº†ã€‚</p>
<p>ä¸çŸ¥é“ä»€ä¹ˆï¼Œæ„Ÿè§‰æœ€è¿‘ä¸æ˜¯é‚£ä¹ˆæœ‰å¿ƒåŠ²äº†â€¦å¯èƒ½æ˜¯åœè¯¾å¿…ç»çš„ä¸€ä¸ªé˜¶æ®µå§ï¼Ÿæˆ‘ä¸æ˜¯å¾ˆæƒ³æŠŠè¿™ä¸ªå½“åšè‡ªå·±åœ¨ä¸€æ®µå‘å¾®çš„æ„Ÿæƒ…ä¸­å—æŒ«çš„å‰¯äº§ç‰©ï¼Œé‚£ä¹Ÿå¤ªæƒ¨äº†å§ï¼Ÿ</p>
<p>ä¸è¿‡å¾ˆè‡ªé—­å°±æ˜¯äº†â€¦â€¦</p>
<p>æˆ‘ä¸€ç›´åœ¨æƒ³ï¼Œæˆ–è®¸æˆ‘å°±æ˜¯å› ä¸ºä¸å–œæ¬¢æ–‡åŒ–è¯¾æ‰å­¦çš„å¥¥èµ›å§ï¼Ÿä»ç†æ™ºè¿˜æ˜¯ä»æƒ…æ„Ÿä¸Šæ¥è¯´ï¼Œæˆ‘éƒ½æ›´åº”è¯¥å»å­¦æ–‡åŒ–è¯¾ã€‚æ‰€ä»¥ï¼Œæˆ‘åœ¨åšä»€ä¹ˆå‘¢ï¼ŸçœŸçš„æ˜¯åœ¨è¿½æ¢¦å—ï¼Ÿæ¯å¤©å°±è¿™ä¹ˆä½ä¸‹çš„å­¦ä¹ ç´§å¼ åº¦èƒ½åšæˆä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>æˆ‘æ‰¾äº†å¥½ä¹…ï¼Œæœ¬æ¥ä»¥ä¸ºæ‰¾åˆ°äº†è‡ªå·±çš„è·¯ï¼Œåæ¥æ‰å‘ç°åŸæ¥è‡ªå·±åªæ˜¯å…œäº†ä¸ªå¤§åœˆï¼Œåˆå›åˆ°åŸåœ°äº†è€Œå·²ã€‚</p>
<h3 id="1-2"><a href="#1-2" class="headerlink" title="1.2"></a>1.2</h3><p>â€¦ä¸Šåˆå†™å®Œé¸½äº†çš„é¢˜è§£ï¼Œç„¶åå‡ ä¹å•¥éƒ½æ²¡å¹²â€¦â€¦åŸå› æ˜¯æœ¬æ¥æ‰“ç®—å­¦æ•´ä½“äºŒåˆ†ï¼Œç»“æœçœ‹åˆ°åŠ¨æ€å›¾è¿é€šæ€§è¿™ä¸œè¥¿è§‰å¾—å¯ä»¥å­¦ä¸€ä¸‹ï¼Œå°±å»å­¦äº†å­¦ETTâ€”â€”ç„¶è€Œå…¶å®å°±æ˜¯å¤§ç•¥åœ°çœ‹äº†é‚£ä¹ˆå‡ çœ¼ï¼Œæ˜ç™½åŸç†å°±ä¸çœ‹äº†ï¼Œå›è¿‡å¤´æ¥å‘ç°è¿™ä¸œè¥¿å¥½åƒä¸æ˜¯ç»™æ­£å¸¸äººå†™çš„â€¦â€¦å¹¶ä¸”è·‘çš„ä¼¼ä¹ä¹Ÿæ²¡æœ‰æš´åŠ›å¿«â€¦â€¦äºæ˜¯å°±åˆå›å»å­¦æ•´ä½“äºŒåˆ†äº†ã€‚</p>
<p>äºæ˜¯å°±äºŒåˆ†äº†ä¸€ä¸‹åˆï¼Œæˆ‘æ˜¯æ†¨æ†¨ã€‚</p>
<p>æ™šä¸Šæœ¬æ¥æ‰“ç®—å¾ˆæœ‰å¿ƒåŠ²ï¼Œç»“æœçœ‹èµ·äº†ã€Šè¿›å‡»çš„å·¨äººã€‹ï¼Œæœ€ç»ˆæ¼«ç”»ä» $55$ è¯çœ‹åˆ°äº†ç¬¬ $70$ è¯ã€‚æœ¬æ¥å¯ä»¥çœ‹æ›´å¤šï¼Œä½†æ˜¯ä¸­é€”æœ‰ <code>slyz</code> çš„ç¥ä»™ç»„å›¢æ¥ç²¾ï¼ˆæ•™ï¼‰å‡†ï¼ˆæˆ‘ï¼‰æ‰¶ï¼ˆåšï¼‰è´«ï¼ˆäººï¼‰ï¼Œæ¯”å¦‚æˆ‘è¢«æ€’æ–¥ï¼š</p>
<p><img src="1.png" alt></p>
<p>ç„¶åå°±ä¸æ•¢é¢“äº†ï¼Œå°±å»åšé¢˜äº†â€¦</p>
<p>ç»“æœå†™äº†ä¸ªæ•´ä½“äºŒåˆ†å¥—æ ‘å‰–çš„é¢˜ï¼Œä¸´èµ°ä¹Ÿåªæ‹¿äº† $10$ åˆ†ï¼Œæ•´ä¸ªäººéƒ½ä¸å¥½äº†â€¦â€¦</p>
<p>ä¸è¿‡è¿˜æ˜¯å¾ˆå¼€å¿ƒçš„ï¼Œæˆ‘ä¹Ÿæ˜¯æœ‰å°ä¼™ä¼´çš„äººäº†ï¼ˆåš£å¼ .ymlï¼‰</p>
<p>ç„¶åä¸‹åˆå‘ç°äº†ä¸€ä¸ªå¾ˆç§€çš„è¡¨æƒ…ï¼š</p>
<p><img src="2.gif" alt></p>
<p>æ„Ÿè§‰æ•´ä¸ªäººéƒ½æœ‹å…‹èµ·æ¥äº†233</p>
<h3 id="1-1"><a href="#1-1" class="headerlink" title="1.1"></a>1.1</h3><p>é¢“äº†ä¸€å¤©ï¼Œä¸‹åˆå°±è¿”æ ¡äº†ã€‚ä¸Šåˆä¸»è¦æ˜¯çœ‹äº†çœ‹Bç«™è·¨å¹´çš„å›æ”¾ã€‚â‘§è¯´äº†ï¼Œé‚“ç´«æ£‹å¤©ä¸‹ç¬¬ä¸€ï¼ˆ</p>
<p>æ™šä¸Šçªç„¶å¾ˆéš¾å—ã€‚è¿˜æ˜¯å…³äºå¦¹å­çš„äº‹ï¼Œå¯èƒ½æˆ‘çœŸçš„éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½ç¼“è¿‡æ¥å§ï¼Ÿæ„Ÿè§‰è‡ªå·±çš„ç¥ç¦ï¼Œæ¯ä¸€å¥è¯ã€æ¯ä¸€ä¸ªå­—éƒ½åœ¨ç—›å‡»è‡ªå·±çš„å¿ƒã€‚ä½†æ˜¯æˆ‘èƒ½æ€ä¹ˆæ ·å‘¢ï¼Ÿæˆ‘åˆèƒ½æ€ä¹ˆæ ·å‘¢ï¼Ÿ</p>
<p>åˆæ˜¯CSPè€ƒå®Œé‚£ç§æ— åŠ›æ„Ÿï¼šå°±è¿™æ ·äº†å—ï¼Ÿå°±è¿™æ ·äº†å§ã€‚</p>
<p>ä¸€ä¸ªäººçš„å¥¥èµ›å®¤ï¼Œå­¤ç‹¬åˆ°è®©æˆ‘æƒ³å“­ã€‚æ˜¯å•Šï¼Œä»¥åå°±å†ä¹Ÿä¸èƒ½å»æ‰¾å¦¹å­è¯´æœ€è¿‘è‡ªå·±å¿ƒæ€å´©äº†æ±‚å®‰æ…°ä¹‹ç±»çš„è¯äº†ï¼Œä¹Ÿå¿…é¡»è¦æé»‘é‚£é“è‹¥æœ‰è‹¥æ— çš„ç•Œé™äº†ï¼Œæ„Ÿè§‰ç”Ÿæ´»å°‘äº†ç‚¹ä»€ä¹ˆã€‚</p>
<p>ä½†æ€»ä¹‹ï¼Œæ˜¯ä¸€ä¸ªæ–°çš„å¼€å§‹ä¸æ˜¯å—ï¼Ÿ</p>
<p>æ˜å¤©å¯è¿˜è¦ç»§ç»­å•Šã€‚</p>
<p>å–‚å–‚ï¼Œpksï¼Œæˆ‘ä»¬å¯æ˜¯èˆå°ä¸Šçš„æˆ˜å£«å•Šï¼Œæ€ä¹ˆèƒ½è¿™ä¹ˆæ—©å°±è°¢å¹•å‘¢ï¼Ÿ</p>
<blockquote>
<p>ã€Šä½ çš„ç­”æ¡ˆã€‹_by é˜¿å†—_</p>
<p>ä¹Ÿè®¸ä¸–ç•Œå°±è¿™æ ·<br>æˆ‘ä¹Ÿè¿˜åœ¨è·¯ä¸Š<br>æ²¡æœ‰äººèƒ½è¯‰è¯´<br>ä¹Ÿè®¸æˆ‘åªèƒ½æ²‰é»˜<br>çœ¼æ³ªæ¹¿æ¶¦çœ¼çœ¶<br>å¯åˆä¸ç”˜æ‡¦å¼±<br>ä½ç€å¤´ æœŸå¾…ç™½æ˜¼<br>æ¥å—æ‰€æœ‰çš„å˜²è®½<br>å‘ç€é£ æ‹¥æŠ±å½©è™¹<br>å‹‡æ•¢çš„å‘å‰èµ°<br>é»æ˜çš„é‚£é“å…‰<br>ä¼šè¶Šè¿‡é»‘æš—<br>æ‰“ç ´ä¸€åˆ‡ææƒ§æˆ‘èƒ½<br>æ‰¾åˆ°ç­”æ¡ˆ<br>å“ªæ€•è¦é€†ç€å…‰<br>å°±é©±æ•£é»‘æš—<br>ä¸¢å¼ƒæ‰€æœ‰çš„è´Ÿæ‹…<br>ä¸å†å­¤å•<br>ä¸å†å­¤å•<br>ä¸å†å­¤å•</p>
</blockquote>
<h3 id="Goodbye-2019"><a href="#Goodbye-2019" class="headerlink" title="Goodbye 2019"></a>Goodbye 2019</h3><blockquote>
<p>åˆæ˜¯ä¸€å¹´å•Šã€‚ </p>
<p>è¿™ä¸€å¹´é‡Œï¼Œæˆ‘å¤±å»äº†å¾ˆå¤šï¼Œä¹Ÿè·å¾—äº†ä¸å°‘ï¼›çœ‹æ¸…äº†å¾ˆå¤šï¼Œä¹Ÿè¿·èŒ«äº†ä¸å°‘ã€‚æ¯ä¸€æ¬¡ç›¸é‡ï¼Œæ¯ä¸€æ¬¡ç¦»åˆ«éƒ½å€¼å¾—å›å¿†ï¼›æ¯ä¸€ä»½é«˜å…´ï¼Œæ¯ä¸€åˆ†å¿§ä¼¤ä¹Ÿéƒ½å€¼å¾—æˆ‘å¸¦åˆ°æœªæ¥ã€‚</p>
<p>å¯¹äº2019ï¼Œã€Œè®©å®ƒå¥½å¥½åœ°æ¥ï¼Œè®©å®ƒå¥½å¥½åœ°å»ã€ï¼Œæˆ‘æ›´å–œæ¬¢è¿™ä¹ˆæ¥å½¢å®¹ã€‚</p>
<p>æ˜å¹´æœ‰ä»€ä¹ˆå¿ƒæ„¿å‘¢ï¼Ÿç”Ÿè€Œä¸ºäººï¼Œæ¡ç´§å¾ˆç®€å•ï¼Œä½†æ˜¯æ”¾ä¸‹å´å¾ˆéš¾ã€‚ç„¶è€Œæ¡å¾—è¶Šç´§è¶Šå‘ç°åŸæ¥æ²¡æœ‰æ¡ä½ï¼Œçœ‹å¾—è¶Šé‡è¶Šå‘ç°è‡ªå·±æ‰‘äº†ä¸ªç©ºã€‚æ‰€ä»¥ï¼Œæˆ‘å¸Œæœ›ï¼Œæˆ‘å¯ä»¥ä¸€è§‰é†’æ¥å‘ç°è‡ªå·±ä»€ä¹ˆéƒ½ä¸è®°å¾—ï¼Œè¿™æ ·æ‰å¯ä»¥æ”¾ä¸‹ä¹‹å‰çš„æ‰€æœ‰ï¼Œå¤§è¸æ­¥å¾—èµ°å‘æ˜å¤©ã€‚2020ï¼Œè¯·è®©æˆ‘å˜å¾—æ›´é‡Šç„¶ä¸€äº›å§ï¼Œå¥½å—ï¼Ÿ </p>
<p>æ€»ä¹‹å‘¢ï¼Œè°¢è°¢å„ä½ä¸€å¹´çš„é™ªä¼´ã€‚</p>
<p>2020ï¼Œè¿™ä¸ªä¸–ç•Œï¼Œä¸æˆ‘é‡æ–°æ¥è¿‡å§ã€‚</p>
</blockquote>
<h3 id="12-31"><a href="#12-31" class="headerlink" title="12.31"></a>12.31</h3><p>ä»Šå¤©æ—©ä¸Šå¾ˆé«˜å…´åœ°åœ¨æ—©è¯»ç»™å¦¹å­å†™å®Œæ–°å¹´å¿«ä¹çš„æ˜ä¿¡ç‰‡+ä¿¡ï¼Œè®©éš”å£ç­åŒå­¦å½“ä¿¡ä½¿ç»™é€å»ã€‚å¬ä»–è¯´äº†ä¸‹æœ€è¿‘éš”å£ç­çš„å…«å¦ï¼Œå‘ç°ä»¥å‰è§‰å¾—ä¼šå®å®ˆå¾ˆä¹…çš„æƒ…ä¾£ä¸åœ¨äº†ï¼Œä»¥å‰è§‰å¾—æ ¹æœ¬ä¸æ­çš„ä¸¤ä¸ªäººåœ¨ä¸€èµ·äº†ã€‚æ„Ÿè§‰å’Œä»–ä»¬åŒç­çš„æ—¥å­å·²ç»è¿œå»å¾ˆä¹…äº†ã€‚</p>
<p>é¡ºä¾¿çŸ¥é“äº†åŸæ¥å–œæ¬¢çš„å¦¹å­å·²ç»æœ‰äº†ç”·ç¥¨ï¼Œäºæ˜¯æ‰“ç®—æŠŠå†™å¥½çš„ä¸œè¥¿æ‰”è¿›åƒåœ¾æ¡¶ã€‚åœ¨ä¿¡ä½¿è€é¸½çš„åŠè¯´ä¸‹è¿˜æ˜¯æ²¡æ‰”ï¼Œè¿˜æ˜¯é€äº†å‡ºå»ã€‚æœ€åæ„Ÿè§‰æœ‰ç‚¹æƒ†æ€…ã€‚ä»åˆä¸­åˆ°ç°åœ¨ï¼Œè‡ªå·±ä¼¼ä¹ä¸€ç›´åœ¨è¶Ÿåˆ«äººçš„æµ‘æ°´ï¼Œæ„Ÿè§‰è‡ªå·±ä¼¼ä¹è·Ÿä»–ä»¬æ—©å°±ä¸æ˜¯ä¸€ä¸ªä¸–ç•Œçš„äººäº†ã€‚</p>
<p>æ˜¯å•Šï¼Œä¸æ˜¯ä¸€ä¸ªä¸–ç•Œçš„äººäº†ã€‚å¯èƒ½æˆ‘çœŸçš„éœ€è¦ç ´é™¤ã€æˆ‘æ‰§ã€äº†å§ï¼Œä¸æƒ³å†å»çº ç»“è¿™äº›æ²¡å¤´æ²¡è„‘çš„å›ºæ‰§äº†ã€‚äºæ˜¯è¶ç€å¤œå¹•è¿˜æ²¡è¢«æ‹½èµ°ï¼Œä¾¿åŒ†åŒ†æ¥åˆ°äº†å¥¥èµ›å®¤ã€‚</p>
<hr>
<p>å†·é™æ€è€ƒäº†æ€è€ƒï¼Œå‘ç°è‡ªå·±ä¸€æ—¦å¯¹ä»€ä¹ˆä¸œè¥¿æœ‰äº†åŒæ¶æ„Ÿå°±å¾ˆéš¾å†å–œæ¬¢ä¸Šäº†ã€‚æ‰€ä»¥çœŸæ­£å¯¹çš„é‚£ä¸ªäººåº”è¯¥è¿˜æ²¡æ¥å§ï¼Œæˆ‘éœ€è¦ç»§ç»­ç­‰ä¸‹å»ã€‚å—¯ï¼Œä»å°çˆ¶æ¯å°±æ•™å¯¼ï¼Œèµ°ä¸¢çš„æ—¶å€™åŸåœ°ç­‰ç€æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚æ‰€ä»¥ä¹Ÿåªæœ‰ç­‰å¾…ï¼Œæ‰æ˜¯è¿æ¥å…‰æ˜çš„æœ€å¥½åŠæ³•å§ã€‚</p>
<hr>
<p>ç„¶åæ™šä¸Šå¥¹ç”¨å¥¹é—ºèœœçš„ qq ç»™æˆ‘å‘ä¿¡æ¯ã€‚ä¸çŸ¥é“ä¸ºå•¥ã€‚å¥¹è¯´å¥¹æœ¬æ¥ä»¥ä¸ºæˆ‘ä»Šå¤©ä¸‹åˆä¼šåœ¨ç­é‡Œçœ‹ç”µå½±ï¼ˆå› ä¸ºæˆ‘ä»¬ç­å¥¥èµ›é€€å½¹é€‰æ‰‹åœ¨å…¶å®ƒç­è”æ¬¢çš„æ—¶å€™ï¼Œåœ¨ç­é‡Œçœ‹ç”µå½±ï¼‰ï¼Œç„¶è€Œå®é™…ä¸Šæˆ‘åœ¨å¥¥èµ›å®¤çœ‹äº†ä¸€ä¸‹åˆçš„ã€Šè¿›å‡»çš„å·¨äººã€‹ï¼ˆ233ã€‚æ‰€ä»¥å¥¹å°±ç»™æˆ‘æ‹è¿‡æ¥ä¸€å¼ ç…§ç‰‡ï¼š</p>
<p><img src="hello.jpg" alt></p>
<p>ã€‚ã€‚ã€‚é‚£ä¸ªâ€œå¼„å¾—æˆ‘å¾ˆæ€‚â€çš„ä¸Šæ–‡æ˜¯æˆ‘é—®å¥¹è¯´æ¯æ¬¡è·Ÿå¥¹å¶ç„¶é‡è§å¥¹ä¸ºå•¥éƒ½æ•…æ„ä¸çœ‹æˆ‘233</p>
<p>ç„¶åäº‹æƒ…æ˜¯è¿™ä¹ˆå‘å±•çš„ï¼š</p>
<blockquote>
<p>å¥¹ï¼šè¿˜æœ‰ä¸€ä»¶ä¿¡æ¯é‡æ¯”è¾ƒå¤§çš„äº‹æƒ…</p>
<p>å¥¹ï¼šæˆ‘è„±å•äº†</p>
</blockquote>
<p>å•Šã€‚</p>
<p>ä¸‹åˆæ—¶ä¸€ç›´åœ¨æƒ³ï¼Œå¦‚æœå¥¹å…¶å®å’Œé‚£ä¸ªç”·ç”Ÿè¿˜æ²¡çœŸæ­£ç¡®å®šçš„è¯ï¼Œæˆ‘å»â€œå…´å¸ˆé—®ç½ªâ€æ˜¯ä¸æ˜¯æœ‰ç‚¹ä¸å¤ªå¥½ï¼Ÿ</p>
<p>å¥½åœ¨äº‹æ€çš„å‘å±•æ²¡è®©æˆ‘é‚£ä¹ˆå°´å°¬â€¦â€¦</p>
<p>æˆ‘å½“æ—¶ä¼¼ä¹ï¼Œä¼¼ä¹æ˜¯ï¼Œæ€è€ƒäº†ä¸€ç¬é—´ï¼Œå°±å·²ç»çŸ¥é“è¯¥æ€ä¹ˆå›å¥¹äº†ã€‚é‚£äº›â€œä¸ºä»€ä¹ˆä½ æœ‰äº†ç”·æœ‹å‹è€Œä¸å‘Šè¯‰æˆ‘ï¼Ÿâ€å’Œâ€œæœ‰äº†ç”·æœ‹å‹ä¸ºä»€ä¹ˆè¿˜è¦ç»™åˆ«äººä»¥å¸Œæœ›â€ä¹‹ç±»çš„è¯ï¼Œå·²ç»è¢«æ‰”åˆ°äº†ä¸çŸ¥å¤„ã€‚</p>
<p><img src="3.png" alt></p>
<blockquote>
<p>é¢˜å¤–è¯ï¼š</p>
<p>â€¦â€¦å¯èƒ½å¤§å®¶éƒ½ä¸çŸ¥é“æˆ‘ä»¬åˆ°åº•æ˜¯ä»€ä¹ˆå…³ç³»ï¼Œå¤§æ¦‚å°±æ˜¯å¥¹çŸ¥é“æˆ‘ä¸€ç›´å–œæ¬¢å¥¹ä½†æ˜¯æˆ‘æ˜¯è¿™ä¹ˆä¸€ç§å¿ƒæ€ï¼š</p>
<blockquote>
<p>å–œæ¬¢ä¸ç­‰äºå æœ‰</p>
</blockquote>
<p>äºæ˜¯å’Œå¥¹å°±å˜æˆäº†å¥½æœ‹å‹ï¼Ÿèµ·ç åœ¨èŠå¤©è½¯ä»¶é‡Œè¿˜æ˜¯å¾ˆé“çš„ï¼ˆ</p>
<p>è‡³äºå¥¹æ˜¯ä»€ä¹ˆäººï¼Œæˆ‘åªèƒ½è¯´æ˜¯å¾ˆå•çº¯ä¸€å¦¹å­â€¦â€¦å°±æ˜¯è·Ÿäººç”¨qqèŠå¤©è¿˜ç”¨ <code>ã€‚ã€‚ã€‚ã€‚</code> è¿™ä¸œè¥¿åšå‰åç¼€çš„äººï¼Œç°å¦‚ä»Šå‡ ä¹æ²¡æœ‰äº†å§ï¼Ÿ</p>
</blockquote>
<p>å—¯ï¼Œå°±è¿™æ ·äº†å—ï¼Ÿå°±è¿™æ ·äº†å§ã€‚</p>
<p>æ™šä¸Šçœ‹äº†çœ‹CèŒçš„ã€Šå¿ƒé­”ã€‹ï¼Œåˆ°æœ€åè™½ç„¶å¾ˆçˆ½ï¼Œä½†æ˜¯æ„Ÿè§‰å’Œã€Šé€ƒç”Ÿ2ã€‹å·®ä¸å¤šï¼Œçˆ½æ˜¯çˆ½äº†ï¼Œä½†æ˜¯æ²¡å•¥æ·±åº¦ã€‚</p>
<p>ç¡äº†ç¡äº†ã€‚</p>
<h3 id="12-30"><a href="#12-30" class="headerlink" title="12.30"></a>12.30</h3><p>æ˜¨æ™šä¸çŸ¥é“ä¸ºå•¥å®¿èˆé‡Œæœ‰ä¸€å †èšŠå­â€¦è®©äººå¾ˆéš¾è¿‡åœ°ä¸€ç‚¹å¤šæ‰ç¡ï¼Œäºæ˜¯ä»Šå¤©å°±å˜æˆäº†æ´»æ­»äººçŠ¶æ€ã€‚ä¸Šåˆçœ‹äº†çœ‹é«˜æ•°ï¼Œå‘ç°åˆ°ä¸€é˜¶å¾®åˆ†æ–¹ç¨‹é‚£é‡Œå…¬å¼å·²ç»ä¸æ˜¯äººè®°çš„äº†ï¼Œäºæ˜¯è§‰å¾—æ— èŠå°±ä¸å­¦äº†ã€‚ä¸‹åˆå’Œæ™šä¸Šåšäº†åš <code>vfk</code> æ›¾ç»å‡ºçš„æŸåœº <code>cf</code>ï¼Œå‰©ä¸‹çš„æ—¶é—´å­¦äº†å‘ç¬›å¡å°”æ ‘å°±å»é¢“äº†ã€‚</p>
<p>å‰å‡ å¤©çœ‹äº†æ¢æ–‡é“çš„ã€Šæˆ‘æ‰§ã€‹ï¼Œå‡ å¤©æ™šä¸Šæ–¹æ‰æ˜ç™½<code>æˆ‘æ‰§</code>çš„æ„æ€ï¼Œçªç„¶å¾ˆæœ‰æ„Ÿè§¦ã€‚ä»¥ä¸‹æ˜¯æ‘˜å½•ï¼Œè½¬è‡ª<a href="https://www.zhihu.com/question/20015896/answer/15644432" target="_blank" rel="noopener">é“¾æ¥</a>ï¼Œæœ‰åˆ æ”¹ï¼š</p>
<blockquote>
<p>ä½ çš„åå­—ä¸æ˜¯ä½ ï¼Œä½ çš„èŒä¸šä¸æ˜¯ä½ ï¼Œåœ¨å“ªé‡Œä¸Šç­çš„é‚£ä¸ªä¹Ÿä¸æ˜¯ä½ ï¼Œè¿™ä¸€åˆ‡æ˜¯ä½ çš„ç»éªŒï¼Œä½†ç»éªŒä¸æ˜¯ä½ æœ¬èº«ã€‚æˆ‘ä»¬ç»ç”±æˆ‘ä»¬ç”Ÿå‘½çš„å†…å®¹æ¥å®šä¹‰è‡ªå·±ï¼Œæˆ‘ä»¬çš„å¹´é¾„ã€å¥åº·ã€äººé™…å…³ç³»ã€è´¢åŠ¡çŠ¶å†µã€å·¥ä½œå’Œç”Ÿæ´»æƒ…å¢ƒä»¥åŠå¿ƒç†æƒ…ç»ªçŠ¶æ€ç­‰ç­‰ï¼Œä½†æ˜¯è¿™äº›æ˜¯ç»éªŒçš„å®¢ä½“ï¼Œè€Œä¸æ˜¯ä¸»ä½“ã€‚æˆ‘ä»¬çš„é”™è¯¯å°±æ˜¯ä¼šæŠŠè¿™äº›ç»éªŒå½“æˆæ˜¯æˆ‘ä»¬çš„ä¸»ä½“ï¼Œç„¶åä¸å®ƒä»¬è®¤åŒï¼ŒæŠŠå®ƒä»¬å½“æˆè‡ªæˆ‘çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>ä¸€è¨€ä»¥è”½ä¹‹ï¼šæˆ‘æ‰§å°±æ˜¯åœ¨å¤–åœ¨äº‹ç‰©ä¸Šæ‰€å»ºç«‹çš„é‚£ä¸ªè™šå‡çš„è‡ªæˆ‘æ„Ÿï¼ˆ è¿™é‡Œçš„å¤–åœ¨äº‹ç‰©è¿˜åŒ…æ‹¬ä½ çš„æƒ…ç»ªå’Œå¿µå¤´ï¼Œä¸‹é¢ä¼šç»†è°ˆ)ã€‚æ— è®ºä½ æ‰§ç€ä»€ä¹ˆï¼Œä½ å°±æ˜¯åœ¨æŠŠå®ƒå½“æˆè‡ªæˆ‘çš„ä¸€éƒ¨åˆ†ï¼Œè€Œé‚£ä¸ªä¸œè¥¿å°±æ˜¯ä½ ã€Œæˆ‘æ‰§ã€çš„ä½“ç°ã€‚åœ¨æ ¹æœ¬ä¸Šï¼Œå¹¶æ— ä¸€ä¸ªå®ä½“çš„ï¼Œä¸å˜çš„ã€Œæˆ‘ã€å­˜åœ¨ã€‚ä¹Ÿæ­£æ˜¯å› ä¸ºæˆ‘ä»¬æŠŠè‡ªæˆ‘æ„Ÿå»ºç«‹åœ¨è¿™äº›å¤–åœ¨çš„äº‹ç‰©ä¸Šï¼Œæ‰€ä»¥å½“å®ƒä»¬å˜åŒ–æ—¶ï¼Œæˆ‘ä»¬çš„ç—›è‹¦ä¾¿äº§ç”Ÿäº†ã€‚ä½†æ˜¯è¿™äº›äº‹ç‰©çš„å˜åŒ–æ˜¯ä¸å¯é¿å…çš„ï¼Œå› ä¸ºå®ƒä»¬çš„æœ¬è´¨ä¾¿æ˜¯ã€Œæ— å¸¸ã€ã€‚æ‰€ä»¥ï¼Œåªè¦ä½ æŠŠè‡ªæˆ‘æ„Ÿå»ºç«‹åœ¨å¤–åœ¨ç¨çºµå³é€çš„äº‹ç‰©ä¸Šï¼Œåˆ™æˆ‘ä»¬å¿ƒç†ä¸Šçš„ç—›è‹¦å°±ä¸å¯é¿å…ã€‚</p>
<p>æˆ‘ä»¬çš„æ‚²å“€æ˜¯ï¼Œæˆ‘ä»¬ç»ˆå…¶ä¸€ç”Ÿï¼Œéƒ½åªæ˜¯åœ¨ä¸ºè‡ªæˆ‘å¡«å……è¿™ä¸€ä¸ªä¸ªæ„è±¡ã€‚è´¢å¯Œï¼Œæƒä½ï¼ŒçŸ¥è¯†ï¼Œè¿˜æœ‰ä½ æ‰§ç€çš„ä»»ä½•ä¸œè¥¿ï¼Œå¦‚æœå®ƒæ²¡æœ‰ä¼¤å®³åˆ°ä»–äººï¼Œæˆ‘æƒ³è¿™äº›éƒ½æ˜¯å¥½ä¸œè¥¿ï¼Œä½†æ˜¯åªè¦ä½ æ²¡æœ‰è®¤æ¸…è¿™äº›ä¸œè¥¿å’Œä½ çš„æœ¬è´¨æ˜¯å®Œå…¨æ— å…³çš„ï¼Œåªè¦ä½ è¿˜åœ¨è¿™äº›äº‹ç‰©ä¸Šå»ºç«‹è®¤åŒæ„Ÿï¼Œé‚£ä½ æ‰€å¾—åˆ°çš„ä¸€åˆ‡ä¸è¿‡æ˜¯åŠ å¼ºæˆ‘æ‰§è€Œå·²ï¼Œè€Œå½“é‚£ä¸ªæ„è±¡ç ´ç­ï¼Œåˆ™ç—›è‹¦å°±å°†æ¥ä¸´ã€‚</p>
</blockquote>
<p>äºæ˜¯æ„Ÿè§‰ä¼¼ä¹ä½›æ•™ä¸æ˜¯å°è±¡é‡Œé‚£ç§ç„å­¦çš„å®—æ•™ï¼Œè€Œæ˜¯ä¸€å¥—ç§‘å­¦åŒ–ç†è®ºåŒ–çš„ä¸–ç•Œè§‚å’Œæ–¹æ³•è®ºã€‚</p>
<p>æˆ‘ä»€ä¹ˆæ—¶å€™æ‰èƒ½ã€Œçœ‹æƒ¯é£æ³¢é‡Œï¼Œé—²æ­¥çº¢å°˜å¤–ã€å‘¢ï¼Ÿ</p>
<h3 id="12-29"><a href="#12-29" class="headerlink" title="12.29"></a>12.29</h3><p>ä¸Šåˆè€ƒçš„æ•°å­¦å’Œè‹±è¯­ï¼Œä¸‹åˆè€ƒçš„è¯­æ–‡ï¼ŒæˆåŠŸè¦åˆ°äº†è®°å¿†ä¸­ä¸Šä¸€æ¬¡åˆæ ¼è€ƒè·Ÿæˆ‘ä¸€ä¸ªè€ƒåœºã€è¿™æ¬¡ä¹Ÿä¸€ä¸ªè€ƒåœºçš„å¯çˆ±å¦¹å­çš„QQã€‚æ„Ÿè§‰åˆ°è¾¾äº†äººç”Ÿå·…å³°ã€‚</p>
<p>ç„¶åæ™šä¸Šå›æ¥å­¦äº†å­¦æ”¯é…æ ‘ï¼Œå‘ç°æœ‰ç¥ä»™è¯´ç­ç»æ ‘å°±æ˜¯æ”¯é…æ ‘ï¼Œç„¶åå‘ç°è‡ªå·±è¿˜ä¸ä¼šç­ç»æ ‘ï¼Œç„¶åå°±å»åšç­ç»æ ‘äº†233</p>
<p>å•Šï¼Œç»ˆäºé©¬ä¸Šè¦æ”¾å‡äº†ï¼Œå¼€æ£®ã€‚</p>
<h3 id="12-28"><a href="#12-28" class="headerlink" title="12.28"></a>12.28</h3><p>ä¸Šåˆåœ¨å¥¥èµ›å®¤èƒŒæ”¿æ²»â€¦â€¦ä¸‹åˆè€ƒäº†æ”¿æ²»è§‰å¾—è‡ªå·±è¿˜å¯ä»¥ã€‚</p>
<p>æ™šä¸Šå°è¯•å†™äº†ä¸€ä¸‹ã€Œä¸€åŒæœ¨æ£‹ã€ï¼Œå‘ç° <code>alpha-beta</code> åªèƒ½å¹²å‡º $70pts$ æ¥ï¼Œç„¶åå°±å»é¢“äº†ã€‚</p>
<h3 id="12-27"><a href="#12-27" class="headerlink" title="12.27"></a>12.27</h3><p>æ²¡å•¥å¥½è®²çš„ï¼Œæ˜å¤©è¦åˆæ ¼è€ƒäº†ï¼Œåœ¨å‘æ„è‡ªå·±çš„æ”¿æ²»233</p>
<h3 id="12-26"><a href="#12-26" class="headerlink" title="12.26"></a>12.26</h3><p>ä¸Šåˆä¸‹åˆä¸€å…±åšäº†ä¸‰é“é¢˜ï¼Œä»æç…œä¸œçš„è“ä¹¦ä¸Šçœ‹æ¥çš„ã€‚ä¸­é€”å†™æŒ‚äº†å¥½å‡ æ¬¡ï¼Œä½†æ˜¯æœ€ç»ˆè°ƒå‡ºæ¥è¿˜æ˜¯æŒºæœ‰æˆå°±æ„Ÿçš„ã€‚</p>
<p>é¥­å¡ä¸¢äº†ï¼Œæœ‰ç‚¹éƒé—·ã€‚æ¯•ç«Ÿç”µè¯å¡å’Œé¥­å¡æ˜¯ä¸€å¼ å¡ï¼Œç”µè¯å¡ä¸¢äº†è¿˜è¦å»ç”µä¿¡è¥ä¸šå…è¡¥åŠã€‚ã€‚ã€‚å¤ªéº»çƒ¦äº†å§233</p>
<p>â€¦â€¦ç„¶åâ€¦â€¦ç„¶åå°±å› ä¸ºä¸€äº›å¥‡æ€ªçš„äº‹æƒ…é™·å…¥äº†å¥‡æ€ªçš„æ€è€ƒã€‚æ„Ÿè§‰è‡ªå·±æ­£åœ¨è¢«æ‹½è¿›å¥‡æ€ªçš„æ¼©æ¶¡ä¸­ï¼Œæ„Ÿè§‰è‡ªå·±ä¼¼ä¹å¦‚åŒã€Œå¥‡å¼‚äººç”Ÿã€é‡Œé¢ <code>Max</code> ç»å¸¸æ¢¦åˆ°çš„åœºæ™¯ï¼Œåœ¨é£æš´ä¹‹ä¸­ï¼Œè‡ªå·±åœ¨è¢«æ’•æ‰¯ç€æƒ³è¦ç™»ä¸Šç¯å¡”ã€‚å¯æƒœåªæœ‰æˆ‘ä¸€ä¸ªäººã€‚</p>
<p>çœ‹ç€ä¸€å †ä¸œè¥¿è¿˜æ²¡å­¦ï¼Œä¹Ÿä¸æ˜¯å¾ˆæƒ³å­¦ã€‚åå¤©è¿˜è¦è€ƒæ”¿æ²»ï¼Œä»€ä¹ˆéƒ½æ²¡èƒŒï¼Œæ„Ÿè§‰æœ‰ç‚¹ä¸å¤ªå¥½ã€‚</p>
<p>ä¼¼ä¹æˆ‘èµ°è¿·äº†è·¯ã€‚æˆ–è€…è¯´ï¼Œæˆ‘ç»å¸¸ä¼šèµ°è¿·äº†è·¯ã€‚é«˜ä¸­åˆ°ç°åœ¨ä¸ºæ­¢æˆ‘ä¸€ç›´åœ¨è¿½æ±‚ç€ä»€ä¹ˆï¼Œæ”¾å¼ƒäº†å¾ˆå¤šï¼Œä½†æ˜¯åˆ°ç°åœ¨æˆ‘ä¹Ÿä¸€ç›´ä¸çŸ¥é“æˆ‘åˆ°åº•åœ¨è¿½æ±‚äº›ä»€ä¹ˆã€‚æ˜¯å¥¥èµ›å—ï¼Ÿæˆ‘ææƒšäº†ã€‚æ˜¯åŠŸæˆåå°±å—ï¼Ÿæˆ‘ææƒšäº†ã€‚</p>
<p>æ„Ÿè§‰åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘åªæœ‰æ¯ä¸ªå­¦æœŸåˆšåˆšå¼€å§‹ï¼Œå³18å¹´9æœˆ $\sim$ 10æœˆå’Œä»Šå¹´çš„9æœˆ $\sim$ 10æœˆæœ‰è®¤çœŸå­¦è¿‡æ–‡åŒ–è¯¾ï¼Œå‰©ä¸‹çš„æ—¶é—´éƒ½åœ¨åˆ’æ°´ï¼›ç¾å…¶åæ›°å­¦ç ”ç©¶å¥¥èµ›ï¼Œå­¦æ¥çš„çº¿æ€§è§„åˆ’æˆ–è€… <code>HLPP</code> å¯èƒ½æ°¸è¿œä¹Ÿç”¨ä¸ä¸Šã€‚æˆ‘åœ¨å¹²ä»€ä¹ˆï¼Ÿå…¶ä»–äººä¸°å¯Œæœ‰è¶£ã€å€¼å¾—å›å¿†çš„é«˜ä¸­ç”Ÿæ´»ï¼Œåœ¨æˆ‘çœ¼é‡Œå°±æ˜¯ä¸€åœºåˆä¸€åœºçš„ç™½æ—¥æ¢¦ï¼Œä¸€æ¬¡åˆä¸€æ¬¡åœ°è·Œå€’å†çˆ¬èµ·æ¥å†æ¬ºéª—è‡ªå·±ï¼šä½ æ²¡è·Œå€’ã€‚è¿™ä¸€åˆ‡çš„ä¸€åˆ‡ï¼ŒçœŸæ˜¯æˆ‘æƒ³è¦çš„å—ï¼Ÿ</p>
<p>æˆ‘åˆåœ¨çæƒ³äº†ã€‚ç»™æ¢æ–‡é“åšåºçš„æŸä½œå®¶ï¼ˆå¿˜äº†åå­—ï¼‰è¯´ï¼Œä¸ºä»€ä¹ˆäººä»¬å–œæ¬¢å¯“å“²å­¦äºæ–‡å­¦å‘¢ï¼Œå› ä¸ºäººä»¬å–œæ¬¢é—®æ²¡æœ‰ç­”æ¡ˆçš„é—®é¢˜ï¼Œå–œæ¬¢å»ä½“å‘³è¿™ç§æ±‚ç´¢çš„æ„Ÿè§‰ã€‚å¯èƒ½å¯¹æˆ‘æ¥è¯´ï¼Œè¿™ä¹Ÿç®—æ˜¯ä¸€ç‚¹å¿ƒç†å®‰æ…°äº†å§ã€‚</p>
<p>å—¯ï¼Œå†™å®Œè¿™äº›æ„Ÿè§‰å†…å¿ƒæ˜æ˜¾å¹³é™äº†è®¸å¤šã€‚</p>
<h3 id="12-25"><a href="#12-25" class="headerlink" title="12.25"></a>12.25</h3><p>ä»Šå¤©æœ‰ç‚¹é¢“ï¼Œä¸Šåˆåªå†™äº†ä¸€ç¯‡é¢˜è§£ï¼Œä¸‹åˆåš$[\rm SNOI2019]$çš„D2T1ï¼Œåšäº†å¥½ä¹…ï¼Œå‰©ä¸‹çš„æ—¶é—´ä¸çŸ¥é“å¹²ä»€ä¹ˆå»äº†ã€‚</p>
<p>æ™šä¸Šç»§ç»­å’Œ <code>ouuuyuuu</code> å‡ºå»è·‘åœˆã€‚å¤–é¢å¼€å§‹ä¸‹é›ªäº†ï¼Œååˆ†å¼€å¿ƒã€‚ä½†æ˜¯ä¸€è¾¹è·‘ï¼Œé£é›ªå¤¹å¸¦ç€å†·é›¨æ‰‘æ‰“è¿‡æ¥æœ‰ç‚¹éš¾å—ã€‚çœ¼é•œä¸­é€”è¿˜å› ä¸ºé•œé¢ä¸Šæ°´å¤ªå¤šï¼Œæƒ³ç”¨æ‰‹å¥—æ“¦ï¼Œç»“æœæ“¦æˆäº†ç£¨ç ‚ç»ç’ƒâ€¦233æ‘˜ä¸‹çœ¼é•œæ¥ç»§ç»­è·‘å°±ä¼šæ„Ÿè§‰è·Ÿå–äº†ä¸€å£¶ä¸€æ ·ï¼Œçœ‹ç€å‘¨å›´éƒ½æ˜¯ä¸€æ´¾è™šæ— ç¼¥ç¼ˆçš„æ™¯è±¡ã€‚</p>
<p>å¼€å§‹çœ‹æ¢æ–‡é“çš„ã€Šæˆ‘æ‰§ã€‹äº†ã€‚æ„Ÿè§‰è¿˜è¡Œã€‚ä½†æ˜¯æ¯•ç«Ÿåªçœ‹äº†ä¸€ç‚¹ï¼Œä¹Ÿä¸çŸ¥é“åˆ°åº•æœ‰ä»€ä¹ˆç²¾å½©ç­‰å¾…ç€æˆ‘ã€‚</p>
<p>å‘ç°è‡ªå·±å†™æ–‡ç« çš„æ—¶å€™ï¼Œå¯èƒ½æ˜¯å› ä¸ºå¹³æ—¶è¯´è¯è¯´å¤ªå¿«äº†ï¼Œä¸€ç›´ä¸å–œæ¬¢åŠ å¥å·ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯ä¸€å¤§æ®µå…¨æ˜¯é€—å·233</p>
<p>æ™šä¸Šå‘ç°èƒœåˆ©ä¸€ä¸­çš„ç¥ä»™ä»¬å»é€›äº†æˆ‘çš„ <code>Luogu</code> åšå®¢ï¼Œæ¯”è¾ƒå¼€å¿ƒã€‚å› ä¸ºä¼¼ä¹æˆ‘ä¹Ÿæ²¡æ³•è·Ÿåˆ«äººäº¤æµäº†ã€‚</p>
<p>çæ‰¯ä¸€å¥ï¼Œæ„Ÿè§‰ <code>rqy</code> èƒ½ä¸€ä¸ªäººåœ¨è¿™å„¿å¥‹æ–—ä¸¤å¹´ï¼Œååˆ†å‰å®³ã€‚å­¤ç‹¬+ç»å¸¸ä¼šæœ‰çš„ç»æœ›+å¶å°”çš„å¸Œæœ›ï¼Œä¸æŠŠäººé€¼è‡ªé—­å·²ç»ç®—æ˜¯å¾ˆå¥½äº†ã€‚</p>
<p>è¯¶ï¼Œåˆšåˆšæ‰å‘ç°åŸæ¥è‡ªå·±æœ‰ä¸‰ä¸ªåšå®¢ï¼Œä½†æ˜¯è¿™ä¸‰ä¸ªåšå®¢ä¸Šçš„ä¸œè¥¿å‡ ä¹éƒ½ä¸ä¸€æ ·ã€‚ã€‚ã€‚233</p>
<h3 id="12-24"><a href="#12-24" class="headerlink" title="12.24"></a>12.24</h3><p>å¹³å®‰å¤œï¼Œå¾ˆè‡ªé—­233</p>
<p>çœ‹äº†ä¸€ä¸Šåˆ+å¤§åŠä¸ªä¸‹åˆçš„æ„é€ ï¼Œæ„Ÿè§‰ä¸€èˆ¬ã€‚å¬ <code>ouuuyuuu</code> è¯´æ„é€ é¢˜åªèƒ½é•¿ç»éªŒï¼Œæ˜¯å­¦ä¸ä¼šçš„ï¼Œæ„Ÿè§‰æœ‰ç‚¹å°å¤±è½ã€‚</p>
<p><del>äººæ€»è¦æœ‰æ¢¦æƒ³ï¼Œä¸‡ä¸€æˆ‘å°±å­¦ä¼šäº†å‘¢</del></p>
<p>æ™šä¸Šå¤ç›˜äº†ä¸€ä¸‹è‡ªå·±çš„ $\rm CSP-S~2019$ ï¼Œæ„Ÿè§‰è™½ç„¶å’Œå¤§å®¶éƒ½å¾ˆæœ‰å·®è·ï¼Œä½†æ˜¯å¦‚æœä»è¿›æ­¥çš„æ„ä¹‰ä¸Šæ¥è®²ï¼Œæ¯”èµ·å»å¹´æ¥è‡ªå·±è¿›æ­¥è¿˜æ˜¯è›®å¤šçš„ã€‚æ¯•ç«Ÿå»å¹´ä¹Ÿå°±é‚£ç‚¹æ°´å¹³ã€‚</p>
<p>å—¯ï¼Œæ‰€ä»¥å‘¢ï¼Œè°çŸ¥é“å°†æ¥æˆ‘ä¼šä¸ä¼šè¿›æ­¥åˆ°æˆ‘æƒ³è±¡ä¸åˆ°çš„æ°´å¹³å‘¢ï¼ŸåŠ æ²¹å§ï¼Œæˆ‘å¯æ˜¯æƒ³è¦åˆ›é€ å¥‡è¿¹çš„ç¬¨è›‹å•Šï¼</p>
<h3 id="12-23"><a href="#12-23" class="headerlink" title="12.23"></a>12.23</h3><p>è¶Šæ¥è¶Šå›°äº†ï¼Œå‘ç°å•¥éƒ½å­¦ä¸ä¼šï¼Œç„¶åè‡ªé—­äº†ã€‚</p>
<p>å‘ç°å»äº† <code>pkuwc</code> çš„å°ä¼™ä¼´ä»¬ä¼¼ä¹éƒ½æœ‰çº¦æ‹¿äº†ï¼Œæ„Ÿè§‰æ›´è‡ªé—­äº†ã€‚</p>
<p>â€¦â€¦æˆ‘è§‰å¾—æˆ‘ç°åœ¨åº”è¯¥æ˜¯å…¨æ ¡æœ€ç›¼ç€æ”¾å¯’å‡çš„äººäº†ã€‚å½“åˆè§‰å¾—ä¼¼ä¹æœºæˆ¿ç”Ÿæ´»ä¼šå¾ˆè½»æ¾ï¼Œç»“æœå‘ç°æ¯”æ–‡åŒ–è¯¾ç”Ÿæ´»è‡ªé—­äº†ä¸æ­¢ä¸€ä¸ªé‡çº§ã€‚å¯æµ·æ˜Ÿâ€¦â€¦</p>
<p>å‘ç°å•¥éƒ½å­¦ä¸ä¼šäº†ï¼Œå‘ç°æ¯”åˆ«äººæ‹‰ä¸‹çš„ä¸æ­¢ä¸€ç‚¹åŠç‚¹â€¦â€¦æœ‰ç‚¹éš¾å—ï¼Œä½†æ˜¯ä¸€æƒ³åˆ°é©¬ä¸Šè¦æ”¾å‡äº†ï¼ˆè™½ç„¶è¿˜æœ‰ä¸€ä¸ªå¤šæœˆï¼‰å°±ä¼šå¼€å¿ƒä¸€ç‚¹phh</p>
<h3 id="12-22"><a href="#12-22" class="headerlink" title="12.22"></a>12.22</h3><p>â€¦â€¦ä¹‹å‰æ¢äº†å‡ å¤©çš„ <code>jacman</code> ä¸»é¢˜ï¼Œè¯´å®è¯æ„Ÿè§‰ä¸æ˜¯å¾ˆæ¼‚äº®ã€‚æ¢ä¸»é¢˜çš„åŸå› æ˜¯æˆ‘å…³äº†ä¸€æ¬¡ <code>icloud</code>ï¼Œç„¶åä»–å°±ç»™æˆ‘åäº†â€¦â€¦è¿·æƒ‘ã€‚äºæ˜¯åªèƒ½é‡æ–°å»ºä¸€ä¸ªä¸»é¢˜ã€‚ä¸è¿‡å¥½åœ¨æˆ‘<del>æ‰¾å›äº†å¤±å»çš„è„‘å­</del>æ‰¾åˆ°äº†å¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œäºæ˜¯ä¹æˆåŠŸå¤åŸäº†ã€‚äºæ˜¯ç°åœ¨å°±åˆæ¢å›äº† <code>next</code> ä¸»é¢˜ã€‚</p>
<p>æ€ä¹ˆè¯´å‘¢ï¼Œè™½ç„¶ <code>next</code> ä¸»é¢˜ç¡®å®ç”¨çš„æ¯”è¾ƒå¤šï¼Œæœ‰çƒ‚å¤§è¡—çš„å«Œç–‘ï¼Œä½†æ˜¯ä½ è¦çœŸè®©æˆ‘å»æŒ‘å…¶ä»–çš„å–œæ¬¢çš„å¹¶ä¸”é…ç½®å‡ºæ¥ï¼Œç¡®å®å¾ˆéº»çƒ¦ã€‚</p>
<p>å—¯ï¼Œè¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬è¦å­¦ä¼šå¤‡ä»½ã€‚ </p>
<h3 id="12-15"><a href="#12-15" class="headerlink" title="12.15"></a>12.15</h3><p>upd:å› ä¸ºä¸çŸ¥ä¸ºå•¥ï¼Œhexoçš„èƒŒæ™¯ç‚¸äº†ï¼Œè§‰å¾—ä¼¼ä¹ç™½è‰²ä¹ŸæŒºæ¼‚äº®ï¼Œå°±å†³å®šä¸è®¾ç½®èƒŒæ™¯äº†ã€‚</p>
<p>æ–°å»ºäº†è¿™ä¸ªæ–‡æ¡£ï¼Œæœ¬æƒ³å†™å¾ˆå¤šï¼Œç»“æœçªç„¶å‘ç°è‡ªå·±WCéƒ½å»ä¸äº†ã€‚</p>
<p>ç„¶åå°±è‡ªé—­äº†ï¼Œæˆ‘ä¸ºä»€ä¹ˆè¿˜è¦æ­»å‘½åšæŒä¸‹å»å‘¢ï¼Ÿåˆæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ</p>
]]></content>
      <categories>
        <category>æ‚è®°</category>
      </categories>
      <tags>
        <tag>ç¬”å°–ç”ŸèŠ±</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘Manacherç®€å•é¢˜æ³›åš</title>
    <url>/2019/12/15/Manacher%E6%B3%9B%E5%81%9A/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><del>åœ¨ï¼Ÿä¸ºå•¥ä¸ç”¨PAMï¼Ÿ</del></p>
<p>emmé‚£å¯èƒ½æ˜¯ç©ºé—´å¼€ä¸ä¸‹ï¼ˆè‡ªæˆ‘å®‰æ…°</p>
<a id="more"></a>
<h1 id="1-LG1659-å›½å®¶é›†è®­é˜Ÿ-æ‹‰æ‹‰é˜Ÿæ’ç»ƒ"><a href="#1-LG1659-å›½å®¶é›†è®­é˜Ÿ-æ‹‰æ‹‰é˜Ÿæ’ç»ƒ" class="headerlink" title="$1$ LG1659 [å›½å®¶é›†è®­é˜Ÿ]æ‹‰æ‹‰é˜Ÿæ’ç»ƒ"></a>$1$ LG1659 [å›½å®¶é›†è®­é˜Ÿ]æ‹‰æ‹‰é˜Ÿæ’ç»ƒ</h1><blockquote>
<p>æ±‚å‰$k$å¤§çš„å¥‡æ•°é•¿åº¦å›æ–‡ä¸²çš„é•¿åº¦ä¹‹ç§¯ã€‚</p>
<p>$\rm |S|\leq 1e6,K\leq 1e12$</p>
</blockquote>
<p>â€¦â€¦ä¸€å¼€å§‹è§‰å¾—æŒºæ°´ï¼Œå°±å¼€å§‹äºŒåˆ†æœ€å°‘é•¿åº¦èƒ½åˆ°å¤šå°‘ã€‚å†™å†™å†™â€¦å†™åˆ°æœ€åå‘ç°ç»†èŠ‚å¾ˆçƒ¦äººâ€¦ç„¶åæœ€åå‘ç°æ˜¯é”™çš„qaq</p>
<p>äºŒåˆ†æ˜¯æ²¡é”™ï¼Œåªæ˜¯æœ€åè®¡ç®—é”™äº†ã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘äºŒåˆ†å‡ºçš„æœ€å°é•¿åº¦æ˜¯$k$ï¼Œå¯¹äºä¸€ä¸ªå¤§äº$k$çš„é•¿åº¦$l$æœ‰å¥½å¤šä¸ªï¼Œæ²¡æ³•çŸ¥é“$l$ä»¬åˆ°åº•è¦ç®—åˆ°å‡ ï¼Œä¹Ÿå°±æ˜¯è¯´$7$ä¸­ä¸€å®šåŒ…å«ç€$3/5/7$ï¼Œä½†æ˜¯å¯¹äº$l$ï¼Œå…¶ä¸­å¯èƒ½æœ‰æ‹†å‡º$7,5$æ¥çš„ï¼Œä¹Ÿæœ‰å¯èƒ½æœ‰æ‹†å‡º$7,5,3$æ¥çš„ï¼Œæ— æ³•åŒä¸€ä¸ªé•¿åº¦ä¸€èµ·ç®—ã€‚</p>
<p>ä»¥ä¸‹æ˜¯é”™è¯¯ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> ns[MAXN], base[MAXN], buc[MAXN], ed[MAXN] ; </span><br><span class="line"><span class="keyword">int</span> N, L = <span class="number">-1</span> ; LL K, res, fact = <span class="number">1</span>, _up ; <span class="keyword">char</span> In[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function">il LL <span class="title">expow</span><span class="params">(LL x, LL y)</span></span>&#123;</span><br><span class="line">	LL ret = <span class="number">1</span> ; </span><br><span class="line">	<span class="keyword">while</span> (y)&#123;</span><br><span class="line">		<span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">			(ret *= x) %= Mod ; </span><br><span class="line">		(x *= x) %= Mod, y &gt;&gt;= <span class="number">1</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">	LL ret = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">int</span> x = ed[p], i ; </span><br><span class="line">	<span class="keyword">if</span> (x % <span class="number">2</span> == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; p ; ++ i)</span><br><span class="line">		ret += <span class="number">1l</span>l * ((ed[i] - ed[p] + <span class="number">2</span>) / <span class="number">2</span>) * <span class="number">1l</span>l * buc[ed[i]] ; </span><br><span class="line">	<span class="keyword">return</span> (<span class="keyword">bool</span>)(ret + (buc[ed[p]]) &gt;= K) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K &gt;&gt; (In + <span class="number">1</span>) ;</span><br><span class="line">	ns[++ L] = <span class="string">'$'</span>, ns[++ L] = <span class="string">'#'</span> ; <span class="keyword">int</span> id = <span class="number">0</span>, rt = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) ns[++ L] = (<span class="keyword">int</span>)In[i], ns[++ L] = <span class="string">'#'</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= L ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (rt &lt;= i) base[i] = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">else</span> base[i] = min(base[<span class="number">2</span> * id - i], rt - i + <span class="number">1</span>) ;</span><br><span class="line">		<span class="keyword">while</span> (ns[i - base[i]] == ns[i + base[i]]) ++ base[i] ; </span><br><span class="line">		<span class="keyword">if</span> (rt &lt;= i + base[i] - <span class="number">1</span>) rt = i + base[i] - <span class="number">1</span>, id = i ; </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">2</span> * N + <span class="number">2</span> ; ++ i) buc[base[i] - <span class="number">1</span>] ++ ;	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; MAXN ; i += <span class="number">2</span>) <span class="keyword">if</span> (buc[i]) ed[++ tot] = i ; </span><br><span class="line">	reverse(ed + <span class="number">1</span>, ed + tot + <span class="number">1</span>) ; <span class="keyword">int</span> L = <span class="number">1</span>, R = tot, Mid, ans, pos = <span class="number">0</span> ; </span><br><span class="line">	<span class="keyword">while</span> (L &lt;= R)&#123;</span><br><span class="line">		Mid = (L + R) &gt;&gt; <span class="number">1</span> ; </span><br><span class="line">		<span class="comment">/*if (rand() % 2)</span></span><br><span class="line"><span class="comment">			while (ed[Mid] % 2 == 0 &amp;&amp; Mid &lt; R) ++ Mid ;</span></span><br><span class="line"><span class="comment">		else </span></span><br><span class="line"><span class="comment">			while (ed[Mid] % 2 == 0 &amp;&amp; Mid &gt; L) -- Mid ;*/</span></span><br><span class="line">		<span class="keyword">if</span> (check(Mid)) ans = Mid, R = Mid - <span class="number">1</span> ; <span class="keyword">else</span> L = Mid + <span class="number">1</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">	pos = ans, res = <span class="number">1l</span>l, _up = ed[<span class="number">1</span>] ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = ed[pos] ; i &lt;= ed[<span class="number">1</span>] ; i += <span class="number">2</span>) fact *= <span class="number">1l</span>l * i ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= pos ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">while</span> (ed[i] &lt; _up) fact /= _up, _up -= <span class="number">2</span> ; </span><br><span class="line">		<span class="keyword">if</span> ((ed[i] - ed[pos] + <span class="number">2</span>) / <span class="number">2</span> &gt; K)&#123;</span><br><span class="line">			<span class="keyword">int</span> j = <span class="number">0</span> ; </span><br><span class="line">			<span class="keyword">while</span> (ed[i] &gt;= ed[pos] &amp;&amp; j &lt; K)</span><br><span class="line">				res = res * <span class="number">1l</span>l * ed[i], ed[i] -= <span class="number">2</span>, ++ j ; </span><br><span class="line">			<span class="keyword">break</span> ; </span><br><span class="line">		&#125; </span><br><span class="line">		res = res * expow(fact, buc[ed[i]] &lt;= K ? buc[ed[i]] : K) % Mod ;</span><br><span class="line">		K -= <span class="number">1l</span>l * ((ed[i] - ed[pos] + <span class="number">2</span>) / <span class="number">2</span>) * <span class="number">1l</span>l * buc[ed[i]] ; </span><br><span class="line">		<span class="keyword">if</span> (K &lt;= <span class="number">0</span>) <span class="keyword">break</span> ; </span><br><span class="line">	&#125; 	 </span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿå¤±è¯¯ç‚¹ï¼Œè´¡çŒ®æ— æ³•æå‰è®¡ç®—ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘å»¶åè®¡ç®—ï¼Œè¿™æ ·ä¸€å®šèƒ½ä¿è¯å‡†ç¡®å‡‘å‡ºæ¥$K$.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> tot, ns[MAXN], base[MAXN], buc[MAXN], ed[MAXN] ; </span><br><span class="line"><span class="keyword">int</span> N, L ; LL K, res, fact = <span class="number">1</span>, _up ; <span class="keyword">char</span> In[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function">il LL <span class="title">expow</span><span class="params">(LL x, LL y)</span></span>&#123;</span><br><span class="line">	LL ret = <span class="number">1</span> ; </span><br><span class="line">	<span class="keyword">while</span> (y)&#123;</span><br><span class="line">		<span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">			(ret *= x) %= Mod ; </span><br><span class="line">		(x *= x) %= Mod, y &gt;&gt;= <span class="number">1</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K &gt;&gt; (In + <span class="number">1</span>) ;</span><br><span class="line">	ns[++ L] = <span class="string">'$'</span>, ns[++ L] = <span class="string">'#'</span> ; <span class="keyword">int</span> id = <span class="number">0</span>, rt = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) ns[++ L] = (<span class="keyword">int</span>)In[i], ns[++ L] = <span class="string">'#'</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= L ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (rt &lt;= i) base[i] = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">else</span> base[i] = min(base[<span class="number">2</span> * id - i], rt - i) ;</span><br><span class="line">		<span class="keyword">while</span> (ns[i - base[i]] == ns[i + base[i]] &amp;&amp; i + base[i] &lt;= L &amp;&amp; i - base[i] &gt;= <span class="number">1</span>) ++ base[i] ; </span><br><span class="line">		<span class="keyword">if</span> (rt &lt;= i + base[i] - <span class="number">1</span>) rt = i + base[i], id = i ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = N ; i &gt;= <span class="number">1</span> ; -- i)&#123;</span><br><span class="line">		ans += buc[i] ; </span><br><span class="line">		<span class="keyword">if</span> (!(i &amp; <span class="number">1</span>)) <span class="keyword">continue</span> ;		</span><br><span class="line">		<span class="keyword">if</span> (ans &lt;= K)	</span><br><span class="line">			(res *= expow(i, ans)) %= Mod, K -= ans ; </span><br><span class="line">		<span class="keyword">else</span> &#123; (res *= expow(i, K)) %= Mod, K -= ans ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ã€‚ã€‚ã€‚è¿™é¢˜ä¸€å¼€å§‹å†™æŒ‚äº†ï¼Œç„¶åä¸¤å¤©åï¼ˆå°±æ˜¯å†™è¿™è¡Œå­—çš„æ—¶å€™ï¼‰æ•´ç†è¿™é“é¢˜ï¼Œåˆè°ƒäº†åŠå¤©æ‰å‘ç°ä¸ºå•¥äºŒåˆ†ä¸å¯¹â€¦qaqè„‘å­æ˜¯ä¸ªå¥½ä¸œè¥¿ã€‚</p>
<h1 id="2-LG4555-å›½å®¶é›†è®­é˜Ÿ-æœ€é•¿åŒå›æ–‡ä¸²"><a href="#2-LG4555-å›½å®¶é›†è®­é˜Ÿ-æœ€é•¿åŒå›æ–‡ä¸²" class="headerlink" title="$2$ LG4555 [å›½å®¶é›†è®­é˜Ÿ]æœ€é•¿åŒå›æ–‡ä¸²"></a>$2$ LG4555 [å›½å®¶é›†è®­é˜Ÿ]æœ€é•¿åŒå›æ–‡ä¸²</h1><p>è¿™é¢˜æ¯”ç¬¬ä¸€é¢˜å‹å–„äº†å¾ˆå¤šã€‚ã€‚ã€‚</p>
<blockquote>
<p>è¾“å…¥é•¿åº¦ä¸º$n$çš„ä¸²$S$ï¼Œæ±‚$S$çš„æœ€é•¿åŒå›æ–‡å­ä¸²$T$,å³å¯å°†$T$åˆ†ä¸ºä¸¤éƒ¨åˆ†$X$ï¼Œ$Y$ï¼Œï¼ˆ$|X|,|Y|â‰¥1$ï¼‰ä¸”$X$å’Œ$Y$éƒ½æ˜¯å›æ–‡ä¸²ã€‚</p>
</blockquote>
<p>å—¯ï¼Œå…¶å®å°±æ˜¯æ±‚ä»¥æ¯ä¸ªç‚¹ä¸ºå³ç«¯ç‚¹/å·¦ç«¯ç‚¹çš„æœ€é•¿å›æ–‡ä¸²é•¿åº¦ã€‚ç”¨Manacheråšçš„è¯ï¼Œå°±æ˜¯ä¸€å¼€å§‹å…ˆæ¨å‡ºä»¥æ¯ä¸ªç‚¹ä¸ºè½´çš„æœ€é•¿å›æ–‡ä¸²é•¿åº¦ï¼Œç„¶åç”¨è¿™ä¸ªå»æ›´æ–°æ¯ç«¯ç‚¹ã€‚æ³¨æ„åˆ°è¿™ä¹ˆåšæœ‰äº›åŒ…å«åœ¨åŸæ¥æ±‚å‡ºçš„æœ€é•¿å›æ–‡ä¸²å†…éƒ¨çš„å°å›æ–‡ä¸²å¯èƒ½å¹¶ä¸å¯ä»¥æ±‚å‡ºæ¥ï¼Œäºæ˜¯å†dpä¸€éå³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">	<span class="built_in">cin</span> &gt;&gt; (In + <span class="number">1</span>), N = <span class="built_in">strlen</span>(In + <span class="number">1</span>) ; </span><br><span class="line">	<span class="keyword">int</span> i, id = <span class="number">0</span>, rt = <span class="number">0</span> ; ns[++ L] = <span class="string">'$'</span>, ns[++ L] = <span class="string">'#'</span> ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) ns[++ L] = (<span class="keyword">int</span>)In[i], ns[++ L] = <span class="string">'#'</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= L ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (rt &lt;= i) base[i] = <span class="number">1</span> ; </span><br><span class="line">		<span class="keyword">else</span> base[i] = min(rt - i + <span class="number">1</span>, base[<span class="number">2</span> * id - i]) ;  </span><br><span class="line">		<span class="keyword">while</span> (ns[i + base[i]] == ns[i - base[i]]) base[i] ++ ;</span><br><span class="line">		<span class="keyword">if</span> (i + base[i] &gt; rt) rt = i + base[i] - <span class="number">1</span>, id = i ; </span><br><span class="line">	&#125;</span><br><span class="line"><span class="comment">//	for (i = 1 ; i &lt;= L ; ++ i) cout &lt;&lt; base[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line"><span class="comment">//	for (i = 1 ; i &lt;= L ; ++ i) cout &lt;&lt; (char)ns[i] &lt;&lt; " " ;</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= L ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">int</span> l = i / <span class="number">2</span> - (base[i] / <span class="number">2</span>) + <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">int</span> r = i / <span class="number">2</span> + (base[i] / <span class="number">2</span>) - <span class="number">1</span> ; <span class="keyword">if</span> (ns[i] == <span class="number">35</span>) ++ r ;</span><br><span class="line">		Ls[r] = max(Ls[r], base[i] - <span class="number">1</span>), Rs[l] = max(Rs[l], base[i] - <span class="number">1</span>) ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) Ls[i] = max(Ls[i], Ls[i + <span class="number">1</span>] - <span class="number">2</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) Rs[i] = max(Rs[i], Rs[i - <span class="number">1</span>] - <span class="number">2</span>) ;</span><br><span class="line"><span class="comment">//	for (i = 1 ; i &lt;= N ; ++ i) cout &lt;&lt; Ls[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line"><span class="comment">//	for (i = 1 ; i &lt;= N ; ++ i) cout &lt;&lt; Rs[i] &lt;&lt; " " ;</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) ans = max(ans, Ls[i] + Rs[i + <span class="number">1</span>]) ; <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ä¸²/Manacher</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘PAMç®€å•é¢˜æ³›åš</title>
    <url>/2019/12/15/PAM%E6%B3%9B%E5%81%9A/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>éƒ½æ˜¯ç®€å•çš„PAMä¹ é¢˜</p>
<a id="more"></a>
<h1 id="1-LG5496-ã€æ¨¡æ¿ã€‘å›æ–‡è‡ªåŠ¨æœº"><a href="#1-LG5496-ã€æ¨¡æ¿ã€‘å›æ–‡è‡ªåŠ¨æœº" class="headerlink" title="$1$ LG5496 ã€æ¨¡æ¿ã€‘å›æ–‡è‡ªåŠ¨æœº"></a>$1$ LG5496 ã€æ¨¡æ¿ã€‘å›æ–‡è‡ªåŠ¨æœº</h1><blockquote>
<p>å¯¹äº $s$ çš„æ¯ä¸ªä½ç½®ï¼Œè¯·æ±‚å‡ºä»¥è¯¥ä½ç½®ç»“å°¾çš„å›æ–‡å­ä¸²ä¸ªæ•°ã€‚</p>
<p>$|s|\leq 1e6$</p>
</blockquote>
<p>ç„¶åå°±æ˜¯PAMçš„æ¿å­é¢˜<del>å’‹æ„Ÿè§‰å¥½åƒæ²¡æœ‰ä¸æ˜¯å¾ˆæ¿çš„PAMé¢˜å‘¢</del></p>
<p>è€ƒè™‘å¯¹è‡ªåŠ¨æœºä¸Šæ¯ä¸ªç‚¹ç»´æŠ¤ä¸€ä¸ªå‡ºç°æ¬¡æ•°$cnt$ï¼Œé‚£ä¹ˆè€ƒè™‘ä¸²é‡Œé¢çš„ä»»ä½•ä¸€ä¸ªå‰ç¼€çš„å›æ–‡åç¼€éƒ½æ˜¯å…¶æœ€é•¿å›æ–‡åç¼€çš„å›æ–‡åç¼€ï¼Œæ‰€ä»¥å°±å¯ä»¥æœ‰è½¬ç§»</p>
<script type="math/tex; mode=display">
cnt_{p}=cnt_{fail_p}+1</script><p>ç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚</p>
<h1 id="2-APIO2014-å›æ–‡ä¸²"><a href="#2-APIO2014-å›æ–‡ä¸²" class="headerlink" title="$2$ [APIO2014]å›æ–‡ä¸²"></a>$2$ [APIO2014]å›æ–‡ä¸²</h1><blockquote>
<p>ç»™ä½ ä¸€ä¸ªç”±å°å†™æ‹‰ä¸å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²$s$ã€‚æˆ‘ä»¬å®šä¹‰$s$çš„ä¸€ä¸ªå­ä¸²çš„å­˜åœ¨å€¼ä¸ºè¿™ä¸ªå­ä¸²åœ¨ $s$ä¸­å‡ºç°çš„æ¬¡æ•°ä¹˜ä»¥è¿™ä¸ªå­ä¸²çš„é•¿åº¦ã€‚</p>
<p>å¯¹äºç»™ä½ çš„è¿™ä¸ªå­—ç¬¦ä¸²$s$ï¼Œæ±‚æ‰€æœ‰å›æ–‡å­ä¸²ä¸­çš„æœ€å¤§å­˜åœ¨å€¼ã€‚</p>
<p>$|s|\leq 1e6$</p>
</blockquote>
<p>æ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒå¦™çš„â€¦â€¦æˆ–è®¸ä¹Ÿç®—æ˜¯PAMçš„åŸºæœ¬æ“ä½œï¼Œå°±æ˜¯æ±‚å‡ºæ¯ä¸ªå›æ–‡å­ä¸²çš„å‡ºç°æ¬¡æ•°ã€‚è€ƒè™‘ä¸€ä¸ªå­ä¸²å‡ºç°ç¬¬$t$æ¬¡çš„æ—¶å€™ï¼ˆ$t&gt;1$ï¼‰ï¼Œä¸€å®šæ˜¯ä½œä¸ºå…¶ä»–ä¸²çš„å›æ–‡åç¼€å‡ºç°ï¼Œè€Œæ˜¾ç„¶<strong>â€œä¸²çš„æœ€é•¿å›æ–‡åç¼€å”¯ä¸€â€</strong>çš„é€†å‘½é¢˜<strong>â€œä»»ä½•ä¸²ä¼šå”¯ä¸€ä½œä¸ºå…¶ä»–ä¸²çš„æœ€é•¿å›æ–‡åç¼€â€</strong>ä¹Ÿæ˜¯æˆç«‹çš„ã€‚æ•…è‹¥è®°å½•ä»¥$u$ä¸º$fail$çš„æ‰€æœ‰å­ä¸²é›†åˆä¸º$\rm S(u)$ï¼Œé‚£å¯ä»¥ç›´æ¥ç”¨</p>
<script type="math/tex; mode=display">
\rm f_u=ctn_u+\sum_{v\in S(u)}f_v</script><p>å…¶ä¸­ctnä¸ºå•ç‹¬å‡ºç°çš„æ¬¡æ•°ï¼Œå› ä¸ºå¯èƒ½æœ‰å¤šä¸ªå­ä¸²$s$éƒ½ä¸ä½œä¸ºå…¶ä»–ä¸²çš„æœ€é•¿å›æ–‡åç¼€ã€‚</p>
<p>emmmä¸€å¥è¯æ¦‚æ‹¬ï¼ŒPAMå¤„ç†å­ä¸²é—®é¢˜çš„æ—¶å€™æœ‰ä¸ªç‰¹æ€§ï¼Œå°±æ˜¯ç”±äºæ˜¯é€’å‡å¼æŸ¥è¯¢ï¼Œæ‰€ä»¥ä¸€ä¸ªå›æ–‡ä¸²ä¸ä¼šåŒæ—¶ä½œä¸ºå›æ–‡ä¸²å’Œå…¶ä»–ä¸²çš„æœ€é•¿å›æ–‡åç¼€å‡ºç°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = P.sz ; i ; i --) </span><br><span class="line">    P.f[P.pre[i]] += P.f[i], ans = max(ans, <span class="number">1l</span>l * P.len[i] * P.f[i]) ;</span><br></pre></td></tr></table></figure>
<p><del>å“ªé‚£ä¹ˆå¤šPè¯ï¼Œå°±æ˜¯èƒŒå•Š</del></p>
<h1 id="3-LG5555-ç§©åºé­”å’’"><a href="#3-LG5555-ç§©åºé­”å’’" class="headerlink" title="$3$ LG5555 ç§©åºé­”å’’"></a>$3$ LG5555 ç§©åºé­”å’’</h1><blockquote>
<p>æ±‚ä¸¤ä¸ªä¸²çš„æœ€é•¿å…¬å…±å›æ–‡å­ä¸²ä»¥åŠè¯¥é•¿åº¦çš„å‡ºç°æ¬¡æ•°ã€‚</p>
<p>$\rm |S|,|T|\leq 10^6$</p>
</blockquote>
<p><del>æ­å–œå‘ç°ä¸€ä¸ªæ–°å¥—è·¯</del></p>
<p>è§‚å¯Ÿèµ·å§‹$\rm PAM$æœ¬èº«æ˜¯ä¸€æ£µæ ‘ï¼Œæ·»ä¸Šäº†ä¸€å †å¥‡å¥‡æ€ªæ€ªçš„$fail$è¾¹æ‰å˜æˆæœ‰å‘å›¾ã€‚æ‰€ä»¥è€ƒè™‘ï¼Œå¦‚æœä»å¥‡æ ¹æˆ–è€…å¶æ ¹åŒæ—¶å‘ä¸‹dfsï¼Œèµ°åŒæ ·çš„è½¬ç§»è¾¹ï¼Œé‚£ä¹ˆä¸€å®šå¯ä»¥åˆ°è¾¾åŒæ ·çš„çŠ¶æ€ã€‚æ‰€ä»¥è€ƒè™‘å»ºä¸¤ä¸ª$\rm PAM$ï¼Œä¸€èµ·dfsï¼Œç„¶åç®—ä¸ªç­”æ¡ˆå³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (ans == P.len[x]) res ++ ;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (ans &lt; P.len[x]) res = <span class="number">1</span>, ans = P.len[x] ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">26</span> ; ++ i)</span><br><span class="line">		<span class="keyword">if</span> (P.trie[x][i] &amp;&amp; Q.trie[y][i]) </span><br><span class="line">            dfs(P.trie[x][i], Q.trie[y][i]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>By the wayï¼Œå¥‡æ ¹/å¶æ ¹éƒ½è¦$dp$ä¸€æ¬¡ã€‚</p>
<h1 id="4-JSOI2013-å¿«ä¹çš„-JYY"><a href="#4-JSOI2013-å¿«ä¹çš„-JYY" class="headerlink" title="$4$ [JSOI2013]å¿«ä¹çš„ JYY"></a>$4$ [JSOI2013]å¿«ä¹çš„ JYY</h1><blockquote>
<p>æ±‚ä¸¤ä¸ªä¸²çš„ä¸åŒå…¬å…±å›æ–‡ä¸²çš„ä¸ªæ•°ï¼Œå…¶ä¸­ä¸åŒæ„æ€æ˜¯ä¸‹æ ‡ä¸åŒã€‚</p>
<p>$|s|,|t|\leq 10^6$</p>
</blockquote>
<p>â€¦â€¦ç„¶è€Œè¿™å°±æ˜¯å‰ä¸¤ä¸ªé¢˜ç»“åˆèµ·æ¥ã€‚è€ƒè™‘å…ˆ$dp$ä¸€éç®—å‡ºæ¥æ¯ä¸ªå›æ–‡å­ä¸²çš„å‡ºç°æ¬¡æ•°ï¼Œç„¶ådfsï¼Œä¹˜æ³•åŸç†è®¡æ•°ï¼Œç„¶åå°±åšå®Œäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (x + y &gt; <span class="number">2</span>) ans += <span class="number">1l</span>l * P.f[x] * Q.f[y] ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">26</span> ; ++ i)</span><br><span class="line">		<span class="keyword">if</span> (P.trie[x][i] &amp;&amp; Q.trie[y][i]) </span><br><span class="line">            dfs(P.trie[x][i], Q.trie[y][i]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	P.Init(), Q.Init() ;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; (S + <span class="number">1</span>) &gt;&gt; (T + <span class="number">1</span>) ; </span><br><span class="line">	N = <span class="built_in">strlen</span>(S + <span class="number">1</span>), M = <span class="built_in">strlen</span>(T + <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) P.Insert(S[i] - <span class="string">'A'</span> + <span class="number">1</span>, i, S) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i) Q.Insert(T[i] - <span class="string">'A'</span> + <span class="number">1</span>, i, T) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = P.sz ; i ; -- i) P.f[P.pre[i]] += P.f[i] ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = Q.sz ; i ; -- i) Q.f[Q.pre[i]] += Q.f[i] ; </span><br><span class="line">	dfs(<span class="number">1</span>, <span class="number">1</span>) ; dfs(<span class="number">0</span>, <span class="number">0</span>) ; <span class="built_in">cout</span> &lt;&lt; ans&lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="5-é—²æ‰¯"><a href="#5-é—²æ‰¯" class="headerlink" title="$5$ é—²æ‰¯"></a>$5$ é—²æ‰¯</h1><p>å†™æ¨¡æ¿é¢˜çœŸæ˜¯è®©äººæ„Ÿåˆ°ç©ºè™šâ€¦â€¦</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ä¸²/PAM,å›æ–‡è‡ªåŠ¨æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘PAM &amp; Manacher</title>
    <url>/2019/12/15/PAMandManacher/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>PAM &amp; Manacherï¼Œä¸¤ç§ç”¨æ¥å¤„ç†å›æ–‡ä¸²çš„ç©æ„å„¿ã€‚</p>
<a id="more"></a> 
<h1 id="1-Manacher"><a href="#1-Manacher" class="headerlink" title="$1$ Manacher"></a>$1$ Manacher</h1><p><del>æŒºçŸ­ï¼ŒèƒŒæ˜¯æŒºå¥½èƒŒçš„</del></p>
<p>Manacherç”¨äºæ±‚å›æ–‡ä¸²é•¿åº¦ã€‚æ€æƒ³å¤§æ¦‚å°±æ˜¯ï¼š</p>
<p>1ã€åŠ å…¥å­—ç¬¦é›†ä¹‹å¤–çš„è¯†åˆ«å­—ç¬¦ï¼ˆæ¯”å¦‚<code>#</code>ï¼‰åˆ†éš”å¼€åŸæ¥ç›¸é‚»çš„å­—æ¯ï¼Œè¿™æ ·æ‰€æœ‰çš„å›æ–‡ä¸²éƒ½å˜æˆäº†ä»¥æŸä¸ªå­—ç¬¦ä¸ºä¸­å¿ƒçš„ï¼ˆå¦åˆ™å¦‚æœæ˜¯å¶æ•°é•¿åº¦çš„å›æ–‡ä¸²è¿˜è¦ç‰¹åˆ¤ï¼‰ã€‚</p>
<p>2ã€è€ƒè™‘å€Ÿç”±ä»¥å‰çš„ä¿¡æ¯æ±‚å‡ºæ–°çš„å›æ–‡ä¸²é•¿åº¦ã€‚è®°å½•åˆ°ç°åœ¨ä¸ºæ­¢æœ€é å³çš„å›æ–‡ä¸²ä¸­æœ€å³ä¾§çš„å­—ç¬¦ä¸‹æ ‡&amp;å…¶å¯¹ç§°è½´çš„ä¸‹æ ‡ï¼Œä¸å¦¨è®°è¿™ä¸ªæœ€é å³çš„ä¸²ä¸º$\rm S$ã€‚é‚£ä¹ˆè€ƒè™‘ä»¥å½“å‰ä½ç½®ä½œä¸ºå¯¹ç§°è½´çš„ç­”æ¡ˆï¼Œä¸€å®š<strong>è‡³å°‘æ˜¯$\min${éš”ç€$\rm S$çš„å¯¹ç§°è½´ä¸å…¶å¯¹ç§°çš„å¦ä¸€ä¸ªä½ç½®ansï¼Œ$|S|-i+1$}</strong> ã€‚ç„¶åå°±ä¸æ–­æ‰©å±•å³å¯ã€‚</p>
<p>3ã€å…³äºå¤æ‚åº¦è¯æ˜ã€‚æˆ‘ä»¬è®°<strong>ä¸€æ¬¡å¸…æ°”çš„æ“ä½œ</strong>çš„æ„ä¹‰æ˜¯<strong>æˆåŠŸè®©$ans_i$çš„åˆå§‹å€¼ç»§æ‰¿äº†ä¸ä¹‹å¯¹ç§°çš„ç‚¹çš„ç­”æ¡ˆå’Œè¾¹ç•Œçš„å–$\min$</strong>ï¼Œè®°ä»¥å½“å‰ç‚¹ä¸ºè½´çš„æœ€é•¿å›æ–‡å­ä¸²ä¸º $\rm T$ï¼Œ$ \rm T$ çš„å³ç«¯ç‚¹ä¸º $q$ã€‚å¯ä»¥çŸ¥é“ .</p>
<ul>
<li>ï¼ˆ1ï¼‰$\rm S$çš„å³ç«¯ç‚¹æ˜¯å•å¢çš„ï¼›</li>
<li>ï¼ˆ2ï¼‰å¦‚æœå½“å‰æ—§çš„$maxlen&lt;i$ï¼Œå³æœªæˆåŠŸè¿›è¡Œä¸€æ¬¡å¸…æ°”çš„æ“ä½œï¼Œé‚£ä¹ˆæ˜¾ç„¶<code>while</code>1æ¬¡ï¼Œ$maxlen$å¢å¤§ä¸€æ¬¡ï¼›</li>
<li>ï¼ˆ3ï¼‰å¦‚æœå½“å‰çš„ä¸²ç»è¿‡äº†ä¸€æ¬¡å¸…æ°”çš„æ“ä½œï¼Œé‚£ä¹ˆå½“$q&lt;maxlen$æ—¶ï¼Œç›´æ¥è·³å‡º<code>while</code>ï¼›å½“$q\geq maxlen$æ—¶ï¼Œ$q$å¢å¤§$maxlen$å¿…å¢å¤§ã€‚æ‰€ä»¥å¾—å‡ºç»“è®ºï¼Œè¿›è¡Œä¸€æ¬¡å¸…æ°”çš„æ“ä½œå’Œ$maxlen$çš„å¢å¤§æ¬¡æ•°æ˜¯ä¸¥æ ¼åŒé˜¶çš„ã€‚</li>
</ul>
<p>So,æœ€ç»ˆå¤æ‚åº¦å°±æ˜¯$\Theta(n)$çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Manacher</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> id, fars, i ; </span><br><span class="line">	id = <span class="number">0</span>, fars = <span class="number">0</span> ;</span><br><span class="line">	<span class="comment">//id : æœ€é å³çš„å›æ–‡ä¸²çš„ä¸­å¿ƒä½ç½® </span></span><br><span class="line">	<span class="comment">//fars : è¿„ä»Šä¸ºæ­¢æœ€é å³çš„å›æ–‡ä¸²çš„æœ€å³ä¾§ </span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		ns[++ L] = (<span class="keyword">int</span>)In[i], ns[++ L] = <span class="string">'#'</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= L ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (fars &lt;= i) base[i] = <span class="number">1</span> ; </span><br><span class="line">		<span class="keyword">else</span> base[i] = min(fars - i + <span class="number">1</span>, base[id * <span class="number">2</span> - i]) ;</span><br><span class="line">		<span class="keyword">while</span> (ns[i + base[i]] == ns[i - base[i]]) base[i] ++ ;</span><br><span class="line"> 		<span class="keyword">if</span> (i + base[i] &gt; fars) id = i, fars = i + base[i] - <span class="number">1</span> ;	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, In + <span class="number">1</span>), </span><br><span class="line">	L = <span class="number">-1</span>, N = <span class="built_in">strlen</span>(In + <span class="number">1</span>) ;</span><br><span class="line">	ns[++ L] = <span class="string">'$'</span>, ns[++ L] = <span class="string">'#'</span> ; Manacher(In) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">2</span> * N + <span class="number">2</span> ; ++ i) ans = max(ans, base[i] - <span class="number">1</span>) ; </span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-PAM"><a href="#2-PAM" class="headerlink" title="$2$ PAM"></a>$2$ PAM</h1><p>å­¦äº†PAMï¼Œä¸çŸ¥é“ä¸ºå•¥æ„Ÿè§‰æ¯”SAMç®€å•ï¼Ÿ</p>
<p>å…¶å®å°±æ˜¯ä¸€ç§è‡ªåŠ¨æœºï¼Œä»¥å›æ–‡ä¸²ä¸ºçŠ¶æ€ï¼Œå·¦å³å„æ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸ºè½¬ç§»çš„è‡ªåŠ¨æœºã€‚è¦ç‚¹å¦‚ä¸‹ï¼š</p>
<p>0ã€ä¸€ä¸ªä¸²çš„å›æ–‡å­ä¸²è‡³å¤šæœ‰ $O(n)$ ä¸ªã€‚</p>
<p>1ã€é¦–å…ˆæ¯ä¸ªèŠ‚ç‚¹éœ€è¦ä¿å­˜è¿™ä¸ªèŠ‚ç‚¹ä¸­å›æ–‡ä¸²çš„é•¿åº¦ã€‚</p>
<p>2ã€æ˜¾ç„¶å§‹çŠ¶æ€éœ€è¦æœ‰ä¸¤ä¸ªï¼Œå³å¥‡æ•°é•¿åº¦çš„ $s_1$ å’Œå¶æ•°é•¿åº¦çš„ $s_0$ ï¼Œç§°ä½œ<strong>â€œå¥‡æ ¹â€</strong>å’Œ<strong>â€œå¶æ ¹â€</strong>ã€‚é‚£ä¹ˆä¸ºäº†æ–¹ä¾¿å‘¢ï¼Œå¥‡æ ¹çš„é•¿åº¦è®¾ç½®ä¸º $-1$ï¼Œå¶æ ¹é•¿åº¦è®¾ç½®ä¸º $0$ã€‚</p>
<p>3ã€è€ƒè™‘è¦ä» $last$ æŒ‡é’ˆæ‰©å±•å½“å‰çŠ¶æ€ï¼Œå‡è®¾å½“å‰éœ€è¦ <code>insert</code> çš„å­—æ¯æ˜¯ $c$ï¼Œæ˜¯è¿™ä¸ªä¸²é‡Œé¢çš„ç¬¬ $p$ ä¸ªå­—ç¬¦ï¼Œé‚£æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªåç¼€ $s[jâ€¦p-1]\quad s.t.\quad s[jâ€¦p-1]$ æœ¬èº«å›æ–‡ä¸” $s[j-1]=c$ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‘ä¸‹æ‰©å±•ã€‚</p>
<p>4ã€è€ƒè™‘æ€ä¹ˆæ‰¾è¿™ä¸ªåç¼€ï¼Œæ˜¾ç„¶å¯¹äºä¸€ä¸ªä¸² $\rm S$ï¼Œä»–çš„æ‰€æœ‰å›æ–‡åç¼€éƒ½æ˜¯å…¶æœ€é•¿å›æ–‡åç¼€çš„å›æ–‡åç¼€ã€‚æ‰€ä»¥è€ƒè™‘$fail$æŒ‡é’ˆï¼Œåº”å½“ä»å½“å‰çŠ¶æ€è¿å‘å®ƒçš„<strong>æœ€é•¿å›æ–‡åç¼€</strong>ã€‚</p>
<p>5ã€æ’å…¥æ–°èŠ‚ç‚¹æ—¶ï¼Œè€ƒè™‘è·³å®Œ $fail$ åå¦‚æœæ²¡æœ‰ç›¸åº”çš„è½¬ç§»è¾¹ï¼Œå°±è¦æ–°å»ºä¸€ä¸ªçŠ¶æ€ç„¶åè¿$fail$.</p>
<p>ç„¶åæ˜¯ä»£ç å’Œä¸€ç‚¹æ³¨æ„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PAM</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> trie[MAXN][Sigma] ;</span><br><span class="line">	<span class="keyword">int</span> rt0, rt1, last, sz ;</span><br><span class="line">	<span class="keyword">int</span> len[MAXN], fail[MAXN] ;</span><br><span class="line">&#125;P ;</span><br><span class="line"><span class="keyword">void</span> _init(PAM &amp;p)&#123;</span><br><span class="line">	p.sz = <span class="number">-1</span>, </span><br><span class="line">	p.rt0 = ++ p.sz, p.rt1 = ++ p.sz ;</span><br><span class="line">	p.fail[p.rt0] = p.fail[p.rt1] = p.rt1 ;</span><br><span class="line">	p.last = p.rt0, p.len[p.rt0] = <span class="number">0</span>, p.len[p.rt1] = <span class="number">-1</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _insert(PAM &amp;p, <span class="keyword">int</span> x, <span class="keyword">int</span> pos, <span class="keyword">char</span> *s)&#123;</span><br><span class="line">	<span class="keyword">int</span> u = p.last ; </span><br><span class="line">	<span class="keyword">while</span> (s[pos - p.len[u] - <span class="number">1</span>] != s[pos]) u = p.fail[u] ; </span><br><span class="line">	<span class="keyword">if</span> (!p.trie[u][x])&#123;</span><br><span class="line">		<span class="keyword">int</span> fa = p.fail[u] ;</span><br><span class="line">		<span class="keyword">int</span> newn = ++ p.sz ; </span><br><span class="line">		p.len[newn] = p.len[u] + <span class="number">2</span> ; </span><br><span class="line">		<span class="keyword">while</span> (s[pos - p.len[fa] - <span class="number">1</span>] != s[pos]) fa = p.fail[fa] ; </span><br><span class="line">		p.fail[newn] = p.trie[fa][x], p.trie[u][x] = newn, </span><br><span class="line">	&#125;</span><br><span class="line">	p.last = p.trie[u][x] ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>6ã€$\rm \color{red}{WARNING}$ï¼Œä»¥ä¸‹ä¸¤å¥é¡ºåºä¸è¦å†™åï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">p.fail[newn] = p.trie[fa][x], p.trie[u][x] = newn,</span><br></pre></td></tr></table></figure>
<p>åŸå› æ˜¯å½“ $fa=u$ æ—¶å°±å‡ºç°ç¯äº†ã€‚</p>
<h1 id="3-é—²æ‰¯"><a href="#3-é—²æ‰¯" class="headerlink" title="$3$ é—²æ‰¯"></a>$3$ é—²æ‰¯</h1><p>å­¦å®Œæ‰çŸ¥é“ï¼Œ$\rm PAM$ åˆç®€å•åˆå¥½èƒŒåŠŸèƒ½åˆå¤šâ€¦â€¦Manacherè¢«æ‰“çˆ†äº†å•Šå–‚qwqã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>PAM,å›æ–‡è‡ªåŠ¨æœº</category>
      </categories>
      <tags>
        <tag>å­—ç¬¦ä¸²/Manacher</tag>
        <tag>å­—ç¬¦ä¸²/PAM,å›æ–‡è‡ªåŠ¨æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘Codeforceså‰11åœºæ³›åš</title>
    <url>/2019/11/15/cf1-11/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å—¯ï¼Œç„¶åè¿™äº›é¢˜å°±æ˜¯ä»å¥½ä¹…ä¹‹å‰å¼€å§‹å°±ä¸€ç›´åœ¨åšçš„CFå‰11åœºçš„ä¸€äº›é¢˜ç›®ï¼Œéƒ½æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å†³å®šè®°å½•ä¸€ä¸‹è¡¥è¡¥åŸºç¡€qwq</p>
<a id="more"></a>
<h1 id="rm-CFÂ·1C"><a href="#rm-CFÂ·1C" class="headerlink" title="$\rm {CFÂ·1C}$"></a>$\rm {CFÂ·1C}$</h1><blockquote>
<p>æ±‚åŒ…å«ç»™å®šä¸‰ç‚¹çš„æ­£å¤šè¾¹å½¢æœ€å°é¢ç§¯ã€‚</p>
</blockquote>
<hr>
<p>å…ˆè€ƒè™‘ï¼Œå¯¹äºç»™å‡ºçš„ä¸‰ä¸ªæ­£å¤šè¾¹å½¢é¡¶ç‚¹ï¼Œä¸¤ä¸¤è¿è¾¹ä¹‹åï¼Œä¸­å‚çº¿äº¤äºæ­£å¤šè¾¹å½¢æ‰€åœ¨åœ†çš„åœ†å¿ƒâ€”â€”åŸå› æ˜¯è¿™ä¸‰ä¸ªç‚¹æœ€ä¼˜æƒ…å†µä¸‹ä¸€å®šæ˜¯åœ¨é¡¶ç‚¹ä¸Šçš„ã€‚é‚£ä¹ˆå¯ä»¥å‡­æ­¤æ±‚å‡ºåœ†å¿ƒå’ŒåŠå¾„ã€‚</p>
<p>ä¹‹åå¯¹äºè¯¥å¤šè¾¹å½¢ï¼Œæˆ‘ä»¬è€ƒè™‘ï¼Œç”±äºå…¶è®©æ±‚çš„æ­£å¤šè¾¹å½¢éœ€è¦<strong>é¢ç§¯æœ€å°</strong>ã€‚å¹¶ä¸”å¯¹äºç»™å‡ºçš„ä¸‰ä¸ªç‚¹ï¼Œç”±äºåœ¨æ­£å¤šè¾¹å½¢ä¸Šçš„åŸå› ï¼Œæ‰€ä»¥åœ†å¿ƒä¸å…¶è¿çº¿çš„è§’éƒ½åº”è¯¥æ˜¯<strong>è¯¥æ­£å¤šè¾¹å½¢ç›¸é‚»ä¸¤ä¸ªé¡¶ç‚¹åœ¨å¤–æ¥åœ†ä¸Šæ‰€å¯¹çš„åœ†å¿ƒè§’çš„æ•´æ•°å€</strong></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±åšä¸€ä¸ª<code>double</code>ç±»å‹çš„$\gcd$å°±å¥½äº†â€”â€”å› ä¸ºåœ¨å¤–æ¥åœ†å¤§å°ä¸€å®šæ—¶ï¼ˆä¸‰ç‚¹å·²ç¡®å®šä¸€ä¸ªåœ†ï¼‰ï¼Œå¯¹äºæ­£$n$è¾¹å½¢ï¼Œå…¶é¢ç§¯ä¸$n$æˆæ­£ç›¸å…³ã€‚æ‰€ä»¥å–$\gcd$ä¸€å®šæ˜¯ä¸ªæœ€å¥½çš„é€‰æ‹©ã€‚</p>
<p>æœ€åçš„é¢ç§¯å˜›â€¦å¤§æ¦‚åªéœ€è¦ä½™å¼¦å®šç†ä¸€ä¸‹å°±å¥½ã€‚æ­¤å¤„å€Ÿé‰´çš„æ˜¯ç¬¬ä¸€ç¯‡é¢˜è§£é‡Œé¢æ±‚é¢ç§¯çš„æ–¹æ³•ã€‚åŒæ—¶ï¼Œç¬¬ä¸‰ä¸ªè§’å¿…é¡»ç”¨$2\pi$å‡å»å¦å¤–ä¸¤ä¸ªè§’å¾—åˆ°ï¼Œå¦‚æœä¸è¿™æ ·è¯¯å·®ä¼šç›¸å½“çš„å¤§â€¦â€¦å°¤å…¶æ˜¯ä¹˜ä¸Šä¸€å †ä¹‹åï¼Œé¢ç§¯ä¼šå¾ˆä¸ç²¾ç¡®$qaq$</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Eps = <span class="number">1e-4</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1.00000</span>) ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">bool</span> mark ; <span class="comment">// 0 = exist, 1 = inexist ;</span></span><br><span class="line">    <span class="keyword">double</span> x, y ;</span><br><span class="line">&#125;A, B, C, O, m1, m2, m3 ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> mark ;<span class="comment">//0 : // x-axis, 1: // y-axis, 2: // normal ;</span></span><br><span class="line">    <span class="keyword">double</span> k, b ; <span class="keyword">double</span> x, y ; <span class="comment">// y = kx + b, x = k, y = k ;</span></span><br><span class="line">&#125;L[<span class="number">12</span>] ; <span class="keyword">double</span> Len[<span class="number">4</span>], agl[<span class="number">4</span>], R, angle ; <span class="keyword">int</span> i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">get_x</span><span class="params">(Line A, Line B)</span></span>&#123; <span class="keyword">return</span> A.mark == <span class="number">0</span> ? A.x : B.x ; &#125; <span class="comment">//which is x = k ;</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">get_y</span><span class="params">(Line A, Line B)</span></span>&#123; <span class="keyword">return</span> A.mark == <span class="number">1</span> ? A.y : B.y ; &#125; <span class="comment">//which is y = k ;</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dis</span><span class="params">(Node A, Node B)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>((A.x - B.x) * (A.x - B.x) + (A.y - B.y) * (A.y - B.y)) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Node <span class="title">get_Mid</span><span class="params">(Node A, Node B)</span></span>&#123; <span class="keyword">return</span> (Node)&#123;<span class="number">0</span>, (A.x + B.x) / <span class="number">2</span>, (A.y + B.y) / <span class="number">2</span> &#125; ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Line <span class="title">get_verti</span><span class="params">(Node n, Line a)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!a.mark) <span class="keyword">return</span> (Line) &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, n.y&#125; ;</span><br><span class="line">    <span class="keyword">if</span> (a.mark == <span class="number">1</span>) <span class="keyword">return</span> (Line) &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, n.x, <span class="number">0</span>&#125; ;</span><br><span class="line">    <span class="keyword">double</span> kk = <span class="number">-1.0</span> / a.k, bb = n.y - n.x * kk ; </span><br><span class="line">  	<span class="keyword">return</span> (Line)&#123;<span class="number">2</span>, kk, bb, <span class="number">0</span>, <span class="number">0</span> &#125; ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Line <span class="title">get_Line</span><span class="params">(Node A, Node B)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (A. y == B. y) <span class="keyword">return</span> (Line)&#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, B.y&#125; ;</span><br><span class="line">    <span class="keyword">if</span> (A. x == B. x) <span class="keyword">return</span> (Line)&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, A.x, <span class="number">0</span>&#125; ;</span><br><span class="line">    <span class="keyword">double</span> kk = (A.y - B.y) / (A.x - B.x), bb = A.y - A.x * kk ; </span><br><span class="line">  	<span class="keyword">return</span> (Line)&#123;<span class="number">2</span>, kk, bb, <span class="number">0</span>, <span class="number">0</span>&#125; ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Node <span class="title">get_inter</span><span class="params">(Line A, Line B)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (A.mark == B.mark &amp;&amp; (A.mark == <span class="number">1</span> || A.mark == <span class="number">0</span>) )</span><br><span class="line">      <span class="keyword">return</span> (Node)&#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span> &#125; ;</span><br><span class="line">    <span class="keyword">if</span> ((A.mark == <span class="number">1</span> &amp;&amp; B.mark == <span class="number">0</span>) || (A.mark == <span class="number">0</span> &amp;&amp; B.mark == <span class="number">1</span>)) </span><br><span class="line">      <span class="keyword">return</span> (Node)&#123;<span class="number">0</span>, get_x(A, B), get_y(A, B)&#125; ;</span><br><span class="line">    <span class="keyword">if</span> (A.mark == <span class="number">1</span> &amp;&amp; B.mark == <span class="number">2</span>) <span class="keyword">return</span> (Node)&#123;<span class="number">0</span>, (A.y - B.b) / B.k, A.y&#125; ;</span><br><span class="line">    <span class="keyword">if</span> (A.mark == <span class="number">2</span> &amp;&amp; B.mark == <span class="number">1</span>) <span class="keyword">return</span> (Node)&#123;<span class="number">0</span>, (B.y - A.b) / A.k, B.y&#125; ;</span><br><span class="line">    <span class="keyword">if</span> (A.mark == <span class="number">2</span> &amp;&amp; B.mark == <span class="number">0</span>) <span class="keyword">return</span> (Node)&#123;<span class="number">0</span>, B.x, B.x * A.k + A.b&#125; ;</span><br><span class="line">    <span class="keyword">if</span> (A.mark == <span class="number">0</span> &amp;&amp; B.mark == <span class="number">2</span>) <span class="keyword">return</span> (Node)&#123;<span class="number">0</span>, A.x, A.x * B.k + B.b&#125; ;</span><br><span class="line">    <span class="keyword">return</span> (Node)&#123;<span class="number">0</span>, (A.b - B.b) / (B.k - A.k), (A.b - B.b) / (B.k - A.k) * A.k + A.b&#125; ;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">gcd</span><span class="params">(<span class="keyword">double</span> a,<span class="keyword">double</span> b)</span> </span>&#123;  </span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">fabs</span>(b) &lt; Eps) <span class="keyword">return</span> a ; </span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">fabs</span>(a) &lt; Eps) <span class="keyword">return</span> b ; </span><br><span class="line">  <span class="keyword">return</span> gcd(b, <span class="built_in">fmod</span>(a, b)) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; A.x &gt;&gt; A.y &gt;&gt; B.x &gt;&gt; B.y &gt;&gt; C.x &gt;&gt; C.y ; </span><br><span class="line">  	A.mark = B.mark = C.mark = <span class="number">0</span> ;</span><br><span class="line">    L[<span class="number">1</span>] = get_Line(A, B), L[<span class="number">2</span>] = get_Line(B, C), L[<span class="number">3</span>] = get_Line(A, C) ; </span><br><span class="line">  	m1 = get_Mid(A, B), m2 = get_Mid(B, C), m3 = get_Mid(A, C) ;</span><br><span class="line">    L[<span class="number">4</span>] = get_verti(m1, L[<span class="number">1</span>]), L[<span class="number">5</span>] = get_verti(m2, L[<span class="number">2</span>]) ;</span><br><span class="line">  	O = get_inter(L[<span class="number">4</span>], L[<span class="number">5</span>]), R = (dis(O, A) + dis(O, B) + dis(O, C)) / <span class="number">3.0</span> ;</span><br><span class="line">    Len[<span class="number">1</span>] = dis(A, B), Len[<span class="number">2</span>] = dis(B, C), Len[<span class="number">3</span>] = dis(A, C) ; </span><br><span class="line">  	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= <span class="number">3</span> ; ++ i) agl[i] = <span class="built_in">acos</span>(<span class="number">1</span> - Len[i] * Len[i] / (<span class="number">2</span> * R * R) ); </span><br><span class="line">    agl[<span class="number">3</span>] = <span class="number">2</span> * Pi - agl[<span class="number">1</span>] - agl[<span class="number">2</span>], angle = gcd(agl[<span class="number">3</span>], gcd(agl[<span class="number">1</span>], agl[<span class="number">2</span>])) ; 		<span class="built_in">printf</span>(<span class="string">"%.6lf\n"</span>, (Pi * R * R * <span class="built_in">sin</span>(angle)) / angle) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·2B"><a href="#rm-CFÂ·2B" class="headerlink" title="$\rm CFÂ·2B$"></a>$\rm CFÂ·2B$</h1><blockquote>
<p>ç»™å®šç”±éè´Ÿæ•´æ•°ç»„æˆçš„$n \times n$çš„æ­£æ–¹å½¢çŸ©é˜µï¼Œå¯»æ‰¾ä¸€æ¡è·¯å¾„ï¼Œä»¥å·¦ä¸Šè§’ä¸ºèµ·ç‚¹, æ¯æ¬¡åªèƒ½å‘å³æˆ–å‘ä¸‹èµ°</p>
<p>ä»¥å³ä¸‹è§’ä¸ºç»ˆç‚¹ã€‚å¹¶ä¸”ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæ²¿è·¯é‡åˆ°çš„æ•°è¿›è¡Œç›¸ä¹˜ï¼Œç§¯åº”å½“ä»¥æœ€å°æ•°ç›®çš„$0$çš„ç»“å°¾.</p>
<p>$n\leq 1,000$</p>
</blockquote>
<p>è€ƒè™‘$0$æ˜¯æ€ä¹ˆæ¥çš„ï¼Œé‚£æ˜¾ç„¶æ˜¯$\times\text{=10}=2\times 5$ã€‚æ‰€ä»¥å°±æŠŠ$2,5$åˆ†å¼€$dp$ã€‚æ–¹ç¨‹ä¹Ÿå¾ˆç®€å•ï¼Œå°±ä»å·¦è¾¹å’Œä¸Šè¾¹å¡«ä¸€ä¸‹è¡¨å°±å¥½äº†ã€‚ç„¶åå¦‚æœåŸæ¥çŸ©é˜µé‡Œé¢æœ‰$0$å¹¶ä¸”æœ€åç­”æ¡ˆ$&gt;1$ï¼Œé‚£ä¹ˆå°±åº”è¯¥èµ°$0$ï¼›å¦åˆ™å°±è¾“å‡ºè·¯å¾„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qwq</span><span class="params">(<span class="keyword">int</span> &amp;N, <span class="keyword">int</span> fac)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!N) &#123; zerox = i, zeroy = j ; <span class="keyword">return</span> <span class="number">1</span> ; &#125;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span> ; <span class="keyword">while</span> (!(N % fac)) ++ res, N /= fac ; <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Print</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> mark, <span class="keyword">int</span> kind)</span></span>&#123; <span class="comment">//mark 1 : D, 2 : R ;</span></span><br><span class="line">    <span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; x &lt;&lt; " " &lt;&lt; y &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">if</span> (kind == <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (x - <span class="number">1</span> &amp;&amp; dp2[x][y] == dp2[x - <span class="number">1</span>][y] + base[x][y][kind]) </span><br><span class="line">          Print(x - <span class="number">1</span>, y, <span class="number">1</span>, kind) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (y - <span class="number">1</span> &amp;&amp; dp2[x][y] == dp2[x][y - <span class="number">1</span>] + base[x][y][kind]) </span><br><span class="line">          Print(x, y - <span class="number">1</span>, <span class="number">2</span>, kind) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; dp5[x][y] &lt;&lt; " " &lt;&lt; dp5[x - 1][y] &lt;&lt; " " &lt;&lt; dp5[x][y - 1] &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">if</span> (x - <span class="number">1</span> &amp;&amp; dp5[x][y] == dp5[x - <span class="number">1</span>][y] + base[x][y][kind]) </span><br><span class="line">          Print(x - <span class="number">1</span>, y, <span class="number">1</span>, kind) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (y - <span class="number">1</span> &amp;&amp; dp5[x][y] == dp5[x][y - <span class="number">1</span>] + base[x][y][kind]) </span><br><span class="line">          Print(x, y - <span class="number">1</span>, <span class="number">2</span>, kind) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!mark) <span class="keyword">return</span> ; <span class="keyword">if</span> (mark == <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"D"</span>) ; <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"R"</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i][j][<span class="number">0</span>]) ;</span><br><span class="line">    <span class="built_in">memset</span>(dp2, <span class="number">63</span>, <span class="keyword">sizeof</span>(dp2)), dp2[<span class="number">1</span>][<span class="number">0</span>] = dp2[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(dp5, <span class="number">63</span>, <span class="keyword">sizeof</span>(dp5)), dp5[<span class="number">1</span>][<span class="number">0</span>] = dp5[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span> ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">            dp2[i][j] = min(dp2[i - <span class="number">1</span>][j], dp2[i][j - <span class="number">1</span>]) </span><br><span class="line">          						+ (base[i][j][<span class="number">1</span>] = qwq(base[i][j][<span class="number">0</span>], <span class="number">2</span>)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">            dp5[i][j] = min(dp5[i - <span class="number">1</span>][j], dp5[i][j - <span class="number">1</span>]) </span><br><span class="line">          						+ (base[i][j][<span class="number">2</span>] = qwq(base[i][j][<span class="number">0</span>], <span class="number">5</span>)) ;</span><br><span class="line">    Ans = min(dp5[N][N], dp2[N][N]) ;</span><br><span class="line">    <span class="keyword">if</span> (Ans &gt; <span class="number">1</span> &amp;&amp; zerox &amp;&amp; zeroy)&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">        <span class="comment">// cout &lt;&lt; zerox &lt;&lt; zeroy &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; zerox ; ++ i) <span class="built_in">printf</span>(<span class="string">"D"</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; zeroy ; ++ i) <span class="built_in">printf</span>(<span class="string">"R"</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (i = zerox + <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">printf</span>(<span class="string">"D"</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (i = zeroy + <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">printf</span>(<span class="string">"R"</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">  		dp5[N][N] &gt; dp2[N][N] ? Print(N, N, <span class="number">0</span>, <span class="number">1</span>) : Print(N, N, <span class="number">0</span>, <span class="number">2</span>) ;</span><br><span class="line">    &#125; </span><br><span class="line">  	<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CF-Â·2C"><a href="#rm-CF-Â·2C" class="headerlink" title="$\rm CF Â·2C$"></a>$\rm CF Â·2C$</h1><blockquote>
<p>ç»™å‡ºä¸‰ä¸ªäº’ä¸ç›¸äº¤çš„åœ†ï¼Œæ±‚ä¸€ä¸ªç‚¹ä½¿å¾—åˆ°è¿™ä¸‰ä¸ªåœ†çš„åˆ‡çº¿å¤¹è§’ç›¸åŒã€‚</p>
</blockquote>
<p><del>å’‹åˆæ˜¯è®¡ç®—å‡ ä½•å•Š</del></p>
<p>è®¾è¿™ç‚¹ä¸º$T$ï¼Œ ä¸‰ä¸ªåœ†å¿ƒåˆ†åˆ«ä¸º$A, B,C$ã€‚è€Œåœ†$A$çš„åŠå¾„$r_A$ä¸$dis(A,T)$çš„æ¯”å€¼ï¼Œå°±æ˜¯$sin(\frac{1}{2}\angle A_1TA_2)$ï¼Œå…¶ä¸­$A_1$å’Œ$A_2$æ˜¯è¿‡Tçš„åœ†Açš„ä¸¤æ¡åˆ‡çº¿ä¸åœ†çš„äº¤ç‚¹ã€‚</p>
<p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¦‚æœæœ‰$\angle A_1TA_2 = \angle B_1TB_2= \angle C_1TC_2$ï¼Œé‚£ä¹ˆä¸€å®šæœ‰<script type="math/tex">\frac{r_A}{dis(A,T)} = \frac{r_B}{dis(B,T)} = \frac{r_C}{dis(C,T)}</script></p>
<p>ç¨å¾®ç§»ä¸€ä¸‹é¡¹ï¼Œå°±ä¼šæœ‰<script type="math/tex">\frac{r_A}{r_B} = \frac{dis(A,T)}{dis(B,T)}</script></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å‘ç°ï¼Œå¯¹äºä¸¤ä¸ªç‚¹è€Œè¨€ï¼Œæˆ‘ä»¬è¦æ‰¾çš„ç›®æ ‡ç‚¹$T$æ»¡è¶³åˆ°ä¸¤ä¸ªç‚¹çš„è·ç¦»ç­‰äºä¸€ä¸ªç»™å®šçš„æ¯”ä¾‹ï¼ˆ$r_A$å’Œ$r_B$ç»™å®šï¼‰ã€‚</p>
<p>äº‹å®ä¸Šï¼Œè¿™æ ·çš„ç‚¹çš„è½¨è¿¹æ˜¯å¯ä»¥åˆ»ç”»çš„ã€‚æˆ‘ä»¬åˆ—ä¸€ä¸ªæ–¹ç¨‹å³å¯ï¼š</p>
<p>è®¾æ¯”ä¾‹ç³»æ•°ä¸º$k(k \geq 1)$, é‚£ä¹ˆï¼š</p>
<script type="math/tex; mode=display">
\frac{\sqrt{(x_T - x_A)^2 + (y_T - y_A)^2 }}{\sqrt{(x_T - x_B)^2 + (y_T - y_B)^2 }} = k\\
\frac{(x_T - x_A)^2 + (y_T - y_A)^2 }{(x_T - x_B)^2 + (y_T - y_B)^2 } = k^2</script><p>ç¨å¾®ç§»ä¸€ä¸‹é¡¹å°±ä¼šå¾—åˆ°</p>
<script type="math/tex; mode=display">
(k^2-1)x_T^2 + (k^2-1)y_T^2 - 2(k^2y_B - y_A)y_T - 2(k^2x_B - x_A)x_T+k^2x_B^2 - x_A^2 + k^2y_B^2 - y_A^2 = 0</script><p>çœ‹èµ·æ¥æœ‰ç‚¹å„¿é•¿â€¦â€¦</p>
<p>ä»¤$A = k^2-1, C = - 2(k^2x_B - x_A), D = -2(k^2y_B - y_A), E = k^2x_B^2 - x_A^2 + k^2y_B^2 - y_A^2$</p>
<p>é‚£ä¹ˆå°±ä¼šå˜æˆ</p>
<script type="math/tex; mode=display">
Ax^2 + Ay^2+ Cx + Dy+E = 0</script><p>ç”±äº$A,C,D,E$éƒ½æ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ª<strong>åœ†çš„ä¸€èˆ¬æ–¹ç¨‹ã€‚</strong></p>
<p>æˆ‘ä»¬å…¶å®ä¹Ÿå¯ä»¥å‘ç°ï¼Œå½“$k=1$æ—¶ã€‚æ­¤æ—¶ä¸ºä¸€æ¡ç›´çº¿ï¼ˆå³ä¸­å‚çº¿ï¼‰ï¼Œæ¢å¥è¯è¯´<strong>å½“ä¸”ä»…å½“ä¸¤ä¸ªåœ†åŠå¾„ç›¸ç­‰æ—¶ï¼Œç‚¹$T$çš„è½¨è¿¹æ˜¯ä¸€æ¡ç›´çº¿</strong>ã€‚å…¶ä½™çš„æƒ…å†µåˆ™æ˜¯<strong>ä¸€ä¸ªåœ†</strong>ã€‚</p>
<p>æˆ‘ä»¬ä¸å¦¨å…ˆè®°è¿™ç§<strong>åˆ°ä¸¤ä¸ªåœ†çš„åœ†å¿ƒçš„è·ç¦»æˆå®šæ¯”ä¾‹çš„</strong>è½¨è¿¹ä¸ºä¸¤ä¸ªåœ†çš„<strong>ç”Ÿæˆæ›²çº¿</strong>ã€‚</p>
<p>é‚£ä¹ˆä¹‹åå‘¢ï¼Œæˆ‘ä»¬å‘ç°ï¼Œåœ†$A$å’Œåœ†$C$çš„ç”Ÿæˆæ›²çº¿ï¼Œä¸åœ†$A$å’Œåœ†$B$çš„ç”Ÿæˆæ›²çº¿ï¼Œè‡³å¤šæœ‰ä¸¤ä¸ªäº¤ç‚¹ã€‚é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ï¼š</p>
<ul>
<li>$(1)~~$åˆ¤æ–­ä¸‰ç»„åœ†çš„ç”Ÿæˆæ›²çº¿æ˜¯å¦éƒ½ç›¸äº¤ä¸”äº¤äºä¸€ç‚¹ï¼Œä¸æ˜¯åˆ™æ— è§£ã€‚</li>
<li>$(2)~~$å¯¹äºå…¶ä¸­ä¸¤ä¸ªåœ†çš„ç”Ÿæˆæ›²çº¿çš„äº¤ç‚¹ï¼Œåˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œå³æ˜¯æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†ç¬¦åˆ<script type="math/tex">\frac{r_A}{r_B} = \frac{dis(A,T)}{dis(B,T)}</script>çš„ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­å¯¹äºåœ†$C$æ˜¯å¦ä¹Ÿæ»¡è¶³<script type="math/tex; mode=display">
\frac{r_A}{r_C} = \frac{dis(A,T)}{dis(C,T)}</script></li>
<li>$(3)~~$å¦‚æœé€‰å–çš„ç”Ÿæˆæ›²çº¿æ°å¥½æœ‰$2$ä¸ªäº¤ç‚¹ä¸”ä¸¤ä¸ªäº¤ç‚¹$Tâ€™,Tâ€™â€™$éƒ½æ»¡è¶³$(2)$ä¸­çš„æ¡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬é€‰$sin$å€¼æœ€å¤§çš„ï¼ˆå¯¹äº$\leq \frac{\pi}{2}$çš„è§’ï¼Œ$sin$å€¼ä¸è§’çš„å¤§å°æˆæ­£ç›¸å…³ï¼‰ã€‚</li>
</ul>
<p>ç„¶åç®—æ³•å°±ç»“æŸäº†ã€‚ä¸­é—´è¿˜æœ‰å¥½å¤šå¥½å¤šå¥½å¤šé—®é¢˜ï¼Œæ¯”å¦‚åœ†ä¸åœ†çš„äº¤ç‚¹æ€ä¹ˆæ±‚ï¼Œç›´çº¿ä¸ç›´çº¿çš„äº¤ç‚¹æ€ä¹ˆæ±‚ï¼Œåœ†ä¸ç›´çº¿çš„äº¤ç‚¹æ€ä¹ˆæ±‚â€¦â€¦æœç„¶æ˜¯é“ä½“åŠ›é¢˜233</p>
<p>ä»£ç å¾ˆç¹ç233</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Eps = <span class="number">1e-3</span> ; <span class="keyword">int</span> i ;<span class="comment">//ä»¥ä¸‹çš„markéƒ½æ˜¯è®°å½•çŠ¶æ€</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span> <span class="keyword">int</span> mark ; <span class="keyword">double</span> xa, ya, xb, yb ; &#125; I[<span class="number">5</span>] ; </span><br><span class="line"><span class="comment">// 0 = inexist, 1 = exist*1, 2 = exist*2 ;</span></span><br><span class="line"><span class="comment">//æ­¤å¤„æˆ‘çš„Nodeå­˜çš„å®é™…ä¸Šæ˜¯ä¸¤ä¸ªç‚¹ï¼Œå³ä¸€ä¸ªä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹çš„ä¸¤ä¸ªè§£ã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span>&#123;</span> <span class="keyword">int</span> mark ; <span class="keyword">double</span> k, b ; <span class="keyword">double</span> x, y ; &#125;L[<span class="number">12</span>] ; </span><br><span class="line"><span class="comment">//0 : // x-axis, 1: // y-axis, 2: // normal ;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Circle</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> mark ; <span class="comment">// 1 : circle ; 0 : Line ;</span></span><br><span class="line">    <span class="keyword">double</span> x, y, r ;</span><br><span class="line">    <span class="keyword">double</span> A, B, C, D, E ;</span><br><span class="line">    Circle <span class="keyword">friend</span> <span class="keyword">operator</span> -(<span class="keyword">const</span> Circle &amp;A, <span class="keyword">const</span> Circle &amp;B)&#123;</span><br><span class="line">        <span class="keyword">return</span> (Circle)&#123;<span class="number">0</span>, A.x - B.x, A.y - B.y, A.r - B.r, A.A - B.A, A.B - B.B, A.C - B.C, A.D - B.D, A.E - B.E&#125; ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;C[<span class="number">10</span>] ;</span><br><span class="line"><span class="keyword">double</span> ansx, ansy ; <span class="keyword">bool</span> check ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Comp</span><span class="params">(Node A, Node B)</span></span>&#123; <span class="keyword">return</span> A.mark &lt; B.mark ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">get_x</span><span class="params">(Line A, Line B)</span></span>&#123; <span class="keyword">return</span> A.mark == <span class="number">0</span> ? A.x : B.x ; &#125; <span class="comment">//which is (x = k) ;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">get_y</span><span class="params">(Line A, Line B)</span></span>&#123; <span class="keyword">return</span> A.mark == <span class="number">1</span> ? A.y : B.y ; &#125; <span class="comment">//which is (y = k) ;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">equal</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y)</span></span>&#123; <span class="keyword">return</span> (x - y &lt;= Eps) &amp;&amp; (x - y &gt;= -Eps) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">disa</span><span class="params">(Node A, Node B)</span></span>&#123; </span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">sqrt</span>((A.xa - B.xa) * (A.xa - B.xa) + (A.ya - B.ya) * (A.ya - B.ya)); </span><br><span class="line">&#125;<span class="comment">//ç¬¬ä¸€ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">disb</span><span class="params">(Node A, Node B)</span></span>&#123; </span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">sqrt</span>((A.xb - B.xb) * (A.xb - B.xb) + (A.yb - B.yb) * (A.yb - B.yb)); </span><br><span class="line">&#125;<span class="comment">//ç¬¬äºŒä¸ªç‚¹ä¹‹é—´çš„è·ç¦»</span></span><br><span class="line"><span class="comment">//å‘ƒâ€¦â€¦æˆ‘æ‰¿è®¤ä¸¤ä¸ªdiså†™çš„å¾ˆéº»çƒ¦â€¦â€¦ä½†æ˜¯å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆå¾ˆç®€å•çš„æ³•å­</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> Node <span class="title">Line_inter</span><span class="params">(Line A, Line B)</span></span>&#123;<span class="comment">//æ–œæˆªå¼ç›´çº¿æ±‚äº¤ç‚¹ï¼ˆä¹‹å‰å†™çš„ç›´æ¥copyè¿‡æ¥çš„ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> (A.mark == B.mark &amp;&amp; (A.mark == <span class="number">1</span> || A.mark == <span class="number">0</span>) ) </span><br><span class="line">      <span class="keyword">return</span> (Node)&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125; ;</span><br><span class="line">    <span class="keyword">if</span> ((A.mark == <span class="number">1</span> &amp;&amp; B.mark == <span class="number">0</span>) || (A.mark == <span class="number">0</span> &amp;&amp; B.mark == <span class="number">1</span>)) </span><br><span class="line">      <span class="keyword">return</span> (Node)&#123;<span class="number">1</span>, get_x(A, B), get_y(A, B), <span class="number">0</span>, <span class="number">0</span>&#125; ;</span><br><span class="line">    <span class="keyword">if</span> (A.mark == <span class="number">1</span> &amp;&amp; B.mark == <span class="number">2</span>) </span><br><span class="line">      <span class="keyword">return</span> (Node)&#123;<span class="number">1</span>, (A.y - B.b) / B.k, A.y, <span class="number">0</span>, <span class="number">0</span>&#125; ;</span><br><span class="line">    <span class="keyword">if</span> (A.mark == <span class="number">2</span> &amp;&amp; B.mark == <span class="number">1</span>) </span><br><span class="line">      <span class="keyword">return</span> (Node)&#123;<span class="number">1</span>, (B.y - A.b) / A.k, B.y, <span class="number">0</span>, <span class="number">0</span>&#125; ;</span><br><span class="line">    <span class="keyword">if</span> (A.mark == <span class="number">2</span> &amp;&amp; B.mark == <span class="number">0</span>) </span><br><span class="line">      <span class="keyword">return</span> (Node)&#123;<span class="number">1</span>, B.x, B.x * A.k + A.b, <span class="number">0</span>, <span class="number">0</span>&#125; ;</span><br><span class="line">    <span class="keyword">if</span> (A.mark == <span class="number">0</span> &amp;&amp; B.mark == <span class="number">2</span>) </span><br><span class="line">      <span class="keyword">return</span> (Node)&#123;<span class="number">1</span>, A.x, A.x * B.k + B.b, <span class="number">0</span>, <span class="number">0</span>&#125; ;</span><br><span class="line">    <span class="keyword">return</span> (Node)&#123;<span class="number">1</span>, (A.b - B.b) / (B.k - A.k), (A.b - B.b) / (B.k - A.k) * A.k + A.b, <span class="number">0</span>, <span class="number">0</span>&#125; ;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Node <span class="title">get_inter</span> <span class="params">(Circle A, Circle B)</span></span>&#123;<span class="comment">//â€œç”Ÿæˆæ›²çº¿â€æ±‚äº¤ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> ((A.mark == <span class="number">0</span> &amp;&amp; B.mark) || (A.mark &amp;&amp; B.mark == <span class="number">0</span>))&#123;<span class="comment">//ä¸€æ¡æ˜¯ç›´çº¿ï¼Œä¸€ä¸ªæ˜¯åœ†</span></span><br><span class="line">        <span class="keyword">if</span> (!A.mark) &#123;Circle C ; C = A, A = B, B = C ;&#125; <span class="comment">// B is a line ;</span></span><br><span class="line">        <span class="keyword">double</span> a = <span class="number">1</span> + (B.C / B.D) * (B.C / B.D), del ;</span><br><span class="line">        <span class="keyword">double</span> c = A.E - B.E * A.D / B.D + B.E * B.E /((B.D) * (B.D)) ;</span><br><span class="line">        <span class="keyword">double</span> b = (A.C - B.C * A.D / B.D + <span class="number">2</span> * B.C * B.E /((B.D) * (B.D)) ) ; </span><br><span class="line">        <span class="keyword">if</span> ((del = (b * b - <span class="number">4</span> * a * c)) &lt; -Eps) <span class="keyword">return</span> (Node)&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125; ; </span><br><span class="line">        <span class="comment">// printf("%lf %lf %lf %lf\n", a, b, c, del) ;</span></span><br><span class="line">        <span class="keyword">double</span> xa =  (-b + <span class="built_in">sqrt</span>(del)) / (<span class="number">2</span> * a), xb = (-b - <span class="built_in">sqrt</span>(del)) / (<span class="number">2</span> * a) ;</span><br><span class="line">        <span class="keyword">double</span> ya = -B.C / B.D * xa - B.E / B.D, yb = -B.C / B.D * xb - B.E / B.D ; </span><br><span class="line">        <span class="comment">// cout &lt;&lt; "-----------------" &lt;&lt; xa &lt;&lt; " " &lt;&lt; ya &lt;&lt; " " &lt;&lt; xb &lt;&lt; " " &lt;&lt; yb &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">return</span> (Node)&#123;<span class="number">2</span>, xa, ya, xb, yb&#125; ;<span class="comment">//æ­¤å¤„ç”±äºè¯¯å·®ç­‰åŸå› ï¼Œä¸å®¹æ˜“åˆ¤æ–­æ˜¯å¦delta=0çš„æƒ…å†µï¼Œæ‰€å¦‚æœdelta=0ç›´æ¥è®°å½•ä¸¤éï¼Œä¸å½±å“ç»“æœ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!A.mark &amp;&amp; !B.mark)&#123;</span><br><span class="line">        Line La, Lb ; <span class="comment">//ä¸¤æ¡éƒ½æ˜¯ç›´çº¿ï¼Œé‚£ä¹ˆå°±ç›´æ¥è½¬åŒ–æˆæ–œæˆªå¼æ±‚ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (!A.C) La = (Line)&#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, - A.E / A.D&#125; ; </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!A.D) La = (Line)&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -A.E / A.C, <span class="number">0</span>&#125; ; <span class="keyword">else</span> La = (Line)&#123;<span class="number">2</span>, -A.C / A.D, -A.E / A.D, <span class="number">0</span>, <span class="number">0</span>&#125; ;</span><br><span class="line">        <span class="keyword">if</span> (!B.C) Lb = (Line)&#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, - B.E / B.D&#125; ; </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!B.D) Lb = (Line)&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -B.E / B.C, <span class="number">0</span>&#125; ; <span class="keyword">else</span> Lb = (Line)&#123;<span class="number">2</span>, -B.C / B.D, -B.E / B.D, <span class="number">0</span>, <span class="number">0</span>&#125; ;  </span><br><span class="line">        <span class="keyword">return</span> Line_inter(La, Lb) ; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span> (A.mark &amp;&amp; B.mark)&#123;</span><br><span class="line">        Circle C = A - B ; <span class="keyword">return</span> get_inter(C, A) ;</span><br><span class="line">        <span class="comment">//æ­¤å¤„éœ€è¦ç”¨åˆ°ä¸€ç‚¹å°çŸ¥è¯†ï¼Œå°±æ˜¯ä¸¤ä¸ªåœ†çš„äº¤ç‚¹å¾ˆéš¾æ±‚ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›¸å‡æ±‚å‡ºäº¤çº¿æ¥ï¼ˆå¿…ä¿®äºŒçŸ¥è¯†ç‚¹ï¼‰ï¼Œé‚£ä¹ˆå°±ç›´æ¥æŠŠè¿™æ¡çº¿ä»£å›ç¬¬ä¸€ä¸ªifé‡Œå°±å¥½ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Circle <span class="title">make_rat</span><span class="params">(Circle A, Circle B)</span></span>&#123;<span class="comment">//rat = ratio[n.]æ¯”ä¾‹ï¼›æ¯”ç‡ï¼Œç”¨æ¥æ±‚ç”Ÿæˆæ›²çº¿çš„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">double</span> _k2 = (A.r / B.r) * (A.r / B.r) ; Circle Ans ; <span class="keyword">double</span> t ; </span><br><span class="line">    Ans.A = Ans.B = (_k2 - <span class="number">1</span>), </span><br><span class="line">  	Ans.C = <span class="number">-2</span> * (_k2 * B.x - A.x), </span><br><span class="line">  	Ans.D = <span class="number">-2</span> * (_k2 * B.y - A.y), </span><br><span class="line">    Ans.E = (_k2 * B.x * B.x - A.x * A.x) + (_k2 * B.y * B.y - A.y * A.y), </span><br><span class="line">  	Ans.x = Ans.y = Ans.r = <span class="number">0</span> ; </span><br><span class="line">    <span class="keyword">if</span> (Ans.A != <span class="number">0</span>) </span><br><span class="line">      Ans.mark = <span class="number">1</span>, t = Ans.A, Ans.A /= t, </span><br><span class="line">  		Ans.B /= t, Ans.C /= t, Ans.D /= t, Ans.E /= t ; </span><br><span class="line">  	<span class="keyword">else</span> Ans.mark = <span class="number">0</span> ; </span><br><span class="line">  	<span class="keyword">return</span> Ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">make_for_Ans</span><span class="params">()</span></span>&#123;<span class="comment">//æœ€åçš„ç»“æœï¼Œåˆ¤æ–­é€‰å“ªä¸ªäº¤ç‚¹</span></span><br><span class="line">    sort(I + <span class="number">1</span>, I + <span class="number">3</span>, Comp) ;<span class="comment">//æˆ‘é—²çš„ï¼Œæ–¹ä¾¿ä¸€ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> (I[<span class="number">1</span>].mark &lt;= <span class="number">1</span>) ansx = I[<span class="number">1</span>].xa, ansy = I[<span class="number">1</span>].ya ;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">double</span> A1, A11, B1, B11 ;</span><br><span class="line">        I[<span class="number">1</span>] = get_inter(C[<span class="number">4</span>], C[<span class="number">5</span>]) ;</span><br><span class="line">        A1 = disa(I[<span class="number">1</span>], (Node)&#123;<span class="number">0</span>, C[<span class="number">1</span>].x, C[<span class="number">1</span>].y, <span class="number">0</span>, <span class="number">0</span>&#125;) / C[<span class="number">1</span>].r ; </span><br><span class="line">        A11 = disa(I[<span class="number">1</span>], (Node)&#123;<span class="number">0</span>, C[<span class="number">3</span>].x, C[<span class="number">3</span>].y, <span class="number">0</span>, <span class="number">0</span>&#125;) / C[<span class="number">3</span>].r ;</span><br><span class="line">        B1 = disb(I[<span class="number">1</span>], (Node)&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, C[<span class="number">1</span>].x, C[<span class="number">1</span>].y&#125;) / C[<span class="number">1</span>].r ; </span><br><span class="line">        B11 = disb(I[<span class="number">1</span>], (Node)&#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, C[<span class="number">3</span>].x, C[<span class="number">3</span>].y&#125;) / C[<span class="number">3</span>].r ;</span><br><span class="line">        <span class="keyword">if</span> (equal(A1, A11) &amp;&amp; !equal(B1, B11)) ansx = I[<span class="number">1</span>].xa, ansy = I[<span class="number">1</span>].ya ; </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!equal(A1, A11) &amp;&amp; equal(B1, B11)) ansx = I[<span class="number">1</span>].xb, ansy = I[<span class="number">1</span>].yb ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!equal(A1, A11) &amp;&amp; !equal(B1, B11)) </span><br><span class="line">          	check = <span class="number">1</span> ;<span class="comment">//å¦‚æœåœ¨è¯¯å·®èŒƒå›´å†…éƒ½ä¸ç›¸ç­‰å°±è¯´æ˜æ— è§£ã€‚</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">double</span> Ja = <span class="built_in">sin</span>(<span class="number">1</span> / A1), Jb = <span class="built_in">sin</span>(<span class="number">1</span> / B1) ;<span class="comment">//æ¯”è¾ƒè§’çš„å¤§å°ï¼Œé€šè¿‡sinæ¥æ</span></span><br><span class="line">            <span class="keyword">if</span> (Ja &gt; Jb) ansx = I[<span class="number">1</span>].xa, ansy = I[<span class="number">1</span>].ya ; </span><br><span class="line">          	<span class="keyword">else</span> ansx = I[<span class="number">1</span>].xb, ansy = I[<span class="number">1</span>].yb ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= <span class="number">3</span> ; ++ i) </span><br><span class="line">      	<span class="built_in">cin</span> &gt;&gt; C[i].x &gt;&gt; C[i].y &gt;&gt; C[i].r ;</span><br><span class="line">    C[<span class="number">4</span>] = make_rat(C[<span class="number">1</span>], C[<span class="number">2</span>]), </span><br><span class="line">  	C[<span class="number">5</span>] = make_rat(C[<span class="number">2</span>], C[<span class="number">3</span>]), </span><br><span class="line">  	C[<span class="number">6</span>] = make_rat(C[<span class="number">3</span>], C[<span class="number">1</span>]), </span><br><span class="line">    I[<span class="number">1</span>] = get_inter(C[<span class="number">4</span>], C[<span class="number">5</span>]), </span><br><span class="line">  	I[<span class="number">2</span>] = get_inter(C[<span class="number">5</span>], C[<span class="number">6</span>]), </span><br><span class="line">  	I[<span class="number">3</span>] = get_inter(C[<span class="number">4</span>], C[<span class="number">6</span>]) ; </span><br><span class="line">    <span class="comment">/*cout &lt;&lt; I[1].xa &lt;&lt; " " &lt;&lt; I[1].xb &lt;&lt; " " &lt;&lt; I[1].ya &lt;&lt; " " &lt;&lt; I[1].yb &lt;&lt; " " &lt;&lt; I[1].mark &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; I[2].xa &lt;&lt; " " &lt;&lt; I[2].xb &lt;&lt; " " &lt;&lt; I[2].ya &lt;&lt; " " &lt;&lt; I[2].yb &lt;&lt; " " &lt;&lt; I[2].mark &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; I[3].xa &lt;&lt; " " &lt;&lt; I[3].xb &lt;&lt; " " &lt;&lt; I[3].ya &lt;&lt; " " &lt;&lt; I[3].yb &lt;&lt; " " &lt;&lt; I[3].mark &lt;&lt; endl ;*/</span></span><br><span class="line">    <span class="keyword">if</span> (!I[<span class="number">1</span>].mark || !I[<span class="number">2</span>].mark || !I[<span class="number">3</span>].mark) <span class="keyword">return</span> <span class="built_in">putchar</span>(<span class="string">'\n'</span>), <span class="number">0</span> ; </span><br><span class="line">  	make_for_Ans() ; (!check) ? <span class="built_in">printf</span>(<span class="string">"%.5lf %.5lf"</span>, ansx, ansy) : <span class="number">1</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·3B"><a href="#rm-CFÂ·3B" class="headerlink" title="$\rm CFÂ·3B$"></a>$\rm CFÂ·3B$</h1><blockquote>
<p>æœ‰ä¸€è¾†è½½é‡é‡ä¸º$v$çš„è´§è½¦ï¼Œ å‡†å¤‡è¿é€ä¸¤ç§ç‰©å“ã€‚ </p>
<p>ç‰©å“$A$çš„é‡é‡ä¸º$1$ï¼Œ ç‰©ä½“$B$çš„é‡é‡ä¸º$2$ï¼Œ æ¯ä¸ªç‰©å“éƒ½æœ‰ä¸€ä¸ªä»·å€¼ã€‚ æ±‚è´§è½¦å¯ä»¥è¿é€çš„ç‰©å“çš„æœ€å¤§ä»·å€¼ã€‚</p>
<p>$n\leq 100,000\quad v\leq 1e9$</p>
</blockquote>
<p>å…¶å®æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„è´ªå¿ƒæ€è·¯ï¼Œå°±æ˜¯å¦‚æœä¸¤ä»¶é‡é‡ä¸º1çš„å•†å“åˆæˆä¸€ä»¶çš„è¯ï¼Œæ¯”é‡é‡ä¸º2çš„è¦ä¼˜æˆ‘ä»¬å°±é€‰åˆèµ·æ¥çš„ã€‚</p>
<p>$\mathsf {Somebody}$è°ˆè¿‡ä¸€ä¸ªå°Ideaï¼Œå°±æ˜¯çœ‹ä¸Šå»æˆ‘ä»¬æœŸæœ›æ¯æ¬¡å–å¶æ•°ä¸ªã€‚é‚£ä¹ˆæˆ‘ä»¬ä¸€å¼€å§‹å¦‚æœ$M$æ˜¯å¥‡æ•°ï¼Œå°±ä»é‡é‡ä¸º1çš„é‚£ä¸€å †é€‰ä¸€ä¸ªæœ€å¤§çš„â€¦â€¦ï¼ˆè™½ç„¶æˆ‘ä¸çŸ¥é“è¿™ä¸ªåˆ°åº•æœ‰æ²¡æœ‰ç”¨ä½†æ˜¯å¬èµ·æ¥æŒºç§‘å­¦ï¼‰</p>
<p>æœ‰äº›å°ç»†èŠ‚éœ€è¦æ³¨æ„ã€‚å…¶ä¸­æ‹¿å‡ºæ¥ä¸€ä¸ªè¯´ä¸€ä¸‹ï¼šè¾¹ç•Œé—®é¢˜å…¶å®ä¸éœ€è¦è€ƒè™‘å¾—å¤ªä»”ç»†ï¼Œåªè¦ä¸€å¼€å§‹memsetæ•´ä¸ªæ•°ç»„ä¸º-INFï¼Œé‚£ä¹ˆå½“ä¸€ç§é‡é‡çš„ç”¨å®Œäº†ï¼Œå¦ä¸€ç§é‡é‡çš„æ²¡ç”¨å®Œæ—¶ï¼Œå–maxä¹‹åä¸ä¼šå‡ºç°è¶Šç•Œçš„æƒ…å†µ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Data</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> num ,val ;</span><br><span class="line">&#125; base1[MAXN], base2[MAXN] ; <span class="keyword">int</span> N, M, p, v, v1, v2, c ;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> Ans ; <span class="keyword">int</span> tot1, tot2, t1, t2, i ; <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; ans ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Comp</span><span class="params">(Data a, Data b)</span></span>&#123; <span class="keyword">return</span> a.val &gt; b.val ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; </span><br><span class="line">    <span class="built_in">memset</span>(base1, <span class="number">-63</span>, <span class="keyword">sizeof</span>(base1)) ; </span><br><span class="line">    <span class="built_in">memset</span>(base2, <span class="number">-63</span>, <span class="keyword">sizeof</span>(base2)) ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;p, &amp;v) ;</span><br><span class="line">        <span class="keyword">if</span> (p &gt; <span class="number">1</span>) base2[++ tot2].val = v, base2[tot2].num = i ;</span><br><span class="line">        <span class="keyword">else</span><span class="comment">/*qwq*/</span>base1[++ tot1].val = v, base1[tot1].num = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(base1 + <span class="number">1</span>, base1 + tot1 + <span class="number">1</span>, Comp), </span><br><span class="line">    sort(base2 + <span class="number">1</span>, base2 + tot2 + <span class="number">1</span>, Comp) ;</span><br><span class="line">    <span class="comment">// for (i = 1 ; i &lt;= N ; ++ i) cout &lt;&lt; base1[i].num &lt;&lt; " " &lt;&lt; base1[i].val &lt;&lt; " qwwq " ;</span></span><br><span class="line">    <span class="comment">// for (i = 1 ; i &lt;= N ; ++ i) cout &lt;&lt; base2[i].num &lt;&lt; " " &lt;&lt; base2[i].val &lt;&lt; " qwwq " ;</span></span><br><span class="line">    <span class="keyword">if</span> (M &amp; <span class="number">1</span>) ans.pb(base1[<span class="number">1</span>].num), Ans += base1[<span class="number">1</span>].val, ++ t1, M -- ;</span><br><span class="line">    <span class="keyword">while</span> (M &gt; <span class="number">1</span>)&#123;<span class="comment">//æ­¤å¤„&gt;1æ˜¯é€‰v=2æ—¶é˜²æ­¢è¶Šç•Œ</span></span><br><span class="line">        v2 = base2[t2 + <span class="number">1</span>].val ;</span><br><span class="line">        <span class="keyword">if</span> (t1 &gt;= tot1 &amp;&amp; t2 &gt;= tot2) <span class="keyword">break</span> ;</span><br><span class="line">        v1 = base1[t1 + <span class="number">1</span>].val + base1[t1 + <span class="number">2</span>].val ; </span><br><span class="line">        <span class="keyword">if</span> (t1 + <span class="number">2</span> &gt; tot1) v1 = base1[t1 + <span class="number">1</span>].val, c = <span class="number">1</span> ; <span class="keyword">else</span> c = <span class="number">2</span> ; </span><br><span class="line">        <span class="keyword">if</span> (v1 &gt;= v2)&#123;</span><br><span class="line">            Ans += v1 ; M -= c ;</span><br><span class="line">            rep(i, <span class="number">1</span>, c) ans.pb(base1[++ t1].num) ; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> Ans += v2, M -= <span class="number">2</span>, ans.pb(base2[++ t2].num) ; </span><br><span class="line">    &#125;<span class="comment">//å› ä¸ºwhileçš„æ¡ä»¶æ˜¯M&gt;1,æ‰€ä»¥éœ€è¦åˆ¤æ–­ä¸€ä¸‹æ˜¯ä¸æ˜¯è¿˜å¯ä»¥é€‰ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (M &amp;&amp; t1 &lt; tot1) </span><br><span class="line">      Ans += base1[++ t1].val, ans.pb(base1[t1].num) ; </span><br><span class="line">  	<span class="keyword">if</span> (Ans &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"0\n"</span>), <span class="number">0</span> ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">  	<span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; :: iterator k = ans.begin() ; k != ans.end() ; ++ k) <span class="built_in">cout</span> &lt;&lt; *k &lt;&lt; <span class="string">" "</span> ;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·4D"><a href="#rm-CFÂ·4D" class="headerlink" title="$\rm{CFÂ·4D}$"></a>$\rm{CFÂ·4D}$</h1><blockquote>
<p>ç»™å‡ºä¸€ä¸ªé™åˆ¶$(w,h)$å’Œ$n$ä¸ªç‰©å“çš„äºŒç»´ä¿¡æ¯$(w_i,h_i)$</p>
<p>æ±‚ç‰©å“äºŒç»´éƒ½æ»¡è¶³$w_i&gt;w,~h_i&gt;h$çš„å‰æä¸‹çš„æœ€é•¿äºŒç»´ä¸¥æ ¼ä¸Šå‡å­åºåˆ—ä»¥åŠå…¶é•¿åº¦<br>$n \leq 5,000$</p>
</blockquote>
<p>ä¸€ä¸ªæ¯”è¾ƒæ˜¾ç„¶çš„æƒ³æ³•æ˜¯ï¼Œç”±äºå¯ä»¥éšä¾¿å®‰æ’é¡ºåºï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æŒ‰å…¶ä¸­ä¸€ç»´æ’ä¸€ä¸ªåºï¼ŒæŠŠè¿™ä¸ªå½“åšä¸‹æ ‡ï¼Œç„¶åæ‰¾å¦ä¸€ç»´çš„$\mathsf {LIS}$ã€‚ é‚£ä¹ˆç”±äºæ˜¯ä¸¥æ ¼å‡åºï¼Œæ‰€ä»¥è¦åˆ¤ä¸€ä¸‹ç›¸ç­‰ã€‚è·¯å¾„å°±ç…§ä¾‹æ˜¯æ‰¾å‰é©±ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)	&#123; </span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B), f[i] = <span class="number">1</span> ;</span><br><span class="line">      <span class="keyword">if</span> (A &lt;= W || B &lt;= H) <span class="keyword">continue</span> ;</span><br><span class="line">      E[++ tot].w = A, E[tot].h = B, E[tot].num = i ;</span><br><span class="line">  &#125;</span><br><span class="line">  sort(E + <span class="number">1</span>, E + tot + <span class="number">1</span>, Comp) ;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= tot ; ++ i)</span><br><span class="line">      <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt; i ; ++ j)</span><br><span class="line">          <span class="keyword">if</span> (E[j].w &lt; E[i].w &amp;&amp; E[j].h &lt; E[i].h)</span><br><span class="line">              <span class="keyword">if</span> (f[i] &lt; f[j] + <span class="number">1</span>) &#123;</span><br><span class="line">                  f[i] = f[j] + <span class="number">1</span>, r[i] = j ;</span><br><span class="line">              &#125; </span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= tot ; ++ i)</span><br><span class="line">      <span class="keyword">if</span> (f[i] &gt; ans) ans = f[i], End = i ;</span><br><span class="line">  <span class="keyword">while</span>(End) s.push(End), End = r[End] ; <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">  <span class="keyword">while</span> (!s.empty()) <span class="built_in">cout</span> &lt;&lt; E[s.top()].num &lt;&lt; <span class="string">" "</span>, s.pop() ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·5C"><a href="#rm-CFÂ·5C" class="headerlink" title="$\rm CFÂ·5C$"></a>$\rm CFÂ·5C$</h1><blockquote>
<p>ç»™å‡ºä¸€ä¸ªæ‹¬å·åºåˆ—ï¼Œæ±‚å‡ºæœ€é•¿åˆæ³•å­ä¸²å’Œå®ƒçš„æ•°é‡ã€‚ åˆæ³•çš„å®šä¹‰ï¼šè¿™ä¸ªåºåˆ—ä¸­å·¦å³æ‹¬å·åŒ¹é…ã€‚</p>
<p>$n\leq 1,000,000$</p>
</blockquote>
<p>å¥½åƒæ˜¯é“$sb$é¢˜ï¼Ÿè€ƒè™‘æŠŠæ‰€æœ‰å¯ä»¥åŒ¹é…çš„ä½ç½®ç½®ä¸º$1$ï¼Œå¦åˆ™ä¸º$0$ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯æœ‰æœ€é•¿è¿ç»­çš„$1$çš„æ®µã€‚$dp$ä¸€ä¸‹å°±å¥½äº†å§â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> In[MAXN] ; <span class="built_in">stack</span> &lt;<span class="keyword">int</span>&gt; s ; </span><br><span class="line"><span class="keyword">int</span> N, dp[MAXN], f[MAXN], base[MAXN] ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, In + <span class="number">1</span>), N = <span class="built_in">strlen</span>(In + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (In[i] == <span class="string">'('</span>) s.push(i)<span class="comment">/*, cout &lt;&lt; "qwq" &lt;&lt; endl */</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!s.empty()) base[s.top()] = base[i] = <span class="number">1</span>, s.pop() ; </span><br><span class="line">    &#125; <span class="keyword">int</span> ans = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">      <span class="keyword">if</span> (base[i]) dp[i] = dp[i - <span class="number">1</span>] + <span class="number">1</span> ; <span class="keyword">else</span> dp[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">      f[i] = max(f[i - <span class="number">1</span>], dp[i]) ; <span class="built_in">cout</span> &lt;&lt; f[N] &lt;&lt; <span class="string">" "</span> ; </span><br><span class="line">  	<span class="keyword">int</span> maxx = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">      <span class="keyword">if</span> (dp[i] == f[N]) ++ ans ; <span class="built_in">cout</span> &lt;&lt; (f[N] ? ans : <span class="number">1</span>) &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">  	<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·5D"><a href="#rm-CFÂ·5D" class="headerlink" title="$\rm CFÂ·5D$"></a>$\rm CFÂ·5D$</h1><blockquote>
<p>æœ‰ä¸€ä¸ªé•¿åº¦ä¸º$l$çš„é“è·¯ï¼Œä½ çš„åŠ é€Ÿæ˜¯$a$ã€‚</p>
<p>ä»$[0,d]$çš„é™é€Ÿæ˜¯$w$ï¼Œ$[0,l]$çš„é™é€Ÿæ˜¯$v$ï¼Œé—®ä½ æœ€å°‘èŠ±è´¹å¤šå°‘æ—¶é—´ä»èµ·ç‚¹åˆ°ç»ˆç‚¹ã€‚</p>
<p>$w$çš„é™é€ŸèŒƒå›´æ˜¯$[d,d]$ï¼Œå³æ˜¯è¯´ä¿è¯åœ¨äº¤é€šæ ‡å¿—å¤„çš„é€Ÿåº¦ä¸è¶…è¿‡$w$å³ä¸ºåˆæ³•ã€‚</p>
</blockquote>
<p>é«˜ä¸­ç‰©ç†æ¨¡æ‹Ÿé¢˜ï¼Ÿï¼Ÿ</p>
<p>å…¶å®å°±æ˜¯åˆ†ç±»è®¨è®ºä¸€ä¸‹å°±å¥½ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">bool</span> mark ; </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-7</span> ; </span><br><span class="line"><span class="keyword">double</span> x_1, x_2, ans, x ;</span><br><span class="line"><span class="keyword">double</span> vnow, a, vmax, L, D, vmaxd ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">equal</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (b &gt; a) swap(a, b) ;</span><br><span class="line">	<span class="keyword">return</span> ((a - b &lt;= eps) &amp;&amp; (b - a &gt;= -eps)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; vmax &gt;&gt; L &gt;&gt; D &gt;&gt; vmaxd ;</span><br><span class="line">	vnow = <span class="built_in">sqrt</span>(<span class="number">0.5</span> * (<span class="number">2</span> * a * D + vmaxd * vmaxd)) ; </span><br><span class="line">	<span class="keyword">if</span> (vnow &gt; vmax) vnow = vmax, mark = <span class="number">1</span> ;</span><br><span class="line">	x_1 = vnow * vnow / <span class="number">2</span> / a, x_2 = (vnow * vnow - vmaxd * vmaxd) / <span class="number">2</span> / a ;</span><br><span class="line">	<span class="keyword">if</span> (vnow &gt; vmaxd || equal(vnow, vmaxd))&#123;</span><br><span class="line"><span class="comment">//		if (!mark)&#123;</span></span><br><span class="line">			ans += vnow / a + (vnow - vmaxd) / a ; </span><br><span class="line">			<span class="keyword">if</span> (x_1 + x_2 &lt; D) x = D - x_1 - x_2, ans += x / vnow ;</span><br><span class="line">		<span class="comment">/*&#125;</span></span><br><span class="line"><span class="comment">		else &#123;</span></span><br><span class="line"><span class="comment">			ans += vnow / a + (vnow - vmaxd) / a ;</span></span><br><span class="line"><span class="comment">			x = ans += x / vnow ;</span></span><br><span class="line"><span class="comment">		&#125;*/</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		vnow = vmax, x = vnow * vnow / <span class="number">2</span> / a ;</span><br><span class="line">		<span class="keyword">if</span> (x &lt; L || equal(x, L))&#123;</span><br><span class="line">			ans = vnow / a, ans += (L - x) / vmax ;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%.9lf"</span>, ans) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			vnow = <span class="built_in">sqrt</span>(<span class="number">2</span> * a * L) ;</span><br><span class="line">			ans = vnow / a, <span class="built_in">printf</span>(<span class="string">"%.9lf"</span>, ans) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	x = (vmax * vmax - vmaxd * vmaxd) / <span class="number">2</span> / a ;</span><br><span class="line">	<span class="keyword">if</span> (x &lt; L - D || equal(x, L - D))&#123;</span><br><span class="line">		ans += (vmax - vmaxd) / a, ans += (L - D - x) / vmax ;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.9lf"</span>, ans) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		vnow = vmaxd, x = <span class="built_in">sqrt</span>(<span class="number">2</span> * a * (L - D) + vnow * vnow) ;</span><br><span class="line">		ans += (x - vnow) / a, <span class="built_in">printf</span>(<span class="string">"%.9lf"</span>, ans) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·5E"><a href="#rm-CFÂ·5E" class="headerlink" title="$\rm CFÂ·5E$"></a>$\rm CFÂ·5E$</h1><blockquote>
<p>æœ‰$\mathsf n$åº§å±±ç»„æˆä¸€ä¸ªç¯ï¼Œä¸¤åº§å±±äº’ç›¸èƒ½çœ‹åˆ°çš„è¦æ±‚æ˜¯ç›¸è¿çš„åœ†å¼§ä¸Šæ²¡æœ‰ä»»ä½•å…¶ä»–çš„å±±é«˜åº¦æ¯”å®ƒä»¬é«˜ï¼Œæ±‚èƒ½çœ‹åˆ°çš„å±±çš„ç»„æ•°ã€‚</p>
<p>$n\leq 100,000$</p>
</blockquote>
<p>ä¸€çœ¼çœ‹ä¸Šå»å°±ç»™äººä¸€è‚¡å•è°ƒæ ˆçš„å‘³é“â€¦â€¦ä½†æ˜¯çœ‹ä¸Šå»è¦æ–­ç¯ä¸ºé“¾ï¼Ÿä½†æ˜¯å¦‚æœæ–­ç¯ä¸ºé“¾çš„è¯ï¼Œæœ‰äº›è´¡çŒ®ä¼šç®—é‡ã€‚ä½†æ˜¯è€ƒè™‘ä¼šç®—é‡çš„æ­£å¥½æ˜¯ç®—ä¸€éåªç®—ä¸€ä¸ªåºåˆ—çš„ç­”æ¡ˆã€‚ä½†æ˜¯è¿™è¿˜ä¸å¤Ÿï¼Œå› ä¸ºæˆ‘ä»¬å‘ç°æˆé“¾ä¹‹åï¼Œæœ€é«˜å€¼å’Œæ¬¡é«˜å€¼åœ¨$[1,n]$èƒ½äº’ç›¸çœ‹åˆ°ï¼Œå¹¶ä¸”åœ¨$[1,n]$å’Œ$[n+1,2n]$çš„äº¤ç•Œä¹Ÿèƒ½äº’ç›¸çœ‹åˆ°ã€‚æ‰€ä»¥åº”è¯¥æŠŠè¿™éƒ¨åˆ†å‡å»ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> L)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= L ; ++ i) <span class="built_in">stack</span>[i] = Mp(<span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Solve</span><span class="params">(<span class="keyword">int</span> M)</span></span>&#123;</span><br><span class="line">	init(M), ans = <span class="number">0</span> ; </span><br><span class="line">	<span class="keyword">register</span> <span class="keyword">int</span> i, tp = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) &#123;</span><br><span class="line">		<span class="keyword">while</span> (tp &amp;&amp; <span class="built_in">stack</span>[tp].first &lt; base[i]) </span><br><span class="line">      ans += <span class="built_in">stack</span>[tp].second, -- tp ;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">stack</span>[tp].first != base[i])  </span><br><span class="line">			ans += (tp &gt; <span class="number">0</span>), <span class="built_in">stack</span>[++ tp] = Mp(base[i], <span class="number">1</span>) ; </span><br><span class="line">		<span class="keyword">else</span> ans += (tp &gt; <span class="number">1</span>) + <span class="built_in">stack</span>[tp].second, ++ <span class="built_in">stack</span>[tp].second ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">register</span> <span class="keyword">int</span> i ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">    base[i + N] = base[i] = qr() ;</span><br><span class="line">	pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; St, Ed ;</span><br><span class="line">	St = Mp(<span class="number">-1</span>, <span class="number">0</span>), Ed = Mp(<span class="number">-1</span>, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (St.first &lt; base[i]) </span><br><span class="line">      Ed = St, St = Mp(base[i], <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (St.first == base[i]) ++ St.second ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (Ed.first &lt; base[i]) Ed = Mp(base[i], <span class="number">1</span>) ; </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (Ed.first == base[i]) ++ Ed.second ;</span><br><span class="line">	&#125;</span><br><span class="line">	Ans = Solve(<span class="number">2</span> * N) - Solve(N),</span><br><span class="line">  Ans -= (St.second * St.second + ((St.second == <span class="number">1</span>) ? Ed.second : <span class="number">0</span>)), </span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·6D"><a href="#rm-CFÂ·6D" class="headerlink" title="$\rm CFÂ·6D$"></a>$\rm CFÂ·6D$</h1><blockquote>
<p>æœ‰ä¸€é˜Ÿäººï¼Œä½ å¯ä»¥ç”¨è†œæŸä¸ªäººï¼Œä¼šå¯¹å½“å‰äººé€ æˆ$a$ç‚¹ä¼¤å®³ï¼Œå¯¹æ—è¾¹çš„äººé€ æˆ$b$ç‚¹ä¼¤å®³ã€‚è¡€é‡æ²¡äº†å°±ä¼šä¼¤é€å¿ƒã€‚</p>
<p>ä¸èƒ½è†œ$1$å·å’Œ$n$å·ï¼Œæ±‚æœ€å°‘å¤šå°‘è†œå¤šå°‘æ¬¡è®©æ‰€æœ‰äººä¼¤é€å¿ƒã€‚</p>
<p>$n\leq 10$</p>
</blockquote>
<p>çœ‹æ•°æ®èŒƒå›´è§‰å¾—æ˜¯çŠ¶å‹ã€‚åæ¥å‘ç°å…¶å®å°±è·Ÿ$\rm CF1110$çš„é‚£ä¸ªéº»å°†é¢˜å·®ä¸å¤šï¼Œåªéœ€è¦è®°å½•$i-1$å’Œ$i$çš„çŠ¶æ€å³å¯ã€‚äºæ˜¯$f_{i,j,k}$è¡¨ç¤ºå‰$i$ä¸ªäººï¼Œåœ¨$i-1$è¿™é‡Œè¿˜å‰©$j$è¡€ï¼Œåœ¨$i$è¿™é‡Œè¿˜å‰©$k$è¡€ï¼Œä¸”å‰$i$ä¸ªäººéƒ½ä¼¤é€å¿ƒ$\min$ã€‚ç„¶åè®°å½•ä¸€ä¸‹è·¯å¾„å°±å®Œäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> dp[MAXN][MAXN][MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, a, b, blood[MAXN], i, j, k, l ; </span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; From[MAXN][MAXN][MAXN] ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Print</span><span class="params">(<span class="keyword">int</span> step, <span class="keyword">int</span> jj, <span class="keyword">int</span> kk)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (step &lt;= <span class="number">1</span>) <span class="keyword">return</span> ;	</span><br><span class="line">	Print(step - <span class="number">1</span>, From[step + <span class="number">1</span>][jj][kk].first, From[step + <span class="number">1</span>][jj][kk].second) ;</span><br><span class="line">	<span class="keyword">int</span> tow = dp[step][From[step + <span class="number">1</span>][jj][kk].first][From[step + <span class="number">1</span>][jj][kk].second] ;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> qwq = <span class="number">1</span> ; qwq &lt;= dp[step + <span class="number">1</span>][jj][kk] - tow ; ++ qwq) <span class="built_in">printf</span>(<span class="string">"%d "</span>, step) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; a &gt;&gt; b ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cin</span> &gt;&gt; blood[i], ++ blood[i] ;</span><br><span class="line">	<span class="built_in">memset</span>(dp, <span class="number">63</span>, <span class="keyword">sizeof</span>(dp)), dp[<span class="number">2</span>][blood[<span class="number">1</span>]][blood[<span class="number">2</span>]] = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt; N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= blood[i - <span class="number">1</span>] ; ++ j)</span><br><span class="line">			<span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt;= blood[i] ; ++ k)&#123;</span><br><span class="line">				<span class="keyword">int</span> down_ = (j + b - <span class="number">1</span>) / b ;</span><br><span class="line">				<span class="keyword">if</span> (dp[i][j][k] &gt; INF) <span class="keyword">continue</span> ;</span><br><span class="line">				<span class="keyword">int</span>	up_ = max(down_, max((blood [i + <span class="number">1</span>] + b - <span class="number">1</span>) / b, (k + a - <span class="number">1</span>) / a)) ;</span><br><span class="line">				<span class="keyword">for</span> (l = down_ ; l &lt;= up_ ; ++ l)&#123;</span><br><span class="line">					<span class="keyword">int</span> now_j = max(<span class="number">0</span>, k - a * l) ;</span><br><span class="line">          <span class="keyword">int</span> now_k = max(<span class="number">0</span>, blood[i + <span class="number">1</span>] - b * l) ;</span><br><span class="line">					<span class="keyword">if</span> (dp[i + <span class="number">1</span>][now_j][now_k] &gt; dp[i][j][k] + l)</span><br><span class="line">						dp[i + <span class="number">1</span>][now_j][now_k] = dp[i][j][k] + l, </span><br><span class="line">          	From[i + <span class="number">1</span>][now_j][now_k] = Mp(j ,k) ;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; dp[N][<span class="number">0</span>][<span class="number">0</span>] &lt;&lt; <span class="built_in">endl</span> ; Print(N - <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CF-Â·6E"><a href="#rm-CF-Â·6E" class="headerlink" title="$\rm CF Â·6E$"></a>$\rm CF Â·6E$</h1><blockquote>
<p>ç»™ä¸€ä¸ª$n$ä¸ªå…ƒç´ çš„åºåˆ—ï¼Œä»ä¸­æŒ‘å‡ºæœ€é•¿çš„å­åºåˆ—ï¼Œè¦æ±‚å­åºåˆ—ä¸­å…ƒç´ å·®çš„æœ€å¤§å€¼ä¸è¶…è¿‡$k$ã€‚é—®æœ‰å‡ ä¸ªæœ€é•¿å­åºåˆ—ï¼Œå­åºåˆ—é•¿åº¦ï¼Œä»¥åŠè¿™å‡ ä¸ªå­åºèµ·å§‹ã€ç»ˆæ­¢ä½ç½®ã€‚</p>
<p>$n\leq 100,000$</p>
</blockquote>
<p>æ†¨æ‰¹é¢˜ã€‚æ˜¾ç„¶å°±æ˜¯ä¸ªå•è°ƒé˜Ÿåˆ—ï¼Œä½†æ˜¯å‘ç°ä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆå¾ˆè¯¡å¼‚çš„é™åˆ¶ï¼Œå¹¶ä¸”åªè¦æ±‚ä¸€ä¸ªæœ€å¤§å€¼æœ€å°å€¼ã€‚äºæ˜¯æœæ–­æƒ³åˆ°$st$è¡¨å¥—äºŒåˆ†ï¼Œå¤æ‚åº¦$n\log n-n\log^2 n$â€¦â€¦è¢«å•è°ƒé˜Ÿåˆ—åŠèµ·æ¥é”¤233</p>
<p>å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œ$st$è¡¨å›ç­”è¯¢é—®çš„å¤æ‚åº¦ï¼Œå¤§å¤šæ•°å†™æ³•éƒ½æ˜¯äºš$\log $çº§åˆ«çš„ï¼Œè€Œä¸æ˜¯ä¼ çš„ç¥ä¹å…¶ç¥çš„$O(1)$ã€‚ä½†å…¶å®åªè¦é¢„å¤„ç†ä¸€ä¸‹å¤§äºç­‰äº$x$çš„$2$çš„å¹‚å³å¯ã€‚</p>
<p>ç„¶åCSPå‰è¯•æœºçš„æ—¶å€™é¡ºä¾¿å†™å‡ºäº†å•è°ƒé˜Ÿåˆ—çš„åšæ³•ï¼Œä»£ç å¤§æ¦‚é•¿è¿™æ ·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> q[MAXN], p[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span>, h1 = <span class="number">1</span>, t1 = <span class="number">0</span>, h2 = <span class="number">1</span>, t2 = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">  <span class="keyword">while</span> (h1 &lt;= t1 &amp;&amp; base[q[t1]] &lt; base[i]) t1 -- ;</span><br><span class="line">  <span class="keyword">while</span> (h2 &lt;= t2 &amp;&amp; base[p[t2]] &lt; base[i]) t2 -- ;</span><br><span class="line">  q[++ t1] = p[++ t2] = i ; </span><br><span class="line">  <span class="keyword">while</span> (h1 &lt;= t1 &amp;&amp; h2 &lt;= t2 &amp;&amp; base[q[h1]] - base[p[h2]] &gt; K)&#123;</span><br><span class="line">  	l ++ ; <span class="keyword">while</span> (q[h1] &lt; l) ++ h1 ; <span class="keyword">while</span> (p[h2] &lt; l) ++ h2 ;</span><br><span class="line">  &#125;</span><br><span class="line">  ans = max(ans, s[i] - s[l - <span class="number">1</span>]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ˜¯äºŒåˆ†$st$è¡¨</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build_ST</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">register</span> <span class="keyword">int</span> H = <span class="built_in">log</span>(N) / <span class="built_in">log</span>(<span class="number">2</span>) + <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= H ; ++ j)</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i + (<span class="number">1</span> &lt;&lt; j) &lt;= N + <span class="number">1</span> ; ++ i)</span><br><span class="line">			dp1[i][j] = max(dp1[i][j - <span class="number">1</span>], dp1[i + (<span class="number">1</span> &lt;&lt; j - <span class="number">1</span>)][j - <span class="number">1</span>]), </span><br><span class="line">			dp2[i][j] = min(dp2[i][j - <span class="number">1</span>], dp2[i + (<span class="number">1</span> &lt;&lt; j - <span class="number">1</span>)][j - <span class="number">1</span>]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query_max</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">register</span> <span class="keyword">int</span> k = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">if</span> (l == r) <span class="keyword">return</span> base[l] ;</span><br><span class="line">	<span class="keyword">while</span> (l + (<span class="number">1</span> &lt;&lt; k) &lt;= r) ++ k ;</span><br><span class="line">	<span class="keyword">return</span> max(dp1[l][k - <span class="number">1</span>], dp1[r - (<span class="number">1</span> &lt;&lt; k - <span class="number">1</span>) + <span class="number">1</span>][k - <span class="number">1</span>]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query_min</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">register</span> <span class="keyword">int</span> k = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">if</span> (l == r) <span class="keyword">return</span> base[l] ;</span><br><span class="line">	<span class="keyword">while</span> (l + (<span class="number">1</span> &lt;&lt; k) &lt;= r) ++ k ;</span><br><span class="line">	<span class="keyword">return</span> min(dp2[l][k - <span class="number">1</span>], dp2[r - (<span class="number">1</span> &lt;&lt; k - <span class="number">1</span>) + <span class="number">1</span>][k - <span class="number">1</span>]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		dp1[i][<span class="number">0</span>] = dp2[i][<span class="number">0</span>] = base[i] = qr() ;</span><br><span class="line">	build_ST(), ans = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		L = i, R = N ;</span><br><span class="line">		<span class="keyword">while</span> (L &lt;= R)&#123;</span><br><span class="line">			Mid = (L + R) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">			<span class="keyword">if</span> (query_max(i, Mid) - query_min(i, Mid) &lt;= K) </span><br><span class="line">				t = Mid, L = Mid + <span class="number">1</span> ; </span><br><span class="line">			<span class="keyword">else</span> R = Mid - <span class="number">1</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">		L = t ;</span><br><span class="line">		<span class="keyword">if</span> (L - i + <span class="number">1</span> &gt; ans) ans = L - i + <span class="number">1</span>, Ans[cnt = <span class="number">1</span>][<span class="number">0</span>] = i, Ans[cnt][<span class="number">1</span>] = L ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (L - i + <span class="number">1</span> == ans) Ans[++ cnt][<span class="number">0</span>] = i, Ans[cnt][<span class="number">1</span>] = L ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">" "</span> &lt;&lt; cnt &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= cnt ; ++ i) </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, Ans[i][<span class="number">0</span>], Ans[i][<span class="number">1</span>]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·7C"><a href="#rm-CFÂ·7C" class="headerlink" title="$\rm CFÂ·7C$"></a>$\rm CFÂ·7C$</h1><blockquote>
<p>ç»™å®šä¸€æ¡ç›´çº¿ï¼š$Ax+By+C=0$ï¼ˆ$A,B$ä¸åŒæ—¶ä¸º$0$ï¼‰ï¼Œæ‰¾åˆ°ä»»æ„ä¸€ä¸ªç‚¹ï¼ˆåœ¨$-5e18$~$5e18$ä¹‹é—´ï¼‰è®©å®ƒçš„æ¨ªçºµåæ ‡å‡ä¸ºæ•´æ•°ï¼Œæˆ–è€…ç¡®å®šæ²¡æœ‰è¿™æ ·çš„ç‚¹ã€‚</p>
</blockquote>
<p>sbçš„exgcdã€‚æˆ‘å½“æ—¶ä¸ºä»€ä¹ˆè¦åšè¿™ç§é¢˜ï¼Ÿ$\rm Cf$åˆä¸ºä»€ä¹ˆè¦å‡ºè¿™ç§é¢˜ï¼Ÿqwq</p>
<h1 id="rm-CFÂ·7D"><a href="#rm-CFÂ·7D" class="headerlink" title="$\rm CFÂ·7D$"></a>$\rm CFÂ·7D$</h1><blockquote>
<p>ä¸€ä¸ªé•¿åº¦ä¸º$n$å­—ç¬¦ä¸²$\sf S$è¢«å«åš$k$é˜¶å›æ–‡ä¸²ï¼Œå½“ä¸”ä»…å½“å®ƒæœ¬èº«æ˜¯ä¸€ä¸ªå›æ–‡ä¸²ï¼Œè€Œä¸”å®ƒé•¿åº¦ä¸º$\lfloor \frac{n}{2}\rfloor$çš„å‰ç¼€å’Œåç¼€éƒ½æ˜¯$k-1$é˜¶å›æ–‡ä¸²ã€‚ä»»ä½•ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬ç©ºå­—ç¬¦ä¸²ï¼‰éƒ½è‡³å°‘æ˜¯$0$é˜¶å­—ç¬¦ä¸²ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œ<code>abaaba</code>æ˜¯3é˜¶å­—ç¬¦ä¸²ã€‚</p>
<p>ç°åœ¨ç»™å®šä½ ä¸€å­—ç¬¦ä¸²ï¼Œè¯·ä½ æ±‚å‡ºå…¶æ‰€æœ‰å‰ç¼€çš„çš„é˜¶çº§ä¹‹å’Œã€‚</p>
<p>$|\sf S|\leq 5,000,000$</p>
</blockquote>
<p>ä¼¼ä¹æœ‰æ—¶å€™å“ˆå¸Œå†™çš„æ¯”è¾ƒ$6$è¿™ç§é¢˜å‡ ä¹æ˜¯ç§’ã€‚è€ƒè™‘$f_i$è¡¨ç¤ºä»¥$i$ä¸ºç»“å°¾çš„å­—ç¬¦ä¸²çš„é˜¶æ•°ï¼Œé‚£ä¹ˆ</p>
<script type="math/tex; mode=display">
f_i=[H[1...\lfloor \frac{i}{2}\rfloor]=H[i-\lfloor \frac{i}{2}\rfloor+1...i]\quad ]\cdot (f_{\lfloor \frac{i}{2}\rfloor}+1)</script><p>ç­”æ¡ˆå°±æ˜¯$\sum f_i$</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> base = <span class="number">131</span> ;<span class="keyword">bool</span> mark[MAXN] ;</span><br><span class="line"><span class="keyword">char</span> S[MAXN] ; <span class="keyword">int</span> N, Ans, i, j, h, ans[MAXN] ;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> base1[MAXN], base2[MAXN], times[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	times[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		base1[i] = (base1[i - <span class="number">1</span>] * base + S[i]) % Mod ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		base2[i] = (base2[i - <span class="number">1</span>] * base + S[N - i + <span class="number">1</span>]) % Mod ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) times[i] = times[i - <span class="number">1</span>] * base % Mod ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, S + <span class="number">1</span>), </span><br><span class="line">	N = <span class="built_in">strlen</span>(S + <span class="number">1</span>), init() ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		h = i / <span class="number">2</span> ;</span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> t1 = base1[h] % Mod ;</span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> t2 = (base2[N - i + h] - (base2[N - i] * times[h] % Mod) + Mod) % Mod ;</span><br><span class="line">		ans[i] = (t1 == t2) * (ans[h] + <span class="number">1</span>),  Ans += ans[i] ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·8C"><a href="#rm-CFÂ·8C" class="headerlink" title="$\rm CFÂ·8C$"></a>$\rm CFÂ·8C$</h1><blockquote>
<p>å¹³é¢ä¸Šæœ‰$n\leq 24$ä¸ªç‰©å“ï¼Œpksä»åŸç‚¹å‡ºå‘ï¼Œæ±‚å…¨éƒ¨æ‹¾èµ·å¹¶ä¸”å›åˆ°åŸç‚¹è¡Œèµ°çš„æœ€çŸ­æ€»è·ç¦»ã€‚æ³¨æ„ï¼Œä»–ä¸èƒ½åŒæ—¶æ‹¿$&gt;2$ä»¶ç‰©å“ã€‚</p>
</blockquote>
<p>æˆ‘å¯»æ€ç€è¿™ä¸å°±æ˜¯ä¸ªæ¬§æ‹‰è·¯â€¦â€¦åªä¸è¿‡åŠ äº†ä¸ªé™åˆ¶ã€‚é‚£ä¹ˆè¿˜æ˜¯$\sf f_S$è¡¨ç¤ºæ‹¿å®Œ$\sf S$é‡Œçš„ä¸œè¥¿ï¼Œæ‰€èµ°çš„æœ€å°è·ç¦»ã€‚æ¯æ¬¡æšä¸¾ä¸¤ä¸ªç‚¹è½¬ç§»å³å¯ã€‚ä½†æ˜¯æ³¨æ„å³ä½¿æ˜¯$\rm Cf$çš„æœºå­ï¼Œ$2^{24}\cdot 24^2$è¿™ä¸œè¥¿ä¹Ÿä¸å¯èƒ½è·‘å‡ºæ¥ã€‚äºæ˜¯è€ƒè™‘ä¸€ä¸ªå‰ªæï¼Œå°±æ˜¯è€ƒè™‘å¦‚æœæŠŠçŠ¶æ€ä¸­çš„å…ƒç´ ä¸¤ä¸¤åˆ†ç»„ï¼Œé‚£ä¹ˆè€ƒè™‘ç»„ä¸ç»„ä¹‹é—´æ˜¯æ²¡æœ‰é¡ºåºå¯è¨€çš„ã€‚äºæ˜¯å°±å¯ä»¥å•è°ƒåœ°æšä¸¾çŠ¶æ€ï¼Œåˆæ³•å°±è·³å‡ºã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> dp[MAXN], Pre[MAXN], Max ;</span><br><span class="line"><span class="keyword">int</span> N, D[<span class="number">50</span>][<span class="number">50</span>], i, j, k, bit[<span class="number">50</span>], tp ; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; Obj[<span class="number">50</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; Obj[<span class="number">0</span>].fr &gt;&gt; Obj[<span class="number">0</span>].sc &gt;&gt; N ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cin</span> &gt;&gt; Obj[i].fr &gt;&gt; Obj[i].sc ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; i ; ++ j)</span><br><span class="line">			D[i][j] = D[j][i] = (Obj[i].fr - Obj[j].fr) * (Obj[i].fr - Obj[j].fr) </span><br><span class="line">      									+ (Obj[i].sc - Obj[j].sc) * (Obj[i].sc - Obj[j].sc) ;</span><br><span class="line">	Max = (<span class="number">1</span> &lt;&lt; N) - <span class="number">1</span> ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= Max ; ++ i) dp[i] = Inf ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= Max ; ++ i)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(bit, <span class="number">0</span>, <span class="keyword">sizeof</span>(bit)), tp = <span class="number">0</span> ;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; N ; ++ j) <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; j &amp; i) bit[++ tp] = j + <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= tp ; ++ j)</span><br><span class="line">			<span class="keyword">for</span> (k = <span class="number">1</span> ; k &lt;= tp ; ++ k)&#123;</span><br><span class="line">				<span class="keyword">if</span> (j != k)&#123;</span><br><span class="line">					<span class="keyword">if</span> (dp[i] &gt; dp[i ^ (<span class="number">1</span> &lt;&lt; bit[k] - <span class="number">1</span>) ^ (<span class="number">1</span> &lt;&lt; bit[j] - <span class="number">1</span>)] + D[bit[k]][bit[j]] + D[<span class="number">0</span>][bit[k]] + D[<span class="number">0</span>][bit[j]])</span><br><span class="line">						dp[i] = dp[i ^ (<span class="number">1</span> &lt;&lt; bit[k] - <span class="number">1</span>) ^ (<span class="number">1</span> &lt;&lt; bit[j] - <span class="number">1</span>)] + D[bit[k]][bit[j]] + D[<span class="number">0</span>][bit[k]] + D[<span class="number">0</span>][bit[j]], </span><br><span class="line">          Pre[i] = i ^ (<span class="number">1</span> &lt;&lt; bit[k] - <span class="number">1</span>) ^ (<span class="number">1</span> &lt;&lt; bit[j] - <span class="number">1</span>) ;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> </span><br><span class="line">					<span class="keyword">if</span> (dp[i] &gt; dp[i ^ (<span class="number">1</span> &lt;&lt; bit[k] - <span class="number">1</span>)] + D[<span class="number">0</span>][bit[k]] + D[bit[k]][<span class="number">0</span>])</span><br><span class="line">						dp[i] = dp[i ^ (<span class="number">1</span> &lt;&lt; bit[k] - <span class="number">1</span>)] + D[<span class="number">0</span>][bit[k]] + D[bit[k]][<span class="number">0</span>], </span><br><span class="line">        		Pre[i] = i ^ (<span class="number">1</span> &lt;&lt; bit[k] - <span class="number">1</span>) ;</span><br><span class="line">				<span class="keyword">if</span> (dp[i] &lt; <span class="number">1061109567</span>) <span class="keyword">break</span> ;</span><br><span class="line">			&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; dp[Max] &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">	<span class="keyword">while</span> (Max)&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="string">" "</span> ;</span><br><span class="line">		<span class="keyword">int</span> qaq = Max ^ Pre[Max] ;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; i &amp; qaq) <span class="built_in">cout</span> &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="string">" "</span> ;</span><br><span class="line">		Max = Pre[Max] ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·9D"><a href="#rm-CFÂ·9D" class="headerlink" title="$\rm CFÂ·9D$"></a>$\rm CFÂ·9D$</h1><blockquote>
<p>ç”¨$n$ä¸ªç‚¹ç»„æˆäºŒå‰æ ‘ï¼Œé—®é«˜åº¦å¤§äºç­‰äº$h$çš„æœ‰å¤šå°‘ä¸ªã€‚</p>
<p>$n\leq 35$</p>
</blockquote>
<p>æ²¡æœ‰é™åˆ¶å°±æ˜¯å¡ç‰¹å…°æ•°è¿™ä¸å¿…è¯´â€¦â€¦ä½†æ˜¯å¦‚æœè·³å‡ºæ€ç»´å®šå¼çš„è¯ï¼Œè€ƒè™‘åŸæ¥çš„$dp_i$è¡¨ç¤ºå‰iä¸ªç‚¹ç»„æˆäºŒå‰æ ‘çš„æ–¹æ¡ˆæ•°ï¼Œè½¬ç§»å°±æ˜¯æšä¸¾ä¸¤ä¸ªå­æ ‘â€”â€”é‚£ä¹ˆå¦‚æœè¦è€ƒè™‘é«˜åº¦ï¼Œåªéœ€è¦åŠ ä¸€ç»´é«˜åº¦$j$å³å¯ï¼Œæ­£å¥½æ˜¯é«˜åº¦$+1-1$çš„å…³ç³»ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; H ; <span class="keyword">int</span> i, j, k ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) dp[<span class="number">0</span>][i] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">			<span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt; j ; ++ k)</span><br><span class="line">				dp[j][i] += dp[k][i - <span class="number">1</span>] * dp[j - k - <span class="number">1</span>][i - <span class="number">1</span>] ;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; dp[N][N] - dp[N][D - <span class="number">1</span>] ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·10C"><a href="#rm-CFÂ·10C" class="headerlink" title="$\rm CFÂ·10C$"></a>$\rm CFÂ·10C$</h1><blockquote>
<p>å®šä¹‰å‡½æ•°$s(x)$ï¼Œ$s(x)$çš„å€¼ç­‰äº$x$å„æ•°ä½ä¸Šçš„æ•°å€¼ä¹‹å’Œï¼Œå®šä¹‰å‡½æ•°$d(x)$ï¼Œå½“$s(x)\leq 9$æ—¶$d(x)=s(x)$ï¼Œå¦åˆ™$d(x)=d(s(x))$ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œ$d(6543)=d(6+5+4+3)=d(18)=9$</p>
<p>ç°åœ¨ç»™å®šä¸€ä¸Šé™$N$ï¼Œæ±‚åœ¨$[1â€¦.N]$å†…ä»»å–$A$ï¼Œ$B$ï¼Œ$C$æ»¡è¶³$A\cdot B\not =C$ä¸”$d(C)=d(d(A)â‹…d(B))$çš„ç»„æ•°ã€‚</p>
<p>$N\leq 1000000$</p>
</blockquote>
<p>è€ƒè™‘$d()$çš„æœ¬è´¨ï¼š</p>
<script type="math/tex; mode=display">
d(x)=\left\{\begin{array}{ll}{x \bmod 9,} & {x \bmod 9 \neq 0} \\ {9,} & {x \bmod 9=0}\end{array}\right.</script><p>é‚£ä¹ˆå…¶å®$a\cdot b=c$å°±ä¸€å®šæ„å‘³ç€$d(d(a)\cdot d(b))=d(c)$ï¼Œæ‰€ä»¥å¯å‘æˆ‘ä»¬å¯ä»¥å…ˆæ±‚å‡ºåä¸€éƒ¨åˆ†çš„ï¼Œç„¶åå‡å»å‰ä¸€éƒ¨åˆ†ã€‚é‚£ä¹ˆå‰ä¸€åŠçš„å°±æ˜¯$\leq n$æ‰€æœ‰æ•°çš„çº¦æ•°ä¸ªæ•°å’Œã€‚è€Œè¿™ä¸œè¥¿æœ‰ä¸€ä¸ªç»å…¸çš„$O(n)$åšæ³•ï¼Œå°±æ˜¯æšä¸¾æ¯ä¸€ä¸ª$i$å¯¹å®ƒçš„å€æ•°äº§ç”Ÿè´¡çŒ®ã€‚</p>
<p>é‚£ä¹ˆåä¸€åŠå°±å¯ä»¥è€ƒè™‘æŒ‰ç…§ä½™æ•°åˆ†ç±»åšï¼Œç„¶åä¹˜æ³•åŸç†ä¹˜èµ·æ¥å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> N, base[<span class="number">20</span>], A, B, i, j ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">    base[i % <span class="number">9</span>] ++, B += N / i ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= <span class="number">8</span> ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= <span class="number">8</span> ; ++ j)</span><br><span class="line">			A += base[i] * base[j] * base[i * j % <span class="number">9</span>] ;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; A - B &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·10D"><a href="#rm-CFÂ·10D" class="headerlink" title="$\rm CFÂ·10D$"></a>$\rm CFÂ·10D$</h1><blockquote>
<p>æ±‚ä¸¤ä¸ªä¸²çš„æœ€é•¿å…¬å…±ä¸Šå‡å­åºåˆ—ã€‚</p>
<ul>
<li><p>$n\leq 500$</p>
</li>
<li><p>$n\leq 5,000$</p>
</li>
</ul>
</blockquote>
<p>ç¬¬ä¸€ä¸ª$subtask$ï¼Œè€ƒè™‘$\sf f_{i,j}$è¡¨ç¤º$A$åˆ°$i$ï¼Œ$B$åˆ°$j$çš„æœ€é•¿å…¬å…±ä¸Šå‡å­åºåˆ—ã€‚é‚£ä¹ˆè½¬ç§»çš„æ—¶å€™è€ƒè™‘å¤šæšä¸¾ä¸€ç»´$k$ï¼Œå½“$A_i=B_j$æ—¶ï¼Œå¯ä»¥ä»$k$è½¬ç§»è¿‡æ¥ã€‚äºæ˜¯å¤æ‚åº¦ä¸º$n^3$ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j)&#123;</span><br><span class="line">		dp[i][j] = dp[i - <span class="number">1</span>][j] ;</span><br><span class="line">		<span class="keyword">if</span> (base1[i] != base2[j]) <span class="keyword">continue</span> ;</span><br><span class="line">		dp[i][j] = <span class="number">1</span> ; </span><br><span class="line">		<span class="keyword">for</span> (k = <span class="number">1</span> ; k &lt; j ; ++ k)</span><br><span class="line">			<span class="keyword">if</span> (base2[k] &lt; base2[j] &amp;&amp; dp[i][j] &lt; dp[i - <span class="number">1</span>][k] + <span class="number">1</span>)</span><br><span class="line">				dp[i][j] = dp[i - <span class="number">1</span>][k] + <span class="number">1</span>, f[j] = k ;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è€ƒè™‘å…¶å®$j$æ¯æ¬¡å‘å³åªåŠ äº†$1$ï¼Œæ‰€ä»¥å¯¹äºåŒä¸€ä¸ª$i$ï¼Œæœ‰å¾ˆå¤šå†³ç­–éƒ½æ˜¯é‡å¤çš„ã€‚æ¢å¥è¯è¯´å°±æ˜¯è¿™ä¸ªå†³ç­–ï¼ˆ$k$ï¼‰æ˜¯å¦åº”è¯¥é€‰ï¼Œåœ¨$j=k$æ—¶å°±å¯ä»¥æ±‚å‡ºæ¥ï¼Œè€Œä¸ç”¨å†å‘å‰æ‰«ä¸€éï¼Œå› ä¸ºåœ¨$A_i$å®šä½çš„æ—¶å€™æ˜¯æ²¡åŒºåˆ«çš„ã€‚</p>
<p>äºæ˜¯æœ€åï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!x) <span class="keyword">return</span> ;</span><br><span class="line">	dfs(pre[x]), <span class="built_in">printf</span>(<span class="string">"%d "</span>, B[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i, j, k, n = <span class="number">0</span> ; </span><br><span class="line">	<span class="keyword">for</span> (N = qr(), i = <span class="number">1</span> ; i &lt;= N ; ++ i) A[i] = qr() ;</span><br><span class="line">	<span class="keyword">for</span> (M = qr(), i = <span class="number">1</span> ; i &lt;= M ; ++ i) B[i] = qr() ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">int</span> res = <span class="number">0</span>, befo = <span class="number">0</span> ; </span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j)&#123;</span><br><span class="line">			<span class="keyword">if</span> (A[i] != B[j]) f[i][j] = f[i - <span class="number">1</span>][j] ;</span><br><span class="line">			<span class="keyword">else</span> f[i][j] = res + <span class="number">1</span>, pre[j] = befo ;</span><br><span class="line">			<span class="keyword">if</span> (B[j] &lt; A[i]) </span><br><span class="line">				<span class="keyword">if</span> (res &lt; f[i - <span class="number">1</span>][j]) </span><br><span class="line">					res = f[i - <span class="number">1</span>][j], befo = j ; </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="keyword">if</span> (ans &lt; f[N][i]) ans = f[N][i], n = i ; </span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; dfs(n) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·11C"><a href="#rm-CFÂ·11C" class="headerlink" title="$\rm CFÂ·11C$"></a>$\rm CFÂ·11C$</h1><blockquote>
<p>ä½ æœ‰ä¸€ä¸ª$01$çŸ©é˜µã€‚é‡Œé¢æœ‰å¤šå°‘ä¸ªæ­£æ–¹å½¢ï¼Ÿ</p>
<p>å…¶ä¸­æ­£æ–¹å½¢çš„è¾¹ç”¨$1$è¡¨ç¤ºã€‚æˆ‘ä»¬ç°åœ¨åªå¯¹è¿™äº›æ­£æ–¹å½¢æ„Ÿå…´è¶£ï¼š</p>
<p>ç¬¬ä¸€ç§ï¼šæ¯æ¡è¾¹ä¸çŸ©é˜µçš„è¾¹å¹³è¡Œçš„æ­£æ–¹å½¢ï¼›</p>
<p>ç¬¬äºŒç§ï¼šæ¯æ¡è¾¹ä¸çŸ©é˜µçš„å¯¹è§’çº¿å¹³è¡Œçš„æ­£æ–¹å½¢ã€‚</p>
<p>$t\leq 10,000\quad 2\leq n,m\leq 250$</p>
</blockquote>
<p>ç„¶åå°±æ˜¯ä¸ªæœç´¢ï¼Œç”¨æ¥ç»ƒç¨‹åºå®ç°çš„ã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘å…«è¿é€šåœ°å»$\sf dfs$ ï¼Œç„¶ååªæœ$1$ä¸æœ$0$ï¼Œè®°å½•ä¸€ä¸‹æœè¿‡çš„å‘¨é•¿ï¼Œç„¶åå»$check$ ã€‚$check$ä¸»è¦å°±æ˜¯åˆ†ç±»è®¨è®ºæ˜¯å¹³è¡Œå¯¹è§’çº¿è¿˜æ˜¯å¹³è¡Œè¾¹é•¿ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> &amp;step)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (base[x][y] != <span class="number">1</span>) <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    base[x][y] = <span class="number">-1</span>, ++ step ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">8</span> ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> kx = x + dx[i], ky = y + dy[i] ;</span><br><span class="line">        <span class="keyword">if</span> (kx &gt;= <span class="number">1</span> &amp;&amp; kx &lt;= N &amp;&amp; ky &gt;= <span class="number">1</span> &amp;&amp; ky &lt;= M) dfs(kx, ky, step) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">chk1</span><span class="params">(<span class="keyword">int</span> step, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x + step &gt; N || y + step &gt; M) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j ; i &lt;= step ; ++ i)&#123;</span><br><span class="line">        j = (base[x + i][y] != <span class="number">-1</span>) | (base[x][y + i] != <span class="number">-1</span>)</span><br><span class="line">            | (base[x + step][y + i] != <span class="number">-1</span>) | (base[x + i][y + step] != <span class="number">-1</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (j) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">chk2</span><span class="params">(<span class="keyword">int</span> step, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lx = step &lt;&lt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x + lx &gt; N || y + step &gt; M) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (base[x + lx][y] != <span class="number">-1</span> || y &lt; step) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j ; i &lt;= step ; ++ i)&#123;</span><br><span class="line">        j = (base[x + lx - i][y - i] != <span class="number">-1</span>) | (base[x + lx - i][y + i] != <span class="number">-1</span>)</span><br><span class="line">            | (base[x + i][y - i] != <span class="number">-1</span>) | (base[x + i][y + i] != <span class="number">-1</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (j) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ; <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M, ans = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j)</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%1d"</span>, &amp;base[i][j]) ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j)&#123;</span><br><span class="line">                <span class="keyword">if</span> (base[i][j] != <span class="number">1</span>) <span class="keyword">continue</span> ;</span><br><span class="line">                res = <span class="number">0</span>, dfs(i, j, res) ;</span><br><span class="line">                <span class="keyword">if</span> (res % <span class="number">4</span> == <span class="number">0</span> &amp;&amp; res / <span class="number">4</span> &lt;= min(N, M))</span><br><span class="line">                    ans += chk1(res / <span class="number">4</span>, i, j) + chk2(res / <span class="number">4</span>, i, j) ;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-CFÂ·11D"><a href="#rm-CFÂ·11D" class="headerlink" title="$\rm CFÂ·11D$"></a>$\rm CFÂ·11D$</h1><blockquote>
<p>æ±‚ç®€å•æ— å‘å›¾çš„ç¯æ•°ã€‚</p>
<p>$n\leq 19$</p>
</blockquote>
<p>ä¸€å¼€å§‹æƒ³çŠ¶å‹è¾¹ï¼Œä½†æ˜¯å‘ç°è½¬ç§»æ¯”è¾ƒéš¾è½¬ç§»å¹¶ä¸”çŠ¶æ€æ•°å¤ªå¤šã€‚äºæ˜¯å°±è€ƒè™‘å®š$\sf f_{s,u,v}$è¡¨ç¤ºèµ°è¿‡äº†é›†åˆ$\sf s$ä¸­çš„ç‚¹ï¼Œèµ·ç‚¹ä¸º$u$ç»ˆç‚¹ä¸º$v$çš„æ–¹æ¡ˆæ•°ã€‚æšä¸¾è½¬ç§»çš„æ—¶å€™è€ƒè™‘åˆ·è¡¨ï¼Œæšä¸¾ä¸åœ¨é›†åˆ$\sf s$ä¸­çš„ä¸€ä¸ªæ–°ç‚¹è½¬ç§»ã€‚</p>
<p>è§‚å¯Ÿåˆ°å…¶å®è½¬ç§»æ—¶å¹¶ä¸éœ€è¦çŸ¥é“æ˜¯ä»å“ªä¸ªç‚¹è½¬ç§»è¿‡æ¥çš„ï¼Œè¿™ä¸œè¥¿ä¹Ÿä¸å½±å“æ–¹æ¡ˆæ•°ï¼Œæ‰€ä»¥ç›´æ¥é»˜è®¤æ˜¯ä»<code>lowbit</code>è½¬ç§»è¿‡æ¥çš„ï¼Œè¿™æ ·æ¯æ¬¡éœ€è¦åˆ¤ä¸€ä¸‹æ–°çš„ç‚¹ä¼šä¸ä¼šç ´åè¿™ä¸ªçŠ¶æ€çš„èµ·ç‚¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cin &gt;&gt; N &gt;&gt; M, Mx = (1 &lt;&lt; N) - 1 ;</span><br><span class="line">for (i = 1, j = 0 ; j &lt; N ; ++ j, i &lt;&lt;= 1) f[i][j] = 1 ;</span><br><span class="line">for (i = 1 ; i &lt;= M ; ++ i) cin &gt;&gt; u &gt;&gt; v, u --, v --, A[u][v] = A[v][u] = 1 ;</span><br><span class="line">for (s = 1 ; s &lt;= Mx ; ++ s)&#123;</span><br><span class="line">    for (i = 0 ; i &lt; N ; ++ i)&#123;</span><br><span class="line">        if (!((1 &lt;&lt; i) &amp; s) || !f[s][i]) continue ;</span><br><span class="line">        for (j = 0 ; j &lt; N ; ++ j)&#123;</span><br><span class="line">            if (!A[i][j] || low(s) &gt; (1 &lt;&lt; j)) continue ;</span><br><span class="line">            if ((1 &lt;&lt; j) == low(s) &amp;&amp; (1 &lt;&lt; j &amp; s)) ans += f[s][i] ;</span><br><span class="line">            else if (!(1 &lt;&lt; j &amp; s)) f[s | (1 &lt;&lt; j)][j] += f[s][i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; ((ans - M) &gt;&gt; 1) &lt;&lt; endl ;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/çŠ¶å‹DP</tag>
        <tag>åŠ¨æ€è§„åˆ’/æ™®é€šDP</tag>
        <tag>æ•°å­¦/æ‰©å±•æ¬§å‡ é‡Œå¾·</tag>
        <tag>è´ªå¿ƒ</tag>
        <tag>è®¡ç®—å‡ ä½•/åŸºç¡€çš„ç‚¹ã€ç›´çº¿ä¸åœ†</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘Codeforces Round-711 Virtual</title>
    <url>/2019/11/14/Codeforces-711/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸€ä¸ªé©¬æ¥è¥¿äºšè€å“¥å‡ºçš„ä¸€åœº<code>Div2</code>ï¼Œé¢˜ç›®è¿˜ç®—æœ‰ç‚¹æ„æ€ï¼Œäºæ˜¯å°±virtualäº†åä¸‰ä¸ªé¢˜ã€‚</p>
<a id="more"></a>
<h1 id="C"><a href="#C" class="headerlink" title="$C$"></a>$C$</h1><blockquote>
<p>ç»™å®šä¸€æ®µåºåˆ—ï¼Œè¦å¯¹ç€çŸ­åºåˆ—è¿›è¡Œæ¶‚è‰²ã€‚æœ‰äº›ä½ç½®æ¶‚äº†è‰²ï¼Œå°±ä¸èƒ½å†æ¶‚äº†ï¼›æ²¡æ¶‚è‰²çš„ä½ç½®å¯ä»¥æ¶‚ä»»æ„é¢œè‰²ï¼ŒåŒä¸€ä¸ªä½ç½®$i$æ¶‚ä¸åŒçš„é¢œè‰²$j$æœ‰ä¸åŒçš„ä»£ä»·ã€‚æ±‚å°†æ•´ä¸ªåºåˆ—æ¶‚æˆ$k$ä¸ªé¢œè‰²æ®µçš„æœ€å°ä»£ä»·ã€‚</p>
<p>$n,m\leq 100$</p>
</blockquote>
<p>ä¸€çœ¼$dp$ã€‚ç„¶åå°±æ˜¯è®¾è®¡çŠ¶æ€ï¼Œè®°$\mathsf {f_{i,j,k}}$è¡¨ç¤ºå‰$i$ä¸ªæ¶‚æˆäº†$j$æ®µï¼Œæœ€åä¸€æ®µé¢œè‰²æ˜¯$k$çš„æœ€å°ä»£ä»·ï¼Œæš´åŠ›è½¬ç§»å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; K ; </span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cin</span> &gt;&gt; base[i] ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j)</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; val[i][j] ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i)</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= K ; ++ j)</span><br><span class="line">		<span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt;= M ; ++ k)</span><br><span class="line">			dp[i][j][k] = Inf ; </span><br><span class="line"><span class="comment">/*for (i = 1 ; i &lt;= N ; ++ i)</span></span><br><span class="line"><span class="comment">	for (j = i - 1 ; j &gt;= 1 ; -- j)</span></span><br><span class="line"><span class="comment">		if (base[j]) &#123;pos[i] = j + 1 ; break ;&#125;*/</span></span><br><span class="line"><span class="comment">/*for (i = 1 ; i &lt;= N ; ++ i)&#123;</span></span><br><span class="line"><span class="comment">	for (j = 1 ; j &lt; i; ++ j)</span></span><br><span class="line"><span class="comment">		if (j &gt;= pos[i])&#123;</span></span><br><span class="line"><span class="comment">			for (k = 1 ; k &lt;= M ; ++ k)</span></span><br><span class="line"><span class="comment">				for (l = 1 ; l &lt;= M ; ++ l)</span></span><br><span class="line"><span class="comment">					for (w = 1 ; w &lt;= K ; ++ w)</span></span><br><span class="line"><span class="comment">						if (l != k) dp[i][w][k] = max(dp[i][w][k], dp[j][w - 1][l] + ) ;</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		else &#123;</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="keyword">if</span> (base[<span class="number">1</span>]) dp[<span class="number">1</span>][<span class="number">1</span>][base[<span class="number">1</span>]] = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) dp[<span class="number">1</span>][<span class="number">1</span>][i] = val[<span class="number">1</span>][i] ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= K ; ++ j)&#123;</span><br><span class="line">		<span class="keyword">if</span> (!base[i])&#123;</span><br><span class="line">			<span class="keyword">for</span> (k = <span class="number">1</span> ; k &lt;= M ; ++ k)&#123;</span><br><span class="line">				dp[i][j][k] = min(dp[i][j][k], dp[i - <span class="number">1</span>][j][k] + val[i][k]);</span><br><span class="line">				<span class="keyword">for</span> (l = <span class="number">1</span> ; l &lt;= M ; ++ l)</span><br><span class="line">					<span class="keyword">if</span> (k != l) </span><br><span class="line">             dp[i][j][k] = min(dp[i][j][k], dp[i - <span class="number">1</span>][j - <span class="number">1</span>][l] + val[i][k]) ;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			dp[i][j][base[i]] = min(dp[i][j][base[i]], dp[i - <span class="number">1</span>][j][base[i]]) ;</span><br><span class="line">			<span class="keyword">for</span> (k = <span class="number">1</span> ; k &lt;= M ; ++ k )</span><br><span class="line">				<span class="keyword">if</span> (k != base[i]) </span><br><span class="line">           dp[i][j][base[i]] = min(dp[i][j][base[i]], dp[i - <span class="number">1</span>][j - <span class="number">1</span>][k]) ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (Ans = Inf, i = <span class="number">1</span> ; i &lt;= M ; ++ i) Ans = min(Ans, dp[N][K][i]) ; </span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; (Ans == Inf ? - <span class="number">1</span> : Ans) &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br></pre></td></tr></table></figure>
<h1 id="D"><a href="#D" class="headerlink" title="$D$"></a>$D$</h1><blockquote>
<p>æœ‰$n$ä¸ªç‚¹å’Œ$n$æ¡è¾¹ï¼Œç¬¬$i$æ¡è¾¹ä»$i$è¿åˆ°$a_i$ ã€‚ </p>
<p>æ¯æ¡è¾¹éœ€è¦æŒ‡å®šä¸€ä¸ªæ–¹å‘ï¼ˆæ— å‘è¾¹å˜ä¸ºæœ‰å‘è¾¹ï¼‰ã€‚é—®æœ‰å¤šå°‘ç§æŒ‡å®šæ–¹å‘çš„æ–¹æ¡ˆä½¿å¾—å›¾ä¸­ä¸å‡ºç°ç¯</p>
</blockquote>
<p>ä¸€é“è®¡æ•°é¢˜ï¼Œä½†æ˜¯æ¯”è¾ƒç¿æ™ºã€‚ç»™å®šçš„å›¾æ˜¾ç„¶æ˜¯ä¸€å †åŸºç¯æ ‘ã€‚é‚£ä¹ˆè€ƒè™‘ä¸åœ¨ç¯ä¸Šçš„è¾¹æ˜¾ç„¶æ€ä¹ˆå®šå‘éƒ½æ— æ‰€è°“ï¼Œåœ¨ç¯ä¸Šçš„è¾¹ä¹Ÿåªä¼šæ˜¯æ°å¥½éƒ½é¡ºæ—¶é’ˆæˆ–è€…æ°å¥½éƒ½é€†æ—¶é’ˆä¸åˆæ³•ã€‚ä¹˜æ³•åŸç†ä¹˜èµ·æ¥å°±å®Œäº†ã€‚</p>
<p>å¥½æ—©ä¹‹å‰åšçš„é¢˜äº†ï¼Œç„¶åå½“æ—¶è¿™é¢˜å¡äº†åŠå¤©åŸå› æ˜¯æˆ‘å¿˜äº†æ€ä¹ˆdfsæ‰¾ç¯äº†â€¦â€¦å¤§æ¦‚å°±æ˜¯ç¥–å…ˆè®°ä¸€è®°ï¼Œæ ‘ä¸Šæ¸¸ä¸€æ¸¸ï¼Œå°±åšå®Œäº†â€¦ç±»ä¼¼äºtarjanï¼Ÿâ€¦å¯æµ·æ˜Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">expow</span><span class="params">(<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">	ll res = <span class="number">1</span>, base = <span class="number">2</span> ;</span><br><span class="line">	<span class="keyword">while</span> (b)&#123; <span class="keyword">if</span> (b &amp; <span class="number">1</span>) res = res * base % Mod ; (base *= base) %= Mod, b &gt;&gt;= <span class="number">1</span> ; &#125;</span><br><span class="line">	<span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> deep)</span></span>&#123;</span><br><span class="line">	dep[u] = deep, vis[u] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (!vis[to(k)]) dfs(to(k), deep + <span class="number">1</span>) ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (vis[to(k)] &lt;= <span class="number">1</span>) rop[++ tot] = dep[u] - dep[to(k)] + <span class="number">1</span> ;</span><br><span class="line"> 	&#125;</span><br><span class="line">	vis[u] = <span class="number">3</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N, Ans = <span class="number">1</span> ; <span class="keyword">int</span> qaq ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;qaq), Add(i, qaq) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="keyword">if</span> ( !dep[i] ) dfs(i, <span class="number">1</span>) ; cnt = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= tot ; ++ i) </span><br><span class="line">	    cnt += rop[i], (Ans *= (expow(rop[i]) - <span class="number">2</span> + Mod)) %= Mod ;</span><br><span class="line">	Ans = Ans * expow(N - cnt) % Mod ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="E"><a href="#E" class="headerlink" title="$E$"></a>$E$</h1><blockquote>
<p>æ±‚ä¸€å¹´æœ‰$2^n$å¤©ï¼Œ$k$ä¸ªäººå‡ºç°ä¸¤äººç”Ÿæ—¥ç›¸åŒçš„å¯èƒ½æ€§æ˜¯å¤šå°‘ã€‚</p>
<p>$n,k\leq 10^{18},\rm Mod=1e6+3$</p>
</blockquote>
<p>é¦–å…ˆè€ƒè™‘ç­”æ¡ˆå°±æ˜¯</p>
<script type="math/tex; mode=display">
\frac{\prod\limits_{i=2^n-k+1}^{2^n-1}i}{2^{n \cdot {k-1}}}</script><p>ç„¶åå°±å˜æˆäº†å¦‚ä½•æŠŠè¿™ä¸ªä¸œè¥¿æ±‚å‡ºæ¥<del>ä¼ ç»Ÿè‰ºèƒ½.jpg</del></p>
<p>1ã€å¦‚æœ$k&gt;P=1e6+3$ï¼Œé‚£ä¹ˆæ ¹æ®æŠ½å±‰åŸç†åˆ†å­ä¸­è‚¯å®šè‡³å°‘æœ‰ä¸€é¡¹$\bmod \rm P=0$ã€‚</p>
<p>2ã€å› ä¸ºåˆ†æ¯æ˜¯$2$çš„å¹‚ï¼Œæ‰€ä»¥æœ€åå®é™…ä¸Šå°±æ˜¯åœ¨æ±‚åˆ†å­ä¸­æœ‰å¤šå°‘ä¸ª$2$ä¹˜èµ·æ¥</p>
<p>3ã€è€ƒè™‘å¦‚ä½•æ±‚åˆ†å­æœ‰å¤šå°‘ä¸ª$2$ã€‚è€ƒè™‘ä¸€ä¸ªå¼•ç†ï¼Œå°±æ˜¯$2^n-m$å’Œ$m$ä¸­çš„$2$çš„ä¸ªæ•°ä¸€æ ·ã€‚è¯æ˜å¤§æ¦‚å°±æ˜¯è€ƒè™‘ä»¤$m=2^p\cdot q$ï¼Œå…¶ä¸­$p$ä¸ºæå¤§çš„$2$çš„å¹‚æŒ‡æ•°ï¼Œé‚£ä¹ˆ$2^n-m=2^n-2^p\cdot q=2^p(2^{n-p}-q)$ã€‚æ ¹æ®æ•´é™¤çš„æ€§è´¨$a|b-c,a|b\Longleftrightarrow a|c$ï¼Œè€Œ$2\not| ~~ q$ï¼Œæ‰€ä»¥$2^n-m$ä¸­$2$çš„æ¬¡æ•°å°±æ˜¯$p$.</p>
<p>4ã€ç„¶åç”±3ä¸­çš„å¼•ç†ï¼Œå°±æœ‰ä¸€ä¸ªæ¯”è¾ƒç»å…¸çš„åšæ³•ã€‚å°±æ˜¯æˆ‘ä»¬å¯ä»¥å¾—åˆ°</p>
<script type="math/tex; mode=display">
\begin{aligned}
(\prod\limits_{i=2^n-k+1}^{2^n-1}i,2^n)&=(\prod\limits_{i=2^n-k+1}^{2^n-1}(2^n-i), 2^n)\\ &=(\prod\limits_{i=1}^{k}i,2^n)\\ &=(k!,2^n)
\end{aligned}</script><p>å†ç»“åˆæŠ½å±‰åŸç†ï¼Œåªéœ€è¦æšä¸¾$2$çš„å¹‚å°±å¯ä»¥ç®—äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 1000003</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; ll Son, Mom ;</span><br><span class="line">ll N, M, Inv, _gcd, qwq, i, base = <span class="number">1</span>, ans = <span class="number">1</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">expow</span><span class="params">(ll x, ll y)</span></span>&#123;</span><br><span class="line">	ll res = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">while</span> (y)&#123;</span><br><span class="line">		<span class="keyword">if</span> (y &amp; <span class="number">1</span>) (res *= x) %= Mod ;</span><br><span class="line">		(x *= x) %= Mod, y &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res % Mod ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		base &lt;&lt;= <span class="number">1</span> ; <span class="keyword">if</span> (base &gt;= M) &#123; ans = <span class="number">0</span> ; <span class="keyword">break</span> ;&#125; </span><br><span class="line"> 	&#125;</span><br><span class="line"> 	<span class="keyword">if</span> (ans) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"1 1"</span>), <span class="number">0</span> ;  Son = <span class="number">1</span> ;</span><br><span class="line"> 	<span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= M - <span class="number">1</span> ; i &lt;&lt;= <span class="number">1</span>) qwq += (M - <span class="number">1</span>) / i ;  </span><br><span class="line">	_gcd = expow(<span class="number">2</span>, qwq), </span><br><span class="line">  Inv = expow(_gcd, Mod - <span class="number">2</span>) ; </span><br><span class="line">  Mom = expow(<span class="number">2</span>, N  % (Mod - <span class="number">1</span>) * (M - <span class="number">1</span>) % (Mod - <span class="number">1</span>)) ;</span><br><span class="line">  (Mom *= Inv) %= Mod ; </span><br><span class="line">  <span class="keyword">if</span> (M - <span class="number">1</span> &gt;= Mod) </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"%I64d %I64d"</span>, Mom, Mom), <span class="number">0</span> ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; M ; ++ i) </span><br><span class="line">    Son = Son * (expow(<span class="number">2</span>, N) - i + Mod) % Mod ; </span><br><span class="line">  (Son *= Inv) %= Mod, </span><br><span class="line">  Son = ((Mom - Son) % Mod + Mod) % Mod ; </span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; Son &lt;&lt; <span class="string">" "</span> &lt;&lt; Mom &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/æ™®é€šDP</tag>
        <tag>æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ </tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘Codeforces Round-840 Virtual</title>
    <url>/2019/11/14/Codeforces-840/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>virtualäº†ä¸€åœºdiv1ï¼Œå‘ç°é¢˜ç›®æœ‰ç‚¹æ¸…æ–°ï¼Œä½†æ˜¯è‡³ä»Šè¿˜æ˜¯æ²¡æœ‰åš$E$ï¼Œå› ä¸º$E$æ˜¯ä¸ªåˆ†å—233</p>
<a id="more"></a>
<h1 id="A"><a href="#A" class="headerlink" title="$A$"></a>$A$</h1><blockquote>
<p>Lehaå–œæ¬¢å„ç§å„æ ·å¥‡æ€ªçš„äº‹ã€‚æœ€è¿‘ä»–å–œæ¬¢ä¸Šäº†å‡½æ•°$F(n,k)$ã€‚è€ƒè™‘æ‰€æœ‰é›†åˆ$[1,2,\dots,n]$ çš„æœ‰$k$ä¸ªå…ƒç´ çš„å­é›†ã€‚ä¸ºè¿™äº›å­é›†æ‰¾åˆ°å…¶ä¸­æœ€å°çš„å…ƒç´ ã€‚$F(n,k)$ â€” å°±æ˜¯æ‰€æœ‰$k$ä¸ªå…ƒç´ å­é›†ä¸­çš„æœ€å°å…ƒç´ çš„æ•°å­¦æœŸæœ›ã€‚</p>
<p>ä½†æ˜¯ä»…ä»…è¿™ä¸ªå‡½æ•°è¿˜ä¸å¤Ÿä½¿ä»–é«˜å…´ã€‚ä»–æƒ³è¦åœ¨è¿™ä¸Šé¢åšä¸€äº›æ›´æœ‰è¶£çš„äº‹æƒ…ã€‚ä»–çš„å¦ˆå¦ˆç»™ä»–å¸¦æ¥äº†ä¸¤ä¸ªæ•°ç»„$A$å’Œ$B$ï¼Œæ¯ä¸ªéƒ½æœ‰$m$ ä¸ªæ•´æ•°ã€‚å¯¹äºæ‰€æœ‰çš„$i,j$ ï¼ˆ$1\leq i,j\leq m$ï¼‰éƒ½æœ‰$a_i\geq b_j$ã€‚å¸®åŠ©Lehaé‡æ–°æ’åˆ—$A$æ•°ç»„æ¥ä½¿å¾—æœ‰æœ€å¤§çš„$\sum_{i=1}^m F(A_iâ€™,B_i)$ ï¼Œ$A$ æ˜¯é‡æ’åçš„æ•°ç»„ã€‚</p>
<p>$n\leq 10^5$</p>
</blockquote>
<p>åˆšçœ‹åˆ°è¿™é¢˜å‘ç°å¯ä»¥çŒœç»“è®º233â€¦â€¦é€šè¿‡è§‚å¯Ÿæ ·ä¾‹å¯ä»¥å‘ç°ï¼Œåº”è¯¥æ˜¯ç¬¬äºŒä¸ªåºåˆ—ä¸­ç¬¬$k$å°çš„å¯¹åº”ç¬¬ä¸€ä¸ªåºåˆ—ä¸­ç¬¬$k$å¤§çš„â€¦â€¦</p>
<p>ç„¶åè¯æ˜ï¼Œè€ƒè™‘å¯¹$F(n,k)$è¿›è¡Œå˜å½¢ï¼ˆä»¥ä¸‹æ˜¯$\mathsf{\color{black}{B}\color{red}{enq}}$çš„è¿‡ç¨‹ï¼‰</p>
<script type="math/tex; mode=display">
\begin{aligned}
F(n,k)&=\frac{\binom{n-1}{k-1}+2 \cdot \binom{n-2}{k-1}+3 \cdot \binom{n-3}{k-1}+\dots}{\binom{n}{k}}\\&=\frac{\binom{n-1}{k}+\binom{n-2}{k}+\binom{n-3}{k}+\dots}{\binom{n}{k}}\\&=\frac{\binom{n+1}{k+1}}{\binom{n}{k}}\\&=\frac{n+1}{k+1}
\end{aligned}</script><p>ç„¶åå°±æ˜¯å¯¹äºæ¯ä¸€é¡¹ï¼Œéƒ½åº”è¯¥è®©$k+1$å°½é‡å°ï¼Œè®©$n+1$å°½é‡å¤§ï¼Œå°±å˜æˆäº†ä¸€ä¸ªè´ªå¿ƒé—®é¢˜äº†233</p>
<h1 id="B"><a href="#B" class="headerlink" title="$B$"></a>$B$</h1><blockquote>
<p>ç»™å®šä½ ä¸€äº›è¾¹ï¼Œå¯èƒ½æœ‰é‡è¾¹ã€‚å¯¹äºæ¯ä¸ªç‚¹ç»™å®šä¸€ä¸ª$d_i$ï¼Œå¦‚æœä¸º$1$è¡¨ç¤ºè¿™ä¸ªç‚¹çš„åº¦æ•°ä¸ºå¥‡æ•°ï¼Œ$0$è¡¨ç¤ºè¿™ä¸ªç‚¹çš„åº¦æ•°ä¸ºå¶æ•°ï¼Œä¸º$-1$è¡¨ç¤ºè¿™ä¸ªç‚¹çš„åº¦æ•°æ²¡æœ‰é™åˆ¶ã€‚</p>
<p>ä½ éœ€è¦é€‰å‡ºä¸€äº›è¾¹ï¼ˆä¸ä¸€å®šè”é€šï¼‰ï¼Œä½¿å¾—è¿™äº›è¾¹æ„æˆçš„å›¾ç¬¦åˆè¦æ±‚ã€‚</p>
<p>$n\leq 3\cdot 10^5$</p>
</blockquote>
<p>é¦–å…ˆè€ƒè™‘å¦‚æœæ²¡æœ‰<code>-1</code>å¹¶ä¸”å¥‡åº¦ç‚¹æ•°é‡ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆä¸€å®šæ— è§£ã€‚å› ä¸ºæ•´å¼ å›¾çš„åº¦æ•°ä¹‹å’Œä¸€å®šæ˜¯$2m$ä¸ºå¶æ•°ã€‚</p>
<p>å‘ç°ä¼¼ä¹æœ€ç®€å•çš„æ–¹å¼æ˜¯ç”Ÿæˆä¸€æ£µæ ‘ï¼Œäºæ˜¯å†³å®šç”Ÿæˆæ ‘ï¼›å¹¶ä¸”æ ¹æ®ä¸Šä¸€å¥çš„æ€§è´¨ï¼Œåªè¦ä»»æ„æ—¶åˆ»ä¿è¯åº¦æ•°ä¸ºå’Œå¶æ•°å³å¯ï¼ˆä¸è¦æ±‚è¿é€šï¼‰ã€‚</p>
<p>ç„¶ååˆ†ç±»è®¨è®ºï¼š<code>0</code>çš„ç‚¹å’Œ<code>1</code>çš„ç‚¹</p>
<ul>
<li><code>0</code>çš„ç‚¹ã€‚ç›´æ¥å¿½ç•¥ï¼Œå› ä¸ºä¸äº§ç”Ÿå½±å“ï¼›</li>
<li><code>1</code>çš„ç‚¹ã€‚é€‰æ‹©å®ƒçš„ä¸Šè¡Œè¾¹ã€å–åå…¶çˆ¶äº²å¹¶ä¸”å¿½ç•¥è¿™ä¸ªç‚¹ã€‚åŸå› è¿˜æ˜¯åº¦æ•°å’Œä¸å˜ã€‚</li>
</ul>
<p>äºæ˜¯å¯çŸ¥è¿™æ˜¯ä¸€ä¸ªåˆç†çš„æ–¹æ¡ˆâ€¦â€¦ç›´è§‚ä¸Šå¾ˆéš¾æ„Ÿè§‰èµ·æ¥æ˜¯å¯¹çš„ï¼Œä½†æ˜¯åªè¦ç´§æ¡ä½â€œåº¦æ•°å’Œä¸ºå¶æ•°â€è¿™ä¸ªæ€§è´¨ä¸å˜å³å¯ã€‚ä»£ç å®ç°ä¸Šä¹Ÿå¯åœˆå¯ç‚¹ï¼Œæ¯ä¸ªç‚¹çš„çŠ¶æ€åœ¨æ²¡éå†å®Œæ•´æ£µå­æ ‘æ—¶éƒ½æ˜¯æœªçŸ¥ï¼Œæ˜¯å¾ˆé²œæ˜çš„ä¿¡ç«ç‰¹ç‚¹â€¦â€¦æ€»ä¹‹æˆ‘ä¸ä¼šï¼Œå­¦åˆ°äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//e.g.2: -1è¡¨ç¤ºä¸èƒ½æœ‰ä¸€ç§æ–¹æ¡ˆï¼Œè€Œ0åˆ™è¡¨ç¤ºæˆ‘å¦‚æœä¸€æ¡è¾¹éƒ½ä¸é€‰ï¼Œä¾æ—§å¯ä»¥æ»¡è¶³è¿™ä¸ªæ¡ä»¶ </span></span><br><span class="line"><span class="keyword">bool</span> vis[MAXN] ;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ST</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">	vis[u] = <span class="number">1</span> ; <span class="keyword">int</span> ret = base[u] ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (vis[to(k)]) <span class="keyword">continue</span> ;</span><br><span class="line">		<span class="keyword">if</span> (ST(to(k))) </span><br><span class="line">      res[++ tot] = (k + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, ret ^= <span class="number">1</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (base[u] &lt; <span class="number">0</span>) ret = <span class="number">0</span> ; </span><br><span class="line">  <span class="keyword">return</span> ret ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), </span><br><span class="line">  	(base[i] &lt; <span class="number">0</span>) ? mr1 = i : (mr2 ^= base[i]) ;</span><br><span class="line">	<span class="keyword">if</span> (!mr1 &amp;&amp; mr2) </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ; </span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B), Add(A, B) ;</span><br><span class="line">	ST(mr1 ? mr1 : <span class="number">1</span>) ;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; tot &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">  sort(res + <span class="number">1</span>, res + tot + <span class="number">1</span>) ; </span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= tot ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d "</span>, res[i]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C"><a href="#C" class="headerlink" title="$C$"></a>$C$</h1><blockquote>
<p>ç»™å®š$n(1â‰¤nâ‰¤300)$ä¸ªæ•°ï¼Œæ±‚é—®æœ‰å¤šå°‘ç§æ’åˆ—æ–¹æ¡ˆä½¿å¾—ä»»æ„ä¸¤ä¸ªç›¸é‚»çš„æ•°ä¹‹ç§¯éƒ½ä¸æ˜¯å®Œå…¨å¹³æ–¹æ•°ã€‚ç”±äºæ–¹æ¡ˆæ•°å¯èƒ½å¾ˆå¤§ï¼Œè¾“å‡ºæ–¹æ¡ˆæ•°$\bmod 10^9+7$çš„å€¼ã€‚</p>
</blockquote>
<p>è€ƒè™‘ç›¸é‚»ä¸¤ä¸ªæ•°ä¹‹ç§¯æ˜¯å®Œå…¨å¹³æ–¹æ•°çš„å……è¦æ¡ä»¶ï¼Œå½“ä¸”ä»…å½“å°†ä¸¤ä¸ªæ•°çš„æ‰€æœ‰è´¨å› å­æ¬¡æ•°$\bmod ~2$ åï¼Œä¸¤ä¸ªæ•°ç›¸åŒæ—¶ï¼Œå…¶ä¹˜ç§¯æ‰ä¼šä¸ºå®Œå…¨å¹³æ–¹æ•°ã€‚</p>
<p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§æ€§è´¨å¯ä»¥ä¼ é€’ï¼Œå³$a\cdot b$ä¸ºå®Œå…¨å¹³æ–¹æ•°ï¼Œ$b\cdot c$ä¸ºå®Œå…¨å¹³æ–¹æ•°ï¼Œé‚£ä¹ˆ$a\cdot c$ä¹Ÿæ˜¯ã€‚äºæ˜¯å¯ä»¥å¯¹æ‰€æœ‰çš„æ•°æš´åŠ›åˆ†ç»„ï¼Œæ¯ä¸ªç»„æ‰¾ä¸€ä¸ªä»£è¡¨å…ƒæ¥è®°å½•ã€‚è®¾æ¯ä¸€ç»„ä¸­æœ‰$cnt_i$ä¸ªæ•°ï¼Œå‰$i$ä¸ªç»„çš„$cnt$å‰ç¼€å’Œä¸º$s_i$ã€‚</p>
<p>é‚£ä¹ˆé—®é¢˜è½¬åŒ–æˆäº†ç»™å®š$n$ä¸ªæ•°ï¼ŒåŒä¸€ç»„çš„å…ƒç´ ä¸èƒ½æ”¾åœ¨ä¸€èµ·ï¼Œæ±‚æ’åˆ—æ•°ã€‚é‚£ä¹ˆå°±æ˜¯$f_{i,j}$è¡¨ç¤ºå‰$i$ä¸ªç»„ï¼Œæœ‰$j$å¯¹ç›¸é‚»å…ƒç´ çš„ä¹˜ç§¯ä¸ºå®Œå…¨å¹³æ–¹æ•°çš„æ’åˆ—æ•°ï¼Œè½¬ç§»æ—¶è€ƒè™‘ï¼Œæšä¸¾å½“å‰è¿™ä¸€ç»„è¢«åˆ†æˆäº†$k$å—ï¼Œæ’æ¿æ³•æ’å‡ºæ¥çš„æ–¹æ¡ˆæ•°ä¸º$\binom{cnt_i-1}{k-1}$ï¼Œå¹¶ä¸”ä¼šå¤šåŠ ä¸Š$cnt_i-k$ä¸ªä¸åˆæ³•çš„ä½ç½®ï¼›ç„¶åè€ƒè™‘è¿™$k$å—æ’åˆ°äº†ä¸Šä¸€ä¸ªçŠ¶æ€ä¸­ï¼Œ$j$å¯¹ä¸åˆæ³•ç›¸é‚»çš„æ•°ä¸­ï¼Œ$o$å¯¹ä¸åˆæ³•çš„æ•°ä¹‹é—´ï¼ˆå³æœ‰$o$å¯¹æ•°è¢«æ‹†å¼€äº†ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šå°‘$o$å¯¹éæ³•æ•°å¯¹ã€‚ç„¶åå°±æ˜¯$\binom{j}{o}$ã€‚è€ƒè™‘å‰©ä¸‹çš„äº†$k-o$å—ï¼Œè¿™$k-o$å—å¯ä»¥æ”¾åˆ°$s_i-j+1$ä¸ªæ­£å¸¸çš„ç©ºéš™é‡Œé¢ï¼Œäºæ˜¯å†ä¹˜ä¸€ä¸ª$\binom{s_i-j+1}{k-o}$</p>
<script type="math/tex; mode=display">
f_{i,j+cnt_i-k-o}=f_{i-1,j}\times \sum\limits_{k\leq cnt_i,l\leq j} (cnt_i!)\cdot \binom{cnt_i-1}{k-1} \cdot \binom{s_i-j+1}{k-o}\cdot \binom{j}{o}</script><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">expow</span><span class="params">(ll d, ll z)</span></span>&#123;</span><br><span class="line">	ll res = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">if</span> (d == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">while</span> (z)&#123;</span><br><span class="line">		<span class="keyword">if</span> (z &amp; <span class="number">1</span>) (res *= d) %= Mod ;</span><br><span class="line">		( d *= d ) %= Mod, z &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N, dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; base[i] ; <span class="keyword">bool</span> mk = <span class="number">0</span> ;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">			ll p = trunc(<span class="built_in">sqrt</span>(base[i] * grp[j])) ;</span><br><span class="line">			<span class="keyword">if</span> (p * p == base[i] * grp[j])&#123;++ tm[j], mk = <span class="number">1</span> ; <span class="keyword">break</span> ; &#125; </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!mk) grp[++ cnt] = base[i], tm[cnt] = <span class="number">1</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="keyword">for</span> (Cm[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>, i = <span class="number">1</span> ; i &lt;= N ; ++ i) Cm[i][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (Frac[<span class="number">0</span>] = <span class="number">1</span>, i = <span class="number">1</span> ; i &lt;= N ; ++ i) Frac[i] = Frac[i - <span class="number">1</span>] * i % Mod ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= i ; ++ j)</span><br><span class="line">			Cm[i][j] = (Cm[i - <span class="number">1</span>][j] + Cm[i - <span class="number">1</span>][j - <span class="number">1</span>]) % Mod ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= cnt ; tot += tm[i], ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= tot ; ++ j) </span><br><span class="line">			<span class="keyword">for</span> (k = <span class="number">1</span> ; k &lt;= tm[i] ; ++ k)	</span><br><span class="line">				<span class="keyword">for</span> (l = <span class="number">0</span>, t = tm[i] - k + j ; l &lt;= j ; ++ l, t --)</span><br><span class="line">					<span class="keyword">if</span>(t &gt;= <span class="number">0</span> &amp;&amp; t &lt; N) </span><br><span class="line">            (dp[i][t] += </span><br><span class="line">             Frac[tm[i]] * Cm[tm[i] - <span class="number">1</span>][k - <span class="number">1</span>] % Mod </span><br><span class="line">           * Cm[j][l] % Mod * Cm[tot - j + <span class="number">1</span>][k - l] % Mod </span><br><span class="line">           * dp[i - <span class="number">1</span>][j] % Mod) %= Mod ;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; dp[cnt][<span class="number">0</span>] &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D"><a href="#D" class="headerlink" title="$D$"></a>$D$</h1><p>è¿™ä¸ªDæ›¾ç»å•ç‹¬å†™è¿‡ï¼š<a href="http://www.orchidany.cf/2019/04/05/å¯æŒä¹…åŒ–æ•°æ®ç»“æ„Â·ä¸é è°±çš„åšæ³•â€”â€”ä¸»å¸­æ ‘ä¸ŠäºŒåˆ†/" target="_blank" rel="noopener">Link</a></p>
<p>233åæ­£å°±æ˜¯ä¹±æå°±å¯¹äº†</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>æ€ç»´é¢˜/è®¡æ•°</tag>
        <tag>æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ </tag>
        <tag>æ€ç»´é¢˜/æ„é€ </tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘æ ¡å†…æ¨¡æ‹Ÿèµ›é€‰æ•´ Â· E2</title>
    <url>/2019/11/14/xiaone-2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ ¡å†…æ¨¡æ‹Ÿèµ›ç¬¬äºŒå¼¹</p>
<a id="more"></a>
<h1 id="A"><a href="#A" class="headerlink" title="$A$"></a>$A$</h1><blockquote>
<p>$ğ‘$åº§æ¥¼æˆ¿ï¼Œç«‹äºåŸä¸­ã€‚ç¬¬$ğ‘–$åº§æ¥¼ï¼Œé«˜åº¦$â„_ğ‘–$ã€‚ä½ éœ€è¦ä¸€å¼€å§‹é€‰æ‹©ä¸€åº§æ¥¼ï¼Œå¼€å§‹è·³æ¥¼ã€‚åœ¨ç¬¬ğ‘–åº§æ¥¼å‡†å¤‡è·³æ¥¼éœ€è¦$ğ‘_ğ‘–$çš„èŠ±è´¹ã€‚ æ¯æ¬¡å¯ä»¥è·³åˆ°ä»»ä½•ä¸€ä¸ªè¿˜æ²¡æœ‰è·³è¿‡çš„æ¥¼ä¸Šå»ã€‚è·³æ¥¼æœ‰ä»£ä»·ï¼Œæ¯æ¬¡è·³åˆ°å¦å¤–ä¸€åº§æ¥¼çš„ä»£ä»·æ˜¯ä¸¤åº§æ¥¼é«˜åº¦çš„å·®çš„ç»å¯¹å€¼ï¼Œæœ€åä¸€æ¬¡ä»æ¥¼ä¸Šè·³åˆ°åœ°é¢ä¸Šä¸éœ€è¦ä»£ä»·ï¼ˆåªèƒ½è·³åˆ°åœ°ä¸Šä¸€æ¬¡ï¼‰ã€‚æ±‚åœ¨ä»£ä»·ä¸è¶…è¿‡ğ‘‡çš„æƒ…å†µä¸‹ï¼Œæœ€å¤šè·³å‡ æ¬¡æ¥¼ã€‚ </p>
</blockquote>
<p>æ€§è´¨é¢˜ï¼Œæ‰¾ä¸å‡ºæ¥äººä¼¼ä¹å°±æ²¡äº†233</p>
<p>è€ƒè™‘æœ€ä¼˜æƒ…å†µä¸‹è‚¯å®šä¼šæ˜¯<strong>å•è°ƒåœ°è·³</strong>ï¼Œå³è¦ä¹ˆå•å¢åœ°è·³ï¼Œè¦ä¹ˆå•å‡åœ°è·³ã€‚è¿™æ ·å°±å¯ä»¥è®¾è®¡çŠ¶æ€äº†$f_{i,j}$ä¸ºè·³åˆ°$i$ï¼Œè·³äº†$j$æ ‹æ¥¼æœ€å°ä»£ä»·ï¼Œç„¶åæšä¸¾ä¸€éçŠ¶æ€å³å¯ã€‚</p>
<h1 id="B"><a href="#B" class="headerlink" title="$B$"></a>$B$</h1><blockquote>
<p>å°$c$åˆ‡LuoguP5487è¿™é¢˜ï¼Œä½†æ˜¯èœå¦‚å°$c$ï¼Œä»–å†™æŒ‚äº†ã€‚</p>
<p>å°$c$å¼€å§‹äº†æ¼«é•¿çš„<code>debug</code>çš„é˜¶æ®µï¼Œ2å¤©è¿‡å»äº†å°$c$è¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°è‡ªå·±ç¨‹åºå“ªé‡Œå†™é”™äº†ã€‚äºæ˜¯ä»–æ‰“å°äº†è‡ªå·±æ‰€æœ‰å‡½æ•°çš„å‡ºå…¥å£çš„ä¿¡æ¯ã€‚å¯¹äºå°$c$å†™çš„ç¬¬$i$ä¸ªå‡½æ•°ï¼Œä»–çš„å…¥å£ä¼šè¾“å‡º$+i$ï¼Œä»–çš„å‡ºå£ä¼šè¾“å‡º$-i$ã€‚</p>
<p>ç­‰åˆ°ä»–æŠŠæ‰€æœ‰çš„è¾“å‡ºæ‰“å‡ºæ¥æ—¶ï¼Œå‘ç°ç”±äºå­—ç¬¦é›†çš„é—®é¢˜å‰é¢çš„ç¬¦å·æ¶ˆå¤±äº†ã€‚ä½†æ˜¯ä»–éšçº¦è®°å¾—æŸå‡ ä¸ªå‡½æ•°çš„å‡ºå£çš„è¾“å‡ºä½ç½®ã€‚ç°åœ¨å°$c$æƒ³çŸ¥é“ä¸€ä¸ªå¯èƒ½çš„æ‰“å°åºåˆ—ï¼Œå¦‚æœä¸å­˜åœ¨è¾“å‡º<code>NO</code></p>
</blockquote>
<p>é¢˜è§£é‡Œé¢å†™è¿™é¢˜å¯ä»¥å€’ç€åšï¼Œå³ä»åå‘å‰æ‰«ï¼Œå¦‚æœè¿™ä¸ªæ‹¬å·æ²¡æœ‰æŒ‡å®šæˆå³æ‹¬å·è€Œä¸”ä»–æ˜¯å·¦æ‹¬å·åˆæ³•ï¼Œåˆ™æ ‡è®°ä¸ºå·¦æ‹¬å·ï¼›å¦åˆ™ä¸ºå³æ‹¬å·ã€‚è·‘å®Œä¹‹åçœ‹çœ‹æ˜¯å¦åˆæ³•ã€‚æ€æƒ³å¤§æ¦‚å°±æ˜¯è¯¡å¼‚çš„è´ªå¿ƒï¼Œå› ä¸ºå·¦æ‹¬å·åªä¼šè¢«â€œå®‰æ’â€ï¼Œä¸ºäº†ä¿è¯å·¦/å³å¹³è¡¡ï¼Œæ•…é€‰æ‹©å¯¹å·¦æ‹¬å·è´ªå¿ƒã€‚</p>
<p>æˆ‘ä¹Ÿæ˜¯è´ªå¿ƒåšçš„ï¼Œä¸è¿‡æ˜¯æ­£ç€åšçš„ã€‚æ²¡æœ‰é™åˆ¶æ—¶ï¼Œå¦‚æœä¸Šä¸€ä¸ªæ˜¯<code>(</code>ï¼Œé‚£æˆ‘è¿™ä¸€ä¸ªå°±å®‰æ’æˆ<code>)</code>å°±å¥½äº†ï¼Œä½†ç®—ä¸Šé™åˆ¶æ—¶ï¼Œå‡ºé—®é¢˜çš„å°±æ˜¯ä¼šæŠŠä¸€äº›å·¦æ‹¬å·é™åˆ¶ä¸ºå³æ‹¬å·ï¼Œå³â€œå¼ºåˆ¶åµŒå¥—â€ã€‚é‚£ä¹ˆå¦‚æœåŸæœ¬æ˜¯<code>()(</code>è¿™æ ·ï¼Œç¬¬ä¸‰ä¸ªæ‹¬å·è¢«å¼ºåˆ¶ä¸ºå³æ‹¬å·ï¼Œå°±é¡ºä¾¿æŠŠå‰ä¸€ä¸ªå³æ‹¬å·æ”¹æˆ<code>(</code>ï¼Œå³å˜ä¸º<code>(()</code>ï¼Œç•™ç€å»è·Ÿåé¢çš„åŒ¹é…ã€‚åˆä¸åˆæ³•æœ€åå†$check$ä¸€éå°±å¥½äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">int</span> i, j ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) base[i] = qr() ; </span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">cin</span> &gt;&gt; M, i = <span class="number">1</span> ; i &lt;= M ; ++ i) ok[qr()] = <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">	<span class="keyword">if</span> (ok[i] &amp;&amp; !stk[base[i]].size())&#123;</span><br><span class="line">		ans[i] = <span class="number">1</span> ; </span><br><span class="line">		stk[base[i]].pb(mat[buc[base[i]]]) ;</span><br><span class="line">		ans[i] = <span class="number">1</span>, ans[mat[buc[base[i]]]] = ans[buc[base[i]]] = <span class="number">0</span> ;</span><br><span class="line">		mat[i] = buc[base[i]], mat[buc[base[i]]] = i ; buc[base[i]] = i ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (!stk[base[i]].size()) stk[base[i]].pb(i), ans[i] = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">else</span> mat[i] = stk[base[i]].back(), ans[i] = <span class="number">1</span>, </span><br><span class="line">		 mat[stk[base[i]].back()] = i, stk[base[i]].pop_back(), buc[base[i]] = i ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		<span class="keyword">if</span> (!ans[i]) <span class="built_in">stack</span>[++ t] = i ; </span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (!t) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>), <span class="number">0</span> ;</span><br><span class="line">		 <span class="keyword">else</span> <span class="built_in">stack</span>[t --] = <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">if</span> (t) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>), <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%c%d "</span>, ans[i] ? <span class="string">'-'</span> : <span class="string">'+'</span>, base[i]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C"><a href="#C" class="headerlink" title="$C$"></a>$C$</h1><blockquote>
<p>ç»™å®š$n\leq 1,000$ã€‚æ±‚æœ€å°‘éœ€è¦å¤šå°‘ä¸åŒçš„$a_i\in[1,n]$ï¼Œä½¿å¾—$\forall x, 1\leq x\leq n$ï¼Œæ€»å¯ä»¥é€‰å‡ºæŸä¸ª$\{a\}$çš„å­é›†æ¥å‡‘å‡º$x$ã€‚åŒæ—¶ï¼Œæ±‚æœ€å°$|\{a\}|$ä¸‹å‡‘å‡ºæ‰€æœ‰$x$çš„æ–¹æ¡ˆæ€»æ•°ã€‚</p>
</blockquote>
<p>ç¬¬ä¸€é—®æ˜¯ä¸ªè´ªå¿ƒâ€¦â€¦è´ªå¿ƒâ€¦â€¦å°±æ˜¯äºŒè¿›åˆ¶åˆ†è§£çš„æ€è·¯ï¼Œ$n$çš„äºŒè¿›åˆ¶ä½æ•°å°±æ˜¯ç­”æ¡ˆã€‚æ„Ÿè§‰å¦‚æœè¦è¯æ˜ï¼Œè¯æ˜èµ·æ¥å…¶å®æ˜¯æŒºè‡ªç„¶çš„ã€‚è€ƒè™‘é¦–å…ˆäºŒè¿›åˆ¶åˆ’åˆ†ä¸€å®šæ˜¯åˆæ³•çš„ï¼ŒåŒæ—¶å¦‚æœå°†å…¶ä¸­çš„$&gt;1$ä¸ªæ¢å‡ºå»ï¼Œé‚£ä¹ˆä¸€å®šå‡‘ä¸å‡º$1$~$n$çš„æ‰€æœ‰æ•°ã€‚</p>
<p>ç¬¬äºŒé—®æ®è¯´æ˜¯ä¸€ä¸ªç»å…¸çš„$dp$ã€‚è€ƒè™‘çŠ¶æ€$f_{i,j,k}$è¡¨ç¤ºå¸¦äº†$i$æšé‡‘å¸ï¼Œå’Œä¸º$j$ï¼Œæœ€å¤§å€¼ä¸º$k$çš„æ–¹æ¡ˆæ•°ã€‚ç„¶è€Œå¯¹æˆ‘æ¥è¯´çŠ¶æ€å¹¶ä¸æ˜¯å¾ˆå®¹æ˜“å®šä¹‰â€¦â€¦emmmã€‚è½¬ç§»çš„è¯é‡‡ç”¨åˆ·è¡¨æ³•æ¯”è¾ƒç®€å•ï¼Œè€ƒè™‘å¯¹äºä¸€ä¸ªçŠ¶æ€$f_{i,j,k}$ï¼Œæšä¸¾æ¯”$k$å¤§çš„$o$ï¼Œé‚£ä¹ˆå°±æœ‰$f_{i,j,k}\to f_{i+1,\min(j+o,n),l}$ .</p>
<h1 id="D"><a href="#D" class="headerlink" title="$D$"></a>$D$</h1><blockquote>
<p>å·²çŸ¥Cå›½æœ‰nä¸ªåŸå¸‚ï¼ŒåŸå¸‚é—´æœ‰mæ¡åŒå‘é“è·¯ï¼Œæ¯æ¡è·¯æœ‰é™é‡ã€‚JDå…¬å¸æƒ³ä¿®å»ºä¸€äº›ä»“åº“æ¥å®ç°å¯¹Cå›½æ‰€æœ‰åŸå¸‚çš„é…é€ï¼Œä»“åº“å¿…é¡»ä¿®å»ºåœ¨æŸä¸ªåŸå¸‚ã€‚é€è¾¾æ¯ä¸ªåŸå¸‚çš„è´§ç‰©å¯ä»¥ç”±ä»»æ„ä¸€ä¸ªä»“åº“å‘å‡ºï¼Œä¸è¿‡åœ¨è¿è¾“é€”ä¸­å¿…é¡»æ»¡è¶³é™é‡çš„è¦æ±‚ã€‚</p>
<p>JDå…¬å¸æƒ³è®©ä½ è®¾è®¡ä¸€ä¸ªç¨‹åºæ¥å¸®åŠ©é«˜ç®¡å†³ç­–ï¼Œqæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®è®¡ç®—å¦‚æœæƒ³é…é€é‡é‡ä¸ºwçš„ç‰©å“ï¼Œè‡³å°‘éœ€è¦å»ºå¤šå°‘ä¸ªä»“åº“ã€‚</p>
</blockquote>
<p><del>è´¨ç–‘é¢˜é¢åœ¨æ°é¥­</del></p>
<p>ä¸€ä¸ªæ¯”è¾ƒæ˜¾ç„¶çš„æ€æƒ³å°±æ˜¯å»ºå‡ºæœ€å¤§ç”Ÿæˆæ ‘æ¥ã€‚ç„¶åæ¯”è¾ƒå¸¸è§„çš„åšæ³•å°±æ˜¯è¾¹å»ºæ ‘è¾¹é£è¯¢é—®ï¼Œè€ƒè™‘åŠ å®Œç¬¬ä¸€æ¡è½½é‡ä¸º$val$è¾¹ä¹‹å‰ï¼Œç°åœ¨çš„è¿é€šå—ä¸ªæ•°å°±æ˜¯é‡é‡ä¸º$val-1$çš„è¯¢é—®çš„ç­”æ¡ˆï¼Œäºæ˜¯ç¦»çº¿ä¸‹æ¥é£å°±å¯ä»¥äº†ã€‚</p>
<p>ç„¶åè¿™ä¸œè¥¿ä¹Ÿå¯ä¸ç¦»çº¿ä¸‹æ¥å†å»é£è¯¢é—®ã€‚è§‚å¯Ÿæ€§è´¨å¯ä»¥å‘ç°å‡è®¾ç°åœ¨è¯¢é—®çš„é‡é‡ä¸º$w_q$ï¼Œé‚£ä¹ˆå¯¹äºæ‰€æœ‰é™é‡$w_o&lt;w_q$çš„è¾¹ï¼Œä¸€å®šä¼šåˆ†æˆä¸¤ä¸ªè¿é€šå—ã€‚äºæ˜¯å¯ä»¥ç›´æ¥æŠŠæœ€å¤§ç”Ÿæˆæ ‘çš„è¾¹æ’ä¸€ä¸ªåºï¼Œç„¶åäºŒåˆ†å‡º$&lt;w_q$çš„ä¸ªæ•°å³ä¸ºç­”æ¡ˆã€‚</p>
<h1 id="E"><a href="#E" class="headerlink" title="$E$"></a>$E$</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯æ¬¡è¯¢é—®ä¸€ä¸ªå­ä¸²ä¸­$A$çš„ä¸ªæ•°å’Œ$B$çš„ä¸ªæ•°çš„æ¯”å€¼ä¸º$x:y$çš„å­ä¸²çš„æœ€é•¿é•¿åº¦ã€‚</p>
<p>$n,q\leq 100,000$</p>
</blockquote>
<p>ä¸€å¼€å§‹æˆ‘æ˜¯çœŸæ²¡æƒ³å†™è¿™é¢˜â€¦â€¦ä½†æ˜¯æƒ³äº†ä¸ªçº¿æ®µæ ‘å‘ç°è‡ªå·±å‡äº†ï¼Œç„¶åå°±è¢«è¿«å…¥å‘ã€‚ã€‚</p>
<p>è€ƒè™‘æ¨å¼å­</p>
<script type="math/tex; mode=display">
\frac{A_r-A_{l-1}}{B_r-B_{l-1}}=\frac{x}{y}\\
x\cdot (B_r-B_{l-1})=y\cdot (A_r-A_{l-1})\\
y \cdot A_r-x \cdot B_r=y \cdot A_{l-1}-x \cdot B_{l-1}</script><p>ç„¶åå¦‚æœæˆ‘ä»¬ä»¤$val_i=y\cdot A_i-x \cdot  B_i$ï¼Œé‚£ä¹ˆæ±‚çš„å°±æ˜¯åŒºé—´å†…ç›¸åŒçš„æ•°ç›¸éš”çš„æœ€é•¿è·ç¦»ã€‚å¤©çœŸçš„æˆ‘ä»¥ä¸ºè¿™é¢˜å¯ä»¥çº¿æ®µæ ‘ï¼Œç„¶åå°±å¾ˆå¼€å¿ƒåœ°æƒ³åšâ€¦â€¦å»<code>uoj</code>ç¾¤é‡Œé—®äº†ä¸€åœˆå‘ç°è¿™ä¸ªè¢«<code>lxl</code>è§„çº¦åˆ°äº†$n \sqrt n$çš„é—®é¢˜ä¸Šé¢â€¦â€¦</p>
<p>ç„¶åå°±è§‰å¾—ï¼Œå¤§æ¦‚å¯ä»¥è«é˜Ÿå§ã€‚äºæ˜¯å°±æƒ³ä¸Šè«é˜Ÿï¼Œç»“æœå‘ç°è¿™ä¸œè¥¿ä¼¼ä¹å¹¶ä¸æ˜¯å¾ˆå¥½ç»Ÿè®¡â€¦â€¦äºæ˜¯å†™äº†åŠå¤©ä¹‹åæ¯…ç„¶å†³ç„¶åœ°å†™äº†ä¸€ä¸ªçº¿æ®µæ ‘ã€‚æœ€ç»ˆåœ¨luoguä¸ŠäºŒåˆ†è¿™ä¸ªé¢˜çš„æ—¶é™ï¼Œå¡åˆ°äº†<code>100ms~6500ms</code>è¿™ä¸ªèŒƒå›´â€¦â€¦ç„¶åæœ€ç»ˆå¤æ‚åº¦å°±åº”è¯¥æ˜¯$n\sqrt q \log n$ã€‚</p>
<p>ç„¶åè«é˜Ÿç¡®å®å¯ä»¥å¡å¸¸ï¼Œå¤§æ¦‚å°±æ˜¯ä¸è¦å‚»å‚»åœ°çœŸæŠŠ$Q$åˆ†æˆ$\sqrt Q$å—ï¼Œå› ä¸ºå¸¸æ•°å› å­å¯¼è‡´å‡å€¼ä¸ç­‰å¼æå‡ºæ¥çš„ç»“æœæ²¡æœ‰é‚£ä¹ˆå¯¹ï¼›ç„¶åè«é˜Ÿçš„cmpå¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(qrs a, qrs b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (blg[a.l] ^ blg[b.l]) ? </span><br><span class="line">      		  blg[a.l] &lt; blg[b.l] : ((blg[a.l] &amp; <span class="number">1</span>) ? a.r &lt; b.r : a.r &gt; b.r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¥‡æ•°å—æ­£ç€æ’ï¼Œå¶æ•°å—å€’ç€æ’ï¼Œå°±ä¼šå¿«å¥½å¤šã€‚</p>
<p>ç„¶åæœ€åï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å†™äº†ä¸€ä¸‹åˆQAQ</span></span><br><span class="line"><span class="keyword">char</span> s[MAXN] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qrs</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, id ;</span><br><span class="line">&#125;q[MAXN] ; <span class="keyword">int</span> l, r, buc[MAXM], val[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> blg[MAXN], T[MAXM &lt;&lt; <span class="number">2</span>], ans[MAXN], Pre[MAXN], Nxt[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, X, Y, M, S, U, base[MAXN], cnt[<span class="number">2</span>][MAXM], pre[MAXN][<span class="number">2</span>], res, res2 ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ; <span class="keyword">int</span> res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) res = (res &lt;&lt; <span class="number">1</span>) + (res &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(qrs a, qrs b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> blg[a.l] == blg[b.l] ? a.r &lt; b.r : blg[a.l] &lt; blg[b.l] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(qrs a, qrs b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (blg[a.l] ^ blg[b.l]) ? blg[a.l] &lt; blg[b.l] : ((blg[a.l] &amp; <span class="number">1</span>) ? a.r &lt; b.r : a.r &gt; b.r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> p, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (L + R) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (L == R) <span class="keyword">return</span> T[rt] = v, <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, L, mid, p, v) ;</span><br><span class="line">    <span class="keyword">else</span> update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, R, p, v) ;</span><br><span class="line">    T[rt] = max(T[rt &lt;&lt; <span class="number">1</span>], T[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; p &lt;&lt; " : " &lt;&lt; cnt[0][val[p]] &lt;&lt; " " &lt;&lt; cnt[1][val[p]] &lt;&lt; " " &lt;&lt; val[p] &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">if</span> (p == cnt[<span class="number">0</span>][val[p]]) cnt[<span class="number">0</span>][val[p]] = Nxt[p] ;</span><br><span class="line">    <span class="keyword">if</span> (p == cnt[<span class="number">1</span>][val[p]]) cnt[<span class="number">1</span>][val[p]] = Pre[p] ;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; p &lt;&lt; " : " &lt;&lt; cnt[0][val[p]] &lt;&lt; " " &lt;&lt; cnt[1][val[p]] &lt;&lt; " " &lt;&lt; val[p] &lt;&lt; endl ;</span></span><br><span class="line">    update(<span class="number">1</span>, <span class="number">0</span>, MAXM, val[p], cnt[<span class="number">1</span>][val[p]] - cnt[<span class="number">0</span>][val[p]]) ;</span><br><span class="line">    res = T[<span class="number">1</span>] ;<span class="comment">// cout &lt;&lt; T[1] &lt;&lt; endl ;</span></span><br><span class="line"><span class="comment">//    cout &lt;&lt; p &lt;&lt; " : " &lt;&lt; cnt[0][val[p]] &lt;&lt; " " &lt;&lt; cnt[1][val[p]] &lt;&lt; " " &lt;&lt; val[p] &lt;&lt; endl ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    cnt[<span class="number">0</span>][val[p]] = min(cnt[<span class="number">0</span>][val[p]], p) ;</span><br><span class="line">    cnt[<span class="number">1</span>][val[p]] = max(cnt[<span class="number">1</span>][val[p]], p) ;</span><br><span class="line">    update(<span class="number">1</span>, <span class="number">0</span>, MAXM, val[p], cnt[<span class="number">1</span>][val[p]] - cnt[<span class="number">0</span>][val[p]]) ;</span><br><span class="line">    res = T[<span class="number">1</span>] ;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; p &lt;&lt; " : " &lt;&lt; cnt[0][val[p]] &lt;&lt; " " &lt;&lt; cnt[1][val[p]] &lt;&lt; " " &lt;&lt; val[p] &lt;&lt; endl ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; X &gt;&gt; Y ; <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>), i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        base[i] = s[i] - <span class="string">'A'</span>,</span><br><span class="line">        pre[i][base[i]] = pre[i - <span class="number">1</span>][base[i]] + <span class="number">1</span>,</span><br><span class="line">        pre[i][base[i] ^ <span class="number">1</span>] = pre[i - <span class="number">1</span>][base[i] ^ <span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) val[i] = MAXN + Y * pre[i][<span class="number">0</span>] - X * pre[i][<span class="number">1</span>] ;</span><br><span class="line">    <span class="built_in">memset</span>(buc, <span class="number">-1</span>, <span class="keyword">sizeof</span>(buc)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) Pre[i] = buc[val[i]], buc[val[i]] = i ;</span><br><span class="line">    <span class="built_in">memset</span>(buc, <span class="number">0</span>, <span class="keyword">sizeof</span>(buc)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = N ; i &gt;= <span class="number">0</span> ; -- i) Nxt[i] = buc[val[i]] ? buc[val[i]] : N + <span class="number">1</span>, buc[val[i]] = i ;</span><br><span class="line">    M = qr() ; S = <span class="built_in">pow</span>(M, <span class="number">0.5832</span>) ; U = <span class="built_in">ceil</span>((<span class="keyword">double</span>)M / S) ;</span><br><span class="line">    <span class="built_in">memset</span>(cnt[<span class="number">0</span>], <span class="number">63</span>, <span class="keyword">sizeof</span>(cnt[<span class="number">0</span>])) ;</span><br><span class="line">    <span class="built_in">memset</span>(cnt[<span class="number">1</span>], <span class="number">-1</span>, <span class="keyword">sizeof</span>(cnt[<span class="number">1</span>])) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = (i - <span class="number">1</span>) * S + <span class="number">1</span> ; j &lt;= i * S ; ++ j) blg[j] = i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) q[i].l = qr() - <span class="number">1</span>, q[i].r = qr(), q[i].id = i ;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + M + <span class="number">1</span>, comp) ; l = <span class="number">0</span>, r = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (r &lt; q[i].r) upd(++ r) ;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; q[i].l) del(l ++) ;</span><br><span class="line">        <span class="keyword">while</span> (l &gt; q[i].l) upd(-- l) ;</span><br><span class="line">        <span class="keyword">while</span> (r &gt; q[i].r) del(r --) ;</span><br><span class="line">        ans[q[i].id] = res ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸çŸ¥é“ä¸ºå•¥rqyå†™çš„è«é˜Ÿå¥—çº¿æ®µæ ‘åŠ äº†ä¸ªçœ‹ä¸å¤ªé€çš„ä¼˜åŒ–æ¯”æˆ‘å¿«äº†ä¸€å€ï¼Œè¿·ä¹±233</p>
<h1 id="F"><a href="#F" class="headerlink" title="$F$"></a>$F$</h1><blockquote>
<p>ä½ çš„èŠ±ç”°ä¸€å…±ç”±$n-2$ç‰‡èŠ±ç”°ç»„æˆï¼Œç¼–å·ä»$1$åˆ°$n-2$ã€‚</p>
<p>ç®—ä¸Šä½ çš„å®¶å’ŒèŠ±åº—ï¼Œä¸€å…±æœ‰$n$ä¸ªåœ°ç‚¹ï¼Œå…¶ä¸­ä½ çš„å®¶ç¼–å·ä¸º$0$ï¼ŒèŠ±åº—ç¼–å·ä¸º$n-1$ã€‚å³ï¼Œå®¶ã€èŠ±ç”°ã€èŠ±åº—éƒ½å±äºåœ°ç‚¹ï¼Œä¸”å®ƒä»¬éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„$0$~$n-1$çš„ç¼–å·ã€‚æœ‰$m$æ¡åŒå‘é“è·¯è¿æ¥è¿™äº›åœ°ç‚¹ã€‚ä¿è¯æ‰€æœ‰åœ°ç‚¹é—´éƒ½æ˜¯ç›´æ¥æˆ–é—´æ¥è¿é€šçš„ã€‚</p>
<p>ä½ éœ€è¦ä»å®¶é‡Œå‡ºå‘ï¼Œç»è¿‡æ‰€æœ‰çš„èŠ±ç”°è¿›è¡Œæ”¶è·ï¼Œå†åˆ°è¾¾èŠ±åº—ï¼Œå†ä»èŠ±åº—å‡ºå‘ç»è¿‡æ‰€æœ‰èŠ±ç”°è¿›è¡Œæ’­ç§ï¼Œæœ€åé‡æ–°å›åˆ°å®¶ä¸­ã€‚å½“ä½ ç»è¿‡ä¸€ç‰‡èŠ±ç”°çš„æ—¶å€™ï¼Œä½ å¯ä»¥é€‰æ‹©æ”¶è·ã€æ’­ç§æˆ–è€…ä»€ä¹ˆäº‹éƒ½ä¸åšï¼Œä¹Ÿå°±æ˜¯è¯´ä½ ç»è¿‡ä¸€ç‰‡æœªæ”¶å‰²çš„èŠ±ç”°æ—¶å¯ä»¥ä¸ç«‹å³æ”¶å‰²å®ƒï¼Œæ’­ç§äº¦ç„¶ã€‚ç„¶è€Œï¼Œæ’­ç§å¿…é¡»å‘ç”Ÿåœ¨ä½ å®Œæˆäº†æ‰€æœ‰æ”¶è·å¹¶åˆ°èŠ±åº—äº¤è´§ä¹‹åã€‚åœ¨å®Œæˆæœ€åä¸€ä¸ªèŠ±ç”°çš„æ”¶è·åï¼Œä½ å¿…é¡»åœ¨åˆ°è¾¾èŠ±åº—åæ‰èƒ½å¼€å§‹æ’­ç§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä½ æ²¡æœ‰æ”¶è·å®Œæ‰€æœ‰èŠ±ç”°å¹¶åˆ°èŠ±åº—äº¤è´§å‰ï¼Œå³ä½¿ä½ å·²ç»ç»è¿‡äº†èŠ±åº—ï¼Œä½ ä¹Ÿä¸èƒ½è¿›è¡Œæ’­ç§ã€‚ï¼ˆå•°å—¦äº†è¿™ä¹ˆå¤šä½†æ„¿è®²æ˜ç™½äº†ï¼‰</p>
<p>ç„¶è€Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ã€‚åœ¨æ”¶å‰²å®ŒèŠ±æœµåï¼ŒèŠ±ç”°ä¼šå˜å¾—å…‰ç§ƒç§ƒçš„ï¼Œæ­¤æ—¶åœŸåœ°é‡Œçš„æ°´åˆ†ä¼šè¿…é€Ÿè’¸å‘ã€‚è€ƒè™‘åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæ›´æ—©è¢«æ”¶å‰²çš„èŠ±ç”°ä¹Ÿç†åº”æ›´æ—©åœ°è¢«æ’­ç§ã€‚å…·ä½“æ¥è¯´ï¼Œä½ å¿…é¡»ä¿è¯å‰$\lfloor \frac{n-2}{2}\rfloor$ä¸ªè¢«æ”¶å‰²çš„èŠ±ç”°ä¹Ÿæ˜¯å‰$\lfloor \frac{n-2}{2}\rfloor$ä¸ªè¢«æ’­ç§çš„ï¼Œå…¶ä¸­ç¬¦å·$\lfloor \rfloor$è¡¨ç¤ºå‘ä¸‹å–æ•´ã€‚ä½ ä¸éœ€è¦ä¿è¯è¿™äº›èŠ±ç”°æ”¶å‰²å’Œæ’­ç§çš„é¡ºåºå®Œå…¨ä¸€è‡´ï¼Œè€Œåªéœ€è¦ä¿è¯å‰$\lfloor \frac{n-2}{2}\rfloor$åçš„é›†åˆä¸å˜å³å¯ã€‚</p>
<p>ç°åœ¨ï¼Œä½ éœ€è¦æ±‚å‡ºå®Œæˆä¸Šè¿°ä¸€ç³»åˆ—åŠ¨ä½œèµ°è¿‡çš„æœ€çŸ­è·¯ç¨‹ã€‚</p>
<p>$n \leq 20$</p>
</blockquote>
<p>ä¸€çœ¼çœ‹å‡ºçŠ¶å‹$dp$ï¼Œç¬¬äºŒçœ¼çœ‹å‡ºåº”è¯¥ä»å¤´å’Œå°¾åˆ†åˆ«$dp$ï¼Œç„¶åæ²¡çœ‹ç¬¬ä¸‰çœ¼å°±å¼€å§‹å†™â€¦â€¦å‘ç°ä¸å¤ªå¯¹ï¼Ÿï¼Ÿæœ‰ä¸ªé™åˆ¶ï¼Œè¦æ±‚å‰$\lfloor \frac{n-2}{2}\rfloor$å¿…é¡»ç›¸åŒã€‚ç„¶åæˆ‘å°±å¯»æ€ç€è¦å‹ä¸€ä¸‹é¡ºåºï¼Ÿæœ‰ç‚¹éš¾å†™ï¼›å¯»æ€ç€è®°å½•ä¸€ä¸‹è·¯å¾„ï¼Ÿä½†æ˜¯å‘ç°å˜æ›´ä¸å¯¹äº†ï¼Œå› ä¸ºå¯èƒ½æœ€åçš„çŠ¶æ€æ ¹æœ¬ä¸é‡åˆï¼Œç„¶åå°±æ²¡æœ‰ç„¶åäº†QAQã€‚</p>
<p>ç„¶åç…äº†ä¸€çœ¼é¢˜è§£å‘ç°å¾ˆå¦™ã€‚å¤§æ¦‚å°±æ˜¯æšä¸¾$size$ä¸º$\frac{n}{2}$çš„çŠ¶æ€ï¼Œå°†æ•´å¼ åœ°å›¾åˆ†ä¸ºä¸¤åŠã€‚ä¹‹å‰é¢„å¤„ç†ä¸€ä¸ª<code>floyd</code>ï¼Œç„¶åæ¯æ¬¡çš„ä»£ä»·å°±æ˜¯</p>
<script type="math/tex; mode=display">
\mathsf{\min _{x\in S,y\in T}(f_{S,x}+dis_{x,y}+g_{T,y})+\min _{x\in S,y\in T}(g_{S,x}+dis_{x,y}+f_{T,y}})</script><p>ç„¶åæšä¸¾$\mathsf {S,T,x,y}$å°±å®Œäº†ï¼Œå¤æ‚åº¦$O(2^{n}+\binom{n}{\lfloor\frac{n}{2}\rfloor}\cdot n^2)$</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> g[MAXS][MAXN], pre[MAXS][<span class="number">2</span>], sz[MAXS], ans ;</span><br><span class="line"><span class="keyword">int</span> A[MAXN][MAXN], dis[MAXN][MAXN], N, M, E, f[MAXS][MAXN], stk[MAXN], cnt ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; E ;</span><br><span class="line">    <span class="keyword">int</span> i, j, k, o ;</span><br><span class="line">    M = (<span class="number">1</span> &lt;&lt; N) - <span class="number">1</span>, ans = Inf ;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">63</span>, <span class="keyword">sizeof</span>(dis)) ;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">63</span>, <span class="keyword">sizeof</span> (f)) ; f[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) dis[i][i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= E ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; j &gt;&gt; k &gt;&gt; o,</span><br><span class="line">        A[j][k] = A[k][j] = o,</span><br><span class="line">        dis[j][k] = dis[k][j] = o ;</span><br><span class="line">    <span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt; N ; ++ k)</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; N ; ++ j)</span><br><span class="line">                dis[i][j] = min(dis[i][j], dis[i][k] + dis[k][j]) ;</span><br><span class="line">    <span class="keyword">if</span> (N == <span class="number">3</span>) <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, <span class="number">2</span> * (dis[<span class="number">0</span>][<span class="number">1</span>] + dis[<span class="number">1</span>][<span class="number">2</span>])), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) sz[i] = sz[i - (i &amp; (-i))] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; N ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; j &amp; i) stk[++ cnt] = j ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">int</span> now = stk[j] ;</span><br><span class="line">            <span class="keyword">for</span> (k = <span class="number">1</span> ; k &lt;= cnt ; ++ k)</span><br><span class="line">                <span class="keyword">if</span> (!(stk[k] ^ now)) <span class="keyword">continue</span> ;</span><br><span class="line">                <span class="keyword">else</span> f[i][now] = min(f[i][now], f[i ^ (<span class="number">1</span> &lt;&lt; now)][stk[k]] + dis[stk[k]][now]) ;</span><br><span class="line">        &#125;</span><br><span class="line">        cnt = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(g, <span class="number">63</span>, <span class="keyword">sizeof</span>(g)) ; g[<span class="number">1</span> &lt;&lt; (N - <span class="number">1</span>)][N - <span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = (<span class="number">1</span> &lt;&lt; (N - <span class="number">1</span>)) + <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; N ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; j &amp; i) stk[++ cnt] = j ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">int</span> now = stk[j] ;</span><br><span class="line">            <span class="keyword">for</span> (k = <span class="number">1</span> ; k &lt;= cnt ; ++ k)</span><br><span class="line">                <span class="keyword">if</span> (!(stk[k] ^ now)) <span class="keyword">continue</span> ;</span><br><span class="line">                <span class="keyword">else</span> g[i][now] = min(g[i][now], g[i ^ (<span class="number">1</span> &lt;&lt; now)][stk[k]] + dis[stk[k]][now]) ;</span><br><span class="line">        &#125;</span><br><span class="line">        cnt = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; g[M][1] &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (sz[i] != N / <span class="number">2</span>) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">int</span> stA = i, stB = (~i &amp; M), res = Inf, fg = <span class="number">0</span> ; </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; N ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; j &amp; stA)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; k &lt; N ; ++ k)</span><br><span class="line">                    <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; k &amp; stB) </span><br><span class="line">						res = min(res, f[stA][j] + dis[j][k] + g[stB][k]), fg = <span class="number">1</span> ; </span><br><span class="line"><span class="comment">//        if (!fg) res = 0 ;</span></span><br><span class="line">		stB ^= (<span class="number">1</span> &lt;&lt; N - <span class="number">1</span>), stB |= <span class="number">1</span> ;</span><br><span class="line">		stA ^= <span class="number">1</span>, stA |= (<span class="number">1</span> &lt;&lt; N - <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; N ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; j &amp; stB)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; k &lt; N ; ++ k)</span><br><span class="line">                    <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; k &amp; stA) ans = min(ans, res + f[stB][j] + dis[j][k] + g[stA][k]) ;</span><br><span class="line"><span class="comment">//		if (!fg) ans *= 2 ;</span></span><br><span class="line">	&#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>æ ¡å†…æ¨¡æ‹Ÿèµ›</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/çŠ¶å‹DP</tag>
        <tag>åŠ¨æ€è§„åˆ’/æ™®é€šDP</tag>
        <tag>æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ </tag>
        <tag>æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è«é˜Ÿ</tag>
        <tag>æ•°æ®ç»“æ„/çº¿æ®µæ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ ‘ä¸Šå¯å‘å¼åˆå¹¶(dsu on tree) Â· 2</title>
    <url>/2019/11/13/dsu-on-tree-2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸»è¦å°±æ˜¯æ•´ç†ä¸€ä¸‹dsu on treeçš„è¿›é˜¶ç‰ˆä¹ é¢˜ã€‚</p>
<a id="more"></a>
<h1 id="0x01-rm-Cf375D-Tree-and-Queries"><a href="#0x01-rm-Cf375D-Tree-and-Queries" class="headerlink" title="$0x01$ $\rm Cf375D$  Tree and Queries"></a>$0x01$ $\rm Cf375D$  Tree and Queries</h1><blockquote>
<p>ç»™å‡ºä¸€æ£µ$n$ä¸ªç»“ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªç»“ç‚¹æœ‰ä¸€ä¸ªé¢œè‰²$c_i$ ã€‚ è¯¢é—®$q$æ¬¡ï¼Œæ¯æ¬¡è¯¢é—®ä»¥$v$ç»“ç‚¹ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œå‡ºç°æ¬¡æ•° $â‰¥k$çš„é¢œè‰²æœ‰å¤šå°‘ç§ã€‚æ ‘çš„æ ¹èŠ‚ç‚¹æ˜¯$1$ã€‚ </p>
</blockquote>
<p>è€ƒè™‘ç»´æŠ¤å­æ ‘é‡Œé¢æ¯ç§é¢œè‰²å‡ºç°çš„æ¬¡æ•°ï¼Œä½†æ˜¯æ˜¾ç„¶è¯¢é—®çš„æ˜¯ä¸€ä¸ª$buc[c_i]$çš„åç¼€å’Œï¼Œäºæ˜¯è€ƒè™‘ä¸Šçº¿æ®µæ ‘æ¥ç»´æŠ¤è¿™ä¸ªä¸œè¥¿ï¼Œ<code>calc</code>åˆ°æ¯ä¸ªç‚¹çš„æ—¶å€™å…ˆ<code>del</code>æ‰åŸæ¥çš„å†<code>upd</code>æ–°çš„ä¿¡æ¯â€¦â€¦ç„¶åå°±åšå®Œäº†233</p>
<p>ç„¶è€Œä¸€å¼€å§‹çš„æ—¶å€™æˆ‘è°ƒäº†å¥½ä¹…ï¼Œå› ä¸ºæˆ‘æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_do</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	ts[base[u]] ++ ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)]) do_do(to(k), u) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_del</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	ts[base[u]] -- ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)]) do_del(to(k), u) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _count(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">int</span> val)&#123;</span><br><span class="line">	<span class="keyword">bool</span> fg = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">if</span> (!chk[base[u]]) </span><br><span class="line">		chk[base[u]] = <span class="number">1</span>, </span><br><span class="line">		update(<span class="number">1</span>, <span class="number">1</span>, N, ts[base[u]] + <span class="number">1</span>, val), fg = <span class="number">0</span> ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)]) _count(to(k), u, val) ; </span><br><span class="line">	<span class="keyword">if</span> (!fg) chk[base[u]] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	_count(u, fa, <span class="number">-1</span>) ; do_do(u, fa) ; _count(u, fa, <span class="number">1</span>) ; </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	_count(u, fa, <span class="number">-1</span>) ; do_del(u, fa) ; _count(u, fa, <span class="number">1</span>) ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸Šå»å¾ˆå¯¹çš„äºšå­ï¼Œä½†æ˜¯é”™å°±é”™åœ¨<strong>å¿…é¡»æ¯ä¸ªç‚¹ç‹¬ç«‹è®¡ç®—å®Œè´¡çŒ®æ‰èƒ½è€ƒè™‘ä¸‹ä¸€ä¸ªç‚¹</strong>ï¼Œå¦åˆ™ä¸‹ä¸€ä¸ªç‚¹çš„ä¿¡æ¯å°±æ˜¯é”™è¯¯çš„â€”â€”ä¹Ÿå°±æ˜¯è¯´ä¸èƒ½æ•´ä½“<code>del</code>å†æ•´ä½“<code>upd</code>ï¼Œå¿…é¡»é€ä¸ªé€ä¸ªçš„<code>del</code>å’Œ<code>upd</code>ã€‚ã€‚ç„¶è€Œäº‹å®ä¸Šå…³é”®é—®é¢˜è¿˜æ˜¯åœ¨$buc$çš„ç»Ÿè®¡ä¸Šå‡ºäº†é—®é¢˜233</p>
<p>äºæ˜¯æœ€åçš„ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	update(<span class="number">1</span>, <span class="number">1</span>, N, ts[base[u]] + <span class="number">1</span>, <span class="number">-1</span>) ;</span><br><span class="line">	ts[base[u]] ++ ; </span><br><span class="line">	update(<span class="number">1</span>, <span class="number">1</span>, N, ts[base[u]] + <span class="number">1</span>, <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)]) calc(to(k), u) ; </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	update(<span class="number">1</span>, <span class="number">1</span>, N, ts[base[u]] + <span class="number">1</span>, <span class="number">-1</span>) ;</span><br><span class="line">	ts[base[u]] -- ; </span><br><span class="line">	update(<span class="number">1</span>, <span class="number">1</span>, N, ts[base[u]] + <span class="number">1</span>, <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)]) del(to(k), u) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">int</span> mk)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; to(k) != son[u]) dfs(to(k), u, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">if</span> (son[u]) </span><br><span class="line">		dfs(son[u], u, <span class="number">1</span>), vis[son[u]] = <span class="number">1</span> ;</span><br><span class="line">	calc(u, fa) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; qs[u].size() ; ++ k) </span><br><span class="line">		ans[u].pb(query(<span class="number">1</span>, <span class="number">1</span>, N, qs[u][k] + <span class="number">1</span>, N)) ;</span><br><span class="line">	vis[son[u]] = <span class="number">0</span> ; <span class="keyword">if</span> (!mk) del(u, fa) ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="0x02-rm-Cf741D-Arpaâ€™s-letter-marked-tree-and-Mehrdadâ€™s-Dokhtar-kosh-paths"><a href="#0x02-rm-Cf741D-Arpaâ€™s-letter-marked-tree-and-Mehrdadâ€™s-Dokhtar-kosh-paths" class="headerlink" title="$0x02$ $\rm Cf741D$ Arpaâ€™s letter-marked tree and Mehrdadâ€™s Dokhtar-kosh paths"></a>$0x02$ $\rm Cf741D$ Arpaâ€™s letter-marked tree and Mehrdadâ€™s Dokhtar-kosh paths</h1><blockquote>
<p> ä¸€æ£µæ ¹ä¸º$1$çš„æ ‘ï¼Œæ¯æ¡è¾¹ä¸Šæœ‰ä¸€ä¸ªå­—ç¬¦ï¼ˆ$a-v$å…±$22$ç§ï¼‰ã€‚ ä¸€æ¡ç®€å•è·¯å¾„è¢«ç§°ä¸º$\rm Dokhtar-kosh$å½“ä¸”ä»…å½“è·¯å¾„ä¸Šçš„å­—ç¬¦ç»è¿‡é‡æ–°æ’åºåå¯ä»¥å˜æˆä¸€ä¸ªå›æ–‡ä¸²ã€‚ æ±‚æ¯ä¸ªå­æ ‘ä¸­æœ€é•¿çš„$\rm Dokhtar-kosh$è·¯å¾„çš„é•¿åº¦ã€‚ </p>
</blockquote>
<p>ä¼¼ä¹æ˜¯<code>Cf570D</code>çš„å‡çº§ç‰ˆï¼Œå› ä¸ºè·¯å¾„å¯ä»¥è·¨è¿‡æ ¹æ‰€ä»¥ä¼šæ˜¾å¾—æ¯”è¾ƒå¤æ‚ï¼Œä¸è¿‡ç»“è®ºè¿˜æ˜¯å¯ä»¥ç”¨çš„ï¼š</p>
<blockquote>
<p>æˆ‘ä»¬ä»¤ä¸€ä¸ªå­—ç¬¦çš„æƒå€¼$val(x)=\text{1&lt;&lt;(x-â€˜aâ€™)}$ï¼Œé‚£ä¹ˆå¯¹ä¸ä¸€ä¸ªä¸²$\rm S$ï¼Œæˆ‘ä»¬ä»¤$k=\rm{Xor}_{i=1}^n\it val\rm( S[i])$ï¼Œé‚£ä¹ˆé‡æ’ä¹‹åå¯ä»¥æ„æˆå›æ–‡ä¸²$\Longleftrightarrow$ $size(k)\leq 1$ï¼Œå…¶ä¸­$size(\rm S)$æŒ‡é›†åˆ$\rm S$å†…çš„å…ƒç´ ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯äºŒè¿›åˆ¶è¡¨ç¤ºä¸­$1$çš„ä¸ªæ•°</p>
</blockquote>
<p>ç„¶åå°±æ˜¯è€ƒè™‘æ€ä¹ˆç»´æŠ¤è¿™ä¸ªä¸œè¥¿ã€‚</p>
<ul>
<li><p>ä¸ç»è¿‡æ ¹çš„è·¯å¾„ï¼Œåˆ†æ²»åšä¸‹å»å°±å¥½ï¼Œæ¯ä¸€å±‚$u$å¯¹æ‰€æœ‰çš„$son[u]$çš„$ans$å–$\max$.</p>
</li>
<li><p>ç»è¿‡æ ¹çš„è·¯å¾„ï¼Œå‘ç°å¯¹äºä¸€ä¸ª$u$ï¼Œå’Œ$v$ç»„åˆåå¯ä»¥äº§ç”Ÿè´¡çŒ®ï¼Œæˆ‘ä»¬åªéœ€è¦å…³å¿ƒæ·±åº¦æœ€å¤§çš„$v$.æ‰€ä»¥è‡ªç„¶æƒ³åˆ°ç”¨ä¸€ä¸ªæ¡¶æ¥ç»´æŠ¤äºŒè¿›åˆ¶æ•°å€¼çš„æœ€å¤§æ·±åº¦ã€‚ä½†æ˜¯è¿™ä¸ªåœ°æ–¹è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ç»Ÿè®¡è·¯å¾„çš„è¯ï¼Œ$u$å’Œ$v$ä¸èƒ½åœ¨åŒä¸€æ£µå­æ ‘ä¸­ï¼Œå®¹æ˜“å‘ç°åªè¦æ»¡è¶³ä¸åœ¨åŒä¸€æ£µå­æ ‘ä¸­ï¼Œé‚£å°±ä¸€å®šæ»¡è¶³$(u,v)$è¿™æ¡è·¯å¾„ç»è¿‡$root$ã€‚æ‰€ä»¥è¿™ä¸ªåœ°æ–¹ï¼Œå¯¹äºä¸€ä¸ªç‚¹$u$ï¼Œè€ƒè™‘ä¸€æ£µå­æ ‘ä¸€æ£µå­æ ‘åœ°è®¡ç®—ç­”æ¡ˆï¼Œæ·±åº¦åšå·®æ±‚ï¼›è€Œâ€œç»è¿‡æ ¹èŠ‚ç‚¹çš„è·¯å¾„â€åŒ…æ‹¬èµ·ç‚¹å’Œç»ˆç‚¹åœ¨æ ¹èŠ‚ç‚¹ä¸Šçš„è·¯å¾„ï¼Œæ‰€ä»¥éœ€è¦å¯¹$root$å•ç‹¬è®¡ç®—ä¸€æ¬¡ã€‚</p>
</li>
</ul>
<p>çœ‹ä¸Šå»åº”è¯¥è¿™ä¹ˆå®ç°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> _delete(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)&#123;</span><br><span class="line">	f[dis[u]] = <span class="number">0</span> ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)]) _delete(to(k), u) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">int</span> &amp; ans, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (f[dis[u]]) </span><br><span class="line">		ans = max(ans, f[dis[u]] + dep[u] - <span class="number">2</span> * d) ;	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= <span class="number">21</span> ; ++ i)</span><br><span class="line">		<span class="keyword">if</span> (f[dis[u] ^ (<span class="number">1</span> &lt;&lt; i)]) </span><br><span class="line">			ans = max(ans, f[dis[u] ^ (<span class="number">1</span> &lt;&lt; i)] + dep[u] - <span class="number">2</span> * d) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next) </span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)]) calc(to(k), u, ans, d) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	f[dis[u]] = max(f[dis[u]], dep[u]) ;	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next) </span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)]) update(to(k), u) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">int</span> mk)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (to(k) == fa || to(k) == son[u]) <span class="keyword">continue</span> ; </span><br><span class="line">		dfs(to(k), u, <span class="number">0</span>), ans[u] = max(ans[u], ans[to(k)]) ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (son[u]) </span><br><span class="line">		dfs(son[u], u, <span class="number">1</span>), vis[son[u]] = <span class="number">1</span>, </span><br><span class="line">		ans[u] = max(ans[u], ans[son[u]]) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) != son[u] &amp;&amp; to(k) != fa) </span><br><span class="line">			calc(to(k), u, ans[u], dep[u]), update(to(k), u) ;</span><br><span class="line">	<span class="keyword">if</span> (f[dis[u]]) </span><br><span class="line">		ans[u] = max(ans[u], f[dis[u]] - dep[u]) ;	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= <span class="number">21</span> ; ++ i)</span><br><span class="line">		<span class="keyword">if</span> (f[dis[u] ^ (<span class="number">1</span> &lt;&lt; i)]) </span><br><span class="line">			ans[u] = max(ans[u], f[dis[u] ^ (<span class="number">1</span> &lt;&lt; i)] - dep[u]) ;</span><br><span class="line">	f[dis[u]] = max(f[dis[u]], dep[u]) ; vis[son[u]] = <span class="number">0</span> ; <span class="keyword">if</span> (!mk) _delete(u, fa) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ€»æ„Ÿè§‰â€¦â€¦å¤æ‚åº¦ä¸æ˜¯å¾ˆå¯¹ï¼Ÿæ„Ÿè§‰å•æ¬¡è¿è¡Œdfså¤æ‚åº¦å¾ˆé«˜çš„äºšå­â€¦â€¦ç„¶è€Œè¿˜æ˜¯å¥—ç”¨â€œä¸€ä¸ªç‚¹åˆ°æ ¹èŠ‚ç‚¹æœ€å¤šæœ‰$\log n $ä¸ªè½»ç¥–å…ˆâ€è¿™ä¸ªç†è®ºï¼Œæ¯ä¸ªç‚¹è¢«è®¿é—®çš„æ¬¡æ•°è¿˜æ˜¯ä¸å˜çš„â€”â€”æ¯•ç«Ÿå­æ ‘ä¹‹é—´è®¿é—®ä¸ä¼šé‡å¤ã€‚äºæ˜¯æ—¶é—´å¤æ‚åº¦$n\log n$ã€‚</p>
<p>å””ï¼Œæ„Ÿè§‰è¿™ä¸ªé¢˜è¿˜æ˜¯æ¯”è¾ƒæœ‰æŠ€å·§æ€§çš„233</p>
<h1 id="0x03-rm-NOIP2018-æ¨¡æ‹Ÿ-Â·-æ ‘"><a href="#0x03-rm-NOIP2018-æ¨¡æ‹Ÿ-Â·-æ ‘" class="headerlink" title="$0x03$ $\rm NOIP2018$æ¨¡æ‹Ÿ Â· æ ‘"></a>$0x03$ $\rm NOIP2018$æ¨¡æ‹Ÿ Â· æ ‘</h1><p>è¿™é“é¢˜æ˜¯ä»ä¸€ä¸ªç¥ä»™çš„blogé‡Œå«–æ¥çš„ï¼Œæäº¤çš„è¯å¯ä»¥åˆ°Luoguä¸Šæäº¤ï¼š<a href="https://www.luogu.org/problem/U92408" target="_blank" rel="noopener">$\rm Link$</a></p>
<p>é¢˜é¢ï¼š</p>
<blockquote>
<p>ç»™å®šä¸€æ£µæ ‘ã€‚</p>
<p>ä»¤$[L,R]$æè¿°çš„æ˜¯åºå·åœ¨$[L,R]$å†…çš„ç‚¹çš„é›†åˆã€‚</p>
<p>åŒæ—¶ï¼Œä»¤å‡½æ•°$\boldsymbol F(\{ \rm S\})$è¡¨ç¤ºä»¤é›†åˆ$\rm S$å†…çš„ç‚¹è”é€šçš„éœ€è¦çš„æœ€å°è¾¹æ•°ã€‚</p>
<p>é—®é¢˜åˆ™æ˜¯æ±‚ï¼š</p>
<script type="math/tex; mode=display">
\sum_{i=1}^{n}\sum_{j=i}^n \boldsymbol F([i,j])</script><p>$n\leq 100,000$</p>
</blockquote>
<hr>
<p>ä¸€æ­¥è½¬åŒ–æˆæ±‚æ¯æ¡è¾¹çš„è´¡çŒ®ã€‚ç»“åˆæ­£éš¾åˆ™åå¯çŸ¥ï¼Œä¸€æ¡è¾¹çš„æ€»è´¡çŒ®è‡³å¤šæ˜¯$\binom{n}{2}$ï¼Œç®—å¤šäº†çš„é›†åˆæ˜¯é‚£äº›ä½äºè¿™æ¡è¾¹ä¸¤ä¾§ä¸­çš„å…¶ä¸­ä¸€ä¾§ï¼Œä¸ç»è¿‡è¿™æ¡è¾¹çš„é›†åˆã€‚æ‰€ä»¥è€ƒè™‘åˆ†åˆ«ç»´æŠ¤å­æ ‘å†…å’Œå­æ ‘å¤–çš„ä¸¤ä¸ªç­”æ¡ˆã€‚</p>
<p>å­æ ‘å†…çš„æ¯”è¾ƒå®¹æ˜“ç»´æŠ¤ï¼Œè€ƒè™‘å‡è®¾ç°åœ¨æœ‰äº†$\{1,2,3\},\{5,6\}$ä¸¤ä¸ªé›†åˆï¼Œå°†å…¶è§†ä½œä¸¤ä¸ªè¿é€šå—ï¼Œå½“åŠ è¿›æ¥$\{4\}$æ—¶ï¼Œä¼šå’Œå·¦å³éƒ½ç›¸è¿æ¥ï¼Œä¸å¦¨å‡è®¾å…ˆä¸$\{1,2,3\}$åˆå¹¶ï¼Œé‚£ä¹ˆæœ€åä¼šäº§ç”Ÿ$(1,4),(2,4),(3,4)$ä¸‰ä¸ªæ–°çš„è¿é€šå—ï¼ŒåŸæ¥çš„ä¾æ—§è¦åŠ å…¥ã€‚æ‰€ä»¥è€ƒè™‘ç”¨<strong>å¹¶æŸ¥é›†+å¹¶æŸ¥é›†çš„$size$</strong>æ¥ç»´æŠ¤ã€‚ç”±äºå­æ ‘å†…çš„ç‚¹åœ¨æš´åŠ›æ—¶åªä¼šæ’å…¥ä¸ä¼šåˆ é™¤ï¼Œæ‰€ä»¥å¹¶æŸ¥é›†æ˜¯$\rm van$å…¨æ²¡é—®é¢˜çš„ã€‚</p>
<p>ä¹‹åæ˜¯å­æ ‘å¤–çš„ã€‚å­æ ‘å¤–çš„å’Œå­æ ‘å†…çš„æƒ…å†µå·®ä¸å¤šï¼Œä½†æ˜¯ç”±æ’å…¥å˜æˆäº†åˆ é™¤ã€‚ç„¶åå°±å¯ä»¥è€ƒè™‘ç”¨setç»´æŠ¤ï¼Œå› ä¸ºè¿™ä¸œè¥¿è‡ªå¸¦çš„å•è°ƒæ€§æ¯”è¾ƒniceï¼Œå¹¶ä¸”æ”¯æŒåˆ é™¤æ“ä½œã€‚æ‰€ä»¥æµç¨‹å¤§æ¦‚å°±æ˜¯è€ƒè™‘æŠŠåˆ é™¤çš„ç‚¹ä¸¢åˆ°seté‡Œé¢ï¼Œæœ€åˆçš„<code>ans_out</code>æ˜¾ç„¶æ˜¯$\binom{n}{2}$ï¼Œæ¯åˆ é™¤ä¸€ä¸ªæ–°çš„ç‚¹ï¼Œè®¾å…¶ç¼–å·ä¸º$x$ï¼Œ<code>set</code>é‡Œé¢ç¬¬ä¸€ä¸ªæ¯”$x$å°çš„å…ƒç´ è®¾ä¸º$x_p$ç¬¬ä¸€ä¸ªæ¯”$x$å¤§çš„å…ƒç´ è®¾ä¸º$x_s$ï¼Œé‚£ä¹ˆ$[x_{p}+1,x-1]$è¿˜æ˜¯è¿ç»­çš„ï¼Œ$[x+1,x_s-1]$è¿˜æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥æ–°çš„è´¡çŒ®å˜æˆäº†</p>
<script type="math/tex; mode=display">
calc(x_s-1-(x+1)+1)+calc(x-1-(x_p+1)+1)</script><p>åŸæ¥çš„æ—§è´¡çŒ®$calc(x_s-1-(x_p+1)+1)$ç†åº”å‡å»ã€‚</p>
<p>æ‰€ä»¥å°±åšå®Œäº†ï¼Œæ„Ÿè§‰ç¥æ¸…æ°”çˆ½ï¼Œæ€»ä½“æ¥è¯´ç®—æ˜¯ä¸€é“å¾ˆå¥½çš„é¢˜å§ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set</span> &lt;<span class="keyword">int</span>&gt; s ;</span><br><span class="line"><span class="keyword">int</span> vis[MAXN], op[MAXN] ;</span><br><span class="line"><span class="function">LL <span class="title">calc</span><span class="params">(LL x)</span></span>&#123; <span class="keyword">return</span> x * (x - <span class="number">1</span>) / <span class="number">2</span> ; &#125;</span><br><span class="line"><span class="keyword">void</span> _clear()&#123;</span><br><span class="line">	s.clear() ;</span><br><span class="line">	ansout = calc(N), ansin = <span class="number">0</span>, </span><br><span class="line">	s.insert(<span class="number">0</span>), s.insert(N + <span class="number">1</span>) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> _find(<span class="keyword">int</span> x)&#123;</span><br><span class="line">	<span class="keyword">return</span> x == fr[x] ? x : fr[x] = _find(fr[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fuck</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">	s.insert(u) ; op[u] = <span class="number">1</span> ;</span><br><span class="line">	<span class="built_in">set</span> &lt;<span class="keyword">int</span>&gt; :: iterator l, r, mid ;</span><br><span class="line">	l = r = mid = s.find(u), l --, r ++ ;</span><br><span class="line">	ansout += calc(*r - *mid - <span class="number">1</span>) + calc(*mid - *l - <span class="number">1</span>) - calc(*r - *l - <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">if</span> (op[u - <span class="number">1</span>])&#123;</span><br><span class="line">		<span class="keyword">int</span> f1 = _find(u - <span class="number">1</span>), f2 = _find(u) ; </span><br><span class="line">		ansin += bg[f1] * bg[f2], fr[f1] = f2, bg[f2] += bg[f1] ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (op[u + <span class="number">1</span>])&#123;</span><br><span class="line">		<span class="keyword">int</span> f1 = _find(u + <span class="number">1</span>), f2 = _find(u) ;</span><br><span class="line">		ansin += bg[f1] * bg[f2], fr[f1] = f2, bg[f2] += bg[f1] ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _update(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)&#123;</span><br><span class="line">	fuck(u) ; <span class="comment">//cout &lt;&lt; u &lt;&lt; endl ;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) == fa || vis[to(k)]) <span class="keyword">continue</span> ; <span class="keyword">else</span> _update(to(k), u) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _delete(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)&#123;</span><br><span class="line">	op[u] = <span class="number">0</span>, fr[u] = u, bg[u] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) == fa) <span class="keyword">continue</span> ; <span class="keyword">else</span> _delete(to(k), u) ; <span class="comment">// 1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">int</span> mk)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (to(k) == fa || to(k) == son[u]) <span class="keyword">continue</span> ; </span><br><span class="line">		dfs(to(k), u, <span class="number">0</span>) ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (son[u]) dfs(son[u], u, <span class="number">1</span>), vis[son[u]] = <span class="number">1</span> ;</span><br><span class="line">	_update(u, fa), ans += calc(N) - ansout - ansin ; </span><br><span class="line">	<span class="keyword">if</span> (!mk) _delete(u, fa), _clear() ; vis[son[u]] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-Warning"><a href="#rm-Warning" class="headerlink" title="$\rm Warning$"></a>$\rm Warning$</h1><ul>
<li><p>æ³¨æ„ä¸€ä¸ªåœ°æ–¹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vis[son[u]] = <span class="number">0</span> ; <span class="keyword">if</span> (!mk) _delete(u, fa) ;</span><br></pre></td></tr></table></figure>
<p>æŠŠè¿™ä¸¤å¥å†™åäº†ä¼šè°ƒä¸€ä¸‹åˆï¼Œæ¬¢è¿å°è¯•quq</p>
</li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>dsu on tree</category>
      </categories>
      <tags>
        <tag>æ ‘ä¸ŠæŠ€å·§/dsu on tree</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ ‘ä¸Šå¯å‘å¼åˆå¹¶(dsu on tree) Â· 1</title>
    <url>/2019/11/13/dsu-on-tree-1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>$\boldsymbol{dsu ~ on ~ tree}$ï¼Œä¸­æ–‡åˆ«ç§°â€œæ ‘ä¸Šå¯å‘å¼åˆå¹¶â€ï¼ˆè™½ç„¶æˆ‘å¹¶ä¸æ‰¿è®¤è¿™ç§ç§°è°“ï¼‰ï¼Œå¤§æ¦‚æ˜¯ä¸€ç§ä¼˜é›…çš„æš´åŠ›ï¼Œå¹¶ä¸”è·Ÿ$dsu$æ¯«æ— å…³ç³»ã€‚äºæ˜¯æˆ‘æ‰“ç®—å«ä»–$\boldsymbol{Elegantly ~Direct~ Counting~ on~ Tree}$ï¼Œâ€œä¼˜é›…çš„æ ‘ä¸Šæš´åŠ›ç»Ÿè®¡â€ã€‚</p>
<a id="more"></a>
<h1 id="rm-0x01-å‰è¨€-amp-æŠ€æœ¯åˆ†æ"><a href="#rm-0x01-å‰è¨€-amp-æŠ€æœ¯åˆ†æ" class="headerlink" title="$\rm 0x01$ å‰è¨€$\&amp;$æŠ€æœ¯åˆ†æ"></a>$\rm 0x01$ å‰è¨€$\&amp;$æŠ€æœ¯åˆ†æ</h1><p>ä¸¥æ ¼æ¥è¯´ï¼Œ$\boldsymbol{EDCT}$è§£å†³çš„é—®é¢˜èŒƒå›´å¹¶ä¸å¹¿æ³›ï¼š</p>
<blockquote>
<p>1ã€ç»´æŠ¤å­æ ‘ä¿¡æ¯ï¼›</p>
<p>2ã€ä¸èƒ½å¸¦ä¿®æ”¹æ“ä½œã€‚</p>
</blockquote>
<p>ä½†è¿™ä»ç„¶æ©ç›–ä¸ä½è¿™ç§ç®—æ³•è‡ªå¸¦çš„æœ‰è¶£çš„æ°”è´¨ã€‚ç¬”è€…è®¤ä¸ºï¼Œè¿™ç§ç®—æ³•è™½ç„¶æ˜¯ä¸ªæš´åŠ›ï¼Œä½†æ˜¯å…¶ä¸­çš„æŠ€æœ¯å«é‡è¿˜æ˜¯ä¸ä½çš„ï¼Œä»£ç ä¹Ÿä¸æ˜¯é‚£ä¹ˆçš„æµ…æ˜¾æ˜“æ‡‚ï¼Œç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒè€ƒå¯Ÿåº”ç”¨èƒ½åŠ›çš„ç®—æ³•ã€‚</p>
<p>ç„¶åæ¥çœ‹æŠ€æœ¯åˆ†æã€‚</p>
<p>é¦–å…ˆï¼Œå‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š</p>
<blockquote>
<p>ç»™å®šä¸€æ£µæœ‰æ ¹æ ‘æ ‘ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªä¿¡æ¯ã€‚ç°åœ¨è€ƒè™‘æ±‚å‡ºæ¯ä¸ªç‚¹å­æ ‘å†…çš„è§„å®šçš„æœ‰æ•ˆä¿¡æ¯æ•°é‡ã€‚</p>
<p>$n,q\leq 5\cdot1e5$</p>
<p>ä¸€èˆ¬è€Œè¨€è¿™æ ·çš„é¢˜æ˜¯å¯ä»¥ä¸Šè«é˜Ÿçš„ï¼Œä½†æ˜¯ä¾¿äºå±•å¼€å°±å¼€åˆ°äº†$500,000$ã€‚</p>
</blockquote>
<p>è€ƒè™‘$n^2$çš„æš´åŠ›ï¼Œå³å¯¹æ¯ä¸ªèŠ‚ç‚¹éƒ½æ‰«ä¸€éå­æ ‘ã€‚å¾ˆå®¹æ˜“å‘ç°è¿™æ ·æ˜¯æµªè´¹çš„ï¼Œå› ä¸ºä¼šç®—é‡ã€‚æˆ‘ä»¬è€ƒè™‘æ€ä¹ˆå¯¹è¿™æ£µæ ‘è¿›è¡Œåˆ’åˆ†æ‰èƒ½é«˜æ•ˆè®¡ç®—ã€‚</p>
<p>è€ƒè™‘ä¸€ç§åˆé€‚çš„åˆ’åˆ†æ–¹æ¡ˆã€‚ç»“åˆè½»é‡é“¾å‰–é‡Œé¢çš„ç»“è®ºï¼Œå¯ä»¥çŸ¥é“ï¼Œåœ¨è½»é‡é“¾å‰–åï¼Œä¸€ä¸ªç‚¹åˆ°æ ¹ä¸ä¼šè¶…è¿‡$\log n$æ¡è½»è¾¹ã€‚æ‰€ä»¥å¦‚æœå¯¹äºæ¯ä¸ªç‚¹ï¼Œå‡è®¾æˆ‘ä»¬åªè®¡ç®—ä»–å¯¹è½»ç¥–å…ˆçš„è´¡çŒ®ï¼Œéœ€è¦è‡³å¤š$\log n$æ¬¡å°±å¯ä»¥è§£å†³ï¼›åŒæ—¶æˆ‘ä»¬è€ƒè™‘é‡å„¿å­ï¼Œæ¯ä¸ªç‚¹è‡³å¤šä¼šè¢«å½“æˆä¸€æ¬¡é‡å„¿å­ï¼Œæ‰€ä»¥å‡è®¾æˆ‘ä»¬åªè®¡ç®—ä»–å¯¹çˆ¶äº²çš„è´¡çŒ®ï¼Œé‚£ä¹ˆè‡³å¤š$1$æ¬¡å°±å¯ä»¥è§£å†³ã€‚æ‰€ä»¥æœ€åçš„å¤æ‚åº¦æ˜¯$O(n\log n)$çš„ã€‚</p>
<p>ç°åœ¨è€ƒè™‘å®ç°å±‚é¢ï¼Œå…¶å®æ˜¯ä¸€ç§åˆ†æ²»çš„æ€æƒ³ã€‚æˆ‘ä»¬è€ƒè™‘é¦–å…ˆåˆ†æ²»$u$çš„è½»å„¿å­å¹¶æ¸…é™¤è½»å„¿å­çš„è´¡çŒ®ï¼Œç„¶åæš´åŠ›è®¡ç®—é‡å„¿å­ï¼Œç„¶åæš´åŠ›è®¡ç®—ä¸€æ•´æ£µå­æ ‘çš„è´¡çŒ®ã€‚é¦–å…ˆç¬¬ä¸€æ­¥ä¸­æ¸…é™¤è´¡çŒ®æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºåˆ†æ²»å‡ºæ¥çš„å‡ ä¸ªå­é—®é¢˜ç›¸äº’ç‹¬ç«‹ï¼Œæ‰€ä»¥å¿…é¡»è¦ç‹¬ç«‹è®¡ç®—ã€‚ä¹‹åæ˜¯é‡å„¿å­ï¼Œç”±äºé‡å„¿å­è‡³å¤šæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è®¡ç®—è€Œä¸ä¼šå½±å“å…¶ä»–çŠ¶æ€ã€‚æœ€ç»ˆå†æš´åŠ›ä¸€éè®¡ç®—è½»å„¿å­çš„è´¡çŒ®ã€‚</p>
<p>æ‰€ä»¥è¿™æ ·å°±è§£å†³äº†ç»´æŠ¤æ ‘ä¸Šä¿¡æ¯çš„é—®é¢˜ï¼Œå¤æ‚åº¦$n\log n$ã€‚</p>
<h1 id="0x02-å…¥é—¨é¢˜ç›®é€‰æ•´"><a href="#0x02-å…¥é—¨é¢˜ç›®é€‰æ•´" class="headerlink" title="$0x02$ å…¥é—¨é¢˜ç›®é€‰æ•´"></a>$0x02$ å…¥é—¨é¢˜ç›®é€‰æ•´</h1><p>æ„Ÿè§‰å¤§éƒ¨åˆ†<code>blog</code>æ‰¾çš„é¢˜ç›®éƒ½å¾ˆä¸æ¸…çœŸ233</p>
<h2 id="rm-Task1-rm-Cf600E-Lomsat-gelral"><a href="#rm-Task1-rm-Cf600E-Lomsat-gelral" class="headerlink" title="$\rm Task1$ $\rm Cf600E$ Lomsat gelral"></a>$\rm Task1$ $\rm Cf600E$ Lomsat gelral</h2><p>ä¸€å¥è¯é¢˜æ„</p>
<blockquote>
<p>ä¸€æ£µæ ‘æœ‰nä¸ªç»“ç‚¹ï¼Œæ¯ä¸ªç»“ç‚¹éƒ½æ˜¯ä¸€ç§é¢œè‰²ï¼Œæ¯ä¸ªé¢œè‰²æœ‰ä¸€ä¸ªç¼–å·ï¼Œæ±‚æ ‘ä¸­æ¯ä¸ªå­æ ‘çš„æœ€å¤šçš„é¢œè‰²ç¼–å·çš„å’Œã€‚ </p>
</blockquote>
<p>è€ƒè™‘å¥—$\rm EDCT$çš„æ¿å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	sz[u] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (to(k) == fa) <span class="keyword">continue</span> ;</span><br><span class="line">		dfs(to(k), u), sz[u] += sz[to(k)] ;</span><br><span class="line">		<span class="keyword">if</span> (sz[to(k)] &gt; sz[son[u]]) son[u] = to(k) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">int</span> mk)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (to(k) == fa || to(k) == son[u]) <span class="keyword">continue</span> ; </span><br><span class="line">		dfs(to(k), u, <span class="number">0</span>) ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (son[u]) dfs(son[u], u, <span class="number">1</span>), vis[son[u]] = <span class="number">1</span> ;</span><br><span class="line">	calc(u, fa, <span class="number">1</span>) ; ans[u] = res ; <span class="keyword">if</span> (son[u]) vis[son[u]] = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">if</span> (!mk) calc(u, fa, <span class="number">-1</span>), res = <span class="number">0</span>, max_cnt = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±æ˜¯æœ€åçš„<code>calc</code>å‡½æ•°æ€ä¹ˆå†™äº†ã€‚è€ƒè™‘æˆ‘ä»¬æœ€æš´åŠ›çš„åšæ³•æ˜¯ä»€ä¹ˆï¼Ÿå°±æ˜¯æŠŠæ¯ä¸ªé¢œè‰²ç»Ÿè®¡ä¸€éã€‚æ‰€ä»¥è¿™ä¹ˆå†™å°±OKäº†ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">int</span> mk)</span></span>&#123;</span><br><span class="line">	buc[clr[u]] += mk ; </span><br><span class="line">	<span class="keyword">if</span> (mk &gt; <span class="number">0</span> &amp;&amp; buc[clr[u]] &gt;= max_cnt)&#123;</span><br><span class="line">		<span class="keyword">if</span> (buc[clr[u]] &gt; max_cnt) </span><br><span class="line">		    res = <span class="number">0</span>, max_cnt = <span class="number">1l</span>l * buc[clr[u]] ;</span><br><span class="line">		res += <span class="number">1l</span>l * clr[u] ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (to(k) == fa || vis[to(k)]) <span class="keyword">continue</span> ; </span><br><span class="line">		calc(to(k), u, mk) ; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="rm-Task2-Cf570D-Tree-Requests"><a href="#rm-Task2-Cf570D-Tree-Requests" class="headerlink" title="$\rm Task2 ~Cf570D$ Tree Requests"></a>$\rm Task2 ~Cf570D$ Tree Requests</h2><p>ä¸€å¥è¯é¢˜æ„ï¼š</p>
<blockquote>
<p>ç»™å®šä¸€ä¸ªä»¥1ä¸ºæ ¹çš„nä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ¯ä¸ªç‚¹ä¸Šæœ‰ä¸€ä¸ªå­—æ¯$(a-z)$ï¼Œæ¯ä¸ªç‚¹çš„æ·±åº¦å®šä¹‰ä¸ºè¯¥èŠ‚ç‚¹åˆ°1å·èŠ‚ç‚¹è·¯å¾„ä¸Šçš„ç‚¹æ•°.æ¯æ¬¡è¯¢é—®$(a,b)$æŸ¥è¯¢ä»¥$a$ä¸ºæ ¹çš„å­æ ‘å†…æ·±åº¦ä¸º$b$çš„èŠ‚ç‚¹ä¸Šçš„å­—æ¯é‡æ–°æ’åˆ—ä¹‹åæ˜¯å¦èƒ½æ„æˆå›æ–‡ä¸². </p>
</blockquote>
<p>è¿™ç§åº”è¯¥å°±æ˜¯æ¯”è¾ƒè£¸çš„$\rm EDCT$ã€‚æœ‰ä¸€æ­¥è½¬åŒ–éœ€è¦å­¦ä¼šæ„é€ ï¼Œå³æˆ‘ä»¬ä»¤ä¸€ä¸ªå­—ç¬¦çš„æƒå€¼$val(x)=\text{1&lt;&lt;(x-â€˜aâ€™)}$ï¼Œé‚£ä¹ˆå¯¹ä¸ä¸€ä¸ªä¸²$\rm S$ï¼Œæˆ‘ä»¬ä»¤$k=\rm{Xor}_{i=1}^n\it val\rm( S[i])$ï¼Œé‚£ä¹ˆé‡æ’ä¹‹åå¯ä»¥æ„æˆå›æ–‡ä¸²$\Longleftrightarrow$ $size(k)\leq 1$ï¼Œå…¶ä¸­$size(\rm S)$æŒ‡é›†åˆ$\rm S$å†…çš„å…ƒç´ ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯äºŒè¿›åˆ¶è¡¨ç¤ºä¸­$1$çš„ä¸ªæ•°ã€‚æ‰€ä»¥ä¹Ÿæ˜¯ï¼Œç›´æ¥çˆ†ç®—å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	buc[dep[u]] ^= (<span class="number">1</span> &lt;&lt; base[u]) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)]) calc(to(k), u) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getl</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ret = <span class="number">0</span> ; </span><br><span class="line">	<span class="keyword">while</span> (x) ret += (x &amp; <span class="number">1</span>), x &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">return</span> (<span class="keyword">bool</span>)(ret &lt;= <span class="number">1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">	buc[dep[u]] = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)]) del(to(k), u) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> fa, <span class="keyword">int</span> mk)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) != fa &amp;&amp; to(k) != son[u]) dfs(to(k), u, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">if</span> (son[u]) dfs(son[u], u, <span class="number">1</span>), vis[son[u]] = <span class="number">1</span> ;</span><br><span class="line">	calc(u, fa) ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; qs[u].size() ; ++ k) </span><br><span class="line">		ans[u].pb(getl(buc[qs[u][k]])) ; </span><br><span class="line">	vis[son[u]] = <span class="number">0</span> ; <span class="keyword">if</span> (!mk) del(u, fa) ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>dsu on tree</category>
      </categories>
      <tags>
        <tag>æ ‘ä¸ŠæŠ€å·§/dsu on tree</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘Codeforces Round-814 Virtual</title>
    <url>/2019/11/13/codeforces-814/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸€åœº<code>cn</code> roundï¼Œç„¶åæ¯æ¬¡<code>cn</code> roundçš„æœ€åä¸€é¢˜éƒ½ä¼šå¾ˆå¥‡æ€ªâ€¦â€¦</p>
<p>â‘§è¯´äº†ï¼Œè®¡æ•°æ˜¯ä¸å¯èƒ½ä¼šçš„ï¼Œè¿™è¾ˆå­éƒ½ä¸å¯èƒ½äº†QAQ</p>
<a id="more"></a>
<h1 id="Omega"><a href="#Omega" class="headerlink" title="$\Omega $"></a>$\Omega $</h1><p>$\rm virtual$äº†ä¸€åœºâ€¦â€¦è¯´å®è¯è¿™ç§<code>div2 only</code>çš„åœºæ¬¡æœ€åä¸€é¢˜å°±ç»å¸¸æ¯”è¾ƒæ¯’â€¦â€¦</p>
<p><del>è€è§„çŸ©ï¼Œå‰é¢å‡ é¢˜ç”¨æ¥æ°´å­—æ•°</del></p>
<h1 id="A"><a href="#A" class="headerlink" title="$A$"></a>$A$</h1><blockquote>
<p>ç»™å‡ºä¸€ä¸ªé•¿åº¦ä¸º$N$çš„éè´Ÿæ•´æ•°åºåˆ—$a_i$ä¸é•¿åº¦ä¸º$K$çš„æ­£æ•´æ•°åºåˆ—$b_i$ï¼Œæ»¡è¶³$a_i$ä¸­åˆšå¥½æœ‰$K$ä¸ª$0$ï¼Œä¸”ä»»ä¸€æ­£æ•´æ•°åœ¨åºåˆ—$a$å’Œåºåˆ—$b$ä¸­çš„å‡ºç°æ¬¡æ•°çš„å’Œä¸ä¼šè¶…è¿‡$1$ã€‚</p>
<p>ç°åœ¨è¯•åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸€ç§æ–¹æ³•ï¼Œä½¿å¾—ç”¨$b_i$ä¸­çš„å…ƒç´ æ›¿æ¢$a_i$ä¸­çš„$0$å¾—åˆ°çš„åºåˆ—ä¸æ˜¯é€’å¢åºåˆ—ã€‚ </p>
</blockquote>
<p>sbä¸€çœ¼é¢˜ï¼Œæ˜¾ç„¶å¦‚æœé€’å‡æ”¾è¿›å»è¿˜æ˜¯é€’å¢å°±æ— è§£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">inline bool cmp(int a, int b)&#123; return a &gt; b ;&#125;</span><br><span class="line">int main()&#123;</span><br><span class="line">	cin &gt;&gt; N &gt;&gt; K ; int j = 1 ;</span><br><span class="line">	for (i = 1 ; i &lt;= N ; ++ i) cin &gt;&gt; base[i] ;</span><br><span class="line">	for (i = 1 ; i &lt;= K ; ++ i) cin &gt;&gt; t[i] ; sort(t + 1, t + K + 1, cmp) ;</span><br><span class="line">	for (i = 1 ; i &lt;= N ; ++ i) if (!base[i]) base[i] = t[j ++] ;</span><br><span class="line">	for (i = 1 ; i &lt; N ; ++ i) if (base[i] &gt; base[i + 1]) return puts(&quot;Yes&quot;), 0 ;</span><br><span class="line">	return puts(&quot;No&quot;), 0 ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="B"><a href="#B" class="headerlink" title="$B$"></a>$B$</h1><blockquote>
<p>ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸º$n$çš„ä¸ç›¸åŒåºåˆ—$a$å’Œ$b$ï¼Œè¿™ä¸¤ä¸ªåºåˆ—è‡³å°‘æœ‰ä¸€ä¸ªä½ç½®ä¸åŒ</p>
<p>ç°åœ¨éœ€è¦æ„é€ ä¸€ä¸ªé•¿åº¦ä¸º$n$çš„æ’åˆ—$p$ï¼Œä½¿å¾—$p$ä¸$a$åªæœ‰ä¸€ä¸ªåœ°æ–¹ä¸åŒï¼Œä¸”$p$ä¸$b$ä¹Ÿåªæœ‰ä¸€ä¸ªåœ°æ–¹ä¸åŒ</p>
</blockquote>
<p>ä¸€çœ¼å°±å¯ä»¥çœ‹å‡ºæœ€å¤šæœ‰ä¸¤ä¸ªä½ç½®ä¸åŒï¼Œå¦åˆ™ä¸€å®šä¸åˆæ³•ã€‚è€ƒè™‘åˆ†ç±»è®¨è®ºï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªä½ç½®ä¸åŒé‚£å°±æ”¾ä¸Šé‚£ä¸ªæ²¡å‡ºç°è¿‡çš„æ•°å­—ï¼›å¦‚æœæœ‰ä¸¤ä¸ªä½ç½®ä¸åŒï¼Œé‚£å°±è€ƒè™‘æ˜¯$A$ä¸­ç¬¬ä¸€ä¸ªä½ç½®æ”¾å¤šäº†è¿˜æ˜¯ç¬¬äºŒä¸ªä½ç½®æ”¾å¤šäº†ï¼Œæ”¾ä¸Š$B$çš„å°±å®Œäº†.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;A[i]), Ma[A[i]] ++ ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;B[i]), Mb[B[i]] ++ ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="keyword">if</span> (A[i] != B[i]) pos[++ cnt] = i ; </span><br><span class="line">	<span class="keyword">if</span> (cnt == <span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">			<span class="keyword">if</span> (!Ma.count(i) &amp;&amp; !Mb.count(i)) &#123; A[pos[<span class="number">1</span>]] = i ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cout</span> &lt;&lt; A[i] &lt;&lt; <span class="string">" "</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (Ma[A[pos[<span class="number">1</span>]]] &gt; <span class="number">1</span> &amp;&amp; !Ma[B[pos[<span class="number">1</span>]]])&#123; </span><br><span class="line">		A[pos[<span class="number">1</span>]] = B[pos[<span class="number">1</span>]] ; </span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cout</span> &lt;&lt; A[i] &lt;&lt; <span class="string">" "</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123; </span><br><span class="line">		A[pos[<span class="number">2</span>]] = B[pos[<span class="number">2</span>]] ; </span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cout</span> &lt;&lt; A[i] &lt;&lt; <span class="string">" "</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ¬æ¥è§‰å¾—æ˜¯é“æ„é€ é¢˜ï¼Œåæ¥å‘ç°æ˜¯é“ç»†èŠ‚æ¨¡æ‹Ÿé¢˜ã€‚ã€‚ã€‚</p>
<h1 id="C"><a href="#C" class="headerlink" title="$C$"></a>$C$</h1><blockquote>
<p>ç»™ä½ ä¸€ä¸ªç”±å°å†™å­—æ¯æ„æˆçš„å­—ç¬¦ä¸².<br>æœ‰$q$ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®ç»™å‡ºæ•°å­—$m$å’Œå°å†™å­—æ¯$c$ï¼Œä½ å¯ä»¥ä»»æ„åœ°ä¿®æ”¹å­—ç¬¦ä¸²ä¸­çš„$m$ä¸ªå­—ç¬¦ï¼Œæ±‚æœ€å¤šèƒ½å¤Ÿä½¿å­—ç¬¦ä¸²ä¸­å«æœ‰å¤šå°‘ä¸ªè¿ç»­ç›¸åŒçš„å­—æ¯$c$.<br>æ¯ä¸ªè¯¢é—®å„è‡ªç‹¬ç«‹.<br>$|\rm S|\leq 1,500$</p>
</blockquote>
<p>å…¶å®æ„Ÿè§‰å¤æ‚åº¦ä¸€ç‚¹ä¹Ÿä¸å¯¹â€¦â€¦æ¯”å¦‚æˆ‘è§‰å¾—è¿™é¢˜å¯ä»¥åšåˆ°$5e4$ä»¥ä¸Šâ€¦â€¦</p>
<p>è€ƒè™‘å¼±åŒ–ç‰ˆï¼ˆåŸç‰ˆï¼‰çš„è§£æ³•ï¼Œå¤§æ¦‚å°±æ˜¯ç”¨$f_{i,j}$è¡¨ç¤ºå‰$i$ä¸ªå­—ç¬¦ç”¨äº†$k$æ¬¡æœºä¼šæœ€é•¿çš„è¿ç»­æ®µæœ‰å¤šé•¿ã€‚ç„¶åå°±å¯ä»¥ç›´æ¥$O(26n^2)$ç»™é¢„å¤„ç†å‡ºæ¥ï¼Œæ¯æ¬¡è¯¢é—®å›ç­”ä¸€ä¸‹å³å¯ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬å‘ç°è¿™ç©æ„å„¿å¤æ‚åº¦ä¸€ç‚¹ä¹Ÿä¸å¹³è¡¡ï¼Œå› ä¸ºé¢„å¤„ç†è´¼æ…¢ä½†æ˜¯å›ç­”è´¼å¿«ã€‚äºæ˜¯è€ƒè™‘æœ‰å“ªäº›æ€§è´¨æ²¡ç”¨ã€‚æˆ‘ä»¬è€ƒè™‘é¢„å¤„ç†å‡ºåŸä¸²ä¸­å¯¹äºä¸€ä¸ªå­—ç¬¦$c$ï¼Œæœ€è¿‘çš„ä¸¤ä¸ª$c$ä¹‹é—´çš„ä½ç½®æ¥ï¼Œç„¶åå¦‚æœè¦ä¿®æ”¹å°±æ˜¾ç„¶å…ˆä¿®æ”¹è·¨åº¦å°çš„$c_i$å’Œ$c_{i+1}$ä¸­é—´çš„éƒ¨åˆ†ï¼Œå› ä¸ºè¿™æ ·è‚¯å®šä¸ä¼šæ›´åŠ£ã€‚åŒæ—¶åªæœ‰æŠŠä¸­é—´çš„é$c$åŒºåŸŸå æ»¡æ‰èƒ½ä½¿ä¹‹è¿é€šï¼Œæ•…æ¯æ¬¡å¯¹äºä¸€ä¸ªç»™å®šçš„$k$ï¼ŒäºŒåˆ†æŸ¥æ‰¾ä¸€ä¸‹å¯ä»¥å æ»¡çš„åŒºé—´ï¼Œå‰©ä¸‹çš„éšä¾¿é“ºï¼Œå¯¹äºè¿™äº›å æ»¡çš„åŒºé—´æå‰é¢„å¤„ç†å‡ºè´¡çŒ®çš„å‰ç¼€å’Œå°±å®Œäº†ã€‚å¤æ‚åº¦å¤§æ¦‚æ˜¯$q\log n+26n$</p>
<p>ç„¶è€Œå‡çº§ç‰ˆåªæ˜¯å£èƒ¡ï¼Œä»€ä¹ˆæ—¶å€™é—²ä¸‹æ¥å†å†™å§qwq</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">		<span class="keyword">if</span> ((<span class="keyword">int</span>)S[j] == <span class="string">'a'</span> + i) dp[i][j][<span class="number">0</span>] = dp[i][j - <span class="number">1</span>][<span class="number">0</span>] + <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)&#123;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">		<span class="keyword">for</span> (k = <span class="number">1</span> ; k &lt;= N ; ++ k)&#123;</span><br><span class="line">			<span class="keyword">if</span> ((<span class="keyword">int</span>)S[j] - <span class="string">'a'</span> == i) dp[i][j][k] = dp[i][j - <span class="number">1</span>][k] + <span class="number">1</span> ;</span><br><span class="line">			<span class="keyword">else</span> dp[i][j][k] = max(dp[i][j][k], dp[i][j - <span class="number">1</span>][k - <span class="number">1</span>] + <span class="number">1</span>) ;</span><br><span class="line">			ans[i][k] = max(ans[i][k], dp[i][j][k]) ;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line"><span class="keyword">while</span> (T --)&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d %c"</span>, &amp;k, &amp;In) ;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; ans[(<span class="keyword">int</span>)In - <span class="string">'a'</span>][k] &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D"><a href="#D" class="headerlink" title="$D$"></a>$D$</h1><blockquote>
<p> æœ‰$n$ä¸ªåœ†ï¼Œå°†å…¶åˆ†ä¸ºä¸¤ç»„ã€‚æ¯ç»„ä¸­ï¼Œåªæœ‰å¥‡æ•°ä¸ªåœ†è¦†ç›–çš„åŒºåŸŸçš„æ‰ä¼šç®—å…¥é¢ç§¯ï¼Œæ±‚å¯èƒ½çš„æœ€å¤§é¢ç§¯ã€‚ </p>
</blockquote>
<p>é¦–å…ˆè€ƒè™‘è´ªå¿ƒã€‚å¤§æ¦‚å°±æ˜¯è¯´åŸæœ¬çš„è¦†ç›–ä¸€å®šå¯ä»¥çœ‹åšä¸€å›¢ä¸€å›¢ç‹¬ç«‹çš„å­é—®é¢˜ã€‚å°†åœ†æŒ‰ç…§é¢ç§¯å¤§å°æ’åºï¼Œä¹‹åè€ƒè™‘é€‰æ¯ä¸€å †æœ€å¤§çš„æ”¾åˆ°ç¬¬ä¸€å †ï¼Œç„¶åæŠŠä¸ä¹‹åŸæœ¬å†²çªçš„æ”¾åˆ°ç¬¬äºŒå †ã€‚è¿™æ ·å¯ä»¥å‘ç°æœ€ç»ˆå‡å»çš„éƒ¨åˆ†é¢ç§¯å˜æˆäº†ä¹‹å‰äº§ç”Ÿè´¡çŒ®çš„éƒ¨åˆ†é¢ç§¯â€¦â€¦ç„¶è€Œè¿™ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯è¿™æ ·ä¿è¯äº†æ¯æ¬¡é€‰çš„ä¸€å®šéƒ½æ˜¯é¢ç§¯æœ€å¤§çš„åœ†çš„é›†åˆã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Comp</span><span class="params">(C A, C B)</span></span>&#123; <span class="keyword">return</span> A.r &gt; B.r ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve2</span><span class="params">()</span></span>&#123;</span><br><span class="line">	sort(base + <span class="number">1</span>, base + N + <span class="number">1</span>, Comp) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		<span class="keyword">for</span>(j = i + <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">			<span class="keyword">if</span> (check_in(base[i], base[j])) ++ mark[j] ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		<span class="keyword">if</span> (!mark[i] || (mark[i] &amp; <span class="number">1</span>)) Ans += get_S(base[i]) ; <span class="keyword">else</span> Ans -= get_S(base[i]) ;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%.8lf"</span>, Ans) ;  	 </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œè¿™ä¸ªè´ªå¿ƒä¼¼ä¹ä¸å¥½æƒ³ï¼Œäºæ˜¯è€ƒè™‘ä¸€ç§ç²¾å¦™çš„$\rm dp$<del>å…¶å®æ›´ä¸å¥½æƒ³</del>ã€‚è€ƒè™‘æŒ‰ç…§åœ†ä»å¤§åˆ°å°æšä¸¾é¡ºæ¬¡è¿è¾¹ï¼Œæœ€åè¿å‡ºæ¥çš„ä¼šæ˜¯ä¸€ä¸ªæ£®æ—çŠ¶ç‰©ã€‚ç„¶åå¯¹äºè¿™ä¸ªä¸œè¥¿ï¼Œ å®šä¹‰$dp[u][0/1][0/1]$è¡¨ç¤ºä»¥ç‚¹$u$ä¸ºæ ¹çš„å­æ ‘é‡Œé¢ï¼Œé™¤$u$ä¹‹å¤–åˆ†æˆä¸¤å †ä¹‹åï¼Œä¸¤å †åˆ†åˆ«çš„é«˜åº¦ä¸ºå¶æ•°/å¥‡æ•°æ—¶çš„æœ€ä¼˜å€¼ã€‚è¿™ä¸œè¥¿å°±å¯ä»¥ç›´æ¥åˆ†ç±»è®¨è®ºæ±‚å’Œ+è½¬ç§»ã€‚ </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">dist</span><span class="params">(C A, C B)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">sqrt</span>((A.x - B.x) * (A.x - B.x) + (A.y - B.y) * (A.y - B.y)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">get_S</span><span class="params">(C A)</span></span>&#123; <span class="keyword">return</span> Pi * A.r * A.r ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check_in</span><span class="params">(C A, C B)</span></span>&#123; <span class="keyword">return</span> A.r + B.r &gt; dist(A, B) ; &#125;</span><br><span class="line"><span class="keyword">namespace</span> DP&#123;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">		<span class="keyword">int</span> next, to ;</span><br><span class="line">	&#125;E[MAXN &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line">	<span class="keyword">int</span> head[MAXN], cnt ;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    	E[++ cnt].to = v, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">    	E[++ cnt].to = u, E[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">do_dp</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> faa)</span></span>&#123;</span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> f[<span class="number">2</span>][<span class="number">2</span>] ; <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f)) ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)&#123;</span><br><span class="line">			<span class="keyword">if</span> (to(k) == faa) <span class="keyword">continue</span> ;</span><br><span class="line">			do_dp(to(k), u) ;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> ii = <span class="number">0</span> ; ii &lt;= <span class="number">1</span> ; ++ ii)</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> jj = <span class="number">0</span> ; jj &lt;= <span class="number">1</span> ; ++ jj)</span><br><span class="line">					f[ii][jj] += dp[to(k)][ii][jj] ; </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> ii = <span class="number">0</span> ; ii &lt;= <span class="number">1</span> ; ++ ii)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> jj = <span class="number">0</span> ; jj &lt;= <span class="number">1</span> ; ++ jj)</span><br><span class="line">				dp[u][ii][jj] = max(</span><br><span class="line">                	f[ii ^ <span class="number">1</span>][jj] + (<span class="number">1l</span>l * (ii ? <span class="number">-1</span> : <span class="number">1</span>) * base[u].r * base[u].r), </span><br><span class="line">					f[ii][jj ^ <span class="number">1</span>] + (<span class="number">1l</span>l * (jj ? <span class="number">-1</span> : <span class="number">1</span>) * base[u].r * base[u].r)) ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Comp</span><span class="params">(C A, C B)</span></span>&#123; <span class="keyword">return</span> A.r &gt; B.r ; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">solve1</span><span class="params">()</span></span>&#123;</span><br><span class="line">		sort(base + <span class="number">1</span>, base + N + <span class="number">1</span>, Comp) ;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">			<span class="keyword">for</span>(j = i + <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">				<span class="keyword">if</span> (check_in(base[i], base[j])) </span><br><span class="line">					<span class="keyword">if</span> (!fa[j] || base[fa[j]].r &gt; base[i].r) fa[j] = i ;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="keyword">if</span> (fa[i]) Add(i, fa[i]) ;	</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)	<span class="keyword">if</span> (!fa[i]) do_dp(i, <span class="number">0</span>), Ans += dp[i][<span class="number">0</span>][<span class="number">0</span>] ;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.8lf"</span>, Ans * Pi) ;  	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="E"><a href="#E" class="headerlink" title="$E$"></a>$E$</h1><blockquote>
<p>ç»™å‡º$n$ä¸ªç‚¹å’Œæ¯ä¸ªç‚¹çš„åº¦è®©ä½ æ„é€ å‡ºä¸€å¼ æ— å‘å›¾æ»¡è¶³ä»¥ä¸‹ä¸¤æ¡æ€§è´¨ï¼š</p>
<ul>
<li><p>$1.$ç‚¹1åˆ°ç‚¹$i$ä»…æœ‰<strong>å”¯ä¸€</strong>ä¸€æ¡æœ€çŸ­è·¯</p>
</li>
<li><p>$2.$ç‚¹$1$åˆ°ç‚¹$i$çš„æœ€çŸ­è·¯é•¿åº¦å¤§äºç­‰äºç‚¹$1$åˆ°ç‚¹$i-1$çš„æœ€çŸ­è·¯é•¿åº¦</p>
</li>
</ul>
<p>æ±‚èƒ½æ„æˆæ»¡è¶³æ¡ä»¶çš„æ— å‘å›¾çš„ä¸ªæ•°   $n\leq 50, 2\leq degree_i\leq 3$</p>
</blockquote>
<p>è¿™ç§è®¡æ•°é¢˜ä¼šæ˜¯ä¸å¯èƒ½ä¼šçš„ï¼Œè¿™è¾ˆå­éƒ½ä¸å¯èƒ½ä¼šäº†qaq</p>
<p>è€ƒè™‘ä¸€ä¸ª$idea$ï¼Œå› ä¸ºè¿™å¼ å›¾æ— æƒï¼Œæ‰€ä»¥æœ€çŸ­è·¯ä¸€å®šä¼šæ˜¯$\it bfs$çš„åˆ†å±‚ã€‚é‚£ä¹ˆå¯¹äºä¸€ä¸ª$i$æ¥è®²ï¼Œä»–çš„è¦ä¹ˆå’Œ$i-1$åœ¨åŒä¸€å±‚ï¼Œè¦ä¹ˆå°±åœ¨$i-1$çš„ä¸‹ä¸€å±‚ã€‚</p>
<p>é‚£ä¹ˆè€ƒè™‘è®°$f_{i,j}$è¡¨ç¤ºå‰$i$ä¸ªç‚¹ä¸­æœ‰$j$ä¸ªå’Œ$i$åœ¨åŒä¸€å±‚çš„æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆè€ƒè™‘è¿™ä¸œè¥¿çš„è½¬ç§»è·Ÿä¸Šä¸€å±‚ä¸­ç‚¹çš„åº¦æ•°æœ‰å…³ï¼Œä¹Ÿå°±æ˜¯éœ€è¦è®°$dp_{k,c_1,c_2}$è¡¨ç¤ºå½“å‰å±‚æœ‰$k$ä¸ªç‚¹ï¼Œä¸Šä¸€å±‚åº¦æ•°ä¸º$2$çš„ç‚¹æœ‰$c_1$ä¸ªï¼Œåº¦æ•°ä¸º$3$çš„ç‚¹æœ‰$c_2$ä¸ªè¿™ä¸€å­çŠ¶æ€çš„æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆæœ‰å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
dp_{i,j,k}=\begin{cases}{1} & (i=j=k=0)\\ \\ {\sum\limits_{l=2}^{k-1} dp_{i,j,k-l-1} \cdot\left(\begin{array}{c}{k-1} \\ {l}\end{array}\right) \cdot N_{l+1}} &(i=j=0,k>0) \\ \\ {(j-1) \cdot dp_{i,j-2,k}+k \cdot dp_{i,j,k-1}} & (i=0,j>0)\\ \\{j \cdot dp_{i-1,j-1,k}+k \cdot dp_{i-1,j+1,k-1}} & (i>0)\\ \\{0}\end{cases}</script><p>å…¶ä¸­$N_i$è¡¨ç¤º<strong>$\boldsymbol{i-}$é¡¹é“¾æ•°</strong>ï¼Œä¹Ÿå°±æ˜¯é•¿åº¦ä¸º$i$ã€å…ƒç´ å„å¼‚ã€é•œåƒå¯¹ç§°çš„å•ç¯çš„æ•°é‡ï¼Œè®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
N_i=\begin{cases} 1 & (i=2)\\ \frac{(i-1)!}{2} &(i>2)\\ 0 & \rm{otherwise}\\ \end{cases}</script><p>å¯¹äºç¬¬äºŒä¸ªè½¬ç§»ï¼Œå°±æ˜¯è€ƒè™‘å‘ä¸Šä¸€å±‚æ’å…¥ä¸€ä¸ªç‚¹ä½¿å…¶æˆä¸ºåº¦æ•°ä¸º$3$çš„ç‚¹ã€‚è€ƒè™‘å› ä¸ºåº¦æ•°ä¸º$3$ä¸”é¢˜ç›®è¦æ±‚â€œæœ‰ä½ç§»æœ€çŸ­è·¯â€ï¼Œæ‰€ä»¥åŒä¸€å±‚ä¸­åªæœ‰å¯èƒ½æ˜¯ç®€å•çš„å¹³è¾¹ç›¸è¿ã€‚æ‰€ä»¥å°±æ˜¯è€ƒè™‘æšä¸¾åŸæ¥çš„ç‚¹é‡Œé¢å¯ä»¥ä¸æ–°åŠ å…¥çš„ç‚¹ç»„æˆé¡¹é“¾çš„æ–¹æ¡ˆæ•°ã€‚æ³¨æ„è¿™é‡Œé¡¹é“¾æ•°å¿…é¡»$&gt;2$åŸå› æ˜¯é¢˜ç›®ä¸­å¼ºè°ƒäº†ä¸èƒ½æœ‰ä¸¤ä¸ªç‚¹ä¹‹é—´è¿$&gt;1$æ¡è¾¹ã€‚</p>
<p>å¯¹äºç¬¬ä¸‰ä¸ªè½¬ç§»ï¼Œè€ƒè™‘æ’å…¥ä¸€ä¸ªç‚¹ä½¿å…¶åº¦æ•°ä¸º$2$ï¼Œè¿™ä¸€æ­¥è½¬ç§»å³è€ƒè™‘$j-1$ä¸ªç‚¹ä¸­é€‰æ‹©ä¸€ä¸ªå¯èƒ½å˜æˆ$2$åº¦çš„ç‚¹å’Œæ–°åŠ è¿‘æ¥è¿™ä¸ªç‚¹ç›¸è¿æœ‰$j-1$ç§æ–¹æ¡ˆï¼Œç›¸è¿ä¹‹åä¸¤ä¸ªç‚¹åº¦æ•°éƒ½å˜ä¸º$2$ï¼›åŒæ—¶è€ƒè™‘å¦ä¸€ç§å¯èƒ½æ€§ï¼Œå°±æ˜¯è¿™ä¸€ä¸ªç‚¹å’Œä¸€ä¸ªå¯èƒ½å˜æˆ$3$åº¦çš„ç‚¹ç›¸è¿ï¼Œé‚£ä¹ˆåŸæ¥çš„äºŒåº¦ç‚¹å˜ä¸ºä¸‰åº¦ç‚¹ï¼Œæ–°åŠ è¿›æ¥çš„å˜æˆäºŒåº¦ç‚¹ã€‚</p>
<p>å¯¹äºç¬¬å››ä¸ªè½¬ç§»ï¼Œè€ƒè™‘è¿™ä¸€å±‚æœ€åä¸€ä¸ªåŠ è¿›æ¥çš„èŠ‚ç‚¹ï¼Œè¦ä¹ˆå’Œä¸Šä¸€å±‚ä¸­ä¸€ä¸ªå¯èƒ½å˜æˆ$2$åº¦çš„ç‚¹ç›¸è¿è¦ä¹ˆå’Œå¯èƒ½å˜æˆ$3$åº¦çš„ç‚¹ç›¸è¿ã€‚</p>
<p>ç„¶åæœ€åçš„ç­”æ¡ˆå°±æ˜¯æšä¸¾æœ€åä¸€å±‚çš„ç‚¹æ•°</p>
<script type="math/tex; mode=display">
ans =\sum_{j=1}^{n}f_{n,j}\cdot g_{0,c_1,c_2}</script><p>å…¶ä¸­$c_1$å’Œ$c_2$è¡¨ç¤ºæšä¸¾åˆ°ç°åœ¨æœ‰å¤šå°‘ä¸ª$d=2$å’Œ$d=3$çš„ç‚¹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 105</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; </span><br><span class="line"><span class="keyword">int</span> N, clr1, clr2, base[MAXN] ; </span><br><span class="line"><span class="keyword">int</span> i, j, k, l ; ll dp[MAXN][MAXN] ;</span><br><span class="line">ll Ans, A[MAXN], f[MAXN][MAXN][MAXN], Cm[MAXN][MAXN] ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N  ; Cm[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) Cm[i][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">1</span> ; j &lt;= i ; ++ j)</span><br><span class="line">			Cm[i][j] = (Cm[i - <span class="number">1</span>][j] + Cm[i - <span class="number">1</span>][j - <span class="number">1</span>]) % Mod ; </span><br><span class="line">	<span class="keyword">for</span> ( A[<span class="number">1</span>] = A[<span class="number">0</span>] = <span class="number">0</span>, A[<span class="number">2</span>] = A[<span class="number">3</span>] = <span class="number">1</span>, i = <span class="number">4</span> ; i &lt;= N ; ++ i) A[i] = A[i - <span class="number">1</span>] * (i - <span class="number">1</span>) % Mod ;</span><br><span class="line">	f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ; <span class="comment">//Calculate g</span></span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt;= N ; ++ j)</span><br><span class="line">		<span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt;= N - j ; ++ k)</span><br><span class="line">			<span class="keyword">if</span> (!j &amp;&amp; k)</span><br><span class="line">				<span class="keyword">for</span> (l = <span class="number">2</span> ; l &lt; k ; ++ l)</span><br><span class="line">					(f[<span class="number">0</span>][j][k] += f[<span class="number">0</span>][j][k - l - <span class="number">1</span>] * Cm[k - <span class="number">1</span>][l] % Mod * A[l + <span class="number">1</span>] % Mod) %= Mod ;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> (j &gt;= <span class="number">2</span>) (f[<span class="number">0</span>][j][k] += f[<span class="number">0</span>][j - <span class="number">2</span>][k] * (j - <span class="number">1</span>) % Mod) %= Mod ;</span><br><span class="line">				<span class="keyword">if</span> (k) (f[<span class="number">0</span>][j][k] += f[<span class="number">0</span>][j][k - <span class="number">1</span>] * k % Mod) %= Mod ; </span><br><span class="line">			&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= N - i ; ++ j)</span><br><span class="line">			<span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt;= N - i - j ; ++ k)&#123;</span><br><span class="line">				<span class="keyword">if</span> (j) (f[i][j][k] += f[i - <span class="number">1</span>][j - <span class="number">1</span>][k] * j % Mod) %= Mod ;</span><br><span class="line">				<span class="keyword">if</span> (k) (f[i][j][k] += f[i - <span class="number">1</span>][j + <span class="number">1</span>][k - <span class="number">1</span>] * k % Mod) %= Mod ;</span><br><span class="line"><span class="comment">//				cout &lt;&lt; f[i][j][k] &lt;&lt; endl ;</span></span><br><span class="line">			&#125;</span><br><span class="line">	<span class="comment">//Calculate dp</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cin</span> &gt;&gt; base[i] ; dp[base[<span class="number">1</span>] + <span class="number">1</span>][base[<span class="number">1</span>]] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = base[<span class="number">1</span>] + <span class="number">2</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= i - base[<span class="number">1</span>] - <span class="number">1</span> ; ++ j)</span><br><span class="line">			<span class="keyword">for</span> (clr1 = clr2 = <span class="number">0</span>, k = <span class="number">1</span> ; k &lt;= i - j ; ++ k)&#123;</span><br><span class="line">				<span class="keyword">if</span> (base[i - j - k + <span class="number">1</span>] &lt;= <span class="number">2</span>) ++ clr1 ; <span class="keyword">else</span> ++ clr2 ;</span><br><span class="line">				(dp[i][j] += (dp[i - j][k] * f[j][clr1][clr2] % Mod)) %= Mod ;</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="keyword">for</span> (clr1 = clr2 = <span class="number">0</span>, i = <span class="number">1</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (base[N - i + <span class="number">1</span>] == <span class="number">2</span>) ++ clr1 ; <span class="keyword">else</span> ++ clr2 ;</span><br><span class="line">		(Ans += (dp[N][i] * f[<span class="number">0</span>][clr1][clr2]) % Mod) %= Mod ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>æ€ç»´é¢˜/è®¡æ•°</tag>
        <tag>åŠ¨æ€è§„åˆ’/æ™®é€šDP</tag>
        <tag>æ€ç»´é¢˜/æ„é€ </tag>
        <tag>è´ªå¿ƒ</tag>
        <tag>ç»„åˆè®¡æ•°/æœ‰æŠ€å·§çš„è®¡æ•°</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘æ ¡å†…æ¨¡æ‹Ÿèµ›é€‰æ•´ Â· E1</title>
    <url>/2019/11/13/xiaonei-1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ ¡å†…æ¨¡æ‹Ÿèµ›é€‰æ•´</p>
<p>å¤§æ¦‚éš¾åº¦éƒ½æ˜¯TGé‡Œé¢$2$~$3$å·¦å³çš„ã€‚</p>
<a id="more"></a>
<h1 id="A"><a href="#A" class="headerlink" title="$A$"></a>$A$</h1><blockquote>
<p>ç»™å®šç›´çº¿ä¸Š$n\leq 2000$ä¸ªå»ºç­‘çš„åæ ‡ï¼Œä¸¤ç§è¦†ç›–æ–¹å¼ï¼Œ$A:$è¦†ç›–é•¿åº¦ä¸º$L$ï¼Œå¯ä»¥ç”¨$p$æ¬¡ï¼›$B$ï¼šè¦†ç›–é•¿åº¦ä¸º$2L$ï¼Œå¯ä»¥ç”¨$q$æ¬¡ã€‚æ±‚æœ€å°çš„$L$.</p>
</blockquote>
<hr>
<p>é¦–å…ˆå°±æ˜¯å¯ä»¥çŸ¥é“$p,q$å¯ä»¥ç¼©åˆ°$p+q\leq n$ï¼Œå¦åˆ™ç­”æ¡ˆå°±æ˜¯$1$ã€‚</p>
<p>ä¹‹åè€ƒè™‘äºŒåˆ†ä¸€ä¸ª$L$ï¼Œ$check$å…¶æ­£ç¡®æ€§ã€‚$check$æ—¶æ„Ÿè§‰è´ªå¿ƒå¹¶ä¸æ˜¯å¾ˆå¥½è´ªï¼Œå¯èƒ½ä¼šæœ‰æ¯”è¾ƒå¦™çš„è´ªå¿ƒï¼Œä½†è¿™ä¸ªåœ°æ–¹é€‰æ‹©ä¸€ç§æ›´åŠ ç¨³å¦¥çš„$dp$ã€‚è€ƒè™‘$f_{i,j}$è¡¨ç¤ºä¸¤ç§è¦†ç›–åˆ†åˆ«ç”¨äº†$i,j$ä¸ªæœ€å¤šèƒ½è¦†ç›–åˆ°å“ªä¸ªå»ºç­‘ï¼Œåˆ™</p>
<script type="math/tex; mode=display">
f_{i,j}=\max(go_p[f_{i-1,j}+1], go_q[f_{i,j-1}+1])</script><p>å…¶ä¸­$go_x[P]$è¡¨ç¤ºåœ¨ä½ç½®$P$ä½¿ç”¨ç¬¬$x$ç§è¦†ç›–èƒ½å¤Ÿè¦†ç›–å¤šå°‘å»ºç­‘ã€‚äºæ˜¯æœ€åå¤æ‚åº¦$O(n^2\log n)$.</p>
<h1 id="B"><a href="#B" class="headerlink" title="$B$"></a>$B$</h1><blockquote>
<p>å®šä¹‰<code>string</code>ç±»å‹çš„é€’æ¨$f_0=â€™0â€™$ï¼Œ$f_1=â€™1â€™$ï¼Œ$f_i=f_{i-2}+f_{i-1}$ï¼Œå…¶ä¸­$+$è¡¨ç¤º<code>string</code>ç±»å‹çš„è¿æ¥ã€‚å¤šç»„è¯¢é—®ï¼Œè¯¢é—®$f_n$ä¸­åŒºé—´$\rm [L,R]$å†…çš„ä¸²ã€‚$n\leq 1e9,~\rm L\leq R\leq 2e9,\sum (R-L)\leq 1e7$</p>
</blockquote>
<hr>
<p>æ‹¿åˆ°è¿™é¢˜é¦–å…ˆåº”è¯¥æ‰‹å†™å‡ºå‰$6$é¡¹æ¥æ‰¾è§„å¾‹â€¦â€¦</p>
<p>å‘ç°$f_i.size()$å°±æ˜¯æ–æ³¢é‚£åˆ‡æ•°åˆ—çš„ç¬¬$i$é¡¹ï¼Œå¹¶ä¸”åºå·å¥‡å¶æ€§ç›¸åŒçš„ä¸¤é¡¹$f_i,f_j$ï¼Œå½“$j&lt;i$æ—¶æ»¡è¶³$f_j$æ˜¯$f_i$çš„å‰ç¼€ï¼Œè¿™ä¸œè¥¿å¯ä»¥æ•°å­¦å½’çº³å‡ºæ¥<del>å¹¶ä¸”è‚‰çœ¼çœ‹ä¸å‡ºæ¥</del>ã€‚</p>
<p>ä¹‹åå¯ä»¥å‘ç°$\rm L,R\leq 2e9$ï¼Œè€Œæ–æ³¢é‚£åˆ‡æ•°åˆ—çš„ç¬¬$50$é¡¹å·²ç»è¶…è¿‡äº†è¿™ä¸ªèŒƒå›´ã€‚äºæ˜¯è€ƒè™‘å¯¹äºä¸€ä¸ªè¯¢é—®$f_n[L,R]$ï¼Œå…ˆæŠŠ$n$ç¼©åˆ°$50$ä»¥å†…ï¼Œç„¶ååˆ†å¥‡å¶æ€§èµ‹å€¼ä¸º$48/49$ï¼Œç„¶åæ¯æ¬¡è€ƒè™‘æŠŠ$f_n$åˆ†æˆ$f_{n-2}+f_{n-1}$ï¼Œåˆ†æ²»ä¸‹å»ã€‚æ³¨æ„åˆ°å…¶å®æ˜¯å¯ä»¥é¢„å¤„ç†ä¸€äº›çŠ¶æ€æ¥æé€Ÿï¼Œäºæ˜¯é€‰æ‹©é¢„å¤„ç†å‰$20$é¡¹å·¦å³ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (n &lt;= <span class="number">20</span>) <span class="keyword">return</span> <span class="built_in">cout</span> &lt;&lt; f[n].substr(L, R - L + <span class="number">1</span>), <span class="keyword">void</span>() ;</span><br><span class="line">	<span class="keyword">if</span> (L &lt; fib[n - <span class="number">2</span>]) solve(n - <span class="number">2</span>, L, min(R, fib[n - <span class="number">2</span>])) ; </span><br><span class="line">	<span class="keyword">if</span> (R &gt;= fib[n - <span class="number">2</span>]) solve(n - <span class="number">1</span>, max(<span class="number">0l</span>l, L - fib[n - <span class="number">2</span>]), R - fib[n - <span class="number">2</span>]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C"><a href="#C" class="headerlink" title="$C$"></a>$C$</h1><blockquote>
<p>æˆ‘ä»¬æœ‰ä¸€å¼ æ–¹æ ¼çº¸ï¼Œä»–å¤§æ¦‚é•¿è¿™æ ·ï¼š</p>
<p><img src="https://s2.ax1x.com/2020/01/09/lfSP0I.jpg" alt></p>
<p>æˆ‘ä»¬ç°åœ¨è¦ä»å·¦ä¸Šè§’$(0,0)$åˆ°å³ä¸‹è§’$(n,m)$ç”»ä¸€æ¡ç›´çº¿ï¼Œç„¶åè¯¢é—®å®ƒç»è¿‡é»‘æ ¼å­çš„é•¿åº¦ä¸æ€»é•¿åº¦çš„æ¯”å€¼ï¼Œå¹¶è¾“å‡ºä¸€ä¸ªäº’è´¨åˆ†æ•°çš„å½¢å¼ã€‚</p>
</blockquote>
<p>sbç»“è®ºé¢˜ï¼Œä»¥ä¸‹æ˜¯ç»“è®ºï¼Œè§‰å¾—è¯çš„æŒºå¥½çš„ï¼ˆ</p>
<blockquote>
<p>æ— è®ºæ€æ ·ï¼Œ$rqy$å¤ªå¼ºäº†ï¼ï¼</p>
<p>ä»¥ä¸‹æ˜¯$rqy$ç»™çš„ä¸¥è°¨è¯æ˜ï¼š</p>
<ul>
<li><p>å¯¹äºæ¯ä¸ªäºŒå…ƒç»„$(n,m)$ï¼Œ$(\frac{n}{\gcd(n,m)},\frac{m}{\gcd(n,m)})$ çš„æœ¬è´¨ä¸$(n,m)$æ˜¯ä¸€æ ·çš„ã€‚</p>
</li>
<li><p>å½“$n$æ˜¯å¶æ•°<strong>æˆ–è€…</strong>$m$æ˜¯å¶æ•°çš„æ—¶å€™ï¼Œç­”æ¡ˆæ˜¾ç„¶æ˜¯$\frac{1}{2}$ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠæ‰€æœ‰çš„é¢œè‰²ç¿»è½¬ï¼Œç­”æ¡ˆæ˜¯ä¸€æ ·çš„ã€‚</p>
</li>
<li><p>ä½™ä¸‹çš„æƒ…å†µï¼Œç”±äºæˆ‘ä»¬ç°åœ¨å·²ç»ç¼©å°äº†é—®é¢˜è§„æ¨¡ä½¿å¾—$n,m$äº’è´¨ï¼Œæ‰€ä»¥åªæœ‰å¯èƒ½æ˜¯$nã€m$å‡ä¸ºå¥‡æ•°ï¼Œæ­¤æ—¶æˆ‘ä»¬è€ƒè™‘å¦‚ä¸‹ï¼ˆå‰æ–¹é«˜èƒ½ï¼‰ï¼š</p>
</li>
<li><p>ç”±äºæ¨ªå‘æœ‰$m$æ®µï¼Œçºµå‘æœ‰$n$æ®µï¼Œæ‰€ä»¥æ€»å…±è¿™æ¡ç›´çº¿å¯ä»¥åˆ†æˆ$n \times m$æ®µï¼Œå½“ç„¶ï¼Œæœ‰äº›æ®µçš„é¢œè‰²ç›¸åŒã€‚æˆ‘ä»¬è¿™ä¹ˆåšçš„ç›®çš„æ˜¯ä¸ºäº†ä¿è¯<strong>æ¯ä¸€æ®µä¸ä¼šè·¨è¿‡æ¯ä¸ªæ ¼å­çš„è¾¹ç•Œï¼Œå³åŒä¸€æ®µçš„æ¯ä¸ªéƒ¨åˆ†éƒ½ä¼šæ˜¯ç›¸åŒçš„é¢œè‰²</strong></p>
</li>
<li><p>é€šè¿‡è§‚å¯Ÿå¯ä»¥å¾—åˆ°ï¼Œå¯¹äºä»å·¦ä¸Šåˆ°å³ä¸‹çš„ç¬¬$i$æ®µï¼Œå®ƒåº”è¯¥åœ¨ç¬¬$\lfloor \frac{i}{n} \rfloor$<strong>åˆ—</strong>ï¼Œç¬¬$\lfloor \frac{i}{m} \rfloor$<strong>è¡Œ</strong>ã€‚æ³¨æ„è¿™ä¸ªåœ°æ–¹ï¼Œè™½ç„¶$n$è¡¨ç¤ºçš„æ˜¯è¡Œï¼Œä½†æ˜¯$\lfloor \frac{i}{n} \rfloor$è¡¨ç¤ºçš„æ˜¯åˆ—ã€‚é“ç†å…¶å®å¾ˆç®€å•ï¼š</p>
<ul>
<li>å¯¹äºç¬¬$i$æ®µï¼Œå®ƒå çš„éƒ¨åˆ†æ˜¯$\frac{i}{n \times m}$ ï¼Œæ‰€ä»¥æ‰€å±çš„è¡Œåº”è¯¥æ˜¯$\lfloor \frac{i}{n \times m} \cdot n \rfloor$ï¼Œæ‰€å±çš„åˆ—ä¸º$\lfloor \frac{i}{n \times m} \cdot m \rfloor$ï¼Œçº¦åˆ†ä¸€ä¸‹ç­”æ¡ˆæ˜¾è€Œæ˜“è§ã€‚ </li>
</ul>
</li>
<li><p>åŸºäºå‰ä¸¤æ¡ï¼Œæˆ‘ä»¬ä¼šæœ‰ä¸€ä¸ªæ¯”è¾ƒå¹³å‡¡çš„ç»“è®ºï¼šå¯¹äºæŸä¸€æ®µ$i$ï¼Œå½“$\lfloor \frac{i}{n} \rfloor + \lfloor \frac{i}{m} \rfloor$ä¸ºå¶æ•°çš„æ—¶å€™ï¼Œè¿™ä¸€æ®µåœ¨é»‘è‰²çš„æ ¼å­ä¸Šï¼›æ˜¯å¥‡æ•°çš„æ—¶å€™ï¼Œè¿™ä¸€æ®µåœ¨ç™½è‰²æ ¼å­ä¸Šã€‚</p>
</li>
<li><p>æˆ‘ä»¬å¯ä»¥è€ƒè™‘å¯¹$\lfloor \frac{i}{n} \rfloor + \lfloor \frac{i}{m} \rfloor$æä¸€äº›äº‹æƒ…ï¼š</p>
<script type="math/tex; mode=display">
\lfloor \frac{i}{n} \rfloor + \lfloor \frac{i}{m} \rfloor\begin{align} \\ \\&\equiv\frac{i - i \mod n}{n}+\frac{i - i \mod m}{m} \pmod 2\\ &\equiv 2i - i \mod n - i \mod m \pmod 2\\  & \equiv i \mod n  + i  \mod m \pmod 2\end{align}</script></li>
</ul>
<p>ä¸Šå¼çš„ç›®çš„å…¶å®å°±æ˜¯é€šè¿‡å¯¹$2$å–æ¨¡å»ºç«‹åŒä½™å¼ï¼Œç”±äº$n,m$å‡ä¸ºå¥‡æ•°ï¼Œæ‰€ä»¥åœ¨$\mod 2$æ„ä¹‰ä¸‹éƒ½æ˜¯$1$ï¼Œå¯ä»¥ç›´æ¥é™¤æ‰ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘ï¼Œè¿™æ ·çš„$i$æœ‰å¤šå°‘ä¸ªå‘¢ï¼Ÿå¾ˆæ˜¾ç„¶çš„ï¼Œåœ¨$0 \to n - 1$ä¸­ï¼Œå…±æœ‰$\frac {n-1}{2}$ä¸ªå¥‡æ•°,$\frac{n+1}{2}$ä¸ªå¶æ•°ï¼›åœ¨$0 \to m-1$ä¸­ï¼Œå…±æœ‰$\frac {m-1}{2}$ä¸ªå¥‡æ•°ï¼Œ$\frac {m+1}{2}$ä¸ªå¶æ•°ã€‚å› ä¸ºåªæœ‰å¥‡å¶æ€§ç›¸åŒæ—¶ï¼Œæ‰å±äºé»‘è‰²æ ¼å­ï¼Œæ‰€ä»¥ç”±ä¸­å›½å‰©ä½™å®šç†å¾—</p>
<script type="math/tex; mode=display">
\begin{aligned}\sum check(i) &= \frac{n-1}{2} \cdot \frac{m-1}{2} + \frac{n+1}{2} \cdot \frac{m+1}{2} \\& = \frac{2nm + 2}{4}\end{aligned}</script><p>é‚£ä¹ˆæœ€ç»ˆç­”æ¡ˆå°±æ˜¯</p>
<script type="math/tex; mode=display">
\frac {\sum check(i)}{n \cdot m} = \frac{n \cdot m+1}{2n \cdot m}</script></blockquote>
<h1 id="D"><a href="#D" class="headerlink" title="$D$"></a>$D$</h1><blockquote>
<p>ç»™å®šä¸€æ£µæ ‘ï¼ŒæŸäº›ç‚¹æ˜¯å…³é”®ç‚¹ã€‚æ¯æ¡è¾¹æœ‰ä»£ä»·ï¼Œæ¯æ¬¡å¯ä»¥åˆ æ‰ä¸€æ¡è¾¹å¹¶ä¸”è·å¾—è¿™æ¡è¾¹çš„ä»£ä»·ã€‚æ±‚æœ€å°‘çš„ä»£ä»·ï¼Œä½¿å¾—æ‰€æœ‰å…³é”®ç‚¹ä¸è¿é€šã€‚$n\leq 300,000$</p>
</blockquote>
<hr>
<p>ç›´è§‚çš„æƒ³æ³•æ˜¯$dp$ï¼Œå³è®°$f_x$è¡¨ç¤ºå¤„ç†å®Œä»¥$x$ä¸ºæ ¹çš„å­æ ‘å†…çš„å…³é”®ç‚¹ï¼ˆä¸äº’ç›¸è¿é€šï¼‰çš„æœ€å°‘ä»£ä»·ã€‚ä½†æ˜¯å‘ç°è¿™æ ·ä¼¼ä¹å¾ˆéš¾è½¬ç§»ï¼Œå› ä¸ºè½¬ç§»æ—¶è¦è€ƒè™‘å­æ ‘ä¹‹é—´çš„å…³é”®ç‚¹æ˜¯å¦è¿é€šã€‚äºæ˜¯è€ƒè™‘å†è®°$g_x$è¡¨ç¤ºå¤„ç†å®Œä»¥$x$ä¸ºæ ¹çš„å­æ ‘å†…å…³é”®ç‚¹äº’ç›¸ä¸è¿é€šï¼Œä¸”ä¸ä¸å¤–ç•Œè¿é€šçš„æœ€å°ä»£ä»·ã€‚</p>
<p>é‚£ä¹ˆè€ƒè™‘è½¬ç§»ï¼Œè®°$x$ä¸ºå½“å‰èŠ‚ç‚¹ï¼Œ$y$ä¸º$x$çš„å­èŠ‚ç‚¹ï¼š</p>
<ul>
<li><p>å½“$x$ä¸ºå…³é”®ç‚¹æ—¶ï¼Œæœ‰ï¼š</p>
<script type="math/tex; mode=display">
\begin{align*}
f_x&=\sum g_y \\
g_x&=f_x+pre_x
\end{align*}</script></li>
<li><p>å½“$x$ä¸ä¸ºå…³é”®ç‚¹æ—¶ï¼Œæœ‰</p>
<script type="math/tex; mode=display">
f_x=\min(\sum f_y-f_{y'}+g_{y'})\\
g_x=\min(f_x+pre_x, \sum g_y)</script></li>
</ul>
<p>å””ï¼Œè¿™ä¸ªç¬¬äºŒä¸ªè½¬ç§»çš„$f_x$è¿˜æ˜¯éœ€è¦ç¼–ä¸€ç¼–çš„ï¼Œå¤§æ¦‚å°±æ˜¯è€ƒè™‘ç°åœ¨åªéœ€è¦ä¸è®©å­æ ‘å†…éƒ¨è¿é€šï¼Œé‚£ä¹ˆå°±å¯ä»¥é€‰å‡ºä¸€æ£µå­æ ‘æ¥å†…éƒ¨ä¸è¿é€šï¼Œå…¶ä»–å­æ ‘éƒ½ä¸å’Œå¤–éƒ¨è¿é€šï¼Œå¯çŸ¥è¿™æ ·æ˜¯æœ€ä¼˜çš„ï¼ˆå› ä¸ºå¤©é€‰ä¹‹å­ä¸éœ€è¦â€œä¸å’Œå¤–éƒ¨è¿é€šâ€ï¼‰ã€‚</p>
<p>å­¦ä¹ äº†ï¼Œå­¦ä¹ äº†ã€‚</p>
<h1 id="E"><a href="#E" class="headerlink" title="$E$"></a>$E$</h1><blockquote>
<p>ç°åœ¨æœ‰å¦‚ä¸‹ä¸€ä¸ªè¡¨è¾¾å¼ï¼š $0 ~a_1 b_1 a_2 b_2 â€¦ a_n b_n$ã€‚å…¶ä¸­$a_i$ä¸ºä¸€ä¸ªä½è¿ç®—ç¬¦ï¼ˆ$\boldsymbol{and/or/xor}$ï¼‰ï¼Œ$b_i$æ˜¯ä¸€ ä¸ªæ•´æ•°ã€‚æ¯ä¸€å¯¹$a_i,b_i$æœ‰$c_i$çš„æ¦‚ç‡ä¼šæ¶ˆå¤±ï¼Œæ±‚è¡¨è¾¾å¼çš„ç»“æœçš„æœŸæœ›ã€‚  </p>
</blockquote>
<hr>
<p>éœ€è¦å»ºç«‹æŸç§ç¥ç§˜çš„æ¡ä»¶åå°„ï¼Œå°±æ˜¯é‡åˆ°ä½è¿ç®—çš„é¢˜ç›®å°±è¦æƒ³åˆ°â€œä½ä¸ä½ä¹‹é—´æ˜¯æ— å…³çš„â€ã€‚é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥æŒ‰ä½åšï¼Œä»¤$f_{i,0/1}$è¡¨ç¤ºè®¡ç®—å®Œå‰$i$å¯¹ï¼Œç°åœ¨è¿™ä¸€ä½ä¸º$0/1$çš„æ¦‚ç‡æ˜¯å¤šå°‘ã€‚è½¬ç§»æ—¶åˆ«å¿˜äº†åŠ ä¸Šå½“å‰è¿™ä¸€å¯¹è¢«åˆ é™¤çš„æ¦‚ç‡ï¼Œå³$f_{i-1,0/1}$ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>æ ¡å†…æ¨¡æ‹Ÿèµ›</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ </tag>
        <tag>æ•°å­¦/æ¦‚ç‡,æœŸæœ›</tag>
        <tag>å¥‡æ€ªçš„æŠ€å·§</tag>
        <tag>æœ‰è¶£çš„äºŒåˆ†ç­”æ¡ˆ</tag>
        <tag>åŠ¨æ€è§„åˆ’/æ ‘å½¢DP</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘åˆ†æ²»åœ¨FFTä¸Šçš„åº”ç”¨</title>
    <url>/2019/08/27/fzfft-md/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å…¶å®å°±æ˜¯cdqåˆ†æ²»+FFTã€‚</p>
<p>åˆ†æ²»FFTè§£å†³çš„é—®é¢˜çš„ä¸€èˆ¬å½¢å¼ï¼š</p>
<p>ç»™å‡º$g_1,g_2,g_3\cdots g_{n-1},f_0=1$ï¼Œä¸”</p>
<script type="math/tex; mode=display">
f_i=\sum_{j=1}^{i} f_{i-j} g_j</script><p>æ±‚$f_1,f_2\cdots f_{n-1}$</p>
<a id="more"></a>
<p>å…ˆå±•å¼€è§‚å¯Ÿæ€§è´¨</p>
<script type="math/tex; mode=display">
\begin{aligned}f_1&=g_1f_0,\\\ f_2&=g_1f_1+g_2f_0,
\\\ f_3&=g_1f_2+g_2f_1+g_3f_0\\\ f_4&=g_1f_3+g_2f_2+g_3f_1+g_4f_0=g_1^4\end{aligned}</script><p>æˆ‘ä»¬å‘ç°å¦‚æœå°†æ•´ä¸ªåºåˆ—åˆ†æˆä¸¤åŠï¼Œå‰ä¸€åŠå¯¹åä¸€åŠçš„è´¡çŒ®æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
o_p=\sum_{i=l}^{\rm{mid}}f_ig_{p-i}</script><p>å…¶ä¸­$p\in(\rm{mid},r]$ï¼Œ$o$æ˜¯é¢å¤–çš„è´¡çŒ®ã€‚</p>
<p>æˆ‘ä»¬å‘ç°ï¼Œå…¶å®è¿™æ˜¯ä¸ªå·ç§¯çš„å½¢å¼ï¼Œæ¯•ç«Ÿå¯¹äºæ™®é€šçš„å·ç§¯å®šä¹‰æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
c_i=\sum_{j\leq i} a_jb_{i-j}</script><p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åˆ†æ²»ï¼Œæ¯æ¬¡æš´åŠ›NTTè®¡ç®—å‰ä¸€åŠå¯¹åä¸€åŠçš„è´¡çŒ®ï¼Œç±»ä¼¼äºcdqåˆ†æ²»çš„æ“ä½œï¼Œå¤æ‚åº¦$n\log ^2n$ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cdqNTT</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;<span class="keyword">if</span> (!l) F[l] = <span class="number">1</span> ; <span class="keyword">return</span> ;&#125; <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, L = r - l + <span class="number">1</span>, Len = <span class="number">1</span>, l1 = <span class="number">0</span> ;</span><br><span class="line">    cdqNTT(l, mid) ;</span><br><span class="line">    <span class="keyword">while</span> (Len &lt;= L) Len &lt;&lt;= <span class="number">1</span>, ++ l1 ;</span><br><span class="line">    <span class="built_in">memcpy</span> (P, G, <span class="keyword">sizeof</span>(LL) * (r - l + <span class="number">1</span>)) ;</span><br><span class="line">    <span class="built_in">memcpy</span> (Q, F + l, <span class="keyword">sizeof</span>(LL)*(mid - l + <span class="number">1</span>)) ;</span><br><span class="line">    <span class="built_in">memset</span> (P + r - l + <span class="number">1</span>, <span class="number">0</span>, <span class="keyword">sizeof</span> (LL) * (Len - r + l)) ;</span><br><span class="line">    <span class="built_in">memset</span> (Q + mid - l + <span class="number">1</span>, <span class="number">0</span>, <span class="keyword">sizeof</span> (LL) * (Len - mid + l)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l1 - <span class="number">1</span>)) ;</span><br><span class="line">    NTT(P, Len, <span class="number">1</span>), NTT(Q, Len, <span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) P[i] = P[i] * Q[i] % Mod ;</span><br><span class="line">    NTT(P, Len, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = mid + <span class="number">1</span> ; i &lt;= r ; ++ i) (F[i] += P[i - l]) %= Mod ; cdqNTT(mid + <span class="number">1</span>, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;G[i]) ;</span><br><span class="line">    cdqNTT(<span class="number">0</span>, N - <span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) <span class="built_in">printf</span>(<span class="string">"%lld "</span>, F[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å—¯ï¼Œå¾—å‡ºç»“è®ºæˆ‘çš„åˆ†æ²»æ²¡å­¦å¥½qaq</p>
<p>ä½†æ˜¯å¦‚æœæ¢ä¸€ä¸ªè§’åº¦è§‚å¯Ÿï¼Œè®¾å‡ºä¸¤ä¸ªå½¢å¼å¹‚çº§æ•°ï¼Œå³ä»¤</p>
<script type="math/tex; mode=display">
\begin{aligned}
\rm{F}&=\sum f_ix^i\\\
\rm{G}&=\sum g_ix^i
\end{aligned}</script><p>ç„¶åæˆ‘ä»¬æŠŠä»–ä¿©å·èµ·æ¥ï¼Œä¸”å› ä¸ºFæœ¬èº«å°±æ˜¯å·ç§¯çš„å½¢å¼ï¼Œå³æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
\rm{F} *\rm{G} & =\sum x^i\sum_{j\leq i} f_ig_j
\\\
&= \sum x_i f_{i+1}\\\
&= \rm{F}-f_0
\end{aligned}</script><p>é‚£ä¹ˆå…ˆç§»é¡¹ï¼Œä¹‹åä¸¤è¾¹åŒæ—¶å·ä¸€ä¸ª$\rm{G}-1$ çš„é€†å°±å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\rm{F}= \frac{1}{1-G}</script><p>äºæ˜¯ç›´æ¥æ±‚ä¸€ä¸ªé€†å°±å®Œäº†ï¼Œå¤æ‚åº¦$n\log n$ã€‚</p>
<p>ä¸å¾—ä¸è¯´è¿™ä¹Ÿç®—æ˜¯ä¸€ä¸ªå°æŠ€å·§äº†qwq</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¤šé¡¹å¼</category>
      </categories>
      <tags>
        <tag>åˆ†æ²»</tag>
        <tag>å¤šé¡¹å¼çš„åº”ç”¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘Berlekamp-Masseyç®—æ³•</title>
    <url>/2019/08/26/BM/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>Berlekamp-Massey</strong>ç®—æ³•ç”¨äºåœ¨$O(n^2)$çš„æ—¶é—´å†…æ±‚è§£æ•°åˆ—çš„é€’æ¨å¼ã€‚</p>
<p>å½¢å¼åŒ–åœ°è®²ï¼Œç»™å®š $a_i(i=1,2,3â€¦n-1,n)$ï¼Œæ±‚ä¸€ç»„ $b_j(j=1,2,3â€¦m)$ï¼Œæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
\forall i\geq m+1, a_i=\sum _{j=1}^{m} a_{i-j}b_j</script><p>å…¶ä¸­æˆ–è®¸ä¼šæœ‰æ¡ä»¶é™åˆ¶$m$æœ€å°ã€‚</p>
<a id="more"></a>
<h1 id="ç¥ä»™æ„é€ "><a href="#ç¥ä»™æ„é€ " class="headerlink" title="ç¥ä»™æ„é€ "></a>ç¥ä»™æ„é€ </h1><p>è€ƒè™‘å¢é‡æ„é€ ã€‚å³å·²çŸ¥æ»¡è¶³å‰ $i - 1$ é¡¹çš„é€’æ¨å¼ï¼Œå¦‚ä½•æ±‚å‡ºä¹Ÿæ»¡è¶³ç¬¬ $i$ é¡¹çš„ã€‚</p>
<p>å®šä¹‰ $\Delta_i$ è¡¨ç¤ºç¬¬ $i$ é¡¹ä¸å½“å‰é€’æ¨å¼ä¹‹é—´çš„å·®å€¼ï¼Œ$\rm F$ ä¸ºå½“å‰æš‚æ—¶æ»¡è¶³æ¡ä»¶çš„é€’æ¨å¼ $\{f_i\}$ã€‚</p>
<p>é‚£ä¹ˆå®šä¹‰ï¼š</p>
<script type="math/tex; mode=display">
\Delta_i=a_i-\sum_{j=1}^{m}f_ja_{i-j}</script><p>è€ƒè™‘å¦‚æœ $\Delta_i=0$ é‚£ä¹ˆå°±ä¸éœ€è¦ç®¡ï¼Œç°åœ¨è€ƒè™‘ $\Delta_i \not =0$  çš„æƒ…å†µã€‚</p>
<p>è€ƒè™‘ä¸€ä¸ªå¤§ä½“çš„æ„é€ æ€æƒ³ï¼Œæˆ‘ä»¬æœ€åæ„é€ å‡ºçš„ $\rm F$ å°½é‡æ˜¯è®©å‰é¢æ»¡è¶³çš„é€’æ¨å…³ç³»æ»¡è¶³ï¼Œå¹¶ä¸”ä½¿å¾—æ–°åŠ è¿›æ¥çš„ä¸€ç»„å…³äº $i$ çš„é€’æ¨å…³ç³»ä¹Ÿæ»¡è¶³ã€‚</p>
<p>è€ƒè™‘ä»¤ $\mathrm{F}_k$ è¡¨ç¤ºä¿®æ”¹è¿‡ $k$ æ¬¡ä¹‹åçš„é€’æ¨å¼ï¼Œ$\mathrm{fail}_k$ è¡¨ç¤ºç¬¬ $k$ ä¸ªç‰ˆæœ¬çš„é€’æ¨å¼æ˜¯å“ªä¸ª $i$ å¼€å§‹å¤±é…çš„ã€‚ä¸å¦¨è®°ç®—å®Œ $a_{i-1}$ çš„ $\rm F$ æ˜¯ç¬¬ $q$ ä¸ªç‰ˆæœ¬ï¼Œå³ $\rm F_q$</p>
<p>é‚£ä¹ˆè€ƒè™‘æˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªè¿™æ ·çš„ $\mathrm Fâ€™:\{fâ€™_1,fâ€™_2,\dots f_{mâ€™}â€™\}$ ï¼Œä½¿å¾— </p>
<script type="math/tex; mode=display">
\forall p\in[m'+1,i-1]\cap\mathbb Z,\\
\sum_{j=1}^{m'} f'_ja_{p-j}=0</script><p>åŒæ—¶æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\sum_{j=1}^{m'} f'_ja_{i-j}=\Delta_{i}</script><p>é‚£ä¹ˆæ˜¾ç„¶ä»¤ $\mathrm{F}_{q+1}=\mathrm{F_q}+\mathrm{Fâ€™}$ å°±æ˜¯ç­”æ¡ˆã€‚</p>
<p>è€ƒè™‘è¿™ä¹ˆä¸€ç§æ„é€ æ–¹å¼ï¼šéšä¾¿é€‰ä¸€ä¸ªå†å²ç‰ˆæœ¬ $o,1\leq o\leq q$ ï¼Œä»¤ $\alpha=\frac{\Delta_i}{\Delta_o}$ ï¼Œé‚£ä¹ˆ $\rm Fâ€™$ å°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\{0,0\ldots0,\alpha,-\alpha\cdot \mathrm F_o\}</script><p>å…¶ä¸­å‰ç¼€ $0$ çš„ä¸ªæ•°ä¸º $i-\mathrm{fail}_o-1$ ï¼Œæœ€å $\mathrm {fail} _o$ é¡¹æ˜¯ $\rm F\it _o$ æ•´ä½“ä¹˜ä¸Šäº† $\alpha$ã€‚</p>
<p>æ€è€ƒè¿™æ ·çš„å¯è¡Œæ€§ï¼Œè®¾ $pâ€™\in[1,i]\cap\mathbb Z$ ï¼Œé‚£ä¹ˆæœ‰ï¼š</p>
<script type="math/tex; mode=display">
\sum_{j=1}^{m'}f_j'a_{p'-j}=
\begin{cases}
\alpha\cdot(a_{\mathrm{fail}_o}-\sum_{j=1}^{|\mathrm{F}_{o}|}f_{o,j}a_{\mathrm{fail}_o-j})=\alpha\cdot \Delta_{\mathrm{fail}_o}=\Delta_i,\quad &p'=i\\
\alpha\cdot(a_{\mathrm{fail}_o-k}-\sum_{j=1}^{|\mathrm{F}_{o}|}f_{o,j}a_{\mathrm{fail}_o-k-j})=0,\quad &p'=i-k,k\in \mathbb Z_{+}
\end{cases}</script><p>å‘ç°åˆšå¥½æ»¡è¶³è¦æ±‚ã€‚äºæ˜¯å¯çŸ¥ $\mathrm{F}_{q+1}=\mathrm{F_q}+\mathrm{Fâ€™}$ å³ä¸ºç­”æ¡ˆã€‚</p>
<p>é‚£ä¹ˆè€ƒè™‘å¦‚ä½•æ±‚æœ€çŸ­é€’æ¨å¼ã€‚å‘ç° $1\leq o\leq q$ çš„é€‰å–æ²¡æœ‰é™åˆ¶ï¼Œæ‰€ä»¥é€‰ $|\mathrm{F}_o|+i-\mathrm{fail}_o$ æœ€å°çš„å³å¯ã€‚</p>
<h1 id="å®ç°éƒ¨åˆ†"><a href="#å®ç°éƒ¨åˆ†" class="headerlink" title="å®ç°éƒ¨åˆ†"></a>å®ç°éƒ¨åˆ†</h1><p>å¤§æ¦‚è¿˜æ˜¯å¾ˆæ˜¾ç„¶çš„ï¼Ÿè¿‡ç¨‹éƒ½å¾ˆæ¸…æ™°ï¼Œå°±æ˜¯æ¨¡æ‹Ÿäº†ä¸€éè€Œå·²ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> fail[MAXN] ; </span><br><span class="line"><span class="built_in">vector</span> &lt;LL&gt; f[MAXN] ;</span><br><span class="line">LL delta[MAXN], now ;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">BM</span><span class="params">(<span class="keyword">int</span> I)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= I ; ++ i)&#123;</span><br><span class="line">      	now = base[i] ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= f[M].size() ; ++ j)</span><br><span class="line">            now = now - base[i - j] * f[M][j - <span class="number">1</span>] % Mod ;</span><br><span class="line">        delta[i] = (now % Mod + Mod) % Mod ; </span><br><span class="line">      	<span class="keyword">if</span> (!delta[i]) <span class="keyword">continue</span> ; <span class="keyword">else</span> fail[M] = i ;</span><br><span class="line">        <span class="keyword">if</span> (!M) &#123; </span><br><span class="line">          f[++ M].resize(i) ;</span><br><span class="line">          delta[i] = base[i] ;  <span class="keyword">continue</span> ; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> Id = M - <span class="number">1</span> ;</span><br><span class="line">        v = f[Id].size() - fail[Id] + i ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; M ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (i - fail[j] + f[j].size() &lt; v)</span><br><span class="line">                Id = j, v = i - fail[j] + f[j].size() ;</span><br><span class="line">        f[M + <span class="number">1</span>] = f[M] ; ++ M ; </span><br><span class="line">      	<span class="keyword">while</span> (f[M].size() &lt; v) f[M].push_back(<span class="number">0</span>) ;</span><br><span class="line">        LL mul = delta[i] * expow(delta[fail[Id]], Mod - <span class="number">2</span>) % Mod ;</span><br><span class="line">        (f[M][i - fail[Id] - <span class="number">1</span>] += mul) %= Mod  ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; f[Id].size() ; ++ j)</span><br><span class="line">            (f[M][i - fail[Id] + j] -= mul * f[Id][j]) %= Mod ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; f[M].size() ; ++ i)</span><br><span class="line">        p[i + <span class="number">1</span>] = (f[M][i] % Mod + Mod) % Mod, <span class="built_in">cout</span> &lt;&lt; p[i + <span class="number">1</span>] &lt;&lt; <span class="string">" "</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±æ²¡æœ‰ç„¶åäº†</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>Berlekamp-Masseyç®—æ³•</category>
      </categories>
      <tags>
        <tag>Berlekamp-Massey</tag>
        <tag>æ•°å­¦/å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢</title>
    <url>/2019/08/26/fwt/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢(FWT)</strong>æ˜¯ä¸€ç§å¹¿ä¹‰ä¸Šçš„<strong>å‚…é‡Œå¶å˜æ¢</strong>ï¼Œå¯ä»¥è§£å†³<strong>å­é›†å¹¶å·ç§¯</strong>ã€<strong>å­é›†äº¤å·ç§¯</strong>ä»¥åŠ<strong>å­é›†å¯¹ç§°å·®å·ç§¯</strong>ã€‚</p>
<p>è€Œåœ¨OIä¸­å†³å®šäº†FWTèƒœè¿‡FMTçš„ä¸€å¤§åŸå› å°±æ˜¯ä»–å¯ä»¥æ–¹ä¾¿åœ°è§£å†³<strong>å­é›†å¯¹ç§°å·®å·ç§¯</strong>ï¼Œå³ï¼š</p>
<script type="math/tex; mode=display">
c_i=\sum_{j\oplus k=i} a_jb_k</script><p>å…¶ä¸­$\oplus$è¡¨ç¤ºäºŒè¿›åˆ¶æ•°çš„å¼‚æˆ–è¿ç®—ã€é›†åˆçš„å¯¹ç§°å·®è¿ç®—ï¼ˆè™½ç„¶â€å¯¹ç§°å·®â€å¬èµ·æ¥æŒºæœ‰é“ç†ï¼Œä½†æ˜¯æ„Ÿè§‰â€œäºŒè¿›åˆ¶éè¿›ä½åŠ æ³•â€æ›´æœ‰è¶£ï¼‰ã€‚</p>
<a id="more"></a>
<hr>
<h1 id="å†è°ˆçº¿æ€§å˜æ¢å®è´¨"><a href="#å†è°ˆçº¿æ€§å˜æ¢å®è´¨" class="headerlink" title="å†è°ˆçº¿æ€§å˜æ¢å®è´¨"></a>å†è°ˆçº¿æ€§å˜æ¢å®è´¨</h1><p>é¦–å…ˆæ˜¯æ„é€ ï¼Œæˆ‘ä»¬è€ƒè™‘çº¿æ€§å˜æ¢çš„æœ¬è´¨ï¼Œéœ€è¦æœ‰:</p>
<script type="math/tex; mode=display">
{\rm FWT(C)}_i={\rm FWT(B)}_i\cdot{\rm FWT(A)}_i</script><p>é‚£ä¹ˆä¸€ä¸ªæ€è·¯å°±æ˜¯å…ˆè®¾ä¸€ä¸ªè¾…åŠ©å‡½æ•°$\varphi(i,x)$å‡ºæ¥ï¼š</p>
<script type="math/tex; mode=display">
{\rm FWT(F)}_i=\sum_{j\geq 0}\varphi(j,i) \cdot f_j</script><p>é‚£ä¹ˆå°±ä¼šæœ‰ï¼š</p>
<script type="math/tex; mode=display">
\sum_{j\geq 0}\varphi(j,i) \cdot c_j=\sum_{j\geq 0}\varphi(j,i) \cdot a_j\times \sum_{j\geq 0}\varphi(j,i) \cdot b_j</script><p>ç„¶åæŠŠ</p>
<script type="math/tex; mode=display">
c_i=\sum_{j\oplus k=i} a_jb_k</script><p>å¸¦è¿›å»å¹¶è°ƒæ•´ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{j\geq 0}\varphi(j,i) \cdot \sum_{p\oplus q=j} a_pb_q & =\sum_{j\geq 0}\varphi(j,i) \cdot a_j \times\sum_{j\geq 0}\varphi(j,i) \cdot b_j\\\
\sum_{p \geq 0} \sum_{q\geq 0}\varphi(p\oplus q,i)\cdot a_pb_q & =\sum_{p\geq 0}\sum_{q\geq 0}\varphi(p,i) \cdot \varphi(q,i)\cdot a_pb_q\\\
\end{aligned}</script><p>å‘ç° $\sum_{p\geq 0}\sum _{q\geq 0}a_pb_q$ æ˜¯å¯ä»¥æ¶ˆæ‰çš„ï¼Œäºæ˜¯å°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\varphi(p\oplus q,i)=\varphi(p,i)\cdot \varphi(q,i)</script><h1 id="æ„é€ -varphi"><a href="#æ„é€ -varphi" class="headerlink" title="æ„é€ $\varphi$"></a>æ„é€ $\varphi$</h1><p>å¯¹äºå¼‚æˆ–æ“ä½œæ¥è¯´ï¼Œå¼‚æˆ–å‰å$1$çš„ä¸ªæ•°çš„å¥‡å¶æ€§ä¸ä¼šæ”¹å˜ã€‚å³ä¹Ÿå°±æ˜¯è¯´$i,j$ä¸­$1$çš„ä¸ªæ•°åŠ èµ·æ¥å’Œ$i\oplus j$ä¸­1çš„ä¸ªæ•°çš„å¥‡å¶æ€§æ˜¯ä¸€æ ·çš„ã€‚å½¢å¼åŒ–åœ°è®²ï¼š</p>
<script type="math/tex; mode=display">
\rm bitcount(i)+bitcount(j)\equiv bitcount(i~\oplus ~j)~(\bmod 2)</script><p>è¯æ˜ï¼š</p>
<p>è€ƒè™‘$i \oplus j$çš„æ¯ä¸€ä½ï¼š</p>
<ul>
<li>è‹¥$i$å’Œ$j$çš„è¿™ä¸€ä½ç›¸åŒï¼Œé‚£ä¹ˆå°±ä¼šå˜æˆ$0$ï¼Œ$1$çš„ä¸ªæ•°å‡äºŒæˆ–ä¸å˜ï¼›</li>
<li>å¦‚ä¸åŒï¼Œé‚£ä¹ˆå°±ä¸€å®šæ˜¯$(xx1xx)\oplus(xx0xx)=(xx1xx)$ï¼Œ$1$çš„ä¸ªæ•°è¿˜æ˜¯ä¸å˜ã€‚</li>
</ul>
<p>è€Œæˆ‘ä»¬å‘ç°è¿™ä¸ªå¼•ç†è§£å†³çš„æ˜¯ç›¸åŠ ä¸å˜çš„é—®é¢˜ï¼Œè€Œæˆ‘ä»¬éœ€è¦çš„$\varphi$å‡½æ•°éœ€è¦æ»¡è¶³ç›¸ä¹˜ä¸å˜ï¼Œäºæ˜¯è‡ªç„¶è€Œç„¶åœ°æƒ³åˆ°è¦æ”¾åˆ°å¹‚ä¸Šå»ã€‚</p>
<p>äºæ˜¯å°±å®šä¹‰äº†$\varphi$:</p>
<script type="math/tex; mode=display">
\varphi(s,t)=(-1)^{|s\cap t|}</script><p>æ¢æˆæ•°å€¼çš„è¡¨ç¤ºæ–¹æ³•ï¼š</p>
<script type="math/tex; mode=display">
\varphi(i,j)=(-1)^{\rm bitcount \mathcal{(i ~\rm{and}~ j)}}</script><p>è¿™ä¹ˆå®šä¹‰çš„åŸå› æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
(i \cap x) \oplus(j \cap x)=(i \oplus j) \cap x</script><p>å³<strong>å¼‚æˆ–å¯¹äº¤æœ‰åˆ†é…å¾‹</strong>ï¼Œé‚£ä¹ˆï¼š</p>
<script type="math/tex; mode=display">
{\rm{FWT(F)}}_i=\sum_{j \geq 0}(-1)^{|i\cap j|}f_j</script><p><del>äºæ˜¯å°±å–œæä¸€ä¸ªæŒ‡æ•°çº§ç®—æ³•</del></p>
<h1 id="çœŸæ­£çš„-rm-FWT"><a href="#çœŸæ­£çš„-rm-FWT" class="headerlink" title="çœŸæ­£çš„$\rm{FWT}$"></a>çœŸæ­£çš„$\rm{FWT}$</h1><p>æˆ‘ä»¬å‘ç°ä¼¼ä¹è¿™ä¸œè¥¿æ²¡æœ‰åŠæ³•dpï¼Œäºæ˜¯è€ƒè™‘ï¼š</p>
<blockquote>
<p>æ¯ä¸€æ¬¡è€ƒè™‘æ–°åŠ å…¥ç¬¬$i$ä¸ªç‰©å“å–ä¸å–çš„æƒ…å†µï¼Œå°†å½“å‰é›†åˆåˆ†ä¸º$i$å–å’Œ$i$ä¸å–ï¼Œ$i$å–çš„æ”¾å³è¾¹ï¼Œ$i$ä¸å–çš„æ”¾å·¦è¾¹ã€‚</p>
<p>$i$å–çš„è¯ï¼Œå’Œ$i$å–çš„çŠ¶æ€å–å¹¶åé›†åˆå¤§å°ä¸å˜ï¼Œå’Œ$i$ä¸å–çš„çŠ¶æ€å–å¹¶åé›†åˆå¤§å°$âˆ’1$ã€‚$i$ä¸å–çš„è¯ï¼Œå’Œ$i$å–çš„çŠ¶æ€å–å¹¶åé›†åˆå¤§å°ä¸å˜ï¼Œå’Œ$i$ä¸å–çš„çŠ¶æ€å–å¹¶åé›†åˆå¤§å°åŒæ ·çš„ä¸å˜ã€‚ </p>
<p>è¿™æ ·è€ƒè™‘åŸæœ‰çŠ¶æ€ï¼Œå·¦å³ä¸¤è¾¹å¯¹$i$ä¸å–çš„è´¡çŒ®éƒ½æ˜¯$\text{++}$ï¼Œå› ä¸ºé›†åˆå¤§å°ä¸å˜ã€‚å·¦è¾¹å¯¹$i$å–çš„è´¡çŒ®æ˜¯$+$ï¼Œå³è¾¹å¯¹$i$å–çš„è´¡çŒ®æ˜¯$\text{âˆ’âˆ’}$ï¼Œå› ä¸ºéƒ½å–$i$çš„è¯å¹¶é›†å¢åŠ äº†$1$ï¼Œè´¡çŒ®å–åã€‚</p>
</blockquote>
<p>ç„¶åå…¶å®å°±æ˜¯ä¸ªæ¨¡æ‹Ÿçš„æ€è·¯ï¼Œç”±äº$(1xxxxxx)_2$å’Œ$(0xxxxxx)_2$çš„æ•°é‡æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†å°äº$(1000000)_2$çš„åˆ†ä¸ºä¸€ç±»ï¼Œå¤§äºç­‰äº$(1000000)_2$çš„åˆ†ä¸ºä¸€ç±»ï¼Œä»æ•°å€¼ä¸Šçœ‹å°±æ˜¯å‰ä¸€åŠå’Œåä¸€åŠã€‚</p>
<p>æ€»ä¹‹å°±æ˜¯ä¸ªFFTğŸ¦‹æ“ä½œçš„æ€è·¯å•¦ã€‚</p>
<p>ç„¶åå¯¹äºé€†å˜æ¢ï¼Œå› ä¸ºæˆ‘ä»¬åˆšæ‰çš„ç»“è®ºæœ‰ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}{F[j+k] =F[j+k]+F[i+j+k]} \\\ {F[i+j+k]=F[j+k]-F[i+j+k]}\end{aligned}</script><p>æ‰€ä»¥æˆ‘ä»¬ç°åœ¨ä¸ºäº†å¾—åˆ°åŸæ¥çš„$F[i+j+k]$å’Œ$F[j+k]$ï¼Œç›´æ¥</p>
<script type="math/tex; mode=display">
\begin{array}{c}{F[j+k]=\frac{F[j+k]+F[j+i+k]}{2}} \\ {F[j+i+k]=\frac{F[j+k]-F[j+i+k]}{2}}\end{array}</script><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fwt</span><span class="params">(<span class="keyword">int</span> *f, <span class="keyword">int</span> g)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, k, m = <span class="number">1</span> &lt;&lt; (N - <span class="number">1</span>), x, y ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= m ; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= M ; j += (i &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt; i ; ++ k)&#123;</span><br><span class="line">                x = f[j + k], y = f[i + j + k] ;</span><br><span class="line">                f[j + k] = <span class="number">1l</span>l * (g ^ <span class="number">1</span> ? Inv2 : <span class="number">1</span>) * (x + y) % Mod ;</span><br><span class="line">                f[i + j + k] = <span class="number">1l</span>l * (g ^ <span class="number">1</span> ? Inv2 : <span class="number">1</span>) * (x + Mod - y) % Mod ;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯æ—¶é—´å¤æ‚åº¦å°±æ˜¯$n \log n$äº†ã€‚</p>
<h1 id="rm-FWT-åšor-andå·ç§¯"><a href="#rm-FWT-åšor-andå·ç§¯" class="headerlink" title="$\rm FWT$åšor/andå·ç§¯"></a>$\rm FWT$åšor/andå·ç§¯</h1><p>è‰¹ï¼ŒçœŸæ˜¯è¢«è¡€å‘äº†ã€‚</p>
<p>æ‰å‘ç°åŸæ¥FWTåšor/andå·ç§¯å°±æ˜¯è·ŸFMTä¸€ä¸ªé“ç†ï¼š</p>
<script type="math/tex; mode=display">
\boldsymbol{or}: F[i+j+k]+=F[j+k]\\\
\boldsymbol{and}: F[j+k]+=F[i+j+k]</script><p>ç„¶åé€†å˜æ¢å°±ç›´æ¥æŠŠåŠ å·æ”¹æˆå‡å·å°±å¥½äº†â€¦â€¦åŸå› å°±æ˜¯â€œä¸å–è¿™ä¸ªä¸œè¥¿â€ä¸€å®šæ˜¯â€œå–è¿™ä¸ªä¸œè¥¿â€çš„å­é›†ã€‚</p>
<p>ä½†æ˜¯å½“æ—¶æˆ‘è®¤çœŸå­¦ä¹ FMTçš„æ—¶å€™ï¼Œ<code>Rockdu</code>åšå®¢é‡Œé¢FMTçš„ä»£ç æ˜¯FWTçš„ï¼ï¼ï¼ç„¶åå†çœ‹åˆ«äººçš„ä»£ç æˆ‘å°±æ‡µOäº†å¥½ä¹…â€¦â€¦</p>
<p>çœŸæ˜¯zz</p>
<p>ä½†æ˜¯ç»ˆäºç†è§£äº†<code>JOHNKRAM</code>ç¥ä»™çš„è¯ï¼š</p>
<p><img src="https://s2.ax1x.com/2019/08/30/mjCdF1.jpg" alt></p>
<p>ä¸å¾—ä¸è¯´æ˜¯å¾ˆå½¢è±¡äº†ã€‚</p>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><ul>
<li>å…¶å®Lugouä¸Šçš„æ¿å­çš„å¤æ‚åº¦æ˜¯$2^n n$çš„ï¼Œæˆ‘ä¸€å¼€å§‹å°±è§‰å¾—æš´åŠ›æšä¸¾å­é›†æ²¡å•¥é—®é¢˜ï¼Œç»“æœæœ€åå‘ç°æšä¸¾å­é›†ä¸æ˜¯æšä¸¾$(n)_2$çš„å­é›†ï¼Œè€Œæ˜¯æšä¸¾$(2^n)_2$çš„å­é›†â€¦â€¦ç™½å­¦äº†ç™½å­¦äº†</li>
<li>å”‰ï¼Œæœ¬æ¥å°±æ˜¯åŠŸèƒ½ç›¸åŒçš„FWTå’ŒFMTï¼Œçœ‹é”™ä»£ç çœŸæ˜¯GG</li>
<li>å…¶å®åªæœ‰å¯¹ç§°å·®å·ç§¯éš¾ç†è§£ä¸€äº›ï¼Œäº¤å¹¶å·ç§¯éƒ½æ˜¯å¾ˆå½¢è±¡çš„ã€‚</li>
</ul>
]]></content>
      <tags>
        <tag>å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢(FWT)</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢&amp;å­é›†å·ç§¯</title>
    <url>/2019/08/26/fmt/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢(FMT)</strong>å¯ä»¥æ–¹ä¾¿åœ°è§£å†³<strong>å­é›†äº¤å·ç§¯</strong>å’Œ<strong>å­é›†å¹¶å·ç§¯</strong>ï¼Œå½¢å¼åŒ–åœ°è®²å°±æ˜¯æ±‚ä¸€ä¸ª$\rm C$ï¼š</p>
<script type="math/tex; mode=display">
c_i=\sum_{k\cup j=i} a_kb_j\\
c_i=\sum_{k\cap j=i} a_kb_j</script><p>è€Œ<strong>å¿«é€Ÿå­é›†å˜æ¢(FST)</strong>åˆ™æ˜¯åœ¨FMTåŸºç¡€ä¸Šçš„æ‰©å±•ï¼Œè§£å†³çš„ä¹Ÿæ˜¯å­é›†äº¤å·ç§¯ï¼Œä½†æ˜¯é™åˆ¶äº†<strong>çŠ¶æ€ä¸é‡å¤</strong>ï¼Œå³</p>
<script type="math/tex; mode=display">
c_i=\sum_{\substack{\begin{aligned}~k &\cup j=i\\ k &\cap j= \emptyset \end{aligned}}}a_kb_j</script><p>æ¢ä¸ªå†™æ³•ï¼š</p>
<script type="math/tex; mode=display">
c_s=\sum_{t\subseteq s}a_sb_{s-t}</script><p>åŒæ—¶ï¼Œä»¥ä¸Šä¸¤ç§å˜æ¢æ‰€æ¶‰åŠçš„äº¤é›†ã€å¹¶é›†å’Œå·®é›†çš„å¯¹è±¡éƒ½æ˜¯é›†åˆï¼ˆä¹Ÿå°±æ˜¯$c_i$çš„ä¸‹è§’æ ‡$i$æŒ‡ä»£çš„æ˜¯é›†åˆï¼‰ï¼Œå…¶äºŒè¿›åˆ¶è¡¨ç¤ºèƒ½æ›´å¥½åœ°å±•ç¤ºè¿™ä¸€ç‚¹ã€‚</p>
<a id="more"></a>
<h1 id="rm-FMT"><a href="#rm-FMT" class="headerlink" title="$\rm{FMT}$"></a>$\rm{FMT}$</h1><p>é¦–å…ˆæˆ‘ä»¬è€ƒè™‘ä¸€æ­¥çº¿æ€§å˜æ¢çš„å®è´¨ã€‚è€ƒè™‘FFTï¼Œå…¶æœ¬è´¨æ˜¯é€šè¿‡DFTä½¿å¾—æˆ‘ä»¬å¯ä»¥ç›´æ¥çº¿æ€§åœ°é€é¡¹ç›¸ä¹˜ï¼Œå³</p>
<script type="math/tex; mode=display">
\begin{aligned}
\rm {C} & =\rm{A*B}\\\
\Longrightarrow \rm{DFT(C)_i} & =\rm{DFT(A)_i\cdot DFT(B)_i}
\end{aligned}</script><p>é‚£ä¹ˆæˆ‘ä»¬åŒæ—¶ä¹Ÿå¸Œæœ›æ„é€ å‡ºä¸€ç§å˜æ¢ä½¿å¾—å¯ä»¥é€é¡¹ç›¸ä¹˜ã€‚</p>
<h2 id="1-å­é›†å¹¶å·ç§¯"><a href="#1-å­é›†å¹¶å·ç§¯" class="headerlink" title="$(1)$ å­é›†å¹¶å·ç§¯"></a>$(1)$ å­é›†å¹¶å·ç§¯</h2><p>ä¸å¦¨å…ˆæ‰©å¤§ä¸€ä¸‹èŒƒå›´ï¼Œå³è‹¥$A\cup B=C$ï¼Œåˆ™ä¸€å®šæœ‰$A\subseteq C$ä¸”$B \subseteq C$ï¼Œä½†æ˜¯åè¿‡æ¥ä¸ä¸€å®šã€‚</p>
<p>é‚£ä¹ˆå…ˆè€ƒè™‘$\rm MT$ï¼Œå³è€ƒè™‘ä¸€ç§å˜æ¢è€Œä¸æ€è€ƒå…¶å¤æ‚åº¦ã€‚æˆ‘ä»¬ä»¤</p>
<script type="math/tex; mode=display">
\rm MT(F)_i= \mathcal{\sum_{j\subseteq i} f_j}</script><p>åˆ™æœ‰</p>
<script type="math/tex; mode=display">
\rm{MT(F)_i\cdot MT(G)_i}=\mathcal{\sum _{j,k\subseteq i} f_j\cdot g_k}</script><p>è€Œå®é™…ä¸Šæˆ‘ä»¬æ±‚çš„æ˜¯</p>
<script type="math/tex; mode=display">
\rm{P_i}=\mathcal{\sum_{j\cup k=i}f_jg_k}</script><p>è€Œæˆ‘ä»¬å‘ç°</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum _{j\subseteq i}{\rm}_j &=\sum_{d \subseteq i} \sum_{j\cup k=d}f_jg_k\\\ &= \sum_{j,k\subseteq i} f_jg_k\\\ &= \rm{MT(P)_i}\end{aligned}</script><p>ä¹Ÿå°±æ˜¯è¯´æœ‰</p>
<script type="math/tex; mode=display">
\rm MT(F)_i\cdot MT(G)_i =MT(P)_i</script><p>äºæ˜¯å°±æ„é€ å‡ºäº†è¿™æ ·çš„çº¿æ€§å˜æ¢ï¼Œæœ¬è´¨å°±æ˜¯å­é›†å’Œã€‚</p>
<p>ä½†æ˜¯æ™®é€šçš„å­é›†å’Œæ˜¯$O(2^nn)$çš„ï¼Œä½†æ˜¯æˆ‘ä»¬çš„$n$æ˜¯$100000$çº§åˆ«ï¼Œæ‰€ä»¥è€ƒè™‘ä¸€ä¸ªdpä¸€æ ·çš„ä¸œè¥¿ã€‚å°±æ˜¯æˆ‘ä»¬æ¯æ¬¡æšä¸¾æ¯ä¸€ä½ï¼Œé‚£ä¹ˆè¿™ä¸€ä½ä¸º0å°±æ˜¯è¿™ä¸€ä½ä¸º1çš„å­é›†ï¼Œæ‰€ä»¥ç±»åŠ è¿›ç­”æ¡ˆã€‚äºæ˜¯è¿™æ ·çš„å¤æ‚åº¦å°±å˜æˆäº†$n\log n$</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//N = (1 &lt;&lt; M) - 1 ;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fmt_or</span><span class="params">(<span class="keyword">int</span> *f, <span class="keyword">int</span> g)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= M ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (j &gt;&gt; i &amp; <span class="number">1</span>) f[j] = (Mod + f[j] + <span class="number">1l</span>l * g * f[j ^ (<span class="number">1</span> &lt;&lt; i)]) % Mod ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-å­é›†äº¤å·ç§¯"><a href="#2-å­é›†äº¤å·ç§¯" class="headerlink" title="$(2)$ å­é›†äº¤å·ç§¯"></a>$(2)$ å­é›†äº¤å·ç§¯</h2><p>æˆ‘ä»¬å¯¹ç§°æ€è€ƒï¼Œå³ä»¤$\rm{MOT}$è¡¨ç¤ºäº¤å·ç§¯çš„å˜æ¢ï¼Œé‚£ä¹ˆåº”è¯¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\rm MOT(F)_i= \mathcal{\sum_{i\subseteq j} f_j}</script><p>é‚£ä¹ˆ</p>
<script type="math/tex; mode=display">
\rm{MOT(F)_i\cdot MOT(G)_i}=\mathcal{\sum _{i\subseteq j,i\subseteq k} f_j\cdot g_k}</script><p>æˆ‘ä»¬è¦æ±‚çš„æ˜¯</p>
<script type="math/tex; mode=display">
\rm{Q_i}=\mathcal{\sum_{j\cap k=i}f_jg_k}</script><p>åˆ™ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum _{i\subseteq j}{\rm}_j &=\sum_{i \subseteq d} \sum_{j\cap k=d}f_jg_k\\\ &= \sum_{i\subseteq j,i\subseteq k} f_jg_k\\\ &= {\rm{MOT(Q)}_i}\end{aligned}</script><p>äºæ˜¯å°±ç›´æ¥åç€æ±‚ä¸€éå³å¯ã€‚</p>
<p>ç„¶åè¿™ä¸œè¥¿å°±ä¹Ÿè¿˜æ˜¯ä¸ªdpï¼Œå¤æ‚åº¦$n \log n$</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fmt_and</span><span class="params">(<span class="keyword">int</span> *f, <span class="keyword">int</span> g)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = M ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">            <span class="keyword">if</span> (~j &gt;&gt; i &amp; <span class="number">1</span>) f[j] = (Mod + f[j] + <span class="number">1l</span>l * g * f[j | (<span class="number">1</span> &lt;&lt; i)]) % Mod ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-ä¼˜åŒ–ï¼šå¢é‡åˆ†æ²»"><a href="#3-ä¼˜åŒ–ï¼šå¢é‡åˆ†æ²»" class="headerlink" title="$(3)$ ä¼˜åŒ–ï¼šå¢é‡åˆ†æ²»"></a>$(3)$ ä¼˜åŒ–ï¼šå¢é‡åˆ†æ²»</h2><p>é˜…è¯»æç¤ºï¼šä¼˜ä½ ğŸçš„åŒ–ï¼Œè¿™å°±æ˜¯ä¸ªFWTã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä»¥å‰çš„ç¿»è½¦ç°åœºï¼š</p>
<hr>
<p>å®é™…ä¸Šæˆ‘è§‰å¾—ä¹Ÿæ²¡æ€ä¹ˆä¼˜åŒ–â€¦â€¦</p>
<p>æ‹¿å¹¶å·ç§¯ä¸¾ä¾‹ï¼Œå¤§ä½“ä¸Šå°±æ˜¯æˆ‘ä»¬è€ƒè™‘å¦‚æœå­˜åœ¨$i\subseteq j\subseteq k$ï¼Œæˆ‘ä»¬æœ´ç´ çš„è¦ç®—ä¸¤æ¬¡ï¼Œä½†å®é™…ä¸Šæˆ‘ä»¬å¯¹äºå‰åŠéƒ¨åˆ†çš„$k$åªéœ€è¦ç®—ä¸€æ¬¡ã€‚è¿™æ ·å®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬è€ƒè™‘æ¯æ¬¡åªè½¬ç§»å‰$n-i$ä¸ªå…ƒç´ ç›¸åŒçš„é›†åˆã€‚</p>
<p>(ä»¥ä¸‹å†…å®¹æ¥è‡ª<code>Rockdu</code>çš„$blog$)</p>
<p>äºæ˜¯æ¯å½“å¤šäº†ä¸€ä¸ªå…ƒç´ ï¼Œå³æˆ‘ä»¬è€ƒè™‘ç”±$i$å±‚è½¬ç§»åˆ°$i+1$å±‚ï¼Œå‘ç°åªæ˜¯å¤šäº†ä¸€ä¸ªå…ƒç´ çš„çŠ¶æ€â€”â€”è®¨è®ºä¸€ä¸‹è¿™ä¸ªå…ƒç´ å–ä¸å–ï¼Œå‘ç°è¿™ä¸ªå…ƒç´ ä¸å–ï¼Œç­”æ¡ˆå°±å’ŒåŸæ¥ä¸€æ ·ï¼Œå› ä¸ºå®ƒçš„å­é›†å’Œä¸å˜ï¼›å¦‚æœè¿™ä¸ªå…ƒç´ è¦å–ï¼Œé‚£ä¹ˆè¿™ä¸ªå…ƒç´ ä¸å–çš„æƒ…å†µæ˜¯å®ƒçš„å­é›†ï¼Œä¼šå¤šå‡ºè¿™ä¸ªå…ƒç´ ä¸å–çš„å­é›†å’Œã€‚æœ€ç»ˆæˆ‘ä»¬å‘ç°ï¼Œåˆ°ç¬¬$i$å±‚åªéœ€è¦æŠŠç¬¬$i$ä¸ªå…ƒç´ ä¸å–çš„çŠ¶æ€åŠ åˆ°ç¬¬$i$ä¸ªå…ƒç´ å–çš„çŠ¶æ€å°±å¯ä»¥äº†ã€‚</p>
<p>äºæ˜¯ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FMT</span><span class="params">(<span class="keyword">int</span> * A, <span class="keyword">int</span> n, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; (<span class="number">1</span> &lt;&lt; n); i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> p = i &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; (<span class="number">1</span> &lt;&lt; n); j += p)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; i; ++k)</span><br><span class="line">                (A[i + j + k] += A[j + k]) %= Mod ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸Šå»æ¯æ¬¡åªç”¨è®¡ç®—ä¸€åŠï¼Œä½†æ˜¯<code>JOHNKRAM</code>ç¥ä»™æ˜¯è¿™ä¹ˆè¯´çš„ï¼š</p>
<p><img src="https://s2.ax1x.com/2019/08/29/mbfpBq.png" alt></p>
<p>ä½ çœ‹ä»–é•¿å¾—å’ŒFFTçš„è´è¶æ“ä½œä¸€æ¯›ä¸€æ ·ï¼Œæ‰€ä»¥è¿˜æ˜¯$n\log n$çš„ã€‚</p>
<hr>
<p>= =å‡é…’å®³äººï¼Œå‡ä»£ç æ›´å®³äºº</p>
<h1 id="rm-FST"><a href="#rm-FST" class="headerlink" title="$\rm FST$"></a>$\rm FST$</h1><p><del>è¿™ä¸ªåå­—ä¸æ˜¯å¾ˆå‰åˆ©</del></p>
<p>è¿™ä¸œè¥¿å…¶å®ä¹Ÿä¸æ˜¯éè¦ç”¨$\rm FMT$æ¥åšï¼Œ$\rm FWT$ä¹Ÿå¯ä»¥ã€‚</p>
<p>ç„¶åå°±æ˜¯è€ƒè™‘åœ¨å·ç§¯çš„æ—¶å€™å¤šå¢åŠ ä¸€ç»´ï¼Œå³$f_{i,S}$è¡¨ç¤ºé›†åˆ$S$ä¸­æœ‰$i$ä¸ªå…ƒç´ ï¼Œäºæ˜¯å‘ç°åªæœ‰å½“å…ƒç´ ä¸ªæ•°ç›¸åŠ ç¬¦åˆæ—¶æ‰æ˜¯å¯¹çš„ã€‚</p>
<p>äºæ˜¯ä¸€å¼€å§‹å°†$f_{bct(s),s}$èµ‹å€¼ä¸º$f_s$ï¼Œå…¶ä¸­$bct(s)=\rm bitcount(s)$ã€‚ç„¶åå¯¹æ¯ä¸€ä¸ª$f_i$åˆ†åˆ«åš$\rm FMT$ï¼Œä¹‹åæŒ‰ä½ä¹˜çš„æ—¶å€™éœ€è¦</p>
<script type="math/tex; mode=display">
P_{i, S}=\sum_{i=0}^{i} f_{j, S} * g_{i-j, S}</script><p>è¾“å‡ºçš„æ—¶å€™åªè¾“å‡º$P_{bct(s),s}$å³å¯ã€‚</p>
<p>æ¿å­é¢˜æ˜¯<a href="https://loj.ac/problem/152" target="_blank" rel="noopener"><code>LOJ #152</code></a>ï¼Œç•¥å¾®å¡å¸¸ï¼Œè¢«é€¼æ— å¥ˆå†™äº†ç¥å¥‡çš„å–æ¨¡ä¼˜åŒ–233</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 21</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 1056701</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 1000000009</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> I inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; <span class="keyword">int</span> bc[MAXM] ;</span><br><span class="line"><span class="keyword">int</span> N, M ; LL A[MAXN][MAXM], B[MAXN][MAXM], C[MAXN][MAXM] ;</span><br><span class="line"></span><br><span class="line"><span class="function">I <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>; <span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">I <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(LL &amp;x)</span> </span>&#123; x += x &gt;&gt; <span class="number">63</span> &amp; Mod ; &#125;</span><br><span class="line"><span class="function">I <span class="keyword">void</span> <span class="title">Ifmt</span><span class="params">(LL *f)</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= M ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (j &gt;&gt; i &amp; <span class="number">1</span>) reduce(f[j] -= f[j ^ <span class="number">1</span> &lt;&lt; i]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">I <span class="keyword">void</span> <span class="title">fmt</span><span class="params">(LL *f)</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= M ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (j &gt;&gt; i &amp; <span class="number">1</span>) reduce(f[j] += f[j ^ <span class="number">1</span> &lt;&lt; i] - Mod) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ; M = (<span class="number">1</span> &lt;&lt; N) - <span class="number">1</span> ; <span class="keyword">register</span> <span class="keyword">int</span> i, j, s ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) bc[i] = bc[i - (i &amp; -i)] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= M ; ++ i) A[bc[i]][i] = read() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= M ; ++ i) B[bc[i]][i] = read() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) fmt(A[i]), fmt(B[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= i ; ++ j)</span><br><span class="line">            <span class="keyword">for</span> (s = <span class="number">0</span> ; s &lt;= M ; ++ s)</span><br><span class="line">                (C[i][s] += A[j][s] * B[i - j][s]) %= Mod ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) Ifmt(C[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= M ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d "</span>, C[bc[i]][i]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>å®é™…ä¸Šå›½é™…ä¸Šæ ¹æœ¬ä¸é€šç”¨FMTå’ŒFSTè¿™ä¸¤ä¸ªç®€å†™ï¼ˆç”šè‡³å¯èƒ½å›½å†…ä¹Ÿæ²¡å‡ ä¸ªäººç”¨FSTæŒ‡ä»£â€å­é›†å·ç§¯â€œï¼‰,äºæ˜¯å°±åªèƒ½233äº†</p>
<p>updï¼šæœ‰äº›è¯´æ˜å‚è§FWTçš„è®²è§£ã€‚</p>
<h2 id="rm-Referance"><a href="#rm-Referance" class="headerlink" title="$\rm Referance$"></a>$\rm Referance$</h2><ul>
<li>$[1]$ :<code>Dance of Faith</code>çš„$blog$ <a href="https://www.cnblogs.com/Dance-Of-Faith/p/8818211.html" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li>
<li>$[2]$ :<code>Rockdu</code>çš„$blog$ <a href="http://blog.leanote.com/post/rockdu/TX20" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¥‡æ€ªçš„å˜æ¢</category>
      </categories>
      <tags>
        <tag>å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢(FMT)</tag>
        <tag>å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢(FWT)</tag>
        <tag>å¿«é€Ÿå­é›†å˜æ¢(FST)</tag>
      </tags>
  </entry>
  <entry>
    <title>éšæƒ³å Â· ç¹æ˜Ÿ</title>
    <url>/2019/08/20/10/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>upd2 : æ—¶æœºä¾æ—§ä¸æˆç†Ÿï¼Œä½†çå¼€äº†çœ¼ç›ï¼Œå‘ç°åŸæ¥ä¸–ç•Œæ˜¯è¿™æ ·çš„ï¼Œå†³å®šæ…¢æ…¢ä½“ä¼šä»€ä¹ˆæ˜¯å–„æ¶ã€ä»€ä¹ˆæ˜¯æ˜æš—ã€‚ç»ˆäºåšå®šäº†ä¸å†å½“è¡Œå°¸èµ°è‚‰çš„å†³å¿ƒï¼Œè¦æˆä¸ºçœŸæ­£ç‹¬ç«‹ã€æœ‰è¡€æœ‰è‚‰çš„äººã€‚</p>
<p>upd1 : æ—¶æœºå°šä¸æˆç†Ÿï¼ŒåŒçœ¸æ˜¯ççš„ï¼Œçœ‹ä¸åˆ°ä¸€ä¸å…‰äº®ï¼Œåªæ˜¯ä¸€å…·åªä¼šéšæ³¢é€æµçš„çš®è‚‰ç½¢äº†ã€‚</p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>éšæƒ³/ä¸‹ä¸‹ç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘CF Educational Round70 é¢˜è§£</title>
    <url>/2019/08/19/Er70/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><code>Educational Round</code>ï¼Œé¡¾åæ€ä¹‰ï¼Œ<strong>æ•™è‚²åšäººä¸“åœº</strong>ã€‚</p>
<p>è¿™åœºæ¯”èµ›å·§å¦™åœ°æ•™è‚²äº†ä¸€ä¸ªåˆå‡ºèŒ…åºçš„èŒæ–°Oierï¼ˆæˆ‘ï¼‰<strong>åˆ°åº•è¯¥å¦‚ä½•åšäºº</strong>ï¼ˆå“­æ™•ï¼‰ã€‚</p>
<p>æ¯”èµ›é“¾æ¥ï¼š<a href="https://codeforces.com/contest/1202" target="_blank" rel="noopener">æˆ³</a></p>
 <a id="more"></a>
<h1 id="A"><a href="#A" class="headerlink" title="$~A$"></a>$~A$</h1><p>é¢˜æ„ï¼šç»™ä½ ä¸¤ä¸ªäºŒè¿›åˆ¶å­—ç¬¦ä¸²$x$å’Œ$y$ï¼Œå°†$y$å·¦ç§»$k$ä½ï¼Œå†ä¸$x$ç›¸åŠ ï¼Œå¾—åˆ°å­—ç¬¦ä¸²$s_k$ï¼Œæœ€åå°†å…¶åè½¬å¾—åˆ°$res_k$ã€‚æ±‚å½“$res_k$å­—å…¸åºæœ€å°æ—¶çš„$k$ã€‚</p>
<hr>
<p>è¯¡å¼‚çš„è´ªå¿ƒâ€¦â€¦</p>
<p>å®ä¸ç›¸ç’æˆ‘æƒ³äº†æ•´æ•´åŠä¸ªå¤šå°æ—¶ï¼ˆä¸­é—´ä¼´æœ‰é—´æ­‡æ€§èµ°ç¥ï¼‰â€¦â€¦</p>
<p>å…¶å®å°±æ˜¯è½¬åŒ–çš„æ€æƒ³ï¼Œæ±‚åä¸²çš„å­—å…¸åºæœ€å°ï¼Œå°±æ˜¯è¦æŠŠæ­£ä¸²é‡Œé¢çš„ä½ä½1ä»¬å°½é‡æ¶ˆæ‰ã€‚åˆå› ä¸ºé¢˜ç›®é‡Œé¢é™åˆ¶äº†$x&gt;y$ï¼Œæ‰€ä»¥ä¸€å®šå­˜åœ¨$x$çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­è‡³å°‘ä¸€ä¸ª$1$æ¯”$y$çš„æœ€ä½ä½$1$é å·¦ã€‚è€ƒè™‘è´ªå¿ƒçš„æ€æƒ³ï¼Œ$x$è¢«æ¶ˆæ‰çš„$1$è¶Šé å³ï¼Œåä¸²å­—å…¸åºå°±è¶Šå°ã€‚æ‰€ä»¥è¯´æˆ‘ä»¬è¦æ‰¾çš„å°±æ˜¯$\boldsymbol{x}$<strong>ä¸­èƒ½è¢«$\boldsymbol{y}$æ¶ˆæ‰çš„æœ€é å³çš„é‚£ä¸ª$\boldsymbol{1}$çš„ä½ç½®</strong>ã€‚</p>
<p>äºæ˜¯æ‰«ä¸€éã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line"><span class="keyword">while</span> (T --)&#123;</span><br><span class="line">	<span class="keyword">int</span> i, posa = <span class="number">0</span> , posb = <span class="number">0</span> ;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, A + <span class="number">1</span>) ;<span class="built_in">scanf</span>(<span class="string">"%s"</span>, B + <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">int</span> La = <span class="built_in">strlen</span>(A + <span class="number">1</span>), Lb = <span class="built_in">strlen</span>(B + <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= Lb ; ++ i)</span><br><span class="line">	<span class="keyword">if</span> (B[i] == <span class="string">'1'</span>) posb = i ; posb = Lb - posb + <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= La ; ++ i)</span><br><span class="line">	<span class="keyword">if</span> (A[i] == <span class="string">'1'</span>) <span class="keyword">if</span> (La - i + <span class="number">1</span> &gt;= posb) posa = La - i + <span class="number">1</span> ;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; posa &lt;&lt; " " &lt;&lt; posb &lt;&lt; endl ;</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, posa - posb) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="it-B"><a href="#it-B" class="headerlink" title="$\it{B}$"></a>$\it{B}$</h1><p>é¢˜æ„ï¼šç»™å®šä¸€ä¸ªè®¡æ•°å™¨$(x-y)$ï¼Œå¯¹äºæ¯æ¬¡å¼•è¿›çš„å¸¸æ•°$z$ï¼Œå¯ä»¥é€‰æ‹©$\text{((+=x)mod=10)}$ æˆ–è€…$\text{((+=y)mod=10)}$ï¼ˆ$\text{mod=}$å°±æ˜¯<code>%=</code>ï¼‰ç„¶åæŠŠç»“æœå†ä¸¢åˆ°è¿ç®—é‡Œé¢ç»§ç»­è¿ç®—ã€‚ç°åœ¨ç»™å®šä¸€ä¸ªæ®‹ç¼ºçš„$z$åºåˆ—ï¼ˆçœç•¥äº†ä¸­é—´çš„æŸäº›ç»“æœï¼‰ï¼Œæ±‚$0\text{~}9$ä¸¤ä¸¤ç»„åˆçš„è®¡æ•°å™¨åˆ†åˆ«è‡³å°‘éœ€è¦å¤šå°‘æ­¥æ‰èƒ½è¿˜åŸè¿™ä¸ªä¸²çš„è¿ç®—ã€‚</p>
<hr>
<p>è‰ï¼Œæˆ‘è¿™æœ€çŸ­è·¯åˆæ˜¯ç™½å­¦äº†ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæ˜¾ç„¶çš„$10^4\cdot \Omega(1)$çš„é¢„å¤„ç†ï¼Œå°±æ˜¯ä»¤$(i-j)$ä¸ºè®¡æ•°å™¨ï¼Œä»$k$åˆ°$o$çš„æœ€çŸ­è·ç¦»ï¼Œè¿™ç©æ„å„¿æ˜¾ç„¶å¯ä»¥BFSï¼Œç”±äºæ˜¯å¯¹$10$å–æ¨¡æ‰€ä»¥å¤§æ¦‚å¾ªç¯èŠ‚ä¹Ÿåœ¨ä¸‹ç•Œä¸º$\Theta(1)$å·¦å³é…±ç´«ã€‚ä¹‹åå¯¹äºè¯¢é—®ç›´æ¥æš´åŠ›æšä¸¾å°±å¥½äº†ï¼Œå¤æ‚åº¦å¤§æ¦‚æ˜¯$100\cdot O(|S|)\leq 100\times 2,000,000=2e8$â€¦â€¦æ¢¦æƒ³ç®—æ³•â€¦â€¦ä½†å…¶å®æ˜¾ç„¶é‚£ä¸ª$100$å¯ä»¥åªåš$50+$çš„æ ·å­ï¼Œæ¯•ç«Ÿæ˜¯å¯¹ç§°çš„â€¦â€¦ä¸è¿‡è¿˜æ˜¯æ¢¦æƒ³ç®—æ³•233</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, k, o ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">10</span> ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; <span class="number">10</span> ; ++ j)</span><br><span class="line">            <span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt; <span class="number">10</span> ; ++ k)</span><br><span class="line">                <span class="keyword">for</span> (o = <span class="number">0</span> ; o &lt; <span class="number">10</span> ; ++ o)&#123;</span><br><span class="line">                    <span class="keyword">bool</span> mark[<span class="number">200</span>] ;</span><br><span class="line">                    dis[i][j][k][o] = <span class="number">-1</span> ;</span><br><span class="line">                    <span class="built_in">memset</span>(mark, <span class="number">0</span>, <span class="keyword">sizeof</span>(mark)) ;</span><br><span class="line">                    q.push((wk)&#123;k, <span class="number">0</span>&#125;) ;</span><br><span class="line">                    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">                        wk now = q.front() ; q.pop() ;</span><br><span class="line">                        <span class="keyword">if</span> (now.num == o &amp;&amp; now.cnt)&#123;</span><br><span class="line">                            dis[i][j][k][o] = now.cnt ; <span class="keyword">break</span> ;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (mark[now.num]) <span class="keyword">continue</span> ;mark[now.num] = <span class="number">1</span> ;</span><br><span class="line">                        q.push((wk)&#123; (now.num + i) % <span class="number">10</span>, now.cnt + <span class="number">1</span>&#125;) ;</span><br><span class="line">                        q.push((wk)&#123; (now.num + j) % <span class="number">10</span>, now.cnt + <span class="number">1</span>&#125;) ;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">while</span> (!q.empty()) q.pop() ;</span><br><span class="line">                &#125;</span><br><span class="line">    <span class="comment">/*for (i = 0 ; i &lt; 10 ; ++ i)</span></span><br><span class="line"><span class="comment">        for (j = 0 ; j &lt; 10 ; ++ j)</span></span><br><span class="line"><span class="comment">            for (k = 0 ; k &lt; 10 ; ++ k)</span></span><br><span class="line"><span class="comment">                for (o = 0 ; o &lt; 10 ; ++ o)</span></span><br><span class="line"><span class="comment">                    cout &lt;&lt; dis[i][j][k][o] &lt;&lt; " " ;*/</span></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; (In + <span class="number">1</span>) ; <span class="keyword">int</span> ans = <span class="number">0</span>, N = <span class="built_in">strlen</span>(In + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) base[i] = In[i] - <span class="string">'0'</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">10</span> ; ++ i, <span class="built_in">puts</span>(<span class="string">""</span>))</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; <span class="number">10</span> ; ++ j)&#123; <span class="comment">/*qwqwq*/</span></span><br><span class="line">            <span class="keyword">for</span> (ans = <span class="number">0</span>, k = <span class="number">2</span> ; k &lt;= N ; ++ k)&#123;</span><br><span class="line">                <span class="keyword">if</span> (dis[i][j][base[k - <span class="number">1</span>]][base[k]] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"-1 "</span>), ans = <span class="number">-1</span> ; <span class="keyword">break</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">                ans += dis[i][j][base[k - <span class="number">1</span>]][base[k]] ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ans &gt; <span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans - N + <span class="number">1</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ï¼ˆä»£ç æ¸²æŸ“ä¼šè‡ªåŠ¨æŠŠ<code>tab</code>æ˜ å°„æˆ<code>force-tab</code>æˆ‘ä¹Ÿæ‡’å¾—ç®¡äº†= =ï¼‰</p>
<h1 id="mathcal-C"><a href="#mathcal-C" class="headerlink" title="$\mathcal{C}$"></a>$\mathcal{C}$</h1><p>é¢˜æ„ï¼šç»™å®šä¸€æ®µæŸä¸ªæœºå™¨äººçš„æ“ä½œåºåˆ—<code>WSAD</code>ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œæ±‚æœ€ç»ˆæœºå™¨äººçš„æœ€å°æ´»åŠ¨åŒºåŸŸé¢ç§¯ã€‚</p>
<hr>
<p>é¦–å…ˆæ˜¾ç„¶æ˜¯<strong>è¡Œåˆ—æ— å…³</strong>çš„ï¼Œæ‰€ä»¥åˆ†å¼€è€ƒè™‘ï¼›æ¥ç€å‘ç°æœ€ä¼˜ç­–ç•¥è‚¯å®šæ˜¯è®©æŸä¸€æ­¥ç›¸å½“äºæ²¡èµ°ï¼Œä½†æ˜¯å‡è®¾$x_{min}$å’Œ$x_{max}$å‡åœ¨è¿™æ¬¡æ”¹åŠ¨æ“ä½œçš„åé¢ï¼Œé‚£ä¹ˆç¼©å°$x_{max}$çš„æ—¶å€™ä¹Ÿä¼šç¼©å°$x_{min}$ï¼Œç›¸å½“äºæ²¡ç¼©â€”â€”æ‰€ä»¥åº”æ‰¾åˆ°ä¸€ä¸ªç•Œç‚¹ï¼Œæ‰€æœ‰çš„æœ€å¤§å€¼éƒ½åœ¨å·¦/å³è¾¹ï¼Œå¯¹åº”çš„æ‰€æœ‰æœ€å°å€¼éƒ½åœ¨å³/å·¦è¾¹ã€‚</p>
<p>ç”±äºæ¯ä¸€æ­¥æ“ä½œéƒ½æ˜¯æœ‰åæ•ˆæ€§çš„ï¼Œæ‰€ä»¥è€ƒè™‘ç›´æ¥å‰ç¼€å’Œä¸Šæ±‚å‡º$min$å’Œ$max$å°±å¥½ã€‚</p>
<p>ä½†æ˜¯è€ƒè™‘æ— è®ºæ€ä¹ˆç§»åŠ¨ï¼Œéƒ½ä¸èƒ½è¶Šè¿‡é¢„å¤„ç†å‡ºæ¥çš„$x_{min}$ã€$x_{max}$è¿™ä¸ªç•Œï¼ˆå¦åˆ™ä¼šå‡ºç°è¶Šè´ªè¶Šå¤§ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´å‡è®¾æœ‰ä¸€ä¸ª$x_{max}$ï¼Œæ¥ç€è¿‡äº†ä¸€ä¼šå„¿æœ‰ä¸€ä¸ª$x_{min}$ï¼Œä¸ºäº†â€œæ‹”é«˜â€$x_{min}$æˆ‘ä»¬å¿…é¡»è¦æ·»åŠ ä¸€ä¸ª$W$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»è¦ä¿è¯ä»»ä½•æ—¶åˆ»ä¸ä¼šå‡ºç°$x_{max}$åœ¨æ”¾ä¸Šä¸€ä¸ª$W$ä¹‹åè¶Šç•Œçš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´$x_{min}$å’Œ$x_{max}$å‡ºç°çš„ä½ç½®ä¹‹é—´å¿…é¡»è¦ä¸€ä¸ª$S$æ‰èƒ½ç”¨æ¥æŠµæ¶ˆæ‰æˆ‘ä»¬$W$ï¼Œéœ€è¦ç‰¹åˆ¤ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; LL ans ; </span><br><span class="line"><span class="keyword">int</span> fhm, fhn, fwm, fwn, pos[<span class="number">2</span>][<span class="number">5</span>], i ; </span><br><span class="line"><span class="keyword">int</span> T, N, Sw[MAXN], Sh[MAXN] ; <span class="keyword">char</span> S[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ; </span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        fhm = fwm = -Inf, fhn = fwn = Inf ;  </span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, S + <span class="number">1</span>), N = <span class="built_in">strlen</span>(S + <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">            Sh[i] = Sh[i - <span class="number">1</span>], Sw[i] = Sw[i - <span class="number">1</span>] ;</span><br><span class="line">            <span class="keyword">if</span> (S[i] == <span class="string">'W'</span>) Sh[i] = Sh[i - <span class="number">1</span>] + <span class="number">1</span> ; </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (S[i] == <span class="string">'S'</span>) Sh[i] = Sh[i - <span class="number">1</span>] - <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (S[i] == <span class="string">'D'</span>) Sw[i] = Sw[i - <span class="number">1</span>] + <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (S[i] == <span class="string">'A'</span>) Sw[i] = Sw[i - <span class="number">1</span>] - <span class="number">1</span> ;</span><br><span class="line">        &#125;<span class="comment">//å‰ç¼€å’Œ : w x h </span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) fwm = max(Sw[i], fwm), fwn = min(Sw[i], fwn) ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) fhm = max(Sh[i], fhm), fhn = min(Sh[i], fhn) ; </span><br><span class="line">        <span class="keyword">for</span> (i = N ; ~i ; -- i) <span class="keyword">if</span> (Sh[i] == fhn) &#123; pos[<span class="number">0</span>][<span class="number">4</span>] = i ; <span class="keyword">break</span> ; &#125; <span class="comment">//last_min h</span></span><br><span class="line">        <span class="keyword">for</span> (i = N ; ~i ; -- i) <span class="keyword">if</span> (Sw[i] == fwn) &#123; pos[<span class="number">1</span>][<span class="number">4</span>] = i ; <span class="keyword">break</span> ; &#125; <span class="comment">//last_min h</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) <span class="keyword">if</span> (Sh[i] == fhm) &#123; pos[<span class="number">0</span>][<span class="number">1</span>] = i ; <span class="keyword">break</span> ; &#125;  <span class="comment">//first_max h</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) <span class="keyword">if</span> (Sw[i] == fwm) &#123; pos[<span class="number">1</span>][<span class="number">1</span>] = i ; <span class="keyword">break</span> ; &#125;  <span class="comment">//first_max w</span></span><br><span class="line">        <span class="keyword">for</span> (i = N ; ~i ; -- i) <span class="keyword">if</span> (Sh[i] == fhm) &#123; pos[<span class="number">0</span>][<span class="number">3</span>] = i ; <span class="keyword">break</span> ; &#125; <span class="comment">//last_max h</span></span><br><span class="line">        <span class="keyword">for</span> (i = N ; ~i ; -- i) <span class="keyword">if</span> (Sw[i] == fwm) &#123; pos[<span class="number">1</span>][<span class="number">3</span>] = i ; <span class="keyword">break</span> ; &#125; <span class="comment">//last_max h</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) <span class="keyword">if</span> (Sh[i] == fhn) &#123; pos[<span class="number">0</span>][<span class="number">2</span>] = i ; <span class="keyword">break</span> ; &#125;  <span class="comment">//first_min h    </span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) <span class="keyword">if</span> (Sw[i] == fwn) &#123; pos[<span class="number">1</span>][<span class="number">2</span>] = i ; <span class="keyword">break</span> ; &#125;  <span class="comment">//first_min w</span></span><br><span class="line">        ans = <span class="number">1l</span>l * (fwn - fwm - <span class="number">1</span>) * (fhn - fhm - <span class="number">1</span>) ; <span class="comment">//cout &lt;&lt; ans &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">if</span> (pos[<span class="number">0</span>][<span class="number">3</span>] &lt; pos[<span class="number">0</span>][<span class="number">2</span>] &amp;&amp; Sh[pos[<span class="number">0</span>][<span class="number">3</span>]] - Sh[pos[<span class="number">0</span>][<span class="number">2</span>]] &gt; <span class="number">1</span>) </span><br><span class="line">            ans = min(ans, <span class="number">1l</span>l * (fhm - fhn) * (fwm - fwn + <span class="number">1</span>)) ;</span><br><span class="line">        <span class="keyword">if</span> (pos[<span class="number">1</span>][<span class="number">3</span>] &lt; pos[<span class="number">1</span>][<span class="number">2</span>] &amp;&amp; Sw[pos[<span class="number">1</span>][<span class="number">3</span>]] - Sw[pos[<span class="number">1</span>][<span class="number">2</span>]] &gt; <span class="number">1</span>) </span><br><span class="line">            ans = min(ans, <span class="number">1l</span>l * (fhm - fhn + <span class="number">1</span>) * (fwm - fwn)) ;</span><br><span class="line">        <span class="keyword">if</span> (pos[<span class="number">0</span>][<span class="number">4</span>] &lt; pos[<span class="number">0</span>][<span class="number">1</span>] &amp;&amp; Sh[pos[<span class="number">0</span>][<span class="number">4</span>]] - Sh[pos[<span class="number">0</span>][<span class="number">1</span>]] &lt; <span class="number">-1</span>) </span><br><span class="line">            ans = min(ans, <span class="number">1l</span>l * (fhm - fhn) * (fwm - fwn + <span class="number">1</span>)) ;</span><br><span class="line">        <span class="keyword">if</span> (pos[<span class="number">1</span>][<span class="number">4</span>] &lt; pos[<span class="number">1</span>][<span class="number">1</span>] &amp;&amp; Sw[pos[<span class="number">1</span>][<span class="number">4</span>]] - Sw[pos[<span class="number">1</span>][<span class="number">1</span>]] &lt; <span class="number">-1</span>) </span><br><span class="line">            ans = min(ans, <span class="number">1l</span>l * (fhm - fhn + <span class="number">1</span>) * (fwm - fwn)) ;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">        pos[<span class="number">0</span>][<span class="number">1</span>] = pos[<span class="number">1</span>][<span class="number">1</span>] = pos[<span class="number">0</span>][<span class="number">2</span>] = pos[<span class="number">1</span>][<span class="number">2</span>] = Inf ;</span><br><span class="line">        pos[<span class="number">0</span>][<span class="number">3</span>] = pos[<span class="number">1</span>][<span class="number">3</span>] = pos[<span class="number">0</span>][<span class="number">4</span>] = pos[<span class="number">1</span>][<span class="number">4</span>] = -Inf ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>emmmmå¥½åƒå½“æ—¶<code>debug</code>äº†å¥½ä¹…çš„æ ·å­ã€‚</p>
<h1 id="rm-D"><a href="#rm-D" class="headerlink" title="$\rm{D}$"></a>$\rm{D}$</h1><p>é¢˜æ„ï¼šæ„é€ ä¸€ä¸ªå«æœ‰<code>1</code>/<code>3</code>/<code>7</code>çš„ä¸²ï¼Œä½¿å¾—å­åºåˆ—<code>1337</code>çš„æ•°é‡æ°å¥½ä¸º$x$ã€‚</p>
<hr>
<p>è¿™ç‰¹ä¹ˆå°±æ˜¯ä¸€ä¸ªæ™ºå•†é¢˜ã€‚å°±æ˜¯è€ƒè™‘ä¸€ä¸ªæœ€ç®€å•çš„æ„é€ <code>133..3337</code>è¿™ç§ï¼Œä½†æ˜¯ä¸æ˜¯æ¯ä¸€ä¸ª$x$éƒ½å¯ä»¥è¡¨ç¤ºæˆ$\frac{p(p-1)}{2}$è¿™ç§å½¢å¼çš„â€¦â€¦æ‰€ä»¥è€ƒè™‘æ‰¾å‡ºæœ€å¤§çš„$p~\rm{s.t.}$ $p(p-1)\leq 2x$ï¼Œç„¶åæ‹¼å‘½åœ°å‘ç¬¬ä¸€ç»„<code>33</code>åé¢æ·»åŠ <code>7</code>å°±å¥½äº†ã€‚è¿™æ ·æ€»é•¿åº¦æ˜¯ä¸Šé™æ˜¯$2\sqrt x$çš„ï¼ŒæŒºç¨³ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">int</span> p = <span class="built_in">sqrt</span>(<span class="number">2</span>*N);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = p ; i &lt;= <span class="number">2</span>*N ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i * (i - <span class="number">1</span>) &gt; <span class="number">2</span> * N) <span class="keyword">break</span> ;</span><br><span class="line">            L1 = i * (i - <span class="number">1</span>) / <span class="number">2</span>, L2 = N - L1, L1 = i ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"133"</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= L2 ; ++ i) <span class="built_in">putchar</span>(<span class="string">'7'</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= L1 - <span class="number">2</span> ; ++ i) <span class="built_in">putchar</span>(<span class="string">'3'</span>) ;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"7\n"</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="mathbb-E"><a href="#mathbb-E" class="headerlink" title="$\mathbb{E}$"></a>$\mathbb{E}$</h1><p>é¢˜æ„ï¼šç»™å®š$N~(\leq 1e5)$ä¸ªæ¨¡æ¿ä¸²$s_i$å’Œä¸€ä¸ªæ–‡æœ¬ä¸²$T$ï¼Œæ±‚æ‰€æœ‰çš„$s_i+s_j~(i\not=j)$åœ¨$T$ä¸­å‡ºç°çš„æ¬¡æ•°ä¹‹å’Œã€‚</p>
<hr>
<p>å—¯ï¼Œé¡ºå¸¦å¤ä¹ äº†ä¸€ä¸‹$AC$è‡ªåŠ¨æœºã€‚</p>
<p>æ€è·¯å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯å»ºä¿©$AC$è‡ªåŠ¨æœºï¼Œä¸€ä¸ªè·‘æ­£ä¸²ï¼Œä¸€ä¸ªè·‘åä¸²ï¼Œç„¶åæšä¸¾æ¯ä¸ªåˆæ³•çš„iä½œä¸ºä¸­é—´çš„ç»“åˆä½ç‚¹ï¼Œä¹˜æ³•åŸç†å°±å¥½äº†â€¦â€¦ä½†å…¶å®è¿™ç§ç»“è®ºèƒ½è½»æ˜“å¾—å‡ºè¿˜æ˜¯å»ºç«‹åœ¨$AC$è‡ªåŠ¨æœºæŒæ¡ååˆ†æ‰å®çš„åŸºç¡€ä¸Šå•Šã€‚</p>
<p>å“¦å¯¹ï¼Œä¼¼ä¹å¯¹äºACè‡ªåŠ¨æœºçš„é¢˜ç›®ï¼Œæ ‘å½¢dpæ‰æ˜¯æ­£ç¡®çš„æ‰“å¼€æ–¹å¼ã€‚æ¯æ¬¡é‡æ–°è·³failæ ¹æœ¬åƒä¸æ¶ˆã€‚ã€‚ï¼ˆ<code>CF</code>çœŸçš„æœ‰æ•°æ®å»å¡è¿™ä¸œè¥¿ï¼Œ<code>aaa..aa</code>è¿™ç§â€¦â€¦ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> S[MAXN], In[MAXN] ; <span class="keyword">int</span> N ; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ACm</span>&#123;</span></span><br><span class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ; <span class="keyword">int</span> cnt ;</span><br><span class="line">	<span class="keyword">int</span> tr[MAXN][<span class="number">27</span>], res[MAXN] ;</span><br><span class="line">	<span class="keyword">int</span> fail[MAXN], ans[MAXN], e[MAXN] ; </span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> v(x) tr[rt][x]</span></span><br><span class="line"> 	<span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> Id)</span></span>&#123;	</span><br><span class="line">		<span class="keyword">int</span> i, j = <span class="built_in">strlen</span>(s), k, rt = <span class="number">0</span> ; </span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; j ; ++ i)&#123;</span><br><span class="line">			k = s[i] - <span class="string">'a'</span> ;</span><br><span class="line">			<span class="keyword">if</span> (!v(k)) v(k) = ++ cnt ; </span><br><span class="line">			rt = v(k) ;</span><br><span class="line">		&#125;</span><br><span class="line">		e[rt] ++ ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i, rt = <span class="number">0</span> ; </span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i) <span class="keyword">if</span> (v(i)) q.push(v(i)) ;</span><br><span class="line">		<span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">			rt = q.front(), q.pop() ;</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)&#123;</span><br><span class="line">				<span class="keyword">if</span> (!v(i)) v(i) = tr[fail[rt]][i] ; </span><br><span class="line">				<span class="keyword">else</span> fail[v(i)] = tr[fail[rt]][i], q.push(v(i)) ;</span><br><span class="line"><span class="comment">//				if (e[fail[v(i)]]) last[v(i)] = fail[v(i)] ; else last[v(i)] = last[fail[v(i)]] ;</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="comment">/*</span></span><br><span class="line"><span class="comment">	void work(char *s)&#123;</span></span><br><span class="line"><span class="comment">		int i, j = strlen(s), p, rt = 0 ; </span></span><br><span class="line"><span class="comment">		for (i = 0 ; i &lt; j ; ++ i)&#123;</span></span><br><span class="line"><span class="comment">			rt = v(s[i] - 'a'), p = rt ; </span></span><br><span class="line"><span class="comment">			while(p) res[i] += e[p], p = fail[p] ;</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (!rt) <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">		<span class="keyword">if</span> (res[rt] != <span class="number">-1</span>) <span class="keyword">return</span> res[rt] ;</span><br><span class="line">		<span class="keyword">return</span> res[rt] = e[rt] + dfs(fail[rt]) ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">		<span class="built_in">memset</span>(res, <span class="number">-1</span>, <span class="keyword">sizeof</span>(res)) ;</span><br><span class="line">		<span class="keyword">int</span> i, j = <span class="built_in">strlen</span>(s), p, rt = <span class="number">0</span> ; </span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; j ; ++ i) rt = v(s[i] - <span class="string">'a'</span>), ans[i] = dfs(rt) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;P, Q ; LL ans ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; S &gt;&gt; N ; <span class="keyword">int</span> i, j ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, In), P.insert(In, i) ; </span><br><span class="line">		j = <span class="built_in">strlen</span>(In), reverse(In, In + j), Q.insert(In, i) ;</span><br><span class="line">	&#125;</span><br><span class="line">	P.build(), Q.build() ; j = <span class="built_in">strlen</span>(S) ;</span><br><span class="line">	P.work(S), j = <span class="built_in">strlen</span>(S) ; reverse(S, S + j) ; Q.work(S) ;</span><br><span class="line"><span class="comment">//	for (i = 0 ; i &lt; j ; ++ i) cout &lt;&lt; P.res[i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line"><span class="comment">//	for (i = 0 ; i &lt; j ; ++ i) cout &lt;&lt; Q.res[i] &lt;&lt; " " ;</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; j ; ++ i) ans += <span class="number">1l</span>l * P.ans[i] * Q.ans[j - <span class="number">2</span> - i] ;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="mathfrak-F"><a href="#mathfrak-F" class="headerlink" title="$\mathfrak{F}$"></a>$\mathfrak{F}$</h1><p>é¢˜æ„ï¼šç»™å®šå¤§å†™å­—æ¯$A$å’Œ$B$çš„æ•°é‡ï¼Œæ±‚å¯ä»¥ç»„æˆå¤šå°‘ç§ä¸åŒçš„æœ€çŸ­å‘¨æœŸã€‚å…¶ä¸­å‘¨æœŸçš„å®šä¹‰å¼ä¸å®Œå…¨çš„ï¼Œå³åªéœ€è¦æ»¡è¶³$\forall i,s[i]=s[i~\bmod~k]$ï¼Œ$k$å°±æ˜¯å‘¨æœŸã€‚</p>
<hr>
<p>è¿™çœŸæ˜¯ç¥ä»™é¢˜â€¦â€¦</p>
<p>ä¸‹æ–‡ä¸­ç”¨$a,b$è¡¨ç¤ºè¾“å…¥çš„é‚£ä¿©å€¼ã€‚</p>
<p>è€ƒè™‘å¯¹äºä¸€ä¸ªåˆæ³•çš„$k$è€Œè¨€ï¼Œå‡è®¾åœ¨è¿™ä¸ª$k$æ»¡è¶³$k=\lfloor n/p\rfloor,p\in \mathbb{N}$ï¼Œé‚£ä¹ˆ$p$å°±æ˜¯å¾ªç¯èŠ‚çš„æ•°é‡ã€‚ç°åœ¨æˆ‘ä»¬å‡è®¾æœ‰$q_a+q_b=k$ï¼Œå³æ¯ä¸€æ®µå¾ªç¯èŠ‚ä¸­$A$çš„æ•°é‡å’Œ$B$çš„æ•°é‡ã€‚é‚£ä¹ˆä¸€å®šéœ€è¦æ»¡è¶³çš„æ˜¯$q_a\cdot p\leq a$å¹¶ä¸”$q_b\cdot p\leq b$ã€‚</p>
<p>åŒæ—¶è€ƒè™‘ä¸€å®šä¼šæœ‰</p>
<script type="math/tex; mode=display">
q_a \leq \lfloor\frac{a}{p}\rfloor, q_b \leq \lfloor\frac{b}{p}\rfloor</script><p>ä½†åŒæ—¶è¿˜æœ‰ä¸€ä¸ªæ¡ä»¶ï¼Œå°±æ˜¯è™½ç„¶å®é™…ä¸Šå¤šå‡ºå»ä¸€å †ä¸‹è„šæ–™ï¼Œä½†$a_{rest},b_{rest}$å¿…é¡»å°äºç­‰äº$q_a$å’Œ$q_b$ã€‚ä¹Ÿå°±æ˜¯è¯´éœ€è¦æœ‰</p>
<script type="math/tex; mode=display">
(p+1)\cdot q_a \geq a,(p+1)\cdot q_b\geq b</script><p>ç¾åŒ–ä¸€ä¸‹å°±æ˜¯</p>
<script type="math/tex; mode=display">
\lceil \frac{a}{p+1} \rceil \leq q_a\leq \lfloor \frac{a}{p} \rfloor \\\
\lceil \frac{b}{p+1} \rceil \leq q_b\leq \lfloor \frac{b}{p} \rfloor</script><p>å°±å¯ä»¥é€šè¿‡ä»$1$åˆ°$n$æšä¸¾$p$æ¥æ±‚å¾—$q_a$å’Œ$q_b$ï¼Œé‚£ä¹ˆæ ¹æ®å®šä¹‰ï¼Œ$q_a$å’Œ$q_b$æ˜¯ä¸€æ®µå¾ªç¯èŠ‚ä¸­çš„$A$å’Œ$B$çš„æ•°é‡ï¼Œæ‰€ä»¥$q_a+q_b$å¯¹$k$äº§ç”Ÿè´¡çŒ®ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯å¦‚ä½•ä¿è¯ä¸€å®šæ˜¯<strong>æœ€å°çš„$k$</strong>ã€‚è¿™ä¸ªå…¶å®ä¹Ÿå¾ˆç®€å•ã€‚å‡è®¾å¯¹äºæ¯ä¸€æ®µå®Œæ•´çš„å¾ªç¯èŠ‚ä»–åŒæ—¶ä¹Ÿè‡ªå¾ªç¯ï¼Œæ®µå’Œæ®µä¹‹é—´$A$å’Œ$B$ä¸ªæ•°ä¸€å®šç›¸åŒï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘ç›´æ¥æŠŠæ¯ä¸€æ®µçš„$A$ä¸¢åˆ°å‰é¢ï¼Œ$B$ä¸¢åˆ°åé¢ï¼Œå°±é¿å…äº†è‡ªå¾ªç¯è¿™ç§æƒ…å†µã€‚</p>
<p>ç„¶åè¿™ä¸œè¥¿æ˜¾ç„¶æ˜¯å¯ä»¥æ•°è®ºåˆ†å—çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ†ä¸€ä¸‹å—å°±åšå®Œäº†.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">int</span> N, M, L ; LL Ans ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M, L = N + M ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> g, l = <span class="number">1</span>, r ; l &lt;= L ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">        g = L / l, r = L / g ;</span><br><span class="line">        <span class="keyword">if</span> (N &lt; g || M &lt; g) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">int</span> ln = (N + g) / (g + <span class="number">1</span>), hn = N / g ;</span><br><span class="line">        <span class="keyword">int</span> lm = (M + g) / (g + <span class="number">1</span>), hm = M / g ;</span><br><span class="line">        <span class="keyword">if</span> (hn &gt;= ln &amp;&amp; hm &gt;= lm)</span><br><span class="line">            Ans += max(<span class="number">0l</span>l, <span class="number">1l</span>l * (min(hn + hm, r) - max(l, lm + ln) + <span class="number">1</span>)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®Œç»“æ’’ğŸŒ¹fa~</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/è‡ªåŠ¨æœºä¸ŠDP</tag>
        <tag>å­—ç¬¦ä¸²/ACè‡ªåŠ¨æœº</tag>
        <tag>æ€ç»´é¢˜/æ„é€ </tag>
        <tag>è´ªå¿ƒ</tag>
        <tag>å¥‡æ€ªçš„æŠ€å·§</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æš‚æ—¶ä¸ç½®é¡¶ã€‘ç•™è¨€æ¿</title>
    <url>/2019/08/09/%E7%95%99%E8%A8%80%E6%9D%BF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å­¦rvalueé€ äº†ä¸ªç•™è¨€æ¿ï¼Œä¹Ÿé¡ºä¾¿æ•´ç†ä¸€äº›æœ‰è¶£çš„äº‹æƒ…ã€‚</p>
<p>çœ‹èµ·æ¥ä¼¼ä¹æ˜¯ç”¨æ¥ç•™è¨€çš„ï¼Ÿæˆ–è®¸å§233</p>
<p>Î£( Â° â–³ Â°|||)ï¸´è¿™ä¸œè¥¿æ˜¯ç»™å¤§å®¶ç•™è¨€çš„è¾£ï¼ŒæŒ‚å‹é“¾/è¸©çˆ†æˆ‘/åæ§½blogçš„è®¾è®¡éƒ½é˜”ä»¥çš„å•ŠQAQ</p>
<p>Upd on 12.26: æ³¥èŒæ¥éƒ½æ¥äº†ä¸ç•™ä¸ªè¨€å˜›qwq</p>
<a id="more"></a>
<p>ä»¥ä¸‹æ˜¯è¢«æ•™è‚²åšäººçš„ç»å†ï¼š</p>
<blockquote>
<p>ä½ çœ¼å‰çœ‹åˆ°çš„æ™¯è±¡ï¼Œåªä¸è¿‡æ˜¯ä½ è‡ªå·±çš„æƒ³è±¡ï¼›ä½ æ‰€è®¤ä¸ºä½ å‘½ä¸­å°†æ‹¥æœ‰çš„ï¼Œåªä¸è¿‡æ˜¯ä¸€ç§å¶ç„¶ã€‚æ¡å¾—è¶Šç´§è¶Šæ˜¯å¾’ç„¶ï¼Œçœ‹å¾—è¶Šé‡è¶Šæ˜¯æ— ç”¨ã€‚æ­¤ä¹‹è°“æˆ‘æ‰§ã€‚</p>
<p>â€‹                â€”â€” ç¼–è‡ªæ¢æ–‡é“çš„ã€Šæˆ‘æ‰§ã€‹</p>
<p>äººç”Ÿæœ‰è®¸å¤šé“ï¼šæ›¾ç»è¸è¶³çš„æ˜¯é“ï¼Œå³å°†è¸å¾€çš„ä¹Ÿæ˜¯é“ï¼Œé‚£ä»€ä¹ˆæ‰æ˜¯é“å‘¢ï¼Ÿå”¯æœ‰è„šä¸‹èµ°çš„æ‰æ˜¯é“ã€‚ä¸€åˆ‡ç²¾ç¥æˆ–è€…ç‰©è´¨éƒ½å½’äºè™šæ— ï¼Œç„¶åä»æ··æ²Œä¸­è¡ç”Ÿå‡ºä¸‰ä¸‡é“ã€‚åœ¨æ‚²å–œé—´æ¶‰è¶³ä¸€æ¡æ— æ•°å‰äººç»å†è¿‡ï¼Œä¸”å°†æœ‰æ— æ•°åäººå¥”èµ´çš„é“ï¼Œæ— è®ºæ˜¯å¦å·²ç»æˆ–è€…å°†è¦åˆ°è¾¾å½¼å²¸ï¼Œç„¶åä¾¿ä¸å†å›å¤´æˆ–æ˜¯å·¦é¡¾å³ç›¼ï¼Œå³ä½¿æœ‰äº›é“ç¹ç››è‡³æï¼Œå¤œç¯å¦‚æ˜¼ï¼Œæ— æ•°äººä¸€æµªåˆä¸€æµªçš„æ¶Œå»ï¼Œé€ å°±äº†ä¸–äººçš†çŸ¥çš„è¾‰ç…Œï¼›å³ä½¿æœ‰äº›é“è‰æœ¨å‡‹æ•ï¼Œè’è‰ä¸›ç”Ÿï¼Œåªç­‰å‹‡æ•¢çš„å¼€æ‹“è€…æ–©å¼€è†æ£˜ï¼Œåˆ›é€ ä¸€ç‰‡å¤©åœ°ï¼›è¿™äº›éƒ½æ— æ‰€å…³ï¼Œæ— æ‰€åœ¨æ„ï¼Œå½¼å²¸ä½•å¦‚ã€æ¥æ—¥ä½•æ–¹ç”šè‡³è¿‡å¾€æ—§äº‹éƒ½åŒ–ä½œä¸€ç¼•äº‘çƒŸï¼Œé£˜æ¸ºç¢§éœ„ï¼Œæˆ‘è‡ªæ’·é«˜å±±ä¹‹æœˆè‰²ï¼Œç‹¬éšè¶³è½å¤„å¾€è¡Œã€‚</p>
<p>â€‹                                                                        â€”â€”SDé˜Ÿé•¿ckw</p>
<p>ç¬”è˜¸æ³¢æ¶›é¥°æ˜†ä»‘ã€‚</p>
<p>â€‹                â€”â€”konosetå­¦é•¿</p>
</blockquote>
<p>å±…ç„¶æœ‰äººæƒ³è¦æˆ‘è¿™ç§è€å¹´é€‰æ‰‹çš„ä¼é¹…å·ï¼š<code>2836531293</code></p>
]]></content>
      <categories>
        <category>æ‚è®°</category>
      </categories>
      <tags>
        <tag>ç¬”å°–ç”ŸèŠ±</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å¤šé¡¹å¼çš„å¿«é€Ÿæ’å€¼å’Œæ±‚å€¼</title>
    <url>/2019/08/07/qzcz/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤šé¡¹å¼çš„æ±‚å€¼å³ç»™å‡ºä¸€æ”¯å¤šé¡¹å¼$\rm{F}$ï¼ŒåŒæ—¶ç»™å‡ºå¤šä¸ª$x$æ±‚å‡ºç›¸åº”çš„${\rm{F}}_{[x]}$</p>
<p>å¤šé¡¹å¼çš„æ’å€¼å³ç»™å‡º$n+1$ä¸ªç‚¹å¯¹$(x,{\rm F}_{[x]}),$ æ ¹æ®å”¯ä¸€åˆ†è§£å®šç†æ±‚å‡ºå¯¹åº”çš„å¤šé¡¹å¼$\rm{F}$</p>
<a id="more"></a>
<h1 id="1-å¤šç‚¹æ±‚å€¼"><a href="#1-å¤šç‚¹æ±‚å€¼" class="headerlink" title="$1$ å¤šç‚¹æ±‚å€¼"></a>$1$ å¤šç‚¹æ±‚å€¼</h1><p>è¿˜æ˜¯åˆ†æ²»+æ„é€ ã€‚</p>
<p>é¦–å…ˆä¸€ç§æ€ç»´æ˜¯ï¼šç”¨å¤šé¡¹å¼é™¤æ³•æ¥<strong>é™æ¬¡</strong>ã€‚</p>
<p>å…·ä½“æ¥è¯´å°±æ˜¯</p>
<script type="math/tex; mode=display">
\rm{F=PQ+R}</script><p>è¿™æ˜¯å¸¦ä½™é™¤æ³•çš„æ ‡å‡†å¼ï¼Œå…¶ä¸­ä¸€å®šä¿è¯äº†$\deg(\rm{R})\leq \deg(\rm{P})$ä¸”$\deg(\rm{R})\leq \deg(\rm{Q})$.</p>
<p>æ‰€ä»¥å‡è®¾æˆ‘ä»¬ä»¤$\rm{P_{[x]}Q_{[x]}}=0$ï¼Œé‚£ä¹ˆå¯¹äºåŒä¸€ä¸ª$x$å°±ä¼šæœ‰$\rm{F_{[x]}=R_{[x]}}$ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¦‚æœæƒ³è¦åˆ†æ²»ï¼Œé‚£ä¹ˆå°±éœ€è¦å…ˆæ„é€ å‡ºä¸€ä¸ª$\rm{Q}$ä¸”$\deg(\rm{Q})=\frac{1}{2}\deg(\rm F)$</p>
<p>é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥è®©$\rm F$å¯¹$\rm Q$å–æ¨¡å°±å¯ä»¥å¾—åˆ°$\rm R$ï¼Œç„¶åä¸æ–­åˆ†æ²»ä¸‹å»å°±å¯ä»¥$n \log^2 n$è®¡ç®—äº†ã€‚</p>
<p>è®¾ç¬¬$i$ä¸ªéœ€è¦æ±‚å€¼çš„$x$æ˜¯$A_i$ï¼Œé‚£ä¹ˆå…³äºFçš„æ„é€ å…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦è®©ä»–æ»¡è¶³$\rm Q_{[A_i]}=0$å³å¯ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥æƒ³åˆ°æ„é€ ä¸€ä¸ª$m$æ¬¡çš„å¤šé¡¹å¼$\rm Q$ï¼š</p>
<script type="math/tex; mode=display">
\rm Q=\prod(x-A_i)</script><p>æ˜¾ç„¶è¿™ä¸ªä¸œè¥¿ï¼Œä»–è¿˜æ˜¯å¯ä»¥åˆ†æ²»æ¥åšï¼Œäºæ˜¯å¤šç‚¹æ±‚å€¼ä¼¼ä¹å°±ä¸èƒ½å†ä¼˜åŒ–äº†ï¼Œå› ä¸ºä»–<strong>å¤æ‚åº¦å®Œå…¨å¹³è¡¡äº†</strong>ï¼Œå³é¢„å¤„ç†å¤æ‚åº¦å’Œè¿ç®—å¤æ‚åº¦éƒ½æ˜¯$\log^2$çº§åˆ«çš„ã€‚</p>
<p>å“¦ï¼Œç„¶åå¯¹äº<a href="https://www.luogu.org/problemnew/solution/P5050" target="_blank" rel="noopener">LuoguP5050</a>è¿™é“é¢˜ï¼Œå¡å¸¸ååˆ†ä¸¥é‡ï¼Œæ‰€ä»¥ä¸€å¼€å§‹çš„ç‰ˆæœ¬æ˜¯è¿™ä¸ªç”»é£çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC target(<span class="meta-string">"avx"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"Ofast"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"inline"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fgcse"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fgcse-lm"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fipa-sra"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-ftree-pre"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-ftree-vrp"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fpeephole2"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-ffast-math"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fsched-spec"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"unroll-loops"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-falign-jumps"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-falign-loops"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-falign-labels"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fdevirtualize"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fcaller-saves"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fcrossjumping"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fthread-jumps"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-funroll-loops"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fwhole-program"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-freorder-blocks"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fschedule-insns"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"inline-functions"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-ftree-tail-merge"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fschedule-insns2"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fstrict-aliasing"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fstrict-overflow"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-falign-functions"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fcse-skip-blocks"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fcse-follow-jumps"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fsched-interblock"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fpartial-inlining"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"no-stack-protector"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-freorder-functions"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-findirect-inlining"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fhoist-adjacent-loads"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-frerun-cse-after-loop"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"inline-small-functions"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-finline-small-functions"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-ftree-switch-conversion"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-foptimize-sibling-calls"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fexpensive-optimizations"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-funsafe-loop-optimizations"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"inline-functions-called-once"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fdelete-null-pointer-checks"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 270009</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">const</span> LL Gp = <span class="number">3</span> ; <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; P[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, M, base[MAXN], F[MAXN], gg[<span class="number">20</span>][MAXN], Ls[MAXN], R[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) (res *= a) %= Mod ;</span><br><span class="line">        a = a * a % Mod, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">NTT</span><span class="params">(<span class="keyword">int</span> *J, <span class="keyword">const</span> <span class="keyword">int</span> &amp;L, <span class="keyword">const</span> <span class="keyword">int</span> &amp;flag)</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> m = <span class="number">0</span>, i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; R[i]) J[i] ^= J[R[i]] ^= J[i] ^= J[R[i]] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; L ; i &lt;&lt;= <span class="number">1</span>, ++ m)&#123;</span><br><span class="line">        rr <span class="keyword">int</span> *rua = gg[m] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; L ; j += (i &lt;&lt; <span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; i ; ++ k)&#123;</span><br><span class="line">                LL real = J[j + k],</span><br><span class="line">                         iroot = J[j + k + i] * (LL)rua[k] ;</span><br><span class="line">                J[j + k] = (real + iroot) % Mod,</span><br><span class="line">                J[j + k + i] = ((real - iroot) % Mod +Mod)%Mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag &gt; <span class="number">0</span>) <span class="keyword">return</span> ;</span><br><span class="line">    rr <span class="keyword">int</span> Inv = expow(L, Mod - <span class="number">2</span>) ;  reverse(J + <span class="number">1</span>, J + L) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i) J[i] = <span class="number">1l</span>l * J[i] * Inv % Mod ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> X[MAXN], Y[MAXN] ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">segNTT</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">        Ls[rt] = <span class="number">1</span> ;</span><br><span class="line">        P[rt].push_back((-base[l]%Mod+Mod)%Mod) ;</span><br><span class="line">        P[rt].push_back(<span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">int</span> lc = rt &lt;&lt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">int</span> rc = rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    segNTT(l, mid, rt &lt;&lt; <span class="number">1</span>) ;</span><br><span class="line">    segNTT(mid + <span class="number">1</span>, r, rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>) ;</span><br><span class="line">    Ls[rt] = Ls[rt &lt;&lt; <span class="number">1</span>] + Ls[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">int</span> Len = <span class="number">1</span>, l1 = <span class="number">0</span> ; <span class="keyword">while</span> (Len &lt; ((Ls[rt] + <span class="number">1</span>) &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l1 ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l1 - <span class="number">1</span>)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = Ls[lc] + <span class="number">1</span> ; i &lt; Len ; ++ i) X[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = Ls[rc] + <span class="number">1</span> ; i &lt; Len ; ++ i) Y[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= Ls[lc] ; ++ i) X[i] = P[lc][i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= Ls[rc] ; ++ i) Y[i] = P[rc][i] ;</span><br><span class="line">    NTT(X, Len, <span class="number">1</span>), NTT(Y, Len, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) X[i] = (LL)X[i] * (LL)Y[i] % Mod ;</span><br><span class="line">    NTT(X, Len, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= Ls[rt] ; ++ i) P[rt].push_back(X[i]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> t[MAXN], ig[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> gt[MAXN], ft[MAXN] ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> *f, <span class="keyword">int</span> *g, <span class="keyword">const</span> <span class="keyword">int</span> &amp;len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        g[<span class="number">0</span>] = expow(f[<span class="number">0</span>], Mod - <span class="number">2</span>) ;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> i, l = <span class="number">0</span>, Len = <span class="number">1</span> ;</span><br><span class="line">    Inv(f, g, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (Len &lt; (len &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; len ; ++ i) t[i] = f[i] ;  NTT(g, Len, <span class="number">1</span>),  NTT(t, Len, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) g[i] = (<span class="number">2l</span>l - (LL)t[i] * (LL)g[i] % Mod + Mod) % Mod * (LL)g[i] % Mod ;</span><br><span class="line">    NTT(g, Len, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = len ; i &lt; Len ; ++ i) g[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> G[MAXN] ;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Mod(<span class="keyword">int</span> *f,  <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g, <span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="keyword">int</span>* Rs)&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> l = <span class="number">0</span>, O = n - m + <span class="number">1</span>, L , i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= (n &lt;&lt; <span class="number">1</span>) ; ++ i) ig[i] = ft[i] = gt[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= n ; ++ i) ft[i] = f[n - i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= m ; ++ i) gt[i] = g[m - i] ; l = <span class="number">0</span>, L = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = O ; i &lt; (n &lt;&lt; <span class="number">1</span>); ++ i) ft[i] = gt[i] = <span class="number">0</span> ;</span><br><span class="line">    Inv(gt, ig, O) ; <span class="keyword">while</span> (L &lt; (O &lt;&lt; <span class="number">1</span>)) L &lt;&lt;= <span class="number">1</span>,++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L ; ++ i) t[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;</span><br><span class="line">    NTT(ig, L, <span class="number">1</span>), NTT(ft, L, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) X[i] = <span class="number">1l</span>l * ft[i] * ig[i] % Mod ;</span><br><span class="line">    NTT(X, L, - <span class="number">1</span>) ; reverse(X, X + O) ; <span class="keyword">for</span> (i = O ; i &lt; L ; ++ i) X[i] = <span class="number">0</span> ;</span><br><span class="line">    O = n + <span class="number">1</span>, L = <span class="number">1</span>, l = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (L &lt; (O &lt;&lt; <span class="number">1</span>)) L &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) G[i] = Y[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= m ; ++ i) G[i] = g[i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>))  ;</span><br><span class="line">    NTT(X, L, <span class="number">1</span>) ; NTT (G, L, <span class="number">1</span>)  ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) Y[i] = <span class="number">1l</span>l * G[i] * X[i] % Mod, X[i] = <span class="number">0</span> ;</span><br><span class="line">    NTT(Y, L, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= m - <span class="number">1</span> ; ++ i) Rs[i] = ((<span class="number">1l</span>l * f[i] - Y[i]) + Mod) % Mod ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cdqNTT</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> rt, <span class="keyword">int</span> *f)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123; <span class="built_in">printf</span>(<span class="string">"%d"</span>, *f), <span class="built_in">putchar</span>(<span class="string">'\n'</span>) ; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    <span class="keyword">int</span> T[(Ls[rt] + <span class="number">2</span>) &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line">    rr <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, i, lc = rt &lt;&lt; <span class="number">1</span>, rc = rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span> ;</span><br><span class="line">    _Mod(f, P[lc], Ls[rt] - <span class="number">1</span>, Ls[lc], T) ; cdqNTT(l, mid, lc, T) ;</span><br><span class="line">    _Mod(f, P[rc], Ls[rt] - <span class="number">1</span>, Ls[rc], T) ; cdqNTT(mid + <span class="number">1</span>, r, rc, T) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">19</span>  ;++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> *rua = gg[i] ; rua[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">int</span> gi = rua[<span class="number">1</span>] = expow(<span class="number">3</span>, <span class="number">998244352</span>/(<span class="number">1</span> &lt;&lt; (i + <span class="number">1</span>))) ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">2</span> ; j &lt; (<span class="number">1</span> &lt;&lt; i) ; ++ j) rua[j] = <span class="number">1l</span>l * rua[j - <span class="number">1</span>] * gi % Mod ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;F[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">    segNTT(<span class="number">1</span>, M, <span class="number">1</span>), <span class="built_in">memset</span>(X, <span class="number">0</span>, <span class="keyword">sizeof</span>(X)), <span class="built_in">memset</span>(Y, <span class="number">0</span>, <span class="keyword">sizeof</span>(Y)) ;</span><br><span class="line">    <span class="keyword">if</span> (N &gt;= M) _Mod(F, P[<span class="number">1</span>], N, M, F) ; cdqNTT(<span class="number">1</span>, M, <span class="number">1</span>, F) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><del>é€¼å¾—æˆ‘å·®ç‚¹ä¸ŠæŒ‡ä»¤é›†</del></p>
<p>ç„¶åå‘ç°æ˜¯è¿™ä¸ªNTTå¸¸æ•°å¤ªå¤§äº†ï¼Œæ‰€ä»¥è€ƒè™‘ç›´æ¥<strong>è¾¹è§’æš´åŠ›</strong>ï¼ŒåŒºé—´é•¿åº¦å°åˆ°ä¸€å®šåœ°æ­¥ç›´æ¥æš´åŠ›ç§¦ä¹éŸ¶å¹¶ä¸”å¾ªç¯å±•å¼€ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cdqNTT</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> rt, <span class="keyword">int</span> *f)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (r - l &lt;= <span class="number">1024</span>) &#123;</span><br><span class="line">         <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">            LL x = base[i], c1, c2, c3, c4, now = f[r - l] ; b[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">16</span> ; ++ j) b[j] = b[j - <span class="number">1</span>] * x % Mod ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=r-l<span class="number">-1</span>;j<span class="number">-15</span>&gt;=<span class="number">0</span>;j-=<span class="number">16</span>)&#123;</span><br><span class="line">                c1=(<span class="number">1l</span>l*now*b[<span class="number">16</span>]+<span class="number">1l</span>l*f[j]*b[<span class="number">15</span>]+<span class="number">1l</span>l*f[j<span class="number">-1</span>]*b[<span class="number">14</span>]+<span class="number">1l</span>l*f[j<span class="number">-2</span>]*b[<span class="number">13</span>])%Mod,</span><br><span class="line">                c2=(<span class="number">1l</span>l*f[j<span class="number">-3</span>]*b[<span class="number">12</span>]+<span class="number">1l</span>l*f[j<span class="number">-4</span>]*b[<span class="number">11</span>]+<span class="number">1l</span>l*f[j<span class="number">-5</span>]*b[<span class="number">10</span>]+<span class="number">1l</span>l*f[j<span class="number">-6</span>]*b[<span class="number">9</span>])%Mod,</span><br><span class="line">                c3=(<span class="number">1l</span>l*f[j<span class="number">-7</span>]*b[<span class="number">8</span>]+<span class="number">1l</span>l*f[j<span class="number">-8</span>]*b[<span class="number">7</span>]+<span class="number">1l</span>l*f[j<span class="number">-9</span>]*b[<span class="number">6</span>]+<span class="number">1l</span>l*f[j<span class="number">-10</span>]*b[<span class="number">5</span>])%Mod,</span><br><span class="line">                c4=(<span class="number">1l</span>l*f[j<span class="number">-11</span>]*b[<span class="number">4</span>]+<span class="number">1l</span>l*f[j<span class="number">-12</span>]*b[<span class="number">3</span>]+<span class="number">1l</span>l*f[j<span class="number">-13</span>]*b[<span class="number">2</span>]+<span class="number">1l</span>l*f[j<span class="number">-14</span>]*b[<span class="number">1</span>])%Mod,</span><br><span class="line">                now=(<span class="number">0l</span>l+c1+c2+c3+c4+f[j<span class="number">-15</span>])%Mod;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = (r-l)%<span class="number">16</span><span class="number">-1</span> ; j &gt;= <span class="number">0</span> ; -- j)now=(<span class="number">1l</span>l*now*x+f[j])%Mod;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>, now), <span class="built_in">putchar</span>(<span class="string">'\n'</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    if (l == r) &#123; printf("%d", *f), putchar('\n') ; return ;&#125;</span></span><br><span class="line">    <span class="keyword">int</span> T[(Ls[rt] + <span class="number">2</span>) &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line">    rr <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, i, lc = rt &lt;&lt; <span class="number">1</span>, rc = rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span> ;</span><br><span class="line">    _Mod(f, P[lc], Ls[rt] - <span class="number">1</span>, Ls[lc], T) ; cdqNTT(l, mid, lc, T) ;</span><br><span class="line">    _Mod(f, P[rc], Ls[rt] - <span class="number">1</span>, Ls[rc], T) ; cdqNTT(mid + <span class="number">1</span>, r, rc, T) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±å¯ä»¥éšä¾¿è¿‡äº†ã€‚</p>
<h1 id="2-å¿«é€Ÿæ’å€¼"><a href="#2-å¿«é€Ÿæ’å€¼" class="headerlink" title="$2$ å¿«é€Ÿæ’å€¼"></a>$2$ å¿«é€Ÿæ’å€¼</h1><p>é¦–å…ˆæ€è€ƒæ‹‰æ ¼æœ—æ—¥æ’å€¼ï¼š</p>
<script type="math/tex; mode=display">
\rm{F}=\mathcal{\sum y_i\prod_{i\neq j}\frac{x-x_j}{x_i-x_j}}</script><p>æˆ‘ä»¬å‘ç°$\prod (x-x_j)$å°±æ˜¯ä¸ªå¼Ÿå¼Ÿï¼Œäºæ˜¯è€ƒè™‘ï¼š</p>
<script type="math/tex; mode=display">
\rm{G}=\mathcal {\sum \frac{y_i}{\prod_{i\neq j}x_i-x_j}}</script><p>å¦‚æœæˆ‘ä»¬éšä¾¿è®¾ä¸€ä¸ªå¤šé¡¹å¼$ \phi(x)$</p>
<script type="math/tex; mode=display">
\phi=\prod(x-x_i)</script><p>é‚£ä¹ˆåŸå¼å°±å˜æˆäº†ï¼š</p>
<script type="math/tex; mode=display">
\rm{G}=\mathcal {\sum \frac{y_i}{\frac{\phi(x_i)}{x-x_i}}}</script><p>è¿™ä¸œè¥¿å°±å¯ä»¥ï¼š<img src="https://s2.ax1x.com/2019/08/28/mH5tyj.jpg" alt></p>
<p>å°±å¯ä»¥<strong>æ´›</strong>ï¼å³</p>
<script type="math/tex; mode=display">
\lim _{x \rightarrow a} \frac{f(x)}{g(x)}=\lim _{x \rightarrow a} \frac{f^{\prime}(x)}{g^{\prime}(x)}</script><p>ç”±äºæ˜¯å½¢å¼å¹‚çº§æ•°ä¹‹é—´çš„è¿ç®—ï¼Œäºæ˜¯å°±å¯ä»¥èƒ¡æï¼Œä¹Ÿå°±æ˜¯</p>
<script type="math/tex; mode=display">
\frac{\phi(x_i)}{x-x_i}=\phi'(x_i)</script><p>æ˜¾ç„¶å…³äºè¿™ä¸ª$\phi$æ˜¯å¯ä»¥åˆ†æ²»çš„ï¼Œåˆ†æ²»å®Œæ±‚ä¸€ä¸ªå¯¼ç„¶åå†å¤šç‚¹æ±‚å€¼å³å¯ã€‚</p>
<p>å›ä»£ä¹‹åï¼Œæ±‚ä¸ªé€†å°±å¯ä»¥æ±‚å‡ºGï¼Œä¹‹åæ¥ç€åˆ†æ²»åé¢çš„$\prod(x-x_j)$å°±å®Œäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 300011</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; <span class="keyword">int</span> Len[MAXN], Q[MAXN], R[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, *P[MAXN], *K[MAXN], bx[MAXN], gg[<span class="number">25</span>][MAXN], by[MAXN], cy[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> ch_top=<span class="number">4e7</span>+<span class="number">3</span>;</span><br><span class="line"><span class="keyword">char</span> ch[ch_top],*now_r=ch<span class="number">-1</span>,*now_w=ch<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(*++now_r&lt;<span class="string">'0'</span>);</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=*now_r-<span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">while</span>(*++now_r&gt;=<span class="string">'0'</span>)x=x*<span class="number">10</span>+*now_r-<span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> st[<span class="number">20</span>];<span class="keyword">static</span> <span class="keyword">int</span> top;</span><br><span class="line">    <span class="keyword">while</span>(st[++top]=<span class="string">'0'</span>+x%<span class="number">10</span>,x/=<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">while</span>(*++now_w=st[top],--top);</span><br><span class="line">    *++now_w=<span class="string">' '</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    rr LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            res = res * <span class="number">1l</span>l * a % Mod ;</span><br><span class="line">        a = <span class="number">1l</span>l * a * a % Mod, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pre</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, j ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">20</span> ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> *now = gg[i] ; now[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">int</span> p = now[<span class="number">1</span>] = expow(<span class="number">3</span>, <span class="number">998244352</span> / (<span class="number">1</span> &lt;&lt; (i + <span class="number">1</span>))) ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">2</span> ; j &lt; (<span class="number">1</span> &lt;&lt; i) ; ++ j) now[j] = <span class="number">1l</span>l * now[j - <span class="number">1</span>] * p % Mod ; <span class="comment">// -1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(<span class="keyword">int</span> *J, <span class="keyword">int</span> L, <span class="keyword">int</span> o)</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, j, k, m = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) <span class="keyword">if</span> (i &lt; R[i]) swap(J[R[i]], J[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; L ; i &lt;&lt;= <span class="number">1</span>, ++ m)&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> *now = gg[m] ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; L ; j += (i &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt; i ; ++ k)&#123;</span><br><span class="line">                <span class="keyword">const</span> LL x = J[j + k], y = <span class="number">1l</span>l * now[k] * J[i + j + k] ;</span><br><span class="line">                J[j + k] = (x + y) % Mod, J[i + j + k] = ((x - y) % Mod + Mod) % Mod ;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (o &gt; <span class="number">0</span>) <span class="keyword">return</span> ; <span class="keyword">const</span> <span class="keyword">int</span> inv = expow(L, Mod - <span class="number">2</span>) ;</span><br><span class="line">    reverse(J + <span class="number">1</span>, J + L) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) J[i] = <span class="number">1l</span>l * inv * J[i] % Mod ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ft[MAXN], gt[MAXN], ig[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> t[MAXN], G[MAXN], X[MAXN], Y[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> *f, <span class="keyword">int</span> *g, <span class="keyword">const</span> <span class="keyword">int</span> &amp;len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        g[<span class="number">0</span>] = expow(f[<span class="number">0</span>], Mod - <span class="number">2</span>) ;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    rr <span class="keyword">int</span> i, l = <span class="number">0</span>, Len = <span class="number">1</span> ;</span><br><span class="line">    Inv(f, g, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (Len &lt; (len &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; len ; ++ i) t[i] = f[i] ;  NTT(g, Len, <span class="number">1</span>),  NTT(t, Len, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) g[i] = (<span class="number">2l</span>l - (LL)t[i] * (LL)g[i] % Mod + Mod) % Mod * (LL)g[i] % Mod ;</span><br><span class="line">    NTT(g, Len, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = len ; i &lt; Len ; ++ i) g[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">        P[rt] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>] ; Len[rt] = <span class="number">1</span> ;</span><br><span class="line">        P[rt][<span class="number">0</span>] = (-bx[l]+Mod)%Mod , P[rt][<span class="number">1</span>] = <span class="number">1</span> ; <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    rr <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">int</span> lc = rt &lt;&lt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">int</span> rc = rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    solve(l, mid, lc), solve(mid + <span class="number">1</span>, r, rc) ;</span><br><span class="line">    Len[rt] = Len[lc] + Len[rc], P[rt] = <span class="keyword">new</span> <span class="keyword">int</span>[Len[rt] + <span class="number">1</span>] ;</span><br><span class="line">    rr <span class="keyword">int</span> L = <span class="number">1</span>, l1 = <span class="number">0</span> ; <span class="keyword">while</span> (L &lt; ((Len[rt] + <span class="number">1</span>) &lt;&lt; <span class="number">1</span>)) L &lt;&lt;= <span class="number">1</span>, ++ l1 ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l1 - <span class="number">1</span>))  ;</span><br><span class="line">    <span class="keyword">for</span> (i = Len[lc] + <span class="number">1</span> ; i &lt; L ; ++ i) X[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = Len[rc] + <span class="number">1</span> ; i &lt; L ; ++ i) Y[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= Len[lc] ; ++ i) X[i] = P[lc][i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= Len[rc] ; ++ i) Y[i] = P[rc][i] ;</span><br><span class="line">    NTT(X, L, <span class="number">1</span>), NTT(Y, L, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) X[i] = <span class="number">1l</span>l * X[i] * Y[i] % Mod ;</span><br><span class="line">    NTT(X, L, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= Len[rt] ; ++ i) P[rt][i] = X[i] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _Dev(<span class="keyword">int</span> *f, <span class="keyword">int</span> *g, <span class="keyword">int</span> len)&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i ; g[len] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt;= len ; ++ i) g[i - <span class="number">1</span>] = <span class="number">1l</span>l * i * f[i] % Mod ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _Mod(<span class="keyword">int</span> *f, <span class="keyword">int</span> *g, <span class="keyword">int</span> *res, <span class="keyword">int</span> n, <span class="keyword">int</span> m)&#123;</span><br><span class="line">    <span class="keyword">int</span> L = <span class="number">1</span>, l = <span class="number">0</span>, i, o = n - m + <span class="number">1</span>, d = n &lt;&lt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; d ; ++ i) ft[i] = gt[i] = ig[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= n ; ++ i) ft[i] = f[n - i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= m ; ++ i) gt[i] = g[m - i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = o ; i &lt; (n &lt;&lt; <span class="number">1</span>) ; ++ i) ft[i] = gt[i] = <span class="number">0</span> ; Inv(gt, ig, o) ;</span><br><span class="line">    <span class="keyword">while</span> (L &lt; (o &lt;&lt; <span class="number">1</span>)) L &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) t[i] = <span class="number">0</span>, R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;<span class="comment">//1</span></span><br><span class="line">    NTT(ig, L, <span class="number">1</span>) ; NTT(ft, L, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) X[i] = <span class="number">1l</span>l * ft[i] * ig[i] % Mod ;</span><br><span class="line">    NTT(X, L, <span class="number">-1</span>) ; reverse(X, X + o) ;</span><br><span class="line">    <span class="keyword">for</span> (i = o ; i &lt; L ; ++ i) X[i] = <span class="number">0</span> ;</span><br><span class="line">    o = n + <span class="number">1</span>, L = <span class="number">1</span>, l = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (L &lt; (o &lt;&lt; <span class="number">1</span>)) L &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) G[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= m ; ++ i) G[i] = g[i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;<span class="comment">//2</span></span><br><span class="line">    NTT(X, L, <span class="number">1</span>) ; NTT(G, L, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) Y[i] = <span class="number">1l</span>l * X[i] * G[i] % Mod, X[i] = <span class="number">0</span> ;<span class="comment">//3</span></span><br><span class="line">    NTT(Y, L, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= m - <span class="number">1</span> ; ++ i) res[i] = ((<span class="number">1l</span>l * f[i] - Y[i]) % Mod + Mod) % Mod;</span><br><span class="line">&#125;</span><br><span class="line">LL b[<span class="number">100</span>] ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cdqNTT</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> rt, <span class="keyword">int</span> *f)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (r - l &lt;= <span class="number">512</span>) &#123;</span><br><span class="line">         <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">            LL x = bx[i], c1, c2, c3, c4, now = f[r - l] ; b[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">16</span> ; ++ j) b[j] = b[j - <span class="number">1</span>] * x % Mod ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=r-l<span class="number">-1</span>;j<span class="number">-15</span>&gt;=<span class="number">0</span>;j-=<span class="number">16</span>)&#123;</span><br><span class="line">                c1=(<span class="number">1l</span>l*now*b[<span class="number">16</span>]+<span class="number">1l</span>l*f[j]*b[<span class="number">15</span>]+<span class="number">1l</span>l*f[j<span class="number">-1</span>]*b[<span class="number">14</span>]+<span class="number">1l</span>l*f[j<span class="number">-2</span>]*b[<span class="number">13</span>])%Mod,</span><br><span class="line">                c2=(<span class="number">1l</span>l*f[j<span class="number">-3</span>]*b[<span class="number">12</span>]+<span class="number">1l</span>l*f[j<span class="number">-4</span>]*b[<span class="number">11</span>]+<span class="number">1l</span>l*f[j<span class="number">-5</span>]*b[<span class="number">10</span>]+<span class="number">1l</span>l*f[j<span class="number">-6</span>]*b[<span class="number">9</span>])%Mod,</span><br><span class="line">                c3=(<span class="number">1l</span>l*f[j<span class="number">-7</span>]*b[<span class="number">8</span>]+<span class="number">1l</span>l*f[j<span class="number">-8</span>]*b[<span class="number">7</span>]+<span class="number">1l</span>l*f[j<span class="number">-9</span>]*b[<span class="number">6</span>]+<span class="number">1l</span>l*f[j<span class="number">-10</span>]*b[<span class="number">5</span>])%Mod,</span><br><span class="line">                c4=(<span class="number">1l</span>l*f[j<span class="number">-11</span>]*b[<span class="number">4</span>]+<span class="number">1l</span>l*f[j<span class="number">-12</span>]*b[<span class="number">3</span>]+<span class="number">1l</span>l*f[j<span class="number">-13</span>]*b[<span class="number">2</span>]+<span class="number">1l</span>l*f[j<span class="number">-14</span>]*b[<span class="number">1</span>])%Mod,</span><br><span class="line">                now=(<span class="number">0l</span>l+c1+c2+c3+c4+f[j<span class="number">-15</span>])%Mod;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = (r-l)%<span class="number">16</span><span class="number">-1</span> ; j &gt;= <span class="number">0</span> ; -- j)now=(<span class="number">1l</span>l*now*x+f[j])%Mod;</span><br><span class="line">            cy[i] = now ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    if (l == r) &#123; printf("%d", *f), putchar('\n') ; return ;&#125;</span></span><br><span class="line">    <span class="keyword">int</span> T[(Len[rt] + <span class="number">2</span>) &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line">    rr <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, i, lc = rt &lt;&lt; <span class="number">1</span>, rc = rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span> ;</span><br><span class="line">    _Mod(f, P[lc], T, Len[rt] - <span class="number">1</span>, Len[lc]) ; cdqNTT(l, mid, lc, T) ;</span><br><span class="line">    _Mod(f, P[rc], T, Len[rt] - <span class="number">1</span>, Len[rc]) ; cdqNTT(mid + <span class="number">1</span>, r, rc, T) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">void cdqNTT(int l, int r, int rt, int *f)&#123;</span></span><br><span class="line"><span class="comment">    int T[(Len[rt] + 2) &lt;&lt; 1] ;</span></span><br><span class="line"><span class="comment">    if (l == r) &#123; cy[l] = f[0] ; return ; &#125;</span></span><br><span class="line"><span class="comment">    int mid = (l + r) &gt;&gt; 1, lc = rt &lt;&lt; 1, rc = lc | 1 ;</span></span><br><span class="line"><span class="comment">    _Mod(f, P[lc], T, Len[rt] - 1, Len[lc]), cdqNTT(l, mid, lc, T) ;</span></span><br><span class="line"><span class="comment">    _Mod(f, P[rc], T, Len[rt] - 1, Len[rc]), cdqNTT(mid + 1, r, rc, T) ;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cdqLg</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">        K[rt] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>] ;</span><br><span class="line">        K[rt][<span class="number">0</span>] = <span class="number">1l</span>l * by[l] * expow(cy[l], Mod - <span class="number">2</span>) % Mod ;</span><br><span class="line">        K[rt][<span class="number">1</span>] = <span class="number">0</span> ; <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> A[MAXN], B[MAXN], C[MAXN], D[MAXN] ;</span><br><span class="line">    rr <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, lc = rt &lt;&lt; <span class="number">1</span>, rc = lc | <span class="number">1</span>, i ;</span><br><span class="line">    cdqLg(l, mid, lc), cdqLg(mid + <span class="number">1</span>, r, rc) ; <span class="keyword">int</span> L = <span class="number">1</span>, l0 = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (L &lt; ((Len[rt] + <span class="number">1</span>) &lt;&lt; <span class="number">1</span>)) L &lt;&lt;= <span class="number">1</span>, ++ l0 ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l0 - <span class="number">1</span>)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = Len[lc] + <span class="number">1</span> ; i &lt; L ; ++ i) A[i] = C[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = Len[rc] + <span class="number">1</span> ; i &lt; L ; ++ i) B[i] = D[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= Len[lc] ; ++ i) A[i] = K[lc][i], C[i] = P[lc][i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= Len[rc] ; ++ i) B[i] = K[rc][i], D[i] = P[rc][i] ;</span><br><span class="line">    NTT(A, L, <span class="number">1</span>), NTT(B, L, <span class="number">1</span>), NTT(C, L, <span class="number">1</span>), NTT(D, L, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) A[i] = (<span class="number">1l</span>l * A[i] * D[i] % Mod + <span class="number">1l</span>l * B[i] * C[i] % Mod) % Mod ;</span><br><span class="line">    NTT(A, L, <span class="number">-1</span>) ; K[rt] = <span class="keyword">new</span> <span class="keyword">int</span>[Len[rt] + <span class="number">1</span>] ; <span class="keyword">for</span>(i = <span class="number">0</span> ; i &lt;= Len[rt] ; ++ i ) K[rt][i] = A[i] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    rr int W ; freopen("2.in", "r", stdin) ;</span></span><br><span class="line">    fread(ch,<span class="number">1</span>,ch_top,<span class="built_in">stdin</span>);</span><br><span class="line">    N = read() ; <span class="keyword">int</span> i ; pre() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) bx[i] = read(), by[i] = read() ;</span><br><span class="line">    solve(<span class="number">1</span>, N, <span class="number">1</span>) ; <span class="built_in">memset</span>(X, <span class="number">0</span>, <span class="keyword">sizeof</span>(X)) ; <span class="built_in">memset</span>(Y, <span class="number">0</span>, <span class="keyword">sizeof</span>(Y));</span><br><span class="line">    _Dev(P[<span class="number">1</span>], Q, Len[<span class="number">1</span>]) ; cdqNTT(<span class="number">1</span>, N, <span class="number">1</span>, Q) ; cdqLg(<span class="number">1</span>, N, <span class="number">1</span>) ;</span><br><span class="line"><span class="comment">//    for (i = 0 ; i &lt; N ; ++ i) cout &lt;&lt; K[1][i] &lt;&lt; " " ;</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) write(K[<span class="number">1</span>][i]) ; fwrite(ch,<span class="number">1</span>,now_w-ch,<span class="built_in">stdout</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼šã™ã¹ã¦åˆ†å‰²ã¹ã‚‹ã“ã¨ã®ã§ãã‚‹å¤šé …å¼ç”Ÿæ´»æœ€é«˜ã ï¼ï¼ˆä¸€åˆ‡çš†å¯åˆ†æ²»çš„å¤šé¡¹å¼ç”Ÿæ´»èµ›é«˜ï¼ï¼‰</p>
]]></content>
      <tags>
        <tag>åˆ†æ²»</tag>
        <tag>å¤šé¡¹å¼åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨</title>
    <url>/2019/08/07/xxdt/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>$\boldsymbol{k}$é˜¶å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨</strong>æŒ‡çš„æ˜¯ä»¥ä¸‹é—®é¢˜ï¼š</p>
<blockquote>
<p>ç»™å‡º$k$é˜¶çº¿æ€§é€’æ¨å¼$\boldsymbol{f}$ä»¥åŠåˆå§‹é¡¹$\boldsymbol{a_0,a_1â€¦a_{k-1}}$ï¼Œå¹¶æ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
a_{n}=\sum_{i=1}^{k} f_{i} \times a_{n-i}</script><p>å¯¹äºæŸä¸ª$o$ï¼Œæ±‚è§£$f_o$åœ¨æŸä¸ªå›ºå®šæ¨¡æ•°ä¸‹çš„å€¼ã€‚</p>
</blockquote>
<p>ç„¶åä»¥ä¸‹æ˜¯<code>shadowice1984</code>çš„äººè¯ç‰ˆæœ¬ï¼š</p>
<blockquote>
<p>1.å®ƒæ˜¯å¸¸ç³»æ•°çš„ï¼Œæ¢å¥è¯è¯´é€’æ¨ç³»æ•°å’Œä¸‹æ ‡næ— å…³</p>
<p>2.å®ƒæ˜¯çº¿æ€§çš„ï¼Œæ¢å¥è¯è¯´é€’æ¨å¼ä¸­æ¯ä¸€é¡¹çš„æ¬¡æ•°éƒ½æ˜¯1ï¼Œæ²¡æœ‰ä¹±ä¸ƒå…«ç³Ÿçš„2æ¬¡3æ¬¡é¡¹</p>
<p>3.å®ƒæ˜¯é½æ¬¡çš„ï¼Œæ¢å¥è¯è¯´é€’æ¨å¼çš„å¸¸æ•°é¡¹ç­‰äº0</p>
</blockquote>
<p>è¿™ä¸ªé—®é¢˜çš„å¼±æ™ºè§£æ³•æ˜¯$O(k^3\log n)$çš„çŸ©é˜µå¿«é€Ÿå¹‚ã€‚ä½†æ˜¯é€šè¿‡å¤šé¡¹å¼åŠ é€Ÿå¯ä»¥å°†å¤æ‚åº¦ä¼˜åŒ–è‡³$O(k^2\log n)$ç”šè‡³$O(k\log k \log n)$.</p>
<p><del>äºæ˜¯è¿™ä¸ªä¸–ç•Œä¸Šå°±å†ä¹Ÿæ²¡æœ‰çŸ©é˜µå¿«é€Ÿå¹‚äº†</del></p>
<a id="more"></a>
<h1 id="1-ç‰¹å¾å‘é‡ä¸ç‰¹å¾å¤šé¡¹å¼"><a href="#1-ç‰¹å¾å‘é‡ä¸ç‰¹å¾å¤šé¡¹å¼" class="headerlink" title="$1$  ç‰¹å¾å‘é‡ä¸ç‰¹å¾å¤šé¡¹å¼"></a>$1$  ç‰¹å¾å‘é‡ä¸ç‰¹å¾å¤šé¡¹å¼</h1><p>é¦–å…ˆï¼Œç»™å®š$n$é˜¶çŸ©é˜µ$\boldsymbol{A}$ï¼Œè‹¥å­˜åœ¨å‘é‡$\boldsymbol{x}$ä½¿å¾—$\exists \lambda \in \mathbb {R}$ ï¼Œæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
\tag{1} \boldsymbol{A}\cdot \boldsymbol{x} = \lambda\boldsymbol{x}</script><p>åˆ™ç§°$\boldsymbol{x}$æ˜¯$\boldsymbol{A}$çš„<strong>ç‰¹å¾å‘é‡</strong>ï¼Œ$\lambda$ç§°ä¸º$\boldsymbol{A}$çš„ç‰¹å¾å€¼ï¼Œ$(1)$å¼ç§°ä¹‹ä¸º<strong>ç‰¹å¾æ–¹ç¨‹</strong>ã€‚</p>
<p>åŒæ—¶ä¹Ÿå¯ä»¥å†™ä½œ</p>
<script type="math/tex; mode=display">
(\boldsymbol{A}-\lambda\boldsymbol{I})\cdot \boldsymbol{x}= \boldsymbol{0}</script><p>æœ‰è§£çš„æ¡ä»¶æ˜¯</p>
<script type="math/tex; mode=display">
\tag{2} \det(\boldsymbol{A}-\lambda\boldsymbol{I})=0</script><p>åŒæ—¶å®šä¹‰<strong>ç‰¹å¾å¤šé¡¹å¼</strong>ä¸º<strong>ç±»å½¢å¼å¹‚çº§æ•°</strong>ï¼Œå³ä¸è€ƒè™‘æœªçŸ¥æ•°$x$çš„æ•°å­¦å½¢æ€ï¼Œ$x$å¯ä»¥ä¸ºçŸ©é˜µã€å‘é‡$  etc.$</p>
<p>æˆ‘ä»¬è§‚å¯Ÿï¼Œ$(2)$ä¸­å³è¾¹çš„è¡Œåˆ—å¼è®¡ç®—çš„æ€§è´¨ä¿è¯äº†è¡Œåˆ—å¼å±•å¼€åæ¯ä¸€é¡¹ä¸€å®šè‡³å¤šæ˜¯$\lambda$çš„$n$æ¬¡ï¼ˆä¸»å¯¹è§’çº¿ç›¸ä¹˜ï¼‰ã€$n-1$æ¬¡$\cdots$ $0$æ¬¡ï¼Œé‚£ä¹ˆ<strong>ç‰¹å¾å¤šé¡¹å¼å³ä¸ºå…³äº$\lambda$çš„$\det(\boldsymbol{A}-\lambda\boldsymbol{I})$å±•å¼€</strong>ï¼Œè®°ä¸º$\boldsymbol{\phi(\lambda)}$.</p>
<p>æ¥ç€è§‚å¯Ÿ$\phi(\lambda)$:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\phi(\lambda)= |\boldsymbol{A}-\lambda \boldsymbol{I}| & = \left[\begin{array}{ccccc}{\ \lambda} & {0} & {\cdots} & {0} & {0} \\\ {0} & {\lambda} & {\cdots} & {0} & {0} \\\ {\cdots} & {\cdots} & {\cdots} & {\cdots} & {\cdots} \\\ {0} & {0} & {\cdots} & {\lambda} & {0} \\\ {0} & {0} & {\cdots} & {0} & {\lambda}\end{array}\right]-\left[\begin{array}{ccccc}{\ 0} & {0} & {\cdots} & {0} & {a_{k}} \\\ {1} & {0} & {\cdots} & {0} & {a_{k-1}} \\\ {0} & {1} & {\cdots} & {0} & {a_{k-2}} \\\ {\cdots} & {\cdots} & {\cdots} & {\cdots} & {\cdots} \\\ {0} & {0} & {\cdots} & {0} & {\lambda}\end{array}\right]\\\ & =\left[\begin{array}{ccccc}{\lambda} & {0} & {\cdots} & {0} & {-a_{k}} \\\ {-1} & {\lambda} & {\cdots} & {0} & {-a_{k-1}} \\\ {0} & {-1} & {\cdots} & {0} & {-a_{k-2}} \\\ {\cdots} & {\cdots} & {\cdots} & {\cdots} & {\cdots} \\\ {0} & {0} & {\cdots} & {-1} & {\lambda-a_{1}}\end{array}\right]
\end{aligned}</script><p>ç„¶åå¯¹äºè¿™ä¸ªæˆ‘ä»¬å¯ä»¥è¿›è¡Œ<strong>æ‹‰æ™®æ‹‰æ–¯å±•å¼€</strong>ï¼ˆå°±æ˜¯ç”¨ä»£æ•°ä½™å­å¼å±•å¼€ä¸€ä¸ªè¡Œåˆ—å¼ï¼‰ï¼Œæˆ‘ä»¬é€‰æ‹©æœ€åä¸€åˆ—ï¼š</p>
<script type="math/tex; mode=display">
\phi(\lambda)=\sum\limits_{i=1}^{k} a_{k-i+1}(-1)^{i+k}\phi(\lambda)_{i, k}</script><p>å…¶ä¸­$\phi(\lambda)_{i,k}$è¡¨ç¤ºä¸¢æ‰$(i,k)$åŒè¡ŒåŒåˆ—ä¹‹åçš„ä»£æ•°ä½™å­å¼ã€‚</p>
<p>è¿™ä¸œè¥¿å¯ä»¥æš´åŠ›è¿­ä»£å¼åŒ–ç®€/ç›´æ¥è‰¯åºå½’çº³å¾—å‡ºä»–çš„<del>èƒŒè¯µ</del>åŒ–ç®€å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
\phi(\lambda)=(-1)^{n}\left(\lambda^{n}-\sum_{i=1}^{n} a_{i} \lambda^{n-i}\right)</script><p><del>å¥½åƒèƒ¡æ‰¯äº†åŠå¤©ä¹Ÿæ²¡æ‰¯åˆ°ç‚¹å­ä¸Šï¼Œé€’æ¨åœ¨å“ªï¼Ÿï¼Ÿ</del></p>
<h1 id="2-ä¸€æ­¥è½¬åŒ–-æ„é€ "><a href="#2-ä¸€æ­¥è½¬åŒ–-æ„é€ " class="headerlink" title="$2$  ä¸€æ­¥è½¬åŒ–/æ„é€ "></a>$2$  ä¸€æ­¥è½¬åŒ–/æ„é€ </h1><p><strong>ç¾åœ¨ã¯å¤§åŠ›æ„é€ æ™‚é–“ã§ã™ï¼ï¼</strong></p>
<p>æˆ‘ä»¬è€ƒè™‘æ„é€ ä¸€ä¸ªè¿™æ ·çš„æ•°åˆ—$\boldsymbol{g}$ï¼Œæ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
\boldsymbol{A}^n=\sum_{i=0}^{k-1}g_i\boldsymbol{A}^i</script><p>ç„¶åæˆ‘ä»¬ä¸¤è¾¹åŒæ—¶å·¦ä¹˜ä¸€ä¸ªåˆå§‹çŠ¶æ€$\boldsymbol{F_0}$:</p>
<script type="math/tex; mode=display">
\boldsymbol{F_0\cdot A}^n=\sum_{i=0}^{k-1}g_i\boldsymbol{F_0\cdot A}^i</script><p>æˆ‘ä»¬è€ƒè™‘å¯¹äºçŸ©é˜µä¹˜æ³•çš„$\boldsymbol{res}$çŸ©é˜µï¼Œæˆ‘ä»¬å…³å¿ƒçš„æ˜¯å®ƒçš„$(0,0)$å¤„çš„å€¼ï¼Œä¸å¦¨è®°ä¸º$\boldsymbol{res_0}$ï¼Œé‚£ä¹ˆå°±æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\boldsymbol{res}_0=(\boldsymbol{F_0\cdot A} ^ n)_0 =\sum_{i=0}^{k-1}g_i(\boldsymbol{F_0\cdot A}^i)_0</script><p>å…¶ä¸­$\boldsymbol{X}_p$è¡¨ç¤ºä¸€ç»´å‘é‡$\boldsymbol{X}$çš„ç¬¬$p$é¡¹ã€‚</p>
<p>ç„¶åä½¿ç”¨è§‚å¯Ÿæ³•ï¼Œæˆ‘ä»¬å‘ç°$\boldsymbol{F_0\cdot A}^i$è¿™ä¸œè¥¿å°±æ˜¯è½¬ç§»äº†$i$æ¬¡ä¹‹åçš„ç¬¬$0$é¡¹ï¼Œæ¢è¨€ä¹‹ä¹Ÿå°±æ˜¯$\boldsymbol{F_0}$çš„ç¬¬$i$é¡¹ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰ï¼š</p>
<script type="math/tex; mode=display">
\boldsymbol{res_0}=\sum_{i=0}^{k-1}g_i\boldsymbol{(F_0)}_i</script><p>æ‰€ä»¥åªè¦æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºä¸€ç»„$g$ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨$O(k)$çš„æ—¶é—´å†…æ±‚å‡ºç­”æ¡ˆã€‚</p>
<h1 id="3-å¿«é€Ÿçº¿æ€§é€’æ¨"><a href="#3-å¿«é€Ÿçº¿æ€§é€’æ¨" class="headerlink" title="$3~$ å¿«é€Ÿçº¿æ€§é€’æ¨"></a>$3~$ å¿«é€Ÿçº¿æ€§é€’æ¨</h1><p>ç°åœ¨æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æ„é€ $\boldsymbol{g}$åºåˆ—äº†ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬éšä¾¿è®¾ä¸€ä¸ªå…³äº$\boldsymbol{A}$çš„å¤šé¡¹å¼ï¼š</p>
<script type="math/tex; mode=display">
\boldsymbol{A}^n=P(\boldsymbol{A})Q(\boldsymbol{A})+R(\boldsymbol{A})</script><p>äºæ˜¯æˆ‘ä»¬å‘ç°ï¼Œä¼¼ä¹æ ¹æ®å¸¦ä½™é™¤æ³•çš„æ€§è´¨$\deg (R(\boldsymbol{A}))\leq \deg(\boldsymbol{A}^n)=n$ï¼Œæ­£å¥½æ»¡è¶³$\deg(\sum_{i=0}^{k-1}g_i\boldsymbol{(F_0)}_i)\leq n$çš„æ€§è´¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘å½“$P(\boldsymbol{A})Q(\boldsymbol{A})$è¿™ä¸€é¡¹ä¸º$\boldsymbol{0}$æ—¶ï¼Œæ°å¥½æ„é€ å‡ºä¸€ç»„å¯è¡Œçš„ç­”æ¡ˆã€‚</p>
<p>æˆ‘ä»¬ç»“åˆç‰¹å¾å¤šé¡¹å¼è€ƒè™‘ï¼Œ$\phi(\lambda)=0$ï¼Œæ°å¥½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚äºæ˜¯æˆ‘ä»¬ç›´æ¥ä»¤$\boldsymbol{A}^n \bmod \phi(\lambda)$å³å¯æ±‚å‡º$R(\boldsymbol{A})=g$ã€‚</p>
<p>ç„¶åæ™®é€šçš„å°±å¯ä»¥ç›´æ¥$k^2$æš´åŠ›NTTï¼Œå¦‚æœå¾ˆé—²å¹¶ä¸”æ¨¡æ•°æ˜¯NTTæ¨¡æ•°çš„è¯è¿˜å¯ä»¥ç”¨$\log^2$çš„å¤æ‚åº¦æå‡ºæ¥ã€‚</p>
<p>ä»¥ä¸‹æ˜¯<a href="https://www.luogu.org/problem/P4723" target="_blank" rel="noopener">LuoguP4723</a></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Gp 3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 251003</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line">LL base[MAXN], p[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, M, L, K, R[MAXN] ;</span><br><span class="line">LL F[MAXN], G[MAXN], P[MAXN], Ans ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    rr LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) (res *= a) %= Mod ;</span><br><span class="line">        a = <span class="number">1l</span>l * a * a % Mod, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(LL *J, <span class="keyword">const</span> <span class="keyword">int</span> &amp;l, <span class="keyword">const</span> <span class="keyword">int</span> &amp;flag)</span></span>&#123;</span><br><span class="line">    rr LL Gn, Gi = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; l ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; R[i]) J[i] ^= J[R[i]] ^= J[i] ^= J[R[i]] ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; l ; i &lt;&lt;= <span class="number">1</span>)&#123;</span><br><span class="line">        Gn = expow(Gp, (Mod - <span class="number">1</span>) / (i &lt;&lt; <span class="number">1</span>)) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; l ; Gi = <span class="number">1</span>, j += (i &lt;&lt; <span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; i ; ++ k, Gi = <span class="number">1l</span>l * Gi * Gn % Mod)&#123;</span><br><span class="line">                <span class="keyword">int</span> real = J[j + k], iroot = <span class="number">1l</span>l * J[j + k + i] * Gi % Mod ;</span><br><span class="line">                J[j + k] = (real + iroot) % Mod, J[j + k + i] = (real - iroot + Mod) % Mod ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag &gt; <span class="number">0</span>) <span class="keyword">return</span> ;</span><br><span class="line">    rr <span class="keyword">int</span> Inv = expow(<span class="number">1l</span>l * l, Mod - <span class="number">2</span>) ; reverse(J + <span class="number">1</span>, J + l) ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; l ; ++ i) J[i] = <span class="number">1l</span>l * J[i] * Inv % Mod ;</span><br><span class="line">&#125;</span><br><span class="line">LL t[MAXN], T[MAXN] ;</span><br><span class="line"><span class="keyword">void</span> _Inv(LL *f, LL *g, <span class="keyword">int</span> len)&#123;</span><br><span class="line">    <span class="keyword">if</span> (len &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        g[<span class="number">0</span>] = expow(f[<span class="number">0</span>], Mod - <span class="number">2</span>) ;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    rr <span class="keyword">int</span> i, l = <span class="number">0</span>, Len = <span class="number">1</span> ;</span><br><span class="line">    _Inv(f, g, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (Len &lt; (len &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; len ; ++ i) t[i] = f[i] ;  NTT(g, Len, <span class="number">1</span>),  NTT(t, Len, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) g[i] = (<span class="number">2l</span>l - t[i] * g[i] % Mod + Mod) % Mod * g[i] % Mod ;</span><br><span class="line">    NTT(g, Len, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = len ; i &lt; Len ; ++ i) g[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line">LL IG[MAXN], Ft[MAXN], Gt[MAXN] ;</span><br><span class="line"><span class="keyword">void</span> _Div(LL *f, <span class="keyword">const</span> <span class="keyword">int</span> &amp;Len)&#123;</span><br><span class="line">    rr <span class="keyword">int</span> L1 = (K &lt;&lt; <span class="number">1</span>), D, i ;</span><br><span class="line">    <span class="keyword">while</span> (!f[-- L1]) ; <span class="keyword">if</span> (L1 &lt; K) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) Ft[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 ; ++ i) Ft[i] = f[i] ; D = L1 - K + <span class="number">1</span> ;</span><br><span class="line">    reverse(Ft, Ft + L1 + <span class="number">1</span>) ; <span class="keyword">for</span> (i = D ; i &lt;= L1 ; ++ i) Ft[i] = <span class="number">0</span> ;</span><br><span class="line">    NTT(Ft, Len, <span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) P[i] = Ft[i] * IG[i] % Mod ;</span><br><span class="line">    NTT(P, Len, - <span class="number">1</span>) ; <span class="keyword">for</span> (i = D ; i &lt;= L1 ; ++ i) P[i] = <span class="number">0</span> ; reverse(P, P + D) ;</span><br><span class="line">    NTT(P, Len, <span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) (P[i] *= G[i]) %= Mod ; NTT(P, Len, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; K ; ++ i) f[i] = (f[i] - P[i] + Mod) % Mod ; <span class="keyword">for</span> (i = K ; i &lt;= L1 ; ++ i) f[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    freopen("2.in", "r", stdin) ;</span></span><br><span class="line">    rr <span class="keyword">int</span> Len = <span class="number">1</span>, l = <span class="number">0</span>, i ; <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K ;</span><br><span class="line">    <span class="keyword">while</span> (Len &lt; (K &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l ; F[<span class="number">0</span>] = <span class="number">1</span> ; Len &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= K ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;p[i]), p[i] = p[i] &lt; <span class="number">0</span> ? p[i] + Mod : p[i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; K ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i]), base[i] = base[i] &lt; <span class="number">0</span> ? base[i] + Mod : base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= K ; ++ i) Gt[K - i] = G[K - i] = Mod - p[i] ; T[<span class="number">1</span>] = G[K] = Gt[K] = <span class="number">1</span> ;reverse(Gt, Gt + K + <span class="number">1</span>) ;</span><br><span class="line">    NTT(G, Len, <span class="number">1</span>) ; _Inv(Gt, IG, Len &gt;&gt; <span class="number">1</span>), NTT(IG, Len, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span>(N)&#123;</span><br><span class="line">        NTT(T, Len, <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (N &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            NTT(F, Len, <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) F[i] = F[i] * T[i] % Mod ;</span><br><span class="line">            NTT(F, Len, <span class="number">-1</span>) ; _Div(F, Len) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) (T[i] *= T[i]) %= Mod ; NTT(T, Len, <span class="number">-1</span>) ; _Div(T, Len), N &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; K ; ++ i) (Ans += (F[i] * base[i]) % Mod) %= Mod ; <span class="built_in">printf</span>(<span class="string">"%lld "</span>, Ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨</tag>
        <tag>å¤šé¡¹å¼çš„åº”ç”¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å¤šé¡¹å¼æ±‚å¹‚/å¼€æ ¹</title>
    <url>/2019/08/07/rooti/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å½¢å¼åŒ–æ¥è®²ï¼Œæˆ‘ä»¬è¦è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
G &= F^k \ (\bmod \ x^n)\\\
G^k &= F \ (\bmod \ x^n)
\end{aligned}</script><p>ç„¶è€Œå®é™…ä¸Šåä¸€ä¸ªå’•äº†ï¼Œæˆ‘æ›¾æŠŠè¿™ç©æ„å„¿å½“ä½œ<code>å¤šé¡¹å¼ç‰›é¡¿è¿­ä»£</code>çš„è¯¾åé¢˜æ¥ç€â€¦â€¦å¹¶ä¸”æ›´é‡è¦çš„åŸå› æ²¡äººå‡ºè¿™ç©æ„å„¿çš„é¢˜ï¼Œæ‰€ä»¥ç›´æ¥ç®€åŒ–æˆ$G^2\equiv F$å¥½äº†ã€‚ã€‚ã€‚</p>
<a id="more"></a>
<h1 id="1-æ±‚å¹‚"><a href="#1-æ±‚å¹‚" class="headerlink" title="$1$ æ±‚å¹‚"></a>$1$ æ±‚å¹‚</h1><p>é¦–å…ˆæ€è€ƒå¼å­</p>
<script type="math/tex; mode=display">
G=F^k(~\bmod~x^n)</script><p>æ€ä¹ˆåŒ–å¼€ã€‚é‚£ä¹ˆå–œé—»ä¹è§çš„å°±æ˜¯ä¸€æ­¥æ±‚å¯¹æ•°ç„¶åexpå›å»ï¼š</p>
<script type="math/tex; mode=display">
\ln G = k \ln F~(\bmod~x^n)\\\
\exp(k\ln F)=G~(\bmod ~x^n)</script><p>å¯¹åº”çš„æ˜¯<code>Luogu</code>çš„<a href="https://www.luogu.org/problem/P5245" target="_blank" rel="noopener"><code>P5245</code></a>:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, y ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N, M = <span class="number">1</span> ;</span><br><span class="line">    Gi = expow(Gp, P - <span class="number">2</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (M &lt;= N) M &lt;&lt;= <span class="number">1</span> ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; In ; y = <span class="built_in">strlen</span>(In) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;F[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; y ; ++ i) K = (K * <span class="number">10</span> + In[i] - <span class="string">'0'</span>) % P ;</span><br><span class="line">    _Ln(F, L, M) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) L[i] = <span class="number">1l</span>l * L[i] * K % P ;</span><br><span class="line">    _Exp(L, G, M) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) <span class="built_in">printf</span>(<span class="string">"%lld "</span>, G[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™ç§æ–¹æ³•åªèƒ½åº”ç”¨äº$a_0=1$çš„æƒ…å†µä¸‹ï¼ŒåŸå› åœ¨å†™<code>exp</code>çš„æ—¶å€™æ•´ç†è¿‡ã€‚</p>
<p>ä½†è¿™ä¸œè¥¿æ˜¾ç„¶æ˜¯å¯ä»¥$\Theta(n\log^2n)$æš´åŠ›nttåšçš„ï¼Œæˆ‘å¾ˆå¿«ä¹åœ°æ°´è¿‡äº†è¿™é“é¢˜çš„åŠ å¼ºç‰ˆ<a href="https://www.luogu.org/problem/P5273" target="_blank" rel="noopener"><code>P5273</code></a>ï¼Œå³ä¸ä¿è¯$a_0=1$çš„ç‰ˆæœ¬ï¼š</p>
<blockquote>
<p>ä¼¼ä¹å¤§å®¶éƒ½æ˜¯è¯¡å¼‚çš„å†™æ³•ï¼Œæ²¡æœ‰äººç”¨$O(n\log^2 n)$å»æš´åŠ›è‰¹è¿™é“é¢˜ã€‚</p>
<p>ç„¶è€Œäº‹å®ä¸Šæ˜¯å®Œå…¨å¯ä»¥å¡è¿‡å»çš„ã€‚æˆ‘çš„æäº¤è™½ç„¶åŠ äº†<code>-O2</code>å’Œ<code>#pragma</code><del>æ˜¾å¾—ååˆ†å¼Ÿå¼Ÿ</del>ï¼Œä½†æ˜¯å…¶å®å»æ‰ä¹‹åä¹Ÿæ˜¯å¾ˆå¿«çš„ã€‚ä¸å¹ï¼Œç»å¯¹æ¯”å¤§éƒ¨åˆ†çš„æ™®é€š$O(n\log^2n)$çš„NTTè·‘å¾—å¿«ã€‚</p>
<p>é‚£ä¹ˆä»¥ä¸‹æ˜¯å‡ ä¸ªä¼˜åŒ–çš„æªæ–½ï¼š<br>$\#1$</p>
<p>é¢„å¤„ç†åŸæ ¹çš„æ¬¡å¹‚â€”â€”å¡å¸¸åˆ©å™¨ã€‚</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">19</span>  ;++ i)&#123;</span><br><span class="line">        rr <span class="keyword">int</span> *rua = gg[i] ; rua[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">        rr <span class="keyword">int</span> gi = rua[<span class="number">1</span>] = expow(<span class="number">3</span>, <span class="number">998244352</span>/(<span class="number">1</span> &lt;&lt; (i + <span class="number">1</span>))) ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">2</span> ; j &lt; (<span class="number">1</span> &lt;&lt; i) ; ++ j) rua[j] = <span class="number">1l</span>l * rua[j - <span class="number">1</span>] * gi % P ;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç„¶åæ¯æ¬¡NTTå°±ä¸éœ€è¦é‡æ–°å†è®¡ç®—äº†ã€‚</p>
<p>$\#2$</p>
<p>åšå¿«é€Ÿå¹‚çš„æ—¶å€™æ³¨æ„å¯ä»¥å°‘å‡ æ¬¡<code>NTT</code>ã€‚è¿™ç‚¹å¸¸æ•°ä¼˜åŒ–ä¹Ÿæ˜¯éœ€è¦çš„ã€‚</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> (K)&#123;</span><br><span class="line">        NTT(F, M, <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (K &amp; <span class="number">1</span>)&#123;</span><br><span class="line">            NTT(A, M, <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; M ; ++ i) A[i] = <span class="number">1l</span>l * A[i] * F[i] % P ;</span><br><span class="line">            NTT(A, M, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = N ; i &lt; M ; ++ i) A[i] = <span class="number">0</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; M ; ++ i)</span><br><span class="line">            F[i] = <span class="number">1l</span>l * F[i] * F[i] % P ; NTT(F, M, <span class="number">-1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (i = N ; i &lt; M ; ++ i) F[i] = <span class="number">0</span> ; K &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>$\#3$</p>
<p>ä¸ç”¨<code>long long</code>.</p>
<p>è¿™å…¶å®ä¸€ä¸ªé€šç”¨çš„æŠ€å·§ï¼Œå› ä¸ºlong longä¸€èˆ¬éƒ½æ¯”intå¤šå¥½å¤šå¸¸æ•°ã€‚åŒæ—¶ä¸è¦å¼ºåˆ¶ç±»å‹è½¬æ¢è€Œé€‰æ‹©<code>1ll*</code>è¿™ç§å½¢å¼ã€‚å®æµ‹å¯ä»¥å¿«è®¸å¤šã€‚</p>
</blockquote>
<p>ä¸å¾—ä¸è¯´ï¼Œè¿™ä¸ªé¢„å¤„ç†åŸæ ¹ç¡®å®æ˜¯ä¸€ä¸ªå¡å¸¸é»‘ç§‘æŠ€qwq</p>
<h1 id="2-å¼€æ ¹"><a href="#2-å¼€æ ¹" class="headerlink" title="$2$ å¼€æ ¹"></a>$2$ å¼€æ ¹</h1><p>æ™®é€šçš„å¼€æ ¹è¿˜æ˜¯<code>exp</code>å’Œ<code>ln</code>ï¼š</p>
<script type="math/tex; mode=display">
G^2=F\\\
2 \ln G = \ln F\\\
G = \exp(\frac{\ln F}{2})</script><p>ç„¶åå°±å¯ä»¥èƒ¡æ<a href="https://www.luogu.org/problem/P5205" target="_blank" rel="noopener">LuoguP5205</a>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> _Invsqr(<span class="keyword">int</span> *f, <span class="keyword">int</span> *g, <span class="keyword">int</span> len)&#123;</span><br><span class="line">    <span class="keyword">int</span> Len = <span class="number">1</span>, l = <span class="number">0</span>, i, o ;</span><br><span class="line">    <span class="keyword">while</span> (Len &lt; (len &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l ; o = expow(<span class="number">2l</span>l, P - <span class="number">2</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; l - <span class="number">1</span>) ;</span><br><span class="line">    _Ln(f, E, M) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) E[i] = E[i] * o % P ; _Exp(E, g, M) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œå°±æ˜¯å› ä¸ºéœ€è¦$\exp$ï¼Œä¸Šè¿°ä¹Ÿå¿…é¡»è¦$F_0=1$ã€‚äºæ˜¯å½“$F_0\neq 1$æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æš´åŠ›æ±‚<strong>äºŒæ¬¡å‰©ä½™</strong>ï¼Œæ³¨æ„è¿™ç§æ–¹æ³•å°±éœ€è¦ç”¨ç‰›è¿­æ¥å®ç°å¼€æ ¹</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> solveroot&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> fr first</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> pint pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> mp(a, b) make_pair(a, b)</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">complex</span>&#123;</span> <span class="keyword">int</span> x, y ; &#125; ;</span><br><span class="line">    <span class="function"><span class="keyword">complex</span> <span class="title">mul</span><span class="params">(<span class="keyword">complex</span> a, <span class="keyword">complex</span> b, <span class="keyword">int</span> p, <span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> nx = (<span class="number">1l</span>l * a.x * b.x % p + <span class="number">1l</span>l * a.y * b.y % p * rt % p) ;</span><br><span class="line">        <span class="keyword">int</span> ny = (<span class="number">1l</span>l * a.x * b.y % p + <span class="number">1l</span>l * a.y * b.x % p) ;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">complex</span>)&#123;nx % p, ny % p&#125; ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">complex</span> <span class="title">expow</span><span class="params">(<span class="keyword">complex</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p, <span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">        <span class="keyword">complex</span> res = (<span class="keyword">complex</span>)&#123;<span class="number">1</span>, <span class="number">0</span>&#125; ;</span><br><span class="line">        <span class="keyword">while</span> (b)&#123;</span><br><span class="line">            <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">                res = mul(res, a, p, z), b -- ;</span><br><span class="line">            a = mul(a, a, p, z), b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (b)&#123;</span><br><span class="line">            <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">                res = <span class="number">1l</span>l * a * res % p ;</span><br><span class="line">            a = <span class="number">1l</span>l * a * a % p ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">seed</span><span class="params">()</span></span>&#123;</span><br><span class="line">        srand((<span class="keyword">int</span>)<span class="string">'x'</span>+<span class="string">'q'</span>+<span class="string">'I'</span>+<span class="string">'L'</span>+<span class="string">'o'</span>+<span class="string">'v'</span>+<span class="string">'e'</span>+<span class="string">'u'</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">pint <span class="title">solve</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">        seed() ;</span><br><span class="line">        <span class="keyword">if</span> (!n) <span class="keyword">return</span> mp(<span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">int</span> x, y ;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">            x = rand() % p ;</span><br><span class="line">            y = (<span class="number">1l</span>l * x * x + (p - n)) % p ;</span><br><span class="line">            <span class="keyword">if</span> (expow(y, (p - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, p) == p - <span class="number">1</span>) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">complex</span> now = (<span class="keyword">complex</span>)&#123;x, <span class="number">1</span>&#125;, ansp, ansn ;</span><br><span class="line">        ansp = expow(now, (p + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, p, y),</span><br><span class="line">        ansn = (<span class="keyword">complex</span>)&#123;p - ansp.x, ansp.y&#125; ;</span><br><span class="line">        <span class="keyword">if</span> (ansp.x &gt; ansn.x) swap(ansp, ansn) ;</span><br><span class="line">        <span class="keyword">return</span> mp(ansp.x, ansn.x) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">LL Ig[MAXN], pf[MAXN] ;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> solveroot ;</span><br><span class="line"><span class="keyword">void</span> _sqr(LL *f, LL *g, <span class="keyword">int</span> len)&#123;</span><br><span class="line">    <span class="keyword">if</span> (len &lt;= <span class="number">1</span>)&#123;</span><br><span class="line">        g[<span class="number">0</span>] = solve(f[<span class="number">0</span>], P).fr ;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    rr <span class="keyword">int</span> i, l = <span class="number">0</span>, Len = <span class="number">1</span> ;</span><br><span class="line">    _sqr(f, g, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (Len &lt; (len &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = len ; i &lt; Len ; ++ i) pf[i] = Ig[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; len ; ++ i) Ig[i] = <span class="number">0</span>, pf[i] = <span class="number">2</span> * g[i] % P ;</span><br><span class="line">    _Inv(pf, Ig, len) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) <span class="comment">/* */</span> t[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; ( l - <span class="number">1</span> )) ;</span><br><span class="line">    NTT(g, Len, <span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) g[i] = g[i] * g[i] % P ;</span><br><span class="line">    NTT(g, Len, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; len ; ++ i) g[i] = (g[i] + f[i]) % P ;</span><br><span class="line">    NTT(g, Len, <span class="number">1</span>) ; NTT(Ig, Len, <span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) g[i] = g[i] * Ig[i] % P ;</span><br><span class="line">    NTT(g, Len, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = len ; i &lt; Len ; ++ i) g[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åä¸ºäº†åšè¿™é“é¢˜è¿˜å»å­¦äº†<code>Cipolla</code>ï¼Œç„¶åè¿˜é¡ºä¾¿å‘ç°luoguä¸Šå°‘ä¸€é“äºŒæ¬¡å‰©ä½™çš„æ¿å­å°±é¡ºæ‰‹å‡ºäº†é“é¢˜2333</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¤šé¡¹å¼</category>
      </categories>
      <tags>
        <tag>å¤šé¡¹å¼åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å¤šé¡¹å¼å¸¦ä½™é™¤æ³•</title>
    <url>/2019/08/07/chumod/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è§£å†³ä¸€ç±»</p>
<script type="math/tex; mode=display">
G=F\cdot P+R ~(\bmod~x^n)</script><p>å…¶ä¸­$F, G$ç»™å®šï¼Œæ±‚è§£$P$å’Œ$R$</p>
<p><del>ç„¶è€Œæœ€åå˜æˆäº†è€å¹´é€‰æ‰‹çš„å¤šé¡¹å¼çå¹ï¼Ÿ</del></p>
<a id="more"></a>
<h1 id="1"><a href="#1" class="headerlink" title="$1$"></a>$1$</h1><p>è¿™å°±å¾ˆè‹Ÿï¼Œæœ€è¿‘è¦è¢«å¤šé¡¹å¼é™¤æ³•ç»™æ•´ç–¯äº†ï¼ŒåŸå› å¤§æ¦‚æ˜¯æˆ‘æ¢ä¸€é“æ¨¡æ¿å°±éœ€è¦æ¢ä¸€ç§å†™æ³•â€¦â€¦åŸæ¥é‚£ç§æ€ä¹ˆæ”¹éƒ½ä¸å¯¹å°±å¾ˆæ™ºéšœâ€¦â€¦</p>
<p>ç„¶ååˆ’å¼å­è¿‡ç¨‹å°±å¾ˆè‹Ÿï¼Œæ˜¯ä¸€ç§è¯¡å¼‚çš„æ„é€ æ–¹å¼ï¼Œå‰ç½®èŠå£«å¤§æ¦‚æ˜¯$F(\frac{1}{x})=F^T(x)$ï¼Œå…¶ä¸­$T$è¡¨ç¤ºè½¬ç½®â€”â€”å½“ç„¶æ˜¯ä¸€ä¸ªä¸ä¸¥è°¨çš„è®°å·ï¼Œæ„æ€å°±æ˜¯æŠŠè¿™ä¸ªå½¢å¼å¹‚çº§æ•°çš„ç³»æ•°<code>reverse</code>æ‰ã€‚</p>
<p>ä»¥ä¸‹æ˜¯è¿‡ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
G(x)&=F(x)P(x)+R(x)\\\
G(\frac{1}{x})&=F(\frac{1}{x})P(\frac{1}{x})+R(\frac{1}{x})\\\
\because A_r&= x^nA(\frac{1}{x})\\\
\therefore x^nG(\frac{1}{x})&=x^nF(\frac{1}{x})P(\frac{1}{x})+x^nR(\frac{1}{x})\\\
\Longrightarrow x^nG(\frac{1}{x})&=x^mF(\frac{1}{x})\cdot x^{n-m}P(\frac{1}{x})+x^{m-1}\cdot x^{n-m+1}R(x)\\\
\Longrightarrow G_r(x)&=F_r(x)\cdot P_r(x)+x^{n-m+1}R_r(x)\\\
\Longrightarrow G_r(x)&=F_r(x)\cdot P_r(x)+x^{n-m+1}R_r(x) ~(\bmod x^{n-m+1})\\\
\Longrightarrow P_r(x)&=F_r(x)\cdot G_r^{-1}(x)~(\bmod x^{n-m+1})\\\
\end{aligned}</script><p>ä¹‹åæ±‚å‡º$P_r$ä¹‹åå°±å¯ä»¥å›ä»£åŸå¼ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
G=F\cdot P+R\\\
R = G - F\cdot P
\end{aligned}</script><p>äºæ˜¯å°±å®Œäº†</p>
<h1 id="2"><a href="#2" class="headerlink" title="$2$"></a>$2$</h1><p>ä½†æ˜¯å®é™…å†™æ³•æœ‰äº›é—®é¢˜ï¼Œæ¯”å¦‚æ¿å­<a href="https://www.luogu.org/problem/P4512" target="_blank" rel="noopener">P4512 ã€æ¨¡æ¿ã€‘å¤šé¡¹å¼é™¤æ³•</a></p>
<p>è¿™å…¶å®å°±ç›´æ¥åšå°±å¥½ï¼Œä¸æ˜¯å¾ˆéœ€è¦è€ƒè™‘æ¸…é›¶ä»€ä¹ˆçš„ã€‚ä½†æ˜¯æˆ‘æ€»è§‰å¾—åœ¨<code>Inv</code>ä¹‹åæ˜¯ä¸æ˜¯éœ€è¦é‡æ–°ç®—ä¸€ä¸‹<code>R</code>â€¦â€¦ä¸æ¸…æ¥šè¯¶ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">LL Ft[MAXN], Gt[MAXN], IG[MAXN] ;</span><br><span class="line"><span class="keyword">void</span> _Div()&#123;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, O = N - M + <span class="number">1</span> ;</span><br><span class="line">    reverse(Ft, Ft + N), reverse(Gt, Gt + M) ;</span><br><span class="line">    l = <span class="number">0</span>, L = <span class="number">1</span> ; <span class="keyword">while</span> (L &lt; (O &lt;&lt; <span class="number">1</span>)) L &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = O ; i &lt; N ; ++ i) Ft[i] = Gt[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;</span><br><span class="line">    _Inv(Gt, IG, O), NTT(IG, L, <span class="number">1</span>), NTT(Ft, L, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i) P[i] = Ft[i] * IG[i] % Mod ; NTT(P, L, - <span class="number">1</span>) ; reverse(P, P + O) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; O ; ++ i) <span class="built_in">printf</span>(<span class="string">"%lld "</span>, P[i]) ; <span class="keyword">for</span> (<span class="keyword">int</span> i = O ; i &lt; N ; ++ i) P[i] = <span class="number">0</span> ;</span><br><span class="line">    O = N, L = <span class="number">1</span>, l = <span class="number">0</span> ; <span class="keyword">while</span> (L &lt; (O &lt;&lt; <span class="number">1</span>)) L &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;</span><br><span class="line">    NTT(P, L, <span class="number">1</span>), NTT(G, L, <span class="number">1</span>) ; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i) Q[i] = (P[i] * G[i]) % Mod ; NTT(Q, L, <span class="number">-1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M, ++ N, ++ M ; <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;F[i]), Ft[i] = F[i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; M ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;G[i]), Gt[i] = G[i] ; _Div() ;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; M - <span class="number">1</span> ; ++ i) <span class="built_in">printf</span>(<span class="string">"%lld "</span>, (F[i] - Q[i] + Mod) % Mod) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ä¹‹åçº¿æ€§é€’æ¨æ—¶éœ€è¦è¿›è¡Œçš„å–æ¨¡æ“ä½œï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> _Div(LL *f, <span class="keyword">int</span> Len)&#123;</span><br><span class="line">    <span class="keyword">int</span> L1 = (K &lt;&lt; <span class="number">1</span>), D, i ;</span><br><span class="line">    <span class="keyword">while</span> (!f[-- L1]) ; <span class="keyword">if</span> (L1 &lt; K) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) Ft[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 ; ++ i) Ft[i] = f[i] ; reverse(Ft, Ft + L1 + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (D = L1 - K + <span class="number">1</span>, i = D ; i &lt;= L1 ; ++ i) Ft[i] = <span class="number">0</span> ; NTT(Ft, Len, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) P[i] = Ft[i] * IG[i] % Mod ; NTT(P, Len, - <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = D ; i &lt;= L1 ; ++ i) P[i] = <span class="number">0</span> ; reverse(P, P + D) ; NTT(P, Len, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) Q[i] = (P[i] * G[i]) % Mod ; NTT(Q, Len, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; K ; ++ i) f[i] = (f[i] - Q[i] + Mod) % Mod ; <span class="keyword">for</span> (i = K ; i &lt;= L1 ; ++ i) f[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//main_function</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= K ; ++ i) G[K - i] = Mod - p[i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= K ; ++ i) Gt[i] = G[i] ; reverse(Gt, Gt + K + <span class="number">1</span>) ;</span><br><span class="line">    NTT(G, Len, <span class="number">1</span>) ; _Inv(Gt, IG, Len &gt;&gt; <span class="number">1</span>), NTT(IG, Len, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;</span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸Šå»å¾ˆæ­£å¸¸ï¼Œåªæ˜¯å¤šäº†å‡ ä¸ªé¢„å¤„ç†è€Œå·²ã€‚ä½†æ˜¯ä¸çŸ¥ä¸ºä½•å½“æ—¶å†™çš„å°±å¾ˆè¿·ã€‚ã€‚ã€‚å¹¶ä¸”ä»è¿™ä¸ªæ¿å­å¼€å§‹æˆ‘æ˜ç™½äº†ï¼Œ<strong>å¤šé¡¹å¼é•¿åº¦+æ˜¯å¦æ¸…ç©º</strong>è¿™ä¸ªç»„åˆç»å¯¹æ˜¯å¤šé¡¹å¼å…¥é—¨é‡Œé¢æœ€éš¾å—çš„ç»†èŠ‚ã€‚</p>
<p>ä¹‹åå°±æ›´è¿·äº†ï¼Œå¤šç‚¹æ±‚å€¼è¿™ç©æ„å„¿å®åœ¨æ¯’ç˜¤ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Mod(<span class="keyword">int</span> *f,  <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g, <span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="keyword">int</span>* Rs)&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> l = <span class="number">0</span>, O = n - m + <span class="number">1</span>, L , i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= (n &lt;&lt; <span class="number">1</span>) ; ++ i) ig[i] = ft[i] = gt[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= n ; ++ i) ft[i] = f[n - i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= m ; ++ i) gt[i] = g[m - i] ; l = <span class="number">0</span>, L = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = O ; i &lt; (n &lt;&lt; <span class="number">1</span>); ++ i) ft[i] = gt[i] = <span class="number">0</span> ;</span><br><span class="line">    Inv(gt, ig, O) ; <span class="keyword">while</span> (L &lt; (O &lt;&lt; <span class="number">1</span>)) L &lt;&lt;= <span class="number">1</span>,++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L ; ++ i) t[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;</span><br><span class="line">    NTT(ig, L, <span class="number">1</span>), NTT(ft, L, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) X[i] = <span class="number">1l</span>l * ft[i] * ig[i] % Mod ;</span><br><span class="line">    NTT(X, L, - <span class="number">1</span>) ; reverse(X, X + O) ; <span class="keyword">for</span> (i = O ; i &lt; L ; ++ i) X[i] = <span class="number">0</span> ;</span><br><span class="line">    O = n + <span class="number">1</span>, L = <span class="number">1</span>, l = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (L &lt; (O &lt;&lt; <span class="number">1</span>)) L &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) G[i] = Y[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= m ; ++ i) G[i] = g[i] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>))  ;</span><br><span class="line">    NTT(X, L, <span class="number">1</span>) ; NTT (G, L, <span class="number">1</span>)  ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; L ; ++ i) Y[i] = <span class="number">1l</span>l * G[i] * X[i] % Mod, X[i] = <span class="number">0</span> ;</span><br><span class="line">    NTT(Y, L, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= m - <span class="number">1</span> ; ++ i) Rs[i] = ((<span class="number">1l</span>l * f[i] - Y[i]) + Mod) % Mod ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™å°±å¾ˆçƒ¦â€¦â€¦é¬¼çŸ¥é“ä½ tmä»€ä¹ˆæ—¶å€™å¿˜æ¸…ç©ºæˆ–è€…å¿˜å¼€<code>long long</code>äº†å°±è¦è°ƒä¸€å¹´â€¦â€¦è‰¹</p>
<h1 id="3"><a href="#3" class="headerlink" title="$3$"></a>$3$</h1><p>æœ€åè¶æœºè¯´ä¸€ä¸‹å†™å¤šé¡¹å¼çš„å¿ƒå¾—<del>å…¶å®å°±æ˜¯çå¹</del>ï¼š</p>
<ul>
<li>å¥½çƒ¦å•Šï¼ˆ</li>
<li>ä»£ç å¥½é•¿å•Šï¼ˆ</li>
<li>ä¸ºä»€ä¹ˆè¸é©¬æ¯æ¬¡å¾’æ‰‹å†™NTTéƒ½ä¼šæŒ‚å•Šï¼ˆ</li>
<li>å­¦äº†åŠå¤©åŸæ¥FFTæ˜¯æœ€æ²¡ç”¨çš„å•Šï¼ˆ</li>
<li>è°ƒæ­»æˆ‘äº†å•Š</li>
<li>è¿˜ä¸å¦‚ç›´æ¥ç…§ç€æ¨¡æ¿èƒŒå‘¢ï¼Œæ¯å¤©æ—©è¯»èƒŒä¸€å‘ï¼Œé‚£ä¸ªä»€ä¹ˆæ•™è¾…ä¸æ˜¯è¯´æ¥ç€ï¼Ÿâ€œèƒŒè™½ä¼ ç»Ÿï¼Œä¹Ÿæœ€å®ç”¨â€ï¼ˆ</li>
<li>å§æ§½æ¯æ¬¡å†™ä¸€é“æ¿å­å°±è¦äº¤ä¸Šä¸€æ•´é¡µ<del>ï¼Œæˆ‘ä¸è¦é¢å­çš„å—</del>ï¼ˆ</li>
</ul>
<p>æ­£ç»ä¸€ç‚¹çš„è¯ï¼Œå¤§æ¦‚å°±æ˜¯æˆ‘è¿™å‡ ä¸ªæ¿å­éƒ½æ˜¯ç”¨æ•°ç»„å†™çš„ï¼Œæ‰€ä»¥ä¼šæœ‰<code>memset</code>æˆ–è€…<code>for for for</code>ä¹‹ç±»çš„ï¼Œé—²å¾—å¾ˆå‡Œä¹±ã€‚å†åŠ ä¸Šä¹‹å‰å¾ˆæ™ºéšœåœ°æ¯æ¬¡éƒ½è¦é‡æ–°æ¨ä¸€éè´è¶æ“ä½œçš„<code>Rev</code>æ•°ç»„ï¼Œå°±æ˜¾å¾—å¾ˆå¼±æ™ºã€‚äºæ˜¯å†³å®šä¸‹ä¸€æ¬¡å¤šé¡¹å¼å¤ä¹ çš„æ—¶å€™ï¼Œè‡ªå·±å¯ä»¥å­¦çš„æ›´æˆä½“ç³»ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸Š<code>operator</code>å’Œ<code>vector</code>è¿™ä¸¤ä¸ªåˆ©å™¨ã€‚</p>
<p>updï¼šå°±åœ¨è½ç¬”ä¸åˆ°5minä¹‹åæƒ³åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä½ ä¼šå‘ç°åœ¨å¤šé¡¹å¼é¢˜ç›®é‡Œé¢æœ‰$\mod x^n$å’Œ$\mod \rm{NTTPrime}$ ä¸¤ç§çº¦æŸï¼Œä¸€ç›´ä»¥ä¸ºçš„æ˜¯<code>ä¸åŒçš„è¿ç®—æœ‰ä¸åŒçš„çº¦æŸ</code>ï¼Œä½†è¿™æ˜¯$\color{red}{\text{é”™çš„}}$ ã€‚çœŸæ­£çš„åŒºåˆ«æ˜¯ï¼Œå‰è€…æ˜¯å¯¹æ¬¡æ•°çš„çº¦æŸï¼Œåè€…æ˜¯å¯¹ç³»æ•°çš„çº¦æŸã€‚</p>
<p>= =ä¹Ÿå°±åªæœ‰æˆ‘ä¼šæ™ºéšœåˆ°ç°åœ¨æ‰æ˜ç™½ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¤šé¡¹å¼</category>
      </categories>
      <tags>
        <tag>å¤šé¡¹å¼åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å¤šé¡¹å¼ln/exp</title>
    <url>/2019/08/07/lnexp/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å…¶å®è¿™ä¸¤ä¸ªä¸œè¥¿åªæ˜¯ä¸€ä¸ªæ‹“å±•ï¼Œæ€æƒ³ä¹Ÿæ˜¯ç®€å•çš„æ€æƒ³ï¼Œåªä¸è¿‡ç”±äº$\ln$è¿ç®—çš„ä¹˜æ–¹è½¬ä¹˜æ³•å¾ˆå¥½ç”¨ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†å¥—è·¯éƒ½æ˜¯<strong>å…ˆå¤šé¡¹å¼$\ln$ä¹±æä¸€é€šå†å¤šé¡¹å¼$\exp$å›å»</strong>ã€‚</p>
<p>å½¢å¼åŒ–åœ°è®²ï¼Œæˆ‘ä»¬å°±æ˜¯è¦è§£å†³ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
1)\quad G&= \ln F \ (\bmod \ p)\\\
2)\quad G&= e^{F} \ (\bmod \ p)
\end{aligned}</script><a id="more"></a>
<h1 id="1-ln"><a href="#1-ln" class="headerlink" title="$1~\ln$"></a>$1~\ln$</h1><p>å…¶å®å°±æ˜¯çjbè®°ä¸€ä¸‹å¼å­å•¦</p>
<script type="math/tex; mode=display">
G'= F'\cdot \frac{1}{F}=\frac{F'}{F}</script><p>â€¦â€¦ç„¶åå°±å…ˆå¯¹Fæ±‚ä¸ªå¯¼+æ±‚ä¸ªé€†ç„¶åå†ä¸å®šç§¯åˆ†å›å»å°±å¥½ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> A[MAXN], B[MAXN] ;</span><br><span class="line"><span class="keyword">void</span> _Dev(<span class="keyword">int</span> *f, <span class="keyword">int</span> *g, <span class="keyword">int</span> len)&#123;</span><br><span class="line">    <span class="keyword">int</span> i ; g[len - <span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt; len ; ++ i) g[i - <span class="number">1</span>] = i * f[i] % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _Invdev(<span class="keyword">int</span> *f, <span class="keyword">int</span> *g, <span class="keyword">int</span> len)&#123;</span><br><span class="line">    g[<span class="number">0</span>] = <span class="number">0</span> ; <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt; len ; ++ i) g[i] = f[i - <span class="number">1</span>] * expow(i, P - <span class="number">2</span>) % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _Ln(<span class="keyword">int</span> *f, <span class="keyword">int</span> *g, <span class="keyword">int</span> len)&#123;</span><br><span class="line">    _Dev(f, A, len), _Inv(f, B, len) ; <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">int</span> Len = <span class="number">1</span>, l = <span class="number">0</span> ; <span class="keyword">while</span> (Len &lt; (len &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>)) ;</span><br><span class="line">    NTT(A, Len, <span class="number">1</span>), NTT(B, Len, <span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) A[i] = <span class="number">1l</span>l * A[i] * B[i] % P ;</span><br><span class="line">    NTT(A, Len, <span class="number">-1</span>), _Invdev(A, g, len) ; <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿç®—æ˜¯å°æ¸…æ–°çš„å¤šé¡¹å¼æ¿å­äº†ï¼Œæ¯•ç«Ÿæ²¡æœ‰è¯¡å¼‚çš„æ¸…ç©ºå’Œé¬¼ç•œçš„ç é•¿ã€‚</p>
<h1 id="2-exp"><a href="#2-exp" class="headerlink" title="$2~\exp$"></a>$2~\exp$</h1><script type="math/tex; mode=display">
\begin{aligned}
G &= G_h - \frac{T(G_h)}{T'(G_h)}\\\
\Longrightarrow G &= G_h-\frac{\ln G_h -F}{\frac{1}{G_h}}\\\
\Longrightarrow G &=G_h-G_h\ln G_h+G_hF\\\
\Longrightarrow G &=G_h(1-\ln G_h+F)\\\
\end{aligned}</script><p>ç„¶åéœ€è¦çš„çŸ¥è¯†ç‚¹å°±æ˜¯<strong>ç‰›é¡¿è¿­ä»£</strong>äº†ï¼Œè¿™ç©æ„å„¿ä¹‹å‰å†™è¿‡ï¼Œæ‡’å¾—å†å™è¿°ä¸€éäº†â€¦â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> _Ln(<span class="keyword">int</span> *f, <span class="keyword">int</span> *g, <span class="keyword">int</span> len)&#123;</span><br><span class="line">    <span class="keyword">int</span> i, Len = <span class="number">1</span>, l = <span class="number">0</span> ;</span><br><span class="line">    _Dev(f, A, len) ; _Inv(f, B, len) ;</span><br><span class="line">    <span class="keyword">while</span> (Len &lt; (len &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line"><span class="comment">//    for (i = 0 ; i &lt;= Len ; ++ i) cout &lt;&lt; A[i] &lt;&lt; " " &lt;&lt; B[i] &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; l - <span class="number">1</span>) ;</span><br><span class="line">    NTT(A, Len, <span class="number">1</span>), NTT(B, Len, <span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) A[i] = A[i] * B[i] % P ;</span><br><span class="line">    NTT(A, Len, <span class="number">-1</span>), _Invdev(A, g, len) ; <span class="built_in">memset</span>(t, <span class="number">0</span>, <span class="keyword">sizeof</span>(t)), <span class="built_in">memset</span>(B, <span class="number">0</span>, <span class="keyword">sizeof</span>(B)),  <span class="built_in">memset</span>(A, <span class="number">0</span>, <span class="keyword">sizeof</span>(A)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> C[MAXN], D[MAXN] ;</span><br><span class="line"><span class="keyword">void</span> _Exp(<span class="keyword">int</span> *f, <span class="keyword">int</span> *g, <span class="keyword">int</span> len)&#123;</span><br><span class="line">    <span class="keyword">if</span>(len == <span class="number">1</span>)&#123; g[<span class="number">0</span>] = <span class="number">1</span> ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">    _Exp(f, g, len + <span class="number">1</span> &gt;&gt; <span class="number">1</span>) ; <span class="keyword">int</span> Len = <span class="number">1</span>, l = <span class="number">0</span>, i ;</span><br><span class="line">    <span class="keyword">while</span> (Len &lt; (len &lt;&lt; <span class="number">1</span>)) Len &lt;&lt;= <span class="number">1</span>, ++ l ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; l - <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; (len &lt;&lt; <span class="number">1</span>) ; ++ i) C[i] = D[i] = <span class="number">0</span> ; _Ln(g, C, len) ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span> ; i &lt; len ; ++ i) D[i] = f[i] ;</span><br><span class="line">    NTT(g, Len, <span class="number">1</span>), NTT(C, Len, <span class="number">1</span>), NTT(D, Len, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) g[i] = (<span class="number">1l</span>l + D[i] - C[i] + P) * g[i] % P ;</span><br><span class="line">    NTT(g, Len, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = len ; i &lt;= Len ; ++ i) g[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¯”è¾ƒé‡è¦çš„å°±æ˜¯<strong>æ¸…ç©º</strong>ï¼Œç”±äº$\exp$æ˜¯è¿­ä»£å®ç°çš„ï¼Œæ‰€ä»¥è¦è¿›è¡Œå¤šæ¬¡$\ln$ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¤šé¡¹å¼</category>
      </categories>
      <tags>
        <tag>å¤šé¡¹å¼åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å½¢å¼å¹‚çº§æ•°çš„ç‰›é¡¿è¿­ä»£</title>
    <url>/2019/08/01/diedai/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤šé¡¹å¼çš„ç‰›é¡¿è¿­ä»£ï¼Œæ˜¯å€ŸåŠ©æ³°å‹’å±•å¼€è¿›è¡Œçš„ä¸€ç§å¯¹äºå½¢å¼å¹‚çº§æ•°çš„å¸¸è§„æ“ä½œï¼Œè§£å†³çš„ä¸»è¦é—®é¢˜æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
G(F) \equiv 0~(\bmod x^n)</script><p>ç»™å®šå½¢å¼å¹‚çº§æ•°$G$ï¼Œæ±‚è§£$F$ã€‚</p>
<p>è€Œè§£å†³é€”å¾„åˆ™æ˜¯é€šè¿‡å¯¹é™åŠæ¬¡çš„$F_0$å‘ä¸Šè¿­ä»£è§£å†³çš„ã€‚</p>
<a id="more"></a>
<h1 id="1"><a href="#1" class="headerlink" title="$1$"></a>$1$</h1><p>å‡è®¾æˆ‘ä»¬ç°åœ¨å·²ç»æ±‚å‡ºäº†$G(F_0)\equiv 0~(\bmod~x^{\frac{n}{2}})$</p>
<p>é¦–å…ˆä¹‹å‰æ ‡å‡†çš„å¼å­å·¦è¾¹åœ¨$F_0(x)$å¤„è¿›è¡Œæ³°å‹’å±•å¼€ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned} G(F(x)) &=G\left(F_{0}(x)\right) \\\ &+\frac{G^{\prime}\left(F_{0}(x)\right)}{1 !}\left(F(x)-F_{0}(x)\right) \\\ &+\frac{G^{\prime \prime}\left(F_{0}(x)\right)}{2 !}\left(F(x)-F_{0}(x)\right)^{2} \\\ &+\cdots (\mod ~x^n)\end{aligned}</script><p>ä½†æ˜¯æˆ‘ä»¬è€ƒè™‘åœ¨$\mod ~x^n$æ„ä¹‰ä¸‹ï¼Œ$F$å’Œ$F_0$çš„æœ€å$\frac{n}{2}$é¡¹ç›¸åŒï¼Œæ‰€ä»¥åœ¨ä¸Šé¢çš„å¼å­ï¼Œ$(F-F_0)^k,~k&gt;2$æ—¶ï¼Œæœ€ä½æ¬¡é¡¹çš„æ¬¡æ•°ä¸€å®šä¼šå¤§äº$2\cdot\lfloor \frac{n}{2}\rfloor$ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨$\mod~x^n$æ„ä¹‰ä¸‹éƒ½æ˜¯å…¨0é¡¹ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
G(F(x)) \equiv G\left(F_{0}(x)\right)+G^{\prime}\left(F_{0}(x)\right)\left(F(x)-F_{0}(x)\right) \quad\left(\bmod x^{n}\right)</script><p>ç„¶åå› ä¸º$G(F)=0~(\bmod~x^n)$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
F(x)\equiv F_0(x) - \frac{G(F_0(x))}{G^{\prime}\left(F_{0}(x)\right)} \quad\left(\bmod x^{n}\right)</script><p>äºæ˜¯ç›´æ¥é€’æ¨å°±å¥½ã€‚</p>
<h1 id="2"><a href="#2" class="headerlink" title="$2$"></a>$2$</h1><p><del>æ¥ä¸‹æ¥çœ‹å‡ ä¸ªè¯¾åç»ƒä¹ </del></p>
<h3 id="1-G-2-equiv-F-bmod-x-n"><a href="#1-G-2-equiv-F-bmod-x-n" class="headerlink" title="$(1)~G^2\equiv F~(\bmod~x^n)$"></a>$(1)~G^2\equiv F~(\bmod~x^n)$</h3><script type="math/tex; mode=display">
\begin{aligned}  
G^2&=F\\\
G^2-F&=0\\\
\end{aligned}</script><p>ä»¤$T(G)=G^2-F$,<del>å¥—ç”¨å…¬å¼</del>å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
T(G)&=G^2-F,F\Longleftrightarrow \mathbb{C} \\\
G &= G_h-\frac{T(G_h)}{T'(G_h)}\\\
\Longrightarrow G&=G_h-\frac{G_h^2-F}{2G_h}\\\
\Longrightarrow G&=\frac{G_h^2+F}{2G_h}
\end{aligned}</script><h3 id="2-G-equiv-e-F-bmod-x-n"><a href="#2-G-equiv-e-F-bmod-x-n" class="headerlink" title="$(2)~G\equiv e^{F}~(\bmod ~x^n)$"></a>$(2)~G\equiv e^{F}~(\bmod ~x^n)$</h3><p><del>æŒ‰ç…§å¥—è·¯åº”è¯¥</del>ä¸¤è¾¹åŒæ—¶å–$\ln$:</p>
<script type="math/tex; mode=display">
\ln G=F~(\bmod~x^n)</script><p>ä¹‹åæˆ‘ä»¬ä»¤$T(G)=\ln G-F$ï¼Œ<del>å¥—ç”¨å…¬å¼å¯ä»¥å¾—åˆ°</del></p>
<script type="math/tex; mode=display">
\begin{aligned}
G &= G_h - \frac{T(G_h)}{T'(G_h)}\\\
\Longrightarrow G &= G_h-\frac{\ln G_h -F}{\frac{1}{G_h}}\\\
\Longrightarrow G &=G_h-G_h\ln G_h+G_hF\\\
\Longrightarrow G &=G_h(1-\ln G_h+F)\\\
\end{aligned}</script><h3 id="3-G-k-equiv-F-bmod-x-n"><a href="#3-G-k-equiv-F-bmod-x-n" class="headerlink" title="$(3)~G^k\equiv F~(\bmod ~x^n)$"></a>$(3)~G^k\equiv F~(\bmod ~x^n)$</h3><script type="math/tex; mode=display">
T(G) = G^k-F=0</script><p><del>å¥—ç”¨å…¬å¼å¯ä»¥å¾—åˆ°</del></p>
<script type="math/tex; mode=display">
\begin{aligned}
G &= G_h - \frac{T(G_h)}{T'(G_h)}\\\
\Longrightarrow G &= G_h-\frac{G_h^k-F}{kG_h^{k-1}}\\\
\Longrightarrow G &=\frac{(k-1)G_h^k+F}{kG_h^{k-1}}
\end{aligned}</script><p>ç„¶åå°±ç®—è¿™ä¸ªä¸œè¥¿å°±å˜æˆ$\log^3~\text{or}~\log^2$å¯ä»¥ç®—çš„ä¸œè¥¿äº†ã€‚</p>
<h3 id="4-2G-ln-G-equiv-F-bmod-x-n"><a href="#4-2G-ln-G-equiv-F-bmod-x-n" class="headerlink" title="$(4)~2G \ln G\equiv F~(\bmod x^n)$"></a>$(4)~2G \ln G\equiv F~(\bmod x^n)$</h3><script type="math/tex; mode=display">
T(G)\equiv 2G\ln G-F~(\bmod~x^n)</script><p>åŒæ ·çš„å°è¯â€¦â€¦</p>
<script type="math/tex; mode=display">
\begin{aligned}
G &= G_h - \frac{T(G_h)}{T'(G_h)}\\\
\Longrightarrow G &= G_h-\frac{2G_h\ln G_h-F}{2\ln G_h+2G_h\cdot \frac{1}{G_h}}\\\
\Longrightarrow G &=\frac{2G_h\ln G_h-F}{(2\ln+1)G_h}
\end{aligned}</script><p>ç„¶åè¿™ä¸œè¥¿å¥½åƒæ˜¯å¯ä»¥$\log^2$åšçš„â€¦â€¦ä¸è¿‡æœ‰äº›å°æœ‹å‹ç‰¹åˆ«å–œæ¬¢å‡ºæ— è„‘çš„å¤šé¡¹å¼æ¿å­ï¼Œåƒè¿™ç§ä¸œè¥¿å°±å¾ˆæ²¡æœ‰æ„æ€qaqã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¤šé¡¹å¼</category>
      </categories>
      <tags>
        <tag>å¤šé¡¹å¼åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å¤šé¡¹å¼æ±‚é€†</title>
    <url>/2019/07/27/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç»™å®š$F(x)$ï¼Œæ±‚$G(x)$æ»¡è¶³$G(x)\cdot F(x) \equiv1~(\bmod x^n)$.</p>
<p>ä¸å¦¨è€ƒè™‘$Gâ€™(x)\cdot F(x) =1~(\bmod x^{\frac{n}{2}})$</p>
<p>åˆ™æœ‰å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\because G'\cdot F =1~(\bmod x^{\frac{n}{2}})\\\ ~G\cdot F \equiv1~(\bmod x^{\frac{n}{2}})\\\
\therefore G' -G\equiv0~(\bmod x^{\frac{n}{2}})\\\ 
\Longrightarrow G'^2+G^2-2G'G\equiv0~(\bmod x^{n})</script><p>ä¸¤ç«¯åŒæ—¶å·ä¸Šä¸€ä¸ª$F(x)$åˆ™æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\because F\cdot G\equiv1~(\bmod x^n)\\\
\therefore G\equiv 2G'-FG'^2~(\bmod x^n)</script><p>ä»¥æ­¤ä¸ºé€’æ¨å¼å³å¯é€’æ¨å‡º$G(x)$çš„å€¼ï¼Œæ—¶é—´å¤æ‚åº¦$O(n\log^2 n)$.</p>
<a id="more"></a>
<h1 id="1"><a href="#1" class="headerlink" title="$1~$"></a>$1~$</h1><p><a href="https://www.luogu.org/problem/P4238" target="_blank" rel="noopener">ã€æ¨¡æ¿ã€‘å¤šé¡¹å¼æ±‚é€†</a></p>
<p>å°±æ˜¯æ¿å­ï¼ŒNTTä¸€ä¸‹å°±å¥½= =</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 300023</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> G = <span class="number">3</span> ;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; <span class="keyword">int</span> t[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, base[MAXN], Ans[MAXN], rev[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> res = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">while</span> (y) </span><br><span class="line">		res = ((y &amp; <span class="number">1</span>) ? <span class="number">1l</span>l * res * x % Mod : res), </span><br><span class="line">		x = <span class="number">1l</span>l * x * x % Mod, y &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">return</span> res % Mod ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(<span class="keyword">int</span> *J, <span class="keyword">int</span> L, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">	rr <span class="keyword">int</span> Gn, Gi = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i)</span><br><span class="line">		<span class="keyword">if</span> (i &lt; rev[i]) J[i] ^= J[rev[i]] ^= J[i] ^= J[rev[i]] ;</span><br><span class="line">	<span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; L ; i &lt;&lt;= <span class="number">1</span>)&#123;</span><br><span class="line">		Gn = expow(G, (Mod - <span class="number">1</span>) / (i &lt;&lt; <span class="number">1</span>)) ;</span><br><span class="line">		<span class="keyword">for</span> (rr <span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; L ; Gi = <span class="number">1</span>, j += (i &lt;&lt; <span class="number">1</span>))&#123;</span><br><span class="line">			<span class="keyword">for</span> (rr <span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; i ; ++ k, Gi = <span class="number">1l</span>l * Gi * Gn % Mod)&#123;</span><br><span class="line">				rr <span class="keyword">int</span> real = J[j + k], iroot = <span class="number">1l</span>l * J[j + k + i] * Gi % Mod ;</span><br><span class="line">				J[j + k] = (real + iroot) % Mod, J[j + k + i] = (real - iroot + Mod) % Mod ;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (flag &gt; <span class="number">0</span>) <span class="keyword">return</span> ;</span><br><span class="line">	<span class="keyword">int</span> Inv = expow(L, Mod - <span class="number">2</span>) ;  reverse(J + <span class="number">1</span>, J + L) ;</span><br><span class="line">	<span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i) J[i] = <span class="number">1l</span>l * J[i] * Inv % Mod ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Inv_NTT</span><span class="params">(<span class="keyword">int</span> Len, <span class="keyword">int</span> *A, <span class="keyword">int</span> *B)</span></span>&#123;<span class="comment">//é€’æ¨ </span></span><br><span class="line">	<span class="keyword">if</span> (Len &lt;= <span class="number">1</span>)&#123; B[<span class="number">0</span>] = expow(A[<span class="number">0</span>], Mod - <span class="number">2</span>) ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">	Inv_NTT((Len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, A, B) ; rr <span class="keyword">int</span> Lim = <span class="number">1</span>, len = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">while</span> (Lim &lt; (Len &lt;&lt; <span class="number">1</span>)) Lim &lt;&lt;= <span class="number">1</span>, ++ len ; rr <span class="keyword">int</span> i, j, k ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Lim ; ++ i) rev[i] = (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (len<span class="number">-1</span>)) ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i) t[i] = A[i] ; </span><br><span class="line">    NTT(t, Lim, <span class="number">1</span>), NTT(B, Lim, <span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Lim ; ++ i) B[i] = <span class="number">1l</span>l * (<span class="number">2l</span>l - <span class="number">1l</span>l * t[i] * B[i] % Mod + Mod) % Mod * B[i] % Mod ;</span><br><span class="line">    NTT(B, Lim, <span class="number">-1</span>) ; <span class="keyword">for</span> (i = Len ; i &lt;= Lim ; ++ i) B[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">int</span> i ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">	Inv_NTT(N, base, Ans) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d "</span>, Ans[i]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2"><a href="#2" class="headerlink" title="$2$"></a>$2$</h1><p><a href="https://www.luogu.org/problem/P4239" target="_blank" rel="noopener">ã€æ¨¡æ¿ã€‘å¤šé¡¹å¼æ±‚é€†ï¼ˆåŠ å¼ºç‰ˆï¼‰</a></p>
<p>ç„¶è€Œå°±æ˜¯æŠŠæ¨¡æ•°æ¢æˆäº†éNTTæ¨¡æ•°= =</p>
<p>äºæ˜¯å°±åšä¸€éMTTå°±å¥½äº†ï¼Œè¿™é‡Œå†™çš„æ˜¯å¸¦æœ‰å…±è½­ä¼˜åŒ–çš„ç‰ˆæœ¬= =</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 300020</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM MAXN</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod (1000000007)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1</span>) ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> G = <span class="number">3</span> ; <span class="keyword">int</span> T[MAXN] ;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; <span class="keyword">int</span> t[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, base[MAXN], Ans[MAXN], rev[MAXN]  ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> res = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">while</span> (y) </span><br><span class="line">		res = ((y &amp; <span class="number">1</span>) ? <span class="number">1l</span>l * res * x % Mod : res), </span><br><span class="line">		x = <span class="number">1l</span>l * x * x % Mod, y &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">double</span> r, i ;</span><br><span class="line">&#125;A[MAXM], B[MAXM], w[MAXM], t1[MAXM], t2[MAXM], qaq ; <span class="keyword">int</span> L1, L2, P ;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> + (<span class="keyword">const</span> node &amp;J, <span class="keyword">const</span> node &amp; Q)&#123; <span class="keyword">return</span> (node)&#123;J.r + Q.r , J.i + Q.i&#125; ; &#125;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> - (<span class="keyword">const</span> node &amp;J, <span class="keyword">const</span> node &amp; Q)&#123; <span class="keyword">return</span> (node)&#123;J.r - Q.r , J.i - Q.i&#125; ; &#125;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> * (<span class="keyword">const</span> node &amp;J, <span class="keyword">const</span> node &amp; Q)&#123; <span class="keyword">return</span> (node)&#123;J.r * Q.r - J.i * Q.i , J.r * Q.i + J.i * Q.r&#125; ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">FFT</span><span class="params">(node *J, <span class="keyword">const</span> <span class="keyword">int</span> &amp;Lim, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Lim; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; rev[i]) qaq = J[i], J[i] = J[rev[i]], J[rev[i]] = qaq ; </span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> j = <span class="number">1</span>; j &lt; Lim; j &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(rr <span class="keyword">int</span> k = <span class="number">0</span>; k &lt; Lim ; k += (j &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span>(rr <span class="keyword">int</span> l = <span class="number">0</span> ; l &lt; j ; ++ l)&#123;</span><br><span class="line">                rr node T = w[Lim / j * l] ; <span class="keyword">if</span> (flag &lt; <span class="number">0</span>) T.i *= <span class="number">-1</span> ;</span><br><span class="line">                rr node Nx = J[k + l], Ny = T * J[k + j + l] ; J[k + l] = Nx + Ny, J[k + j + l] = Nx - Ny ;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MTT</span><span class="params">(<span class="keyword">int</span> *J, <span class="keyword">int</span> *K, <span class="keyword">int</span> Length, <span class="keyword">int</span> P, <span class="keyword">int</span> Lim, <span class="keyword">int</span> *ret)</span></span>&#123;</span><br><span class="line">    rr node ia, ib, a1, a2, b1, b2 ; rr <span class="keyword">int</span> t, k, q1, q2, q3 ;  </span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; (Length &lt;&lt; <span class="number">1</span>) ; ++ i) A[i] = B[i] = (node)&#123;<span class="number">0</span>, <span class="number">0</span>&#125; ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; Lim ; i &lt;&lt;= <span class="number">1</span>) <span class="keyword">for</span>(k = <span class="number">0</span> ; k &lt; i ; ++ k) w[Lim / i * k] = (node)&#123;<span class="built_in">cos</span>(k * Pi / i) , <span class="built_in">sin</span>(k * Pi / i)&#125; ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= Length ; ++ i) A[i].r = J[i] &amp; <span class="number">32767</span>, A[i].i = J[i] &gt;&gt; <span class="number">15</span>, B[i].r = K[i] &amp; <span class="number">32767</span>, B[i].i = K[i] &gt;&gt; <span class="number">15</span> ;</span><br><span class="line">    FFT(A, Lim, <span class="number">1</span>), FFT(B, Lim, <span class="number">1</span>), t = Lim - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; Lim ; ++ i)&#123;</span><br><span class="line">        k = (Lim - i) &amp; t ; </span><br><span class="line">		ia = (node)&#123; A[k].r, -A[k].i &#125;, ib = (node)&#123; B[k].r, -B[k].i &#125; ; </span><br><span class="line">        a1 = (ia + A[i]) * (node) &#123;<span class="number">0.5</span>, <span class="number">0</span>&#125;, a2 = (A[i] - ia) * (node) &#123;<span class="number">0</span>, <span class="number">-0.5</span>&#125; ;</span><br><span class="line">        b1 = (ib + B[i]) * (node) &#123;<span class="number">0.5</span>, <span class="number">0</span>&#125;, b2 = (B[i] - ib) * (node) &#123;<span class="number">0</span>, <span class="number">-0.5</span>&#125; ;</span><br><span class="line">        t1[i] = a1 * b1 + (a1 * b2 + b1 * a2) * (node)&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, t2[i] = a2 * b2 ;</span><br><span class="line">    &#125;  </span><br><span class="line">	FFT(t1, Lim, <span class="number">-1</span>), FFT(t2, Lim, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; Length ; ++ i)&#123; </span><br><span class="line">        q1 = (<span class="keyword">long</span> <span class="keyword">long</span>)(t1[i].r / Lim + <span class="number">0.5</span>) % P, q2 = (<span class="keyword">long</span> <span class="keyword">long</span>)(t1[i].i / Lim + <span class="number">0.5</span>) % P ;</span><br><span class="line">        q3 = (<span class="keyword">long</span> <span class="keyword">long</span>)(t2[i].r / Lim + <span class="number">0.5</span>) % P, ret[i] = ((<span class="number">1l</span>l * q3 &lt;&lt; <span class="number">30</span>) % P + (<span class="number">1l</span>l * q2 &lt;&lt; <span class="number">15</span>) % P + q1) % P ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Inv_MTT</span><span class="params">(<span class="keyword">int</span> Len, <span class="keyword">int</span> *A, <span class="keyword">int</span> *B)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (Len &lt;= <span class="number">1</span>)&#123; </span><br><span class="line">		B[<span class="number">0</span>] = expow(A[<span class="number">0</span>], Mod - <span class="number">2</span>) ; </span><br><span class="line">		<span class="keyword">return</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">	Inv_MTT(Len &gt;&gt; <span class="number">1</span>, A, B) ; rr <span class="keyword">int</span> Lim, len = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (Lim = <span class="number">1</span> ; Lim &lt;= Len ; Lim &lt;&lt;= <span class="number">1</span>) ++ len ;</span><br><span class="line">	<span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; Lim ; ++ i) </span><br><span class="line">		rev[i] = (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (len<span class="number">-1</span>)) ;</span><br><span class="line">	MTT(A, B, Len, Mod, Lim, T), MTT(T, B, Len, Mod, Lim, t) ;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; Len ; ++ i) B[i] = <span class="number">1l</span>l * (<span class="number">2l</span>l * B[i] - t[i] + Mod) % Mod ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c))  c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span> ,c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ; rr <span class="keyword">int</span> i, Np ; </span><br><span class="line">	<span class="keyword">for</span> (Np = <span class="number">1</span> ; Np &lt; N ; Np &lt;&lt;= <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) base[i] = qr() ;</span><br><span class="line">	Inv_MTT(Np, base, Ans) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d "</span>, Ans[i]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¼€äº†ä¸€å‘O2å‘ç°å¿«äº†ä¸‰å€ï¼Œwocâ€¦</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¤šé¡¹å¼</category>
      </categories>
      <tags>
        <tag>å¤šé¡¹å¼åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘æ´›è°·ä¸‰æœˆæœˆèµ› Derivation</title>
    <url>/2019/07/26/biaodashishu2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸€èˆ¬åœ¨è€ƒåœºä¸Šå†™å‡ºè¿™ç§ä¸œè¥¿çš„äººï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºï¼šå·¨  é­”  ç   æ€ªã€‚</p>
<a id="more"></a>
<p>å° R å­¦ä¼šå¾®ç§¯åˆ†ä¸­æ±‚å¯¼è¿™ä¸€æ¦‚å¿µåï¼Œä»–çš„æ•°å­¦è€å¸ˆè¦æ±‚ä»–å¼€å§‹åšä¸€éƒ¨åˆ†å¯¼æ•°çš„ç»ƒä¹ é¢˜åŠ æ·±è‡ªå·±çš„ç†è§£ã€‚</p>
<p>ä½†é¢–æ‚Ÿç»ä¼¦çš„å° R å¯¹ç¹å¤çš„ç»ƒä¹ é¢˜å¹¶ä¸æ„Ÿå…´è¶£ã€‚ä»–å¸Œæœ›ä½ å¸®ä»–è®¾è®¡ä¸€ä¸ªç¨‹åºï¼Œè®¡ç®—ä¸€ä¸ªç»™å®šå‡½æ•° $f(x)$ çš„å¯¼æ•°ã€‚</p>
<p>ç¬¬ä¸€è¡Œä¸€ä¸ªæ­£æ•´æ•° Tï¼Œè¡¨ç¤ºå° R è¦å®Œæˆçš„ç»ƒä¹ é¢˜æ•°é‡ï¼Œäº¦å³æµ‹è¯•æ•°æ®çš„ç»„æ•°ã€‚<br>æ¯ç»„æµ‹è¯•æ•°æ®çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªéç©ºå­—ç¬¦ä¸²ï¼Œæè¿°äº†è¾“å…¥çš„å‡½æ•° $f(x)$ã€‚è®¾ $p=998244353$ã€‚</p>
<p>å­—ç¬¦ä¸²ä¸­å¯èƒ½åŒ…å«çš„å…ƒç´ æœ‰ï¼š</p>
<p>1ã€ç³»æ•°ä¸º $1$ çš„å•é¡¹å¼ï¼ŒåŒ…æ‹¬ $x^2,x^0$ ç­‰ï¼Œæˆ‘ä»¬ä¿è¯æŒ‡æ•°ä¸ºéè´Ÿæ•´æ•°ä¸º $1$ æ—¶ä¸çœç•¥ï¼Œä¸ä¼šè¶…è¿‡ $p-1$ã€‚æ‰€æœ‰å¹‚å·ç”¨ <code>^</code> ä»£æ›¿ã€‚<br>2ã€å¸¸æ•°ï¼Œå¦‚ $0,19260817$ ç­‰ï¼›æˆ‘ä»¬ä¿è¯ä¸€åˆ‡å¸¸æ•°æ˜¯éè´Ÿæ•´æ•°ä¸”ä¸è¶…è¿‡ $p-1$ã€‚<br>3ã€å¤åˆå‡½æ•°ã€‚å°†ä»¥ä¸Šä¸¤ç§å‡½æ•°ç»„åˆçš„æ–¹å¼å¯ä»¥ä¸ºåŠ ä¹˜å¹‚ï¼Œæ‹¬å·ç­‰ã€‚æ•°å­¦ä¸­ä¼šçœç•¥ä¹˜å·å’Œæ‹¬å·ï¼Œä½†æˆ‘ä»¬ä¿è¯ä»»æ„æƒ…å†µä¸‹éƒ½ä¸çœç•¥ï¼ˆä¹Ÿä¸ä¼šæ— æ„ä¹‰å†—ä½™ï¼Œå³ä¸å­˜åœ¨ <code>((x)),(3)+(4)</code>ï¼‰ï¼›ä¿è¯ä»»ä½•æŒ‡æ•°éƒ½æ˜¯å¸¸æ•°ï¼Œå³ä¸å­˜åœ¨ $x^{g(x)}$çš„æƒ…å†µã€‚</p>
<p>æµ‹è¯•æ•°æ®çš„ç¬¬äºŒè¡Œä¸ºä¸¤ä¸ªæ•´æ•°ï¼Œå€¼åœ¨$[0,p)$ä¹‹é—´ã€‚ä½ éœ€è¦è¾“å‡ºä¸¤ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºè¿™äº›æ•´æ•°ä»£å…¥å¯¼å‡½æ•°åçš„å€¼æ¨¡ $p$ çš„ç»“æœã€‚</p>
<p>æœ¬é¢˜ä¸­è®¤ä¸º $0^0=1$ã€‚</p>
<hr>
<hr>
<p>è¿™é“é¢˜ä¹Ÿæ˜¯å¾ˆç¥= =</p>
<p>é¦–å…ˆæ±‚å¯¼ä¸æ±‚å¯¼çš„ï¼Œå…ˆæŠŠæ ‘å»ºå‡ºæ¥ï¼Œç„¶åå°±ä¼šå‘ç°è¿™ä¸ªé¢˜çš„æœ¬è´¨è¿˜æ˜¯åˆå¹¶å·¦å³å­©å­ã€‚ä½†æ˜¯æœ‰ä¸€ç‚¹å¾ˆç¥ï¼Œå°±æ˜¯åˆå¹¶æ—¶è¦ç”¨<strong>æ‰©å±•æ¬§æ‹‰å®šç†</strong>åˆå¹¶ï¼ŒåŸå› æ˜¯æˆ‘ä»¬å­˜åœ¨<code>^</code>è¿™ä¸ªè¿ç®—ã€‚ç„¶åå°±è€ƒè™‘æˆ‘ä»¬å¯ä»¥å­˜å‚¨å½“<code>x=v</code>æ—¶å¯¹æ‰€æœ‰æ‰©æ¬§å±•å¼€æ—¶çš„æ¨¡æ•°å–æ¨¡ï¼Œæ›´æ–°çš„æ—¶å€™æŒ‰ç§©æ›´æ–°å°±å¥½äº†= =</p>
<p>è¿˜æœ‰å°±æ˜¯åœ¨è°ƒè¿™é¢˜æ—¶ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªä»¥å‰ç¨‹åºçš„bugã€‚</p>
<p>å…³äºå»ºæ ‘æ—¶çš„é¬¼ç•œåˆ¤æ–­ï¼Œæˆ‘å½“æ—¶æ˜¯è¿™ä¹ˆåŠ çš„åˆ¤æ–­:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	tp = <span class="number">0</span>, <span class="built_in">memset</span>(brac, <span class="number">0</span>, <span class="keyword">sizeof</span>(brac)) ;</span><br><span class="line">	<span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (In[i] == <span class="string">'('</span>) stk[++ tp] = i ; </span><br><span class="line">		<span class="keyword">if</span> (In[i] == <span class="string">')'</span>) brac[i] = stk[tp], brac[stk[tp]] = i, tp -- ;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">blablabla....</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (brac[l] == r) l ++, r -- ;</span><br><span class="line">    blablabla...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸œè¥¿æ¯æ¬¡<code>memset</code>æ˜¾ç„¶ä¼šè¶…æ—¶ï¼Œäºæ˜¯ä¾¿é‡‡ç”¨ä¸€ä¸ªé€€åŒ–ç‰ˆæœ¬<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123; </span><br><span class="line">    <span class="keyword">if</span> (In[l] == <span class="string">'('</span> &amp;&amp; In[r] == <span class="string">')'</span>) l ++, r -- ; <span class="comment">// 1</span></span><br><span class="line">    blablabla...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>tmå½“æ—¶è‡ªå·±å› ä¸ºè¿™ä¸ªè°ƒäº†å¥½ä¹…ä¹Ÿæ˜¯å¾ˆä½›äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mod[MAXM], n, v ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">phi</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = x ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i * i &lt;= x ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (!(x % i))&#123;</span><br><span class="line">            ret = ret / i * (i - <span class="number">1</span>) ; </span><br><span class="line">            <span class="keyword">while</span> (!(x % i)) x /= i ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) ret = ret / x * (x - <span class="number">1</span>) ; <span class="keyword">return</span> ret ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _prework()&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Mod ; i &gt; <span class="number">1</span> ; i = phi(i)) </span><br><span class="line">        mod[++ n] = i ; mod[++ n] = <span class="number">1</span>, mod[++ n] = <span class="number">1</span> ; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> brac[MAXN], stk[MAXN], tp ;</span><br><span class="line"><span class="keyword">char</span> op[MAXN], In[MAXN] ; <span class="keyword">int</span> N, T ; </span><br><span class="line"><span class="keyword">int</span> root, L[MAXN], R[MAXN], tot ; ll val[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isop</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x == <span class="string">'+'</span> || x == <span class="string">'*'</span> || x == <span class="string">'^'</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">     <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (In[i] == <span class="string">'('</span>) stk[++ tp] = i ; </span><br><span class="line">        <span class="keyword">if</span> (In[i] == <span class="string">')'</span>) brac[i] = stk[tp], brac[stk[tp]] = i, tp -- ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123; </span><br><span class="line">    <span class="keyword">if</span> (In[l] == <span class="string">'('</span> &amp;&amp; In[r] == <span class="string">')'</span>) l ++, r -- ; <span class="comment">// 1</span></span><br><span class="line">    rr <span class="keyword">int</span> rt = <span class="number">0</span>, rt1 = <span class="number">0</span>, rt2 = <span class="number">0</span>, x = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (In[i] == <span class="string">'('</span>) i = brac[i] + <span class="number">1</span> ; <span class="keyword">if</span> (i &gt; r) <span class="keyword">break</span> ; </span><br><span class="line">        <span class="keyword">if</span> (In[i] == <span class="string">'+'</span> &amp;&amp; !isop(In[i - <span class="number">1</span>])) &#123; rt = i ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">        <span class="keyword">if</span> (In[i] == <span class="string">'*'</span>) rt1 = i ; <span class="keyword">if</span> (In[i] == <span class="string">'^'</span> &amp;&amp; !rt2) rt2 = i ; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (rt) x = rt ; <span class="keyword">else</span> <span class="keyword">if</span> (rt1) x = rt1 ; <span class="keyword">else</span> x = rt2 ; </span><br><span class="line">    <span class="keyword">if</span> (!x)&#123;</span><br><span class="line">        x = r ; </span><br><span class="line">        <span class="keyword">if</span> (In[r] == <span class="string">'x'</span>) op[x] = <span class="string">'X'</span>, val[x] = <span class="number">1</span> ; </span><br><span class="line">        <span class="keyword">else</span> op[x] = <span class="string">'?'</span>, <span class="built_in">sscanf</span>(In + l, <span class="string">"%lld"</span>, &amp;val[x]), val[x] %= Mod ;</span><br><span class="line">        L[x] = R[x] = <span class="number">0</span> ; <span class="keyword">return</span> x ; </span><br><span class="line">    &#125;</span><br><span class="line">    op[x] = In[x], L[x] = build(l, x - <span class="number">1</span>), R[x] = build(x + <span class="number">1</span>, r) ; <span class="keyword">return</span> x ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    ll y[MAXM], dy[MAXM] ; </span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll a,ll b,ll p)</span></span>&#123; <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">return</span> a * b &lt; p ? a * b :  a * b % p + p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">add</span><span class="params">(ll a,ll b,ll p)</span></span>&#123; <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">return</span> a + b &lt; p ? a + b : (a + b) % p + p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">expow</span><span class="params">(ll a, ll b, ll p)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span> ; </span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) res = mul(res, a, p) ;</span><br><span class="line">        a = mul(a, a, p) ; b &gt;&gt;= <span class="number">1</span> ;  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Node <span class="title">dp</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    Node res ; </span><br><span class="line">    <span class="keyword">if</span> (!L[x] &amp;&amp; !R[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (op[x] == <span class="string">'X'</span>)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">       					res.y[i] = v % mod[i], res.dy[i] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                res.y[i] = val[x] % mod[i], res.dy[i] = <span class="number">0</span> ;   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        Node l = dp(L[x]), r = dp(R[x]) ; </span><br><span class="line">        <span class="keyword">if</span> (op[x] == <span class="string">'+'</span>)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                res.y[i] = add(l.y[i], r.y[i], mod[i]), </span><br><span class="line">                res.dy[i] = add(l.dy[i], r.dy[i], mod[i]) ; </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op[x] == <span class="string">'*'</span>)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                res.y[i] = mul(l.y[i], r.y[i], mod[i]), </span><br><span class="line">                res.dy[i] = add(mul(l.dy[i], r.y[i], mod[i]), mul(l.y[i], r.dy[i], mod[i]), mod[i]) ; </span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            rr ll calc ;</span><br><span class="line">            res.y[n] = res.dy[n] = <span class="number">0</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span> ; i &gt;= <span class="number">1</span> ; -- i) <span class="comment">// 1</span></span><br><span class="line">                res.y[i] = expow(l.y[i], r.y[i + <span class="number">1</span>], mod[i]),</span><br><span class="line">                calc = (!(l.y[i] % mod[i]) &amp;&amp; (r.y[i + <span class="number">1</span>] % mod[i + <span class="number">1</span>] == <span class="number">1</span>)) ?</span><br><span class="line">                 		<span class="number">1</span> : expow(l.y[i], (r.y[i + <span class="number">1</span>] + mod[i + <span class="number">1</span>] - <span class="number">1</span>) % mod[i + <span class="number">1</span>], mod[i]),</span><br><span class="line"> 				res.dy[i] = mul(mul(l.dy[i], r.y[i], mod[i]), calc, mod[i]) ; </span><br><span class="line">          <span class="comment">//calc: æ­¤é¢˜è®¤ä¸º0^0=1ï¼Œå› æ­¤åˆ¤ä¸€ä¸‹ã€‚s</span></span><br><span class="line">        &#125;</span><br><span class="line">  	&#125;</span><br><span class="line">    <span class="keyword">return</span> res ; </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    _prework() ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ; <span class="keyword">int</span> i ;  </span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">		In[<span class="number">1</span>] = <span class="string">'('</span>, <span class="built_in">scanf</span>(<span class="string">"%s"</span>, (In + <span class="number">2</span>)) ; </span><br><span class="line">        N = <span class="built_in">strlen</span>(In + <span class="number">1</span>), In[++ N] = <span class="string">')'</span> ;</span><br><span class="line">        Init(), tot = <span class="number">0</span>, root = build(<span class="number">1</span>, N); </span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; <span class="number">2</span> ; ++ i)&#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; v ; Node res = dp(root) ; </span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d%c"</span>, res.dy[<span class="number">1</span>] % Mod, <span class="string">" \n"</span>[i == <span class="number">1</span>]) ; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ï¼Œå°±æ˜¯å½“æ—¶è‡ªå·±è§‰å¾—è‡ªå·±å·²ç»ç†è§£äº†æ€ä¹ˆæ“ä½œå°±å¼€å§‹çå†™ï¼Œç»“æœå°±å¼€å§‹ç–¯ç‹‚åœ°æŒ‚ï¼Œäºæ˜¯å‘ç°äº†è¿™ä¸¤ä¸ªå‡½æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll a,ll b,ll p)</span></span>&#123; <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">return</span> a * b &lt; p ? a * b :  a * b % p + p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">add</span><span class="params">(ll a,ll b,ll p)</span></span>&#123; <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">return</span> a + b &lt; p ? a + b : (a + b) % p + p ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¹³å¿ƒè€Œè®ºï¼Œè¿™ä¸¤ä¸ªå‡½æ•°æ˜¯æœ€ä¸èµ·çœ¼çš„ä¸¤ä¸ªå‡½æ•°â€¦â€¦ä½†æ˜¯å¯¹äºæŸäº›è€å¹´OIé™æ™ºé€‰æ‰‹ç¡®å®è‡´å‘½æ€§çš„æ‰“å‡»ï¼š<strong>è¿™ä¸¤ä¸ªå‡½æ•°ä¸æ˜¯å‡­ç©ºå­˜åœ¨çš„ï¼Œæ˜¯ä¸ºäº†é…åˆæ‰©å±•æ¬§æ‹‰å®šç†çš„</strong>ï¼</p>
<p>åŸºæœ¬å½¢å¼å¤§æ¦‚å°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">n^k\equiv \begin{matrix} \qquad\ n^{[k\ \ mod \ \ \varphi(m)]+\varphi(m)} \   \ (k\geq \varphi(m))\\\ n^k \qquad\ (k<\varphi(m)) \end{matrix}  \qquad\  (mod \ \ m)</script><p>ä¹Ÿå°±æ˜¯è¯´æœ€åçš„$+p$æ˜¯å¿…è¦çš„= = è¿™ä¹Ÿæ˜¯å¾ˆä½›ã€‚ã€‚</p>
<hr>
<p>ç„¶åå°±æ˜¯æˆ‘å½“æ—¶è¿˜å¥‡æ€ªä¸ºä»€ä¹ˆå…”é˜Ÿå†™çš„è¿™ä¹ˆå¿«ï¼Œç»“æœå†™ä¸Šä¸€ç¯‡æ–‡ç« æ—¶å‘ç°åŸæ¥æ˜¯è‡ªå·±çš„å¤æ‚åº¦å†™å‡äº†ï¼Œå¦‚æœæŒ‰ä¸Šæ–‡ä¸­çš„å†™ï¼Œå¤æ‚åº¦åº”è¯¥æ˜¯$O(q|S|\log|S|\log^2p)$ã€‚</p>
<p>äºæ˜¯ä¸ºäº†ä¼˜åŒ–æ‰è¿™ä¸ªlogæˆ‘ä»¬éœ€è¦å†™ä¸€éåç¼€è¡¨è¾¾å¼ç‰ˆçš„æ±‚å¯¼= = </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 100010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span> ll y[MAXM], dy[MAXM] ; &#125;;</span><br><span class="line"><span class="keyword">char</span> stk[MAXM] ; Node Ans[MAXN] ; <span class="keyword">int</span> ans, i, j, tp, pt ;</span><br><span class="line"><span class="keyword">char</span> In[MAXN], op[MAXN], res[MAXN] ; <span class="keyword">int</span> T, N, L, mod[MAXM], n ; ll val[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">phi</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = x ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i * i &lt;= x ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (!(x % i))&#123;</span><br><span class="line">            ret = ret / i * (i - <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">while</span> (!(x % i)) x /= i ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) ret = ret / x * (x - <span class="number">1</span>) ; <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _prework()&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Mod ; i &gt; <span class="number">1</span> ; i = phi(i))</span><br><span class="line">        mod[++ n] = i ; mod[++ n] = <span class="number">1</span>, mod[++ n] = <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">mul</span><span class="params">(ll a,ll b,ll p)</span></span>&#123; <span class="keyword">return</span> a * b &lt; p ? a * b :  a * b % p + p ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">add</span><span class="params">(ll a,ll b,ll p)</span></span>&#123; <span class="keyword">return</span> a + b &lt; p ? a + b : (a + b) % p + p ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">expow</span><span class="params">(ll a, ll b, ll p)</span></span>&#123;</span><br><span class="line">    rr ll res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) res = mul(res, a, p) ;</span><br><span class="line">        a = mul(a, a, p) ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x ==<span class="string">'('</span>)  <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x ==<span class="string">'+'</span>)  <span class="keyword">return</span> <span class="number">2</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x ==<span class="string">'*'</span>)  <span class="keyword">return</span> <span class="number">3</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x ==<span class="string">'^'</span>)  <span class="keyword">return</span> <span class="number">4</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Comp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> &amp;a, <span class="keyword">const</span> <span class="keyword">char</span> &amp;b)</span></span>&#123; <span class="keyword">return</span> calc(a) &gt;= calc(b) ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    _prework() ; <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, In + <span class="number">1</span>), N = <span class="built_in">strlen</span>(In + <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">            ll ret = <span class="number">0</span> ;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isdigit</span>(In[i]))&#123;</span><br><span class="line">                <span class="keyword">while</span> (<span class="built_in">isdigit</span>(In[i]))</span><br><span class="line">                    ret = (ret &lt;&lt; <span class="number">1</span>) + (ret &lt;&lt; <span class="number">3</span>) + In[i] - <span class="string">'0'</span>, ++ i ;</span><br><span class="line">                i --, val[++ L] = ret, res[L] = <span class="string">'N'</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (In[i] == <span class="string">'x'</span>) val[++ L] = <span class="number">1</span>, res[L] = <span class="string">'X'</span> ;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (In[i] == <span class="string">'('</span>) stk[++ tp] = In[i] ;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (In[i] == <span class="string">')'</span>)&#123;</span><br><span class="line">                <span class="keyword">while</span> (stk[tp] != <span class="string">'('</span>)</span><br><span class="line">                    res[++ L] = stk[tp --] ;</span><br><span class="line">                tp -- ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (tp &amp;&amp; Comp(stk[tp], In[i]))</span><br><span class="line">                    res[++ L] = stk[tp --] ; stk[++ tp] = In[i] ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (tp) res[++ L] = stk[tp --] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> o = <span class="number">1</span> ; o &lt;= <span class="number">2</span> ; ++ o)&#123;</span><br><span class="line">            rr <span class="keyword">int</span> v ; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v) ;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= L ; ++ j)&#123;</span><br><span class="line">                rr Node ret ;</span><br><span class="line">                <span class="keyword">if</span> (!calc(res[j])) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (res[j] == <span class="string">'X'</span>)</span><br><span class="line">                        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                            ret.y[i] = v % mod[i], ret.dy[i] = <span class="number">1</span> ;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                            ret.y[i] = val[j] % mod[i], ret.dy[i] = <span class="number">0</span> ;</span><br><span class="line">                    Ans[++ pt] = ret ; <span class="keyword">continue</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">                rr Node p1 = Ans[pt --] ; rr Node p2 = Ans[pt --] ; </span><br><span class="line">                <span class="keyword">if</span> (res[j] == <span class="string">'+'</span>)</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                        ret.y[i] = add(p1.y[i], p2.y[i], mod[i]),</span><br><span class="line">                        ret.dy[i] = add(p1.dy[i], p2.dy[i], mod[i]) ;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (res[j] == <span class="string">'*'</span>)</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                        ret.y[i] = mul(p1.y[i], p2.y[i], mod[i]),</span><br><span class="line">                        ret.dy[i] = add(mul(p1.dy[i], p2.y[i], mod[i]), mul(p1.y[i], p2.dy[i], mod[i]), mod[i]) ;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    rr ll calcc ; swap(p1, p2) ;</span><br><span class="line">                    ret.y[n] = ret.dy[n] = <span class="number">0</span> ;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span> ; i &gt;= <span class="number">1</span> ; -- i) <span class="comment">// 1</span></span><br><span class="line">                        ret.y[i] = expow(p1.y[i], p2.y[i + <span class="number">1</span>], mod[i]),</span><br><span class="line">                        calcc = (!(p1.y[i] % mod[i]) &amp;&amp; (p2.y[i + <span class="number">1</span>] % mod[i + <span class="number">1</span>] == <span class="number">1</span>)) ?</span><br><span class="line">                                <span class="number">1</span> : expow(p1.y[i], (p2.y[i + <span class="number">1</span>] + mod[i + <span class="number">1</span>] - <span class="number">1</span>) % mod[i + <span class="number">1</span>], mod[i]),</span><br><span class="line">                        ret.dy[i] = mul(mul(p1.dy[i], p2.y[i], mod[i]), calcc, mod[i]) ;</span><br><span class="line">                &#125;</span><br><span class="line">                Ans[++ pt] = ret ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld "</span>, Ans[pt].dy[<span class="number">1</span>] % Mod), pt -- ;</span><br><span class="line">        &#125;</span><br><span class="line">        L = <span class="number">0</span>, <span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å†™å®Œæˆ‘æ‰å‘ç°æˆ‘çš„å¤§å¸¸æ•°æ˜¯æ•‘ä¸äº†çš„äº†ï¼Œå…”çˆ·å†™çš„60msï¼Œæˆ‘å†™çš„1120msï¼Œè¿™tm20å€çš„å¸¸æ•°å®›å¦‚å†™äº†$\rm{|S|\log|S|}$â€¦â€¦ä¸è¿‡è¯´ä¼šè¯æ¯”å»ºæ ‘çš„å¿«äº†äº›ã€‚</p>
<p>çœ‹äº†çœ‹é¢˜è§£ä¼¼ä¹åº”è¯¥æ˜¯å…”çˆ·å¤šå†™äº†ä¸€å±‚æ¬§æ‹‰å±•å¼€ï¼Œäºæ˜¯åˆæ¶ˆæ‰ä¸€ä¸ªlog = =</p>
<blockquote>
<p>$O(q|S|\log^2 p)$ <img src="1.jpg" alt></p>
<p>$O(q|S|\log |S| log^2 p)$ <img src="2.jpg" alt></p>
</blockquote>
<p>å¡å¸¸çœŸæ˜¯è¼æ¯’äººå= =</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>è¡¨è¾¾å¼/è¡¨è¾¾å¼æ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘è¡¨è¾¾å¼æ ‘å…¥é—¨</title>
    <url>/2019/07/26/biaodashishu/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸¥æ ¼æ¥è®²ï¼Œæˆ‘ä»¬æ‰€è°ˆçš„<strong>è¡¨è¾¾å¼æ ‘</strong>æ˜¯å¯¹ä¸€ä¸ªè®¡ç®—å¼çš„ä¸­ç¼€è¡¨è¾¾å¼æ‰€æ„é€ çš„<strong>äºŒå‰æ ‘å½¢ç»“æ„</strong>ï¼Œåœ¨æ±‚è§£è¡¨è¾¾å¼çš„å€¼æ—¶ååˆ†çš„æ–¹ä¾¿ã€‚</p>
<p>å¯¹äºä¸€æ£µè¡¨è¾¾å¼æ ‘ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œç‰¹åˆ«çš„æ˜¯<strong>æ•°å€¼åªä¼šæ˜¯å¶å­èŠ‚ç‚¹</strong>ï¼Œè¿™äº›æ•°å€¼ç”±å…¶ç¥–å…ˆèŠ‚ç‚¹â€”â€”å‡æ˜¯â€œè®¡ç®—ç¬¦å·â€çš„èŠ‚ç‚¹è¿æ¥èµ·æ¥ã€‚è€Œè®¡ç®—æ–¹å¼åˆ™æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\rm{S_u=calc(S_{v_1}, S_{v_2})}</script><p>å…¶ä¸­uä¸ºå½“å‰èŠ‚ç‚¹ï¼Œcalcå‡½æ•°çš„è®¡ç®—æ–¹å¼å–å†³äºç‚¹$u$ä¸Šçš„ç¬¦å·ã€‚</p>
<p>ä»è€Œåªéœ€è¦é€’å½’è®¡ç®—å³å¯ã€‚</p>
<a id="more"></a>
<h1 id="1-é€’å½’å»ºæ ‘"><a href="#1-é€’å½’å»ºæ ‘" class="headerlink" title="$1$ é€’å½’å»ºæ ‘"></a>$1$ é€’å½’å»ºæ ‘</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isop</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> &amp;x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x == <span class="string">'+'</span> || x == <span class="string">'-'</span> || x == <span class="string">'*'</span> || x == <span class="string">'/'</span> || x == <span class="string">'^'</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;l, <span class="keyword">const</span> <span class="keyword">int</span> &amp;r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (brac[l] == r) <span class="keyword">return</span> build(l + <span class="number">1</span>, r - <span class="number">1</span>) ; </span><br><span class="line">	rr <span class="keyword">int</span> rt = <span class="number">0</span>, ls = <span class="number">0</span>, rs = <span class="number">0</span>, x = <span class="number">0</span> ; </span><br><span class="line">	<span class="keyword">for</span> (rr <span class="keyword">int</span> k = l ; k &lt;= r ; ++ k)&#123;</span><br><span class="line">		<span class="keyword">if</span> (In[k] == <span class="string">'('</span>) k = brac[k] + <span class="number">1</span> ; <span class="keyword">if</span> (k &gt; r) <span class="keyword">break</span> ; </span><br><span class="line">		<span class="keyword">if</span> ((In[k] == <span class="string">'+'</span> || In[k] == <span class="string">'-'</span>) &amp;&amp; k != l &amp;&amp; !isop(In[k - <span class="number">1</span>])) &#123; rt = k ; <span class="keyword">break</span> ; &#125;<span class="comment">//!</span></span><br><span class="line">		<span class="keyword">if</span> (In[k] == <span class="string">'*'</span> || In[k] == <span class="string">'/'</span>) ls = k ; <span class="keyword">if</span> (In[k] == <span class="string">'^'</span> &amp;&amp; !rs) rs = k ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (rt) x = rt ; <span class="keyword">else</span> <span class="keyword">if</span> (ls) x = ls ; <span class="keyword">else</span> x = rs ; </span><br><span class="line">	<span class="keyword">if</span> (!x) &#123; </span><br><span class="line">		x = r, op[x] = <span class="string">'?'</span> ; </span><br><span class="line">		<span class="built_in">sscanf</span>(In + l, <span class="string">"%d"</span>, &amp;val[x]) ; </span><br><span class="line">		val[x] %= Mod ; <span class="keyword">return</span> x ; </span><br><span class="line">	&#125;</span><br><span class="line">	op[x] = In[x] ; L[x] = build(l, x - <span class="number">1</span>), R[x] = build(x + <span class="number">1</span>, r) ; <span class="keyword">return</span> x ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">	rr <span class="keyword">int</span> res = <span class="number">1</span> ; </span><br><span class="line">	<span class="keyword">while</span> (b)&#123;</span><br><span class="line">		<span class="keyword">if</span> (b &amp; <span class="number">1</span>) (res *= a) %= Mod ;</span><br><span class="line">		(a *= a) %= Mod ; b &gt;&gt;= <span class="number">1</span> ;  </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (op[x] == <span class="string">'?'</span>) <span class="keyword">return</span> val[x] ; </span><br><span class="line">	rr <span class="keyword">int</span> l = dp(L[x]) % Mod, r = dp(R[x]) % Mod, res = <span class="number">0.0</span> ;</span><br><span class="line">	<span class="keyword">if</span> (op[x] == <span class="string">'+'</span>) res = (l + r) % Mod ;</span><br><span class="line">	<span class="keyword">if</span> (op[x] == <span class="string">'-'</span>) res = (l - r) % Mod ;</span><br><span class="line">	<span class="keyword">if</span> (op[x] == <span class="string">'*'</span>) res = (l * r) % Mod ;</span><br><span class="line">	<span class="keyword">if</span> (op[x] == <span class="string">'/'</span>) res = l * expow(r, Mod - <span class="number">2</span>) % Mod ;</span><br><span class="line">	<span class="keyword">if</span> (op[x] == <span class="string">'^'</span>) res = expow(l ,r) ; <span class="keyword">return</span> res ; 	 </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; In + <span class="number">1</span>, N = <span class="built_in">strlen</span>(In + <span class="number">1</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (In[i] == <span class="string">'('</span>) stk[++ tp] = i ; </span><br><span class="line">		<span class="keyword">if</span> (In[i] == <span class="string">')'</span>) brac[i] = stk[tp], brac[stk[tp]] = i, tp -- ;</span><br><span class="line">	&#125;</span><br><span class="line">	root = build(<span class="number">1</span>, N), <span class="built_in">cout</span> &lt;&lt; dp(root) &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶å®ä¹Ÿæ²¡å•¥å¥½è¯´çš„ï¼Œè¿™é“é¢˜æ˜¯NOIP2013æ™®åŠç»„çš„<a href="https://www.luogu.org/problem/P1981" target="_blank" rel="noopener">è¡¨è¾¾å¼æ±‚å€¼</a>ã€‚ç„¶åå»ºæ ‘çš„æ—¶å€™éœ€è¦æ³¨æ„ä¼˜å…ˆçº§â€¦â€¦</p>
<p>ä½†å…¶å®è¿™ä¸ªåœ°æ–¹æƒ³è¯´çš„ä¸æ˜¯è¿™ä¸ªä¸œè¥¿ï¼Œè€Œæ˜¯ä¸€ä¸ªå¤æ‚åº¦çš„é—®é¢˜ã€‚å–œé—»ä¹è§çš„è¿™ä¸ªç©æ„å„¿çš„å¤æ‚åº¦æ˜¯$O(n^2)$çš„ï¼Œä½†æ˜¯åœ¨æˆ‘åŠ äº†</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ((In[k] == <span class="string">'+'</span> || In[k] == <span class="string">'-'</span>) &amp;&amp; k != l &amp;&amp; !isop(In[k - <span class="number">1</span>])) &#123; </span><br><span class="line">  rt = k ; <span class="keyword">break</span> ; </span><br><span class="line">&#125;<span class="comment">//!</span></span><br></pre></td></tr></table></figure>
<p>ä¸­çš„breakä¹‹åï¼Œä»–å°±å¯ä»¥åœ¨400mså†…çš„é¾Ÿé€ŸæŠŠ1e6çš„æ•°æ®ç»™è‰¹è¿‡å»äº†â€¦â€¦ä¹Ÿç®—æ˜¯å¾ˆè¿·</p>
<p>ä½†å¬è¯´ä¼¼ä¹çœŸæ­£$O(|S|)$çš„å»ºæ ‘å…¶å®åªéœ€è¦é¢„å¤„ç†ä¸€ä¸‹æ¯ä¸ªä½ç½®ä¹‹å‰æœ€è¿‘çš„ç¬¦å·å°±å¥½â€¦â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> rt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (Code[r][<span class="number">1</span>] &gt;= l) rt = Code[r][<span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (Code[r][<span class="number">2</span>] &gt;= l) rt = Code[r][<span class="number">2</span>] ;</span><br><span class="line">    <span class="keyword">if</span> (rt &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        op[rt] = In[rt], </span><br><span class="line">      	L[rt] = build(l, rt - <span class="number">1</span>), </span><br><span class="line">      	R[rt] = build(rt + <span class="number">1</span>, r) ; <span class="keyword">return</span> rt ;</span><br><span class="line">    &#125;</span><br><span class="line">    op[r] = <span class="string">'?'</span>, <span class="built_in">sscanf</span>(In + l, <span class="string">"%d"</span>, &amp;val[r]) ; val[r] %= Mod ; <span class="keyword">return</span> r ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (op[x] == <span class="string">'?'</span>) <span class="keyword">return</span> val[x] ;</span><br><span class="line">    <span class="keyword">int</span> l = dp(L[x]) % Mod, r = dp(R[x]) % Mod, res = <span class="number">0.0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (op[x] == <span class="string">'+'</span>) res = (l + r) % Mod ;</span><br><span class="line">    <span class="keyword">if</span> (op[x] == <span class="string">'*'</span>) res = (l * r) % Mod ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; (In + <span class="number">1</span>) ;</span><br><span class="line">    N = <span class="built_in">strlen</span>(In + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (In[i] == <span class="string">'+'</span>) Add = i ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (In[i] == <span class="string">'*'</span>) Mul = i ;</span><br><span class="line">        Code[i][<span class="number">1</span>] = Add, Code[i][<span class="number">2</span>] = Mul ;</span><br><span class="line">    &#125;</span><br><span class="line">    root = build(<span class="number">1</span>, N) ; <span class="built_in">cout</span> &lt;&lt; dp(root) &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¼¼ä¹å°±æ˜¯çº¿æ€§çš„äº†ï¼ˆflag * 1ï¼‰ã€‚ç„¶è€Œæµ‹äº†ä¸€ä¸‹é€Ÿå‘ç°ï¼š</p>
<blockquote>
<p>$n^2$å†™æ³• <img src="1.jpg" alt> </p>
<p>$|S|$å†™æ³• <img src="2.jpg" alt></p>
</blockquote>
<p>ä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«â€¦â€¦äºæ˜¯è¿™å°±å¾ˆä½›äº†ã€‚ã€‚ï¼ˆfo * 1ï¼‰</p>
<h1 id="2-ç”¨æ ˆå»ºæ ‘"><a href="#2-ç”¨æ ˆå»ºæ ‘" class="headerlink" title="$2$ ç”¨æ ˆå»ºæ ‘"></a>$2$ ç”¨æ ˆå»ºæ ‘</h1><p>è¿™å…¶å®æ˜¯åœ¨UOJç¾¤é‡Œé¢<code>iki9</code>æ¨èçš„æ–¹å¼ï¼Œæˆ‘çœ‹åˆ°ä¼¼ä¹å…”é˜Ÿä¹Ÿæ˜¯è¿™ä¹ˆå»ºçš„ï¼Œäºæ˜¯å°±æ‰“ç®—å­¦ä¸€å­¦ã€‚</p>
<p>ç„¶åå…¶å®ä¹Ÿæ˜¯è›®ç®€å•çš„ï¼Œå¤§æ¦‚å°±æ˜¯å…ˆç”¨$|S|$çš„æ—¶é—´è½¬åŒ–æˆåç¼€è¡¨è¾¾å¼ï¼Œç„¶åå†ç”¨$|S|$çš„æ—¶é—´æ±‚å‡ºæ¥ã€‚</p>
<p>è½¬åç¼€è¡¨è¾¾å¼ä¹ŸæŒºç®€å•ï¼Œå°±æ˜¯æ³¨æ„ä¸€å®šè¦æ˜¯å…ˆè®¡ç®—ä¼˜å…ˆçº§é«˜çš„ã€åè®¡ç®—ä½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¼˜å…ˆçº§å•è°ƒé€’å‡çš„æ ˆæ¥ä¿å­˜ã€‚</p>
<p>è®¡ç®—çš„æ—¶å€™ç”¨ä¸€ä¸ªæ ˆè®°å½•ï¼Œæ¯é‡åˆ°ä¸€ä¸ªè®¡ç®—ç¬¦å°±å¼¹å‡ºæœ€é¡¶ä¸Šçš„ä¿©æ•°è®¡ç®—ã€‚å› ä¸ºåç¼€è¡¨è¾¾å¼çš„å®Œå¤‡æ€§æ‰€ä»¥ä¸€å®šæ˜¯å¯è¡Œçš„ã€‚</p>
<p>å¥½äº†æˆ‘å»å†™äº†â€¦â€¦</p>
<hr>
<p>â€¦â€¦è¿™è¸é©¬æ˜¯ä»€ä¹ˆæ“ä½œå•Šå–‚â€¦å…ˆè´´ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">stack</span> &lt;<span class="keyword">char</span>&gt; stk ; <span class="built_in">stack</span> &lt;<span class="keyword">int</span>&gt; Ans ; <span class="keyword">int</span> ans, i ;</span><br><span class="line"><span class="keyword">char</span> In[MAXN], op[MAXN], res[MAXN] ; <span class="keyword">int</span> N, L, val[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x ==<span class="string">'('</span>)  <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x ==<span class="string">'+'</span>)  <span class="keyword">return</span> <span class="number">2</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x ==<span class="string">'-'</span>)  <span class="keyword">return</span> <span class="number">2</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x ==<span class="string">'*'</span>)  <span class="keyword">return</span> <span class="number">3</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x ==<span class="string">'/'</span>)  <span class="keyword">return</span> <span class="number">3</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x ==<span class="string">'^'</span>)  <span class="keyword">return</span> <span class="number">4</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Comp</span><span class="params">(<span class="keyword">char</span> a, <span class="keyword">char</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> calc(a) &gt;= calc(b) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; (In + <span class="number">1</span>), N = <span class="built_in">strlen</span>(In + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isdigit</span>(In[i]))&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="built_in">isdigit</span>(In[i]))</span><br><span class="line">                ret = (ret &lt;&lt; <span class="number">1</span>) + (ret &lt;&lt; <span class="number">3</span>) + In[i] - <span class="string">'0'</span>, ++ i ;</span><br><span class="line">            i --, val[++ L] = ret, res[L] = <span class="string">'N'</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (In[i] == <span class="string">'('</span>) stk.push(In[i]) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (In[i] == <span class="string">')'</span>)&#123;</span><br><span class="line">            <span class="keyword">while</span> (stk.top() != <span class="string">'('</span>)</span><br><span class="line">                res[++ L] = stk.top(), stk.pop() ;</span><br><span class="line">            stk.pop() ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (!stk.empty() &amp;&amp; Comp(stk.top(), In[i]))</span><br><span class="line">                res[++ L] = stk.top(), stk.pop() ;</span><br><span class="line">            stk.push(In[i]) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!stk.empty()) res[++ L] = stk.top(), stk.pop() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= L ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!calc(res[i])) &#123; Ans.push(val[i]) ; <span class="keyword">continue</span> ; &#125;</span><br><span class="line">        <span class="keyword">int</span> p1 = Ans.top() ; Ans.pop() ; <span class="keyword">int</span> p2 = Ans.top() ; Ans.pop() ;</span><br><span class="line">        <span class="keyword">if</span> (calc(res[i]) == <span class="number">2</span>) &#123;<span class="keyword">int</span> p = (p1 + p2) % Mod ; Ans.push(p) ; &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (calc(res[i]) == <span class="number">3</span>) &#123;<span class="keyword">int</span> p = (p1 * p2) % Mod ; Ans.push(p) ; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; Ans.top() % Mod &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å†è´´ç»“æœï¼š</p>
<p><img src="3.png" alt></p>
<p>ï¼Ÿï¼Ÿï¼Ÿ</p>
<p>æ€è€ƒäº†æ€è€ƒï¼Œä¼¼ä¹åˆšæ‰é€’å½’é‚£ç§å†™æ³•ä¸æ˜¯$O(|S |)$çš„ï¼Ÿå—¯ï¼Œå¾ˆæœ‰é“ç†ï¼Œé‚£ç©æ„å„¿å¤æ‚åº¦åº”è¯¥æ˜¯$O(|S|\log |S|)$çš„å•Šï¼Œæ¯•ç«Ÿtmç»ˆç©¶æ˜¯æ£µå®Œå…¨äºŒå‰æ ‘â€¦â€¦</p>
<p>æˆ‘ä½›äº†</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>è¯­ä¹‰æ ‘</category>
      </categories>
      <tags>
        <tag>è¡¨è¾¾å¼/è¡¨è¾¾å¼æ ‘</tag>
        <tag>æ ‘æ¨¡å‹</tag>
        <tag>å¥‡æ€ªçš„æŠ€å·§</tag>
      </tags>
  </entry>
  <entry>
    <title>éšæƒ³ä¹ Â· æ„ä¹‰</title>
    <url>/2019/07/18/Nine/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>Letâ€™s say sunshine for everyone äººä»¬è¯´ç”Ÿæ´»æ€»æ˜¯å……æ»¡é˜³å…‰<br>But as far as I can remember ä½†åœ¨æˆ‘çš„è®°å¿†ä¸­<br>Weâ€™ve been migratory animals æˆ‘ä»¬ä¸€ç›´åªæ˜¯å¦‚é‡å…½èˆ¬æµæµª<br>Living under changing weather å››å­£å˜æ¢ï¼Œæˆ‘ä»¬å¦‚å¸¸<br>Someday we will foresee obstacles æ€»æœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬ä¼šçœ‹è§é‚£äº›å›°éš¾é˜»ç¢<br>Through the blizzard through the blizzard åœ¨é‚£ç‰‡é£é›ªä¹‹ä¸­ï¼Œåœ¨é‚£ç‰‡é£é›ªä¹‹å<br>Today we will sell our uniform å¦‚ä»Šæˆ‘ä»¬å°†æ›¾ç»çš„æ ¡æœå˜å–<br>Live together live together ä¸€åŒç¦»å»ï¼Œä¸€åŒå¯ç¨‹</p>
</blockquote>

        <div id="aplayer-QOuQqnaf" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">
            <pre class="aplayer-lrc-content"></pre>
        </div>
        <script>
          var ap = new APlayer({
            element: document.getElementById("aplayer-QOuQqnaf"),
            narrow: false,
            autoplay: false,
            showlrc: false,
            music: {
              title: "Obstacles",
              author: "Syd Matters",
              url: "Obstacles.flac",
              pic: "/2019/07/18/Nine/lis.png",
              lrc: ""
            }
          });
          window.aplayers || (window.aplayers = []);
          window.aplayers.push(ap);
        </script>
<a id="more"></a>
<h1 id="1"><a href="#1" class="headerlink" title="$1$"></a>$1$</h1><p>æœ€è¿‘æš‘å‡äº†ï¼Œä¸€ç›´é¢“çš„å¾ˆã€‚å¹¶ä¸æƒ³è¯´å¤ªå¤šï¼Œæ¯å¤©æ™šä¸Šæ˜ç¡ä¹‹é™…çœ¼å‰çš„ç«è‹—ä¼šåœ¨ç¬¬äºŒå¤©æ—©ä¸Šå¤ªé˜³å‡èµ·æ—¶ç†„ç­ï¼Œä¼¼ä¹ä¹Ÿä¸å†æ˜¯ä»€ä¹ˆç¨€ç½•äº‹ã€‚ä¸è¿‡å€’æ˜¯ä¹Ÿæœ‰æ‰€æ”¶è·ã€‚å…ˆæ˜¯å»Bç«™çœ‹<code>CèŒ</code>çš„ã€Šå¥‡å¼‚äººç”ŸäºŒÂ·å®å†µã€‹ï¼Œæ‰çŸ¥é“æœ‰ã€ŠLife is Strangeã€‹è¿™ä¹ˆä¸€æ¬¾æ¸¸æˆï¼Œäºæ˜¯ç´¢æ€§åªçœ‹äº†ã€ŠäºŒã€‹ï¼Œè‡ªå·±ä»steamä¸Šä¹°äº†ç¬¬ä¸€éƒ¨ï¼Œæ´¥æ´¥æœ‰å‘³åœ°ç©äº†èµ·æ¥ã€‚å¥ˆä½•CPUæ˜¯1.8GHzçš„ï¼Œä»…è¾¾åˆ°äº†æœ€ä½é…çš„è¦æ±‚ï¼Œæ•…ç”»é¢ä½“éªŒæœ‰äº›å·®ï¼Œä½†å€’ä¹Ÿæ— å¦¨ã€‚ä½†æˆ–è®¸æ¸¸æˆæ—¶é•¿æœ‰ç‚¹å¤šï¼Ÿåˆ«äººéƒ½è¯´â€œ15å°æ—¶é€šå…³â€ï¼Œä¼¼ä¹æˆ‘ä¹Ÿæ˜¯åœ¨æ‹½å¹³å‡åˆ†äº†ã€‚</p>
<p><img src="1.png" alt></p>
<p>å¥‡æ€ªçš„æ˜¯ä¸€ç›´æ²¡æœ‰å®˜æ–¹çš„çš„æ±‰åŒ–åŒ…ï¼ˆä½†æ˜¯2å’Œç»­ä½œéƒ½æœ‰æ±‰åŒ–åŒ…ï¼Œåªæœ‰1å®˜æ–¹æ²¡å‘å¸ƒï¼‰ï¼Œäºæ˜¯åªèƒ½å‡­å¾ˆæ¸£çš„è‹±è¯­é˜…è¯»èƒ½åŠ›æ¥ç©ï¼Œä¸­é—´è‡ªç„¶ä¹Ÿæ˜¯å’Œçœ‹ã€Šå“ˆåˆ©æ³¢ç‰¹ã€‹ä¸€æ ·ï¼Œæœ‰è®¸å¤šç»†èŠ‚æ˜¯çœ‹ä¸æ‡‚çš„ï¼Œä½†æ˜¯95%+è¿˜æ˜¯æ²¡æœ‰é—®é¢˜ã€‚å¯æƒœç©å®Œä¹‹åï¼Œæ¯•ç«Ÿæ˜¯12 P.M.äº†ï¼Œä¸çŸ¥æ˜¯çœŸçš„å‡ºäºå›°å€¦ï¼Œäº¦æˆ–æ˜¯åˆ«çš„åŸå› ï¼Œæˆ‘å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„æ„Ÿè§‰ï¼Œå¤§æ¦‚å°±æ˜¯â€œå•Šï¼Œç»“æŸäº†â€ä¾¿æ²¡äº†åæ–‡ã€‚</p>
<p>ä¹‹åçš„ä¸€å¤©åŠ<strong>å…¨</strong>ç”¨æ¥çœ‹éŸ©å‰§ã€Šç§˜å¯†æ£®æ—ã€‹ï¼Œè±†ç“£ä¸Š9åˆ†+çš„æ‚¬ç–‘åŠ›ä½œï¼Œç¡®å®ä¸é”™ï¼›ä½†æ˜¯çœ‹å®Œåˆ°ç°åœ¨ä¼¼ä¹å·²ç»è¿‡äº†10ä¸ªå°æ—¶å¤šï¼Œè‡ªå·±å´ä¸€ç‚¹æ·±åˆ»çš„æ„Ÿè§‰ä¹Ÿæ²¡æœ‰ï¼Œä»…ä»…ä¹Ÿæ˜¯â€œå•Šï¼Œç»“æŸäº†â€ã€‚æˆ‘é€¼è‡ªå·±åœ¨è„‘æµ·é‡Œæ„æ€å‡ºè¿‡å‡ ä¸ªç»“è®ºï¼Œè¯¸å¦‚â€œå‰§æƒ…å¥½ï¼Œæƒ…èŠ‚ç´§å‡‘â€ã€â€œä¸»è§’ä»¬èº«ä¸Šçš„å“è´¨å€¼å¾—å­¦ä¹ â€ä¹‹ç±»çš„è€å¥—çš„ä¸œè¥¿ï¼Œæ¯•ç«Ÿè‡ªå·±ä¸å–œæ¬¢æ¥å—â€œæˆ‘æµªè´¹äº†æ—¶é—´â€è¿™ç§äº‹å®ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»QQéŸ³ä¹ä¸Šï¼ˆæˆ‘ä¸€ç›´ä¸ç”¨ç½‘æ˜“äº‘ï¼‰æœåˆ°äº†Life is Strangeçš„soundtrackï¼Œå¬äº†å¬æœ€åé€‰æ‹©Cloyeåçš„BGMï¼Œæˆ–è€…è¯´è°¢åœºæ›²ï¼Œ<code>Obstacles</code>ï¼Œæ¸æ¸åœ°æœ‰äº†æ„Ÿè§‰ã€‚è¿™æ—¶æˆ‘æ‰æ„è¯†åˆ°ï¼Œæˆ–è®¸è¿™çœŸæ˜¯ä¸€æ¬¾ä¼Ÿå¤§çš„æ¸¸æˆã€‚</p>
<h1 id="2"><a href="#2" class="headerlink" title="$2$"></a>$2$</h1><p>åˆ°ç°åœ¨æˆ‘æ‰å‘ç°ï¼Œä¸€ä¸ªçœŸæ­£çš„çˆ±çš„ä¸œè¥¿ï¼Œæˆ–è®¸ä¸€å¼ ç…§ç‰‡å°±èƒ½è¡¨è¾¾ï¼Œä¸è®¸è¦å„ä¸ªè§’åº¦çš„æ‹æ‘„ã€ç‚¹ç¼€â€”â€”æ­¤æ„Ÿæ…¨å¤§æ¦‚æ˜¯æ¥æºäºæˆ‘æœ¬æ¥æƒ³æŠŠè‡ªå·±å¾ˆæœ‰æ„Ÿè§¦çš„ç‰‡æ®µå•Šã€é•œå¤´å•Šã€å°è¯å•Šéƒ½æ•´ç†å‡ºæ¥ï¼Œä¸¢åˆ°åšå®¢ä¸Šå°å­˜èµ·æ¥ã€‚ä½†ç¢äºè‡ªå·±å®åŠ›ä¸å¤Ÿåˆå¤ªæ‡’ï¼Œæœ€ç»ˆå†³å®šæ”¾å¼ƒäº†ã€‚å½“ç„¶ï¼Œæˆ–è®¸è¿™ä¸ªæ„Ÿæ…¨ä¹Ÿä»…æ˜¯ä¸€ä¸ªå¿ƒç†å®‰æ…°è€Œå·²å§ã€‚</p>
<p>ä¸çŸ¥æ€çš„ï¼Œæœ€è¿‘æ— è®ºåšä»€ä¹ˆäº‹éƒ½æœ‰ç§â€œå´é“å¤©å‡‰å¥½ä¸ªç§‹â€çš„æ„Ÿè§‰ã€‚çºµç„¶ååœ¨å±å¹•å‰ï¼Œå•æ›²å¾ªç¯ç€<code>Obstacles</code>çš„æˆ‘å¿ƒä¸­ä¸æ–­é—ªå›æ— æ•°ä¸ªæ¸¸æˆä¸­çš„é•œå¤´ï¼Œæˆ‘ä»æ¥æ²¡æ„è¯†åˆ°çš„æ„ŸåŠ¨ã€æ»¡è¶³åœ¨å¿ƒä¸­æ¸¸åŠ¨ï¼Œæˆ‘å´åªæƒ³æ·¡æ·¡åœ°æè¿°å®ƒï¼Œä»¿ä½›çœŸçš„æœ‰ä»€ä¹ˆä¸œè¥¿ä¸€è¯´å‡ºå£ï¼Œå°±ä¼šåŒ–ä½œçƒŸäº‘é£˜é£èµ°ï¼Œå†ä¹Ÿä¸å›ã€‚</p>
<p>æœ€åæˆ‘é€‰æ‹©äº†Cloyeï¼Œæ¯«ä¸çŠ¹è±«åœ°ï¼Œæ¯æ‰äº†å°é•‡ã€‚å¤§æ¦‚æ˜¯å¤ªæ„Ÿæ€§äº†å§ï¼Œçœ‹ç€CèŒç©å‡ºçš„æ‹¯æ•‘å°é•‡çš„ç»“å±€æœ€åï¼Œæ£ºæä¸Šç¿©ç¿©è½ä¸‹çš„é‚£åªè“è´è¶å’Œæœ€åçš„Maxçš„ç¬‘ï¼Œæˆ‘æ„Ÿåˆ°ä¸€é˜µç›®çœ©ã€‚ç»è¿‡äº†23ä¸ªå°æ—¶çš„å¥‹æˆ˜ï¼Œæˆ‘ä»¿ä½›å·²ç»å’ŒMaxèä¸ºäº†ä¸€ä½“ï¼šæˆ‘ä¼šæ„Ÿå¹è¶…èƒ½åŠ›æ»¥ç”¨çš„å±å®³ï¼Œæˆ‘çœ‹ç€Cloyeå¼€å¿ƒçš„æ ·å­è‡ªå·±ä¹Ÿä¼šå–œä¸è‡ªèƒœï¼Œçœ‹åˆ°æ¸¸æˆä¸­å‘¨å›´çš„åœºæ™¯ä¹Ÿæ¨ä¸å¾—èµ¶ç´§æ‹ä¸€å¼ ï¼Œä¹Ÿååˆ†æƒ³æ‹¥æœ‰å’ŒMaxä¸€æ ·çš„ä¹¦ç”»æ–¹å¼ï¼Œå¥é‡Œè¯é—´è´¯ç©¿ç€å……æ»¡æµ“éƒç¾å›½è¥¿éƒ¨é£å‘³çš„ç¬‘è¯ï¼Œä½†å´æ°¸è¿œä¸å¤±ç®€çº¦å’Œå¾—ä½“ã€‚æˆ‘æ„Ÿå¹è‡ªå·±èº«ä¸ºMaxæ‰€ç»å†çš„ä¸€åˆ‡ï¼Œä¸æ–­å˜æ¢çš„ç»“å±€ï¼Œä¸æ–­è¿æ¥çš„æŒ‘æˆ˜ï¼Œç›´åˆ°æœ€åæ‰å‘ç°å¯ä»¥æ”¹å˜äº‹å®çš„è‡ªå·±æœ‰å¤šä¹ˆæ— åŠ›ï¼Œæ‰å‘ç°Cloyeæ´»ç€æ‰æ˜¯æˆ‘å”¯ä¸€æƒ³è¦çš„ã€‚æ— è®ºæœ€åCloyeæ˜¯å¦ä¸ºæ­¤ç‰ºç‰²äº†ï¼Œæˆ‘éƒ½ä¼šå¾ˆæ„Ÿæ…¨å’ŒCloyeåœ¨ä¸€èµ·å®æ··ã€æ„Ÿæ…¨æˆ‘æˆåŠŸæ•‘ä¸‹äº†Kateï¼Œæ„Ÿæ…¨è‡ªå·±æˆ¿é—´çš„å°æ¸…æ–°å’ŒCloyeæˆ¿é—´çš„ç‹¬ç‰¹ï¼Œæ„Ÿæ…¨Maxå’ŒCloyeçš„é‚£ç§çˆ±æƒ…å’Œå‹æƒ…ä¸æ–­ç›¸äº’å åŠ ï¼Œåˆ›é€ å‡ºçš„é‚£ç§è‡³ç¾è‡³çœŸçš„æƒ…æ„Ÿã€‚</p>
<p>æ•´ä½“ä¸Šæ¥çœ‹ï¼Œè¿™åº”è¯¥æ˜¯ä¸ªæ‚²ä¼¤çš„æ•…äº‹â€”â€”æ— è®ºé€‰å“ªç§ç»“å±€ã€‚ä½†æ˜¯æˆ–è®¸ä¹Ÿåªæœ‰æ‚²å‰§ä¼šæŠŠç”Ÿæ´»ä¸­çš„ç¾å¥½æ’•ç¢ç»™äººçœ‹ï¼Œä¹‹åäººä»¬æ‰ä¼šä»é‚£äº›ç¢ç‰‡é‡Œé¢é‡æ–°æ‹¾èµ·å‘å‰èµ°çš„åŠ¨åŠ›å§ã€‚</p>
<p>æˆ‘å¾ˆæƒ³å’ŒMaxå’ŒCloyeåšæœ‹å‹ã€‚é‚£ä¸€å®šæ˜¯ä¸€ä»¶å¾ˆå¹¸ç¦çš„äº‹æƒ…å§ã€‚</p>
<h1 id="3"><a href="#3" class="headerlink" title="$3$"></a>$3$</h1><p>ä»ç°åœ¨å¼€å§‹ï¼Œæˆ‘å¼€å§‹å¾ˆæƒ§æ€•çœ‹ä¸€éƒ¨æ–°å‰§æˆ–è€…ç©ä¸€éƒ¨æ–°çš„æ¸¸æˆã€‚æˆ‘å®³æ€•æƒ…èŠ‚ä¼šå¤ªå¦™ã€äººç‰©ä¼šå¤ªç²¾è‡´å¯¼è‡´æˆ‘æ²‰æµ¸å…¶ä¸­æ— æ³•è‡ªæ‹”ï¼Œæ­£å¦‚æˆ‘çœ‹ã€Šå“ˆåˆ©æ³¢ç‰¹ã€‹ã€æˆ‘çœ‹ã€Šè¨€å¶ä¹‹åº­ã€‹ã€æˆ‘ç©ã€Šç”ŸåŒ–å±æœº7ã€‹ã€æˆ‘ç©Life is Strangeä¸€æ ·ï¼Œè¦ç¼“å¥½å‡ å¤©æ‰èƒ½ç¼“è¿‡æ¥ã€‚æˆ‘ä¼šæ³„æ°”ä¸ºä»€ä¹ˆæˆ‘çš„ç”Ÿæ´»æ²¡æœ‰é‚£ä¹ˆå¤šç¼¤çº·çš„å…ƒç´ â€”â€”æ²¡æœ‰é­”æ³•ã€æ²¡æœ‰å€¼å¾—æˆ‘å®ˆæŠ¤çš„ä¸œè¥¿ã€æ²¡æœ‰æ”¹å˜æ—¶é—´çš„è¶…èƒ½åŠ›ã€æ²¡æœ‰è·¨è¶Šé¸¿æ²Ÿçš„æè‡´çˆ±æƒ…ï¼›æˆ‘ä¼šæ„Ÿæ…¨ä¸ºä»€ä¹ˆæˆ‘æ²¡æœ‰ä¸»äººå…¬é‚£ç§è¶…å‡¡è„±ä¿—çš„å“è´¨ã€æƒŠäººçš„æ„å¿—æˆ–è€…ä¼˜ç§€çš„äººé™…å…³ç³»ã€‚ä»¿ä½›æ¯å¤šä¸€éƒ¨æ–‡å­¦ä½œå“ï¼Œå°±å¦‚åŒæˆ‘å¿ƒåº•é»‘æš—çš„å¤œç©ºå¤šäº†ä¸€é¢—æ˜Ÿç‚¹ï¼Œä½†æˆ‘å´åªèƒ½èœ·ç¼©åœ¨è¿œå¤„é»‘æš—çš„è§’è½ï¼Œç‘Ÿç‘Ÿåœ°å‘ç€æŠ–ï¼Œçœ‹ç€å¤©ç©ºä¸­çš„å…‰èŠ’æˆ‘ç«Ÿä¼šè§‰å¾—åˆºçœ¼ï¼Œè§‰å¾—é¿ä¹‹ä¸åŠã€‚ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™ï¼Œæˆ‘è¿æ¬£èµç¾å¥½çš„èƒ½åŠ›éƒ½æ²¡äº†ã€‚</p>
<p>ç¡®å®ï¼Œè™½ç„¶ä¸Šæ–‡æåˆ°çš„<code>Obstacles</code>è¿™æ”¯æ­Œç¡®å®æ˜¯Life is Strangeåœ¨æˆ‘å¿ƒä¸­æœ€å®Œç¾çš„è¯ é‡Šï¼Œä½†æ˜¯æˆ‘æ¯«ä¸ç•™æƒ…é¢åœ°æŠŠå®ƒç§»å‡ºäº†æˆ‘çš„æ›²åº“ã€‚ä¸åœ¨äºåˆ«çš„ï¼Œåªæ˜¯å› ä¸ºæˆ‘ä¸æƒ³å†ä¸€å¬æŸé¦–æ­Œå°±æœ‰æƒ³å“­çš„å†²åŠ¨ï¼Œä¸æƒ³å†å¬ä¸€é¦–æ­Œå°±æ„Ÿåˆ°è‡ªå·±æœ‰å¤šä¹ˆå­¤ç‹¬ã€‚rqyå£ä¸­çš„â€œæ—©åœ¨å¿ƒé‡Œå“­è¿‡äº†â€æˆ–è®¸å°±æ˜¯è¿™ç§æ„Ÿè§‰å§ã€‚</p>
<p>æˆ‘åˆèƒ½åšä»€ä¹ˆå‘¢ï¼Ÿæ— è®ºå‘¨å›´æœ‰å¤šå°‘äººè·Ÿæˆ‘æˆå¤©å¼€ç©ç¬‘å•Šã€æ–—å˜´å•Šï¼Œæˆ‘çœŸçš„æŠŠä»–ä»¬æ‰“å¿ƒåº•å½“ä½œè¿‡ç†è§£æˆ‘çš„äººå—ï¼Ÿæˆ‘æ„Ÿè§‰è‡ªå·±æ¯å¤©å°±å¦‚åŒä¸€åº§ç©ºå£³ä¸€æ ·ï¼Œè¡Œå°¸èµ°è‚‰èˆ¬åœ°æ‹…å¿ƒç€ä¸€åˆ‡ã€‚å¤§æ¦‚æˆ‘æ˜¯å¾ˆéš¾æŠŠå¿ƒæ•å¼€ç»™è°çš„æŠŠï¼Œæˆ–è€…å³ä½¿æˆ‘æ•å¼€äº†æˆ‘ä¹Ÿä¸è®¤ä¸ºè‡ªå·±æ•å¼€äº†å§ï¼›ä»¥æ­¤ä¸ºç†ç”±è¯´â€œå¤§æ¦‚æ˜¯å› ä¸ºæ²¡æœ‰å¦ä¸€åŠé€ æˆçš„â€ï¼Œä¹Ÿä¸è¿‡æ˜¯ç—…æ€¥ä¹±æŠ•åŒ»å§ã€‚æˆ‘å°±ä»¿ä½›ä¸€åªè¿·é€”çš„å°èˆ¹ï¼Œæ°¸è¿œä¸çŸ¥é“è‡ªå·±çš„ä¸‹ä¸€ç«™åœ¨å“ªé‡Œã€‚-</p>
<p>å…¶å®è¯´åˆ°åº•ï¼Œè¿˜æ˜¯æˆ‘æ ¹æœ¬ä¸çŸ¥é“å¦‚ä½•å»ç”Ÿæ´»ã€‚ä¹‹å‰ç§¯ç´¯çš„æµ®èºè®©æˆ‘ä¸çŸ¥é“è¯¥å¦‚ä½•é¢å¯¹å¹³å¸¸äººçš„ç”Ÿæ´»ï¼Œæ¥åˆ°é«˜ä¸­ä¹‹åæˆ‘æ‰çŸ¥é“â€œå“¦ï¼ŒåŸæ¥åŠªåŠ›æ‰æ˜¯ç¡¬é“ç†â€ã€‚æˆ–è®¸æ˜¯rqyå¤ªå¼ºäº†ï¼Œå¼ºåˆ°ä»–çš„å…‰èŠ’æ´’åœ¨æˆ‘çœ¼å‰æ—¶ä¼šè®©æˆ‘æœ‰ç§æˆ‘ä¹Ÿå¯ä»¥è½»æ¾åˆ°è¾¾é‚£ä¸ªé«˜åº¦çš„é”™è§‰â€”â€”æ•´ä¸ªé«˜ä¸€ä»¿ä½›åªæœ‰æœ€åä¸€æ˜ŸæœŸä¸æ˜¯æµ®èºçš„ã€‚</p>
<p>æˆ–è®¸ï¼Œæˆ‘ä¸€ç›´æ˜¯ä¸ªå¾ˆå¥½çš„$\rm{Admirator}$  (ç¾¡æ…•è€…)è€Œä¸æ˜¯ä¸€ä¸ªå¥½çš„$\rm{Doer}$(å®è·µè€…)å§ã€‚</p>
<h1 id="4"><a href="#4" class="headerlink" title="$4$"></a>$4$</h1><p>æˆ‘ä¸€ç›´æƒ³çŸ¥é“è‡ªå·±ç°åœ¨åˆ°åº•ä¸ºä½•è€Œæ´»ï¼Œæ´»çš„æ„ä¹‰åˆæ˜¯ä»€ä¹ˆã€‚</p>
<p>æ”¾çœ¼å››å‘¨å…¨æ˜¯çƒŸé›¾å¼¥æ¼«ï¼Œæˆ‘ç•æƒ§äº†ã€‚</p>
<p>æˆ–è®¸åªè¦æˆ‘å¼ºä¸€äº›ï¼Œåœ¨æ–‡åŒ–è¯¾ä¸Šã€æˆ–è€…åœ¨å¥¥èµ›ä¸Šå–å¾—äº†éª„äººçš„æˆç»©æˆ‘å°±å¯ä»¥å…¨èº«å¿ƒæŠ•å…¥å…¶ä¸­ä¸€è€…äº†ã€‚ä½†å¥ˆä½•å®åŠ›ä¸è¶³ï¼Œä¸¤è€…éƒ½ä¸æ˜¯æˆ‘çš„æ‹¿æ‰‹é¡¹ã€‚æˆ‘å¼€å§‹æ…Œäº†ã€‚ä¹‹å‰çš„å²æœˆä»¿ä½›éƒ½æ˜¯è™šåº¦ï¼Œè‡ªå·±å»å¹´å¤šä¹ˆå¼±ï¼Œä»Šå¹´ä¼¼ä¹ä¹Ÿå¹¶æ²¡æœ‰ä»€ä¹ˆå®è´¨çš„å˜åŒ–ã€‚æˆ‘å¼€å§‹æ…Œäº†ã€‚</p>
<p>å¤§å®¶éƒ½è¯´â€œä¸èƒ½åŠŸåˆ©åœ°æOIå•Šâ€ï¼Œå‘¨å›´mcfxã€rqyçš„æˆåŠŸä¹Ÿéƒ½åå¤è®ºè¯äº†è¿™ä¸€ç‚¹ã€‚ä½†æ˜¯æˆ‘ï¼Œæˆ‘â€¦å¯¹æˆ‘è€Œè¨€ï¼Œä¼¼ä¹æ²¡æœ‰æ¯”è¿™ä¸ªæ›´é«˜çš„ç²¾ç¥åŠ¨åŠ›äº†å•Šã€‚å‘¨å›´å¼‚æ ·çš„ç›®å…‰æ¥è¸µè€Œæ¥ï¼Œå› ä¸ºæˆ‘ä¸æ˜¯å¼ºè€…ï¼Œä¸å¯èƒ½è¯´å‡ºä»€ä¹ˆâ€œèµ°è‡ªå·±çš„è·¯ï¼Œè®©åˆ«äººè¯´å»å§â€çš„è±ªè¨€å£®è¯­â€”â€”æŒ‰ç€ä¼ ç»Ÿçš„æ­¥è°ƒéƒ½ä¸èƒ½å–èƒœï¼Œè‡ªå·±çš„æ­¥è°ƒå¤§æ¦‚åªæ˜¯é£è›¾æ‰‘ç«å§ã€‚</p>
<p>æˆ‘ä¼¼ä¹è§‰å¾—æœ‰äº›å¥‡æ€ªï¼Œå¤§æ¦‚è‡ªå·±æœ¬æ¥å°±ä¸æ˜¯æOIçš„äººï¼Œæˆ–è®¸æ˜¯ä¸ªæ–‡å­¦å®¶æ›´åˆé€‚ï¼›ä½†æ˜¯çœ‹åˆ°æœŸæœ«è€ƒè¯•æƒ¨ä¸å¿ç¹çš„è¯­æ–‡åˆ†æ•°ï¼Œæˆ‘åˆè¿·èŒ«äº†ï¼›å¤§æ¦‚è‡ªå·±æœ¬æ¥å°±æ²¡æœ‰å¤šåŠªåŠ›ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰ä»Šå¹´çœé€‰å‰è‡ªå·±å·²ç»å¤ŸåŠªåŠ›äº†å•Šï¼Œæˆ–è®¸åªæ˜¯æ–¹å‘é”™äº†â€”â€”ä½†æ˜¯æ–¹å‘åˆåœ¨å“ªå‘¢ï¼Œæˆ‘åˆè¿·èŒ«äº†ã€‚</p>
<p>ä¼¼ä¹å¤©åœ°ä¹‹å¤§ï¼Œåªæœ‰æˆ‘ä¸€ä¸ªäººæ•´æ—¥æ²‰æµ¸åœ¨è¿·èŒ«ä¹‹ä¸­æ— æ³•è„±èº«ï¼šäººä¸äººçœŸæ˜¯ä¸ä¸€æ ·å•Šã€‚æœ‰äº›äººå°±æ˜¯å¯ä»¥æ— é—®è¥¿ä¸œã€æ•¢æƒ³æ•¢å¹²ï¼›æˆ‘åˆ™åªä¼šæ˜¯ä¸€ä¸ªæ‚é±¼ï¼Œç¡æ­»åœ¨æ¼«æ— è¾¹é™…çš„å†¬æ—¥ã€‚</p>
<p>æ¯åˆ°è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘éƒ½å¥½æƒ³é€ƒè·‘ï¼Œæˆ‘æƒ³è·‘åˆ°Maxå’ŒCloyeçš„é‚£ä¸ªå°é•‡ï¼Œå’Œä»–ä»¬ä¸€èµ·æ— å¿§æ— è™‘åœ°æ´»ç€ï¼Œæ²¡æœ‰æ–‡åŒ–è¯¾çš„å‹åŠ›ï¼Œæ²¡æœ‰å‡å­¦çš„å‹åŠ›ï¼Œæ²¡æœ‰è±ªè¨€å£®è¯­çš„å‹åŠ›ï¼Œæ²¡æœ‰OIçš„å‹åŠ›ï¼Œå°±åªæ˜¯ç®€å•åœ°æ´»ç€â€¦â€¦æœ€é‡è¦çš„ï¼Œæˆ‘å¯ä»¥ä¸æ€è€ƒæˆ‘ä¸ºä½•è€Œæ´»ã€‚</p>
<p>å½“ç„¶ï¼Œä»¥ä¸Šéƒ½æ˜¯ä¸€ä¸ªé«˜ä¸­ç”Ÿçš„æ— ç—…å‘»åŸè€Œå·²ã€‚è¯´åˆ°åº•ï¼Œæˆ‘è¿˜æ˜¯æ²¡æœ‰ä»»ä½•å‹‡æ°”çš„è¼èšï¼Œä¸çŸ¥é“è¯¥æ€æ ·ç›´é¢ç”Ÿæ´»çš„ç—›å‡»ï¼Œä¸çŸ¥é“å¦‚ä½•è‡ªåœ¨åœ°æ´»ï¼Œæ•æ„Ÿï¼Œè€Œé¢“åºŸã€‚</p>
<blockquote>
<p>é™¤äº†å‹‡æ°”ï¼Œæˆ‘ä»€ä¹ˆéƒ½ä¸ç¼ºã€‚</p>
</blockquote>
<p>Life is Strangeï¼ŒMaxï¼ŒCloyeï¼Œå¯„æ‰˜ç€çš„ï¼Œæ˜¯æˆ‘é¥ä¸å¯åŠçš„ä¸€ä¸ªæ¢¦å•Šã€‚</p>
<p><img src="2.png" alt></p>
<h1 id="5"><a href="#5" class="headerlink" title="$5$"></a>$5$</h1><p>ç»ˆäºæˆ‘è¦é‡æ–°ä¸Šè·¯äº†ï¼Œè¿‡å»çš„å¿«ä¹æˆ‘æƒ³æŠ¹å»ï¼Œè¿‡å»çš„å¿ƒé…¸æˆ‘æƒ³åŸ‹è‘¬ã€‚çœ¼æ³ªå‚é’è¿‡çš„åœŸåœ°æ˜¯ç¿»ä¸Šæ¥çš„æ–°æ³¥ï¼Œåœ¨å¿ƒé‡Œæ­»äº†å¥½å‡ æ¬¡ä¹Ÿå¿…é¡»é‡ç”Ÿã€‚</p>
<p>è‡³äºæ–‡å­¦ä½œå“ï¼Œæˆ‘èƒ½æƒ³åˆ°çš„æœ€å¥½çš„ç»“æŸä¾¿æ˜¯å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>æˆ–è®¸ï¼Œ<br>æ¯ä¸€ä»½ç²¾è‡´çš„è‰ºæœ¯ä½œå“éƒ½æ˜¯ä¸€ä¸ªæœ‰æ¡ä¸ç´Šçš„ä¸–ç•Œï¼›<br>æœ‰å…³é‚£ä¸ªä¸–ç•Œçš„å›å¿†ï¼Œä¸å¦‚æŠ˜å èµ·æ¥ï¼Œå°±ç•™åœ¨é‚£ä¸ªä¸–ç•Œå§ã€‚</p>
</blockquote>
<p>æ˜¯å•Šï¼ŒMaxå’ŒCloyeçš„æ•…äº‹ï¼Œå°±ç•™ç»™é˜¿å¡è¿ªäºšæ¹¾å’Œä»–ä»¬å³å°†æŠµè¾¾çš„è¥¿é›…å›¾å§ï¼›ç§‹æœˆå­é›„å’Œé›ªé‡ç™¾é¦™é‡Œçš„æ•…äº‹å°±ç•™åœ¨é‚£ä¸ªå¤è‰²å¤é¦™çš„é›¨äº­å§ã€‚ä¸€åˆ‡çš„ä¸€åˆ‡éƒ½æ˜¯ç¢ç‰‡ï¼Œåœ¨æ—¶ç©ºé‡Œé¢ç©¿è¡Œï¼Œå€è€Œæ¶ˆå¤±ä¸è§ï¼Œå€è€Œåˆå‡ºç°åœ¨æˆ‘çœ¼å‰ã€‚é“­è®°å’Œæ²‰æ²¦æ²¡æœ‰æ„ä¹‰ï¼›è¿™ä¸ªä¸–ç•Œçš„ä¸€åˆ‡ï¼Œæ— è®ºå¤šä¹ˆæ— èŠä¸ä¸å¯æœŸå¾…ï¼Œæ˜å¤©å¤ªé˜³å‡èµ·æ—¶ï¼Œä¾¿è¿˜è¦ç»§ç»­ã€‚</p>
<p>æ„ä¹‰ï¼Ÿä¼¼ä¹æ„ä¹‰è¿™ä¸œè¥¿æœ¬èº«å°±æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ç†è§£ç”Ÿå‘½ã€ç†è§£ç”Ÿæ´»åè€Œæ˜¯æŸç§å±ˆä»ï¼Œè€ŒçœŸæ­£çš„è‹±é›„åˆ™æ˜¯å‘½è¿çš„æ–—å£«â€”â€”å°±å¥½åƒJO5é‡Œé¢çš„ä¸»è§’ä»¬ï¼Œåšå®šåœ°ä¸¾èµ·åæŠ—å‘½è¿çš„å¤§æ——ã€‚</p>
<p>æ˜æ—¥æ˜¯å¦å¦‚åŒä»Šæ—¥ä¸€æ ·æ²‰æ²¦ï¼Ÿæˆ‘ä¸çŸ¥é“ã€‚æˆ‘åªçŸ¥é“æŠŠæ¡ä½ä¸‹ä¸€ç§’å°±è¶³å¤Ÿäº†ã€‚ä¹‹å‰çš„ç”Ÿæ´»çš„æ¯ä¸€å¸§ä»¿ä½›éƒ½åƒæ˜¯é£˜åœ¨ç©ºä¸­çš„æ³¡å½±è€Œå·²ï¼Œæ´—åˆ·ç€å­˜åœ¨äºè™šå¦„ä¸­çš„è®°å¿†ï¼Œä¸€æ¬¡ä¸€æ¬¡ï¼Œå¦‚åŒæ·é”ä¸€æ ·é˜»éç€æˆ‘çš„å‰è¿›ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¯·å›å‹¿è¨€ä»€ä¹ˆæ˜å¤©æ›´å¥½ä¹‹ç±»çš„Pè¯äº†ï¼Œåœ¨ç»æœ›ä¸­æ±‚ç”Ÿæ‰æ˜¯äººç”Ÿçš„å¸¸æ€ã€‚å°±å¦‚åŒä»å³­å£ä¸­ç”Ÿå‡ºçš„å…°èŠ±ï¼ŒæŒ¤è½ä¸€æ»çŸ³å°˜éƒ½æ˜¯æˆåŠŸã€‚</p>
<hr>
<p>ã€Šéšæƒ³ã€‹ç³»åˆ—ç›®æ¬¡è¡¨ï¼š<a href="http://www.orchidany.cf/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/" target="_blank" rel="noopener">$Link$</a></p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>éšæƒ³/ä¸‹ä¸‹ç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ³›åšã€‘Old-NOIP æ³›åšä¸€</title>
    <url>/2019/07/11/old-noip/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>é¦–å…ˆç®€ä»‹ä¸€ä¸‹è¿™ç¯‡æ–‡ç« çš„æ¥å†â€¦â€¦</p>
<p>æ­¤æ—¶çš„æˆ‘æ­£åœ¨çç¿»ä¹‹å‰åšè¿‡çš„ã€çœ‹èµ·æ¥è¿˜å¯ä»¥çš„NOIPæ°´é¢˜ï¼Œè§‰å¾—å“ªä¸ªåœ°æ–¹å€¼å¾—æ³¨æ„å°±æ•´äº†ä¸‹æ¥ã€‚ç„¶è€Œå®é™…ä¸Šæˆ‘æ˜¯åªæƒ³æ•´ç†â€œæ³›åšäºŒâ€é‡Œçš„é¢˜ç›®ã€‚ä¸è¿‡ä¸€æƒ³ä¼¼ä¹è‡ªå·±åŸºç¡€ä¸æ‰å®ï¼Œäºæ˜¯æ‰æœ‰äº†è¿™ç¯‡æ°´æ–‡ã€‚</p>
<a id="more"></a>
<h1 id="1-2013B-ç«æŸ´æ’é˜Ÿ"><a href="#1-2013B-ç«æŸ´æ’é˜Ÿ" class="headerlink" title="$1~2013B$ ç«æŸ´æ’é˜Ÿ"></a>$1~2013B$ ç«æŸ´æ’é˜Ÿ</h1><p><a href="https://www.luogu.org/problem/P1966" target="_blank" rel="noopener">Link</a></p>
<p>è¿™çœŸæ˜¯ä¸ªæ°´é¢˜ã€‚ä½†æ˜¯ä¹‹å‰åšçš„æ—¶å€™æ²¡æ„è¯†åˆ°ä¸€äº›é—®é¢˜ï¼Œå‰å‡ å¤©ç¿»æ¥çœ‹çœ‹åˆæŠŠè¿™ä¸ªé¢˜ç§’äº†ä¸€éã€‚</p>
<p>è§‚å¯Ÿæ•´ä¸ªå¼å­ï¼Œæˆ‘ä»¬æ‹†å¼€ä¹‹åå°±å‘ç°æ˜¯åœ¨æœ€å°åŒ–$-\sum a_ib_i$ï¼Œä¹Ÿå°±æ˜¯æœ€å¤§åŒ–$\sum a_ib_i$ã€‚ç„¶åæ ¹æ®é€‰ä¿®4-5é‡Œé¢çš„<strong>æ’åºä¸ç­‰å¼</strong>ï¼Œé€†åºå’Œ&lt;ä¹±åºå’Œ&lt;é¡ºåºå’Œï¼Œç›´æ¥æ‰¾é€†åºå¯¹å°±å¥½ã€‚</p>
<p><del>å·å·å­¦æ•°å­¦çœŸæœ‰ç”¨å•Š/kk</del></p>
<h1 id="2-2014C-é£æ‰¬çš„å°é¸Ÿ"><a href="#2-2014C-é£æ‰¬çš„å°é¸Ÿ" class="headerlink" title="$2 ~2014C$ é£æ‰¬çš„å°é¸Ÿ"></a>$2 ~2014C$ é£æ‰¬çš„å°é¸Ÿ</h1><p><a href="https://www.luogu.org/problem/P1941" target="_blank" rel="noopener">Link</a></p>
<p>â€¦â€¦ä¸€é“goué¢˜ã€‚</p>
<p>å½“æ—¶å…¨å¤©ä¸‹éƒ½çŸ¥é“çŠ¶æ€$f_{i,j}$å°±æˆ‘ä¸ä¼šè½¬ç§»â€¦èƒŒåŒ…å…¶å®æŒºæ˜¾ç„¶çš„ï¼Œä¸Šå‡çš„æ—¶å€™åšå®Œå…¨èƒŒåŒ…ï¼Œæ³¨æ„ç”±äºå³ä½¿ğŸ¦åœ¨å¤©èŠ±æ¿é‡Œé¢($h= m$)æ—¶ä¹Ÿå¯ä»¥è·³ï¼Œæ‰€ä»¥å¤šè½¬ç§»å‡ æ¬¡ï¼Œ ä¸”æ³¨æ„æ—¢å¯ä»¥ä»i-1è½¬ç§»è¿‡æ¥ï¼Œä¹Ÿå¯ä»¥ä»ç°åœ¨çš„iè½¬ç§»è¿‡æ¥ï¼›ä¸‹é™çš„æ—¶å€™åšåå‘å€¼åŸŸçš„01èƒŒåŒ…ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; K ; ans = Inf ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;up[i], &amp;dw[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">      Wd[i][<span class="number">0</span>] = <span class="number">-1</span>, Wd[i][<span class="number">1</span>] = M + <span class="number">1</span> ; <span class="built_in">memset</span>(dp, <span class="number">63</span>, <span class="keyword">sizeof</span>(dp)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= K ; ++ i) </span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;k), S[k] = <span class="number">1</span>, <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;Wd[k][<span class="number">0</span>], &amp;Wd[k][<span class="number">1</span>]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= M ; ++ i) dp[<span class="number">0</span>][i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="comment">/*for (i = 2 ; i &lt;= N ; ++ i)</span></span><br><span class="line"><span class="comment">        for (j = Wd[i][0] + 1 ; j &lt; Wd[i][1] ; ++ j)&#123;</span></span><br><span class="line"><span class="comment">            dp[i][j] = dp[i - 1][j + dw[i]] ;</span></span><br><span class="line"><span class="comment">            for (k = 0 ; k &lt;= (j - Wd[i - 1][0] - 1) / up[i] ; ++ k)</span></span><br><span class="line"><span class="comment">                dp[i][j] = min(dp[i - 1][j - k * up[i]] + k, dp[i][j]) ;</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (j = up[i] + <span class="number">1</span> ; j &lt;= M + up[i] ; ++ j)</span><br><span class="line">            dp[i][j] = min(dp[i - <span class="number">1</span>][j - up[i]], dp[i][j - up[i]]) + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (j = M + <span class="number">1</span> ; j &lt;= M + up[i] ; ++ j) </span><br><span class="line">          	dp[i][M] = min(dp[i][M], dp[i][j]) ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= M - dw[i] ; j ++) </span><br><span class="line">          	dp[i][j] = min(dp[i][j], dp[i - <span class="number">1</span>][j + dw[i]]) ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= Wd[i][<span class="number">0</span>] ; ++ j) dp[i][j] = Inf ; </span><br><span class="line">      	<span class="keyword">for</span> (j = Wd[i][<span class="number">1</span>] ; j &lt;= M ; j ++) dp[i][j] = Inf ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) ans = min(ans, dp[N][i]) ; </span><br><span class="line">    <span class="keyword">if</span> (ans &lt; <span class="number">19260817</span>) <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"%d\n%d\n"</span>, <span class="number">1</span>, ans),<span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) S[i] = S[i - <span class="number">1</span>] + S[i] ; l = <span class="number">1</span>, r = N, p ;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>, ans = Inf ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) ans = min(ans, dp[mid][i]) ;</span><br><span class="line">        <span class="keyword">if</span> (ans &lt; <span class="number">19260817</span>) l = mid + <span class="number">1</span>, p = mid ; <span class="keyword">else</span> r = mid - <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="built_in">endl</span> &lt;&lt; S[p] &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-2001C-ç»Ÿè®¡å•è¯æ•°"><a href="#3-2001C-ç»Ÿè®¡å•è¯æ•°" class="headerlink" title="$3~2001C$ ç»Ÿè®¡å•è¯æ•°"></a>$3~2001C$ ç»Ÿè®¡å•è¯æ•°</h1><p><a href="https://www.luogu.org/problem/P1026" target="_blank" rel="noopener">$Link$</a> ä¸€é“å¾ˆæ°´çš„DPï¼Œéš¾ç‚¹ï¼ˆå¦‚æœå¯ä»¥ç§°ä¹‹ä¸ºéš¾çš„è¯ï¼‰åœ¨äºåˆ¤æ–­ã€‚ç„¶åæ­¤å¤„ç”¨çš„æ˜¯å“ˆå¸Œï¼Œåˆ¤æ–­çš„æ—¶å€™å°±çåˆ¤å°±å¥½äº†ï¼ˆé›¾</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line">pair &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; p ; </span><br><span class="line"><span class="keyword">char</span> D[MAXLEN][<span class="number">10</span>] ;</span><br><span class="line"><span class="keyword">const</span> UN LL base = <span class="number">131</span> ;</span><br><span class="line">LL Hash[MAXLEN][MAXLEN], H[<span class="number">10</span>] ;</span><br><span class="line"><span class="built_in">stack</span>&lt; pair &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; s, s2 ;</span><br><span class="line"><span class="keyword">const</span> UN LL Mod = <span class="number">192183781721L</span>L ;</span><br><span class="line"><span class="keyword">int</span> dp[MAXLEN][<span class="number">50</span>], Len, Length[<span class="number">10</span>], o ;</span><br><span class="line"><span class="keyword">int</span> P, M, K, i, j, k, di, dj ; <span class="keyword">char</span> S[MAXLEN] ;     </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">Hashh</span><span class="params">(<span class="keyword">int</span> Mark)</span></span>&#123;</span><br><span class="line">	UN LL res = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">if</span> (!Mark) &#123;</span><br><span class="line">		<span class="keyword">for</span> (k = j ; k &lt;= i ; ++ k)</span><br><span class="line">			res = (res * base + S[k]) % Mod ; </span><br><span class="line">		<span class="keyword">return</span> res ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt;= Length[Mark] ; ++k)</span><br><span class="line">		res = (res * base + D[Mark][k]) % Mod ;</span><br><span class="line">	<span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Sum</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	LL res[<span class="number">7</span>] ;</span><br><span class="line">	<span class="built_in">memset</span>(res, <span class="number">0</span>, <span class="keyword">sizeof</span>(res)) ;</span><br><span class="line">	<span class="keyword">for</span> (di = <span class="number">1</span>; di &lt;= M ; ++ di)</span><br><span class="line">		<span class="keyword">for</span> (dj = x ; dj &lt;= y - Length[di] ; ++ dj)</span><br><span class="line">			<span class="keyword">if</span> (Hash[dj][dj + Length[di]] == H[di]) ++ res[di] ;</span><br><span class="line">	<span class="keyword">while</span> (!s.empty()) &#123;</span><br><span class="line">		p = s.top() ;</span><br><span class="line">		res[p.first] &gt; res[p.second] ? res[p.second] : res[p.first] = <span class="number">0</span> ; </span><br><span class="line">		s.pop(), s2.push(p) ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (!s2.empty()) s.push(s2.top()), s2.pop() ;</span><br><span class="line">	<span class="keyword">return</span> res[<span class="number">1</span>] + res[<span class="number">2</span>] + res[<span class="number">3</span>] + res[<span class="number">4</span>] + res[<span class="number">5</span>] + res[<span class="number">6</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; P &gt;&gt; K ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; P ; ++ i) </span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%20s"</span>, S + i * <span class="number">20</span>) ;	<span class="built_in">cin</span> &gt;&gt; M ; Len = <span class="built_in">strlen</span>(S) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) </span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, D[i]), Length[i] = <span class="built_in">strlen</span>(D[i]) - <span class="number">1</span>, H[i] = Hashh(i) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt; i ; ++ j)&#123;</span><br><span class="line">			<span class="keyword">bool</span> flag = <span class="number">1</span> ;</span><br><span class="line">			<span class="keyword">for</span> (di = <span class="number">0</span> ; di &lt;= min(Length[j], Length[i]) ; ++ di)</span><br><span class="line">				<span class="keyword">if</span> (D[j][di] != D[i][di])&#123; flag = <span class="number">0</span> ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">			<span class="keyword">if</span> (flag) s.push(&#123;i, j&#125;), ++ o ;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= i ; ++ j) </span><br><span class="line">			Hash[j][i] = Hashh(<span class="number">0</span>) ;</span><br><span class="line">	<span class="comment">/*for (i = 0 ; i &lt; Len ; ++ i) </span></span><br><span class="line"><span class="comment">		for (j = 0 ; j &lt; i ; ++ j) </span></span><br><span class="line"><span class="comment">			printf("%d%c", Sum(j, i)," \n"[j == i - 1]) ;*/</span></span><br><span class="line">	<span class="keyword">for</span> (k = <span class="number">1</span> ; k &lt;= K ; ++ k)</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; Len ; ++ i)</span><br><span class="line">			<span class="keyword">for</span> (j = k - <span class="number">1</span> ; j &lt;= i ; ++ j)</span><br><span class="line">				dp[i][k] = max(dp[i][k], dp[max(<span class="number">0</span>, j - <span class="number">1</span>)][k - <span class="number">1</span>] + Sum(j, i)) ;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; dp[Len - <span class="number">1</span>][K] &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="4-2005B-è¿‡æ²³"><a href="#4-2005B-è¿‡æ²³" class="headerlink" title="$4~2005B$ è¿‡æ²³"></a>$4~2005B$ è¿‡æ²³</h1><p><a href="https://www.luogu.org/problem/P1052" target="_blank" rel="noopener">$Link$</a></p>
<p>ä¹Ÿæ˜¯ä¸€é“å¾ˆæ°´çš„DPã€‚æ•´ç†è¿™ä¸ªé¢˜çš„åŸå› æ˜¯å› ä¸ºå¥½ä¹…ä¹‹å‰çš„å½“æ—¶åšè¿™é¢˜æ—¶ç”¨äº†ä¸€ç§è¯¡å¼‚çš„åšæ³•ï¼Œå³é€šè¿‡å¯¹$\sqrt{1e9}$å–æ¨¡è¿›è¡Œå‹ç¼©ï¼Œä½†æ˜¯è¿™æ˜¾ç„¶ä¸å¯¹å› ä¸º1ï¼šæˆ‘çš„å†™æ³•æ²¡æœ‰å¤„ç†modä¹‹åä½ç½®ç›¸åŒçš„æƒ…å†µï¼›å†è€…è½¬ç§»è¿‡ç¨‹ä¹Ÿååˆ†åœ°ä¸æœè´£ä»»ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> mod=<span class="number">32501</span>;</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">200000</span>];</span><br><span class="line"><span class="keyword">bool</span> pos[<span class="number">200000</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n,l,r,m,cnt=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;l&gt;&gt;r&gt;&gt;m;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		<span class="keyword">int</span> x; <span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">		pos[x%mod]=<span class="number">1</span>;	<span class="keyword">if</span>(l==r&amp;&amp;x%l==<span class="number">0</span>)cnt++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(l==r)&#123;	<span class="built_in">cout</span>&lt;&lt;cnt; <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=mod;i++) f[i]=MAXN;</span><br><span class="line">	f[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=mod;i++)</span><br><span class="line">	 <span class="keyword">for</span>(<span class="keyword">int</span> j=l;j&lt;=r;j++)&#123;</span><br><span class="line">		<span class="keyword">int</span> k=i%mod;</span><br><span class="line">		<span class="keyword">if</span>(i&gt;=j)f[i]=min(f[i],f[i-j]+pos[k]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;f[mod];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†é—®é¢˜æ˜¯ï¼Œå®ƒè¿‡äº†ï¼Œè¿™å°±å¾ˆè¿·ã€‚ä»”ç»†æƒ³æƒ³ï¼Œä¼¼ä¹å¯èƒ½æ˜¯å› ä¸ºçŸ³å¤´æ•°é‡å¤ªå°äº†ï¼Œåªæœ‰100ï¼Œæ‰€ä»¥éšæœºä¸¢åˆ°ç©ºé—´é‡Œå»æœŸæœ›æ„ä¹‰ä¸Šæ¯$1e7$ä¼šæœ‰ä¸€å—çŸ³å¤´ï¼Œä¸”modä¹‹åä½äºåŒä¸€ä¸ªä½ç½®çš„æ¦‚ç‡çš„ç›¸åæ•°æ˜¯$32501$ï¼Œæ‰€ä»¥å¾ˆéš¾æœ‰è¿™ç§æ•°æ®å‡ºç°â€¦â€¦æ¢å¥è¯è¯´ï¼Œæ•°æ®æ°´æ­»äº†ã€‚</p>
<p>ç„¶è€ŒçœŸæ­£çš„åšæ³•åº”è¯¥æ˜¯â€œ2520ç¼©â€ï¼Œæ„æ€å°±æ˜¯å› ä¸ºé¢˜ç›®ä¸­çš„ s~t çš„å–å€¼èŒƒå›´æ˜¯ 1~10ï¼Œæ‰€ä»¥å–$lcm(1,2,..,10)=2520$æ˜¯å¯è¡Œçš„ã€‚</p>
<h1 id="5-2009B-Hanksonçš„è¶£å‘³é¢˜"><a href="#5-2009B-Hanksonçš„è¶£å‘³é¢˜" class="headerlink" title="$5~2009B$ Hanksonçš„è¶£å‘³é¢˜"></a>$5~2009B$ Hanksonçš„è¶£å‘³é¢˜</h1><p><a href="https://www.luogu.org/problem/P1072" target="_blank" rel="noopener">$Link$</a></p>
<p>æ•´è¿™ä¸ªé¢˜åªæ˜¯å› ä¸ºæƒ…æ€€â€¦â€¦</p>
<p>é¥ä¸å¯åŠçš„è¿‡å»å•Šâ€¦â€¦<a href="https://pks-loving.blog.luogu.org/solution-p1072" target="_blank" rel="noopener">Solution</a></p>
<h1 id="6-2004D-è™«é£Ÿç®—"><a href="#6-2004D-è™«é£Ÿç®—" class="headerlink" title="$6~2004D$ è™«é£Ÿç®—"></a>$6~2004D$ è™«é£Ÿç®—</h1><p><a href="https://www.luogu.org/problem/P1092" target="_blank" rel="noopener">$Link$</a></p>
<p>æ•´è¿™ä¸ªé¢˜æ›´æ˜¯å› ä¸ºæƒ…æ€€äº†â€¦â€¦</p>
<p>å½“æ—¶æ˜¯ä½•æ—¶ï¼Ÿä¸è®°å¾—æ˜¯æœ«å†¬è¿˜æ˜¯æš‘å‡ï¼Œåªè®°å¾—æˆ‘ååˆ†å¼€å¿ƒåœ°å»é«˜ä¸­éƒ¨åŸ¹è®­ï¼Œåƒæ—©é¥­ä¹‹å‰è·ŸrqyçèŠï¼ŒèŠä»€ä¹ˆâ€œæ˜¯ä¸æ˜¯åªè¦æˆ‘å‘æ˜å‡ºå¯ä»¥å¤„ç†è´Ÿæƒè¾¹çš„Dijkstraå°±å¯ä»¥ä¸Šæ¸…åäº†â€ï¼Œä¸è‡ªè§‰åœ°èŠåˆ°äº†è¿™é“é¢˜ã€‚å—¯â€¦åœºæ™¯ä»€ä¹ˆçš„éƒ½å†å†åœ¨ç›®ï¼Œå°¤å…¶æ˜¯é¤å…ä¸œè¾¹æ´’è½çš„ç™½è‰²çš„é˜³å…‰ï¼Œä¸€ç›´åœ¨æˆ‘çš„è®°å¿†ä¸­é—ªäº®â€¦</p>
<p>å¯æƒœæˆ‘ä¸æ˜¯å½“å¹´é‚£ä¸ªæˆ‘äº†ï¼Œrqyä¹Ÿä¸æ˜¯å½“å¹´é‚£ä¸ªrqyäº†ï¼Œå¤§å®¶éƒ½åœ¨è¿ˆç€è‡ªå·±çš„æ­¥å­è¸å®åœ°å‰è¿›ï¼Œç»ˆäºè¿˜æ˜¯ä¼šåˆ†é“æ‰¬é•³å§â€¦â€¦</p>
<p>è¯¶è¯¶æˆ‘åœ¨å¹²ä»€ä¹ˆï¼Œqaqï¼Œå­¦ä¹ ï¼Œå­¦ä¹ â€¦â€¦</p>
<p>æš´åŠ›å°±æ˜¯æšä¸¾å…¨æ’åˆ—ï¼Œä½†æ˜¾ç„¶åªæœ‰30ptsã€‚ äºæ˜¯è€ƒè™‘ä¸€ä¸ªå¯è¡Œæ€§å‰ªæï¼Œå…¶å®å°±æ˜¯æ¯æ¬¡dfsåˆšå¼€å§‹å…ˆcheckä¸€éåˆä¸åˆæ³•ã€‚ä½†æ˜¯æ•´ç†è¿™ä¸ªé¢˜çš„ç›®çš„ä¹Ÿä¸åœ¨äºæ­¤ï¼Œè€Œåœ¨äºå…¶ä¸­çš„<code>pos</code>æ•°ç»„ï¼Œå…¶å®å°±æ˜¯ç”¨æ¥è®°å½•ä»ä½ä½åˆ°é«˜ä½æ¯ä¸ªæœªçŸ¥æ•°çš„å‡ºç°é¡ºåºçš„ã€‚é‚£ä¹ˆå®é™…ä¸Šè¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¼˜ç§€çš„å‰ªæï¼Œå› ä¸ºåœ¨dfsé‡Œé¢æˆ‘ä»¬å¯ä»¥æ ¹æ®æ­¤å¯¹é è¿‘ä½ä½çš„æœªçŸ¥æ•°å…ˆèµ‹å€¼ã€å…ˆåˆ¤æ–­ï¼ˆç¬¬ä¸€ä¸ªå‰ªæï¼‰ã€‚</p>
<p>æ‰€ä»¥å¤§æ¦‚å°±æ˜¯å¯è¡Œæ€§å‰ªæå’Œæœ€ä¼˜æ€§å‰ªæç›¸è¾…ç›¸æˆçš„ç»“æœï¼Œæ¯”è¾ƒå·§å¦™ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> _Char ; <span class="keyword">int</span> pos[MAX] ;</span><br><span class="line"><span class="keyword">int</span> Ans[MAX] ; <span class="keyword">bool</span> mark[MAX] ;</span><br><span class="line"><span class="keyword">int</span> N, A[MAX], B[MAX], C[MAX], tot ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Print</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N ; ++ i) <span class="built_in">cout</span> &lt;&lt; Ans[i] &lt;&lt; <span class="string">" "</span> ; <span class="built_in">exit</span>(<span class="number">0</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Judge</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> X = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span> ; -- i)&#123;</span><br><span class="line">        <span class="keyword">int</span> NA = Ans[A[i]], NB = Ans[B[i]], NC = Ans[C[i]] ;</span><br><span class="line">        <span class="keyword">if</span>((NA + NB + X) % N != NC) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        X = (NA + NB + X) / N ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Speed</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Ans[A[<span class="number">0</span>]] + Ans[B[<span class="number">0</span>]] &gt;= N) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span> ; i --)&#123;</span><br><span class="line">        <span class="keyword">int</span> NA = Ans[A[i]], NB = Ans[B[i]], NC = Ans[C[i]] ;</span><br><span class="line">        <span class="keyword">if</span> (NA == <span class="number">-1</span> || NB == <span class="number">-1</span> || NC == <span class="number">-1</span>) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">if</span> ((NA + NB) % N != NC &amp;&amp; (NA + NB + <span class="number">1</span>) % N != NC) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> sum)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!Speed()) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (sum == N + <span class="number">1</span>)&#123;<span class="keyword">if</span> (Judge()) Print() ; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span> ; -- i)</span><br><span class="line">        <span class="keyword">if</span>(!mark[i])&#123;</span><br><span class="line">            Ans[pos[sum]] = i, mark[i] = <span class="number">1</span> ;</span><br><span class="line">            dfs(sum + <span class="number">1</span>) ;</span><br><span class="line">            Ans[pos[sum]] = <span class="number">-1</span>, mark[i] = <span class="number">0</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">work_pos</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">if</span>(!mark[x])  mark[x] = <span class="number">1</span>,  pos[++ tot] = x ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">    fill(Ans, Ans + MAX + <span class="number">2</span>, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N ; ++ i)&#123; <span class="built_in">cin</span> &gt;&gt; _Char ; A[i] = _Char - <span class="string">'A'</span> ;&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N ; ++ i)&#123; <span class="built_in">cin</span> &gt;&gt; _Char ; B[i] = _Char - <span class="string">'A'</span> ;&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N ; ++ i)&#123; <span class="built_in">cin</span> &gt;&gt; _Char ; C[i] = _Char - <span class="string">'A'</span> ;&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span> ; -- i) </span><br><span class="line">      work_pos(A[i]), work_pos(B[i]), work_pos(C[i]) ;</span><br><span class="line">    fill(mark, mark + MAX + <span class="number">2</span>, <span class="number">0</span>) ; dfs(<span class="number">1</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-Afterword"><a href="#rm-Afterword" class="headerlink" title="$\rm{Afterword}$"></a>$\rm{Afterword}$</h1><blockquote>
<p>é¥æœ›æ‰¬å·æ»¡åœ°é›ªï¼Œä¸çŸ¥å·²æ˜¯æƒŠè›°èŠ‚ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>å¥‡æ€ªçš„æŠ€å·§</tag>
        <tag>åŠ¨æ€è§„åˆ’/èƒŒåŒ…æ¨¡å‹</tag>
        <tag>NOIPç³»åˆ—</tag>
        <tag>æ•°å­¦/ä¸ç­‰å¼</tag>
        <tag>æœç´¢/å‰ªæ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ³›åšã€‘Old-NOIP æ³›åšä¸‰</title>
    <url>/2019/07/11/old-NOIP-0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>$NOIP2016$ä»¥åŠä¹‹å‰å¹´ä»½$NOIP$ä¸­ä¼˜ç§€é¢˜ç›®çš„æ³›åšã€‚</p>
<p>ä»¥ä¸‹çš„é¢˜æ˜¯æˆ‘åšäº†ä¹‹åä¸ç¦æ„Ÿæ…¨â€œå•Šï¼ŒçœŸæ˜¯ä¸ªå¥½é¢˜â€çš„é¢˜ä»¬â€¦â€¦</p>
<a id="more"></a>
<p>ç„¶åé¦–å…ˆæ‰“å‡ºéš¾åº¦æ ‡ç­¾ï¼š<img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt></p>
<p><del>ç„¶åä»¥ä¸‹é¢˜ç›®æŒ‰ç…§å¾—è¾ƒé«˜çš„éƒ¨åˆ†åˆ†çš„éš¾åº¦æ’åº</del></p>
<h1 id="1-2013F-åå®¹é“"><a href="#1-2013F-åå®¹é“" class="headerlink" title="$  1  2013F$ åå®¹é“"></a>$  1  2013F$ åå®¹é“</h1><p><a href="https://www.luogu.org/problem/P1979" target="_blank" rel="noopener">$Link$</a></p>
<p>å¯èƒ½è¿™é“é¢˜å¾ˆéš¾â€¦ä½†æ˜¯å®ƒæœ‰70åˆ†çš„æš´åŠ›åˆ†ï¼70åˆ†ï¼åœ¨lojä½ ç”šè‡³å¯ä»¥è·å¾—80åˆ†ï¼tmè¿™æ ·çš„è¯æš´åŠ›å’Œæ­£è§£æœ‰ä»€ä¹ˆåŒºåˆ«å—â€¦ä»å¾—åˆ†çš„æ—¶é—´åˆ†å¸ƒä¸Šæ¥è®²ï¼Œæƒ³æ­£è§£å°±æ˜¯å¤§å†™çš„ä¸å€¼â€¦â€¦</p>
<p>é¦–å…ˆæˆ‘ä»¬æ€è€ƒä»€ä¹ˆä¿¡æ¯æ˜¯æœ‰ç”¨çš„ï¼Œå—¯ï¼Œç©ºç™½æ ¼å­çš„ä½å­å’Œå½“å‰æ£‹å­çš„ä½ç½®ï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬ç”¨BFSï¼ˆè€Œä¸æ˜¯DFSï¼ŒDFSçš„çŠ¶æ€å¼€é”€æå¤§ï¼Œä½†æ›´å¯èƒ½çš„æ˜¯æˆ‘DFSçš„æ‰“å¼€æ–¹å¼ä¸å¯¹å§/sighï¼‰çš„è¯ï¼ŒçŠ¶æ€æ•°å°±æ˜¯$O(n^2m^2)$çš„ï¼Œç„¶åæ€»å¤æ‚åº¦å°±æ˜¯$O(qn^2m^2)$ï¼Œå¤§æ¦‚æ˜¯å››äº¿é›¶500ä¸‡çš„è¿ç®—é‡ä¸Šé™â€¦ç„¶è€Œä¸€å¼€å§‹æˆ‘ç®—æˆäº†å››åƒäº”ç™¾ä¸‡è¿˜çº³é—·ä¸ºä»€ä¹ˆå¼€äº†<code>-O2</code>åœ¨1sä»¥å†…è¿˜è·‘ä¸å‡ºæ¥â€¦â€¦</p>
<p>å…ˆè´´ä¸ªæš´åŠ›å§ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis)) ;</span><br><span class="line">	ans = Inf, vis[ex][ey][sx][sy] = <span class="number">1</span> ;</span><br><span class="line">	q.push((state)&#123;ex, ey, sx, sy, <span class="number">0</span>, <span class="number">1</span>&#125;) ; </span><br><span class="line">	<span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">		state n = q.front() ; q.pop() ;</span><br><span class="line">		<span class="keyword">if</span> (n.sx == tx &amp;&amp; n.sy == ty) ans = min(ans, n.s) ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; <span class="number">4</span> ; ++ k)&#123;</span><br><span class="line">			<span class="keyword">int</span> kx = n.bx + dx[k], ky = n.by + dy[k], px, py ; </span><br><span class="line">			<span class="keyword">if</span> (kx == n.sx &amp;&amp; ky == n.sy) </span><br><span class="line">        px = n.bx, py = n.by ; <span class="keyword">else</span> px = n.sx, py = n.sy ;</span><br><span class="line">			<span class="keyword">if</span> (!base[kx][ky] || kx &gt; N || ky &gt; M || kx &lt; <span class="number">1</span> || ky &lt; <span class="number">1</span> || vis[kx][ky][px][py]) <span class="keyword">continue</span> ;</span><br><span class="line">			vis[kx][ky][px][py] = <span class="number">1</span> ;</span><br><span class="line">      q.push((state)&#123;kx, ky, px, py, n.s + <span class="number">1</span>, n.num + <span class="number">1</span>&#125;) ;</span><br><span class="line">		&#125; </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (ans &gt;= Inf) <span class="built_in">puts</span>(<span class="string">"-1"</span>) ; <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; Q ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j)</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i][j]) ;</span><br><span class="line">	<span class="keyword">while</span> (Q --) <span class="built_in">cin</span> &gt;&gt; ex &gt;&gt; ey &gt;&gt; sx &gt;&gt; sy &gt;&gt; tx &gt;&gt; ty, bfs() ;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å–œé—»ä¹è§â€¦ä¸è¿‡è‡ªå·±æ‰“æš´åŠ›çš„èƒ½åŠ›è¿˜æ˜¯ä¸è¡Œå•Šï¼Œè¿˜å¾—ç»ƒå•Šqaq</p>
<p>ä¹‹åå°±æ˜¯æ›´åŠ å–œé—»ä¹è§çš„çŠ¶æ€å‹ç¼©ã€‚æˆ‘ä»¬æ€è€ƒï¼Œè¿™$n^2m^2$ä¸ªçŠ¶æ€éƒ½ä»–å¨˜çš„æœ‰é¸Ÿç”¨å—ï¼ˆæäº‘é¾™ç–¾å‘¼æ€ï¼‰ï¼Œå¦‚æœç©ºç™½æ ¼å­ä¸åœ¨ç›®æ ‡æ ¼å­å‘¨å›´ï¼Œé‚£ä¹ˆæ— è®ºç©ºç™½æ ¼å­æ€ä¹ˆç§»åŠ¨éƒ½ä¸å¯èƒ½ç”¨çˆ±å‘ç”µã€‚æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘å§ç›´æ¥é¢„å¤„ç†å‡ºæ¥æ¯ä¸ª<strong>ç©ºç™½æ ¼å­ä¸ç›®æ ‡æ ¼å­ï¼ˆå³èµ·å§‹æ ¼å­ï¼‰ç›¸é‚»çš„çŠ¶æ€</strong>ä¹‹é—´çš„ä»£ä»·ï¼Œä¹‹åç›´æ¥å¯¹æ­¤è·‘ä¸ª$SPFA$å°±å¥½äº†ï¼Œæ¯•ç«Ÿæœ€åæƒ…å†µä¸‹SPFAçš„å¤æ‚åº¦ä¹Ÿåªæ˜¯$O(nM)$çš„ï¼Œå¤§æ¦‚å°±æ˜¯$O(n\cdot 4nm)&lt;\frac{O(n^2m^2)}{7.5}$ï¼Œä¹Ÿç®—æ˜¯å¾ˆç¨³çš„å¤æ‚åº¦äº†ã€‚</p>
<p>ç„¶åæˆ‘ä»¬æ€è€ƒè¿™æ ·çš„å¤æ‚åº¦æ˜¯å¤šå°‘ã€‚è€ƒè™‘ç›®æ ‡æ ¼å­æœ‰$nm$ç§æƒ…å†µï¼Œç©ºç™½æ ¼å­åœ¨æœ‰æ•ˆæƒ…å†µä¸‹åªèƒ½åœ¨å…¶å››å‘¨ï¼Œæ•…çŠ¶æ€æ•°æ˜¯$O(4nm)=nm$çš„ã€‚</p>
<p>ç„¶åå…³äºä»£ç å®ç°è¿™å—éœ€è¦æ¯”è¾ƒæ·±å…¥çš„ç†è§£ã€‚é¦–å…ˆæˆ‘ä»¬å…ˆé¢„å¤„ç†å‡ºæ¥å½“å½“å‰æ ¼å­åœ¨éšä¾¿ä¸€ä¸ªæ ¼å­ä¸Šï¼Œç©ºç™½æ ¼å­æƒ³è¦è½¬åˆ°å¦ä¸€ä¸ªæ–¹å‘çš„æ­¥æ•°ã€‚è¿™æ ·å°±å¯ä»¥æŠ½è±¡æˆä¸€å¼ ç©ºç™½å›¾ä¸Šå…ˆæœ‰çš„ä¸€ä¸ªä¸€ä¸ªæ ‘ï¼ˆä¹Ÿå°±æ˜¯ä¸€å¨æ£®æ—ï¼‰ã€‚ç„¶åä¸ºäº†è®©è¿™äº›æ£®æ—ä¹‹é—´èƒ½è¿ä¸Šè¾¹ï¼Œå†å°†â€œç©ºç™½æ ¼å­å’Œç›®æ ‡æ ¼å­æ¢äº†ä¸ªä½ç½®â€è¿™ç§è½¬ç§»è¿ä¸Šè¾¹ï¼ˆä¸è¿çš„è¯å°±ä¸å­˜åœ¨ä»ä¸€ä¸ªæ ¼å­åˆ°å¦ä¸€ä¸ªæ ¼å­çš„è½¬ç§»äº†ï¼‰ã€‚åŒæ—¶ä¸è¦å¿˜äº†å¯¹çŠ¶æ€çš„ç¼–å·ã€‚å³ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="keyword">int</span> _get(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> d)&#123; <span class="keyword">return</span> x * <span class="number">120</span> + y * <span class="number">4</span> + d ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> fx, <span class="keyword">int</span> fy, <span class="keyword">int</span> ox, <span class="keyword">int</span> oy, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> Id = _get(ox, oy, d) ; </span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0</span>, <span class="keyword">sizeof</span>(dis)), </span><br><span class="line">    dis[fx][fy] = <span class="number">1</span>, q.push((state)&#123;fx, fy&#125;) ; </span><br><span class="line"><span class="comment">//    cout &lt;&lt; fx &lt;&lt; " " &lt;&lt; fy &lt;&lt; endl ; </span></span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        state n = q.front() ; </span><br><span class="line">        <span class="keyword">int</span> nx = n.x, ny = n.y ; q.pop() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; <span class="number">4</span> ; ++ k)&#123;</span><br><span class="line">            <span class="keyword">int</span> kx = nx + dx[k], ky = ny + dy[k] ; </span><br><span class="line">            <span class="keyword">if</span> (kx &gt; N || ky &gt; M || kx &lt; <span class="number">1</span> || ky &lt; <span class="number">1</span>) <span class="keyword">continue</span> ; </span><br><span class="line">            <span class="keyword">if</span> (base[kx][ky] &amp;&amp; !dis[kx][ky] &amp;&amp; (kx != ox || ky != oy)) </span><br><span class="line">                dis[kx][ky] = dis[nx][ny] + <span class="number">1</span>, q.push((state)&#123;kx, ky&#125;) ; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (d &gt; <span class="number">3</span>) <span class="keyword">return</span> ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; <span class="number">4</span> ; ++ k)&#123;</span><br><span class="line">        <span class="keyword">int</span> kx = ox + dx[k], ky = oy + dy[k] ; </span><br><span class="line">        <span class="keyword">if</span> (kx &gt; N || ky &gt; M || kx &lt; <span class="number">1</span> || ky &lt; <span class="number">1</span>) <span class="keyword">continue</span> ; </span><br><span class="line">        <span class="keyword">if</span> (dis[kx][ky] &amp;&amp; (kx != fx || ky != fy) &amp;&amp; base[kx][ky])</span><br><span class="line">            Add(Id, _get(ox, oy, k), dis[kx][ky] - <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    Add(Id, _get(fx, fy, d) ^ <span class="number">1</span>, <span class="number">1</span>) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥åŠ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j)</span><br><span class="line">         <span class="built_in">cin</span> &gt;&gt; base[i][j] ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j)&#123;</span><br><span class="line">         <span class="keyword">if</span> (!base[i][j]) <span class="keyword">continue</span> ;</span><br><span class="line">         <span class="keyword">if</span> (base[i - <span class="number">1</span>][j]) bfs(i - <span class="number">1</span>, j, i, j, <span class="number">0</span>) ; </span><br><span class="line">         <span class="keyword">if</span> (base[i + <span class="number">1</span>][j]) bfs(i + <span class="number">1</span>, j, i, j, <span class="number">1</span>) ; </span><br><span class="line">         <span class="keyword">if</span> (base[i][j - <span class="number">1</span>]) bfs(i, j - <span class="number">1</span>, i, j, <span class="number">2</span>) ; </span><br><span class="line">         <span class="keyword">if</span> (base[i][j + <span class="number">1</span>]) bfs(i, j + <span class="number">1</span>, i, j, <span class="number">3</span>) ; </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬è€ƒè™‘åœ¨SPFAä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ±‚å‡ºç©ºç™½æ ¼å­ä»(ex,ey)åˆ°(sx, sy)å‘¨å›´éœ€è¦çš„æ­¥æ•°ä½œä¸ºèµ·å§‹ç‚¹ï¼Œç„¶åSPFAå°±å¥½äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Spfa</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; MAXS ; ++ k) f[k] = Inf, vis[k] = <span class="number">0</span> ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; <span class="number">4</span> ; ++ k)&#123;</span><br><span class="line">        <span class="keyword">int</span> Id = _get(sx, sy, k), kx = sx + dx[k], ky = sy + dy[k] ;</span><br><span class="line">        <span class="keyword">if</span> (dis[kx][ky]) f[Id] = dis[kx][ky] - <span class="number">1</span>, Q.push(Id), vis[Id] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!Q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> n = Q.front() ; Q.pop() ; vis[n] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[n] ; k ; k = E[k].next)&#123;</span><br><span class="line">            <span class="keyword">if</span> (f[to(k)] &gt; f[n] + E[k].val)&#123;</span><br><span class="line">                f[to(k)] = f[n] + E[k].val ; </span><br><span class="line">                <span class="keyword">if</span> (!vis[to(k)]) vis[to(k)] = <span class="number">1</span>, Q.push(to(k)) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-2012C-å¼€è½¦æ—…è¡Œ"><a href="#2-2012C-å¼€è½¦æ—…è¡Œ" class="headerlink" title="$2~2012C$ å¼€è½¦æ—…è¡Œ"></a>$2~2012C$ å¼€è½¦æ—…è¡Œ</h1><p> <a href="https://www.luogu.org/problem/P1081" target="_blank" rel="noopener">$Link$</a></p>
<p>ä¸å¾—ä¸è¯´2012çš„é¢˜ç›®è´¨é‡æ˜¯çœŸå¿ƒå¥½å•Šâ€¦â€¦</p>
<p>é¦–å…ˆè¿™é¢˜ä¸ºäº†çœ‹ä¸Šå»ä¸æ˜¯é‚£ä¹ˆæ¯’ç˜¤ï¼Œäºæ˜¯åŠ äº†ä¸€ä¸ª70åˆ†çš„æš´åŠ›åˆ†ã€‚ç„¶è€Œâ€¦ç»†èŠ‚è´¼å¤šâ€”â€”æˆ–è€…è¯´åªæ˜¯æˆ‘ä¸ç»†å¿ƒï¼Œæ¯”å¦‚è¯´æŠŠAå’ŒBæ€ä¹ˆèµ°çœ‹åäº†ã€ç®—æ¯”å€¼çš„æ—¶å€™ç”¨äº†ä¸ªå‡<code>double</code>ä¹‹ç±»çš„â€¦â€¦</p>
<p>äºæ˜¯70åˆ†å¥½åƒæœ‰ä¸ªå¤´å°±ä¼šå†™å§= = ä¸çŸ¥é“å½“å¹´ä»€ä¹ˆåŒºåˆ†åº¦= =</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Path</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v1, v2 ;</span><br><span class="line">    <span class="keyword">int</span> Id1, Id2 ;</span><br><span class="line">&#125;P[MAXN] ; <span class="keyword">int</span> i, j ; <span class="keyword">double</span> o, q ;</span><br><span class="line"><span class="keyword">int</span> res, ans, N, M, T, base[MAXN], s[MAXN], x[MAXN], p ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mabs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> x &lt; <span class="number">0</span> ? -x : x ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">GO</span><span class="params">(<span class="keyword">int</span> S, <span class="keyword">int</span> H)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u = <span class="number">0</span> ; res = ans = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (j = S ; j &lt;= N &amp;&amp; j ; u ^= <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (u) <span class="keyword">if</span> (res + ans + P[j].v1 &gt; H) <span class="keyword">return</span> ; </span><br><span class="line">      				 <span class="keyword">else</span> res += P[j].v1, j = P[j].Id1 ;</span><br><span class="line">        <span class="keyword">else</span> <span class="comment">/*pkspks*/</span> <span class="keyword">if</span> (res + ans + P[j].v2 &gt; H) <span class="keyword">return</span> ; </span><br><span class="line">      									<span class="keyword">else</span> ans += P[j].v2, j = P[j].Id2 ;</span><br><span class="line">        <span class="comment">//        cout &lt;&lt; j &lt;&lt; endl ;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ; q = Inf  ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i]) ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T &gt;&gt; M ;  <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;s[i], &amp;x[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> tp = Inf, w = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (j = i + <span class="number">1</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">int</span> qwq = <span class="built_in">abs</span>(base[i] - base[j]) ;</span><br><span class="line">            <span class="keyword">if</span> (qwq &lt; tp || (qwq == tp &amp;&amp; base[w] &gt; base[j])) </span><br><span class="line">              	tp = qwq, w = j ;</span><br><span class="line">        &#125;</span><br><span class="line">        P[i].Id1 = w, P[i].v1 = tp ; tp = Inf, w = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (j = i + <span class="number">1</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">int</span> qwq = <span class="built_in">abs</span>(base[i] - base[j]) ;</span><br><span class="line">            <span class="keyword">if</span> (qwq &lt; tp &amp;&amp; (qwq &gt; P[i].v1 || (qwq == P[i].v1 &amp;&amp; base[P[i].Id1] &lt; base[j])))</span><br><span class="line">                tp = qwq, w = j ;</span><br><span class="line">        &#125;</span><br><span class="line">        P[i].Id2 = w, P[i].v2 = tp ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//    GO(2, T), cout &lt;&lt; ans &lt;&lt; " " &lt;&lt; res &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">//    GO(4, T), cout &lt;&lt; ans &lt;&lt; " " &lt;&lt; res &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">//    for (i = 1 ; i &lt;= N ; ++ i) cout &lt;&lt; i &lt;&lt; " " &lt;&lt; P[i].v1 &lt;&lt; " " &lt;&lt; P[i].Id1 &lt;&lt; " " &lt;&lt; P[i].v2 &lt;&lt; " " &lt;&lt; P[i].Id2 &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123; </span><br><span class="line">      GO(i, T) ; o = <span class="number">1.0</span> * res ? (<span class="number">1.0</span> * ans) / (<span class="number">1.0</span> * res) : Inf ; </span><br><span class="line">      <span class="keyword">if</span> (o &lt; q ||(o == q &amp;&amp; base[p] &lt; base[i])) q = o, p = i ; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; p &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">  	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) </span><br><span class="line">      GO(s[i], x[i]), <span class="built_in">printf</span>(<span class="string">"%lld %lld\n"</span>, ans, res) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ„Ÿè§‰ä»æš´åŠ›åˆ°æ­£è§£å®Œå…¨ä¸æ˜¯ä¸€ä¸ªéš¾åº¦çš„ã€‚é¦–å…ˆè€ƒè™‘åˆ°åº•æ˜¯ä»€ä¹ˆåœ°æ–¹é˜»ç¢äº†ç¤¾ä¼šçš„å‘å±•â€”â€”åˆå§‹åŒ–ä¼¼ä¹æ˜¯$n^2$çš„ï¼Œèµ°ä¼¼ä¹æ˜¯$&lt;n^2$çš„ï¼Œé‚£ä¹ˆä»åˆå§‹åŒ–å…¥æ‰‹ï¼š</p>
<h2 id="rm-Part-1-åˆå§‹åŒ–çš„ä¼˜åŒ–"><a href="#rm-Part-1-åˆå§‹åŒ–çš„ä¼˜åŒ–" class="headerlink" title="$\rm{Part~1}$ åˆå§‹åŒ–çš„ä¼˜åŒ–"></a>$\rm{Part~1}$ åˆå§‹åŒ–çš„ä¼˜åŒ–</h2><p>æˆ‘ä»¬æ€è€ƒå¦‚æœå½“å‰è½®åˆ°ç¬¬$i$é«˜çš„åŸå¸‚äº†ï¼Œå¹¶ä¸”æ­¤æ—¶æ‰€æœ‰ç°å­˜åŸå¸‚ä¸­ä¸å­˜åœ¨ç¼–å·åœ¨$i$ä¹‹å‰çš„åŸå¸‚ï¼Œå³$i$æ˜¯æœ€å·¦è¾¹çš„åŸå¸‚ï¼Œé‚£ä¹ˆå¯¹å…¶æœ‰ç”¨çš„ä¿¡æ¯åªä¼šåœ¨ç¬¬$i-1,i-2,i+1$æˆ–è€…ç¬¬$i+2$çš„åŸå¸‚ä¸­é€‰å–ã€‚è¿™å°±æç¤ºæˆ‘ä»¬ä¼¼ä¹å¦‚æœä»å€¼åŸŸä¸Šè€ƒè™‘å°±æ˜¯$O(4n)$çš„äº†â€”â€”åªè¦æˆ‘ä»¬ä¿è¯ä¸å­˜åœ¨åœ¨$i$å·¦è¾¹çš„åŸå¸‚ã€å³å¯¹åº”åŸå¸‚ä¸å¯èµ°çš„æƒ…å†µã€‚</p>
<p>ç„¶åè¿™ä¸ªæ—¶å€™æœ‰ä¸ªå¾ˆç¥ä»™çš„æƒ³æ³•å°±æ˜¯<strong>åŒå‘é“¾è¡¨ä¼˜åŒ–</strong>ï¼Œæˆ‘ä»¬è€ƒè™‘æŒ‰é«˜åº¦æ’å®Œåºä¹‹åï¼Œå¯¹ç›¸é‚»å…ƒç´ å»ºç«‹åŒå‘é“¾è¡¨ã€‚ç„¶å<strong>æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºæšä¸¾åŸå¸‚ã€getä¿¡æ¯ç„¶ååˆ é™¤æ‰è¿™ä¸ªåŸå¸‚</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(BASE A, BASE B)</span></span>&#123; <span class="keyword">return</span> A.h &lt; B.h ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp2</span><span class="params">(BASE A, BASE B)</span></span>&#123; <span class="keyword">return</span> A.id &lt; B.id ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">inlaw</span><span class="params">(<span class="keyword">int</span> pos)</span></span>&#123; <span class="keyword">return</span> (pos &gt; N || !pos) ? Inf : <span class="number">0</span> ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ; q = Inf  ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) pre[i] = i - <span class="number">1</span>, nxt[i] = i + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i].h), base[i].id = i ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T &gt;&gt; M ; <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;s[i], &amp;x[i]) ;</span><br><span class="line">    sort(base + <span class="number">1</span>, base + N + <span class="number">1</span>, cmp) ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) Tid[base[i].id] = i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> t = Tid[i] ;</span><br><span class="line">        d[<span class="number">1</span>].h = inlaw(pre[t]) + <span class="built_in">abs</span>(base[pre[t]].h - base[t].h),</span><br><span class="line">        d[<span class="number">2</span>].h = inlaw(pre[pre[t]]) + <span class="built_in">abs</span>(base[pre[pre[t]]].h - base[t].h) ;</span><br><span class="line">        d[<span class="number">3</span>].h = inlaw(nxt[t]) + <span class="built_in">abs</span>(base[nxt[t]].h - base[t].h), </span><br><span class="line">        d[<span class="number">4</span>].h = inlaw(nxt[nxt[t]]) + <span class="built_in">abs</span>(base[nxt[nxt[t]]].h - base[t].h) ;</span><br><span class="line">        d[<span class="number">1</span>].id = base[pre[t]].id, d[<span class="number">2</span>].id = base[pre[pre[t]]].id, </span><br><span class="line">        d[<span class="number">3</span>].id = base[nxt[t]].id, d[<span class="number">4</span>].id = base[nxt[nxt[t]]].id, </span><br><span class="line">        sort(d + <span class="number">1</span>, d + <span class="number">5</span>, cmp) ;</span><br><span class="line">        P[i].Id1 = d[<span class="number">1</span>].id, P[i].v1 = d[<span class="number">1</span>].h, </span><br><span class="line">        P[i].Id2 = d[<span class="number">2</span>].id, P[i].v2 = d[<span class="number">2</span>].h ; </span><br><span class="line">        pre[nxt[t]] = pre[t], nxt[pre[t]] = nxt[t] ;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶ååˆå§‹åŒ–çš„å·¥ä½œå°±ä¼˜åŒ–å®Œäº†ã€‚è‡³æ­¤å¯ä»¥åœ¨<code>Luogu</code>è·å¾—75ptsçš„å¥½æˆç»©ã€‚</p>
<h2 id="rm-Part-2-èµ°çš„ä¼˜åŒ–"><a href="#rm-Part-2-èµ°çš„ä¼˜åŒ–" class="headerlink" title="$\rm{Part~2}$ èµ°çš„ä¼˜åŒ–"></a>$\rm{Part~2}$ èµ°çš„ä¼˜åŒ–</h2><p>â€¦ç„¶è€Œåªæœ‰ç¬¬ä¸€ä¸ªä¼˜åŒ–æƒ…å†µå¹¶ä¸ä¼šå¥½è½¬å¤šå°‘ã€‚æŸ¥çœ‹æ•°æ®ä¹‹åå‘ç°åŸæ¥æœ€åå‡ ä¸ªç‚¹çš„$s$å’Œ$x$éƒ½å®Œå…¨æ˜¯éšçš„é‚£ç§â€¦â€¦æ‰€ä»¥å°±å¤æ‚åº¦çˆ†ç‚¸ã€‚ç„¶åæˆ‘ä»¬è€ƒè™‘è¿™ä¹ˆä¸€ä¸ªå–œé—»ä¹è§çš„äº‹æƒ…â€”â€”é™åˆ¶ä¼¼ä¹åªæœ‰â€œå°äºxâ€å’Œâ€œå¯ä»¥ç»§ç»­èµ°â€è¯¶ï¼Œäºæ˜¯ä¼¼ä¹ç›¸é‚»çš„å‡ æ­¥å¦‚æœéƒ½ä¸è¶…è¿‡é™åˆ¶æ˜¯ä¸æ˜¯å°±å¯ä»¥ä¸€èµ·èµ°ï¼Ÿäºæ˜¯æƒ³åˆ°<strong>å€å¢é¢„å¤„ç†</strong>ã€‚</p>
<p>æˆ‘ä»¬ç”¨$A_{i,j}$è¡¨ç¤ºä»iå·ç‚¹å¼€å§‹ï¼Œèµ°$2^j$<strong>è½®</strong>ä¹‹å$A$èµ°è¿‡çš„è·¯ç¨‹ï¼›åŒç†$B_{i,j}$è¡¨ç¤ºä»iå·ç‚¹å¼€å§‹ï¼Œèµ°$2^j$<strong>è½®</strong>ä¹‹å$B$èµ°è¿‡çš„è·¯ç¨‹ã€‚å¹¶ä¸”é€‰æ‹©ç”¨$f_{i,j}$è¡¨ç¤ºä»iå¼€å§‹èµ°$2^j$è½®ä¹‹ååˆ°è¾¾çš„ç‚¹ã€‚ç„¶åå€¼å¾—æ³¨æ„çš„æ˜¯æœ€åå¯èƒ½èµ°çš„ä¸æ»¡ä¸€æ•´è½®ï¼Œäºæ˜¯ç‰¹åˆ¤ä¸€ä¸‹Aèƒ½ä¸èƒ½å†èµ°ä¸€æ¬¡å°±å¥½ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">sort(base + <span class="number">1</span>, base + N + <span class="number">1</span>, cmp2) ;<span class="comment">//é‡æ’å›æ¥= =</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">    	f[i][<span class="number">0</span>] = P[P[i].Id2].Id1 ;	</span><br><span class="line">    	<span class="keyword">if</span> (P[i].Id2) </span><br><span class="line">        A[i][<span class="number">0</span>] = <span class="built_in">abs</span>(base[P[i].Id2].h - base[i].h) ; </span><br><span class="line">		  <span class="keyword">if</span> (P[P[i].Id2].Id1)</span><br><span class="line">        B[i][<span class="number">0</span>] = <span class="built_in">abs</span>(base[P[i].Id2].h - base[P[P[i].Id2].Id1].h) ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= <span class="number">20</span> ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">			f[j][i] = f[f[j][i - <span class="number">1</span>]][i - <span class="number">1</span>], </span><br><span class="line">			A[j][i] = A[f[j][i - <span class="number">1</span>]][i - <span class="number">1</span>] + A[j][i - <span class="number">1</span>], </span><br><span class="line">			B[j][i] = B[f[j][i - <span class="number">1</span>]][i - <span class="number">1</span>] + B[j][i - <span class="number">1</span>] ;</span><br><span class="line">...</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">GO</span><span class="params">(<span class="keyword">int</span> S, ll H)</span></span>&#123;</span><br><span class="line">	ans = res = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">20</span> ; j &gt;= <span class="number">0</span> ; -- j) </span><br><span class="line">		<span class="keyword">if</span> (f[S][j] &amp;&amp; A[S][j] + B[S][j] &lt;= H) </span><br><span class="line">			ans += A[S][j], res += B[S][j], H -= (A[S][j] + B[S][j]), S = f[S][j] ;</span><br><span class="line">	<span class="keyword">if</span> (A[S][<span class="number">0</span>] &lt;= H) ans += A[S][<span class="number">0</span>] ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-2016B-å¤©å¤©çˆ±è·‘æ­¥"><a href="#3-2016B-å¤©å¤©çˆ±è·‘æ­¥" class="headerlink" title="$3~2016B$ å¤©å¤©çˆ±è·‘æ­¥"></a>$3~2016B$ å¤©å¤©çˆ±è·‘æ­¥</h1><p><a href="https://www.luogu.org/problem/P1600" target="_blank" rel="noopener">$Link$</a></p>
<p>â€¦â€¦å½“å¹´çš„æ¯’ç˜¤é¢˜ï¼Œè¿˜è®°å¾—é‚£è¿˜æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‚åŠ NOIPï¼ˆæ™®åŠç»„ï¼‰ï¼Œä¸å‡ºæ‰€æ–™åœ°è€ƒæŒ‚ï¼Œç„¶årqyä¸å‡ºæ‰€æ–™åœ°è€ƒå¥½â€¦â€¦</p>
<p>å’³ï¼Œåé¢˜äº†ï¼Œç„¶åå¯¹äºè¿™é“é¢˜ï¼Œæˆ‘ç´¢æ€§æŠŠæ¯ä¸ªéƒ¨åˆ†åˆ†éƒ½å†™äº†ä¸€éï¼š</p>
<h2 id="rm-Part-1-25pts"><a href="#rm-Part-1-25pts" class="headerlink" title="$\rm{Part~1}$ 25pts"></a>$\rm{Part~1}$ 25pts</h2><p>$n,m\leq 1000$</p>
<p>å…¶å®å°±æ˜¯LCAä¸€ä¸‹ç„¶å$nm$çš„ç»Ÿè®¡ç­”æ¡ˆå°±å®Œäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">	fa[now][<span class="number">0</span>] = f, dep[now] = dep[f] + <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)</span><br><span class="line">		<span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ; <span class="keyword">else</span> build(to(k), now) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Setup</span><span class="params">()</span></span>&#123;</span><br><span class="line">	h = <span class="built_in">log</span>(N) / <span class="built_in">log</span>(<span class="number">2</span>) + <span class="number">1</span> ; </span><br><span class="line">	<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= h ; ++ j)</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">			fa[i][j] = fa[fa[i][j - <span class="number">1</span>]][j - <span class="number">1</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (dep[u] &lt; dep[v]) u ^= v ^= u ^= v ; l = dep[u] - dep[v] ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = h ; k &gt;= <span class="number">0</span> ; -- k) <span class="keyword">if</span> (dep[fa[u][k]] &gt;= dep[v]) u = fa[u][k] ;</span><br><span class="line">	<span class="keyword">if</span> (u == v) <span class="keyword">return</span> u ; <span class="keyword">for</span> (<span class="keyword">int</span> k = h ; k &gt;= <span class="number">0</span> ; -- k) <span class="keyword">if</span> (fa[u][k] != fa[v][k]) u = fa[u][k], v = fa[v][k] ; <span class="keyword">return</span> fa[u][<span class="number">0</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y), Add(x, y) ;</span><br><span class="line">	build(<span class="number">1</span>, <span class="number">0</span>), Setup() ; <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;	</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) </span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;s[i], &amp;e[i]), </span><br><span class="line">  	lca1[i] = t = lca(s[i], e[i]), </span><br><span class="line">  	_up[i] = -(dep[t] &lt;&lt; <span class="number">1</span>) + (dep[s[i]] + dep[e[i]]) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i, <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans), ans = <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j) t = lca(e[j], i), p = lca(s[j], i), </span><br><span class="line">  			w1 = -(dep[p] &lt;&lt; <span class="number">1</span>) + (dep[i] + dep[s[j]]), </span><br><span class="line">  			w2 = dep[i]  +  dep[e[j]] -  (dep[t] &lt;&lt; <span class="number">1</span>), </span><br><span class="line">  		  ans += (w1 == base[i]) * (_up[j] == w1 + w2) ;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="rm-Part-2-15pts"><a href="#rm-Part-2-15pts" class="headerlink" title="$\rm{Part~2}$ 15pts"></a>$\rm{Part~2}$ 15pts</h2><p>è¿™éƒ¨åˆ†æ˜¯é“¾ï¼Œä¿è¯$i$åˆ°$i+1$æœ‰ä¸€æ¡è¾¹ã€‚</p>
<p>é‚£ä¹ˆå…¶å®è¿™ä¸ªé—®é¢˜å°±è½¬åŒ–æˆäº†åœ¨ä¸€ä¸ªåºåˆ—ä¸Šï¼Œä¸ç‚¹$i$ç›¸éš”æ°å¥½ä¸º$t[i]$çš„ç‚¹çš„ä¸ªæ•°ï¼Œé¡ºä¾¿æ³¨æ„åˆ¤æ–­ä¸€ä¸‹èµ°æ²¡èµ°å®Œå°±å¥½ã€‚ä½†æ˜¯è¿™ä¸ªåœ°æ–¹æˆ‘ç”¨äº†ä¸€ä¸ªè‚¥è‚ zzçš„å†™æ³•ï¼Œå°±æ˜¯æ¯æ¬¡åŠ å®Œä¹‹ååˆ é™¤åˆ°è¿™ä¸ªç‚¹åœæ­¢çš„é‚£äº›ç‚¹ï¼Œè€Œâ€œé‚£äº›ç‚¹â€çš„æ±‚æ³•åˆ™æ˜¯æˆ‘æ‰‹å†™äº†ä¸€ä¸ªå¾ˆè¯¡å¼‚çš„äºŒåˆ†â€¦â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Tink&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Nodes</span>&#123;</span></span><br><span class="line">		<span class="keyword">int</span> s, e, n ;</span><br><span class="line">	&#125;u[MAXN], v[MAXN] ; <span class="keyword">int</span> t1, t2 ;</span><br><span class="line">	<span class="keyword">int</span> be[MAXN], bs[MAXN], res[MAXN], k1 = <span class="number">0</span>, k2 = <span class="number">0</span> ;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">cmp1</span><span class="params">(Nodes a, Nodes b)</span> </span>&#123; <span class="keyword">return</span> a.e &lt; b.e ; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">cmp2</span><span class="params">(Nodes a, Nodes b)</span> </span>&#123; <span class="keyword">return</span> a.e &gt; b.e ; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">bool</span> m)</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> l = <span class="number">1</span>, r = (m ? k2 : k1) + <span class="number">1</span> , mid, l0, l1 ; </span><br><span class="line">		<span class="keyword">if</span> (!m)&#123;</span><br><span class="line">			<span class="keyword">while</span> (l &lt; r)&#123;</span><br><span class="line">				mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">				<span class="keyword">if</span> (u[mid].e &lt; p) l = mid + <span class="number">1</span> ; <span class="keyword">else</span> r = mid ;</span><br><span class="line">			&#125; l0 = l, l = <span class="number">1</span>, r = k1 + <span class="number">1</span> ;</span><br><span class="line">			<span class="keyword">while</span> (l &lt; r)&#123;</span><br><span class="line">				mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">				<span class="keyword">if</span> (u[mid].e &lt; p + <span class="number">1</span>) l = mid + <span class="number">1</span> ; <span class="keyword">else</span> r = mid ;</span><br><span class="line">			&#125; l1 = l ; </span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = l0 ; i &lt; l1 ; ++ i) bs[u[i].s] -- ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">while</span> (l &lt; r)&#123;</span><br><span class="line">				mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">				<span class="keyword">if</span> (v[mid].e &lt; p) l = mid + <span class="number">1</span> ; <span class="keyword">else</span> r = mid ;</span><br><span class="line">			&#125; l0 = l, l = <span class="number">0</span>, r = k2 + <span class="number">1</span> ;</span><br><span class="line">			<span class="keyword">while</span> (l &lt; r)&#123;</span><br><span class="line">				mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">				<span class="keyword">if</span> (v[mid].e &lt; p + <span class="number">1</span>) l = mid + <span class="number">1</span> ; <span class="keyword">else</span> r = mid ;</span><br><span class="line">			&#125; l1 = l ;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = l0 ; i &lt; l1 ; ++ i) be[v[i].s] -- ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Solve2</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i) &#123;</span><br><span class="line">			t1 = qr(), t2 = qr() ; </span><br><span class="line">			<span class="keyword">if</span> (t1 &lt; t2) bs[t1] ++, u[++ k1] = (Nodes)&#123;t1, t2, k1&#125; ;</span><br><span class="line">			<span class="keyword">else</span> <span class="comment">/**/</span>be[t1] ++, v[++ k2] = (Nodes)&#123;t1, t2, k2&#125; ;</span><br><span class="line">		&#125;</span><br><span class="line">		sort(u + <span class="number">1</span>, u + k1 + <span class="number">1</span>, cmp1) ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) res[i] += bs[i - base[i]], del(i, <span class="number">0</span>) ;	</span><br><span class="line">		sort(v + <span class="number">1</span>, v + k2 + <span class="number">1</span>, cmp1) ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = N ; i &gt;= <span class="number">1</span> ; -- i) res[i] += be[i + base[i]], del(i, <span class="number">1</span>) ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">1</span> ; p &lt;= N ; ++ p) <span class="built_in">cout</span> &lt;&lt; res[p] &lt;&lt; <span class="string">" "</span> ; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="rm-Part-3-20pts"><a href="#rm-Part-3-20pts" class="headerlink" title="$\rm{Part~3}$ 20pts"></a>$\rm{Part~3}$ 20pts</h2><p>ä¿è¯æ‰€æœ‰èµ·ç‚¹éƒ½åœ¨æ ¹ï¼ˆ1å·ç‚¹ï¼‰ã€‚</p>
<p>å…¶å®è¿™ä¸ªéƒ¨åˆ†ä¹Ÿæ˜¯æŒºæ°´çš„ã€‚å°±æ˜¯è€ƒè™‘ä¸€ä¸ªæ ‘å½¢DPå³å¯ã€‚ç„¶ååˆ¤æ–­ä¹Ÿå¾ˆå¥½åˆ¤æ–­ï¼Œå¦‚æœè¿™ä¸ªç‚¹çš„å¼€çœ¼æ—¶é—´æ­£å¥½æ˜¯æ ¹åˆ°å®ƒçš„è·ç¦»ï¼ˆæ·±åº¦å·®ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šä¸€å®šä¼šæ»¡è¶³åˆ°å®ƒçš„ç‚¹å’Œåˆ°å®ƒçš„å­æ ‘å†…çš„æ‰€æœ‰çš„ç‚¹ã€‚å¦åˆ™å°±è‚¯å®šä¸è¡Œï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªéƒ½ä¸æ»¡è¶³ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> DP&#123;</span><br><span class="line">    <span class="keyword">int</span> dp[MAXN], dis[MAXN] ;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)&#123;</span><br><span class="line">            <span class="keyword">if</span> (to(k) == fa) <span class="keyword">continue</span> ;</span><br><span class="line">            dis[to(k)] = dis[now] + <span class="number">1</span>, sum += dfs(to(k), now) ; </span><br><span class="line"> 		&#125;</span><br><span class="line"> 		dp[now] += sum ; <span class="keyword">return</span> dp[now] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Solve3</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(dis, <span class="number">63</span>, <span class="keyword">sizeof</span>(dis)), dis[<span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i) dp[e[i]] ++ ; dp[<span class="number">1</span>] = dfs(<span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">          	<span class="keyword">if</span> (base[i] == dis[i]) <span class="built_in">printf</span>(<span class="string">"%d "</span>, dp[i]) ; <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="string">" "</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯ç°åœ¨å°±æœ‰äº†60ptsçš„ä¼˜ç§€åˆ†æ•°ã€‚ä¼¼ä¹è¿™æ ·çš„è¯å°±å¯ä»¥ç›´æ¥æŠŠå‰©ä¸‹çš„éƒ¨åˆ†å¼ƒäº†å»å†™T3çš„æœŸæœ›DPè¾½233</p>
<h2 id="rm-Part-4-and-5-40pts"><a href="#rm-Part-4-and-5-40pts" class="headerlink" title="$\rm{Part~4~and~5}$  40pts"></a>$\rm{Part~4~and~5}$  40pts</h2><p>å‰©ä¸‹çš„éƒ¨åˆ†æ²¡æœ‰é€‰æ‹©åˆ†å¼€å†™<del>æ‰€ä»¥å°±ä¸ç®—è°¢äº†æ¯ä¸ªéƒ¨åˆ†åˆ†æ˜¯ä¸æ˜¯</del>ï¼Œå› ä¸ºå‰©ä¸‹çš„ä¸¤ä¸ªéƒ¨åˆ†å®åœ¨æ˜¯å¤ªåƒäº†ï¼Œéƒ½è¦ç”¨åˆ°ä¸€ç§æ€æƒ³â€”â€”<strong>æ¡¶</strong>. <del>å…¶å®80ptsè¿˜æœ‰ä¸€ç§ä¸æ˜¯å¾ˆæƒ³å†™çš„å†™æ³•åœ¨è¿™é‡Œå°±ç•™ä¸ªå›¾å§ï¼š</del></p>
<p><img src="1.png" alt></p>
<p>ç„¶åæˆ‘ä»¬æ€è€ƒæ¡¶çš„è§£æ³•ã€‚æˆ‘ä»¬æŠŠæ¯ä¸€æ®µè·¯ç¨‹æ‹†æˆå‘ä¸Šå’Œå‘ä¸‹ä¸¤æ®µã€‚ä¸‹æ–‡ä¸­è®¾$x$ä¸ºå½“å‰èŠ‚ç‚¹ã€‚</p>
<ul>
<li><p>å¯¹äºå‘ä¸Šçš„è·¯å¾„</p>
<ul>
<li>é¦–å…ˆå¯ä»¥äº§ç”Ÿè´¡çŒ®çš„ç‚¹å°±æ˜¯å­æ ‘å†…çš„$buc[dep[x]+ base[x]]$ï¼Œè¿™ä¸ªæˆ‘ä»¬ç”¨ä½œå·®æ¥æ±‚è§£ï¼ˆåŸå› æ˜¯æˆ‘ä»¬å¯èƒ½ä¼šéå†è®¸å¤šæ£µå­æ ‘æ‰€ä»¥ä¼šäº§ç”Ÿæ•°å€¼ç›¸åŒä½†ä¸åˆæ³•çš„è´¡çŒ®ï¼‰ã€‚</li>
<li>å…¶æ¬¡æˆ‘ä»¬éœ€è¦çŸ¥é“ï¼Œå¦‚æœä¸€ä¸ªäººçš„èµ·ç‚¹å’Œç»ˆç‚¹çš„LCAåœ¨å­æ ‘å†…ä½†ä¸æ˜¯$x$ï¼Œé‚£ä¹ˆä¹Ÿä¸ä¼šäº§ç”Ÿè´¡çŒ®ã€‚è§£å†³æ–¹æ¡ˆæ˜¯æ¯æ¬¡dfså®Œä¸€ä¸ªç‚¹å‘ä¸Šå›æº¯çš„æ—¶å€™åˆ é™¤æ‰å­æ ‘å†…æ‰€æœ‰ä»¥è¯¥ç‚¹ä¸ºLCAçš„ç‚¹ã€‚</li>
<li>åŒæ—¶ä¹Ÿéœ€è¦æˆ‘ä»¬æ›´æ–°ä»¥è¯¥èŠ‚ç‚¹ä¸ºèµ·ç‚¹çš„è·¯å¾„çš„æ¡¶ã€‚</li>
</ul>
</li>
<li><p>å¯¹äºå‘ä¸‹çš„è·¯å¾„</p>
<ul>
<li>é¦–å…ˆå¯¹äºä¸€æ¡è·¯å¾„$(u,v)$ï¼Œå½“å¯¹ç‚¹iäº§ç”Ÿè´¡çŒ®æ—¶å¯ä»¥æ¨å‡ºæ¥å¼å­ï¼š</li>
</ul>
<script type="math/tex; mode=display">
dep_v-dis_{u,v}=dep_i-base_i</script><pre><code> é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡æŠŠæ¯æ¡è·¯å¾„çš„$dep_v-dis_{u,v}$å‹åˆ°æ¡¶é‡Œé¢ï¼Œç„¶åæ¯æ¬¡è®¡ç®—è´¡çŒ®ã€‚
</code></pre><ul>
<li>åŒæ—¶æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æ¶ˆé™¤è´¡çŒ®ï¼Œå³æ¶ˆé™¤é‚£äº›å¯¹äºå„¿å­è€Œè¨€åœ¨çˆ¶äº²é‚£é‡Œåœæ­¢çš„è·¯å¾„ï¼Œæ–¹æ³•å°±æ˜¯åœ¨å‘ä¸‹è¿­ä»£ä¹‹å‰å…ˆæŠŠæ‰€æœ‰ä»¥å½“å‰ç‚¹ä¸ºç»ˆç‚¹çš„è´¡çŒ®åŠ ä¸Šï¼Œåˆ°å„¿å­æ—¶é€šè¿‡ä½œå·®å°±å¯ä»¥å‡å»è¿™éƒ¨åˆ†ã€‚æ³¨æ„å‘ä¸Šå›æº¯æ—¶è¿˜æ˜¯éœ€è¦åˆ é™¤é‚£äº›èœ·ç¼©åœ¨å­æ ‘å†…çš„è·¯å¾„ã€‚</li>
</ul>
</li>
</ul>
<p>ä¹‹åè¿˜æœ‰éœ€è¦æ³¨æ„çš„ï¼Œå°±æ˜¯å¦‚æœåœ¨ä¸€æ¡è·¯å¾„çš„LCAå¤„æ­£å¥½å¯ä»¥è§‚å¯Ÿåˆ°è¿™æ¡è·¯å¾„ï¼Œé‚£ä¹ˆå°±éœ€è¦<code>-1</code>ï¼Œå› ä¸ºæˆ‘ä»¬ä¸Šå‡ä¸‹é™ç»Ÿè®¡äº†ä¸¤éã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Prepare&#123; <span class="comment">//25</span></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;a, <span class="keyword">const</span> <span class="keyword">int</span> &amp;b)</span> </span>&#123; <span class="keyword">return</span> a &gt; b ? a : b ; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">	    E[++ cnt].to = v, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">	    E[++ cnt].to = u, E[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">	&#125;	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">	    fa[now][<span class="number">0</span>] = f, dep[now] = dep[f] + <span class="number">1</span>, H = max(H, dep[now]) ;</span><br><span class="line">	    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)</span><br><span class="line">	        <span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ; <span class="keyword">else</span> build(to(k), now) ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Setup</span><span class="params">()</span></span>&#123;</span><br><span class="line">	    h = <span class="built_in">log</span>(N) / <span class="built_in">log</span>(<span class="number">2</span>) + <span class="number">1</span> ; </span><br><span class="line">	    <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= h ; ++ j)</span><br><span class="line">        	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">    	        fa[i][j] = fa[fa[i][j - <span class="number">1</span>]][j - <span class="number">1</span>] ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    	<span class="keyword">if</span> (dep[u] &lt; dep[v]) u ^= v ^= u ^= v ; l = dep[u] - dep[v] ; </span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> k = h ; k &gt;= <span class="number">0</span> ; -- k) <span class="keyword">if</span> (dep[fa[u][k]] &gt;= dep[v]) u = fa[u][k] ;</span><br><span class="line">	   	<span class="keyword">if</span> (u == v) <span class="keyword">return</span> u ; <span class="keyword">for</span> (<span class="keyword">int</span> k = h ; k &gt;= <span class="number">0</span> ; -- k) <span class="keyword">if</span> (fa[u][k] != fa[v][k]) u = fa[u][k], v = fa[v][k] ; <span class="keyword">return</span> fa[u][<span class="number">0</span>] ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">	    <span class="keyword">register</span> <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ; <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">	    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ; <span class="keyword">return</span> k ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">wo</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span>&#123; <span class="keyword">return</span> -(dep[c] &lt;&lt; <span class="number">1</span>) + (dep[a] + dep[b]) ; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> pks&#123;</span><br><span class="line">	<span class="keyword">using</span> <span class="keyword">namespace</span> Prepare ;</span><br><span class="line">	<span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; v1[MAXN], v2[MAXN], v3[MAXN] ;</span><br><span class="line">	<span class="keyword">int</span> buc_d[MAXN &lt;&lt; <span class="number">2</span>], buc_u[MAXN &lt;&lt; <span class="number">2</span>], ans[MAXN] ;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> co = base[now] + dep[now], ks ; <span class="keyword">if</span> (co &lt;= H) ks = buc_d[co] ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next) <span class="keyword">if</span> (fa ^ to(k)) dfs1(to(k), now) ;</span><br><span class="line">		buc_d[dep[now]] += cnbt[now] ; <span class="keyword">if</span> (co &lt;= H) ans[now] = buc_d[co] - ks ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; v1[now].size() ; ++ k) -- buc_d[dep[v1[now][k]]] ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> co = dep[now] - base[now] + N, ks = buc_u[co] ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; v2[now].size() ; ++ k) ++ buc_u[v2[now][k] + N] ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next) <span class="keyword">if</span> (fa ^ to(k)) dfs2(to(k), now) ;</span><br><span class="line">		ans[now] += buc_u[co] - ks ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; v3[now].size() ; ++ k) -- buc_u[v3[now][k] + N] ; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Solve5</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i) </span><br><span class="line">      cnbt[s[i]] ++, v1[LCA[i]].push_back(s[i]) ; dfs1(<span class="number">1</span>, <span class="number">0</span>) ; </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i) </span><br><span class="line">      v2[e[i]].push_back(dep[e[i]] - _up[i]), </span><br><span class="line">    	v3[LCA[i]].push_back(dep[e[i]] - _up[i]) ;  dfs2(<span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= M ; ++ i) </span><br><span class="line">      <span class="keyword">if</span> (dep[s[i]] - dep[LCA[i]] == base[LCA[i]]) -- ans[LCA[i]] ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[i]) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Prepare ; <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) x = qr(), y = qr(), Add(x, y) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;s[i], &amp;e[i]) ;</span><br><span class="line">    build(<span class="number">1</span>, <span class="number">0</span>), Setup() ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) </span><br><span class="line">      LCA[i] = lca(s[i], e[i]), _up[i] = wo(s[i], e[i], LCA[i]) ; </span><br><span class="line">    pks :: Solve5() ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å—¯ï¼Œç„¶åè¿™é“é¢˜å°±å®Œäº†ã€‚ä¸å¾—ä¸è¯´è™½ç„¶å½“æ—¶ç”¨å¿ƒåšäº†ï¼Œä½†æ˜¯è¿‡ä¸Šå‡ å‘¨å†åè¿‡å¤´æ¥çœ‹è¿˜æ˜¯è§‰å¾—æœ‰äº›ç»†èŠ‚ç†è§£çš„å¹¶ä¸åˆ°ä½ã€æˆ–è€…è¯´æ˜¯æ»¡åˆ†åšæ³•ä¸­çš„æœ‰äº›æµç¨‹å½“æ—¶æ ¹æœ¬æ²¡æœ‰ä»”ç»†æ¨å¯¼ã€‚</p>
<p>ä¸è¿‡ä¸å¾—ä¸è¯´è¿™ä¸ªé¢˜è¿˜æ˜¯éå¸¸å¦™çš„ã€‚æˆ–è®¸æœ‰æ—¶å€™é¢˜é¢å¤æ‚ã€éœ€æ±‚å¤æ‚ä¼šè®©äººå¿˜è®°è¿™é“é¢˜åˆ°åº•æœ‰å¤šå·§å¦™â€¦åæ­£å°±æ˜¯æ„Ÿè§‰è¿™é“é¢˜ç”¨â€œæ¡¶+å³æ—¶ä¿®æ”¹â€è¿™ä¸ªç»„åˆæ€æƒ³è¿˜æ˜¯å¾ˆ<code>nice</code>çš„ã€‚</p>
<h1 id="4-2012F-ç–«æƒ…æ§åˆ¶"><a href="#4-2012F-ç–«æƒ…æ§åˆ¶" class="headerlink" title="$4~2012F$ ç–«æƒ…æ§åˆ¶"></a>$4~2012F$ ç–«æƒ…æ§åˆ¶</h1><p><a href="https://www.luogu.org/problem/P1084" target="_blank" rel="noopener">$Link$</a></p>
<p>â€¦è¿™ä¸ªé¢˜ä¹‹æ‰€ä»¥æ”¾åœ¨æœ€åä¸€ä¸ªæ˜¯å› ä¸ºæˆ‘çœŸçš„ä¸çŸ¥é“éƒ¨åˆ†åˆ†è¯¥æ€ä¹ˆå†™å•Šã€‚</p>
<p>å—¯ï¼Œé¦–å…ˆæ˜¯äºŒåˆ†ï¼Œè¿™å€’æ˜¯å¯ä»¥æƒ³åˆ°ã€‚ä¹‹åä¸€å¼€å§‹æƒ³çš„æ˜¯ä¼¼ä¹ä¸æ–­æŠŠåŸå¸‚å‘ä¸Šç§»åŠ¨å°±å¥½äº†ï¼Œæ¯•ç«Ÿè¶Šé ä¸Šè¶Šä¼˜ï¼›ä½†æ˜¯æ ·ä¾‹å°±æŠŠæˆ‘è¿™ç§å†™æ³•å¡æ‰äº†ï¼ŒåŸå› å¾ˆæµ…æ˜¾ï¼Œæˆ‘å¿½ç•¥äº†ç»•è¿‡æ ¹ç»§ç»­èµ°çš„é‚£äº›ç‚¹å¯ä»¥ç»§ç»­äº§ç”Ÿè´¡çŒ®â€¦â€¦äºæ˜¯å°±å¾ˆGGã€‚</p>
<p>â€¦äºæ˜¯æˆ‘é€‰æ‹©ç»Ÿè®¡äº†é‚£äº›å¯ä»¥è·¨è¶Šæ ¹çš„èŠ‚ç‚¹ã€‚å¯¹äºæœ€ç»ˆæ¯ä¸ªè¢«è¦†ç›–çš„èŠ‚ç‚¹ï¼Œæˆ‘ç”¨çš„æ˜¯ç›´æ¥æ›´æ–°<code>vector</code>é¢„å¤„ç†å‡ºæ¥æŒ‚åœ¨æ¯ä¸ªç‚¹åº•ä¸‹çš„å¶å­èŠ‚ç‚¹ï¼Œcheckçš„æ—¶å€™ç›´æ¥åˆ¤ä¸€ä¸‹æ¯ä¸ªèŠ‚ç‚¹çš„markã€‚ç„¶è€Œè¿™æ ·å†™çš„å¾ˆç¹çï¼Œå¹¶ä¸”å¤æ‚åº¦ä¹Ÿæ˜¯ä¸ªè¿·â€¦æœ€ååªèƒ½ä¸äº†äº†ä¹‹äº†</p>
<p>æ‰€ä»¥å¤§æ¦‚è¿™ä¸ªé¢˜æˆ‘æƒ³å‡ºäº†50%~60%ï¼Ÿâ€¦ç„¶è€Œè¿˜æ˜¯æ²¡æœ‰åˆ†æ•°ã€‚</p>
<h2 id="rm-Part-1-å€å¢ï¼å€å¢ï¼å€å¢ï¼"><a href="#rm-Part-1-å€å¢ï¼å€å¢ï¼å€å¢ï¼" class="headerlink" title="$\rm{Part~1}$ å€å¢ï¼å€å¢ï¼å€å¢ï¼"></a>$\rm{Part~1}$ å€å¢ï¼å€å¢ï¼å€å¢ï¼</h2><p>é¦–å…ˆå–œé—»ä¹è§çš„æ˜¯ï¼Œæˆ‘ä»¬å‘ä¸Šè·³çš„æ—¶å€™vanâ™‚å…¨å¯ä»¥ç”¨å€å¢æ¥æï¼Œåªè¦é¢„å¤„ç†å‡º$2^k$çº§ç¥–å…ˆå°±å¥½äº†ã€‚</p>
<p>ç„¶åæ³¨æ„é¡ºä¾¿åˆ¤æ–­ä¸€ä¸‹å¯ä¸å¯ä»¥æ‹å¼¯ï¼Œå³è·³åˆ°æ ¹ä¹‹åæ˜¯å¦åœ¨äºŒåˆ†çš„æ—¶é—´å†…å¯ä»¥ç»§ç»­å‘ä¸‹è·³ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp(a, b) make_pair(a, b)</span></span><br><span class="line">pair&lt;<span class="keyword">int</span> ,<span class="keyword">int</span>&gt; Army[MAXN], Pest[MAXN] ;</span><br><span class="line"><span class="built_in">memset</span>(res, <span class="number">0</span>, <span class="keyword">sizeof</span>(res)) ;</span><br><span class="line"><span class="built_in">memset</span>(Army, <span class="number">0</span>, <span class="keyword">sizeof</span>(Army)) ;</span><br><span class="line"><span class="built_in">memset</span>(Pest, <span class="number">0</span>, <span class="keyword">sizeof</span>(Pest)) ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">    t = base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">20</span> ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">        <span class="keyword">if</span> (!fa[t][j] || Sum[base[i]] - Sum[fa[t][j]] &gt; x) <span class="keyword">continue</span> ; </span><br><span class="line">  			<span class="keyword">else</span> t = fa[t][j] ;</span><br><span class="line">        <span class="keyword">if</span> (t &gt; <span class="number">1</span>) res[t] = <span class="number">1</span> ; </span><br><span class="line">  			<span class="keyword">else</span> &#123; </span><br><span class="line">          	t = base[i] ; </span><br><span class="line">          	<span class="keyword">for</span> (j = <span class="number">20</span> ; j &gt;= <span class="number">0</span> ; -- j) </span><br><span class="line">              	<span class="keyword">if</span> (fa[t][j] &gt; <span class="number">1</span>) t = fa[t][j] ; </span><br><span class="line">          	Army[++ n] = mp(x - Sum[base[i]], t) ; </span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="rm-Part-2-è½¬åŒ–ï¼è½¬åŒ–ï¼è½¬åŒ–ï¼"><a href="#rm-Part-2-è½¬åŒ–ï¼è½¬åŒ–ï¼è½¬åŒ–ï¼" class="headerlink" title="$\rm{Part~2}$ è½¬åŒ–ï¼è½¬åŒ–ï¼è½¬åŒ–ï¼"></a>$\rm{Part~2}$ è½¬åŒ–ï¼è½¬åŒ–ï¼è½¬åŒ–ï¼</h2><p>è¿™ä¸ªåœ°æ–¹æœ‰ä¸ªè‚¥è‚ æœ‰æ„æ€çš„ç‚¹ï¼Œå°±æ˜¯æˆ‘ä»¬æ€è€ƒå‡è®¾ä¸€ä¸ªå¶å­èŠ‚ç‚¹æ²¡æœ‰è¢«è¦†ç›–ï¼Œé‚£ä¹ˆå°±è¯´æ˜ä¸€å®šå­˜åœ¨å®ƒçš„æŸä¸€çº§ç¥–å…ˆçš„æ•´æ£µå­æ ‘æ²¡æœ‰è¢«è¦†ç›–ã€‚é‚£ä¹ˆè¿™å°±æç¤ºæˆ‘ä»¬å¯ä»¥è€ƒè™‘<strong>ç›´æ¥åˆ¤æ–­æ ¹çš„æ¯ä¸ªå„¿å­æ˜¯å¦éƒ½è¢«è¦†ç›–äº†ï¼ˆæ ‘å½¢ç»“æ„çš„ä¼˜è¶Šæ€§ï¼‰</strong> </p>
<p>å—¯ï¼Œäºæ˜¯å¯¹äºæˆ‘ä»¬ä¸Šä¸€éƒ¨åˆ†æ‰“å®Œmarkä¹‹åçš„é‚£äº›ç‚¹ï¼ˆæš‚æ—¶æ˜¯åªæœ‰ä¸ä¼šæ‹å¼¯çš„è¢«æ‰“äº†markï¼‰ï¼Œæˆ‘ä»¬ç›´æ¥è€ƒè™‘ä¸è¿›è¡Œä¸€æ¬¡$O(n)$çš„<code>dfs</code>å°±å¯ä»¥å®Œæˆ<code>push_up</code>çš„æ“ä½œã€‚</p>
<p>ç„¶åæˆ‘ä»¬è€ƒè™‘å¦‚ä½•æ“ä½œé‚£äº›å¯ä»¥æ‹å¼¯çš„ç‚¹ã€‚æ€è€ƒæœ€ä¼˜çš„æ–¹æ¡ˆä¸€å®šæ˜¯è¶Šé«˜è¶Šå¥½ï¼Œæ‰€ä»¥ä¸å¦¨å°±è®©ä»–æ‹è¿‡æ¥ä¹‹åè½åœ¨æ ¹çš„å„¿å­ä¸Šã€‚äºæ˜¯æˆ‘ä»¬éœ€è¦ç»Ÿè®¡è¿™ä¸ªçš„ä»£ä»·ï¼Œå¹¶å¯¹æ”¶é›†æ¥çš„ä¸¤ä¸ªä¿¡æ¯åˆ†åˆ«æ’åºã€‚ä¹‹åå°±ç›´æ¥åŒæŒ‡é’ˆæ‰«ä¸€éæ ¹çš„å…¨éƒ¨å„¿å­ï¼Œçœ‹çœ‹æ˜¯å¦å…¨éƒ¨éƒ½è¢«è¦†ç›–äº†å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> x = <span class="number">1</span>, y = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[rt] ; k ; k = E[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == fa[rt][<span class="number">0</span>]) <span class="keyword">continue</span> ;</span><br><span class="line">        push_down(to(k)) ; x &amp;= res[to(k)] ; y = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (rt &gt; <span class="number">1</span> &amp;&amp; x &amp;&amp; y) res[rt] = <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line">....</span><br><span class="line">	push_down(<span class="number">1</span>) ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[<span class="number">1</span>] ; k ; k = E[k].next) </span><br><span class="line">  	<span class="keyword">if</span> (res[to(k)]) <span class="keyword">continue</span> ; <span class="keyword">else</span> Pest[++ m] = mp(E[k].v, to(k)) ;</span><br><span class="line">	j = <span class="number">1</span> ; sort(Army + <span class="number">1</span>, Army + n + <span class="number">1</span>, cmp), sort(Pest + <span class="number">1</span>, Pest + m + <span class="number">1</span>, cmp) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">  	  <span class="keyword">if</span> (!res[Army[i].sc]) res[Army[i].sc] = <span class="number">1</span> ;</span><br><span class="line">    	<span class="keyword">else</span> <span class="keyword">if</span> (Army[i].fr &gt;= Pest[j].fr) res[Pest[j].sc] = <span class="number">1</span> ;</span><br><span class="line">    	<span class="keyword">while</span> (res[Pest[j].sc] &amp;&amp; j &lt;= m) ++ j ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> j &gt; m ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å—¯ï¼Œè´´ä¸ªæ€»ç¨‹åºå§ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next, v ;</span><br><span class="line">&#125;E[MAXN &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> cnt, head[MAXN], n, m ; <span class="keyword">bool</span> res[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, M, P, Sum[MAXN], ans, base[MAXN], fa[MAXN][<span class="number">25</span>], i, j, l, r, mid ;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    P += w ;</span><br><span class="line">    E[++ cnt].to = v, E[cnt].v = w, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">    E[++ cnt].to = u, E[cnt].v = w, E[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp(a, b) make_pair(a, b)</span></span><br><span class="line">pair&lt;<span class="keyword">int</span> ,<span class="keyword">int</span>&gt; Army[MAXN], Pest[MAXN] ;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; a, pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; b)</span></span>&#123; <span class="keyword">return</span> a.fr &lt; b.fr ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= <span class="number">20</span> ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">            fa[j][i] = fa[fa[j][i - <span class="number">1</span>]][i - <span class="number">1</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">    fa[now][<span class="number">0</span>] = f ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ;</span><br><span class="line">        Sum[to(k)] = Sum[now] + E[k].v ; dfs(to(k), now) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> x = <span class="number">1</span>, y = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[rt] ; k ; k = E[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == fa[rt][<span class="number">0</span>]) <span class="keyword">continue</span> ;</span><br><span class="line">        push_down(to(k)) ; x &amp;= res[to(k)] ; y = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (rt &gt; <span class="number">1</span> &amp;&amp; x &amp;&amp; y) res[rt] = <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t ; n = m = <span class="number">0</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(res, <span class="number">0</span>, <span class="keyword">sizeof</span>(res)) ;</span><br><span class="line">    <span class="built_in">memset</span>(Army, <span class="number">0</span>, <span class="keyword">sizeof</span>(Army)) ;</span><br><span class="line">    <span class="built_in">memset</span>(Pest, <span class="number">0</span>, <span class="keyword">sizeof</span>(Pest)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        t = base[i] ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">20</span> ; j &gt;= <span class="number">0</span> ; -- j)</span><br><span class="line">            <span class="keyword">if</span> (!fa[t][j] || Sum[base[i]] - Sum[fa[t][j]] &gt; x) <span class="keyword">continue</span> ; <span class="keyword">else</span> t = fa[t][j] ;</span><br><span class="line">        <span class="keyword">if</span> (t &gt; <span class="number">1</span>) res[t] = <span class="number">1</span> ; <span class="keyword">else</span> &#123; t = base[i] ; <span class="keyword">for</span> (j = <span class="number">20</span> ; j &gt;= <span class="number">0</span> ; -- j) <span class="keyword">if</span> (fa[t][j] &gt; <span class="number">1</span>) t = fa[t][j] ; Army[++ n] = mp(x - Sum[base[i]], t) ; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    push_down(<span class="number">1</span>) ; <span class="keyword">for</span> (<span class="keyword">int</span> k = head[<span class="number">1</span>] ; k ; k = E[k].next) <span class="keyword">if</span> (res[to(k)]) <span class="keyword">continue</span> ; <span class="keyword">else</span> Pest[++ m] = mp(E[k].v, to(k)) ;</span><br><span class="line">    j = <span class="number">1</span> ; sort(Army + <span class="number">1</span>, Army + n + <span class="number">1</span>, cmp), sort(Pest + <span class="number">1</span>, Pest + m + <span class="number">1</span>, cmp) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!res[Army[i].sc]) res[Army[i].sc] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (Army[i].fr &gt;= Pest[j].fr) res[Pest[j].sc] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (res[Pest[j].sc] &amp;&amp; j &lt;= m) ++ j ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> j &gt; m ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">int</span> a, b, c ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;c), Add(a, b, c) ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; M ; <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; dfs(<span class="number">1</span>, <span class="number">0</span>) ; Init() ;</span><br><span class="line">    l = <span class="number">0</span>, r = P ;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">if</span> (check(mid)) r = mid - <span class="number">1</span>, ans = mid ; <span class="keyword">else</span> l = mid + <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-Afterword"><a href="#rm-Afterword" class="headerlink" title="$\rm{Afterword}$"></a>$\rm{Afterword}$</h1><p>å…¶å®æ€»æ„Ÿè§‰è‡ªå·±åšè¿™äº›é¢˜è¿˜æ˜¯æœ‰äº›åŠ›ä¸ä»å¿ƒ233</p>
<p>ä¸å¾—ä¸è¯´ç±»ä¼¼äºâ€œäºŒåˆ†ç­”æ¡ˆâ€è¿™ç§ä¸œè¥¿æ˜¯å¾ˆæœ‰OIé£å‘³çš„ï¼Œæ¯•ç«Ÿæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ€æƒ³â€¦ä¸çŸ¥é“è‡ªå·±ä»€ä¹ˆæ—¶å€™èƒ½æŠŠç±»ä¼¼çš„æ‰€æœ‰æ€æƒ³çœŸæ­£åœ°æ‰“åŒ…å­¦ä¼šå•Šqaq</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>è´ªå¿ƒ</tag>
        <tag>æ ‘æ¨¡å‹</tag>
        <tag>å¥‡æ€ªçš„æŠ€å·§</tag>
        <tag>å€å¢</tag>
        <tag>æœç´¢/å‰ªæ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ³›åšã€‘Old-NOIP æ³›åšäºŒ</title>
    <url>/2019/07/11/Old-NOIP2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>äº‹å®ä¸Šæˆ‘ä¸ä¹…å‰æ‰å‘ç°åŸæ¥NOIPé‡Œé¢çš„ä¸€äº›é¢˜æ˜¯å¾ˆå¥½çš„â€¦â€¦</p>
<p>ç„¶åå¤§æ¦‚æ¥ä¸‹æ¥æ•´ç†çš„éƒ½æ˜¯äº›æˆ‘è®¤ä¸ºæŒºæœ‰éš¾åº¦çš„å§qwq</p>
<p>ä½†æ˜¯æ„Ÿè§‰ä¼¼ä¹è¿™ä¹ˆå¥½çš„é¢˜æ”¾åœ¨ä¸€å—æœ‰ç‚¹æ†‹å±ˆâ€¦â€¦äºæ˜¯å°±ç¼©çŸ­äº†ç¯‡å¹…å¢å¤šäº†ç¯‡ç›®</p>
<a id="more"></a>
<h1 id="1-2011F-è§‚å…‰å…¬äº¤"><a href="#1-2011F-è§‚å…‰å…¬äº¤" class="headerlink" title="$1~2011F$ è§‚å…‰å…¬äº¤"></a>$1~2011F$ è§‚å…‰å…¬äº¤</h1><p><a href="https://www.luogu.org/problem/P1315" target="_blank" rel="noopener">$Link$</a></p>
<p>è¿™é¢˜æˆ‘è¿˜æ˜¯å»å¹´çš„3æœˆ19å·åšçš„ï¼Œæ˜¾ç„¶æ˜¯æŠ„çš„é¢˜è§£ï¼Œäºæ˜¯ç°åœ¨åˆè¦é‡åšä¸€é/sad</p>
<p>é‚£ä¹ˆå…¶å®è´ªå¿ƒçš„æ€è·¯å¾ˆç®€å•ï¼Œæ‰¾æœ€å¤šäººç»è¿‡çš„é‚£æ¡è·¯ã€‚ç”±äº$n$æ˜¯$1000$æ‰€ä»¥ç›´æ¥$O(nk)$çš„æš´åŠ›å°±å¾ˆç¨³äº†ã€‚ç„¶åæ³¨æ„æ¶ˆé™¤åæ•ˆæ€§â€”â€”å¤§ä½“ä¸Šå°±æ˜¯å¦‚æœä½ è¿™ä¸€ç«™ç”¨äº†ä»€ä¹ˆâ€œæ°®æ°”åŠ é€Ÿâ€ï¼Œç»“æœä¸‹ä¸€ç«™è¿˜å¾—åœ¨é‚£ç­‰ç€ï¼Œå°±æ²¡æœ‰ä»»ä½•ä½œç”¨äº†ï¼Œè¿™ç§æƒ…å†µå°±<code>gg[i]=i+1</code>ï¼Œä½ åªèƒ½æ‹¯æ•‘ä¸‹ä¸€ç«™ä¸‹è½¦çš„ä¹˜å®¢ï¼›å¦åˆ™ä½ ä¹Ÿå¯ä»¥æ‹¯æ•‘æ›´å¤šçš„ï¼Œå°±æ˜¯<code>gg[i]=gg[i+1]</code>ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§çŠ¶æ€è½¬ç§»çš„æ€æƒ³å§ã€‚åœ¨æˆ‘çœ‹æ¥ä¼¼ä¹è¿™æ˜¯æœ¬é¢˜å”¯ä¸€çš„éš¾ç‚¹äº†â€¦â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">person</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> w,f,t;</span><br><span class="line">&#125;p[<span class="number">100001</span>];</span><br><span class="line"><span class="keyword">int</span> max_each[<span class="number">100001</span>],sum_max[<span class="number">100001</span>],get[<span class="number">100001</span>],time[<span class="number">100001</span>],gg[<span class="number">100001</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n,m,k,ans=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++)<span class="built_in">cin</span>&gt;&gt;time[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">    	<span class="built_in">cin</span>&gt;&gt;p[i].w&gt;&gt;p[i].f&gt;&gt;p[i].t;</span><br><span class="line">    	max_each[p[i].f] = max(p[i].w,max_each[p[i].f]);</span><br><span class="line">      sum_max[p[i].t]++ ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">			sum_max[i]+=sum_max[i<span class="number">-1</span>];</span><br><span class="line">		get[<span class="number">1</span>]=max_each[<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">			get[i]=max(get[i<span class="number">-1</span>],max_each[i<span class="number">-1</span>])+time[i<span class="number">-1</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">			ans+=(get[p[i].t]-p[i].w);</span><br><span class="line">		&#125;<span class="comment">//cout&lt;&lt;ans&lt;&lt;endl;</span></span><br><span class="line">		<span class="keyword">while</span>(k--)&#123;</span><br><span class="line">  	    gg[n]=gg[n<span class="number">-1</span>]=n;</span><br><span class="line">				<span class="keyword">int</span> maxn=<span class="number">0</span>,f;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-2</span>;i&gt;=<span class="number">1</span>;i--)</span><br><span class="line">      	  gg[i]=get[i+<span class="number">1</span>]&lt;=max_each[i+<span class="number">1</span>]?i+<span class="number">1</span>:gg[i+<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">        	<span class="keyword">if</span>(sum_max[gg[i]]-sum_max[i]&gt;maxn&amp;&amp;time[i])&#123;</span><br><span class="line">            maxn=sum_max[gg[i]]-sum_max[i];f=i;</span><br><span class="line">        	&#125;</span><br><span class="line">        ans-=maxn;time[f]--;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)get[i]=max(get[i<span class="number">-1</span>],max_each[i<span class="number">-1</span>])+time[i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><del>æ‹¿ä»€ä¹ˆæ‹¯æ•‘æˆ‘å½“å¹´å¹¼ç¨šçš„ç é£å•Š</del></p>
<h1 id="2-2015C-æ–—åœ°ä¸»"><a href="#2-2015C-æ–—åœ°ä¸»" class="headerlink" title="$2~2015C$ æ–—åœ°ä¸»"></a>$2~2015C$ æ–—åœ°ä¸»</h1><p><a href="https://www.luogu.org/problem/P2668" target="_blank" rel="noopener">Link</a></p>
<p>ä¸€é“å–œé—»ä¹è§çš„æœç´¢é¢˜ã€‚å…¶å®è›®ç®€å•çš„ï¼Œå°±æ˜¯æ¯æ¬¡æŠŠèƒ½å‡ºçš„ç‰Œå‡ºä¸€éå°±å¥½äº†ï¼Œå°±æ˜¯è°ƒæœ‰ç‚¹éš¾è°ƒï¼Œåœ¨è¿™ä¸ªæ—¶å€™è¾“å‡ºè°ƒè¯•æ³•+è‚‰çœ¼æŸ¥é”™æ³•æ¯”ä»€ä¹ˆ<code>gdb</code>å¥½ç”¨å¤šäº†ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æ•´ç†çš„ç»†èŠ‚ï¼š</p>
<ul>
<li>è‡³äºå¦‚ä½•å‡ºå•ç‰Œå’Œå¯¹å­ï¼Œåªéœ€è¦æ¯æ¬¡dfsæ—¶æ¯æ¬¡æœ€åæŠŠä¸èƒ½å‡ºèŠ±çš„éƒ½å‡ºäº†å°±å¥½ï¼Œå°±æ˜¯è¿™æ ·ï¼š</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">14</span> ; ++ j) <span class="keyword">if</span> (buc[j]) step ++ ; Ans = min(Ans, step) ; <span class="keyword">return</span> ;</span><br></pre></td></tr></table></figure>
<pre><code> åä¹‹å¦‚æœåœ¨å‡ºå•ç‰Œ/å¯¹å­çš„æ—¶å€™å†è®¾ç½®å›æº¯â€”â€”æ²¡æœ‰å¿…è¦ä¸”ä¸¥é‡æ‰©å±•äº†çŠ¶æ€æ•°ã€‚
</code></pre><ul>
<li>è¿˜æ˜¯å‰ªæï¼Œå¤§æ¦‚å°±æ˜¯ä¸€ä¸ªæœ€ä¼˜æ€§å‰ªæï¼š<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (step &gt;= Ans) <span class="keyword">return</span> ;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>â€‹    å¯èƒ½æ˜¯å› ä¸ºå¤ªå¥—è·¯äº†æˆ‘ä¸€ç›´è®°ä¸ä½= =</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> step)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (step &gt;= Ans) <span class="keyword">return</span> ; </span><br><span class="line"> 	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">12</span> ; ++ j)&#123; <span class="comment">//å•é¡ºå­ </span></span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>, pos ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; ; ++ k) </span><br><span class="line">      <span class="keyword">if</span> (!buc[j + k - <span class="number">1</span>] || j + k &gt; <span class="number">13</span>) &#123; </span><br><span class="line">        cnt = k - <span class="number">1</span> ; pos = j + k - <span class="number">2</span> ; <span class="keyword">break</span> ; </span><br><span class="line">      &#125;</span><br><span class="line">		<span class="keyword">if</span> (cnt &gt;= <span class="number">5</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = j ; k &lt;= pos ; ++ k) buc[k] -- ;</span><br><span class="line">			dfs(m - cnt, step + <span class="number">1</span>) ; <span class="keyword">for</span> (<span class="keyword">int</span> k = j ; k &lt;= pos ; ++ k) buc[k] ++ ;</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">12</span> ; ++ j)&#123; <span class="comment">//åŒé¡ºå­ </span></span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>, pos ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; ; ++ k)  </span><br><span class="line">      <span class="keyword">if</span> (buc[j + k - <span class="number">1</span>] &lt; <span class="number">2</span> || j + k &gt; <span class="number">13</span>) &#123; </span><br><span class="line">         cnt = k - <span class="number">1</span> ; pos = j + k - <span class="number">2</span> ; <span class="keyword">break</span> ; </span><br><span class="line">     &#125;</span><br><span class="line">		<span class="keyword">if</span> (cnt &gt;= <span class="number">3</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = j ; k &lt;= pos ; ++ k) buc[k] -= <span class="number">2</span> ;</span><br><span class="line">			dfs(m - cnt * <span class="number">2</span>, step + <span class="number">1</span>) ; <span class="keyword">for</span> (<span class="keyword">int</span> k = j ; k &lt;= pos ; ++ k) buc[k] += <span class="number">2</span> ;</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">12</span> ; ++ j)&#123; <span class="comment">//ä¸‰é¡ºå­ </span></span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>, pos ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; ; ++ k) </span><br><span class="line">      <span class="keyword">if</span> (buc[j + k - <span class="number">1</span>] &lt; <span class="number">3</span> || j + k &gt; <span class="number">13</span>) &#123; </span><br><span class="line">        cnt = k - <span class="number">1</span> ; pos = j + k - <span class="number">2</span> ; <span class="keyword">break</span> ; </span><br><span class="line">      &#125;</span><br><span class="line">		<span class="keyword">if</span> (cnt &gt;= <span class="number">3</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = j ; k &lt;= pos ; ++ k) buc[k] -= <span class="number">3</span>  ;</span><br><span class="line">			dfs(m - cnt * <span class="number">3</span>, step + <span class="number">1</span>) ; <span class="keyword">for</span> (<span class="keyword">int</span> k = j ; k &lt;= pos ; ++ k) buc[k] += <span class="number">3</span> ;</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line"> 	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">13</span> ; ++ j)&#123; <span class="comment">//ç‚¸å¼¹ or å››å¸¦äºŒ  </span></span><br><span class="line"> 		<span class="keyword">int</span> p[<span class="number">3</span>], tot = <span class="number">0</span>, q[<span class="number">3</span>], cnt = <span class="number">0</span> ; </span><br><span class="line">		<span class="keyword">if</span> (buc[j] &gt;= <span class="number">4</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; k &lt;= <span class="number">14</span> ; ++ k)&#123;</span><br><span class="line">				<span class="keyword">if</span> (j != k)&#123;</span><br><span class="line">					<span class="keyword">if</span> (buc[k] &gt;= <span class="number">2</span> &amp;&amp; cnt &lt; <span class="number">2</span>) q[++ cnt] = k ; </span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span> (buc[k] &amp;&amp; tot &lt; <span class="number">2</span>) p[++ tot] = k ; </span><br><span class="line">				&#125;</span><br><span class="line">			&#125;   </span><br><span class="line">			<span class="keyword">if</span> (tot &lt; <span class="number">2</span> &amp;&amp; cnt &lt; <span class="number">2</span>) &#123; buc[j] -= <span class="number">4</span> ; dfs(m - <span class="number">4</span>, step + <span class="number">1</span>) ; buc[j] += <span class="number">4</span> ; &#125; </span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (cnt &lt; <span class="number">2</span>)  &#123; </span><br><span class="line">        buc[p[<span class="number">2</span>]] --, buc[p[<span class="number">1</span>]] --, buc[j] -= <span class="number">4</span> ; </span><br><span class="line">        dfs(m - <span class="number">6</span>, step + <span class="number">1</span>) ; buc[p[<span class="number">2</span>]] ++, buc[p[<span class="number">1</span>]] ++, buc[j] += <span class="number">4</span> ; </span><br><span class="line">      &#125;</span><br><span class="line">			<span class="keyword">else</span> &#123; </span><br><span class="line">        buc[q[<span class="number">2</span>]] -= <span class="number">2</span>, buc[q[<span class="number">1</span>]] -= <span class="number">2</span>, buc[j] -= <span class="number">4</span> ; </span><br><span class="line">        dfs(m - <span class="number">8</span>, step + <span class="number">1</span>) ; buc[q[<span class="number">2</span>]] += <span class="number">2</span>, buc[q[<span class="number">1</span>]] += <span class="number">2</span>, buc[j] += <span class="number">4</span> ; &#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">13</span> ; ++ j)&#123; <span class="comment">// ä¸‰å¸¦XXX </span></span><br><span class="line">		<span class="keyword">if</span> (buc[j] &gt;= <span class="number">3</span>)&#123;</span><br><span class="line">			buc[j] -= <span class="number">3</span> ;</span><br><span class="line">          	<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span> ; k &lt;= <span class="number">14</span> ; ++ k)&#123;</span><br><span class="line">                <span class="keyword">if</span>( !buc[k] || k == j )  <span class="keyword">continue</span> ;</span><br><span class="line">                buc[k] -- ; dfs(m - <span class="number">4</span>, step + <span class="number">1</span>) ; buc[k] ++ ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span> ; k &lt;= <span class="number">13</span> ; ++ k)&#123;</span><br><span class="line">                <span class="keyword">if</span>( buc[k] &lt;= <span class="number">1</span> || j == k) <span class="keyword">continue</span> ;</span><br><span class="line">                buc[k] -= <span class="number">2</span> ; dfs(m - <span class="number">5</span>, step + <span class="number">1</span>) ; buc[k] += <span class="number">2</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            buc[j] +=<span class="number">3</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">14</span> ; ++ j) </span><br><span class="line">    <span class="keyword">if</span> (buc[j]) step ++ ; Ans = min(Ans, step) ; </span><br><span class="line">  <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>= =å…¶å®è¿™é¢˜æœ€æ¶å¿ƒçš„è¿˜æ˜¯ç²—å¿ƒåœ°å†™é”™ï¼Œæ¯•ç«Ÿé‚£ä¹ˆå¤šå‡½æ•°éƒ½æ˜¯<code>ctrl c</code>+<code>ctrl v</code>çš„ï¼Œé¬¼çŸ¥é“ä»€ä¹ˆåœ°æ–¹å°±å´©æ‰äº†â€¦â€¦</p>
<h1 id="3-2015-text-C-G-æ–—åœ°ä¸»åŠ å¼ºç‰ˆ"><a href="#3-2015-text-C-G-æ–—åœ°ä¸»åŠ å¼ºç‰ˆ" class="headerlink" title="$3~2015\text{C+/G}$  æ–—åœ°ä¸»åŠ å¼ºç‰ˆ"></a>$3~2015\text{C+/G}$  æ–—åœ°ä¸»åŠ å¼ºç‰ˆ</h1><p><a href="https://www.luogu.org/problem/P2540" target="_blank" rel="noopener">Link</a></p>
<p>ç›´æ¥ç²˜ä¸€ä»½ä»£ç è¿‡æ¥ä½ ç”šè‡³å¯ä»¥è·å¾—74ptsçš„å¥½æˆç»©= =</p>
<p>å…¶å®ä¸»è¦æ€æƒ³å°±æ˜¯<strong>æ‹†ç‰Œ</strong>ï¼ŒåŸå› æ˜¯å‡è®¾ä½ åˆä¸¤ç»„ä¸‰å¼ ï¼Œä¸€ç»„ç‚¸ï¼Œä½ çš„æ€è·¯æ˜¯å‡ºä¸‰æ¬¡ï¼Œä½†å®é™…ä¸Šåªéœ€è¦ä¸¤æ¬¡å°±å¯ä»¥â€”â€”æŠŠä¸€ç»„ä¸‰å¼ æ‹†æˆä¸€å•+ä¸€å¯¹ï¼Œç„¶åå¸¦èµ°åªéœ€è¦ä¸¤æ¬¡ã€‚</p>
<p>ä½†æ˜¯æˆ‘å¹¶ä¸æƒ³å†™è¯¡å¼‚çš„å‰ªæï¼Œäºæ˜¯ç´¢æ€§æ ¹æ®é¢˜è§£åŒºå†™äº†ä¸€ä¸ªDPã€‚å³è®¾$dp_{i,j,k,l,o}$è¡¨ç¤ºå‰©ä¸‹çš„å•å¼ æœ‰$i$ä¸ªï¼Œå¯¹ç‰Œæœ‰$j$ä¸ªï¼Œä¸‰å¼ æœ‰$k$ç»„ï¼Œå››å¼ æœ‰$l$ç»„ï¼Œç‹æœ‰$o$ä¸ªçš„æœ€å°å‡ºç‰Œæ¬¡æ•°ã€‚ç„¶åè½¬ç§»å°±æ˜¯æœ´ç´ çš„è½¬ç§»ï¼ŒåŒæ—¶ç”±äºæ‹†ç‰Œçš„å­˜åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å¤šåŠ ä¸¤ç»„æ‹†ç‰Œçš„è½¬ç§»ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬å…ˆæšä¸¾ä¸‰å¼ å’Œç‚¸æ‰èƒ½è½¬ç§»ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init_dp</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dp, <span class="number">63</span>, <span class="keyword">sizeof</span>(dp)) ;</span><br><span class="line">	dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (rr <span class="keyword">int</span> l = <span class="number">0</span> ; l &lt;= N ; ++ l)</span><br><span class="line">		<span class="keyword">for</span> (rr <span class="keyword">int</span> k = <span class="number">0</span> ; k &lt;= N ; ++ k)</span><br><span class="line">			<span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= N ; ++ i)</span><br><span class="line">				<span class="keyword">for</span> (rr <span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= N ; ++ j)</span><br><span class="line">					<span class="keyword">for</span> (rr <span class="keyword">int</span> o = <span class="number">0</span> ; o &lt;= <span class="number">2</span> ; ++ o)&#123;</span><br><span class="line">						rr <span class="keyword">int</span> res = <span class="number">100</span> ;</span><br><span class="line">						<span class="comment">// Single</span></span><br><span class="line">						<span class="keyword">if</span> (i) res = min(res, dp[i - <span class="number">1</span>][j][k][l][o] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="keyword">if</span> (j) res = min(res, dp[i][j - <span class="number">1</span>][k][l][o] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="keyword">if</span> (k) res = min(res, dp[i][j][k - <span class="number">1</span>][l][o] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="keyword">if</span> (l) res = min(res, dp[i][j][k][l - <span class="number">1</span>][o] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="keyword">if</span> (o) res = min(res, dp[i][j][k][l][o - <span class="number">1</span>] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="keyword">if</span> (o &gt; <span class="number">1</span>) res = min(res, dp[i][j][k][l][o - <span class="number">2</span>] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="comment">// T -&gt; 1</span></span><br><span class="line">						<span class="keyword">if</span> (i &amp;&amp; k) res = min(res, dp[i - <span class="number">1</span>][j][k - <span class="number">1</span>][l][o] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="keyword">if</span> (k &amp;&amp; o) res = min(res, dp[i][j][k - <span class="number">1</span>][l][o - <span class="number">1</span>] + <span class="number">1</span>) ; </span><br><span class="line">						<span class="comment">// T -&gt; 2</span></span><br><span class="line">						<span class="keyword">if</span> (j &amp;&amp; k) res = min(res, dp[i][j - <span class="number">1</span>][k - <span class="number">1</span>][l][o] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="comment">// F -&gt; 2</span></span><br><span class="line">						<span class="keyword">if</span> (l &gt; <span class="number">1</span>) res = min(res, dp[i][j][k][l - <span class="number">2</span>][o] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="keyword">if</span> (j &amp;&amp; l)  res = min(res, dp[i][j - <span class="number">1</span>][k][l - <span class="number">1</span>][o] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="keyword">if</span> (i &gt; <span class="number">1</span> &amp;&amp; l) res = min(res, dp[i - <span class="number">2</span>][j][k][l - <span class="number">1</span>][o] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="keyword">if</span> (j &gt; <span class="number">1</span> &amp;&amp; l) res = min(res, dp[i][j - <span class="number">2</span>][k][l - <span class="number">1</span>][o] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="keyword">if</span> (o &gt; <span class="number">1</span> &amp;&amp; l) res = min(res, dp[i][j][k][l - <span class="number">1</span>][o - <span class="number">2</span>] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="keyword">if</span> (i &amp;&amp; o &amp;&amp; l) res = min(res, dp[i - <span class="number">1</span>][j][k][l - <span class="number">1</span>][o - <span class="number">1</span>] + <span class="number">1</span>) ;</span><br><span class="line">						<span class="comment">// CHAI</span></span><br><span class="line">						<span class="keyword">if</span> (l) res = min(res, dp[i + <span class="number">1</span>][j][k + <span class="number">1</span>][l - <span class="number">1</span>][o]) ;</span><br><span class="line">						<span class="keyword">if</span> (k) res = min(res, dp[i + <span class="number">1</span>][j + <span class="number">1</span>][k - <span class="number">1</span>][l][o]) ;</span><br><span class="line">						<span class="comment">// Trans</span></span><br><span class="line">						dp[i][j][k][l][o] = min(res, dp[i][j][k][l][o]) ;</span><br><span class="line">					&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‹†ç‰Œåˆ†åˆ«æ˜¯â€œç‚¸æ‹†æˆä¸‰å¼ å’Œå•å¼ â€ä»¥åŠâ€œä¸‰å¼ æ‹†æˆå¯¹å­å’Œå•å¼ â€ã€‚</p>
<p>ç„¶åç”±äºé¡ºå­è¿™ç§ä¸œè¥¿ä¸èƒ½æ ¹æ®æ•°é‡è½¬ç§»ï¼Œæ‰€ä»¥å°±è¿˜æ˜¯dfsæš´åŠ›ç®—ï¼ˆdpæŒ‰ç†è¯´ä¹Ÿæ˜¯æš´åŠ›å§/kkï¼‰ï¼Œæœ€ååŠ å›æ¥å°±å®Œäº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> step)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (step &gt;= Ans) <span class="keyword">return</span> ; </span><br><span class="line"> 	<span class="keyword">for</span> (rr <span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">12</span> ; ++ j)&#123; <span class="comment">//å•é¡ºå­ </span></span><br><span class="line">        rr <span class="keyword">int</span> cnt = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (rr <span class="keyword">int</span> k = <span class="number">1</span> ; ; ++ k) </span><br><span class="line">          <span class="keyword">if</span> (!buc[j + k - <span class="number">1</span>] || j + k &gt; <span class="number">13</span>) &#123; cnt = k - <span class="number">1</span> ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">        <span class="keyword">if</span> (cnt &gt;= <span class="number">5</span>)&#123;</span><br><span class="line">        	<span class="keyword">for</span> (rr <span class="keyword">int</span> p = <span class="number">5</span> ; p &lt;= cnt ; ++ p)&#123;</span><br><span class="line">           		<span class="keyword">for</span> (rr <span class="keyword">int</span> k = j ; k &lt;= j + p - <span class="number">1</span> ; ++ k) buc[k] -- ;</span><br><span class="line">            	dfs(m - p, step + <span class="number">1</span>) ;   </span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">int</span> k = j ; k &lt;= j + p - <span class="number">1</span> ; ++ k) buc[k] ++ ;</span><br><span class="line">			&#125;</span><br><span class="line">        &#125;	</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">12</span> ; ++ j)&#123; <span class="comment">//åŒé¡ºå­ </span></span><br><span class="line">        rr <span class="keyword">int</span> cnt = <span class="number">0</span>, pos ;</span><br><span class="line">        <span class="keyword">for</span> (rr <span class="keyword">int</span> k = <span class="number">1</span> ; ; ++ k)  </span><br><span class="line">          <span class="keyword">if</span> (buc[j + k - <span class="number">1</span>] &lt; <span class="number">2</span> || j + k &gt; <span class="number">13</span>) &#123; cnt = k - <span class="number">1</span> ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">        <span class="keyword">if</span> (cnt &gt;= <span class="number">3</span>)&#123;</span><br><span class="line">        	<span class="keyword">for</span> (rr <span class="keyword">int</span> p = <span class="number">3</span> ; p &lt;= cnt ; ++ p)&#123;</span><br><span class="line">            	pos = j + p - <span class="number">1</span> ; </span><br><span class="line">              <span class="keyword">for</span> (rr <span class="keyword">int</span> k = j ; k &lt;= pos ; ++ k) buc[k] -= <span class="number">2</span> ;</span><br><span class="line">            	dfs(m - cnt * <span class="number">2</span>, step + <span class="number">1</span>) ; </span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">int</span> k = j ; k &lt;= pos ; ++ k) buc[k] += <span class="number">2</span> ;</span><br><span class="line">			&#125;</span><br><span class="line">        &#125;	</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">12</span> ; ++ j)&#123; <span class="comment">//ä¸‰é¡ºå­ </span></span><br><span class="line">        rr <span class="keyword">int</span> cnt = <span class="number">0</span>, pos ;</span><br><span class="line">        <span class="keyword">for</span> (rr <span class="keyword">int</span> k = <span class="number">1</span> ; ; ++ k)  </span><br><span class="line">          <span class="keyword">if</span> (buc[j + k - <span class="number">1</span>] &lt; <span class="number">3</span> || j + k &gt; <span class="number">13</span>) &#123; cnt = k - <span class="number">1</span> ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">        <span class="keyword">if</span> (cnt &gt;= <span class="number">2</span>)&#123;</span><br><span class="line">        	<span class="keyword">for</span> (rr <span class="keyword">int</span> p = <span class="number">2</span> ; p &lt;= cnt ; ++ p)&#123;</span><br><span class="line">            	pos = j + p - <span class="number">1</span> ; </span><br><span class="line">              <span class="keyword">for</span> (rr <span class="keyword">int</span> k = j ; k &lt;= pos ; ++ k) buc[k] -= <span class="number">3</span> ;</span><br><span class="line">            	dfs(m - cnt * <span class="number">3</span>, step + <span class="number">1</span>) ; </span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">int</span> k = j ; k &lt;= pos ; ++ k) buc[k] += <span class="number">3</span> ;</span><br><span class="line">			&#125;</span><br><span class="line">        &#125;	</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(tong, <span class="number">0</span>, <span class="keyword">sizeof</span>(tong)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= <span class="number">13</span> ; ++ j) tong[buc[j]] ++ ; tong[<span class="number">5</span>] = buc[<span class="number">14</span>] ;</span><br><span class="line">    Ans = min(Ans, step + dp[tong[<span class="number">1</span>]][tong[<span class="number">2</span>]][tong[<span class="number">3</span>]][tong[<span class="number">4</span>]][tong[<span class="number">5</span>]]);<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="4-2015E-å­ä¸²"><a href="#4-2015E-å­ä¸²" class="headerlink" title="$4~2015E$ å­ä¸²"></a>$4~2015E$ å­ä¸²</h1><p><a href="https://www.luogu.org/problem/P2679" target="_blank" rel="noopener">$Link$</a></p>
<p>åˆæ˜¯ä¸€é“æƒ…æ€€é¢˜ï¼Œè¿˜è®°å¾—å½“æ—¶åšçš„æ—¶å€™è§‰å¾—å¯éš¾äº†â€¦ï¼ˆå½“æ—¶çš„pksï¼šè¿™ä¸ªè½¬ç§»æ˜¯äººèƒ½æƒ³å‡ºæ¥çš„å—ï¼Ÿï¼‰</p>
<p>ä½†å…¶å®çŠ¶æ€å¾ˆç®€å•ï¼Œ$f_{i,j,k,0/1}$è®°å½•Aåˆ°äº†$i$ï¼ŒBåˆ°äº†$j$ï¼ŒAè¿„ä»Šä¸ºæ­¢åˆ†æˆ$k$æ®µï¼Œ$A[i]$é€‰æˆ–è€…ä¸é€‰çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>ç„¶åè½¬ç§»æ—¶è€ƒè™‘åˆ†ç±»è®¨è®ºï¼š</p>
<ul>
<li><p>é¦–å…ˆ  $A[i] = B[j]:$</p>
<ul>
<li>1 ï¼š $f_{i,j,k,1} = f_{i-1,j-1,k-1,1} + f_{i-1,j-1,k-1,0} + f_{i-1,j-1,k,1}$ ä¹Ÿå°±æ˜¯{i,j}å’Œå‰é¢çš„æ˜¯ä¸€æ®µ/ä¸æ˜¯ä¸€æ®µä¸”å’Œå‰é¢çš„æ®µä¹‹é—´æœ‰ç©ºæ ¼/ä¸æ˜¯ä¸€æ®µä¸”å’Œå‰é¢çš„æ®µä¹‹é—´æ²¡ç©ºæ ¼ï¼ˆè®¨è®ºç©ºæ ¼æ˜¯ä¸ºäº†ä¿è¯è½¬ç§»çš„å®Œæ•´æ€§ï¼‰ã€‚</li>
<li>2 ï¼š $f_{i,j,k,0} = f_{i - 1,j, k, 1} + f_{i -1, j, k, 0}$ å‰é¢ä¸€ä½é€‰/ä¸é€‰</li>
</ul>
</li>
<li><p>å¦åˆ™ $A[i]\not = B[j]$</p>
<ul>
<li>1ï¼š  $f_{i,j,k,1} = 0\\$ ä¸åˆæ³•çš„è½¬ç§»<br>2ï¼š $f_{i,j,k,0} = f_{i - 1,j, k, 1} + f_{i -1, j, k, 0}$</li>
</ul>
</li>
</ul>
<p>å…¶å®æ„Ÿè§‰è¿™ä¸ªæ–¹ç¨‹â€¦æ€ä¹ˆè¯´å‘¢ï¼ŒæŒºæœ‰å­¦ä¹ æ„ä¹‰çš„ã€‚è¿™å…¶å®ä¹Ÿç®—æ˜¯åšäº†ä¸€ä¸ªçŠ¶æ€çš„å‰ç¼€å’Œï¼Œå› ä¸ºç†è®ºä¸Šæ˜¯è¦ä»$k\text{~}i-1$ä¸­è½¬ç§»çš„ï¼Œä½†å› ä¸ºæ˜¯æ–¹æ¡ˆæ•°ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åšä¸€ä¸ªå‰ç¼€å’Œè¿‡æ¥ï¼›åŒæ—¶å› ä¸ºæ­¤æ—¶æˆ‘ä»¬çš„â€œä¸»å…ƒâ€æ˜¯$A$ï¼Œæ‰€ä»¥å¦‚æœä¸é€‰çš„è¯åªèƒ½æ˜¯ä»$(i-1,j)$è½¬ç§»è¿‡æ¥è€Œä¸æ˜¯$(i,j-1)$ï¼ˆå³$k$è¿™ä¸€ç»´é™åˆ¶çš„æ˜¯$i$ï¼‰ ã€‚</p>
<p>ç„¶è€Œè¿˜æœ‰å¦å¤–ä¸€ç§å®šä¹‰çŠ¶æ€çš„æ–¹å¼ï¼›</p>
<p>å…¶ä½™çš„éƒ½å·®ä¸å¤šï¼Œè¿˜æ˜¯$f_{i,j,k,1}$è¡¨ç¤ºå¿…é€‰ï¼Œä½†æ˜¯$f_{i,j,k,0}$åˆ™è¡¨ç¤º<strong>â€œå¯é€‰å¯ä¸é€‰â€</strong>ã€‚é‚£æˆ‘ä»¬æ¥æ€è€ƒè¿™æ ·å¦‚ä½•è½¬ç§»ï¼š</p>
<ul>
<li>1ï¼š$f_{i,j,k,1} = (f_{i-1,j-1,k,1} +f_{i - 1,j-1, k-1, 0})\cdot [A_i=B_j] $ è¿˜æ˜¯åˆ†ç±»è®¨è®ºâ€œè¿ä¸è¿æˆä¸€æ•´æ®µâ€</li>
<li>2ï¼š$f_{i,j,k,0} = f_{iâˆ’1,j,k,0}+f_{i,j,k,1}$ï¼Œå³<strong>ä¿è¯äº†è¿™ä¸€ä½ä¸é€‰çš„ä¸Šä¸€ä½çš„é€‰/ä¸é€‰</strong>å’Œ<strong>ä¿è¯äº†è¿™ä¸€ä½å¿…é€‰</strong>çš„æ–¹æ¡ˆæ•°ã€‚</li>
</ul>
<p>æ€æƒ³ä¹Ÿå¤§ä½“ç›¸åŒã€‚æ³¨æ„æ•°æ®èŒƒå›´çš„é™åˆ¶ï¼Œæ»šä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<p>å—¯ï¼Œæ˜¯ä¸€é“ä¸é”™çš„é¢˜ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; K ; dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= N; i ++) <span class="built_in">cin</span> &gt;&gt; A[i] ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= M; i ++) <span class="built_in">cin</span> &gt;&gt; B[i] ;</span><br><span class="line">    <span class="keyword">for</span>(d = i = <span class="number">1</span>; i &lt;= N; i ++, d ^= <span class="number">1</span>)&#123;</span><br><span class="line">        dp[d][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt;= M; j ++)</span><br><span class="line">            <span class="keyword">for</span>(k = <span class="number">1</span>; k &lt;= K ;k ++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(A[i] == B[j]) </span><br><span class="line">                f[d][j][k] = (dp[d ^ <span class="number">1</span>][j - <span class="number">1</span>][k - <span class="number">1</span>] + f[d ^ <span class="number">1</span>][j - <span class="number">1</span>][k]) % mod ;</span><br><span class="line">                <span class="keyword">else</span> f[d][j][k] = <span class="number">0</span> ; </span><br><span class="line">              	dp[d][j][k] = (dp[d ^ <span class="number">1</span>][j][k] + f[d][j][k]) % mod ;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; dp[N &amp; <span class="number">1</span>][M][K]% mod ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="5-2011C-Mayanæ¸¸æˆ"><a href="#5-2011C-Mayanæ¸¸æˆ" class="headerlink" title="$5~2011C$ Mayanæ¸¸æˆ"></a>$5~2011C$ Mayanæ¸¸æˆ</h1><p><a href="https://www.luogu.org/problem/P1312" target="_blank" rel="noopener">Link</a></p>
<p>æƒ³å½“å¹´è¿™å¯çœŸæ˜¯å™©æ¢¦â€¦â€¦</p>
<p>ç®€å•æ¥è®²å°±æ˜¯çˆ†æœå§ï¼Œåªä¸è¿‡è®°å¾—å½“æ—¶æ²¡æƒ³åˆ°æ˜¯çœŸçš„æ¯æ¬¡æœä¸€é$7\cdot5$çš„æ–¹é˜µâ€¦â€¦</p>
<p>ç„¶åè¿™æ˜¯ä»¥å‰çš„ç¬”è®°ï¼š</p>
<ul>
<li>1ã€æ¯æ¬¡æœç´¢è¦ä¿ç•™æœ¬æ¬¡çš„çŠ¶æ€ï¼Œè¿™æ˜¯æ¯”è¾ƒå¥½æƒ³çš„ï¼Œæˆ‘ä¹ŸæˆåŠŸçš„æƒ³åˆ°äº†ã€‚ä½†æ˜¯é—®é¢˜æ˜¯æˆ‘ä»¬ä¸èƒ½å•çº¯åœ°ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„æ¥$copy$ï¼Œéœ€è¦è®°å½•æ­¥æ•°ï¼Œå› ä¸ºå¦‚æœå•çº¯çš„resetä¼šå¯¼è‡´ä¹‹å‰èµ°è¿‡çš„ä¹Ÿæ¶ˆå¤±ã€‚äºæ˜¯æœ€ç»ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸‰ç»´æ•°ç»„æ¥è®°å½•ã€‚ååŠæ®µæ˜¯$qcr$å‘Šè¯‰æˆ‘çš„ã€‚ </li>
<li><p>2ã€è¿˜æœ‰å°±æ˜¯ä¸€ä¸ªå°å°çš„å‰ªæã€‚å°±æ˜¯ç”±äºå¯¹äºæ¯ä¸€ä¸ªæ ¼å­ï¼Œæˆ‘ä»¬è€ƒè™‘å®ƒå‘ä¸¤è¾¹æ›¿æ¢ï¼Œè€Œæˆ‘ä»¬ä¸ºäº†é¿å…é‡å¤æœç´¢ï¼Œæ‰€ä»¥å°±å†³å®š<strong>å•å‘æœç´¢</strong>ï¼Œå³å¯¹äºæ¯ä¸ªå—ï¼Œå¦‚æœä»–å·¦è¾¹ä¹Ÿæ˜¯ä¸€ä¸ªå—ï¼Œé‚£å°±ä¸å»$exchange$ï¼Œåªè€ƒè™‘å³è¾¹ï¼›è€Œå¦‚æœå·¦è¾¹æ˜¯ç©ºç™½æ ¼ï¼Œæ‰$exchange$ã€‚æ˜¾ç„¶è¿™ä¸ªå‰ªæçš„ä¼˜åŒ–æ€§æ˜¯å¾ˆæ˜¾è‘—çš„ã€‚</p>
</li>
<li><p>3ã€æˆ‘ä¸€å¼€å§‹å†™çš„$remove()$ã€$down()$å’Œ$check()$ååˆ†çš„éº»çƒ¦â€”â€”æˆ–è€…è¯´ä¸“ä¸€?åæ­£ä¹‹åæˆ‘æ‡’å¾—è°ƒè¯•äº†ï¼Œç›´æ¥å¬çš„$qcr$çš„ï¼Œæ¯æ¬¡æ‰§è¡Œè¿™å‡ ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œç›´æ¥<strong>å…¨å±æ‰«ä¸€é</strong>ã€‚</p>
</li>
<li><p>4ã€$qcr$ç»™æˆ‘è®²äº†ä¸€ä¸ªå¾ˆç¥çš„$down()$å‡½æ•°â€”â€”å…¶å®ä¹Ÿä¸ç®—å¤šç¥ï¼Œåªæ˜¯å¾ˆç®€å•åœ°å¤„ç†äº†æ¯ä¸€è¡Œçš„æ‚¬ç©ºæ€æ–¹å—ï¼Œä½†æ˜¯è¯´â€œç¥â€çš„åŸå› åˆ™æ˜¯å› ä¸ºâ€œç®€å•â€ã€‚å¯¹ï¼Œç®€å•ï¼Œè€Œæœ‰æ—¶å¾€å¾€æˆ‘ä¼šæƒ³å¤æ‚ã€‚</p>
</li>
<li><p>5ã€å¯¹äº$exchange$ï¼Œæˆ‘ä»¬è¦ä¸æ–­çš„$while(remove()) ~;$ï¼Œå› ä¸ºä¼šä¸æ–­åœ°æœ‰æ–°æƒ…å†µå‡ºç°ã€‚</p>
</li>
<li><p>6ã€æœ€åæˆ‘æŒ‚äº†â€¦â€¦å‡ ä¸ªç‚¹æ¥ç€â€¦â€¦å¿˜è®°äº†ã€‚åæ­£åŸå› æ˜¯å› ä¸ºï¼Œæ¯æ¬¡$remove()$ä¹‹å‰åº”è¯¥å…ˆ$down()$ï¼Œç„¶è€Œæˆ‘å¹¶æ²¡æœ‰$down()$å¹²å‡€233</p>
</li>
<li><p>7ã€æœ€åå†è¯´ä¸€ä¸ªå‰ªæå„¿ï¼Œä¸æ˜¯å¿…è¦æ€§çš„ï¼Œä½†æ˜¯ç¡®å®å¯ä»¥åŠ å¿«é€Ÿåº¦ã€‚å°±æ˜¯æˆ‘ä»¬å†æ¯æ¬¡éå†$7 \times 5$çš„æ—¶å€™ï¼Œé‡åˆ°ç©ºç™½çš„ï¼Œä¸æ˜¯<code>continue</code>è€Œæ˜¯<code>break</code>ï¼Œå› ä¸ºæˆ‘ä»¬$down$ä¸€å®šæ˜¯å®Œå¤‡çš„ï¼Œå³ä»ä¸‹å‘ä¸Šæšä¸¾æ—¶ï¼Œå¦‚æœä¸‹æ–¹çš„å·²ç»clearäº†ï¼Œä¸Šæ–¹çš„ä¸å¯èƒ½æ‚¬ç©ºã€‚æ‰€ä»¥å¯ä»¥å°‘å¥½å‡ æ¬¡ç©ºéå†ã€‚</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">D</span>&#123;</span> <span class="keyword">int</span> x, y ;&#125; ; <span class="built_in">stack</span> &lt;D&gt; s ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ans</span>&#123;</span> <span class="keyword">int</span> x, y, d  ;&#125; res[<span class="number">100</span>] ; <span class="keyword">int</span> Remove[<span class="number">50</span>][<span class="number">50</span>] ;</span><br><span class="line"><span class="keyword">int</span> N, T[<span class="number">30</span>][<span class="number">30</span>], base[<span class="number">4000</span>][<span class="number">10</span>][<span class="number">10</span>], qwq[<span class="number">4000</span>][<span class="number">30</span>], color[<span class="number">30</span>], i, j, t, tot ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">  ....</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">down</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ttt = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> di = <span class="number">1</span> ; di &lt;= <span class="number">5</span> ; ++ di)&#123;</span><br><span class="line">        ttt = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> dj = <span class="number">1</span> ; dj &lt;= <span class="number">7</span> ; ++ dj)</span><br><span class="line">            <span class="keyword">if</span>(T[di][dj] == <span class="number">-1</span>) ++ ttt ;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(! ttt) <span class="keyword">continue</span> ;</span><br><span class="line">                T[di][dj - ttt] = T[di][dj], T[di][dj] = <span class="number">-1</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">remove</span><span class="params">()</span></span>&#123; <span class="comment">// void -&gt; bool</span></span><br><span class="line">    <span class="keyword">bool</span> Mark = <span class="number">0</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(Remove, <span class="number">0</span>, <span class="keyword">sizeof</span>(Remove)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> di = <span class="number">1</span> ; di &lt;= <span class="number">5</span> ; ++ di)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> dj = <span class="number">1</span> ; dj &lt;= <span class="number">7</span> ; ++ dj)&#123;</span><br><span class="line">            <span class="keyword">if</span> (T[di][dj] != <span class="number">-1</span> &amp;&amp; di &gt;= <span class="number">2</span> &amp;&amp; di &lt;= <span class="number">4</span> </span><br><span class="line">                &amp;&amp; T[di][dj] == T[di + <span class="number">1</span>][dj] &amp;&amp; T[di][dj] == T[di - <span class="number">1</span>][dj])&#123;</span><br><span class="line">                Remove[di + <span class="number">1</span>][dj] = Remove[di - <span class="number">1</span>][dj] = Remove[di][dj] = <span class="number">1</span>, </span><br><span class="line">                Mark = <span class="number">1</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (T[di][dj] != <span class="number">-1</span> &amp;&amp; dj &gt;= <span class="number">2</span> &amp;&amp; dj &lt;= <span class="number">6</span> </span><br><span class="line">                &amp;&amp; T[di][dj] == T[di][dj + <span class="number">1</span>] &amp;&amp; T[di][dj] == T[di][dj - <span class="number">1</span>])&#123;</span><br><span class="line">                Remove[di][dj + <span class="number">1</span>] = Remove[di][dj - <span class="number">1</span>] = Remove[di][dj] = <span class="number">1</span>, </span><br><span class="line">                Mark = <span class="number">1</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (!Mark) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> di = <span class="number">1</span> ; di &lt;= <span class="number">5</span> ; ++ di)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> dj = <span class="number">1</span> ; dj &lt;= <span class="number">7</span> ; ++ dj)</span><br><span class="line">            T[di][dj] = (!Remove[di][dj]) ? T[di][dj] : <span class="number">-1</span> ;</span><br><span class="line">    down() ; <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">judge</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> di = <span class="number">1</span> ; di &lt;= <span class="number">5</span> ; ++ di)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> dj = <span class="number">1</span> ; dj &lt;= <span class="number">7</span> ; ++ dj)</span><br><span class="line">            <span class="keyword">if</span> (T[di][dj] != <span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Prepare</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="comment">//copy</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> di = <span class="number">1</span> ; di &lt;= <span class="number">5</span> ; ++ di)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> dj = <span class="number">1</span> ; dj &lt;= <span class="number">7</span> ; ++ dj)</span><br><span class="line">            base[x][di][dj] = T[di][dj] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _reset(<span class="keyword">int</span> x)&#123;<span class="comment">//copy_back</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> di = <span class="number">1</span> ; di &lt;= <span class="number">5</span> ; ++ di)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> dj = <span class="number">1</span> ; dj &lt;= <span class="number">7</span> ; ++ dj)</span><br><span class="line">            T[di][dj] = base[x][di][dj] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs_work</span><span class="params">(<span class="keyword">int</span> step)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (judge())&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> di = <span class="number">1</span> ; di &lt;= N ; ++ di)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d %d %d\n"</span>, res[di].x, res[di].y, res[di].d) ;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (step == N + <span class="number">1</span>) <span class="keyword">return</span> ; Prepare(step) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> di = <span class="number">1</span> ; di &lt;= <span class="number">5</span> ; ++ di)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> dj = <span class="number">1</span> ; dj &lt;= <span class="number">7</span> ; ++ dj)&#123;</span><br><span class="line">            <span class="keyword">if</span> (T[di][dj] == <span class="number">-1</span>) <span class="keyword">break</span> ;</span><br><span class="line">            <span class="keyword">if</span> (di &gt; <span class="number">1</span> &amp;&amp; T[di - <span class="number">1</span>][dj] == <span class="number">-1</span>)&#123;</span><br><span class="line">                swap(T[di][dj], T[di - <span class="number">1</span>][dj]) ; down() ; <span class="keyword">while</span> (remove()) ;</span><br><span class="line">                res[step] = (Ans)&#123;di - <span class="number">1</span>, dj - <span class="number">1</span>, <span class="number">-1</span>&#125; ; </span><br><span class="line">                dfs_work(step + <span class="number">1</span>) ; _reset(step) ; res[step] = (Ans)&#123;<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>&#125; ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (di &lt; <span class="number">5</span> &amp;&amp; T[di][dj] != T[di + <span class="number">1</span>][dj])&#123;</span><br><span class="line">                swap(T[di][dj], T[di + <span class="number">1</span>][dj]) ; down() ; <span class="keyword">while</span>(remove()) ;</span><br><span class="line">                res[step] = (Ans)&#123;di - <span class="number">1</span>, dj - <span class="number">1</span> ,<span class="number">1</span>&#125; ; </span><br><span class="line">                dfs_work(step + <span class="number">1</span>) ; _reset(step) ; res[step] = (Ans)&#123;<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>&#125; ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ; <span class="built_in">memset</span>(T, <span class="number">-1</span>, <span class="keyword">sizeof</span>(T)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= <span class="number">5</span> ; ++ i) T[i][<span class="number">0</span>] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= <span class="number">5</span> ; ++ i)</span><br><span class="line">        <span class="keyword">while</span>((t = qr()) != <span class="number">0</span>) T[i][++ T[i][<span class="number">0</span>]] = t ;</span><br><span class="line">    dfs_work(<span class="number">1</span>) ; <span class="built_in">cout</span> &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="text-Afterwords"><a href="#text-Afterwords" class="headerlink" title="$\text{Afterwords}$"></a>$\text{Afterwords}$</h1><p>â€œ</p>
<p>å‡†ç¡®æ¥è¯´ï¼Œæ²¡æœ‰äººåœ¨åˆ°è¾¾ä¹‹å‰çŸ¥é“è‡ªå·±åˆ°åº•è¦å»å“ªå„¿ã€‚</p>
<p>â€</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Luogu</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/æ™®é€šDP</tag>
        <tag>è´ªå¿ƒ</tag>
        <tag>å¥‡æ€ªçš„æŠ€å·§</tag>
        <tag>NOIPç³»åˆ—</tag>
        <tag>æœç´¢/å‰ªæ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘NOIP2017æ³›åš</title>
    <url>/2019/07/11/NOIP2017/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>$NOIP2017$çš„æ³›åšã€‚</p>
<a id="more"></a>
<h1 id="Omega"><a href="#Omega" class="headerlink" title="$\Omega$"></a>$\Omega$</h1><p>å—¯ï¼Œè¿™ä¸ªä»£è¡¨â€œå‰è¨€â€çš„å­—æ¯å¾ˆå¸…ã€‚</p>
<p>å…ˆæ¥æ€»ç»“ä¸€ä¸‹æ¯ä¸ªé¢˜çš„éš¾åº¦ï¼ŒAé¢˜<code>æé«˜ï¼ˆè¯æ˜ï¼‰/æ™®åŠ-ï¼ˆæ‰¾è§„å¾‹ï¼‰</code>, Bé¢˜<code>æé«˜</code>ï¼Œ Cé¢˜<code>æé«˜+</code>ï¼Œæ€»ç»“æ¥çœ‹ï¼ŒDay1æ¯”è¾ƒé€ï¼›Dé¢˜<code>æ™®åŠ+</code>ï¼ŒEé¢˜<code>çœé€‰-</code>ï¼ŒFé¢˜<code>çœé€‰-</code>ï¼ŒDay2ä¸å¦‚Day1æ°´ã€‚</p>
<p>PS: <code>æé«˜</code>ä»¥NOIPæé«˜ç»„å¹³å‡éš¾åº¦ä¸ºå‡†ï¼Œ<code>çœé€‰</code>ä»¥å¼±çœçœé€‰ä¸ºå‡†ï¼ˆæ¯”å¦‚ä»¥<code>SNOI2019</code>å¹³å‡éš¾åº¦ä½œä¸ºåŸºå‡†çº¿ï¼‰</p>
<h1 id="A"><a href="#A" class="headerlink" title="$A$"></a>$A$</h1><p>ç”±äºå½“æ—¶åœºä¸Šåˆ‡äº†è¿™é“é¢˜ï¼Œå¯¼è‡´æˆ‘å¯¹â€œæ‰¾è§„å¾‹â€œè¿™ç§æŠ•æœºå–å·§çš„åšé¢˜æ–¹å¼æƒ…æœ‰ç‹¬é’Ÿï¼Œä»è€Œåœ¨æŸäº›è®¡æ•°é¢˜æ—¶ä¸å¥½å¥½æƒ³DPåè€ŒçŒœsbè§„å¾‹â€¦â€¦æ„Ÿè§‰å¾ˆGGâ€¦â€¦</p>
<p>å…¶å®è¿™ä¸ªé¢˜å°±æ˜¯ç»™ä¸€ä¸ªæ–¹ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
ax+by \not= t \quad x,y, \in\mathbb{N},\quad t\in \mathbb{N+} \quad (a,b)= 1</script><p>æ±‚$\max{t}$</p>
<p>å‘ƒï¼Œé¦–å…ˆï¼Œæˆ‘æƒ³äº†ä¸€ç§å¾ˆzzçš„è¯æ˜æ–¹å¼ï¼š</p>
<ul>
<li><p>å½“$t = a \cdot b - a - b$æ—¶ï¼Œ$t$æ»¡è¶³è¿™ä¸ªæ–¹ç¨‹</p>
<ul>
<li><p>æˆ‘ä»¬é€šè¿‡ç§»é¡¹å¯ä»¥å¾—åˆ°ï¼š</p>
</li>
<li><script type="math/tex; mode=display">
ax+by-ab+a+b=0 \\\
a(x-b +1) + b(y+1) = 0 \\\</script></li>
<li><p>è§‚å¯Ÿè¿™ä¸ªå¼å­ï¼Œè¦ä¹ˆæœ‰$y+1=0$ä¸”$x-b+1=0$ï¼Œè¦ä¹ˆæœ‰</p>
<script type="math/tex; mode=display">
a(b-x-1) = b(y+1)\cdots(1)</script></li>
<li>ç¬¬ä¸€ç§æƒ…å†µæ˜¾ç„¶ä¸æˆç«‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘ç¬¬äºŒç§æƒ…å†µã€‚æ­¤æ—¶å› ä¸º$(a,b)=1$ï¼Œæ‰€ä»¥ä¼šæœ‰$b~|~(b-x-1) \to b ~|~(x+1)$, åŒç†$a~|~(y+1)$ .ä½†åŒæ—¶æˆ‘ä»¬å°†$(1)$å¼æä¸€æå°±å¯ä»¥å¾—åˆ°<script type="math/tex">\frac{a}{b} = \frac{b-(x+1)}{y+1}</script>ä½†å› ä¸º$a,b \in \mathbb{N+}$ï¼Œæ‰€ä»¥ä¼šæœ‰$b&gt;(x+1)$ ; å› ä¸º$b~|~(x+1)$ï¼Œæœ‰$b\leq x+1$æˆ–$x+1=0$ï¼ˆèˆï¼‰ ï¼ŒçŸ›ç›¾ï¼Œæ•…æ­¤æ—¶$t$æ»¡è¶³è¿™ä¸ªæ–¹ç¨‹ã€‚</li>
</ul>
</li>
<li><p>å½“$t&gt;a\cdot b-a-b$æ—¶ï¼Œ$t$æ€»ä¸æ»¡è¶³ã€‚</p>
<blockquote>
<p>ä¸å¦¨è®¾$t_0=a\cdot b-a-b, ~t=t_0+k, ~k\in\mathbb{N+}$</p>
<p>æ­¤æ—¶â€¦â€¦ç„¶åå°±ä¸ä¼šäº†2333â€”â€”ä»¥ä¸‹æ˜¯å€Ÿé‰´çš„<a href="https://www.cnblogs.com/xxzh/p/9178564.html" target="_blank" rel="noopener">æ˜Ÿæ˜Ÿä¹‹ç«OIer</a>å·¨ä½¬çš„æ€è·¯ï¼š</p>
</blockquote>
</li>
<li><p>å¯¹äºä»»æ„æ­£æ•´æ•°$k\geq abâˆ’aâˆ’b+1$ï¼Œå³$k+a+b\geq ab+1$</p>
<ul>
<li>è®¾$k+a+b = \mu a+m~~(k\geq b,1\leq m &lt;a)$. åŒæ—¶ï¼š<script type="math/tex; mode=display">
\because (a,b)=1\\\
\therefore \exists x_0,y_0 \in \mathbb{Z} \quad s.t. \quad ax_0+by_0=1 \\\
\therefore \exists x_1,y_1âˆˆ\mathbb{Z}ï¼Œâˆ’(bâˆ’1)\leq x_1\leq 0 \quad s.t.\quad  ax_1+by_1=m\\\</script>è¿™é‡Œçš„æ„æ€å…¶å®æ˜¯è®¾$âˆ’(bâˆ’1)\leq x_1\leq 0$ï¼Œä¸€å®šå­˜åœ¨æ•´æ•°$y_1$ä½¿å¾—$ax_1+by+_1=m$æˆç«‹ã€‚åŸå› å°±æ˜¯åœ¨æ•´æ•°$x_1$çš„å–å€¼ä¸­ä¸€å…±æœ‰$b$ä¸ªæ•°ï¼Œ$y_1=(mâˆ’ax_1)/b$ï¼Œæ ¹æ®é¸½ç¬¼åŸç†ä¹‹ç±»çš„zzå®šç†ï¼Œæˆ‘ä»¬æ€»æ˜¯å¯ä»¥æ‰¾åˆ°$x_1$ä½¿å¾—$mâˆ’ax_1$èƒ½è¢«$b$æ•´é™¤ã€‚</li>
</ul>
</li>
</ul>
<p>æ˜¾ç„¶ï¼Œ$y_1\geq 1(ax_1\leq 0,m &gt;0, b&gt;0, å› æ­¤y_1\geq 1,)$ã€‚äºæ˜¯ï¼Œå–$x=\mu+x_1âˆ’1,y=y_1âˆ’1$ã€‚æ³¨æ„åˆ°$x_1,y_1$çš„å–å€¼èŒƒå›´ï¼Œå¾—$x,y\geq 0$ï¼Œ å³æœ‰$ax+by=k$</p>
<hr>
<p>ï¼Ÿï¼Ÿï¼Ÿä¸çŸ¥ä¸è§‰å†™äº†å°åŠä¸ªä¸‹åˆï¼Ÿï¼Ÿçœ‹èµ·æ¥Aé¢˜ç¡®å®æ˜¯ç»“è®ºé¢˜äº†ï¼ˆsigh</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">long</span> <span class="keyword">long</span>  A, B ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; A &gt;&gt; B ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; A * B - A - B ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="B"><a href="#B" class="headerlink" title="$B$"></a>$B$</h1><p> â€¦â€¦åƒè¿™ç§é¢˜ä¸å°±æ˜¯çœ‹è„¸é¢˜å—â€¦æ‰‹ä¸€æŠ–å°±è°ƒä¸å‡ºæ¥äº†$\rm{qaq}$</p>
<p>é¢˜è§£ä»¥å‰å†™è¿‡ï¼Œäºæ˜¯ç›´æ¥æŠŠä¸»è¦éƒ¨åˆ†å¼•ç”¨è¿‡æ¥ï¼ˆä»¥å‰çš„ç é£è¿˜çœŸæ˜¯æŠ½æ</p>
<blockquote>
<p><strong>è¯»å…¥</strong>ï¼š</p>
<p>æˆ‘ä»¬å…ˆç”¨$while$æŒ‰å­—ç¬¦è¯»å…¥æ¯ä¸ªç¨‹åºçš„ç¬¬ä¸€è¡Œï¼ŒæŠ å‡ºéœ€è¦æ£€éªŒçš„å¤æ‚åº¦ï¼Œ$O(1)$ç”¨$0$æ¥å­˜$[n^0=1  $ $~~~$ $ (n!=0)]$.</p>
<p>æ³¨æ„ï¼Œæœ‰å¯èƒ½æœ‰ä¸¤ä½æ•°ï¼Œéœ€è¦å¤šæ‰£ä¸€ä½â€¦â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">&gt;	  <span class="keyword">while</span>(o!=<span class="string">')'</span>)&#123;</span><br><span class="line">&gt;    	<span class="keyword">if</span>(o==<span class="string">'1'</span>&amp;&amp;!chk) </span><br><span class="line">&gt;			   need_check=<span class="number">0</span>;</span><br><span class="line">&gt;    	<span class="keyword">if</span>(o==<span class="string">'n'</span>)&#123;</span><br><span class="line">&gt;    	   <span class="built_in">cin</span>&gt;&gt;o&gt;&gt;o;</span><br><span class="line">&gt;          need_check=o<span class="number">-48</span>;</span><br><span class="line">&gt;			   chk=<span class="number">1</span>;</span><br><span class="line">&gt;			&#125;</span><br><span class="line">&gt;       o=getchar();</span><br><span class="line">&gt;       <span class="keyword">if</span>(<span class="built_in">isdigit</span>(o)&amp;&amp;chk)need_check*=<span class="number">10</span>,need_check+=(o<span class="number">-48</span>); </span><br><span class="line">&gt;  &#125;</span><br><span class="line">&gt;  getchar();</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>è‡³äºæœ€åä¸ºä»€ä¹ˆè¦å†$gatchar()$ä¸€æ¬¡â€¦â€¦è‡ªå·±è¯•è¯•å°±çŸ¥é“äº†ã€‚</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±è¦æŒ‰è¡Œè¯»å…¥å¾ªç¯äº†ï¼Œæ¯”è¾ƒç®€å•ã€‚</p>
<p><strong>åˆå§‹åŒ–</strong>ï¼š</p>
<p>ä¸ºäº†ä½¿ç é£ç®€æ´ï¼Œæ‰€ä»¥å†™åˆ°å‡½æ•°é‡Œäº†ã€‚è¿™ä¸ªåœ°æ–¹æˆ‘ç”¨åˆ°äº†ä¸‰ä¸ªæ ˆï¼Œä¸€ä¸ªç”¨æ¥è®°å½•æ¯ä¸ªå¾ªç¯çš„ç­”æ¡ˆï¼ˆå› ä¸ºæœ‰å¯èƒ½æœ‰å¤šä¸ªç›¸äº’ç‹¬ç«‹çš„å¾ªç¯ï¼‰ï¼Œä¸€ä¸ªç”¨æ¥è®°å½•æ¯æ¬¡$F$æ—¶è¯»å…¥çš„å¾ªç¯ä¸Šä¸‹ç•Œã€‚ä»¥ä¸Šä¸¤ä¸ªéƒ½æ˜¯$int$æ ˆ,è¿˜æœ‰ä¸€ä¸ª$char$æ ˆï¼Œå­˜å‚¨æ¯æ¬¡å®šä¹‰çš„å¾ªç¯å˜é‡ï¼Œè€Œè¿™ä¸ªå­—ç¬¦æ ˆæ­é…ä¸€ä¸ª$bool$æ€§çš„æ•°ç»„ï¼Œç”¨äºè®°å½•æ˜¯å¦å¯ç”¨ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">&gt;<span class="meta">#<span class="meta-keyword">define</span> MAX 1000000</span></span><br><span class="line">&gt;<span class="keyword">int</span> i,x,y,t,tt,num,cntf,cnte,res,ans[MAX],T,l,now,need_checks,stk[MAX];</span><br><span class="line">&gt;<span class="keyword">bool</span> check[<span class="number">150</span>],flag,spj,chk;</span><br><span class="line">&gt;<span class="keyword">char</span> s[<span class="number">3010</span>],o,stkk[MAX]; </span><br><span class="line">&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">&gt;	<span class="built_in">memset</span>(check,<span class="number">0</span>,<span class="keyword">sizeof</span>(check));</span><br><span class="line">&gt;<span class="built_in">memset</span>(stkk,<span class="number">0</span>,<span class="keyword">sizeof</span>(stkk));</span><br><span class="line">&gt;<span class="built_in">memset</span>(stk,<span class="number">0</span>,<span class="keyword">sizeof</span>(stk));</span><br><span class="line">&gt;now=t=tt=cntf=cnte=res=flag=spj=chk=<span class="number">0</span>;</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<p>$ps:$è™½ç„¶ä¸çŸ¥é“ç”¨ä¸€ä¸ªäºŒè¿›åˆ¶ä½çš„$0$æ¥åˆå§‹åŒ–å­—ç¬¦æ•°ç»„ä¼šæ€æ ·â€¦â€¦ä¸è¿‡å¥½åƒæµ·æ˜Ÿã€‚</p>
<p>$cnte$å’Œ$cntf$ç”¨æ¥è®°å½•$F$å’Œ$E$çš„æ•°é‡ï¼Œ$num$ã€$t$ã€$tt$éƒ½æ˜¯æ ˆçš„æŒ‡é’ˆï¼Œ$spj$ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªç‹¬ç«‹å¾ªç¯æ˜¯å¦ç»“æŸï¼ˆå¦‚æœç»“æŸå°±æŠŠå½“å‰çš„å¾—åˆ°å‹å…¥æ ˆï¼‰,$now$ç”¨æ¥æ­é…$spj$è®°å½•å½“å‰ç‹¬ç«‹å¾ªç¯ä½“çš„æ—¶é—´å¤æ‚åº¦ï¼Œ $chk$ç”¨äºè¯»å…¥æ¯ä¸ªç¨‹åºçš„ç¬¬ä¸€è¡Œï¼ˆå³å«æœ‰éœ€è¦åˆ¤æ–­çš„æ—¶é—´å¤æ‚åº¦çš„é‚£ä¸€è¡Œï¼‰ï¼Œ$flag$ç”¨äºåˆ¤æ–­è¾“å‡ºã€‚</p>
<p><strong>ä¸»è¦æ“ä½œ</strong></p>
<p>å¯¹äºè¯»å…¥çš„ä¸œè¥¿ï¼Œåˆ†ç±»è®¨è®ºï¼Œç„¶å$continue$â€¦â€¦æ²¡ä»€ä¹ˆå¯è¯´çš„ã€‚<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">&gt;	   <span class="keyword">while</span>(l--)&#123;</span><br><span class="line">&gt;     gets(s);</span><br><span class="line">&gt;     <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(s);)&#123;</span><br><span class="line">&gt;      		<span class="keyword">while</span>(s[i]==<span class="string">' '</span>)i++;</span><br><span class="line">&gt;				<span class="keyword">if</span>(s[i]==<span class="string">'F'</span>)&#123;</span><br><span class="line">&gt;					<span class="keyword">if</span>(cntf&gt;cnte&amp;&amp;cnte)&#123;</span><br><span class="line">&gt;						ans[++num]=now;</span><br><span class="line">&gt;						now=<span class="number">0</span>;</span><br><span class="line">&gt;					&#125;</span><br><span class="line">&gt;           	cntf++,i++;</span><br><span class="line">&gt;           	<span class="keyword">continue</span>;</span><br><span class="line">&gt;       	&#125;</span><br><span class="line">&gt;       	<span class="keyword">if</span>(s[i]==<span class="string">'E'</span>)&#123;</span><br><span class="line">&gt;       		y=stk[t],t--;</span><br><span class="line">&gt;					x=stk[t],t--;</span><br><span class="line">&gt;           	cnte++;</span><br><span class="line">&gt;           	<span class="keyword">if</span>(cnte==cntf)spj=<span class="number">1</span>;</span><br><span class="line">&gt;           	<span class="keyword">if</span>(x!=MAX)&#123;</span><br><span class="line">&gt;           		<span class="keyword">if</span>(y==MAX)now++;</span><br><span class="line">&gt;           		<span class="keyword">if</span>(y&lt;x)now=<span class="number">0</span>;</span><br><span class="line">&gt;           	&#125;</span><br><span class="line">&gt;           	<span class="keyword">else</span>&#123;</span><br><span class="line">&gt;           		<span class="keyword">if</span>(y!=MAX)now=<span class="number">0</span>;</span><br><span class="line">&gt;           	&#125;</span><br><span class="line">&gt;           	check[stkk[tt]-<span class="string">'a'</span>]=<span class="number">0</span>;</span><br><span class="line">&gt;           	tt--,i++;</span><br><span class="line">&gt;           	<span class="keyword">if</span>(spj)&#123;</span><br><span class="line">&gt;           		ans[++num]=now;</span><br><span class="line">&gt;						now=<span class="number">0</span>;</span><br><span class="line">&gt;						spj=<span class="number">0</span>;</span><br><span class="line">&gt;           	&#125;</span><br><span class="line">&gt;					<span class="keyword">continue</span>;</span><br><span class="line">&gt;       	&#125;</span><br><span class="line">&gt;           <span class="keyword">if</span>(!<span class="built_in">isdigit</span>(s[i])&amp;&amp;s[i]!=<span class="string">'n'</span>)&#123;</span><br><span class="line">&gt;           	<span class="keyword">if</span>(check[s[i]-<span class="string">'a'</span>]&amp;&amp;!flag)&#123; </span><br><span class="line">&gt;           	<span class="built_in">cout</span>&lt;&lt;<span class="string">"ERR"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&gt;           	flag=<span class="number">1</span>;</span><br><span class="line">&gt;					&#125;</span><br><span class="line">&gt;           	stkk[++tt]=s[i];</span><br><span class="line">&gt;           	check[s[i]-<span class="string">'a'</span>]=<span class="number">1</span>;</span><br><span class="line">&gt;           &#125;</span><br><span class="line">&gt;       	<span class="keyword">else</span> &#123;  </span><br><span class="line">&gt;           	<span class="keyword">if</span>(s[i]==<span class="string">'n'</span>)&#123;</span><br><span class="line">&gt;       		my_push(s[i],s[i+<span class="number">1</span>]);</span><br><span class="line">&gt;					i+=<span class="number">2</span>;</span><br><span class="line">&gt;           &#125;               </span><br><span class="line">&gt;           my_push(s[i],s[i+<span class="number">1</span>]);</span><br><span class="line">&gt;           &#125;</span><br><span class="line">&gt;       	i++;</span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt;  &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>å”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯å…¥æ ˆæ“ä½œï¼Œå› ä¸ºè¦æŠŠå­—ç¬¦å‹å…¥æ•´å‹ï¼Œæ‰€ä»¥æˆ‘åˆå†™äº†ä¸ªå‡½æ•°æ¥å…¥æ ˆã€‚å…¥æ ˆçš„æ—¶å€™å½“ç„¶éœ€è¦æ³¨æ„æ˜¯ä¸æ˜¯ä¸¤ä½æ•°â€¦â€¦</p>
<p>å“¦ï¼Œè¿˜æœ‰ï¼Œå¦‚æœè¿™æ¬¡è½®åˆ°$n$å…¥æ ˆäº†ï¼Œé‚£ä¹ˆå°±éšä¾¿å…¥æ ˆä¸€ä¸ªå¤§äºä¸€ç™¾çš„æ•°å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">&gt;<span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">my_push</span><span class="params">(<span class="keyword">char</span> a,<span class="keyword">char</span> b)</span></span>&#123;</span><br><span class="line">&gt;	<span class="keyword">if</span>(<span class="built_in">isdigit</span>(a))&#123;</span><br><span class="line">&gt;		<span class="keyword">if</span>(<span class="built_in">isdigit</span>(b))&#123;</span><br><span class="line">&gt;			stk[++t]=(a<span class="number">-48</span>)*<span class="number">10</span>+b<span class="number">-48</span>;</span><br><span class="line">&gt;			i++;</span><br><span class="line">&gt;		&#125;</span><br><span class="line">&gt;		<span class="keyword">else</span> stk[++t]=a<span class="number">-48</span>; </span><br><span class="line">&gt;	&#125;</span><br><span class="line">&gt;	<span class="keyword">if</span>(a==<span class="string">'n'</span>)stk[++t]=MAX;</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<p>æœ€ååˆ¤æ–­ä¸€ä¸‹è¾“å…¥è¾“å‡ºå³å¯</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">&gt;	   <span class="keyword">if</span>(!flag&amp;&amp;cntf!=cnte)&#123;</span><br><span class="line">&gt;     <span class="built_in">cout</span>&lt;&lt;<span class="string">"ERR"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&gt;     flag=<span class="number">1</span>;</span><br><span class="line">&gt;  &#125;</span><br><span class="line">&gt;	   <span class="keyword">while</span>(num)&#123;</span><br><span class="line">&gt;  	   res=max(res,ans[num]); </span><br><span class="line">&gt;  	   num--;</span><br><span class="line">&gt;  &#125;</span><br><span class="line">&gt;  <span class="keyword">if</span>(!flag) <span class="keyword">if</span>(res==need_check) <span class="built_in">cout</span>&lt;&lt;<span class="string">"Yes"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&gt;  			 <span class="keyword">else</span> 				 <span class="built_in">cout</span>&lt;&lt;<span class="string">"No"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>å—¯~o(<em>ï¿£â–½ï¿£</em>)oè¿™å°±æ˜¯æ»¡åˆ†åšæ³•äº†ã€‚</p>
</blockquote>
<p>å”‰ï¼Œæ—¶å…‰ä¸€å»ä¸å¤è¿”å•Šã€‚</p>
<h1 id="C"><a href="#C" class="headerlink" title="$C$"></a>$C$</h1><p>â€¦â€¦å…¶å®ä¸ç®—æ˜¯ä¸ªæ–°é¢˜ï¼Œåªæ˜¯ä¼¼ä¹å½“æ—¶è¿™é“é¢˜åœºä¸Šå¾ˆå¡å¸¸ï¼Ÿæ„Ÿè§‰å°±æ˜¯å¥½å¤šä¸œè¥¿çš„æ‚ç³…ï¼Œå…ˆSPFAåˆ¤ä¸ªå…¨$0$ç¯ï¼Œå†å€’ç€è®°æœä¸€éâ€¦â€¦æ„Ÿè§‰å·²ç»ä¸ç®—ä»€ä¹ˆæ–°é¢˜äº†ï¼ŒT3å‡ºæˆè¿™æ ·æ„Ÿè§‰å¾ˆå¤±æœ›qaqâ€¦â€¦</p>
<p>ä½†æ€ä¹ˆè¯´å‘¢ï¼Œä¹Ÿæ˜¯ä¸ªç»ƒä¹ ç åŠ›çš„æœºä¼šå§ï¼Œè½¬ç§»æ–¹ç¨‹æŒºå¥½æƒ³çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">deque</span> &lt;<span class="keyword">int</span>&gt; q ;  </span><br><span class="line"><span class="built_in">bitset</span> &lt;MAXN&gt; vis ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> fr, to, next, v ;</span><br><span class="line">&#125;E[MAXM] ; <span class="keyword">int</span> head[MAXN][<span class="number">2</span>], cnt ;</span><br><span class="line"><span class="keyword">int</span> T, N, L, M, K, P, A, B, C, ss[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> Es[MAXM][<span class="number">2</span>], dfn[MAXN], low[MAXN], tot ; </span><br><span class="line"><span class="keyword">bool</span> flag ; LL Ans, dp[MAXN][MAXK], dist[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Add(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)&#123;</span><br><span class="line">	E[++ cnt].to = v, E[cnt].v = w, E[cnt].next = head[u][<span class="number">1</span>], head[u][<span class="number">1</span>] = cnt ; </span><br><span class="line">	E[++ cnt].to = u, E[cnt].v = w, E[cnt].next = head[v][<span class="number">0</span>], head[v][<span class="number">0</span>] = cnt ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">register</span> <span class="keyword">int</span> k ; </span><br><span class="line">	vis.reset() ;</span><br><span class="line">	<span class="built_in">memset</span>(dp, <span class="number">-63</span>, <span class="keyword">sizeof</span>(dp)), cnt = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt;= L + <span class="number">3</span> ; ++ k) </span><br><span class="line">		dist[k] = Inf, ss[k] = head[k][<span class="number">1</span>] = head[k][<span class="number">0</span>] = <span class="number">0</span> ; 		</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">SPFA</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">register</span> <span class="keyword">int</span> now, k ; </span><br><span class="line">	q.push_front(<span class="number">1</span>), vis[<span class="number">1</span>] = <span class="number">1</span>, dist[<span class="number">1</span>] = <span class="number">0</span>, ++ ss[<span class="number">1</span>] ;</span><br><span class="line">	<span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">		now = q.front(), vis[now] = <span class="number">0</span>, q.pop_front() ;</span><br><span class="line">		<span class="keyword">for</span> (k = head[now][<span class="number">1</span>] ; k ; k = E[k].next)&#123;</span><br><span class="line">			<span class="keyword">if</span> (dist[to(k)] &gt;= dist[now] + E[k].v)&#123;</span><br><span class="line">				++ ss[to(k)] ; </span><br><span class="line">				dist[to(k)] = dist[now] + E[k].v ;</span><br><span class="line">				<span class="keyword">if</span> (ss[to(k)] &gt;= N)&#123; flag = <span class="number">1</span> ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">				<span class="keyword">if</span> (!vis[to(k)])&#123;</span><br><span class="line">					<span class="keyword">if</span> (q.empty() || dist[to(k)] &lt; dist[q.front()]) </span><br><span class="line">						q.push_front(to(k)) ; <span class="keyword">else</span> q.push_back(to(k)) ; vis[to(k)] = <span class="number">1</span> ;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;  </span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">dp_work</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> op)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (dp[now][op] &gt;= <span class="number">0</span>) <span class="keyword">return</span> dp[now][op] ; dp[now][op] = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> k = head[now][<span class="number">0</span>] ; k ; k = E[k].next)&#123;</span><br><span class="line">		LL t = op - dist[to(k)] + dist[now] - E[k].v ; </span><br><span class="line">		<span class="keyword">if</span> (t &gt; K || t &lt; <span class="number">0</span>) <span class="keyword">continue</span> ; dp[now][op] = (dp[now][op] + dp_work(to(k), t)) % P ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> dp[now][op] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">register</span> <span class="keyword">int</span> i ; <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">	<span class="keyword">while</span>(T --)&#123;</span><br><span class="line">		L = <span class="number">200000</span>, Init() ; Ans = <span class="number">0</span> ;</span><br><span class="line">		N = qr(), M = qr(), K = qr(), P = qr() ;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) A = qr(), B = qr(), C = qr(), _Add(A, B, C) ;</span><br><span class="line">		SPFA() ; dp[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span> ; L = N ; <span class="keyword">if</span> (flag) &#123; flag = <span class="number">0</span>, <span class="built_in">printf</span>(<span class="string">"-1\n"</span>) ; <span class="keyword">continue</span> ; &#125; </span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= K ; ++ i) Ans = (Ans + dp_work(N, i)) % P ; <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, Ans) ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æƒ³äº†ä¸€ä¸‹ï¼Œä¼¼ä¹å‡ºé¢˜äººæ˜¯æ•…æ„æŠŠæ—¶é—´æŠ¼ç»™$B$çš„ï¼Œæ‰€ä»¥$C$æ¯”è¾ƒé€ã€‚</p>
<h1 id="D"><a href="#D" class="headerlink" title="$D$"></a>$D$</h1><p>ä¹Ÿæ˜¯æŒºé€çš„ä¸€é“é¢˜ï¼Œæ³¨æ„å¼€<code>long long</code>å°±å¥½â€¦ç”¨å¹¶æŸ¥é›†ç»´æŠ¤ä¸€ä¸‹æœ€ä¸Šé¢å’Œæœ€ä¸‹é¢çš„ä¸¤ä¸ªæ´åœ¨ä¸åœ¨ä¸€æ¡â€œè¿é€šé“¾â€ä¸Šå³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">hole</span>&#123;</span></span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> x,y,z;</span><br><span class="line">&#125;c[<span class="number">10001</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">long</span> <span class="keyword">long</span> <span class="title">find</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(f[a]!=a)a=find(f[a]);</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">unionn</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> xz,<span class="keyword">long</span> <span class="keyword">long</span>  yz)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(c[find(yz)].z&gt;c[find(xz)].z) f[find(yz)]=f[find(xz)];</span><br><span class="line">	<span class="keyword">else</span> f[find(xz)]=f[find(yz)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(hole a,hole b)</span>z</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> d;</span><br><span class="line">    d=(a.z-b.z)*(a.z-b.z)+(a.y-b.y)*(a.y-b.y)+(a.x-b.x)*(a.x-b.x);</span><br><span class="line">    <span class="keyword">if</span>(d&lt;=<span class="number">4</span>*r*r)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;t;</span><br><span class="line">	<span class="keyword">while</span>(t--)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(<span class="number">0</span>));</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;h&gt;&gt;r;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	    &#123;</span><br><span class="line">	    	<span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>,&amp;c[i].x,&amp;c[i].y,&amp;c[i].z);</span><br><span class="line">	    	f[i]=i;</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	     <span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> j=i+<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">	      <span class="keyword">if</span>(f[i]!=f[j]&amp;&amp;check(c[i],c[j]))unionn(i,j);</span><br><span class="line">	    <span class="keyword">bool</span> cc=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	      <span class="keyword">if</span>(c[i].z+r&gt;=h&amp;&amp;c[find(i)].z-r&lt;=<span class="number">0</span>)</span><br><span class="line">		  &#123;</span><br><span class="line">		  	cc=<span class="number">1</span>;</span><br><span class="line">		  	<span class="built_in">cout</span>&lt;&lt;<span class="string">"Yes"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		    <span class="keyword">break</span>;</span><br><span class="line">		  &#125;</span><br><span class="line">		  <span class="keyword">if</span>(!cc)<span class="built_in">cout</span>&lt;&lt;<span class="string">"No"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		  cc=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span>  <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><del>wtmä»¥å‰çš„ç é£æ˜¯æœ‰å¤šçŠ€åˆ©å•Šï¼Œå­—ç¬¦é—´ä¸åŠ ç©ºæ ¼å¤§æ‹¬å·ä¹Ÿä¸æ¢è¡Œ</del></p>
<h1 id="E"><a href="#E" class="headerlink" title="$E$"></a>$E$</h1><p>emmmç¬¬ä¸€çœ¼çŠ¶å‹ï¼Œç¬¬äºŒçœ¼éœ€è¦æŠŠæ ‘é«˜åŠ åˆ°çŠ¶æ€é‡Œï¼Œé‚£ä¹ˆå°±æ˜¯$f_{s,h}$è¡¨ç¤ºç°åœ¨é€‰çš„ç‚¹é›†ä¸º$S$ï¼Œæ ‘é«˜ä¸º$h$çš„æœ€å°èŠ±è´¹ã€‚è½¬ç§»çš„æ—¶å€™å¤§æ¦‚å°±æ˜¯æœ´ç´ çš„</p>
<script type="math/tex; mode=display">
f_{s,i} = \min\limits _{t \in s}\{f_{t,i-1}+cost_{t\to s}\}</script><p>ç„¶åè¿™ä¸ªcostæ˜¾ç„¶æ˜¯å¯ä»¥åœ¨å¯æ¥å—çš„å¤æ‚åº¦ä»¥å†…$prework$å‡ºæ¥çš„ã€‚äºæ˜¯æœ€ç»ˆçš„å¤æ‚åº¦å°±æ˜¯$\Theta(3^n\cdot n^2)$</p>
<blockquote>
<p>æ±‚â€œå­é›†çš„å­é›†â€çš„å¤æ‚åº¦ä¸¥æ ¼æ¥è®²æ˜¯$3^n$è€Œä¸æ˜¯$4^n$ï¼ŒåŸå› åœ¨äºæˆ‘ä»¬äº‹å®ä¸Šä¸€å…±æœ‰$\sum \binom{n}{k}2^k$ä¸ªå­é›†ï¼Œé€†å‘äºŒé¡¹å¼å±•å¼€<del>æˆ–è€…å«äºŒé¡¹å¼æ”¶ç¼©</del>ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°<script type="math/tex">\sum \binom{n}{k}2^k = \sum \binom{n}{k}1^{n-k}\cdot 2^k = (1+2)^n = 3^n</script>ä»£ç å®ç°ï¼š<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">&gt; <span class="keyword">for</span>(t = S ; t ; t = (t - <span class="number">1</span>) &amp; S)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
<p>å‘ƒï¼Œè‡³äºè¿™å¥è¯çš„åŸç†æš‚ä¸å¯çŸ¥ï¼Œä½†æ˜¯æŒºå¥½ç”¨æ˜¯çœŸçš„qwq</p>
</blockquote>
<p>ä½†æ˜¯å¤æ‚åº¦ä¸Šé™æ­¤æ—¶æ˜¯$531441\times 12^2= 76527504$ï¼Œä¸å¯è¿‡ï¼ˆä½†äº‹å®ä¸Šæ ¹æœ¬ä¸å¯èƒ½è·‘æ»¡æ‰€ä»¥ä¹Ÿè¿‡äº†ï¼‰ï¼Œä»¥ä¸‹æ˜¯<code>Flash_hu</code>å·¨ä½¬çš„$\Theta(3^nn)$çš„åšæ³•ï¼š</p>
<p>æˆ‘ä»¬å‘ç°ä¼¼ä¹åŒä¸€æ ‘é«˜çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œå®Œå…¨å¯ä»¥åŒæ—¶è½¬ç§»ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸å¦¨è®¾$f_{s,t}$è¡¨ç¤ºå·²é€‰ç‚¹é›†ä¸º$s$ï¼Œä¸‹ä¸€å±‚è¦åŠ å…¥çš„ç‚¹é›†ä¸º$t$æ—¶ï¼Œ æ–°åŠ å…¥çš„æ‰€æœ‰ç‚¹ä¸åŸæœ‰ç‚¹ä¹‹é—´æœ€å°çš„è¾¹æƒä¹‹å’Œâ€”â€”ç”¨äºé¢„å¤„ç†ã€‚ å…·ä½“çš„è½¬ç§»æˆ‘ä»¬å¯ä»¥è€ƒè™‘å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
f_{s,t} = \min \{f_{s,t-lowbit(j)}+cost_{k, s}\}, k=\log _2lowbit(j)</script><p>å…¶ä¸­$cost_{k,s}$è¡¨ç¤ºç‚¹$k$åˆ°è¿é€šå—$s$çš„æœ€çŸ­è·ç¦»ã€‚å¯ä»¥ç”¨$lowbit$çš„åŸå› æ˜¯ç­”æ¡ˆæ— åºï¼Œæ‰€ä»¥è¿™ä¸€éƒ¨åˆ†çš„å¤æ‚åº¦æ˜¯$O(3^nn).$</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥è€ƒè™‘åŸå…ˆçš„$dp$ï¼Œè®¾$g_{s,h}$è¡¨ç¤ºå·²é€‰ç‚¹é›†ä¸º$s$ï¼Œå½“å‰æ ‘é«˜ä¸º$h$çš„æœ€å°ä»£ä»·ï¼Œå³ç›®æ ‡å‡½æ•°ã€‚é‚£ä¹ˆè½¬ç§»å°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
g_{s,h} = \sum_{t\in s}g_{s-t, h-1}+h\cdot f_{s-t,t}</script><p>åŒæ ·æ˜¯æ˜¾ç„¶çš„ã€‚æ‰€ä»¥æœ€åçš„å¤æ‚åº¦å°±æ˜¯$O(3^nn)$ ã€‚ç­”æ¡ˆçš„è¯æœ€åç›´æ¥å¯¹æ‰€æœ‰$g_{_{2^n-1,h}},h\in[1,n]$å–ä¸ªæœ€å°å€¼å°±å¥½äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> cnt, T, D[MAX][MAX], a, b, c ;</span><br><span class="line"><span class="keyword">int</span> F[MAXN][MAX], Next[MAX], Ans, Sup, Now ;</span><br><span class="line"><span class="keyword">int</span> N, M, i, j, k, Log[MAX], Max, A[MAXN][MAXN] ;   </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(A, <span class="number">63</span>, <span class="keyword">sizeof</span>(A)) ;</span><br><span class="line">    <span class="built_in">memset</span>(F, <span class="number">63</span>, <span class="keyword">sizeof</span>(F)), Ans = Inf ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; Max = (<span class="number">1</span> &lt;&lt; N) - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;c), </span><br><span class="line">        A[a][b] = A[b][a] = min(c, A[a][b]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) Log[<span class="number">1</span> &lt;&lt; i] = i ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) F[<span class="number">0</span>][<span class="number">1</span> &lt;&lt; i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= Max ; ++ i)&#123;</span><br><span class="line">        cnt = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (j = Sup = Max ^ i; j ; j = (j - <span class="number">1</span>) &amp; Sup) Next[j] = cnt, cnt = j ;</span><br><span class="line">        <span class="keyword">for</span> (j = cnt ; j ; j = Next[j])&#123;</span><br><span class="line">            Now = Log[j &amp; (-j)] + <span class="number">1</span>, T = Inf ;</span><br><span class="line">            <span class="keyword">for</span> (k = <span class="number">1</span>; k &lt;= N ; ++ k)</span><br><span class="line">                <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; (k - <span class="number">1</span>) &amp; i) T = min(T, A[Now][k]) ; </span><br><span class="line">            D[i][j] = D[i][j ^ (j &amp; -j)] + T ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) </span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= Max; ++ j)</span><br><span class="line">            <span class="keyword">for</span> (k = j ; k ; k = (k - <span class="number">1</span>) &amp; j)</span><br><span class="line">                F[i][j] = min(F[i][j], F[i - <span class="number">1</span>][j ^ k] + i * D[j ^ k][k]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) Ans = min(Ans, F[i][Max]) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="F"><a href="#F" class="headerlink" title="$F$"></a>$F$</h1><p>ä¸€é“æˆ‘ä¸æ˜¯å¾ˆä¼šçš„çº¿æ®µæ ‘é¢˜â€¦â€¦</p>
<p>æ€ä¹ˆè¯´å‘¢ï¼Œæ„Ÿè§‰è¿™ä¸ªåšæ³•æœªæ›¾è§è¿‡å§ã€‚å¤§æ¦‚å°±æ˜¯ç»´æŠ¤$n+1$æ£µåŠ¨æ€å¼€ç‚¹çš„çº¿æ®µæ ‘ï¼Œå…¶ä¸­å¯¹æ¯ä¸€è¡Œçš„å‰$m-1$ä¸ªå…ƒç´ ç»´æŠ¤ä¸€ä¸ªçº¿æ®µæ ‘ï¼Œç„¶åå¯¹æœ€åä¸€åˆ—å•ç‹¬ç»´æŠ¤ä¸€æ£µçº¿æ®µæ ‘ã€‚çº¿æ®µæ ‘ä¸Šæ¯ä¸ªç‚¹ç»´æŠ¤è‡ªå·±å­æ ‘å†…åˆ°åº•æœ‰å¤šå°‘ä¸ªç‚¹è¢«åˆ äº†ï¼Œç”¨æ¥ååŠ©å¯»æ‰¾ç°åœ¨çš„ä½ç½®ã€‚åœ¨æ­¤åŸºç¡€ä¸Šå†ç»´æŠ¤$n+1$ä¸ª<code>vector</code>ï¼Œç”¨æ¥è®°å½•ä»æ¯æ£µçº¿æ®µæ ‘ä¸­å¼¹å‡ºçš„ç‚¹å³å¯ã€‚</p>
<p>å‘ƒï¼Œç°åœ¨çš„æˆ‘ä¼¼ä¹å¹¶æ²¡æœ‰å¾ˆå¥½åœ°ç†è§£è¿™ä¸ªé¢˜çš„åšæ³•ï¼Œæœ‰äº›é©¬è™â€¦æ‰€ä»¥å¸Œæœ›æ—¥åå†çœ‹çš„æ—¶å€™èƒ½çœ‹çš„æ›´æ¸…æ˜ä¸€ç‚¹å§ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M, Q ;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ; <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ; <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> vio&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> MAXV 2010</span></span><br><span class="line">    <span class="keyword">int</span> x, y, t, i, j ; </span><br><span class="line">    <span class="keyword">int</span> base[MAXV][MAXV] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Solve1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        t = <span class="number">0</span> ; </span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j)</span><br><span class="line">                base[i][j] = ++ t ; </span><br><span class="line">        <span class="keyword">while</span>(Q --)&#123;</span><br><span class="line">            x = qr(), y = qr(), t = base[x][y] ;</span><br><span class="line">            <span class="keyword">for</span> (i = y + <span class="number">1</span> ; i &lt;= M ; ++ i) base[x][i - <span class="number">1</span>] = base[x][i] ; </span><br><span class="line">            <span class="keyword">for</span> (i = x + <span class="number">1</span> ; i &lt;= N ; ++ i) base[i - <span class="number">1</span>][M] = base[i][M] ; </span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, (base[N][M] = t)) ; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> segment_T&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> MAXN 400010</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rr register int</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;ll&gt; del[MAXN &lt;&lt; <span class="number">4</span>] ; <span class="keyword">int</span> Max ; </span><br><span class="line">    <span class="keyword">int</span> rt[MAXN &lt;&lt; <span class="number">4</span>], L[MAXN &lt;&lt; <span class="number">4</span>], R[MAXN &lt;&lt; <span class="number">4</span>], dfn, val[MAXN &lt;&lt; <span class="number">4</span>] ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> &amp;root, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> pos)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!root) root = ++ dfn ; val[root] ++ ; <span class="keyword">if</span> (l == r) <span class="keyword">return</span> ; rr mid = (l + r) &gt;&gt; <span class="number">1</span> ; </span><br><span class="line">        <span class="keyword">if</span> (pos &lt;= mid) update(L[root], l, mid, pos) ; <span class="keyword">else</span> update(R[root], mid + <span class="number">1</span>, r, pos) ; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> pos)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l ; rr mid = (l + r) &gt;&gt; <span class="number">1</span>, dif = mid - l + <span class="number">1</span> - val[L[root]] ; </span><br><span class="line">        <span class="keyword">if</span> (dif &gt;= pos) <span class="keyword">return</span> query(L[root], l, mid, pos) ; <span class="keyword">else</span> <span class="keyword">return</span> query(R[root], mid + <span class="number">1</span>, r, pos - dif) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">delcase2</span><span class="params">(<span class="keyword">int</span> x, ll y)</span></span>&#123;</span><br><span class="line">        rr now_p = query(rt[N + <span class="number">1</span>], <span class="number">1</span>, Max, x) ; update(rt[N + <span class="number">1</span>], <span class="number">1</span>, Max, now_p) ;</span><br><span class="line">        ll ret = now_p &lt;= N ? <span class="number">1L</span>L * now_p * M : del[N + <span class="number">1</span>][now_p - N - <span class="number">1</span>] ; del[N + <span class="number">1</span>].pb(y ? y : ret) ; <span class="keyword">return</span> ret ;  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">delcase1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">        rr now_p = query(rt[x], <span class="number">1</span>, Max, y) ; update(rt[x], <span class="number">1</span>, Max, now_p) ; </span><br><span class="line">        ll ret = now_p &lt; M ? <span class="number">1L</span>L * (x - <span class="number">1</span>) * M + now_p : del[x][now_p - M] ; del[x].pb(delcase2(x, ret)) ; <span class="keyword">return</span> ret ;  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Solve2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        rr x, y ; Max = max(N, M) + Q ; </span><br><span class="line">        <span class="keyword">while</span> (Q --) x = qr(), y = qr(), <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, y != M ? delcase1(x, y) : delcase2(x, <span class="number">0</span>)) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; Q ;</span><br><span class="line">    <span class="keyword">if</span> (N &lt;= <span class="number">5000</span> &amp;&amp; M &lt;= <span class="number">5000</span>) vio :: Solve1() ;</span><br><span class="line">    <span class="keyword">else</span> segment_T :: Solve2() ;<span class="comment">/*pkspkspks*/</span> <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="varPhi"><a href="#varPhi" class="headerlink" title="$\varPhi$"></a>$\varPhi$</h1><p>ç°åœ¨æ¥çœ‹ï¼Œä¹è§‚ä¼°è®¡ï¼Œè‡ªå·±åº”è¯¥å¯ä»¥å¾—åˆ°$100+100+100+100+55+30=485pts$ï¼Œå½“ä¸”ä»…å½“è‡ªå·±çš„ç åŠ›å·²ç»å¾ˆå¼ºã€‚å¦‚æœæ˜¯æ‚²è§‚ä¼°è®¡ï¼Œé‚£å¤§æ¦‚æ˜¯$100+70+40+80+55+30=375pts$ã€‚ç»§ç»­åŠªåŠ›å§ï¼Œç°åœ¨è¿˜å·®å¾—å¾ˆè¿œå•Šâ€¦â€¦</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/æ™®é€šDP</tag>
        <tag>æ•°å­¦/æ‰©å±•æ¬§å‡ é‡Œå¾·</tag>
        <tag>æ•°æ®ç»“æ„/çº¿æ®µæ ‘</tag>
        <tag>NOIPç³»åˆ—</tag>
        <tag>æš´åŠ›,brute-force</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘èˆè¹ˆé“¾(DLX)å…¥é—¨</title>
    <url>/2019/07/11/dlx/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>â€œ<br>åœ¨ä¸€ä¸ªå…¨é›†$X$ä¸­è‹¥å¹²å­é›†çš„é›†åˆä¸º$S$ï¼Œç²¾ç¡®è¦†ç›–ï¼ˆ$\boldsymbol{Exact~Cover}$ï¼‰æ˜¯æŒ‡ï¼Œ$S$çš„å­é›†$S*$ï¼Œæ»¡è¶³$X$ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ åœ¨$S*$ä¸­æ°å¥½å‡ºç°ä¸€æ¬¡ã€‚åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œç²¾ç¡®è¦†ç›–é—®é¢˜æŒ‡æ‰¾å‡ºè¿™æ ·çš„ä¸€ç§è¦†ç›–ï¼Œæˆ–è¯æ˜å…¶ä¸å­˜åœ¨ã€‚<br>â€</p>
<a id="more"></a>
<h1 id="0x01-ç²¾å‡†è¦†ç›–é—®é¢˜"><a href="#0x01-ç²¾å‡†è¦†ç›–é—®é¢˜" class="headerlink" title="$0x01$ ç²¾å‡†è¦†ç›–é—®é¢˜"></a>$0x01$ ç²¾å‡†è¦†ç›–é—®é¢˜</h1><p>â€¦â€¦å…¶å®æ˜¯ä¸€ç§å†³ç­–é—®é¢˜ï¼Œç»™å®š$n$è¡Œé•¿åº¦ä¸º$m$çš„$0,1$åºåˆ—ï¼Œè¦æ±‚é€‰å‡ºä¸€äº›è¡Œï¼Œä½¿å¾—æ¯ä¸€åˆ—æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª$1$ï¼Œè¿™å°±æ˜¯ç²¾å‡†è¦†ç›–é—®é¢˜ã€‚</p>
<p>è¯šç„¶ï¼Œæˆ‘æœç´¢è´¼èœï¼Œæ‰€ä»¥æš‚ä¸”ä¸è€ƒè™‘çˆ†æœï¼Œå¼•è¿›ä¸€ç§å«åšâ€œXç®—æ³•â€çš„ä¸œè¥¿ï¼Œå…¶æœ¬è´¨ä¸Šæ˜¯æ¯æ¬¡é€‰å–ä¸€è¡Œï¼Œä¹‹ååˆ æ‰æ‰€æœ‰ä¸è¿™è¡Œå†²çªçš„è¡Œï¼ŒåŒæ—¶åˆ æ‰ä¸è¿™è¡Œå†²çªçš„åˆ—ï¼Œæˆä¸ºä¸€ä¸ªæ›´å°çš„çŸ©é˜µï¼Œè¿­ä»£ä¸‹å»ã€‚å¦‚æœä»€ä¹ˆæ—¶å€™åˆ æ²¡äº†ï¼Œå°±è¯´æ˜æ˜¯ä¸€ç§å¯è¡Œè§£ï¼›å¦åˆ™æ¢å¤åŸæ¥çš„çŠ¶æ€ã€‚</p>
<p>æˆ‘ä»¬æ€è€ƒè¿™ç§ç®€æ´åšæ³•çš„æµç¨‹ï¼Œå‘ç°æœ´ç´ çš„åˆ é™¤ä¸æ¢å¤æ— éå°±æ˜¯å°†çŸ©é˜µçš„è¿™ä¸€ä¸ªå…ƒç´ ç”±$0$æˆ–$1$èµ‹å€¼æˆ$-1$ï¼Œè®°å½•ä¸€ä¸‹çŠ¶æ€å›æº¯çš„æ—¶å€™å†èµ‹å€¼å›å»ï¼Œæ•´ä¸ªè¿‡ç¨‹ååˆ†åœ°æ¼«é•¿ä¸”ç¹å¤ã€‚è€Œæ‰€è°“æ‰€è°“çš„â€<strong>èˆè¹ˆé“¾ç®—æ³•</strong>$\rm{DLX~(Dancing-Links ~X ~Algorithm)}$â€œç®—æ³•åˆ™æ˜¯ä¸“é—¨ç”¨æ¥åŠ é€Ÿè¿™ä¸€è¿‡ç¨‹ã€‚</p>
<p>åœ¨æœ¬äººçœ‹æ¥ï¼Œ$\rm{DLX}$æ›´åƒæ˜¯ä¸€ç§åŒ…è£…å¥½çš„æ•°æ®ç»“æ„ï¼Œä¸€ç§åŠ é€Ÿæªæ–½ï¼Œèƒ½æ›´å¥½çš„è®©çˆ†æœè¾¾åˆ°å…¶ç†è®ºå¤æ‚åº¦ï¼ˆæ‰€ä»¥æœ¬è´¨ä¸Šè¿˜æ˜¯çˆ†æœXDï¼‰â€¦â€¦ä¸è¿‡è¯´å®è¯â€œåƒç¿©ç¿©èµ·èˆçš„èˆè€…â€æˆ‘å€’æ˜¯çœ‹ä¸å‡ºæ¥â€¦æˆ‘è§‰å¾—æ›´åƒæ˜¯ä¸€å¯¹ç‰›ä»”è£¤ä¸Šæ‹‰é“¾ï¼Œæ‹‰æ¥æ‹‰å»çš„é‚£ç§æ„Ÿè§‰â€¦â€¦</p>
<p><del>è¯¶ï¼Œä»€ä¹ˆæ—¶å€™æˆ‘çš„Prefaceå¼€å§‹è¿™ä¹ˆæ„è¯†æµäº†å•Š</del></p>
<h1 id="0x02-text-Dancing-Links"><a href="#0x02-text-Dancing-Links" class="headerlink" title="$0x02$ $\text{Dancing-Links}$"></a>$0x02$ $\text{Dancing-Links}$</h1><p>å…¶å®ç®—æ³•çš„æœ¬è´¨å°±æ˜¯é“¾è¡¨ï¼Œè¿™ç©æ„å„¿æ’å…¥åˆ é™¤éƒ½æ˜¯$\Theta(1)$çš„ã€‚æˆ‘ä»¬è€ƒè™‘å»ºç«‹ä¸€ä¸ª<strong>åå­—å¾ªç¯é“¾è¡¨</strong>ï¼Œå³æ¯ä¸ªå…ƒç´ åœ¨é“¾è¡¨é‡Œæ˜¯å››è”é€šçš„ï¼Œå¹¶ä¸”å·¦å³æˆç¯ã€ä¸Šä¸‹æˆç¯ï¼Œç›®çš„æ˜¯æ–¹ä¾¿çŸ¥é“æŸäº›æ“ä½œè¯¥ä»€ä¹ˆæ—¶å€™åœæ­¢ã€‚æœ¬è´¨ä¸Šæ¥è®²ï¼Œä¸€ä¸ªæ±‚è§£çŸ©é˜µï¼ˆæ­¤å¤„ä»£æŒ‡ä¸Šæ–‡æåˆ°çš„$n$è¡Œ$0,1$åºåˆ—ï¼‰åˆå§‹çš„$\text{Dancing-Links}$ å…±æœ‰$\text{1+m+Count(â€˜1â€™)}$ ä¸ªå…ƒç´ ï¼Œå…¶ä¸­$Count(â€˜1â€™)$æŒ‡çŸ©é˜µä¸­$1$çš„ä¸ªæ•°ã€‚</p>
<p>å‰$\text{m+1}$ä¸ªå…ƒç´ ï¼Œå¤§æ¦‚å°±æ˜¯åˆ—æ ‡å…ƒç´ ï¼ˆ$m$ä¸ªï¼‰å·¦å³è¿æˆä¸€ç‰‡ï¼Œæœ€å·¦è¾¹çš„$0$å·å…ƒç´ ç”¨æ¥åˆ¤æ–­æ˜¯å¦$\text{worked-out}$æ•´ä¸ªçŸ©é˜µï¼Œå’Œæ‰€æœ‰åˆ—æ ‡å…ƒç´ ä¸²æˆä¸€æ¡å·¦å³è¿é€šçš„é“¾è¡¨ã€‚ç„¶åå‰©ä¸‹çš„çš„å…ƒç´ å°±æ˜¯çœŸå®å­˜åœ¨çš„å…ƒç´ â€¦è¯¥æ€ä¹ˆè¿æ€ä¹ˆè¿é‚£ç§æ„Ÿè§‰â€¦</p>
<p>é‚£ä¹ˆæ¯ä¸ªå…ƒç´ è®°å½•$6$ä¸ªå€¼ï¼Œä¸Šä¸‹å·¦å³å’Œè¡Œæ ‡åˆ—æ ‡ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> l, r, u, d, co, ro ;</span><br><span class="line">&#125;B[MAX &lt;&lt; <span class="number">1</span>] ;</span><br></pre></td></tr></table></figure>
<p>åˆå§‹åŒ–</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= M ; ++ i) B[i].l = i - <span class="number">1</span>, B[i].r = i + <span class="number">1</span>, B[i].u = B[i].d = i ;</span><br><span class="line">	B[M].r = <span class="number">0</span>, B[<span class="number">0</span>].l = M, cnt = M, <span class="built_in">memset</span>(Ro, <span class="number">-1</span>, <span class="keyword">sizeof</span>(Ro))  ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­$R_o[]$æ•°ç»„è®°å½•æ¯ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆç¬¬ä¸€ä¸ªåŠ è¿›æ¥çš„å…ƒç´ </p>
<p>ç„¶å<code>Insert</code>å‡½æ•°ç”¨äºæ’å…¥â€¦â€¦æ¯•ç«Ÿæ˜¯é“¾è¡¨å˜›<del>ï¼Œå°±è¦æœ‰ä¸ªé“¾è¡¨çš„æ ·å­</del></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> R, <span class="keyword">int</span> C)</span></span>&#123;</span><br><span class="line">	Cs[C] ++, B[++ cnt].ro = R, B[cnt].co = C ;</span><br><span class="line">	B[cnt].u = C, B[cnt].d = B[C].d, B[C].d = B[B[C].d].u = cnt ; </span><br><span class="line">	<span class="keyword">if</span> (Ro[R] &lt; <span class="number">0</span>) Ro[R] = B[cnt].l = B[cnt].r = cnt ; </span><br><span class="line">	<span class="keyword">else</span> B[cnt].l = B[Ro[R]].l, B[cnt].r = Ro[R], B[Ro[R]].l = B[B[Ro[R]].l].r = cnt ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶å$C_s[]$æ•°ç»„ç”¨æ¥è®°å½•æ¯ä¸€åˆ—çš„å…ƒç´ ä¸ªæ•°ï¼Œç”¨æ¥å‰ªæã€‚</p>
<p>ç„¶åå°±æ˜¯åˆ é™¤å’Œæ¢å¤ï¼Œéƒ½æ˜¯ä»¥åˆ—ä¸ºå‚æ•°çš„å‡½æ•°ï¼Œä¹Ÿéƒ½æ˜¯å¾ˆå¹³å‡¡çš„æ“ä½œã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Del</span><span class="params">(<span class="keyword">int</span> C)</span></span>&#123;</span><br><span class="line">	B[B[C].l].r = B[C].r, B[B[C].r].l = B[C].l ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = B[C].d ; i != C ; i = B[i].d)  </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = B[i].r ; j != i ; j = B[j].r)</span><br><span class="line">			B[B[j].d].u = B[j].u, B[B[j].u].d = B[j].d, Cs[B[j].co] -- ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Back</span><span class="params">(<span class="keyword">int</span> C)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = B[C].u ; i != C ; i = B[i].u)  </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = B[i].l ; j != i ; j = B[j].l)</span><br><span class="line">			B[B[j].d].u = j, B[B[j].u].d = j, Cs[B[j].co] ++ ;</span><br><span class="line">	B[B[C].l].r = C, B[B[C].r].l = C ;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ˜¯ä¸»å‡½æ•°</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dance</span><span class="params">(<span class="keyword">int</span> step)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!B[<span class="number">0</span>].r)&#123; <span class="keyword">return</span> (<span class="keyword">bool</span>)(ans = step) ; &#125; <span class="keyword">int</span> now_c = B[<span class="number">0</span>].r ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = B[<span class="number">0</span>].r ; i ; i = B[i].r) </span><br><span class="line">		now_c = Cs[i] &lt; Cs[now_c] ? i : now_c ; </span><br><span class="line">	Del(now_c) ; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = B[now_c].d ; i != now_c ; i = B[i].d) &#123;</span><br><span class="line">		Ans[step] = B[i].ro ; <span class="keyword">for</span>(<span class="keyword">int</span> j = B[i].r ; j != i ; j = B[j].r) Del(B[j].co) ;</span><br><span class="line">		<span class="keyword">if</span> (dance(step + <span class="number">1</span>)) <span class="keyword">return</span> <span class="number">1</span> ;  <span class="keyword">for</span>(<span class="keyword">int</span> j = B[i].l ; j != i ; j = B[j].l) Back(B[j].co) ;</span><br><span class="line"> 	&#125;</span><br><span class="line"> 	Back(now_c) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰ä¸ªå°å‰ªæï¼Œå°±æ˜¯åˆšæ‰è¯´çš„$C_s[]$ã€‚å¦‚æœæ¯æ¬¡ä»å«æœ‰æœ€å°‘$1$çš„é‚£ä¸€åˆ—å¼€å§‹åˆ ï¼Œä¼¼ä¹å¯ä»¥å¿«å¥½å‡ å€ã€‚</p>
<p>æˆ‘å‘ç°æ•´ç†ç®—æ³•çš„æ–‡ç« å†™èµ·æ¥çœŸæ˜¯éš¾å—å•Šï¼Œè¿˜æ˜¯æ„è¯†æµæ¯”è¾ƒç®¡ç”¨ã€‚</p>
<p>æœ€åæ˜¯å…¨éƒ¨çš„ç¨‹åºï¼ˆ<a href="https://www.luogu.org/problemnew/show/P4929" target="_blank" rel="noopener">$Luogu4929$</a>ï¼‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> I_used_to_rule_the_world___Seas_would_rise_when_I_gave_the_word___Now_in_the_morning_I_sleep_alone___Sweep_the_streets_I_used_to_own Init</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> I_used_to_roll_the_dice___Feel_the_fear_in_my_enemy_s_eyes___Listen_as_the_crowd_would_sing_Now_the_old_king_is_dead__Long_live_the_king Done</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> One_minute_I_held_the_key__Next_the_walls_were_closed_on_me__And_I_discovered_that_my_castles_stand__Upon_pillars_of_salt_pillars_of_sand work </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 520</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX 30010</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, u, d, co, ro ;</span><br><span class="line">&#125;B[MAX &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> cnt, ans ; </span><br><span class="line"><span class="keyword">int</span> N, M, Ans[MAX], Ro[MAX], Cs[MAX] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M, <span class="built_in">memset</span>(Ro, <span class="number">-1</span>, <span class="keyword">sizeof</span>(Ro)) ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= M ; ++ i) B[i].l = i - <span class="number">1</span>, B[i].r = i + <span class="number">1</span>, B[i].u = B[i].d = i ;</span><br><span class="line">    B[M].r = <span class="number">0</span>, B[<span class="number">0</span>].l = M, cnt = M  ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">int</span> R, <span class="keyword">int</span> C)</span></span>&#123;</span><br><span class="line">    Cs[C] ++, B[++ cnt].ro = R, B[cnt].co = C ;</span><br><span class="line">    B[cnt].u = C, B[cnt].d = B[C].d, B[C].d = B[B[C].d].u = cnt ; </span><br><span class="line">    <span class="keyword">if</span> (Ro[R] &lt; <span class="number">0</span>) Ro[R] = B[cnt].l = B[cnt].r = cnt ; </span><br><span class="line">    <span class="keyword">else</span> B[cnt].l = B[Ro[R]].l, B[cnt].r = Ro[R], B[Ro[R]].l = B[B[Ro[R]].l].r = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Del</span><span class="params">(<span class="keyword">int</span> C)</span></span>&#123;</span><br><span class="line">    B[B[C].l].r = B[C].r, B[B[C].r].l = B[C].l ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = B[C].d ; i != C ; i = B[i].d)  </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = B[i].r ; j != i ; j = B[j].r)</span><br><span class="line">            B[B[j].d].u = B[j].u, B[B[j].u].d = B[j].d, Cs[B[j].co] -- ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Back</span><span class="params">(<span class="keyword">int</span> C)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = B[C].u ; i != C ; i = B[i].u)  </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = B[i].l ; j != i ; j = B[j].l)</span><br><span class="line">            B[B[j].d].u = j, B[B[j].u].d = j, Cs[B[j].co] ++ ;</span><br><span class="line">    B[B[C].l].r = C, B[B[C].r].l = C ;  </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dance</span><span class="params">(<span class="keyword">int</span> step)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!B[<span class="number">0</span>].r)&#123; <span class="keyword">return</span> (<span class="keyword">bool</span>)(ans = step) ; &#125; <span class="keyword">int</span> now_c = B[<span class="number">0</span>].r ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = B[<span class="number">0</span>].r ; i ; i = B[i].r) </span><br><span class="line">        now_c = Cs[i] &lt; Cs[now_c] ? i : now_c ; </span><br><span class="line">    Del(now_c) ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = B[now_c].d ; i != now_c ; i = B[i].d) &#123;</span><br><span class="line">        Ans[step] = B[i].ro ; <span class="keyword">for</span>(<span class="keyword">int</span> j = B[i].r ; j != i ; j = B[j].r) Del(B[j].co) ;</span><br><span class="line">        <span class="keyword">if</span> (dance(step + <span class="number">1</span>)) <span class="keyword">return</span> <span class="number">1</span> ;  <span class="keyword">for</span>(<span class="keyword">int</span> j = B[i].l ; j != i ; j = B[j].l) Back(B[j].co) ;</span><br><span class="line"> 	&#125;</span><br><span class="line"> 	Back(now_c) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Done</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, k ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j)</span><br><span class="line">            &#123; <span class="built_in">cin</span> &gt;&gt; k ; <span class="keyword">if</span> (k) Insert(i, j) ;&#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">work</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!dance(<span class="number">0</span>)) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"No Solution!"</span>) ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; ans ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d "</span>, Ans[i]) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123; </span><br><span class="line">    I_used_to_rule_the_world___Seas_would_rise_when_I_gave_the_word___Now_in_the_morning_I_sleep_alone___Sweep_the_streets_I_used_to_own() ; </span><br><span class="line">    I_used_to_roll_the_dice___Feel_the_fear_in_my_enemy_s_eyes___Listen_as_the_crowd_would_sing_Now_the_old_king_is_dead__Long_live_the_king() ;</span><br><span class="line">    One_minute_I_held_the_key__Next_the_walls_were_closed_on_me__And_I_discovered_that_my_castles_stand__Upon_pillars_of_salt_pillars_of_sand() ; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ; <span class="comment">/*</span></span><br><span class="line"><span class="comment">             	I hear Jerusalem bells are ringing   Roman Cavalry choirs are singing</span></span><br><span class="line"><span class="comment">             	Be my mirror my sword and shield     My missionaries in a foreign field</span></span><br><span class="line"><span class="comment">                For some reason I can't explain	     Once you know there was never'</span></span><br><span class="line"><span class="comment">                Never an honest word			     That was when I ruled the world</span></span><br><span class="line"><span class="comment">               */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>ç²¾å‡†è¦†ç›–</category>
      </categories>
      <tags>
        <tag>ç²¾å‡†è¦†ç›–/èˆè¹ˆé“¾/DLX</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘ç”¨èˆè¹ˆé“¾(DLX)è§£å†³ä¸€ç±»æ•°ç‹¬é—®é¢˜</title>
    <url>/2019/07/11/dlx2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è€ƒè™‘ç²¾å‡†è¦†ç›–é—®é¢˜çš„æœ¬è´¨â€”â€”æˆ‘ä»¬æŠŠè¡Œçœ‹åšå†³ç­–ï¼ŒæŠŠåˆ—çœ‹åšä»»åŠ¡ï¼Œé‚£ä¹ˆå…¶å®è´¨å°±æ˜¯é€šè¿‡å†³ç­–æ¥å®Œæˆä»»åŠ¡ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬æ¥è€ƒè™‘æ•°ç‹¬é—®é¢˜çš„æœ¬è´¨ï¼Œå¯¹äºä¸€ä¸ª$n^2\cdot n^2$çš„æ•°ç‹¬è€Œè¨€ï¼Œä»–çš„ç›®æ ‡å‡½æ•°æœ‰å››ä¸ªï¼š</p>
<ul>
<li><p>1ã€$r(i,j):$å¯¹äºç¬¬$i$è¡Œï¼Œå¿…é¡»è¦æœ‰æ•°å­—$j$</p>
</li>
<li><p>2ã€$c(i,j):$å¯¹äºç¬¬$i$åˆ—ï¼Œå¿…é¡»è¦æœ‰æ•°å­—$j$</p>
</li>
<li><p>3ã€$p(i,j):$å¯¹äºç¬¬$i$ä¸ªå®«ï¼Œå¿…é¡»è¦æœ‰æ•°å­—$j$</p>
</li>
<li><p>4ã€$e(i,j):$å¯¹äºç¬¬$(i,j)$ä¸ªæ ¼å­ï¼Œå¿…é¡»è¦æœ‰æ•°å­—</p>
</li>
</ul>
<p>ç”±æ­¤å¯çŸ¥ï¼Œæˆ‘ä»¬æœ‰$4\times (n^2\cdot n^2)$çš„ä»»åŠ¡é‡ã€‚</p>
<p>åŒæ—¶æˆ‘ä»¬å¯ä»¥ç”¨$n^6$çš„çŠ¶æ€è¡¨ç¤ºæˆ‘ä»¬çš„å†³ç­–ï¼Œå³$(i,j,k)$è¡¨ç¤ºç¬¬$i$è¡Œ$j$åˆ—å¡«äº†æ•°å­—$k$ã€‚</p>
<p>ç»“åˆä¸¤è€…è€ƒè™‘ï¼Œæˆ‘ä»¬å¯ä»¥å»ºå‡ºä¸€ä¸ªæ–°çš„ç½‘æ ¼å›¾ï¼Œæœ‰$n^6$è¡Œã€$4n^4$åˆ—ã€‚è€ƒè™‘å‘ç½‘æ ¼ä¸­å¡«â€œ$1$â€è¡¨ç¤ºä¸€ä¸ªå†³ç­–å®Œæˆäº†ä¸€ä¸ªä»»åŠ¡ï¼Œé‚£ä¹ˆå¯¹äºæ¯ä¸€ä¸ªå†³ç­–$(i,j,k)$ï¼Œå®ƒç†åº”å¯ä»¥å®Œæˆ$4$ä¸ªä»»åŠ¡ï¼Œæ‰€ä»¥ä¸€å…±æœ‰$16n^4$ä¸ª1.</p>
<p>è‡³æ­¤å»ºæ¨¡å®Œæ¯•ï¼Œä¸€ä¸ª$n^2\cdot n^2$çš„æ•°ç‹¬é—®é¢˜å¯ä»¥è½¬åŒ–æˆä¸€ä¸ª$n^6$è¡Œã€$4n^4$åˆ—ï¼Œæœ‰$16n^4$ä¸ª$1$çš„ç²¾å‡†è¦†ç›–é—®é¢˜ã€‚</p>
<a id="more"></a>
<p>ä¸‹é¢æ˜¯ä»£ç å®ç°éƒ¨åˆ†ï¼Œä»¥<a href="https://www.spoj.com/problems/SUDOKU/" target="_blank" rel="noopener">SPOJ1110-SUDOKU</a>ä¸ºä¾‹ï¼š</p>
<ul>
<li>é¦–å…ˆæ˜¯å¯¹çŠ¶æ€è¿›è¡Œç¼–å·</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">encode</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span>&#123; </span><br><span class="line">  	<span class="keyword">return</span> (a &lt;&lt; <span class="number">8</span>) + (b &lt;&lt; <span class="number">4</span>) + c + <span class="number">1</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">decode</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> &amp;a, <span class="keyword">int</span> &amp;b, <span class="keyword">int</span> &amp;c)</span></span>&#123; </span><br><span class="line">  	x --, c = x % <span class="number">16</span>, x /= <span class="number">16</span>, b = x % <span class="number">16</span>, x /= <span class="number">16</span>, a = x ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åŸç†å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯içš„åç»­çŠ¶æ€(j,k)æœ‰$n^4=256$ç§ç»„åˆï¼ŒåŒç†jçš„åç»­çŠ¶æ€æœ‰$n^2=16$ç§ç»„åˆã€‚</p>
<p>ç„¶åå°±æ˜¯è¿è¾¹ï¼Œå¯¹äºæ¯ä¸ªç‚¹åˆ¤æ–­ä¸€ä¸‹ï¼Œå¦‚æœå½“å‰æšä¸¾åˆ°çš„æ•°å­—æ˜¯è¿™ä¸ªç‚¹çš„æ•°å­—é‚£ä¹ˆå°±éœ€è¦<code>insert</code>ï¼ŒåŒç†å¦‚æœæ²¡æœ‰æ•°å­—çš„è¯é‚£å°±éƒ½<code>insert</code>ä¸€éï¼Œæ¯•ç«Ÿæ¯”èµ·æœ‰æ•°å­—çš„ç‚¹ï¼Œå¯è¡Œçš„å†³ç­–æ•°è¦æ›´å¤šã€‚è‡³æ­¤æˆ‘ä»¬å°±ä¿è¯äº†åŸå›¾ä¸­å­˜åœ¨æ•°å­—çš„æ–¹æ ¼è¢«<code>insert</code>äº†ï¼Œä¸å­˜åœ¨æ•°å­—çš„æ–¹æ ¼çš„æ‰€æœ‰å¯èƒ½æƒ…å†µä¹Ÿè¢«<code>insert</code>äº†ï¼Œä¹‹åç›´æ¥<code>dance</code>å°±å¯ä»¥å•¦ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> t[O][O], op ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> POS = <span class="number">0</span>, Row = <span class="number">1</span>, Col = <span class="number">2</span>, Sub = <span class="number">3</span> ; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">	<span class="keyword">while</span> (T --)&#123;</span><br><span class="line">		read(), Init() ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">16</span> ; ++ i)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">16</span> ; ++ j)&#123;</span><br><span class="line">				t[i][j] = base[i][j] == <span class="string">'-'</span> ? <span class="number">0</span> : base[i][j] - <span class="number">64</span> ;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; <span class="number">16</span> ; ++ k)&#123;</span><br><span class="line">					<span class="keyword">if</span> (t[i][j] &amp;&amp; t[i][j] != k + <span class="number">1</span>) <span class="keyword">continue</span> ;</span><br><span class="line">					op = encode(i, j, k) ; </span><br><span class="line">          Insert(op, encode(POS, i, j)),</span><br><span class="line">					Insert(op, encode(Row, i, k)), </span><br><span class="line">          Insert(op, encode(Col, j, k)), </span><br><span class="line">          Insert(op, encode(Sub, (i / <span class="number">4</span>) * <span class="number">4</span> + j / <span class="number">4</span>, k)) ;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;		</span><br><span class="line">		dance(<span class="number">0</span>) ;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">16</span> ; ++ i, <span class="built_in">puts</span>(<span class="string">""</span>))</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">16</span> ; ++ j) <span class="built_in">printf</span>(<span class="string">"%c"</span>, (<span class="keyword">char</span>)(res[i][j] + <span class="number">65</span>)) ;</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">""</span>) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ˜¯ä¸€é“è¦æ±‚å‡ºæ‰€æœ‰è§£çš„é¢˜ï¼š<a href="https://www.luogu.org/problem/P1074" target="_blank" rel="noopener">NOIP2009D é¶å½¢æ•°ç‹¬</a></p>
<p>æ­¤å¤„éœ€è¦æˆ‘ä»¬æ±‚å‡ºæ‰€æœ‰å¯èƒ½çš„ç²¾å‡†è¦†ç›–æ–¹æ¡ˆç„¶åå–æœ€å¤§å€¼ï¼Œäºæ˜¯å°å°æ”¹åŠ¨ä¸€ä¸‹<code>dance</code>å°±å¥½ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">gs</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;x, <span class="keyword">const</span> <span class="keyword">int</span> &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">1</span> || y == <span class="number">1</span> || x == <span class="number">9</span> || y == <span class="number">9</span> )   <span class="keyword">return</span> <span class="number">6</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">2</span> || y == <span class="number">2</span> || x == <span class="number">8</span> || y == <span class="number">8</span> )   <span class="keyword">return</span> <span class="number">7</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">3</span> || y == <span class="number">3</span> || x == <span class="number">7</span> || y == <span class="number">7</span> )   <span class="keyword">return</span> <span class="number">8</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">4</span> || y == <span class="number">4</span> || x == <span class="number">6</span> || y == <span class="number">6</span> )   <span class="keyword">return</span> <span class="number">9</span> ; <span class="keyword">return</span> <span class="number">10</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dance</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;step)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> now_c = B[<span class="number">0</span>].r ; </span><br><span class="line">	<span class="keyword">if</span> (!now_c)&#123;</span><br><span class="line">		<span class="keyword">int</span> x, y, z, ret = <span class="number">0</span> ;</span><br><span class="line">		<span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; step ; ++ i)</span><br><span class="line">			decode(ans[i], x, y, z), g[x][y] = z + <span class="number">1</span> ; </span><br><span class="line">		<span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">9</span> ; ++ i)</span><br><span class="line">			<span class="keyword">for</span> (rr <span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">9</span> ; ++ j)</span><br><span class="line">				ret += g[i][j] * gs(i + <span class="number">1</span>, j + <span class="number">1</span>) ;</span><br><span class="line">		res = max(res, ret) ; <span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (rr <span class="keyword">int</span> i = now_c ; i ; i = B[i].r) </span><br><span class="line">    now_c = Cs[i] &lt; Cs[now_c] ? i : now_c ; Del(now_c) ;  </span><br><span class="line">	<span class="keyword">for</span> (rr <span class="keyword">int</span> i = B[now_c].d ; i != now_c ; i = B[i].d)&#123;</span><br><span class="line">		ans[step] = B[i].ro ; </span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> j = B[i].r ; j != i ; j = B[j].r) Del(B[j].co) ;</span><br><span class="line">		dance(step + <span class="number">1</span>) ; </span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> j = B[i].l ; j != i ; j = B[j].l) Back(B[j].co) ;</span><br><span class="line">	&#125;</span><br><span class="line">	Back(now_c) ; <span class="keyword">return</span>  ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ’’èŠ±~ <del>ï¼ˆæ’’è‡ªå·±XD</del></p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>æ¨¡å‹</category>
      </categories>
      <tags>
        <tag>ç²¾å‡†è¦†ç›–/èˆè¹ˆé“¾/DLX</tag>
      </tags>
  </entry>
  <entry>
    <title>éšæƒ³å…« Â· é€ƒå§</title>
    <url>/2019/06/11/8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¿™æ˜¯ä¸€ç¯‡æ—¶é—´è·¨åº¦å¾ˆé•¿çš„æ–‡ç« ï¼Œä¹Ÿæ˜¯ã€Œéšæƒ³ã€ç³»åˆ—é‡Œé¢æˆ‘è®¤ä¸ºæœ€ä¸§çš„ä¸€ç¯‡æ–‡ç« ã€‚</p>
<p>ä½ ç¡®å®šè¦çœ‹å—ï¼Ÿæˆ–è®¸ä¹Ÿæ²¡æœ‰æƒ³è±¡çš„é‚£ä¹ˆä¸§ã€‚å¯èƒ½ä»Šå¤©æˆ‘æ˜¯è¿™ä¹ˆå†™çš„ï¼Œåå¤©æˆ‘å°±ä¸è¿™ä¹ˆè®¤ä¸ºäº†ã€‚æ¯•ç«Ÿæœ¬è´¨ä¸Šï¼Œè¿™åªæ˜¯ä¸€ç¯‡é—²æ‰¯çš„æ–‡ç« ã€‚</p>
<a id="more"></a>
<p>çµé•¿ç±»åŠ¨ç‰©çš„æƒ…ç»ªå¾€å¾€ä¼šè¡¨å¾åœ¨è¡Œä¸ºä¸Šã€‚ä»ä¸€å¼€å§‹åªä¼šå› å¸Œæœ›å‘æ³„è€ŒæŠ¢ã€ç ¸ç‰©å“ï¼Œæ¼”å˜åˆ°è„±ç¦»å‡ºç¾¤è½ã€ç‹¬è‡ªå¯¹ç€å¤©ä¸Šçš„æœˆäº®çšæ´ã€åœ°ä¸Šçš„èš‚èšæˆç¾¤ï¼Œæœ€åæ¼”å˜å‡ºéŸ³ä¹ã€æ–‡ç« ã€æ¶‚é¸¦ã€‚åŒæ—¶ï¼Œä¸å¾—ä¸æ‰¿è®¤ï¼Œæƒ…æ„Ÿæ˜¯æ¨åŠ¨è‰ºæœ¯å‘å±•çš„å†…åœ¨åŠ›é‡ï¼Œè€Œç¬æ—¶çš„æƒ…ç»ªåˆ™æ˜¯è‰ºæœ¯è¯ç”Ÿçš„ç¼˜ç”±ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¿™ç¯‡æ–‡ç« å†™äº†å¾ˆä¹…ä¹Ÿå°±ä¸å¥‡æ€ªäº†â€”â€”æˆ‘çš„æƒ…ç»ªèµ·ä¼æœ‰æ—¶ä¼šå¾ˆä¸¥é‡ï¼Œä»å†…ç¯å¢ƒè§’åº¦åˆ†æï¼Œå°±æ˜¯é›Œæ€§æ¿€ç´ å«é‡çš„èµ·ä¼å˜åŒ–ã€‚è€Œè¿™ç¯‡æ–‡ç« ï¼Œä¸åŒäºå…¶ä»–çš„æ–‡ç« ï¼Œæ˜¯å¿…é¡»è¦åœ¨æˆ‘ååˆ†æƒ…ç»ªåŒ–çš„çŠ¶æ€ä¸‹æ‰èƒ½å†™å‡ºæ¥ã€‚</p>
<p>å°±å¥½åƒï¼Œæ¯”èµ·å¹³æ—¥é‡Œæ´»è·ƒçš„è¿‡å¤´çš„æˆ‘ï¼Œæˆ‘æ›´å€¾å‘äºè®¤ä¸ºç°åœ¨è¿™ä¸ªè‡ªå·±æ‰æ˜¯çœŸæ­£çš„è‡ªå·±ã€‚åªæœ‰åœ¨ç°åœ¨è¿™ä¸ªçŠ¶æ€ï¼Œå¯èƒ½ä¼šè¢«å«åšã€ŒæŠ‘éƒæƒ…ç»ªå †ç§¯ã€ä¹‹ç±»çš„ï¼Œæˆ‘æ‰èƒ½å¤Ÿæ„Ÿåˆ°â€œå•Šï¼ŒåŸæ¥æˆ‘è¿˜æ´»ç€â€ã€‚</p>
<p>æ­£å¦‚ï¼Œæ¯”èµ·å››å¤„é«˜å‘¼â€œä¸ºäº†å…´è¶£è€Œå­¦â€ã€â€œå‹‡æ•¢å­¦ä¸‹å»â€ã€â€œåˆ«æ”¾å¼ƒå•Šâ€çš„æˆ‘ï¼Œæˆ‘æ›´å€¾å‘äºè®¤ä¸ºé‚£ä¸ªæ‡¦å¼±æ— èƒ½çš„æˆ‘æ‰æ˜¯çœŸçš„æˆ‘ã€‚</p>
<p>æ­£å¦‚ï¼Œæˆ‘ä¸€ç›´ä»¥æ¥è®¤ä¸ºçš„ï¼Œã€ŒçŸ­æš‚çš„å¿«ä¹åªä¼šå¸¦æ¥ç©ºè™šï¼Œæ— å°½çš„æ‚²ä¼¤æ‰ä¼šå¸¦æ¥å……å®ã€ã€‚</p>
<hr>

        <div id="aplayer-woIhCZfg" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">
            <pre class="aplayer-lrc-content"></pre>
        </div>
        <script>
          var ap = new APlayer({
            element: document.getElementById("aplayer-woIhCZfg"),
            narrow: false,
            autoplay: false,
            showlrc: false,
            music: {
              title: "Space Oddity",
              author: "(Mix)",
              url: "Space Oddity.mp3",
              pic: "/2019/06/11/8/qwq.png",
              lrc: ""
            }
          });
          window.aplayers || (window.aplayers = []);
          window.aplayers.push(ap);
        </script>
<h1 id="æ—¶é—´è½´ï¼š19å¹´å¤"><a href="#æ—¶é—´è½´ï¼š19å¹´å¤" class="headerlink" title="æ—¶é—´è½´ï¼š19å¹´å¤"></a>æ—¶é—´è½´ï¼š19å¹´å¤</h1><h2 id="1"><a href="#1" class="headerlink" title="$1$"></a>$1$</h2><p>æœ€è¿‘æœ‰åœ¨çœ‹ã€Šå“ˆåˆ©Â·æ³¢ç‰¹ã€‹ï¼Œä»¥å‰ä»æœªè¯»è¿‡çš„æˆ‘ç°åœ¨ä¿¨ç„¶æˆäº†å¼‚ç±»ï¼Œä¸è¿‡å€’ä¹Ÿæ˜¯å…´è¶£ä½¿ç„¶ã€‚æœ¬æ˜¯è¯»è‹±æ–‡ç‰ˆçš„ï¼Œç¬¬ä¸€éƒ¨å´è¯»äº†æ¥è¿‘ä¸€ä¸ªæœˆï¼Œæ¯æ—¥å°è¯»10é¡µå·²ç®—ä¸é”™çš„æ”¶è·äº†ã€‚è¯»å®Œé¦–å·åå°è¯•æ•´ç†ä¸‹å•è¯ï¼Œè‹¦äºå¦‚åŒä¼¸æ‰‹æ‘˜ç¹æ˜Ÿï¼Œä¸çŸ¥ä»ä½•è€Œå§‹ï¼Œäº¦ä¸çŸ¥åˆ°ä½•å¤„æ˜¯ä¸ªå°½å¤´ã€‚äºæ˜¯ç¬¬äºŒå·ä¾¿ä¸€ç›´æç½®åœ¨ä¹¦æ¡Œçš„è§’è½ï¼Œæœªå°å¾—åˆ°æ—¶é—´ç”¨äºé˜…è¯»ã€‚</p>
<p>æ°é€¢é«˜è€ƒç«¯åˆè¿ä¼‘ï¼Œç´¢æ€§ç”¨å‡æœŸçš„æœ€åä¸€å¤©æŠŠã€Šå“ˆã€‹ç”µå½±çš„3\4\5\6çœ‹å®Œäº†ã€‚çœ‹å®Œçš„æ„Ÿè§¦è‡ªç„¶æ˜¯æœ‰çš„ï¼Œè™½ç„¶æœªè§¦åŠç»“å±€ï¼Œä½†æ—©åœ¨çŸ¥ä¹ä¸Šè¢«å‰§é€äº†ä¸ªå·®ä¸å¤šã€‚å¤§æ¦‚å°±æ˜¯ç±»ä¼¼çˆ¶æ¯çš„æ„Ÿè§‰ï¼Ÿçœ‹ç€å“ˆåˆ©ã€ç½—æ©å’Œèµ«æ•æ¯éƒ¨ç”µå½±éƒ½æ›´æˆç†Ÿçš„æ¨¡æ ·ï¼Œä¸ç¦æ„Ÿæ…¨æ—¶é—´çš„æµé€ç¡®æ˜¯ä¸€å»ä¸å›ï¼Œé¡ºä¾¿ä¹Ÿä¸ºè‡ªå·±ä¸€åªæ²¡æœ‰è¿‡é“ä¸‰è§’é‚£æ ·é‡‘çŸ³å¯é•‚çš„å‹æƒ…è€Œå¿§ä¼¤ï¼Œå¤§æ¦‚æ˜¯è‡ªå·±å¤ªå­¤ç‹¬äº†å§ã€‚</p>
<p>ä½†æˆ‘å´å¾ˆåœ¨æ„ä¸€ä¸ªæ–°å‡ºåœºçš„äººç‰©ï¼Œå¢å¨œï¼Œå¢å¨œÂ·æ´›å¤«å¤å¾·ã€‚å¥¹æ˜¯åæœŸâ€œé“å…­è§’â€çš„ä¸€å‘˜ï¼Œç»å¸¸åœ¨å“ˆåˆ©éœ€è¦çš„æ—¶å€™å¸®åŠ©ä»–â€”â€”ä½†è¿™ä¸æ˜¯æœ€é‡è¦çš„ï¼Œæœ€é‡è¦çš„æ˜¯ï¼Œä¸çŸ¥ä¸ºä½•ï¼Œå¥¹ä¼¼ä¹å¯¹æˆ‘æœ‰ä¸€ç§å¤©ç„¶çš„å¸å¼•åŠ›ï¼Œ$\rm{gorgerous}$ï¼Œå°±æ˜¯è¿™ä¸ªè¯ã€‚å¯èƒ½æ˜¯å› ä¸ºæ‰®æ¼”è¿™ä¸ªè§’è‰²çš„æ¼”å‘˜æ¼”ç»çš„å¤ªå®Œç¾äº†ï¼ŒæŠŠç²¾çµ/ç©ºçµã€æœºæ•/ç¿æ™ºçš„æ··åˆæ¼”ç»çš„æ ©æ ©å¦‚ç”Ÿï¼Œä¹Ÿå¯èƒ½æ˜¯è§’è‰²æœ¬èº«å°±å¾ˆè®¨å–œï¼Œæˆ–è€…è¯´æ‰®æ¼”è€…è‡ªå·±çš„é¢œå€¼åŠ äº†å¾ˆå¤§çš„åˆ†ï¼ˆæˆ‘è®¤ä¸ºæ˜¯å¾ˆæ¼‚äº®çš„ï¼‰â€”â€”æ€»ä¹‹ï¼Œæˆ‘æ‰æ˜ç™½å¦‚æœåœ¨æˆ‘çš„æ¢¦å¢ƒé‡Œå‡ºç°ä¸€ä½ç±»ä¼¼â€œæ´›ç¥â€çš„å­˜åœ¨ï¼Œé‚£å½¢è±¡å¤§æ¦‚å°±æ˜¯å¥¹ï¼Œå¢å¨œï¼Œçš„æ ·å­äº†ã€‚æ— è®ºæ˜¯å°è¯´é‡Œçš„æå†™ã€ç”µå½±é‡Œçš„æ¼”ç»ï¼Œäº¦æˆ–è€…æ˜¯æ‚ç³…ï¼Œæˆ‘éƒ½æ¬£ç„¶æ¥å—è¿™æ ·ä¸€ä½ç²¾çµå…¥é©»æˆ‘é¥ä¸å¯åŠçš„æ¢¦ã€‚</p>
<p>æˆ‘è¿™ç§æ„Ÿæƒ…ç¼˜ä½•è€Œèµ·å‘¢ï¼Ÿå¤§æ¦‚æ˜¯å¥¹èº«ä¸Šçš„é‚£ç§è¶…ç„¶è„±ä¿—çš„æ„Ÿè§‰å§ã€‚åœ¨ç”µå½±é‡Œï¼Œæ‰®æ¼”è€…æ°å¦‚å…¶åˆ†åœ°æŠŠå¢å¨œçš„è¶…ç„¶æ¼”ç»äº†å‡ºæ¥â€”â€”å¥¹çœ‹å¾—é€ç”Ÿæ­»ï¼Œçœ‹å¾—é€å“ˆåˆ©æœ‰å¤šéš¾è¿‡ï¼Œçœ‹å¾—é€ä¸€åˆ‡ï¼Œå´åˆåƒä¸€å—æ— ç‘•çš„å®ç‰ä¸å—æ²¾æŸ“ã€‚å¤§æ¦‚æ˜¯å› ä¸ºå‡ ä¹æ‰€æœ‰äººï¼ŒåŠæ—¶å¤©æ€§æ˜¯å–„çš„ï¼Œä¹Ÿä¼šå› ä¸ºåå¤©çŸ¥è¯†çš„è¾“å…¥ã€é˜…å†çš„å¢é•¿è€Œå˜å¾—æ··æµŠã€æ‰­æ›²ã€çº ç»“ã€è¿·èŒ«ï¼Œä½†å¥¹ä¼¼ä¹å¹¶æ²¡æœ‰ã€‚ä¹¦ä¸­çš„è®¾å®šï¼Œå¥¹æ˜¯æ‹‰æ–‡å…‹åŠ³çš„å­¦ç”Ÿï¼Œå¹¶ä¸”æœ‰ç€æ‹‰æ–‡å…‹åŠ³äººå›ºæœ‰çš„èªæ…§æœºæ•ï¼Œä½†æ˜¯é‚£ä¸€åˆ‡ä¼¼ä¹éƒ½æ²¡æœ‰æˆä¸ºå¥¹è¶…è„±çš„æ·é”ã€‚</p>
<p>å¥¹æœ‰çˆ±ï¼Œå¿ƒä¸­æœ‰è¯´ä¸å‡ºçš„æ¸©åº¦ã€‚å¥¹çš„çˆ¶äº²æ˜¯æŸæœ¬å¥‡å¦™çš„ç•…é”€æ‚å¿—ã€ŠThe Quibblerï¼ˆå”±å”±åè°ƒï¼‰ã€‹çš„ä¸»ç¼–ã€‚é‚£æ˜¯ä¸€æœ¬è¢«èµ«æ•å«Œå¼ƒçš„å¥‡æ€ªçš„æ‚å¿—ï¼Œä½†å¥¹å´å¾ˆå–œæ¬¢ï¼Œå¹¶ä¸”å››å¤„æ¨é”€ï¼Œç”¨å¥¹é‚£ç²¾çµä¸€èˆ¬çš„å—“éŸ³æ¨é”€â€”â€”çœ‹åˆ°é‚£å„¿æ—¶ï¼Œæˆ‘çªç„¶æ„Ÿè§‰æœ‰ä»€ä¹ˆä¸œè¥¿å¼€å§‹åœ¨é»‘æš—é‡Œå‘å…‰ã€‚å“ˆåˆ©æ³¢ç‰¹åˆ°äº†åæœŸï¼Œå®Œå…¨å˜æˆäº†é»‘æš—ç«¥è¯ï¼Œå……æ»¡äº†ç´§å¼ ã€å–§åš£å’Œå‹æŠ‘ã€‚ä½†æ¯æ¬¡å¢å¨œä¸€å‡ºç°ï¼Œåªè¦è¯´å‡ å¥è¯ï¼Œä¼¼ä¹å°±å¯ä»¥é©¬ä¸Šå‘¼å”¤ä¸€é˜µæ¸…é£å¾æ¥ï¼Œæ¶¤è¡å¿ƒçµã€‚</p>
<p><img src="http://b-ssl.duitang.com/uploads/item/201701/29/20170129133646_i5Bh3.thumb.224_0.gif" alt></p>
<p>é‚£æ˜¯æ¢¦ï¼Œæ˜¯é¥é¥æ— æœŸçš„æ¢¦ï¼Œæ¢¦é‡Œæœ‰å¥¹ï¼Œä¸€ä¸ªè™šæ„çš„äººç‰©ï¼Œæœ‰ç€ä¸å­˜åœ¨çš„èº«ä»½ï¼Œä¸å­˜åœ¨çš„éŸ³å®¹ç¬‘è²Œã€‚æˆ‘ç‰¹æ„å»æœç´¢è¿‡æ‰®æ¼”è€…çš„ç›¸å…³ä¿¡æ¯ï¼Œå‘ç°æˆå¹´åçš„æ‰®æ¼”è€…ä¼¼ä¹å¹¶ä¸å‡ºå½©ï¼Œèº«ä¸Šå†ä¹Ÿæ²¡æœ‰é‚£ç§ç²¾çµçš„æ°”æ¯ã€‚</p>
<p>å¥½åœ¨ç”±äºæ—¶é—´å®åœ¨ä¸å¤Ÿç”¨ï¼Œåªèƒ½çœ‹åˆ°ã€Šæ··è¡€ç‹å­ã€‹ã€‚ä¹‹åè¿˜æœ‰ä¸¤éƒ¨å†³å®šç•™åœ¨ä¸‹æ¬¡å¤§ä¼‘ï¼Œä¹Ÿå°±æ˜¯åˆæ ¼è€ƒä¹‹åçœ‹ã€‚æˆ‘çŒœå¤§æ¦‚æˆ‘çœ‹å®Œå…¨éƒ¨çš„ã€Šå“ˆã€‹ä¹‹åï¼Œè‡ªå·±ä¼šå˜å¾—å¾ˆæƒ†æ€…â€”â€”æƒ†æ€…å¥½å‡ å¤©çš„é‚£ç§å§ï¼Œæ¯•ç«Ÿä¸Šæ¬¡çœ‹å®Œã€Šè¨€å¶ä¹‹åº­ã€‹å°±æ˜¯è¿™æ ·ã€‚ç¾å¥½çš„ä¸œè¥¿ç»“æŸäº†ï¼Œæ€»æ˜¯æ„Ÿè§‰å¾ˆæ‚²ä¼¤ã€‚</p>
<p>ä½†å¤©ä¸‹æ²¡æœ‰ä¸æ•£çš„å®´å¸­ï¼Œä½ è¯´å¯¹å§ã€‚å“¦ï¼Œå¯¹ï¼Œè¿™å¥è¯æˆ‘ç¬¬ä¸€æ¬¡è§è¿˜æ˜¯åœ¨ã€Šå®¶æœ‰å„¿å¥³ã€‹é‡Œé¢å‘¢ã€‚</p>
<h2 id="2"><a href="#2" class="headerlink" title="$2$"></a>$2$</h2><p>ä½†å…¶å®ï¼Œæˆ‘æ›´å‘å¾€çš„ï¼Œæ˜¯è¿™ä¹ˆä¸€ç§ç”Ÿæ´»ï¼Œè¿™ä¹ˆä¸€ç§æ— å¿§æ— è™‘çš„ç”Ÿæ´»å§ï¼Ÿ</p>
<p>ä¸€ä¸ªäººï¼Œé™é™åœ°å¾…åœ¨ä¸€ä¸ªå››å‘¨æœ‰ç€è¿ç»µèœ¿èœ’çš„å±±ã€é™é™æµæ·Œçš„æ°´ï¼Œå¤§åœ°è¢«ä¸€æœ›æ— å°½çš„ã€è½¯ç»µç»µçš„ç»¿è‰è¦†ç›–ï¼Œå¤©ä¸å±±ä¸æ°´ä¹‹é—´åªæœ‰ä¸€é—´å°å°çš„æ£šå±‹ï¼Œç”¨çŸ³å¤´å’çš„ï¼Œå¯èƒ½ä¼šæœ‰ç€çº¢è‰²çš„é¡¶ï¼Œä½†é‚£æ ·å¤ªçªå…€ï¼›å¯èƒ½ä¼šæœ‰ç€æ£•è‰²çš„é¡¶ï¼Œä½†é‚£æ ·å¤ªæ²‰å¯‚ã€‚å±‹é‡Œç‚‰å­ä¸Šç…®ç€èŒ¶æˆ–è€…å’–å•¡ï¼Œä¸€å¼ ç®€å•ä½†æ˜¯æ¸©æš–çš„åºŠï¼Œä¸€åºŠè“¬æ¾åˆ°æ°å¥½çš„è¢«å­ï¼Œä¸€åªæ²¡é‚£ä¹ˆæŸ”è½¯çš„æ•å¤´ï¼Œå‡ æŠŠå¸¦èƒŒå„¿çš„æ¤…å­ï¼Œä¸€å¼ å¤è‰²å¤é¦™çš„æ¡Œå­ã€‚æˆ¿é‡Œï¼Œå¢™ä¸Šå¯èƒ½ä¼šæ”¾ç€ä¸€ä¸¤åªç²¾è‡´çš„æŒ‚é’Ÿï¼Œæ¡Œä¸Šå¯èƒ½ä¼šæ”¾ç€ä¸€ä¸ªæ’æœ‰å„è‰²é²œè‰³èŠ±å„¿çš„èŠ±ç“¶ã€‚</p>
<p>å¹³æ—¶æˆ‘å”¯ä¸€åšçš„äº‹ï¼Œå°±æ˜¯ååœ¨å±±å¡ä¸Šï¼Œæ„Ÿå—ç€è‰çš„æŸ”è½¯ä¸ç»†è…»ï¼Œç›®é€ç€å¤©è¾¹äº‘å½©çš„æ¥å»åŒ†åŒ†ï¼Œçœºæœ›ç€æ½ºæ½ºæµè¿‡çš„æ²³æµã€‚å¯èƒ½ï¼Œåœ¨ä¸€æœ›æ— é™…é—´ï¼Œä¼šæœ‰ä¸€æ£µå¤§å¤§çš„æ ‘ï¼Œæœ‰æ—¶æˆ‘ä¹Ÿä¼šçˆ¬ä¸Šæ ‘æ¢¢ï¼Œæ— å¥ˆæ–œé˜³æ¥äº†åˆå»ï¼Œæ„Ÿæ…¨æ˜Ÿç‚¹æ¥äº†åˆå›ã€‚</p>
<p>æ˜¯å•Šï¼Œå°±è®©æˆ‘ä¸€ä¸ªäººï¼ŒåŸè¿œç¦»è¿™ä¸ªä¸–ç•Œï¼Œä¸è¡Œå—ï¼Ÿ</p>
<p>æˆ‘ä¸€ç›´åœ¨æƒ³ï¼Œæ—¢ç„¶æˆ‘çŸ¥é“æœ‰å¾ˆç®€å•å¾ˆç®€å•çš„ç”Ÿæ´»ï¼Œä½†ä¸ºä»€ä¹ˆæˆ‘æ¯å¤©éƒ½æ´»åœ¨æƒ¶æã€æ´»åœ¨å¿§è™‘ã€æ´»åœ¨æ— å¥ˆä¸­ï¼Ÿæˆ‘å—å¤Ÿäº†å› ä¸ºä¸€ç‚¹ç¾å¥½çš„æœºé‡è€Œæ²¾æ²¾è‡ªå–œã€å› ä¸ºä¸€ç‚¹ä¸å ªçš„ç»å†å°±è¦æ‹…æƒŠå—æ€•çš„æ—¥å­äº†ã€‚æˆ‘å—å¤Ÿè¿™å¿…é¡»è¦å¿å—ä¸€åˆ‡ã€å¿…é¡»è¦æé˜²ä¸€åˆ‡çš„æ—¥å­äº†ã€‚æˆ‘å—å¤Ÿè¿™ç§ä¸å¤Ÿå•è°ƒçš„æ—¥å­äº†ã€‚</p>
<p>æ˜¯å•Šï¼Œè¿™ç§è·Œå®•èµ·ä¼çš„ç”Ÿæ´»æ‰æœ‰è¶£ï¼Œæˆ‘åˆä½•å°ä¸çŸ¥é“ï¼Ÿ</p>
<p>ä½†ï¼Œæˆ‘ä¸æƒ³äº†å•Šï¼Œåªæ˜¯è§‰å¾—ï¼Œå¤ªéš¾èµ°ä¸‹å»äº†å•Šã€‚</p>
<p>ã€Œåœ°çƒonlineã€è¿™ä¸ªæ¸¸æˆï¼Œç¡®å®ä¸å…¬å¹³å§ã€‚è§„åˆ™é™å®šäº†åªæœ‰å‰è¿›çš„äººæ‰èƒ½æ´»ä¸‹å»ï¼Œå‰¥å¤ºäº†æƒ³è¦åŸåœ°è¸æ­¥çš„äººçš„æƒåˆ©ã€‚æ‰€ä»¥è®½åˆºçš„æ˜¯ï¼Œæˆ–è®¸ä¸–ç•Œä¸Šæœ€éš¾çš„äº‹ï¼Œå°±æ˜¯ã€Œè¿‡æœ€ç®€å•çš„ç”Ÿæ´»ã€è¿™ä»¶äº‹å§ã€‚</p>
<p>ä¸ºä»€ä¹ˆï¼Œè¿ã€Œæˆ‘å’Œä¸–ç•Œäº’ç›¸å¿˜è®°ã€è¿™ç§å¯¹æ•´ä¸ªæ¸¸æˆæ ¹æœ¬æ— å…³ç—›ç—’çš„å†³ç­–ï¼Œä¹Ÿä¸æ˜¯å…è´¹çš„å‘¢ï¼Ÿ</p>
<h2 id="3"><a href="#3" class="headerlink" title="$3$"></a>$3$</h2><p>å—¯ï¼Œèƒ†å°å•Šã€æ‡¦å¼±å•Šï¼Œæˆ‘çŸ¥é“ã€‚</p>
<p>ã€Œé™¤äº†å‹‡æ°”ï¼Œæˆ‘ä»€ä¹ˆéƒ½ä¸ç¼ºã€‚ã€è¿™è¯ï¼Œæœ¬å°±æ˜¯è¯´ç»™è‡ªå·±å¬çš„ã€‚ã€Œæœªæ¥çš„è·¯åˆåœ¨å“ªå‘¢ï¼Ÿã€è¿™è¯ï¼Œè¯´äº†åƒç™¾éä¹Ÿè¿˜æ˜¯é¢“å”ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼ŒæŠŠæˆ‘ç»‘æ¶åˆ°åŠ æ‹¿å¤§åŒ—éƒ¨ã€ç‘å£«ã€ä¸¹éº¦ä¹‹ç±»çš„åœ°æ–¹â€”â€”è®©è¿™ä¸–ç•Œï¼Œå¿˜äº†æˆ‘å§ã€‚</p>
<h1 id="æ—¶é—´è½´ï¼š2019å¹´ç§‹"><a href="#æ—¶é—´è½´ï¼š2019å¹´ç§‹" class="headerlink" title="æ—¶é—´è½´ï¼š2019å¹´ç§‹"></a>æ—¶é—´è½´ï¼š2019å¹´ç§‹</h1>]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>éšæƒ³/ä¸‹ä¸‹ç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>Pruferåºåˆ—æ³›åš</title>
    <url>/2019/05/26/Prufer%E5%BA%8F%E5%88%97%E6%B3%9B%E5%81%9A/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>Pruferæ•°åˆ—æ˜¯æ— æ ¹æ ‘çš„ä¸€ç§æ•°åˆ—ï¼Œå¸¸ç”¨æ¥æ±‚è§£æ ‘çš„è®¡æ•°é—®é¢˜ã€‚</p>
</blockquote>
<a id="more"></a>
<h1 id="Preface"><a href="#Preface" class="headerlink" title="$Preface$"></a>$Preface$</h1><p>å—¯ï¼Œæœ€è¿‘å­¦äº†å­¦ä¸€ä¸ªå«åš<code>Prufer</code>åºåˆ—çš„ä¸œè¥¿ï¼Œç„¶åä¸»è¦æ˜¯è·Ÿæ ‘çš„è®¡æ•°æœ‰å…³ã€‚</p>
<h2 id="åŸºæœ¬æ¦‚å¿µä¸åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ¦‚å¿µä¸åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µä¸åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ¦‚å¿µä¸åŸºæœ¬æ“ä½œ</h2><p>é¦–å…ˆä¸‹å®šä¹‰ï¼šPruferåºåˆ—æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º$n-2$çš„åºåˆ—ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘ç»™å®šä¸€æ£µå¸¦æ ‡å·çš„æ— æ ¹æ ‘ï¼Œæ‰¾å‡ºç¼–å·æœ€å°çš„å¶å­èŠ‚ç‚¹ï¼Œå†™ä¸‹ä¸å®ƒç›¸é‚»çš„èŠ‚ç‚¹çš„ç¼–å·ï¼Œç„¶ååˆ æ‰è¿™ä¸ªå¶å­èŠ‚ç‚¹ã€‚åå¤æ‰§è¡Œè¿™ä¸ªæ“ä½œç›´åˆ°åªå‰©ä¸¤ä¸ªèŠ‚ç‚¹ä¸ºæ­¢ã€‚ç”±äºèŠ‚ç‚¹æ•°$n&gt;2$çš„æ ‘æ€»å­˜åœ¨å¶å­èŠ‚ç‚¹ï¼Œå› æ­¤ä¸€æ£µ$n$ä¸ªèŠ‚ç‚¹çš„æ— æ ¹æ ‘å”¯ä¸€åœ°å¯¹åº”äº†ä¸€ä¸ªé•¿åº¦ä¸º$n-2$çš„æ•°åˆ—ï¼Œæ•°åˆ—ä¸­çš„æ¯ä¸ªæ•°éƒ½åœ¨$1$åˆ°$n$çš„èŒƒå›´å†…ã€‚è€Œè¿™å°±æ˜¯è¿™æ£µæ ‘çš„$\boldsymbol{Prufer}$<strong>åºåˆ—</strong>ã€‚</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆæ˜¯$n-2$ï¼Ÿ</p>
<p>æˆ‘ä»¬è§‚å¯Ÿä¸€æ£µæ ‘ï¼Œ$n-1$æ¡æ— å‘è¾¹å†³å®šäº†æ€»åº¦æ•°ä¸º$2n-2$ï¼ŒåŒæ—¶ç”±äºæ¯ä¸ªèŠ‚ç‚¹å½“è‡ªå·±æ˜¯è¢«åˆ æˆå¶å­çš„æ—¶å€™ä¸ä¼šè¢«ç®—è¿›å»ï¼Œæ‰€ä»¥æ¯ä¸ªèŠ‚ç‚¹éœ€è¦å‡å»ä¸€çš„è´¡çŒ®ï¼Œæ¢å¥è¯è¯´å°±æ˜¯$Prufer$åºåˆ—çš„é•¿åº¦ä¸º$n-2$ã€‚</p>
</blockquote>
<p>emmmç„¶åä¸€ä¸ªæ¯”è¾ƒå¹³å‡¡çš„ç»“è®ºå°±æ˜¯<strong>$\boldsymbol{P rufer}$åºåˆ—ä¸­æŸä¸ªç¼–å·å‡ºç°çš„æ¬¡æ•°å°±ç­‰äºè¿™ä¸ªç¼–å·çš„èŠ‚ç‚¹åœ¨æ— æ ¹æ ‘ä¸­çš„åº¦æ•°-1ã€‚</strong></p>
<p>åŒæ—¶æˆ‘ä»¬æ¥ä¸‹æ¥è¦ä¸åŠ è¯æ˜åœ°æ–­è¨€<strong>ä»»ä½•ä¸€ä¸ªé•¿ä¸º$n-2$ã€å–å€¼èŒƒå›´åœ¨$1$åˆ°$n$ä¹‹é—´çš„æ•°åˆ—éƒ½å”¯ä¸€åœ°å¯¹åº”äº†ä¸€æ£µ$n$ä¸ªèŠ‚ç‚¹çš„æ— æ ¹æ ‘.</strong></p>
<p><del>ä¸¥æ ¼è¯æ˜å¤§å®¶å¯ä»¥å»Mt67çš„åšå®¢ä¸Šç¿»ï¼ˆ</del></p>
<p>æƒ³è¦æ›´å¥½çš„æ„ä¼šä»¥ä¸Šå†…å®¹ï¼Œéœ€è¦æˆ‘ä»¬è€ƒè™‘å¦‚ä½•å®ç°Pruferçš„å‘ˆç°ä¸å¤åŸï¼š(æ‘˜è‡ª<code>ProJ7-Jeffy</code>çš„åšå®¢)</p>
<p>ï¼ˆ1ï¼‰æ— æ ¹æ ‘è½¬åŒ–ä¸º $Prufer$ åºåˆ—ã€‚<br>é¦–å…ˆå®šä¹‰æ— æ ¹æ ‘ä¸­åº¦æ•°ä¸º<code>1</code>çš„èŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹ã€‚<br>æ‰¾åˆ°ç¼–å·æœ€å°çš„å¶å­å¹¶åˆ é™¤ï¼Œåºåˆ—ä¸­æ·»åŠ ä¸ä¹‹ç›¸è¿çš„èŠ‚ç‚¹ç¼–å·ï¼Œé‡å¤æ‰§è¡Œç›´åˆ°åªå‰©ä¸‹<code>2</code>ä¸ªèŠ‚ç‚¹ã€‚<br>å¦‚ä¸‹å›¾çš„æ ‘å¯¹åº”çš„ $Prufer$ åºåˆ—å°±æ˜¯ <code>3ï¼Œ5ï¼Œ1ï¼Œ3</code>ã€‚<br><img src="1.png" alt><br>å…·ä½“å®ç°å¯ä»¥ç”¨ä¸€ä¸ª <code>set</code> æå®šï¼Œç»´æŠ¤åº¦æ•°ä¸º <code>1</code> çš„èŠ‚ç‚¹ã€‚å¤æ‚åº¦ $O(n\log n)$ã€‚<br>ï¼ˆ2ï¼‰$Prufer$åºåˆ—è½¬åŒ–ä¸ºæ— æ ¹æ ‘ã€‚<br>è®¾ç‚¹é›† <code>V={1,2,3,...,n}</code>ï¼Œæ¯æ¬¡å–å‡º $Prufer$ åºåˆ—ä¸­æœ€å‰é¢çš„å…ƒç´ $u$ï¼Œåœ¨<code>V</code>ä¸­æ‰¾åˆ°ç¼–å·æœ€å°çš„æ²¡æœ‰åœ¨ $Prufer$ åºåˆ—ä¸­å‡ºç°çš„å…ƒç´ $v$ï¼Œç»™ $uï¼Œv$ è¿è¾¹ç„¶ååˆ†åˆ«åˆ é™¤ï¼Œæœ€ååœ¨ <code>V</code> ä¸­å‰©ä¸‹ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œç»™å®ƒä»¬è¿è¾¹ã€‚æœ€ç»ˆå¾—åˆ°çš„å°±æ˜¯æ— æ ¹æ ‘ã€‚<br>å…·ä½“å®ç°ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ª <code>set</code>ï¼Œç»´æŠ¤ $Prufer$ åºåˆ—ä¸­æ²¡æœ‰å‡ºç°çš„ç¼–å·ã€‚å¤æ‚åº¦ $O(n\log nï¼‰$ã€‚ </p>
<h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><ul>
<li><p>$n$ä¸ªç‚¹æœ‰æ ‡å·æ— æ ¹æ ‘å…±æœ‰$n^{n-2}$ç§ã€‚</p>
<ul>
<li>$\rm{Proof}:$ ä»”ç»†æƒ³æƒ³â€¦ä¼¼ä¹Pruferåºåˆ—ä¸€å…±$n-2$é¡¹ï¼Œäºæ˜¯å°±ä¹˜æ³•åŸç†å°±å¥½äº†â€¦â€¦</li>
</ul>
</li>
<li>æ¥ä¸Šä¸€ä¸ªï¼Œæœ‰æ ¹æ ‘çš„è¯å› ä¸ºå¯¹äºæ¯ç§æ–¹æ¡ˆé‡Œé¢çš„$n$ä¸ªç‚¹éƒ½å¯ä»¥å½“ä½œæ ¹ï¼Œæ‰€ä»¥æ€»æ•°é‡æ˜¯$n^{n-2}\cdot n=n^{n-1}$ã€‚</li>
</ul>
<hr>
<ul>
<li><p>å‡è®¾æ¯ä¸ªç‚¹çš„åº¦æ•°å·²ç»ç¡®å®šäº†ï¼Œè®¾ç¬¬$i$å·ç‚¹çš„åº¦æ•°ä¸º$d_i$ï¼Œåˆ™æ˜¾ç„¶æœ‰$\sum_{i=1}^{n}(d_i - 1)=n-2$ï¼Œé‚£ä¹ˆå¯¹äºæ¯ä¸ªèŠ‚ç‚¹åº¦æ•°ç¡®å®šçš„å¸¦æ ‡å·æ— æ ¹æ ‘æ•°é‡å°±æ˜¯</p>
<script type="math/tex; mode=display">
\frac{(n-2)!}{\prod_{i=1}^n(d_i-1)}</script><ul>
<li>$\rm{Proof}:$ å¤§æ¦‚æ˜¯ä¸€ä¸ªæ’åˆ—ç»„åˆçš„æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯ä¸€å…±$n$ç§å…ƒç´ ï¼Œé€‰$n-2$ä¸ªï¼Œæ¯ç§å…ƒç´ æœ‰ä¸”å¿…é¡»æœ‰$d_i-1$ä¸ªï¼Œæ±‚æ’åˆ—æ•°ã€‚ç„¶åæ¯”è¾ƒæ˜¾ç„¶çš„æ˜¯$(n-2)!$æ˜¯æ€»æ’åˆ—æ•°ï¼Œè€Œæ¯ä¸ªå…ƒç´ ä¸€å…±æœ‰$d_i-1$ä¸ªä½ç½®ï¼Œå¯¹äºåŒä¸€ç§å…ƒç´ çš„åŒä¸€ç§ä½ç½®æ’å¸ƒï¼Œæˆ‘ä»¬å¤šç®—äº†$A_{(d_i-1)}^{(d_i-1)}=(d_i-1)!$æ¬¡çš„ï¼Œæ‰€ä»¥åˆ†æ¯ä¸Šä¹˜æ³•åŸç†èµ·æ¥å»é™¤è¿™äº›è´¡çŒ®å°±å¥½ã€‚</li>
</ul>
</li>
<li><p>æ¥ä¸Šä¸€ä¸ª, $n$ ä¸ªèŠ‚ç‚¹çš„åº¦ä¾æ¬¡ä¸º $d_1,d_2,â€¦,d_{n-m}$ï¼Œå¦å¤–æœ‰ $m$ ä¸ªèŠ‚ç‚¹åº¦æ•°æœªçŸ¥ï¼Œæ±‚æœ‰å¤šå°‘ç§ç”Ÿæˆæ ‘ï¼Ÿ</p>
<ul>
<li>æˆ‘ä»¬è€ƒè™‘é¦–å…ˆè®¡ç®—ä¸€ä¸‹$Prufer$åºåˆ—è¯¥å‰©ä¸‹å¤šå°‘æœªçŸ¥é¡¹ï¼Œè®¾å…¶æ•°ç›®ä¸º$\omega$ï¼Œåˆ™$\omega=(n-2)-\sum_{d_i ~is~known} (d_i-1)$ã€‚é‚£ä¹ˆæœ¬ç€ç**å»é‡çš„åŸåˆ™ï¼Œæˆ‘ä»¬è€ƒè™‘åº”è¯¥åœ¨åˆ†æ¯ä¸Šä¹˜ä¸€ä¸ª$\omega!$ã€‚è€ŒåŒæ—¶ç”±äºæˆ‘ä»¬å­˜åœ¨$m$ä¸ªåº¦æ•°å¹¶æœªç¡®å®šçš„ç‚¹ï¼Œåœ¨$Prufer$åºåˆ—ä¸­å æ®äº†$\omega$ä¸ªä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ†å­ä¸Šåº”è¯¥å†ä¹˜ä¸Šä¸€ä¸ª$m^{\omega}$ã€‚æ•…æ€»æ–¹æ¡ˆæ•°å°±å˜æˆäº†ï¼š</li>
</ul>
</li>
</ul>
<script type="math/tex; mode=display">
\frac{(n-2)!m^{\omega}}{\omega!\cdot \prod_{i=1}^{n-m}(d_i-1)}</script><h1 id="A-HNOI2008-æ˜æ˜çš„çƒ¦æ¼"><a href="#A-HNOI2008-æ˜æ˜çš„çƒ¦æ¼" class="headerlink" title="$A$ [HNOI2008]æ˜æ˜çš„çƒ¦æ¼"></a>$A$ [HNOI2008]æ˜æ˜çš„çƒ¦æ¼</h1><p><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=1005" target="_blank" rel="noopener">bzoj1005</a></p>
<p>å…¶å®å°±æ˜¯ä¸Šé¢<code>æ‰©å±•</code>é‡Œé¢çš„ä¸€ä¸ªæ¨è®ºï¼Œç„¶åæˆ‘ä»¬å°±ç”¨<code>python</code>æ°´è¿‡å»å°±å¥½äº†233</p>
<p><del>ç„¶è€ŒBZOJçš„Pyåªä¼šä¸€ç›´Pendingï¼Œæ‰€ä»¥è¿˜æ˜¯ä»€ä¹ˆæ—¶å€™å†å†™ä¸€å‘é«˜ç²¾åº¦å§</del></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">N = input()</span><br><span class="line">Fac = [<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, N - <span class="number">1</span>) :</span><br><span class="line">    Fac = Fac + [Fac[i - <span class="number">1</span>] * i]</span><br><span class="line">Ans = Fac[N - <span class="number">2</span>]</span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line">Sum = N - <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, N) :</span><br><span class="line">    di = input()</span><br><span class="line">    <span class="keyword">if</span> di == <span class="number">-1</span> :</span><br><span class="line">    	cnt = cnt + <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span> : </span><br><span class="line">        Ans = Ans / Fac[di - <span class="number">1</span>]</span><br><span class="line">        Sum = Sum - (di - <span class="number">1</span>)</span><br><span class="line">Ans = Ans / Fac[Sum]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, Sum) :</span><br><span class="line">    Ans = Ans * cnt</span><br><span class="line"><span class="keyword">print</span> (Ans)</span><br></pre></td></tr></table></figure>
<h1 id="B-å°çŒ´æ‰“æ¶"><a href="#B-å°çŒ´æ‰“æ¶" class="headerlink" title="$B$ å°çŒ´æ‰“æ¶"></a>$B$ å°çŒ´æ‰“æ¶</h1><p>ç”±äºåœ¨BZOJä¸Šæ˜¯æƒé™é¢˜ï¼Œæ‰€ä»¥ä¸å¾—å·²å»Luoguåšâ€¦<del>å›½å†…æœ€å¤§çš„ç›—ç‰ˆé¢˜å¸‚åœº</del></p>
<p><a href="https://www.luogu.org/problemnew/show/P4430" target="_blank" rel="noopener">Luogu4430</a></p>
<p> æˆ‘ä»¬å‘ç°è¿™ä¸ªé¢˜çš„Aimåœ¨äºè®©æˆ‘ä»¬æ±‚æ— æ ¹æ ‘æœ‰å¤šå°‘ç§ä¸åŒçš„ç”Ÿæˆæ–¹å¼ï¼Œæ¯”æ™®é€šçš„Pruferåºåˆ—å¤šä¸€ä¸ªåŠ è¾¹çš„é¡ºåºâ€”â€”æ¯•ç«ŸPruferåªèƒ½å¤„ç†æ ‘çš„å½¢æ€ä¸åŒ&amp;æ ‡å·ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬ç†æ‰€å½“ç„¶åœ°ä¹˜ä¸Šä¸€ä¸ª$(n-1)!$ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;<span class="comment">//ç”¨sbä»£ç æ¥å¡«è¡¥åšæ–‡å¤ªçŸ­çš„ç©ºç™½</span></span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ; Frac[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt; N ; ++ i) (Ans *= N) %= Mod ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) Frac[i] = Frac[i - <span class="number">1</span>] * i % Mod ;</span><br><span class="line">	(Ans *= Frac[N - <span class="number">1</span>]) %= Mod, <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>BZOJ</category>
      </categories>
      <tags>
        <tag>Pruferåºåˆ—</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘CF#Global Round 1ã®é¢˜è§£(A $\to$ G)</title>
    <url>/2019/05/10/Codeforces-1110/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è‡ªä»çœé€‰å®Œä¹‹åçŠ¶æ€ä¸€ç›´ä¸ä½³ï¼Œæ„Ÿè§‰è‡ªå·±åˆšç‡ƒèµ·çš„å¸Œæœ›åˆç†„ç­äº†ã€‚æ‰€ä»¥å°±æ‰“ç®—æ¥æ•´ç†ä¸€ä¸‹çœé€‰ä¹‹å‰å› ä¸ºæ‡’è€Œæ²¡æ•´çš„ä¸€äº›é¢˜ã€‚ç„¶åä½ ä¼šå‘ç°å‰ä¸¤å¥è¯ä¸€ç‚¹å…³ç³»éƒ½æ²¡æœ‰XD</p>
<p>è¿™é‡Œæ˜¯æ€»é“¾æ¥<a href="http://codeforces.com/contest/1110" target="_blank" rel="noopener">$Link$</a>.</p>
<h1 id="A"><a href="#A" class="headerlink" title="$A$"></a>$A$</h1><p><img src="https://img.shields.io/badge/éš¾åº¦-æ™®åŠï¼-yellow.svg" alt></p>
<p>é¢˜æ„ï¼šæ±‚$\sum_{i=1}^{k} a_i\times b^{k-i}$çš„å¥‡å¶æ€§ï¼Œ $k = \Theta(n \log n)$ </p>
<p>â€¦â€¦å…¶å®å¾ˆå®¹æ˜“æƒ³éº»çƒ¦ï¼Œæ¯”å¦‚è¯´é€ä¸ªåˆ¤æ–­ï¼Œæ•´ä½“åˆ¤æ–­å•¥çš„ã€‚ä½†å…¶å®åªè¦å¯¹ç»“æœéƒ½$\bmod ~10$ï¼Œç„¶ååˆ¤æ–­å¥‡å¶æ€§å°±å¥½äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cin</span> &gt;&gt; b &gt;&gt; k ;</span><br><span class="line">   <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= k ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">   reverse (base + <span class="number">1</span>, base + k + <span class="number">1</span>) ;</span><br><span class="line">   <span class="keyword">for</span> (i = k ; i &gt;= <span class="number">1</span> ; -- i) Sum = Sum * b + base[i], Sum %= <span class="number">10</span> ;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; (Sum &amp; <span class="number">1</span> ? <span class="string">"odd"</span> : <span class="string">"even"</span>) &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br></pre></td></tr></table></figure>
<p><del>å…¶å®å°±æ˜¯åœ¨æ°´å­—æ•°</del></p>
<h1 id="B"><a href="#B" class="headerlink" title="$B$"></a>$B$</h1><p><img src="https://img.shields.io/badge/éš¾åº¦-æ™®åŠ%2B-red.svg" alt></p>
<p>é¢˜æ„ï¼šç»™å®šä¸€æ¡ç½‘æ ¼çº¸ï¼Œ$n, m, k$, åˆ†åˆ«è¡¨ç¤ºç‚¹æ•°ï¼Œæ€»é•¿åº¦ï¼Œèƒ¶å¸¦çš„æ•°é‡ã€‚å¯¹äºè¾“å…¥çš„$n$ä¸ªç‚¹ï¼Œä¿è¯ä½ç½®é€’å¢ï¼Œ æ±‚è¦†ç›–æ‰€æœ‰çš„ç‚¹æ‰€éœ€çš„æœ€å°èƒ¶å¸¦é•¿åº¦ï¼ˆèƒ¶å¸¦æ•°é‡$\leq k$ï¼‰ã€‚</p>
<p>å…¶å®æ˜¯ä¸ªåˆ¶æ–é¢˜ã€‚æˆ‘ä»¬è€ƒè™‘å¦‚æœ$k$æ˜¯æ— é™å¤§ï¼Œé‚£ä¹ˆæœ€ä¼˜çš„æ–¹å¼ä¸€å®šæ˜¯å•ç‚¹è¦†ç›–ã€‚æ‰€ä»¥å¦‚æœèƒ¶å¸¦ä¸å¤Ÿçš„è¯ï¼Œå°±æ˜¯è¦å»é¢å¤–å¤šç²˜$N-k$ä¸ªç©ºç™½çš„åŒºé—´ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æ’ä¸ªåºï¼Œæ±‚å‡º$N-k$ä¸ªç©ºç™½åŒºé—´çš„é•¿åº¦ï¼Œå†åŠ ä¸Šå•ç‚¹çš„é•¿åº¦å’Œ$n$ï¼Œå¾—åˆ°ç­”æ¡ˆã€‚æ³¨æ„ç©ºç™½åŒºé—´çš„ä¸¤å¤´å¼€çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; K ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;now), (i &gt; <span class="number">1</span> ? (d[i - <span class="number">1</span>] = now - Last - <span class="number">1</span>) : <span class="number">1</span>), Last = now ;</span><br><span class="line">nth_element(d + <span class="number">1</span>, d + N - K + <span class="number">1</span>, d + N) ; <span class="comment">//Last row, now - Last + 1 -&gt; now - Last</span></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N - K ; ++ i) Ans += d[i] ; Ans += N ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br></pre></td></tr></table></figure>
<p>emmmæ€ä¹ˆè¯´å‘¢ï¼Œæ˜¯ä¸ªæ˜¾ç„¶åˆä¸æ˜¾ç„¶çš„è´ªå¿ƒï¼Œå¤§æ¦‚è¿˜æ˜¯è·Ÿ<code>OIç´ å…»</code>ç›´æ¥æŒ‚é’©çš„å§ï¼ˆsigh</p>
<h1 id="C"><a href="#C" class="headerlink" title="$C$"></a>$C$</h1><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98%2B-blue.svg" alt></p>
<p>é¢˜ç›®ç®€è¿°    :    å®šä¹‰å‡½æ•°$f(a)$</p>
<script type="math/tex; mode=display">
f(a) = \max_{0 < b < a}{\gcd(a \oplus b, a \> \& \> b)}</script><p>ç»™å‡º $q$ ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®ä¸ºä¸€ä¸ªæ•´æ•°$a_i$ã€‚ä½ éœ€è¦å¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œæ±‚å‡º$f(a_i)$çš„å€¼ã€‚$q=O(10^3),a=O(2^{25}).$</p>
<p>ä¹Ÿç®—æ˜¯æ¯”è¾ƒå·§å¦™çš„ä¸€é“é¢˜ï¼Œå½“ç„¶è¿™ä¸ªéš¾åº¦è¯„çº§æ˜¯ç»™çš„åˆ†å—æ‰“è¡¨çš„ï¼Œæ¯•ç«Ÿæ€ç»´éš¾åº¦æ‘†åœ¨é‚£é‡Œâ€¦â€¦é¦–å…ˆæˆ‘ä»¬è€ƒè™‘è¿™ä¸ªå¼å­çš„ç»“æ„ï¼Œæœ€å¤§åŒ–ä¸€ä¸ªgcdï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸å¦¨è€ƒè™‘å¦‚æœ$gcd(x,y)$,å­˜åœ¨$x=0$æˆ–è€…$y=0$æ—¶ï¼Œ$gcd(x,y)=y$æˆ–è€…$gcd(x,y)=x$ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘ï¼Œå¯¹äºä»»æ„çš„$a$ï¼Œæˆ‘ä»¬åªéœ€è¦å»å°è¯•æ„é€ ä¸€ç§æ–¹æ¡ˆ ï¼Œä½¿å¾—$a\oplus b$æœ€å¤§å¹¶ä¸”$a~\&amp; ~b$æœ€å°ã€‚é‚£ä¹ˆä¸å¦¨è€ƒè™‘ç›´æ¥é€‰ä¸€ä¸ªä¸$a$æ‰€æœ‰ä½ä¸Šéƒ½ç›¸åçš„æ•°$b$ï¼Œå°±å¯ä»¥ä¿è¯$a~\oplus~b$æœ€å¤§ä¸”$a~\&amp;~b=0$ï¼Œæœ€åçš„ç­”æ¡ˆå°±æ˜¯$2^{k-1}-1$ï¼Œå…¶ä¸­$k$æ˜¯äºŒè¿›åˆ¶ä¸‹$a$çš„ä½æ•°ã€‚å…¶ä¸­åˆæ³•æ€§æ˜¯ä¸è¨€è€Œå–»çš„ï¼Œå› ä¸ºæ ¹æ®æ„é€ ï¼Œ$b$çš„ç¬¬$k$ä½ï¼ˆäºŒè¿›åˆ¶ä½ä¸‹æœ€å¤§çš„é‚£ä¸€ä½ï¼‰ä¸Šå¿…å®šæ˜¯$0$ï¼Œæ‰€ä»¥ä¼¼ä¹å°±åšå®Œäº†ï¼Ÿ</p>
<p>ç„¶è€Œå¹¶ä¸æ˜¯ï¼Œå› ä¸º$b\not =0$ï¼Œæ‰€ä»¥å½“$~a=2^{w}-1ï¼Œw\in \mathbb N~$æ—¶å°±ä¼šä¸åˆæ³•ã€‚æ­¤å¤„åˆæœ‰ä¸€ä¸ªç²¾å¦™çš„æ„é€ ï¼Œæˆ‘ä»¬å‘ç°å½“$a$çš„äºŒè¿›åˆ¶ä½ä¸Šéƒ½æ˜¯$1$æ—¶ï¼Œ$\forall b&lt;a,\exists a  ~\&amp; ~b=b, a~\oplus~b=a-b$, äºæ˜¯æœ€åå°±ç›¸å½“äºæ±‚$\max \gcd (a-b,b)$ï¼Œè¿ç”¨è¾—è½¬ç›¸é™¤æˆ–è€…æ›´ç›¸å‡æŸçš„æ€æƒ³å¯ä»¥ç«‹å³çœ‹å‡ºæ˜¯$\max \gcd(a,b)$ï¼Œäºæ˜¯åªéœ€è¦æ‰¾å‡º$a$æœ€å¤§çš„å› å­å°±å¥½äº†â€”â€”æ­¤å¤„æš´åŠ›å³å¯ã€‚</p>
<p>äºæ˜¯æœ€åçš„ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 34000000</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">bitset</span> &lt;MAXN&gt; check ; <span class="keyword">int</span> T, N, i, O ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">get_fac</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">3</span> ; i &lt;= x ; i += <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> (!(x % i)) <span class="keyword">return</span> (x /= i) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= <span class="number">25</span> ; ++ i) check[(<span class="number">1</span> &lt;&lt; i) - <span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N) ;</span><br><span class="line">        <span class="keyword">if</span> (check[N]) </span><br><span class="line">            O = get_fac(N), <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, O) ;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; i &lt;&lt;= <span class="number">1</span>, O = i) ; </span><br><span class="line">            O --, <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, O) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸å¾—ä¸è¯´æ˜¯ä¸€é“æ¯”è¾ƒç¥çš„çš„é¢˜äº†ï¼ŒBrainstormï¼ŒBrainstormâ€¦..</p>
<h1 id="D"><a href="#D" class="headerlink" title="$D$"></a>$D$</h1><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98%2B-blue.svg" alt></p>
<p>é¢˜ç›®è¯¦è¿°ï¼šä½ åœ¨ç©ä¸€ä¸ªå«åš <code>Jongmah</code> çš„æ¸¸æˆï¼Œä½ æ‰‹ä¸Šæœ‰ $n$ ä¸ªéº»å°†ï¼Œæ¯ä¸ªéº»å°†ä¸Šæœ‰ä¸€ä¸ªåœ¨ $1$ åˆ° $m$ èŒƒå›´å†…çš„æ•´æ•° $a_i$ã€‚ä¸ºäº†èµ¢å¾—æ¸¸æˆï¼Œä½ éœ€è¦å°†è¿™äº›éº»å°†æ’åˆ—æˆä¸€äº›ä¸‰å…ƒç»„ï¼Œæ¯ä¸ªä¸‰å…ƒç»„ä¸­çš„å…ƒç´ æ˜¯ç›¸åŒçš„æˆ–è€…è¿ç»­çš„ã€‚ä½ åªèƒ½ä½¿ç”¨æ‰‹ä¸­çš„éº»å°†ï¼Œå¹¶ä¸”æ¯ä¸ªéº»å°†åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚è¯·æ±‚å‡ºä½ æœ€å¤šå¯ä»¥å½¢æˆå¤šå°‘ä¸ªä¸‰å…ƒç»„ã€‚</p>
<p><del>è¿™é“é¢˜å‡†ç¡®é¢„æŠ¥äº†ä»Šå¹´å„çœçœé€‰é‡Œé¢çš„æ¯’ç˜¤é›€é­‚é¢˜</del></p>
<p>ä¸€é“åŠ¨æ€è§„åˆ’ï¼Œæ„Ÿè§‰æ€è·¯æ¸…æ–°ã€è§£æ³•è‡ªç„¶<del>ï¼Œç»™å‡ºé¢˜äººç‚¹èµ.</del> ç„¶ååº•ä¸‹æ˜¯æˆ‘ä¸¢åˆ°Luoguçš„é¢˜è§£ï¼š</p>
<blockquote>
<p>$dp.$</p>
<p>å…¶å®ä¸»è¦æ€æƒ³éƒ½å·®ä¸å¤šï¼Œä½†æˆ‘å‘è¿™ç¯‡$sol$ä¸ºäº†é˜æ˜ä¸€ç§è§‚ç‚¹ï¼šå¤æ‚åº¦åŒé˜¶çš„$DP$ï¼Œä¸åŒçš„çŠ¶æ€è®¾è®¡ï¼Œä¼šå¯¼è‡´ä»£ç éš¾åº¦ã€æ—¶ç©ºå¤æ‚åº¦ç­‰æˆªç„¶ä¸åŒã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰çŠ¶æ€$dp_{i,j_{1},j_{2}}$è¡¨ç¤ºè€ƒè™‘äº†å‰$i$å¤§åºå·çš„éº»å°†($mahJong$)ï¼Œå…¶ä¸­æœ‰$j_{1}$ä¸ª$[i - 1, i, i + 1]$ç±»å‹ã€æœ‰$j_{2}$ä¸ª$[i, i + 1, i + 2]$ç±»å‹çš„ç»„åˆï¼Œæœ€å¤šç»„æˆå¤šå°‘ä¸ªä¸‰å…ƒç»„ã€‚</p>
<p>è¿™æ ·å®šä¹‰çŠ¶æ€çš„åŸå› æ˜¯ï¼šæˆ‘ä»¬å‘ç°å¦‚æœå•çº¯ç”¨$1$ç»´çŠ¶æ€è½¬ç§»ï¼Œé‚£ä¹ˆçŠ¶æ€åŠ¿å¿…æ˜¯â€œå‰$i$å¤§åºå·çš„éº»å°†åŒ…å«çš„ä¸‰å…ƒç»„ä¸ªæ•°â€ï¼Œä½†æ˜¯æ­¤çŠ¶æ€ä¸æ˜ç¡®â€”â€”æ— æ³•å‡†ç¡®å®šä¹‰â€œåŒ…å«â€çš„æ„æ€ã€‚è€Œæ­¤å¤„æˆ‘ä»¬å®šä¹‰åŒ…å«æŒ‡<strong>ä¸‰å…ƒç»„å³ç«¯ç‚¹ä¹Ÿ$\leq i$</strong>ï¼Œé‚£ä¹ˆ$[i - 1, i, i + 1]$å’Œ$[i, i + 1, i + 2]$ä¾¿éœ€è¦å•ç‹¬å®šä¹‰å‡ºæ¥ã€‚</p>
<p>è½¬ç§»çš„æ—¶å€™ç›´æ¥æšä¸¾æœ‰å¤šå°‘ä¸ª$[i + 1,i+2, i+3]$å³å¯ï¼ˆå› ä¸ºæˆ‘ä»¬ä½¿ç”¨$i$æ›´æ–°$i+1$è€Œä¸æ˜¯ç”¨$i-1$æ›´æ–°$i$ï¼Œå¦‚æ˜¯åšç»†èŠ‚å°‘ã€æ€è€ƒéš¾åº¦å°ï¼‰</p>
</blockquote>
<p>ç„¶åè½¬ç§»çš„æ—¶å€™ä¹Ÿè¦é¡ºä¾¿è®¡ç®—$[i,i,i]$çš„æ•°é‡ã€‚è€Œç”±äºå¦‚æœå­˜åœ¨ä¸‰ä¸ª$[i,i+1,i+2]$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥æ‹†æˆä¸‰ä¸ª$[i,i,i]$ï¼Œä¸‰ä¸ª$[i+1,i+1,i+1]$, ä¸‰ä¸ª$[i+2,i+2,i+2]$å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; </span><br><span class="line"><span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="keyword">sizeof</span>(dp)), dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) Sum[ qrd() ] ++ ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; <span class="number">3</span> ; ++ j)</span><br><span class="line">        <span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt; <span class="number">3</span> ; ++ k)</span><br><span class="line">            <span class="keyword">for</span> (l = <span class="number">0</span> ; l &lt; <span class="number">3</span> ; ++ l)</span><br><span class="line">                <span class="keyword">if</span> (Sum[i] &lt; j + k + l) <span class="keyword">continue</span> ;</span><br><span class="line">                <span class="keyword">else</span> dp[i][k][l] = max(dp[i][k][l], dp[i - <span class="number">1</span>][j][k] + (Sum[i] - j - k - l)/<span class="number">3</span> + l) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; dp[M][<span class="number">0</span>][<span class="number">0</span>] &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br></pre></td></tr></table></figure>
<h1 id="E"><a href="#E" class="headerlink" title="$E$"></a>$E$</h1><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98%2B-blue.svg" alt></p>
<p>é¢˜ç›®ç®€è¿°ï¼šç»™å®šæ•°åˆ—$c$å’Œ$t$ï¼Œæ¯æ¬¡æ“ä½œéƒ½å¯ä»¥é€‰æ‹©ä¸€ä¸ª$1&lt;i&lt;n$ï¼Œä»¤$c_i$å˜æˆ$c_iâ€™$ï¼Œå…¶ä¸­$c_iâ€™=c_{i+1}+c_{i-1}-c_i$ã€‚é—®æ˜¯å¦å¯ä»¥ç»è¿‡è‹¥å¹²æ¬¡æ“ä½œï¼Œä½¿å¾—$\forall c_i=t_i$. </p>
<p>â€¦â€¦æˆ‘ç®¡è¿™ç§é¢˜å«åšâ€œç–¯ç‹‚æš—ç¤ºé¢˜â€ï¼Œå…¶å®ä¹Ÿæ˜¯ä¸€ç§åšé¢˜æŠ€å·§çš„é—®é¢˜ã€‚æ‰“å®Œæ¯”èµ›åæ€äº†ä¸€ä¸‹ï¼Œä¼¼ä¹æœ‰å¥½å‡ ä¸ªå…³é”®ä¿¡æ¯æ²¡æœ‰æ•æ‰åˆ°ã€‚æ¯”å¦‚è¯´â€œè‹¥å¹²æ¬¡æ“ä½œâ€ï¼Œæ²¡æœ‰é™å®šæ“ä½œæ¬¡æ•°ï¼Œå°±è¯´æ˜æ— è®ºæ€ä¹ˆæ“ä½œï¼Œå…¶èƒŒåä¸€å®šæœ‰æŸäº›æœ¬è´¨ä¸å˜çš„ä¸œè¥¿ï¼Œå¦åˆ™åº”è¯¥å‡ºæˆä¸€ä¸ªäº¤äº’é¢˜ï¼Œåœ¨$k$æ­¥ä¹‹å†…å®Œæˆä»»åŠ¡çš„é‚£ç§æ„Ÿè§‰ã€‚è€ŒåŒæ—¶ï¼Œæ¯æ¬¡æ“ä½œä¸€ä¸ª$c_i$ï¼Œéƒ½åªä¼šè·Ÿ$c_{i-1}$ã€$c_{i+1}$æœ‰å…³ã€‚æ‰€ä»¥ï¼Œä¸€åˆ‡çš„ä¸€åˆ‡éƒ½åœ¨å¼•å¯¼æˆ‘ä»¬å‘<code>å·®åˆ†</code>é æ‹¢ã€‚</p>
<p>æˆ‘ä»¬æ€è€ƒå¯¹äºä¸€ä¸ª$c_i$ï¼Œä»¤å…¶æ»¡è¶³$c_{i-1}+d_1=c_i, ~c_i+d_2=c_{i+1}$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ–°çš„$c_iâ€™$å°±æ˜¯</p>
<script type="math/tex; mode=display">
c_i'=c_i-d_1+c_i+d_2-c_i=c_i-d_1+d_2</script><p>é‚£ä¹ˆæˆ‘ä»¬å°±ä¼šå‘ç°</p>
<script type="math/tex; mode=display">
c_{i+1}-c_i' = d_1\\\ c_i'-c_{i-1} = d_2</script><p>æ¢å¥è¯è¯´ï¼Œå…¶å®å°±æ˜¯ç›¸é‚»ä¸¤ä¸ªå·®æ¢äº†ä½ç½®ï¼é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´æ— è®ºæ€æ ·ï¼Œå·®åˆ†æ•°ç»„é‡Œé¢æ¯ä¸ªæ•°å‡ºç°çš„æ¬¡æ•°éƒ½æ˜¯ä¸å˜çš„ï¼Œç›´æ¥æ’ä¸ªåºæ£€æŸ¥å°±å¥½ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">   <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;A[i]) ;</span><br><span class="line">   <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;B[i]) ;</span><br><span class="line">   <span class="keyword">if</span> (A[<span class="number">1</span>] != B[<span class="number">1</span>] || A[N] != B[N]) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"No"</span>), <span class="number">0</span> ;</span><br><span class="line">   <span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= N ; ++ i) Da[i] = A[i] - A[i - <span class="number">1</span>] ;</span><br><span class="line">   <span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= N ; ++ i) Db[i] = B[i] - B[i - <span class="number">1</span>] ;</span><br><span class="line">   sort(Da + <span class="number">2</span>, Da + N + <span class="number">1</span>), sort(Db + <span class="number">2</span>, Db + N + <span class="number">1</span>) ;</span><br><span class="line">   <span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= N ; ++ i) <span class="keyword">if</span> (Da[i] != Db[i]) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"No"</span>), <span class="number">0</span> ; <span class="built_in">puts</span>(<span class="string">"Yes"</span>) ;</span><br></pre></td></tr></table></figure>
<p>æ„Ÿè§‰å…¶å®$C/D/E$éƒ½æ˜¯æ¯”è¾ƒå¥½çš„æ€ç»´é¢˜â€¦â€¦ä½†æ˜¯æ¥ä¸‹æ¥ä¸€ä¸ªå°±ä¸æ˜¯äº†ã€‚</p>
<h1 id="F"><a href="#F" class="headerlink" title="$F$"></a>$F$</h1><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt></p>
<p>é¢˜ç›®ç®€è¿° ï¼šç»™å®šä¸€æ£µä»¥$1$ä¸ºæ ¹çš„$n$ä¸ªèŠ‚ç‚¹æœ‰æ ¹æ ‘ï¼Œ ç»™å®š$m$æ¬¡è¯¢é—®ï¼Œ å½¢å¦‚ <code>v l r</code>ï¼Œ è¾“å‡ºä»¥$v$ä¸ºèµ·ç‚¹ï¼Œç»ˆç‚¹ç¼–å·ä¸º$l$ ~$r$ä»¥å†…çš„å¶å­ä¸­æœ€çŸ­çš„è·¯å¾„è·ç¦»ã€‚</p>
<p>æ ¹æ®dfsåºçš„ç›¸å…³çŸ¥è¯†ï¼Œæˆ‘ä»¬éœ€è¦ä¸€æ£µçº¿æ®µæ ‘æ¥ç»´æŠ¤dfsåºä¸Šçš„è·¯å¾„é•¿åº¦æœ€å°å€¼ã€‚ä½†æ˜¯å¾ˆå¤šäººï¼ˆæ¯”å¦‚æˆ‘ï¼‰ä¼šè®¤ä¸ºä¸€å®šéœ€è¦çº¿æ®µæ ‘ä¸Šä¸ªæ ‘ä»€ä¹ˆçš„ï¼Œä½†å…¶å®æœ‰æ›´ç®€å•çš„ç­–ç•¥ã€‚</p>
<p>ä¸å¦¨ç›´æ¥ä»¤å½“å‰ç‚¹åˆ°å…¶ä»–æ‰€æœ‰çš„ç‚¹çš„è·ç¦»æ˜¯ä¸€ä¸ªæ•°ç»„$dis$ã€‚æ€è€ƒå¦‚æœæˆ‘ä»¬æŠŠå½“å‰ç‚¹çš„å½“å‰å­èŠ‚ç‚¹è®¾ä¸º$x$, é‚£ä¹ˆæˆ‘ä»¬å¦‚æœå‘ä¸‹é€’å½’$x$ï¼Œå°±ä¼šæœ‰$x$åˆ°$x$å­æ ‘å†…çš„æ‰€æœ‰èŠ‚ç‚¹çš„$dis$ï¼Œæ¯”å…¶çˆ¶äº²çš„diséƒ½å°ä¸€ä¸ª$E[k].v$ï¼Œ$x$åˆ°å…¶ä»–èŠ‚ç‚¹çš„è·ç¦»éƒ½ä¼šå¤§ä¸€ä¸ª$E[k].v$ï¼Œé‚£ä¹ˆå°±å¦‚åŒçŠ¶æ€è½¬ç§»ä¸€æ ·ï¼Œæ¯æ¬¡å‘ä¸‹é€’å½’çš„æ—¶å€™å…ˆç»Ÿè®¡ä¸€é$Ans$ï¼Œå†æ›´æ–°ä¸€ä¸‹è·ç¦»å³å¯ã€‚</p>
<p>å…¶å®è¿™ä¸ªé¢˜æ˜¯ä¸€ä¸ª$tricky$é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸ºäº†ç”¨ä¸€ä¸ªdisæ•°ç»„è¡¨ç¤ºåˆ°å¶å­çš„è·ç¦»ï¼Œå¯ä»¥æŠŠéå¶å­ä¹‹é—´çš„è·ç¦»éƒ½è®¾æˆ$\rm{Inf}$ ï¼›æ¯”å¦‚æˆ‘ä»¬ä¸ºäº†é£é€Ÿç»Ÿè®¡ç­”æ¡ˆï¼Œå¯ä»¥æŠŠè¯¢é—®ç¦»çº¿ä¸‹åˆ°ä¸€ä¸ª<code>vector</code>é‡Œé¢ï¼Œåœ¨dfsçš„æ—¶å€™ç›´æ¥ç»Ÿè®¡å‡ºå…¨éƒ¨ç­”æ¡ˆã€‚</p>
<p>ä¸å¤±ä¸ºä¸€é“å¥½é¢˜å•Šqwq</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 500020</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Inf (1LL &lt;&lt; 55)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to, next ; ll c ;</span><br><span class="line">&#125;E[MAXN &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> N, M, A, i, q ; </span><br><span class="line">ll tag[MAXN &lt;&lt; <span class="number">2</span>], S[MAXN &lt;&lt; <span class="number">2</span>], Ans[MAXN], dis[MAXN], B ;</span><br><span class="line"><span class="keyword">int</span> cnt, head[MAXN], Last[MAXN], Lr[MAXN], Rr[MAXN] ; <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; query[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">min</span><span class="params">(<span class="keyword">const</span> ll &amp;a, <span class="keyword">const</span> ll &amp;b)</span></span>&#123; <span class="keyword">return</span> a &lt; b ? a : b ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">max</span><span class="params">(<span class="keyword">const</span> ll &amp;a, <span class="keyword">const</span> ll &amp;b)</span></span>&#123; <span class="keyword">return</span> a &gt; b ? a : b ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">	Last[u] = u ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ; </span><br><span class="line">		dis[to(k)] = dis[u] + E[k].c ; </span><br><span class="line">		dfs(to(k), u), Last[u] = max(Last[u], Last[to(k)]) ; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, ll w)</span></span>&#123;</span><br><span class="line">	E[++ cnt].to = v, E[cnt].c = w, </span><br><span class="line">	E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">	E[++ cnt].to = u, E[cnt].c = w, </span><br><span class="line">	E[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123; </span><br><span class="line">	S[rt] = min(S[rt &lt;&lt; <span class="number">1</span>], S[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (tag[rt] == <span class="number">0</span>) <span class="keyword">return</span> ;</span><br><span class="line">	rr <span class="keyword">int</span> lc = rt &lt;&lt; <span class="number">1</span>, rc = rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span> ;</span><br><span class="line">	tag[lc] += tag[rt], tag[rc] += tag[rt], </span><br><span class="line">	S[lc] += tag[rt], S[rc] += tag[rt], tag[rt] = <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, ll k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(ul &lt;= l &amp;&amp; ur &gt;= r)&#123;</span><br><span class="line">		S[rt] += k, tag[rt] += k ; <span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	push_down(rt) ; rr <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">if</span> (ul &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, l, mid, ul ,ur, k) ;</span><br><span class="line">	<span class="keyword">if</span> (ur &gt; mid) update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ul, ur, k) ; push_up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">		S[rt] = dis[l] ; <span class="keyword">return</span> ; </span><br><span class="line">	&#125; rr <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">	build(rt &lt;&lt; <span class="number">1</span>, l, mid), build(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r), push_up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">querys</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) <span class="keyword">return</span> S[rt] ;</span><br><span class="line">	rr <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; rr ll res = Inf ; push_down(rt) ;</span><br><span class="line">	<span class="keyword">if</span> (ql &lt;= mid) res = min(res, querys(rt &lt;&lt; <span class="number">1</span>, l, mid, ql, qr)) ;</span><br><span class="line">	<span class="keyword">if</span> (qr &gt; mid) res = min(res, querys(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ql, qr)) ; <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k : query[u]) </span><br><span class="line">		Ans[k] = querys(<span class="number">1</span>, <span class="number">1</span>, N, Lr[k], Rr[k]) ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ;</span><br><span class="line"> 		update(<span class="number">1</span>, <span class="number">1</span>, N, <span class="number">1</span>, N, E[k].c), update(<span class="number">1</span>, <span class="number">1</span>, N, to(k), Last[to(k)], -(E[k].c &lt;&lt; <span class="number">1</span>)), </span><br><span class="line">		work(to(k), u) ; update(<span class="number">1</span>, <span class="number">1</span>, N, <span class="number">1</span>, N, -E[k].c), update(<span class="number">1</span>, <span class="number">1</span>, N, to(k), Last[to(k)], E[k].c &lt;&lt; <span class="number">1</span>) ; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d%I64d"</span>, &amp;A, &amp;B), Add(A, i, B) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;q, &amp;Lr[i], &amp;Rr[i]), query[q].push_back(i) ; </span><br><span class="line">	dfs(<span class="number">1</span>, <span class="number">0</span>) ; <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="keyword">if</span> (i != Last[i]) dis[i] = Inf ; build(<span class="number">1</span>, <span class="number">1</span>, N) ; <span class="comment">// by _pks</span></span><br><span class="line">	work(<span class="number">1</span>, <span class="number">0</span>) ; <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="built_in">printf</span>(<span class="string">"%I64d\n"</span>, Ans[i]) ; <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// by _pks by _pks by _pks by_pks</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><del>by_pkså…¶å®æ˜¯ç”¨æ¥å ä½çš„å› ä¸ºæˆ‘å–œæ¬¢åŒä¸€ä¸ªä»£ç å—é‡Œï¼Œæ¯ä¸€è¡Œçš„é•¿åº¦éƒ½æ˜¯é€’å¢çš„XD</del></p>
<h1 id="G"><a href="#G" class="headerlink" title="$G$"></a>$G$</h1><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89-darkviolet.svg" alt></p>
<p>é¢˜ç›®å¤§æ„ï¼šç»™å‡ºä¸€æ£µNä¸ªç‚¹çš„æ ‘ï¼Œåˆå§‹æ—¶æŸäº›èŠ‚ç‚¹æ˜¯ç™½è‰²ï¼Œå…¶ä»–èŠ‚ç‚¹æ²¡æœ‰é¢œè‰²ï¼Œæœ‰ä¸¤ä¸ªäººåœ¨æ ‘ä¸Šåšå¼ˆã€‚æ¯ä¸€å›åˆï¼Œä¸€æ–¹å¯ä»¥å°†ä¸€ä¸ªæ²¡æœ‰é¢œè‰²çš„ç‚¹æŸ“æˆç™½è‰²ï¼Œç„¶åå¦ä¸€æ–¹å¯ä»¥å°†ä¸€ä¸ªæ²¡æœ‰é¢œè‰²çš„ç‚¹æŸ“æˆé»‘è‰²ã€‚å¦‚æœåœ¨æŸæ¬¡æŸ“è‰²åæ ‘ä¸Šå­˜åœ¨ä¸‰ä¸ªç‚¹ABCæ»¡è¶³æœ‰è¾¹$(A,B)(B,C)$ä¸”ABCéƒ½æœ‰é¢œè‰²ä¸”é¢œè‰²ç›¸åŒï¼Œåˆ™è¯¥é¢œè‰²å¯¹åº”çš„äººè·èƒœã€‚å‡è®¾ä¸¤äººç»é¡¶èªæ˜ï¼Œé—®æœ€åç»“æœå¦‚ä½•ã€‚$T\leq 5e5,\sum n\leq 5e5$</p>
<p>emmmmä¸€é“æˆ‘ä¸ä¼šçš„é¢˜ã€‚å…¶å®æ€»è§‰å¾—è¿™ç§åšå¼ˆè®ºæœ‰ä¸€ç§ä¸€è„‰ç›¸æ‰¿çš„ç²¾å¦™ä¹‹å¤„ï¼Œä½†æ˜¯è‡ªå·±æ€»æ˜¯ä¸èƒ½ç¨”ç†Ÿäºå¿ƒâ€¦â€¦GG</p>
<p>ç„¶åæˆ‘é€‰æ‹©æ¬äº†<code>Itst</code>å·¨ä½¬çš„æ€è·¯è¿‡æ¥</p>
<h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>é¦–å…ˆæˆ‘ä»¬è€ƒè™‘ï¼Œé»‘è‰²æ˜¯ä¸å¯èƒ½è·èƒœçš„ï¼Œæ¯•ç«ŸåŸæ¥å°±å·²ç»æœ‰ä¸€å †ç™½ç‚¹äº†â€¦â€¦</p>
<p>å…¶æ¬¡æˆ‘ä»¬è€ƒè™‘å…ˆå¿½ç•¥åŸæ ‘ä¸­çš„æ‰€æœ‰å·²ç»è¢«æŸ“è¿‡è‰²çš„ç‚¹ï¼Œç„¶åç”¨ä¸€ç§æ¯”è¾ƒå‰å«çš„æ–¹å¼æ¥åˆ†ç±»è®¨è®ºâ€”â€”<code>åº¦æ•°è®¨è®ºæ³•</code>ã€‚</p>
<ul>
<li>å‡è®¾æœ‰ä¸€ä¸ªç‚¹çš„åº¦æ•°$\geq 4$ï¼Œæ¢å¥è¯è¯´è¿™ä¸ªè”é€šå—çš„ç‚¹çš„ä¸ªæ•°è¦$\geq 5$ï¼Œé‚£ä¹ˆæ ¹æ®ç™½è‰²å…ˆæ‰‹çš„åŸåˆ™ï¼Œç™½è‰²çš„ä¸€å®šå¯ä»¥å–$3$ä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä¸”ä¸€å®šå¯ä»¥å–$3$ä¸ªè¿ç»­çš„èŠ‚ç‚¹ã€‚æ‰€ä»¥ç™½è‰²èµ¢ï¼›</li>
<li>å¦‚æœå­˜åœ¨ä¸€ä¸ªç‚¹çš„åº¦æ•°$=3$ï¼Œä¸”å®ƒæ‰€è¿çš„$3$ä¸ªç‚¹è‡³å°‘æœ‰$2$ä¸ªç‚¹ä¸æ˜¯å¶å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœè€ƒè™‘è®²æ ‘å¹³å±•å¼€ä¹‹åï¼Œå…ˆé€‰ä¸­é—´çš„ç‚¹ï¼Œå°±å¯ä»¥ä¿è¯ç™½è‰²èµ¢ï¼›</li>
<li>å…¶ä½™çš„æƒ…å†µæˆ‘ä»¬å¯ä»¥è€ƒè™‘å¤§åŠ›åˆ†ç±»è®¨è®ºæ ‘çš„å½¢æ€ï¼š<img src="1.png" alt></li>
</ul>
<p>æˆ‘ä»¬å‘ç°ï¼Œå¯¹äºå‰ä¸¤ç§æƒ…å†µéƒ½æ˜¯drawçš„ã€‚è€Œå¯¹äºç¬¬ä¸‰ç§æƒ…å†µï¼Œå¦‚æœæ€»ç‚¹æ•°æ˜¯<strong>å¥‡æ•°ä¸ª</strong>ï¼Œé‚£ä¹ˆ<strong>ç™½è‰²å¿…èµ¢</strong>ã€‚æˆ‘ä»¬è€ƒè™‘ä»å·¦å‘å³æŸ“è‰²ï¼Œç™½è‰²ç¬¬ä¸€æ¬¡è€ƒè™‘æŸ“ä»å·¦å¾€å³ç¬¬äºŒä¸ªéå¶å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆé»‘è‰²åªèƒ½æŸ“ç¬¬ä¸€ä¸ªï¼›ç™½è‰²æŸ“ç¬¬å››ä¸ªï¼Œé»‘è‰²åªèƒ½æŸ“ç¬¬ä¸‰ä¸ªâ€¦â€¦ä»¥æ­¤ç±»æ¨ã€‚åˆ°æœ€åä¸€å®šä¼šå‡ºç°ç™½è‰²æŸ“äº†$2n$è¿™ä¸ªç‚¹ï¼Œé»‘è‰²å»æŸ“$2n-1$è¿™ä¸ªç‚¹ï¼Œé‚£ä¹ˆç™½è‰²æ¥ä¸‹æ¥å°±å¯ä»¥æŸ“$2n+1$è¿™ä¸ªç‚¹ï¼ŒWinnerï¼</p>
<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¦‚æœè¦ç®—ä¸ŠåŸæœ¬å°±æ˜¯ç™½è‰²çš„ç‚¹å‘¢ï¼Ÿå¯¹äºè¿™ç§æƒ…å†µï¼Œä¸€èˆ¬éƒ½æ˜¯è½¬åŒ–å›æˆ‘ä»¬å·²ç»è®¨è®ºå®Œçš„<code>0x01</code>å»ã€‚æˆ‘ä»¬è€ƒè™‘æŠŠä¸€ä¸ªç™½è‰²ç‚¹æ‹†æˆ$4$ä¸ªæ— è‰²ç‚¹ã€‚<img src="2.png" alt></p>
<p>å…¶ä¸­Aå°±æ˜¯åŸæ¥çš„$1$å·ç‚¹ï¼ŒåŸå›¾ä¸Šå“ªäº›ç‚¹è·Ÿ$1$è¿äº†è¾¹ï¼Œç°åœ¨ä¹Ÿå’Œ$A$è¿ï¼Œæ¢å¥è¯è¯´å°±æ˜¯$A$å¤šäº†ä¸€æ£µä¸‰ä¸ªèŠ‚ç‚¹çš„å­æ ‘ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘å…¶å¯è¡Œæ€§ã€‚</p>
<ul>
<li>å¦‚æœ$A$è¢«æŸ“æˆé»‘è‰²ï¼Œé‚£ä¹ˆç™½è‰²æ²¡æœ‰å¿…è¦å†æŸ“å­æ ‘å†…çš„ç‚¹ï¼Œè¿™ç§æƒ…å†µç­‰ä»·äºä¸è¿å­æ ‘ã€‚</li>
<li>å¦‚æœ$A$è¢«æŸ“æˆç™½è‰²ï¼Œé‚£ä¹ˆé»‘è‰²ä¸€å®šè¦æŸ“$B$ç‚¹ï¼Œé‚£ä¹ˆæ­¤æ—¶è¿™æ£µå­æ ‘åˆæ²¡ç”¨äº†ï¼Œæ‰€ä»¥ä¹Ÿç­‰ä»·äºä¸è¿å­æ ‘ã€‚</li>
</ul>
<p>å—¯ï¼Œç„¶åè¿™ä¸ªé¢˜å°±å®Œäº†ã€‚æˆ‘ä»¬å¯ä»¥å‘ç°å°±æ˜¯ä¸€ä¸ªå¤§åŠ›åˆ†ç±»è®¨è®ºçš„è¿‡ç¨‹â€”â€”é¢˜è¿˜æ˜¯æŒºå¥½çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 500020</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> Input[MAXN] ;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to, next ;</span><br><span class="line">&#125;E[MAXN &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> In[MAXN], qaq ;</span><br><span class="line"><span class="keyword">int</span> T, N, head[MAXN], A, qwq, B, i, j, ans, cnt ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">	E[++ cnt].to = v, In[v] ++ ;</span><br><span class="line">	E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">	E[++ cnt].to = u, In[u] ++ ; </span><br><span class="line">	E[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">	<span class="keyword">while</span> (T --)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N), ++qwq ;</span><br><span class="line">		fill(In, In + N + <span class="number">4</span>, <span class="number">0</span>) ;</span><br><span class="line">		fill(head, head + N + <span class="number">4</span>, <span class="number">0</span>), ans = <span class="number">0</span>, qaq = <span class="number">0</span> ;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B), Add(A, B) ;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, Input) ; <span class="keyword">if</span> (N &lt; <span class="number">3</span>) <span class="built_in">puts</span>(<span class="string">"Draw"</span>) ; </span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (N == <span class="number">3</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) ans += Input[i] == <span class="string">'W'</span> ;</span><br><span class="line">			<span class="built_in">puts</span>(ans &gt;= <span class="number">2</span> ? <span class="string">"White"</span> : <span class="string">"Draw"</span>) ;</span><br><span class="line">		&#125; </span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">int</span> Linshi = <span class="number">0</span> ;</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)</span><br><span class="line">				<span class="keyword">if</span> (Input[i] == <span class="string">'W'</span>)&#123;</span><br><span class="line">					head[++ N] = <span class="number">0</span>, Add(i + <span class="number">1</span>, N), In[N] = <span class="number">3</span> ;</span><br><span class="line">				&#125;</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N &amp;&amp; ans &lt;= <span class="number">0</span>; ++ i)&#123;</span><br><span class="line">				<span class="keyword">if</span> (In[i] &gt; <span class="number">3</span>) ans ++ ;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (In[i] == <span class="number">3</span>)&#123; Linshi = <span class="number">0</span> ;</span><br><span class="line">					<span class="keyword">for</span> (j = head[i] ; j ; j = E[j].next) Linshi += (In[to(j)] &gt;= <span class="number">2</span>) ;</span><br><span class="line">					ans += Linshi &gt; <span class="number">1</span>, qaq ++ ;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (qaq == <span class="number">2</span> &amp;&amp; (N % <span class="number">2</span>)) ans ++ ; <span class="built_in">puts</span>(ans ? <span class="string">"White"</span> : <span class="string">"Draw"</span>) ;</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">// 		if (qwq == 20) return 0 ;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Global Roundçš„é¢˜ç›®è´¨é‡ä¸ä½è›¤ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>åŠ¨æ€è§„åˆ’/æ™®é€šDP</tag>
        <tag>æ€ç»´é¢˜/æ„é€ </tag>
        <tag>æ ‘æ¨¡å‹</tag>
        <tag>æœ‰æŠ€å·§çš„å·®åˆ†</tag>
        <tag>åšå¼ˆè®º/ç»„åˆæ¸¸æˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ¢ç©¶å‘ã€‘ä¸»å¸­æ ‘ä¸Šçš„ä¸é è°±è§£æ³•</title>
    <url>/2019/04/05/%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%96%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%C2%B7%E4%B8%8D%E9%9D%A0%E8%B0%B1%E7%9A%84%E5%81%9A%E6%B3%95%E2%80%94%E2%80%94%E4%B8%BB%E5%B8%AD%E6%A0%91%E4%B8%8A%E4%BA%8C%E5%88%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>yyå‡ºæ¥çš„å‡å¤æ‚åº¦åšæ³•ï¼Œä½†æ˜¯æ®è¯´æœ‰ä¸€ä¸ªå¾ˆå¼ºçš„å‰ªæï¼Ÿ</p>
<a id="more"></a>
<h1 id="rm-0x00-Preface"><a href="#rm-0x00-Preface" class="headerlink" title="$\rm{0x00~}Preface$"></a>$\rm{0x00~}Preface$</h1><p>æŸå¤©æœºæˆ¿é‡Œï¼Œ<del>å…¬è®¤çš„ezi</del> lwyè·Ÿwxléšå£è¯´äº†ä¸€é“luoguä¸Šçš„é¢˜ï¼Œwxlæ¥äº†å…´è¶£ï¼Œè¢«pkså¬è§äº†ï¼Œäºæ˜¯pkså°±ç…äº†ä¸€çœ¼è¿™é¢˜ï¼Œç„¶åè¯´äº†ä¸€å¥â€è¿™ä¸å°±æ˜¯sbä¸»å¸­æ ‘ä¸ŠäºŒåˆ†å—ï¼Ÿéšä¾¿ä¸€ä¸ª$\Theta(n \log^2n)$å°±å¯ä»¥è¿‡å•Šâ€</p>
<p>ç„¶åpksé‚£ä¸€æ•´ä¸ªæ™šä¸Šéƒ½åœ¨æè¿™ä¸ªå‡ç®—æ³•ï¼Œ$\rm{QAQ}$</p>
<p>äºæ˜¯å°±æœ‰äº†æœ¬æ–‡ï¼Œæ•´ç†äº†ä¸¤é“ä¸»å¸­æ ‘çš„æ­£ç¡®ï¼ˆï¼Ÿï¼‰åº”ç”¨ã€‚</p>
<h1 id="rm-0x01-faebdcçš„çƒ¦æ¼"><a href="#rm-0x01-faebdcçš„çƒ¦æ¼" class="headerlink" title="$\rm{0x01~}$faebdcçš„çƒ¦æ¼"></a>$\rm{0x01~}$faebdcçš„çƒ¦æ¼</h1><p>ä¼ é€é—¨ï¼š<a href="https://www.luogu.org/problemnew/show/P1997" target="_blank" rel="noopener">https://www.luogu.org/problemnew/show/P1997</a></p>
<p>å‘ƒï¼Œå…¶å®è¿™ä¸æ˜¯ä¸€é“å¾ˆéš¾çš„é¢˜ã€‚å› ä¸ºæœ¬æ¥å°±ä¿è¯äº†æ•°åˆ—ä¸é™ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è®°å½•ä¸€ä¸‹æ¯ä¸ªæ•°å‡ºç°åŒºé—´çš„å·¦å³ç«¯ç‚¹ï¼Œçæå°±å¥½ã€‚ä½†æ˜¯æ—¢ç„¶æˆ‘è¯´äº†è¦ä¸»å¸­æ ‘ä¸ŠäºŒåˆ†ï¼Œå°±ä¸€å®šè¦å†™å†™çœ‹å§qaq</p>
<p>æˆ‘ä»¬è€ƒè™‘åœ¨æˆ‘çš„<a href>è¿™ç¯‡åšå®¢</a>é‡Œé¢æ›¾ç»ä»‹ç»è¿‡çš„$T3$ä¸­çš„ç®—æ³•ï¼Œæˆ‘ä»¬ç›´æ¥å»æŸ¥è¯¢å·¦å³å„¿å­å€¼åŸŸåŒºé—´å†…ä¸­æ•°çš„ä¸ªæ•°ï¼Œçœ‹çœ‹å“ªä¸ªå¯è¡Œï¼Œç„¶åæš´åŠ›æ‰¾å°±å¥½ã€‚</p>
<p>ä½†æ˜¯â€¦ä»–TLEäº†ä¸¤ä¸ªç‚¹ï¼Œå› ä¸ºæˆ‘æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;Left,<span class="keyword">const</span> <span class="keyword">int</span> &amp;Right,<span class="keyword">const</span> <span class="keyword">int</span> &amp;l, <span class="keyword">const</span> <span class="keyword">int</span> &amp;r, <span class="keyword">const</span> <span class="keyword">int</span> &amp;k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> aft[l] ; </span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, qwq ;</span><br><span class="line">    <span class="keyword">if</span> (sum[Right] - sum[Left] &lt; k) <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">int</span> x = sum[L[Right]] - sum[L[Left]], y = sum[R[Right]] - sum[R[Left]] ;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= k) </span><br><span class="line">        <span class="keyword">if</span> ((qwq = query(L[Left], L[Right], l, mid, k)) &gt; <span class="number">0</span>) <span class="keyword">return</span> qwq ;</span><br><span class="line">    <span class="keyword">if</span> (y &gt;= k) </span><br><span class="line">        <span class="keyword">if</span> ((qwq = query(R[Left], R[Right], mid + <span class="number">1</span>, r, k)) &gt; <span class="number">0</span>) <span class="keyword">return</span> qwq ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; </span><br><span class="line">  	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= N; i ++)  base[i] = qr() + ADD, aft[i] = base[i] ;</span><br><span class="line">    sort (aft + <span class="number">1</span>, aft + N + <span class="number">1</span>),Len = unique(aft + <span class="number">1</span>, aft + N + <span class="number">1</span>) - (aft + <span class="number">1</span>), </span><br><span class="line">	  T[<span class="number">0</span>] = build(<span class="number">1</span>, Len) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= N; i ++) </span><br><span class="line">      pos = lower_bound(aft + <span class="number">1</span>, aft + Len + <span class="number">1</span>, base[i]) - aft, </span><br><span class="line">  		T[i] = update(T[i - <span class="number">1</span>], <span class="number">1</span>, Len, pos) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= M; i ++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a, &amp;b) ;</span><br><span class="line">        <span class="keyword">register</span> <span class="keyword">int</span> l = <span class="number">1</span>, r = b - a + <span class="number">1</span>, ans = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">           	<span class="keyword">register</span> <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (query(T[a - <span class="number">1</span>], T[b], <span class="number">1</span>, Len, mid) &gt; <span class="number">0</span>) ans = mid, l = mid + <span class="number">1</span> ; </span><br><span class="line">            <span class="keyword">else</span> r = mid - <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¥½åƒå¾ˆæ­£å¸¸ï¼Ÿä½†æ˜¯ï¼Œè¿™ä¸ªå¤æ‚åº¦æ˜¯å®Œå…¨é”™è¯¯çš„ã€‚æœ€å¤§çš„æ—¶å€™ç”šè‡³å¯ä»¥åˆ°è¾¾å•æ¬¡$m \log n$çš„å¤æ‚åº¦â€”â€”æ³¨æ„æ˜¯å•æ¬¡ã€‚å› ä¸ºæˆ‘ä»¬æ¯æ¬¡è¯¢é—®çš„æ—¶å€™ï¼Œå¦‚æœæŸ¥è¯¢äº†å·¦åŒºé—´ä¸åˆæ³•ï¼Œé‚£ä¹ˆä¸ä»£è¡¨å³åŒºé—´åˆæ³•â€”â€”æ¯•ç«Ÿæ˜¯äºŒåˆ†é‡Œçš„<code>check</code>ç¯èŠ‚ã€‚è€Œä¸Šä¸€ä¸ªç±»ä¼¼æ–¹æ³•çš„é¢˜ï¼Œå¯ä»¥ä¿è¯æˆ‘ä»¬å¦‚æœå·¦åŒºé—´çš„æ•°çš„å‡ºç°æ¬¡æ•°ä¸è¶…è¿‡$\frac{1}{2}$ï¼Œé‚£ä¹ˆå³åŒºé—´ä¸€å®šæ»¡è¶³â€”â€”ä½†æ˜¾ç„¶çš„æ˜¯ï¼Œæœ¬é¢˜ä¸å…·æœ‰è¿™ä¸ªæ€§è´¨ã€‚</p>
<p>æ‰€ä»¥ï¼Œæ€»ç»“ä¸€ä¸‹ï¼Œä¸»å¸­æ ‘ä¸Šä¸å¯ä»¥äºŒåˆ†ã€‚</p>
<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬åŠ ä¸€ç‚¹å‰ªæå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬è€ƒè™‘ï¼Œå¯¹äºä¸»å¸­æ ‘ä¸Šçš„æ¯ä¸€ä¸ªç‚¹ç»´æŠ¤ä¸€ä¸ª$maxx$ä¸€ä¸ª$minx$ï¼Œè®°å½•åŒºé—´å†…<strong>å•ä¸ªæ•°å€¼å‡ºç°çš„æœ€å¤§æ¬¡æ•°å’Œæœ€å°æ¬¡æ•°</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨$check$çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥ç”¨è¿™ç§æ–¹å¼åˆ¤â€”â€”å¦‚æœ$r$ç‰ˆæœ¬çš„ä¸»å¸­æ ‘å†…å‡ºç°çš„æœ€å¤§æ¬¡æ•°å‡å»$l-1$ç‰ˆæœ¬å†…å‡ºç°çš„æ•°çš„æœ€å°æ¬¡æ•°$k&lt;q$ï¼ˆ$q$æ˜¯äºŒåˆ†å‡ºçš„$val$ï¼‰ï¼Œé‚£ä¹ˆä¸€å®šä¸æ»¡è¶³ã€‚</p>
<p>æ¯”è¾ƒæ˜¾ç„¶çš„æ˜¯ï¼Œè¿™ä¸æ˜¯ä¸€ç§æœ€ä¼˜æ€§å‰ªæï¼Œè€Œæ˜¯ä¸€ç§å¯è¡Œæ€§å‰ªæã€‚ä½†æ˜¯å¯¹ä»˜è¿™é“é¢˜å´æœ‰ç€ä¸é”™çš„æ•ˆæœï¼Œè·‘çš„å¥‡å¿«ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADD 393216</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 100073</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">int</span> a, b, c, pos, N, base[MAXN], mx[(MAXN &lt;&lt; <span class="number">5</span>) + <span class="number">1</span>], mn[(MAXN &lt;&lt; <span class="number">5</span>) + <span class="number">1</span>], aft[MAXN], M, i ;</span><br><span class="line"><span class="keyword">int</span> cnt, Len, T[(MAXN &lt;&lt; <span class="number">5</span>) + <span class="number">1</span>], L[(MAXN &lt;&lt; <span class="number">5</span>) + <span class="number">1</span>], R[(MAXN &lt;&lt; <span class="number">5</span>) + <span class="number">1</span>], sum[(MAXN &lt;&lt; <span class="number">5</span>) + <span class="number">1</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> k = <span class="number">0</span>, f = <span class="number">1</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c))&#123; <span class="keyword">if</span> (c == <span class="string">'-'</span>) f = <span class="number">-1</span> ; c = getchar() ; &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k * f ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;last, <span class="keyword">const</span> <span class="keyword">int</span> &amp;l, <span class="keyword">const</span> <span class="keyword">int</span> &amp;r, <span class="keyword">const</span> <span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> rt = ++ cnt, mid ;</span><br><span class="line">    sum[rt] = sum[last] + <span class="number">1</span>, R[rt] = R[last], L[rt] = L[last] ;</span><br><span class="line">    <span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">    	mx[rt] = mn[rt] = sum[rt] ; </span><br><span class="line">        <span class="keyword">return</span> rt ;</span><br><span class="line">    &#125;</span><br><span class="line">    mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x &lt;= mid) L[rt] = update(L[last], l, mid, x) ;</span><br><span class="line">    <span class="keyword">else</span>  R[rt] = update(R[last], mid + <span class="number">1</span>, r, x) ;</span><br><span class="line">    mn[rt] = min(mn[L[rt]], mn[R[rt]]), mx[rt] = max(mx[L[rt]], mx[R[rt]]) ;</span><br><span class="line">    <span class="keyword">return</span> rt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">query</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;Left,<span class="keyword">const</span> <span class="keyword">int</span> &amp;Right,<span class="keyword">const</span> <span class="keyword">int</span> &amp;l, <span class="keyword">const</span> <span class="keyword">int</span> &amp;r, <span class="keyword">const</span> <span class="keyword">int</span> &amp;k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> <span class="number">1</span> ; rr <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, qwq ;</span><br><span class="line">    <span class="keyword">if</span> (mx[L[Right]] - mn[L[Left]] &gt;= k &amp;&amp; query(L[Left], L[Right], l, mid, k)) <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (mx[R[Right]] - mn[R[Left]] &gt;= k &amp;&amp; query(R[Left], R[Right], mid + <span class="number">1</span>, r, k)) <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M; <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= N ; ++ i)  base[i] = qr() + ADD, aft[i] = base[i] ;</span><br><span class="line">    sort (aft + <span class="number">1</span>, aft + N + <span class="number">1</span>), Len = unique(aft + <span class="number">1</span>, aft + N + <span class="number">1</span>) - (aft + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= N ; ++ i) pos = lower_bound(aft + <span class="number">1</span>, aft + Len + <span class="number">1</span>, base[i]) - aft, T[i] = update(T[i - <span class="number">1</span>], <span class="number">1</span>, Len, pos) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        a = qr(), b = qr() ;</span><br><span class="line">        <span class="keyword">register</span> <span class="keyword">int</span> l = <span class="number">1</span>, mid, r = b - a + <span class="number">1</span>, ans = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">           	mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (query(T[a - <span class="number">1</span>], T[b], <span class="number">1</span>, Len, mid)) ans = mid, l = mid + <span class="number">1</span> ; </span><br><span class="line">            <span class="keyword">else</span> r = mid - <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="rm-0x02-CF840D-Destiny"><a href="#rm-0x02-CF840D-Destiny" class="headerlink" title="$\rm{0x02~}CF840D~Destiny$"></a>$\rm{0x02~}CF840D~Destiny$</h2><p>ä¼ é€é—¨ï¼š<a href="http://codeforces.com/problemset/problem/840/D" target="_blank" rel="noopener">http://codeforces.com/problemset/problem/840/D</a></p>
<p>ç®€åŒ–ç‰ˆé¢˜æ„ï¼šæ¯æ¬¡ç»™å‡ºä¸‰ä¸ªå‚æ•°$l,r,k$ï¼Œè¯¢é—®åŒºé—´$[l,r]$å†…æ˜¯å¦å­˜åœ¨å‡ºç°æ¬¡æ•°ä¸¥æ ¼å¤§äº$\frac{r-l+1}{k}$çš„æ•°ã€‚å¦‚æœå­˜åœ¨å°±è¾“å‡ºæœ€å°çš„é‚£ä¸ª$ans$ï¼Œå¦åˆ™è¾“å‡º$-1$.</p>
<p>è¿™ä¸ªä¸œè¥¿â€¦â€¦å°±ç›´æ¥æŸ¥è¯¢å°±å¥½äº†å•Šâ€¦â€¦ç”±äºä¸ç”¨äºŒåˆ†ï¼Œæ‰€ä»¥å¤æ‚åº¦ç›¸å¯¹æ¥è¯´ç¨³å®šäº†ä¸€äº›ã€‚äºæ˜¯æˆ‘å°±æ²¡æœ‰åŠ ä¸Šæ–‡ä¸­æåˆ°è¿‡çš„é‚£ä¸ªè¯¡å¼‚çš„ä¼˜åŒ–ã€‚æˆ‘ä»¬æ¯æ¬¡å…ˆæŸ¥å·¦åŠè¾¹ï¼Œå°±å¯ä»¥ä¿è¯åœ¨å€¼åŸŸä¸Šæœ€å°ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡æˆ‘ä»¬éƒ½å¯ä»¥æ±‚å‡ºæœ€å°çš„åˆæ³•$ans$äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> rt = ++ cnt ;</span><br><span class="line">    sum[rt] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span>(l &lt; r)&#123;</span><br><span class="line">        L[rt] = build(l, mid) ;</span><br><span class="line">        R[rt] = build(mid + <span class="number">1</span>, r) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> rt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> last, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> rt = ++ cnt ;</span><br><span class="line">    sum[rt] = sum[last] + <span class="number">1</span> ;</span><br><span class="line">    R[rt] = R[last] ;</span><br><span class="line">    L[rt] = L[last] ;</span><br><span class="line">    <span class="keyword">if</span> (l &lt; r)&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt;= mid) L[rt] = update(L[last], l, mid, x) ;</span><br><span class="line">        <span class="keyword">else</span>  R[rt] = update(R[last], mid + <span class="number">1</span>, r, x) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> rt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> Left, <span class="keyword">int</span> Right, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> aft[l] ; <span class="keyword">int</span> qwq ;</span><br><span class="line">    <span class="comment">// if (sum[Right] - sum[Left] &lt;= k) return -1 ;</span></span><br><span class="line">    <span class="keyword">int</span> x = sum[L[Right]] - sum[L[Left]], y = sum[R[Right]] - sum[R[Left]] ;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; k) </span><br><span class="line">		<span class="keyword">if</span> ((qwq = query(L[Left], L[Right], l, mid, k)) &gt; <span class="number">0</span>) <span class="keyword">return</span> qwq ;</span><br><span class="line">    <span class="keyword">if</span> (y &gt; k) </span><br><span class="line">		<span class="keyword">if</span> ((qwq = query(R[Left], R[Right], mid + <span class="number">1</span>, r, k)) &gt; <span class="number">0</span>) <span class="keyword">return</span> qwq ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= N; i ++) base[i] = qr(), aft[i] = base[i] ;</span><br><span class="line">    sort(aft + <span class="number">1</span>, aft + N + <span class="number">1</span>) ;</span><br><span class="line">    Len = unique(aft + <span class="number">1</span>, aft + N + <span class="number">1</span>) - (aft + <span class="number">1</span>) ; </span><br><span class="line">    T[<span class="number">0</span>] = build(<span class="number">1</span>, Len) ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= N; i ++)&#123;</span><br><span class="line">        pos = lower_bound(aft + <span class="number">1</span>, aft + Len + <span class="number">1</span>, base[i]) - aft;</span><br><span class="line">        T[i] = update(T[i - <span class="number">1</span>], <span class="number">1</span>, Len, pos) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= M; i ++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;c) ; <span class="keyword">int</span> k = (b - a + <span class="number">1</span>) / c ;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; query(T[a - <span class="number">1</span>], T[b], <span class="number">1</span>, Len, k) &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>äº‹å®ä¸Šï¼ŒåŠ ä¸Šé‚£ä¼˜åŒ–ä¹‹åï¼Œæ€»ç”¨æ—¶å¤§çº¦$27000ms$ï¼Œè€Œæˆ‘è¿™ä¸ªä¸åŠ ä¼˜åŒ–çš„ç‰ˆæœ¬è¶³è¶³è·‘äº†$56677ms$â€¦â€¦çœŸä¸¢äººå•Š</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„/å¯æŒä¹…åŒ–/å¯æŒä¹…åŒ–çº¿æ®µæ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>é˜²å®ˆæˆ˜çº¿[ZJOI2013] &amp; å¿—æ„¿è€…æ‹›å‹Ÿ[NOI2008]</title>
    <url>/2019/04/05/fszx-and-zyzzm/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="rm-0x01-ZJOI2013-é˜²å®ˆé˜µçº¿"><a href="#rm-0x01-ZJOI2013-é˜²å®ˆé˜µçº¿" class="headerlink" title="$\rm{0x01}$ [ZJOI2013]é˜²å®ˆé˜µçº¿"></a>$\rm{0x01}$ [ZJOI2013]é˜²å®ˆé˜µçº¿</h1><p>ä¼ é€é—¨ï¼š<a href="https://www.luogu.org/problemnew/show/P3337" target="_blank" rel="noopener">https://www.luogu.org/problemnew/show/P3337</a></p>
<p>é¦–å…ˆå°±æ˜¯è¦æ˜ç™½æ€ä¹ˆå»ºæ¨¡ï¼Œå¤§æ¦‚å°±æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å°åŒ–} \quad \sum c_ix_i \quad(i = 1,2,3\cdots n)\\\
\text{æ»¡è¶³çº¦æŸ} \quad \sum \limits_{j=l_i}^{r_i} x_{j} \geq d_i \quad (i = 1,2,3\cdots m)</script><p>å…¶ä¸­$x_j$è¡¨ç¤º$j$è¿™ä¸ªåœ°æ–¹æœ‰å‡ åº§å¡”ã€‚</p>
<p>é‚£æˆ‘ä»¬é¦–å…ˆæŠŠå®ƒå¯¹å¶è¿‡å»ï¼Œå°±ä¼šå¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å¤§åŒ–} \quad \sum d_iy_i \quad(i = 1, 2,3 \cdots m) \\\
\text{æ»¡è¶³çº¦æŸ} \quad \sum \limits_{j=l_i}^{r_i} y_{j} \leq c_i\quad (i = 1,2,3\cdots n)</script><p>ç„¶åæˆ‘ä»¬è€ƒè™‘ï¼Œä¼¼ä¹ä»·å€¼ä¸èƒ½å¸¦å°æ•°å•Šï¼Œæ¯•ç«Ÿé¢˜ç›®ä¸­è§„å®šäº†ä»·å€¼éƒ½ä¸ºæ•´æ•°<del>(äº‹å®ä¸Šå¹¶æ²¡æœ‰è§„å®šä½†æ˜¯æ•°æ®æ˜¯è¿™æ ·ç»™çš„)</del>ï¼Œæ¢å¥è¯è¯´æˆ‘ä»¬ä¸èƒ½å­˜åœ¨å»ºæŸåº§å¡”çš„ä¸€éƒ¨åˆ†(æ¯”å¦‚åªå»ºä¸€åŠ)ã€‚</p>
<p>é‚£ä¹ˆè¿™å°±æ˜¯<strong>æ•´æ•°çº¿æ€§è§„åˆ’é—®é¢˜</strong>ï¼Œæ¢å¥è¯è¯´å°±æ˜¯<strong>è‡ªå˜é‡å–å€¼èŒƒå›´æ˜¯$\Z$çš„çº¿æ€§è§„åˆ’</strong>ã€‚</p>
<p>å‘ƒï¼Œè¿™é—®é¢˜å·²ç»è¢«è¯æ˜æ˜¯$\rm{NP-Hard}$çš„é—®é¢˜äº†â€¦ä½†æ˜¯ï¼Œæœ‰ä¸€ç§çŸ©é˜µå«åš<strong>å…¨å¹ºæ¨¡çŸ©é˜µ</strong>ï¼Œå³<strong>å…ƒç´ åªä¼šæ˜¯$\boldsymbol{0,1,-1}$çš„çŸ©é˜µ</strong>ï¼Œè¢«è¯æ˜è‚¯å®šè‡³å°‘æœ‰ä¸€ç»„æœ€ä¼˜è§£ä¿è¯æ•´æ•°çº¿æ€§è§„åˆ’ä¸å®æ•°çº¿æ€§è§„åˆ’çš„æ–¹æ¡ˆä¸€è‡´ã€‚</p>
<p><del>å•¥ï¼Œä½ è¯´å•¥ï¼Ÿä½ è¦å…³äºå…¨å¹ºæ¨¡çŸ©é˜µè¿™ä¸ªæ€§è´¨çš„äº‰é¸£ï¼Ÿæ˜¯ç™¾å®¶äº‰é¸£é‚£ä¸ªäº‰é¸£å—ï¼Ÿå­¦OIå‘¢åˆ«çè®¨è®ºå†å²</del> </p>
<p>ç„¶åå°±å¯ä»¥ä¸€å‘å•çº¯å½¢ç»™è‰¹è¿‡å»å•¦~å¼€å¿ƒå¿ƒ~</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>, INF = <span class="number">1e9</span> ;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; <span class="keyword">double</span> A[MAXN][MAXM] ;</span><br><span class="line"><span class="keyword">int</span> N, M, B, E, i, j, k, p ; <span class="keyword">double</span> res, t, cost[MAXM], _need[MAXM] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pivot</span><span class="params">(<span class="keyword">int</span> e, <span class="keyword">int</span> l)</span></span>&#123;</span><br><span class="line">	cost[l] /= A[l][e], t = A[l][e], A[l][e] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="keyword">if</span> (i != e) A[l][i] /= t ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">if</span> (i != l &amp;&amp; <span class="built_in">abs</span>(A[i][e]) &gt; eps)&#123;</span><br><span class="line">			cost[i] -= A[i][e] * cost[l] ;  </span><br><span class="line">			<span class="keyword">for</span> (p = <span class="number">1</span> ; p &lt;= M ; ++ p) <span class="keyword">if</span> (p != e) A[i][p] -= A[i][e] * A[l][p] ;</span><br><span class="line">			A[i][e] = - A[i][e] * A[l][e] ;</span><br><span class="line">		&#125; </span><br><span class="line">	res += _need[e] * cost[l] ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="keyword">if</span> (i != e) _need[i] -= _need[e] * A[l][i] ;</span><br><span class="line">	_need[e] = - _need[e] * A[l][e] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">simplex</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">		<span class="keyword">double</span> MINX = INF ; j = <span class="number">0</span>, k = <span class="number">0</span> ;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= M ; ++ j) <span class="keyword">if</span> (_need[j] &gt; eps) <span class="keyword">break</span> ; <span class="keyword">if</span> (j &gt; M) <span class="keyword">return</span> res ; </span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="keyword">if</span> (A[i][j] &gt; eps &amp;&amp; MINX &gt; cost[i] / A[i][j]) k = i, MINX = cost[i] / A[i][j] ;</span><br><span class="line">		<span class="keyword">if</span> (MINX &gt;= INF) <span class="keyword">return</span> INF ;  Pivot(j, k) ;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;cost[i]) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%lf"</span>, &amp;B, &amp;E, &amp;_need[i]) ; <span class="comment">//çº¦æŸ </span></span><br><span class="line">		<span class="keyword">for</span> (j = B ; j &lt;= E ; ++ j) A[j][i] = <span class="number">1.0</span> ;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, (<span class="keyword">int</span>)(simplex() + <span class="number">0.5</span>)) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ€ä¹ˆè¯´å‘¢ï¼Œä¼¼ä¹å•çº¯å½¢æœ‰å¥½å¤šåœ°æ–¹çš„å†™æ³•éƒ½æ¯”è¾ƒçµæ´»<del>è®©æˆ‘ä¸çŸ¥é“èƒŒä»€ä¹ˆæ ·çš„æ¿å­ä¼šæ›´å¥½</del></p>
<h1 id="rm-0x02-NOI2008-å¿—æ„¿è€…æ‹›å‹Ÿ"><a href="#rm-0x02-NOI2008-å¿—æ„¿è€…æ‹›å‹Ÿ" class="headerlink" title="$\rm{0x02}$ [NOI2008] å¿—æ„¿è€…æ‹›å‹Ÿ"></a>$\rm{0x02}$ [NOI2008] å¿—æ„¿è€…æ‹›å‹Ÿ</h1><p>ä¼ é€é—¨ï¼š<a href="https://www.luogu.org/problemnew/show/P3980" target="_blank" rel="noopener">https://www.luogu.org/problemnew/show/P3980</a></p>
<p><del>ä»€ä¹ˆé¬¼å•Šè¿™ä¸æ˜¯ä¸Šé¢çš„é‚£é“é¢˜å—</del></p>
<p>è¿˜æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å°åŒ–} \quad \sum c_ix_i \quad(i = 1,2,3\cdots m)\\\
\text{æ»¡è¶³çº¦æŸ} \quad \sum \limits_{j=1}^{m} w_{i,j}x_{j} \geq A_i \quad (i = 1,2,3\cdots n)</script><p>å…¶ä¸­$x_j$è¡¨ç¤ºé€‰æ‹©çš„ç¬¬$j$ç±»å¿—æ„¿è€…çš„ä¸ªæ•°ï¼Œ$w_{i,j}$è¡¨ç¤ºåœ¨ç¬¬$i$å¤©ï¼Œç¬¬$j$ç±»å¿—æ„¿è€…èƒ½å¦é€‰æ‹©ã€‚é‚£ä¹ˆè¿˜æ˜¯è€æ ·å­ï¼Œå¯¹å¶è¿‡å»å°±å¯ä»¥å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å¤§åŒ–} \quad \sum A_ix_i \quad(i = 1,2,3\cdots n)\\\
\text{æ»¡è¶³çº¦æŸ} \quad \sum \limits_{j=1}^{m} w_{i,j}x_{j} \leq c_i \quad (i = 1,2,3\cdots m)</script><p>æ€ä¹ˆè¯´å‘¢â€¦â€¦è¿™ä¸ªä¸€å¼€å§‹çš„å»ºæ¨¡æ¯”ä¸Šä¸€ä¸ªé¢˜è¿˜æ˜¯æœ‰éš¾åº¦çš„ï¼Œå› ä¸ºä¸Šä¸€ä¸ªé¢˜çš„$L_i,R_i$è·Ÿçº¦æŸæœ‰å…³ï¼Œè€Œè¿™æ¬¡çš„$L_i,R_i$åˆ™æ˜¯è·Ÿç›®æ ‡å‡½æ•°æœ‰å…³â€”â€”æˆ–è®¸ä¸åº”è¯¥è¿™ä¹ˆè¯´ï¼Œä½†æ˜¯çœ‹ä¸Šå»ç¡®å®ä¸å¦‚ä¸Šé¢é‚£é¢˜è·Ÿçº¦æŸæœ‰å…³ç³»å°±å¯¹äº†<del>(æˆ‘åœ¨BBä¸€å †ä»€ä¹ˆå•Š)</del></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 1e9</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 1035</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 10010</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span> ; <span class="keyword">double</span> res ;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; <span class="keyword">int</span> b[MAXM], e[MAXM] ; </span><br><span class="line"><span class="keyword">int</span> N, M, i, j, k ; <span class="keyword">double</span> C[MAXM], _need[MAXM], A[MAXM][MAXN] ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pivot</span><span class="params">(<span class="keyword">int</span> posN, <span class="keyword">int</span> posC)</span></span>&#123;</span><br><span class="line">	C[posC] /= A[posC][posN] ; <span class="comment">// constraint divided by A_&#123;l,e&#125;</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">1</span> ; p &lt;= N ; ++ p) <span class="keyword">if</span> (p != posN) A[posC][p] /= A[posC][posN] ;<span class="comment">//this line Booom</span></span><br><span class="line">	A[posC][posN] = <span class="number">1</span> ;</span><br><span class="line">	<span class="comment">// Pivot is above, taking it back is below</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">1</span> ; p &lt;= M ; ++ p)<span class="comment">//taking back to constraints </span></span><br><span class="line">		<span class="keyword">if</span> (p != posC &amp;&amp; <span class="built_in">fabs</span>(A[p][posN]) &gt; eps)&#123;</span><br><span class="line">			C[p] -= A[p][posN] * C[posC] ;</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">				<span class="keyword">if</span> (i != posN) A[p][i] -= A[p][posN] * A[posC][i] ;</span><br><span class="line">			A[p][posN] = <span class="number">0</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">	res += _need[posN] * C[posC] ;<span class="comment">//this time results in a better INIT-Sol</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">1</span> ; p &lt;= N ; ++ p) <span class="keyword">if</span> (p != posN) _need[p] -= _need[posN] * A[posC][p] ;</span><br><span class="line">	_need[posN] = - _need[posN] * A[posC][posN] ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">simplex</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		j = <span class="number">0</span>, k = <span class="number">0</span> ; <span class="keyword">double</span> MAX = INF ;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j) <span class="keyword">if</span> (_need[j] &gt; eps) <span class="keyword">break</span> ; <span class="comment">/*1*/</span> <span class="keyword">if</span> (j &gt; N) <span class="keyword">return</span> res ; <span class="comment">//make-it-sure if go on</span></span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="keyword">if</span> (A[i][j] &gt; eps &amp;&amp; MAX &gt; C[i] / A[i][j]) MAX = C[i] / A[i][j], k = i ; <span class="comment">//find the min_val constraint</span></span><br><span class="line">		<span class="keyword">if</span> (MAX &gt;= INF) <span class="keyword">return</span> INF ; <span class="comment">/* this task is unbounded */</span> Pivot(j, k) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cin</span> &gt;&gt; _need[i] ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%lf"</span>, &amp;b[i], &amp;e[i], &amp;C[i]) ;</span><br><span class="line">		<span class="keyword">for</span> (j = b[i] ; j &lt;= e[i] ; ++ j) A[i][j] = <span class="number">1</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, (<span class="keyword">int</span>)(simplex()+<span class="number">0.5</span>)) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$\rm{Reference}$"></a>$\rm{Reference}$</h2><ul>
<li>$[1]$ :$Candy?$çš„$blog$ <a href="https://www.cnblogs.com/candy99/" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li>
</ul>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>çº¿æ€§è§„åˆ’/å•çº¯å½¢æ³•</tag>
        <tag>çº¿æ€§è§„åˆ’/å¯¹å¶å®šç†</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ç½‘ç»œæµ24é¢˜ä¸“é¢˜ã€‘1 Â· è¾ƒç®€å•çš„è´¹ç”¨æµ</title>
    <url>/2019/03/29/nw-flow-24-1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>åŒ…æ‹¬ä»¥ä¸‹å¯ä»¥ç”¨è´¹ç”¨æµè§£å†³çš„é—®é¢˜ï¼š</p>
<p><code>loj#6011</code> è¿è¾“é—®é¢˜ï¼Œ<code>loj#6012</code> åˆ†é…é—®é¢˜ ã€ <code>loj#6024</code> æ·±æµ·æœºå™¨äººé—®é¢˜ ä»¥åŠ  <code>loj#6025</code> ç«æ˜Ÿè¿è¾“é—®é¢˜ã€‚</p>
<a id="more"></a>
<h1 id="è¿è¾“é—®é¢˜"><a href="#è¿è¾“é—®é¢˜" class="headerlink" title="è¿è¾“é—®é¢˜"></a>è¿è¾“é—®é¢˜</h1><blockquote>
<p>ç»™å®šä¸€ä¸ªäºŒåˆ†å›¾ã€‚ä¸€å¼€å§‹æ¯ä¸ªç‚¹æœ‰ç‚¹æƒï¼Œå¯¹äºä¸€æ¡è¾¹æ‰€è¿æ¥çš„ $a_i,b_j$ ï¼Œå¯ä»¥è®© $a_i\text{+=}\Delta,b_j\text{-=}\Delta$ æˆ–è€…åè¿‡æ¥ï¼Œä»£ä»·å‡ä¸º $c_{i,j}\times \Delta$ã€‚ç°åœ¨éœ€è¦è®© $\sum a_i=\sum b_i$ ï¼Œæœ€å°åŒ–ä»£ä»·å’Œã€‚</p>
</blockquote>
<p>çœ‹äº† $40\%$ ?</p>
<p>å…¶å®å°±æ˜¯</p>
<script type="math/tex; mode=display">
\rm S\stackrel{f = a_i,c = 0}{\longrightarrow}i \stackrel{f = + \infty,c = c_{i,j}}{\longrightarrow}j \stackrel{f = b_j,c=0}{\longrightarrow}T</script><p>å…¶ä¸­$i$ä»£è¡¨ä»“åº“çš„ç¼–å·ï¼Œ$j$ä»£è¡¨å•†åº—çš„ç¼–å·ï¼Œå»ºå®Œå›¾è·‘è´¹ç”¨æµå³å¯ã€‚</p>
<p>ç”±äºSPFAæ­»äº†ï¼Œæ‰€ä»¥å°±ä¸€ç›´ç”¨$dijk$åšè´¹ç”¨æµï¼Œåªä¸è¿‡éš¾èƒŒä¸€ç‚¹â€¦â€¦ç„¶åç¬¬äºŒé—®çš„è¯å°±æŠŠæƒå€¼å–è´Ÿé‡æ–°åšä¸€ä¸‹è´¹ç”¨æµå°±å¥½ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œè¿™ä¸ªé¢˜ä¼¼ä¹æ˜¯æ¯”è¾ƒè£¸çš„è´¹ç”¨æµçš„é¢˜äº†ï¼Ÿä¸€èˆ¬è´¹ç”¨æµå¤§æ¦‚éƒ½æ˜¯ç”¨æ¥æ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜çš„å§qwqâ€¦â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to, next, f, c ;</span><br><span class="line">&#125;E[MAXN] ; <span class="keyword">int</span> head[MAXN], cnt = <span class="number">-1</span> ;</span><br><span class="line"><span class="keyword">int</span> S, T, N, M, dist[MAXN], i, j, k, t[MAXN], x ; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> dist, num ;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> node &amp; now) <span class="keyword">const</span>&#123;<span class="keyword">return</span> dist &gt; now.dist ; &#125;</span><br><span class="line">&#125;; priority_queue&lt;node&gt; q ; <span class="keyword">bool</span> vis[MAXN] ; <span class="keyword">int</span> Last[MAXN], F[MAXN], H[MAXN], Pre[MAXN], MAX_C ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;u, <span class="keyword">const</span> <span class="keyword">int</span> &amp;v, <span class="keyword">const</span> <span class="keyword">int</span> &amp;f, <span class="keyword">const</span> <span class="keyword">int</span>&amp; c)</span></span>&#123;</span><br><span class="line">	E[++ cnt].to = v, E[cnt].c = c, t[cnt] = f ;</span><br><span class="line">	E[cnt].f = f, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">	E[++ cnt].to = u, E[cnt].c = -c, t[cnt] = <span class="number">0</span> ;</span><br><span class="line">	E[cnt].f = <span class="number">0</span>, E[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">dijkstra</span><span class="params">()</span></span>&#123;</span><br><span class="line">    q.push((node)&#123;<span class="number">0</span>, S&#125;) ; vis[S] = dist[S] = <span class="number">0</span>, F[<span class="number">0</span>] = Inf ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= T ; ++ i) dist[i] = F[i] = Inf, vis[i] = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">		node now = q.top() ; q.pop() ;</span><br><span class="line">		<span class="keyword">int</span> fr = now.num, sec = now.dist ; <span class="keyword">if</span> (vis[fr]) <span class="keyword">continue</span> ;</span><br><span class="line">		<span class="keyword">for</span> (vis[fr] = <span class="number">1</span>, k = head[fr] ; k != <span class="number">-1</span> ; k = E[k].next)&#123;</span><br><span class="line">			<span class="keyword">int</span> nowc = sec + E[k].c + H[fr] - H[to(k)] ;</span><br><span class="line">			<span class="keyword">if</span> (E[k].f &gt; <span class="number">0</span> &amp;&amp; !vis[to(k)] &amp;&amp; dist[to(k)] &gt; nowc)&#123;</span><br><span class="line">				dist[to(k)] = nowc, q.push((node)&#123;dist[to(k)], to(k)&#125;) ;</span><br><span class="line">				F[to(k)] = min(F[fr], E[k].f), Pre[to(k)] = fr, Last[to(k)] = k ; </span><br><span class="line">			&#125;<span class="comment">//!!!!!</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> dist[T] &lt; Inf ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MCMF</span><span class="params">(<span class="keyword">int</span> qwq)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> _Ed ; MAX_C = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">while</span> (dijkstra())&#123;</span><br><span class="line">		_Ed = T, MAX_C += (dist[T] - H[S] + H[T]) * F[T] ;</span><br><span class="line">		<span class="keyword">while</span>(_Ed != S)	E[Last[_Ed]].f -= F[T], E[Last[_Ed] ^ <span class="number">1</span>].f += F[T], _Ed = Pre[_Ed] ;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= T ; ++ i) H[i] += dist[i] ; <span class="comment">/*	cout &lt;&lt; MAX_C &lt;&lt; endl ;  */</span></span><br><span class="line">	&#125;	</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; MAX_C * qwq &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M, S = <span class="number">0</span> ; </span><br><span class="line">	T = N + M + <span class="number">1</span>, <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), Add(S, i, x, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = N + <span class="number">1</span> ; i &lt;= N + M ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), Add(i, T, x, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)	</span><br><span class="line">		<span class="keyword">for</span> (j = N + <span class="number">1</span> ; j &lt;= N + M ; ++ j)</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), Add(i, j, Inf, x) ;</span><br><span class="line"><span class="comment">//    for (i = 0 ; i &lt;= cnt ; ++ i) printf("%d %d %d\n", E[i].to + 1, E[i].f, E[i].c) ;</span></span><br><span class="line">	MCMF(<span class="number">1</span>) ; <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= cnt ; ++ i) E[i].f = t[i], E[i].c = -E[i].c ; MCMF(<span class="number">-1</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="åˆ†é…é—®é¢˜"><a href="#åˆ†é…é—®é¢˜" class="headerlink" title="åˆ†é…é—®é¢˜"></a>åˆ†é…é—®é¢˜</h1><blockquote>
<p>ä¸¤ä¸ªéƒ¨å‡ä¸º $n$ ä¸ªç‚¹çš„æœ€å¤§æƒäºŒåˆ†å›¾å®Œç¾åŒ¹é…åŒ¹é…é—®é¢˜ã€‚</p>
</blockquote>
<p>å¯èƒ½ä¼šå­˜åœ¨ä¸€ä¸ªç¥å¥‡çš„KMç®—æ³•ã€‚ä½†æ˜¯è‡ªå·±ä¸ä¼šx</p>
<p>å‘ç°æ­¤é¢˜ä¸­ä¸ä»…éœ€è¦æœ€å¤§æƒï¼Œä¹Ÿéœ€è¦å®Œç¾åŒ¹é…ã€‚æ‰€ä»¥ç›´æ¥è·‘æœ€å°è´¹ç”¨/æœ€å¤§è´¹ç”¨æœ€å¤§æµå³å¯ã€‚</p>
<p>ç»†èŠ‚çš„è¯ï¼Œè€ƒè™‘ç›´æ¥åœ¨äºŒåˆ†å›¾åŒ¹é…çš„æµå›¾åŸºç¡€ä¸Šï¼ŒåŠ ä¸Š $c_{i,j}$ çš„è´¹ç”¨å°±å¥½äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">æ­¤å¤„æ˜¯dijkstraâ€¦â€¦</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MCMF</span><span class="params">(<span class="keyword">int</span> qwq)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> _Ed ; MAX_C = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">while</span> (dijkstra())&#123;</span><br><span class="line">		_Ed = T, MAX_C += (dist[T] - H[S] + H[T]) * F[T] ;</span><br><span class="line">		<span class="keyword">while</span>(_Ed != S)	</span><br><span class="line">      E[Last[_Ed]].f -= F[T], E[Last[_Ed] ^ <span class="number">1</span>].f += F[T], _Ed = Pre[_Ed] ;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= T ; ++ i) H[i] += dist[i] ; <span class="comment">/*	cout &lt;&lt; MAX_C &lt;&lt; endl ;  */</span></span><br><span class="line">	&#125;	</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; MAX_C * qwq &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ; S = <span class="number">0</span>, T = N &lt;&lt; <span class="number">1</span> | <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) Add(S, i, <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = N + <span class="number">1</span> ; i &lt;= N + N ; ++ i) Add(i, T, <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="keyword">for</span> (j = N + <span class="number">1</span> ; j &lt;= N + N ; ++ j)</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; x, Add(i, j, Inf, x) ;</span><br><span class="line">	MCMF(<span class="number">1</span>) ; </span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= cnt ; ++ i) </span><br><span class="line">    E[i].c = -E[i].c, E[i].f = t[i] ;</span><br><span class="line">  MCMF(<span class="number">-1</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ç«æ˜Ÿæ¢é™©é—®é¢˜"><a href="#ç«æ˜Ÿæ¢é™©é—®é¢˜" class="headerlink" title="ç«æ˜Ÿæ¢é™©é—®é¢˜"></a>ç«æ˜Ÿæ¢é™©é—®é¢˜</h1><blockquote>
<p>ç«æ˜Ÿæ¢é™©é˜Ÿçš„ç™»é™†èˆ±å°†åœ¨ç«æ˜Ÿè¡¨é¢ç€é™†ï¼Œç™»é™†èˆ±å†…æœ‰å¤šéƒ¨éšœç¢ç‰©æ¢æµ‹è½¦ã€‚ç™»é™†èˆ±ç€é™†åï¼Œæ¢æµ‹è½¦å°†ç¦»å¼€ç™»é™†èˆ±å‘å…ˆæœŸåˆ°è¾¾çš„ä¼ é€å™¨æ–¹å‘ç§»åŠ¨ã€‚æ¢æµ‹è½¦åœ¨ç§»åŠ¨ä¸­è¿˜å¿…é¡»é‡‡é›†å²©çŸ³æ ‡æœ¬ï¼Œæ¯ä¸€å—å²©çŸ³æ ‡æœ¬ç”±æœ€å…ˆé‡åˆ°å®ƒçš„æ¢æµ‹è½¦å®Œæˆé‡‡é›†ï¼Œæ¯å—å²©çŸ³æ ‡æœ¬åªèƒ½è¢«é‡‡é›†ä¸€æ¬¡ã€‚å²©çŸ³æ ‡æœ¬è¢«é‡‡é›†åï¼Œå…¶ä»–æ¢æµ‹è½¦å¯ä»¥ä»åŸæ¥å²©çŸ³æ ‡æœ¬æ‰€åœ¨å¤„é€šè¿‡ã€‚æ¢æµ‹è½¦ä¸èƒ½é€šè¿‡æœ‰éšœç¢çš„åœ°é¢ã€‚</p>
<p>æœ¬é¢˜é™å®šæ¢æµ‹è½¦åªèƒ½ä»ç™»é™†å¤„æ²¿ç€å‘å—æˆ–å‘ä¸œçš„æ–¹å‘æœä¼ é€å™¨ç§»åŠ¨ï¼Œè€Œä¸”å¤šä¸ªæ¢æµ‹è½¦å¯ä»¥åœ¨åŒä¸€æ—¶é—´å æ®åŒä¸€ä½ç½®ã€‚å¦‚æœæŸä¸ªæ¢æµ‹è½¦åœ¨åˆ°è¾¾ä¼ é€å™¨ä»¥å‰ä¸èƒ½ç»§ç»­å‰è¿›ï¼Œåˆ™è¯¥è½¦æ‰€é‡‡é›†çš„å²©çŸ³æ ‡æœ¬å°†å…¨éƒ¨æŸå¤±ã€‚</p>
<p>ç”¨ä¸€ä¸ª $\text{P}\times \text{Q}$ ç½‘æ ¼è¡¨ç¤ºç™»é™†èˆ±ä¸ä¼ é€å™¨ä¹‹é—´çš„ä½ç½®ã€‚ç™»é™†èˆ±çš„ä½ç½®åœ¨ $(X_1,Y_1)$ å¤„ï¼Œä¼ é€å™¨ çš„ä½ç½®åœ¨ $(X_P,Y_Q)$ å¤„ã€‚ ç»™å®šæ¯ä¸ªä½ç½®çš„çŠ¶æ€ï¼Œè®¡ç®—æ¢æµ‹è½¦çš„æœ€ä¼˜ç§»åŠ¨æ–¹æ¡ˆï¼Œä½¿åˆ°è¾¾ä¼ é€å™¨çš„æ¢æµ‹è½¦çš„æ•°é‡æœ€å¤šï¼Œ è€Œä¸”æ¢æµ‹è½¦é‡‡é›†åˆ°çš„å²©çŸ³æ ‡æœ¬çš„æ•°é‡æœ€å¤šã€‚</p>
<p><img src="https://www.oj.swust.edu.cn/upload/image/problem/1758.png" alt="233"> </p>
</blockquote>
<p>å‘ç°æ¯ä¸ªç‚¹è™½ç„¶å¯èƒ½æœ‰è‡³å¤š $1$ ä¸ªçŸ³å—ï¼Œä½†æ˜¯å¯ä»¥é‡å¤ç»è¿‡ã€‚äºæ˜¯è‡ªç„¶æƒ³åˆ°æŠŠæ¯ä¸ªç‚¹æ‹†æˆä¿©ï¼Œä¹‹é—´è¿ $f=1,c=-1$ çš„è¾¹ã€‚å¯¹äºä¸€ä¸ªç‚¹ $x$ å’Œä»–ç›´æ¥è¿é€šçš„ç‚¹ $y$ ï¼Œå°† $x,xâ€™$ å’Œ $y,yâ€™$ è¿™ $2*2=4$ ä¸ªç‚¹å¯¹åˆ†åˆ«è¿ $f=\infty,c=0$ çš„æ™®é€šè¾¹ï¼Œä»£è¡¨ç€èµ°è¿˜æ˜¯ä¸èµ°ã€‚å½“ç„¶è¿™ä¸ªåœ°æ–¹è¿˜æœ‰å¦ä¸€ä¸ªå¤„ç†æ–¹æ³•ï¼Œå°±æ˜¯ç›´æ¥æ‹¿ $xâ€™$ å»è·Ÿ $y$ è¿ï¼Œç„¶åæ¯ä¸ª $x$ å†å’Œ $xâ€™$ è¿ä¸€ä¸ª $f=\infty,c=0$ çš„è¾¹ã€‚å¯ä»¥çŸ¥é“è¿™æ ·æ˜¯æœ¬è´¨ç›¸åŒçš„ã€‚</p>
<p>æœ€å $dfs$ è¾“å‡ºæ–¹æ¡ˆã€‚è¿™é‡Œ $dfs$ çš„æ–¹å¼å¯¹æˆ‘è‡ªå·±è€Œè¨€æ˜¯æœ‰å¯å‘çš„ã€‚æœ¬æ¥æƒ³çš„æ˜¯é€æ¸å¢åŠ  $\rm S$ çš„åˆå§‹æµé‡ï¼Œç„¶åå» $dfs$ æ‰¾å“ªäº›è¾¹å·²ç»æ»¡æµäº†ã€‚ä½†è¿™æ ·æ²¡æ³•å»è®°å½•å“ªäº›æ˜¯è¿™ä¸€å±‚å¢å¹¿çš„ï¼Œå“ªäº›æ˜¯ä¹‹å‰å¢å¹¿çš„ã€‚æ‰€ä»¥è€ƒè™‘ä¸€å¼€å§‹å…¨éƒ¨æµä¸€ä¸‹ï¼Œç„¶åè¾¹ $dfs$ è¾¹æ¨¡æ‹Ÿæµçš„è¿‡ç¨‹ã€‚<strong>åˆ¤æ–­æ¯æ¡è¾¹æ˜¯å¦åº”è¯¥è¢«æµï¼Œç›´æ¥çœ‹åå‘è¾¹çš„æµé‡å³å¯ã€‚</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> num ;</span><br><span class="line"><span class="keyword">int</span> tot ;</span><br><span class="line"><span class="keyword">int</span> fl[M] ;</span><br><span class="line"><span class="keyword">int</span> ans[M] ;</span><br><span class="line"><span class="keyword">int</span> Id[N][N] ;</span><br><span class="line"><span class="keyword">int</span> base[N][N] ;</span><br><span class="line"><span class="keyword">int</span> _n, _m, _k ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dodo</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">	<span class="comment">//cout &lt;&lt; x &lt;&lt; " " &lt;&lt; y &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">if</span> (x == _n &amp;&amp; y == _m)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; len ; ++ i)</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; num &lt;&lt; <span class="string">" "</span> &lt;&lt; ans[i] &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> now = Id[x][y] ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; ~k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (fl[k] &gt;= fw(k ^ <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">continue</span> ; <span class="keyword">else</span> fl[k] ++ ;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == Id[x + <span class="number">1</span>][y])</span><br><span class="line">            &#123; ans[len] = <span class="number">0</span> ; dodo(x + <span class="number">1</span>, y, len + <span class="number">1</span>) ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == Id[x][y + <span class="number">1</span>])</span><br><span class="line">            &#123; ans[len] = <span class="number">1</span> ; dodo(x, y + <span class="number">1</span>, len + <span class="number">1</span>) ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == Id[x + <span class="number">1</span>][y] + tot)</span><br><span class="line">            &#123; ans[len] = <span class="number">0</span> ; dodo(x + <span class="number">1</span>, y, len + <span class="number">1</span>) ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == Id[x][y + <span class="number">1</span>] + tot)</span><br><span class="line">            &#123; ans[len] = <span class="number">1</span> ; dodo(x, y + <span class="number">1</span>, len + <span class="number">1</span>) ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	now += tot ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; ~k ; k = next(k))&#123;</span><br><span class="line">        <span class="keyword">if</span> (fl[k] &gt;= fw(k ^ <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">continue</span> ; <span class="keyword">else</span> fl[k] ++ ;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == Id[x + <span class="number">1</span>][y])</span><br><span class="line">            &#123; ans[len] = <span class="number">0</span> ; dodo(x + <span class="number">1</span>, y, len + <span class="number">1</span>) ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == Id[x][y + <span class="number">1</span>])</span><br><span class="line">			&#123; ans[len] = <span class="number">1</span> ; dodo(x, y + <span class="number">1</span>, len + <span class="number">1</span>) ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == Id[x + <span class="number">1</span>][y] + tot)</span><br><span class="line">            &#123; ans[len] = <span class="number">0</span> ; dodo(x + <span class="number">1</span>, y, len + <span class="number">1</span>) ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">        <span class="keyword">if</span> (to(k) == Id[x][y + <span class="number">1</span>] + tot)</span><br><span class="line">            &#123; ans[len] = <span class="number">1</span> ; dodo(x, y + <span class="number">1</span>, len + <span class="number">1</span>) ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">int</span> a, b, c, d ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; _k &gt;&gt; _m &gt;&gt; _n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= _n + <span class="number">1</span> ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= _m + <span class="number">1</span> ; ++ j)</span><br><span class="line">            base[i][j] = <span class="number">1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= _m ; ++ j)</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; base[i][j], Id[i][j] = ++ tot ;</span><br><span class="line">    n = <span class="keyword">_t</span> = tot * <span class="number">2</span> + <span class="number">1</span> ; _s = <span class="number">0</span> ;</span><br><span class="line">    add(_s, <span class="number">1</span>, _k, <span class="number">0</span>) ; </span><br><span class="line">	<span class="comment">//add(_s, tot + 1, _k, 0) ;</span></span><br><span class="line">    <span class="comment">//add(Id[_n][_m], _t, _k, 0) ; </span></span><br><span class="line">	add(Id[_n][_m] + tot, <span class="keyword">_t</span>, _k, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= _m ; ++ j)&#123;</span><br><span class="line">			<span class="keyword">if</span> (base[i][j] == <span class="number">1</span>) <span class="keyword">continue</span> ;</span><br><span class="line">            <span class="keyword">if</span> (base[i + <span class="number">1</span>][j] != <span class="number">1</span>)&#123;</span><br><span class="line">                add(Id[i][j], Id[i + <span class="number">1</span>][j], I, <span class="number">0</span>) ;</span><br><span class="line">                add(Id[i][j], Id[i + <span class="number">1</span>][j] + tot, I, <span class="number">0</span>) ;</span><br><span class="line">                add(Id[i][j] + tot, Id[i + <span class="number">1</span>][j], I, <span class="number">0</span>) ;</span><br><span class="line">                add(Id[i][j] + tot, Id[i + <span class="number">1</span>][j] + tot, I, <span class="number">0</span>) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (base[i][j + <span class="number">1</span>] != <span class="number">1</span>)&#123;</span><br><span class="line">                add(Id[i][j], Id[i][j + <span class="number">1</span>], I, <span class="number">0</span>) ;</span><br><span class="line">                add(Id[i][j], Id[i][j + <span class="number">1</span>] + tot, I, <span class="number">0</span>) ;</span><br><span class="line">                add(Id[i][j] + tot, Id[i][j + <span class="number">1</span>], I, <span class="number">0</span>) ;</span><br><span class="line">                add(Id[i][j] + tot, Id[i][j + <span class="number">1</span>] + tot, I, <span class="number">0</span>) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (base[i][j] == <span class="number">2</span>)</span><br><span class="line">                add(Id[i][j], Id[i][j] + tot, <span class="number">1</span>, <span class="number">-1</span>) ;</span><br><span class="line">        	<span class="comment">//add(Id[i][j], Id[i][j] + tot, I, 0) ;</span></span><br><span class="line">		&#125;</span><br><span class="line">    ek() ; <span class="comment">//cout &lt;&lt; res &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= _k ; ++ i)</span><br><span class="line">        num = i, dodo(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ·±æµ·æœºå™¨äººé—®é¢˜"><a href="#æ·±æµ·æœºå™¨äººé—®é¢˜" class="headerlink" title="æ·±æµ·æœºå™¨äººé—®é¢˜"></a>æ·±æµ·æœºå™¨äººé—®é¢˜</h1><blockquote>
<p>æ·±æµ·èµ„æºè€ƒå¯Ÿæ¢é™©é˜Ÿçš„æ½œè‰‡å°†åˆ°è¾¾æ·±æµ·çš„æµ·åº•è¿›è¡Œç§‘å­¦è€ƒå¯Ÿã€‚æ½œè‰‡å†…æœ‰å¤šä¸ªæ·±æµ·æœºå™¨äººã€‚æ½œè‰‡åˆ°è¾¾æ·±æµ·æµ·åº•åï¼Œæ·±æµ·æœºå™¨äººå°†ç¦»å¼€æ½œè‰‡å‘é¢„å®šç›®æ ‡ç§»åŠ¨ã€‚æ·±æµ·æœºå™¨äººåœ¨ç§»åŠ¨ä¸­è¿˜å¿…é¡»æ²¿é€”é‡‡é›†æµ·åº•ç”Ÿç‰©æ ‡æœ¬ã€‚æ²¿é€”ç”Ÿç‰©æ ‡æœ¬ç”±æœ€å…ˆé‡åˆ°å®ƒçš„æ·±æµ·æœºå™¨äººå®Œæˆé‡‡é›†ã€‚æ¯æ¡é¢„å®šè·¯å¾„ä¸Šçš„ç”Ÿç‰©æ ‡æœ¬çš„ä»·å€¼æ˜¯å·²çŸ¥çš„ï¼Œè€Œä¸”ç”Ÿç‰©æ ‡æœ¬åªèƒ½è¢«é‡‡é›†ä¸€æ¬¡ã€‚</p>
<p>æœ¬é¢˜é™å®šæ·±æµ·æœºå™¨äººåªèƒ½ä»å…¶å‡ºå‘ä½ç½®æ²¿ç€å‘åŒ—æˆ–å‘ä¸œçš„æ–¹å‘ç§»åŠ¨ï¼Œè€Œä¸”å¤šä¸ªæ·±æµ·æœºå™¨äººå¯ä»¥åœ¨åŒä¸€æ—¶é—´å æ®åŒä¸€ä½ç½®ã€‚ç”¨ä¸€ä¸ª $\text{P} \times \text{Q}$ ç½‘æ ¼è¡¨ç¤ºæ·±æµ·æœºå™¨äººçš„å¯ç§»åŠ¨ä½ç½®ã€‚è¥¿å—è§’çš„åæ ‡ä¸º $(0,0)$ ï¼Œä¸œåŒ—è§’çš„åæ ‡ä¸º $(Q,P)$ ã€‚</p>
<p>ç»™å®šæ¯ä¸ªæ·±æµ·æœºå™¨äººçš„å‡ºå‘ä½ç½®å’Œç›®æ ‡ä½ç½®ï¼Œä»¥åŠæ¯æ¡ç½‘æ ¼è¾¹ä¸Šç”Ÿç‰©æ ‡æœ¬çš„ä»·å€¼ã€‚è®¡ç®—æ·±æµ·æœºå™¨äººçš„æœ€ä¼˜ç§»åŠ¨æ–¹æ¡ˆï¼Œ ä½¿æ·±æµ·æœºå™¨äººåˆ°è¾¾ç›®çš„åœ°åï¼Œé‡‡é›†åˆ°çš„ç”Ÿç‰©æ ‡æœ¬çš„æ€»ä»·å€¼æœ€é«˜ã€‚</p>
<p><img src="https://www.oj.swust.edu.cn/upload/image/problem/1755.png" alt="233"></p>
</blockquote>
<p>å‘ç°â€¦ä¼¼ä¹å’Œä¸Šä¸€é“é¢˜å·®ä¸å¤šï¼Ÿå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯æƒæ”¾åˆ°è¾¹ä¸Šäº†ï¼Œå¤§æ¦‚æ˜¯24é¢˜é‡Œæœ€ç®€å•çš„é¢˜ä¹‹ä¸€äº†å§ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cnt = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">int</span> a, b, c, d ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; _n &gt;&gt; _m ;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= _n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= _m ; ++ j)</span><br><span class="line">            Id[i][j] = ++ tot ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= _n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; _m ; ++ j)</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; c, add(Id[i][j], Id[i][j + <span class="number">1</span>], <span class="number">1</span>, -c) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= _m ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; _n ; ++ j)</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; d, add(Id[j][i], Id[j + <span class="number">1</span>][i], <span class="number">1</span>, -d) ;</span><br><span class="line">    n = <span class="keyword">_t</span> = tot + <span class="number">1</span> ; _s = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= _n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= _m ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; _n) add(Id[i][j], Id[i + <span class="number">1</span>][j], I, <span class="number">0</span>) ;</span><br><span class="line">            <span class="keyword">if</span> (j &lt; _m) add(Id[i][j], Id[i][j + <span class="number">1</span>], I, <span class="number">0</span>) ;</span><br><span class="line">           &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= a ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; _k &gt;&gt; c &gt;&gt; d, add(_s, Id[c][d], _k, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= b ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; _k &gt;&gt; c &gt;&gt; d, add(Id[c][d], <span class="keyword">_t</span>, _k, <span class="number">0</span>) ;</span><br><span class="line">    ek() ; <span class="built_in">cout</span> &lt;&lt; -res &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åè°·çš„è®¨è®ºåŒºå¿«ç¬‘æ­»æˆ‘äº†ï¼š</p>
<p><img src="fmf.png" alt></p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>ç½‘ç»œæµ24é¢˜</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œæµ24é¢˜</tag>
        <tag>ç½‘ç»œæµ/è´¹ç”¨æµ</tag>
      </tags>
  </entry>
  <entry>
    <title>éšæƒ³ä¸ƒ Â· è¨€è‘‰ã®åº­</title>
    <url>/2019/03/28/%E9%9A%8F%E6%83%B3%E4%B8%83%C2%B7%E8%A8%80%E5%8F%B6%E4%B9%8B%E5%BA%AD/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote>
<p>â€‹    Hello darkness my old friend. é»¯æ·¡å¦‚æ—§ï¼Œä»Šæ—¶é‡é€¢ã€‚<br>â€‹    Iâ€™ve come to talk with you again. é˜”åˆ«ä¹…æ—¥ï¼Œå¯èµ´ä½å™ï¼Ÿ<br>â€‹    Because a vision softly creeping. å¦‚æ¢¦å¦‚å¹»ï¼Œäºæˆ‘å¿ƒè¦ã€‚<br>â€‹    Left its seeds while I was sleeping. é—ä¹‹å…¥æ¢¦ï¼Œé½æˆ‘å¿ƒåŒã€‚<br>â€‹    And the vision that was planted in my brain. ä¸çŸ¥å½’å¤„ï¼Œä¸çŸ¥å½’å¤„ã€‚<br>â€‹    Still remains with the sound of silence. è¡ŒèˆŸå¦‚é£ï¼Œé£èˆŸè¿Ÿæš®ã€‚<br>â€‹    In restless dreams I walk alone. å¾å¿ƒç‹¬è¡Œï¼Œå…°çš‹æ­¢æ¯ã€‚<br>â€‹    Narrow streets of cobble stone. è¶Šé™Œåº¦é˜¡ï¼Œå¯æœ‰ä¸€é†‰ï¼Ÿ<br>â€‹    Beneath the hallo of a street lampâ€™, å¦‚å…‰åŒ–å½±ï¼Œäºæˆ‘å¿ƒå¯‚ã€‚<br>â€‹    I turned my collar to the cold and damp. æµŠå¯’å…¥è¥Ÿï¼Œåˆºæˆ‘å¿ƒåº•ã€‚<br>â€‹    When my eyes were stabbled. æ‰€è§çš†å¹»ï¼Œæ‰€è§çš†æ˜ã€‚<br>â€‹    By the flash of a neon light. ä¸‡ç‰©çš†è™šï¼Œä¸‡ç‰©çš†å…ã€‚<br>â€‹    That split the night. ä¸çŸ¥å½’å¤„ï¼Œä¸çŸ¥å½’å¤„ã€‚<br>â€‹    And touched the sound of silence æ˜Ÿç€šç¿æ¼«ï¼Œè¡Œäººæ…¢èµ°ã€‚</p>
<p>â€‹    â€”â€”ã€$\rm{The ~Sound~of~Silence}$ã€å¯‚é™ä¹‹å£°</p>
</blockquote>
<p>éšæƒ³ç³»åˆ—ç›®æ¬¡è¡¨ï¼š<a href="http://www.orchidany.cf/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/" target="_blank" rel="noopener">æˆ³æˆ‘</a></p>
<p>è¿™æ¬¡å¤§æ¦‚ä¼šå†™çš„æ—¶é—´çº¿å¾ˆè·³è·ƒï¼Œä½†æˆ‘çœŸçš„æ˜¯è¢«è¿™ä¸ªæ•…äº‹å©å‡»äº†å¿ƒè„æœ€æ·±å¤„çš„åœ°æ–¹ã€‚</p>
<hr>
<h1 id="rm-Part-1"><a href="#rm-Part-1" class="headerlink" title="$\rm{Part~1}$"></a>$\rm{Part~1}$</h1><p>æœˆè€ƒç»“æŸäº†ã€‚æˆ‘ç»ˆäºæœ‰æ—¶é—´æŠŠè¿™æœ¬ä¹¦è¯»å®Œã€‚</p>
<p>ä¹‹å‰æ˜¯ä¸€æ¬¡å‘¨æœ«ï¼Œå›ºå®šçš„å¥¥èµ›æ—¶é—´ã€‚ä¸­é€”è¯¾ä»¶å»å­¦æ ¡çš„ä¹¦åº—é€›â€”â€”ä¸€ä¸ªä¸é”™çš„ä¹¦å§ï¼Œä¹¦å¢¨é¦™é€ç€å°èµ„æƒ…è°ƒã€‚</p>
<p>æˆ‘åœ¨ä¸èµ·çœ¼çš„åœ°æ–¹ï¼Œå¶ç„¶å‘ç°äº†ä¸€æœ¬ã€Šè¨€å¶ä¹‹åº­ã€‹â€”â€”çœ‹èµ·æ¥æ˜¯æœ€åä¸€æœ¬äº†ï¼Œæƒ³éƒ½æ²¡æƒ³å°±ä¹°äº†ã€‚38å…ƒï¼Œä¸ä¾¿å®œï¼Œè–„è–„çš„ä¸€æœ¬ï¼Œä½†æ˜¯å°é¢å´æ˜¯ä¸€ç‰‡ä»¤äººèµå¿ƒæ‚¦ç›®çš„æµ“ç»¿â€”â€”æ˜¯ç”¨æ²¹å½©ç”»çš„æ ‘å¶ï¼Œå¾ˆæ¼‚äº®â€”â€”é‚è§‰å¾—ä¸ç®—ç‰©ä¸æŠµä»·ã€‚</p>
<p>ä½†ä¹°å›æ¥æ‰å‘ç°ï¼Œä¸æ˜¯æ–°æµ·è¯šçš„å†™çš„ï¼Œè€Œæ˜¯ä»–çš„ä¸€ä¸ªâ€œå¥½åŸºå‹â€åŠ çº³æ–°å¤ªï¼Œç«™åœ¨ç§‹æœˆå­é›„çš„ç«‹åœºå†™çš„ã€‚å‰§æƒ…å¤§ä½“ä¸Šè·Ÿæˆ‘ä¸€å¹´ä¹‹å‰çœ‹è¿‡çš„46åˆ†é’Ÿçš„çŸ­ç‰‡å·®ä¸å¤šï¼Œâ€œå°±å½“ä¹°äº†æ”¶è—å§â€æˆ‘æƒ³ã€‚</p>
<p>ã€Šè¨€å¶ä¹‹åº­ã€‹æ˜¯æˆ‘å»å¹´åˆšæ¥å®éªŒéƒ¨çš„æ—¶å€™æ¥è§¦çš„æ–°é²œä¸œè¥¿ä¹‹ä¸€â€”â€”åˆä¸­æ—¶åªæ‡µæ‡‚åœ°çœ‹è¿‡ã€Šä½ çš„åå­—ã€‹ï¼Œè¢«é‡Œé¢è¶…è¶Šæ—¶ç©ºçš„çˆ±æƒ…å¸å¼•çš„ä¸è¦ä¸è¦çš„ã€‚å½“æ—¶çœ‹å®Œç¡®å®è§‰å¾—æ˜¯éƒ¨å¥½ç‰‡ï¼Œå› ä¸ºå‰§æƒ…å¾ˆå¸å¼•äººâ€”â€”å½“ç„¶ï¼Œå¤§å¤šæ•°éƒ½æ˜¯æˆ‘çš„ä¸»è§‚æ„Ÿæƒ…åœ¨èµ·ä½œç”¨ï¼Œå› ä¸ºå½“æ—¶æ‡µæ‡‚çš„æˆ‘æ­£å¥½è¿«åˆ‡åœ°æ¸´æœ›ä¸€æ¬¡è¯´èµ°å°±èµ°çš„çˆ±æƒ…ã€‚</p>
<p>é‚£æœ¬è–„è–„çš„ä¹¦åˆå¸¦æˆ‘å›æƒ³èµ·äº†ç¬¬ä¸€æ¬¡çœ‹ã€Šè¨€å¶ä¹‹åº­ã€‹æ—¶çš„æ»¡è¶³å’Œæ„‰æ‚¦ï¼Œäºæ˜¯ä¾¿å†³å®šä¹°æ–°æµ·è¯šçš„åŸç‰ˆæ¥çœ‹ã€‚æˆ‘å¹¶ä¸è®¤ä¸ºæ–°æµ·è¯šçš„åŸç‰ˆä¼šæ¯”åŠ ç‰ˆæˆ–åŠ¨ç”»ç‰ˆå¥½å¤šå°‘ï¼Œæ¯•ç«Ÿæ•…äº‹å°±æ˜¯é‚£ä¹ˆä¸ªæ•…äº‹ï¼Œæ— éæ˜¯è§†è§’ä¸ä¸€æ ·ç½¢äº†ã€‚</p>
<p>å¹¶ä¸”æˆ‘ä¹Ÿè§‰å¾—ï¼Œä¼¼ä¹åŠ ç‰ˆå’Œç”µå½±ç‰ˆåˆ»ç”»çš„äººç‰©éƒ½å¤ªå•è–„äº†ï¼Ÿåæ­£æˆ‘åœ¨çœ‹å®ŒåŠ ç‰ˆä¹‹åï¼Œåˆé‡çœ‹äº†ä¸€éç”µå½±ç‰ˆï¼Œå‘ç°ä¸å…‰äººç‰©å¥½å‡ å¤„ç”»å´©äº†ï¼Œæœ‰äº›ä¸œè¥¿å†™çš„ä¼¼ä¹å¤ªå°‘â€”â€”ä¸åªæ˜¯æ„çŠ¹æœªå°½äº†ï¼Œæ›´åƒæ˜¯è¿è¯´éƒ½æ²¡è¯´å®Œã€‚æ‰€ä»¥æˆ‘ä¸€ç›´æœŸå¾…ç€èƒ½å¤Ÿèµ¶ç´§æœˆè€ƒå®Œï¼Œå¥½è®©æˆ‘åœ¨è€å¸ˆå¿™äºè®²é¢˜+é˜…å·ã€æ²¡ç©ºå¸ƒç½®ä½œä¸šçš„æ—¶å€™ï¼Œæœ‰ç©ºçœ‹ä¸€ä¸‹æ–°æµ·è¯šçš„åŸç‰ˆâ€”â€”åŸç‰ˆæ˜¯æœˆè€ƒå‰çš„å¤§ä¼‘æ¥çš„è´§ï¼Œä¹¦å°çš„ä¸»è‰²è°ƒæ˜¯ç™½è‰²çš„ï¼Œå°1æ˜¯ä¸€å¼ åŠ¨ç”»ç”µå½±é‡Œçš„æˆªå›¾â€”â€”ä¸€åªç¡è²ï¼Œèººåœ¨ä¸‹ç€é›¨çš„æ²³é‡Œã€‚</p>
<p>æˆ–è®¸é‚£æ—¶æˆ‘è¿˜ä¸çŸ¥é“ï¼Œæˆ‘å°†ä¼šçœ‹åˆ°ä¸€ä¸ªæ€æ ·å®Œæ•´ã€ä¼˜ç§€ã€ç»†è…»çš„æ•…äº‹â€”â€”ç”µå½±å’ŒåŠ ç‰ˆï¼Œå’ŒåŸç‰ˆæ¯”èµ·æ¥ï¼Œç®€ç›´è´»ç¬‘å¤§æ–¹ã€‚</p>
<h1 id="rm-Part-2"><a href="#rm-Part-2" class="headerlink" title="$\rm{Part~2}$"></a>$\rm{Part~2}$</h1><p>æ„ŸåŠ¨ï¼Œæ»¡è¶³ï¼Œå¹¸ç¦ï¼Œç¾å¥½â€¦â€¦éƒ½æ˜¯æˆ‘çœ‹å®Œçš„ç¬¬ä¸€æƒ³æ³•ï¼›ç‹¬æ­¥å¤©ä¸‹ï¼Œç»æ— ä»…æœ‰â€¦â€¦åˆ™æ˜¯ç¬¬äºŒæƒ³æ³•ã€‚</p>
<p>è¿ç»­ä¸¤ä¸ªä¸­åˆæœªçœ ï¼Œå†åŠ ä¸Šè€ƒå®Œè¯•çš„è½»æ¾ï¼Œè®©æˆ‘åœ¨$3$æœˆ$28$æ—¥ä¸­åˆè¯»å®Œäº†è¿™æœ¬ä¹¦ã€‚è¿˜æœ‰äºŒååˆ†é’Ÿæ‰å¹èµ·åºŠå“¨ï¼Œé‚å†³å®šå°çœ ç‰‡åˆ»ï¼Œè°çŸ¥æ¢¦é‡Œæœ¦èƒ§çš„ï¼Œå…¨æ˜¯è¨€å¶é‡Œé¢çš„å†…å®¹ï¼Œå…¨æ˜¯é›ªé‡å’Œå­é›„ï¼Œå…¨æ˜¯æ£‰èŠ±ç³–ä¸€æ ·æŸ”è½¯é¦™ç”œçš„æ¢¦å¹»ï¼Œåœ¨æˆ‘çš„è„‘æµ·é‡Œæ¬ºè´Ÿã€æ²‰æ·€ã€å·ç¼©ã€èˆ’å¼ â€”â€”é‚£çœŸæ˜¯æˆ‘æœ‰ç”Ÿä»¥æ¥ç»å†è¿‡çš„æœ€å•çº¯è€Œåˆç¾å¥½çš„æ—¶å…‰ä¹‹ä¸€ã€‚</p>
<p>æˆ‘æ›´åŠ åšå®šåœ°è®¤ä¸ºï¼Œè¿™ç§åªå±äºæ¢¦å¹»çš„ä¸œè¥¿ï¼Œè¿™ç§â€œå¤©ä¸Šè¯­â€ï¼Œâ€œå¤©ç±ä¹‹éŸ³â€ï¼Œéƒ½åº”è¯¥ç•™åœ¨é‚£ä¸ªæ¢¦å¹»çš„ä¸–ç•Œé‡Œâ€”â€”å¤§æŠµä¸Šå°±æ˜¯è¦æŠŠâ€œç°å®â€å’Œâ€œæ¢¦å¹»â€å‰²è£‚å¼€æ¥å§ã€‚æˆ‘è®¤ä¸ºï¼ŒæŠŠè¿™ç§â€œæ­¤æ›²åªåº”å¤©ä¸Šæœ‰ï¼Œäººé—´éš¾å¾—å‡ å›é—»â€çš„ç¾å¥½ï¼Œå¸¦åˆ°è¿™ä¸ªç°å®çš„ã€ä»¤äººå¤±æœ›çš„ä¸–ç•Œï¼Œæ˜¯ä¸€ç§å¯¹å®ƒçš„ä¾®è¾±ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä¸æ‰“ç®—å»çœ‹çŸ¥ä¹çš„è¯„è®ºï¼Œä¸æ„¿å»çœ‹ä¹¦è¯„ï¼Œä¸æ„¿å»ä¸åˆ«äººèŠèµ·è¿™éƒ¨å°è¯´â€”â€”æˆ‘åªæƒ³æŠŠè¿™ç§æœ€å•çº¯çš„æ¢¦å¹»ï¼Œç•™ç»™æœ€çº¯ç²¹çš„ä¸–ç•Œï¼Œç²¾å¿ƒåœ°å‘µæŠ¤ã€‚</p>
<p>â€¦â€¦</p>
<p>è¯´èµ·åŸå› ï¼Œå¤§æŠµä¸Šæœ‰å¾ˆå¤šã€‚æ¯”å¦‚ç”µå½±é‡Œå‰§æƒ…çš„æ·¡è–„ï¼Œåœ¨è¿™éƒ¨å°è¯´é‡Œå¾—åˆ°äº†å¾ˆå¥½çš„å……å®ï¼Œè®©æˆ‘æ»¡è¶³å¾—å¾ˆï¼›æ¯”å¦‚é›ªé‡å’Œå­é›„ä¹‹é—´æœªæ›¾è¨€æ˜ï¼Œä½†æ˜¯å´æ— æ¯”çœŸæŒšã€æ— æ¯”çº¯ç²¹ã€æ— æ¯”åšå›ºçš„çˆ±æƒ…â€”â€”é‚£æ˜¯æœ€ç¾å¥½çš„çˆ±æƒ…äº†å§ï¼Œå®å®ˆï¼Œé™ªä¼´å¤§æ¦‚æ˜¯æœ€é•¿æƒ…çš„å‘Šç™½ï¼›æ¯”å¦‚ä¹¦ä¸­æ¯ä¸ªäººçš„å¿ƒç†æ´»åŠ¨ï¼Œç»†è…»ï¼ŒçœŸåˆ‡ï¼Œè¯»èµ·æ¥ä¸€æ°”å‘µæˆï¼›æ¯”å¦‚â€¦â€¦</p>
<p>ä½†æ˜¯æˆ‘æ€»æ„Ÿè§‰ï¼Œè¿™äº›å…¶ä¸­çš„æŸä¸ªï¼Œæˆ–è€…æ˜¯ä»–ä»¬çš„å¹¶é›†ï¼Œä»å®¢è§‚ä¸Šè®²ï¼Œéƒ½ä¸èƒ½æˆä¸ºè®©æˆ‘å¦‚æ­¤åŠ¨å®¹çš„ç†ç”±ã€‚</p>
<p>ç°åœ¨æƒ³æ¥ï¼Œä¸Šä¸€æ¬¡å¦‚æ­¤æ„ŸåŠ¨è‡³æ·±ï¼Œè¿˜æ˜¯åœ¨çœ‹çœŸäººç”µå½±ç‰ˆçš„ã€Šæˆ‘æƒ³åƒæ‰ä½ çš„èƒ°è„ã€‹çš„æ—¶å€™ã€‚æˆ‘è‡ªè®¤ä¸ºåƒè¿™ç§å…·æœ‰å¼ºå¤§æ„ŸæŸ“åŠ›çš„æ–‡è‰ºä½œå“ï¼Œç”¨åŠ¨ç”»å»è¡¨ç°å®åœ¨æ˜¯å¤ªå•è–„äº†â€”â€”æˆ–è®¸éœ€è¦å¥½çš„æ¼”å‘˜ï¼Œæˆ–è®¸éœ€è¦å¥½çš„æ–‡å­—ï¼Œæ€»ä¹‹ï¼Œå°è¯´å’ŒçœŸäººç”µå½±ï¼Œéƒ½è¦æœ‰æ›´å¥½çš„æ•ˆæœâ€”â€”å½“æ—¶å“­çš„ç¨€é‡Œå“—å•¦çš„ã€‚æˆ‘ä¹Ÿä¸çŸ¥é“åˆ°åº•ä¸ºä½•è€Œå“­ï¼Œæ˜æ˜ç”·å¥³ä¸»ä¹‹é—´éƒ½æ²¡æœ‰ä»¤äººç¾¡æ…•çš„çˆ±æƒ…ï¼Œæ˜æ˜å¥³ä¸»æœ€åéƒ½å·²ç»åœ¨åŠç”·ä¸»å¿˜æ‰å¥¹ï¼Œæ˜æ˜æƒ…èŠ‚å°±æ˜¯é‚£ä¹ˆçš„ç®€å•ä¿—å¥—â€¦â€¦</p>
<p>æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚</p>
<p>æ€»ä¹‹ï¼Œå¾ˆç¾å°±å¯¹äº†ã€‚æˆ‘å¤§æ¦‚éœ€è¦å†è¿‡å¥½å¤šå¥½å¤šå¤©æ‰èƒ½ç¼“è¿‡æ¥å§ã€‚ç°åœ¨çš„çŠ¶æ€å¤§æ¦‚æ˜¯ä¸€é—²ä¸‹æ¥å°±ä¼šæƒ³èµ·è¨€å¶é‡Œé¢çš„å†…å®¹ï¼Œæ¯å½“ç‹¬è‡ªä¸€ä¸ªäººæ—¶ï¼Œè„‘å­é‡Œä¾¿å…¨æ˜¯$1.$ç™¾é¦™é‡Œå’Œå­é›„ä¹‹é—´å¦‚æ½ºæ½ºä¸ç»çš„æµæ°´ä¸€æ ·çš„çœŸæŒšæ„Ÿæƒ…$2.$ç™¾é¦™é‡Œæ˜¯å¦‚ä½•ä¸€ä¸ªäººæ‰›è¿‡é‚£äº›å²æœˆçš„$3.$ä»–ä»¬æœ€åç›¸é‡ä»¥åä¼šæ€æ ·ï¼Œåœ¨ä¸€èµ·ä¹‹åä¼šæ€æ ·çš„å¿«ä¹â€¦â€¦æ„Ÿè§‰è‡ªå·±ä»¿ä½›å˜æˆäº†ä¸€ä¸ªå¤šæƒ…ç»†è…»çš„å°å§‘å¨˜ï¼Œé‡å¤å›æƒ³ç€ä¹¦ä¸­çš„ä¸€å¹•å¹•ã€‚â€œå¦‚æœç«™åœ¨æ–°æµ·è¯šçš„ä½œå®¶ç«‹åœºä¸Šçœ‹ï¼Œä»–è¿™æœ¬ä¹¦å¯¹æˆ‘è¿™ä¸ªè¯»è€…æ¥è¯´ï¼Œå·²ç»æ˜¯æä¸ºæˆåŠŸçš„äº†å§â€æˆ‘å¿ƒæƒ³ã€‚</p>
<p>æˆ‘ç”šè‡³ä¼šå¹»æƒ³ä¸–ç•Œä¸ŠçœŸæœ‰ä¸€ä¸ªç™¾é¦™é‡Œï¼Œä¸€ä¸ªå­é›„ï¼Œä»–ä»¬åœ¨æŸä¸ªæ—¶é—´ç‚¹ç›¸é‡ã€ç›¸ä¼´ã€ç›¸æºã€ç›¸çŸ¥ã€ç›¸çˆ±â€¦â€¦é‚£è¯¥æ˜¯å¤šç¾å¥½çš„ç«¥è¯å•Šã€‚æˆ–è®¸ç™¾é¦™é‡Œç»å†çš„ä¸€åˆ‡ï¼Œå…¶èƒŒåçš„åŸå› éƒ½æ˜¯é‚£ä¹ˆçš„æ— å˜å¤´ã€ç”šè‡³æ˜¯è’è°¬â€”â€”æ¯•ç«Ÿæ˜¯é’æ˜¥æœŸçš„å­©å­ä¸€é¦–é…¿æˆçš„é”™è¯¯â€”â€”ä½†æˆ–è®¸è€å¤©æ˜¯ä¸ºäº†æœ‰ä¸ªåˆ©ç”¨å¥–èµç»™å¥¹ä¸€ä»½å®Œç¾çš„ã€ç«¥è¯èˆ¬çš„çˆ±æƒ…ï¼Œæ‰ä¼šå…ˆè®©å¥¹ç»å†ä¸€äº›ç—›è‹¦å§ã€‚æ¯•ç«Ÿå¦‚æœé›ªé‡ä¸ç»å†è¿™äº›ï¼Œæˆ–è®¸ä»–è·Ÿå­é›„å°±ä¼šæ˜¯æ°¸è¿œé™Œç”Ÿäººäº†â€¦â€¦</p>
<p>çªç„¶æ„Ÿè§‰è‡ªå·±çœŸçš„â€¦å±…ç„¶éƒ½å¼€å§‹ç›¸ä¿¡ä¸»è§‚å”¯å¿ƒä¸»ä¹‰äº†â€¦çœŸæ˜¯ä¸å¯æ•‘è¯åœ°æ²‰æµ¸åœ¨è¿™æœ¬ä¹¦é‡Œäº†å•Šã€‚</p>
<p>è¿™ç»å¯¹æ˜¯æˆ‘è¯»è¿‡çš„æœ€ç¾çš„æ•…äº‹äº†ã€‚</p>
<h1 id="rm-Part3"><a href="#rm-Part3" class="headerlink" title="$\rm{Part3}$"></a>$\rm{Part3}$</h1><p>ç°åœ¨æ˜¯$3.27$çš„ä¸­åˆï¼Œæˆ‘èººåœ¨å¯‚é™çš„å®¿èˆé‡Œï¼Œçœ‹ç€ã€Šè¨€å¶ä¹‹åº­ã€‹â€”â€”å¤§æ¦‚ï¼Œâ€œä¸‰åˆ†ä¹‹ä¸€æ˜¯è¯»å®Œäº†å§?â€æˆ‘æƒ³ã€‚</p>
<p>â€œè¿™æœ¬ä¹¦å¤§æŠµä¸Šæ˜¯æ–°æµ·è¯šåœ¨æ‹ã€Šè¨€å¶ä¹‹åº­ã€‹ä¹‹å‰å†™çš„å§ï¼Œâ€æˆ‘æƒ³ï¼Œâ€œæ‰€ä»¥æˆ–è®¸ä¼šè·Ÿå¾ˆæ— èŠï¼Œæ¯•ç«Ÿæƒ…èŠ‚æ˜¯éƒ½çŸ¥é“çš„â€ã€‚ç¡®å®ï¼Œçœ‹å®ŒåŠ ç‰ˆã€é‡æ¸©å®Œç”µå½±ç‰ˆä¹‹åï¼Œå¦‚æœæ˜¯ç›¸åŒçš„å†…å®¹ï¼Œå¯¹æˆ‘æ¥è¯´ç¡®å®æ˜¯æœ‰ç‚¹æ¯ç‡¥ã€‚</p>
<p>ä½†æ˜¯å½“æˆ‘ç°åœ¨çœ‹åˆ°ä¸»è§’ä¸ºâ€œç§‹æœˆç¿”å¤ªâ€è¿™ä¸€ç« æ—¶ï¼Œä¼¼ä¹æ„Ÿåˆ°äº†ä»€ä¹ˆå¥‡æ€ªçš„äº‹æƒ…å‘ç”Ÿäº†â€”â€”ä¹¦ä¸­å¯¹ç”·ä¸»å“¥å“¥çš„æå†™å¾—å¦‚æ­¤è¯¦ç»†ï¼Œç”šè‡³ç»å¤§éƒ¨åˆ†æƒ…èŠ‚éƒ½æ˜¯åŸä½œé‡Œé¢æ²¡æœ‰çš„ã€‚è™½ç„¶å‰é¢å‡ èŠ‚é‡Œé¢ä¹Ÿæœ‰æˆ–å¤šæˆ–å°‘çš„æƒ…èŠ‚æ²¡åœ¨ç”µå½±é‡Œå‡ºç°ï¼Œä½†æ˜¯ä¸€æ•´ç« çš„å†…å®¹å…¨éƒ¨ææ‰ï¼Œä¹Ÿæœªå…å¤ªç‹ å¿ƒäº†å§ã€‚</p>
<p>æˆ‘çªç„¶å¼€å§‹ç€è¿·èµ·æ¥ï¼Œå¼€å§‹è§‰å¾—æ–°æµ·è¯šæ˜¯ä¸ªå°å¤©æ‰äº†â€”â€”å…¶æƒ…èŠ‚è®¾ç½®çš„æ˜¯å¦‚æ­¤çš„åˆç†ï¼Œè®©æˆ‘è¶Šæ¥è¶Šæ„Ÿåˆ°æ»¡è¶³ã€‚åŸæœ¬å›°å€¦çš„æˆ‘ä¼¼ä¹æ¥äº†ç²¾ç¥ï¼Œâ€œä¸€å®šè¦èµ¶ç´§è¯»å®Œâ€ï¼Œæˆ‘å¿ƒæƒ³ã€‚</p>
<p>â€¦â€¦</p>
<p>è¯»å®Œä¹‹åï¼Œåè®°é‡Œé¢æ–°æµ·è¯šæ˜¯è¿™ä¹ˆæè¿°çš„ï¼š</p>
<blockquote>
<p>æˆ‘ä¸€ç›´å•æ‹ç€å°è¯´ã€‚<br>ä¸åªæ˜¯å°è¯´ï¼Œæˆ‘è§‰å¾—è‡ªå·±ä¹Ÿä¸€ç›´å•æ‹ç€æ¼«ç”»ã€ç”µå½±ã€åŠ¨ç”»ä¸ç°å®ä¸­çš„é£æ™¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ˜¯ä¸€<br>ç§ã€Œæˆ‘å–œæ¬¢å¯¹æ–¹ï¼Œå¯¹æ–¹å´å¯¹æˆ‘æ²¡ä»€ä¹ˆå…´è¶£ã€çš„çŠ¶æ€ã€‚æˆ‘ä¹ŸçŸ¥é“è‡ªå·±æ˜¯å››åå‡ å²çš„æˆå¹´äººäº†ï¼Œä¸è¯¥å†<br>æƒ³è¿™äº›æ²¡æœ‰æ„ä¹‰çš„äº‹ï¼Œä½†æˆ‘å´æ€ä¹ˆæ ·ä¹Ÿæ‘†è„±ä¸äº†è¿™ç§æƒ…ç»ªã€‚</p>
<p>â€¦â€¦</p>
<p>å†™å°è¯´æ˜¯å¾ˆæ„‰å¿«çš„ï¼Œæˆ‘èƒ½å¤Ÿå°½æƒ…å†™å‡ºåŠ¨ç”»è¡¨è¾¾ä¸å‡ºæ¥çš„æƒ…èŠ‚ï¼Œæˆ–æ˜¯å¾ˆéš¾çš„å†…å®¹ã€‚ä¾‹å¦‚ï¼Œå†™åˆ°<br>ã€Œå¥¹çš„è„¸ä¸Šæµ®ç°è¿·é€”å­©å­èˆ¬çš„å¾®ç¬‘ã€ï¼Œæˆ‘å°±ä¼šï¼ˆå¯¹èº«ä¸ºåŠ¨ç”»å¯¼æ¼”çš„è‡ªå·±ï¼‰ç¤ºå¨ï¼šã€Œæ€æ ·ï¼ã€æ€æ ·ï¼Ÿ<br>è¿™å¥è¯å¾ˆéš¾ç”¨å½±åƒè¡¨ç°å§ï¼æ¼”å‘˜èƒ½æ°å¦‚å…¶åˆ†è¯ é‡Šå‡ºã€Œè¿·é€”å­©å­èˆ¬çš„è¡¨æƒ…ã€å—ï¼ŸåŠ¨ç”»å¸ˆèƒ½ç”»å‡ºæ¯ä¸ªäºº<br>ä¸€çœ‹å°±çŸ¥é“æ˜¯ã€Œè¿·é€”å­©å­ã€çš„è„¸å—ï¼Ÿä¸å¯èƒ½ï¼ä¸å®‰çš„è¡¨æƒ…æˆ–è®¸å¯ä»¥åŠåˆ°ï¼Œä½†æ˜¯ã€Œè¿·é€”å­©å­èˆ¬çš„ã€è¿™<br>ç§ç®€æ´æ˜ç™½çš„å½¢å®¹ï¼Œå¾ˆéš¾åˆ©ç”¨å½±åƒå‘ˆç°ã€‚åˆæˆ–æ˜¯å½“æˆ‘å†™åˆ°ï¼šã€Œé—¨å¤–çš„å–§é—¹å£°ï¼Œå®›å¦‚ä»è€³æœºé‡Œå¤–æº¢çš„<br>å£°éŸ³â€¦â€¦ã€ï¼Œæˆ‘å°±ä¼šç‹ç¬‘å¿ƒæƒ³ï¼šã€Œè¿™ä¸ªä½ ï¼ˆå½±åƒï¼‰ä¹Ÿåšä¸åˆ°å§ï¼Ÿã€è§‚ä¼—æ— æ³•ä»æ•™å®¤çš„ç¯å¢ƒéŸ³è”æƒ³åˆ°<br>è€³æœºå£°éŸ³å¤–æº¢äº‘äº‘ã€‚<br>æˆ‘é€è¿‡å†™ä½œåˆ‡èº«æ„Ÿå—åˆ°ï¼Œå°è¯´çš„ä¹è¶£å°±åœ¨äºæ–‡å­—çš„è¿ç»“ã€‚æˆ‘æ³¨æ„åˆ°è‡ªå·±åˆ©ç”¨å†™åè®°çš„æ–¹å¼æ¥å›<br>é¡¾é‚£æ®µæ—¶å…‰æ—¶ï¼Œå°±ä¼šç‹¬è‡ªæ„Ÿåˆ°é›€è·ƒä¸å·²ï¼Œæ€»ä¹‹å°±æ˜¯éå¸¸åœ°å¹¸ç¦ã€‚</p>
<p>â€¦â€¦</p>
<p>å†™å®Œä¸€æœ¬ä¹¦æœ€å¤§æ”¶è·ï¼Œåè€Œæ˜¯æ›´åŠ æ·±äº†æˆ‘å¯¹äºå°è¯´å’ŒåŠ¨ç”»çš„å•æ‹æƒ…æ€€ã€‚åæ­£æˆ‘æœ¬æ¥å°±ä¸æœŸå¾…ä¸¤<br>æƒ…ç›¸æ‚¦ã€‚æˆ‘æœ‰æ—¶ä¼šæƒ³åˆ°ï¼Œå­é›„å¯¹é›ªé‡çš„æ„Ÿæƒ…ï¼Œæ˜¯å¦ä¹Ÿæœ‰ç›¸ä¼¼çš„ä¸œè¥¿ï¼Ÿè‹¥è¿™ä¹ˆè¯´æ¥ï¼Œæœ¬ä¹¦é‡Œçš„è§’è‰²å¤š<br>å¤šå°‘å°‘éƒ½åœ¨å•æ‹ã€‚æˆ‘é‡æ–°ä½“æ‚Ÿåˆ°è‡ªå·±æƒ³å†™çš„ï¼Œå°±æ˜¯äººä»¬çš„è¿™ç§å¿ƒæƒ…â€”â€”å­¤å•æ¸´æœ›æŸä¸ªäººã€æŸé¡¹äº‹ç‰©<br>çš„å¿ƒç¼–ç»‡å‡ºè¿™ä¸ªä¸–ç•Œã€‚è€Œæœ¬ä¹¦æƒ³è¦æè¿°çš„å°±æ˜¯è¿™ç‚¹ã€‚<br>åœ¨ã€Œçˆ±ã€ä»¥å‰ï¼Œè¿™æ˜¯æ®µã€Œå­¤ç‹¬å¸Œæ±‚ã€çš„æ•…äº‹ã€‚<br>è¿™å¥è¯æ˜¯ç”µå½±ç‰ˆçš„å®£ä¼ æ–‡æ¡ˆã€‚æƒ³å¿…ç°ä»£ä¹Ÿæœ‰ä¸å°‘äººå¯¹äºè¿œåœ¨ä¸€åƒä¸‰ç™¾å¹´å‰çš„ä¸‡å¶æ—¶ä»£ï¼Œå°†ã€Œæ‹<br>çˆ±ã€è¿™ä¸ªå­—ï¼Œå†™ä½œã€Œå­¤æ‚²ï¼ˆå­¤å¯‚æ‚²ä¼¤ï¼‰ã€æ·±è¡¨åŒæ„Ÿã€‚</p>
</blockquote>
<p>æˆ‘æƒ³ï¼Œè¿™å¤§æ¦‚ä¹Ÿæ˜¯è¿™éƒ¨å°è¯´è¿·äººçš„å› ç´ ä¹‹ä¸€å§â€”â€”åŸæœ¬å°±å·²ç»å¾ˆå®Œæ•´çš„æƒ…èŠ‚ï¼ŒåŠ ä¸Šå¦™ç¬”çš„å‹¾å‹’ï¼Œç¬é—´æ´»çµæ´»ç°èµ·æ¥ã€‚</p>
<h1 id="rm-Part-4"><a href="#rm-Part-4" class="headerlink" title="$\rm{Part~4}$"></a>$\rm{Part~4}$</h1><p>é€‰äº†å‡ æ®µæ”¾åˆ°è¿™é‡Œï¼Œç•™ä½œçºªå¿µã€‚</p>
<p>é¦–å…ˆæ˜¯æœ€åï¼Œå­é›„å’Œé›ªé‡é‡é€¢çš„æƒ…æ™¯ï¼š</p>
<blockquote>
<p>èµ°è¿‡æ—¥æœ¬åº­å›­çš„æœ¨æ¡¥ï¼Œé›¨å£°åˆèµ·äº†äº›å¾®å˜åŒ–ã€‚æ ‘å¶æ‘‡æ›³çš„å£°éŸ³ï¼Œèƒœè¿‡é›¨æ»´æ•²æ‰“æ°´é¢çš„å£°éŸ³ã€‚è‡ª<br>åˆ¶çš„é›•èŠ±çš®é‹ï¼Œç¼“ç¼“è¸åœ¨åœŸå£¤ä¸Šçš„è„šæ­¥å£°ï¼Œä¼´ç€ç»¿ç»£çœ¼æ¸…è„†çš„é¸£å•­ã€‚è¶Šè¿‡æ—¥æœ¬é»‘æ¾æ‰€è§åˆ°çš„æ°´é¢ã€<br>æœé¹ƒèŠ±å€’æ˜ åœ¨æ°´é¢ä¸Šçš„ç²‰çº¢è‰²ã€åƒå¤´èµ¤æ¾æ ‘çš®çš„çº¢è‰²ï¼Œä»¥åŠæ«å¶çš„ç¿ç»¿è‰²ã€‚<br>å­é›„çš„åèƒŒåŒ…é‡Œè£…ç€ä¸ºé‚£ä¸ªäººæ‰“é€ çš„é‹å­ã€‚é‚£æ˜¯ä¸€åŒçº¦äº”å…¬åˆ†é«˜çš„å°å·§å°–å¤´é«˜è·Ÿé‹ï¼Œé‹å°–æ˜¯æµ…<br>ç²‰çº¢è‰²ï¼Œé‹èº«æ˜¯è¿‘ä¹ç™½è‰²çš„æµ…è‚¤è‰²ï¼Œè„šè¸µå¤„æ˜¯ä»¿ä½›é˜³å…‰ç…§è€€çš„æŸ æª¬é»„è‰²ï¼Œç¼ ç»•åœ¨è„šè¸ä¸Šçš„é•¿è„šè¸å¸¦<br>ä¸Šç¼ç€æ«å¶çš„å½¢çŠ¶ã€‚<br>è¿™åŒé‹æ˜¯ä¸ºäº†é‚£ä¸ªäººæ‰“é€ ï¼Œä¸€å®šå¯ä»¥èµ°å¾—æ›´é•¿æ›´è¿œã€‚<br>ä¸çŸ¥ä»ä½•å¤„ä¼ æ¥è€ä¹Œé¸¦å¼ºæœ‰åŠ›çš„é¸£å«ï¼Œè¿œæ–¹çš„å¤©ç©ºéšçº¦å“èµ·äº†é›·é¸£å£°ã€‚<br>â€”â€”éšçº¦é›·é¸£ã€‚<br>å­é›„è„±å£è€Œå‡ºè¿™å¥è¯ã€‚<br>ä¸€è‚¡é¢„æ„Ÿå……æ»¡å…¨èº«ã€‚<br>å·²ç»å¯ä»¥çœ‹åˆ°æµ¸æ¹¿æ«å¶åä¾§çš„å‡‰äº­ï¼Œé‚£é‡Œåç€ä¸€ä¸ªäººã€‚<br>å­é›„å¸å…¥é›¨æ°´çš„æ°”å‘³ï¼Œå…‹åˆ¶ä½è‡ªå·±çš„å¿ƒæƒ…ï¼Œç»§ç»­èµ°å‘å‡‰äº­ï¼Œç©¿è¿‡å±‚å±‚æ ‘å¶åï¼Œæ•´åº§å‡‰äº­æ˜ å…¥çœ¼<br>å¸˜ã€‚<br>é‚£æ˜¯ä¸€ä½ç©¿ç€æµ…ç»¿è‰²è£™å­çš„å¥³äººã€‚<br>å­é›„åœä¸‹è„šæ­¥ã€‚<br>æœ‰ç€ä¸€å¤´å‰ªè‡³é½è‚©æŸ”è½¯çŸ­å‘çš„å¥³äººï¼Œæ­£æŠŠå’–å•¡ä¸¾åˆ°å˜´è¾¹ï¼Œå¥¹è½»è½»ç¥äº†ä»–ä¸€çœ¼ã€‚<br>çœ‹ç€é›ªé‡ä»å¿«è¦å“­å‡ºæ¥çš„ç´§ç»·è¡¨æƒ…ï¼Œé€æ¸ç»½å¼€ç¬‘å®¹ã€‚<br>å­é›„å¿ƒæƒ³ï¼Œé›¨å¥½åƒåœäº†ã€‚</p>
</blockquote>
<p>ç„¶åæ˜¯å­é›„è¡¨ç™½å®Œã€é›ªé‡æ‹’ç»åï¼Œé›ªé‡çš„å¿ƒå£°ï¼š</p>
<blockquote>
<p>ã€Œå¯æ˜¯ä½ çš„è¡£æœè¿˜æ²¡å¹²â€¦â€¦ã€é›ªé‡æœ›ç€ä»–è¿œå»çš„èƒŒå½±ï¼Œä¸ç”±å¾—å¤§å«ã€‚<br>ä¸å¯¹ï¼Œè¿™æ ·æ­£å¥½ã€‚é›ªé‡é€¼è‡ªå·±æ”¶å›è§†çº¿ï¼Œä½å¤´çœ‹ç€æ‰‹ä¸­çš„å’–å•¡æ¯ï¼Œéšçº¦å¬è§ä»–å…³ä¸Šæ›´è¡£é—´çš„<br>é—¨ã€‚é›ªé‡æŠŠè¿˜æ²¡å–ä¸Šä¸€å£çš„å’–å•¡æ¯ä¸¾åˆ°å˜´è¾¹ï¼Œè¢…è¢…å‡èµ·çš„çƒ­æ°”å¾®å¾®æ²¾æ¹¿äº†ç«æ¯›ã€‚å¥¹æƒ³è¦å–å’–å•¡ï¼Œå´<br>è§‰å¾—æ¯å­æ²‰é‡å¼‚å¸¸ï¼Œåªå¾—æŠŠå®ƒæ”¾å›æ¡Œä¸Šã€‚é›ªé‡ä½“å†…æœ‰ä¸€å›¢åƒåˆºçŒ¬èˆ¬å¸¦åˆºçš„æƒ…ç»ªï¼Œç¬¨æ‹™åœ°å››å¤„ä¹±é—¯ã€‚<br>è¿™æƒ…ç»ªä¼¼ä¹æ˜¯åæ‚”å’Œå†…ç–šï¼Œæ­£ä¸€é˜µé˜µåˆºç—›é›ªé‡çš„å¿ƒå¹¶æ²‰é»˜åœ°è´£æ€ªå¥¹ã€‚<br>ä¸ç„¶æˆ‘è¯¥æ€ä¹ˆåšï¼Ÿé›ªé‡å‡ ä¹å°±è¦å“­å‡ºæ¥äº†ã€‚æˆ‘ä»ä¸€å¼€å§‹å°±æ²¡æœ‰é€‰æ‹©çš„ä½™åœ°ã€‚æˆ‘æ˜æ˜é‚£ä¹ˆçœŸè¯šåœ°<br>å¯¹å¾…æ¯ä¸€ä¸ªäººï¼Œæ˜æ˜æƒ³æˆä¸ºåƒé˜³èœå­è€å¸ˆé‚£æ ·æ¸©æŸ”ä½“è´´çš„å¤§äººï¼Œæ˜æ˜åŠªåŠ›å›åº”ä»»ä½•ä¸€ä¸ªéœ€è¦æˆ‘çš„<br>äººã€‚é›ªé‡çœ‹ç€é€æ¸ç¨€è–„çš„å’–å•¡çƒ­æ°”ã€‚æˆ‘ä¸è¦å¾…åœ¨ä¸–ç•Œçš„å¤–å›´ï¼Œæˆ‘æƒ³è¿›åˆ°ä¸–ç•Œçš„é‡Œé¢ï¼Œæˆ‘æƒ³æˆä¸ºè¿™ä¸ª<br>è€€çœ¼ä¸–ç•Œçš„ä¸€éƒ¨åˆ†ã€‚æˆ‘ä»¥ä¸ºåªè¦é•¿å¤§ï¼Œä¸€åˆ‡å°±ä¼šé¡ºåˆ©ï¼›æˆ‘ä»¥ä¸ºç…§è¿™æ ·ä¸‹å»ï¼Œå°±èƒ½å’Œå¤§å®¶ä¸€æ ·æ­£å¸¸ç”Ÿ<br>æ´»ã€‚å¯æ˜¯ï¼Œå´å‘ç°è‡ªå·±è¢«å·å…¥é‚£äº›åƒæ·‹é›¨èˆ¬é¿ä¸æ‰çš„ç¾éš¾é‡Œã€‚å…ˆæ˜¯ä¼Šè—¤è€å¸ˆå‡ºç°ï¼Œç„¶åç‰§é‡åŒå­¦å‡º<br>ç°ï¼Œæœ€åç›¸æ³½åŒå­¦ä¹Ÿå‡ºç°ï¼Œæˆ‘çš„ç”Ÿæ´»å˜å¾—ä¸€å›¢ç³Ÿã€‚å¥½ä¸å®¹æ˜“æ¥åˆ°å±‹æªä¸‹å¯ä»¥èº²èº²é›¨ï¼Œè¿™å›ç§‹æœˆå‡ºç°<br>äº†ã€‚æ¯ä¸ªäººéƒ½åœ¨æ‰°ä¹±æˆ‘çš„å¿ƒï¼Œæˆ‘æƒ³è¦é™é™åœ°å¾…ç€ã€‚ä½†æˆ‘ä¸€ä¸ªäººå°±è¿åªæ˜¯ç«™ç€ï¼Œéƒ½å¦‚æ­¤å‹‰å¼ºï¼Œæ¯å¤©å…‰<br>æ˜¯ä¸è®©è‡ªå·±è¹²ä¸‹ï¼Œå°±å¿…é¡»è€—è´¹è«å¤§çš„åŠ›æ°”ã€‚<br>å¬è§è„šæ­¥å£°æ…¢æ…¢ç§»è¿‘ï¼Œé›ªé‡æŠ¬èµ·å¤´ã€‚ä»–ç«™åœ¨æµ…æµ…çš„é’ç»¿è‰²å½±å­é‡Œï¼Œèº«ä¸Šå·²ç»æ¢ä¸Šåº”è¯¥è¿˜æ˜¯åŠå¹²<br>çš„åˆ¶æœã€‚<br>ã€Œé‚£ä¸ªï¼Œæˆ‘è¦èµ°äº†ã€‚å„æ–¹é¢æ¥è¯´ï¼Œéå¸¸æ„Ÿè°¢ä½ ã€‚ã€ä»–é™é™è¯´å®Œï¼Œæ·±æ·±ä¸€é èº¬ï¼Œä¸ç­‰é›ªé‡å›åº”ä¾¿<br>æœç€ç„å…³èµ°å»ã€‚<br>ã€Œå•Šï¼ã€<br>é›ªé‡ä¸è‡ªè§‰ç¦»åº§èµ·èº«ã€‚ç­‰ç­‰ï¼Œå¤šå¾…ä¸€ä¼šå„¿å§ã€‚ä½ æ²¡æœ‰å¸¦ä¼ï¼Œå¯¹å§ï¼Ÿç­‰é›¨åœå†èµ°å§ï¼Ÿâ€”â€”ä¸å¯¹ï¼Œ<br>ä¸æ˜¯è¿™æ ·ï¼Œä¸å¯ä»¥è¿™æ ·è¯´ã€‚é›ªé‡é»˜ç„¶ä¸è¯­ï¼Œåˆä¸€æ¬¡æ…¢æ…¢åå›æ¤…å­ä¸Šã€‚ä»–çš„è„šæ­¥å£°æ„ˆæ¥æ„ˆè¿œï¼Œç©¿é‹çš„<br>å£°éŸ³ï¼Œè½¬å¼€é—¨æŠŠçš„å£°éŸ³ã€‚ç„¶åâ€”â€”</p>
<p>å•ªå—’ã€‚å…³é—¨çš„å£°éŸ³ã€‚<br>é‚£ä¸€ç¬é—´ï¼Œé›ªé‡çªç„¶æ„Ÿåˆ°å¾ˆæ°”æ„¤ã€‚<br>ã€Œç¬¨è›‹ï¼ã€<br>å¥¹å¤§å¼ä¸€å£°ï¼ŒæŠ“èµ·åç€çš„æ¤…å­ä½œåŠ¿è¦æ‰”å‡ºå»ï¼Œå¯æ˜¯ï¼Œå¥¹æ€’è§†çš„å‰æ–¹å·²ç»æ²¡æœ‰åŠä¸ªäººåœ¨ã€‚å¥¹é¡¿æ—¶<br>æ³„æ°”åœ°æ…¢æ…¢æ”¾ä¸‹æ¤…å­ï¼Œå†æ¬¡åäº†ä¸‹æ¥ã€‚<br>ã€Œâ€¦â€¦ç¬¨è›‹ã€‚ã€å¥¹å°å£°åœ°åˆè¯´äº†ä¸€æ¬¡ã€‚<br>ç§‹æœˆé‚£ä¸ªç¬¨è›‹ã€‚<br>ä¸€å‰¯å•æ–¹é¢è¢«ç”©çš„å—å®³è€…è¡¨æƒ…ã€ä¸€å‰¯è‡ªå·±æ²¡åšé”™ä»»ä½•äº‹çš„è¡¨æƒ…ï¼Œä½ æ ¹æœ¬ä¸çŸ¥é“ä½ æ²¡æ¥å‡‰äº­çš„æš‘<br>å‡é‡Œï¼Œæˆ‘æ˜¯æ€€æŠ±ç€ä»€ä¹ˆæ ·çš„å¿ƒæƒ…åº¦è¿‡ã€‚ä½ çš„é«˜ä¸€æš‘å‡ä¸€å®šè¿‡å¾—å¾ˆæ¬¢ä¹å§ï¼ä½ å¯ä»¥æ¯å¤©å’Œå®¶äººä¸€èµ·åƒ<br>é¥­ï¼Œå¯ä»¥å’Œç­ä¸Šå¥³åŒå­¦å»å–èŒ¶ï¼Œä½ æ ¹æœ¬å®Œå…¨æ— æ³•æƒ³åƒå¤§ä½ åäºŒå²çš„å¥³äººè¿‡ç€ä»€ä¹ˆæ ·çš„ç”Ÿæ´»ã€‚<br>ä¸€é˜µé¼»é…¸ï¼Œçƒ­æ°”å µä½å–‰å’™ï¼Œèƒ¸å£è‹¦é—·éš¾å—ï¼Œçœ¼çœ¶æ¸—å‡ºæ³ªæ°´ï¼Œå¥¹ä»¥æ‰‹æŒç´§ç´§æŒ‰ä½åŒçœ¼é˜»æ­¢è¿™ä¸€<br>åˆ‡ï¼Œæ¹¿çœ¼çš®å†…ä¾§æµ®ç°çŠ¹å¦‚ç»†çª„è¿·å®«èˆ¬çš„ç™½è‰²çº¹è·¯ã€‚å§‹ç»ˆæåœ¨æ¡Œä¸Šçš„é‚£æ¯å’–å•¡ï¼Œä»åœ¨æ— å£°æ— æ¯åœ°æŒç»­<br>å†·å´ç€ã€‚<br>â€”â€”ç»“æŸè¿™æ®µæ—¶å…‰çš„äººï¼Œæ˜¯ä½ å•Šï¼<br>é›ªé‡ä¸ç¦æœ‰äº›åŸ‹æ€¨ã€‚ä½ æœçœŸè¿˜æ˜¯ä¸ªå­©å­ã€‚å¦‚æœä½ ä¸è¯´é‚£ç§è¯ï¼Œæˆ‘ä»¬è¯´ä¸å®šè¿˜èƒ½ä¸€èµ·åƒé¥­ã€äº¤æ¢<br>è¿ç»œæ–¹å¼ï¼Œæˆ–æ˜¯ä½ ä¼šåœ¨æˆ‘è¦å›è€å®¶é‚£å¤©æ¥é€æˆ‘ï¼Œè¯´ä¸å®šæˆ‘ä»¬è¿˜èƒ½å¤Ÿä»¥æ¸©å’Œå¹³é™ã€ç—›è‹¦æœ€å°‘çš„æ–¹å¼ï¼Œ<br>é™é™åœ°ç»“æŸæˆ‘ä»¬çš„å…³ç³»ã€‚<br>å…¶å®æˆ‘ä¸€ç›´åœ¨å¿è€ã€‚<br>å…¶å®æˆ‘ä¸€ç›´æ²¡æœ‰è¯´å‡ºå£ã€‚<br>å…¶å®æˆ‘ä¸€ç›´æ²¡æœ‰è¯´å‡ºæ¥è¿‡â€”â€”</p>
<p>æˆ‘å–œæ¬¢ä½ ã€‚</p>
</blockquote>
<p>è¿˜æœ‰ä¸¤æ®µæ®µå¾ˆæœ‰åçš„æ‘˜å½•ä¸‹æ¥ï¼š</p>
<blockquote>
<p>äºŒåä¸ƒå²çš„æˆ‘ï¼Œä¸æ¯«ä¸æ¯”åäº”å²æ—¶å€™çš„æˆ‘èªæ˜ã€‚<br>é›ªé‡æœ›ç€é˜³å…‰æ„ˆæ¥æ„ˆç‚«ç›®ã€å½±å­é€æ¸åŠ æ·±çš„åº­å›­ï¼Œå¸¦ç€æœ‰äººåœ¨ä¸ºè‡ªå·±æ‰“åˆ†æ•°çš„å¿ƒæƒ…ï¼Œå¦‚æ­¤æƒ³<br>ç€ã€‚</p>
</blockquote>
<p>è¿˜æœ‰å­é›„çš„æƒ…æ„Ÿçˆ†å‘ï¼š</p>
<blockquote>
<p>å­é›„æ•…æ„æ‰“æ–­å¥¹çš„è¯ï¼Œä»€ä¹ˆä¹Ÿä¸æƒ³å¬ï¼Œã€Œé›ªé‡å§ï¼Œè¯·ä½ å¿˜äº†æˆ‘åˆšæ‰è¯´çš„è¯ã€‚ã€<br>ä»¿ä½›äº‹å…ˆèƒŒå¥½çš„å°è¯ï¼Œå­é›„å¾ˆè‡ªç„¶ã€å¹²è„†åœ°è¯´å‡ºè¿™å¥è¯ã€‚ä»–ç›´ç›´æœ›ç€é›ªé‡ï¼Œè¯´å‡ºå¿…é¡»è¯´çš„è¯ï¼Œ<br>è¯´å‡ºä»–è§‰å¾—ä¸ºäº†å¥¹åº”è¯¥è¦è¿™ä¹ˆè¯´çš„è¯ï¼šã€Œæˆ‘å…¶å®å¾ˆè®¨åŒä½ ã€‚ã€<br>å¹è¿›æ¥çš„é›¨æ»´æ‰“åœ¨è„¸é¢Šä¸Šã€‚é›ªé‡ååˆ†å“€ä¼¤åœ°çœ¯ç€çœ¼ã€‚å­é›„çœŸçš„è§‰å¾—è‡ªå·±éå¸¸åŒæ¶äº‹åˆ°å¦‚ä»Šæ‰<br>éœ²å‡ºè¿™å‰¯è¡¨æƒ…çš„å¥¹ã€‚<br>ã€Œæˆ‘ä¸€å¼€å§‹å°±è§‰å¾—ä½ è¿™ä¸ªäººâ€¦â€¦æœ‰å¤Ÿè®¨åŒï¼Œä¸€å¤§æ—©å°±åœ¨å…¬å›­é‡Œå–å•¤é…’ï¼Œè¿˜ç•™ä¸‹è«åå…¶å¦™çš„å’Œ<br>æ­Œã€‚ã€å­é›„è¯´ç€ã€‚<br>è¿‡å»å› ä¸ºè¿™ä¸ªé›¨å¥³è€Œå°åˆ°çš„å›°æƒ‘ã€ç„¦èºã€å«‰å¦’ã€æ†§æ†¬ã€æœŸç›¼ã€ç¥ˆæ±‚ã€å¸Œæœ›ã€ç»æœ›ç­‰æ‰€æœ‰æƒ…ç»ªï¼Œé€æ¸åŒ–ä¸ºæ€’æ„ã€‚ä»–å†ä¹Ÿç®¡ä¸ä½è‡ªå·±çš„å˜´å·´ã€‚<br>ã€Œä½ ä»æ¥ä¸è¯´è‡ªå·±çš„äº‹ï¼Œå´è€æ˜¯æ¢å¬æˆ‘çš„äº‹ã€‚ä½ æ—©å°±çŸ¥é“æˆ‘æ˜¯ä½ çš„å­¦ç”Ÿå§ï¼Ÿä½ è¿™ç§åšæ³•æœ‰å¤Ÿå‘<br>é„™ï¼ã€<br>è®¨åŒï¼æˆ‘è®¨åŒè¿™ä¸ªå¥³äººã€‚ä¸€å‰¯å—åˆ°ä¼¤å®³çš„è¡¨æƒ…ï¼Œç°åœ¨åˆä¸€å‰¯è¦å“­çš„æ ·å­ï¼Œæˆ‘æœ€è®¨åŒå¥¹äº†ï¼<br>ã€Œå¦‚æœçŸ¥é“ä½ æ˜¯è€å¸ˆï¼Œæˆ‘ç»å¯¹ä¸ä¼šå‘Šè¯‰ä½ é‹å­çš„äº‹ã€‚åæ­£ä½ ä¼šè§‰å¾—é‚£æ˜¯åšä¸åˆ°ï¼Œä¹Ÿä¸å¯èƒ½å®ç°<br>çš„æ¢¦æƒ³ï¼Œå¯¹å§ï¼Ÿä½ ä¸ºä»€ä¹ˆä¸é‚£æ ·è¯´ï¼Ÿè¿˜æ˜¯ä½ è§‰å¾—è¿™åªæ˜¯å°å­©å­è®²çš„è¯ï¼Œéšä¾¿åº”ä»˜ä¸€ä¸‹å°±å¥½ï¼Ÿã€<br>è®¨åŒï¼æˆ‘è®¨åŒè‡ªå·±åƒå­©å­ä¸€æ ·ï¼Œä¸ºè¿™ç§äº‹æƒ…åš·åš·ã€‚<br>ã€Œä½ ä¸€å¼€å§‹å°±çŸ¥é“æˆ‘å‘å¾€ä»€ä¹ˆã€æ†§æ†¬è°ï¼Œä¹ŸçŸ¥é“é‚£ä¸ªäººä¸ä¼šæ¥å—ã€ç›®æ ‡æ°¸è¿œä¸ä¼šå®ç°ã€‚ä½ éƒ½çŸ¥<br>é“ï¼ã€<br>æˆ‘è®¨åŒè‡ªå·±åœ¨å¥³äººé¢å‰å“­å¾—è¿™ä¹ˆéš¾çœ‹ï¼Œæˆ‘ä¸€ç›´ä¸€ç›´åŠªåŠ›å½“ä¸ªå¤§äººï¼Œä½ å´æŠŠæˆ‘å˜æˆè¿™å‰¯æ¨¡æ ·ã€‚æˆ‘<br>è®¨åŒä½ ï¼<br>ã€Œâ€¦â€¦æ—¢ç„¶å¦‚æ­¤ï¼Œä½ åº”è¯¥ä¸€å¼€å§‹å°±å¯¹æˆ‘è¯´å•Šï¼è¯´æˆ‘ç¢äº‹ï¼è¯´è‡­å°å­å¿«å»ä¸Šå­¦ï¼è¯´ä½ è®¨åŒæˆ‘ï¼ã€<br>ä½†å¦‚æœä¸è¿™ä¹ˆåšï¼Œæˆ‘ä¼šä¸€è¾ˆå­éƒ½çˆ±ç€ä½ ã€‚å¥½å–œæ¬¢å¥½å–œæ¬¢å¥½å–œæ¬¢ï¼Œå°±è¿ç°åœ¨çš„æ¯ä¸€åˆ†æ¯ä¸€ç§’ä¹Ÿæ›´<br>åŠ å–œæ¬¢ä½ ã€‚<br>ã€Œä½ å°±ä¸€ç›´é‚£æ ·â€¦â€¦ã€<br>â€”â€”å¼€ä»€ä¹ˆç©ç¬‘ï¼Œæ€ä¹ˆè¿ä½ ä¹Ÿå“­äº†ï¼Ÿ<br>ã€Œä½ å°±ä¸€ç›´é‚£æ ·ï¼Œæ‘†å‡ºè‹¥æ— å…¶äº‹çš„è¡¨æƒ…â€¦â€¦ã€<br>ç§‹æœˆçš„æ³ªæ°´æ»´æ»´ç­”ç­”æ»‘è½ï¼Œå¤§å¼ç€ã€‚<br>ã€Œâ€”â€”ä¸€ç›´å­¤å•ä¸€äººï¼Œåº¦è¿‡ä¸€ç”Ÿå§ï¼ã€</p>
</blockquote>
<p>â€¦â€¦</p>
<p>ä»Šå¤©æ˜¯ä¸‰æœˆäºŒåä¹æ—¥ï¼Œæˆ‘çªç„¶å¥½åƒæ˜ç™½äº†è‡ªå·±å¦‚æ­¤ç€è¿·ä¸è¿™ä¸ªæ•…äº‹çš„åŸå› ã€‚</p>
<p>å­¤ç‹¬ã€‚</p>
<p>å¯¹ï¼Œå°±æ˜¯è¿™ä¸ªè¯ï¼Œå­¤ç‹¬ã€‚</p>
<p>æ— è®ºæ˜¯ã€Šæˆ‘æƒ³åƒæ‰ä½ çš„èƒ°è„ã€‹çœŸäººç”µå½±ä¹Ÿå¥½ï¼Œã€Šè¨€å¶ä¹‹åº­ã€‹ä¹Ÿå¥½ï¼Œç”·ä¸»ä¸€ç›´æ˜¯å­¤ç‹¬çš„â€”â€”åªä¸è¿‡ä»–ä»¬è‡ªå·±ä¸è§‰å¾—å­¤ç‹¬ï¼Œä½†æ˜¯å´æœ‰ä¸€ç§å‘¼ä¹‹æ¬²å‡ºçš„å­¤ç‹¬æ„Ÿï¼›ç´§æ¥ç€ä»–ä»¬åˆ†åˆ«é‡åˆ°äº†å¥³ä¸»ï¼Œä»æ­¤å¼€å§‹ä¸å†å­¤ç‹¬â€”â€”å­é›„å¯ä»¥æ¯é€¢é›¨å¤©å»äº­å­é‡Œå’Œé›ªé‡ç›¸è§ï¼Œæ˜¥æ ‘ä¹Ÿå¯ä»¥æ¯å¤©æœ‰æ¨±è‰¯ä¸ºä¼´â€”â€”è™½ç„¶ä¸æ¸…æ¥šæ˜¥æ ‘åˆ°åº•å–œä¸å–œæ¬¢è¿™æ ·ã€‚</p>
<p>æ€»ä¹‹ï¼Œæœ¬æ¥å•è°ƒçš„ç”Ÿæ´»ï¼Œçªç„¶å°±å¤šå½©äº†èµ·æ¥ï¼šçœ¼å‰æ˜¯æœªæ›¾è§è¿‡çš„äº®ä¸½æ™¯è‰²ã€‚ä¸€åˆ‡ä»¿ä½›æ˜¯å‘½ä¸­æ³¨å®šï¼Œæœ‰ç§å¤©èµçš„ä½¿å‘½æ„Ÿè®©ä½ çˆ±å¥¹ï¼Œè€Œå¥¹ä¹Ÿè®©ä½ çš„ç”Ÿæ´»çœ‹èµ·æ¥æ²¡æœ‰é‚£ä¹ˆæ— èŠâ€”â€”â€œæ¯ä¸ªä¸æ›¾èµ·èˆçš„æ—¥å­ã€‚éƒ½æ˜¯å¯¹ç”Ÿå‘½çš„è¾œè´Ÿâ€ï¼Œå¥¹æˆ–è®¸å°±æ˜¯ä½ ç”Ÿå‘½ä¸­çš„é¢†èˆè€…ã€‚æ€»ä¹‹ï¼Œå¿ƒä¸­å¦‚åŒæ‹¨äº‘è§æ—¥äº†ä¸€æ ·ï¼Œæœ‰ç€æ˜å¿«çš„èŠ‚å¥å’Œçˆ½æœ—çš„æ—‹å¾‹ã€‚</p>
<p>æˆ–è®¸æ–°æµ·è¯šå·²ç»è¯´å‡ºæ¥äº†ï¼Œä»–æƒ³è¥é€ çš„å°±æ˜¯â€œå­¤ç‹¬â€çš„æ°”æ°›ï¼Œè€Œè¿™å†°å‡‰å†°å‡‰çš„å­¤ç‹¬å¦‚åŒä¸€æŠŠæœ‰ç€æ°´èœœæ¡ƒé¦™æ°”çš„ç®­ï¼Œç©¿è¿‡æˆ‘èƒ¸è…”å‰è–„è–„çš„å‡ å±‚è‚Œè‚¤ï¼Œç›´æˆ³æˆ‘å†…å¿ƒæœ€æŸ”è½¯çš„åœ°æ–¹â€”â€”æˆ‘å¥½å­¤ç‹¬å•Šã€‚</p>
<p>æˆ–è®¸ä¸€æ—¦æˆ‘å¿™èµ·æ¥ï¼Œæˆ‘å°±ä¸å†å¯¹ã€Šè¨€å¶ã€‹æœ‰è¿™ä¹ˆæ·±åšçš„æ„Ÿæƒ…äº†ï¼›æˆ–è®¸ä¸€æ—¦æˆ‘æœ‰äº†å¯ä»¥è®©æˆ‘çš„ç”Ÿæ´»çƒ­é—¹èµ·æ¥çš„äººï¼Œæˆ‘å°±ä¸å†å¯¹ã€Šè¨€å¶ã€‹æœ‰è¿™ä¹ˆæ·±å±‚æ¬¡çš„å…±é¸£äº†ï¼›æˆ–è®¸â€¦â€¦</p>
<p>ä½†æˆ‘æ²¡æœ‰å•Šï¼Œå“ˆã€‚</p>
<p>ä½†æ˜¯æˆ‘å› æ­¤è€Œæ‚²ä¼¤å—ï¼Ÿæˆ–è®¸å§ã€‚ä½†æˆ‘æ›´åº†å¹¸å¯ä»¥æœ‰è¿™ä¸ªæœºä¼šï¼Œæƒ³æœªè°™ä¸–äº‹çš„å°å¥³å­©ä¸€æ ·è‚†æ„å¹»æƒ³è¿™ä¸ªä¸–ç•Œä¸Šæœ€ç¾å¥½çš„ä¸œè¥¿ã€‚è¿™å¯¹æˆ‘æ¥è¯´ï¼Œæˆ–è®¸å·²ç»è¶³å¤Ÿäº†ã€‚</p>
<p>å¤©è¾¹æ˜¯ä¸€æŠ¹é£˜é€¸çš„é±¼è‚šç™½ï¼Œç‚¹ç¼€ç€ä¸€åªé‡‘é»„è‰²çš„å¤ªé˜³ï¼Œéšå·èˆ’çš„äº‘åœ¨ç¢§è“çš„å¤©ç©ºä¸­æ‘‡æ›³ï¼Œæœ‰ç€åˆ«è‡´çš„ç¾æ„Ÿã€‚</p>
<h1 id="rm-Part-5-Ending"><a href="#rm-Part-5-Ending" class="headerlink" title="$\rm{Part~5/Ending}$"></a>$\rm{Part~5/Ending}$</h1><p>ä»Šå¤©æ˜¯$3$æœˆ$31$æ—¥ï¼Œæˆ‘ç»ˆäºå¯ä»¥ç›´é¢ä¸€äº›ä¸œè¥¿äº†ã€‚æ¯”å¦‚æˆ‘åœ¨å¬åˆ°è¨€å¶çš„ä¸»é¢˜æ›²æ—¶ï¼Œä¸åœ¨æ„Ÿåˆ°å­¤ç‹¬å’Œå‹æŠ‘ï¼Œæ›´å¤šçš„åˆ™æ˜¯å¯¹æ–°ç”Ÿæ´»çš„ç›¼æœ›ã€‚</p>
<p>æˆ‘ä¸€ç›´åœ¨æƒ³ï¼Œè¿™æœ¬ä¹¦åˆ°åº•èƒ½å¸¦ç»™æˆ‘ä»€ä¹ˆã€‚</p>
<p>æ˜¯å¦‚ä½•å°å¿ƒåœ°å‘µæŠ¤ä¸€ä¸ªäººå—ï¼Ÿæ˜¯ä¸ºäº†ä¸€ä¸ªç›®æ ‡ï¼ˆæ¯”å¦‚å­é›„å¯¹åˆ¶é‹ï¼‰è¦ä¸æ–­æŠ«è†æ–©æ£˜å—ï¼Ÿæ˜¯è¦åšå¼ºå—ï¼Ÿæ˜¯è¦çæƒœèº«è¾¹æ¯ä¸€ä¸ªäººå—ï¼Ÿæ˜¯â€¦â€¦ï¼Ÿâ€¦â€¦</p>
<p>æˆ‘ä¸çŸ¥é“ï¼Œä½†æˆ‘è§‰å¾—æˆ‘åˆ—ä¸¾çš„æ¯ä¸ªç›®çš„éƒ½å¤ªè‚¤æµ…ã€‚</p>
<p>æˆ–è®¸è¯»ä¹¦ï¼Œè¯»ä¸€ä¸ªä»¤äººæ„ŸåŠ¨çš„æ•…äº‹ï¼ŒçœŸçš„ä¸ä¼šå¸¦æ¥ä»€ä¹ˆç‰¹åˆ«çš„ä¸œè¥¿ã€‚ä½†é‚£ä¼šåŒ–æˆè¡€ä¸è‚‰ï¼Œå¡«å……è¿›æˆ‘çš„èº«ä½“ï¼›ä¼šåŒ–æˆä¸€ç¼•é’çƒŸï¼Œè¿·è’™åœ¨æˆ‘çš„è„‘æµ·é‡Œï¼Œæœ€ç»ˆæ²‰ç§¯ä¸‹æ¥ï¼Œåˆ°å®ƒåº”è¯¥åˆ°çš„åœ°æ–¹å»ã€‚</p>
<p>è¯´çš„å¤ªæ¨¡ç³Šäº†ï¼Œâ€œåˆ°å®ƒåº”è¯¥åˆ°çš„åœ°æ–¹å»â€ï¼Œç©¶ç«Ÿæ˜¯åˆ°å“ªå»å‘¢ï¼Ÿæ˜¯æ²‰ç§¯åˆ°è„‘è¢‹é‡Œï¼Œæ²‰ç§¯åœ¨å¿ƒé‡Œï¼Œè¿˜æ˜¯æ²‰ç§¯åœ¨æˆ‘èº«ä½“ä¸Šéšä¾¿å“ªä¸ªå™¨å®˜ä¸Šï¼Ÿåˆæˆ–è®¸å®ƒæ ¹æœ¬ä¸ä¼šåœç•™ï¼Œäºæˆ‘è€Œè¨€åªæ˜¯ä¸€ä¸ªè¿‡å®¢ï¼Œå¯ä»¥çªç„¶ä»æˆ‘èº«ä¸Šè’¸å‘èµ°å‘¢â€¦â€¦ï¼Ÿ</p>
<p>æˆ‘ä¸ä¼šçŸ¥é“â€”â€”æ¯•ç«Ÿï¼Œæˆ‘è¿è‡ªå·±çš„è·¯éƒ½ä»ä¸çŸ¥è¦å¦‚ä½•å»èµ°ï¼Œæˆ‘è¿è‡ªå·±çš„å»å¤„éƒ½ä»ä¸çŸ¥è¯¥ä½•å¤„å¯»è§…ï¼Œè¿™ç§äº‹æƒ…æˆ‘ä¹Ÿæ›´ä¸ä¼šçŸ¥é“äº†å§ã€‚</p>
<p>$\mathfrak{Orchidany, 3,31,2019}$</p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>éšæƒ³/ä¸‹ä¸‹ç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘çº¿æ€§è§„åˆ’å¯¹å¶å®šç†</title>
    <url>/2019/03/19/%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92%E5%AF%B9%E5%81%B6%E5%AE%9A%E7%90%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt></p>
<h1 id="rm-Preface-About-Duality-Theorm"><a href="#rm-Preface-About-Duality-Theorm" class="headerlink" title="$\rm{Preface:} About~Duality~Theorm$"></a>$\rm{Preface:} About~Duality~Theorm$</h1><p><strong>çº¿æ€§è§„åˆ’å¯¹å¶å®šç†</strong>ï¼šæˆ‘ä»¬æœ´ç´ çš„çº¿æ€§è§„åˆ’å¤§è‡´å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å¤§åŒ–}\quad \sum c_ix_i \quad(i = 1, 2,3 \cdots n) \\
\text{æ»¡è¶³çº¦æŸ} \quad \sum \limits_{j=1}^{n} a_{i,j}x_{j} \leq b_i\quad (i = 1,2,3\cdots m) \\\ \qquad \qquad \qquad \quad x_j \geq 0\quad (j=1,2,3\cdots n)</script><p>é‚£ä¹ˆæˆ‘ä»¬ç§°å®ƒçš„<strong>å¯¹å¶</strong>ä¸ºå½¢å¦‚ä¸‹çš„çº¿æ€§è§„åˆ’ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å°åŒ–}\quad \sum b_iy_i \quad(i = 1, 2,3 \cdots m) \\
\text{æ»¡è¶³çº¦æŸ} \quad \sum \limits_{j=1}^{m} a_{i,j}y_{j} \geq c_i\quad (i = 1,2,3\cdots n) \\\ \qquad \qquad \qquad \quad y_j \geq 0\quad (j=1,2,3\cdots m)</script><a id="more"></a>
<p>æ¢åšçŸ©é˜µè¡¨ç¤ºå°±ä¼šæ˜¯è¿™æ ·ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å°åŒ–}\quad \boldsymbol{b^Ty} \\
\text{æ»¡è¶³çº¦æŸ} \quad A^T\boldsymbol{y\geq c} \\\
\it{\qquad \qquad \quad} \boldsymbol {y} \geq 0</script><p>é‚£å…¶å®æ¯”è¾ƒæ˜¾ç„¶çš„æ˜¯ï¼Œæˆ‘ä»¬åŸæ¥çº¿æ€§è§„åˆ’ä¸­çš„çº¦æŸå‘é‡ä¸ç›®æ ‡å‡½æ•°é‡Œçš„ç³»æ•°å‘é‡äº¤æ¢ï¼Œç›®æ ‡å‡½æ•°çš„æœ€å¤§åŒ–å˜æˆäº†æœ€å°åŒ–ã€‚ç°åœ¨æˆ‘ä»¬æ€è€ƒå¯¹å¶çš„æ„ä¹‰ã€‚</p>
<p>é¦–å…ˆå‡è®¾æˆ‘ä»¬æœ‰è¿™ä¹ˆä¸€ä¸ªçº¿æ€§è§„åˆ’ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å°åŒ–}\quad \sum b_iy_i \quad(i = 1, 2,3 \cdots m) \\
\text{æ»¡è¶³çº¦æŸ} \quad \sum \limits_{j=1}^{m} a_{i,j}y_{j} \geq c_i\quad (i = 1,2,3\cdots n) \\\ \qquad \qquad \qquad \quad y_j \geq 0\quad (j=1,2,3\cdots m)</script><p><del>å…¶å®å°±æ˜¯ä¸Šé¢é‚£ä¸ª</del></p>
<p>æˆ‘ä»¬çš„ç›®çš„å…¶å®ç­‰ä»·äºç¡®å®šç›®æ ‡å‡½æ•°çš„ä¸‹ç•Œã€‚æˆ‘ä»¬è§‚å¯Ÿæ¯ä¸€ç»„çº¦æŸï¼Œå‡è®¾æœ‰ä¸€ç»„çº¦æŸæ˜¯</p>
<script type="math/tex; mode=display">
\quad \sum \limits_{j=1}^{m} a_{p,j}y_{j} \geq c_p\quad (i = 1,2,3\cdots n)</script><p>å¹¶ä¸”æˆ‘ä»¬ä¿è¯æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\forall a_{p,j} \in \boldsymbol{a_p},\forall b_i \in{\boldsymbol{b}},\quad i=j \Longrightarrow b_i\geq a_{p,j}</script><p>å¥½åƒå†™çš„å¾ˆä¸è§„çŸ©â€¦â€¦æ„æ€å°±æ˜¯å¯¹åº”é¡¹çš„ç³»æ•°ï¼Œç›®æ ‡å‡½æ•°éƒ½æ¯”è¿™ä¸ªçº¦æŸé‡Œçš„å¤§ã€‚</p>
<p>é‚£ä¹ˆå› ä¸º$\forall x\geq 0$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¿è¯ç›®æ ‡å‡½æ•°çš„æœ€å°å€¼ä¸€å®šä¼šæ˜¯$c_p$ã€‚è¿™ä¸ªç»“è®ºæ˜¯æ˜¾ç„¶çš„ã€‚</p>
<p>æ›´è¿›ä¸€æ­¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€åç¡®å®šçš„ä¸‹ç•Œä¸€å®šä¼šæ˜¯è¿™æ ·çš„ï¼ˆæ­¤å¤„ä¸€ç‚¹ä¹Ÿä¸ä¸¥è°¨åœ°ä½¿ç”¨äº†$\Omega$ç¬¦å·ï¼‰ï¼š</p>
<script type="math/tex; mode=display">
\Omega(\rm{Aim}) = \it{\sum \limits_{j = 1}^{n}t_j\cdot\sum\limits_{i=1}^{n}\sum \limits_{k=1}^{m}a_{i,k}y_k}\\\
\forall t_j \geq 0</script><p>è€Œå› ä¸ºæˆ‘ä»¬å¯¹äºåŸæ¥çš„çº¦æŸæœ‰</p>
<script type="math/tex; mode=display">
\quad \sum \limits_{j=1}^{m} a_{i,j}y_{j} \geq c_i\quad (i = 1,2,3\cdots n)</script><p>æ‰€ä»¥æˆ‘ä»¬å°†å…¶ä»£å›æˆ‘ä»¬ç”»å¥½çš„å¼å­é‡Œé¢ï¼š</p>
<script type="math/tex; mode=display">
\Omega(\rm{Aim}) \geq \it{\sum\limits_{j=1}^{n}t_jc_j}</script><p>é‚£ä¹ˆâ€¦â€¦ç›®æ ‡å‡½æ•°çš„ä¸‹ç•Œå°±å˜æˆäº†ä¸€ä¸ªå’Œå¼çš„ä¸Šç•Œâ€”â€”åˆå˜æˆäº†ä¸€ä¸ªæ±‚è§£ç›®æ ‡å‡½æ•°æœ€å¤§å€¼çš„é—®é¢˜ã€‚</p>
<p>é‚£ä¹ˆè¿™æˆ–è®¸æ„Ÿæ€§è¯æ˜äº†å¯¹å¶å®šç†çš„æ­£ç¡®æ€§ï¼Ÿ</p>
<h1 id="rm-Afterword-Some-Typical-Problem"><a href="#rm-Afterword-Some-Typical-Problem" class="headerlink" title="$\rm{Afterword:}Some~Typical~Problem$"></a>$\rm{Afterword:}Some~Typical~Problem$</h1><p><del>æ²¡è§è¿‡å§ï¼Œä¸€ç¯‡æ–‡ç« åªæœ‰å‰è¨€å’Œæ€»ç»“</del></p>
<p><del>å…¶å®åšä¸»å°±æ˜¯åœ¨ç–¯ç‹‚åˆ’æ°´/æ‘¸é±¼</del></p>
<p>å…¶å®å¸¸è§çš„å¯¹å¶é—®é¢˜æœ‰å¾ˆå¤šï¼Œåšä¸»åŠŸåŠ›ä¸å¤Ÿï¼Œäºæ˜¯åªèƒ½æ•´ç†ä¸€ä¸ªæ¯”è¾ƒå½¢å¼åŒ–çš„ç»“è®ºï¼š</p>
<h2 id="æœ€å¤§æµé—®é¢˜"><a href="#æœ€å¤§æµé—®é¢˜" class="headerlink" title="$~$æœ€å¤§æµé—®é¢˜"></a>$~$æœ€å¤§æµé—®é¢˜</h2><p>å½¢å¼åŒ–çš„æœ€å¤§æµé—®é¢˜çš„çº¿æ€§è§„åˆ’å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å¤§åŒ–}\quad \quad \quad ~f_{s\to t} \quad ~ \quad \quad \quad \quad \quad \quad \\
\text{æ»¡è¶³çº¦æŸ} \quad \quad f_{u\to v} \leq L_{u \to v}\qquad (u,v) \in E \\\ 
\qquad \quad \quad ~\sum\limits_{u}f_{u \to v} = \sum\limits_{v}f_{v \to u}\qquad u\in V
 \\\ \qquad \qquad \qquad ~~\quad f_{u\to v} \geq 0 \qquad (u,v) \in E ~\cup \text{e(s,t)}</script><p>å…¶ä¸­$e(u,v)$è¡¨ç¤ºé“¾æ¥$u,v$çš„è·¯å¾„é›†åˆï¼Œ$f$è¡¨ç¤ºæµé‡ï¼Œ$L$è¡¨ç¤ºå®¹é‡(Limit)ã€‚</p>
<p>å…¶å¯¹å¶è¿‡å»å°±ä¼šæ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å°åŒ–}\quad \quad \quad \sum_{(u,v)\in E}L_{u\to v}d_{u \to v} \quad ~ \quad \quad \quad \\
\begin{aligned}
\text{æ»¡è¶³çº¦æŸ} \quad \quad d_{u\to v}-p_u+p_v &\geq 0\qquad (u,v) \in E \\\ 
\qquad \quad \quad \quad \quad \quad ~~p_s - p_t & \geq 1\qquad u\in V
 \\\ \qquad \qquad \qquad \quad  p_i,d_{i\to j} & \in \{0,1\} ~\qquad
\end{aligned}</script><p>é‡Œé¢$d_{i\to j}$è¡¨ç¤º$i \to j$è¿™æ¡è¾¹æœ‰æ²¡æœ‰è¢«å‰²ï¼ŒåŒæ—¶å‡è®¾æˆ‘ä»¬å‰²å®Œä¹‹åï¼ŒåŸæ¥çš„å›¾åˆ†æˆäº†ä¸¤éƒ¨åˆ†$S$å’Œ$T$,é‚£ä¹ˆä¼šæœ‰$p_i = [i \in S]$ã€‚è¿™ä¸ªé™åˆ¶æ˜¯ä¸ºäº†ä¿è¯å‰²çš„é€»è¾‘æ€§â€”â€”æ‰€æœ‰çš„å‰²è¾¹éƒ½è¿æ¥ç€$S,T$ä¸¤ä¸ªé›†åˆï¼Œä¸”æºç‚¹å’Œæ±‡ç‚¹åœ¨ä¸åŒçš„é›†åˆã€‚</p>
<p>emmmæˆ‘å®åœ¨ä¸æƒ³å†æ•´ç†äº†(å†™å¼å­å¤ªéº»çƒ¦)ï¼Œç­‰ä»€ä¹ˆæ—¶å€™æˆ‘é€€å®Œå½¹é—²ä¸‹æ¥å†è¯´å§233</p>
<h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$\rm{Reference}$"></a>$\rm{Reference}$</h2><ul>
<li>$[1]$ :2016å›½å®¶é›†è®­é˜Ÿè®ºæ–‡ã€Šæµ…è°ˆçº¿æ€§è§„åˆ’ä¸å¯¹å¶é—®é¢˜ã€‹è‘£å…‹å‡¡Â· <a href="https://pan.baidu.com/s/1aN2L7DAm_RY2GeN5Snxj1A" target="_blank" rel="noopener">$^{^{[\nearrow]}}$</a> æå–ç ï¼švua4</li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>çº¿æ€§è§„åˆ’</category>
      </categories>
      <tags>
        <tag>çº¿æ€§è§„åˆ’/å•çº¯å½¢æ³•</tag>
        <tag>çº¿æ€§è§„åˆ’/å¯¹å¶å®šç†</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘NTTå’Œä»»æ„æ¨¡æ•°NTT</title>
    <url>/2019/03/17/NTT1-2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="0x01-quad-rm-Preface"><a href="#0x01-quad-rm-Preface" class="headerlink" title="$0x01\quad \rm{Preface}$"></a>$0x01\quad \rm{Preface}$</h1><p>æ— ç‰¹åˆ«è¯´æ˜ï¼Œæœ¬æ–‡ä¸åŒºåˆ†$n$å’Œ$N$ä¸¤ç§ç¬¦å·ï¼Œå‡è¡¨ç¤ºå½¢å¼ä¸º$2^j(j \in \mathbb{N+})$çš„å¤šé¡¹å¼é•¿åº¦ï¼ˆæˆ–è€…ï¼Œæ¬¡æ•°ï¼‰ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äº$FFT$è€Œè¨€ï¼Œå…¶å¾—ä»¥ä¼˜åŒ–æˆ$\log$çš„æ ¹æœ¬åŸå› æ˜¯æ‰¾åˆ°äº†å•ä½å¤æ ¹è¿™ä¸ªä¸œè¥¿ï¼Œå¯ä»¥æ–¹ä¾¿å¤„ç†+è®¡ç®—ã€‚è€Œå¦ä¸€ç§æ–¹æ³•åˆ™æ˜¯åœ¨æ¨¡æ„ä¹‰ä¸‹ï¼Œåˆ©ç”¨åŸæ ¹çš„ç¾å¦™æ€§è´¨ï¼Œè¿›è¡Œå¤šé¡¹å¼å·ç§¯ã€‚</p>
<p>$\boldsymbol{NTT~\text{(Fast Number-Theoreti Transform)}}$ï¼Œ<strong>å¿«é€Ÿæ•°è®ºå˜æ¢</strong>ã€‚åœ¨åˆ†æ$NTT$æ˜¯å¦‚ä½•åˆ©ç”¨åŸæ ¹ä¹‹å‰ï¼Œéœ€è¦å…ˆåˆ†æ$FFT$æ˜¯å¦‚ä½•åˆ©ç”¨çš„å•ä½å¤æ ¹$^{[1]}$ï¼š</p>
<ul>
<li><p>$\omega_n^n = 1$ã€‚</p>
</li>
<li><p>$\omega_n^1,\omega_n^2, \omega_n^3\cdots\omega_n^{n-1}$æ˜¯äº’ä¸ç›¸åŒçš„ï¼Œè¿™æ ·å¸¦å…¥è®¡ç®—æ‰èƒ½ä¿è¯æ’å‡ºä¸€ä¸ªå®Œæ•´çš„$n$æ¬¡å¤šé¡¹å¼ã€‚</p>
</li>
<li><p>{$\omega_n^2$} = {$\omega_{\frac{n}{2}}^{2}$}ï¼Œè¿™ä½¿å¾—é—®é¢˜è§„æ¨¡å¯ä»¥åœ¨è®¡ç®—çš„æ—¶å€™å‡åŠã€‚</p>
</li>
<li><script type="math/tex; mode=display">
\sum \limits _{k=0}^{n-1} (\omega_n^{j-i})^k = 
 \begin{cases} 0 \quad i \neq j \newline n \quad i = j \newline \end{cases}</script></li>
</ul>
<p>è¿™æ ·å¯ä»¥ä¿è¯æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ç›¸åŒçš„æ–¹æ³•è¿›è¡Œé€†å˜æ¢ã€‚</p>
<hr>
<p>é¦–å…ˆï¼ŒåŸæ ¹çš„åŸºæœ¬å®šä¹‰ï¼šè®¾$g$ä¸º$p$çš„ä¸€ä¸ªåŸæ ¹ï¼Œåˆ™æ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">
ğ‘”^{ğ‘âˆ’1}  \equiv 1(\mod p) \\
âˆ€1â‰¤ğ‘˜<ğ‘âˆ’1, ğ‘”^ğ‘˜ \not \equiv 1(\mod p)</script><p>æ¢å¥è¯è¯´$g^0,g^1,g^2\cdots,g^{p-2} \quad (\bmod p)$ æ˜¯äº’ä¸ç›¸åŒçš„æ•°ï¼Œæ»¡è¶³æ€§è´¨äºŒã€‚</p>
<p>åŒæ—¶å¦‚æœæˆ‘ä»¬ä»¤$p-2$ä½œä¸ºè¿™ä¸ªç¾¤çš„é˜¶ï¼Œé‚£ä¹ˆ$g^{p-1}$å’Œ$\omega_n^n$ï¼Œå…¶å®å°±æ˜¯ç­‰ä»·çš„ï¼Œåªä¸è¿‡</p>
<script type="math/tex; mode=display">
g^{p-1} \equiv1(\bmod~p) \\ \omega_n^n=1</script><p>è€Œå·²ã€‚äºæ˜¯å°±æ»¡è¶³æ€§è´¨ä¸€ã€‚</p>
<p>  è€Œå¯¹äºæ€§è´¨ä¸‰ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘ä¸€ä¸ªè½¬åŒ–ã€‚æˆ‘ä»¬å¦‚æœè¦å°†$g$ä½œä¸ºå•ä½æ ¹çš„æ›¿ä»£çš„è¯ï¼Œå°±éœ€è¦ç”¨åˆ°$g^{\frac{p-1}{N}}$ã€‚æ¢å¥è¯è¯´ï¼Œ$N | (p-1)$ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥ä»¤$g_n^k \equiv g^{\frac{k(p-1)}{N}} (\bmod~p)$ï¼Œå¾—åˆ°ä¸€ä¸ªå’Œå•ä½æ ¹ç›¸ä¼¼çš„å½¢å¼ã€‚</p>
<p>  é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œå› ä¸º$p$æ˜¯ç´ æ•°ï¼Œæ‰€ä»¥åœ¨$g_n^n\equiv g^{\frac{N(p-1)}{N}}\equiv g^{p-1} \equiv 1 (\bmod ~p)$çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$g_{2n}^{n} \equiv1\quad\text{or}\quad \text{-1} (\bmod~ p)$ï¼Œé‚£ä¹ˆå¹³æ–¹ä¹‹åæ€§è´¨ä¸‰ä¾¿æ˜¾è€Œæ˜“è§ï¼›æˆ–è€…è€ƒè™‘å¦ä¸€ç§æ€è·¯ï¼Œæˆ‘ä»¬æ ¹æ®åˆšæ‰å¾—å‡ºçš„ã€è·ŸäºŒæ¬¡å‰©ä½™æœ‰äº›ç›¸ä¼¼çš„å¼å­ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ç»“è®ºï¼š</p>
<script type="math/tex; mode=display">
  g_n^{\frac{n}{2}+k}=-g_n^k (\bmod~p)</script><p>  å†ç»“åˆ<del>æ˜¾è€Œæ˜“è¯çš„</del>æ¶ˆå»å¼•ç†$g_n^k \equiv g_{jn}^{jk}$ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè‡ªç„¶åƒ$FFT$è¯æ˜å•ä½å¤æ ¹çš„æŠ˜åŠæ€§ä¸€æ ·ï¼Œè¯å‡ºè¿™ä¸ªç»“è®ºã€‚</p>
<p>  è‡³äºæ€§è´¨å››ï¼Œè¯æ˜çš„å¤§ä½“ç›¸ä¼¼äºå•ä½å•ä½å¤æ ¹ã€‚å³ï¼š</p>
<script type="math/tex; mode=display">
  \sum\limits_{j =0}^{n-1}{(g_n^k)^j} \equiv \frac{(g_n^k)^n -1}{g_n^k -1} \Longrightarrow  \frac{(g_n^n)^k -1}{g_n^k -1} \equiv  \frac{(1)^k -1}{g_n^k -1} = 0</script><p>  è€Œå¯¹äº$n=k$çš„æƒ…å†µï¼Œä¸é€‚ç”¨äºæ™®é€šçš„å‡ ä½•çº§æ•°æ±‚å’Œï¼Œæ‰€ä»¥ç›´æ¥å°±æ˜¯$\sum 1 =n$ ã€‚</p>
<h1 id="0x02-quad-rm-Codes"><a href="#0x02-quad-rm-Codes" class="headerlink" title="$0x02\quad \rm{Codes}$"></a>$0x02\quad \rm{Codes}$</h1><p>å‘ƒï¼Œäºæ˜¯NTTå°±å®Œäº†ã€‚æ³¨æ„å› ä¸ºè¦ä¿è¯$N | (p-1)$ï¼Œä¸” $N$ æ˜¯ $2$ çš„å¹‚æ¬¡ï¼Œæ‰€ä»¥ç´ æ•° $p$ ä¸€å®šè¦æ˜¯ $k\cdot 2^j+1$ çš„å½¢å¼ã€‚</p>
<p>è‡³äºæ±‚åŸæ ¹ï¼Œä¸æ˜¯æœ¬ç•Œæ¢è®¨çš„å†…å®¹ã€‚æ™®é€šçš„NTTæ¨¡æ•°ï¼ŒåŸæ ¹å¯ä»¥èƒŒè¿‡ï¼›å…¶ä½™æƒ…å†µæš´åŠ›æ±‚+éªŒè¯å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> N, M, K, qaq ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3000010</span> ;</span><br><span class="line">LL A[MAXN], B[MAXN], Inv ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>) ;</span><br><span class="line"><span class="keyword">int</span> i, j, k, l, Lim = <span class="number">1</span>, L, R[MAXN] ; </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span>, G = <span class="number">3</span>, Gi = <span class="number">332748118</span> ; </span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IO&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> ch_top=<span class="number">4e7</span>+<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">char</span> ch[ch_top],*now_r=ch<span class="number">-1</span>,*now_w=ch<span class="number">-1</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">while</span>(*++now_r&lt;<span class="string">'0'</span>);</span><br><span class="line">    	<span class="keyword">register</span> <span class="keyword">int</span> x=*now_r-<span class="string">'0'</span>;</span><br><span class="line">    	<span class="keyword">while</span>(*++now_r&gt;=<span class="string">'0'</span>)x=x*<span class="number">10</span>+*now_r-<span class="string">'0'</span>;</span><br><span class="line">    	<span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">   		<span class="keyword">static</span> <span class="keyword">char</span> st[<span class="number">20</span>];<span class="keyword">static</span> <span class="keyword">int</span> top;</span><br><span class="line">    	<span class="keyword">while</span>(st[++top]=<span class="string">'0'</span>+x%<span class="number">10</span>,x/=<span class="number">10</span>);</span><br><span class="line">    	<span class="keyword">while</span>(*++now_w=st[top],--top);</span><br><span class="line">    	*++now_w=<span class="string">' '</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL a, LL b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) (res *= a) %= P ;</span><br><span class="line">        (a *= a) %= P, b &gt;&gt;= <span class="number">1</span> ; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(LL *J, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; R[i]) swap(J[i], J[R[i]]) ;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; Lim; j &lt;&lt;= <span class="number">1</span>)&#123;</span><br><span class="line">    	LL Gn = expow(flag == <span class="number">1</span> ? G : Gi, (P - <span class="number">1</span>) / (j &lt;&lt; <span class="number">1</span>)) ;</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; Lim; k += (j &lt;&lt; <span class="number">1</span>) )&#123;</span><br><span class="line">        	LL g = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j ; l ++, g = (g * Gn) % P)&#123;</span><br><span class="line">                LL Nx = J[k + l], Ny = g * J[k + j + l] % P ;</span><br><span class="line">                J[k + l] = (Nx + Ny) % P, J[k + j + l] = (Nx - Ny + P) % P ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> IO ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fread(ch,<span class="number">1</span>,ch_top,<span class="built_in">stdin</span>); </span><br><span class="line">    N = read(), M = read() ;</span><br><span class="line">    <span class="keyword">while</span>(Lim &lt;= N + M) Lim &lt;&lt;= <span class="number">1</span>, L ++ ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= N; i ++) A[i] = (read() + P) % P ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= M; i ++) B[i] = (read() + P) % P ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++ ) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>)) ;</span><br><span class="line">    NTT(A, <span class="number">1</span>), NTT(B, <span class="number">1</span>);</span><br><span class="line">  	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= Lim; i ++) A[i] = (A[i] * B[i]) % P ; Inv = expow(Lim, P - <span class="number">2</span>) ;</span><br><span class="line">    NTT(A, <span class="number">-1</span>) ; </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= N + M; i ++) write((<span class="keyword">long</span> <span class="keyword">long</span>) (A[i] * Inv + P) % P) ; 	 					fwrite(ch, <span class="number">1</span>, now_w - ch, <span class="built_in">stdout</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­<code>Gi</code>è¡¨ç¤º$998244353$çš„åŸæ ¹çš„é€†å…ƒã€‚</p>
<h1 id="0x03-quad-rm-Extending"><a href="#0x03-quad-rm-Extending" class="headerlink" title="$0x03\quad \rm{Extending}$"></a>$0x03\quad \rm{Extending}$</h1><p>æ¥ä¸ŠèŠ‚å†…å®¹ï¼Œ$NTT$æœ¬è´¨ä¸Šæ˜¯åªèƒ½å¤„ç†â€œ$NTT$æ¨¡æ•°ï¼ˆ$p=\omega\cdot 2^k+1$ï¼‰â€ã€‚ä½†æ˜¯å½“æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œä»»æ„æ¨¡æ•°å–æ¨¡æ—¶ï¼Œå°±éœ€è¦æˆ‘ä»¬ç”¨$CRT$åˆå¹¶ã€‚</p>
<p>ç„¶åâ€¦æˆ‘ä¹Ÿä¸çŸ¥é“ä»å“ªæ‰¾åˆ°äº†ä¸€å¼ æ¯”è¾ƒæµ…æ˜¾çš„å›¾ï¼š<img src="1.png" alt> </p>
<p>ä½†æ˜¯è¿™ä¸ªåœ°æ–¹ä»ç„¶ä¼šå­˜åœ¨ä¸å°‘é—®é¢˜ï¼Œå·¨ä½¬<code>KsCla</code>å¦‚æ­¤è§£é‡Šï¼š</p>
<blockquote>
<p>å…·ä½“åšæ³•æ˜¯è¿™æ ·ï¼šå…ˆé€‰å–ä¸‰ä¸ªä¹˜ç§¯åœ¨$10^{23 }$ä»¥ä¸Šçš„ä¾¿äºä½¿ç”¨NTTçš„æ¨¡æ•°ã€‚åœ¨è¿™é‡Œæˆ‘é€‰çš„æ˜¯$m_1=998244353=2^{23}âˆ—119+1$ï¼Œ$m_2=1004535809=2^{21}âˆ—479+1$ï¼Œ$m_3=469762049=2^{26}âˆ—7+1$ã€‚é€‰è¿™ä¸‰ä¸ªæ¨¡æ•°çš„å¥½å¤„åœ¨äºå®ƒä»¬çš„åŸæ ¹éƒ½æ˜¯3ã€‚<br>ç„¶åç”¨è¿™ä¸‰ä¸ªæ¨¡æ•°åšNTTï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¸‰æ¡å¼å­ï¼š</p>
<script type="math/tex; mode=display">
~ansâ‰¡c_1~(\bmod m_1)\\\
ansâ‰¡c_2~(\bmod m_2)\\\
ansâ‰¡c_3~(\bmod m_3)</script><p>è™½ç„¶è¿™ä¸‰æ¡å¼å­å¯ä»¥åœ¨$10^{23}$ä»¥å†…å”¯ä¸€å›ºå®š$ans$çš„å€¼ï¼Œä½†é—®é¢˜ä¹Ÿéšä¹‹è€Œæ¥ï¼š$m_1âˆ—m_2âˆ—m_3$å¾ˆå¤§ï¼Œæ— æ³•ç›´æ¥ç”¨<code>long long</code>å­˜ä¸‹ï¼Œè€Œç”¨<code>long double</code>ä¹‹ç±»çš„åˆ™ä¼šä¸¢å¤±ç²¾åº¦ï¼Œæ‰€ä»¥æ— æ³•ç”¨æ™®é€šçš„$CRT$ã€‚éš¾é“è¦å†™é«˜ç²¾åº¦ï¼Ÿ</p>
<p>ä¸ï¼Œæœ‰ä¸€ç§å¾ˆå¦™çš„æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<br>é¦–å…ˆæ³¨æ„åˆ°è¿™é‡Œåªæœ‰ä¸‰ä¸ªæ¨¡æ•°ï¼Œè€Œä¸”ä¸¤ä¸ªæ¨¡æ•°ä¹˜èµ·æ¥æ˜¯ä¸ä¼šçˆ†<code>long long</code>çš„ï¼Œæ‰€ä»¥å¯ä»¥å…ˆåˆå¹¶å‰ä¸¤æ¡å¼å­ã€‚æ ¹æ®CRTï¼Œæœ‰ï¼š</p>
<script type="math/tex; mode=display">
ansâ‰¡(c_1m_2Inv(m_2,m_1)+c_2m_1Inv(m_1,m_2))(\bmod m_1m_2)</script><p>å…¶ä¸­$Inv(x,y)$è¡¨ç¤ºxå…³äºyçš„é€†å…ƒã€‚<br>è¿™æ¡å¼å­æ¶‰åŠåˆ°ä¸¤ä¸ªå¾ˆå¤§çš„æ•°ç›¸ä¹˜ç„¶åå†å–æ¨¡ï¼Œè€Œç›´æ¥ç›¸ä¹˜ä¼šçˆ†long longã€‚å¯ä»¥ç”¨$O(\log(m_1m_2))$çš„å¿«é€Ÿä¹˜ï¼Œæˆ–è€…$O(1)$è½¬doubleåç›¸ä¹˜ã€‚<br>ä¸ºäº†æ–¹ä¾¿ï¼ŒæŠŠä¸Šå¼åŒ–æˆè¿™æ ·çš„å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
ansâ‰¡C(\bmod M)</script><p>ç„¶åè®¾ï¼š</p>
<script type="math/tex; mode=display">
ans=xM+C=ym_3+c_3</script><p>æ¥ä¸‹æ¥çš„éƒ¨åˆ†æ‰æ˜¯ç²¾é«“ã€‚æˆ‘ä»¬æ±‚å‡º$x$åœ¨$\bmod m_3$æ„ä¹‰ä¸‹çš„å€¼ï¼š</p>
<script type="math/tex; mode=display">
xMâ‰¡c_3âˆ’C(\bmod m_3)</script><p>åœ¨$\bmod m_3$æ„ä¹‰ä¸‹ï¼Œ$ym_3$è¢«æ¶ˆæ‰äº†ã€‚</p>
<p>ç„¶åæœ‰ï¼š</p>
<script type="math/tex; mode=display">
xâ‰¡(c_3âˆ’C)Mâˆ’1(\bmod m_3)</script><p>ç®—å‡ºå³åŠéƒ¨åˆ†çš„å€¼ä¸º$q$ï¼Œåˆ™å¯ä»¤$x=km_3+qx=km_3+q$ã€‚å°†å…¶ä»£å…¥$ans=xM+C$ï¼š</p>
<script type="math/tex; mode=display">
ans=(km_3+q)M+C=km_3M+qM+C</script><p>ä¹Ÿå°±æ˜¯è¯´ï¼š</p>
<script type="math/tex; mode=display">ans=km_1m_2m_3+qM+C</script><p>è€Œç”±äº$ansâˆˆ[0,m_1m_2m_3)$ï¼Œæ‰€ä»¥$k$å¿…ä¸º0ã€‚ä¹Ÿå°±æ˜¯è¯´$ans$å°±æ˜¯$qM+C$ï¼ç›´æ¥æŠŠè¿™æ¡å¼å­å¯¹é¢˜é¢è¦æ±‚çš„æ¨¡æ•°å–æ¨¡å³å¯.</p>
</blockquote>
<p>å—â€¦â€¦å…¶å®æˆ‘å°±æ˜¯åŠ äº†ä¸€émkdï¼Œä½†æ˜¯ä¹Ÿç®—æ˜¯å¤ä¹ äº†ä¸€éå§XDã€‚</p>
<p>æœ‰ä¸€ç‚¹æ˜¯éœ€è¦æ³¨æ„çš„ï¼š</p>
<ul>
<li>ä¸ºä»€ä¹ˆè¦é€‰ä¸‰ä¸ªä¹˜ç§¯å¤§äº$10^{23}$çš„è´¨æ•°ä½œä¸ºæ¨¡æ•°ï¼Ÿ<ul>
<li>ä¸ºäº†æ˜¯æœ€åçš„ç»“æœå¯ä»¥<strong>ä¸å–æ¨¡</strong></li>
</ul>
</li>
</ul>
<p>å—¯ï¼Œç„¶åå°±æ˜¯æ¿å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> G = <span class="number">3</span> ;</span><br><span class="line"><span class="keyword">int</span> N, M, K, qaq ;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">600010</span> ;</span><br><span class="line"><span class="keyword">int</span> i, j, k, l, Lim = <span class="number">1</span>, L, R[MAXN] ; </span><br><span class="line"><span class="keyword">int</span> Mod, P, pr[] = &#123;<span class="number">469762049</span>, <span class="number">998244353</span>, <span class="number">1004535809</span>&#125; ;</span><br><span class="line">LL Ans[<span class="number">4</span>][MAXN], A[MAXN], B[MAXN], Inv, A1[MAXN], B1[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    LL k = <span class="number">0</span>, f = <span class="number">1</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c)) &#123;<span class="keyword">if</span>(c == <span class="string">'-'</span>) f = <span class="number">-1</span> ;c = getchar() ;&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span> ,c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k * f ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL a, LL b, LL p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) (res *= a) %= p ;</span><br><span class="line">        (a *= a) %= p, b &gt;&gt;= <span class="number">1</span> ; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res % p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(LL *J, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, j, k, l ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; R[i]) swap(J[i], J[R[i]]) ;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; Lim; j &lt;&lt;= <span class="number">1</span>)&#123;</span><br><span class="line">    	LL Gn = expow(G, (P - <span class="number">1</span>) / (j &lt;&lt; <span class="number">1</span>), P) ;</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; Lim; k += (j &lt;&lt; <span class="number">1</span>) )&#123;</span><br><span class="line">        	LL g = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j ; l ++, g = (g * Gn) % P)&#123;</span><br><span class="line">                LL Nx = J[k + l], Ny = g * J[k + j + l] % P ;</span><br><span class="line">                J[k + l] = (Nx + Ny) % P, J[k + j + l] = (Nx - Ny + P) % P ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag &gt; <span class="number">0</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> Inv = expow(Lim, P - <span class="number">2</span>, P) ; reverse(J + <span class="number">1</span>, J + Lim) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= Lim ; ++ i) J[i] = <span class="number">1l</span>l * J[i] * Inv % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">(LL *J, LL *L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (rr <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; Lim ; ++ i) J[i] = L[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">egg</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> ; &#125;</span><br><span class="line"><span class="function">LL <span class="title">mul</span><span class="params">(LL a,LL b,LL p)</span></span>&#123;</span><br><span class="line">    LL re = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>,a = (a + a) % p)</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) re = (re + a) % p;</span><br><span class="line">    <span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">T_NTT</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, j, k ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= <span class="number">2</span> ; ++ i)&#123;</span><br><span class="line">        P = pr[i] ; i ? clear(A1, B1) : egg() ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= N ; ++ j) A1[j] = A[j] ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= M ; ++ j) B1[j] = B[j] ;</span><br><span class="line">        NTT(A1, <span class="number">1</span>), NTT(B1, <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; Lim ; ++ j) A1[j] = A1[j] * B1[j] % P ;</span><br><span class="line">        NTT(A1, <span class="number">-1</span>) ; <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= Lim ; ++ j) Ans[i + <span class="number">1</span>][j] = A1[j] ; </span><br><span class="line">    &#125;</span><br><span class="line">    rr LL Mo = <span class="number">1l</span>l * pr[<span class="number">1</span>] * pr[<span class="number">0</span>], k1, k2, a, b, c, mod = Mod ;</span><br><span class="line">    LL inv1 = expow(pr[<span class="number">1</span>] % pr[<span class="number">0</span>], pr[<span class="number">0</span>] - <span class="number">2</span>, pr[<span class="number">0</span>]), inv0 = expow(pr[<span class="number">0</span>] % pr[<span class="number">1</span>], pr[<span class="number">1</span>] - <span class="number">2</span>, pr[<span class="number">1</span>]), inv3 = expow(Mo % pr[<span class="number">2</span>], pr[<span class="number">2</span>] - <span class="number">2</span>, pr[<span class="number">2</span>]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N + M ; ++ i)&#123;</span><br><span class="line">        a = Ans[<span class="number">1</span>][i], b = Ans[<span class="number">2</span>][i], c = Ans[<span class="number">3</span>][i] ;</span><br><span class="line">        k1 = (mul(a * pr[<span class="number">1</span>] % Mo, inv1, Mo) + mul(b * pr[<span class="number">0</span>] % Mo, inv0, Mo)) % Mo ;</span><br><span class="line">        k2 = ((c - k1 % pr[<span class="number">2</span>]) % pr[<span class="number">2</span>] + pr[<span class="number">2</span>]) % pr[<span class="number">2</span>] * inv3 % pr[<span class="number">2</span>], Ans[<span class="number">0</span>][i] = ((k2 % mod) * (Mo % mod) % mod + k1 % mod) % mod;</span><br><span class="line">    &#125;<span class="comment">/*</span></span><br><span class="line"><span class="comment">    LL a,b,c,t,k,M = 1ll * pr[0] * pr[1];</span></span><br><span class="line"><span class="comment">    LL inv1 = inv(pr[1],pr[0]),inv0 = inv(pr[0],pr[1]),inv3 = inv(M % pr[2],pr[2]);</span></span><br><span class="line"><span class="comment">    for (int i = 0; i &lt;= deg; i++)&#123;</span></span><br><span class="line"><span class="comment">        a = fft[0].A[i],b = fft[1].A[i],c = fft[2].A[i];</span></span><br><span class="line"><span class="comment">        t = (mul(a * pr[1] % M,inv1,M) + mul(b * pr[0] % M,inv0,M)) % M;</span></span><br><span class="line"><span class="comment">        k = ((c - t % pr[2]) % pr[2] + pr[2]) % pr[2] * inv3 % pr[2];</span></span><br><span class="line"><span class="comment">        ans[i] = ((k % md) * (M % md) % md + t % md) % md;</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i ;</span><br><span class="line">    N = qr(), M = qr(), Mod = qr() ;</span><br><span class="line">    <span class="keyword">while</span>(Lim &lt;= N + M) Lim &lt;&lt;= <span class="number">1</span>, L ++ ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= N; i ++) A[i] = qr() % Mod ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= M; i ++) B[i] = qr() % Mod ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++ ) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>)) ;</span><br><span class="line">    T_NTT() ; <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= N + M; i ++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, Ans[<span class="number">0</span>][i])  ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯è¿™ç©æ„å„¿è¿›è¡Œäº†9éNTTï¼Œé‚£æ˜¯çœŸçš„æ…¢ã€‚ã€‚ã€‚</p>
<h1 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$\rm{Reference}$"></a>$\rm{Reference}$</h1><ul>
<li><code>KsCla</code>çš„$blog$ <a href="https://blog.csdn.net/kscla/article/details/79547242" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¤šé¡¹å¼</category>
      </categories>
      <tags>
        <tag>å¤šé¡¹å¼åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘æœ‰è¶£çš„æ•°å­¦é¢˜</title>
    <url>/2019/03/17/Math1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸¤é“å°æ¸…æ–°æ•°å­¦é¢˜ï¼Œåˆ†åˆ«æ˜¯[NOI2002]Savageå’Œ[Violet Â· 5]æ¨±èŠ±</p>
<a id="more"></a>
<p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98-skyblue.svg" alt></p>
<h2 id="rm-NOI2002-Savage"><a href="#rm-NOI2002-Savage" class="headerlink" title="$\rm{[NOI2002]}$ Savage"></a>$\rm{[NOI2002]}$ Savage</h2><p>é“¾æ¥ï¼š<a href="https://www.lydsy.com/JudgeOnline/problem.php?id=1407" target="_blank" rel="noopener">$\color{violet}{Link}$</a> </p>
<h3 id="rm-Sol"><a href="#rm-Sol" class="headerlink" title="$\rm{Sol}$"></a>$\rm{Sol}$</h3><p>ä¸ç®—ç‰¹åˆ«éš¾â€¦å…¶å®å°±æ˜¯æ±‚æ–¹ç¨‹<script type="math/tex">C_{i}+P_{i}x \equiv C_j+P_jx ~(\bmod ~M)</script>ä¸å­˜åœ¨ä¸€ä¸ªè§£ä½¿å¾—$x \leq min(L_i,L_j)$æ—¶ï¼Œ$M$çš„æœ€å°å€¼ã€‚ç„¶åå› ä¸ºé¢˜ç›®ä¸­çš„æ•°æ®ï¼Œå‡è®¾æˆ‘ä»¬ä»¤æ¯ä¸ªé‡äººéƒ½åªæ˜¯ç»•ç€åœˆèµ°è€Œä¸é‡å¤ç»è¿‡å¯¹æ–¹çš„è·¯å¾„â€”â€”å³$M$çš„æœ€å¤§å€¼ï¼Œä¹Ÿä¸è¿‡æ˜¯$100\times 106\times 100 = O(1e6)$çš„çº§åˆ«ï¼Œäºæ˜¯è€ƒè™‘ç›´æ¥æšä¸¾$M$, ç„¶åcheckã€‚ç”±äºæœ€å¤šå…±æœ‰$15$ä¸ªé‡äººï¼Œä¸”å•æ¬¡exgcdæ˜¯$\log n $çº§åˆ«çš„ï¼Œæ‰€ä»¥å¤æ‚åº¦ä¸Šé™æ˜¯$O (Mn^2 \log C_{max}) &lt; \Omega(1e8)$çº§åˆ«çš„ã€‚å¦‚æœä¸æ˜¯ç²¾å¿ƒæ„é€ æ•°æ®çš„è¯ï¼Œå¯ä»¥ç›´æ¥è‰¹è¿‡å»ã€‚</p>
<p>å–œé—»ä¹è§çš„æ˜¯â€¦â€¦æˆ‘çš„exgcdä¼¼ä¹ä¸€å¼€å§‹æœ‰é—®é¢˜ï¼Ÿæˆ‘ä¸€å¼€å§‹æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span>(j = i + <span class="number">1</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">int</span> a = P[i] - P[j], b = M, x, y, w = C[j] - C[i] ;</span><br><span class="line">            <span class="keyword">int</span> qwq = exgcd(x, y, a, b) ; <span class="keyword">if</span> (w % qwq) <span class="keyword">continue</span> ;</span><br><span class="line">            x = x * w / qwq ; <span class="keyword">while</span> (x &lt;= <span class="number">0</span>) x += M ; <span class="keyword">if</span> (x &lt;= min(L[i], L[j])) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åè§‰å¾—ä¸€ç‚¹é—®é¢˜éƒ½æ²¡æœ‰ï¼Œ$40pts$ä¹‹åæ„£äº†å¤§åŠå¤©ã€‚</p>
<p>è€Œäº‹å®ä¸Šè¿™ä¸ªåœ°æ–¹$x$åº”è¯¥æ˜¯ä¸€ä¸ªç‰¹è§£ï¼Œè€Œä¸æ˜¯æœ€å°è§£ã€‚æ¢å¥è¯è¯´æˆ‘ä¸ºäº†æ±‚å‡ºå‡†ç¡®çš„$x$ï¼Œåº”è¯¥ä¸æ–­å–æ¨¡$b/ \gcd(a,b)$</p>
<p>ä¸ºä»€ä¹ˆï¼Ÿè‡³äºä¸ºä»€ä¹ˆï¼Œä¸€å¼€å§‹æˆ‘ä¹Ÿæ‡µçš„å¾ˆã€‚ç›´åˆ°æˆ‘ç¿»å‡ºæ¥å¾ˆä¹…ä¹‹å‰æˆ‘çš„ä¸€ç¯‡é¢˜è§£ï¼š</p>
<blockquote>
<p>_è¿™æ˜¯ä¸Šé¢è¿™ä¸ªå¼å­ä¸ºä»€ä¹ˆå¯ä»¥è¿™ä¹ˆåšçš„è¯æ˜ï¼š_</p>
<p>è‹¥æœ‰$ax+by=c$ä¸”$a_0x+b_0y=c$</p>
<p>é‚£ä¹ˆä¾¿æœ‰$a(x-x_0)+b(y-y_0)=0$<br>ä¸¤è¾¹åŒæ—¶é™¤ä»¥$gcd(a,b)$å¯å¾—ï¼š<br>$\frac{a}{gcd(a,b)}(x-x_0)=-\frac{b}{gcd(a,b)}(y-y_0)$ $ \quad$ $(1)$</p>
<p>è€Œå› ä¸º</p>
<p>$(\frac{a}{gcd(a,b)},\frac{b}{gcd(a,b)})=1$</p>
<p>æ‰€ä»¥ç”±$(1)$å¯å¾—$\frac{b}{gcd(a,b)}$æ•´é™¤$(x-x_0)$</p>
<p>æ‰€ä»¥å¾ˆæ˜¾ç„¶æœ‰$\frac{b}{gcd(a,b)}\times{t}={(x-x_0)},t \in Z$</p>
<p>é‚£ä¹ˆå°±æœ‰å¯¹äºä»»æ„ä¸€ä¸ª$x_i$ï¼Œæœ‰</p>
<p>$ x_i=x_0+\frac{b}{gcd(a,b)} \times{t} $</p>
</blockquote>
<p>æˆ‘ç‰¹ä¹ˆâ€¦æ™ºå•†å·²ç»å›é€€åˆ°ä¸Šä¸ªä¸–çºªäº†å§$\rm{qaq}$ï¼Œè‡ªé—­äº†ã€‚</p>
<p>è¿™å°±æ˜¯æˆ‘æ•´ç†è¿™é“é¢˜çš„åŸå› â€¦â€¦è¿˜æœ‰ï¼Œä¸Šé¢$P_i-P_j$ä¼¼ä¹éœ€è¦å–æ¨¡å¹¶ä½¿å…¶å˜æˆæ­£çš„ï¼Œå› ä¸ºå¥½åƒæˆ‘çš„$exgcd$é‡Œé¢é™åˆ¶äº†$A&gt;0$çš„ç¼˜æ•…ã€‚</p>
<p>å¿ƒå¾—ï¼šæˆ‘é€€å½¹å§å˜¤ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> i, j, N, M, C[MAXN], P[MAXN], L[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y, <span class="keyword">int</span> A, <span class="keyword">int</span> B)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!B) &#123; x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> A ;&#125;</span><br><span class="line">    <span class="keyword">int</span> t = exgcd(y, x, B, A % B) ; y -= A / B * x ; <span class="keyword">return</span> t ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span>(j = i + <span class="number">1</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">int</span> a = (P[i] - P[j] + M) % M + M, b = M, x, y, w = C[j] - C[i], qwq = exgcd(x, y, a, b) ; <span class="keyword">if</span> (w % qwq) <span class="keyword">continue</span> ; </span><br><span class="line">            x = x * w / qwq ; x = (x % (M / qwq) + (M / qwq)) % (M / qwq) ; <span class="keyword">if</span> (!x) x += (M / qwq) ; <span class="keyword">if</span> (x &lt;= min(L[i], L[j])) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;C[i], &amp;P[i], &amp;L[i]), M = max(M, C[i]) ;</span><br><span class="line">    <span class="keyword">for</span> ( M ; ; ++ M) <span class="keyword">if</span> (check()) &#123; <span class="built_in">cout</span> &lt;&lt; M &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="rm-Violetï½5-æ¨±èŠ±"><a href="#rm-Violetï½5-æ¨±èŠ±" class="headerlink" title="$\rm{[Violetï½5]}$ æ¨±èŠ±"></a>$\rm{[Violetï½5]}$ æ¨±èŠ±</h2><p>é“¾æ¥ï¼š<a href="https://www.lydsy.com/JudgeOnline/problem.php?id=2721" target="_blank" rel="noopener">$\color{violet}{Link}$</a> </p>
<p>è¿™æ˜¯å¥½ä¹…ä¹‹å‰åšçš„ä¸€é“é¢˜ï¼Œçªç„¶è¢«æˆ‘å‘ç°äº†ã€‚å¤§æ¦‚å°±æ˜¯æ±‚æ–¹ç¨‹<script type="math/tex">\frac{1}{x}+\frac{1}{y} = \frac{1}{n!}\quad (n \leq 1e6)</script>çš„è§£çš„ç»„æ•°ã€‚</p>
<h3 id="rm-Sol-1"><a href="#rm-Sol-1" class="headerlink" title="$\rm{Sol}$"></a>$\rm{Sol}$</h3><p>ä¸æƒ³æ€è€ƒç³»åˆ—é—®é¢˜ï¼Œæˆ‘è¿™ä¹ˆæ‡’è¿˜æ˜¯é€€å½¹å§ã€‚(sigh)</p>
<p>æˆ‘ä»¬å°†æŸ¿å­å˜ä¸ªå½¢ï¼š</p>
<script type="math/tex; mode=display">
\frac{x+y}{xy} = \frac{1}{n!} \\
n!x + n!y = xy</script><p><del>ç„¶åæˆ‘å°±ä¸ä¼šäº†ï¼Œæ­¤é¢˜å®Œç»“</del></p>
<p>ç„¶åæœ‰ä¸€æ­¥å¾ˆå¦™çš„æ˜¯ä¸¤è¾¹åŒæ—¶$+(n!)^2$å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
(n!)^2 + n!(x+y) -n!(xy) = (n!)^2\\
(n!-x)(n!-y)=(n!)^2</script><p>ç„¶åå°±ä¼šå‘ç°æˆ‘ä»¬åªéœ€è¦æ‰¾å‡º$(n!)^2$çš„å› å­ä¸ªæ•°å°±å¥½äº†â€¦</p>
<p>å¥½åƒæˆ‘ä»æ¥æ²¡æœ‰å†™è¿‡$\tau$çš„æ ·å­ï¼Œæ—¢ç„¶è¿™æ ·æˆ‘å°±é¡ºä¾¿è®°ä¸€ä¸ªç®—å› å­ä¸ªæ•°çš„å…¬å¼å§ï¼ˆå…¶å®å°±æ˜¯ä¹˜æ³•åŸç†å•¦ï¼‰</p>
<script type="math/tex; mode=display">
x = \prod p_ix^{a_i} \longleftrightarrow\tau(x) = \prod (a_i+1)</script><p><del>å…¶å®å°±æ˜¯ä¸ºäº†æ°´å­—æ•°</del></p>
<p>$\rm upd ~on ~6.13$ : æˆ‘å‘ç°è‡ªå·±ä¼¼ä¹ä¹‹å‰å¬è¿‡è¿™ä¸ªé¢˜çš„â€å¦è§£â€ï¼Œä»¥å‰è‡ªå·±æ•´ç†è¿‡ï¼š</p>
<blockquote>
<p>$233$çªèŒæ€è€ƒä¸€ä¸ªæ¯”è¾ƒæ˜¾ç„¶çš„é—®é¢˜ï¼Œå°±æ˜¯ä¸€å®šä¼šæœ‰$y&gt;n!$ã€‚é‚£çªèŒä¸å¦¨è®¾$y = n!+T$ï¼Œé‚£ä¹ˆå¸¦å›åˆ°åŸå¼é‡Œé¢å°±ä¼šæœ‰<script type="math/tex">\frac{1}{x} + \frac{1}{n!+T} = \frac{1}{n!}</script>ç»§è€Œæœ‰<script type="math/tex">x = \frac{n!^2}{T}+n!</script>é‚£ä¹ˆå…¶å®ä¸€å…±å°±æœ‰$\tau(n!^2)$ä¸ªåˆæ³•ç­”æ¡ˆï¼Œæ‰€ä»¥æˆ‘ä»¬è½¬è€Œæ±‚$n!^2$çš„çº¦æ•°æ•°é‡ã€‚</p>
<p>ä½†æ˜¯æ˜¾ç„¶çš„æ˜¯æˆ‘ä»¬å¹¶ä¸å¯ä»¥ç›´æ¥æ±‚è§£ï¼Œå½“ç„¶æˆ‘ä¸çŸ¥é“é«˜ç²¾åº¦ä¹‹åä¼šæ€ä¹ˆæ ·ï¼Œä¼°è®¡$nlogn$ä¸€ä¸‹è¿˜æ˜¯æœ‰å¯èƒ½è¿‡çš„ã€‚ä½†æ˜¯è€ƒè™‘åˆ°å¸¸æ•°å·¨å¤§ï¼Œæ‰€ä»¥å¡è¿‡$1e6$åŸºæœ¬ä¸Šæ˜¯ç—´äººè¯´æ¢¦ã€‚æ‰€ä»¥æˆ‘ä»¬æ€è€ƒä¸€ç§æ¸…æ–°è„±ä¿—<del>æˆ‘æ ¹æœ¬æƒ³ä¸å‡ºæ¥</del>çš„åšæ³•ã€‚</p>
<p>çªèŒè€ƒè™‘ç­›å‡ºæ‰€æœ‰çš„$1-n$ç´ æ•°æ¥ï¼Œç„¶åå¯¹äºä¸€ä¸ªç´ æ•°è€Œè¨€ï¼Œç”±äºçªèŒè¦åˆ¤æ–­çš„å¯¹è±¡æ˜¯$n!$ï¼Œä»–æœ‰ä¸€ä¸ªå¥‡å¦™çš„æ€§è´¨å°±æ˜¯<script type="math/tex">n!=\prod \limits_{i=1}^{n}{i}</script>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦åˆ¤æ–­å¯¹äºä¸€ä¸ªå½“å‰ç»™å®šçš„ç´ æ•°$p$ï¼Œåœ¨$1-n$çš„æ‰€æœ‰æ•°é‡Œé¢ï¼Œ$p$ä½œä¸ºå› å­å‡ºç°äº†å¤šå°‘æ¬¡å³å¯ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¿™ä¸ªå¼å­ï¼š</p>
<script type="math/tex; mode=display">
Ans = \prod \limits _{p \in prime }^{p \leq n}{\sum \limits _{i \geq 1}^{p^i \leq n}{\lfloor \frac{n}{p^i}} \rfloor +1}</script><p>æˆ‘ä»¬æ¯æ¬¡éå†ä¸€éï¼Œä¿è¯åªåŠ ä¸€æ¬¡ï¼Œè­¬å¦‚è´¨æ•°$3$ï¼Œä¸‰çš„å€æ•°çš„ä¸ªæ•°äº§ç”Ÿçš„è´¡çŒ®æ˜¯ä¸€ï¼Œä¸‰çš„å¹³æ–¹çš„å€æ•°äº§ç”Ÿçš„è´¡çŒ®æ˜¯äºŒï¼Œä½†æ˜¯æˆ‘ä»¬ä»å‰å¾€åæ‰«çš„è¯ï¼Œæ¯æ¬¡å°±åªè¦å¢é•¿ä¸€ä¸ªè´¡çŒ®å³å¯ï¼ˆç±»ä¼¼äºå»é‡æ“ä½œ$233$ï¼‰</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10000100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Prime[MAXN] ;</span><br><span class="line"><span class="built_in">std</span> :: <span class="built_in">bitset</span> &lt;MAXN&gt; vis ; </span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> N, i, j, cnt, Ans, Cnt[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Ego</span><span class="params">()</span></span>&#123;</span><br><span class="line">	vis[<span class="number">1</span>] = vis[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		<span class="keyword">if</span> (!vis[i]) Prime[++ cnt] = i ;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">			<span class="keyword">if</span> (i * Prime[j] &gt; N) <span class="keyword">break</span> ;</span><br><span class="line">			vis[i * Prime[j]] = <span class="number">1</span> ;</span><br><span class="line">			<span class="keyword">if</span> (!(i % Prime[j])) <span class="keyword">break</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">	    <span class="keyword">for</span> (j = Prime[i] ; j &lt;= N ; j *= Prime[i])</span><br><span class="line">	        ( Cnt[i] += (N / j) ) %= Mod ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">std</span> :: <span class="built_in">cin</span> &gt;&gt; N ; Ans = <span class="number">1l</span>l, Ego() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= cnt ; ++ i) </span><br><span class="line">        (Ans *= (Cnt[i] &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>) %= Mod ;</span><br><span class="line">    <span class="built_in">std</span> :: <span class="built_in">cout</span> &lt;&lt; Ans % Mod &lt;&lt; <span class="built_in">std</span> :: <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/æ‰©å±•æ¬§å‡ é‡Œå¾·</tag>
        <tag>æ•°å­¦/ç´ æ•°/ç´ æ•°ç­›æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘ä¸€ç±»çº¿æ®µæ ‘çš„è½¬ç§»</title>
    <url>/2019/03/17/Segment-Tree1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¥‡å¥‡æ€ªæ€ªçš„çº¿æ®µæ ‘æ•£å‘ç€å¥‡å¥‡æ€ªæ€ªçš„é¦™æ°”ï¼ˆ</p>
<a id="more"></a>
<p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt></p>
<p>æœ€è¿‘å¤§æ¦‚æ˜¯æ³›åšäº†çº¿æ®µæ ‘ç›¸å…³é¢˜ç›®ï¼Œä½†æ˜¯è¿™äº›çº¿æ®µæ ‘å¤§æ¦‚éƒ½éœ€è¦æ¯”è¾ƒå¼ºçš„æ€ç»´å’Œæ¯”è¾ƒé•¿çš„ä»£ç â€¦â€¦$2333$</p>
<h1 id="rm-Task1-å­æ®µå’Œ"><a href="#rm-Task1-å­æ®µå’Œ" class="headerlink" title="$\rm{Task1} $å­æ®µå’Œ"></a>$\rm{Task1} $å­æ®µå’Œ</h1><p>å…¶å®è¿™ä¸ªç®—æ˜¯æ¯”è¾ƒç®€å•çš„äº†ï¼Œæ¯•ç«Ÿ$qyf$æ›¾ç»ç»™æˆ‘ä»¬è®²è¿‡ï¼Œå½“æ—¶æˆ‘å°±è§‰å¾—ååˆ†çš„â€¦â€¦éº»çƒ¦233.</p>
<p>é‚£ä¹ˆä¾‹é¢˜å…¶å®å°±æ˜¯$\rm{SPOJ}$çš„$GSS$ç³»åˆ—â€”â€”çš„å‰ä¸‰é“é¢˜<del>(åå‡ é“é¢˜éƒ½ä¸ä¼šåš)</del></p>
<h2 id="GSS1-åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ-ä¸å¸¦ä¿®"><a href="#GSS1-åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ-ä¸å¸¦ä¿®" class="headerlink" title="$GSS1$åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ(ä¸å¸¦ä¿®)"></a>$GSS1$åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ(ä¸å¸¦ä¿®)</h2><p><a href="https://www.luogu.org/problemnew/show/SP1043" target="_blank" rel="noopener">$\color{violet}{Link}$</a></p>
<p>$2333$åº”è¯¥ç®—æ˜¯æ¯”è¾ƒç®€å•çš„äº†ã€‚æˆ‘ä»¬å¯¹äºæ¯ä¸ªåŒºé—´ç»´æŠ¤ä¸€ä¸ª<strong>åŒºé—´å’Œ</strong>ï¼Œç»´æŠ¤ä¸€ä¸ª<strong>ä»æœ€å·¦ç«¯å¼€å§‹ä¸”å¿…é¡»åŒ…å«æœ€å·¦ç«¯å…ƒç´ çš„æœ€å¤§å­æ®µå’Œ</strong>ï¼Œå†ç»´æŠ¤ä¸€ä¸ª<strong>ä»æœ€å³ç«¯å¼€å§‹ä¸”å¿…é¡»åŒ…å«æœ€å³ç«¯å…ƒç´ çš„æœ€å¤§å­æ®µå’Œ</strong>ï¼Œæœ€åç»´æŠ¤ä¸€ä¸ª<strong>åŒºé—´æœ€å¤§å­æ®µå’Œ</strong>ã€‚</p>
<p>é‚£ä¹ˆè½¬ç§»($push$_$up$)æ—¶å°±æ˜¾å¾—ååˆ†æ–¹ä¾¿ã€‚æˆ‘ä»¬çš„çˆ¶åŒºé—´çš„$Lmax$åªå–å†³äºå·¦å­åŒºé—´çš„$Lmax$å’Œ<strong>å½“å·¦åŒºé—´çš„$Sum$ç­‰äº$Max$æ—¶ï¼ˆå³å·¦åŒºé—´å…¨éƒ¨éƒ½è¦çº³å…¥åˆ°å…¶æœ€å¤§å­æ®µå’Œä¸­æ—¶ï¼‰</strong>ï¼Œå·¦åŒºé—´çš„$Sum$ä¸å³åŒºé—´çš„$Lmax$çš„å’Œã€‚é‚£ä¹ˆå¯¹äºåŒºé—´çš„$Rsum$ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé“ç†ã€‚æœ€ç»ˆå¯¹äºè¯¥åŒºé—´çš„æœ€å¤§å­æ®µå’Œï¼Œæˆ‘ä»¬<strong>ä¸è€ƒè™‘</strong>ä»å·²ç»è½¬ç§»æ¥çš„$Lmax/Rmax$ï¼Œè€Œæ˜¯è€ƒè™‘ä»å·¦å³åŒºé—´çš„$Max$ä»¥åŠå·¦å³åŒºé—´çš„å’Œæ¥è½¬ç§»ã€‚å¤§ä½“ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_u</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">	S(rt) = S(ls(rt)) + S(rs(rt)) ;</span><br><span class="line">	Lsum(rt) = max(Lsum(ls(rt)), S(ls(rt)) + Lsum(rs(rt))) ;</span><br><span class="line">	Rsum(rt) = max(Rsum(rs(rt)), S(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">	Sum(rt) = max(max(Sum(ls(rt)), Sum(rs(rt))), Lsum(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹ï¼šåœ¨è¯¢é—®çš„æ—¶å€™ï¼Œå®ƒæ¯”è¾ƒè†ˆåº”â€¦â€¦å°±æ˜¯ç”±äºæ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥ä½ ä¸èƒ½ç›´æ¥åƒæ™®é€šçš„çº¿æ®µæ ‘ä¸€æ ·è¯¢é—®ç„¶ååŠ èµ·æ¥â€¦â€¦æ‰€ä»¥æ‰€å°±è¦ç±»ä¼¼äºè¾¹è¯¢é—®ï¼Œè¾¹$push_up$è¿™ç§æ„Ÿè§‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">Tree <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> T[rt] ; </span><br><span class="line">	Tree res, A, B ;</span><br><span class="line">	<span class="keyword">if</span> (mid &gt;= R) <span class="keyword">return</span> query(ls(rt), l, mid) ;</span><br><span class="line">	<span class="keyword">if</span> (mid &lt; L) <span class="keyword">return</span> query(rs(rt), mid + <span class="number">1</span>, r) ; </span><br><span class="line">	A = query(ls(rt), l, mid), B = query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">	res.Lsum = max(A.Lsum, A.S + B.Lsum) ; res.Rsum = max(B.Rsum, B.S + A.Rsum) ;</span><br><span class="line">	res.Sum = max(max(A.Sum, B.Sum), A.Rsum + B.Lsum) ; res.S = A.S + B.S ; <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ€»ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 200010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max my_Fuckmax</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls(rt) rt &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs(rt) rt &lt;&lt; 1 | 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>  mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">	LL S, Sum, Lsum, Rsum ;</span><br><span class="line">&#125;T[MAXN &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> N, M, L, R, base[MAXN] ; </span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> S(x) T[x].S</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Sum(x) T[x].Sum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Lsum(x) T[x].Lsum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Rsum(x) T[x].Rsum</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">my_Fuckmax</span><span class="params">(LL A, LL B)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> A &amp; ((B - A) &gt;&gt; <span class="number">63</span>) | B &amp; ((~(B - A)) &gt;&gt; <span class="number">63</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_u</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">	S(rt) = S(ls(rt)) + S(rs(rt)) ;</span><br><span class="line">	Lsum(rt) = max(Lsum(ls(rt)), S(ls(rt)) + Lsum(rs(rt))) ;</span><br><span class="line">	Rsum(rt) = max(Rsum(rs(rt)), S(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">	Sum(rt) = max(max(Sum(ls(rt)), Sum(rs(rt))), Lsum(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">		T[rt].Lsum = T[rt].Rsum = </span><br><span class="line">		T[rt].S = T[rt].Sum = base[l] ; <span class="keyword">return</span>  ;</span><br><span class="line">	&#125; build(ls(rt), l, mid), build(rs(rt), mid + <span class="number">1</span>, r), P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Tree <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) </span><br><span class="line">		<span class="keyword">return</span> T[rt] ; </span><br><span class="line">	Tree res, A, B ;</span><br><span class="line">	<span class="keyword">if</span> (mid &gt;= R) <span class="keyword">return</span> query(ls(rt), l, mid) ;</span><br><span class="line">	<span class="keyword">if</span> (mid &lt; L) <span class="keyword">return</span> query(rs(rt), mid + <span class="number">1</span>, r) ; </span><br><span class="line">	A = query(ls(rt), l, mid), B = query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">	res.Lsum = max(A.Lsum, A.S + B.Lsum) ; res.Rsum = max(B.Rsum, B.S + A.Rsum) ;</span><br><span class="line">	res.Sum = max(max(A.Sum, B.Sum), A.Rsum + B.Lsum) ; res.S = A.S + B.S ; <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">register</span> <span class="keyword">int</span> i ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; build(<span class="number">1</span>, <span class="number">1</span>, N) ; <span class="built_in">cin</span> &gt;&gt; M ;</span><br><span class="line">	<span class="keyword">while</span> (M --) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;L, &amp;R), <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, query(<span class="number">1</span>, <span class="number">1</span>, N).Sum) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="GSS3-åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ-å¸¦ä¿®"><a href="#GSS3-åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ-å¸¦ä¿®" class="headerlink" title="$GSS3$ åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ(å¸¦ä¿®)"></a>$GSS3$ åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ(å¸¦ä¿®)</h2><p><a href="https://www.luogu.org/problemnew/show/SP1716" target="_blank" rel="noopener">$\color{violet}{Link}$</a></p>
<p>â€¦â€¦å…¶å®å§ï¼Œè¿™ä¸ªå¸¦ä¿®ä¸å¸¦ä¿®â€¦â€¦å¥½åƒå½±å“å¹¶ä¸å¤§ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 200010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max my_Fuckmax</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls(rt) rt &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs(rt) rt &lt;&lt; 1 | 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>  mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">bool</span> MArk ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">	LL S, Sum, Lsum, Rsum ;</span><br><span class="line">&#125;T[MAXN &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> N, M, L, R, base[MAXN] ; </span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> S(x) T[x].S</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Sum(x) T[x].Sum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Lsum(x) T[x].Lsum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Rsum(x) T[x].Rsum</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">my_Fuckmax</span><span class="params">(LL A, LL B)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> A &amp; ((B - A) &gt;&gt; <span class="number">63</span>) | B &amp; ((~(B - A)) &gt;&gt; <span class="number">63</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_u</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">	S(rt) = S(ls(rt)) + S(rs(rt)) ;</span><br><span class="line">	Lsum(rt) = max(Lsum(ls(rt)), S(ls(rt)) + Lsum(rs(rt))) ;</span><br><span class="line">	Rsum(rt) = max(Rsum(rs(rt)), S(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">	Sum(rt) = max(max(Sum(ls(rt)), Sum(rs(rt))), Lsum(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">		T[rt].Lsum = T[rt].Rsum = </span><br><span class="line">		T[rt].S = T[rt].Sum = base[l] ; <span class="keyword">return</span>  ;</span><br><span class="line">	&#125; build(ls(rt), l, mid), build(rs(rt), mid + <span class="number">1</span>, r), P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Tree <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) </span><br><span class="line">		<span class="keyword">return</span> T[rt] ; </span><br><span class="line">	Tree res, A, B ;</span><br><span class="line">	<span class="keyword">if</span> (mid &gt;= R) <span class="keyword">return</span> query(ls(rt), l, mid) ;</span><br><span class="line">	<span class="keyword">if</span> (mid &lt; L) <span class="keyword">return</span> query(rs(rt), mid + <span class="number">1</span>, r) ; </span><br><span class="line">	A = query(ls(rt), l, mid), B = query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">	res.Lsum = max(A.Lsum, A.S + B.Lsum) ; res.Rsum = max(B.Rsum, B.S + A.Rsum) ;</span><br><span class="line">	res.Sum = max(max(A.Sum, B.Sum), A.Rsum + B.Lsum) ; res.S = A.S + B.S ; <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L == l &amp;&amp; L == r)&#123;</span><br><span class="line">		T[rt].Sum = T[rt].Lsum = T[rt].Rsum = T[rt].S = k ; <span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= mid) change(ls(rt), l, mid, k) ;</span><br><span class="line">	<span class="keyword">else</span> change(rs(rt), mid + <span class="number">1</span>, r, k ) ; P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">register</span> <span class="keyword">int</span> i ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; build(<span class="number">1</span>, <span class="number">1</span>, N) ; <span class="built_in">cin</span> &gt;&gt; M ;</span><br><span class="line">	<span class="keyword">while</span> (M --) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;MArk, &amp;L, &amp;R) ;</span><br><span class="line">		<span class="keyword">if</span> (!MArk) change(<span class="number">1</span>, <span class="number">1</span>, N, R) ;</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, query(<span class="number">1</span>, <span class="number">1</span>, N).Sum) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="GSS4-åŒºé—´å¼€æ ¹é—®é¢˜"><a href="#GSS4-åŒºé—´å¼€æ ¹é—®é¢˜" class="headerlink" title="$GSS4$ åŒºé—´å¼€æ ¹é—®é¢˜"></a>$GSS4$ åŒºé—´å¼€æ ¹é—®é¢˜</h2><p><a href="https://www.luogu.org/problemnew/show/SP2713" target="_blank" rel="noopener">$\color{violet}{Link}$</a></p>
<p>è¿™ä¸ªå’Œå­æ®µå’Œä¸€ç‚¹å„¿å…³ç³»éƒ½æ²¡æœ‰ï¼Œé¡ºä¾¿æ•´ä¸€ä¸‹233.</p>
<p>å°±æ˜¯è®©ä½ åŒºé—´å¼€æ ¹ï¼ˆå‘ä¸‹å–æ•´ï¼‰+æŸ¥è¯¢â€¦â€¦è¿™ä¸ªä¸œè¥¿å¤§æ¦‚å°±æ˜¯å¯¹äºä¸€ä¸ª$2^{63}$å†…çš„æ•°å€¼$N$ï¼Œæˆ‘ä»¬å‡è®¾å…¶å¼€æ ¹$k$æ¬¡å¯ä»¥å¾—åˆ°$N &lt; 2$â€”â€”åªè¦$N &lt; 2$ä¹‹åçš„è®¡ç®—å°±ä¼šé›†ä¸­åœ¨ä¸€ä¸ªç´§ç¡®çš„èŒƒå›´$(1,2)$å†…ï¼Œå‘ä¸‹å–æ•´ä¹‹åæ°¸è¿œéƒ½ä¼šæ˜¯$1$ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦å†å»è€ƒè™‘ã€‚</p>
<p>é‚£ä¹ˆç°åœ¨ï¼Œæˆ‘ä»¬è‡´åŠ›äºå»ç¡®å®š$k$çš„å€¼åŸŸã€‚æˆ‘ä»¬ä¸å¾—ä¸æ‰¿è®¤ï¼Œ$\sqrt n$åœ¨$[0,+\infty]$æ˜¯å•è°ƒé€’å¢çš„ï¼ŒåŒç†ä¸‰æ¬¡æ–¹æ ¹ä¹Ÿæ˜¯ï¼Œå››æ¬¡æ–¹æ ¹ä¹Ÿæ˜¯â€¦â€¦æ‰€ä»¥æˆ‘ä»¬ä¸å¦¨å–æœ€å¤§å€¼ï¼Œè€ƒè™‘$N=2^{63}$æ—¶ï¼Œ$k$å€¼çš„å¤§å°ã€‚è€Œå¾ˆæ˜¾ç„¶ï¼Œæ­¤æ—¶çš„$k$åº”è¯¥ä¸º$\log _263+1 â‰ˆ 6.978$â€”â€”è¿™ä¼¼ä¹æ˜¯ååˆ†å¹³å‡¡çš„ç»“è®ºã€‚</p>
<p>æ€»ä¹‹ï¼Œæˆ‘ä»¬å¾—å‡ºï¼Œä¼¼ä¹è¿ç®—æ¬¡æ•°çš„ä¸Šç•Œå°±æ˜¯$kâ‰ˆ7$ï¼Œæ‰€ä»¥è¯´æˆ‘ä»¬ç›´æ¥æš´åŠ›é™¤å°±å¥½äº†ï¼Œèšåˆåˆ†æä¸€ä¸‹ï¼Œå¤æ‚åº¦çš„ä¸Šç•Œä¼¼ä¹æ˜¯$\Omega(7n)$çš„æ ·å­ï¼Œæ— éå°±æ˜¯å¤šå‡ ä¸ªå¸¸æ•°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">ll N, M, K, i, L, R ; </span><br><span class="line">ll base[MAXN], T[MAXN], tot ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">p_u</span><span class="params">(ll rt)</span></span>&#123; ;&#125;</span><br><span class="line"><span class="keyword">void</span> _Build(ll rt, ll l, ll r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)&#123;T[rt] = base[l] ; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    _Build(ls(rt), l, mid) ;</span><br><span class="line">    _Build(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">    T[rt] = T[ls(rt)] + T[rs(rt)] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> ll _query(ll rt, ll l, ll r, ll sl, ll sr)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= sl &amp;&amp; r &lt;= sr) <span class="keyword">return</span> T[rt] ;</span><br><span class="line">    ll ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (mid &gt;= sl) ret += _query(ls(rt), l, mid, sl, sr) ;</span><br><span class="line">    <span class="keyword">if</span> (mid &lt; sr) ret += _query(rs(rt), mid + <span class="number">1</span>, r, sl, sr) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Sqrt(ll rt, ll l, ll r, ll sl, ll sr)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= sl &amp;&amp; r &lt;= sr)&#123;</span><br><span class="line">        <span class="keyword">if</span> (T[rt] &lt;= (r - l + <span class="number">1</span>)) <span class="keyword">return</span> ; </span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">                T[rt] = (<span class="keyword">int</span>)(<span class="built_in">pow</span>((<span class="keyword">double</span>)T[rt], <span class="number">0.5</span>)) ;</span><br><span class="line">            	<span class="keyword">return</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (mid &gt;= sl) _Sqrt(ls(rt), l, mid, sl, sr), </span><br><span class="line">				   T[rt] = T[ls(rt)] + T[rs(rt)] ;</span><br><span class="line">    <span class="keyword">if</span> (mid &lt; sr) _Sqrt(rs(rt), mid + <span class="number">1</span>, r, sl, sr), </span><br><span class="line">				   T[rt] = T[ls(rt)] + T[rs(rt)] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; N)&#123;</span><br><span class="line">    	++ tot, <span class="built_in">printf</span>(<span class="string">"Case #%d:\n"</span>, tot) ;</span><br><span class="line">    	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= N ; ++ i) base[i] = qr() ;</span><br><span class="line">    	_Build(<span class="number">1</span>, <span class="number">1</span>, N) ; <span class="built_in">cin</span> &gt;&gt; M ;</span><br><span class="line">    	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= M ; ++ i)&#123;</span><br><span class="line">    	    K = qr(), L = qr(), R = qr() ;</span><br><span class="line">    	    <span class="keyword">if</span> (L &gt; R) swap(L, R) ;</span><br><span class="line">   		    <span class="keyword">if</span> (K)&#123;</span><br><span class="line">    	        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, _query(<span class="number">1</span>, <span class="number">1</span>, N, L, R)) ;</span><br><span class="line">    	        <span class="keyword">continue</span> ;</span><br><span class="line">    	    &#125;</span><br><span class="line">    	    _Sqrt(<span class="number">1</span>, <span class="number">1</span>, N, L, R) ;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">"\n"</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-Task2-æœ€é•¿è¿ç»­é—®é¢˜"><a href="#rm-Task2-æœ€é•¿è¿ç»­é—®é¢˜" class="headerlink" title="$\rm{Task2}$ æœ€é•¿è¿ç»­é—®é¢˜"></a>$\rm{Task2}$ æœ€é•¿è¿ç»­é—®é¢˜</h1><p>è¿™ä¸ªä¸œè¥¿å…¶å®åº”è¯¥è·Ÿæœ€å¤§å­æ®µå’Œå·®ä¸å¤šâ€”â€”è¦æ±‚çš„éƒ½æ˜¯è¿ç»­çš„ä¸œè¥¿ã€‚å¯¹äºæ‰€æœ‰åŒ…æ‹¬<strong>è¿ç»­</strong>å­—æ ·çš„ä¸œè¥¿ï¼ŒåŸºæœ¬çš„æ€è·¯å¤§æ¦‚éƒ½æ˜¯ç»´æŠ¤ä¸€ä¸ªä»å·¦ç«¯å¼€å§‹çš„ï¼Œç»´æŠ¤ä¸€ä¸ªä»å³ç«¯å¼€å§‹çš„ï¼Œç„¶åä»ä¸‹å‘ä¸Šä¸æ–­$push_up$å³å¯ã€‚</p>
<p>$emmm$åœ¨è¿™è¾¹æ•´ç†å‡ é“æ€è·¯ä¸é”™çš„é¢˜å§ï¼š</p>
<h2 id="rm-USACO-é…’åº—-hotel"><a href="#rm-USACO-é…’åº—-hotel" class="headerlink" title="$\rm{USACO}$ é…’åº—($hotel$)"></a>$\rm{USACO}$ é…’åº—($hotel$)</h2><p><a href="https://www.luogu.org/problemnew/show/P2894" target="_blank" rel="noopener">$\color{violet}{Link}$</a></p>
<p>åˆå§‹çš„ä¸€ä¸ªå…¨é›¶çš„åºåˆ—ï¼Œæˆ‘ä»¬å¯¹å®ƒå‡†ç¡®æ¥è¯´æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ“ä½œï¼š</p>
<ul>
<li>åŒºé—´ç½®$0$</li>
<li>åŒºé—´ç½®$1$</li>
<li>è¯¢é—®æ˜¯å¦æœ‰ä¸€æ®µé•¿åº¦ä¸º$k$çš„è¿ç»­çš„é›¶åŒºé—´ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œé€‰å–æœ€é å·¦çš„ï¼Œè¾“å‡ºå…¶å·¦ç«¯ç‚¹å¹¶æ‰§è¡Œæ“ä½œâ‘¡</li>
</ul>
<hr>
<p>è¿™ä¸ªé¢˜åœ¨æˆ‘çœ‹æ¥ï¼Œåº”è¯¥ç®—æ˜¯ä¸€ä¸ªæ€ç»´é¢˜ã€‚å¯¹äºæœ€åä¸€ä¸ªæ“ä½œï¼Œæˆ‘ååˆ†åœ°æ‡µé€¼â€”â€”å› ä¸ºæˆ‘å‹æ ¹ä¸çŸ¥é“è¯¥æ€ä¹ˆç»´æŠ¤ã€‚</p>
<p>ä½†äº‹å®ä¸Šâ€¦â€¦è¿™å°±æ˜¯å­¦æ•°æ®ç»“æ„å­¦å‚»äº†çš„åæœâ€¦â€¦æ¯•ç«Ÿæ•°æ®ç»“æ„åªä¼šæ˜¯ä¸€ä¸ªè¾…åŠ©è€Œå·²ã€‚ä»”ç»†æƒ³æ¥ï¼Œå¥½åƒé™¤äº†æƒå€¼çº¿æ®µæ ‘èƒ½å¤Ÿç»´æŠ¤$\rm{DP}$ä¹‹å¤–ï¼Œæ²¡åšè¿‡ä»€ä¹ˆæ•°æ®ç»“æ„çš„å¥½é¢˜ï¼Œéƒ½æ˜¯ä¸€äº›æ•°æ®ç»“æ„çš„è£¸é¢˜â€¦â€¦å¤§æ¦‚è¿™å°±æ˜¯å­¦å‚»äº†å§ï¼Œåªä¼šä¸“ä¸€çš„ä¸€é—¨å­¦ç§‘ï¼Œæˆ–è€…è¯´åªä¼šä¸“ç²¾ä¸€ç§ä¸œè¥¿â€”â€”è¿˜æ˜¯ååˆ†è ¢ç¬¨è¿Ÿé’åœ°â€œä¸“ç²¾â€ã€‚</p>
<p>å”‰ï¼Œå¤§æ¦‚æ£€éªŒä¸€ä¸ªäººå­¦æ²¡å­¦è¿‡æ•°æ®ç»“æ„ï¼Œä¸æ˜¯é€šè¿‡ä»–ä¼šä¸ä¼šåšç±»ä¼¼äº$NOI2005$ç»´æŠ¤æ•°åˆ—é‚£æ ·çš„æ¯’ç˜¤è£¸é¢˜ï¼Œè€Œæ˜¯çœ‹ä»–åˆ°åº•å¯ä¸å¯ä»¥å’Œå…¶ä»–çš„ä¸œè¥¿ç»“åˆåœ¨ä¸€èµ·ã€‚å­¦ä¹ å¤§æŠµä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œä¸å¯ä»¥æŠŠå­¦çš„ä¸œè¥¿è¿ç§»åˆ°å…¶ä»–åœ°æ–¹ï¼Œç…§æ ·æ˜¯ç™½å­¦å§ã€‚</p>
<p>è¯¶ï¼Œå¥½åƒæ‰¯äº†ä»€ä¹ˆå¥‡æ€ªçš„ä¸œè¥¿â€¦â€¦</p>
<p>å›åˆ°æ­£é¢˜ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘ç›´æ¥ç»´æŠ¤è¿™ä¸ªä¸œè¥¿ï¼Œè€Œæ˜¯<strong>é€šè¿‡ç»´æŠ¤åŒºé—´å†…çš„æœ€é•¿è¿ç»­$0$çš„ä¸ªæ•°ï¼Œè¾¾åˆ°è¾…åŠ©æŸ¥æ‰¾åŒºé—´çš„ç›®çš„</strong>ã€‚é‚£ä¹ˆæˆ‘ä»¬æŸ¥æ‰¾åŒºé—´çš„æ—¶å€™ï¼Œå°±ç›´æ¥**æ‹©æœ€å·¦è¾¹çš„åŒºé—´ä¼˜å…ˆï¼Œå¹¶$check$å…¶æ˜¯å¦æœ‰è¶³å¤Ÿçš„$0$ã€‚</p>
<p>å¯¹äºæŸ¥è¯¢ï¼Œæˆ‘ä»¬å…ˆæŸ¥è¯¢å·¦åŒºé—´ï¼Œå†æŸ¥è¯¢ä¸­é—´ï¼ˆå·¦åŒºé—´çš„å³è¾¹ä¸å³åŒºé—´çš„å¹¶é›†ï¼‰ï¼Œæœ€åæŸ¥è¯¢å³åŒºé—´ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> Sum, Len, Lsum, Rsum, tag ; </span><br><span class="line">&#125;T[MAXN &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> A, B, N, M, MArk, i, t ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (T[rt].tag == <span class="number">-1</span>) <span class="keyword">return</span> ;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (T[rt].tag == <span class="number">0</span>)&#123;</span><br><span class="line">		T[ls(rt)].tag = T[rs(rt)].tag = <span class="number">0</span> ;</span><br><span class="line">		T[ls(rt)].Lsum = T[ls(rt)].Sum = T[ls(rt)].Rsum = <span class="number">0</span> ;</span><br><span class="line">		T[rs(rt)].Lsum = T[rs(rt)].Sum = T[rs(rt)].Rsum = <span class="number">0</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		T[ls(rt)].tag = T[rs(rt)].tag = <span class="number">1</span> ;</span><br><span class="line">		T[ls(rt)].Lsum = T[ls(rt)].Sum = T[ls(rt)].Rsum = T[ls(rt)].Len ;</span><br><span class="line">		T[rs(rt)].Lsum = T[rs(rt)].Sum = T[rs(rt)].Rsum = T[rs(rt)].Len ;	</span><br><span class="line">	&#125;</span><br><span class="line">	T[rt].tag = <span class="number">-1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (T[ls(rt)].Sum == T[ls(rt)].Len) </span><br><span class="line">		T[rt].Lsum = T[ls(rt)].Len + T[rs(rt)].Lsum ;</span><br><span class="line">	<span class="keyword">else</span> T[rt].Lsum = T[ls(rt)].Lsum ;</span><br><span class="line">	<span class="keyword">if</span> (T[rs(rt)].Sum == T[rs(rt)].Len) </span><br><span class="line">		T[rt].Rsum = T[rs(rt)].Len + T[ls(rt)].Rsum ;</span><br><span class="line">	<span class="keyword">else</span> T[rt].Rsum = T[rs(rt)].Rsum ;</span><br><span class="line">	T[rt].Sum = max(T[ls(rt)].Sum, T[rs(rt)].Sum), </span><br><span class="line">	T[rt].Sum = max(T[rt].Sum, T[ls(rt)].Rsum + T[rs(rt)].Lsum) ;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	T[rt].tag = <span class="number">-1</span>,</span><br><span class="line">	T[rt].Len = T[rt].Lsum = </span><br><span class="line">	T[rt].Rsum = T[rt].Sum = r - l + <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">if</span> (l == r)&#123; <span class="keyword">return</span> ; &#125;</span><br><span class="line">	build(ls(rt), l, mid), build(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (ul &lt;= l &amp;&amp; ur &gt;= r)&#123;</span><br><span class="line">		T[rt].tag = k ;</span><br><span class="line">		<span class="keyword">if</span> (k == <span class="number">0</span>) T[rt].Lsum = T[rt].Rsum = T[rt].Sum = <span class="number">0</span> ;</span><br><span class="line">		<span class="keyword">else</span> T[rt].Lsum = T[rt].Rsum = T[rt].Sum = T[rt].Len ;</span><br><span class="line">		<span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	push_down(rt) ;</span><br><span class="line">	<span class="keyword">if</span> (ul &lt;= mid) update(ls(rt), l, mid, ul, ur, k) ;</span><br><span class="line">	<span class="keyword">if</span> (ur &gt; mid) update(rs(rt), mid + <span class="number">1</span>, r, ul, ur, k) ;</span><br><span class="line">	push_up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	push_down(rt) ;</span><br><span class="line">	<span class="keyword">if</span> (l == r) <span class="keyword">return</span> l ;</span><br><span class="line">	<span class="keyword">if</span> (T[ls(rt)].Sum &gt;= A) <span class="keyword">return</span> query(ls(rt), l, mid) ;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (T[ls(rt)].Rsum + T[rs(rt)].Lsum &gt;= A) <span class="keyword">return</span> mid - T[ls(rt)].Rsum + <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">return</span> query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">	build(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line">	<span class="keyword">while</span>(M --)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;MArk) ;</span><br><span class="line">		<span class="keyword">if</span> (MArk == <span class="number">2</span>)  <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B), update(<span class="number">1</span>, <span class="number">1</span>, N, A, A + B - <span class="number">1</span>, <span class="number">1</span>) ;	</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;A) ;</span><br><span class="line">			<span class="keyword">if</span> (T[<span class="number">1</span>].Sum &gt;= A)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, t = query(<span class="number">1</span>, <span class="number">1</span>, N)), update(<span class="number">1</span>, <span class="number">1</span>, N, t, t + A - <span class="number">1</span>, <span class="number">0</span>)  ;</span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">				<span class="built_in">putchar</span>(<span class="string">'0'</span>), <span class="built_in">putchar</span>(<span class="string">'\n'</span>) ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;  <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$emmm$è¿™ä¸ªé¢˜ç é‡å…¶å®ä¸å¤§ï¼Œæ€ç»´å«é‡ä¹Ÿä¸é«˜ï¼Œä½†æ˜¯æˆåŠŸåœ°æŠŠåšæ•°æ®ç»“æ„é¢˜åšå‚»äº†çš„æˆ‘æ‹‰å›äº†æ­£é€”ã€‚</p>
<h2 id="rm-SCOI-åºåˆ—æ“ä½œ"><a href="#rm-SCOI-åºåˆ—æ“ä½œ" class="headerlink" title="$\rm{SCOI}$ åºåˆ—æ“ä½œ"></a>$\rm{SCOI}$ åºåˆ—æ“ä½œ</h2><p><a href="https://www.luogu.org/problemnew/show/P2572" target="_blank" rel="noopener">$\color{violet}{Link}$</a></p>
<p>å¯¹äºä¸€ä¸ª$01$åºåˆ—ï¼Œå¤§ä½“æ˜¯è¿™å‡ ç§æ“ä½œï¼š</p>
<ul>
<li>åŒºé—´æ¸…é›¶</li>
<li>åŒºé—´ç½®ä¸º$1$</li>
<li>åŒºé—´å…¨éƒ¨å–é</li>
<li>åŒºé—´æŸ¥è¯¢$1$çš„ä¸ªæ•°</li>
<li>åŒºé—´æŸ¥è¯¢æœ€é•¿è¿ç»­çš„$1$çš„é•¿åº¦</li>
</ul>
<p>å¥½çš„ï¼Œè¿™é“é¢˜è¢«æˆ‘ç§’äº†ï¼Œçˆ½å•Šâ€¦â€¦ä¸è¿‡ç§’æ˜¯ç§’äº†ï¼Œå¯¹æ‹è°ƒè¯•æ³•è°ƒäº†å¥½ä¹…$233$ã€‚</p>
<p>å…¶å®å¯¹äº$1,2,4,5$éƒ½å¥½è¯´ï¼Œåªæ˜¯ç¬¬$3$ä¸ªæ“ä½œï¼Œéœ€è¦å†å¦ç»´æŠ¤åŒºé—´æœ€é•¿è¿ç»­çš„$0$çš„é•¿åº¦ï¼Œå¦‚æœå­˜åœ¨å–éæ ‡è®°ç”Ÿæ•ˆï¼Œå°±äº¤æ¢ä¸€ä¸‹å°±è¡Œã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> OS, OL, OR ;</span><br><span class="line">	<span class="keyword">int</span> Sum, Lsum, Len, Rsum, S, tag, t ;</span><br><span class="line">	<span class="comment">//tag = 1 -&gt; 1,tag = 0 -&gt; 0, tag = 2 -&gt; xor</span></span><br><span class="line">&#125;T[MAX &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> N, M, MArk, L, R, base[MAX], i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;<span class="comment">//</span></span><br><span class="line">	T[rt].S = T[ls(rt)].S + T[rs(rt)].S ;</span><br><span class="line">	<span class="comment">//1</span></span><br><span class="line">	<span class="keyword">if</span> (T[ls(rt)].S == T[ls(rt)].Len) </span><br><span class="line">		  T[rt].Lsum = max(T[ls(rt)].Lsum, T[ls(rt)].Len + T[rs(rt)].Lsum) ;</span><br><span class="line">	<span class="keyword">else</span>  T[rt].Lsum = T[ls(rt)].Lsum ;</span><br><span class="line">	<span class="keyword">if</span> (T[rs(rt)].S == T[rs(rt)].Len) </span><br><span class="line">		  T[rt].Rsum = max(T[rs(rt)].Rsum, T[rs(rt)].Len + T[ls(rt)].Rsum) ;</span><br><span class="line">	<span class="keyword">else</span>  T[rt].Rsum = T[rs(rt)].Rsum ;</span><br><span class="line">	T[rt].Sum = max(T[ls(rt)].Rsum + T[rs(rt)].Lsum, max(T[ls(rt)].Sum, T[rs(rt)].Sum)) ;</span><br><span class="line">	<span class="comment">//0</span></span><br><span class="line">	<span class="keyword">if</span> (!T[ls(rt)].S) </span><br><span class="line">		  T[rt].OL = max(T[ls(rt)].OL, T[ls(rt)].Len + T[rs(rt)].OL) ;</span><br><span class="line">	<span class="keyword">else</span>  T[rt].OL = T[ls(rt)].OL ;</span><br><span class="line">	<span class="keyword">if</span> (!T[rs(rt)].S) </span><br><span class="line">		  T[rt].OR = max(T[rs(rt)].OR, T[rs(rt)].Len + T[ls(rt)].OR) ;</span><br><span class="line">	<span class="keyword">else</span>  T[rt].OR = T[rs(rt)].OR ;</span><br><span class="line">	T[rt].OS = max(T[ls(rt)].OR + T[rs(rt)].OL, max(T[ls(rt)].OS, T[rs(rt)].OS)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">down</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;<span class="comment">//</span></span><br><span class="line">	<span class="keyword">if</span> (T[rt].tag == <span class="number">-1</span>) <span class="keyword">return</span> ;</span><br><span class="line">	<span class="keyword">if</span> (T[rt].t == <span class="number">1</span>)&#123;</span><br><span class="line">		T[ls(rt)].tag ^= <span class="number">1</span>, T[rs(rt)].tag ^= <span class="number">1</span> ;</span><br><span class="line">		T[ls(rt)].S = T[ls(rt)].Len - T[ls(rt)].S ;</span><br><span class="line">		T[rs(rt)].S = T[rs(rt)].Len - T[rs(rt)].S ;</span><br><span class="line">		<span class="comment">//l</span></span><br><span class="line">		T[ls(rt)].Sum ^= T[ls(rt)].OS ^= T[ls(rt)].Sum ^= T[ls(rt)].OS ;</span><br><span class="line">		T[ls(rt)].Lsum ^= T[ls(rt)].OL ^= T[ls(rt)].Lsum ^= T[ls(rt)].OL ;</span><br><span class="line">		T[ls(rt)].Rsum ^= T[ls(rt)].OR ^= T[ls(rt)].Rsum ^= T[ls(rt)].OR ;</span><br><span class="line">		<span class="comment">//r</span></span><br><span class="line">		T[rs(rt)].Sum ^= T[rs(rt)].OS ^= T[rs(rt)].Sum ^= T[rs(rt)].OS ;</span><br><span class="line">		T[rs(rt)].Lsum ^= T[rs(rt)].OL ^= T[rs(rt)].Lsum ^= T[rs(rt)].OL ;</span><br><span class="line">		T[rs(rt)].Rsum ^= T[rs(rt)].OR ^= T[rs(rt)].Rsum ^= T[rs(rt)].OR ;	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (T[rt].tag == <span class="number">0</span>)&#123;</span><br><span class="line">		T[ls(rt)].tag = T[rs(rt)].tag = <span class="number">0</span> ;</span><br><span class="line">		T[ls(rt)].OL = T[ls(rt)].OR = T[ls(rt)].OS = T[ls(rt)].Len ;</span><br><span class="line">		T[rs(rt)].OL = T[rs(rt)].OR = T[rs(rt)].OS = T[rs(rt)].Len ;</span><br><span class="line">		T[ls(rt)].Lsum = T[ls(rt)].Rsum = T[ls(rt)].Sum = T[ls(rt)].S = <span class="number">0</span> ;</span><br><span class="line">		T[rs(rt)].Lsum = T[rs(rt)].Rsum = T[rs(rt)].Sum = T[rs(rt)].S = <span class="number">0</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (T[rt].tag == <span class="number">1</span>)&#123;</span><br><span class="line">		T[ls(rt)].tag = T[rs(rt)].tag = <span class="number">1</span> ;</span><br><span class="line">		T[ls(rt)].OL = T[ls(rt)].OR = T[ls(rt)].OS = <span class="number">0</span> ;</span><br><span class="line">		T[rs(rt)].OL = T[rs(rt)].OR = T[rs(rt)].OS = <span class="number">0</span> ;</span><br><span class="line">		T[ls(rt)].Lsum = T[ls(rt)].Rsum = T[ls(rt)].Sum = T[ls(rt)].S = T[ls(rt)].Len ;</span><br><span class="line">		T[rs(rt)].Lsum = T[rs(rt)].Rsum = T[rs(rt)].Sum = T[rs(rt)].S = T[rs(rt)].Len ;</span><br><span class="line">	&#125;</span><br><span class="line">	T[rt].tag = <span class="number">-1</span>, T[rt].t = <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _change(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)&#123;<span class="comment">//</span></span><br><span class="line">	<span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">		T[rt].tag = k ;</span><br><span class="line">		<span class="keyword">if</span> (!k)	</span><br><span class="line">			T[rt].OL = T[rt].OR = T[rt].OS = T[rt].Len, </span><br><span class="line">			T[rt].Lsum = T[rt].Rsum = T[rt].Sum = T[rt].S = <span class="number">0</span> ;</span><br><span class="line">		<span class="keyword">else</span>  T[rt].OL = T[rt].OR = T[rt].OS = <span class="number">0</span>, </span><br><span class="line">			  T[rt].Lsum = T[rt].Rsum = T[rt].Sum = T[rt].S = T[rt].Len ;</span><br><span class="line">		<span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	down(rt) ;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= mid) _change(ls(rt), l, mid, k) ;</span><br><span class="line">	<span class="keyword">if</span> (R &gt; mid) _change(rs(rt), mid + <span class="number">1</span>, r, k) ;</span><br><span class="line">	up(rt) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _reverse(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;<span class="comment">//</span></span><br><span class="line">	<span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">		T[rt].t = <span class="number">1</span> ;</span><br><span class="line">		T[rt].Sum ^= T[rt].OS ^= T[rt].Sum ^= T[rt].OS ;</span><br><span class="line">		T[rt].Lsum ^= T[rt].OL ^= T[rt].Lsum ^= T[rt].OL ;</span><br><span class="line">		T[rt].Rsum ^= T[rt].OR ^= T[rt].Rsum ^= T[rt].OR ;	</span><br><span class="line">		<span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	down(rt) ;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= mid) _reverse(ls(rt), l, mid) ;</span><br><span class="line">	<span class="keyword">if</span> (R &gt; mid) _reverse(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">	up(rt) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Sum</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;<span class="comment">//</span></span><br><span class="line">	<span class="keyword">if</span> (L &lt;= l &amp;&amp; R &gt;= r) <span class="keyword">return</span> T[rt].S ;</span><br><span class="line">	down(rt) ; <span class="keyword">int</span> res = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= mid) res += Sum(ls(rt), l, mid) ;</span><br><span class="line">	<span class="keyword">if</span> (R &gt; mid) res += Sum(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">	<span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;<span class="comment">//</span></span><br><span class="line">	T[rt].tag = <span class="number">-1</span> ;</span><br><span class="line">	T[rt].Len = r - l + <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">		<span class="keyword">if</span> (!base[l]) T[rt].OL = T[rt].OR = T[rt].OS = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">else</span>  T[rt].Sum = T[rt].Lsum = T[rt].Rsum = T[rt].S = <span class="number">1</span> ;</span><br><span class="line">		<span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	build(ls(rt), l, mid), build(rs(rt), mid + <span class="number">1</span>, r), up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Tree <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= l &amp;&amp; R &gt;= r) <span class="keyword">return</span> T[rt] ;</span><br><span class="line">	Tree res, A, B ;	</span><br><span class="line">	<span class="keyword">if</span> (mid &gt;= R) <span class="keyword">return</span> query(ls(rt), l, mid) ;</span><br><span class="line">	<span class="keyword">if</span> (mid &lt; L) <span class="keyword">return</span> query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">    A = query(ls(rt), l, mid), B = query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">    res.Lsum = max(A.Lsum, A.S + B.Lsum) ; res.Rsum = max(B.Rsum, B.S + A.Rsum) ;</span><br><span class="line">    res.Sum = max(max(A.Sum, B.Sum), A.Rsum + B.Lsum) ; res.S = A.S + B.S ; </span><br><span class="line">	<span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">	build(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line">	<span class="keyword">while</span> (M --)&#123;</span><br><span class="line"><span class="comment">//		cout &lt;&lt; M &lt;&lt; " " &lt;&lt; "qwerweafasdfsdf" &lt;&lt; endl ;</span></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;MArk, &amp;L, &amp;R),</span><br><span class="line">		++ L, ++ R ;</span><br><span class="line">		<span class="keyword">if</span> (MArk == <span class="number">0</span>) _change(<span class="number">1</span>, <span class="number">1</span>, N, <span class="number">0</span>) ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (MArk == <span class="number">1</span>) _change(<span class="number">1</span>, <span class="number">1</span>, N, <span class="number">1</span>) ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (MArk == <span class="number">2</span>) _reverse(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (MArk == <span class="number">3</span>) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Sum(<span class="number">1</span>, <span class="number">1</span>, N)) ;</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d"</span>, query(<span class="number">1</span>, <span class="number">1</span>, N).Sum), <span class="built_in">putchar</span>(<span class="string">'\n'</span>) ;</span><br><span class="line"><span class="comment">//		cout &lt;&lt; " qwerweafasdfsdf " &lt;&lt; endl ;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$push_up$çœŸé•¿å•Š$233$</p>
<p>è‰¹å®Œè¿™ä¸ªé¢˜æ˜¯çœŸçš„çˆ½å•Š~</p>
<h1 id="Task3-æ€»ç»“ä¸€ä¸‹"><a href="#Task3-æ€»ç»“ä¸€ä¸‹" class="headerlink" title="$Task3~$ æ€»ç»“ä¸€ä¸‹"></a>$Task3~$ æ€»ç»“ä¸€ä¸‹</h1><p>å…¶å®è¿™ä¸œè¥¿å’Œ$DP$æ˜¯ä¸€æ ·çš„å§ï¼Ÿä½ åªéœ€è¦ç¡®å®šä½ æƒ³è¦ç»´æŠ¤ä»€ä¹ˆ(ç­‰ä»·äºç¡®å®šçŠ¶æ€)ï¼Œç„¶åæ˜ç¡®çˆ¶å­åŒºé—´å¦‚ä½•å‘ä¸Šç»´æŠ¤(ç­‰ä»·äºçŠ¶æ€ä¹‹é—´å¦‚ä½•è½¬ç§»)ã€‚</p>
<p>å—¯ï¼Œä¸‡ç‰©ç›¸åŒã€‚</p>
<blockquote>
<p>é‡é©¬ä¹Ÿï¼Œå°˜åŸƒä¹Ÿï¼Œç”Ÿç‰©ä¹‹ä»¥æ¯å‘å¹ä¹Ÿã€‚å¤©ä¹‹è‹è‹ï¼Œå…¶æ­£è‰²è€¶ï¼Ÿå…¶è¿œè€Œæ— æ‰€è‡³æè€¶ï¼Ÿ</p>
</blockquote>
<p>ä¸çŸ¥ä¸ºä»€ä¹ˆï¼Œçªç„¶æƒ³åˆ°äº†è¿™å¥è¯ã€‚</p>
<h1 id="mathscr-The-End"><a href="#mathscr-The-End" class="headerlink" title="$\mathscr{The~End}$"></a>$\mathscr{The~End}$</h1>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>å¥‡æ€ªçš„æŠ€å·§</tag>
        <tag>æ•°æ®ç»“æ„/çº¿æ®µæ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘è‡ªé€‚åº”Simpsonæ³•å…¥é—¨</title>
    <url>/2019/03/17/Simpson1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸€ç§å¾ˆå¯çˆ±çš„ç§¯åˆ†è¿‘ä¼¼æ³•ï¼Œå­¦çš„æ—¶å€™é¡ºä¾¿çœ‹äº†å¥½å¤šè®ºæ–‡qaq</p>
<a id="more"></a>
<p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98%2B-blue.svg" alt></p>
<h1 id="rm-0x01-å‰è¨€"><a href="#rm-0x01-å‰è¨€" class="headerlink" title="$\rm{0x01}$  å‰è¨€"></a>$\rm{0x01}$  å‰è¨€</h1><p>é¦–å…ˆé˜æ˜ä¸€ç‚¹ï¼Œ<strong>è‡ªé€‚åº”è¾›æ™®æ£®ç®—æ³•($\rm{Adaptive ~Simpsonâ€™s~ rule}$ )</strong>æ˜¯ä¸€ç±»<strong>è¿‘ä¼¼ç®—æ³•($\rm{Approximation ~algorithm}$)</strong>ï¼Œä¸»è¦ç”¨äºæ±‚è¾ƒéš¾åå¯¼çš„å‡½æ•°çš„ç§¯åˆ†ã€‚å¤§æ¦‚åœ¨ä¿¡æ¯è®¡ç®—çš„æ—¶å€™ä¸­å¾ˆå¸¸ç”¨ï¼Ÿ</p>
<p>å…¶æ€æƒ³æ˜¯åˆ©ç”¨äºŒæ¬¡å‡½æ•°æ¥ä¸æ–­<strong>æ‹Ÿåˆ($\rm{Overfitting}$)</strong>æ‰€æ±‚æ›²çº¿ï¼Œè€Œæ‰€è°“çš„<strong>$Adapative$ï¼ˆè‡ªé€‚åº”ï¼‰</strong>åˆ™æ˜¯ç”¨äºä¼˜åŒ–æ—¶é—´å¤æ‚åº¦çš„æ–¹æ³•ã€‚</p>
<p>å—â€¦æ€»ä¹‹â€¦æ¯”è¾ƒç®€å•ï¼Ÿ</p>
<p>è¡¨ç¤ºçœ‹äº†ä¸¤ç¯‡å¤–å›½å­¦è€…çš„è®ºæ–‡ï¼Œæ„Ÿè§‰å¥½åƒæ€è·¯å·²ç»æ¯”è¾ƒæ¸…æ™°çš„æ ·å­ã€‚</p>
<h1 id="rm-0x02-mathcal-Simpson-Formula-è¾›æ™®æ£®å…¬å¼"><a href="#rm-0x02-mathcal-Simpson-Formula-è¾›æ™®æ£®å…¬å¼" class="headerlink" title="$\rm{0x02}$  $\mathcal{Simpson~Formula}$ è¾›æ™®æ£®å…¬å¼"></a>$\rm{0x02}$  $\mathcal{Simpson~Formula}$ è¾›æ™®æ£®å…¬å¼</h1><p>ç¨ç­‰ï¼Œè¿™ä¸ªè·Ÿç®—æ³•çš„å…³ç³»ä¸å¤§ï¼Œä¸»è¦æ˜¯å…¬å¼ï¼š<script type="math/tex">\rm{\int _{l}^{r} f(x) \rm{dx}\approx \frac{f(r) +f(l)+ 4 \cdot f(m)}{6}} \,</script></p>
<p>äº‹å®ä¸Šå§ï¼Œæ±‚ç§¯åˆ†çš„è¯ï¼Œå¤§å¤šæ•°éƒ½æ˜¯ç›´æ¥å¥—è¾›æ™®æ£®å…¬å¼çš„ã€‚å¹¶ä¸”è¿™ä¸ªå…¬å¼æ˜¯å¹¿æ³›é€‚ç”¨çš„â€¦â€¦åªä¸è¿‡è¯¯å·®æœ‰ç‚¹å„¿äººå¤§$233$</p>
<p>è¿™å…¶å®æ˜¯æˆ‘ä»¬ç”¨äºŒæ¬¡å‡½æ•°ä¸æ–­æ‹Ÿåˆçš„ç»“æœï¼Œæ¨å¯¼è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹$^{[1]}$ï¼š</p>
<blockquote>
<p>å› ä¸º $g(x)$ æ˜¯ç”¨æ¥æ‹Ÿåˆ $f(x)$ çš„ï¼Œæ‰€ä»¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
\int\limits_L^Rf(x)dx\approx \int\limits_L^Rax^2+bx+c\space dx</script><p>æ±‚ $g(x)$ çš„ä¸å®šç§¯åˆ†ä¸ºï¼š</p>
<script type="math/tex; mode=display">
\int g(x)dx=\frac13ax^3+\frac12bx^2+cx+C</script><p>ç„¶åå†å¸¦å…¥ R å’Œ L ï¼š</p>
<script type="math/tex; mode=display">
\int\limits_L^Rf(x)dx=\frac13a(R^3-L^3)+\frac12b(R^2-L^2)+c(R-L)</script><p>ç„¶åæå…¬å› å¼ï¼ŒåŸå¼ä¸ºï¼š</p>
<script type="math/tex; mode=display">
\frac{R-L}{6}(2a(R^2+LR+L^2)+3b(R+L)+6c)6Râˆ’L(2a(R2+LR+L2)+3b(R+L)+6c)</script><p>æŠŠé‡Œé¢å±•å¼€æ¥ï¼š</p>
<script type="math/tex; mode=display">
\frac{R-L}{6}(2aR^2+2aLR+2aL^2+3bR+3bL+6c)</script><p>é‡æ–°æ•´ç†ä¸€ä¸‹å¼å­ï¼š</p>
<script type="math/tex; mode=display">
\frac{R-L}{6}((aR^2+bR+c)+(aL^2+bL+c)+aR^2+aL^2+2aLR+2bR+2bL+4c)</script><p>å†æ•´ç†ï¼š</p>
<script type="math/tex; mode=display">
\frac{R-L}{6}((aR^2+bR+c)+(aL^2+bL+c)+4(a(\frac{R+L}{2})^2+b(\frac{R+L}{2})+c))</script><p>ä»£æ¢å¯å¾—ï¼š</p>
<script type="math/tex; mode=display">
aR^2+bR+c\approx f(R)\\\
aL^2+bL+c\approx f(L)\\\
4(a(\frac{R+L}{2})^2+b(\frac{R+L}{2})+c)\approx 4f(\frac{R+L}{2})</script><p>æŠŠè¿™ä¸‰ä¸ªå¼å­å¸¦å›å»ï¼Œ æœ€åæˆ‘ä»¬å°±å¾—åˆ°äº†$\rm{Simpson}$ ç§¯åˆ†å…¬å¼ï¼š</p>
<script type="math/tex; mode=display">
\int\limits_L^Rf(x)dx \approx \frac{R-L}{6}(f(L)+4f(\frac{L+R}{2})+f(R)))</script></blockquote>
<p>äºæ˜¯æˆ‘ä»¬å°±å¾—åˆ°äº†æ‰€è°“çš„$\rm{Simpson~Fomula}$ã€‚ä½†äº‹å®ä¸Šï¼Œå¯¹äºä¸€æ®µâ€œè·Œå®•èµ·ä¼â€çš„å‡½æ•°ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ— æ³•å‡†ç¡®åœ°å»ç”¨ä¸€ä¸ªäºŒæ¬¡å‡½æ•°çš„æ‹Ÿåˆæ¥åˆ»ç”»ã€‚äºæ˜¯â€”â€”</p>
<h1 id="rm-0x03-mathcal-Adaptive-Simpson-Rule-è‡ªé€‚åº”è¾›æ™®æ£®æ³•"><a href="#rm-0x03-mathcal-Adaptive-Simpson-Rule-è‡ªé€‚åº”è¾›æ™®æ£®æ³•" class="headerlink" title="$\rm{0x03}$  $\mathcal{Adaptive~Simpson~Rule}$ è‡ªé€‚åº”è¾›æ™®æ£®æ³•"></a>$\rm{0x03}$  $\mathcal{Adaptive~Simpson~Rule}$ è‡ªé€‚åº”è¾›æ™®æ£®æ³•</h1><p>æˆ‘ä»¬è€ƒè™‘ï¼Œå¦‚æœæŠŠåŒºé—´ä»¬ç¨å¾®åˆ’åˆ†åœ°æ›´ç»†ä¸€ç‚¹ï¼Œé‚£æ˜¯ä¸æ˜¯ä¼šå¥½å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¸€å®šçš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘<strong>å®šå‘äºŒåˆ†</strong>ã€‚ä½†æ˜¯â€¦â€¦å®šå‘äºŒåˆ†å§‹ç»ˆå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å®ƒå¤ªç¬¨äº†ï¼Œç¬¨åˆ°å¦‚æœ$[l_1,r_1]$å·²ç»æ»¡è¶³ç²¾åº¦è¦æ±‚äº†ï¼Œæˆ‘ä»¬å´è¿˜è¦ä¸€ç›´åˆ†ï¼›ç¬¨åˆ°$[l_2,r_2]$åˆ†çš„æ¬¡æ•°æ ¹æœ¬ä¸å¤Ÿç”¨â€”â€”ä½†æˆ‘ä»¬å¹¶ä¸å¯ä»¥å¾—åˆ°åé¦ˆã€‚</p>
<p>äºæ˜¯è€ƒè™‘<strong>è‡ªé€‚åº”</strong>ã€‚</p>
<p>æ‰€è°“<strong>è‡ªé€‚åº”</strong>ï¼Œè¯´çš„ç›´ç™½ç‚¹ï¼Œæ— éå°±æ˜¯<strong>éœ€è¦å¤šåˆ†æ²»å‡ æ¬¡çš„åœ°æ–¹ï¼Œå¤šåˆ†æ²»å‡ æ¬¡ï¼›ä¸éœ€è¦çš„åˆ™å¯ä»¥å°‘åˆ†æ²»å‡ æ¬¡</strong></p>
<p>ä½ ä¼šå‘ç°ï¼Œå…¶å®ä»–èŠ‚çº¦çš„å°±æ˜¯ä¸€ä¸ªç‚¹â€”â€”<strong>æ—¶é—´æ•ˆç‡</strong>ã€‚</p>
<p>ä¸¾ä¸ªæ —å­$^{[2]}$ï¼š</p>
<p>æ¯”å¦‚æœ‰è¿™ä¹ˆä¸ªå‡½æ•°$\rm{f (x) = 13(x âˆ’ x^2)e^{\frac{âˆ’3x}{2}} }$ï¼Œæˆ‘ä»¬è¦æ±‚$\int_{0}^{4}f(x) \rm{~dx}$ å¹¶è¦æ±‚ç²¾åº¦è¯¯å·®åœ¨$1e-5$ ä»¥å†…ã€‚è€Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•å»è§£å†³ï¼š</p>
<ul>
<li>ä»¥å›ºå®šçš„æ¯”ä¾‹ä»¥åŠçº¦æŸäºŒåˆ†ã€‚</li>
<li>è¿ç”¨è‡ªé€‚åº”ç­–ç•¥åˆ†é…</li>
</ul>
<p>é‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“ä»–çœŸæ­£çš„$value:$</p>
<p><img src="3.png" alt></p>
<p>çœ‹èµ·æ¥å¥½åƒæµ·æ˜Ÿï¼Ÿç„¶åæˆ‘ä»¬ç”¨ä¸¤ç§æ–¹æ³•éƒ½è¯•ä¸€è¯•ï¼š</p>
<p>é¦–å…ˆæ˜¯è‡ªé€‚åº”æ³•ï¼Œæˆ‘ä»¬å‘ç°æœ€ååªéœ€è¦æ±‚$20$æ®µåŒºé—´ã€‚è¡¨ä¸­çš„$a_k \&amp; b_k$è¡¨ç¤ºå·¦å³åŒºé—´ï¼Œ$S(l,r)$è¡¨ç¤º$[l,r]$å†…ã€è¿ç”¨$0x01$ä¸­çš„å…¬å¼è®¡ç®—çš„ï¼Œ$\rm{Error~Bound}$è¡¨ç¤ºè¯¯å·®ç•Œï¼Œ$\rm{Tolerance}$è¡¨ç¤ºè®¡ç®—æ—¶<strong>éœ€è¦çš„è¯¯å·®</strong>(ç¨‹åºè®¾è®¡æ—¶ä¼šè®²)ã€‚</p>
<p><img src="4.png" alt></p>
<p>é‚£ä¹ˆæœ€åç®—å‡ºæ¥çš„å€¼æ˜¯$ âˆ’1.54878823413$ ï¼Œä¸çœŸå®å€¼è¯¯å·®ä¸º$0.00000013840 $ï¼Œä¸€å…±è°ƒç”¨äº†$79$æ¬¡<strong>å‡½æ•°ä¼°å€¼</strong>ï¼ˆç•™ä¸ªå‘ï¼Œåæ–‡ä¼šè®²ï¼‰ã€‚</p>
<p>é‚£ä¹ˆç»˜åˆ¶å‡ºæ¥çš„å‡½æ•°å›¾åƒå¤§æ¦‚é•¿è¿™æ ·ï¼š<img src="5.png" alt></p>
<p>å¥½åƒå¾ˆæµç•…ï¼Ÿ$233$</p>
<p>é‚£ä¹ˆç¬¬äºŒç§æ–¹æ³•æ˜¯å®šå€¼åˆ†æ®µã€‚æˆ‘ä»¬è€ƒè™‘åˆ†æˆåŒºé—´$[0,4]$åˆ†ä¸ºé•¿åº¦ä¸º$0.03125$çš„$128$æ®µï¼Œå¹¶è¿ç”¨$0x01$çš„$Formula$ï¼Œæœ€åå¾—å‡ºçš„ç»“æœä¸º$âˆ’1.54878844029$ï¼Œè¯¯å·®ä¸º$0.00000006776$â€¦â€¦</p>
<p>å¥½åƒæ˜¯ç¬¬ä¸€ä¸ªè¯¯å·®çš„äºŒåˆ†ä¹‹ä¸€ï¼Ÿå¬èµ·æ¥å¥½åƒè¯¯å·®å°äº†ï¼Œä½†æ˜¯å´éœ€è¦$257$æ¬¡å‡½æ•°ä¼°å€¼çš„è°ƒç”¨â€¦â€¦ç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—æ›´ä¼˜è¶Šçš„æ€§èƒ½ï¼Œè€Œé‚£è¯¯å·®ä¹Ÿæ˜¯ä¸éœ€è¦è€ƒè™‘çš„å•¦çš„å•¦ï½</p>
<p>ä½†æ˜¯æ¯”èµ·$1e-5$ç²¾åº¦æ¥è¯´â€¦â€¦è¿™æ³¢ç¨³èµšå•Š$233$</p>
<h1 id="rm-0x04-mathcal-About-Code-ä»£ç å®ç°"><a href="#rm-0x04-mathcal-About-Code-ä»£ç å®ç°" class="headerlink" title="$\rm{0x04}$  $\mathcal{About~Code~}$ ä»£ç å®ç°"></a>$\rm{0x04}$  $\mathcal{About~Code~}$ ä»£ç å®ç°</h1><p>é¦–å…ˆæ˜¯<a href="https://www.luogu.org/problemnew/show/P4525" target="_blank" rel="noopener">$LuoguP4525$</a>çš„æš´åŠ›è§£æ³•ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid (l + r) / 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Eps = <span class="number">5e-8</span> ;</span><br><span class="line"><span class="keyword">double</span> Ans, A, B, C, D, L, R ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">F</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (C * x + D) / (A * x + B) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">Simp_calc</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (r - l) / <span class="number">6</span> * (F(l) + F(r) + <span class="number">4</span> * F(mid)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">do_divide</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> Lv, Rv, v, t ;</span><br><span class="line">    Lv = Simp_calc(l, mid), Rv = Simp_calc(mid, r), v = Simp_calc(l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(t = (Lv + Rv - v)) &lt;= Eps) <span class="keyword">return</span> Lv + Rv ; <span class="keyword">return</span> do_divide(l, mid) + do_divide(mid, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf%lf%lf%lf"</span>, &amp;A, &amp;B, &amp;C, &amp;D, &amp;L, &amp;R) ;</span><br><span class="line">    Ans = do_divide(L, R) ; <span class="built_in">printf</span>(<span class="string">"%.6lf"</span>, Ans) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™â€¦ä¸¥æ ¼æ„ä¹‰ä¸Šè®²ï¼Œä¸èƒ½ç®—æ˜¯è‡ªé€‚åº”è¾›æ™®æ£®æ³•â€”â€”æ›´å‡†ç¡®åœ°è¯´ï¼Œå››ä¸åƒï¼Œæˆ–è€…â€œä¸œæ–½æ•ˆé¢¦â€ä¹‹ç±»çš„ï¼Œéƒ½æŒºåˆé€‚ã€‚è¿™æ˜¯æˆ‘åœ¨åˆå­¦è¿™ä¸€å—å„¿å†…å®¹æ—¶çš„å†™æ³•ï¼Œä»–ä¸ä¸¥æ ¼æ­£ç¡®ï¼Œä½†æ˜¯â€¦â€¦ä»–å¯¹çš„å¾ˆï¼Ÿ</p>
<p>è‡³äºè¿›åŒ–ç‰ˆ<a href="https://www.luogu.org/problemnew/show/P4526" target="_blank" rel="noopener">$LuoguP4526$</a>ï¼Œä¹Ÿæ˜¯å®Œå…¨å¯ä»¥violentlyè‰¹è¿‡å»çš„ï¼š<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid (l + r) / 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Eps = <span class="number">5e-8</span> ;</span><br><span class="line"><span class="keyword">double</span> Ans, A, B, C, D, L, R ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">F</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(x, A / x - x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">Simp_calc</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (r - l) / <span class="number">6</span> * (F(l) + F(r) + <span class="number">4</span> * F(mid)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">do_divide</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r, <span class="keyword">double</span> Lans)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> Lv, Rv, v, t ; Lv = Simp_calc(l, mid), Rv = Simp_calc(mid, r), v = Lans ;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(t = (Lv + Rv - v)) &lt;= Eps) <span class="keyword">return</span> Lv + Rv ; <span class="keyword">return</span> do_divide(l, mid, Lv) + do_divide(mid, r, Rv) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;A) ; L = Eps, R = <span class="number">23.3</span> ;</span><br><span class="line">    <span class="keyword">if</span> (A &lt; <span class="number">0</span>) &#123; <span class="built_in">puts</span>(<span class="string">"orz"</span>), <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;&#125;</span><br><span class="line">    Ans = do_divide(L, R, Simp_calc(L, R)) ; <span class="built_in">printf</span>(<span class="string">"%.5lf"</span>, Ans) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯ï¼Œå…¶çœŸæ­£çš„å®ç°åº”è¯¥æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> v Lans</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> hps eps * 0.5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid (l + r) * 0.5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">double</span> Ans, A, L, R ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Eps = <span class="number">1e-7</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Liu = <span class="number">1.0</span> / <span class="number">6</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">F</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(x, A / x - x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">Simp_calc</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (r - l) * Liu * (F(l) + F(r) + <span class="number">4.0</span> * F(mid)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">do_divide</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r, <span class="keyword">double</span> Lans, <span class="keyword">double</span> eps)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> Lv, Rv, t ; </span><br><span class="line">    Lv = Simp_calc(l, mid), Rv = Simp_calc(mid, r) ;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(t = (Lv + Rv - v)) &lt;= eps * <span class="number">15</span>) <span class="keyword">return</span> Lv + Rv + t / <span class="number">15</span> ; </span><br><span class="line">    <span class="keyword">return</span> do_divide(l, mid, Lv, hps) + do_divide(mid, r, Rv, hps) ; <span class="comment">//æ®è¯´epsÃ—15æ¥è‡ªäºWikiâ€¦â€¦</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;A) ; L = Eps, R = <span class="number">30</span> ; </span><br><span class="line">    <span class="keyword">if</span> (A &lt; <span class="number">0</span>) &#123; <span class="built_in">puts</span>(<span class="string">"orz"</span>), <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;&#125;</span><br><span class="line">    Ans = do_divide(L, R, Simp_calc(L, R), Eps) ; <span class="built_in">printf</span>(<span class="string">"%.5lf"</span>, Ans) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬å‘ç°è¿™å°±å¯ä»¥è·Ÿæ–‡ç« ä¸Šé¢$0x03$ä¸­çš„ä¾‹å­å‘¼åº”äº†ï¼šæ¯æ¬¡åˆ†æ²»æ—¶è®¡ç®—ä¸¤æ¬¡ï¼Œæ€»å…±åˆ†æ²»äº†$39$æ¬¡ï¼Œæœ€ç»ˆä¸€å…±è®¡ç®—äº†$78+1=79$æ¬¡ï¼Œè€ŒäºŒåˆ†åˆ™æ˜¯ä¸€æ£µæœ‰$128$ä¸ªå¶å­èŠ‚ç‚¹çš„é€’å½’æ ‘ï¼Œæ€»å…±è®¡ç®—äº†$256 +1=257$æ¬¡ã€‚    </p>
<p>å¥½çš„ï¼Œç»ˆäºè¦æ‰¯æ­£é¢˜äº†ã€‚ç®—æ³•çš„å®ç°å…¶å®ç®€å•ï¼Œæˆ‘ä»¬ç”¨æ‹Ÿåˆæ€§ç®—æ³•ä¸æ–­$check\&amp;calc$, è€Œ$check$çš„æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åˆ¤æ–­ä¸€ä¸‹ä¸¤æ®µå­åŒºé—´çš„å‡½æ•°å€¼ä¹‹å’Œä¸æ•´ä¸ªåŒºé—´çš„å‡½æ•°å€¼ä¹‹å’Œçš„å·®å€¼æ˜¯å¦åœ¨ç²¾åº¦è¦æ±‚èŒƒå›´ä¹‹å†…ï¼Œä¹‹åå¦‚æœæ»¡è¶³ç²¾åº¦è¯¯å·®å°±ç›´æ¥$return$ï¼Œå¦åˆ™å¯¹äºè¿™æ®µåŒºé—´ç»§ç»­é€’å½’ä¸‹å»ã€‚</p>
<p>è€Œè¿™ä¸ªåœ°æ–¹æœ‰ä¸ªè¦æ±‚ï¼Œå°±æ˜¯å¯¹äº$eps$ï¼Œä½ éœ€è¦ä¸æ–­$half$ä»–ï¼ŒåŸå› å¾ˆç®€å•ï¼Œå¯¹äºä¸€æ•´æ®µåŒºé—´$U$ï¼Œè¦æ±‚ä»–çš„è¿”å›å€¼çš„$|eps(U)| \leq k$çš„è¯ï¼Œé‚£ä¹ˆå¯¹äºå…¶ä½œä¸ºå­é›†ä¸¤ä¸ªè¿ç»­åŒºé—´$A,B$ï¼Œå½“$A \bigcup B = U$æ—¶ï¼Œå¿…é¡»è¦æ»¡è¶³$|eps(A)| \leq \frac{k}{2}, |eps(B)| \leq  \frac{k}{2}$ï¼Œæ‰èƒ½ä¿è¯$|eps(U) = eps(A) + eps(B)| \leq k$ï¼Œæ‰€ä»¥è¦ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> hps eps * 0.5</span></span><br><span class="line">....................</span><br><span class="line"><span class="keyword">return</span> do_divide(l, mid, Lv, hps) + do_divide(mid, r, Rv, hps) ;</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œå”¯ä¸€çš„é—®é¢˜åœ¨äºæœ‰å¥è¯è¿·çš„å¾ˆï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">fabs</span>(t = (Lv + Rv - v)) &lt;= eps * <span class="number">15</span>) <span class="keyword">return</span> Lv + Rv + t / <span class="number">15</span> ;</span><br></pre></td></tr></table></figure>
<p><img src="nky.jpg" alt></p>
<p>è¿™ä¸ª$\leq 15 \cdot eps$æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</p>
<p>å¥½å§ï¼Œç¬”è€…ä¹Ÿä¸æ¸…æ¥šï¼Œä½†æ˜¯æœ‰ä¸ªç»“è®ºæ˜¯é•¿è¿™æ ·çš„ï¼š<img src="1.png" alt></p>
<p>ä»€ä¹ˆï¼Ÿä½ è¯´æ¨ä»€ä¹ˆå€’ï¼Ÿå°å°å¹´çºªæ•´å¤©æƒ³ç€æ¨å€’<del>å­¦å§</del>å¯ä¸å¥½å•Š$233$</p>
<p>ä»€ä¹ˆï¼Ÿä½ è¿˜æƒ³çœ‹æ¨å€’çš„è¿‡ç¨‹ï¼Ÿå•§å•§å•§ï¼Œå·¦è½¬çŸ¥ä¹æ„Ÿæƒ…ä¸“åŒºèŸ¹èŸ¹ï½</p>
<p>å¥½çš„ï¼Œä»¥ä¸Šä¸¤æ®µæ˜¯çæ‰¯çš„ï¼Œæ¨å¯¼è¿‡ç¨‹ååˆ†è¯¡å¼‚ï¼Œå¤§å®¶è‡ªå·±é£Ÿç”¨å¥½äº†â€¦â€¦</p>
<p>äºæ˜¯ç»“æŸï¼Œæ’’èŠ±èŠ±â€¦ï¼ˆä¸æ˜¯æ’’ç¬”è€…xï¼‰</p>
<h1 id="rm-Referance"><a href="#rm-Referance" class="headerlink" title="$\rm{Referance}$"></a>$\rm{Referance}$</h1><ul>
<li><p>$[1]$ :$NaCly_Fish$çš„$blog$ <a href="https://www.luogu.org/blog/NaCly-Fish-blog/SimpsonIntegral" target="_blank" rel="noopener">$^{^{[\nearrow]}}$</a></p>
</li>
<li><p>$[2]$ :æŸç¯‡è®ºæ–‡ <a href="https://files.cnblogs.com/files/pks-t/AdaptiveQuadProof.pdf" target="_blank" rel="noopener">$^{^{[\nearrow]}}$</a></p>
</li>
</ul>
<p>å¯¹äºç¬¬äºŒç¯‡$refer$ï¼Œå€Ÿé‰´çš„æ¯”è¾ƒå¤šï¼ˆè¯»ä¹¦äººçš„äº‹â€¦â€¦å’³å’³â€¦â€¦ï¼‰ï¼Œä½†æ˜¯æ”¹äº†ä¸€ä¸ªæ•°æ®ï¼Œå°±æ˜¯$81 \to 79$ï¼Œå› ä¸ºä»£ç éœ€è¦$233$</p>
<p>$Ps:$å²ä¸Šæœ€ä¸æ­£ç»çš„$reference$è¯ç”Ÿäº†â€¦â€¦</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/ç§¯åˆ†/ç§¯åˆ†è¿‘ä¼¼</tag>
        <tag>è®¡ç®—å‡ ä½•/Simpsonç§¯åˆ†</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€é¢˜è§£ã€‘ä¸€ç±»æ ‘ä¸Šè·ç¦»çš„è®¡ç®—</title>
    <url>/2019/03/16/Cal-on-Tree1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98%2B-blue.svg" alt></p>
<p>å¥½çš„ï¼Œä»Šå¤©æ•´ç†ä¸€ç±»è¾ƒä¸ºç®€å•çš„æ ‘ä¸Šé’ˆå¯¹è¾¹æƒçš„ä¿®æ”¹ã€æŸ¥è¯¢ã€æ“ä½œé¢˜ã€‚</p>
<p>é—®é¢˜å¤§æ¦‚æœ‰ä¸¤ç±»ï¼šåªæœ‰æŸ¥è¯¢$\&amp;$ä¿®æ”¹æŸ¥è¯¢éƒ½æœ‰</p>
<h2 id="mathscr-Task1-æ™®é€šçš„æŸ¥è¯¢é—®é¢˜"><a href="#mathscr-Task1-æ™®é€šçš„æŸ¥è¯¢é—®é¢˜" class="headerlink" title="$\mathscr{Task1}$æ™®é€šçš„æŸ¥è¯¢é—®é¢˜"></a>$\mathscr{Task1}$æ™®é€šçš„æŸ¥è¯¢é—®é¢˜</h2><p>å¤§æ¦‚é—®é¢˜å°±ç±»ä¼¼äºè¿™ä¸ªå…¸å‹çš„<a href="https://www.luogu.org/problemnew/show/P2420" target="_blank" rel="noopener">$XOR$é—®é¢˜</a> </p>
<p>å…¶å®è¯´ç™½äº†ï¼Œè¿™ä¸ªé¢˜çš„è§£æ³•ååˆ†ç®€å•â€”â€”$LCA$</p>
<p>ä½†å…¶å®â€¦â€¦æˆ‘ä¸€å¼€å§‹è€ƒè™‘$LCA$ï¼Œæ²¡æœ‰ç»†è‡´è€ƒè™‘ï¼Œåªæ˜¯è§‰å¾—å¦‚æœä»$u,v$åˆ†åˆ«å‘$LCA$è·³ï¼Œè¿™å¹¶ä¸å¯ä»¥æå‰å¤„ç†æˆ–è€…æå‰ç»´æŠ¤ï¼Œæ‰€ä»¥å’Œæš´åŠ›æ²¡æœ‰åŒºåˆ«ï¼Œäºæ˜¯å°±å¼ƒç–—ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸ªåœ°æ–¹ï¼Œ$LCA$çš„ä½œç”¨ååˆ†å·§å¦™â€”â€”æˆ‘ä»¬è¯•å›¾å»æ‹“å±•è¿™ä¸ªé¢˜ã€‚æˆ‘ä»¬å®šä¹‰$D(\bigodot,r,u)$è¡¨ç¤ºåœ¨è¿ç®—$\bigodot$ä¸‹ï¼Œä»æ ¹$r$åˆ°æŸä¸€å›ºå®šç‚¹$u$çš„è¾¹æƒè¿ç®—ç»“æœï¼Œå…¶ä¸­é™å®šäº†è¿ç®—$\bigodot$å¿…é¡»ä¸ºå¯é€†è¿ç®—ï¼Œæ¯”å¦‚è¯´å¼‚æˆ–ã€åŠ æ³•ã€å‡æ³•â€”â€”æ³¨æ„ï¼Œæ­¤æ—¶çš„å¯é€†è¿ç®—ï¼Œå¯ä»¥æ˜¯<strong>è‡ªå¯é€†ï¼ˆè‡ªå·±å¯¹è‡ªå·±è¿ç®—æ˜¯é€†è¿ç®—ï¼Œæ¯”å¦‚$A~XOR ~A = 0$ï¼‰</strong>æˆ–è€…<strong>ä»–å¯é€†ï¼ˆå³å­˜åœ¨å¦ä¸€ç§è¿ç®—ï¼Œæ˜¯è¿™ç§è¿ç®—çš„é€†è¿ç®—ï¼Œæ¯”å¦‚åŠ æ³•ä¹‹äºå‡æ³•ï¼‰</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¾—å‡ºå®ƒçš„ä¸€èˆ¬å½¢å¼<script type="math/tex">D(\bigodot,u,v) = D(\bigodot,r,u) \bigodot D(\bigodot,r,v) ~\bigoplus ~(~2 \cdot D(\bigodot,r,LCA(u,v)~)~)</script> ï¼Œå…¶ä¸­æˆ‘ä»¬å‡è®¾è¿ç®—$\bigodot$ä¸$\bigoplus$äº’é€†ã€‚æ ‘ä¸Šå‰ç¼€å’Œå¤§æŠµä¸Šå°±æ˜¯è¿™ä¸ªæ„æ€ã€‚</p>
<p>é‚£ä¹ˆå›åˆ°è¿™ä¸ªé¢˜ï¼Œæˆ‘ä»¬å¯¹äºæ¯ä¸€ä¸ªç‚¹çš„$D$ï¼Œéƒ½æ˜¯ååˆ†æ–¹ä¾¿è®¡ç®—çš„ï¼Œå› ä¸ºæ— æƒæ—¶ï¼Œ$D(r,t) = depth[t]$æ˜¯ä¸€ä¸ªç›¸å½“å¹³å‡¡çš„ç»“è®ºï¼›æœ‰æƒæ—¶ï¼Œåˆ™ç›´æ¥$dfs$ä¸€éå³å¯ã€‚æ¯æ¬¡æŸ¥è¯¢æ˜¯$log$çº§åˆ«çš„ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦çš„æ¸è¿›ä¸Šç•Œå°±æ˜¯æ¯”è¾ƒæ˜¾ç„¶çš„$O(\max(m \log_2n,n))$ã€‚</p>
<p>ä»£ç å¤§æ¦‚æ˜¯è¿™æ ·</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span> )+ (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    e[++cnt].t = v ;</span><br><span class="line">    e[cnt].next = head[u] ;</span><br><span class="line">    e[cnt].v = w ;</span><br><span class="line">	head[u] = cnt ;</span><br><span class="line">    e[++cnt].t = u ;</span><br><span class="line">    e[cnt].next = head[v] ;</span><br><span class="line">    e[cnt].v = w ;</span><br><span class="line">	head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _build(<span class="keyword">int</span> deep, <span class="keyword">int</span> now, <span class="keyword">int</span> f, <span class="keyword">int</span> _xor)&#123;</span><br><span class="line">    fa[now][<span class="number">0</span>] = f, dep[now] = deep, XOR[now] = _xor ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = head[now]; k ;k = e[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span>(e[k].t == f) <span class="keyword">continue</span> ;</span><br><span class="line">        _build(deep + <span class="number">1</span>, e[k].t, now, _xor ^ e[k].v) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Up = <span class="built_in">log</span>(N) / <span class="built_in">log</span>(<span class="number">2</span>) + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= Up; i ++)</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">            fa[j][i] = fa[fa[j][i - <span class="number">1</span>]][i - <span class="number">1</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[u] &lt; dep[v]) swap(u, v) ;</span><br><span class="line">    pre = dep[u] - dep[v] ;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt;= Up; j ++) <span class="keyword">if</span>((<span class="number">1</span> &lt;&lt; j) &amp; pre) u = fa[u][j] ;</span><br><span class="line">    <span class="keyword">if</span>(u == v) <span class="keyword">return</span> u ;</span><br><span class="line">    <span class="keyword">for</span>(j = Up; j &gt;= <span class="number">0</span>; j --) <span class="keyword">if</span>(fa[u][j] != fa[v][j]) u = fa[u][j], v = fa[v][j] ;</span><br><span class="line">    <span class="keyword">return</span> fa[v][<span class="number">0</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    N = qr() ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; N; i ++)&#123;</span><br><span class="line">        in1 = qr(), in2 = qr(), in3 = qr();</span><br><span class="line">        add(in1, in2, in3) ;</span><br><span class="line">    &#125;</span><br><span class="line">    M = qr() ;</span><br><span class="line">    _build(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>), init( );</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= M; i ++)&#123;</span><br><span class="line">        in1 = qr(), in2 = qr() ;</span><br><span class="line">        f1 = LCA(in1, in2) ;</span><br><span class="line">        <span class="keyword">int</span> t = XOR[in1]^XOR[f1]^XOR[in2]^XOR[f1] ;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; t &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="mathscr-Task-2-å¸¦æœ‰ä¿®æ”¹çš„æŸ¥è¯¢é—®é¢˜ï¼š"><a href="#mathscr-Task-2-å¸¦æœ‰ä¿®æ”¹çš„æŸ¥è¯¢é—®é¢˜ï¼š" class="headerlink" title="$\mathscr{Task~2}$å¸¦æœ‰ä¿®æ”¹çš„æŸ¥è¯¢é—®é¢˜ï¼š"></a>$\mathscr{Task~2}$å¸¦æœ‰ä¿®æ”¹çš„æŸ¥è¯¢é—®é¢˜ï¼š</h2><p>ä¹‹åæˆ‘ä»¬ç´§æ¥ç€å°è¯•å»æ¢è®¨ä¸€ç±»å¸¦æœ‰ä¿®æ”¹è¾¹æƒçš„æ ‘ä¸Šæ“ä½œï¼Œå¤§æ¦‚é¢˜ç›®å°±æ˜¯<a href="https://www.luogu.org/problemnew/show/P1505" target="_blank" rel="noopener">æŸå¹´å›½å®¶é›†è®­é˜Ÿçš„æ¿å­é¢˜</a>å’Œä¸€é“ç»å…¸çš„<a href="https://www.luogu.org/problemnew/show/P4315" target="_blank" rel="noopener">è¾¹æƒä¿®æ”¹å¯è’™é¢˜</a> </p>
<p>æˆ‘ä»¬è€ƒè™‘ï¼Œçº·ç¹çš„æ“ä½œï¼Œæ­¤æ—¶å¥½åƒæ ‘å‰–æ¯”è¾ƒåˆé€‚äº›ã€‚ä½†æ— è®ºæ€æ ·ï¼Œæ ‘å‰–æ˜¯å‰–ç‚¹çš„ï¼Œä¸æ˜¯å‰–è¾¹çš„ã€‚æ‰€ä»¥æˆ‘ä»¬è‡ªç„¶è€Œç„¶åœ°æƒ³åˆ°è¦å»æŠŠè¾¹æƒè½¬ç§»åˆ°ç‚¹æƒä¸Šé¢ã€‚è½¬ç§»åˆ°å“ªå„¿å»å‘¢ï¼Ÿæ˜¾ç„¶<strong>åªèƒ½è½¬ç§»åˆ°æ·±åº¦å¤§çš„ç‚¹ä¸Š</strong>ï¼Œå› ä¸ºåœ¨æ ‘è¿™ç§ç»“æ„é‡Œé¢ï¼Œä¸€å¯¹å¤šå†³å®šäº†æ¯ä¸ªèŠ‚ç‚¹å¦‚æœæƒ³è¦åªä¿ç•™ä¸€ä¸ªå±æ€§ï¼ˆæƒå€¼ï¼‰ï¼Œå°±ä¸èƒ½è®©çˆ¶èŠ‚ç‚¹ä¿ç•™è¾¹æƒâ€”â€”å¦åˆ™çˆ¶èŠ‚ç‚¹å°±ä¼šåŒæ—¶ä¿æœ‰è®¸å¤šå±æ€§ï¼Œå¹¶ä¸”å¶å­ç»“ç‚¹ä¼šæ²¡æœ‰å±æ€§ï¼Œå¯¼è‡´é€»è¾‘å…³ç³»ååˆ†æ··ä¹±ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±åº”è¯¥æŠŠè¾¹æƒæ”¾åˆ°æ·±åº¦å¤§çš„èŠ‚ç‚¹ä¸Šï¼Œå¯¹èŠ‚ç‚¹è¿›è¡Œæ“ä½œã€‚äº‹å®ä¸Šï¼Œæ­¤å¤„å”¯ä¸€éœ€è¦æ³¨æ„çš„é—®é¢˜å°±æ˜¯ï¼Œæˆ‘ä»¬åœ¨æ“ä½œçš„æ—¶å€™è¦<strong>å¿½ç•¥$LCA(u,v)$</strong>ï¼Œè¿™æ˜¯æ˜¾ç„¶çš„ã€‚å…³äºè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ˜¯æŠŠä¹‹å‰æ ‘å‰–é‡Œé¢çš„è¿™ä¸€å¥ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">_query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u], Id[v]) ;	</span><br><span class="line">_update(<span class="number">1</span>, <span class="number">1</span>, N, Id[u], Id[v], d) ;</span><br></pre></td></tr></table></figure>
<p>æ”¹æˆ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">_query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v]) ;	</span><br><span class="line">_update(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v], d) ;</span><br></pre></td></tr></table></figure>
<p>å³å¯ã€‚</p>
<p>è€Œå¯¹äºå¦‚ä½•è¾¹æƒè½¬ç‚¹æƒï¼Œæˆ‘ç”¨çš„æ€»æ—¶é—´å¤æ‚åº¦å¤§çº¦$O(n)$çš„åŒºé—´èµ‹å€¼å‡½æ•°ï¼Œå¥½åƒæ¯”è¾ƒæ–¹ä¾¿ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">    n[i].u = qr(), n[i].v = qr(), n[i].c = qr(), _Add(n[i].u, n[i].v, n[i].c) ;</span><br><span class="line">dfs1(<span class="number">1</span>, <span class="number">1</span>), dfs2(<span class="number">1</span>, <span class="number">1</span>), _build(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">    <span class="keyword">if</span> (Dep[n[i].u] &gt; Dep[n[i].v]) swap(n[i].u,n[i].v);</span><br><span class="line">    _change(<span class="number">1</span>, <span class="number">1</span>, N, Id[n[i].v], Id[n[i].v], n[i].c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å—¯ï¼Œ<del>é¢˜è§£å¥½å•Š</del></p>
<p>é‚£ä¹ˆä¸Šé¢ä¸¤ä¸ªé¢˜å°±æ¯”è¾ƒç®€å•äº†ï¼š</p>
<p>$\mathscr{T1 ~\text{ã®} ~code}$</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, c ;</span><br><span class="line">&#125;n[MAX &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v, next, to ;</span><br><span class="line">&#125;e[MAX &lt;&lt; <span class="number">1</span>] ;  </span><br><span class="line"><span class="keyword">int</span> Id[MAX], M, N, tot, A, B, C, i ; <span class="keyword">char</span> STR[<span class="number">50</span>] ;</span><br><span class="line"><span class="keyword">int</span> Top[MAX], Fa[MAX], Sum[MAX], Son[MAX], Dep[MAX], head[MAX] ;</span><br><span class="line"><span class="keyword">int</span> Max[MAX &lt;&lt; <span class="number">1</span>], Min[MAX &lt;&lt; <span class="number">1</span>], S[MAX &lt;&lt; <span class="number">1</span>], T[MAX &lt;&lt; <span class="number">1</span>], cnt ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>, f = <span class="number">1</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) &#123;<span class="keyword">if</span> (c == <span class="string">'-'</span>) f = <span class="number">-1</span> ; c = getchar() ;&#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) res = (res &lt;&lt; <span class="number">1</span>) + (res &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> res * f ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Add(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)&#123;</span><br><span class="line">    e[++ cnt].v = c, e[cnt].to = v ;</span><br><span class="line">    e[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">    e[++ cnt].v = c, e[cnt].to = u ;</span><br><span class="line">    e[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> F, <span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    Sum[now] = <span class="number">1</span>, Fa[now] = F, Dep[now] = Dep[F] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = e[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span> (e[k].to == F) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs1(now, e[k].to) ;</span><br><span class="line">        Sum[now] += Sum[e[k].to] ;</span><br><span class="line">        <span class="keyword">if</span> (Sum[e[k].to] &gt; Sum[Son[now]]) Son[now] = e[k].to ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> Tp)</span></span>&#123;</span><br><span class="line">    Id[now] = ++ tot, Top[now] = Tp ;</span><br><span class="line">    <span class="keyword">if</span> (Son[now]) dfs2(Son[now], Tp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = e[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span> (e[k].to == Fa[now] || e[k].to == Son[now]) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs2(e[k].to, e[k].to) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_u</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    Max[rt] = max(Max[Rs(rt)], Max[Ls(rt)]) ;</span><br><span class="line">    Min[rt] = min(Min[Rs(rt)], Min[Ls(rt)]) ;</span><br><span class="line">    S[rt] = S[Ls(rt)] + S[Rs(rt)] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_d</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (T[rt])&#123;</span><br><span class="line">        <span class="keyword">int</span> t1 = Max[Ls(rt)], t2 = Max[Rs(rt)] ;</span><br><span class="line">        T[Ls(rt)] ^= <span class="number">1</span>, T[Rs(rt)] ^= <span class="number">1</span> ;</span><br><span class="line">        Max[Ls(rt)] = -Min[Ls(rt)], Max[Rs(rt)] = -Min[Rs(rt)] ;</span><br><span class="line">        Min[Ls(rt)] = -t1, Min[Rs(rt)] = -t2, S[Ls(rt)] = -S[Ls(rt)], S[Rs(rt)] = -S[Rs(rt)] ;</span><br><span class="line">        T[rt] = <span class="number">0</span> ;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span>  _build(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R)&#123;</span><br><span class="line">    <span class="keyword">if</span> (L == R) <span class="keyword">return</span> ;</span><br><span class="line">    _build(Ls(rt), L, Mid), _build(Rs(rt), Mid + <span class="number">1</span>, R) ;</span><br><span class="line">    P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _change(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r)&#123;</span><br><span class="line">        S[rt] = Max[rt] = Min[rt] = k, T[rt] = <span class="number">0</span> ; <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    P_d(rt, L, R) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) _change(Ls(rt), L, Mid, l, r, k) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) _change(Rs(rt), Mid + <span class="number">1</span>, R, l, r, k) ;</span><br><span class="line">    P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _update(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r)&#123;</span><br><span class="line">        <span class="keyword">int</span> t = Max[rt] ;</span><br><span class="line">        Max[rt] = -Min[rt], Min[rt] = -t ; </span><br><span class="line">        T[rt] ^= <span class="number">1</span>, S[rt] = -S[rt] ; <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    P_d(rt, L, R) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) _update(Ls(rt), L, Mid, l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) _update(Rs(rt), Mid + <span class="number">1</span>, R, l, r) ;</span><br><span class="line">    P_u(rt) ;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> _query(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r) <span class="keyword">return</span> Max[rt] ;</span><br><span class="line">    P_d(rt, L, R) ; <span class="keyword">int</span> Maxxxxx = -Inf ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) Maxxxxx = max(Maxxxxx, _query(Ls(rt), L, Mid, l, r)) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) Maxxxxx = max(Maxxxxx, _query(Rs(rt), Mid + <span class="number">1</span>, R, l, r)) ;</span><br><span class="line">    <span class="keyword">return</span> Maxxxxx ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> __query(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r) <span class="keyword">return</span> Min[rt] ;</span><br><span class="line">    P_d(rt, L, R) ; <span class="keyword">int</span> Minnnnn = Inf ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) Minnnnn = min(Minnnnn, __query(Ls(rt), L, Mid, l, r)) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) Minnnnn = min(Minnnnn, __query(Rs(rt), Mid + <span class="number">1</span>, R, l, r)) ;</span><br><span class="line">    <span class="keyword">return</span> Minnnnn ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ___query(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r) <span class="keyword">return</span> S[rt] ;</span><br><span class="line">    P_d(rt, L, R) ; <span class="keyword">int</span> Ssssss = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) Ssssss += ___query(Ls(rt), L, Mid, l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) Ssssss += ___query(Rs(rt), Mid + <span class="number">1</span>, R, l, r) ;</span><br><span class="line">    <span class="keyword">return</span> Ssssss ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Update(<span class="keyword">int</span> u, <span class="keyword">int</span> v)&#123;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        _update(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u]) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    _update(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get_Max</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = -Inf ;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        ret = max(ret, _query(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u])) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    ret = max(ret, _query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v])) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get_Min</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = Inf ;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        ret = min(ret, __query(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u])) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    ret = min(ret, __query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v])) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get_Sum</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        ret += ___query(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u]) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> ret ;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    ret += ___query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v]) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        n[i].u = qr() + <span class="number">1</span>, n[i].v = qr() + <span class="number">1</span>, n[i].c = qr(), _Add(n[i].u, n[i].v, n[i].c) ;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">1</span>), dfs2(<span class="number">1</span>, <span class="number">1</span>), _build(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (Dep[n[i].u] &gt; Dep[n[i].v]) swap(n[i].u,n[i].v);</span><br><span class="line">        _change(<span class="number">1</span>, <span class="number">1</span>, N, Id[n[i].v], Id[n[i].v], n[i].c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; M ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, STR) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'N'</span>) A = qr() + <span class="number">1</span>, B = qr() + <span class="number">1</span>, _Update(A, B) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'S'</span>) A = qr() + <span class="number">1</span>, B = qr() + <span class="number">1</span>, <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Get_Sum(A, B)) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'M'</span> &amp;&amp; STR[<span class="number">1</span>] == <span class="string">'A'</span>) A = qr() + <span class="number">1</span>, B = qr() + <span class="number">1</span>, <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Get_Max(A, B)) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'M'</span> &amp;&amp; STR[<span class="number">1</span>] == <span class="string">'I'</span>) A = qr() + <span class="number">1</span>, B = qr() + <span class="number">1</span>, <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Get_Min(A, B)) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'C'</span>) A = qr(), B = qr(), n[A].c = B, _change(<span class="number">1</span> ,<span class="number">1</span>, N, Id[n[A].v], Id[n[A].v], B) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¢˜æœ‰ä¸€ä¸ªå–ç›¸åæ•°çš„æ“ä½œï¼Œé‡åˆ°è¿™ç§æ­£åéƒ½éœ€è¦è€ƒè™‘çš„ï¼Œ$tag$ä¸€å®šæ˜¯<strong>å¼‚æˆ–è€Œä¸æ˜¯è¦†ç›–</strong> â€¦â€¦æ˜¯ä¸€ä¸ªå‘ç‚¹</p>
<p>$\mathscr{T2 ~\text{ã®} ~code}$</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, c ;</span><br><span class="line">&#125;n[MAX &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v, next, to ; <span class="comment">//0 = Change, 1 = Add .</span></span><br><span class="line">&#125;e[MAX &lt;&lt; <span class="number">1</span>] ; <span class="keyword">char</span> STR[<span class="number">50</span>] ; <span class="keyword">int</span> A, B, C ;</span><br><span class="line"><span class="keyword">int</span> Rec[MAX], Id[MAX], Aft[MAX] ;<span class="keyword">int</span> N, tot ;</span><br><span class="line"><span class="keyword">int</span> M[MAX &lt;&lt; <span class="number">1</span>], T[MAX &lt;&lt; <span class="number">1</span>][<span class="number">2</span>], head[MAX], cnt, i ;</span><br><span class="line"><span class="keyword">int</span> Top[MAX], Fa[MAX], Sum[MAX], Son[MAX], Dep[MAX];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>, f = <span class="number">1</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) &#123;<span class="keyword">if</span> (c == <span class="string">'-'</span>) f = <span class="number">-1</span> ; c = getchar() ;&#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) res = (res &lt;&lt; <span class="number">1</span>) + (res &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> res * f ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Add(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)&#123;</span><br><span class="line">    e[++ cnt].v = c, e[cnt].to = v ;</span><br><span class="line">    e[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">    e[++ cnt].v = c, e[cnt].to = u ;</span><br><span class="line">    e[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> F, <span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    Sum[now] = <span class="number">1</span>, Fa[now] = F, Dep[now] = Dep[F] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = e[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span> (e[k].to == F) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs1(now, e[k].to) ;</span><br><span class="line">        Sum[now] += Sum[e[k].to] ;</span><br><span class="line">        <span class="keyword">if</span> (Sum[e[k].to] &gt; Sum[Son[now]]) Son[now] = e[k].to ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> Tp)</span></span>&#123;</span><br><span class="line">    Id[now] = ++ tot, Top[now] = Tp ;</span><br><span class="line">    <span class="keyword">if</span> (Son[now]) dfs2(Son[now], Tp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = e[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span> (e[k].to == Fa[now] || e[k].to == Son[now]) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs2(e[k].to, e[k].to) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_u</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;M[rt] = max(M[Rs(rt)], M[Ls(rt)]) ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">P_d</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L == R) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (T[rt][<span class="number">0</span>] != <span class="number">-1</span>)&#123;</span><br><span class="line">        M[Ls(rt)] = T[rt][<span class="number">0</span>], M[Rs(rt)] = T[rt][<span class="number">0</span>] ;</span><br><span class="line">        T[Rs(rt)][<span class="number">0</span>] = T[rt][<span class="number">0</span>], T[Ls(rt)][<span class="number">0</span>] = T[rt][<span class="number">0</span>]; </span><br><span class="line">        T[rt][<span class="number">0</span>] = <span class="number">-1</span>, T[Rs(rt)][<span class="number">1</span>] = <span class="number">0</span>, T[Ls(rt)][<span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (T[rt][<span class="number">1</span>])&#123;</span><br><span class="line">        M[Ls(rt)] += T[rt][<span class="number">1</span>], M[Rs(rt)] += T[rt][<span class="number">1</span>] ;</span><br><span class="line">        T[Rs(rt)][<span class="number">1</span>] += T[rt][<span class="number">1</span>], T[Ls(rt)][<span class="number">1</span>] += T[rt][<span class="number">1</span>] ; </span><br><span class="line">        T[rt][<span class="number">1</span>] = <span class="number">0</span> ;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span>  _build(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R)&#123;</span><br><span class="line">    T[rt][<span class="number">0</span>] = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (L == R) &#123;M[rt] = <span class="number">0</span> ; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    _build(Ls(rt), L, Mid), _build(Rs(rt), Mid + <span class="number">1</span>, R) ;</span><br><span class="line">    P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _change(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r)&#123;T[rt][<span class="number">0</span>] = M[rt] = k, T[rt][<span class="number">1</span>] = <span class="number">0</span> ; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    P_d(rt, L, R) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) _change(Ls(rt), L, Mid, l, r, k) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) _change(Rs(rt), Mid + <span class="number">1</span>, R, l, r, k) ;</span><br><span class="line">    P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _update(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r)&#123;T[rt][<span class="number">1</span>] += k, M[rt] += k ; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    P_d(rt, L, R) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) _update(Ls(rt), L, Mid, l, r, k) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) _update(Rs(rt), Mid + <span class="number">1</span>, R, l, r, k) ;</span><br><span class="line">    P_u(rt) ;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> _query(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r) <span class="keyword">return</span> M[rt] ;</span><br><span class="line">    P_d(rt, L, R) ; <span class="keyword">int</span> Maxxxxx = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) Maxxxxx = max(Maxxxxx, _query(Ls(rt), L, Mid, l, r)) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) Maxxxxx = max(Maxxxxx, _query(Rs(rt), Mid + <span class="number">1</span>, R, l, r)) ;</span><br><span class="line">    <span class="keyword">return</span> Maxxxxx ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Update(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> d)&#123;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        _update(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u], d) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    _update(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v], d) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get_Max</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        ret = max(ret, _query(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u])) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> ret ;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    ret = max(ret, _query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v])) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Cover(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> d)&#123;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        _change(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u], d) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    _change(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v], d) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        n[i].u = qr(), n[i].v = qr(), n[i].c = qr(), _Add(n[i].u, n[i].v, n[i].c) ;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">1</span>), dfs2(<span class="number">1</span>, <span class="number">1</span>), _build(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (Dep[n[i].u] &gt; Dep[n[i].v]) swap(n[i].u,n[i].v);</span><br><span class="line">        _change(<span class="number">1</span>, <span class="number">1</span>, N, Id[n[i].v], Id[n[i].v], n[i].c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; STR ;</span><br><span class="line">    <span class="keyword">while</span>(STR[<span class="number">0</span>] != <span class="string">'S'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'A'</span>) A = qr(), B = qr(), C = qr(), _Update(A, B, C) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'M'</span>) A = qr(), B = qr(), <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Get_Max(A, B)) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'C'</span> &amp;&amp; STR[<span class="number">1</span>] == <span class="string">'o'</span>) A = qr(), B = qr(), C = qr(), _Cover(A, B, C) ;    </span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'C'</span> &amp;&amp; STR[<span class="number">1</span>] == <span class="string">'h'</span>) A = qr(), B = qr(), n[A].c = B, _change(<span class="number">1</span> ,<span class="number">1</span>, N, Id[n[A].v], Id[n[A].v], B) ;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, STR) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªé¢˜ä¹Ÿæœ‰ä¸€ä¸ªå‘ç‚¹ï¼Œä¸è¿‡æˆ‘ä¼¼ä¹æ³¨æ„åˆ°äº†ï¼Œå°±æ˜¯å®ƒå®é™…ä¸Šæœ‰ä¸¤ç§éœ€è¦ä¸‹ä¼ çš„æ ‡è®°ï¼Œä¸€ç§æ˜¯èµ‹å€¼ï¼Œä¸€ç§æ˜¯åŠ ï¼Œåœ¨ç®—æ ‡è®°çš„æ—¶å€™æ³¨æ„ä¸€ä¸‹å°±å¥½äº† ã€‚</p>
<h2 id="ä¸æ ‘å½¢-mathbb-DP-çš„å·§å¦™ç»“åˆ"><a href="#ä¸æ ‘å½¢-mathbb-DP-çš„å·§å¦™ç»“åˆ" class="headerlink" title="ä¸æ ‘å½¢$\mathbb{DP}$ çš„å·§å¦™ç»“åˆ"></a>ä¸æ ‘å½¢$\mathbb{DP}$ çš„å·§å¦™ç»“åˆ</h2><p>è¿™ä¸ªåœ°æ–¹å…¶å®è¯´çš„æ˜¯ä¸€ç±»é—®é¢˜ã€‚ã€‚ã€‚æ¯”å¦‚ä¸€é“<del>æˆ‘æ ¹æœ¬ä¸ä¼šçš„</del> ç»å…¸é¢˜ï¼š</p>
<p>$\rm Description$</p>
<p>ä¸€æ£µå¸¦æƒæ ‘ï¼Œ$n$ä¸ªç‚¹$q$æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ä¸€ä¸ªç‚¹çš„$\sum dis_{odd}$å’Œ$\sum dis_{even}$ã€‚</p>
<p>$\mathcal{Solution}$</p>
<p>å…¶å®è¿™ä¸ªé¢˜çš„é¢˜ç›®æ„æ€æ˜¯è®©æˆ‘ä»¬æ±‚ï¼š</p>
<blockquote>
<p>$R$å›æƒ³çŸ¥é“å¯¹äºæ¯ä¸ªç‚¹æ¥è¯´ï¼Œåˆ°è¿™ä¸ªç‚¹æ˜¯è·ç¦»å¥‡æ•°çš„èŠ‚ç‚¹çš„è·ç¦»å’Œï¼Œä¸åˆ°è¿™ä¸ªç‚¹è·ç¦»æ˜¯å¶æ•°çš„èŠ‚ç‚¹çš„è·ç¦»å’Œã€‚    </p>
</blockquote>
<p>é‚£ä¹ˆæˆ‘ä»¬ä¸å¦¨å…ˆä»ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„é—®é¢˜å¼€å§‹è€ƒè™‘ï¼šå¦‚ä½•æ±‚ä¸€ä¸ªç‚¹åˆ°å®ƒå­æ ‘çš„è·ç¦»å’Œå‘¢ï¼Ÿ</p>
<p>è¿™ä¸ªä¸œè¥¿æ¯”è¾ƒç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ç›´æ¥$dfs$ã€‚</p>
<p>é‚£ä¹ˆå¦‚æœæ˜¯æ±‚æ‰€æœ‰ç‚¹åˆ°æ‰€æœ‰ç‚¹çš„è·ç¦»å’Œå‘¢ï¼Ÿ</p>
<p>æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåˆšæ‰è¿™ä¸ªååˆ†ç®€å•çš„é—®é¢˜ï¼Œå‡åæˆä¸ºä¸€ä¸ªç¨å¾®å›°éš¾ä¸€äº›çš„é—®é¢˜ï¼šå¯¹äºæ¯ä¸ªç‚¹$u$ï¼Œæ±‚æ‰€æœ‰ç‚¹ä¸å®ƒçš„è·ç¦»ä¹‹å’Œï¼Œè·ç¦»ä¾è¾¹æƒè€Œå®šã€‚</p>
<p>æˆ‘é¦–å…ˆå¿½ç•¥è¾¹æƒï¼Œä»¤è¾¹æƒéƒ½æ˜¯$1$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€è€ƒï¼Œæˆ‘ä»¬æ ¹æ®å·²çŸ¥æ¡ä»¶ï¼Œå¾ˆå®¹æ˜“çŸ¥é“çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¸€ä¸ªé—®é¢˜çŸ¥é“<strong>æ ¹èŠ‚ç‚¹åˆ°æ‰€æœ‰ç‚¹çš„è·ç¦»ä¹‹å’Œ</strong>ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥çŸ¥é“æ¯ä¸ªèŠ‚ç‚¹å­æ ‘å†…çš„è¾¹æƒä¹‹å’Œï¼Œé‚£ä¹ˆå¦‚ä½•åˆ©ç”¨è¿™äº›å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œæ­¤æ—¶æˆ‘ä»¬çŸ¥é“çš„é‡ï¼ŒåŒä¸€èˆ¬çš„æ ‘å½¢$DP$æˆ–è€…è¯´æ ‘å½¢ç»“æ„ä¸åŒï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“äº†<strong>æ¯ä¸€ä¸ªå­æ ‘çš„æ ¹èŠ‚ç‚¹çš„è®¯æ¯ï¼›</strong>è€Œå¹³å¸¸çš„æ ‘å½¢ç»“æ„ï¼Œæˆ‘ä»¬çŸ¥é“çš„åˆ™æ˜¯<strong>å­èŠ‚ç‚¹çš„è®¯æ¯$or$å­æ ‘çš„è®¯æ¯</strong>ï¼Œè¿™ä¸€ç‚¹æç¤ºæˆ‘ä»¬ï¼š<strong>åå‘$DP$</strong></p>
<p>æˆ‘ä»¬ä¸å¦¨è®¾$dp_u$è¡¨ç¤º$\sum \limits_{i \in T}^{}{dist(i,u)}$ é‚£ä¹ˆæˆ‘ä»¬æ€è€ƒå¦‚ä½•æ„é€ ç›¸é‚»ä¸¤å±‚çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å·²ç»å†³å®šåå‘$DP$ï¼Œæ¢å¥è¯è¯´å°±æ˜¯<strong>ç”¨çˆ¶äº²æ¨å‡ºå„¿å­</strong>ï¼›å¹¶ä¸”æˆ‘ä»¬äº†è§£åˆ°ï¼Œå¯¹äºæŸä¸€ä¸ªç‚¹$u$ï¼Œä»–çš„<strong>æ‰€æœ‰å­èŠ‚ç‚¹åˆ°ä»–çš„è·ç¦»è¦æ¯”åˆ°ä»–çš„çˆ¶äº²çš„è·ç¦»å°‘$1$</strong>ï¼ˆå‡è®¾è¾¹æƒ$=1$ï¼‰ï¼ŒåŒæ—¶æ‰€æœ‰<strong>é™¤å…¶å­æ ‘ä¹‹å¤–çš„æ‰€æœ‰ç‚¹åˆ°ä»–çš„è·ç¦»ä¼šå¤š$1$</strong>.é‚£ä¹ˆè½¬ç§»æ–¹ç¨‹æ—§é¡ºæ°´æ¨èˆŸåœ°ï¼š</p>
<script type="math/tex; mode=display">
dp_v = dp_u - subsize_v + (n - subsize_v), v \in son_u</script><p>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬æ€è€ƒï¼Œå½“è¾¹æƒä¸ä¸º$1$çš„æ—¶å€™å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç¨å¾®é­”æ”¹ä¸€ä¸‹ä¸Šå¼ï¼Œäºæ˜¯å°±å¾—åˆ°</p>
<script type="math/tex; mode=display">
dp_v = dp_u - 2 \cdot pre_v \cdot  subsize_v + N \cdot pre_v</script><p>å…¶ä¸­$pre_i$è¡¨ç¤ºèŠ‚ç‚¹$i$çš„ä¸Šè¡Œè¾¹ï¼Œå³çˆ¶äº²ä¸å®ƒç›¸è¿çš„é‚£æ¡è¾¹ã€‚</p>
<p>é‚£ä¹ˆä»¥ä¸Šç®€å•ç‰ˆæœ¬çš„ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to, next ;</span><br><span class="line">&#125;E[MAX] ; <span class="keyword">int</span> head[MAX], cnt ; </span><br><span class="line"><span class="keyword">int</span> N, A, B, i, j, dp[MAX], sub[MAX], Pre[MAX] ; </span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Add(<span class="keyword">int</span> u, <span class="keyword">int</span> v)&#123;</span><br><span class="line">	E[++ cnt].to = v, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">	E[++ cnt].to = u, E[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">	sub[now] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ;</span><br><span class="line">		build(to(k), now) ;  </span><br><span class="line">		sub[now] += sub[E[k].to], dp[<span class="number">1</span>] += sub[E[k].to] ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fwork</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (E[k].to == f) <span class="keyword">continue</span> ;</span><br><span class="line">		dp[E[k].to] = dp[now] - <span class="number">2</span> * sub[E[k].to] + N ;</span><br><span class="line">		fwork(to(k), now) ; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) </span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B), _Add(A, B) ;</span><br><span class="line">	build(<span class="number">1</span>, <span class="number">0</span>) ; fwork(<span class="number">1</span>, <span class="number">0</span>) ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dp[i]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å”¯ä¸€å€¼å¾—æ³¨æ„çš„åœ°æ–¹å°±æ˜¯å…¶ä¸­$dp_1$æˆ–è€…è¯´$dp_{root}$çš„å¤„ç†ã€‚é‚£ä¹ˆå…¶å®è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬åªéœ€è¦ä¸æ–­åŠ $size$å³å¯ã€‚</p>
<p>é«˜ç«¯ç‰ˆæœ¬çš„é—®é¢˜ï¼Œä»£ç ç±»ä¼¼ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to, next, v ;</span><br><span class="line">&#125;E[MAX &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> head[MAX], cnt, i ;</span><br><span class="line"><span class="keyword">int</span> N, Sub[MAX], Pre[MAX], dp[MAX], Sum, A, B, C ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">	Sub[now] = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ;</span><br><span class="line">		build(to(k), now) ;  Pre[to(k)] = E[k].v ;</span><br><span class="line">		Sub[now] += Sub[to(k)], dp[<span class="number">1</span>] += Pre[to(k)] * Sub[to(k)] ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp_work</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)&#123;</span><br><span class="line">		<span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ;</span><br><span class="line">		dp[to(k)] = dp[now] - <span class="number">2</span> * Pre[to(k)] * Sub[to(k)] + N * Pre[to(k)] ; dp_work(to(k), now) ;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">	E[++ cnt].to = v, E[cnt].v = w, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">	E[++ cnt].to = u, E[cnt].v = w, E[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) </span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;A, &amp;B, &amp;C), Add(A, B, C) ;;</span><br><span class="line">	build(<span class="number">1</span>, <span class="number">0</span>) ; dp_work(<span class="number">1</span>, <span class="number">0</span>) ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cout</span> &lt;&lt; dp[i] &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå›å½’åˆ°æˆ‘ä»¬çš„é—®é¢˜ï¼Œæˆ‘ä»¬è¦æ±‚çš„æ˜¯å¥‡æ•°è·ç¦»$\&amp;$å¶æ•°è·ç¦»ï¼Œå¾ˆç®€å•ï¼Œå†åŠ ä¸€ç»´å³å¯ã€‚</p>
<p>æˆ‘ä»¬è‡´åŠ›äºç»´æŠ¤è¿™æ ·ä¸€ä¸ªä¸œè¥¿ï¼šå¯¹äºæ¯ä¸ª$u \in T$ï¼Œ æˆ‘ä»¬è¯•å›¾ç¡®å®šé™¤$u$åŠå…¶å­æ ‘å¤–ï¼Œåˆ°$u$ç‚¹è·ç¦»æ˜¯å¥‡æ•°çš„ç‚¹çš„ä¸ªæ•°$S0$$\&amp;$è·ç¦»æ˜¯å¶æ•°çš„ç‚¹çš„ä¸ªæ•°$S1$ï¼Œä»¥ä¾¿äºçŠ¶æ€è½¬ç§»æ—¶ï¼Œä½œä¸ºç¬¬äºŒéƒ¨åˆ†ã€‚é‚£ä¹ˆå¹³å‡æ ‘é«˜ä¸‹ï¼Œç›´æ¥åœ¨$dfs/bfs$é‡Œé¢æ¥å›èµ‹å€¼å³å¯ã€‚ä½†æ˜¯è¿˜æ˜¯æœ‰éœ€è¦æ³¨æ„çš„åœ°æ–¹â€”â€”æ¯”å¦‚è¯´è¾¹ä¸ºå¥‡æ•°çš„æ—¶å€™ï¼Œçˆ¶å­èŠ‚ç‚¹çš„ä¸¤ä¸ªå€¼éœ€è¦$swap$ä¸€ä¸‹ï¼Œå¹¶ä¸”è¾¹æƒä¸ºå¥‡æ•°çš„æ—¶å€™ï¼Œæ˜¯äº¤å‰è½¬ç§»çš„ï¼ˆå¥‡æ•°çŠ¶æ€è½¬ç§»ç»™å¶æ•°çŠ¶æ€ï¼‰ï¼š</p>
<script type="math/tex; mode=display">
dp[to(k)][0] = dp[now][1] - Sub[to(k)][0] * Pre[to(k)] \\ dp[to(k)][1] = dp[now][0] - Sub[to(k)][1] * Pre[to(k)] ï¼Œ\\ dp[to(k)][0] += S0 * Pre[to(k)] , \\ dp[to(k)][1] += S1 * Pre[to(k)] ;</script><p>å…¶ä¸­$to(k) \in son_{now}$</p>
<p>è€Œå¶æ•°çš„æ—¶å€™ï¼Œæ˜¾ç„¶ä¸æ˜¯äº¤å‰è½¬ç§»çš„ï¼ˆå¥‡æ•°çŠ¶æ€è½¬ç§»ç»™å¥‡æ•°çŠ¶æ€ï¼‰ï¼š</p>
<script type="math/tex; mode=display">dp[to(k)][1] = dp[now][1] - Sub[to(k)][1] * Pre[to(k)] ;\\ dp[to(k)][0] = dp[now][0] - Sub[to(k)][0] * Pre[to(k)] ;\\        dp[to(k)][1] += S1 * Pre[to(k)],\\         dp[to(k)][0] += S0 * Pre[to(k)] ;</script><p>äºæ˜¯å°±ç»“æŸäº†ã€‚å…¶å®è¿™ä¸ªåœ°æ–¹è½¬ç§»æ–¹å¼ååˆ†çš„å¤šï¼Œä½†æ˜¯å…³é”®çš„è£…å¥—è½¬ç§»æ–¹ç¨‹å…¶å®å°±æ˜¯ä¸€å¥ï¼š</p>
<script type="math/tex; mode=display">
dp_v = dp_u - 2 \cdot pre_v \cdot  subsize_v + Count \cdot pre_vs</script><p>å…¶ä¸­$Count$è¡¨ç¤ºæŸç§ç¥ç§˜çš„è®¡æ•°ã€‚ã€‚ã€‚ã€‚</p>
<p>é‚£ä¹ˆå…¶å®è¿™ç§é—®é¢˜è¿˜å¯ä»¥æ‹“å±•åˆ°â€œæ±‚å¯¹äºæ¯ä¸€ä¸ªç‚¹$u$ï¼Œ$dist(u,v) \mod n =k$çš„ç‚¹çš„ä¸ªæ•°ï¼Œå…¶ä¸­$k \in [0,k-1]$ï¼Œæˆ‘æ„Ÿè§‰åšæ³•åº”è¯¥ä¼šç±»ä¼¼å§<del>ï¼ˆä½†æ˜¯æˆ‘è‚¯å®šä¸ä¼šåšå› ä¸ºæ ¹æœ¬ä¸å¯èƒ½è°ƒçš„å‡ºæ¥ï¼‰</del></p>
<h1 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h1><ul>
<li>æ²¡å•¥å¥½è¯´çš„ï¼Œåªè§‰å¾—ç¬¬ä¸‰æ¨¡å—çš„ä¾‹é¢˜ååˆ†éš¾è°ƒï¼ååˆ†éš¾è°ƒï¼ï¼ï¼å¹¶ä¸”â€¦â€¦æˆ‘ä¸€å¼€å§‹æ²¡ç”¨$S0$æˆ–è€…$S1$ï¼Œç›´æ¥ç”¨çš„æ ¹èŠ‚ç‚¹çš„$sub_0$å’Œ$sub_1$ï¼Œæœ€åæ‰æ³•æ¡ˆæ ¹æœ¬ä¸å’Œé€»è¾‘ã€‚ã€‚ã€‚ä½†ä»–å±…ç„¶è¿‡æ ·ä¾‹äº†ã€‚ã€‚ã€‚</li>
<li>è½¬ç§»çš„æ—¶å€™è¿˜æ˜¯éœ€è¦æœ‰ä¸€ä¸ªæ¸…é†’çš„æ€è·¯å†codeå•Šï¼</li>
<li>$DP$å¥½å•Šï¼</li>
</ul>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>æ¨¡å‹</category>
      </categories>
      <tags>
        <tag>æ ‘æ¨¡å‹</tag>
        <tag>åŠ¨æ€è§„åˆ’/æ ‘å½¢DP</tag>
        <tag>æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è½»é‡é“¾å‰–åˆ†</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘çº¿æ€§è§„åˆ’å…¥é—¨</title>
    <url>/2019/03/15/%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt></p>
<p>è®¸ä¹…ä¹‹å‰å¼€å§‹å­¦çš„ç®—æ³•äº†â€¦ä»Šå¤©ç»ˆäºå­¦å®Œäº†ã€‚ä¸»è¦å‚è€ƒçš„ææ–™æ˜¯è‘£å…‹å‡¡çš„ $ 2016 $ é›†è®­é˜Ÿè®ºæ–‡å’Œ $ \rm{Candy?} $ çš„ä»£ç æ•´ç†ï¼Œåœ¨æ­¤å¤„è‡´ä»¥æ•¬æ„ã€‚</p>
<hr>
<h1 id="rm-0x01-Preface"><a href="#rm-0x01-Preface" class="headerlink" title="$ \rm{0x01~ Preface} $"></a>$ \rm{0x01~ Preface} $</h1><p>çº¿æ€§è§„åˆ’ä¸»è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å¤§åŒ–}\quad \sum c_ix_i \quad(i = 1, 2,3 \cdots n) \\
\text{æ»¡è¶³çº¦æŸ} \quad \sum \limits_{j=1}^{n} a_{i,j}x_{j} \leq b_i\quad (i = 1,2,3\cdots m) \\\ \qquad \qquad \qquad \quad x_j \geq 0\quad (j=1,2,3\cdots n)</script><p>ä¸å¤±ä¸€èˆ¬æ€§çš„ï¼Œæˆ‘ä»¬å®šä¹‰æœ€å¤§åŒ–çš„å‡½æ•°ä¸º<strong>ç›®æ ‡å‡½æ•°( $ \rm{Aim-Func} $ )</strong> ï¼Œå®šä¹‰çº¦æŸå‡½æ•°çš„é›†åˆä¸º<strong>çº¦æŸå‡½æ•°é›†( $ \rm{Constraint-Set} $ )</strong>ã€‚é‚£ä¹ˆæœ´ç´ çš„çº¿æ€§è§„åˆ’å¯ä»¥çœ‹æ±‚ä¸€ç»„å‘é‡{ $ x_1,x_2\cdots x_n $ }ï¼Œä½¿ä¹‹æ—¢å¯ä»¥åšçº¦æŸå‡½æ•°çš„å› å˜é‡ï¼Œåˆæ»¡è¶³å…¶ç›®æ ‡å‡½æ•°çš„å€¼ä¸º $ max $ ã€‚</p>
<p>åŒæ—¶ï¼Œè§„å®šæ‰€æœ‰çš„ $ x $ å‡æ»¡è¶³ $ x&gt;0 $ ã€‚</p>
<a id="more"></a>
<p>å½“ç„¶ï¼Œå­˜åœ¨ä¸€ç§æ›´åŠ èµå¿ƒæ‚¦ç›®çš„çŸ©é˜µè¡¨ç¤ºæ–¹å¼ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å¤§åŒ–}\quad \boldsymbol{c^Tx} \\
\text{æ»¡è¶³çº¦æŸ} \quad A\boldsymbol{x\leq b} \\\
\it{\qquad \qquad \quad} \boldsymbol {x} \geq 0</script><p>å…¶ä¸­ $ \boldsymbol{c,x,b} $ å‡ä¸ºä¸€ç»´å‘é‡ï¼Œ $ A $ ä¸ºç³»æ•°çŸ©é˜µã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬åœ¨é«˜ä¸­æ•°å­¦å¿…ä¿®äº”é‡Œé¢è¿ç”¨çš„æ™ºéšœåšæ³•æ˜¯ï¼Œé€šè¿‡æ¯ä¸ªçº¦æŸç¡®å®šä¸€ä¸ªå‡¸åŒ…ï¼Œå†ç”¨ç›®æ ‡å‡½æ•°ä¸æ–­å¹³ç§»ä»¥æ±‚å¾—ä¸å‡¸åŒ…çš„åˆ‡ç‚¹/åˆ‡çº¿æ¥è¾¾åˆ°æœ€å¤§å€¼ï¼Œä½†æ˜¯è¿™æ ·çš„åšæ³•é€šå¸¸ä¸å…·æœ‰ä¸€èˆ¬æ€§ã€‚æ‰€ä»¥éœ€è¦å¼•å…¥ä¸€ç§æ›´å¸¸ç”¨çš„æ–¹æ³•æ¥è§£å†³è¿™ç±»é—®é¢˜ã€‚</p>
<h1 id="rm-0x02-æ¾å¼›å‹çŸ©é˜µä¸-rm-Pivot-æ“ä½œ"><a href="#rm-0x02-æ¾å¼›å‹çŸ©é˜µä¸-rm-Pivot-æ“ä½œ" class="headerlink" title="$ \rm{0x02} $  æ¾å¼›å‹çŸ©é˜µä¸ $ \rm{Pivot} $ æ“ä½œ"></a>$ \rm{0x02} $  æ¾å¼›å‹çŸ©é˜µä¸ $ \rm{Pivot} $ æ“ä½œ</h1><p>æˆ‘ä»¬è€ƒè™‘ä¸€ç§æ›´åŠ å‹å¥½çš„çº¿æ€§è§„åˆ’æ–¹å¼â€”â€”<strong>æ¾å¼›å‹çŸ©é˜µ</strong>ï¼Œå³å°†åŸæ¥çš„çŸ©é˜µæ·»åŠ å‡ ä¸ªæ— å®é™…ä½œç”¨çš„æ–°å˜é‡ $ x_i $ ï¼Œä½¿ä¹‹æ¢ä¸€ä¸ªæ ·å­ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å¤§åŒ–}\quad \sum c_ix_i \quad(i = 1, 2,3 \cdots n) \\
\text{æ»¡è¶³çº¦æŸ} \quad x_{n+i} = b_i - \sum \limits_{j=1}^{n} a_{i,j}x_{j} \quad (i = 1,2,3\cdots m) \\\ \qquad\quad  x_j \geq 0\quad (j=1,2,3\cdots n+m)</script><p>ä¸¤ç§è¡¨ç¤ºæ˜¯ç­‰ä»·çš„ï¼Œä½†æ˜¯æˆ‘ä»¬æ›´å€¾å‘äºæ¾å¼›å‹è¿™ç§ç®€æ´çš„è¡¨è¿°æ–¹å¼ã€‚</p>
<p>åŒæ—¶æˆ‘ä»¬è§„å®šä»¥ä¸‹ï¼š</p>
<p> $ 1. $ åŸºå˜é‡ï¼šåœ¨æ¾å¼›å‹çº¦æŸä¸­ï¼Œç­‰å¼å·¦è¾¹çš„å˜é‡ã€‚</p>
<p> $ 2. $ éåŸºå˜é‡ï¼šåœ¨æ¾å¼›å‹çº¦æŸä¸­ï¼Œç­‰å¼å³è¾¹çš„å˜é‡ã€‚</p>
<p>é‚£æˆ‘ä»¬å®šä¹‰ä¸€æ¬¡<strong>è½¬è½´æ“ä½œ $ (pivot) $ </strong>ä¸º<strong>å°†ä¸€ä¸ªåŸºå˜é‡æ¢è¿›ç­‰å¼å³è¾¹ï¼Œæ¢å‡ºä¸€ä¸ªéåŸºå˜é‡çš„è¿‡ç¨‹</strong>ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬åœ¨ç¬¬ $ i $ ç»„çº¦æŸä¸­ï¼Œæœ‰ä¸€ä¸ªå˜é‡ $ x_k~(k&gt;n) $ æ˜¯åŸºå˜é‡ï¼Œæˆ‘ä»¬è¦æ¢å‡ºä¸€ä¸ªéåŸºå˜é‡ $ x_p~(1\leq p\leq n) $ ï¼Œé‚£ä¹ˆå°±ä¼šç”±ï¼š</p>
<script type="math/tex; mode=display">
x_k= b_i -\sum \limits_{j=1}^{n} a_{i,j}x_{j}</script><p>å˜æˆ</p>
<script type="math/tex; mode=display">
x_p = \frac{b_i - \sum \limits_{j\neq p}a_{i,j}x_j -x_k}{a_{i,p}}</script><p>è€Œå•çº¯æ€§åšæ³•çš„æœ¬è´¨å°±æ˜¯é€šè¿‡ä¸æ–­è½¬è½´ï¼Œå®ç°ç›®æ ‡å‡½æ•°ä¸æ–­å˜å¤§ã€‚</p>
<p>çœ‹ä¸Šå»ä¼¼ä¹æ¯”è¾ƒæŠ½è±¡ï¼Ÿæˆ‘ä»¬è€ƒè™‘å¯¹ä¸€æ¬¡è½¬è½´æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦åœ¨è½¬è½´ä¹‹åå°†åŸæ¥ç›®æ ‡å‡½æ•°é‡Œçš„éåŸºå˜é‡ä»£å…¥ï¼Œå³ç”¨ $ (b_i - \sum _{j\neq p}a_{i,j}x_j -x_k)/a_{i,p} $ è¿™ä¸ªä¸œè¥¿å»æ›¿æ¢æ‰ $ x_p $ ï¼Œé‚£ä¹ˆå…¶ä¸­çš„å¸¸æ•°é¡¹ $ \frac{b_i}{a_{i,p}} $ å°±å¯ä»¥ä½œä¸ºç›®æ ‡å‡½æ•°ä¸­çš„ä¸€ä¸ªå¸¸æ•°å€¼ï¼Œå½“ $ x_i~(i=1,2,3\cdots n) $ å‡ä¸º $ 0 $ æ—¶ï¼Œç›®æ ‡å‡½æ•°çš„å€¼å³ä¸ºæ­¤ã€‚é‚£ä¹ˆè½¬è½´æ“ä½œå°±æ˜¯é€šè¿‡è¿™æ ·çš„æ“ä½œä½¿å¾—ç›®æ ‡å‡½æ•°é‡Œçš„å¸¸æ•°å€¼ä¸æ–­å¢å¤§ï¼Œè¾¾åˆ°æœ€ä¼˜è§£ã€‚</p>
<p>æ³¨æ„ï¼Œè½¬è½´ä¹‹åçš„å¾—åˆ°çš„ $ x_p $ çš„è¡¨è¾¾å¼ï¼Œä¸ä»…è¦ä»£å…¥ç›®æ ‡å‡½æ•°ï¼Œä¹Ÿè¦ä»£å…¥å…¶ä½™çš„çº¦æŸã€‚</p>
<h1 id="rm-0x03-rm-Simplex"><a href="#rm-0x03-rm-Simplex" class="headerlink" title="$ \rm{0x03}~ \rm{Simplex} $"></a>$ \rm{0x03}~ \rm{Simplex} $</h1><p>é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è€ƒè™‘å•çº¯æ€§åšæ³•çš„å®Œæ•´è¿‡ç¨‹ã€‚</p>
<p>ä¸å¤±ä¸€èˆ¬æ€§çš„ï¼Œæˆ‘ä»¬å‡è®¾æ‰€æœ‰ $ b_i\geq 0 $ </p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯¹äºè½¬è½´æ“ä½œç»“æŸï¼Œå›ä»£ä¸€æ¬¡ä¹‹åï¼Œä¼šå‘ç°ç›®æ ‡å‡½æ•°ä¸­è‚¯å®šä¼šæœ‰è‡³å°‘ä¸€é¡¹ç³»æ•°å˜ä¸ºè´Ÿå€¼ï¼Œå³è½¬è¿›æ¥çš„å‰Â·åŸºå˜é‡ $ x_k $ ï¼Œé‚£ä¹ˆå¢å¤§ $ x_k $ ä¸€å®šä¼šè®©ç»“æœç›®æ ‡å‡½æ•°å˜å°ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ–­è¨€ï¼Œ<strong>å½“ç›®æ ‡å‡½æ•°é‡Œçš„æ‰€æœ‰å˜é‡ç³»æ•°å‡ä¸ºè´Ÿå€¼æ—¶ï¼Œç›®æ ‡å‡½æ•°çš„æœ€ä¼˜å€¼å°±ä¼šæ˜¯ç°åœ¨ç›®æ ‡å‡½æ•°ä¸­çš„å¸¸æ•°å€¼</strong>â€”â€”å› ä¸ºæˆ‘ä»¬åœ¨å‰æ–‡å·²ç»å‡å®š $ x_i\geq 0 $ äº†ã€‚</p>
<p>åŒæ ·ï¼Œæˆ‘ä»¬æ¯æ¬¡è½¬è½´æ“ä½œéœ€è¦ä¿æŒåŸæ¥çº¿æ€§è§„åˆ’çš„ä¸å˜æ€§ï¼Œæ¢å¥è¯è¯´å°±æ˜¯æˆ‘ä»¬æ¯æ¬¡è½¬è½´æ—¶<strong>éƒ½éœ€è¦æ‰¾ä¸€ä¸ªå¯¹ä¸æŸä¸ªéåŸºå˜é‡é™åˆ¶æœ€ç´§çš„çº¦æŸï¼Œå°†å…¶æ¢å‡º</strong>ã€‚åŸå› æ˜¯æˆ‘ä»¬è€ƒè™‘ç›®æ ‡å‡½æ•°ä¸­çš„ $ x_i $ ï¼Œå½“å…¶ç³»æ•° $ \geq 0 $ æ—¶ï¼Œ $ \rm{Aim  }\propto x_i $ ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªæœ€ç´§çš„çº¦æŸ<strong>éæ­¢</strong> $ x_i $ çš„å¢é•¿(å³ä½¿æˆ‘ä»¬ä¸æƒ³)ã€‚</p>
<p>é‚£ä¹ˆä¼ªä»£ç å¦‚ä¸‹ï¼Œ $ A,\boldsymbol{b,c} $ çš„å®šä¹‰ä¸€å¼€å§‹å·²ç»™å‡ºï¼š</p>
<hr>
<p>Simplex(A, b, c){<br> $ \qquad $  initialization(A,b,c)  ;<br> $ \qquad $  while  $ âˆƒe $  that  $ c_e&gt;0 $ {<br> $ \qquad  \qquad $ find the index  $ l $  that  $ A_{l,e} $   $ &gt; 0 $  and minimizes  $ b_l/A_{l,e} $<br> $ \qquad \qquad $ if  $ âˆ€l, A_{l,e} â‰¤ 0 $<br> $ \qquad \qquad \qquad $ return Unbounded ;<br> $ \qquad \qquad $ else<br> $ \qquad \qquad \qquad $ pivot(A, b, c, l, e)ï¼›<br>}</p>
<hr>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœåœ¨å¯»æ‰¾å®Œæœ€ç´§çº¦æŸåï¼Œå­˜åœ¨ä¸€ä¸ª $ A_{l,e} \leq 0 $ ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨è¿™ç»„çº¦æŸé‡Œæ— è®ºæ€ä¹ˆå¢å¤§ $ x_e $ éƒ½ä¼šä½¿å¾—ç›®æ ‡å‡½æ•°å¢å¤§ï¼Œæ‰€ä»¥ç›´æ¥<code>return Unbounded</code>ã€‚</p>
<p>æ­¤æ—¶æˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œé¢å¤–çš„æ“ä½œï¼Œå³åˆå§‹åŒ–ã€‚å› ä¸ºæˆ‘ä»¬è½¬è½´æ“ä½œçš„ç›®çš„æ˜¯ä½¿ç›®æ ‡å‡½æ•°å¢å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿è¯æ‰€æœ‰çš„ $ b_i\geq 0 $ ï¼Œä½†ä¸€å¼€å§‹ç»™å®šçš„ $ b_i $ å¾ˆå¯èƒ½ä¸æ»¡è¶³è¿™ä¸€çº¦æŸï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€æ¬¡åˆå§‹åŒ–ã€‚é‚£ä¹ˆå¯¹äºåˆå§‹åŒ–ï¼Œæˆ‘ä»¬çš„æ€æƒ³æ˜¯åšå¦ä¸€æ¬¡çº¿æ€§è§„åˆ’ã€‚<del>é¬¼çŸ¥é“é‚£äº›å‘æ˜è¿™ç©æ„å„¿çš„ç¥ä»™æ€ä¹ˆæ„é€ å‡ºçš„è¿™ä¸ªçº¿æ€§è§„åˆ’ã€‚</del></p>
<p>æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªè¿™æ ·çš„çº¿æ€§è§„åˆ’ï¼š</p>
<script type="math/tex; mode=display">
\text{æœ€å¤§åŒ–}\quad -x_0 \\
\text{æ»¡è¶³çº¦æŸ} \quad x_{n+i} = b_i - \sum \limits_{j=1}^{n} a_{i,j}x_{j} +x_0\quad (i = 1,2,3\cdots m)\\
\it{\qquad \qquad \qquad \quad x_j} \geq 0\quad (j=0,1,2,3\cdots n)</script><p>é¦–å…ˆï¼Œæ— è®ºæ€æ ·ï¼Œå…ˆæ€è€ƒä»–ä¼šä¸ä¼šå¯¹åŸæ¥çš„çº¿æ€§è§„åˆ’äº§ç”Ÿä»€ä¹ˆå½±å“â€”â€”ç­”æ¡ˆæ˜¯ï¼šä¸ä¼šã€‚å› ä¸ºæˆ‘ä»¬è€ƒè™‘å½“ $ -x_0 $ æœ€å¤§æ—¶ï¼Œä¸€å®šæ˜¯ $ x_0=0 $ çš„æ—¶å€™ã€‚æ‰€ä»¥å¯¹äºçº¦æŸä¸­çš„ $ x_{n+i} $ ï¼Œå¤§å°ä¸ä¼šå˜åŒ–ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘è¿™ç§åˆå§‹åŒ–æ–¹å¼çš„æ­£ç¡®æ€§ã€‚æˆ‘ä»¬è€ƒè™‘æ¯æ¬¡éƒ½å°† $ x_0 $ ä½œä¸ºæ¢å…¥å˜é‡(å³æˆ‘ä»¬ä¸€å¼€å§‹å°† $ x_0 $ è§†ä½œéåŸºå˜é‡)ï¼Œé‚£ä¹ˆ $ pivot $ ä¹‹åå°±ä¼šæœ‰</p>
<script type="math/tex; mode=display">
x_0 = -b_i+x_{i+n}+\sum\limits_{j=1}^{n}a_{i,j}x_j</script><p>ç”±äºæˆ‘ä»¬ä¸€å®šæ‰¾çš„æ—¶é™åˆ¶æœ€å°çš„ï¼Œé‚£ä¹ˆ $b_i\lt 0\Longrightarrow-b_i\gt 0$ ï¼Œè¿™ç»„çº¦æŸåˆæ³•ã€‚</p>
<p>å¯¹äºå…¶ä½™çš„çº¦æŸï¼Œæˆ‘ä»¬è€ƒè™‘ä»£å…¥ä¹‹åï¼Œä¼šæœ‰ï¼š</p>
<script type="math/tex; mode=display">
x_{n+k}= b_k-b_i+\sum\limits_{j=1}^{n}(a_{k,j}-a_{i,j})x_j+x_{i+n}</script><p>ç”±äº $ b_i $ æœ€å°ï¼Œé‚£ä¹ˆ $ b_k\geq b_i \Longrightarrow b_k-b_i\geq 0 $ ã€‚ä»»åŠ¡å®Œæˆã€‚</p>
<p>é‚£ä¹ˆå°±å¯ä»¥æ„‰å¿«åœ°ä¸Šä»£ç è¾£(â‰§â–½â‰¦)/ï¼é¢˜ç›®æ¥è‡ªäº<a href="http://uoj.ac/problem/179" target="_blank" rel="noopener"> $ \rm{UOJ179} $ </a></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 1010</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>, INF = <span class="number">1e15</span> ;</span><br><span class="line"><span class="keyword">int</span> N, M, T, Id[MAXN], i, j ; <span class="keyword">double</span> A[MAXN][MAXN], Get[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pivot</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> e)</span></span>&#123;</span><br><span class="line">    swap(Id[N + l], Id[e]) ;<span class="comment">//äº¤æ¢ä¸¤ä¸ªå˜é‡</span></span><br><span class="line">    <span class="keyword">double</span> t = A[l][e] ; A[l][e] = <span class="number">1.0</span> ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span> ; i &lt;= N ; ++ i) A[l][i] /= t ;<span class="comment">//ç±»ä¼¼äºé«˜æ–¯æ¶ˆå…ƒçš„ç¬¬ä¸€æ­¥ï¼ŒæŠŠè¿™ä¸€é¡¹æŒªåˆ°ç­‰å¼å³è¾¹ï¼Œæ‰€ä»¥è¦å…ˆéƒ½é™¤ä»¥ç³»æ•°</span></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span> ; i &lt;= M ; ++ i) </span><br><span class="line">        <span class="keyword">if</span>(i != l &amp;&amp; <span class="built_in">fabs</span>(A[i][e]) &gt; eps)</span><br><span class="line">            <span class="keyword">for</span>(t = A[i][e], A[i][e] = j = <span class="number">0</span> ; j &lt;= N ; ++ j) </span><br><span class="line">              A[i][j] -= A[l][j] * t ;<span class="comment">//æ­¤å¤„åˆ™æ˜¯ä»£æ¢ã€‚è€Œç”±äºä»£æ•°å¼ä¸­è‚¯å®šä¸ä¼šå‡ºç°æˆ‘ä»¬çš„A_&#123;i,e&#125;(æ¯•ç«Ÿæ˜¯æ¢åˆ°äº†ç­‰å¼å³è¾¹)ï¼Œæ‰€ä»¥å¯¹äºè¿™ä¸€é¡¹çš„ç³»æ•°è¦ç‰¹æ®Šå¤„ç†æˆ0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> e = <span class="number">0</span>, l = <span class="number">0</span> ; <span class="keyword">double</span> t = -eps ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="keyword">if</span> (A[i][<span class="number">0</span>] &lt; t) l = i, t = A[i][<span class="number">0</span>] ; <span class="keyword">if</span>(!l) <span class="keyword">return</span> <span class="number">1</span> ;<span class="comment">//æ‰¾ç³»æ•°æœ€å°çš„è´Ÿå€¼é¡¹</span></span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j) <span class="keyword">if</span> (A[l][j] &lt; -eps &amp;&amp; (!e || (rand() &amp; <span class="number">1</span>))) e = j ;</span><br><span class="line">        <span class="keyword">if</span> (!e) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"Infeasible"</span>), <span class="literal">false</span> ;  Pivot(l, e) ;</span><br><span class="line">    &#125;<span class="comment">//ä¸åˆæ³•çš„çº¿æ€§è§„åˆ’ï¼Œå› ä¸ºæˆ‘ä»¬å‡è®¾å…¨éƒ¨çš„ç³»æ•°éƒ½ä¸ºæ­£ï¼Œä¸”æˆ‘ä»¬å‰é¢å·²ç»å‡å®šäº†å…¨éƒ¨x_iä¸ºæ­£ï¼Œé‚£ä¹ˆä¸å¯èƒ½æ»¡è¶³æ ‡å‡†å‹é‡Œé¢çš„å°äºb_lâ€”â€”æ­¤æ—¶b_lä¸ºè´Ÿå€¼ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Simplex</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, e = <span class="number">0</span> ; <span class="keyword">double</span> MAX = INF ;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">1</span> ; j &lt;= N ; ++ j) <span class="keyword">if</span> (A[<span class="number">0</span>][j] &gt; eps) &#123; e = j ; <span class="keyword">break</span> ; &#125; <span class="keyword">if</span>(!e) <span class="keyword">break</span> ;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt;= M ; ++ i) <span class="keyword">if</span> (A[i][e] &gt; eps &amp;&amp; A[i][<span class="number">0</span>] / A[i][e] &lt; MAX) MAX = A[i][<span class="number">0</span>] / A[i][e], l = i ;<span class="comment">//é€‰ä¸ªæœ€ç´§çš„çº¦æŸ</span></span><br><span class="line">        <span class="keyword">if</span> (!l) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"Unbounded"</span>), <span class="literal">false</span> ; Pivot(l,e) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; T ; srand(<span class="number">19260817</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) Id[i] = i ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cin</span> &gt;&gt; A[<span class="number">0</span>][i] ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; <span class="built_in">cin</span> &gt;&gt; A[i ++][<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j) <span class="built_in">cin</span> &gt;&gt; A[i][j] ; </span><br><span class="line">    <span class="keyword">if</span> (!(Init() &amp;&amp; Simplex())) <span class="keyword">return</span> <span class="number">0</span> ; <span class="built_in">printf</span>(<span class="string">"%.8lf\n"</span>, -A[<span class="number">0</span>][<span class="number">0</span>]) ;</span><br><span class="line">    <span class="keyword">if</span>(T)&#123;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt;= M ; ++ i) Get[Id[N + i]] = A[i][<span class="number">0</span>] ; </span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">printf</span>(<span class="string">"%.8lf "</span>,Get[i]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> ç„¶é¹…äº‹å®ä¸Šè¿™ä»½ä»£ç åªæœ‰ $ 97pts $ â€¦å¥½åƒå‰©ä¸‹3åˆ†å°±å‡ ä¹æ²¡æœ‰äººå¾—è¿‡ï¼Œé™¤äº†kczå’Œstdâ€¦â€¦</p>
<p>è‡³äºä¸­é—´çš„<code>srand</code>ï¼Œæ˜¯ç”±äºæˆ‘ä»¬éšä¾¿ $ pivot $ ä¸€ä¸ª $ e $ å°±å¥½ï¼Œäºæ˜¯å°±<del>å¬é•¿è€…çš„</del>ã€‚</p>
<h1 id="rm-0x04-Afterwords"><a href="#rm-0x04-Afterwords" class="headerlink" title="$ \rm{0x04}~ Afterwords $"></a>$ \rm{0x04}~ Afterwords $</h1><p>ä¸€ç›´æƒ³å­¦ï¼Œä¸€ç›´æ²¡æœ‰æœºä¼šå­¦ã€‚</p>
<p>è¯´èµ·æ¥ç¡®å®æœ‰ç‚¹å„¿å°æ¿€åŠ¨ã€‚ç¬¬ä¸€æ¬¡å†™å•çº¯å‹çš„ä»£ç æ˜¯å‰ä¸ä¹…çš„ä¸€æ¬¡å‘¨æœ«ï¼Œæ—©ä¸Šç‚¹èµ·æ¥ä¹‹åå¤´æ˜è„‘æ¶¨åœ°æ‰‘å‘Candy?çš„åšå®¢ï¼Œå­¦äº†èµ·æ¥ã€‚åœ¨é‚£ä¹‹åæ‰å‘ç°åŸæ¥çº¿æ€§è§„åˆ’å¹¶ä¸å¸¸è€ƒï¼Œç”šè‡³è¯´ï¼Œä¸è€ƒã€‚ä½†æ˜¯æˆ‘æŒºå–œæ¬¢è¿™ç§æ„Ÿè§‰ï¼Œ<del>æ„Ÿè§‰è‡ªå·±ä»¿ä½›æ¯”å‡ºé¢˜äººä¼šçš„è¿˜å¤š</del></p>
<h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$ \rm{Reference} $"></a>$ \rm{Reference} $</h2><ul>
<li>$ [1] $  : $ Candy? $ çš„ $ blog $  <a href="https://www.cnblogs.com/candy99/" target="_blank" rel="noopener"> $ ^{^{[\nearrow ]}} $ </a></li>
<li>$ [2] $  :2016å›½å®¶é›†è®­é˜Ÿè®ºæ–‡ã€Šæµ…è°ˆçº¿æ€§è§„åˆ’ä¸å¯¹å¶é—®é¢˜ã€‹è‘£å…‹å‡¡Â· <a href="https://pan.baidu.com/s/1aN2L7DAm_RY2GeN5Snxj1A" target="_blank" rel="noopener"> $ ^{^{[\nearrow]}} $ </a> æå–ç ï¼švua4</li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>çº¿æ€§è§„åˆ’</category>
      </categories>
      <tags>
        <tag>çº¿æ€§è§„åˆ’/å•çº¯å½¢æ³•</tag>
        <tag>ç›®æµ‹ç”¨ä¸åˆ°çš„ç®—æ³•ç³»åˆ—</tag>
      </tags>
  </entry>
  <entry>
    <title>éšæƒ³å…­ Â· éš¾</title>
    <url>/2019/03/10/%E9%9A%8F%E6%83%B3%E5%85%AD%C2%B7Hard/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æœ€è¿‘å¿ƒç»ªé¢‡ä¸å®é™ã€‚</p>
<a id="more"></a>
<p>ã€Šéšæƒ³ã€‹ç³»åˆ—ç›®æ¬¡è¡¨ï¼š<a href="http://www.orchidany.cf/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/" target="_blank" rel="noopener">$Link$</a></p>
<h2 id="text-Part0"><a href="#text-Part0" class="headerlink" title="$\text{Part0}$"></a>$\text{Part0}$</h2><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæœ€è¿‘çš„å¿ƒç»ªé¢‡ä¸å®é™ã€‚</p>
<p>é‚£æ˜¯ä¸€ç§è¯´ä¸å‡ºæ¥çš„ç—›è‹¦ä¸å¯‚å¯ï¼Œæˆ–è®¸å¤¹æ‚ç€ä¸€äº›çˆ½å¿«ã€‚çœé€‰å°†è¿‘ï¼Œæˆ‘ä¸çŸ¥é“è‡ªå·±ä¼šæœ‰ä»€ä¹ˆæ ·çš„ä¸‹åœºã€‚æˆ‘åªçŸ¥é“è‡ªå·±ç åŠ›ä¾æ—§å¾ˆå¼±ã€è„‘å­ä¾æ—§å¾ˆç¬¨ã€‚æ¯”èµ·å‡ ä¸ªæœˆä¹‹å‰é€€å½¹ä¹‹åèé¡ä¸æŒ¯çš„è‡ªå·±ï¼Œæ²¡æœ‰ä»€ä¹ˆé•¿è¿›ã€‚</p>
<p>æˆ‘æ›´æ˜¯çŸ¥é“ï¼Œæˆ‘åŸæœ¬çš„æƒ³æ³•æ˜¯å¤šä¹ˆçš„å¹¼ç¨šã€‚æˆ–è®¸æˆ‘ä¸€ç›´åœ¨éª—è‡ªå·±å§ï¼Œéª—è‡ªå·±â€œçœé€‰ä¹‹å‰çš„ä¸€ä¸¤ä¸ªæœˆï¼Œæ‹¼ä¸€æ‹¼ã€æŒ¤ä¸€æŒ¤æ—¶é—´ï¼Œæˆ–è®¸å°±èƒ½æ€æ ·æ€æ ·â€â€”â€”åŸæ¥$\rm{NOIP}$çˆ†é”¤æˆ‘çš„äººï¼Œä¸æ­¢æ¯”æˆ‘èªæ˜ï¼Œè¿˜æ¯”æˆ‘å‹¤å¥‹ï¼Œè¿˜æ¯”æˆ‘è®¤çœŸï¼Œè¿˜æ¯”æˆ‘åŠªåŠ›ã€‚æˆ‘æœ‰ä»€ä¹ˆèµ„æœ¬å»åŒå°ç«æŠ€å‘¢ï¼Ÿåˆ°æœ€åï¼Œçœé€‰å¯¹æˆ‘æ¥è¯´ï¼Œä¹Ÿä¸è¿‡åªæ˜¯ä¸ªç¬‘è¯å§ã€‚</p>
<p>è¿™äº›å¤©æˆ‘ä¸€ç›´è§‰å¾—è‡ªå·±å·²ç»è¶³å¤ŸåŠªåŠ›äº†ï¼Œä½†æ˜¯å‘ç°æ°¸è¿œéƒ½æ˜¯â€œè¿œè¿œä¸å¤Ÿâ€ã€‚å°±å¥½æ¯”æˆ‘æƒ³è¦è§¦åŠ$\infin$ï¼Œè€Œæˆ‘æ¯å¤©å°±ç®—æ˜¯ä»¥$100$ã€$1000$ã€$10000$â€¦â€¦ çš„é€Ÿç‡å¢é•¿ï¼Œä¹Ÿæ°¸è¿œæ²¡æœ‰æŠµè¾¾çš„é‚£ä¸€å¤©ã€‚</p>
<p>æ¯•ç«Ÿå•Šï¼Œä¸Šè‹çš„ç¬”ä¸‹ï¼Œæ—©å·²ç»å†™ä¸‹äº†è§„åˆ™ï¼šæ— è®º$1$åé¢å¤šå°‘ä¸ª$0$ï¼Œéƒ½è‡³å¤šæ˜¯ä¸€ä¸ªååˆ†å¤§çš„å¸¸æ•°è€Œå·²ã€‚</p>
<p>å°±å¥½åƒæˆ‘è‡ªå·±ï¼Œæ— è®ºå¤šä¹ˆåŠªåŠ›ï¼ŒåŠªåŠ›åˆ°æ„ŸåŠ¨è‡ªå·±ï¼Œä¹Ÿè‡³å¤šæ˜¯ä¸€ä¸ªç¬‘è¯è€Œå·²ã€‚</p>
<h2 id="text-Part1-cdot-Her"><a href="#text-Part1-cdot-Her" class="headerlink" title="$\text{Part1}\cdot Her$"></a>$\text{Part1}\cdot Her$</h2><p>â€œå¥¹â€æ˜¯è°ï¼Ÿ</p>
<p>æˆ‘æ›¾åœ¨$qq$ç©ºé—´ä¸­å‘è¿‡ä¸€ç¯‡è¯´è¯´ï¼Œè°ƒä¾ƒæˆ‘ä»¬å¥¥èµ›ç”Ÿä¸èƒ½æ”¾å‡ï¼Œä½†æ˜¯ä¸»ä½“éƒ¨åˆ†å´æ˜¯ä¸å‡æœŸæ¯«æ— å…³ç³»ï¼š</p>
<blockquote>
<p>å¤´ä¸€æ¬¡æ¸…æ™¨åœ¨æ— äººçš„æ ¡å›­é‡Œé—²é€›ï¼Œ<br>è€³ç•”æ˜¯é’é¸Ÿåœ¨æ­Œå”±ç€ç¤¼èµï¼Œä»¥åŠå¤¹æ‚åœ¨æ¸…é£ä¸­çš„å¾å¾å›éŸ³ï¼Œ<br>çœ¼å‰æ˜¯æ¾„ç¢§è‰²çš„å¤©ç©ºï¼Œè¿œå¤„ä»¿ä½›é™ä¸‹ä¸€é“è‹¥éšè‹¥ç°çš„å¤©ä¸Šè™¹ã€‚<br>ä¸€åˆ‡éƒ½æ…¢ä¸‹æ¥äº†ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æµäº‘åœ¨èˆ’å¼ ã€å·ç¼©ï¼Œåˆèˆ’å¼ ï¼Œæˆ‘å¯ä»¥å¬åˆ°æ¸ºèŒ«çš„æ­Œå£°ï¼Œæˆ‘ç”šè‡³å¯ä»¥æƒ³åˆ°ä½ çš„æ¨¡æ ·â€”â€”é‚£åœ¨æš–é˜³ä¸‹ç† ç† é—ªå…‰çš„ç»†æ¡†çœ¼é•œå’Œæ¸…äº®çš„çœ¸å­ï¼Œä»¥åŠå¦‚æ¡ƒèŠ±ä¸€æ ·ç»¯çº¢çš„é¢é¢Šã€‚<br>å¥½åƒæ•´ä¸ªä¸–ç•Œéƒ½åœä¸‹æ¥äº†ï¼Œåªæœ‰æˆ‘å’Œåœ¨çƒŸé›¾ä¸­å¹»åŒ–å‡ºç¥å½¢çš„ä½ ï¼Œå’Œèº«æ—ææ¢¢ä¸Šçš„é’é¸Ÿï¼Œä»¥åŠæŒ‡å°–æµæ çš„æ¸…é£ä¸é˜³å…‰â€”â€”</p>
</blockquote>
<p>æœ€åä¸€å¥æœ¬æ¥æ˜¯<code>ä½†æ˜¯è¿™TMè·Ÿæˆ‘åªèƒ½å¾…åœ¨å­¦æ ¡ä¸èƒ½å›å®¶å¹¶ä¸”ä½ ä»¬åœ¨å®¶é‡Œå—¨æ²¡æœ‰ä»»ä½•å…³ç³»</code>ï¼Œæ¯•ç«Ÿæ˜¯ä¸ºäº†é€—ä¹ï¼Œæˆ‘ä¹Ÿä¸æƒ³è¢«å½“æˆä»€ä¹ˆä¸ºæ„Ÿæƒ…çƒ¦æ¼çš„æ„£å¤´é’ã€‚ä½†æ˜¯åœ¨æˆ‘çœ‹æ¥ï¼Œä¸»ä½“éƒ¨åˆ†åº”è¯¥æ˜¯ä¸Šé¢å¼•ç”¨æ¡†é‡Œçš„å†…å®¹ã€‚</p>
<p>æˆ‘æ›¾ç»è§‰å¾—åªè¦å¥¥èµ›æ‹¿äº†è€€çœ¼çš„æˆç»©ï¼Œå°±å¯ä»¥ååˆ†éª„å‚²åœ°å»è¿½æ±‚æˆ‘æƒ³è¦çš„ã€‚ä½†å°±ç°åœ¨çš„æƒ…å†µè€Œè¨€ï¼Œä¸æ˜¯å¾ˆä¹è§‚ã€‚</p>
<p>æˆ‘ä¸æƒ³è®©å¥¹çŸ¥é“è¿™ä»¶äº‹ï¼Œå› ä¸ºè¿™ä¸–ç•Œä¸Šæ— ç–¾è€Œç»ˆçš„äº‹æƒ…å¤ªå¤šäº†ï¼Œæˆ–è®¸è¿™å°±æ˜¯ä¸‹ä¸€ä»¶ã€‚ä½†å…¶å®æ€æ¥æƒ³å»ï¼Œä¼¼ä¹è¿™ä»½è–„è–„çš„æ„Ÿæƒ…å¹¶ä¸é‚£ä¹ˆé‡è¦ï¼Œå› ä¸ºæ¯”èµ·è¿™äº‹å„¿æ¥ï¼Œæˆ‘éœ€è¦æ‹…å¿ƒçš„ä¸œè¥¿è¿˜æœ‰å¤ªå¤šå¤ªå¤šâ€”â€”æ˜å¤©è·‘æ“ä¼šä¸ä¼šå¾ˆç´¯ï¼Ÿæ–‡åŒ–è¯¾ä¼šä¸ä¼šç»§ç»­è·ªï¼Ÿæ–‡åŒ–è¯¾è·ªå®Œç­ä¸»ä»»æ˜¯å¦ä¼šä¸§å¤±å¯¹æˆ‘çš„æœ€åä¸€ç‚¹ä¿¡ä»»ï¼Ÿæˆ‘çš„OIç»ˆç‚¹åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿâ€¦â€¦</p>
<p>ä»¥å‰ä»æ²¡è§‰å¾—åšäººè¿™ä¹ˆéš¾ã€‚ä½†æˆ‘å¹¶ä¸æƒ³è¯´â€œæˆ‘æˆé•¿äº†â€è¿™ç§è‡ªæˆ‘æ»¡è¶³å¼çš„è¯è¯­ï¼Œæˆ‘æ›´æƒ³å¯¹æˆ‘è‡ªå·±è¯´ï¼š</p>
<blockquote>
<p>å¤§æ¦‚æ˜¯åªæœ‰å¼±è€…æ‰ä¼šè§‰å¾—äººç”Ÿè‰°éš¾å§ã€‚ä½ çœ‹ä½ ç°æš—çš„çœ¼çœ¸ä¸­çš„å¯¹å²¸ï¼Œæ­£æœ‰ä¸ªé’å¹´ï¼Œçœ¼é‡Œå…¨æ˜¯å±±æ°´è¯—ç”»ã€‚å¯æƒœé‚£ä¸ªé’å¹´ï¼Œä¸æ˜¯ä½ ã€‚</p>
</blockquote>
<p>å¥¹å­¦ä¹ æˆç»©å¾ˆå¥½ï¼Œæ¯•ç«Ÿä¸å­¦å¥¥èµ›ï¼Œæœ‰å¤§æŠŠçš„æ—¶é—´å»ææ–‡åŒ–è¯¾ã€‚è€Œæˆ‘æˆ–è®¸åªæ˜¯ç­çº§è§’è½é‡Œä¸€ä¸ªå–œæ¬¢æ ‡æ–°ç«‹å¼‚çš„å¼±è€…å§ã€‚</p>
<h2 id="rm-Part3"><a href="#rm-Part3" class="headerlink" title="$\rm{Part3}$"></a>$\rm{Part3}$</h2><p>æˆ‘å¾ˆçƒ¦ã€‚</p>
<p>æœºæˆ¿é‡Œå»å¹´çœä¸€çš„å°ä¼™ä¼´ä»¬ä¼¼ä¹å¹¶ä¸æ˜¯å¤šåœ¨æ„çœé€‰ï¼Œå°±åªæœ‰æˆ‘åœ¨æ‹¼å¾—å¤´æ˜è„‘èƒ€ã€‚</p>
<p>æˆ‘å¥½ä¸çˆ½å•Šï¼Œå‡­ä»€ä¹ˆæˆ‘å¦‚æ­¤çè§†çš„ä¸œè¥¿ï¼Œä»–ä»¬å¯ä»¥èƒ¡ä¹±è¹‚èºã€æµªè´¹ã€ç·æ±¡â€”â€”å†µä¸”è¿„ä»Šä¸ºæ­¢è¿™ä¸ªæœºä¼šå¯¹äºå»å¹´<code>NOIP</code>è€ƒæŒ‚çš„æˆ‘ï¼Œè¿˜ä¸ä¸€å®šæœ‰è¿™ä¸ªæœºä¼šå»çœé€‰ã€‚è¿™å°±å¥½åƒæˆ‘çš„å¥³ç¥ä¸å±äºæˆ‘ï¼Œä½†æ˜¯å´è¢«å¦ä¸€ä¸ªäººåˆæ€åˆå‰â€”â€”æˆ‘æ€èƒ½ä¸ç”Ÿæ°”+å¯’å¿ƒå‘¢ï¼Ÿ</p>
<p>å¥½åœ¨è¿™ä¸ªç²¾ç¥çŠ¶æ€æŒç»­äº†ä¸¤å¤©å°±å¥½è½¬äº†â€”â€”ä¸»è¦åŸå› æ˜¯æˆ‘å¾—çŸ¥$SD$çš„çœé€‰æ”¿ç­–ï¼Œåªæ˜¯é™åˆ¶äº†åŸºå‡†çº¿è€Œå·²â€”â€”æˆ–è®¸è¿˜æœ‰æœºä¼šï¼Ÿæˆ‘ä¸çŸ¥é“ï¼Œå› ä¸ºæˆ‘çš„æ™ºå•†åœ¨æ‰€æœ‰çš„$Oier$é‡Œé¢ï¼Œå¤§æ¦‚ç®—æ˜¯ä¸ªä¸­ä¸‹ï¼Œæ‰€ä»¥æˆ‘å³ä½¿æ‹¼å°½å…¨åŠ›ä¹Ÿä¸èƒ½ä¿è¯å¼ºè¿‡è°â€”â€”å†µä¸”æˆ‘æ ¹æœ¬ä¸å¯ä»¥æ‹¼å°½å…¨åŠ›å•Šâ€¦</p>
<p>æœ€è¿‘ä¸€ç›´åœ¨ç¿˜è€ƒè¯•ã€ç¿˜ç¾æœ¯éŸ³ä¹è¯¾â€¦â€¦å„ç§ç¿˜ï¼Œæˆ‘ä¼°è®¡ç­ä¸»ä»»é©¬ä¸Šå°±è¦é€šè¿‡å¯¹æˆ‘çš„ä¸ä¿¡ä»»æ¡ˆäº†â€¦â€¦</p>
<h2 id="rm-Part4"><a href="#rm-Part4" class="headerlink" title="$\rm{Part4}$"></a>$\rm{Part4}$</h2><p>ä¸å¾—ä¸è¯´è¿™ç¯‡éšæƒ³æ¯”ä¹‹å‰çš„éšæƒ³æ°´å¤šäº†â€¦â€¦äºæ˜¯ç³Šä¸€ç¯‡æˆ‘åœ¨çŸ¥ä¹ä¸Šçš„å›ç­”å§ã€‚å½“æ—¶æœ‰ä¸ªé¢˜ä¸»é—®ï¼Œå¦‚æœä»é«˜ä¸€ä¸‹å­¦æœŸå·¦å³å¼€å§‹ï¼Œæ¯å¤©å­¦å¥¥èµ›å‡ ä¸ªå°æ—¶ï¼Œèƒ½ä¸èƒ½æ‹¿é‡‘ç‰Œã€‚</p>
<p>å…¶å®æœ¬æ¥æ˜¯æ— æ‰€è°“çš„â€”â€”äºæˆ‘è€Œè¨€æ— æ‰€è°“ã€‚å› ä¸ºä»–å¿—å‘å®å¤§æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œè‡³äºèƒ½å¦æˆçœŸï¼Œæˆ‘ä¹Ÿæ²¡æœ‰è¯„è®ºçš„æƒåˆ©ã€‚ä½†æ˜¯æˆ‘ç¡®ä¹æ˜¯å‘ç°ï¼Œä»–å¿ƒé‡Œä¸€ç›´æ˜¯è§‰å¾—â€œæˆ‘è¿˜æœ‰ä¸¤æŠŠåˆ·å­çš„â€ï¼Œâ€œåªæ˜¯æ—¶è¿ä¸æµç½¢äº†â€ã€‚ä¸çŸ¥æ€çš„ï¼Œçªç„¶æˆ‘å°±æœ‰äº†æƒ³å¤šè¯´ä¸¤å¥çš„æ¬²æœ›ï¼š</p>
<blockquote>
<p>æˆ‘ç»™ä½ è®²ï¼Œç›®æ ‡è·Ÿçœ¼ç•Œå’Œå®åŠ›æœ‰å…³ã€‚çœ¼ç•Œè¶Šå¤§ã€å®åŠ›è¶Šå¼ºï¼Œç›®æ ‡è¶Šå°ã€‚</p>
<p>åŒæ—¶ï¼Œæˆ‘å¯ä»¥å¾ˆè´Ÿè´£ä»»çš„è·Ÿä½ è®²ï¼šä½ ç»å¯¹ä¸çŸ¥é“çš„æ¥ä¸‹æ¥ä½ é¢ä¸´çš„æ˜¯ä»€ä¹ˆã€‚</p>
<p>å¦‚æœè¯´ä½ å‡†å¤‡æé«˜ç»„çš„è€ƒè¯•ä¹‹å‰ï¼Œæœ‰ä»€ä¹ˆé¢˜ä¸ä¼šçœ‹é¢˜è§£ï¼Œç†è§£èµ·æ¥çš„ç—›è‹¦ç¨‹åº¦æ˜¯1çš„è¯ï¼Œé‚£ä¹ˆä½ æƒ³ç»§ç»­å‘ä¸Šèµ°ã€æƒ³å»çœé€‰ã€æƒ³å»NOIï¼Œç†è§£èµ·æ¥çš„ç—›è‹¦ç¨‹åº¦å°†ä¼šæ˜¯1e5ä»¥ä¸Šã€‚</p>
<p>æ²¡é”™ï¼Œ10ä¸‡å€â€”â€”å¦‚æœä½ æƒ³è‡ªå­¦çš„è¯ã€‚ç›¸ä¿¡æˆ‘ï¼ŒNOIPçº§åˆ«çš„è€ƒè¯•ï¼Œåªæ˜¯è€ƒä»£ç ç´ è´¨/ç¨‹åºè®¾è®¡èƒ½åŠ›ï¼Œæ ¹æœ¬ä¸è€ƒå¯Ÿç†è§£èƒ½åŠ›ã€‚</p>
<p>ä¿é€â€”â€”æ˜¯çš„ï¼Œè¿™æ˜¯å¥¥èµ›çš„ç»ˆæç›®æ ‡ä¹‹ä¸€ã€‚ä½†æ˜¯å‘æ¥ä¸ä¼šæœ‰äººä¸»åŠ¨è°ˆèµ·è¿™ä»¶äº‹ï¼Œå³ä½¿ä»–å†NBã€‚ä½ ç°åœ¨è¿˜å¯ä»¥æå‡ºè¿™ä¸ªé—®é¢˜ï¼Œåªæ˜¯è¯´æ˜ä½ è¿˜ä¸äº†è§£è¡Œæƒ…ã€‚æŠ±æ­‰ï¼Œå¦‚æœä½ ç°åœ¨è§‰å¾—ä½ è‡ªå·±å¾ˆæœ‰å¤©åˆ†ï¼Œä½ è§‰å¾—ä½ ç°åœ¨å¯ä»¥æ‹¿â€œå•Šâ€¦æˆ‘å½“æ—¶åªæ˜¯å› ä¸ºæŸäº›è·Ÿæˆ‘è‡ªå·±æ²¡æœ‰å…³ç³»çš„åŸå› å¤±è´¥äº†â€è¿™ç§å¹¼å„¿å›­æ™ºå•†çš„ç†ç”±æ¥éª—è‡ªå·±â€”â€”æˆ‘åªèƒ½è·Ÿä½ è¯´ï¼Œä½ ä¸çŸ¥é“å…¶å®ƒäººæœ‰å¤šå‰å®³ï¼Œè¯´å¾—éš¾å¬äº›ï¼Œå°±æ˜¯äº•åº•ä¹‹è›™â€”â€”</p>
<p>ä½ çŸ¥é“å…¨ä¸­å›½æœ‰æ— ç©·æ— å°½çš„æ™ºå•†å¯ä»¥åŠæ‰“ä½ çš„äººï¼Œä»–ä»¬æ¯å¤©å¯ä»¥æœ‰å¤§åŠå¤©çš„æ—¶é—´å­¦OIå—ï¼Ÿ</p>
<p>ä½ çŸ¥é“æ¯å¹´æœ‰å¤šå°‘åˆä¸­ç”Ÿåœ¨NOIpä¸­ç¢¾å‹é«˜ä¸­ç”Ÿå—ï¼Ÿ</p>
<p>ä½ ä¸çŸ¥é“ã€‚</p>
<p>æ¯å¤©å‡ ä¸ªå°æ—¶ï¼Ÿ</p>
<p>åšå­¦é—®æœ€éœ€è¦çš„æ˜¯è°¦å‘ï¼Œç»™è‡ªå·±æ‰¾ç†ç”±ã€æ²‰æµ¸åœ¨â€œæˆ‘åº”è¯¥å¤šä¹ˆå¤šä¹ˆå‰å®³â€çš„å¹»æƒ³é‡Œç»ˆç©¶ä¼šå¤±è´¥ã€‚</p>
<p>ä½ ç›¸ä¿¡æˆ‘ï¼Œæˆ‘è¯´çš„éƒ½æ˜¯åˆ‡å®çš„ä½“ä¼šã€‚ä½ ä½“ä¼šä¸åˆ°æ˜¯å› ä¸ºä½ ä¸çŸ¥é“ä½ æ‰€åœ¨å››å·åˆ°åº•æœ‰å¤šä¹ˆææ€–â€”â€”åŸºæœ¬æ˜¯æˆéƒ½ä¸ƒä¸­åˆ¶éœ¸ï¼›NOIPå…¨çœå‰40äººå‡460+ï¼Œå…¨çœå‰90äººå‡400+ã€‚</p>
<p>æˆ‘çŸ¥é“æˆ‘æ²¡æœ‰å¾ˆå‰å®³ï¼Œæ‰€ä»¥æˆ‘çš„è¯ä½ ä¸ä¼šä¿¡å¤šå°‘ã€‚ä½†æ˜¯å¦‚æœè¯´å¥¥èµ›ç»™äº†æˆ‘ä»€ä¹ˆï¼Œæœ€å¤§çš„æ”¶è·å°±æ˜¯åœ¨å­¦æœ¯ä¸Šé¢çš„è™”è¯šâ€”â€”åšå­¦é—®å°±å¥½å¥½åšå­¦é—®ï¼Œä¸å»è¿½æ±‚é™„åŠ ä»·å€¼ï¼Œä»¥åŠåœ¨å­¦æœ¯ä¸Šæ°¸è¿œè°¦å‘çš„æ€åº¦ã€‚</p>
</blockquote>
<p>çœ‹èµ·æ¥ä¼¼ä¹æˆ‘å¾ˆåˆšçš„æ ·å­ï¼Œä½†æ˜¯è¿™æ ·åšä¸æ˜¯æ¯«æ— ç¼˜ç”±çš„â€”â€”æˆ‘å…¶å®ï¼Œä¹Ÿæ˜¯åœ¨å¯¹è‡ªå·±è¯´å§ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆéš¾å‘¢ï¼Ÿæˆ‘ä¸çŸ¥é“å•Šã€‚</p>
<p>æˆ‘åªçŸ¥é“æˆ‘çš„æœºä¼šç¡®ä¹æ˜¯ä¸å¤šäº†ã€‚</p>
<p>ä»Šå¹´çœé€‰è¿˜æœ‰æ²¡æœ‰æˆå‘¢ï¼Ÿæˆ‘ä¹Ÿä¸çŸ¥é“ã€‚</p>
<p>æˆ‘åªçŸ¥é“æˆ‘çš„æ—¶é—´ä¸å¤šäº†ã€‚</p>
<p>ä¸çŸ¥æ€çš„ï¼Œçœ¼å‰ä»¿ä½›æœ‰ä¸€æ¡å®½é˜”çš„å¤§æ²³ï¼Œæµ©è¡æ— é™…ã€‚æˆ‘æ— è®ºåšä»€ä¹ˆï¼Œéƒ½åªèƒ½åœ¨ä¸Šé¢æº…èµ·ä¸€åœˆçª„çª„çš„æ³¢çº¹è€Œå·²ã€‚æˆ‘åœ¨å°å°çš„æ²™æ´²ä¸Šä¼«ç«‹ç€ï¼Œè¿œæœ›æ˜¯å¦ä¸€ä¸ªå°å°çš„æ²™ä¸˜ï¼Œä¸Šé¢ç«™ç€å¥¹ã€‚æˆ‘æ— æ³•ä¸ˆé‡å‡ºæˆ‘ä»¬å½¼æ­¤ä¹‹é—´çš„è·ç¦»ï¼Œå¥½åƒå¾ˆè¿‘ï¼Œè¿‘åˆ°æˆ‘èƒ½çœ‹æ¸…å¥¹çš„ä¸€é¢¦ä¸€ç°‡ï¼Œå¯ä»¥çœ‹æ¸…å¥¹çœ‰ä¸Šæ–°æ·»çš„éœ²ç ï¼›å¥½åƒä¹Ÿå¾ˆè¿œï¼Œå› ä¸ºæˆ‘ä¸çŸ¥é“å¥¹åœ¨æƒ³ä»€ä¹ˆã€å¥¹è¦åšä»€ä¹ˆã€‚</p>
<p>å‘µï¼Œæ‰è®°èµ·æ¥æ›¾ç»æœ‰ä¸€éƒ¨æ—¶ä¸‹è¾ƒç«çš„å‰§é‡Œï¼Œç§°â€œæš—æ‹â€æˆ–è€…â€œå•ç›¸æ€â€ï¼Œæ˜¯æœ€çœé’±çš„æ‹çˆ±ã€‚æˆ‘ç¡®ä¹æ˜¯è®°ä½è¿™ä¸€ç‚¹äº†ã€‚ä½†æ˜¯æˆ‘æ›´æƒ³è¯´ï¼Œå®ƒä¸ä»…æ˜¯æœ€çœé’±çš„ï¼Œä¹Ÿæ˜¯æœ€ç¾çš„ã€æœ€å¯Œæœ‰å˜åŒ–çš„ã€æœ€æ¢¦å¹»çš„ã€‚</p>
<p>è¿™æ˜¯ä¸€ç‰‡æ— å çš„æœ¦èƒ§ï¼Œå¤œå¹•ä¸­é¥é¥çš„ï¼Œä»¿ä½›é—ªç€ä¸¤é¢—æ‘‡æ›³çš„æ˜Ÿã€‚</p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>éšæƒ³/ä¸‹ä¸‹ç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>éšæƒ³å›› Â· æ•…äººæ•…äº‹</title>
    <url>/2019/03/01/%E9%9A%8F%E6%83%B3%E5%9B%9B%C2%B7%E6%95%85%E4%BA%BA/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æˆ‘ä¸€ç›´åœ¨æƒ³ï¼Œè¿™ç¯‡åˆ°åº•è¯¥æ€ä¹ˆå†™ï¼Œåˆ°åº•è¯¥å†™ä»€ä¹ˆã€‚</p>
<p>ä½†æ‰å‘ç°ï¼Œæƒ³è¦å›å¿†çš„å¤ªå¤šäº†å•Šã€‚</p>
<p>ä½†æ—¢ç„¶æ˜¯è®²æ•…äººæ•…äº‹çš„ï¼Œé‚£å°±è®²å¥½äº†ã€‚</p>
<p>è¿™æ˜¯æ®µä»€ä¹ˆæ•…äº‹å‘¢ï¼Ÿè¿™æ˜¯æ®µæˆ‘ä¸æƒ³è®²ä¹Ÿä¸ä¼šè®²çš„æ•…äº‹å§ã€‚</p>
<a id="more"></a>
<h1 id="0"><a href="#0" class="headerlink" title="$0$"></a>$0$</h1><p>è¯´å®åœ¨çš„ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘å†™äº†å¥½å¤šå¥½å¤šä¸åŒçš„ç‰ˆæœ¬ï¼Œä½†éƒ½æ˜¯å†™äº†ä¸€ä¸¤æ®µä¸æƒ³å†™äº†ï¼Œæ„Ÿè§‰è¶Šå†™è¶Šæ™ºéšœã€‚ä»Šå¤©æ˜¯ <code>11/1/2020</code> ï¼Œä¸çŸ¥é“ä¸ºå•¥çªç„¶å°±å•¥éƒ½ä¸æƒ³å¹²äº†ï¼Œäºæ˜¯å°±æ¥è¡¥ä¸€ä¸‹ã€‚</p>
<p>æˆ‘ä»¬è¿™ä¸€çº§ï¼Œåº”è¯¥æ˜¯æœ€ç‰¹æ®Šçš„å§ï¼Ÿæˆ‘ä»¬æ¥çš„å‰ä¸€å¹´9æœˆå®éªŒéƒ¨æˆç«‹ï¼Œæ¥çš„ç¬¬ä¸€å¹´10æœˆå› ä¸ºé«˜ä¸‰å¤ªèœäº†ï¼Œå®éªŒéƒ¨è§£æ•£ï¼›æˆ‘ä»¬çš„å­¦é•¿æ˜¯rqyï¼Œè¿™ä»½å¥‡æ€ªçš„ç¼˜åˆ†å¥‡æ€ªåœ¨ï¼Œæˆ‘ä»¬äº›äººè¿ç»­å‚åŠ äº† $4$ å¹´çš„ $noip$ï¼Œæ¯æ¬¡éƒ½å’Œ $rqy$ ä¸€èµ·å‚åŠ â€”â€”å°±ç®—æ˜¯å’Œä»–åŒçº§çš„äººä¹Ÿæ²¡æœ‰è¿™ç§ç¼˜åˆ†ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯è€æ ¡æœ€åä¸€æ‰¹åˆä¸‰ï¼Œæ–°æ ¡ç¬¬ä¸€æ‰¹é«˜ä¸€</p>
<p>æ€»ä¹‹å‘¢ï¼Œè¿™è®©æˆ‘æƒ³èµ·ä¸€å¥è¯ï¼š</p>
<blockquote>
<p>è¿‡å»ä¸æœªæ¥çš„äº¤å‰ç‚¹å°±æ˜¯å½“ä¸‹,è€Œæˆ‘æ­£ç«™åœ¨è¿™ä¸ªç‚¹ä¸Šã€‚ â€”â€”æ¢­ç½—ã€Šç“¦å°”ç™»æ¹–ã€‹</p>
</blockquote>
<h1 id="1-è€æ ¡-Â·-è¡”æ¥ç­-Â·-å…‰æ˜"><a href="#1-è€æ ¡-Â·-è¡”æ¥ç­-Â·-å…‰æ˜" class="headerlink" title="$1$ è€æ ¡ Â· è¡”æ¥ç­ Â· å…‰æ˜"></a>$1$ è€æ ¡ Â· è¡”æ¥ç­ Â· å…‰æ˜</h1><p>è¿˜åœ¨è€æ ¡çš„æ—¶å€™ï¼Œæ¯å¤©æœ€çƒ¦çš„å°±æ˜¯è€ƒè¯•ï¼Œå› ä¸ºæˆ‘è€æ˜¯å«åº•ã€‚</p>
<p>æˆ‘ $2019$ å¹´ä¸€æœˆä»½æ¥çš„å®éªŒéƒ¨ï¼Œç›´åˆ°ç°åœ¨ä¹Ÿä¸€ç›´è§‰å¾—è‡ªå·±æ˜¯æ··ä¸Šæ¥çš„ï¼Œå› ä¸ºæˆ‘è§‰å¾—æˆ‘è€ƒçš„å¾ˆå·®ï¼Œå¯èƒ½åªæ˜¯å› ä¸ºåˆä¸‰æé«˜ç»„å†™äº†ä¸ªå°å‡¯çš„ç–‘æƒ‘æ°´åˆ°äº†çœä¸‰è€Œè¢«æ½œè§„åˆ™ä¸Šæ¥çš„ã€‚å½“æ—¶åˆšæ¥çš„æ—¶å€™ååˆ†æ„‰å¿«ï¼Œæ¯å¤© $5:30$ èµ·ï¼Œå¤ªæ–°å¥‡äº†ã€‚é«˜ä¸­éƒ¨å››å¤„éƒ½æ˜¯æ–°é²œçš„ç¯å¢ƒï¼Œç§ç±»ç¹å¤šçš„åŠ¨ç‰©å°å–éƒ¨ï¼Œå†åŠ ä¸Šæˆ‘åˆä¸‰ä¸€ç›´å¾ˆç¨³åœ°éœ¸å ç€å…¨ç­ç¬¬ä¸€ï¼Œè§‰å¾—è‡ªå·±äººç”Ÿåˆ°è¾¾äº†ä¸€ä¸ªå°é¡¶ç‚¹ã€‚</p>
<p>åˆšæ¥çš„æ—¶å€™ï¼Œæ˜¯ $12$ ä¸ªäººã€‚æˆ‘åœ¨å…¶ä¸­çš„å®åŠ›ä¸ç®—é«˜ã€‚åªè®°å¾—åˆšæ¥çš„æ—¶å€™ï¼Œç”±äºå¤§å®¶åˆä¸­æ˜¯å°±æŒºç†Ÿï¼Œæ‰€ä»¥ä¹Ÿäº†è§£å½¼æ­¤çš„å…«å¦ã€‚åœ¨é˜¿æ·³å¸®ç´å“¥ç»™ä»–çš„å¤§ç•ªè–¯å¥³ç¥ç”¨qqè¡¨ï¼ˆæœºï¼‰å®Œç™½ï¼ˆæƒ¨ï¼‰ä¹‹åï¼ˆè‡³äºä¸ºä»€ä¹ˆå«å¤§ç•ªè–¯â€¦æˆ‘æ‰¿è®¤è¿™æ˜¯æˆ‘èµ·çš„ç»°å·ï¼Œå› ä¸ºä»–å¥³ç¥å’Œã€Šè€å¤«å­ã€‹é‡Œé¢çš„å¤§ç•ªè–¯ä¸€æ ·å¯çˆ±233ï¼‰ï¼Œç´å“¥è¢«æ— æƒ…æ‹’ç»ï¼Œä¹‹åè¿™å°±å˜æˆäº†æˆ‘ä»¬æœºæˆ¿åˆæ¥å®éªŒç­çš„ç¬¬ä¸€ä¸ªæ¢—ã€‚å—¯ï¼Œå…¶å®æˆ‘å¹¶æ²¡æœ‰å¤šè€å®ï¼Œå› ä¸ºæ¥ä¸‹æ¥ä¸¤å¤©ï¼Œæˆ‘å¤–æ”¾äº†ä¸¤å¤©çš„ã€Šå¥½æ—¥å­ã€‹æ¥åº†ç¥ç´å“¥è¡¨ç™½å¤±è´¥ï¼Œ233.</p>
<p>ä¸è¿‡ä¹‹åå¯èƒ½æ˜¯é­æŠ¥åº”äº†ï¼Œç”±äºåœ¨é«˜ä¸­éƒ¨é£Ÿå ‚åƒäº†ä¸€ç¢—çƒ¤é¸¡å¿ƒï¼Œè‚ èƒƒå‘ç‚åœ¨å­¦æ ¡é«˜çƒ§äº†ä¸¤å¤©â€”â€”å½“æ—¶æˆ‘è¯´ä»€ä¹ˆéƒ½ä¸ä¼šè¯·å‡çš„ã€‚æ‰€ä»¥ç°åœ¨æˆ‘åœ¨æ‰“å‡ºã€Œçƒ¤é¸¡å¿ƒã€è¿™ä¸‰ä¸ªå­—çš„ä»»æ„ä¸€ä¸ªç»„åˆæˆ–è€…æŸä¸ªåç¼€çš„æ—¶å€™éƒ½ä¼šæ„Ÿåˆ°æ¶å¿ƒã€‚</p>
<p>ä¹‹åå‘¢ï¼Ÿä¹‹åæˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆå°±è¢«é€‰æˆäº†é˜Ÿé•¿ã€‚ç„¶åå¤§å®¶å°±å¼€å§‹åœ¨é«˜ä¸­éƒ¨å¹æ°´ï¼Œæ¯å¤©å»æ´›è°·åšé¢˜ï¼Œä»ä¸Šåˆ°ä¸‹æŒ¨ç€åˆ·ï¼Œä¸è¿‡æˆ‘å¤§å¤šæ•°éƒ½æ˜¯åœ¨æŠ„é¢˜è§£ã€‚</p>
<p>æ¸æ¸åœ°ï¼Œæˆ‘çš„ç¼ºç‚¹ç»ˆäºæš´éœ²äº†â€”â€”æˆ‘å¾ˆåæ‰§ã€‚è¿™å°±ç›´æ¥å¯¼è‡´äº†æˆ‘çš„é¢†å¯¼ååˆ†ã€Œé»‘æš—ã€ï¼Œä¹Ÿå¯èƒ½æ˜¯å› ä¸ºå¤§å®¶éƒ½å¤ªæœ‰ä¸ªæ€§äº†ï¼Œåˆä¸­çš„æ—¶å€™éƒ½æ˜¯ç­é‡Œå±å’¤é£äº‘çš„äººç‰©ï¼Œæ‰€ä»¥éƒ½ä¸æ˜¯å¾ˆæœã€‚å½“ç„¶äº†ï¼ŒçŸ›ç›¾å•¥çš„æœ€åä¹Ÿéƒ½ä¸äº†äº†ä¹‹ï¼Œå¤§å¤šæ•°æ—¶å€™å¤§å®¶è¿˜æ˜¯å¾ˆå’Œç¦çš„ã€‚</p>
<p>è¡”æ¥ç­ï¼Œä¹Ÿå°±æ˜¯å®éªŒç­è¢«é€‰å‡ºæ¥æå‰åœ¨é«˜ä¸­éƒ¨å­¦ä¹ çš„é‚£åŠå¹´ï¼ŒæŒºå¿«ä¹çš„ã€‚ä½†å°±æ˜¯è€ƒè¯•è‡ªå·±è€æ˜¯ä¸ä¼šï¼Œç„¶è€Œè‡ªå·±å½“æ—¶å”¯ä¸€æ‰¾å‡ºçš„åŸå› å°±æ˜¯ã€Œåˆ«äººç»éªŒä¸°å¯Œã€ï¼Œ233ã€‚</p>
<p>æœŸé—´ç»å†è¿‡ä»€ä¹ˆå‘¢ï¼Ÿç»å†è¿‡æœ€éš¾å¿˜çš„ä¸€æ¬¡åŸ¹è®­ï¼Œé‚£æ˜¯åœ¨äºŒæœˆã€‚å¹´å‰åˆšæ¥å®éªŒéƒ¨çš„æ„‰æ‚¦åŠ ä¸Šé©¬ä¸Šè¿‡å¹´çš„æœŸç›¼ï¼Œæ¯å¤©å’Œlzr&amp;qcråƒé¸¡åƒåˆ°å‡Œæ™¨ä¸‰å››ç‚¹ï¼Œå››ç‚¹å¤šå¼€å§‹å†™åšå®¢ï¼Œ8ç‚¹å¤šèµ·åºŠç›´å¥”è®²è¯¾åœ°ç‚¹ä¹Ÿæ¥ä¸åŠåƒæ—©é¥­ï¼Œäºæ˜¯é¥­ç¥¨å‡ ä¹å°±æ²¡ç”¨è¿‡ï¼›è‡ªæˆ‘æ„Ÿè§‰æ˜¯æ”¶è·æ¯”è¾ƒå¤šçš„ä¸€æ¬¡åŸ¹è®­ã€‚å› ä¸ºåœ¨é‚£ä¹‹åï¼Œç»è¿‡ä¸€ä½HBå·¨ä½¬çš„æŒ‡æ­£ï¼Œæˆ‘å­¦ä¼šäº†çº¿æ®µæ ‘ï¼ˆä¹‹åæ‰å‘ç°åŸæ¥è·Ÿçº¿æ®µæ²¡æœ‰å…³ç³»ï¼‰ï¼Œå†ä¹‹åæˆ‘å°±å†™å‡ºäº†æ´›è°·ä¸Šã€Œçº¿æ®µæ ‘ã€çš„é¢˜è§£â€”â€”å½“æ—¶çš„æ´›è°·è¿˜ä¸æ˜¯è¿™ä¹ˆçƒ­é—¹ã€‚</p>
<p>ç°åœ¨å›æƒ³èµ·æ¥ï¼ŒçœŸå¹¸ç¦å•Šã€‚</p>
<p>æ¯”è¾ƒæ‚²ä¼¤çš„å‡ ä»¶äº‹ï¼Œå°±æ˜¯æ¥çš„å‰å‡ å¤©å°±è¢«ä¸»ä»»ç»™æŠ“äº†æ™šä¸Šåœ¨å®¿èˆè¯´è¯ï¼ˆ8ä¸ªäººæœ‰7å“¥åœ¨é—²æ‰¯ï¼‰ï¼Œè¢«ç½šå¹²ä¸€å­¦æœŸçš„å€¼æ—¥å¹¶ä¸”æŒ‚åã€Œç‰©ä¸šå…¬å¸ã€ï¼›å››æœˆåº•åˆå› ä¸ºåœ¨å¥¥èµ›å®¤é‡Œå¼€qqç¾¤å¹æ°´+æ¢äº†ä¸€å¼ sexy Mikuçš„é«˜æ¸…å›¾åšæ¡Œé¢è€Œè¢«èµ¶å›å®¶è¿‡äº†ä¸ªé»„é‡‘å‘¨â€¦â€¦</p>
<p>ç„¶åå°±æ˜¯æ— æ­¢å°½çš„å¤±æ‹ï¼Œå¦‚æœæˆ‘å¯ä»¥è¿™ä¹ˆè¯´çš„è¯ã€‚å› ä¸ºæ¯•ç«Ÿå¦¹å­éƒ½æ²¡å–œæ¬¢è¿‡æˆ‘qaqã€‚</p>
<p>è®°å¾—å½“æ—¶çš„å¤§å®¶ï¼š</p>
<p>dyzä½œä¸ºæˆ‘ä»¬ä¹‹ä¸­å”¯ä¸€çš„å¥³é€‰æ‰‹ï¼Œå¾ˆè¦å¼ºå¾ˆè®¤çœŸï¼Œä¼šè‡ªå·±ç”³è¯·ä¸æ”¾å‡ç•™æ ¡å­¦ä¹ ï¼›</p>
<p>ljpæ¯å¤©å’Œwxé»åœ¨ä¸€èµ·å¹¶ä¼™åŒæˆ‘ä»¬ä¸€èµ·ç»™wxèµ·åä¸ºã€Œç‹å¼ºã€ï¼Œæ¯•ç«Ÿwxç¡®å®å¾ˆå¼ºï¼›</p>
<p>yjkç”±äºæ¯æ¬¡è€ƒè¯•éƒ½rank1æ·±å—é‡‘ç‰Œæ•™ç»ƒå–œçˆ±è¢«æˆ‘ä»¬ç§°ä¸ºã€Œå¹²å„¿å­ã€ï¼Œæ˜¯ä¸ªéªšåŒ…ï¼›</p>
<p>lwyåšé¢˜é€Ÿåº¦æ€»æ˜¯å¾ˆå¿«ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ã€Œå½±æµæ®¿ã€æ˜¯ä¸ªä»€ä¹ˆæ¢—ï¼ˆä¸€ç›´åˆ°å»å¹´å¹´åº•ã€Œå½±æµä¹‹ä¸»ã€çš„çˆ†ç«æˆ‘æ‰çŸ¥é“ï¼‰ï¼›</p>
<p>wxlä¸€ç›´è¢«æˆ‘ä»¬æ€‚æ¿å»è·Ÿä»–æš—æ‹çš„å¦¹å­è¡¨ç™½ï¼Œç›´åˆ°æ‹æ¯•ä¸šç…§é‚£å¤©ä»–æ‰çœŸæ•¢å»è¡¨ç™½ï¼›</p>
<p>ç´å“¥ä¸€ç›´å¾ˆç¨³ï¼Œç”±äºå’Œåˆ«äººæ°´ç¾¤è¢«ç»„cpï¼ŒåŒæ—¶ç”±äºæˆ‘ä»¬çš„å®¿èˆå’Œåˆä¸‰å®¿èˆä»¥åŠä¹°å­¦ä¹ ç”¨å“çš„å°å–éƒ¨é¢å¯¹é¢ï¼Œå¯¼è‡´æ¯æ¬¡ä»–çš„ã€Œå¤§ç•ªè–¯å¥³ç¥ã€ç»è¿‡æ—è¾¹çš„å•†åº—éƒ½è¢«æˆ‘ä»¬èµ·å“„ï¼›</p>
<p>qcrç»™è‡ªå·±èµ·äº†ä¸ªIdå«åšã€Œé‚±åŸé”å¤§ç¥ã€ï¼Œåœ¨æ˜ç™½OIçš„ç”Ÿå­˜æ³•åˆ™ä¹‹åæ„Ÿåˆ°å¤±å»æ¢¦æƒ³ï¼Œç„¶è€Œä»–ç»å¸¸å› ä¸ºçœ‹å°è¯´è¢«æŠ“ï¼Œå› æ­¤ä¹ŸæŒæ¡äº†å„ç§ã€Œè£…ä½œè‡ªå·±ä¸åœ¨çœ‹å°è¯´ä½†å®é™…ä¸Šå°±æ˜¯åœ¨çœ‹ã€çš„çœ‹å°è¯´æ–¹æ³•ï¼ˆæ¯”å¦‚å¤åˆ¶è¿›luoguçš„å‰ªè´´æ¿ï¼‰ï¼›</p>
<p>lzrååˆ†é¢“ï¼Œç»å¸¸å’Œqcrè¢«æˆå¯¹æŠ“åŒ…ï¼Œä½†ä»–ä¸»è¦æ˜¯åœ¨æ“æ¸¸æˆï¼›ç”±äºåˆä¸­çš„æ—¶å€™åŒç­ï¼Œæ‰€ä»¥æˆ‘æœ‰ä»€ä¹ˆäº‹å„¿éƒ½ä¼šå…ˆåŒä»–è®²â€”â€”ä»–ä¹Ÿå¾ˆä»—ä¹‰ï¼Œåœ¨æˆ‘ä»¬çš„æ°´ç¾¤è¢«æŠ“åŒ…ã€æˆ‘è¦è¢«èµ¶å›å®¶çš„æ—¶å€™ï¼Œä»–ç«™å‡ºæ¥è·Ÿä¸»ä»»è§£é‡Šä¸å…¨æ˜¯æˆ‘çš„é”…ï¼ˆè™½ç„¶æœ€åè¿˜æ˜¯å› ä¸ºæˆ‘èº«ä¸ºé˜Ÿé•¿ä¹Ÿåœ¨æ°´ç¾¤è¢«èµ¶å›å»é»„é‡‘å‘¨äº†ï¼‰ï¼›</p>
<p>é˜¿æ·³ä½œä¸ºå”¯ä¸€æœ‰å¥³ç¥¨çš„ï¼Œè¢«æˆ‘ä»¬æ•´å¤©èµ·å“„â€”â€”æˆ‘ä»¬ç”¨ã€Œå¤§æ²³ã€ä»£æŒ‡ä»–çš„å¥³ç¥¨ï¼Œä½ æ²¡çŒœé”™è¿™ä¹Ÿæ˜¯æˆ‘èµ·çš„ç»°å·ï¼ˆæ–‡å­¦å¸¦å¸ˆ.jpgï¼‰ï¼›åŒæ—¶åæœŸçš„ä»–ä¹Ÿæ˜¯htmlï¼ˆè¯»ä½œã€å–ç‰¹ä¹ˆäº†ã€ï¼‰å¸¦å¸ˆï¼Œåšå®¢å›­ç¾åŒ–å°èƒ½æ‰‹ï¼Œç”šè‡³çœŸçš„æ‹¿äº†å¥¥èµ›å®¤çš„ä¸€æœ¬htmlæ•™æå¼€å§‹å­¦orzï¼›</p>
<p>ZZHä¸€åº¦æ˜¯æˆ‘ä»¬ä¸­åšé¢˜åšçš„æœ€å¤šçš„ï¼Œä¹Ÿæ˜¯å…«å¦å…«çš„å¾ˆé¢‘ç¹çš„ï¼šä»–è‡ªè¯©ä¸ºé’¢é“ç›´ç”·ï¼ˆè™½ç„¶ï¼Œindeedï¼‰ï¼ŒåŒæ—¶ä¸€ç›´æš—æ‹ç€ä¸€ä¸ªå¦¹å­ä½†æ˜¯ä¸€ç›´ä¸è¡¨ç™½ï¼ˆå› ä¸ºé‚£ä¸ªå¦¹å­ä¹Ÿæ¥äº†å®éªŒç­ï¼Œä¸è¿‡ä¸æ˜¯æˆ‘ä»¬ç­çš„233ï¼‰â€”â€”è¿˜æœ‰ï¼Œæˆ‘è‡ªè¯©ä¸ºå…¨å¥¥èµ›æ¨¡ä»¿ZZHæ¨¡ä»¿çš„æœ€åƒçš„ï¼Œæˆ‘æŠŠä»–å›ç­”é—®é¢˜/è¯´è¯æ—¶çš„ã€Œæ…¢<del>~</del><del>~</del>~~æ¡æ–¯ç†ã€æ¨¡ä»¿çš„æ·‹æ¼“å°½è‡´ã€‚</p>
<p>å—¯ï¼Œé‚£æˆ‘å‘¢ï¼Ÿä¼¼ä¹å› ä¸ºæˆ‘å†™çš„åšå®¢éƒ½å¾ˆè¯¦ç»†ï¼Œæ‰€ä»¥è·å¾—äº†ä¸€å †èµï¼Œè‡ªå·±ä¹Ÿå¾ˆå¼€å¿ƒï¼›è‡³äºç»„ç»‡å­¦ä¹ æ–¹é¢ï¼Œæˆ‘ç»„ç»‡å¤§å®¶æ¯ä¸ªäººéƒ½å»å­¦ä¸åŒçš„æ–°ç®—æ³•ç„¶åäº’ç›¸æ•™ç»™å¯¹æ–¹ï¼Œå­¦äº†ä¸€å †æ¯”å¦‚ç½‘ç»œæµã€splayã€è«é˜Ÿã€treapä¹‹ç±»çš„æ–°å¥‡ä¸œè¥¿ï¼Œä¹Ÿè¡¥äº†ä¸€ä¸‹dpã€æœç´¢ä¹‹ç±»çš„åŸºæœ¬åŠŸã€‚</p>
<p>å…³äºè¿™ä¸ªæ´»åŠ¨â€¦è¯„ä»·å‡ ç‚¹å§ï¼š</p>
<ul>
<li>æˆ‘ä¸»å¼ çš„å­¦splayâ€”â€”å½“æ—¶ä»¿ä½›å¤§å®¶éƒ½è§‰å¾—splayï¼Œåå­—ç®€çŸ­ä½†æ˜¯æ€»æ„Ÿè§‰è•´å«ç€å¤æ‚æœ‰è¶£çš„é“ç†ï¼Œäºæ˜¯å†³å®šwxè®²äºŒå‰æœç´¢æœ¨å’Œtreapï¼Œæˆ‘è®²splay.</li>
<li>â€¦å¦‚æœè¯´æˆ‘ä»¬è¿™ä¸€çº§åˆ°åº•å‡ºäº†ä»€ä¹ˆé—®é¢˜ï¼Œé‚£å¯èƒ½å°±æ˜¯åŸºç¡€ä¸æ‰å®å§ã€‚ä½œä¸ºå§‹ä½œä¿‘è€…ï¼Œæˆ‘è‡ªè£qaq</li>
</ul>
<p>è¿˜æœ‰å­¦é•¿å•Šã€‚ä¸€ç›´åœ¨éª‘ç ï¼ˆ233ï¼‰çš„é‚±ç¥ã€ä¸ç†Ÿçš„å­¦é•¿hmrï¼Œmzqã€ä¸€å¼€å§‹ä¸ç†Ÿä½†æ…¢æ…¢ç†Ÿå¾—å¾ˆçš„zayï¼ˆè™½ç„¶ç°åœ¨å·²ç»å˜æˆäº†æˆ‘çš„åŒå­¦ï¼‰ï¼Œè¿˜æœ‰rqyã€‚</p>
<p>è€æ ¡çš„å¤©ï¼Œæ€»æ˜¯å˜å¾—å¾ˆæ…¢å¾ˆæ…¢ï¼›è€æ ¡çš„æ—¥å­ï¼Œä¹Ÿæ€»æ˜¯è¿‡çš„å¾ˆæ…¢å¾ˆæ…¢ã€‚å’Œlzrã€qcrä¸€èµ·æ‰“ä¹’ä¹“çƒï¼Œå½“æ—¶çš„æˆ‘ä¸ºä»€ä¹ˆä¼šè§‰å¾—ï¼Œè¿™ä¸€çƒä¸€çƒã€æ¥å›ç¿»é£ä¹‹é—´ï¼Œæ—¶å…‰ä¼šæµçš„è¿™ä¹ˆæ…¢å‘¢ï¼Ÿèµ°åœ¨åƒé¥­çš„è·¯ä¸Šã€ä¸ºäº†ä¸è¿Ÿåˆ°å¥”è·‘åœ¨å‡Œæ™¨äº”ç‚¹çš„æ“åœºä¸Šã€åœ¨æœˆå…‰ä¸‹æ…¢æ‚ æ‚ åœ°èµ°åœ¨å›å®¿èˆçš„è·¯ä¸Šï¼Œä¸ºä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿™æ—¶å…‰æ€»æ˜¯è¿‡å¾—è¿™ä¹ˆæ…¢å‘¢ï¼Ÿ</p>
<p>æ…¢å•Šï¼Œæ…¢åˆ°æˆ‘éƒ½å¿˜è®°äº†ï¼Œå¿˜è®°äº†è¿™ä¸€åˆ‡ï¼Œæ€»æ˜¯ä¼šæœ‰ä¸ªå°½å¤´çš„ã€‚</p>
<h1 id="2-æ–°æ ¡-Â·-é«˜ä¸€-Â·-æ€»æ˜¯ç¦»åˆ«"><a href="#2-æ–°æ ¡-Â·-é«˜ä¸€-Â·-æ€»æ˜¯ç¦»åˆ«" class="headerlink" title="$2$ æ–°æ ¡ Â· é«˜ä¸€ Â· æ€»æ˜¯ç¦»åˆ«"></a>$2$ æ–°æ ¡ Â· é«˜ä¸€ Â· æ€»æ˜¯ç¦»åˆ«</h1><p>ç»ˆäºï¼Œç´å“¥å› ä¸ºå¿å—ä¸äº†ä¸»ä»»çš„ç²¾è‹±è®ºè°ƒï¼Œå»äº†å³æ ¡ã€‚</p>
<p>ç»ˆäºï¼Œå”¯ä¸€çš„å¥³ç”Ÿdyzç”±äºæ–‡åŒ–è¯¾çš„ç¹é‡ï¼Œåœ¨é©¬ä¸Šè¦è”èµ›çš„æ—¶å€™é€€å‡ºäº†å¥¥èµ›ã€‚</p>
<p>ç»ˆäºï¼Œè”èµ›ä¹‹åï¼Œzzhèµ°äº†ã€‚æˆ‘ä¸€ç›´åœ¨æƒ³ï¼Œä»–å†³å¿ƒè¦èµ°çš„æ—¶å€™ï¼Œå†…å¿ƒä¼šæœ‰å¤šä¸èˆå‘¢ï¼Ÿå¯èƒ½å†ä¹Ÿæ²¡æœ‰ç­”æ¡ˆäº†ã€‚</p>
<p>ç»ˆäºï¼Œé˜¿æ·³ä¹Ÿä¸å­¦äº†ï¼Œåªå‰©äº†8ä¸ªäººã€‚</p>
<p>ç¦»åˆ«ï¼Œä¸åªæ˜¯äººç¦»åˆ«ã€‚æˆ‘ç¦»åˆ«äº†è‡ªå·±åˆä¸­æ—¶çš„å¿«ä¹ï¼Œå¼€å§‹å˜å¾—é˜´éƒï¼Œå˜å¾—æ›´åŠ åæ‰§ã€‚ä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæˆ‘å°±æ˜¯éš¾ä»¥æ”¾ä¸‹å¥¥èµ›ã€‚å•Šï¼Œå¯èƒ½ç¾å…¶åæ›°æ˜¯æ‰§å¿µå§ã€‚ä½†æ˜¯æˆ‘å¯èƒ½åªæ˜¯ï¼Œåœ¨é‚£äº›ä¸ªæ—¶é—´è¿˜ä¼šæ…¢æ…¢æµæ·Œæ—¥å­é‡Œï¼Œå·²ç»å¹»æƒ³å‡ºè‡ªå·±å–å¾—å¥½æˆç»©ä¼šå»æ€æ ·åœ°åº†ç¥â€”â€”å¦‚åŒé©¾é©¶ç€ä¸€åŒ¹éš¾ä»¥é©¾é©­çš„é©¬ï¼Œè¦æˆ‘åœä¸‹ï¼Œæˆ‘ä¹Ÿå¾ˆéš¾å»æ”¾æ‰‹ã€‚</p>
<p>æˆ‘ä¸å¾—ä¸æ‰¿è®¤ï¼Œå…¶å®è¿™æ®µæ—¶å…‰è¿‡çš„æ‰æ˜¯æœ€æ¼«é•¿çš„â€”â€”æœ‰ç€ä¸€çœ¼æœ›ä¸åˆ°å¤´çš„æ–‡åŒ–è¯¾ã€åšç€ä¸€çœ¼æœ›ä¸åˆ°å¤´çš„ä¸ä¼šçš„ä¹ é¢˜ã€æ¥å—ç€ä¸€çœ¼æœ›ä¸åˆ°å¤´çš„å¤±è´¥ã€‚å¤©åˆ†ä¸å¤Ÿï¼ŒåŠªåŠ›æ›´ä¸å¤Ÿã€‚åœ¨å¹¿è¢¤çš„å¤©åœ°é—´ï¼Œæˆ‘åˆç®—ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>ä½†å…¶å®ç«™åœ¨ç°åœ¨çš„è§’åº¦ï¼Œæˆ‘ä¼šæ„Ÿæ©è¿™æ®µæ—¶å…‰ï¼Œæ„Ÿæ©è¿™æ®µç¢Œç¢Œæ— ä¸ºçš„æ—¶å…‰ã€‚å®ƒå‘Šè¯‰äº†æˆ‘ï¼Œæœ€å·®åŠ²ã€æœ€è¿·èŒ«ã€æœ€æ²¡æœ‰å¸Œæœ›çš„ä¸€æ®µæ—¥å­è¯¥æ€ä¹ˆèµ°ã€‚è¿™æœŸé—´æˆ‘ç¿˜è¯¾å»å‡†å¤‡çœé€‰ï¼Œä½†å°±æ˜¯åœ¨ç©ï¼›è¿™æœŸé—´æˆ‘ç”¨ã€ŒåŠªåŠ›ã€æ¬ºéª—äº†è‡ªå·±ï¼Œå®é™…ä¸Šæ ¹æœ¬æ²¡æœ‰å¤šåŠªåŠ›ï¼›è¿™æœŸé—´æˆ‘ç”¨ã€Œèœæ˜¯åŸç½ªï¼Œæœ‰bbã€æ„Ÿå¹äººç”Ÿçš„æ—¶é—´ï¼Œä¸å¦‚å¤šåšç‚¹é¢˜æ¥æå‡ä½ é‚£æœ¬æ¥å°±å¾®ä¸è¶³é“çš„å®åŠ›ã€æ¥è¯´æœè‡ªå·±ï¼Œç»“æœå‘ç°è¿™æ ¹æœ¬å°±æ˜¯ä¸æ˜¯é€‚åˆæˆ‘çš„å¿ƒæ€ã€‚</p>
<p>æ€»ä¹‹å‘¢ï¼Œåœ¨è€åº„(ç­ä¸»ä»»)çš„å…³ç…§ä¸‹ï¼Œæˆ‘å¾…åœ¨è‡ªå·±çš„èˆ’é€‚åŒºé‡Œï¼Œå®‰é™åœ°ç¡ç€ã€‚</p>
<p>ç›´åˆ°æš‘å‡çš„åˆ°æ¥ã€‚</p>
<h1 id="3-æš‘å‡-Â·-å¤–å‡ºåŸ¹è®­-Â·-Simon"><a href="#3-æš‘å‡-Â·-å¤–å‡ºåŸ¹è®­-Â·-Simon" class="headerlink" title="$3$ æš‘å‡ Â· å¤–å‡ºåŸ¹è®­ Â· Simon"></a>$3$ æš‘å‡ Â· å¤–å‡ºåŸ¹è®­ Â· Simon</h1>]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>éšæƒ³/ä¸‹ä¸‹ç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ‰©å±•çš„BSGS</title>
    <url>/2019/02/22/exBSGS/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt></p>
<hr>
<h1 id="rm-0x01-quad-Preface"><a href="#rm-0x01-quad-Preface" class="headerlink" title="$\rm{0x01\quad Preface}$"></a>$\rm{0x01\quad Preface}$</h1><p>$emmm$ä¸¥æ ¼æ¥è®²ï¼Œä¸åº”è¯¥è¢«ç®—åˆ°ä¸€ä¸ªæ¨¡æ¿é‡Œé¢ã€‚å› ä¸ºåœ¨æˆ‘çœ‹æ¥<strong>æ¨¡æ¿</strong>æ˜¯äººæ„é€ å‡ºæ¥çš„ï¼Œä½†æ˜¯è¿™ä¸ªç®—æ³•åº”è¯¥æ˜¯ä¸€ä¸ªè§£å†³é—®é¢˜çš„$process$â€¦æ›´åƒæ˜¯åœ¨è§£ä¸€é“æ•°å­¦é¢˜ï¼Œå¦‚æœ$BSGS$æ˜¯å®šç†çš„è¯ï¼Œ$exBSGS$æ›´åƒæ˜¯ä¸€ä¸ªä¸æ–­è½¬åŒ–çš„è¿‡ç¨‹233ï¼ˆæ‰‹åŠ¨@lxaå¹¶ä¸”æºœ</p>
<h1 id="rm-0x02-quad-Algorithm-Process"><a href="#rm-0x02-quad-Algorithm-Process" class="headerlink" title="$\rm{0x02\quad Algorithm~Process}$"></a>$\rm{0x02\quad Algorithm~Process}$</h1><p>ä»Šå¤©æ‰å‘ç°åŸæ¥$\rm{BSGS}$æœ‰ä¸¤ç§å†™æ³•â€¦â€¦å¹¶ä¸”è§‰å¾—å‰©ä¸‹çš„é¢˜è§£è®²çš„éƒ½è®²çš„ä¸æ˜¯å¾ˆå…¨çš„æ ·å­233ã€‚</p>
<p>å…¶å®æœ¬è´¨ä¸Šï¼Œå½“$p$ä¸ä¸ºç´ æ•°æ—¶ï¼Œæˆ‘ä»¬æ— æ³•è¿›è¡Œæœ´ç´ $\rm{BSGS}$çš„åŸå› æ˜¯æˆ‘ä»¬çš„æ¬§æ‹‰å®šç†$a^{\varphi(p)} \equiv b(\bmod p)$ åªèƒ½å¤„ç†$(a,p)=1$çš„æƒ…å†µã€‚é‚£ä¹ˆæˆ‘ä»¬çŸ¥é“ï¼Œæœ´ç´ çš„$\rm{BSGS}$çš„å…³é”®åœ¨äºï¼Œå¯ä»¥ä¿è¯æœ€å°è§£æ˜¯æœ‰ç•Œçš„â€”â€”$x$ä¸€å®šåœ¨$[1,\varphi(p)]$ä¸­ã€‚æ‰€ä»¥æœ€å$BSGS$çš„å¤æ‚åº¦æ‰ä¼šæ˜¯$\Theta(\sqrt{\varphi(p)})$ çš„â€”â€”æ¯”å¦‚è¯´æ¯”è¾ƒå¸¸è§çš„$p$æ˜¯ç´ æ•°çš„æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$\Theta(p)$ã€‚</p>
<p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦è¿›è¡Œä¸€äº›æ“ä½œï¼Œä¿è¯$(a,p)=1 $å³å¯$^{[1]}$ã€‚</p>
<p>æˆ‘ä»¬æ€è€ƒï¼Œå¯¹äºåŒä½™å¼$a^x\equiv b (\bmod p)$è€Œè¨€ï¼Œæˆ‘ä»¬å…ˆå‡å®š$(a,p)&gt;1 $ã€‚è€Œæ­¤æ—¶å¦‚æœæœ‰$((a,p), b)=1$ï¼Œé‚£ä¹ˆè¯´æ˜æ­¤å¼åªæœ‰å¯èƒ½åœ¨$x=0,b=1 $çš„æ—¶å€™æœ‰è§£â€”â€”è¿™ä¸ªç»“è®ºæ˜¯å¹³å‡¡çš„ã€‚å› ä¸ºå‡è®¾æˆ‘ä»¬æŠŠå®ƒå±•å¼€æˆ$a\cdot a^{x-1} +kp=b $çš„å½¢å¼ï¼Œå¿…é¡»è¦æœ‰$(a,p)  |  b$çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½ä¿è¯$a^{x-1}$å’Œ$k $éƒ½æ˜¯æ•´æ•°ã€‚</p>
<p>é‚£ä¹ˆå¯¹äº$(a,p)&gt;1$ä¸”$(a,p)  |  b $ï¼Œæˆ‘ä»¬ä»¤åŸå¼å˜æˆ</p>
<script type="math/tex; mode=display">
a^{x-1}\cdot \frac{a}{(a,p)} \equiv \frac{b}{(a,p)} (\bmod \frac{p}{(a,p)})</script><p>çš„æ ·å­ï¼Œå¦‚æœæ­¤æ—¶$(a^{x-1},\frac{p}{(a,p)})=1$ çš„è¯ï¼Œæˆ‘ä»¬å°±ç›´æ¥è§£</p>
<script type="math/tex; mode=display">
a^{x-1}\equiv \frac{\frac{b}{(a,p)}} {\frac{a}{(a,p)} }(\bmod \frac{p}{(a,p)})</script><p>è¿™ä¸ªæ–¹ç¨‹å³å¯ã€‚å¦åˆ™æˆ‘ä»¬ç»§ç»­åˆ†è§£ç›´è‡³$(pâ€™,a)=1$ã€‚</p>
<p>é‚£ä¹ˆæ­¤æ—¶æœ‰ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼Œå°±æ˜¯å¦‚æœä»¬åœ¨è§£è¿™ä¸ªæ–¹ç¨‹æ—¶ï¼Œå‡ºç°äº†</p>
<script type="math/tex; mode=display">
(a^{x-1}, \frac{p}{(a,p)})\nmid \frac{\frac{b}{(a,p)}} {\frac{a}{(a,p)} }</script><p>çš„æƒ…å†µï¼Œé‚£æˆ‘ä»¬éœ€è¦ç‰¹åˆ¤å¹¶<code>return -1</code> ï¼›å¦ä¸€ç§æƒ…å†µï¼Œå¦‚æœæˆ‘ä»¬å‡ºç°äº†</p>
<script type="math/tex; mode=display">
a^{x-1}\equiv \frac{\frac{b}{(a,p)}} {\frac{a}{(a,p)} } \equiv1(\bmod \frac{p}{(a,p)})</script><p>çš„æƒ…å†µï¼Œä¹Ÿéœ€è¦ç‰¹åˆ¤å¹¶è¾“å‡ºæ­¤$k$ï¼ˆæ­¤æ—¶åŒä½™å¼å·¦è¾¹æ˜¯$a^{x-k}$ï¼Œå› ä¸º$a^{x-k}\equiv1~(\bmod p)$æ‰€ä»¥ç›´æ¥è¾“å‡º$k$ï¼‰ï¼Œä¸è¿‡ä¹Ÿæœ‰å¯èƒ½ä¸éœ€è¦ï¼Œå®Œå…¨çœ‹ä½ å†™çš„$BSGS$èƒ½ä¸èƒ½åˆ¤æ–­$x=0$çš„æƒ…å†µâ€¦â€¦ä¸€èˆ¬æƒ…å†µä¸‹ä¸èƒ½ã€‚</p>
<p>æ­¤æ—¶<strong>ç”±äº$\boldsymbol{p}$ä¸å†æ˜¯ç´ æ•°ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨è´¹é©¬å°å®šç†ï¼Œéœ€è¦æˆ‘ä»¬ç”¨$exgcd$çš„æ–¹æ³•æ±‚é€†å…ƒï¼ŒåŒ…æ‹¬ä½†ä¸é™äº$\frac{b}{(a,p)}$çš„é€†å…ƒå’Œ$a^{-im}$ã€‚</strong></p>
<p>ä»¥ä¸‹æ˜¯å®Œæ•´ç‰ˆä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; </span><br><span class="line"><span class="built_in">unordered_map</span>&lt;ll, <span class="keyword">int</span>&gt; H ;</span><br><span class="line"><span class="keyword">int</span> N, M, P, ans ; <span class="comment">// N ^x = M (mod P)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">gcd</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) <span class="keyword">return</span> a ;</span><br><span class="line">    <span class="keyword">return</span> gcd(b, a % b) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">expow</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b) res = ((b &amp; <span class="number">1</span>)?res * a % mod : res), a = a * a % mod, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">exgcd</span><span class="params">(ll &amp;x, ll &amp;y, ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b)&#123; x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> a ; &#125;</span><br><span class="line"> 	ll t = exgcd(y, x, b, a % b) ; y -= x * (a / b) ; <span class="keyword">return</span> t ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">BSGS</span><span class="params">(ll a, ll b, ll mod, ll qaq)</span></span>&#123;</span><br><span class="line">    H.clear() ; ll Q, p = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(mod)), x, y ; </span><br><span class="line">    exgcd(x, y, qaq, mod), b = (b * x % mod + mod) % mod, </span><br><span class="line">    Q = expow(a, p, mod), exgcd(x, y, Q, mod), Q = (x % mod + mod) % mod ;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>, j = <span class="number">0</span> ; j &lt;= p ; ++ j, i = i * a % mod)  <span class="keyword">if</span> (!H.count(i)) H[i] = j ;</span><br><span class="line">    <span class="keyword">for</span> (ll i = b, j = <span class="number">0</span> ; j &lt;= p ; ++ j, i = i * Q % mod)  <span class="keyword">if</span> (H[i]) <span class="keyword">return</span> j * p + H[i] ; <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">exBSGS</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll qaq = <span class="number">1</span> ;</span><br><span class="line">    ll k = <span class="number">0</span>, qwq = <span class="number">1</span> ; </span><br><span class="line">    <span class="keyword">if</span> (M == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">    <span class="keyword">while</span> ((qwq = gcd(N, P)) &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (M % qwq) <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">        ++ k, M /= qwq, P /= qwq, qaq = qaq * (N / qwq) % P ;</span><br><span class="line">        <span class="keyword">if</span> (qaq == M) <span class="keyword">return</span> k ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (qwq = BSGS(N, M, P, qaq)) == <span class="number">-1</span> ? <span class="number">-1</span> : qwq + k ;</span><br><span class="line">&#125;                    </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; N)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;P, &amp;M); <span class="keyword">if</span> (!N &amp;&amp; !M &amp;&amp; !P) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        N %= P, M %= P, ans = exBSGS() ; <span class="keyword">if</span> (ans &lt; <span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">"No Solution"</span>) ; <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-0x03-quad-Afterword"><a href="#rm-0x03-quad-Afterword" class="headerlink" title="$\rm{0x03\quad Afterword}$"></a>$\rm{0x03\quad Afterword}$</h1><p>ä»Šå¤©æ‰çŸ¥é“åŸæ¥$BSGS$æœ‰ä¸¤ç§å†™æ³•qaq</p>
<p>$zyf2000$å¥½åƒå’Œæˆ‘å†™çš„$BSGS$å¯¹â€œå¤§æ­¥â€å’Œâ€œå°æ­¥â€çš„å®šä¹‰ä¸æ˜¯å¾ˆä¸€æ ·â€¦äºæ˜¯æœ€åè¿˜æ˜¯è‡ªå·±$\rm{yy}$çš„233</p>
<h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$\rm{Reference}$"></a>$\rm{Reference}$</h2><ul>
<li>$[1]$ :$zyf2000$çš„$blog$ <a href="https://blog.csdn.net/clove_unique/article/details/51227328" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>BSGS</category>
      </categories>
      <tags>
        <tag>BSGS/exBSGS</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ‹†ç³»æ•°FFT</title>
    <url>/2019/02/19/FFT2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89-darkviolet.svg" alt></p>
<p>ä¸Šä¸€ç¯‡å¤šé¡¹å¼ï¼š<a href="http://www.orchidany.cf/2019/02/19/FFT1/" target="_blank" rel="noopener">å¤šé¡¹å¼1Â·æ™®é€šçš„FFT</a></p>
<hr>
<h1 id="rm-0x01-quad-Preface"><a href="#rm-0x01-quad-Preface" class="headerlink" title="$\rm{0x01\quad Preface}$"></a>$\rm{0x01\quad Preface}$</h1><p>ä»Šå¤©æ˜¯$Feb.19^{th}$ï¼Œå¼€å­¦å‰ä¸€å¤©ï¼Œç°åœ¨æ˜¯åŒ—äº¬æ—¶é—´ä¸‹åˆ$10:05$ï¼Œæˆ‘è¿˜å‰©é™¤äº†è‹±è¯­ç‰©ç†çš„æ‰€æœ‰ä½œä¸šæ²¡åš â€¦ è€¶ï¼ŒçœŸå¼€å¿ƒã€‚</p>
<p>ç”±äºç‰¹æ®ŠåŸå› å˜›ï¼Œæˆ‘æš‚æ—¶ä¸ä¼šå†™çš„ç‰¹åˆ«è¯¦ç»†â€”â€”æ¯•ç«Ÿè¿˜æœ‰ä½œä¸šæ²¡æœ‰åš<del>æŠ„</del>å®Œï¼Œæ‰€ä»¥å°±å…ˆæ•´ç†åœ°ä»“ä¿ƒä¸€ç‚¹ã€‚</p>
<p>é¦–å…ˆï¼Œä¸ºä»€ä¹ˆè¦æ‹†ç³»æ•°ï¼Ÿè¿™æ˜¯ä¸€ä¸ªé—®é¢˜â€”â€”ç›´æ¥$FFT$ä¹‹ååˆ¤ä¸ªç²¾åº¦å†å–æ¨¡ä¸å°±å¾—äº†ï¼Ÿå¾ˆå–œé—»ä¹è§çš„æ˜¯ï¼Œè¿™ä¸ªé¢˜ä¸­çš„$value_{max}$åˆ°è¾¾äº†$1e9\cdot1e9 \cdot 1e5 = 1e23$çš„çº§åˆ«ï¼Œä¸å¯ä»¥ç›´æ¥<code>long long</code>çˆ†è‰¹ã€‚</p>
<h1 id="rm-0x02-Normal-Coefficient-Spliting-FFT"><a href="#rm-0x02-Normal-Coefficient-Spliting-FFT" class="headerlink" title="$\rm{0x02~Normal-Coefficient-Spliting~FFT}$"></a>$\rm{0x02~Normal-Coefficient-Spliting~FFT}$</h1><p>é¦–å…ˆæ˜¯æœ€æœ´ç´ çš„æ‹†ç³»æ•°æ³•ã€‚å…¶åŸç†ç®€å•å¾—å¾ˆï¼Œå°±æ˜¯é€‰æ‹©ä¸€ä¸ª$M$ï¼ŒæŠŠ$A(x)$å’Œ$B(x)$çš„å„é¡¹ç³»æ•°è¡¨ç¤ºæˆ</p>
<script type="math/tex; mode=display">
A_i = a_iM+b_i~(0\leq b_i <a_i) \\
B_i = c_iM+d_i~(0\leq d_i <c_i)</script><p>çš„å½¢å¼ã€‚ç„¶åæˆ‘ä»¬åšä¹˜æ³•çš„è¯ï¼Œä¼šæœ‰</p>
<script type="math/tex; mode=display">
A_i\cdot B_i = a_ic_iM^2+(a_id_i+c_ib_i)M+b_id_i</script><p>é‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘ï¼Œå¯¹äºç¬¬ä¸€éƒ¨åˆ†$a_ic_iM^2$æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€æ¬¡$DFT$ã€ä¸€æ¬¡$IDFT$ç®—å‡ºæ¥ï¼Œï¼›å¯¹äºç¬¬äºŒéƒ¨åˆ†$(a_id_i+c_ib_i)M$ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤æ¬¡$DFT$åˆ†åˆ«ç®—å‡º$a_id_i$ã€$c_ib_i$ç„¶ååˆå¹¶ï¼Œä¹‹åä¸€æ¬¡$IDFT$æ±‚å‡ºæ¥ï¼›å¯¹äºæœ€åä¸€éƒ¨åˆ†åˆ™åªéœ€è¦ä¸€æ¬¡$DFT$ã€ä¸€æ¬¡$IDFT$æ±‚å‡ºã€‚æ‰€ä»¥ç®—æ³•æµç¨‹ä¸€å…±$7$æ¬¡$FFT$ã€‚</p>
<p>é‚£æˆ‘ä»¬è€ƒè™‘ä¼°è®¡ä¸€ä¸‹èŒƒå›´ï¼Œæ­¤å¤„ä¸ç”šä¸¥è°¨åœ°ä½¿ç”¨$\Theta$ä½œä¸ºåŒé˜¶çš„ç¬¦å·$^{[1]}$</p>
<script type="math/tex; mode=display">b_i\cdot d_i \approx \Theta(M^2)</script><script type="math/tex; mode=display">a_i\cdot c_i =\lfloor \frac{P}{M}\rfloor \cdot \lfloor \frac{P}{M}\rfloor = \Theta(\lfloor \frac{P^2}{M^2}\rfloor)</script><script type="math/tex; mode=display">(a_id_i + c_ib_i)\cdot M =\Theta( M \cdot \lfloor \frac{P}{M}\rfloor)</script><p>é‚£ä¹ˆæˆ‘ä»¬å–$M = \Theta(\sqrt P)$çº§åˆ«çš„ï¼Œå¯ä»¥ä¿è¯ä¸‰ä¸ªå€¼çš„é˜¶ä¸º$\Theta(P)$ï¼Œå¤§æ¦‚æ˜¯$1e9 \cdot 1e5 = 1e14$çº§åˆ«çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 423333</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(i = a ; i &lt;= b ; ++ i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1</span>) ;</span><br><span class="line"><span class="keyword">int</span> R[MAXN], L, x ; <span class="keyword">long</span> <span class="keyword">long</span> Ans[MAXN] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">double</span> x, y ;</span><br><span class="line">    node (<span class="keyword">long</span> <span class="keyword">double</span> xx = <span class="number">0</span>, <span class="keyword">long</span> <span class="keyword">double</span> yy = <span class="number">0</span>)&#123;</span><br><span class="line">        x = xx, y = yy ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;A[MAXN], B[MAXN], C[MAXN], D[MAXN], F[MAXN], G[MAXN] ;</span><br><span class="line">node H1[MAXN], H2[MAXN], H3[MAXN] ; <span class="keyword">int</span> L1, L2, P, N, M ;</span><br><span class="line">node <span class="keyword">operator</span> + (node J, node Q)&#123; <span class="keyword">return</span> node(J.x + Q.x , J.y + Q.y); &#125;</span><br><span class="line">node <span class="keyword">operator</span> - (node J, node Q)&#123; <span class="keyword">return</span> node(J.x - Q.x , J.y - Q.y); &#125;</span><br><span class="line">node <span class="keyword">operator</span> * (node J, node Q)&#123; <span class="keyword">return</span> node(J.x * Q.x - J.y * Q.y , J.x * Q.y + J.y * Q.x) ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(node *J, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, j, k, l ; </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; R[i]) swap(J[i], J[R[i]]) ;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; N; j &lt;&lt;= <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="function">node <span class="title">T</span><span class="params">(<span class="built_in">cos</span>(Pi / j), flag * <span class="built_in">sin</span>(Pi / j))</span> </span>;</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; N; k += (j &lt;&lt; <span class="number">1</span>) )&#123;</span><br><span class="line">            <span class="function">node <span class="title">t</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span> </span>;</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j; l ++, t = t * T)&#123;</span><br><span class="line">                node Nx = J[k + l], Ny = t * J[k + j + l] ;</span><br><span class="line">                J[k + l] = Nx + Ny ;</span><br><span class="line">                J[k + j + l] = Nx - Ny ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag &lt; <span class="number">0</span>) <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) J[i].x = J[i].x / N + <span class="number">0.5</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123; </span><br><span class="line">    rr <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ; </span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ; </span><br><span class="line">    <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, t ; <span class="built_in">cin</span> &gt;&gt; L1 &gt;&gt; L2 &gt;&gt; P, M = <span class="number">32767</span> ; N = <span class="number">1</span>, t = L1 + L2 ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 ; ++ i) x = qr(), A[i].x = x / M, B[i].x = x % M ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L2 ; ++ i) x = qr(), C[i].x = x / M, D[i].x = x % M ; </span><br><span class="line">    <span class="keyword">while</span>(N &lt;= t) N &lt;&lt;= <span class="number">1</span>, ++ L ; rep(i, <span class="number">0</span>, N) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>)) ;</span><br><span class="line">    FFT(A, <span class="number">1</span>), FFT(B, <span class="number">1</span>), FFT(C, <span class="number">1</span>), FFT(D, <span class="number">1</span>) ;</span><br><span class="line">    rep(i, <span class="number">0</span>, N) H1[i] = A[i] * C[i], H2[i] = B[i] * D[i], H3[i] = A[i] * D[i]+ C[i] * B[i] ; </span><br><span class="line">    FFT(H1, <span class="number">-1</span>), FFT(H2, <span class="number">-1</span>), FFT(H3, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) </span><br><span class="line">        Ans[i] = ((<span class="keyword">long</span> <span class="keyword">long</span>)H1[i].x * M % P * M % P + (<span class="keyword">long</span> <span class="keyword">long</span>)H2[i].x % P + (<span class="keyword">long</span> <span class="keyword">long</span>)H3[i].x * M % P) % P ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 + L2 ; ++ i) <span class="built_in">printf</span>(<span class="string">"%lld "</span>, Ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æœ€ç»ˆçš„å¤æ‚åº¦æ˜¯$\boldsymbol{O(7\cdot P(n) \cdot n \log n)}$ï¼Œå…¶ä¸­$P(n)$æ˜¯$FFT$è‡ªå¸¦çš„ã€å¤§åˆ°ä¸å¯å¿½ç•¥çš„å¸¸é‡å› å­ã€‚</p>
<p>ä½†æ˜¯â€¦â€¦å¥½åƒè¿™ä¸ªå¸¸æ•°æœ‰ç‚¹å¤§è¯¶ï¼Œç®—ä¸Šå¸¸æ•°çš„è¯å·²ç»æ˜¯$O(n \log^2n)$çš„çº§åˆ«äº†ï¼Œäºæ˜¯â€”â€”</p>
<h1 id="rm-0x03-Conjugate-Optimization"><a href="#rm-0x03-Conjugate-Optimization" class="headerlink" title="$\rm{0x03~Conjugate~Optimization}$"></a>$\rm{0x03~Conjugate~Optimization}$</h1><p>æºè‡ªæ¯›å•¸çš„ã€Šå†æ¢å¿«é€Ÿå‚…ç«‹å¶å˜æ¢ã€‹ã€‚</p>
<p>æˆ‘ä»¬æ€è€ƒè¿™æ ·ä¸¤ä¸ªå¤šé¡¹å¼$\boldsymbol{P, Q} \in \mathbb{C}$</p>
<script type="math/tex; mode=display">
\rm{P(x) = A(x) + iB(x)} \\
\rm{Q(x) = A(x) - iB(x)}</script><p>æˆ‘ä»¬ä¸å¦¨ä»¤$Pâ€™[k]$å’Œ$Qâ€™[k]$ä¸ºå…¶$\text{DFT}$ä¹‹åçš„åºåˆ—ï¼Œå³$Pâ€™[k] =P(\omega_n^k),Qâ€™[k] =Q(\omega_n^k) $ã€‚</p>
<p>åŒæ—¶ï¼Œä»¤$\text{conj(x)}$è¡¨ç¤ºå¯¹$x$å–å…±è½­ã€‚</p>
<p>é‚£ä¹ˆä¼šæœ‰$^{[5]}$ï¼š</p>
<script type="math/tex; mode=display">
\begin{align}
P'[k] &= A(\omega_{n}^{k}) + i B(\omega_{n}^{k}) \\
& = \sum_{j=0}^{n-1} A_{j} \omega_{n}^{jk} + i B_{j} \omega_{n}^{jk} \\
& = \sum_{j=0}^{n-1} (A_{j} + i B_{j}) \left(\cos \left(\frac{2 \pi jk}{n}\right) + i \sin \left(\frac{2 \pi jk}{n}\right)\right) \\
& =  \sum_{j=0}^{n-1} (A_{j} + i B_{j}) \omega_{n}^{kj}
\\
Q'[k] &= A(\omega_{n}^{k}) - i B(\omega_{n}^{k}) \\
& = \sum_{j=0}^{n-1} A_{j} \omega_{n}^{jk} - i B_{j} \omega_{n}^{jk} \\
& = \sum_{j=0}^{n-1} (A_{j} - i B_{j}) \left(\cos \left(\frac{2 \pi jk}{n}\right) + i \sin \left(\frac{2 \pi jk}{n}\right)\right) \\
& = \sum_{j=0}^{n-1} \left(A_{j} \cos \left(\frac{2 \pi jk}{n}\right) + B_{j} \sin \left(\frac{2 \pi jk}{n}\right)\right) + i \left(A_{j} \sin \left(\frac{2 \pi jk}{n}\right) - B_{j} \cos \left(\frac{2 \pi jk}{n}\right)\right) \\
& = \text{conj} \left( \sum_{j=0}^{n-1} \left(A_{j} \cos \left(\frac{2 \pi jk}{n}\right) + B_{j} \sin \left(\frac{2 \pi jk}{n}\right)\right) - i \left(A_{j} \sin \left(\frac{2 \pi jk}{n}\right) - B_{j} \cos \left(\frac{2 \pi jk}{n}\right)\right) \right) \\
& = \text{conj} \left( \sum_{j=0}^{n-1} \left(A_{j} \cos \left(\frac{-2 \pi jk}{n}\right) - B_{j} \sin \left(\frac{-2 \pi jk}{n}\right)\right) + i \left(A_{j} \sin \left(\frac{-2 \pi jk}{n}\right) + B_{j} \cos \left(\frac{-2 \pi jk}{n}\right)\right) \right) \\
& = \text{conj} \left( \sum_{j=0}^{n-1} (A_{j} + i B_{j}) \left(\cos \left(\frac{-2 \pi jk}{n}\right) + i \sin \left(\frac{-2 \pi jk}{n}\right)\right)\right) \\
& = \text{conj} \left( \sum_{j=0}^{n-1} (A_{j} + i B_{j}) \omega_{n}^{-jk} \right) \\
& = \text{conj} \left( \sum_{j=0}^{n-1} (A_{j} + i B_{j}) \omega_{n}^{(n-k)j} \right) \\
& = \text{conj} \left( P'[n-k] \right)
\end{align}</script><p>å¥½å§æˆ‘æ‰¿è®¤è¿™æ®µæ¨å¯¼è¿‡ç¨‹çš„ä»£ç ç”šæ˜¯å£®è§‚ï¼Œäºæ˜¯å¹¶ä¸æ˜¯æˆ‘è‡ªå·±å†™çš„qwqã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å‘ç°å…¶ä¸­$A(x)$å’Œ$B(x)$å¯ä»¥é€šè¿‡$P,Q$æ¨å‡ºæ¥ï¼š</p>
<script type="math/tex; mode=display">
A'[k] = \frac{P'[k] + Q'[k]}{2} \\
B'[k] = \frac{P'[k] - Q'[k]}{2i}</script><p>å“¦ï¼Œå¯¹äº†ï¼Œå½“$k=0$æ—¶ï¼Œç”±äºä¸å­˜åœ¨è¿™ä¸€é¡¹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç‰¹åˆ¤ä¸€ä¸‹ã€‚å¹¶ä¸”ç”±äºæˆ‘ä»¬çš„$P(x)$å’Œ$Q(x)$çš„å®éƒ¨å’Œè™šéƒ¨éƒ½å¯ä»¥åˆ©ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹äºä¸ƒæ¬¡$DFT$å¯ä»¥ä¼˜åŒ–åˆ°$4$æ¬¡$DFT$.</p>
<p>ä»¥ä¸‹æ˜¯å…±è½­ä¼˜åŒ–$FFT$çš„åˆå·æœºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 423333</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(i = a ; i &lt;= b ; ++ i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">int</span> f[MAXN], g[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> R[MAXN], Len, x, Ans[MAXN] ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1</span>) ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">double</span> r, i ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="title">node</span> <span class="params">(<span class="keyword">long</span> <span class="keyword">double</span> xx = <span class="number">0</span>, <span class="keyword">long</span> <span class="keyword">double</span> yy = <span class="number">0</span>)</span></span>&#123;</span><br><span class="line">        r = xx, i = yy ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> node <span class="title">Conj</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> node(r, -i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;A[MAXN], B[MAXN], w[MAXN], t1[MAXN], t2[MAXN] ;</span><br><span class="line">node H1[MAXN], H2[MAXN], H3[MAXN] ; <span class="keyword">int</span> L1, L2, P, N, M ;</span><br><span class="line">node <span class="keyword">operator</span> + (node J, node Q)&#123; <span class="keyword">return</span> node(J.r + Q.r , J.i + Q.i); &#125;</span><br><span class="line">node <span class="keyword">operator</span> - (node J, node Q)&#123; <span class="keyword">return</span> node(J.r - Q.r , J.i - Q.i); &#125;</span><br><span class="line">node <span class="keyword">operator</span> * (node J, node Q)&#123; <span class="keyword">return</span> node(J.r * Q.r - J.i * Q.i , J.r * Q.i + J.i * Q.r) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123; </span><br><span class="line">    rr <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ; <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ; <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(node *J, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, j, k, l ; </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; R[i]) swap(J[i], J[R[i]]) ;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; N; j &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; N; k += (j &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j; ++ l)&#123;</span><br><span class="line">                node T = w[N / j * l] ; T.i *= flag ;</span><br><span class="line">                node Nx = J[k + l], Ny = T * J[k + j + l] ;</span><br><span class="line">                J[k + l] = Nx + Ny, J[k + j + l] = Nx - Ny ;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">int</span> L)</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i ; <span class="keyword">while</span> (N &lt;= L) N &lt;&lt;= <span class="number">1</span>, ++ Len ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) A[i] = node(f[i] &amp; <span class="number">32767</span>, f[i] &gt;&gt; <span class="number">15</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) B[i] = node(g[i] &amp; <span class="number">32767</span>, g[i] &gt;&gt; <span class="number">15</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) w[i] = node(<span class="built_in">cos</span>(Pi * i / N), <span class="built_in">sin</span>(Pi * i / N)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (Len - <span class="number">1</span>)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MTT</span><span class="params">()</span></span>&#123;</span><br><span class="line">    node ia, ib, a1, a2, b1, b2 ;</span><br><span class="line">    rr <span class="keyword">int</span> i, k, t = L1 + L2, q1, q2, q3 ; Init(t) ;</span><br><span class="line">    <span class="comment">// for (i = 0 ; i &lt;= N ; ++ i) cout &lt;&lt; A[i].r &lt;&lt; " "; cout &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">// for (i = 0 ; i &lt;= N ; ++ i) cout &lt;&lt; B[i].r &lt;&lt; " "; cout &lt;&lt; endl ;</span></span><br><span class="line">    FFT(A, <span class="number">1</span>), FFT(B, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">        k = (N - i) &amp; (N - <span class="number">1</span>), ia = A[k].Conj(), ib = B[k].Conj() ;<span class="comment">//(ia,ib) = Q</span></span><br><span class="line">        a1 = (ia + A[i]) * node(<span class="number">0.5</span>, <span class="number">0</span>), a2 = (A[i] - ia) * node(<span class="number">0</span>, <span class="number">-0.5</span>) ;</span><br><span class="line">        b1 = (ib + B[i]) * node(<span class="number">0.5</span>, <span class="number">0</span>), b2 = (B[i] - ib) * node(<span class="number">0</span>, <span class="number">-0.5</span>) ;</span><br><span class="line">        t1[i] = a1 * b1 + (a1 * b2 + b1 * a2) * node(<span class="number">0</span>, <span class="number">1</span>), t2[i] = a2 * b2 ;</span><br><span class="line">    &#125;  FFT(t1, <span class="number">-1</span>), FFT(t2, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="comment">// for (i = 0 ; i &lt;= N ; ++ i) cout &lt;&lt; w[i].r &lt;&lt; " "; cout &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">// for (i = 0 ; i &lt;= N ; ++ i) cout &lt;&lt; A[i].r &lt;&lt; " "; cout &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">// for (i = 0 ; i &lt;= N ; ++ i) cout &lt;&lt; B[i].r &lt;&lt; " "; cout &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">        q1 = (<span class="keyword">long</span> <span class="keyword">long</span>)(t1[i].r / N + <span class="number">0.5</span>) % P, q2 = (<span class="keyword">long</span> <span class="keyword">long</span>)(t1[i].i / N + <span class="number">0.5</span>) % P ;</span><br><span class="line">        q3 = (<span class="keyword">long</span> <span class="keyword">long</span>)(t2[i].r / N + <span class="number">0.5</span>) % P, Ans[i] = ((((<span class="keyword">long</span> <span class="keyword">long</span>)q3 &lt;&lt; <span class="number">30</span>) % P + ((<span class="keyword">long</span> <span class="keyword">long</span>)q2 &lt;&lt; <span class="number">15</span>) % P + q1) % P + P) % P ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i ; </span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; L1 &gt;&gt; L2 &gt;&gt; P ; N = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 ; ++ i) f[i] = qr() % P ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L2 ; ++ i) g[i] = qr() % P ; MTT() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 + L2 ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d "</span>, Ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-0x04-quad-æ‹¼å‘½å¡å¸¸"><a href="#rm-0x04-quad-æ‹¼å‘½å¡å¸¸" class="headerlink" title="$\rm{0x04\quad}$æ‹¼å‘½å¡å¸¸"></a>$\rm{0x04\quad}$æ‹¼å‘½å¡å¸¸</h1><p>å¥½çš„ï¼Œé¦–å…ˆæˆ‘ä»¬å¯ä»¥æ¬£èµä¸€ä¸‹æœ€åˆçš„ç‰ˆæœ¬ï¼ˆç”¨å°å·äº¤çš„æ‹†ç³»æ•°$FFT$ + $O2$ï¼‰</p>
<p><img src="1.png" alt></p>
<p>ç„¶åæ˜¯å¤§å·çš„å…±è½­ä¼˜åŒ–$FFT$ï¼ˆä¸åŠ $O2$ï¼Œå³ä¸Šæ–¹ä»£ç ï¼‰ï¼š</p>
<p><img src="2.png" alt></p>
<p>ç‰¹åˆ«çš„ï¼Œä»¥ä¸‹æ˜¯æ— å…±è½­ä¼˜åŒ–çš„æ‹†ç³»æ•°$FFT$ï¼Œä¸å¼€$O2$:</p>
<p><img src="3.png" alt></p>
<p><img src="4.png" alt></p>
<p>å¥½å§ï¼Œä»–çœ‹èµ·æ¥æ²¡æœ‰å¿«å¤šå°‘ã€‚æ¯•ç«Ÿéƒ½æ˜¯åŒé˜¶çš„å¤æ‚åº¦ï¼Œå¥½åƒåè€…çš„å¸¸æ•°æ›´å¤§é‚£ä¹ˆä¸€ç‚¹â€¦â€¦</p>
<p>äºæ˜¯è€ƒè™‘å¯¹å…±è½­ä¼˜åŒ–çš„è¿›è¡Œå¤§åŠ›å¡å¸¸ï¼š</p>
<ul>
<li>å¤šæ¬¡ä½¿ç”¨çš„éå…¨å±€å˜é‡ã€‚ä½¿ç”¨<code>register</code>ä¿®é¥°ç¬¦ã€‚</li>
<li>å°†$double$è½¬æ¢æˆä¸º$long~double$ ã€‚</li>
<li>å‡å°‘å–æ¨¡æ¬¡æ•°ã€‚</li>
<li>ä»yjké‚£é‡Œå·æ¥çš„$\rm{fread/fwrite}$</li>
</ul>
<p>ä¸€ç•ªæ“ä½œä¹‹åï¼Œæˆ‘ä»¬æˆåŠŸåœ°å¡åˆ°äº†ç¬¬äº”é¡µä¸Šâ€¦â€¦</p>
<p><img src="5.png" alt></p>
<p>æœ€åå¥‰ä¸Šæœ€å¿«çš„ä»£ç qwqï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// luogu-judger-enable-o2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"Ofast"</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 102333</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 272333</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(i = a ; i &lt;= b ; ++ i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IO&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> ch_top=<span class="number">4e7</span>+<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">char</span> ch[ch_top],*now_r=ch<span class="number">-1</span>,*now_w=ch<span class="number">-1</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">while</span>(*++now_r&lt;<span class="string">'0'</span>);</span><br><span class="line">    	<span class="keyword">register</span> <span class="keyword">int</span> x=*now_r-<span class="string">'0'</span>;</span><br><span class="line">    	<span class="keyword">while</span>(*++now_r&gt;=<span class="string">'0'</span>)x=x*<span class="number">10</span>+*now_r-<span class="string">'0'</span>;</span><br><span class="line">    	<span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">   		<span class="keyword">static</span> <span class="keyword">char</span> st[<span class="number">20</span>];<span class="keyword">static</span> <span class="keyword">int</span> top;</span><br><span class="line">    	<span class="keyword">while</span>(st[++top]=<span class="string">'0'</span>+x%<span class="number">10</span>,x/=<span class="number">10</span>);</span><br><span class="line">    	<span class="keyword">while</span>(*++now_w=st[top],--top);</span><br><span class="line">    	*++now_w=<span class="string">' '</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> R[MAXM], Len, x, Ans[MAXN &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> r, i ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> node <span class="title">Conj</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> node(r, -i); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="title">node</span> <span class="params">(<span class="keyword">double</span> xx = <span class="number">0</span>, <span class="keyword">double</span> yy = <span class="number">0</span>)</span></span>&#123;</span><br><span class="line">        r = xx, i = yy ;</span><br><span class="line">    &#125;<span class="comment">//å®šä¹‰çš„Complexå‹æ˜¯ç”¨æ¥è¿›è¡Œå¤æ•°è¿ç®—çš„ </span></span><br><span class="line">&#125;A[MAXM], B[MAXM], w[MAXM], t1[MAXM], t2[MAXM] ; <span class="keyword">int</span> L1, L2, P, N, M ;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> + (<span class="keyword">const</span> node &amp;J, <span class="keyword">const</span> node &amp;Q) &#123; <span class="keyword">return</span> node(J.r + Q.r , J.i + Q.i); &#125;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> - (<span class="keyword">const</span> node &amp;J, <span class="keyword">const</span> node &amp;Q) &#123; <span class="keyword">return</span> node(J.r - Q.r , J.i - Q.i); &#125;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> * (<span class="keyword">const</span> node &amp;J, <span class="keyword">const</span> <span class="keyword">double</span> &amp;Q) &#123; <span class="keyword">return</span> (node) &#123;J.r * Q, J.i * Q&#125; ; &#125;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> * (<span class="keyword">const</span> node &amp;J, <span class="keyword">const</span> node &amp;Q) &#123; <span class="keyword">return</span> node(J.r * Q.r - J.i * Q.i , J.r * Q.i + J.i * Q.r) ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">FFT</span><span class="params">(node *J)</span></span>&#123;</span><br><span class="line">    rr node t ;</span><br><span class="line">    rr <span class="keyword">int</span> i, j, k, l ; </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; R[i]) t = J[i], J[i] = J[R[i]], J[R[i]] = t ;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; N; j &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; N; k += (j &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j; ++ l)&#123;</span><br><span class="line">                rr node T = w[N / j * l] ;</span><br><span class="line">            	rr node Nx = J[k + l], Ny = T * J[k + j + l] ;</span><br><span class="line">                J[k + l] = Nx + Ny, J[k + j + l] = Nx - Ny ;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IFFT</span><span class="params">(node *J)</span></span>&#123;</span><br><span class="line">    reverse(J + <span class="number">1</span>, J + N), FFT(J) ; </span><br><span class="line">    rr <span class="keyword">int</span> i ; rr <span class="keyword">double</span> qwq = <span class="number">1.0</span> / N ; </span><br><span class="line">    rep(i, <span class="number">0</span>, N - <span class="number">1</span>) J[i] = J[i] * qwq ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> IO ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fread(ch,<span class="number">1</span>,ch_top,<span class="built_in">stdin</span>); </span><br><span class="line">    rr <span class="keyword">int</span> i, k, t ; rr node ia, ib, a1, a2, b1, b2 ; </span><br><span class="line">    t = ((L1 = read()) + (L2 = read())), P = read(), N = <span class="number">1</span> ; </span><br><span class="line">    <span class="keyword">while</span> (N &lt;= t) N &lt;&lt;= <span class="number">1</span>, ++ Len ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 ; ++ i) x = read(), A[i] = node(x &amp; <span class="number">32767</span>, x &gt;&gt; <span class="number">15</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L2 ; ++ i) x = read(), B[i] = node(x &amp; <span class="number">32767</span>, x &gt;&gt; <span class="number">15</span>) ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) w[i] = node(<span class="built_in">cos</span>(Pi * i / N), <span class="built_in">sin</span>(Pi * i / N)), R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (Len - <span class="number">1</span>)) ;</span><br><span class="line">    FFT(A), FFT(B) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">        k = (N - i) &amp; (N - <span class="number">1</span>), ia = A[k].Conj(), ib = B[k].Conj() ;<span class="comment">//(ia,ib) = Q</span></span><br><span class="line">        a1 = (ia + A[i]) * node(<span class="number">0.5</span>, <span class="number">0</span>), a2 = (A[i] - ia) * node(<span class="number">0</span>, <span class="number">-0.5</span>) ;</span><br><span class="line">        b1 = (ib + B[i]) * node(<span class="number">0.5</span>, <span class="number">0</span>), b2 = (B[i] - ib) * node(<span class="number">0</span>, <span class="number">-0.5</span>) ;</span><br><span class="line">        t1[i] = a1 * b1 + (a1 * b2 + b1 * a2) * node(<span class="number">0</span>, <span class="number">1</span>), t2[i] = a2 * b2 ;</span><br><span class="line">    &#125;  </span><br><span class="line">    IFFT(t1), IFFT(t2) ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= t ; ++ i)</span><br><span class="line">        write(((ll)(t1[i].r + <span class="number">0.5</span>) + ((ll)(t1[i].i + <span class="number">0.5</span>) % P &lt;&lt; <span class="number">15</span>) + ((ll)(t2[i].r + <span class="number">0.5</span>) % P &lt;&lt; <span class="number">30</span>)) % P) ;</span><br><span class="line">    fwrite(ch,<span class="number">1</span>,now_w-ch,<span class="built_in">stdout</span>); <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®è·µè¯æ˜ï¼Œä»¥ä¸Šä»£ç ä¸åŠ ä»»ä½•ä¼˜åŒ–ï¼ˆä¸å¼€$\rm{O2/3/fast}$ï¼‰ç”šè‡³å¯ä»¥å¿«$4ms$ï¼<br><img src="6.png" alt></p>
<h1 id="rm-0x00-quad-Afterword"><a href="#rm-0x00-quad-Afterword" class="headerlink" title="$\rm{0x00\quad Afterword}$"></a>$\rm{0x00\quad Afterword}$</h1><p>å—¯ï¼Œå…¶å®æŒ‰é“ç†æ¥è®²ï¼Œä¸æ˜¯ç‰¹åˆ«éš¾ã€‚ä½†æ˜¯è¿™è·Ÿ$HLPP$ä¸€æ ·ï¼Œéƒ½æ˜¯æ‰“æ­»éƒ½ä¸ä¼šè€ƒçš„ç®—æ³•ï¼Œæ‰€ä»¥å­¦è¿™äº›åªæ˜¯ä¸ºäº†å¨±ä¹â€¦â€¦å¬èµ·æ¥æŒºè‹å‡‰ï¼Ÿ</p>
<p>ä½†ä¼¼ä¹ï¼Œä»ä¸€å¼€å§‹å°±ä¸åº”è¯¥æŠŠåº”ä»˜è€ƒç‚¹ä½œä¸ºOIçš„åˆè¡·å§ï¼Œè™½ç„¶å¦‚æœæ²¡æœ‰è·åˆ©ï¼Œæ²¡æœ‰å¤šå°‘äººä¼šå»å­¦ï¼Œä½†æ˜¯ä¸æ²¾æŸ“åŠŸåˆ©çš„OIï¼Œä¼¼ä¹å¯çˆ±äº†é‚£ä¹ˆå‡ åˆ†å‘¢â€¦â€¦</p>
<p>å¹¶ä¸”åœ¨å­¦çš„è¿‡ç¨‹ä¸­é¡ºä¾¿è®¤è¯†äº†ä¸€ä¸ªå·¨ä½¬<code>CMXRYNP</code>ï¼Œå˜¿å˜¿ï¼Œä¹Ÿç®—ä¸äºå•¦ã€‚</p>
<p>æœ¬ç¯‡æ–‡ç« çœŸå®å®Œç¨¿æ—¶é—´æ˜¯$2019/3/17$ï¼Œå› ä¸ºå¤ªæ‡’+å¤ªå¿™ï¼Œé¸½äº†ä¸€ä¸ªæœˆ$\rm{qaq}$.</p>
<h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$\rm{Reference}$"></a>$\rm{Reference}$</h2><ul>
<li>$[1]$ :$lvzelong2014$çš„$blog$ <a href="https://blog.csdn.net/lvzelong2014/article/details/80156989" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li>
<li>$[2]$:<code>æ— æ¢¦ä¹‹æ¢¦</code>çš„$blog$ <a href="https://www.cnblogs.com/DreamlessDreams/p/10241267.html" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li>
<li>$[3]$:$Cyhlnj$çš„$blog$ <a href="https://www.cnblogs.com/cjoieryl/p/10114614.html" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li>
<li>$[4]$:$litble$çš„$blog$ <a href="https://blog.csdn.net/litble/article/details/84864516" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li>
<li>$[5]$:$CMXRYNP$çš„$blog$ <a href="https://cmxrynp.github.io/2019/01/07/fft-optimization/" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li>
<li>$[6]$ :2016å›½å®¶é›†è®­é˜Ÿè®ºæ–‡ã€Šå†æ¢å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ã€‹æ¯›å•¸Â· <a href="https://pan.baidu.com/s/1aN2L7DAm_RY2GeN5Snxj1A" target="_blank" rel="noopener">$^{^{[\nearrow]}}$</a> æå–ç ï¼švua4</li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¤šé¡¹å¼</category>
      </categories>
      <tags>
        <tag>å¤šé¡¹å¼åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘ä»å•ä½æ ¹åˆ°FFT</title>
    <url>/2019/02/19/FFT1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt></p>
<h1 id="rm-0x01-quad-Preface"><a href="#rm-0x01-quad-Preface" class="headerlink" title="$ \rm{0x01\quad Preface} $"></a>$ \rm{0x01\quad Preface} $</h1><p>è¿™ç¯‡æ–‡ç« åˆå†™äº $ 7/1/2018 $ ï¼Œæ˜¯åœ¨é™ªåŒå¥½å‹ $ yjk $ ä¸ $ wx $ ä»¥åŠå­¦é•¿ $ rqy $ ä¸€èµ·å»å‚åŠ çœé˜Ÿé›†è®­æ—¶å†™çš„ã€‚ä»Šå¤©çªç„¶æ¥äº†å…´è‡´ï¼Œæ‰“ç®—é‡æ–°å¤ä¹ ä¸€é $ FFT $ å¹¶ä¸”å†™ $ MTT $ ï¼Œäºæ˜¯ä¾¿æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚</p>
<p>å…¶å®ä¸€å¼€å§‹æˆ‘æ˜¯ä¸æƒ…æ„¿æŠŠè¿™ç¯‡æ–‡ç« æ¬åˆ°è¿™å„¿æ¥çš„â€”â€”è¿™å¥½åƒæ˜¯ä¸€ä¸ªæ—¶ä»£çš„ç¼©å½±ï¼Œé‚£ä¸ªæ—¶ä»£çš„<code>orchidany</code>ç‰¹åˆ«å–œæ¬¢æ‰®æ¼”è€å¸ˆï¼Œæ¯å¤©ä»¿ä½›æ¥åˆ°å¥¥èµ›å®¤åªæ˜¯ä¸ºäº†â€œä¸ºäººå¸ˆâ€çš„ï¼šå¿ƒæ€§æµ®èºï¼Œå­¦ä¹ åŠŸåˆ©ã€‚ä½†ç°åœ¨æˆ‘åˆ™æ˜¯æƒ³æ²‰ä¸‹å¿ƒæ¥ï¼Œè®¤çœŸåšå­¦é—®ã€‚</p>
<p>ä½†æ— è®ºå¦‚ä½•ï¼Œæˆ‘å¸Œæœ›è¿™ç¯‡åŸæœ¬å†—æ‚ç¹é•¿çš„æ–‡ç« å¯ä»¥æ›´çŸ­ã€æ›´æ–°é¢–ã€ä»æ›´é«˜çš„è§’åº¦å®¡è§†ä¸€äº›é—®é¢˜ã€‚</p>
<h1 id="rm-0x02-quad-Convolution"><a href="#rm-0x02-quad-Convolution" class="headerlink" title="$ \rm{0x02\quad Convolution} $"></a>$ \rm{0x02\quad Convolution} $</h1><p><strong>å·ç§¯ $ \boldsymbol{(Convolution)} $ </strong>ï¼Œå‡†ç¡®æ¥è¯´æ˜¯ä¸€ç§<strong>é€šè¿‡ä¸¤ä¸ªå‡½æ•° $ \boldsymbol f $  å’Œ $ \boldsymbol g $  ç”Ÿæˆç¬¬ä¸‰ä¸ªå‡½æ•°çš„ä¸€ç§æ•°å­¦ç®—å­.</strong></p>
<p>è€Œå¹¿ä¹‰ä¸Šå…¶å®šä¹‰ä¸ºï¼š <script type="math/tex">\boldsymbol{h(x) = \int _{- \infty} ^{\infty}g(\tau) \cdot f(x - \tau)} \rm{d\tau}</script> </p>
<p>æˆ‘ä»¬ç§° $ h(x) $ æ˜¯ $ g(x) $ ä¸ $ f(x) $ çš„<strong>å·ç§¯</strong>ã€‚</p>
<p>è€Œæ­¤å¤„æˆ‘ä»¬è®¨è®ºçš„æ˜¯æ•´æ¬¡å¤šé¡¹å¼åŸŸï¼Œé‚£ä¹ˆå°±æŠŠå…¶å®šä¹‰åˆ’å½’è¿›å¤šé¡¹å¼ï¼Œå¾—åˆ°</p>
<script type="math/tex; mode=display">A(x) \cdot B(x) =\sum\limits_{i = 0}^{n} \sum\limits_{j=0}^{i}{a_jb_{i-j}}</script><p>å…¶ä¸­ $ A(x) $ å’Œ $ B(x) $ å‡ä¸º $ N-1 $ æ¬¡å¤šé¡¹å¼<br>æ¯”è¾ƒæ˜¾ç„¶çš„æ˜¯ï¼Œåœ¨æˆ‘ä»¬åˆå¹¶åŒç±»é¡¹çš„æƒ…å†µä¸‹ï¼Œæœ€ç»ˆå·å‡ºæ¥çš„ç»“æœåº”è¯¥æœ‰ $ 2n+1 $ é¡¹ã€‚</p>
<h1 id="rm-0x03-quad-Dot-Method"><a href="#rm-0x03-quad-Dot-Method" class="headerlink" title="$ \rm{0x03\quad Dot~Method} $"></a>$ \rm{0x03\quad Dot~Method} $</h1><p>æˆ‘ä»¬çŸ¥é“ï¼ŒåŸæœ¬çš„å¤šé¡¹å¼æ˜¯ç³»æ•°è¡¨ç¤ºæ³•ï¼Œç°åœ¨æˆ‘ä»¬å°†å…¶è½¬åŒ–ä¸º<strong>ç‚¹å€¼è¡¨ç¤ºæ³• $ (\boldsymbol{dot~method} ) $ </strong>ã€‚å³æˆ‘ä»¬å¯ä»¥æŠŠå¤šé¡¹å¼ $ F(x) $ è½¬åŒ–ä¸ºå¤šé¡¹å¼å‡½æ•° $ f(x) $ ï¼Œé‚£ä¹ˆè¿™ä¸ª $ n $ é˜¶å‡½æ•°å°±å¯ä»¥ç”± $ n+1 $ ä¸ªç‚¹å”¯ä¸€ç¡®å®šã€‚å³ <script type="math/tex">f(x)\Longleftrightarrow{(x_0,y_0),(x_1,y_1),(x_2,y_2)....(x_n,y_n)}</script> é‚£ä¹ˆ <script type="math/tex">\forall k,y_k = f(x_k)</script> è¿™æ˜¯å¾ˆæ˜¾ç„¶çš„ï¼Œå¹¶ä¸”è¿™ $ n+ $ ä¸ªç‚¹æ˜¯éšæ„é€‰å–çš„â€”â€”åªè¦æ±‚å®ƒä»¬ç›¸å¼‚å³å¯ã€‚</p>
<ul>
<li><h2 id="rm-Advanced-Trick-Point-color-red-1-rm-Multiplication"><a href="#rm-Advanced-Trick-Point-color-red-1-rm-Multiplication" class="headerlink" title="$ \rm{Advanced~Trick~Point} $   $ \color{red}{1} $   $ \rm{Multiplication} $"></a>$ \rm{Advanced~Trick~Point} $   $ \color{red}{1} $   $ \rm{Multiplication} $</h2></li>
</ul>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªå…³äº $ x $ çš„ $ n+1 $ æ¬¡å¤šé¡¹å¼ $ A(x) $ å’Œ $ B(x) $ ï¼Œæˆ‘ä»¬è¦å¯¹å®ƒçš„ç‚¹å€¼è¡¨è¾¾å¼è¿›è¡Œä¹˜æ³•æ“ä½œã€‚ç”±äºç»“æœæœ‰ $ 2n+1 $ é¡¹ï¼Œæˆ‘ä»¬è€ƒè™‘è¡¥ä¸Šä¸€å †é¡¹ï¼Œå¹¶å¯¹ <script type="math/tex">A(x) = {(x_0,y_0),(x_1,y_1)....(x_{2n},y_{2n})}</script>   <script type="math/tex">B(x) = {(x_0,y_0'),(x_1,y_1')....(x_{2n},y_{2n})}</script>  åšä¹˜æ³•å¯å¾—  <script type="math/tex">A(x)B(x) = {(x_0,y_0y_0'),(x_1,y_1y_1')(x_{2n},y_{2n}y_{2n}')}</script>   </p>
<p>æˆ‘ä»¬è§‚å¯Ÿç‚¹ä¹˜æ³•ï¼Œå®ƒçš„æ—¶é—´å¤æ‚åº¦è¾¾åˆ°äº† $ \Theta(n) $ ï¼Œå®Œå…¨å¯ä»¥æ¥å—ã€‚é‚£ä¹ˆä¸å¦¨å…ˆçœ‹ä¸€ä¸‹ç®—æ³•çš„å¤§ä½“æ€è·¯ï¼š</p>
<blockquote>
<p>å¯¹äºæ¯ä¸ªå› å­å¤šé¡¹å¼ï¼Œé€‰å– $ n+1 $ ä¸ªç‚¹ï¼Œå¾—å‡ºç‚¹å€¼è¡¨è¾¾å¼ï¼ˆå¤æ‚åº¦ $ \Theta(n^2) $ ï¼‰  $ \longrightarrow $ ç‚¹ä¹˜æ³•(æ—¶é—´å¤æ‚åº¦ $ \Theta(n) $ )â€”â€”&gt;å°†å¾—å‡ºæ¥çš„ $ C(x) $ çš„ç‚¹å€¼è¡¨è¾¾å¼å†è½¬æ¢æˆç³»æ•°è¡¨è¾¾å¼(å¤æ‚åº¦ $ \Theta(n^2) $ )</p>
</blockquote>
<p>è¿™å°±æ˜¯ $ FFT $ çš„å¤§ä½“æµç¨‹ã€‚<del>è½¬åŒ–ä¹‹åæ€ä¹ˆæ²¡å¤šå¿«å¸¸æ•°è¿˜å¤§äº†</del></p>
<p>è™½ç„¶å…¶ä½™éƒ¨åˆ†çš„æ—¶é—´å¤æ‚åº¦è¿˜æ˜¯å¾ˆéº»çƒ¦çš„ $ O(n^2) $ ï¼Œä½†æ˜¯éƒ½æ˜¯å¯ä»¥ä¼˜åŒ–æˆ $ O(nlogn) $ çš„ã€‚</p>
<hr>
<p>æœ¬è´¨ä¸Šçš„ $ FFT $ åŒ…å«<strong> $ \boldsymbol{DFT} $ ï¼ˆç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼‰</strong>å’Œ<strong> $ \boldsymbol{IDFT} $ ï¼ˆé€†ç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼‰</strong>å®é™…ä¸Šï¼Œ<strong> $ DFT $ </strong>å¯¹åº”ç€çš„å°±æ˜¯<strong>æŠŠç³»æ•°è¡¨è¾¾å¼æ˜ å°„åˆ°ç‚¹å€¼è¡¨è¾¾å¼</strong>çš„è¿‡ç¨‹ï¼Œ<strong> $ IDFT $ </strong>å¯¹åº”ç€çš„å°±æ˜¯æˆ‘ä»¬<strong>æŠŠç‚¹å€¼è¡¨è¾¾å¼æ˜ å°„åˆ°ç³»æ•°è¡¨è¾¾å¼</strong>çš„è¿‡ç¨‹ã€‚</p>
<h1 id="rm-0x04-Base-of-Optimization"><a href="#rm-0x04-Base-of-Optimization" class="headerlink" title="$ \rm{0x04~Base ~of~Optimization} $"></a>$ \rm{0x04~Base ~of~Optimization} $</h1><p>å› ä¸ºå®é™…ä¸Šï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€æ­¥â€”â€”æ±‚å€¼ï¼ˆç³»æ•°è½¬ç‚¹å€¼ï¼‰å’Œæˆ‘ä»¬çš„ç¬¬ä¸‰æ­¥ï¼ˆç‚¹å€¼è½¬ç³»æ•°ï¼‰éƒ½æ˜¯å¯ä»¥åšåˆ° $ nlogn $ çš„ï¼Œé‚£ä¹ˆæ€»çš„æ—¶é—´å¤æ‚åº¦ï¼Œæ¸è¿›æ„ä¹‰ä¸‹å°±æ˜¯ $ O(nlogn) $ çš„ã€‚</p>
<p>ä¸‹é¢å°±è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä¼˜åŒ–ï¼š</p>
<ul>
<li><h2 id="rm-Advanced-Trick-Point-color-red-2-rm-Unit-Complex-Root"><a href="#rm-Advanced-Trick-Point-color-red-2-rm-Unit-Complex-Root" class="headerlink" title="$ \rm{Advanced~Trick~Point} $   $ \color{red}{2} $   $ \rm{Unit ~Complex ~Root} $"></a>$ \rm{Advanced~Trick~Point} $   $ \color{red}{2} $   $ \rm{Unit ~Complex ~Root} $</h2><p>$ n $ æ¬¡å•ä½å¤æ ¹æ˜¯æ»¡è¶³ $ \omega^n = 1 $  çš„å¤æ•° $ \omega $ ï¼Œå…¶ä¸­æˆ‘ä»¬å¯ä»¥ç”±å¤æ•°çš„è¿ç®—æ³•åˆ™ï¼ˆè¾è§’ç›¸åŠ ï¼Œæ¨¡ç›¸ä¹˜ï¼‰å¾ˆç®€å•åœ°å¾—å‡º<strong> $ n $ æ¬¡å•ä½æ ¹æœ‰ $ n $ ä¸ª</strong>è¿™ä¸ªç»“è®ºâ€”â€”äº¦æˆ–è€…æ˜¯ç”¨ä»£æ•°åŸºæœ¬å®šç†è¯ï¼Œéƒ½å¯ä»¥ã€‚è€Œåˆå› ä¸ºå¤æ•° $ \omega^n $ åœ¨å¤æ•°å¹³é¢ä¸Šçš„æ¨¡éƒ½æ˜¯ä¸€ï¼Œæ‰€ä»¥ç›¸ä¹˜ä¹‹åè¿˜ä¼šæ˜¯ä¸€ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„ $ \omega_i,1 \leq i \leq n $ å°±ä¼šå‡åŒ€åˆ†å¸ƒåœ¨å•ä½åœ†ä¸Šï¼Œç±»ä¼¼å½“ $ n = 8 $ æ—¶å®ƒæ˜¯è¿™æ ·çš„ï¼š</p>
</li>
</ul>
<p><img src="1.png" alt></p>
<p>æˆ‘ä»¬è€ƒè™‘æ¬§æ‹‰å…¬å¼ï¼š</p>
<script type="math/tex; mode=display">e^{ix} = cosx + isinx</script><p>æˆ‘ä»¬å– $ x =2\pi $ ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹å…³ç³»å¼ï¼š <script type="math/tex">e^{2 \pi i} = 1 = \omega^n \Longleftrightarrow \omega = e^{\frac{2\pi i}{n}}</script> </p>
<p>ä»¬æŠŠæ­¤æ—¶çš„å•ä½æ ¹ç§°ä¹‹ä¸º<strong>ä¸»æ¬¡å•ä½æ ¹</strong>ï¼Œè®°ä½œ <script type="math/tex">\omega_n = e^{\frac{2\pi i}{n}}</script> </p>
<p>é‚£ä¹ˆå¯¹äºå…¶ä»–çš„å•ä½æ ¹ï¼Œè®°ä½œ <script type="math/tex">\omega_n^k=e^{\frac{2\pi ik}{n}},0 \leq k < n</script> éƒ½æ˜¯ä¸»æ¬¡å•ä½æ ¹çš„æ•´æ¬¡å¹‚ï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸­çš„ä¸€åœˆã€‚</p>
<hr>
<p>è¯¶ï¼Œè¿™ä¸ªæœ‰å•¥ç”¨å•Š $ QAQ $ ?</p>
<p>é‚£æ˜¯å› ä¸ºå•ä½æ ¹ä»¬æœ‰ä¸€å †ç‰¹åˆ«å¥½ç”¨çš„æ€§è´¨ï¼Œè®©æˆ‘ä»¬å¯ä»¥å°†æ•°æ®è§„æ¨¡ä¸æ–­æŠ˜åŠï¼Œä½¿å¾—å…¶è¾¾åˆ° $ nlogn $ çš„å¤æ‚åº¦â€¦â€¦</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å…ˆæ¥çœ‹å…¶æ”¯æŒå…¶è§„æ¨¡å‡åŠçš„å¼•ç†ï¼š</p>
<ul>
<li><h3 id="frak-Elimination-Lemma-quad-æ¶ˆå»å¼•ç†"><a href="#frak-Elimination-Lemma-quad-æ¶ˆå»å¼•ç†" class="headerlink" title="$ \frak{Elimination ~Lemma\quad} $ æ¶ˆå»å¼•ç†"></a>$ \frak{Elimination ~Lemma\quad} $ æ¶ˆå»å¼•ç†</h3></li>
</ul>
<hr>
<blockquote>
<p><strong>å¼•ç†ï¼šå¯¹ä»»ä½•æ•´æ•° $ n \geq 0,k \geq 0,d &gt;0 $ ,æœ‰ <script type="math/tex">\omega_{dn}^{dk} = \omega_n^k</script> </strong></p>
</blockquote>
<p> $ \mathcal{Proof.} $ </p>
<p>è¿™ä¸ªå¥½åƒå¾ˆå¥½è¯çš„æ ·å­â€¦â€¦ä»£å…¥å®šä¹‰å¯ä»¥è·å¾— <script type="math/tex">\omega_{dn}^{dk} = \omega^{\frac{2\pi dk}{dn}} = e^{\frac{2\pi ik}{n}} = \omega_n^k</script><br> $ \mathcal{Q.E.D.} $ </p>
<hr>
<ul>
<li><h3 id="frak-Binary-Lemma-quad-æŠ˜åŠå¼•ç†"><a href="#frak-Binary-Lemma-quad-æŠ˜åŠå¼•ç†" class="headerlink" title="$ \frak{Binary~Lemma\quad} $  æŠ˜åŠå¼•ç†"></a>$ \frak{Binary~Lemma\quad} $  æŠ˜åŠå¼•ç†</h3></li>
</ul>
<hr>
<blockquote>
<p><strong>å¼•ç†ï¼šå¯¹äºä»»ä½•å¤§äº $ 0 $ çš„å¶æ•° $ n $ ï¼Œéƒ½æœ‰ $ n $ ä¸ª $ n $ æ¬¡å•ä½å¤æ ¹çš„å¹³æ–¹çš„é›†åˆï¼Œç­‰äº $ \frac{n}{2} $ ä¸ª $ \frac{n}{2} $ æ¬¡å•ä½å¤æ ¹çš„é›†åˆã€‚</strong></p>
</blockquote>
<p> $ \mathcal{Proof.} $ </p>
<p>æˆ‘ä»¬å¯ä»¥ç”±æ¶ˆå»å¼•ç†å¾—åˆ° <script type="math/tex">(\omega _n^k)^2 = \omega^{2k}_n=\omega_{n/2}^k</script> é‚£ä¹ˆ</p>
<script type="math/tex; mode=display">(\omega_n^{k + \frac{n}{2}})^2 = \omega_n^{2k + n} \Longrightarrow \omega_n^{2k} \cdot \omega_n^n \Longrightarrow \omega_n^{2k} = (\omega_n^k)^2</script><p> $ \mathcal{Q.E.D.} $ </p>
<hr>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œå¦‚æœå¯¹æ‰€æœ‰çš„ $ n $ æ¬¡å•ä½è·Ÿå¹³æ–¹ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¼šå‘ç° $ \frac{n}{2} $ æ¬¡å•ä½æ ¹æ¯ä¸ªéƒ½æ°å¥½å‡ºç°äº†ä¸¤æ¬¡â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ $ n $ ä¸ª $ n $ æ­¤å•ä½å¤æ•°æ ¹çš„é›†åˆï¼ˆæœ´ç´ çš„é›†åˆï¼Œå³ä¸å¯é‡é›†ï¼‰é‡Œï¼Œåªæœ‰ $ \frac{n}{2} $ ä¸ªå…ƒç´ ã€‚æˆ‘ä»¬å‚è€ƒä¸Šé¢é‚£å¼ å›¾ï¼Œå®ƒçš„æ„ä¹‰å°±åœ¨äºæ–¹å‘ç›¸å¯¹çš„ä¸¤åªå‘é‡ï¼Œå…¶å¹³æ–¹ç›¸ç­‰ã€‚</p>
<p>é‚£ä¹ˆæŠŠæ‰€æœ‰ $ n $ å•ä½æ ¹çš„å¹³æ–¹ç”»åˆ°ä¸€ä¸ªæ•°åˆ—ä¸Šå°±æ˜¯è¿™æ ·ã€‚</p>
<p><img src="2.png" alt></p>
<p>è¿™ä¸ªå¼•ç†ç›´æ¥ä¿è¯äº†æˆ‘ä»¬æ±‚å€¼çš„å¤æ‚åº¦ä¸º $ \Theta(n \log n) $ </p>
<p>è€Œæˆ‘ä»¬åœ¨ä»£ç å®ç°ä¸­ï¼Œ<strong>ä¸èƒ½ç›´æ¥å¾—åˆ° $ e $ æˆ–è€…è™šæ•° $ i $ </strong>ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æ±‚å•ä½æ ¹çš„ä»»åŠ¡å°±äº¤ç»™äº†æˆ‘ä»¬ä¸Šæ–‡ä¸­æåˆ°è¿‡çš„<strong>æ¬§æ‹‰å…¬å¼</strong>ã€‚</p>
<ul>
<li><h3 id="frak-Sum-Lemma-quad-æ±‚å’Œå¼•ç†"><a href="#frak-Sum-Lemma-quad-æ±‚å’Œå¼•ç†" class="headerlink" title="$ \frak{Sum~Lemma\quad} $ æ±‚å’Œå¼•ç†"></a>$ \frak{Sum~Lemma\quad} $ æ±‚å’Œå¼•ç†</h3></li>
</ul>
<hr>
<blockquote>
<p><strong>å¼•ç†ï¼šå¯¹äºä»»æ„ $ n&gt;0 $ ä¸” $ k $ ä¸èƒ½æ•´é™¤ $ n $ ï¼Œæˆ‘ä»¬éƒ½æœ‰ <script type="math/tex">\sum\limits_{j =0}^{n-1}{(\omega_n^k)^j} = 0</script> </strong></p>
</blockquote>
<p> $ Proof. $ </p>
<p>ç”±å‡ ä½•çº§æ•°çš„æ±‚å’Œå…¬å¼ï¼ˆç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼) <script type="math/tex">\sum\limits_{j = 0}^{n}{x^j} = \frac{x^{j +1} -1}{x -1}</script> å¯å¾— <script type="math/tex">\sum\limits_{j =0}^{n-1}{(\omega_n^k)^j} = \frac{(\omega_n^k)^n -1}{\omega_n^k -1} \Longrightarrow  \frac{(\omega_n^n)^k -1}{\omega_n^k -1} =  \frac{(1)^k -1}{\omega_n^k -1}</script> ç”±äºä¿è¯äº† $ k $ ä¸å¯æ•´é™¤ $ n $ æ‰€ä»¥åˆ†æ¯ä¸€å®šä¸ä¸º $ 0. $ </p>
<p> $ \mathcal{Q.E.D} $ </p>
<hr>
<h1 id="rm-0x05-quad-DFT-to-FFT"><a href="#rm-0x05-quad-DFT-to-FFT" class="headerlink" title="$ \rm{0x05\quad DFT \to FFT} $"></a>$ \rm{0x05\quad DFT \to FFT} $</h1><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨äº†è§£å®Œå•ä½å¤æ•°æ ¹ä¹‹åï¼Œä¾¿å¯ä»¥æ­£å¼åœ°å¯¹ $ DFT $ ç»™å‡ºå®šä¹‰ä¸æ“ä½œæ–¹æ¡ˆäº†ã€‚</p>
<ul>
<li><h2 id="DFT"><a href="#DFT" class="headerlink" title="$ DFT $"></a>$ DFT $</h2></li>
</ul>
<p>å¯¹äºæˆ‘ä»¬å·²çŸ¥çš„ä¸€ä¸ªå¤šé¡¹å¼ <script type="math/tex">A(x) = \sum\limits_{i =0}^{n - 1}{a_ix^i}</script> åœ¨ $ \omega_n^0,\omega_n^1,\omega_n^2 \cdots \omega_n^{n-1} $ å¤„çš„å–å€¼ï¼Œæˆ‘ä»¬å¯ä»¥å‡å®š $ n $ æ˜¯ $ 2 $ çš„å¹‚ï¼Œå› ä¸ºå³ä½¿å®ƒæœ¬èº«ä¸æ˜¯ $ 2 $ çš„å¹‚ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å‘é«˜æ¬¡å¹‚è¡¥å€¼ä¸º $ 0 $ çš„é¡¹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è€Œè¡¥è¶³ $ 2 $ çš„å¹‚çš„ç›®çš„ï¼Œå°±æ˜¯ä¸ºäº†åœ¨ $ FFT $ åˆ†æ²»çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ä¹‹å¯ä»¥ä¸€ç›´åˆ†æ²»ä¸‹å»ä¸”æ¯æ¬¡åˆ†æ²»å¾—å‡ºçš„ä¸¤åŠå¯ä»¥è¿›è¡Œè¿ç®—ã€‚</p>
<p>é‚£æˆ‘ä»¬ç°åœ¨ä¼šæœ‰ä¸€ä¸ª $ A $ çš„å‘é‡ç»„ $ \vec{a} = {a_1, a_2, a_3 \cdots a_{n-1}} $ ï¼Œå¯¹äº $ k = 0, 1, 2, \cdots n -1 $ ï¼Œå®šä¹‰ $ y_k $ å¦‚ä¸‹ï¼š <script type="math/tex">y_k = A(\omega_n^k)=\sum\limits_{j =0}^{n -1}{a_j \cdot \omega_n^{kj}}</script> ï¼Œé‚£ä¹ˆå‘é‡ <script type="math/tex">\vec{y} = {y_0, y_1, y_2 \cdots y_{n-1}}</script> å°±ç§°ä½œç³»æ•°å‘é‡ $ \vec{a} = {a_1, a_2, a_3 \cdots a_{n-1}} $ çš„<strong>ç¦»æ•£å‹å‚…ç«‹å¶å˜æ¢ï¼ˆ $ \boldsymbol{Discrete   Fourier   Transformation} $ ï¼‰</strong>ã€‚</p>
<p>å—¯ï¼Œè¿™ä¸ª<strong>ç¦»æ•£å‹</strong>æˆ‘ä»¬å¯ä»¥ç”±ç‚¹ä¹˜æ³•è”æƒ³æ„ä¼šä¸€ä¸‹ï¼šæœ¬æ¥ $ A(x) $ æ˜¯ä¸€ä¸ªä¼˜ç¾çš„å¤šé¡¹å¼ï¼Œè½¬å˜æˆå‡½æ•°ä¹‹åæ˜¯ä¸€æ¡ä¼˜ç¾çš„æ›²çº¿ï¼ˆä¼˜ç¾åªæ˜¯å®šè¯­â€¦â€¦ä¸æ˜¯é‡è¦å†…å®¹ $ qwq $ ï¼‰ï¼Œç»“æœä½ çªç„¶æŠŠå®ƒæ‹†æˆäº†ä¸€å †ç¦»æ•£çš„ç‚¹ï¼ŒæŠŠå®ƒç”¨ç‚¹å€¼æ³•è¡¨ç¤ºï¼Œæ•…ç§°ä¹‹æ›°ï¼šâ€œç¦»æ•£å‹â€ ã€‚</p>
<ul>
<li><h2 id="FFT-ä¼˜åŒ–-DFT"><a href="#FFT-ä¼˜åŒ–-DFT" class="headerlink" title="$ FFT $ ä¼˜åŒ– $ DFT $"></a>$ FFT $ ä¼˜åŒ– $ DFT $</h2></li>
</ul>
<p>åœ¨ä¸Šæ–‡ä¸­æˆ‘ä»¬åˆ†æè¿‡ï¼Œå°†ç³»æ•°è¡¨è¾¾å¼è½¬åŒ–ä¸ºç‚¹å€¼è¡¨è¾¾å¼éœ€è¦çš„æ—¶é—´å¤æ‚åº¦ä¸º $ O(n^2) $ ï¼Œè¿™æ˜¯æœ´ç´ ç®—æ³•ã€‚è€Œæˆ‘ä»¬åªéœ€è¦ç”¨ä¸€ç§è¢«ç§°ä½œ<strong>å¿«é€Ÿå‚…ç«‹å¶å˜æ¢ï¼ˆ $ \boldsymbol{Fast   Fourier   Transformation} $ ï¼‰</strong>çš„æ–¹å¼ï¼Œå°±å¯ä»¥å°†å…¶æ—¶é—´å¤æ‚åº¦å‹ç¼©æˆ $ O(nlogn) $ ã€‚è€Œåœ¨è¿™é‡Œæˆ‘ä»¬å°±ç”¨åˆ°äº†åˆšæ‰è¯æ˜çš„å¼•ç†â€”â€”<strong>æŠ˜åŠå¼•ç†</strong>ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘å°†åŸæ¥çš„å¤šé¡¹å¼ <script type="math/tex">A(x) = a_0+a_1x+ a_2x^2 \cdots +a_{n-1}x^{n-1}</script> é‡å®šä¹‰æˆä¸¤ä¸ªæ¬¡æ•°ä¸º $ \frac{n}{2} $ çš„å°å¤šé¡¹å¼ $ A^{[0]}(x) $ å’Œ $ A^{[1]}(x) $ ï¼š </p>
<script type="math/tex; mode=display">A^{[0]}(x) = a_0 + a_2x+a_4x^2 \cdots +a_{n-2}x^{\frac{n}{2} - 1} $$   $$  A^{[1]}(x) = a_1 + a_3x+a_5x^2 \cdots +a_{n-1}x^{\frac{n}{2} - 1} $$     é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œ $ A^{[0]}(x) $ å­˜å‚¨çš„æ˜¯æ‰€æœ‰å¶æ•°ä½ï¼ˆäºŒè¿›åˆ¶ä½æœ€åä¸€ä½æ˜¯ $ 0 $ ï¼‰ï¼Œè€Œ $ A^{[1]}(x) $ å­˜å‚¨çš„æ˜¯æ‰€æœ‰çš„å¥‡æ•°ä½ï¼ˆäºŒè¿›åˆ¶ä½æœ€åä¸€ä½æ˜¯ $ 1 $ ï¼‰ï¼Œé‚£ä¹ˆæœ‰ä¸‹å¼ï¼š $$ A(x) = A^{[0]}(x^2)+xA^{[1]}(x^2) $$ é‚£æˆ‘ä»¬æ±‚ $ A(x) $ åœ¨å•ä½æ ¹ä»¬ $ \omega_n^0,\omega_n^1,\omega_n^2 \cdots ,\omega_n^{n-1} $ å¤„çš„å€¼ï¼Œå°±å˜æˆäº†å…ˆæ±‚å‡º $ A^{[0]}(x^2) $ å’Œ $ A^{[1]}(x^2) $ çš„å€¼ï¼Œç„¶åæ ¹æ®ä¸Šå¼è¿›è¡Œåˆå¹¶å³å¯ã€‚

è€Œæ˜¾ç„¶çš„æ˜¯ï¼Œæ ¹æ®æŠ˜åŠå¼•ç†ï¼Œæˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦ $ O(n) $ æ±‚ï¼Œè€Œæ˜¯é€šè¿‡æ•°æ®è§„æ¨¡ä¸æ–­å‡å°ä½¿ä¹‹æˆä¸º $ O(\log n) $ ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬æˆåŠŸé€šè¿‡ $ FFT $ ä¼˜åŒ–äº†æ±‚å€¼çš„å¤æ‚åº¦ã€‚

é‚£ä¹ˆåŒæ—¶å¯¹äºå¦ä¸€è¾¹ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®

 $$ A(\omega_n^{k+\frac{n}{2}}) = A^{[0]}(\omega_n^{2k+n})+\omega_n^{k+\frac{n}{2}}A^{[1]}(\omega_n^{2k+n}) \Longrightarrow A^{[0]}(\omega_n^{2k}\cdot \omega_n^{n})-\omega_n^{k}A^{[1]}(\omega_n^{2k}\cdot \omega_n^{n})</script><p>å¾—åˆ°</p>
<script type="math/tex; mode=display">A(\omega_n^{k+\frac{n}{2}})=A^{[0]}(\omega_n^{2k})-\omega_n^{k}A^{[1]}(\omega_n^{2k})</script><p>ä»è€Œæœ‰ä¼ªä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> Lim = <span class="number">1</span>, N, M ;</span><br><span class="line"><span class="function">function <span class="title">FFT</span><span class="params">(<span class="keyword">int</span> lenth, <span class="keyword">complex</span> *A, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    IF (Lim == <span class="number">1</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">complex</span> A0[lenth &gt;&gt; <span class="number">1</span>], A1[lenth &gt;&gt; <span class="number">1</span>] ;<span class="comment">//åˆ†æˆä¸¤éƒ¨åˆ†</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j : <span class="number">0</span> to lenth by_grow <span class="number">2</span>) A0[j &gt;&gt; <span class="number">1</span>] = A[j], A1[j &gt;&gt; <span class="number">1</span>] = A[j + <span class="number">1</span>] ;</span><br><span class="line">    FFT(lenth &gt;&gt; <span class="number">1</span>, A0, flag) ;</span><br><span class="line">    FFT(lenth &gt;&gt; <span class="number">1</span>, A1, flag) ;</span><br><span class="line">    <span class="keyword">complex</span> Wn = unit(,) , w = (<span class="number">1</span>, <span class="number">0</span>) ;<span class="comment">//Wnæ˜¯å•ä½æ ¹ï¼Œwç”¨æ¥æšä¸¾å¹‚ï¼Œå³æˆ‘ä»¬ä»¤ä¸»æ¬¡å•ä½æ ¹ä¸å˜ï¼Œç”±äºå…¶ä½™å•ä½æ ¹éƒ½æ˜¯å…¶æ•´æ¬¡å¹‚ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¸€ä¸ªwæ¥è®°å½•åˆ°ç¬¬å‡ æ¬¡å¹‚</span></span><br><span class="line">        <span class="comment">/*æ­¤å¤„æ±‚å•ä½æ ¹çš„æ—¶å€™ä¼šç”¨åˆ°æˆ‘ä»¬çš„å‚æ•°flagâ€¦â€¦å—¯æ²¡é”™å°±ç”¨è¿™ä¸€æ¬¡ï¼Œå¹¶ä¸”flagçš„å€¼åŸŸä¸º(-1, 1)â€¦â€¦æ˜¯çš„ï¼Œåªä¼šæœ‰ä¸¤ä¸ªå€¼*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j : <span class="number">0</span> to (lenth &gt;&gt; <span class="number">1</span>) by_grow <span class="number">1</span> with w = w * Wn)&#123;</span><br><span class="line">        A[i] = A0[i] + A1[i] * w ;<span class="comment">//åº”ç”¨å…¬å¼ï¼Œä¸‹åŒ </span></span><br><span class="line">        A[i + (lenth &gt;&gt; <span class="number">1</span>)] = A0[i] - A1[i] * w ; <span class="comment">//é¡ºä¾¿æ±‚å‡ºå¦ä¸€åŠï¼Œç”±æŠ˜åŠå¼•ç†å¯æ˜¾ç„¶ã€‚ </span></span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line">function Main&#123;</span><br><span class="line">    input(N), input(M) ;</span><br><span class="line">    <span class="keyword">for</span>(i : <span class="number">0</span> to N by_grow <span class="number">1</span>) =&gt; input(A) ;</span><br><span class="line">    <span class="keyword">for</span>(i : <span class="number">0</span> to M by_grow <span class="number">1</span>) =&gt; input(B) ; </span><br><span class="line">    <span class="keyword">while</span>(Lim &lt; N + M) Lim &lt;&lt;= <span class="number">1</span> ;<span class="comment">//Limä¸ºç»“æœå¤šé¡¹å¼çš„é•¿åº¦ï¼ˆæš‚æ—¶ï¼‰ï¼ŒåŒ–ä¸º2çš„å¹‚çš„ä¾¿äºåˆ†æ²»ï¼ˆäºŒåˆ†ï¼‰</span></span><br><span class="line">    FFT(Lim, A, <span class="number">1</span>) ;<span class="comment">//ä¸¤éFFTè¡¨ç¤ºä»ç³»æ•°åŒ–ä¸ºç‚¹å€¼ </span></span><br><span class="line">    FFT(Lim, B, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span>(i : <span class="number">0</span> to Lim by_grow <span class="number">2</span>) =&gt; A[i] *= B[i] ;<span class="comment">//ç‚¹ä¹˜æ³•ï¼Œæ­¤å¤„éœ€è¦é‡å®šä¹‰ä¹˜å·ï¼Œå› ä¸ºæ¯ä¸€é¡¹ç°åœ¨è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªç‚¹ï¼Œæœ‰xå’Œyä¸¤ä¸ªå±æ€§qwq </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šæ˜¯åŸºäº $ pks $ æ ‡å‡†ä¸‹çš„ä¼ªä»£ç <del>ä½ å¯ä»¥è¯•è¯•åœ¨c++æ ‡å‡†ä¸‹è¿è¡Œ</del>ï¼Œå…¶ä¸­ $ for $ å¾ªç¯éƒ¨åˆ†ï¼Œ $ grow $ è¡¨ç¤ºå½“å‰å¾ªç¯å˜é‡çš„<strong>å•æ¬¡å¢é‡</strong>ï¼Œä¹‹åå¸¦æœ‰ $ with $ è¡¨ç¤ºæ¯æ¬¡å¾ªç¯ç»“æŸéƒ½ä¼šè¿›è¡Œçš„è¿ç®—ï¼ˆä¸‹åŒ</p>
<p>å—¯ï¼Œè¿™å°±æ˜¯æ±‚å€¼çš„æ–¹æ³•ï¼Œå¥½åƒå¾ˆ $ nice $ åœ°è¾¾åˆ°äº† $ O(n \log n) $ </p>
<ul>
<li><h2 id="FFT-ä¼˜åŒ–-IDFT"><a href="#FFT-ä¼˜åŒ–-IDFT" class="headerlink" title="$ FFT $ ä¼˜åŒ– $ IDFT $"></a>$ FFT $ ä¼˜åŒ– $ IDFT $</h2></li>
</ul>
<p>ä¸Šæ–‡ä¸­æˆ‘ä»¬æ›¾ç»æåŠè¿‡çš„<strong>èŒƒå¾·è’™å¾·çŸ©é˜µ</strong>å¯ä»¥æ”¾åˆ°è¿™å„¿ç”¨ï¼š</p>
<p> $ \begin{vmatrix}  1         &amp;  1  &amp; 1   &amp; \cdots &amp; 1      \newline 1         &amp;  \omega_n  &amp; \omega_n^2   &amp; \cdots &amp; w_n^{n-1}      \\newline1         &amp;  \omega_n^2  &amp; \omega_n^4   &amp; \cdots &amp; \omega_n^{2(n-1)}      \newline \vdots  &amp; \vdots &amp; \vdots  &amp;  \ddots &amp; \vdots \newline 1    &amp;  \omega_n^{n-1}  &amp; \omega_n^{2(n-1)}   &amp; \cdots &amp; \omega_n^{(n-1)(n-1)}        \newline  \end{vmatrix} $    $ \begin{vmatrix}  a_0  \newline a_1 \newline a_2 \newline \vdots \newline a_{n-1} \end{vmatrix} $  =  $ \begin{vmatrix}  y_0  \newline y_1 \newline y_2 \newline \vdots \newline y_{n-1} \end{vmatrix} $ </p>
<p>é‚£ä¸ºäº†æ±‚å‡ºæˆ‘ä»¬çš„ $ \vec{a} = {a_0, a_1 \cdots ,a_{n-1}} $ æˆ‘ä»¬åº”è¯¥è®©åˆšåˆšæ±‚å€¼ç®—å‡ºçš„ $ \vec{y} $ ä¹˜ä¸Šæˆ‘ä»¬ $ \vec{V}^{~-1} $ ï¼ˆ $ \vec{V} $ çš„é€†çŸ©é˜µï¼‰å³å¯ã€‚ä½†æ˜¯æ¡¥è±†éº»è¢‹~~~ä¸éœ€è¦ç”¨ä»€ä¹ˆé«˜æ¶ˆå•Šâ€¦ä½™å­å¼å•Šâ€¦æˆ‘ä»¬åªéœ€è¦ä»¥ä¸‹ï¼š</p>
<hr>
<blockquote>
<p><strong>æ¨è®º</strong>ï¼šå¯¹äº $ j,k = 0,1, 2 \cdots n-1,V_n^{-1} $ çš„ $ (j, k) $ å¤„çš„å€¼ä¸º $ \omega_n^{-kj}/n $ </p>
</blockquote>
<p> $ Proof. $ </p>
<p>æˆ‘ä»¬è€ƒè™‘åå‘è¯æ˜ï¼Œå·²çŸ¥ $ V_nâ€™ $ æ˜¯ä¸€ä¸ª $ (j,k) $ å¤„å€¼ä¸º $ \omega_n^{-kj}/n $ çš„ã€ä¸ $ V $ å½¢æ€ç›¸åŒçš„çŸ©é˜µï¼Œé‚£æˆ‘ä»¬åªéœ€è¦è¯æ˜ $ Vâ€™ \cdot V = I_n $ å³å¯ï¼Œå…¶ä¸­ $ I_n $ æ˜¯ $ n $ é˜¶å•ä½çŸ©é˜µï¼Œå³ä¸»å¯¹è§’çº¿éƒ½æ˜¯ $ 1 $ ï¼Œå…¶ä½™ä½ç½®ä¸Šæ˜¯ $ 0 $ çš„çŸ©é˜µã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬è€ƒå¯Ÿ $ Vâ€™ V $ ä¸­çš„å…ƒç´  $ (i, j) $ ï¼Œæœ‰å¦‚ä¸‹çš„å¼å­ <script type="math/tex">V'V = \sum\limits^ {n-1}_{k=0}{(\omega_n^{-ki}/n)} \cdot {\omega_n^{kj}} = \frac{1}{n} \sum\limits^ {n-1}_{k=0}{\omega_n^{k(j-i)}}</script> </p>
<p>ç”±<strong>æ±‚å’Œå¼•ç†</strong>å½“ä¸”ä»…å½“ $ i=j $ æ—¶å…¶å€¼ä¸ºä¸€ï¼Œå…¶ä½™çš„æ—¶åˆ»å‡ä¸ºé›¶ï¼Œæ‰€ä»¥æœ‰ $ Vâ€™V = I_n $ </p>
<p> $ \mathcal{Q.E.D} $ </p>
<hr>
<p>é‚£ä¹ˆæˆ‘ä»¬æŠŠæˆ‘ä»¬åˆšåˆšæ±‚å‡ºæ¥çš„é€†çŸ©é˜µ $ V^{-1} $ ç¾åŒ–ä¸€ä¸‹ï¼Œæå‡ºæ¯ä¸€é¡¹æ‰€é™¤çš„ $ n $ ï¼Œå¯ä»¥å¾—åˆ° $ IDFT $ å¯ä»¥å¦‚æ­¤è®¡ç®—ï¼š <script type="math/tex">IDFT_n(y) = \frac{1}{n}\sum\limits_{k = 0}^{n-1}{y_k\omega_n^{-kj}},j\in [0,n-1]</script> è¯¶ï¼Œè¿™ä¸ªå¥½åƒâ€¦â€¦è·Ÿæˆ‘ä»¬æ±‚å€¼æ—¶çš„å…¬å¼å·®ä¸å¤šï¼Ÿæ²¡é”™ï¼Œé™¤äº†å¸¦ä¸ªè´Ÿå·ï¼Œå…¶ä½™çš„éƒ½å·®ä¸å¤šã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æ‰“ä¸ªæ ‡è®°ï¼šå½“ $ flag=1 $ æ—¶ï¼Œä»–æ˜¯æ­£å‘ $ DFT $ ï¼›å½“å®ƒç­‰äº $ -1 $ æ—¶ï¼Œå®ƒæ˜¯é€†å‘çš„ $  IDFT $ ã€‚è¿™å¯ä»¥è®©æˆ‘ä»¬é€šè¿‡è¿™ä¸€ä¸ªå‡½æ•°è§£å†³ä¸¤ä¸ªè¿‡ç¨‹ã€‚æˆ‘ä»¬åªéœ€è¦ç”¨ $ y $ æ›¿æ¢ $ a $ ï¼Œç”¨ $ \omega_n^{-1} $ æ›¿æ¢ $ \omega_n $ ï¼Œå…¶ä½™çš„æ²¡ä»€ä¹ˆå·®åˆ«ï¼Œäºæ˜¯â€¦â€¦æ—¶é—´å¤æ‚åº¦è¿˜æ˜¯ $ O(n \log n) $ çš„!</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(<span class="keyword">int</span> Lim,<span class="keyword">complex</span> *A,<span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Lim == <span class="number">1</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">complex</span> A0[Lim &gt;&gt; <span class="number">1</span>], A1[Lim &gt;&gt; <span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= Lim ; i += <span class="number">2</span>)</span><br><span class="line">        A0[i &gt;&gt; <span class="number">1</span>] = A[i], A1[i &gt;&gt; <span class="number">1</span>] = A[i+<span class="number">1</span>] ;</span><br><span class="line">    FFT(Lim &gt;&gt; <span class="number">1</span>, A0, flag) ;</span><br><span class="line">    FFT(Lim &gt;&gt; <span class="number">1</span>, A1, flag) ;</span><br><span class="line">    <span class="keyword">complex</span> unit = (<span class="keyword">complex</span>)&#123;<span class="built_in">cos</span>(<span class="number">2.0</span> * Pi / Lim) , flag * <span class="built_in">sin</span>(<span class="number">2.0</span> * Pi / Lim)&#125;, w = <span class="keyword">complex</span>(<span class="number">1</span>, <span class="number">0</span>) ;<span class="comment">//æ¬§æ‹‰å…¬å¼ </span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; (Lim &gt;&gt; <span class="number">1</span>) ; i ++, w = w * unit) &#123;</span><br><span class="line">        A[i] = A0[i] + w * A1[i] ;</span><br><span class="line">        A[i + (Lim&gt;&gt;<span class="number">1</span>)] = A0[i] - w*A1[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">......................</span><br><span class="line">FFT(A, <span class="number">1</span>), FFT(B, <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= Lim; i ++) A[i] = A[i] * B[i] ;</span><br><span class="line">FFT(A, <span class="number">-1</span>) ;</span><br><span class="line">......................</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¥½çš„ï¼Œç°åœ¨å˜›â€¦â€¦å¯ä»¥è€ƒè™‘æ’’èŠ±èŠ±å•¦ï¼å› ä¸ºæˆ‘ä»¬çš„ $ FFT $ å®é™…ä¸Šå·²ç»ç»“æŸäº†ï¼ $ But $ ï¼Œè¿™ä¸ªé€’å½’ç‰ˆæœ¬çš„ $ FFT $ ç”±äºç‰µæ‰¯åˆ° $ sin/cos $ çš„è¿ç®—ã€ $ double $ ã€é€’å½’æ—¶çš„å…¥æ ˆå‡ºæ ˆï¼ˆåº•å±‚ï¼‰ï¼Œæ‰€ä»¥å¸¸æ•°ç‰¹åˆ«çš„å¤§ $ emmmmm $ ï¼Œé‚£ä¹ˆâ€”â€”</p>
<h1 id="rm-0x06-Iterative-Optimization"><a href="#rm-0x06-Iterative-Optimization" class="headerlink" title="$ \rm{0x06~Iterative~ Optimization} $"></a>$ \rm{0x06~Iterative~ Optimization} $</h1><p>æˆ‘ä»¬ç°åœ¨è¦å¼•å‡ºçš„å°±æ˜¯è¿­ä»£ç‰ˆçš„ $ FFTqwq $ </p>
<h2 id="Â·-rm-Advanced-Trick-Point-color-red-3-rm-The-Butterfly-Operation"><a href="#Â·-rm-Advanced-Trick-Point-color-red-3-rm-The-Butterfly-Operation" class="headerlink" title="Â·  $ \rm{Advanced~Trick~Point} $   $ \color{red}{3} $   $ \rm{The~Butterfly ~Operation} $"></a>Â·  $ \rm{Advanced~Trick~Point} $   $ \color{red}{3} $   $ \rm{The~Butterfly ~Operation} $</h2><p> $ emmm $ å…ˆä¸Šä¸€ä¸ªä¸æ˜¯ç‰¹åˆ«å¡å¸¸æ•°çš„ä¼˜åŒ–ã€‚æˆ‘ä»¬è§‚å¯Ÿä¹‹å‰çš„ä»£ç ä¸­ï¼Œæœ‰è¿™ä¹ˆä¸€æ­¥ï¼š<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; (Lim &gt;&gt; <span class="number">1</span>) ; i ++, w = w * unit) &#123;</span><br><span class="line">        a[i] = A0[i] + w * A1[i] ;</span><br><span class="line">        a[i + (Lim&gt;&gt;<span class="number">1</span>)] = A0[i] - w*A1[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬ä¼šå‘ç°â€¦â€¦ $ \omega \cdot A^{[1]}[i] $ è¢«æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¦¨ç”¨ä¸ªå˜é‡è®°å½•å®ƒï¼š<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; (Lim &gt;&gt; <span class="number">1</span>) ; i ++, w = w * unit) &#123;</span><br><span class="line">     <span class="keyword">int</span> temp = w * A1[i] ;</span><br><span class="line">     a[i] = A0[i] + t ;</span><br><span class="line">     a[i + (Lim&gt;&gt;<span class="number">1</span>)] = A0[i] - t ;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p><del>å—¯ï¼Œè¿™å°±æ˜¯å…¨éƒ¨çš„ä¼˜åŒ–å•¦ï¼é‚£ä¹ˆï¼ŒFFTï¼Œå®Œï¼</del></p>
<p> $ qwq $ è¿™åˆ†æ˜æ˜¯éª—å°å­©å­çš„å•¦â€¦â€¦å¦‚æœå•å•è¿™ä¸€æ­¥å°±å¯ä»¥å¡å¸¸æ•°çš„è¯ï¼Œé‚£è¿™ä¸ªä¸–ç•Œè¯¥å¤šä¹ˆç¾å¥½ $ \mathcal{QAQ} $ ã€‚å¥½å§ï¼Œè¯´è¿™ä¸ªçš„åŸå› ï¼Œåªæ˜¯ä¸ºäº†å¼•å‡ºæˆ‘ä»¬å…³äº<strong>è´è¶æ“ä½œ</strong>çš„å®šä¹‰ï¼š</p>
<blockquote>
<p>æˆ‘ä»¬å®šä¹‰ $ \omega_n^k $ ä¸º<strong>æ—‹è½¬å› å­</strong>ï¼Œé‚£ä¹ˆæ¯ä¸€æ¬¡æˆ‘ä»¬å…ˆå°† $ y_k^{[1]} $ ä¸æ—‹è½¬å› å­çš„ä¹˜ç§¯å­˜å‚¨åœ¨ä¸€ä¸ªå˜é‡ $ t $ é‡Œï¼Œå¹¶åœ¨ $ y_k^{[0]} $ å¢åŠ ã€å‡å» $ t $ çš„æ“ä½œç§°ä¸ºä¸€æ¬¡è´è¶æ“ä½œã€‚</p>
</blockquote>
<p>è¯´ç™½äº†ï¼Œè´è¶æ“ä½œæ˜¯ä¸€æ¬¡ $ O(2) $ çš„æ±‚å‡º $ A^{[0]}_k $ ä¸ $ A^{[1]}_k $ çš„æ“ä½œã€‚</p>
<hr>
<p>æˆ‘ä»¬é¦–å…ˆè€ƒè™‘æŒ‰ç…§é€’å½’çš„æ€è·¯ï¼Œå°† $ FFT $ çš„åˆ†æ²»æµç¨‹åˆ»ç”»ä¸€ä¸‹ï¼š</p>
<p><img src="3.png" alt></p>
<p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œå…¶å®æˆ‘ä»¬æ˜¯å¯ä»¥å¯¹å®ƒè¿›è¡Œåå‘è¿­ä»£çš„ã€‚ä»¥ä¸Šé¢çš„è¿­ä»£æ ‘ä¸ºä¾‹ï¼Œæˆ‘ä»¬çš„æ­¥éª¤å¤§ä½“å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>$ step   1 $   æˆå¯¹åœ°å–å‡ºå„¿å­èŠ‚ç‚¹ï¼Œç”¨è´è¶æ“ä½œè®¡ç®—å‡ºå…¶ $ DFT $ ã€‚<br>$ step   2 $   ç”¨è¿™ä¸€æ­¥çš„ $ DFT $ æ›¿æ¢ä¹‹å‰çš„ï¼›<br>$ step   3 $   ç›´åˆ°æˆ‘ä»¬è¿­ä»£åˆ°æ ¹èŠ‚ç‚¹ä¸ºæ­¢ï¼Œå¦åˆ™è¿”å› $ step   1 $ </p>
</blockquote>
<p>è€Œåå‘è¿­ä»£ä¼¼ä¹æœ‰è§„å¾‹å¯å¾ªã€‚æˆ‘ä»¬å‘ç°åªè¦æˆ‘ä»¬ç”¨è¿­ä»£çš„è¿‡ç¨‹æ¨¡æ‹Ÿå‡ºå›æº¯çš„è¿‡ç¨‹å³å¯ã€‚é‚£ä¹ˆæ€è·¯ä¾¿æœ‰äº†ï¼šä¸‰å±‚ $ for $ ï¼Œå…ˆæšä¸¾åŒºé—´é•¿åº¦ï¼ˆ1ï¼Œ2ï¼Œ4ï¼Œ8â€¦â€¦ï¼‰ï¼Œç¬¬äºŒå±‚æšä¸¾é•¿åº¦ä¸º $ j*2 $ çš„æ¯ä¸ªåŒºé—´çš„èµ·ç‚¹â€”â€”æ„å›¾ä¸ºåŒæ—¶æšä¸¾ä¸¤ä¸ªç›¸é‚»åŒºé—´ï¼Œä¾¿äºç›¸é‚»åŒºé—´ä¹‹é—´ $ DFT $ çš„åˆå¹¶ï¼Œç¬¬ä¸‰å±‚è´Ÿè´£éå†æ¯æ®µåŒºé—´ï¼Œè¿ç”¨è´è¶æ“ä½œé€ä¸ªåˆå¹¶ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; Lim; j &lt;&lt;= <span class="number">1</span>)&#123;<span class="comment">//æšä¸¾åŒºé—´é•¿åº¦ï¼Œä»å°åŒºé—´åˆ°å¤§åŒºé—´ä¾æ¬¡åˆå¹¶ã€‚</span></span><br><span class="line">        <span class="function">node <span class="title">T</span><span class="params">(<span class="built_in">cos</span>(Pi / j), flag * <span class="built_in">sin</span>(Pi / j))</span> </span>;</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; Lim; k += (j &lt;&lt; <span class="number">1</span>) )&#123;<span class="comment">//ä¸¤æ®µåŒºé—´ä¸¤æ®µåŒºé—´çš„æšä¸¾ï¼Œç”¨äºåˆå¹¶</span></span><br><span class="line">            <span class="function">node <span class="title">t</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span> </span>;</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j; l ++, t = t * T)&#123;<span class="comment">//æšä¸¾kæ‰€æšä¸¾çš„ä¸¤ä¸ªåŒºé—´å†…çš„å€¼ï¼Œå¹¶è¿›è¡Œè´è¶æ“ä½œã€‚</span></span><br><span class="line">                node Nx = J[k + l], Ny = t * J[k + j + l] ;</span><br><span class="line">                J[k + l] = Nx + Ny ; J[k + j + l] = Nx - Ny ;<span class="comment">//ä¸€æ¬¡è´è¶æ“ä½œ</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å—¯ï¼Œå¥½åƒâ€¦â€¦æµ·æ˜Ÿï¼Ÿå“ˆï¼Œæ€ç»´ä¸ä¸¥è°¨çš„æˆ‘ä»¬æ¼äº†ä¸€ä¸ªåœ°æ–¹ï¼šæˆ‘ä»¬åœ¨ $ DFT $ çš„æ—¶å€™ï¼Œä¸ºäº†ä¿è¯æ—¶é—´å¤æ‚åº¦æ˜¯ $ \Theta(\log n) $ ï¼Œæˆ‘ä»¬æ›¾ç»è¿›è¡Œè¿‡ä¸€æ¬¡ $ A(x) = A^{[0]}(x^2)+xA^{[1]}(x^2) $ çš„æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªåŠ¨è°ƒæ•´é¡ºåºã€‚é€šä¿—ä¸€ç‚¹ï¼Œå°±æ˜¯æˆ‘ä»¬åŸæ¥çš„åºåˆ—é¡ºåºæ˜¯ $ 0,1,2,3,4,5,6,7 $ ï¼Œä½†æ˜¯è¿­ä»£ç‰ˆçš„ $ FFT $ å´éœ€è¦çš„é¡ºåºåº”è¯¥è·Ÿå¶å­ç»“ç‚¹çš„é¡ºåºå»åˆï¼Œå³ $ 0, 4, 2, 6, 1, 5,3,7 $ ã€‚æ‰€ä»¥â€”â€”</p>
<ul>
<li><h2 id="Â·-rm-Trick-Point-color-red-4-rm-The-Butterfly-Law"><a href="#Â·-rm-Trick-Point-color-red-4-rm-The-Butterfly-Law" class="headerlink" title="Â·  $ \rm{Trick~Point} $   $ \color{red}{4} $   $ \rm{The~Butterfly ~Law} $"></a>Â·  $ \rm{Trick~Point} $   $ \color{red}{4} $   $ \rm{The~Butterfly ~Law} $</h2></li>
</ul>
<p>è¿™ä¸ªå˜›â€¦â€¦æˆ‘ä»¬å¯ä»¥é€‰æ‹©æ‰“ä¸ªè¡¨è§‚å¯Ÿï¼š<br>åŸæ¥çš„åºå·  $ 0        1        2        3        4        5        6         7 $<br>ç°åœ¨çš„åºå·  $ 0        4        2        6        1        5        3        7 $<br>åŸæ¥çš„äºŒè¿›åˆ¶è¡¨ç¤º  $ 000        001        010        011        100        101        110        111 $<br>ç°åœ¨çš„äºŒè¿›åˆ¶è¡¨ç¤º  $ 000        100        010        110        100        101        011        111 $ </p>
<p>è¯¶ï¼ŒäºŒè¿›åˆ¶å¥½åƒæ˜¯ååºçš„å—·~~è¿™ä¾¿æ˜¯æˆ‘ä»¬çš„æœ€åä¸€ä¸ª $ trick $ ï¼Œè´è¶å®šç†ã€‚è€Œå› ä¸ºæˆ‘ä»¬è§‚å¯Ÿåˆ°çš„è´è¶å®šç†æ˜¯æ»¡è¶³ä¸€ä¸€å¯¹åº”æ€§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ $ FFT $ ä¹‹å‰ $ swap $ ä¸€éå³å¯ã€‚</p>
<p>å—¯ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªååºå­˜åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢ã€‚ç±»ä¼¼è¿™æ ·æ±‚å‡ºæ¥ï¼š<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++ ) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>)) ;</span><br></pre></td></tr></table></figure></p>
<p>å‘ƒï¼Œè¿™ä¸ªäºŒè¿›åˆ¶è®¡ç®—è‡ªå·±æ¨ä¸€ä¸‹å°±å¥½ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™å°±ç®€åŒ–äº†å¾ˆå¤šå†—ä½™çš„æ­¥éª¤ï¼Œå¹¶è®©æˆ‘ä»¬è„±ç¦»é€’å½’çš„å¤§å¸¸æ•°ã€‚<del>çœŸå¼€æ£®å•Š</del></p>
<p>æœ€åé™„è¿­ä»£ç‰ˆçš„ä»£ç (æˆ‘å†™çš„å¸¸æ•°å¥½åƒæœ‰ç‚¹å„¿å¤§ $ QAQ $ )</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">int</span> N, M, K ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3000100</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>) ;</span><br><span class="line"><span class="keyword">int</span> i, j, k, l, Lim = <span class="number">1</span>, L, R[MAXN] ; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y ;</span><br><span class="line">    node (<span class="keyword">double</span> xx = <span class="number">0</span>, <span class="keyword">double</span> yy = <span class="number">0</span>)&#123;</span><br><span class="line">        x = xx, y = yy ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;A[MAXN], B[MAXN] ;</span><br><span class="line">node <span class="keyword">operator</span> * (node J, node Q)&#123;</span><br><span class="line">    <span class="keyword">return</span> node(J.x * Q.x - J.y * Q.y , J.x * Q.y + J.y * Q.x);</span><br><span class="line">&#125;</span><br><span class="line">node <span class="keyword">operator</span> + (node J, node Q)&#123;</span><br><span class="line">    <span class="keyword">return</span> node(J.x + Q.x , J.y + Q.y);</span><br><span class="line">&#125;</span><br><span class="line">node <span class="keyword">operator</span> - (node J, node Q)&#123;</span><br><span class="line">    <span class="keyword">return</span> node(J.x - Q.x , J.y - Q.y );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>, f = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c))&#123;<span class="keyword">if</span>(c == <span class="string">'-'</span>) f = <span class="number">-1</span> ;c = getchar() ;&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span> ,c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k * f ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(node *J, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; R[i]) swap(J[i], J[R[i]]) ;<span class="comment">//å‰é¢çš„ifä¿è¯åªæ¢ä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; Lim; j &lt;&lt;= <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="function">node <span class="title">T</span><span class="params">(<span class="built_in">cos</span>(Pi / j), flag * <span class="built_in">sin</span>(Pi / j))</span> </span>;</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; Lim; k += (j &lt;&lt; <span class="number">1</span>) )&#123;</span><br><span class="line">            <span class="function">node <span class="title">t</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span> </span>;</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j; l ++, t = t * T)&#123;</span><br><span class="line">                node Nx = J[k + l], Ny = t * J[k + j + l] ;</span><br><span class="line">                J[k + l] = Nx + Ny ;</span><br><span class="line">                J[k + j + l] = Nx - Ny ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    N = qr(), M = qr() ; </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= N; i ++) A[i].x = qr() ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= M; i ++) B[i].x = qr() ;</span><br><span class="line">    <span class="keyword">while</span>(Lim &lt;= N + M) Lim &lt;&lt;= <span class="number">1</span>, L ++ ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++ ) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>)) ;</span><br><span class="line">    FFT(A, <span class="number">1</span>), FFT(B, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= Lim; i ++) A[i] = A[i] * B[i] ;</span><br><span class="line">    FFT(A, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= N + M; i ++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, (<span class="keyword">int</span>)(A[i].x / Lim + <span class="number">0.5</span>)) ;<span class="comment">//æˆ‘ä»¬æ¨è¿‡çš„å…¬å¼é‡Œé¢æœ‰ä¸€ä¸ª1/nè¿™ä¸€é¡¹ï¼Œæœ€åè¾“å‡ºçš„æ—¶å€™æ·»ä¸Šå³å¯ </span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å•Šâ€¦â€¦é‚£å°±æ’’èŠ±èŠ±å§ï¼ï¼</p>
<h1 id="rm-0x00-quad-Afterword"><a href="#rm-0x00-quad-Afterword" class="headerlink" title="$ \rm{0x00\quad Afterword} $"></a>$ \rm{0x00\quad Afterword} $</h1><p>ä»¥ä¸‹æ˜¯åŸå°¾è¯­ï¼Œä¿ç•™äº†ä¸‹æ¥ï¼š</p>
<blockquote>
<p>å—¯â€¦â€¦æ€ä¹ˆè¯´å‘¢ï¼Œç°åœ¨çœ‹è¿™ä¸ªç®—æ³•ï¼ŒçœŸæ˜¯ç®€å•çš„ä¸€åŒ¹å•Šâ€¦â€¦ä»£ç è¿™ä¹ˆçŸ­<del>è¿™ä¹ˆå®¹æ˜“èƒŒè¿‡</del>ã€‚ä½†æ˜¯å½“æ—¶ç†è§£èµ·æ¥å´èŠ±äº†å¾ˆå¤§å¿ƒæ€å‘¢ï¼è¿™ç¯‡åšå®¢æˆ‘å†™äº†æ•´æ•´ä¸‰å¤© $ qwq $ ï¼Œç”±äºè¦åŸ¹è®­å’Œè€ƒè¯•ï¼Œæ‰€ä»¥æ‹–æ‹–æ²“æ²“åœ°å†™äº†ä¸‰å¤©ï¼Œä¸€è¾¹å†™ä¸€è¾¹æ„Ÿå¹è‡ªå·±ç†è§£çš„ç®€ç›´å¤ªæµ…æ˜¾äº†ã€‚æ¯ä¸€ä¸ªè¯æ˜ã€æ¯ä¸€ä¸ªå¼•ç†ã€ç”šè‡³æ¯ä¸€ä¸ªç¬¦å·ï¼Œæˆ‘éƒ½éœ€è¦å»å’Œå…¶ä»– $ DALAO $ æ¯”å¯¹å®¡æ ¸ã€æˆ–è€…ç¼ ç€ $ rqy $ é—®ä¸ªæ²¡å®Œï¼›æ¯æ¬¡ä¸€è®²åˆ°åŸç†ï¼Œæˆ‘éƒ½å‘ç°è‡ªå·±åŸæ¥å¹¶ä¸ç†è§£é‚£äº›ï¼Œäºæ˜¯ä¸å¾—ä¸æ¨å€’é‡æ¥ã€‚è¿™ç¯‡åšå®¢ä¼šæŒç»­æ›´æ–°ï¼Œè¡¥å……è¯­æ„ä¸æ˜ã€è¯æ˜éš¾ä»¥ç†è§£çš„åœ°æ–¹ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æ¸©é¦¨æç¤ºï¼š</p>
<ul>
<li>å¥½å¤šè‡ªå·±å½“åˆä¸ç†è§£çš„åœ°æ–¹åœ¨ä»£ç é‡Œå°±åªæœ‰åŠè¡Œqaq</li>
<li>ä¸‰ä¸ªå¼•ç†ä¸­ï¼Œåªæœ‰æ¶ˆå»å¼•ç†è·Ÿç®—æ³•çš„å®ç°æ²¡æœ‰å…³ç³»â€”â€”æ¶ˆå»å¼•ç†ä¸»è¦æ˜¯ç”¨æ¥è¯æ˜å…¶ä»–å¼•ç†çš„</li>
</ul>
</blockquote>
<p>çœŸ Â· ç»“æŸè¯­ï¼š</p>
<p>å…¶å®æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œä»Šå¤©é‡æ–°å¤ä¹ äº†ä¸€éï¼Œå‘ç°è‡ªå·±ä»¥å‰æœ‰å¥½å¤šå†…å®¹è™½ç„¶å¦‚åŸå°¾è¯­æ‰€è¨€ï¼Œçœ‹ä¸Šå»<code>ç°åœ¨çœ‹è¿™ä¸ªç®—æ³•ï¼ŒçœŸæ˜¯ç®€å•çš„ä¸€åŒ¹å•Š</code>ï¼Œä½†å®é™…ä¸Šå¿½ç•¥äº†å¥½å¤šä¸œè¥¿ã€‚æˆ‘æƒ³å¤§æ¦‚åªæœ‰ä¸€éä¸€éåœ°é’»ç ”æ‰èƒ½äº†è§£å®Œå…¨ä¸€ä»¶äº‹æƒ…å§ã€‚</p>
<h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$ \rm{Reference} $"></a>$ \rm{Reference} $</h2><ul>
<li>$ [1] $  : $ rvalue $ çš„ $ blog $  <a href="https://www.cnblogs.com/rvalue/p/7351400.html" target="_blank" rel="noopener"> $ ^{^{[\nearrow ]}} $ </a></li>
<li>$ [2] $  :ç®—æ³•å¯¼è®º <a href="https://pan.baidu.com/s/13PRy8pPn__zGj3UfOTX8Ew" target="_blank" rel="noopener"> $ ^{^{[\nearrow]}} $ </a> æå–ç : txs2 </li>
<li>[3]*ï¼šé¸£è°¢rqy</li>
</ul>
<h2 id="mathfrak-writter-pks"><a href="#mathfrak-writter-pks" class="headerlink" title="$ \mathfrak{writter:pks} $"></a>$ \mathfrak{writter:pks} $</h2>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¤šé¡¹å¼</category>
      </categories>
      <tags>
        <tag>å¤šé¡¹å¼åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>éšæƒ³äº” Â· æ‰‹ä¸­æ²¡æœ‰çº¢ç«ç‘°</title>
    <url>/2019/02/14/%E9%9A%8F%E6%83%B3%E4%BA%94%C2%B7%E6%83%85%E4%BA%BA%E8%8A%82/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>â€œéšæƒ³â€ç³»åˆ—ç´¢å¼•ï¼š<a href="http://www.orchidany.cf/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/" target="_blank" rel="noopener">æˆ³æˆ‘</a></p>
<hr>
<p>ä»Šå¤©ä¸‹äº†ä¸€å¤©çš„é›ªã€‚</p>
<p>æˆ‘æ˜¯éš”ç€çª—æˆ·æœ›çš„ï¼Œç›´åˆ°ç°åœ¨æˆ‘è¿˜æ²¡æœ‰çœŸæ­£è§¦æ‘¸åˆ°ä¹…è¿çš„é›ªèŠ±ã€‚ä¸€å¹´å¤šäº†ï¼Ÿæˆ–è®¸å§ã€‚æˆ‘è½»åº¦è¿‘è§†ï¼Œä½†æ˜¯ç™½å¤©åœ¨çª—è¾¹çš„ä¹¦æ¡Œæ—ä¹ ä½œæ—¶ï¼Œä¸æˆ´çœ¼é•œçš„ï¼Œè¿˜æ˜¯èƒ½çœ‹åˆ°çº·é£çš„ç™½çµ®â€”â€”è™½ç„¶æœ‰äº›æ¨¡ç³Šã€‚å®ƒä»¬ç»å¸¸æƒ³æˆ‘æŒ¥æ‰‹è‡´æ„ï¼Œæˆ‘ä¹Ÿæ»¡è¶³äº†ã€‚</p>
<p>â€œæƒ…äººèŠ‚å‘¢â€¦â€æˆ‘æƒ³ç€ã€‚å½“ç„¶ï¼Œäººç±»åœ¨æ€è€ƒä¸€ä»¶äº‹çš„æ—¶å€™ä¸å¯é¿å…çš„è¦è”æƒ³ï¼Œæˆ‘è”æƒ³åˆ°çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯æˆ‘æ²¡å†™å®Œä¹Ÿå‹æ ¹ä¸æƒ³å†™çš„ä½œä¸šï¼Œæ˜¯å¦‚æœæœ‰äº†æ‹äººä¹‹åè€å¸ˆä»¬çš„ç«­åŠ›åå¯¹ã€åœ¨åŒå­¦ä¸­æ˜¾å¾—é¹¤ç«‹é¸¡ç¾¤ä»¥åŠåœ¨å­¦ä¸šä¸å¤„ç†æ‹çˆ±å…³ç³»çš„æ¼©æ¶¡äº¤å‰ä¸­æŠ½ä¸å¼€èº«â€”â€”å¤§æŠµå°±æ˜¯è¿™äº›å§ã€‚æˆ‘ä¸æ•¢æƒ³äº†ï¼Œå› ä¸ºæˆ‘æƒ³åˆ°ä¸€æ¡©ç¾å¥½çš„äº‹æƒ…ï¼Œä»¿ä½›å°±ä¼šè”æƒ³åˆ°åä»¶ã€ä¸Šç™¾ä»¶ä»¤äººä¸å¯’è€Œæ —çš„äº‹æƒ…â€”â€”è¿™è®©æˆ‘æ„Ÿåˆ°ææƒ§ã€‚</p>
<p>é›ªçœŸç¾å•Šã€‚</p>
<hr>
<p>æ—©æ‹ï¼Ÿ</p>
<p>â€œä¸¥æ‰“ï¼â€ï¼Œ â€œå¥½å­©å­ä¸æ—©æ‹ï¼â€ï¼Œ â€œæ—©æ‹è‚¯å®šæ²¡æˆï¼Œå¥½å¥½å­¦ä¹ å§â€ï¼Œâ€œä»€ä¹ˆå¹´é¾„å°±è¯¥å¹²ä»€ä¹ˆå¹´é¾„è¯¥å¹²çš„äº‹å„¿â€â€¦â€¦</p>
<p>è¯´çœŸçš„ï¼Œæˆ‘å¾ˆéš¾å¯é½¿ï¼Œå“ªæ€•æ˜¯åœ¨è¦å¥½çš„æœ‹å‹é¢å‰â€”â€”å½“æˆ‘è¯´å‡ºæˆ‘å¯¹å“ªä¸ªå¥³å­©å­æœ‰å¥½æ„Ÿçš„æ—¶å€™ï¼Œæˆ‘éƒ½æ˜¯æ€¯æ€¯çš„ã€‚</p>
<p>ç›´åˆ°åˆšåˆšçœ‹åˆ°äº†è¿™æ ·ä¸€ç¯‡æ–‡ç« ï¼Œæ˜¯ä¸€ä¸ªç½‘ç»œä½œå®¶è‹è§ç¥ˆå†™çš„ï¼ŒæŒºæ—©çš„ä¸€ç¯‡æ–‡ç« äº†ï¼š</p>
<blockquote>
<p>å°å­¦äº”å¹´çº§çš„æ—¶å€™ï¼Œæˆ‘å–œæ¬¢ç­ä¸Šçš„ä¸€ä¸ªå¥³å­©å­ã€‚<br>é‚£æ—¶å€™æƒ³çš„å¾ˆå¤šã€‚<br>æ¯”å¦‚æœ‰ä¸€å¤©çœ‹ç”µè§†å‰§ï¼Œç”·ä¸»æ‰‘è¿‡æ¥æ›¿å¥³ä¸»æŒ¡äº†ä¸€æªï¼ŒæŒ‚äº†ã€‚<br>é‚£å¤©æˆ‘è¾—è½¬åä¾§äº†ä¸€å¤œï¼Œè´¨é—®è‡ªå·±å¦‚æœæœ‰äººç”¨æªæŒ‡ç€æˆ‘å–œæ¬¢çš„å°å¥³å­©ï¼Œæˆ‘æ•¢ä¸æ•¢æ‰‘è¿‡å»èµ´æ­»ã€‚<br>è¿™çŠ¹è±«è®©12å²çš„æˆ‘éå¸¸ç¾æ„§ã€‚æˆ‘è§‰å¾—è¿™æ ·è‡ªç§çš„æˆ‘ï¼Œä¸é…å–œæ¬¢å¥¹ã€‚<br>æˆ‘å¼€å§‹è´¨ç–‘è‡ªå·±ï¼Œæˆ‘è‡ªä»¥ä¸ºçš„å–œæ¬¢æ˜¯ä¸æ˜¯çœŸçš„åƒå¤§äººè¯´çš„é‚£æ ·ï¼Œåªæ˜¯ä¸æ‡‚äº‹çš„å°å­©é—¹ç€ç©ã€‚</p>
<p>å¦‚ä»Šæˆ‘çŸ¥é“è¿™è‡ªè´£æ¯«æ— å¿…è¦ã€‚åœ¨æ„Ÿæƒ…é‡Œé—¹ç€ç©ï¼Œè¿™äº‹å„¿åœ¨å¤§äººçš„ä¸–ç•Œé‡Œè¦æµè¡Œçš„å¤šã€‚</p>
<p>æˆ‘æƒ³å¾—å¤šè¿˜ä½“ç°åœ¨äº†åˆ«çš„æ–¹é¢ã€‚æ¯”å¦‚è€å¸ˆè¯´å¥½å¥½å­¦ä¹ ï¼Œå¯æˆ‘ä¸€ç›´ä¸æ˜ç™½ä¸ºä»€ä¹ˆã€‚<br>ä»–ä»¬çš„é‚£äº›ç†ç”±ï¼Œæ¯”å¦‚æ‰¾ä¸ªå¥½å·¥ä½œå•Šï¼Œå‡ºäººå¤´åœ°å•Šï¼Œå¬èµ·æ¥å°±å¾ˆæ— èŠï¼Œä½•å¿…å‘¢ã€‚</p>
<p>äºæ˜¯ä»åˆä¸€å¼€å§‹ï¼ŒåŸæœ¬ä¸‰å¥½å­¦ç”Ÿçš„æˆ‘æˆç»©ä¸€è½åƒä¸ˆï¼Œå‹‰å¼ºåªèƒ½ä¸Šä¸ªæœ«æµé«˜ä¸­ã€‚<br>å®¶é•¿è€å¸ˆå…¨éƒ½æ€¥æ­»äº†ï¼Œæˆ–å¨é€¼åˆ©è¯±ï¼Œæˆ–è‹¦å£å©†å¿ƒï¼Œæˆ‘ä¸€æ¦‚æ²¹ç›ä¸è¿›ã€‚å½“ç„¶ç°åœ¨çš„æˆ‘çŸ¥é“äº†è¯»ä¹¦çš„ç†ç”±ï¼Œå¯æ˜¯å›é€†æœŸçš„å°‘å¹´ä»€ä¹ˆä¹Ÿä¸æƒ³å¬ã€‚</p>
<p>åæ¥åˆä¸‰å¼€å­¦ï¼Œæˆ‘æ”¶åˆ°äº†ä¸€å°ä¿¡ã€‚<br>æ¥è‡ªé‚£ä¸ªå°å­¦æ—¶å€™å–œæ¬¢çš„å¥³å­©å­ã€‚<br>ä¿¡çš„æœ«å°¾æœ‰ä¸€å¥è¯ï¼šæˆ‘å‡†å¤‡æŠ¥è€ƒXä¸­ï¼Œä½ è¦ä¸è¦ä¸€èµ·ï¼Ÿ</p>
<p>æˆ‘çš„æ‰‹ä¸å—æ§åˆ¶åœ°é¢¤æŠ–ã€‚<br>çƒˆç„°åœ¨çµé­‚çš„æ·±å¤„ç‡ƒèµ·ï¼Œç¼äººçš„çƒ­æµªå¸­å·äº†å…¨èº«æ¯ä¸€ä¸ªç»†èƒã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦è¯»ä¹¦å‘¢ï¼Ÿ<br>16å²çš„æˆ‘è·å¾—äº†å”¯ä¸€çš„ç­”æ¡ˆâ€”â€”ä¸ºäº†å’Œå–œæ¬¢çš„äººåœ¨ä¸€èµ·ã€‚<br>æˆ‘å¼€å§‹ç–¯äº†ä¸€æ ·åœ°å¤ä¹ ï¼Œæ¶è¡¥è¿™ä¸¤å¹´è½ä¸‹çš„çŸ¥è¯†ç‚¹ã€‚ä¹¦æ¡Œè¾¹ä¸Šæ”¾äº†ä¸€ç›†æ°´ï¼Œå›°äº†å°±ç”¨æ°´æ³¼è‡ªå·±çš„è„¸ã€‚<br>å¯¹äºæˆ‘ä¸€å¤œä¹‹é—´çš„å‰§å˜ï¼Œå¤§äººä»¬ä¸€ä¸ªä¸ªå–œç¬‘é¢œå¼€ï¼Œè¯´å­©å­ç»ˆäºæ‡‚äº‹äº†ã€‚<br>æ˜¯å•¦ï¼Œä»–ä»¬æ€»ä»¥ä¸ºè‡ªå·±å¾ˆæ‡‚ã€‚</p>
<p>å¾ˆå¤šäººè¯´ï¼Œå°å­©å­ä¸è¦è°ˆæ„Ÿæƒ…ï¼Œå› ä¸ºåæ­£ä¸ä¼šæœ‰ç»“æœã€‚<br>æ˜¯ï¼Œçš„ç¡®ä¸ä¼šæœ‰ç»“æœã€‚<br>å°±åƒå“ªæ€•åæ¥æˆ‘å¦‚æ„¿è€ƒä¸Šäº†Xä¸­ï¼Œè¿™ä¾ç„¶ä¸æ˜¯æŸ¯æ™¯è…¾æ²ˆä½³å®œé‚£æ ·çš„æ•…äº‹ã€‚ä»å§‹è‡³ç»ˆï¼Œæˆ‘éƒ½æ²¡èƒ½åœ¨å¥³å­©çš„äººç”Ÿé‡Œæ‰®æ¼”è¿‡å“ªæ€•ä¸€ä¸ªé…è§’ã€‚</p>
<p>å¯æ˜¯å¦‚ä»Šæˆ‘ç«™åœ¨æ—¶é—´çš„å½¼ç«¯å›æœ›ï¼Œå¦‚æœé‚£ä¸ªåå‡ å²çš„å­©å­æ²¡æœ‰çˆ±ä¸Šè¿‡ä»€ä¹ˆäººï¼Œé‚£ä¹ˆä»–ä¹‹åçš„äººç”Ÿï¼Œå°†æ— æ³•æŒ½å›åœ°æ»‘å…¥æ·±æ¸Šã€‚<br>çˆ±è¿‡ä¸€ä¸ªäººï¼Œæ˜¯æˆ‘å°‘å¹´æ—¶æœ€å¤§çš„å¹¸è¿ã€‚</p>
<p>æ‰€ä»¥ï¼Œå½“æ‰€æœ‰å¤§äººè§†æ—©æ‹ä¸ºæ´ªæ°´çŒ›å…½çš„æ—¶å€™ï¼Œæˆ‘å®Œå…¨ä¸æ•¢è‹ŸåŒã€‚è€Œå½“ä»–ä»¬è¨€ä¹‹å‡¿å‡¿åœ°è¯´â€œè°ˆæ‹çˆ±å½±å“å­¦ä¹ â€çš„æ—¶å€™ï¼Œæˆ‘æ›´åªèƒ½æŠ¥ä»¥ç™½çœ¼ã€‚<br>æ˜¯ï¼Œè°ˆæ‹çˆ±å½±å“å­¦ä¹ ã€‚åªæ˜¯å¾ˆå¤šæ—¶å€™ï¼Œè¿™â€œå½±å“â€å¯ä»¥è¢«ç§°ä¸ºâ€œæ¿€åŠ±â€ã€‚</p>
<p>æœ‰å¯èƒ½å½±å“å­¦ä¹ çš„ä¸œè¥¿å¾ˆå¤šï¼Œç”µè§†å‰§å¯ä»¥ï¼Œå°è¯´å¯ä»¥ï¼Œç³Ÿç³•çš„è€å¸ˆå’Œä¸åˆæ ¼çš„çˆ¶æ¯æ›´åŠ å¯ä»¥ã€‚è€Œåœ¨æ‰€æœ‰çš„å› å­é‡Œï¼Œæ‹çˆ±æœ€æœ‰å¯èƒ½æŠŠå›é€†çš„å°‘å¹´å˜æˆæ›´å¥½çš„äººã€‚<br>ç»“æœæ‰€æœ‰çš„å¤§äººï¼Œååç”¨å°½æ‰€æœ‰åŠ›æ°”ï¼Œæªç€è¿™æŸ„åŒåˆƒå‰‘çº ç¼ ä¸æ¸…ã€‚</p>
<p>æˆ‘ç”šè‡³æ€€ç–‘ï¼Œæ¯”èµ·é‚£äº›é«˜å¤§ä¸Šçš„â€œä¸ºä½ å¥½â€ï¼Œä»–ä»¬åªæ˜¯ææƒ§å¦ä¸€ä¸ªäººæˆä¸ºè‡ªå·±å­©å­çš„ç²¾ç¥å¯„æ‰˜ï¼Œææƒ§å­©å­è„±ç¦»è‡ªå·±çš„æŒæ§â€”â€”å’Œå©†å©†åˆéš¾åª³å¦‡çš„å¿ƒç†ç›¸åŒã€‚</p>
<p>ä»–ä»¬è½»è”‘åœ°è¯´ï¼Œå°å­©å­æ‡‚ä»€ä¹ˆæ‹çˆ±ã€‚<br>å¥½ï¼Œé‚£æˆ‘ä»¬æ¥çœ‹çœ‹å¤§äººä»¬æœ‰å¤šä¹ˆæ‡‚çˆ±æƒ…ã€‚<br>ç›¸äº²çš„ç”·å¥³å°†å„è‡ªçš„ç­¹ç æ‘†ä¸Šå¤©å¹³ï¼Œæˆ¿ï¼Œè½¦ï¼Œè¡Œä¸šï¼Œå®¶åº­ï¼Œæ”¶å…¥ï¼Œåƒä¸€åœºç­‰ä»·äº¤æ¢çš„ç”Ÿæ„ã€‚<br>å¤œåœºé‡Œä¹å£°éœ‡è€³æ¬²è‹ï¼Œç”·äººåœ¨åˆšè®¤è¯†åŠå°æ—¶çš„å¥³äººè€³è¾¹å¤§å–Šï¼Œæ˜å¤©ä¸Šåˆæˆ‘é€ä½ å›å­¦æ ¡å¥½å—ã€‚<br>å¤«å¦»äºŒäººååœ¨æ²™å‘çš„ä¸¤ç«¯ç©ç€å„è‡ªçš„æ‰‹æœºï¼Œä¸€æ™šä¸Šéƒ½æ‡’å¾—æŠ¬å¤´çœ‹å¯¹æ–¹ä¸€çœ¼ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä¸€ç›´æ— æ³•ç†è§£ï¼Œæˆå¹´äººåœ¨å­©å­çš„çˆ±æƒ…é¢å‰ï¼Œé‚£ä»½ä¼˜è¶Šæ„Ÿåˆ°åº•ä»ä½•è€Œæ¥ã€‚ä»–ä»¬è¶¾é«˜æ°”æ‰¬åœ°è¯´ç€â€œå°å­©æ‡‚ä»€ä¹ˆæ‹çˆ±â€ï¼Œå´ä¸æ‹¿é•œå­ç…§ç…§è‡ªå·±çš„ä¸€åœ°é¸¡æ¯›ã€‚<br>éš¾é“ä»¥ä¸Šè¿™äº›ç”»é¢ï¼Œæ¯”ç©¿ç€æ ¡æœçš„å¥³å­©å‡è£…è·¯è¿‡çƒåœºï¼Œåªä¸ºå·çœ‹ä¸€çœ¼å–œæ¬¢çš„ç”·ç”Ÿæ‰“çƒï¼Œæ›´èƒ½ç§°ä¸ºçˆ±æƒ…ï¼Ÿ</p>
<p>è¿˜æœ‰ä¸€ç§æ¯”è¾ƒæ¸©å’Œçš„åå¯¹ï¼Œè¯´èµ·æ¥è¯­é‡å¿ƒé•¿ï¼šâ€œä½ ä»¬è¿˜å¹´è½»ï¼Œåˆ«ç€æ€¥ï¼Œè°ˆæ‹çˆ±ä»¥åæœ‰çš„æ˜¯æœºä¼šã€‚â€<br>ä»”ç»†å›æƒ³ï¼Œè¿™ç§è¿‡æ¥äººç°èº«è¯´æ³•çš„æ–¹å¼ï¼Œå¯¹å­©å­çš„ç¡®å¾ˆæœ‰è¯´æœåŠ›ã€‚å­©å­æ€»æ˜¯ç›¸ä¿¡ç¾å¥½çš„ï¼Œç›¸ä¿¡ä¹…åˆ«é‡é€¢ï¼Œç›¸ä¿¡å§»ç¼˜ä¸€çº¿ï¼Œç›¸ä¿¡åå¹´ä¹‹åæˆ‘ä»¬è‡³å°‘è¿˜æ˜¯æœ‹å‹ã€‚</p>
<p>å¯æ˜¯ï¼Œè¯·å¦‚ä»Šå·²ç»é•¿å¤§çš„å¤§å®¶é—®é—®è‡ªå·±ï¼Œå½“å¹´é­‚ç‰µæ¢¦è¦çš„é‚£ä¸ªäººï¼Œå¦‚ä»Šè¿˜åœ¨å—ï¼Ÿ<br>ä½ ä»¬æ˜¯çœŸçš„æœ‰çš„æ˜¯ä»¥åï¼Œè¿˜æ˜¯æ—©å·²ç¦»æ•£åœ¨äººæµ·ï¼Ÿ<br>è€Œåæ¥é‡åˆ°çš„é‚£äº›äººï¼ŒçœŸèƒ½æ¨¡ç³Šäº†åå…­å²ç•™åœ¨å¿ƒé‡Œçš„çœ‰çœ¼å—ï¼Ÿ</p>
<p>å¾ˆä¹…ä»¥åæˆ‘ä»¬ç»ˆäºçŸ¥é“ï¼Œå¤§äººéƒ½åœ¨è¯´è°ã€‚<br>å°‘å¹´çš„é”™è¿‡æ˜¯ä¸€ç”Ÿçš„æ±‚ä¸å¾—ï¼Œæ˜¯å“ªæ€•åŠŸæˆåå°±å’Œå¯Œå¯æ•Œå›½éƒ½æ— æ³•æŒ½å›çš„é—æ†¾ã€‚æˆ–è®¸æœªæ¥çš„ä½ é£å…‰æ— é™ï¼Œå¯ä½ æ°¸è¿œæ— æ³•é€†è½¬æ—¶é—´ã€‚æ²¡æœ‰ä»€ä¹ˆâ€œæœ‰çš„æ˜¯æœºä¼šâ€ï¼Œé”™è¿‡æ­¤åˆ»ï¼Œå°±æ˜¯é”™è¿‡ä¸€ç”Ÿã€‚</p>
<p>å¦‚æœæœ‰è¿˜åœ¨ä¸Šå­¦çš„è¯»è€…çœ‹åˆ°è¿™é‡Œï¼Œè¯·è®°ä½ï¼Œäººç”Ÿæ²¡æœ‰é‚£ä¹ˆå¤šä»¥åã€‚<br>æœ‰å–œæ¬¢çš„äººå°±å»è¿½ï¼Œä½ ä¸è¿½ä¸Štaï¼Œåˆ†ç¦»å°±ä¼šè¿½ä¸Šä½ ï¼Œæ²¡æœ‰ä¾‹å¤–ã€‚å½“ç„¶å•¦ï¼Œä¸ºäº†ä½ ä»¬çš„æ‰‹èƒ½ç‰µå¾—ä¹…ä¸€äº›ï¼Œæˆç»©ä¸€å®šä¸èƒ½è½ä¸‹ã€‚</p>
<p>è‡³äºé‚£äº›ä¹‰æ­£è¾ä¸¥æ£’æ‰“é¸³é¸¯çš„é•¿è¾ˆâ€¦â€¦ç›¸ä¿¡æˆ‘ï¼Œåå¹´åä»–ä»¬ä¸ä¼šç†ä¼šä½ çš„é—æ†¾å’Œæ€…æƒ˜ï¼Œä»–ä»¬ä¼šå‚¬ä½ éšä¾¿æ‰¾ä¸ªäººç»“å©šï¼Œå¹¶ä¸”ä¸æ¯«ä¸è§‰å¾—åœ¨æ‰“è‡ªå·±çš„è„¸ã€‚</p>
<p>æˆ‘æœ‰ä¸ªæœ‰ç‚¹å„¿ä¸§çš„æœ‹å‹ï¼Œå«å°æ€ªã€‚å…³äºå°‘å¹´çš„çˆ±æ‹ä»–è¯´è¿‡ä¸€æ®µè¯ï¼Œæˆ‘è§‰å¾—æˆ‘ä¸èƒ½è¯´å¾—æ›´å¥½äº†ï¼Œå€ŸèŠ±çŒ®ä½›é€ç»™å¤§å®¶ã€‚</p>
<p>â€ å¾ˆå¤šäººå³ä½¿åªè§è¿‡ä¸€é¢ï¼Œå·²ç»ç®—è§è¿‡äº†æœ€åä¸€é¢ã€‚â€œ</p>
<p>åå…«å²å‰ä¸æ—©æ‹ï¼Œè¿™è¾ˆå­éƒ½æ¥ä¸åŠæ—©æ‹ã€‚<br>ä½ çš„äººç”Ÿçœ‹èµ·æ¥å¾ˆé•¿ï¼Œæ¯ä¸€ç§’éƒ½æ— æ³•æŒ½å›ã€‚</p>
</blockquote>
<p>è™½ç„¶ä¸æ’é™¤æœ‰â€œç«™ç€è¯´è¯ä¸è…°ç–¼â€çš„å«Œç–‘ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™æˆ–è®¸æé†’äº†æˆ‘ä»€ä¹ˆã€‚</p>
<p>æˆ‘ä»Šå¤©åœ¨è¿™é‡Œå¯ä»¥å¼€è¯šå¸ƒå…¬åœ°è·Ÿå„ä½è®²æˆ‘æ‰€è°“çš„â€æ„Ÿæƒ…ç»å†â€œï¼Œâ€å¿ƒè·¯å†ç¨‹â€œã€‚</p>
<p>å½“ç„¶ï¼Œä¹Ÿæ˜¯ç»™æˆ‘è‡ªå·±è®²ã€‚</p>
<p>å…³äºè¿™ä»¶äº‹ï¼Œæˆ‘ä¸€ç›´çº ç»“çš„å¾ˆã€‚å› ä¸ºèº«æ—æˆ–è®¸æœ‰äº†å–œæ¬¢çš„å¥³ç”Ÿï¼Œä½†æ˜¯æˆ–å› ä¸ºå¥¹æœ‰ç”·æœ‹å‹äº†ï¼Œæˆ–å› ä¸ºåˆ«çš„ä»€ä¹ˆåŸå› ï¼Œæˆ‘ä¸èƒ½å¾ˆé¡ºåˆ©åœ°å®ç°ã€‚æ˜¯åšæŒå‘¢ï¼Œè¿˜æ˜¯ä¸åšæŒå‘¢ï¼Ÿæˆ‘ä¸çŸ¥é“ã€‚ä»¥å‰åœ¨åˆä¸­ï¼Œé‡åˆ°ä¸€ä¸ªå¥³å­©å°±ç—´ç—´åœ°è§‰å¾—å¯ä»¥æºæ‰‹ä¸€ç”Ÿï¼Œä½†æœ€åå´æ˜¯è¿ç‰µæ‰‹çš„æœºä¼šéƒ½æ²¡æœ‰ã€‚</p>
<p>ç°åœ¨ä¸ä¸€æ ·äº†å§ï¼Œä¸€ç”Ÿï¼Œå¤šé•¿å•Šã€‚</p>
<p>æˆ‘æ˜¯åœ¨æ‹…å¿ƒè¿™ä¸ªå—ï¼Ÿæˆ‘ä¹Ÿä¸çŸ¥é“ã€‚å¤§æ¦‚æ˜¯ä»æ¥æ²¡æœ‰ä»€ä¹ˆäººæ”¯æŒè¿‡æˆ‘ï¼ŒåŒ…æ‹¬æˆ‘è‡ªå·±ï¼Œä¹Ÿä»æ¥æ²¡æœ‰æ”¯æŒè¿‡æˆ‘è‡ªå·±ã€‚</p>
<p>æ²¡æèµ·è¿™ä»¶äº‹ï¼Œé‡è§å¥¹ï¼Œæ€»ä¼šæ„Ÿè§‰å†…å¿ƒæ— æ¯”çº ç»“ï¼Œä¼šå› ä¸ºå¥¹ä¸€é¢¦ä¸€ç°‡å¿ƒé‡Œç¿»è…¾å¥½ä¹…ï¼Œä¹Ÿä¼šå› ä¸ºå…¶ä»–çš„åŸå› æ„Ÿåˆ°ç•¥ç•¥å‹æŠ‘ã€‚å¥½åƒæˆ‘å·²ç»æŠŠå¥¹å½“æˆäº†ä»€ä¹ˆæ´ªæ°´çŒ›å…½ã€‚å› è€Œæˆ‘ä¹Ÿå¸¸å¸¸çº ç»“ä¸å·²ã€‚</p>
<p>ç­‰ä¼šå„¿ï¼Œéš¾é“æ¯å¤©çº ç»“çš„è¦æ­»å°±æ˜¯æˆ‘æƒ³è¦çš„å—ï¼Ÿç†æ€§åˆ†æä¸€ä¸‹ï¼Œæˆ‘æƒ³è¦å¥¹æˆä¸ºæˆ‘çš„æ‹äººæ˜¯æˆ‘å–œæ¬¢å¥¹çš„å¿…ç„¶ç»“æœï¼Œä½†æ˜¯è¿™ä¸¤ç§çŠ¶æ€æˆ‘çœŸçš„å¯ä»¥æƒè¡¡çš„å¾ˆå¥½å—ï¼Ÿæ¢å¥è¯è¯´ï¼Œæˆ‘å…³äºå¥¹çš„çš„å–œæ€’å“€ä¹è¿˜æ˜¯å› ä¸ºæˆ‘å–œæ¬¢å¥¹å—ï¼Ÿ</p>
<p>ä¸ï¼Œæˆ‘è§‰å¾—ä¸æ˜¯ã€‚</p>
<p>æˆ‘æ˜¯åœ¨äºµæ¸ä¸€ç§æ„Ÿæƒ…ï¼Œæ˜¯åœ¨ä¾®è¾±ä¸€ä¸ªäººã€‚</p>
<p>çˆ±ä»æ¥éƒ½æ˜¯æ— ç§åœ°ä»˜å‡ºï¼Œè€Œä¸æ˜¯æ‹¼å‘½çš„å æœ‰å•Šã€‚</p>
<p>æˆ‘ä»¿ä½›æŠŠå¥¹å½“åšäº†ä¸€ç§å•†å“ï¼Œä¸€ç§ååˆ†æƒ³å¾—åˆ°æ‰‹çš„å•†å“ã€‚æˆ‘ç°åœ¨ä¼šå±•ç°ç»™è‡ªå·±ã€ä¹Ÿå±•ç°ç»™å…¶ä»–äººä¸€å‰¯ååˆ†æ¸´æ±‚ã€ååˆ†çœŸè¯šçš„é¢å­”ï¼Œæˆ–è®¸ä¹Ÿä¸è¿‡æ˜¯å¸Œæœ›å¾—åˆ°å¥¹çš„ä¸€ç§æ‰‹æ®µã€‚å½“æˆ‘ä»¬çœŸæ­£å±äºå½¼æ­¤åï¼Œæˆ‘ä¸èƒ½ä¿è¯åœ¨é‚£å±‚çš®æ’•å¼€ä¹‹åï¼Œæˆ‘è¿˜ä¼šä¸€å¦‚æ—¢å¾€åœ°çæƒœè¿™ä»½æƒ…æ„«ï¼Œä½ ä¹Ÿä¸èƒ½ä¿è¯ï¼ŒåŒæ ·ï¼Œå¥¹ä¹Ÿä¸èƒ½ä¿è¯ã€‚</p>
<p>ä½ çœ‹ï¼Œå°±è¿™ä¹ˆç‚¹å„¿äº‹æƒ…æˆ‘çº ç»“äº†è¿™ä¹ˆé•¿çš„ç¯‡å¹…ã€‚ä»€ä¹ˆçº ç»“å•Šï¼Œå æœ‰å•Šï¼ŒçœŸçˆ±å•Šï¼Œä¸€ç”Ÿå•Šï¼Œ</p>
<p>éƒ½ä¸è¿‡æ˜¯æ‹¼å‘½åœ°æƒ³è¢«çˆ±è€Œå·²ã€‚</p>
<hr>
<p>ä¸çŸ¥é“ç°åœ¨çœ‹åˆ°è¿™å„¿çš„ä½ æ˜¯å¦å’Œæˆ‘ä¸€æ ·å­¤ç‹¬ï¼Ÿå­¤ç‹¬å¹¶ä¸æ˜¯æ¯ä¸ªäººéƒ½æœ‰çš„æƒ…æ„Ÿï¼Œæœ‰äº›äººï¼Œå¾ˆå¤šäººä»æ¥éƒ½ä¸ä¼šæ„Ÿåˆ°å­¤ç‹¬â€”â€”æˆ‘å¤šç¾¡æ…•ä»–ä»¬å•Šâ€¦â€¦</p>
<p>å­¤ç‹¬ï¼Œæˆ–è®¸ä¹Ÿæ˜¯å¦ä¸€ç§ç¨‹åº¦ä¸Šçš„çº¯ç²¹ã€‚æˆ‘è‡³ä»Šä»è§‰å¾—æˆ‘æœ‰ç€æœ€çº¯ç²¹çš„æ„Ÿæƒ…ï¼Œæ˜¯å°‘å¹´ä¸€æ ·çš„æ„Ÿæƒ…ï¼Œä¸æ˜¯å‘å‚æš®è€äººä¸€æ ·çš„ã€åªå¯ç‹¬è‡ªæ€€å¿µçš„æƒ…æ„Ÿã€‚è¿™ç§æ„Ÿæƒ…æ˜¯çƒ­åˆ‡çš„ã€ç”ŸåŠ¨çš„ã€‚</p>
<p>æˆ‘å¾ˆå–œæ¬¢ä¸€é¦–åˆå”±æ›²ç›®ï¼Œå«åšâ€æˆ‘å–œæ¬¢â€œã€‚æ­Œè¯ååˆ†åŠ¨äººï¼Œæ—‹å¾‹ä¼˜ç¾åŠ¨å¬ï¼Œæ¾å¼›æ°åˆ°å¥½å¤„ã€‚</p>
<p>ä¸‹é¢æ˜¯æ­Œè¯ï¼š</p>
<blockquote>
<p>æˆ‘å–œæ¬¢æš–å†¬çš„å¤ªé˜³<br>æˆ‘å–œæ¬¢åˆæ˜¥çš„é’è‰<br>æˆ‘å–œæ¬¢åˆåçš„åº­é™¢å’Œä¸€æ—å‘å‘†çš„ç§‹åƒ<br>æˆ‘å–œæ¬¢ä»²å¤çš„å†°æ²™<br>æˆ‘å–œæ¬¢æ¸…ç§‹çš„æ˜æœˆ<br>è‰¯å®µçš„å¤œç©º æ¼«å¤©æ˜Ÿè¾°<br>æˆ‘å–œæ¬¢é›¨åçš„é’è›™<br>æˆ‘å–œæ¬¢å±±å‰çš„æ<br>æˆ‘å–œæ¬¢å‘¨ä¸‰çš„å‚æ™šè¢«éœå…‰äº²å»çš„æ°´æ—é¦†<br>æˆ‘å–œæ¬¢æˆç¾¤çš„é‡<br>æˆ‘å–œæ¬¢å‡Œä¹±çš„ä¹¦æ¶<br>æ¸…é£çš„éœ²å°è¿œå¤„çš„ç¯æµ·<br>æˆ‘å–œæ¬¢ èµ°åœ¨æ— äººçš„ä¹åå…­å·å…¬è·¯<br>æˆ‘å–œæ¬¢ æœ¨æ‘æ‹“å“‰é•¿é•¿çš„å¤´å‘<br>æˆ‘å–œæ¬¢ æ— å°½ç”°é‡ä¸Šå¥”è·‘çš„éº‹é¹¿<br>æˆ‘å–œæ¬¢ å¤–å©†é—¨å‰çš„æ¦•æ ‘<br>æˆ‘å–œæ¬¢æ¯äº²çš„ä¾¿å½“<br>å–œæ¬¢çˆ¶äº²çš„èƒ¡æ¸£<br>æˆ‘å–œæ¬¢å…«æœˆçš„å¤œæ™šè¿˜åœ¨è¥ä¸šçš„æ¸¸ä¹åœº<br>æˆ‘å–œæ¬¢æ”¾å­¦çš„é“ƒé“›<br>æˆ‘å–œæ¬¢åœç”µçš„å¤œæ™š<br>ç‚¹ä¸€å¯¹èœ¡çƒ› åœ¨å¹½é™çš„ç„å…³<br>æˆ‘å–œæ¬¢ åŸå¸‚å°½å¤´é‚£è¿œè¿œçš„é’å±±<br>æˆ‘å–œæ¬¢ çƒ­æ°”çƒé£ä¸Šè¥¿è¾¹çš„å¤©ç©º<br>æˆ‘å–œæ¬¢ æ¸…æ™¨çš„çŸ³æ¿è·¯<br>é›¾è…¾è…¾çš„æ—©é¤åº— é˜¿å…¬çš„æ¡‚èŠ±ç³•<br>æˆ‘å–œæ¬¢ æ¯ä¸€æœµæš®äº‘ æ¯ä¸€æ ªç»¿æ ‘<br>æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“<br>æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“</p>
</blockquote>
<p>ä¼˜ç¾çš„æ—‹å¾‹ï¼Œé…ä¸Šæœ€åä¸¤å¥ç”œç”œçš„å‘Šç™½ã€‚æˆ–è®¸æˆ‘ä»¬å¼€æ¥ï¼Œä¼¼ä¹æœ‰ç‚¹æ‰­æâ€”â€”æ‰¯è¿™ä¹ˆå¤šåªä¸ºäº†è¡¨è¾¾æœ€åä¸¤å¥â€”â€”</p>
<blockquote>
<p>æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“.</p>
<p>æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“ã€‚</p>
</blockquote>
<p>å¾ˆå¹³å¸¸ï¼Ÿç¡®å®å¾ˆå¹³å¸¸ã€‚ä½†æ˜¯æˆ‘è®¤ä¸ºè¿™ä¸¤å¥æ°åˆ°å¥½å¤„ã€‚å‰é¢å¤§æ®µå¤§æ®µçš„é“ºå«ï¼Œå™è¿°äº†è®¸è®¸å¤šå¤šç¾å¥½ã€æ¬é™çš„äº‹ç‰©ï¼Œä½†æ˜¯è¿™ä¸€åˆ‡æˆ–è®¸éƒ½æ¯”ä¸è¿‡ä½ ã€‚</p>
<p>ä½ å¯ä»¥æƒ³è±¡ï¼Œåœ¨ä¸€ç‰‡åŠ¨äººçš„å¤•é˜³ä¸‹ï¼Œå¤©ç©ºä¸­æ˜¯å¤§ç‰‡å¤§ç‰‡çš„å¥¶èŒ¶çº¢ï¼Œä¸€ä¸ªæ†¨æ†¨çš„å¤§ç”·å­©ï¼Œçªç„¶å«ä½ä½ ï¼Œçº¢ç€è„¸è·‘åˆ°ä½ é¢å‰ï¼Œæ‹¿ç€çš±çš±å·´å·´çš„ç¨¿å­ï¼Œé¢¤é¢¤åœ°æœ—è¯µç€è¿™äº›â€”â€”ä»–å®åœ¨å¤ªåŠ¨æƒ…äº†ï¼Œå¿µç€å¿µç€çªç„¶å£°è°ƒæ”¾é«˜ï¼Œå£°éŸ³å˜å¤§â€”â€”ä»–æ˜¯æ‰“å¿ƒçœ¼é‡Œå–œæ¬¢ä½ ï¼Œè¶Šè¯»è¶Šæœ‰æ„Ÿæƒ…ï¼Œè¶Šè¯»ä»–è¶Šè‡ªä¿¡â€”â€”ä½†æ˜¯çªç„¶ä»–åˆç•ç¼©èµ·æ¥ï¼Œå£°éŸ³ä½ä½åœ°å‘ä½ è¯´å‡ºäº†æœ€åä¸€å¥æœ€åŠ¨äººçš„è¯ï¼šâ€æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“â€œã€‚</p>
<p>æœ‰å¯èƒ½ä½ æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„æ„Ÿè§‰ï¼Œä½†åœ¨æˆ‘å¿ƒé‡Œï¼Œè¿™å°±æ˜¯æœ€çº¯ç²¹çš„ä¸œè¥¿â€”â€”æ˜¯ä¸å¥¢æ±‚çš„æœ´å®çš„çˆ±ï¼Œæ˜¯ä¸è€ƒè™‘ç‰©è´¨åªæ‹¿ææ„Ÿæƒ…çš„çˆ±ï¼Œæ˜¯æ— è¯­å‡å™ä½†å¿ƒä¸­é‡å¤åƒåƒä¸‡ä¸‡æ¬¡çš„çˆ±ï¼Œæ˜¯çœŸæŒšçš„çˆ±â€”â€”è¿™æ˜¯å±äºæˆ‘ä»¬è¿™ä¸ªå¹´çºªæœ€ç¾å¥½çš„ä¸œè¥¿ï¼Œè™½ç„¶æœ‰å­¦ä¸šç¹å¿™ç­‰è¯¸å¤šå› ç´ é˜»æŒ ï¼Œæ— æ³•å®Œæ•´åœ°å¾—åˆ°â€”â€”ä½†æˆ–è®¸åªæ˜¯ä¸€ç‰‡ã€ä¸¤ç‰‡è¿™æ ·çš„æœ‰ç€äº®æš–è‰²è°ƒçš„æ«å¶ï¼Œå°±å¯ä»¥ç‚¹äº®ä¸€æ•´ç‰‡æ¯è´¥çš„æ«æ—ã€‚</p>
<p>æˆ‘å¤§æ¦‚åœ¨å¬è¿™é¦–æ­Œä¹‹å‰ï¼Œä»æ¥æ²¡æœ‰çœŸæ­£çŸ¥é“åŸæ¥â€å–œæ¬¢â€œè¿™ä¸ªå·²ç»çƒ‚å¤§è¡—çš„è¯ã€è¿™ä¸ªç°å¦‚ä»Šå¯ä»¥éšä¾¿è¯´å‡ºå£åˆå¯ä»¥éšä¾¿å¿˜è®°çš„è¯ã€è¿™ä¸ªåœ¨æˆ‘ä¸Šè¿‡çš„æ‰€æœ‰å­¦æ ¡é‡Œä»æ¥æ²¡æœ‰äººæ•¢å…‰æ˜æ­£å¤§è¯´å‡ºæ¥çš„è¯ã€è¿™ä¸ªç°åœ¨åœ¨èŠ¸èŠ¸ä¼—ç”Ÿä¸­å·²ç»è¢«ç·æ±¡çš„ã€è¢«äººä»¬è®¤ä¸ºè¿˜æ²¡æœ‰ä¸€å—é’±æ¥çš„å®åœ¨çš„è¯ï¼Œç«Ÿç„¶å¦‚æ­¤çš„å¯çˆ±ï¼Œç«Ÿç„¶å¦‚æ­¤çš„å€¼å¾—äººä»¬å°Šæ•¬ï¼Œç«Ÿç„¶å¯ä»¥åœ¨å†°å†·çš„å¯’å¤œæ•£å‘å‡ºå¦‚æ­¤è€€çœ¼çš„å…‰èŠ’ã€‚</p>
<p>æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“ã€‚</p>

        <div id="aplayer-aigMwgIY" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">
            <pre class="aplayer-lrc-content"></pre>
        </div>
        <script>
          var ap = new APlayer({
            element: document.getElementById("aplayer-aigMwgIY"),
            narrow: false,
            autoplay: false,
            showlrc: false,
            music: {
              title: "æˆ‘å–œæ¬¢",
              author: "å½©è™¹åˆå”±å›¢",
              url: "æˆ‘å–œæ¬¢.flac",
              pic: "/2019/02/14/éšæƒ³äº”Â·æƒ…äººèŠ‚/wxh.jpg",
              lrc: ""
            }
          });
          window.aplayers || (window.aplayers = []);
          window.aplayers.push(ap);
        </script>
<hr>
<p>å¿ƒåœ¨æµæµªçš„äººå•Šï¼Œåœ¨è¿™åç¯éè¡—çš„æƒ…äººèŠ‚ï¼Œä½ æ˜¯å¦ä¹Ÿè·Ÿæˆ‘ä¸€æ ·ï¼Œè·Ÿè‡ªå·±çš„çµé­‚å½¢å½±ç›¸åŠå‘¢ï¼Ÿ</p>
<p>å¦‚æœä½ å·²ç»æœ‰äº†å¿ƒä¸Šäººï¼Œæˆ‘ç¥ç¦ä½ ï¼›å¦‚æœä½ å·²ç»æœ‰äº†æ‰“ç®—æºæ‰‹ä¸€ç”Ÿçš„äººï¼Œæˆ‘ä¹Ÿç¥ç¦ä½ ã€‚å”¯æœ‰é‚£äº›éƒ½å¸‚é‡Œæœ€è§’è½çš„å­¤ç‹¬è€…ï¼Œæˆ‘ä»¬çš„é‚‚é€…æˆ–è®¸æ˜¯ä¸€ç§ç¼˜åˆ†å§ï¼Œæˆ–è®¸æˆ‘ä»¬ç´ æœªè°‹é¢ï¼Œæˆ–è®¸æˆ‘ä»¬å¹¶ä¸ç†Ÿè¯†ï¼Œä½†åœ¨è¿™æµå…‰æ å½±çš„æ¼†é»‘å¤œç©ºä¸‹ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½è·¨è¿‡ä¸€åˆ‡ï¼Œè·¨è¿‡æ—¶é—´â€”â€”çœ‹è¿™ç¯‡æ–‡ç« æ—¶çš„ä½ ï¼Œä¼¸å‡ºä½ çš„å³æ‰‹ï¼Œæˆ–è®¸å°±å¯ä»¥è·Ÿåœ¨è¿™ä¸€æ™šä¼æ¡ˆæ²‰æ€å†™ä¸‹è¿™ç¯‡æ–‡ç« çš„æˆ‘ï¼Œè½»è½»å‡»æŒï¼Œæ„Ÿå—å¯¹æ–¹çš„ä½“æ¸©ä¸çµé­‚ã€‚</p>
<p>æˆ‘ä¼¸å‡ºæ‰‹äº†å•Šï¼Œä½ å‘¢ï¼Ÿå—¯â€¦æŠ±æ­‰å•¦ï¼Œæˆ‘æ‰‹ä¸­ä»Šå¤©æ²¡æœ‰çº¢ç«ç‘°å¯ä»¥é€ä½ ã€‚è¿™ç¿©é£çš„é›ªèŠ±ï¼Œå°±å½“åšæ˜¯æˆ‘é€ä½ æœ€å¥½çš„ç¤¼ç‰©å§ã€‚</p>
<p>ç›¸ä¿¡æˆ‘ï¼Œè¿™ä¸ªä¸–ç•Œä¸Šç»å¯¹æœ‰äººå·å·åœ°çˆ±ç€ä½ ï¼Œå³ä½¿ä½ è§‰å¾—è‡ªå·±å¾ˆä¸å ªã€‚æ¯”å¦‚ä½ ç­é‡Œçš„æŸä¸ªäººï¼Œæ¯”å¦‚ä½ å¯¹é—¨ï¼Œæ¯”å¦‚ä½ åŒäº‹ï¼Œæ¯”å¦‚ä½ çš„åæ¡Œï¼Œæ¯”å¦‚ï¼Œæˆ‘ã€‚</p>
<p>$19/2/14$ </p>
<hr>
<p>æœ¬æ¥æ‰“ç®—è¿™ç¯‡æ°´æ–‡å°±è¿™ä¹ˆç»“æŸï¼Œç•™ä¸‹ä¸€ä¸ªæ¸©é¦¨é¸¡æ±¤ç»“å°¾ï¼ŒæŒºå¥½çš„ã€‚ä½†çªç„¶æƒ³äº†æƒ³ï¼Œè‡ªå¤ä»¥æ¥èƒ½ç»™äººç•™ä¸‹å°è±¡çš„ä»æ¥ä¸æ˜¯å–œå‰§ç»“å°¾ï¼ŒçŸ­æš‚çš„æ¬¢æ„‰ä¼šè®©äººå¿˜è®°ã€‚</p>
<p>é‚£ä¹ˆå°±è¡¥ä¸€ä¸ªæ·±æ²‰ä¸€ç‚¹çš„ç»“å°¾å§ã€‚</p>
<p>æˆ‘ä¸€ç›´ä¸çŸ¥é“æˆ‘ç°åœ¨æœ‰å¥½æ„Ÿçš„é‚£ä¸ªäººï¼Œç©¶ç«Ÿæ˜¯è‡ªå·±æ„è¯†æµå¼ºåŠ çš„ï¼Œè¿˜æ˜¯çœŸçš„å‘è‡ªå†…å¿ƒçš„å–œæ¬¢ã€‚æˆ‘çº ç»“ã€‚æˆ‘æ— æ³•çŸ¥é“å°†æ¥æ˜¯å¦ä¼šé‡åˆ°ä¸€è§é’Ÿæƒ…çš„äººâ€”â€”æˆ‘å¸Œæœ›è¿™æ ·ï¼Œè€Œä¸æ˜¯ä¸ºäº†æ•è·çˆ±æƒ…è€Œå»æ•è·å¾—æ¥çš„æ„Ÿæƒ…ã€‚æˆ‘æƒ¶æã€‚</p>
<p>ä½†å…¶å®æ²¡å‡†æ‰€è°“ä¸€è§é’Ÿæƒ…+ä¿®æˆæ­£æœä¸€ç›´æ˜¯æ–‡å­¦ä½œå“é‡Œé¢ç”¨æ¥æŠ“è¯»è€…çœ¼çƒçš„å·¥å…·è€Œå·²ï¼Œå¤§å®¶æˆ–è®¸éƒ½ä¸å¯èƒ½æ‰¾åˆ°è‡ªå·±çš„â€œæœ€çˆ±â€ï¼Œåªèƒ½æ‰¾åˆ°ä¸€ä¸ªâ€œå·®ä¸å¤šâ€ï¼Œè¿›è€Œä¸æ–­åœ°ç£¨åˆï¼Œç›´è‡³ç£¨æˆâ€œæœ€çˆ±â€ã€‚ä½†è¿™æ ·çš„æƒ…èŠ‚ï¼Œè¯´ä»€ä¹ˆéƒ½ä¸ä¼šè®©äººæ»¡æ„å§â€¦â€¦</p>
<p>è·¯åœ¨å“ªå‘¢ï¼Ÿå½¼å²¸åˆåœ¨å“ªå‘¢ï¼Ÿæˆ‘å·²ç»å—å¤Ÿä¸€ä¸ªäººå½¢å½±ç›¸åŠçš„å­¤ç‹¬ç”Ÿæ´»äº†ï¼Œä½†åœ¨è¿™æµ©å¦‚çƒŸæµ·çš„æ±‚å­¦ä¹‹æ—…ä¸­ï¼Œä¼¼ä¹æ¥å—å­¤ç‹¬ã€ä½“å‘³å­¤ç‹¬ã€å¹¶æœ€ç»ˆçƒ­çˆ±å­¤ç‹¬æ‰æ˜¯æœ€å¥½çš„æ³•å­å§ã€‚</p>
<p>å¯æ˜¯é¢å¯¹ç€æ— å¥ˆçš„æ˜å¤©çš„æˆ‘ï¼Œä»€ä¹ˆéƒ½ä¸èƒ½åšã€‚</p>
<hr>
<p>é›ªï¼Œç»ˆäºåœäº†å•Šã€‚ç°åœ¨å·²ç»åˆå¤œäº†ï¼Œè¡—ä¸Šä¸€ä¸ªäººéƒ½æ²¡æœ‰ï¼Œå¤©ç©ºåœ¨ç§¯é›ªçš„æ˜ ç…§ä¸‹ï¼Œæ˜¯è®©äººç€è¿·çš„ç´«çº¢è‰²ã€‚</p>

        <div id="aplayer-DOLMLpca" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">
            <pre class="aplayer-lrc-content"></pre>
        </div>
        <script>
          var ap = new APlayer({
            element: document.getElementById("aplayer-DOLMLpca"),
            narrow: false,
            autoplay: false,
            showlrc: false,
            music: {
              title: "é‡è§",
              author: "å­™ç‡•å§¿",
              url: "é‡è§.flac",
              pic: "/2019/02/14/éšæƒ³äº”Â·æƒ…äººèŠ‚/yj.jpg",
              lrc: ""
            }
          });
          window.aplayers || (window.aplayers = []);
          window.aplayers.push(ap);
        </script>]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>éšæƒ³/ä¸‹ä¸‹ç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>éšæƒ³ä¸‰ Â· NOIP2018æ¸¸è®°</title>
    <url>/2019/02/14/%E9%9A%8F%E6%83%B3%E4%B8%89%C2%B7NOIP/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æˆ‘ä¸æƒ³é€€å½¹ã€‚</p>
<a id="more"></a>
<p>â€œéšæƒ³â€ç³»åˆ—ç´¢å¼•ï¼š<a href="http://www.orchidany.cf/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/" target="_blank" rel="noopener">æˆ³æˆ‘</a></p>
<hr>
<p>ä»–çœ‹ç€çœ¼å‰çš„å±å¹•ï¼Œé™é™åœ°å‘å‘†ã€‚</p>
<p>ä»–ä¸çŸ¥é“è¿æ¥ä»–çš„å°†ä¼šæ˜¯ä»€ä¹ˆï¼Œåå¤©çš„$\rm{NOIp}$ç»ˆç©¶æ˜¯ä¸ªè°œã€‚</p>
<p>åˆšåˆšç»™æœºæˆ¿é‡Œå…¶ä»–äººè®²å®ŒæœŸæœ›çš„ä»–ï¼Œæ‰“å¿ƒåº•è§‰å¾—è‡ªå·±æ²¡æœ‰è®²å¥½ï¼Œä½†æ•ˆæœä¼¼ä¹è¿˜å¯ä»¥ã€‚</p>
<p>â€œå¸Œæœ›åˆ«è€ƒæœŸæœ›å§ï¼Œå˜¿å˜¿â€¦â€¦â€ä»–å¿ƒé‡Œè¿™ä¹ˆæƒ³ç€ã€‚</p>
<p>æ™šä¸Šï¼Œä»–ä¸€ç›´åœ¨è¡¥ä»–å‡ºçš„é¢˜çš„é”…ã€‚é¸½äº†è¿™ä¹ˆä¹…ï¼Œä¹Ÿè¯¥å†™ä¸€å†™é¢˜è§£äº†å•Šã€‚</p>
<p>ä»–ä¸çŸ¥é“æ˜¯å¦è¯¥å‘èº«æ—çš„åŒåƒšä»¬ä¸€æ ·ç»§ç»­æ‰“æ¿å­â€”â€”ä¸Šåˆæ‰“çš„æ¿å­è®©ä»–å¾ˆæ»¡æ„ï¼Œè™½ç„¶éƒ½æ˜¯å¾ˆç®€å•çš„ä¸œè¥¿ï¼Œä½†æ˜¯ä»–å´è§‰å¾—è‡ªå·±å†™çš„å¾ˆç²¾å½©ï¼Œéƒ½æ˜¯ä¸€é$AC$ã€‚å¤§æ¦‚è¿™æ ·ï¼Œä»–è§‰å¾—ä¼¼ä¹æ²¡ä»€ä¹ˆé—®é¢˜ã€‚</p>
<p>ä»ä¸‹åˆå°±å¼€å§‹æœ‰ç©ºè°ƒæš–é£äº†ï¼Œè¿™å€’æ˜¯è®©ä»–ååˆ†æ¬£å–œã€‚å‰å‡ å¤©ï¼Œæˆ–è€…è¯´æ˜¨å¤©ï¼Œåœ¨æœºæˆ¿ç©¿ç€åšåšçš„ç¾½ç»’æœï¼Œæ‰‹é¢¤æŠ–ç€ï¼Œè„‘è¢‹ååˆ†æ˜æ²‰åœ°æ‰“ä»£ç ï¼Œä»–ä¸æ„¿æ„å†å›æƒ³èµ·è¿™äº›ã€‚</p>
<hr>
<p>æ—©ä¸Šååˆ†ç€æ€¥åœ°ä¹°äº†æ—©é¥­ï¼Œä¹‹å‰åƒå­¦æ ¡é‡Œçš„ç¾Šæ±¤éƒ½åƒçš„æ˜¯ç¾Šæ‚æ±¤ï¼Œä»Šå¤©å†³å®šå°è¯•ä¸€ä¸‹è´µä¸‰å—é’±çš„ç¾Šè‚‰æ±¤çš„ä»–æ„Ÿåˆ°å¾ˆå¤±æœ›â€”â€”ç¾Šè‚‰åˆè‚¥åˆè…»åˆè†»è…¥ã€‚ä»–ä¸€ç‚¹æ²¡åƒï¼Œä¹°äº†ä¸€å—è„†é¦™ç±³å°±èµ°å‡ºäº†é£Ÿå ‚ã€‚å»å¥¥èµ›å®¤æ”¶æ‹¾äº†ä¸€ä¸‹ä¸œè¥¿ï¼Œæœ¬æ¥è¿˜æƒ³ç¦»çº¿ä¸‹æ¥å‡ é›†æœ€è¿‘åœ¨è¿½çš„ç•ªå‰§ï¼Œæ‰å‘ç°åŸæ¥$\rm{Bilibili}$æ²¡æœ‰$\rm Mac$ç‰ˆï¼Œè¿ç¡•é¼ ä¹Ÿä¸èƒ½ç”¨äº†ï¼Œä¾¿åªå¾—ä½œç½¢ã€‚</p>
<p>ç»ˆäºè¦èµ°äº†ã€‚è¸ä¸Šå»æ˜Œé‚‘ä¸€ä¸­çš„è½¦çš„å‰ä¸€åˆ»ï¼Œä»–å›å¤´çœ‹äº†ä¸€çœ¼å­¦æ ¡ã€‚ä»–è®°å¾—é‚£ä¸ªå¼€æœ—çš„ã€ä½†æ˜¯å®é™…ä¸Šå¹¶ä¸æ˜¯å¾ˆç†Ÿçš„å¥³å­©åœ¨å¬è¯¾ä¹‹å‰ä¸ºä»–åŠ©å¨çš„åœºæ™¯ï¼›ä»–è®°å¾—ä»–è‡ªå·±è®¡åˆ’çš„æ˜¯ï¼Œ$NOIP$å¥½å¥½è€ƒï¼Œå‚åŠ å®Œå†¬ä»¤è¥ï¼Œç­¾ä¸€ä¸ªæ¸…åŒ—çº¦ï¼Œå¸¦ç€è¿˜ç®—ä¸é”™çš„æˆç»©è¿æ¥å¯’å‡ï¼Œç„¶ååœ¨å¯’å‡é‡Œå»æ‰¾ä»–çš„å¥³ç¥â€”â€”é«˜ä¸­æ–°è®¤è¯†çš„ã€ä¸€ä¸ªçˆ±ç¬‘çš„ã€åŠªåŠ›çš„ã€å¯çˆ±çš„å¥³ç”Ÿï¼Œæ’©å¥¹å‡ºå»ç©å„¿ï¼Œæœ€å¥½æ˜¯èƒ½åœ¨ä¸€èµ·å§â€”â€”ä½†æ˜¯å­¦æ ¡è§„åˆ™æ˜¯ä¸ä¼šå…è®¸çš„å§ã€‚ä¸è¿‡ä»–è®¤ä¸ºï¼Œåªè¦å½¼æ­¤éƒ½åœ¨å­¦æ ¡é‡Œæ•°ä¸€æ•°äºŒï¼Œåªè¦å½¼æ­¤éƒ½èƒ½æ¯”è¾ƒè½»æ¾åœ°ä¸Šæ¸…åŒ—ï¼Œå­¦æ ¡æˆ–è®¸ä¼šçä¸€åªçœ¼é—­ä¸€åªçœ¼ã€‚ä»–ä¼¼ä¹å¯¹å°†æ¥ä»–ä»¬ä¸€èµ·åŠªåŠ›çš„åœºæ™¯å……æ»¡äº†ä¿¡å¿ƒã€‚</p>
<p>â€œå¤§æ¦‚åªéœ€è¦400åˆ†ï¼Œæˆ–è€…ä»¥ä¸Šï¼Ÿæ€»ä¹‹ä¸æ˜¯ç‰¹åˆ«éš¾å§ã€‚â€ä»–è¿™ä¹ˆæƒ³ç€ï¼Œçœ¼é‡Œå‘å‡ºæ™¶è“è‰²çš„å…‰ï¼Œæˆ–è®¸æ˜¯åå°„çš„å¤ªé˜³å…‰å§ã€‚</p>
<p>çœ‹äº†çœ‹å¤©ç©ºï¼Œä»–ä¸Šäº†å¤§å·´è½¦ã€‚</p>
<hr>
<p>â€æ˜Œé‚‘ä¸€ä¸­çœŸå¤§å•Šâ€œè¿™æ˜¯ä»–åˆ°è¿™å„¿åçš„ç¬¬ä¸€æƒ³æ³•ã€‚</p>
<p>åˆ°è¾¾æ˜Œé‚‘ä¸€ä¸­å·²ç»æ˜¯ä¸­åˆã€‚é¥­èœæ¯”è¾ƒå¯å£ï¼Œåœ¨ä»–å¿ƒé‡Œå¤§æ¦‚æ¯”æ—¥ç…§ä¸€ä¸­çš„é¥­èœ$better$å‡ å€ã€‚ä¸‹åˆåŸæœ¬æƒ³å‡ºå»æ‰¾åŒåƒšä»¬è¹­ä¸€ä¸‹ç½‘ï¼ŒæŠŠæ¿å­æ‰“å®Œï¼Œä½†è°çŸ¥é“ä¸€ç¡å°±ç¡åˆ°äº†å››ç‚¹ã€‚åŒ†åŒ†å¿™å¿™åœ°çœ‹å®Œè€ƒåœºä½ç½®ï¼Œåœ¨è·¯ä¸Šé‡åˆ°äº†åŒåƒšå’Œå‰åŒåƒšã€‚çä¾ƒäº†å‡ å¥ä¹‹åå‘ç°åˆ°é¥­ç‚¹å„¿äº†ï¼Œäºæ˜¯å°±åªèƒ½é€‰æ‹©å»åƒæ™šé¥­äº†ã€‚æ™šé¥­ç»™ä»–çš„æ„Ÿè§‰ä¼¼ä¹æ²¡æœ‰åˆé¥­é‚£ä¹ˆæƒŠè‰³ï¼Œâ€œæˆ–è®¸æ˜¯å¤ªç´¯äº†å§â€ï¼Œä»–è¿™ä¹ˆæƒ³ã€‚åƒé¥­çš„æ—¶å€™å’Œ$rqy$çä¾ƒï¼Œæ„Ÿè§‰æµ·æ˜Ÿã€‚</p>
<p>å®¿ç®¡è¯´$6$ç‚¹ä»¥åæ¥ç”µï¼Œç»“æœå’•å’•å’•ã€‚æˆ‘ä»¬äºæ˜¯å°±ç”¨ç©ºè°ƒæ’å¤´æ¥ä¸Šæ’æ’å‡‘æ´»äº†ä¸€æ™šä¸Šã€‚</p>
<p>ä»–åäºŒç‚¹å·¦å³æ‰ç¡ä¸‹â€”â€”è™½ç„¶ä»–çŸ¥é“è¿™ä¹ˆæ™šç¡ä¸è¡Œï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•ï¼Œæ¿å­æ²¡æ‰“å®Œçš„è¯ï¼Œå¿ƒä¸­åƒæ˜¯æœ‰ä»€ä¹ˆè´Ÿæ‹…ä¸€æ ·â€”â€”å½“åˆä»–æ‰§ç€äºè¡¥ä¸€æ™šä¸Šè‡ªå·±çš„é”…è€Œä¸æ˜¯å»æ‰“æ¿å­å¤§æ¦‚ä¹Ÿæ˜¯è¿™ä¸ªç¼˜ç”±ã€‚ä»–æƒ³æ”¾å¿ƒåœ°è¿›å…¥è€ƒåœºï¼Œè¿™æ˜¯ä»–è€ƒè¯•çš„ä¹ æƒ¯ã€‚</p>
<hr>
<h2 id="rm-Day-1"><a href="#rm-Day-1" class="headerlink" title="$\rm{Day~1}$"></a>$\rm{Day~1}$</h2><p>çªç„¶ä¸è®©åç”µæ¢¯ï¼Œå…­æ¥¼è®©ä»–æ°”å–˜ååã€‚â€œè¯¥å‡è‚¥äº†â€¦â€¦ä¸è¿‡ç°åœ¨æˆ–è®¸ä¸æ˜¯æƒ³è¿™ä¸ªçš„æ—¶å€™â€ã€‚</p>
<p>è€ƒåœºåœ¨å…­æ¥¼ï¼Œæ˜¨æ™šè¯•æœºçš„æ—¶å€™ï¼Œä»–å†™äº†ä¸€ä¸ª$dijkstra$ï¼Œå†™äº†ä¸ª$ST$è¡¨åˆå†™äº†ä¸ªæš´åŠ›$n^2 ~\rm{RMQ}$ ï¼Œå¹¶å†™äº†ä¸ªå¯¹æ‹ã€‚éƒ½æ˜¯ä¸€æ¬¡æˆåŠŸã€‚è®©ä»–æ„Ÿè§‰å¾ˆå¥½ã€‚</p>
<p>å…¥åœºäº†ï¼Œä»–å¸¦äº†ä¸¤å—æ©¡çš®ç³–ï¼Œä¸¤å°å—è„†é¦™ç±³ï¼Œéƒ½æ˜¯æ—©å…ˆä»å­¦æ ¡ä¹°å¥½çš„ã€‚</p>
<p>$T1$ä»–è§‰å¾—ä¼¼æ›¾ç›¸è¯†ï¼Œå¤§æ¦‚æ˜¯ä»€ä¹ˆç§¯æœ¨å¤§èµ›è¿˜æ˜¯ç§¯æœ¨å¤§ä¼šå•¥çš„ï¼Œä»–è®°ä¸æ¸…äº†ã€‚è€ƒåœºçš„æ—¶å€™ä»–ä¸€èµ°ç¥å°±ä¼šä¸è‡ªè§‰åœ°å»æƒ³æœ€åä¸€ä¸ªå­—åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œä½†å°±æ˜¯æƒ³ä¸èµ·æ¥ã€‚æœ€åä»–å†™äº†ä¸€ä¸ªå¤æ‚åº¦$n\log^2n$çš„çº¿æ®µæ ‘å’Œä¸€ä¸ª$n\log n$çš„$ST$è¡¨ï¼Œåˆå†™äº†ä¸ªå¯¹æ‹å•¥çš„è®©ä»–ä¿©æ‹ï¼Œæ­¤æ—¶å·²ç»$9:15$äº†ã€‚</p>
<p>$T2$ä»–ä»ç¬¬ä¸€çœ¼å¼€å§‹å°±å·²ç»è¾“äº†ã€‚ä»–è§‰å¾—åº”è¯¥æ˜¯ä»€ä¹ˆæ•°å­¦é¢˜æˆ–è€…ç»“è®ºé¢˜ï¼ŒèŠ±äº†$10min$å†™äº†ä¸ªæš´åŠ›ï¼Œè¿‡ä¸äº†å¤§æ ·ä¾‹çš„æœ€åä¸€ä¸ªç‚¹ï¼Œåˆæƒ³äº†$10min$ä»–æ‰å‘ç°åŸæ¥ä¸æ­¢å¯ä»¥ç”±ä¸¤ä¸ªæ¨å‡ºæ–°çš„ï¼Œå¯èƒ½æ˜¯ä¸‰ä¸ªæˆ–è€…æ›´å¤šã€‚$DP$è¿™ä¸ªæƒ³æ³•åœ¨ä»–è„‘å­é‡Œä¸€é—ªè€Œè¿‡ï¼Œä»–æ²¡æœ‰é€‰æ‹©æ•æ‰ã€‚æœ€ç»ˆä»–å±…ç„¶åªå†™äº†ä¸€ä¸ªæš´åŠ›+éª—åˆ†ã€‚</p>
<p>$T3$å¤§æ¦‚åªä¼šæ±‚ç›´å¾„â€”â€”ä½†æ˜¯ä»–åªè®°å¾—æ˜¯ä»€ä¹ˆä¸¤é$dfs$æˆ–è€…$bfs$ï¼Œå› ä¸ºä»–ä»æ²¡åšè¿‡æ±‚ç›´å¾„çš„é¢˜ã€‚è€ƒè¯•ä¹‹å‰$qbxt$çš„æ—¶å€™ï¼Œä»–ç”šè‡³è®©åˆ«äººç»™ä»–æ¨èå‡ é“ç›´å¾„çš„é¢˜ï¼Œä½†ç»ˆç©¶æ˜¯æ²¡æ¥å¾—åŠåšã€‚ä»–å¾ˆåæ‚”ã€‚æœ€ç»ˆå†™äº†ä¸€ä¸ªæš´åŠ›éª—åˆ†ã€‚</p>
<p>æœŸæœ›å¾—åˆ†$100pts + random(0,100)+random(10,20) $</p>
<p>$Luogu$æ•°æ®$100pts + 65pts + 15pts = 180pts$</p>
<p>å¬è¯´ä»Šå¤©ä¸‰é“é¢˜éƒ½æ˜¯åŸé¢˜ï¼Œä»–å¾ˆæ„¤æ‡‘ï¼Œå¸Œæœ›æ²¡å‡†å¯ä»¥è®©$CCF$é‡è€ƒä¸€ä¸‹ä¹‹ç±»çš„ã€‚ä½†æ˜¯è¿™æ ¹æœ¬æ˜¯æ— ç¨½ä¹‹è°ˆã€‚</p>
<p>ä¸‹åˆä»–å’ŒåŒåƒšå»é€›äº†é€›æ˜Œé‚‘ä¸€ä¸­ï¼Œå¹¶ä¸”ä¹°äº†ä¸‰æœ¬ä¸œé‡åœ­å¾çš„ä¹¦ï¼Œåº—ä¸»å¯¹ä»–ä¸é”™ï¼Œç»™ä»–æ‰“äº†ä¸ƒæŠ˜ã€‚</p>
<p>è€ƒæŒ‚äº†ï¼Œä»–æƒ³åˆ°ã€‚</p>
<p>è¿™ä¸–ç•Œä¸Šä¼¼ä¹å°±ä»–ä¸€ä¸ªä¸ä¼š$\rm T2$çš„äººã€‚</p>
<p>ä»–å¯¹å¥½å¤šäººçš„è¨€è¡Œæ„Ÿåˆ°åŒçƒ¦ï¼šæœ‰äººè¯´â€œå®Œäº†ï¼Œå¤§ä¼—åˆ†160â€ï¼Œæ¥ç€ä¾¿æœ‰äººå›é©³ä»–â€œæ˜æ˜å¤§ä¼—åˆ†220â€ï¼Œä½†æ¥ç€åˆæœ‰äººå¤§å£°åœ°è¯´â€œå¤§ä¼—åˆ†æ˜æ˜255å¥½å§â€ã€‚</p>
<p>è™½ç„¶å¤§å®¶å¹³å¸¸éƒ½äº’%ï¼Œä½†æ˜¯æ€»æ„Ÿè§‰é‚£äº›å¼±å°çš„äººæ˜¯å¤šä¹ˆçš„æ— åŠ©å•Šâ€”â€”ä»–ä»¬åªä¼šæ„Ÿåˆ°è™šä¼ªã€æ— åŠ©ã€ç»æœ›ã€‚åƒæˆ‘ä¸€æ ·ã€‚</p>
<p>æˆ–è®¸ä»–æœŸæœ›ç€æ˜å¤©èƒ½ç¿»ç›˜ï¼Ÿ</p>
<p>æ™šä¸Šä»–å½»åº•é¢“åºŸäº†ï¼Œè¦æ±‚ç†„ç¯åï¼Œä»–ç”¨åŒå­¦çš„çƒ­ç‚¹çœ‹äº†ã€Šé’æ˜¥æœŸçŒªå¤´å°‘å¹´XXXXã€‹çš„æœ€æ–°ä¸‰é›†ï¼Œæ„Ÿåˆ°æµ·æ˜Ÿã€‚ä¾æ—§ç¡å¾—ä¸æ—©ã€‚$11ï¼š30$å·¦å³å§ã€‚</p>
<hr>
<h2 id="rm-Day-2"><a href="#rm-Day-2" class="headerlink" title="$\rm{Day~2}$"></a>$\rm{Day~2}$</h2><p>ä»Šå¤©ä»–æ²¡æœ‰å¸¦ä»€ä¹ˆåƒçš„ã€‚</p>
<p>$T1$åªä¼š$60$åˆ†ï¼Œè½¬çœ¼å»çœ‹$T2$</p>
<p>å†™äº†å¥½é•¿æ—¶é—´çš„æš´åŠ›å¹¶ä¸”è°ƒäº†å¥½ä¹…ï¼Œåœ¨è€ƒè¯•ç»“æŸå‰$30min$ä»–å†™å¥½äº†çˆ†æœï¼Œæ‰¾å‡ºäº†è§„å¾‹ï¼Œ$65pts$å·¦å³ã€‚</p>
<p>$T3$è¿æƒ³çš„æ—¶é—´éƒ½æ²¡æœ‰ã€‚</p>
<p>é€€å½¹äº†ã€‚</p>
<hr>
<p>ä»–å¾ˆä¼¤å¿ƒã€‚</p>
<p>å›å®¶ä¹‹åä»–å’Œå…¶ä»–çœå¸‚çš„$Oier$äº¤æµä¹‹åå‘ç°å¤§æ¦‚éƒ½æŒ‚äº†ã€‚æ— å¥ˆçš„ä¸–ç•Œã€‚</p>
<p>ä»–æœ¬æ¥ä¸æƒ³æœŸä¸­è€ƒè¯•ï¼Œä½†æ˜¯å´åˆæƒ³ä¸å‡ºä»€ä¹ˆç†ç”±æ¥ä¸å»è€ƒè¯•ã€‚æ¯•ç«Ÿåˆšè€ƒå®Œ$NOIp$çš„å…¶ä»–äººéƒ½ç…§å¸¸æœŸä¸­è€ƒè¯•ã€‚</p>
<p>ä»–è§‰å¾—è‡ªå·±è¯­æ–‡å‘æŒ¥çš„ä¸€èˆ¬ï¼Œç‰©ç†å‘æŒ¥çš„æ­£å¸¸ï¼Œé™¤äº†ç‰©ç†çš„æŸä¸ªå‚»ç‹—å¡«ç©ºé¢˜è®©ä¿ç•™ä¸€ä½å°æ•°è‡ªå·±çœ¼çäº†è€Œå·²ã€‚</p>
<p>å…¶ä½™çš„éƒ½è€ƒç‚¸äº†ã€‚</p>
<p>åˆå›æ–‡åŒ–è¯¾ï¼Œç­é‡Œçš„äººå¹¶ä¸é™Œç”Ÿã€‚è¯­æ–‡è€å¸ˆä¼¼ä¹å¯¹ä»–çš„è¿™ä¸ªè¯­æ–‡è¯¾ä»£è¡¨çš„å›å½’æ„Ÿåˆ°å¾ˆé«˜å…´ã€‚</p>
<p>ä»–ä¸€å¼€å§‹ä¹Ÿå¹¶ä¸æ€æ ·ï¼Œæ²¡å•¥æ„Ÿè§‰ã€‚</p>
<p>ç›´åˆ°é‚£å¤©ä¸‹åˆã€‚</p>
<hr>
<p>ä»–å…´é«˜é‡‡çƒˆåœ°å»å¥¥èµ›å®¤çœ‹æ°‘é—´æµ‹è¯•æ•°æ®çš„æˆç»©ã€‚ä¸­åˆé«˜äºŒçš„æŸä¸ªå­¦é•¿å‘Šè¯‰ä»–çš„ï¼Œä»–è€ƒäº†å…¨æ ¡ç¬¬å››ï¼Œæ¥è¿‘$400$åˆ†ã€‚è™½ç„¶å¯ä¿¡åº¦ä¸é«˜ï¼Œæ¯•ç«Ÿè‡ªå·±ä»€ä¹ˆé€¼æ•°ä»–è‡ªå·±å¿ƒé‡Œæ¸…æ¥šã€‚ä¸è¿‡è¿˜æ˜¯æœŸå¾…äº†ä¸€ä¸‹åˆã€‚</p>
<p>å…´å¥‹çš„ä»–å»å¥¥èµ›å®¤çœ‹æˆç»©ã€‚</p>
<p>å­¦é•¿çœ‹é”™äº†ã€‚</p>
<p>ä»–çš„ä¸¤ä¸ªåŒåƒšéƒ½æ˜¯$370/380+$çš„æ ·å­ã€‚</p>
<p>åªæœ‰ä»–ä¸åˆ°.</p>
<p>å…¶ä»–äººçš„åˆ†æ•°ä¹Ÿæ¯”ä»–é«˜ã€‚</p>
<p>ä»–å¤§æ¦‚å…¨æ ¡ç¬¬åå‡ å§ã€‚</p>
<p>ä»–æ„Ÿåˆ°äº†ç»æœ›ã€‚</p>
<p>æœ¬æ¥ä»¥ä¸ºçš„ä¸‰äººè¡Œï¼ˆä¸‰ä¸ªäººä¸€èµ·å‚åŠ è¿‡ä¸¤å±Šçœé˜Ÿé›†è®­ï¼‰ï¼Œå…¶å®æ˜¯ä¸åŒ…æ‹¬ä»–çš„ä¸¤äººè¡Œã€‚</p>
<p>ä»–æ³¨å®šæ˜¯å¤±è´¥è€…ã€‚</p>
<p>ä»–ä¼¤å¿ƒæäº†ã€‚</p>
<hr>
<p>ä»–å¼€å§‹æ„ˆå‘æ¶ˆæ²‰ï¼Œæ™šè‡ªä¹ çœ‹äº†ä¸€æ™šä¸Šçš„æ–‡å­¦ç´ æèŸèƒé‚£ç§ä¸œè¥¿ï¼Œéƒ½æ˜¯äº›é¸¡æ±¤ä¹‹ç±»çš„è ¢æ–‡ç« ã€‚ä½†ä»–ä»€ä¹ˆéƒ½ä¸æƒ³å¹²ã€‚ä»–æƒ³åœ¨å­¦æ ¡è¯»é‚£å‡ æœ¬ä»æ˜Œé‚‘ä¹°å›æ¥çš„ä¹¦ï¼Œä½†æ˜¯æ€•è¢«æŠ“åªå¥½ä½œç½¢ã€‚</p>
<p>ä»–è§‰å¾—ä¸€å¹´æ¥ï¼Œä»–ä¸€äº‹æ— æˆã€‚</p>
<p>æˆ–è®¸è¿›å®éªŒéƒ¨åªæ˜¯ä¸ªé”™è¯¯ã€‚ä½†ä»–æ˜¯ä¸ä¼šé€€å‡ºçš„ã€‚å³ä½¿æ˜¯ä¸ºäº†é¢å­ä¹Ÿä¸ä¼šã€‚</p>
<p>ä»–åŸæœ¬è®¡åˆ’å¥½çš„ä¸€åˆ‡éƒ½æ²¡æœ‰æˆåŠŸã€‚ç°åœ¨æœ€åä¸€æ¬¡æœºä¼šï¼Œä»–ä¾æ—§å¤±è´¥äº†ã€‚äººç”Ÿè¾“å®¶ï¼Œå¤§æŠµå°±æ˜¯è¿™æ ·ã€‚ä»–ä¸æ„¿æ„å»é¢å¯¹ä»–çš„å¥¥èµ›åŒåƒšä»¬ã€‚ä»–å¤§æ¦‚å°±åƒæ˜¯$EDG$â€”â€”å›½å†…èµ›å¦‚åŒæˆ˜ç¥ä¸€èˆ¬ï¼Œä¸€åˆ°å›½é™…æ¯”èµ›å°±æ­»ã€‚</p>
<p>ä»–çš„å¥³ç¥è¶Šå¼€å¿ƒï¼Œä»–è¶Šå¯’å¿ƒã€‚å€’ä¸æ˜¯å› ä¸ºåˆ«çš„ï¼Œåªæ˜¯ä»–çš„å¥³ç¥è¶Šå¯çˆ±ï¼Œä»–è¶Šè§‰å¾—æ›¾ç»åšç™½æ—¥æ¢¦çš„è‡ªå·±æ˜¯ä¸ªä¸æ›¾è®¤æ¸…ç°å®çš„å‚»$B$ï¼Œä»–è¶Šå‘æ„Ÿåˆ°è½å·®çš„ä¸å¯é€¾è¶Šã€‚ä»–ç»æœ›äº†ã€‚</p>
<p>æœŸä¸­è€ƒè¯•æˆç»©å‘ä¸‹æ¥äº†ï¼Œä»–ä»åœè¯¾ä¹‹å‰çš„ç­é‡Œç¬¬äº”ï¼Œå¹´çº§ç¬¬äºŒåæ»‘åˆ°äº†ç­é‡Œç¬¬å››åï¼Œå¹´çº§ç¬¬$289$ã€‚è¿™æ¬¡ä»–ä»¬ç­è€ƒå¾—å¾ˆå¥½ã€‚å¹´çº§å‰å››ï¼Œä»–çš„ç­é‡Œæœ‰ä¸‰ä¸ªï¼›å¹´çº§å‰20æœ‰10ä¸ªï¼Œå¹´çº§å‰400æœ‰46ä¸ªã€‚å¹´çº§å…±æœ‰1640å·¦å³çš„äººã€‚</p>
<p>è¿™ä¼¼ä¹æ˜¯å®éªŒéƒ¨è¯¥æœ‰çš„æˆç»©ã€‚å¯æ˜¯è·Ÿä»–æ²¡æœ‰å…³ç³»ã€‚</p>
<p>ç‰¹åˆ«çš„ï¼Œä»–çš„å¥³ç¥è€ƒäº†å¹´çº§28ï¼Œç­é‡Œç¬¬13ã€‚ä»–æ¯”å¥¹å·®åå€ã€‚è™½ç„¶åœè¯¾äº†ä¸€æ®µæ—¶é—´æ²¡ä¸Šå¥½åƒæ˜¯ä¸ªä¸é”™çš„ç†ç”±ï¼Œä½†ä»–ä¾æ—§è§‰å¾—ï¼Œè‡ªå·±å¤ªå¤±è´¥äº†ã€‚</p>
<p>å¤ªå¤±è´¥äº†ã€‚</p>
<p>å¤ªå¤±è´¥äº†ã€‚</p>
<hr>
<p>å¤§ä¼‘å›å®¶ï¼Œç°åœ¨æ˜¯$11.17$æ™šï¼Œæˆ‘ç”¨ç¬¬ä¸‰äººç§°è¯´å®Œäº†è¿™ä¸ªæ•…äº‹ï¼Œæ„Ÿè§‰â€¦â€¦å¹¶æ²¡æœ‰ä»€ä¹ˆæ„Ÿè§‰ã€‚</p>
<p>æˆ‘å‘ç°æˆ‘ç°åœ¨å¿ƒæƒ…è™½ç„¶å¾ˆæ²‰é‡ï¼Œä½†æ˜¯åŒæ ·å¾ˆæ”¾æ¾ã€‚æˆ‘å¤§æ¦‚ä¸ä¼šå†å‚åŠ ä»€ä¹ˆ$OI$äº†å§â€”â€”è¿™è®©æˆ‘æ„Ÿåˆ°è½»æ¾æ— æ¯”ã€‚ä¸éœ€è¦é¢å¯¹å…¶ä»–å¾ˆå¼ºçš„äººè€Œæœ‰å¿ƒç†è´Ÿæ‹…ï¼Œä¸å¿…é¢å¯¹æ•™ç»ƒä¸»ä»»å»æ‰¿å—ä»–ä»¬çš„â€œé«˜ç›®æ ‡â€ï¼Œä¸å¿…æ¯æ¬¡fakeæ—¶è¿˜ä¼šçº ç»“æˆ‘è‡ªå·±åˆ°åº•å¼ºä¸å¼ºï¼Œä¸å¿…å†å»äº‰å¼ºå¥½èƒœã€‚è™½ç„¶æœ€ç»ˆå…ä¸äº†è¢«å½“åšåé¢æ•™æè¯´ä¸ª$OI$çš„å­¦å¼Ÿä»¬ï¼Œè™½ç„¶å…ä¸äº†æ˜¯è¦ä¸»ä»»è¢«æ‰¹ä¸€é¡¿å¹¶ä¸”è®©ä½ æ€»ç»“ä¸ªä»€ä¹ˆå‚»é€¼é”™å› æˆ–è€…æ„Ÿæ‚Ÿå¹¶è®©ä½ å£°æ³ªä¿±ä¸‹åœ°å»åçœå¹¶ä¸”ä¿è¯ä»¥åå¥½å¥½å­¦$OI$ï¼Œä½†ï¼Œæˆ‘è½»æ¾çš„å¾ˆã€‚</p>
<p>è¿™çœŸæ˜¯ä»æœªæœ‰è¿‡çš„è½»æ¾çš„æ„Ÿè§‰ã€‚</p>
<p>æˆ–è®¸æˆ‘æœ¬æ¥æ²¡æœ‰ä»€ä¹ˆå¤©èµ‹ï¼Œåªæ˜¯åœ¨é ä¸ªäººç´ è´¨ç¡¬åˆšè€Œå·²ã€‚ä¹Ÿè®¸ä¿¡ç«ç»™æˆ‘çš„ç»ˆç©¶æ˜¯é™¤äº†æˆåŠŸä¹‹å¤–çš„ä¸€åˆ‡ï¼Œæ¯”å¦‚æ¯…åŠ›ï¼Œæ¯”å¦‚åšäººã€‚</p>
<p>æˆ‘æ„Ÿåˆ°æ— æ¯”çš„è½»æ¾ã€‚</p>
<p>ä»¥åå¤§æ¦‚ä¸ä¼šå­¦ä¿¡ç«äº†å§ã€‚æ¯•ç«Ÿå‹æ ¹æ²¡æœ‰ä»€ä¹ˆè½¬æœºã€‚è·¯çš„è¯ï¼Œè¾¹èµ°è¾¹æƒ³å§ã€‚</p>
<p>æˆ‘ç°åœ¨ååˆ†åœ°æƒ³å­¦$CNAO$ï¼Œä¹‹å‰ç”±äºè¦å‡†å¤‡$NOIp$ï¼Œä»å›¾ä¹¦é¦†å€Ÿæ¥çš„ä¹¦æ²¡æ¥å¾—åŠçœ‹ã€‚ç°åœ¨ç»ˆäºæœ‰æ—¶é—´äº†ã€‚</p>
<p>å—¯ï¼Œå¤§æ¦‚å¤©æ–‡æ‰æ˜¯æˆ‘çœŸæ­£å–œæ¬¢çš„å§ã€‚ä»¥å‰æ¯æ¬¡ä¸ºäº†$OI$å¥‹æ–—çš„æ—¶å€™æ€»è¦æƒ³æƒ³è‡ªå·±åˆ°åº•æ˜¯ä¸æ˜¯çœŸæ­£å–œæ¬¢$OI$ï¼Œå…¶å®è¯´ä¸ä¸Šå–œæ¬¢å§ï¼Œæ¯•ç«Ÿæ²¡æœ‰çœŸçš„ä»éª¨å­é‡Œå–œæ¬¢è¿™ä¸œè¥¿ã€‚</p>
<p>ä½†æ˜¯å…¶å®å±±ä¸œæ²¡æœ‰å¼€å±•$AO$çš„ï¼Œä¸è¿‡æˆ‘æƒ³å½“è¿™ä¸ªç¬¬ä¸€äººã€‚</p>
<p>æˆ‘çªç„¶å¾ˆæ„Ÿæ¿€è¿™ä¸€åˆ‡ï¼Œæ„Ÿæ¿€æ›¾ç»çš„å¤±è´¥ä¸æˆåŠŸã€æ”¶è·ä¸æ„ŸåŠ¨ã€‚å›ä¸æˆ‘ä¹‹æ©ï¼Œæ¯•ç”Ÿéš¾å¿˜ã€‚</p>
<p>åˆ°äº†è¯´å†è§çš„æ—¶å€™äº†ï¼Œå“ˆï¼Œæˆ‘çš„ä½œä¸šè¿˜æ²¡å†™å‘¢ã€‚æˆ‘å¯è¦å­¦å¥½æ–‡åŒ–è¯¾ï¼Œåšçš„æ»´æ°´ä¸æ¼æ‰èƒ½å»å­¦$AO$å•Šï¼Œè™½ç„¶è¿™æ˜¯ä¸€æ®µæœªçŸ¥çš„æ—…ç¨‹ï¼Œä½†æ˜¯æˆ‘ä¹æ„å»é—¯ã€‚</p>
<hr>
<p>åœ¨æˆç»©å•ä¸Šçœ‹åˆ°äº†å¥½å¤šå±±ä¸œçš„å·¨ä½¬â€¦â€¦æ›¾ç»åœ¨æˆ‘çœ‹æ¥ä¸æˆ‘æ°´å¹³å·®ä¸å¤šçš„äººï¼Œå¤§æ¦‚éƒ½ä»¥å‹å€’æ€§çš„ä¼˜åŠ¿å‡»è´¥äº†æˆ‘å§ã€‚</p>
<p>æ²¡å‡†å­¦$OI$çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä¸€ç›´æ˜¯ä¸ºäº†åŠŸååˆ©ç¦„è€Œå­¦ï¼Œä¸ºäº†è·å¾—è¿›å…¥æŸä¸¤æ‰€å¤§å­¦çš„æœºä¼šè€Œå­¦ï¼Œç»ˆç©¶æ˜¯è‚¯å®šä¸ä¼šæˆåŠŸçš„å§â€”â€”åˆ°ä¸æ˜¯è¯´ä¸€å®šè¦å»å–œæ¬¢è¿™é—¨å¥¥èµ›ï¼Œåªæ˜¯åœ¨å¥‹æ–—çš„æ—¶å€™ï¼Œè¿˜æ˜¯åªä¸ºäº†å¥‹æ–—è€Œå¥‹æ–—æ¯”è¾ƒå¥½å§ã€‚</p>
<p>æˆ‘è¯¥è¯´ä»€ä¹ˆï¼Ÿå¼ºå¤§çš„ç†è§£èƒ½åŠ›æˆ–è€…æ¨ç†èƒ½åŠ›ï¼Œç»ˆæ˜¯ä¸æ˜¯OIçš„æ ¸å¿ƒç´ å…»â€”â€”åˆ›é€ åŠ›æ‰æ˜¯ã€‚å½“ç„¶å•¦ï¼Œæ•°å­¦æœ‰å¤Ÿå¥½+å¼ºå¤§çš„ç†è§£èƒ½åŠ›=rqyè¿™ä¸ªç­‰å¼ä¹Ÿæ˜¯æˆç«‹çš„ã€‚</p>
<p>å½“ç„¶ï¼Œä¸å±äºæˆ‘å•¦ã€‚</p>
<p>è™½ç„¶ç°åœ¨å¾ˆä¸ç”˜â€¦â€¦ä½†æ˜¯æ²¡æœ‰åŠæ³•ï¼Œå¤§æ¦‚è¿™å°±æ˜¯äººç”Ÿå§ã€‚</p>
<p>å¦‚æœè¯´â€¦â€¦é€€å½¹åçš„å‡ å¤©æ„Ÿè§‰æ€ä¹ˆæ ·â€¦â€¦è¿˜å¥½å§ï¼Œæ²¡æˆ‘æƒ³è±¡çš„ç—›è‹¦ã€‚åªä¸è¿‡ä¹‹å‰ä¸€ç›´æ†§æ†¬çš„æ‰€è°“â€œå¦¹å­â€ä¹Ÿå¥½ï¼Œâ€œå¥³ç¥â€ä¹Ÿå¥½ï¼ŒåŸæ¥ä¸€ç›´æœ‰ç”·æœ‹å‹åªä¸è¿‡æˆ‘ä¸çŸ¥é“ï¼›åªä¸è¿‡å¹²èµ·ä»€ä¹ˆäº‹æƒ…æ¥éƒ½åŠ›ä¸ä»å¿ƒè€Œå·²ï¼›åªä¸è¿‡é‡æ–°ç‡ƒèµ·çš„å¸Œæœ›ä¹‹ç«åˆè¢«æµ‡ç­äº†è€Œå·²å§ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¿…è¦å»ä¸ºä¹‹ä¼¤å¿ƒâ€”â€”è¿™æ‰æ˜¯äººç”Ÿå§ã€‚</p>
<p>å¬è¯´ä½ è°·æœ‰ä¸ªOIerè‡ªæ€äº†â€¦â€¦ä¸çŸ¥é“è¿™ä¸ªä¼ é—»æ˜¯çœŸæ˜¯å‡ï¼Œæ¯•ç«Ÿä¹Ÿæ²¡æ³•å»ç¡®è®¤ã€‚æˆ‘åªæ˜¯ä¸ºæ­¤æ„Ÿåˆ°ä¼¤å¿ƒè€Œå·²â€”â€”æ— è®ºåˆ°åº•æœ‰æ²¡æœ‰è‡ªæ€ï¼Œæˆ‘åªæƒ³ç”¨é‚£å¥è¯æ¥è¯„è®ºâ€œå®åŠ›å¦‚æœå¼ºåˆ°ç‹¬æ­¥å¤©ä¸‹ï¼Œæƒ³æ€ä¹ˆå­¦å°±æ€ä¹ˆå­¦ï¼›å¦åˆ™åªèƒ½æ¯«æ— ä¿ç•™åœ°ã€çº¯ç²¹åœ°å»åŠªåŠ›ï¼Œè€Œä¸æ˜¯ä¸ºäº†å»è·å¾—åŠŸåã€å°ä½›å°ç¥ â€”â€” ä¸å¿˜åˆå¿ƒåœ¨ä»€ä¹ˆæ—¶å€™éƒ½æ˜¯æœ€é‡è¦çš„ã€‚â€æ‰€ä»¥ï¼Œå¿ƒæ— æ—éª›ï¼Œä»€ä¹ˆæ—¶å€™éƒ½æ˜¯æœ€é‡è¦çš„ã€‚</p>
<p>æ€»ä¹‹å‘¢ï¼Œæˆ‘æŠŠè¿™ç¯‡æ–‡ç« ç§°ä¹‹ä¸ºâ€œå¯ç¤ºå½•â€ï¼Œåªæ˜¯å¸Œæœ›åæ¥çš„Oieræˆ–å¯ä»¥ä»æˆ‘çš„è¿™ä¸€äº›æ‚æ‚Ÿé‡Œè·å¾—äº›ä»€ä¹ˆï¼š</p>
<h2 id="åšä»€ä¹ˆäº‹æƒ…ï¼Œéƒ½è¦å…ˆä»è‡ªå·±çš„çµé­‚å‡ºå‘ï¼Œè€Œä¸æ˜¯ä»åˆ©ç›Šå‡ºå‘ã€‚"><a href="#åšä»€ä¹ˆäº‹æƒ…ï¼Œéƒ½è¦å…ˆä»è‡ªå·±çš„çµé­‚å‡ºå‘ï¼Œè€Œä¸æ˜¯ä»åˆ©ç›Šå‡ºå‘ã€‚" class="headerlink" title="åšä»€ä¹ˆäº‹æƒ…ï¼Œéƒ½è¦å…ˆä»è‡ªå·±çš„çµé­‚å‡ºå‘ï¼Œè€Œä¸æ˜¯ä»åˆ©ç›Šå‡ºå‘ã€‚"></a>åšä»€ä¹ˆäº‹æƒ…ï¼Œéƒ½è¦å…ˆä»è‡ªå·±çš„çµé­‚å‡ºå‘ï¼Œè€Œä¸æ˜¯ä»åˆ©ç›Šå‡ºå‘ã€‚</h2><p>ä¹‹ç±»çš„å§ã€‚</p>
<p>æˆ‘æƒ³å¼•ç”¨ä¸€å¥ï¼ˆæ®µï¼‰è¯ï¼Œæ¥è‡ªã€Šæœ¬æ°æ˜å·´é¡¿å¥‡äº‹ã€‹ï¼š</p>
<blockquote>
<p>æœ‰äº›äººï¼Œæ³¨å®šå¯ä»¥äºæ²³è¾¹é—²åã€‚<br>æœ‰äº›äººè¢«é—ªç”µå‡»ä¸­è¿‡ä¸ƒæ¬¡ã€‚<br>æœ‰äº›äººå¯¹éŸ³ä¹æœ‰ç€éå‡¡çš„å¤©èµ‹ã€‚<br>æœ‰äº›äººæ˜¯è‰ºæœ¯å®¶ã€‚<br>æœ‰äº›äººæ˜¯æ¸¸æ³³å¥å°†ã€‚<br>æœ‰äº›äººæ‡‚å¾—åˆ¶ä½œçº½æ‰£ã€‚<br>æœ‰äº›äººæ‡‚èå£«æ¯”äºšã€‚<br>æœ‰äº›äººæ˜¯å¦ˆå¦ˆã€‚<br>è¿˜æœ‰äº›äººï¼Œæ˜¯èˆè€…ã€‚<br>æˆ‘ä»¬æ³¨å®šè¦å¤±å»æˆ‘ä»¬æ‰€çˆ±çš„äººï¼Œ<br>è¦ä¸ç„¶æˆ‘ä»¬æ€ä¹ˆçŸ¥é“ä»–ä»¬å¯¹æˆ‘ä»¬æœ‰å¤šä¹ˆçš„é‡è¦ã€‚</p>
</blockquote>
<p>åä¼šæœ‰æœŸã€‚</p>
<h1 id="mathscr-THE-quad-ENDâ€¦"><a href="#mathscr-THE-quad-ENDâ€¦" class="headerlink" title="$\mathscr{THE\quad ENDâ€¦.?}$"></a>$\mathscr{THE\quad ENDâ€¦.?}$</h1>]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>éšæƒ³/ä¸‹ä¸‹ç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘CF#536Div2ã®é¢˜è§£(E&amp;F)</title>
    <url>/2019/02/08/CF-536Div2%E3%81%AE%E9%A2%98%E8%A7%A3-E-F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ˜¥èŠ‚å‰çš„ä¸€åœº$CF$ï½åå­—å¾ˆ$nice$çš„è¯´ï½</p>
<p>â‘§è¯´åˆ«çš„å•¦ï¼Œæ–°å¹´å¥½é‚£ä¸ªæ–°å¹´å¥½qwq!</p>
<a id="more"></a>
<p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89--%2F%E7%9C%81%E9%80%89-blueviolet.svg" alt></p>
<h2 id="0x01-Preface"><a href="#0x01-Preface" class="headerlink" title="$0x01~~Preface$"></a>$0x01~~Preface$</h2><p>$emmm$è¿™æ¬¡CFæœ¬èº«æ‰“çš„å¾ˆé¡ºç•…ï¼Œä½†æ˜¯å±…ç„¶unratedäº†â€¦â€¦å’•å’•å’•å’•</p>
<p>è¿™æ˜¯å¤´ä¸€æ¬¡CFæœ‰æ¯”èµ›æˆ‘å…¨éƒ¨é¢˜ç›®éƒ½åšäº†â€¦â€¦å¯å–œå¯è´ºå¯å–œå¯è´º233</p>
<p>ç®€å•æ€»ç»“ä¸€ä¸‹å‰é¢å››é“é¢˜<a href="http://codeforces.com/contest/1106" target="_blank" rel="noopener">$\color{red}{Link}$</a>ï¼š</p>
<ul>
<li><p>Aé¢˜ï¼šsbé¢˜ï¼Œ$O(n^2)$æšä¸¾çš„çº¢é¢˜ï¼ˆæˆ–è®¸éƒ½ä¸åˆ°ï¼‰ï¼Œä½†æ˜¯æˆ‘$check$çš„æ—¶å€™å¤ªç²—å¿ƒWAäº†ä¸€æ¬¡<del>èº«è´¥åè£‚XD</del></p>
</li>
<li><p>Bé¢˜ï¼šsbé¢˜ï¼Œä¸€ä¸ªæ¨¡æ‹Ÿï¼Œéœ€è¦ä¸€ä¸ªå¯ä»¥å¤„ç†ä¼˜å…ˆçº§çš„æ•°æ®ç»“æ„ï¼ˆå…¶å®å°±æ˜¯å †ä½†æ˜¯æˆ‘ä¸€å¼€å§‹æƒ³çš„æ˜¯çº¿æ®µæ ‘ï¼‰</p>
</li>
<li>Cé¢˜ï¼šsbé¢˜ï¼Œä¸€ä¸ªè´ªå¿ƒï¼ˆå…¶å®æ˜¯æ•°å­¦ä¸Šå¯proofçš„æ•°å­¦é¢˜ä½†è¢«æˆ‘å½“è´ªå¿ƒé¢˜åšäº†XDï¼‰ï¼Œå¤§æ¦‚å°±æ˜¯ä½ èƒ¡ä¹±æ’ä¸ªåºä¹‹åèƒ¡æä¸€ä¸‹å°±å¥½ã€‚</li>
<li>Dé¢˜ï¼šæ°´é¢˜ï¼Œæ€è€ƒä¸€ä¸‹å¯å¾—ï¼Œæˆ‘ä»¬åªéœ€è¦å†™ä¸€ä¸ªBFS+ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—å³å¯ï¼Œå› ä¸ºæ— å‘å›¾+éšä¾¿èµ°=èƒ¡æå…«æ</li>
</ul>
<p>ä¸‹é¢ä¸¤é“é¢˜å°±å¥½åƒä¸æ˜¯é‚£ä¹ˆæ°´äº†qaq</p>
<h2 id="0x02-E-cdot-text-Lunar-New-Year-and-Red-Envelopes"><a href="#0x02-E-cdot-text-Lunar-New-Year-and-Red-Envelopes" class="headerlink" title="$0x02~~E\cdot \text{Lunar New Year and Red Envelopes}$"></a>$0x02~~E\cdot \text{Lunar New Year and Red Envelopes}$</h2><h3 id="color-red-Link"><a href="#color-red-Link" class="headerlink" title="$\color{red}{Link}$"></a><a href="http://codeforces.com/contest/1106/problem/E" target="_blank" rel="noopener">$\color{red}{Link}$</a></h3><p>ç®€å•æ¥è¯´å°±æ˜¯ç»™$k$ä¸ªåŒºé—´ï¼Œæ¯ä¸ªåŒºé—´ä¸€ä¸ªå·¦ç«¯ç‚¹$s$ä¸€ä¸ªå³ç«¯ç‚¹$e$ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªèœœæ±Â·å³ç«¯ç‚¹$t$ã€‚é¡ºç€æ—¶é—´çº¿$1$~$n$ï¼Œå¯ä»¥ä»$s_i$åˆ°$e_i$çš„æ—¶é—´å†…é€‰æ‹©è·å¾—$w_i$çš„æ”¶ç›Šï¼Œä½†åŒæ—¶ä¸‹æ¬¡çš„é€‰æ‹©å¿…é¡»åœ¨$t_i$ä¹‹åã€‚</p>
<p>æœ€å¤§åŒ–æ”¶ç›Šçš„æ€è·¯ä¸‹ï¼Œæœ‰$m$æ¬¡æœºä¼šè®©é€‰æ‹©è€…åœ¨æŸä¸ªæ—¶é—´ç‚¹å•¥éƒ½ä¸å¹²ã€‚æ±‚æœ€å°çš„æ”¶ç›Šã€‚</p>
<h3 id="mathfrak-Solution"><a href="#mathfrak-Solution" class="headerlink" title="$\mathfrak {Solution}$"></a>$\mathfrak {Solution}$</h3><p>å‘ƒï¼Œå…¶å®æ¯”è¾ƒå®¹æ˜“çš„å‘ç°å°±æ˜¯ä¸ªæ—¶é—´çº¿$DP$ã€‚æ ¹æ®â€$n$ä¸å¤§å°±DP$n$â€çš„æ˜¯æŒ‡å¯¼æ€æƒ³ï¼ˆçæ‰¯çš„ï¼‰ï¼Œæˆ‘ä»¬åº”è¯¥æŒ‰æ—¶é—´$DP$ã€‚é‚£ä¹ˆç¬¬ä¸€æ­¥å°±æ˜¯æŠŠæ¯ä¸ªåŒºé—´çš„ä¿¡æ¯æ˜ å°„åˆ°æ—¶é—´çº¿ä¸Šå»ã€‚è¿™ä¸ªæ—¶å€™æœ‰ä¸€ä¸ªæ¯”è¾ƒå¦™çš„$idea$ã€‚é¦–å…ˆæˆ‘ä»¬ç»™æ¯ä¸ªåŒºé—´çš„$s$å’Œ$e+1$åœ¨æ—¶é—´çº¿ä¸Šåˆ†åˆ«æ‰“ä¸Šä¸åŒçš„æ ‡è®°ï¼Œä¹‹åæˆ‘ä»¬è€ƒè™‘æ²¿æ—¶é—´çº¿ä»å‰å‘åæ‰«ææ¯ä¸€æ®µåŒºé—´ï¼Œæ¯å½“é‡åˆ°ä¸€ä¸ªåŒºé—´çš„$s$æ—¶å°±ä¸¢åˆ°ä¸€ä¸ª$multiset$é‡Œé¢ï¼Œåä¹‹é‡åˆ°$e+1$æ—¶å°±$erase$ã€‚ç„¶åè¿™æ ·æˆ‘ä»¬åªé¡ºä¾¿ä¹±æä¸€ä¸‹å°±å¯ä»¥å¾—å‡ºæ¯ä¸ªæ—¶é—´ç‚¹æœ€ä¼˜çš„æ–¹æ¡ˆã€‚</p>
<p>ä¹‹åï¼Ÿä¹‹åå°±ç›´æ¥$nm$çš„DPå•Šï¼Œæ¯•ç«Ÿ$nm$åªæœ‰$20million$é‚£ä¹ˆå¤§ã€‚</p>
<p>Ps:ç”±äºSTLä¸­multisetä¸€åˆ åˆ ä¸€ä¸²çš„zzæ€§è´¨ï¼Œæ”¹ç”¨mapæƒ¹qaq</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 233</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 100010</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">time_node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> mark, d, w ;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> time_node &amp;T) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> w &gt; T.w || (w == T.w &amp;&amp; d &gt; T.d);</span><br><span class="line">	&#125;</span><br><span class="line">&#125; base[MAXN] ; </span><br><span class="line"><span class="built_in">map</span> &lt;time_node, <span class="keyword">int</span>&gt; M_set ; </span><br><span class="line"><span class="built_in">vector</span>&lt;time_node&gt;Time[MAXN] ; <span class="keyword">long</span> <span class="keyword">long</span> Ans ;</span><br><span class="line"><span class="keyword">int</span> N, M, K, A, B, C, D, i, j ; <span class="keyword">long</span> <span class="keyword">long</span> dp[MAXN][MAXM] ;  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; K ;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">63</span>, <span class="keyword">sizeof</span>(dp)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= K ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;A, &amp;B, &amp;C, &amp;D), </span><br><span class="line">        Time[A].push_back((time_node)&#123;<span class="number">1</span>, C, D&#125;) ;</span><br><span class="line">        Time[B + <span class="number">1</span>].push_back((time_node)&#123;<span class="number">2</span>, C, D&#125;) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">register</span> <span class="keyword">int</span> tot = Time[i].size() ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; tot ; ++ j) </span><br><span class="line">            <span class="keyword">if</span> (Time[i][j].mark == <span class="number">1</span>) ++ M_set[Time[i][j]] ; </span><br><span class="line">            <span class="keyword">else</span> M_set[Time[i][j]] &gt; <span class="number">1</span> ? M_set[Time[i][j]] -- : M_set.erase(Time[i][j]) ;</span><br><span class="line">        <span class="keyword">if</span> (M_set.size()) base[i] = (*M_set.begin()).first ; <span class="keyword">else</span> base[i] = (time_node)&#123;<span class="number">0</span>, i, <span class="number">0</span>&#125; ;</span><br><span class="line">    &#125;dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>, Ans = dp[<span class="number">1</span>][<span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= M ; ++ j)&#123;</span><br><span class="line">            j &gt; <span class="number">0</span> ? dp[i][j] = min(dp[i - <span class="number">1</span>][j - <span class="number">1</span>], dp[i][j]) : <span class="number">1</span> ;</span><br><span class="line">            dp[base[i].d][j] = min(dp[base[i].d][j], dp[i - <span class="number">1</span>][j] + base[i].w) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= M ; ++ i) Ans = min(Ans, dp[N][i]) ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x03-F-cdot-text-Lunar-New-Year-and-a-Recursive-Sequence"><a href="#0x03-F-cdot-text-Lunar-New-Year-and-a-Recursive-Sequence" class="headerlink" title="$0x03~~F\cdot \text{Lunar New Year and a Recursive Sequence}$"></a>$0x03~~F\cdot \text{Lunar New Year and a Recursive Sequence}$</h2><p><a href="http://codeforces.com/contest/1106/problem/E" target="_blank" rel="noopener">$Link$</a></p>
<p>ç®€å•æ¥è¯´å°±æ˜¯ç»™ä½ ä¸€ä¸ªåºåˆ—$F_x$çš„$k$é¡¹çš„é€’æ¨æ³•åˆ™ï¼ˆå¹‚æ¬¡ç§¯å¼é€’æ¨ï¼‰ï¼Œåœ¨è®¤å®šå‰$k-1$é¡¹éƒ½æ»¡è¶³$F_x=1$çš„åŸºç¡€ä¸Šç»™å®š$F_n$ï¼Œè®©ä½ å€’æ¨å‡º$F_k$æ¥ã€‚</p>
<h3 id="mathfrak-Solution-1"><a href="#mathfrak-Solution-1" class="headerlink" title="$\mathfrak {Solution}$"></a>$\mathfrak {Solution}$</h3><p>æ•æˆ‘ç›´è¨€â€¦è¿™é“é¢˜æˆ‘è€ƒåœºä¸Šæ˜¯ä¸å¯èƒ½ä¼šçš„â€¦ï¼ˆå·²æ‰‘è¡—</p>
<p>é¦–å…ˆæˆ‘ä»¬è§‚å¯Ÿä¸€èˆ¬å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
F_x = \begin{cases}1 \ , &\rm{x<k} \newline ? \ , & \rm{x = k} \newline \prod\limits_{j=1}^kF_{x-j}^{b_j}  ,  & \rm{x>k}\end{cases} \  (\mod 998,244,353)</script><p>å¤§ä½“ä¸Šè¿™ä¸ªå¼å­æ˜¯æ²¡æ³•åšçš„ï¼Œå› ä¸ºæ¯•ç«Ÿæ˜¯ä¹˜ç§¯+å¹‚æ¬¡æ–¹é€’æ¨çš„å½¢å¼ã€‚ä½†æ˜¯è¿™ä¸ªåœ°æ–¹æœ‰ä¸ª<del>æˆ‘æ²¡æƒ³å‡ºæ¥ã€æƒ³å‡ºæ¥ä¹Ÿä¸ä¼šç”¨çš„</del>$Idea$ï¼Œå°±æ˜¯æˆ‘ä»¬æ—¢ç„¶è¦æŠŠä¹˜ç§¯è½¬åŒ–æˆæ±‚å’Œçš„å½¢å¼ï¼Œé‚£å°±åªèƒ½åœ¨æŒ‡æ•°ä¸Šä¹±æã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠå®ƒçš„æ¯ä¸€é¡¹éƒ½å†™æˆåŒä¸€ä¸ªæ•°çš„å¹‚æ¬¡ï¼Œé‚£ä¹ˆé€’æ¨çš„æ—¶å€™åªéœ€è¦åšåŠ æ³•å°±å¯ä»¥äº†ã€‚</p>
<p>æ¬¡æˆ‘ä»¬é€‰æ‹©$998,244,353$çš„<strong>åŸæ ¹</strong>ä½œä¸ºåº•æ•°ã€‚å› ä¸ºåŸæ ¹æœ‰ä¸€ä¸ªå¾ˆä¼˜ç¾çš„æ€§è´¨ï¼Œå°±æ˜¯<strong>$p$çš„åŸæ ¹çš„å¹‚æ¬¡å¯ä»¥éå†$p$çš„ç®€åŒ–å‰©ä½™ç³»ã€‚</strong>è€Œç”±$NTT$é‡Œå¾—åˆ°çš„ç»éªŒï¼Œè¿™ä¸ªæ¨¡æ•°çš„æœ€å°åŸæ ¹æ˜¯$3$ã€‚</p>
<hr>
<p>åŸæ ¹çš„åŸºæœ¬å®šä¹‰ï¼šè®¾$g$ä¸º$p$çš„ä¸€ä¸ªåŸæ ¹ï¼Œåˆ™æ»¡è¶³ï¼š</p>
<script type="math/tex; mode=display">ğ‘”^{ğ‘âˆ’1}  \equiv 1(\mod p)</script><script type="math/tex; mode=display">âˆ€1â‰¤ğ‘˜<ğ‘âˆ’1, ğ‘”^ğ‘˜ \not \equiv 1(\mod p)</script><hr>
<p>ä¹‹åå‘¢ï¼Ÿä¹‹åæˆ‘ä»¬å°±æ‰¾ä¸€ä¸ªå‡½æ•°$q(x)$ï¼Œä»¤<script type="math/tex">g^{q(x)} \equiv x(\bmod p)</script> ç›®çš„æ˜¯ä¸ºäº†æ„é€ ä¸€ä¸ª$l_x = q(F_x)$ï¼Œä½¿å¾—ç­‰å¼<script type="math/tex">g^{l_x} \equiv \prod \limits_{i=1}^{k}g^{b_il_{x-i}}( \mod p)</script>æˆç«‹ã€‚è€Œæ¯”è¾ƒç‰¹æ®Šçš„æ˜¯ï¼Œå› ä¸º$F_1$~$F_{k-1}$éƒ½ä¸º$1$ï¼Œæ‰€ä»¥$l_i=0\quad(1 \leq i &lt;k)$ ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´å¯¹äºæŒ‡æ•°ä¸Šçš„$l_x$æ»¡è¶³<script type="math/tex">l_x \equiv \sum\limits_{i=1}^{k}b_il_{x-i}( \mod p-1)</script>è¿™å°±æ˜¯ä¸€ä¸ªçº¿æ€§é€’æ¨çš„å½¢å¼äº†ã€‚</p>
<p>æ­¤å¤„æœ‰ä¸ªå°$trick$ï¼Œå°±æ˜¯æˆ‘ä»¬ä¸ºäº†é˜²æ­¢$l_x$è¿‡å¤§ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å®ƒå–æ¨¡ï¼Œæ­¤æ—¶ç›´æ¥ä¾æ®è´¹é©¬å°å®šç†ï¼Œå–$p-1$åšæ¨¡æ•°å³å¯ã€‚</p>
<p>æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªååˆ†å·§å¦™çš„$Idea$ï¼Œæˆ‘ä»¬è™½ç„¶ä¸çŸ¥é“$l_k$ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çŸ¥é“$l_k$åˆ°$l_n$æ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚è§‚å¯Ÿé¢˜ç›®æ€§è´¨ï¼Œ<script type="math/tex">l_j = \omega_j l_k \mod(p-1)</script>å…¶ä¸­çš„$\omega_j$æ˜¯ä¸€ä¸ªå…³äº$b_k$çš„å¸¸é‡å› å­ã€‚è¯æ˜ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå› ä¸º$l_i=0\quad(1 \leq i &lt; k) $æ˜¯æ˜¾ç„¶çš„ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åšä¸€ä¸‹çŸ©é˜µå¿«é€Ÿå¹‚â€”â€”å¹‚æ¬¡ä¸Šæ˜¯$n-k$â€”â€”å°±å¯ä»¥å¾—å‡º$\omega_n$æ¥ã€‚è€Œæˆ‘ä»¬çš„$l_n$æ˜¯å¯ä»¥é€šè¿‡å¯¹åŸæ ¹$g$æ±‚$BSGS$è§£å¾—çš„ã€‚é‚£ä¹ˆç°åœ¨å°±æ˜¯<script type="math/tex">l_k\omega_n = l_n \mod (p-1)</script>ç§»ä¸ªé¡¹å¯ä»¥å¾—åˆ°<script type="math/tex">l_k \omega_n + t(p-1)= l_n</script>ç”±äºåŸé¢˜è®©æ±‚çš„æ˜¯æœ€å°çš„æ­£æ•´æ•°è§£ï¼Œæ‰€ä»¥åº”ç”¨ä¸€ä¸‹$exgcd$åˆ¤ä¸€ä¸‹æ˜¯å¦æœ‰è§£å°±è§£å†³äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 108</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>&lt;LL, LL&gt; Hash ;</span><br><span class="line"><span class="keyword">int</span> N, T, base[MAXN] ;</span><br><span class="line">LL Ft, Hn, Xs, Ans, X, Y, G  ; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span>&#123;</span></span><br><span class="line">    LL M[MAXN][MAXN] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123; <span class="built_in">memset</span>(M, <span class="number">0</span>, <span class="keyword">sizeof</span>(M)) ;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        clear() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) M[i][i] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">friend</span> <span class="keyword">operator</span> *(<span class="keyword">const</span> Matrix&amp;A, <span class="keyword">const</span> Matrix &amp;B)&#123;</span><br><span class="line">        Matrix Ans ; Ans.clear() ; </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; k &lt;= N; ++ k)</span><br><span class="line">                    Ans.M[i][j] = (Ans.M[i][j] + A.M[i][k] * B.M[k][j]) % (Mod - <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">return</span> Ans ;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">friend</span> <span class="keyword">operator</span> +(<span class="keyword">const</span> Matrix&amp;A, <span class="keyword">const</span> Matrix &amp;B)&#123;</span><br><span class="line">        Matrix Ans ; Ans.clear() ; </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">                    Ans.M[i][j] = (A.M[i][j] + B.M[i][j]) % (Mod - <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">return</span> Ans ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> Matrix <span class="title">expow</span><span class="params">(Matrix T, LL P)</span></span>&#123;</span><br><span class="line">    Matrix Ans ; Ans.reset() ;</span><br><span class="line">    <span class="keyword">while</span> (P)&#123;</span><br><span class="line">        <span class="keyword">if</span> (P &amp; <span class="number">1</span>) Ans = Ans * T ;</span><br><span class="line">        T = T * T, P &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL a, LL b, LL p)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) </span><br><span class="line">            (res *= a) %= p ;</span><br><span class="line">        (a *= a) %= p, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res % p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">bsgs</span><span class="params">(LL x, LL y, LL p)</span></span>&#123;</span><br><span class="line">    LL P = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p - <span class="number">1</span>)), Q = expow(x, -P + <span class="number">2</span> *(p - <span class="number">1</span>), p) ;</span><br><span class="line">    <span class="keyword">for</span> (LL i = <span class="number">1</span>, j = <span class="number">0</span> ; j &lt;= P ; ++ j, (i *= x) %= p)  <span class="keyword">if</span> (!Hash.count(i)) Hash[i] = j ; </span><br><span class="line">    <span class="keyword">for</span> (LL i = y, j = <span class="number">0</span>  ; j &lt;= P ; ++ j, (i *= Q) %= p)  <span class="keyword">if</span> (Hash.count(i)) <span class="keyword">return</span> Hash[i] + j * P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">exgcd</span><span class="params">(LL a, LL b, LL &amp;x, LL &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b) &#123;x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> a ;&#125;</span><br><span class="line">    LL t = exgcd(b, a % b, y, x) ;  y -=  a / b * x ; <span class="keyword">return</span> t ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> LL k = <span class="number">0</span>, p = <span class="number">1</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>) &#123; c = getchar() ; <span class="keyword">if</span> (c == <span class="string">'-'</span>) p = <span class="number">-1</span> ;&#125;</span><br><span class="line">    <span class="keyword">while</span> (c &lt;= <span class="string">'9'</span> &amp;&amp; c &gt;= <span class="string">'0'</span>) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k * p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">register</span> <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) base[i] = qr() ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T &gt;&gt; Ft ;  Matrix lab ;  lab.clear() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= N ; ++ i) lab.M[i][i - <span class="number">1</span>] = <span class="number">1l</span>l  ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) lab.M[i][N] = <span class="number">1l</span>l * base[N -i + <span class="number">1</span>] ;</span><br><span class="line">    lab = expow(lab, T - N), Hn = bsgs(<span class="number">3</span>,Ft, Mod), Xs = lab.M[N][N] ; </span><br><span class="line">    G = exgcd(Xs, Mod - <span class="number">1</span>, X, Y) ; <span class="keyword">if</span> (Hn % G) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ;</span><br><span class="line">    X = (X % (Mod - <span class="number">1</span>) * (Hn / G) % (Mod - <span class="number">1</span>) + Mod - <span class="number">1</span>) % (Mod - <span class="number">1</span>) ;</span><br><span class="line">    Ans = expow(<span class="number">3</span>, X, Mod) ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x00-quad-åè®°"><a href="#0x00-quad-åè®°" class="headerlink" title="$0x00\quad$åè®°"></a>$0x00\quad$åè®°</h2><p>è¯´å®è¯ï¼Œè¿™æ˜¯ç¬¬ä¸€æ¬¡åšæ•´å¥—CFçš„é¢˜ç›®â€¦ç¡®å®ï¼Œåƒé‡ŒæŒ‘ä¸€çš„é¢˜ç›®å°±æ˜¯æ¯”ä½ è°·ä¸Šéšä¾¿æ‰¾å‡ é“é¢˜åšæ¥åŠ²ã€‚$A$~$E$éƒ½è¿˜å¥½ï¼Œä½†æ˜¯$F$å®åœ¨æ˜¯â€¦â€¦çœ‹é¢˜è§£éƒ½è¦æƒ³åŠå¤©çš„é‚£ç§â€¦â€¦å°¤å…¶æ˜¯è¿™ä¸ªè§£ç¦»æ•£æ–¹æ ¹çš„ä¸œè¥¿â€¦â€¦å“‡å¡æ¶å¿ƒæ­»äº†ä»æ²¡å¬è¯´è¿‡è¿˜æœ‰è¿™ä¸œè¥¿qaq</p>
<p>rqyè¯´$F$é¢˜æ˜¯çœé€‰ä¸€è½®çš„éš¾åº¦â€”â€”è™½ç„¶æ²¡è¯´æ˜¯$D$å‡ $T$å‡ ï¼Œä½†æˆ‘æ„Ÿè§‰ä»–çš„è¯­æ°”ä¸åƒæ˜¯åœ¨è¯´ä¸€é“å¾ˆéš¾çš„é¢˜â€¦â€¦</p>
<p>å®Œäº†ï¼Œè¦è·ªäº†ã€‚</p>
<blockquote>
<p>å¥¥èµ›æ–‡åŒ–è¯¾ä¸¤çˆ†ç‚¸ï¼Œçœé€‰è¿›é˜Ÿè¿›ä½ maï¼ŒæŒ‡æœ›ç€å°†æ¥æ²¡å­¦ä¸Šï¼Œè¿˜ä¸å¦‚æ”¶æ‹¾å¥½é“ºç›–æ—©å›å®¶ ã€‚</p>
<p>â€‹                                                    â€”â€”ï¼ˆpksã€Šæ˜¥æ—¥ç»å¥ã€‹ï¼‰</p>
</blockquote>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>BSGS/exBSGS</tag>
        <tag>åŠ¨æ€è§„åˆ’/æ™®é€šDP</tag>
        <tag>æ•°å­¦/çº¿æ€§ä»£æ•°/çŸ©é˜µ</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•</title>
    <url>/2019/02/07/Lagrange-Formula/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¥½åƒåˆä¸‰çš„æ—¶å€™çœ‹é€‰ä¿®4-6çš„è¯¾æœ¬çœ‹çš„ä¸€è„¸æ‡µï¼Œè¿™ä¸œè¥¿ä¼¼ä¹æ˜¯ä¸ºæ•°ä¸å¤šå°è±¡æ·±åˆ»çš„233</p>
<a id="more"></a>
<p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98---9cf.svg" alt></p>
<h2 id="rm-0x01-Preface"><a href="#rm-0x01-Preface" class="headerlink" title="$\rm{0x01~~} Preface$"></a>$\rm{0x01~~} Preface$</h2><p><strong>æ’å€¼($\rm Interpolaton$)</strong> åœ¨å¤šé¡¹å¼åŸŸä¸­å¯ä»¥çœ‹åšæ˜¯<strong>æ±‚å€¼$(\rm Evaluation)$</strong>çš„é€†è¿ç®—ã€‚æ’å€¼åŸºäºä»£æ•°åŸºæœ¬å®šç†ï¼š</p>
<blockquote>
<p>ç»™å®š $n+1$ ç»„ç¡®å®šçš„ã€æœ¬è´¨ä¸åŒçš„äºŒå…ƒç»„$(x_i, y_i)$ï¼Œæ»¡è¶³ $F(x_i) = y_i$ï¼Œå¯ä»¥é€†å‘æ±‚å‡ºåŸ $n$ æ¬¡å¤šé¡¹å¼ $F$ã€‚</p>
</blockquote>
<p>è€Œå…¶å®ï¼Œæ‹‰æ ¼æœ—æ—¥æ’å€¼å…¬å¼æœ¬èº«æ˜¯æ ‡å‡†çš„ $\Theta(n^2)$ ç®—æ³•ï¼š</p>
<script type="math/tex; mode=display">
</script><p>æˆ–è€…ä¸èƒ½ç§°å…¶ä¸ºç®—æ³•ï¼Œæ˜¯ $\Theta(n^2)$ çš„è¿ç®—è¿‡ç¨‹æˆ–è®¸ä¼šæ›´å‡†ç¡®ä¸€äº›ã€‚å®é™…ä¸Šè¯¥å…¬å¼æ˜¯æ„é€ å‡ºæ¥çš„ï¼Œæ‰€ä»¥æ²¡æœ‰å¤šä¹ˆç¹ççš„è¯æ˜â€”â€”</p>
<h2 id="rm-0x02-rm-Proof"><a href="#rm-0x02-rm-Proof" class="headerlink" title="$\rm{0x02}~~\rm{Proof}$"></a>$\rm{0x02}~~\rm{Proof}$</h2><h3 id="rm-Proof-of-Existence"><a href="#rm-Proof-of-Existence" class="headerlink" title="$\rm Proof ~of~Existence$"></a>$\rm Proof ~of~Existence$</h3><p>æˆ‘ä»¬å®šä¹‰ $F(x)$ ä¸ºä¸€åœ¨å®æ•°åŸŸä¸Šçš„ $n-1$ æ¬¡å¤šé¡¹å¼ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªå¯¹äºç¬¬ $i$ ä¸ªäºŒå…ƒç»„çš„ç‰¹æ®Šå¤šé¡¹å¼ $L_i(x)$ï¼Œæ»¡è¶³</p>
<script type="math/tex; mode=display">
L_i(x_j) = \begin{cases}1, &\rm{i=j} \newline 0, & \rm{i \neq j}\end{cases}</script><p>é‚£ä¹ˆæˆ‘ä»¬æ‰€æ±‚çš„å¤šé¡¹å¼ $F(x)$ å°±å¯ä»¥è¿™ä¹ˆè®¡ç®—å‡ºæ¥ï¼š</p>
<script type="math/tex; mode=display">
F(x)  = \sum L_i(x_i)\cdot y_i</script><p>è¿™ä¸ªå¼å­ä¿è¯äº†æˆ‘ä»¬å¯¹åº”çš„ $n$ ä¸ªäºŒå…ƒç»„ï¼Œ$F(x)=y$ æ’æˆç«‹ã€‚</p>
<p>é‚£ä¹ˆå¯¹äº$L_i(x)$ï¼Œæˆ‘ä»¬è€ƒè™‘ç”±æˆ‘ä»¬å¯¹$L_i(x)$çš„å®šä¹‰å¯ä»¥å¾—å‡º<script type="math/tex">L_i(x) = k_i(x-x_1)(x-x_2)\cdots(x-x_n)</script>å…¶ä¸­ä¸åŒ…å«$x-x_i$è¿™ä¸€å› å¼ã€‚è€Œç”±$L_i(x_i)=1$å¯çŸ¥æˆ‘ä»¬çš„æ¯”ä¾‹ç³»æ•°</p>
<script type="math/tex; mode=display">
k_i=\frac{1}{(x_i-x_1)(x_i-x_2)\cdots(x_i - x_{i-1})(x_i - x_{i+1})\cdots(x_i-x_n)}</script><p>é‚£ä¹ˆ</p>
<script type="math/tex; mode=display">
L_i(x) = \prod\limits_{i=1, i \neq j}^{n}\frac{x - x_j}{x_i-x_j}</script><p>ä»è€Œ</p>
<script type="math/tex; mode=display">
F(x)=\sum L_i(x)\cdot y_i(x) = \sum y_i \cdot \prod\limits_{i=1, i \neq j}^{n}\frac{x - x_j}{x_i-x_j}</script><hr>
<h3 id="rm-Proof-of-Uniqueness-1"><a href="#rm-Proof-of-Uniqueness-1" class="headerlink" title="$\rm Proof~of~Uniqueness^{[1]}$"></a>$\rm Proof~of~Uniqueness^{[1]}$</h3><p>æ¥ä¸‹æ¥è¦è¯æ˜çš„æ˜¯å¤šé¡¹å¼ $L_i(x)$  çš„å”¯ä¸€æ€§</p>
<p>å‡è®¾åŒæ—¶æœ‰ä¸¤ä¸ªå®æ•°åŸŸä¸Šçš„ $n-1$ æ¬¡å¤šé¡¹å¼ $L_1(x),L_2(x)$ æ»¡è¶³ </p>
<script type="math/tex; mode=display">
L_i(x_j) = \begin{cases}1, &\rm{i=j} \\ 0, & \rm{i \neq j}\end{cases}</script><p>é‚£ä¹ˆæˆ‘ä»¬ç”±ä½œå·®æ³•å¯ä»¥å¾—å‡ºå¤šé¡¹å¼ $L_{\Delta} = L_1 - L_2$ åœ¨å–æ‰€æœ‰çš„ $x_i$ æ—¶ï¼Œå…¶å€¼å‡ä¸º $0$ ã€‚é‚£ä¹ˆä¸€å®šä¼šæœ‰å¤šé¡¹å¼</p>
<script type="math/tex; mode=display">
L'(x) = \prod\limits_{i=1}^{n}(x - x_i)</script><p>æ»¡è¶³</p>
<script type="math/tex; mode=display">
L'|L_{\Delta}</script><p>å…¶ä¸­ $|$ è¡¨ç¤ºå¤šé¡¹å¼æ•´é™¤ã€‚ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äº $Lâ€™$ è¿™ä¸ªå¤šé¡¹å¼ï¼Œå…¶æ¬¡æ•°ä¸º $n$ ï¼›è€Œå¯¹äºæˆ‘ä»¬æ‰€å®šä¹‰çš„ $L_i(x)$ ï¼Œå‡ä¸º $n-1$ æ¬¡çš„ï¼Œä»è€Œ $L_{\Delta}$ ä¹Ÿæ˜¯ $n-1$ æ¬¡å¤šé¡¹å¼ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡º</p>
<script type="math/tex; mode=display">
L_{\Delta} = 0</script><p>ä»è€Œæœ‰</p>
<script type="math/tex; mode=display">
L_1=L_2</script><h2 id="rm-0x03-color-red-C-color-cyan-o-color-gold-d-color-green-e"><a href="#rm-0x03-color-red-C-color-cyan-o-color-gold-d-color-green-e" class="headerlink" title="$\rm{0x03~\color{red}{C}\color{cyan}{o}\color{gold}{d}\color{green}{e}}$"></a>$\rm{0x03~\color{red}{C}\color{cyan}{o}\color{gold}{d}\color{green}{e}}$</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é¢˜å·ï¼šLuogu4781</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 2020</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; LL Ans, xs ;</span><br><span class="line"><span class="keyword">int</span> N, i, j ; LL T, t, xv[MAXN], yv[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL A, LL B)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (B)&#123;</span><br><span class="line">        <span class="keyword">if</span> (B &amp; <span class="number">1</span>) (res *= A) %= Mod ; </span><br><span class="line">        B &gt;&gt;= <span class="number">1</span>, (A *= A) %= Mod ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;xv[i], &amp;yv[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        t = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i == j) <span class="keyword">continue</span> ;</span><br><span class="line">            (t *= (xv[i] - xv[j] + Mod)) %= Mod ;</span><br><span class="line">        &#125;</span><br><span class="line">        t = expow(t, Mod - <span class="number">2</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i == j) <span class="keyword">continue</span> ;</span><br><span class="line">            (t *= (T - xv[j] + Mod)) %= Mod ;</span><br><span class="line">        &#125;</span><br><span class="line">        (t *= yv[i]) %= Mod, (Ans += t) %= Mod ;</span><br><span class="line"><span class="comment">//		cout &lt;&lt; Ans &lt;&lt; endl ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, Ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x04-ä¸€é“æ°´é¢˜"><a href="#0x04-ä¸€é“æ°´é¢˜" class="headerlink" title="$0x04$ ä¸€é“æ°´é¢˜"></a>$0x04$ ä¸€é“æ°´é¢˜</h2><p>é¢˜æ„å¤§æ¦‚å°±æ˜¯ç»™å‡ºè¿ç»­çš„ä¸€æ®µ $x_0$ å’Œ $y_0$ ï¼Œç®—å‡ºå¤šé¡¹å¼ $F(x)$ åœ¨ä¸€ä¸ªç‰¹å®šå€¼ $x_0â€™$ æ—¶çš„å€¼ã€‚</p>
<p>æ³¨æ„åˆ° $40 \%$ çš„æ•°æ®å¯ä»¥ç›´æ¥é«˜æ¶ˆï¼Œåˆ—å‡º $n+1$ ä¸ªæ–¹ç¨‹ã€‚åŒæ—¶è¿˜å¯ä»¥ç”¨æœ´ç´ çš„æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•æ’å‡º $80pts$ çš„å¥½æˆç»©ã€‚è€Œå¯¹äº $100 \%$ çš„æ•°æ®ï¼Œ$n$ æ˜¯ $1e5$ çº§åˆ«çš„ï¼Œæ‰€ä»¥è€ƒè™‘é¢„å¤„ç†å‡ºä¸€äº›ä¸œè¥¿ã€‚</p>
<p>è§‚å¯Ÿæ‹‰æ ¼æœ—æ—¥æ’å€¼å…¬å¼çš„ä¸€èˆ¬å½¢å¼ï¼š</p>
<script type="math/tex; mode=display">
F(x) = \sum \limits _{i=0}^{N} y_i \cdot \prod \limits_{i \neq j} \frac{x -x_j}{x_i-x_j}</script><p>æˆ‘ä»¬å‘ç°é¦–å…ˆåˆ†å­å¯ä»¥ $O(n)$ é¢„å¤„ç†ï¼Œè€Œåˆ†æ¯ç”±äº $x_j$ æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥</p>
<script type="math/tex; mode=display">
{\prod \limits _{i \neq j} (x_i  - x_j)}= \rm fac(i) \cdot fac(n-i) \cdot evenmark(n-i)</script><p>å…¶ä¸­$\rm fac$è¡¨ç¤ºæ±‚é˜¶ä¹˜ï¼Œ$\rm{evenmark}(x)$ æ˜¯ç¬¦å·å‡½æ•°ï¼Œå½“ $x$ æ˜¯å¶æ•°æ—¶è¿”å› $1$ï¼Œå¦åˆ™è¿”å› $-1$ ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥å¾—å‡ºä¸€ä¸ªå¼å­ï¼š</p>
<script type="math/tex; mode=display">
F(x) = \sum \limits_{i=0}^{n}{y_i \cdot}\frac{\frac{Pre}{x-x_i}}{\rm fac(i) \cdot fac(n-i) \cdot evenmark(n-i)}</script><p>å…¶ä¸­ $\frac{Pre}{x-x_i}$ çš„ç¼˜ç”±æ˜¯åˆ†æ¯ä¸Šæ²¡æœ‰ $x-x_i$ è¿™ä¸€é¡¹ã€‚</p>
<p>å–æ¨¡å•¥çš„å°±å°è´¹é©¬æä¸€æå³å¯ï¼Œæœ€ç»ˆå¤æ‚åº¦ $\Theta(n \log n)$ .</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL A, LL B)</span></span>&#123;</span><br><span class="line">	LL res = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">while</span> (B)&#123;</span><br><span class="line">		<span class="keyword">if</span> (B &amp; <span class="number">1</span>) (res *= A) %= Mod ; </span><br><span class="line">		B &gt;&gt;= <span class="number">1</span>, (A *= A) %= Mod ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res % Mod ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">get_symbol</span><span class="params">(LL x)</span></span>&#123; <span class="keyword">return</span> (!x ? <span class="number">1</span> : Mod - <span class="number">1</span>) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N ; Fac[<span class="number">0</span>] = qwq = <span class="number">1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i]), (Fac[i + <span class="number">1</span>] = Fac[i] * (i + <span class="number">1</span>)) %= Mod ;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T ; Ans = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">if</span> (T &lt;= N) <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, base[T]) ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) (qwq *= (T - i + Mod)) %= Mod ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">		M = (N - i) &amp; <span class="number">1</span>, _qwq = qwq * expow((T - i), Mod - <span class="number">2</span>) % Mod ;</span><br><span class="line">		t = expow(Fac[i] * Fac[N - i] % Mod, Mod - <span class="number">2</span>) % Mod ; </span><br><span class="line">		t = t * (get_symbol(M) * _qwq % Mod) % Mod, t = (t * base[i]) % Mod ;</span><br><span class="line">		(Ans += t)  %= Mod ;</span><br><span class="line"><span class="comment">//		cout &lt;&lt; Ans &lt;&lt; endl ;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, Ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$\rm{Reference}$"></a>$\rm{Reference}$</h2><ul>
<li>$[1] $:Angel_Kittyçš„$blog$ã€Šæ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•ã€‹ <a href="https://www.cnblogs.com/ECJTUACM-873284962/p/6833391.html" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å¤šé¡¹å¼</category>
      </categories>
      <tags>
        <tag>å¤šé¡¹å¼åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€æ‘¸é±¼ç¬”è®°ã€‘ç¾¤è®ºå…¥é—¨</title>
    <url>/2019/02/06/%E7%BE%A4%E8%AE%BA%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>â‘§è¯´åˆ«çš„äº†ï¼ŒæŠ½ä»£èµ›é«˜ï¼</p>
<a id="more"></a>
<h1 id="ç¾¤"><a href="#ç¾¤" class="headerlink" title="ç¾¤"></a>ç¾¤</h1><h2 id="1-ç¾¤çš„å®šä¹‰"><a href="#1-ç¾¤çš„å®šä¹‰" class="headerlink" title="$1~)~$ç¾¤çš„å®šä¹‰"></a>$1~)~$ç¾¤çš„å®šä¹‰</h2><p>æ¯”è¾ƒç®€å•çš„æ¥è®²ï¼Œæ‰€è°“<strong>ç¾¤$(\rm{group})$</strong>æŒ‡çš„æ˜¯ä¸€ç±»ç‰¹æ®Šçš„é›†åˆï¼Œè¿™ä¸ªé›†åˆåŒ…å«ä¸€ç»„å…ƒç´ å’Œå¤§äºç­‰äºä¸€ä¸ªçš„è¿ç®—ï¼Œæ¯”å¦‚ä¹˜æ³•ç¾¤æ•‘è®°ä½œ$(G,\cdot)$ã€‚é‚£ä¹ˆå¹³å‡¡æ¥è®²ï¼Œç¾¤æ»¡è¶³ä¸‹åˆ—å‡ ä¸ªæ€§è´¨ï¼š</p>
<p>æˆ‘ä»¬å‡å®šä¸€ä¸ªå¹³å‡¡çš„ç¾¤$G$æ”¯æŒ$\color{purple}{qwq}$è¿™ç§è¿ç®—ï¼š</p>
<h4 id="Property1-å°é—­æ€§-forall-a-in-G-b-in-G-a-color-purple-qwq-b-in-G"><a href="#Property1-å°é—­æ€§-forall-a-in-G-b-in-G-a-color-purple-qwq-b-in-G" class="headerlink" title="$Property1~~$å°é—­æ€§$\forall a\in G, b\in G, a~\color{purple}{qwq}~b \in G$"></a>$Property1~~$å°é—­æ€§$\forall a\in G, b\in G, a~\color{purple}{qwq}~b \in G$</h4><h4 id="Property2-è¿ç®—çš„ç»“åˆæ€§-a-color-purple-qwq-b-color-purple-qwq-c-a-color-purple-qwq-b-qwq-c"><a href="#Property2-è¿ç®—çš„ç»“åˆæ€§-a-color-purple-qwq-b-color-purple-qwq-c-a-color-purple-qwq-b-qwq-c" class="headerlink" title="$Property2~~$è¿ç®—çš„ç»“åˆæ€§$(a~\color{purple}{qwq}~b) ~\color{purple}{qwq}~ c=a~\color{purple}{qwq}~ (b ~qwq~ c)$"></a>$Property2~~$è¿ç®—çš„ç»“åˆæ€§$(a~\color{purple}{qwq}~b) ~\color{purple}{qwq}~ c=a~\color{purple}{qwq}~ (b ~qwq~ c)$</h4><h4 id="Property3-å­˜åœ¨å•ä½å…ƒï¼ˆå¹ºå…ƒï¼‰æ»¡è¶³ä»¥ä¸‹å®šä¹‰ï¼š-exists-e-in-G-s-t-forall-a-in-G-e-color-purple-qwq-a-a-color-purple-qwq-e-a"><a href="#Property3-å­˜åœ¨å•ä½å…ƒï¼ˆå¹ºå…ƒï¼‰æ»¡è¶³ä»¥ä¸‹å®šä¹‰ï¼š-exists-e-in-G-s-t-forall-a-in-G-e-color-purple-qwq-a-a-color-purple-qwq-e-a" class="headerlink" title="$Property3~~$å­˜åœ¨å•ä½å…ƒï¼ˆå¹ºå…ƒï¼‰æ»¡è¶³ä»¥ä¸‹å®šä¹‰ï¼š$\exists e\in G, s.t. \forall a\in G, e~\color{purple}{qwq}~ a=a~\color{purple}{qwq}~e=a$"></a>$Property3~~$å­˜åœ¨å•ä½å…ƒï¼ˆå¹ºå…ƒï¼‰æ»¡è¶³ä»¥ä¸‹å®šä¹‰ï¼š$\exists e\in G, s.t. \forall a\in G, e~\color{purple}{qwq}~ a=a~\color{purple}{qwq}~e=a$</h4><h4 id="Property4-å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œå­˜åœ¨é€†å…ƒï¼Œå³æ»¡è¶³-forall-a-in-G-exists-b-in-G-s-t-a-color-purple-qwq-b-b-color-purple-qwq-a-e"><a href="#Property4-å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œå­˜åœ¨é€†å…ƒï¼Œå³æ»¡è¶³-forall-a-in-G-exists-b-in-G-s-t-a-color-purple-qwq-b-b-color-purple-qwq-a-e" class="headerlink" title="$Property4~~$å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œå­˜åœ¨é€†å…ƒï¼Œå³æ»¡è¶³ $\forall a\in G, \exists b\in G, s.t. a~\color{purple}{qwq}~ b=b~\color{purple}{qwq}~a=e$"></a>$Property4~~$å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œå­˜åœ¨é€†å…ƒï¼Œå³æ»¡è¶³ $\forall a\in G, \exists b\in G, s.t. a~\color{purple}{qwq}~ b=b~\color{purple}{qwq}~a=e$</h4><p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´çš„ç›´ç™½ç‚¹å§ï¼Œå¯¹æ‰€æœ‰çš„å…ƒç´ ï¼Œåšå®Œè¯¥ç¾¤æ‰€å¸¦æœ‰çš„<strong>å¸¦æœ‰ç»“åˆå¾‹çš„è¿ç®—</strong>ä¹‹åï¼Œæ‰€å¾—ç»“æœ<strong>ä»ç„¶å±äºè¯¥ç¾¤</strong>ä¸”ä¸€å®šå­˜åœ¨å•ä½å…ƒï¼Œå¯¹äºæ¯ä¸ªå…ƒç´ å­˜åœ¨è¿ç®—é€†å…ƒã€‚</p>
<p>é‚£æˆ‘ä»¬ä¸å¦¨å®šä¹‰ä¸€äº›å…¶ä»–çš„ï¼š</p>
<ul>
<li><h3 id="é˜¿è´å°”ç¾¤-Abel-Group-ï¼šå³äº¤æ¢ç¾¤â€”â€”è¿ç®—æ»¡è¶³äº¤æ¢å¾‹çš„ç¾¤ã€‚"><a href="#é˜¿è´å°”ç¾¤-Abel-Group-ï¼šå³äº¤æ¢ç¾¤â€”â€”è¿ç®—æ»¡è¶³äº¤æ¢å¾‹çš„ç¾¤ã€‚" class="headerlink" title="é˜¿è´å°”ç¾¤$(Abel~ Group)$ï¼šå³äº¤æ¢ç¾¤â€”â€”è¿ç®—æ»¡è¶³äº¤æ¢å¾‹çš„ç¾¤ã€‚"></a>é˜¿è´å°”ç¾¤$(Abel~ Group)$ï¼šå³äº¤æ¢ç¾¤â€”â€”è¿ç®—æ»¡è¶³äº¤æ¢å¾‹çš„ç¾¤ã€‚</h3></li>
<li><h3 id="åŠç¾¤ï¼šæ»¡è¶³å°é—­æ€§å’Œç»“åˆå¾‹çš„ç¾¤ã€‚"><a href="#åŠç¾¤ï¼šæ»¡è¶³å°é—­æ€§å’Œç»“åˆå¾‹çš„ç¾¤ã€‚" class="headerlink" title="åŠç¾¤ï¼šæ»¡è¶³å°é—­æ€§å’Œç»“åˆå¾‹çš„ç¾¤ã€‚"></a>åŠç¾¤ï¼šæ»¡è¶³å°é—­æ€§å’Œç»“åˆå¾‹çš„ç¾¤ã€‚</h3></li>
<li><h3 id="æœ‰é™ç¾¤-Finite-Group-ï¼šå…ƒç´ ä¸ªæ•°æœ‰é™çš„ç¾¤ç§°ä¸ºæœ‰é™ç¾¤-è€Œæœ‰é™ç¾¤çš„å…ƒç´ ä¸ªæ•°ç§°ä½œæœ‰é™ç¾¤çš„é˜¶"><a href="#æœ‰é™ç¾¤-Finite-Group-ï¼šå…ƒç´ ä¸ªæ•°æœ‰é™çš„ç¾¤ç§°ä¸ºæœ‰é™ç¾¤-è€Œæœ‰é™ç¾¤çš„å…ƒç´ ä¸ªæ•°ç§°ä½œæœ‰é™ç¾¤çš„é˜¶" class="headerlink" title="æœ‰é™ç¾¤$(Finite~Group)$ï¼šå…ƒç´ ä¸ªæ•°æœ‰é™çš„ç¾¤ç§°ä¸ºæœ‰é™ç¾¤,è€Œæœ‰é™ç¾¤çš„å…ƒç´ ä¸ªæ•°ç§°ä½œæœ‰é™ç¾¤çš„é˜¶"></a>æœ‰é™ç¾¤$(Finite~Group)$ï¼šå…ƒç´ ä¸ªæ•°æœ‰é™çš„ç¾¤ç§°ä¸ºæœ‰é™ç¾¤,è€Œæœ‰é™ç¾¤çš„å…ƒç´ ä¸ªæ•°ç§°ä½œæœ‰é™ç¾¤çš„é˜¶</h3></li>
</ul>
<p>ç»“åˆå‡ ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ï¼š</p>
<p>æ¯”å¦‚ä»¥ä¸‹æ˜¯å‡ ä¸ªä¹˜æ³•ç¾¤ <script type="math/tex">(Q\setminus\{0\}~,~\cdot)</script> <script type="math/tex">(R\setminus\{0\}~, ~\cdot)$$$$ (C\setminus\{0\}~,~\cdot)</script></p>
<p>ä»–ä»¬éƒ½ä¸èƒ½åŒ…æ‹¬$0$è¿™ä¸ªå…ƒç´ ï¼Œå› ä¸ºè¿™ä¸ªå…ƒç´ æ˜¾ç„¶æ˜¯æ²¡æœ‰é€†å…ƒçš„ã€‚</p>
<p>æˆ–è€…ä¸€ä¸ªå¥½ç©å„¿çš„ä¹˜æ³•ç¾¤<script type="math/tex">((1, -1)~~, ~~\cdot)</script>æˆ–è€…æ˜¯æ‰€æœ‰<strong>éå¥‡å¼‚çš„$n$é˜¶çŸ©é˜µ</strong>ä¹Ÿå¯ä»¥ç»„æˆä¸€ä¸ªä¹˜æ³•ç¾¤ã€‚</p>
<p>æˆ–è€…æ˜¯<script type="math/tex">(Z~,~+)</script>è¿™ä¸ªç¾¤æ¯”è¾ƒç»å…¸$233$ï¼Œå…¶ä¸­æˆ‘ä»¬å€ŸåŠ©è¿™ä¸ªæ¥ç»ƒä¹ ä¸€ä¸‹å¦‚ä½•åˆ¤æ–­<strong>æ˜¯å¦æˆç¾¤</strong>,é¦–å…ˆæ€è€ƒï¼Œè¿™ä¸ªä¸œè¥¿ä¸€å®šæ˜¯å°é—­çš„ï¼Œå› ä¸ºæœ€åä¼šæ”¶æ•›äº$\pm \inf$æ‰€ä»¥ä¸€å®šå°é—­ï¼Œå…¶æ¬¡è¿ç®—æ˜¯ä¸€å®šç¬¦åˆç»“åˆå¾‹çš„ï¼Œç„¶åå•ä½å…ƒè‚¯å®šå°±æ˜¯$0$ï¼Œæœ€åé€†å…ƒçš„è¯ï¼Œå¯¹äº$n$é‚£å°±ä¸€å®šæ˜¯$-n$äº†ï¼ˆç´§æ‰£å®šä¹‰å³å¯ï¼‰ã€‚</p>
<hr>
<p>$Extra   Things :$</p>
<p>ä»¥ä¸‹æ˜¯ä¸¤ç§å¤åˆæŠ½ä»£æ•°æ®ç»“æ„ï¼ˆåå­—è‡ªå·±èµ·çš„$233$ï¼‰ï¼š</p>
<h3 id="ç¯ï¼šå®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ-G-cdot-å…¶ä¸­-G-æ˜¯é˜¿è´å°”ç¾¤ï¼Œ-G-cdot-æ˜¯åŠç¾¤"><a href="#ç¯ï¼šå®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ-G-cdot-å…¶ä¸­-G-æ˜¯é˜¿è´å°”ç¾¤ï¼Œ-G-cdot-æ˜¯åŠç¾¤" class="headerlink" title="ç¯ï¼šå®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ$(G,+,\cdot)$å…¶ä¸­$(G,+)$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$(G,\cdot)$æ˜¯åŠç¾¤"></a>ç¯ï¼šå®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ$(G,+,\cdot)$å…¶ä¸­$(G,+)$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$(G,\cdot)$æ˜¯åŠç¾¤</h3><p>ä¸¾ä¾‹å­ï¼š$Z$, $R[x]$ï¼Œå³æ•´æ•°ç¯å’Œ$R$ä¸Šçš„æ‰€æœ‰å¤šé¡¹å¼çš„é›†åˆã€‚</p>
<h3 id="åŸŸï¼šåŒæ ·å®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ-F-cdot-å…¶ä¸­-F-æ˜¯é˜¿è´å°”ç¾¤ï¼Œ-F-setminus-0-cdot-æ˜¯é˜¿è´å°”ç¾¤"><a href="#åŸŸï¼šåŒæ ·å®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ-F-cdot-å…¶ä¸­-F-æ˜¯é˜¿è´å°”ç¾¤ï¼Œ-F-setminus-0-cdot-æ˜¯é˜¿è´å°”ç¾¤" class="headerlink" title="åŸŸï¼šåŒæ ·å®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ$(F,+,\cdot)$å…¶ä¸­$(F,+)$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$(F\setminus\{0\},\cdot)$æ˜¯é˜¿è´å°”ç¾¤"></a>åŸŸï¼šåŒæ ·å®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ$(F,+,\cdot)$å…¶ä¸­$(F,+)$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$(F\setminus\{0\},\cdot)$æ˜¯é˜¿è´å°”ç¾¤</h3><p>ä¸¾ä¾‹å­ ï¼š$Q,R,C$å³æœ‰ç†æ•°åŸŸã€å®æ•°åŸŸå’Œå¤æ•°åŸŸã€‚</p>
<hr>
<p>å¥½çš„ï¼Œé‚£æˆ‘ä»¬å°è¯•è¯æ˜ä¸¤ä¸ªå‘½é¢˜ï¼š</p>
<h3 id="Proposition1-ä¸€ä¸ªç¾¤ä¸­çš„å•ä½å…ƒå”¯ä¸€"><a href="#Proposition1-ä¸€ä¸ªç¾¤ä¸­çš„å•ä½å…ƒå”¯ä¸€" class="headerlink" title="$Proposition1~~~~$ä¸€ä¸ªç¾¤ä¸­çš„å•ä½å…ƒå”¯ä¸€"></a>$Proposition1~~~~$ä¸€ä¸ªç¾¤ä¸­çš„å•ä½å…ƒå”¯ä¸€</h3><p>è®¾æœ‰ä¸¤ä¸ªå•ä½å…ƒ$e_1,e_2$</p>
<p>é‚£ä¹ˆ$e_1=e_1e_2=e_2$ï¼Œå…¶å®æ˜¯ä¸€ä¸ª$233$</p>
<h3 id="Proposition2-ç¾¤ä¸­å…ƒç´ çš„é€†å…ƒå”¯ä¸€"><a href="#Proposition2-ç¾¤ä¸­å…ƒç´ çš„é€†å…ƒå”¯ä¸€" class="headerlink" title="$Proposition2~~~~$ç¾¤ä¸­å…ƒç´ çš„é€†å…ƒå”¯ä¸€"></a>$Proposition2~~~~$ç¾¤ä¸­å…ƒç´ çš„é€†å…ƒå”¯ä¸€</h3><p>ä»¥ä¹˜æ³•ç¾¤ä¸ºä¾‹ï¼Œå‡è®¾$a$æœ‰ä¸¤ä¸ªé€†å…ƒ$b,c$ï¼Œé‚£ä¹ˆä¸€å®šä¼šæœ‰<script type="math/tex">b = b \cdot(a \cdot c) = (b \cdot a) \cdot c = c</script></p>
<p>æ˜¾ç„¶ä¹Ÿæ˜¯åŒä¸€ä¸ªã€‚</p>
<p>é‚£ä¹ˆæ­¤æ—¶æˆ‘æ‰“ç®—æ•´ç†ä¸€ä¸ªç¾¤çš„å…±æ€§ç‰¹å¾ï¼š</p>
<script type="math/tex; mode=display">(ab)^{-1}=b^{-1}a^{-1}</script><p>å¾ˆæ˜¾ç„¶ï¼Œè¯æ˜å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">ab(b^{-1}a^{-1})=b^{-1}a^{-1})ab=e</script><p>æè¿™ä¸ªçš„ç›®çš„å°±æ˜¯ï¼Œæˆ‘ä»¬å‘ç°åœ¨çŸ©é˜µçš„ç›¸å…³å†…å®¹é‡Œé¢ä¹Ÿæœ‰è¿™ä»¶äº‹å„¿~æ‰€ä»¥å°±å¾ˆå¼€å¿ƒ</p>
<p>é‚£ä¹ˆä¹‹åæˆ‘ä»¬è®¨è®º<strong>å‘¨æœŸ</strong></p>
<p>å¯¹äºä¸€ä¸ªå…ƒç´ $a \in G$è€Œè¨€ï¼Œæˆ‘ä»¬è®°$a$çš„å‘¨æœŸæ˜¯$o(a)$</p>
<p>$o(a)$è¡¨ç¤ºæœ€å°æ­£æ•´æ•°ï¼Œä½¿å¾—$a^{o(a)}=e$</p>
<hr>
<h2 id="2-å­ç¾¤åŠè¡ç”Ÿ"><a href="#2-å­ç¾¤åŠè¡ç”Ÿ" class="headerlink" title="$2~)~$å­ç¾¤åŠè¡ç”Ÿ"></a>$2~)~$å­ç¾¤åŠè¡ç”Ÿ</h2><p>æœ¬èŠ‚æ‰€æŒ‡<strong>â€œç¾¤â€</strong>æ²¡æœ‰ç‰¹åˆ«è¯´æ˜ä¾¿å‡ä¸º<strong>æœ‰é™ç¾¤</strong></p>
<p>ä¸å¦¨å…ˆç»™å‡ºå­ç¾¤çš„æµ…æ˜¾ç‰ˆå®šä¹‰ï¼š</p>
<h3 id="å¦‚æœå¯¹äºä¸€ä¸ªç¾¤-G-C-ï¼Œå…¶ä¸­-H-subseteq-G-ï¼Œä¸”-H-C-æ˜¯ç¾¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°åœ¨è¿ç®—-C-ä¸‹ï¼Œ-H-æ˜¯-G-çš„å­ç¾¤ï¼Œç”¨-H-leq-G-è¡¨ç¤º"><a href="#å¦‚æœå¯¹äºä¸€ä¸ªç¾¤-G-C-ï¼Œå…¶ä¸­-H-subseteq-G-ï¼Œä¸”-H-C-æ˜¯ç¾¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°åœ¨è¿ç®—-C-ä¸‹ï¼Œ-H-æ˜¯-G-çš„å­ç¾¤ï¼Œç”¨-H-leq-G-è¡¨ç¤º" class="headerlink" title="å¦‚æœå¯¹äºä¸€ä¸ªç¾¤$(G, C)$ ï¼Œå…¶ä¸­$H\subseteq G$,ï¼Œä¸” $(H,C)$æ˜¯ç¾¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°åœ¨è¿ç®—$C$ä¸‹ï¼Œ$H$æ˜¯$G$çš„å­ç¾¤ï¼Œç”¨$H\leq G$è¡¨ç¤º"></a>å¦‚æœå¯¹äºä¸€ä¸ªç¾¤$(G, C)$ ï¼Œå…¶ä¸­$H\subseteq G$,ï¼Œä¸” $(H,C)$æ˜¯ç¾¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°åœ¨è¿ç®—$C$ä¸‹ï¼Œ$H$æ˜¯$G$çš„å­ç¾¤ï¼Œç”¨$H\leq G$è¡¨ç¤º</h3><p>é‚£ä¹ˆä»è€Œæˆ‘ä»¬å¯ä»¥å®šä¹‰<strong>ç”Ÿæˆå­ç¾¤</strong>è¿™ä¸ªä¸œè¥¿ï¼š</p>
<p><strong>ç”Ÿæˆå­ç¾¤ï¼šè‹¥$S \subseteq G$ï¼Œ å¹¶ä¸”å¯¹äºè¿ç®—$C$è€Œè¨€ï¼Œ$(G,C)$ä¹Ÿæ˜¯ä¸€ä¸ªç¾¤ï¼Œé‚£ä¹ˆå°±ç§°$G$ä¸ºé›†åˆ$S$åœ¨è¿ç®—$C$ä¸‹çš„ç”Ÿæˆå­ç¾¤ã€‚é›†åˆ$S$çš„ç”Ÿæˆå­ç¾¤ç”¨$&lt;<script type="math/tex">S</script>&gt;$è¡¨ç¤º</strong></p>
<p>è¿™ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å®šä¹‰<strong>é™ªé›†</strong>è¿™ä¸ªæ¦‚å¿µ</p>
<p>é™ªé›†ä¸€èˆ¬ä¸ŠåŒ…å«<strong>å·¦é™ªé›†</strong>å’Œ<strong>å³é™ªé›†</strong>ã€‚</p>
<h3 id="å·¦é™ªé›†ï¼šå¦‚æœ-H-leq-G-ï¼Œå¯¹äº-a-in-G-ï¼Œå®šä¹‰é›†åˆ-H-a-x-in-G-exists-h-in-H-ah-x-ä¸º-H-çš„ä¸å…ƒç´ -a-å·¦é™ªé›†ã€‚"><a href="#å·¦é™ªé›†ï¼šå¦‚æœ-H-leq-G-ï¼Œå¯¹äº-a-in-G-ï¼Œå®šä¹‰é›†åˆ-H-a-x-in-G-exists-h-in-H-ah-x-ä¸º-H-çš„ä¸å…ƒç´ -a-å·¦é™ªé›†ã€‚" class="headerlink" title="å·¦é™ªé›†ï¼šå¦‚æœ$H \leq G$ï¼Œå¯¹äº$a \in G$ï¼Œå®šä¹‰é›†åˆ$H_a = \{x\in G~|~ \exists h\in H, ah=x\}$ä¸º$H$çš„ä¸å…ƒç´ $a$å·¦é™ªé›†ã€‚"></a>å·¦é™ªé›†ï¼šå¦‚æœ$H \leq G$ï¼Œå¯¹äº$a \in G$ï¼Œå®šä¹‰é›†åˆ$H_a = \{x\in G~|~ \exists h\in H, ah=x\}$ä¸º$H$çš„ä¸å…ƒç´ $a$å·¦é™ªé›†ã€‚</h3><h3 id="å³é™ªé›†ï¼š-å¦‚æœ-H-leq-G-ï¼Œå¯¹äº-a-in-G-ï¼Œå®šä¹‰é›†åˆ-H-a-x-in-G-exists-h-in-H-ha-x-ä¸º-H-çš„å³é™ªé›†ã€‚"><a href="#å³é™ªé›†ï¼š-å¦‚æœ-H-leq-G-ï¼Œå¯¹äº-a-in-G-ï¼Œå®šä¹‰é›†åˆ-H-a-x-in-G-exists-h-in-H-ha-x-ä¸º-H-çš„å³é™ªé›†ã€‚" class="headerlink" title="å³é™ªé›†ï¼š å¦‚æœ$H \leq G$ï¼Œå¯¹äº$a \in G$ï¼Œå®šä¹‰é›†åˆ$H_a = \{x\in G~|~ \exists h\in H, ha=x\}$ä¸º$H$çš„å³é™ªé›†ã€‚"></a>å³é™ªé›†ï¼š å¦‚æœ$H \leq G$ï¼Œå¯¹äº$a \in G$ï¼Œå®šä¹‰é›†åˆ$H_a = \{x\in G~|~ \exists h\in H, ha=x\}$ä¸º$H$çš„å³é™ªé›†ã€‚</h3><p>$233$ä¹Ÿå¯ä»¥å«åš<strong>å‚é›†</strong>æˆ–è€…<strong>æ—ç³»</strong>ä¹‹ç±»çš„~</p>
<p>é‚£ä¹ˆæˆ‘ä»¬è¿™ä¸ªåœ°æ–¹å…ˆåªç ”ç©¶å³é™ªé›†$233$</p>
<h4 id="Lemma1"><a href="#Lemma1" class="headerlink" title="$Lemma1:$"></a>$Lemma1:$</h4><p>æˆ‘ä»¬é¦–å…ˆè¯æ˜ä¸€ç‚¹ï¼š$|H|=|H_a|$ï¼Œå…¶ä¸­é•¿å¾—åƒç»å¯¹å€¼ç¬¦å·çš„ç«–çº¿è¡¨ç¤ºçš„æ˜¯æœ‰é™ç¾¤çš„<strong>ç¾¤ä¸­å…ƒç´ æ•°é‡</strong>ã€‚ </p>
<p>è¿™ä¸ªå…¶å®æ¯”è¾ƒæ˜¾ç„¶ï¼Œå› ä¸ºäº‹å®ä¸Šç¾¤éƒ½æ˜¯å®šä¹‰åœ¨<strong>éå¯é‡é›†</strong>ä¸Šé¢çš„ã€‚</p>
<p>è¾ƒä¸ºä¸¥è°¨çš„è¯æ˜å¦‚ä¸‹ï¼š</p>
<hr>
<p>$Proof.$</p>
<p>å¯¹äº$H \leq G$ï¼Œå¦‚æœ$h_1\neq h_2 \in H$ï¼Œé‚£ä¹ˆ$h_1a\neq h_2a$</p>
<p>åè¯ï¼šè‹¥$h_1a=h_2a$ï¼Œ$h_1aa^{-1}=h_2aa^{-1},~h_1=h_2$çŸ›ç›¾</p>
<p>å¯¹äºä¸åŒçš„$h$ï¼Œ$ha$äº’ä¸ç›¸åŒï¼Œå› æ­¤$|H_a|=|H|$</p>
<hr>
<h4 id="Lemma2"><a href="#Lemma2" class="headerlink" title="$Lemma2:$"></a>$Lemma2:$</h4><p>ä¹‹åæˆ‘ä»¬å†è¯æ˜ä¸€äº›å¥½ç©å„¿çš„ï¼š</p>
<p>å‘½é¢˜ï¼š$H_a=H_b$å½“ä¸”ä»…å½“$ab^{-1}\in H$ </p>
<p>çœ‹èµ·æ¥å¥½åƒä¸æ˜¯é‚£ä¹ˆå¥½ç©â€¦â€¦</p>
<hr>
<p>$Proof.$</p>
<p>è‹¥$H_a=H_b$ï¼Œåˆ™$ea\in H_a$ï¼Œå³$a\in H_b$ï¼Œé‚£ä¹ˆ$\exists h\in H,~a=hb$,é‚£ä¹ˆ$ab^{-1}=h$</p>
<p>è‹¥$ab^{-1}\in H$ï¼Œé‚£ä¹ˆ$ha=ha(b^{-1}b)=(hab^{-1})b\in Hb$ï¼Œå› æ­¤$H_a\subseteq H_b$</p>
<p>$hb=hb(a^{-1}a)=h(ab^{-1})^{-1}a\in H_a$ï¼Œæ•…$H_b\subseteq H_a$</p>
<p>å› æ­¤$H_a=H_b$</p>
<hr>
<p>é‚£ä¹ˆæˆ‘ä»¬è¿˜å¯ä»¥æœ‰ä¸€ä¸ªæ¨è®ºï¼š</p>
<p>è‹¥$H_a\neq H_b$ï¼Œé‚£ä¹ˆ$H_a\cap H_b = \emptyset$</p>
<hr>
<p>$Proof.$</p>
<p>å‡è®¾$x\in H_a\cap H_b$ï¼Œ åˆ™$\exists h_1,h_2\in H$ï¼Œ$h_1a=h_2b=x$ ï¼Œ é‚£ä¹ˆ$ab^{-1}=h_1^{-1}h_2\in H$ï¼Œé‚£ä¹ˆ$H_a=H_b$ï¼ŒçŸ›ç›¾</p>
<hr>
<p>ä»è€Œè¿˜å¯ä»¥æœ‰ä¸ªå®šç†ï¼ˆ$Lagrange$å®šç†ï¼‰ï¼š</p>
<p>ç”±äº$\forall g\in G$ï¼Œ $g\in Hg$ï¼Œæ‰€ä»¥$G$ä¸­æ¯ä¸ªå…ƒç´ éƒ½åœ¨æŸä¸ªå‚é›†ä¸­ã€‚ç”¨$[G:H]$è¡¨ç¤ºä¸åŒçš„å‚é›†æ•°ï¼Œé‚£ä¹ˆ</p>
<script type="math/tex; mode=display">|G|=|H|\cdot [G:H]</script><p>ä¹Ÿå°±æ˜¯è¯´$|H|$æ˜¯$|G|$çš„çº¦æ•°ã€‚</p>
<p>è¿™ä¸ªå…¶å®å¾ˆæ˜¾ç„¶ï¼Œå› ä¸ºä¸åŒå…ƒç´ çš„å‚é›†å¦‚æœä¸åŒå°±ä¸ä¼šæœ‰äº¤é›†ï¼Œå¦‚æœç›¸åŒå°±ä¸ä¼šè¢«è€ƒè™‘åˆ°$[G:H]$é‡Œé¢ã€‚æ‰€ä»¥ç»“è®ºå¹³å‡¡ã€‚</p>
<p>ä½†æ˜¯å…¶å®è¿™æ˜¯ä¸ªå¾ˆä¼Ÿå¤§çš„å®šç†$233$ </p>
<hr>
<p>å¥½çš„ï¼Œé‚£ä¹ˆä»è€Œå°±ä¼šæœ‰ä¸€äº›ç¥å¥‡çš„æ¨è®ºï¼š</p>
<p><strong>æ¨è®ºä¸€ ï¼š å¯¹äºä¸€ä¸ªå…ƒç´ $a \in G$ï¼Œ$G$æ˜¯ä¸€ä¸ªç¾¤ï¼Œé‚£ä¹ˆ$o(a) | |G|$ </strong></p>
<p><strong>$Proof.$</strong> å› ä¸º$o(a) = |<script type="math/tex"><</script>a<script type="math/tex">></script>|$ï¼Œç”±æˆ‘ä»¬åˆšåˆšè¯æ˜çš„å®šç†å¯ä»¥å¾—å‡º$o(a) | |G|$ </p>
<p><strong>æ¨è®ºäºŒï¼šå¯¹ä»»æ„çš„$a \in G,a ^{|G|} = e$</strong></p>
<p>$Proof.$ æ¯”è¾ƒæ˜¾ç„¶ï¼Œç”±æ¨è®ºä¸€å¯çŸ¥ã€‚</p>
<p><strong>æ¨è®ºä¸‰ï¼šè‹¥$|G|$ä¸ºç´ æ•°ï¼Œåˆ™$G$æ˜¯å¾ªç¯ç¾¤</strong></p>
<p>$Proof.$ è‹¥$a \neq e$ï¼Œé‚£ä¹ˆä¼šæœ‰$|<script type="math/tex"><</script>a<script type="math/tex">></script>|$æ•´é™¤$|G|$ã€‚è€Œç”±äº$|G|$æ˜¯ä¸ªç´ æ•°ï¼Œæ‰€ä»¥åªæœ‰å¯èƒ½$|G| = |<script type="math/tex"><</script>a<script type="math/tex">></script>|$ ï¼Œæ‰€ä»¥$G$æ˜¯ä¸ªå¾ªç¯ç¾¤ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœŸçš„è¦å»åšäº›å¥½ç©çš„äº†~</p>
<hr>
<h3 id="å®šç†-1-Â·-Fermat-å°å®šç†"><a href="#å®šç†-1-Â·-Fermat-å°å®šç†" class="headerlink" title="å®šç†$1$Â·$Fermat$å°å®šç†"></a>å®šç†$1$Â·$Fermat$å°å®šç†</h3><p>å¦‚æœ$p$ä¸ºç´ æ•°ï¼Œé‚£ä¹ˆå­˜åœ¨$a^{p-1} \equiv 1 (\mod p) $</p>
<h3 id="Proof"><a href="#Proof" class="headerlink" title="$Proof. $"></a>$Proof. $</h3><p>è€ƒè™‘è´¨æ•°$p$ï¼Œè€ƒè™‘ç¾¤$G=${$1,2,\dots,p-1$}ï¼Œç¾¤çš„è¿ç®—å®šä¹‰ä¸ºå¯¹$p$å–æ¨¡çš„ä¹˜æ³•ï¼Œé‚£ä¹ˆç”±$Lagrange$å¯çŸ¥ï¼š</p>
<script type="math/tex; mode=display">\forall a\in G, a^{p-1}=1(\mod p)</script><h3 id="å®šç†2Â·-Euler-å®šç†"><a href="#å®šç†2Â·-Euler-å®šç†" class="headerlink" title="å®šç†2Â·$Euler$å®šç†"></a>å®šç†2Â·$Euler$å®šç†</h3><p>$a^{\phi(n)}=1 (\mod n)$</p>
<h3 id="Proof-1"><a href="#Proof-1" class="headerlink" title="$Proof.$"></a>$Proof.$</h3><p>è€ƒè™‘$n\in N^{+}$ï¼Œè€ƒè™‘ç¾¤$G=$ {$1\leq x\leq n~|~gcd(x,n)=1$ },ç¾¤çš„è¿ç®—å®šä¹‰ä¸ºå¯¹$n$å–æ¨¡çš„ä¹˜æ³•</p>
<p>é‚£ä¹ˆä¼šæœ‰$|G|=\phi(n)$ï¼Œä»è€Œæœ‰ï¼š</p>
<script type="math/tex; mode=display">\forall a\in G, a^{\phi(n)}=1 (\mod n)</script><hr>
<p>æ²¡é”™ï¼Œè¯æ˜ååˆ†çš„ç®€æ´ç¾è§‚ã€‚</p>
<p>ä½œè€…è¢«è¿™ç§ç¥å¥‡çš„è¯æ˜ç»™æŠ˜æœäº†$stO$.</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>æŠ½è±¡ä»£æ•°</category>
      </categories>
      <tags>
        <tag>æ•°å­¦/æŠ½è±¡ä»£æ•°/ç¾¤è®º</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘BSGSç®—æ³•åˆæ¢</title>
    <url>/2019/02/06/BSGS-junior/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸€ç±»è§£å†³$a^x\equiv b(~\bmod~p)$ï¼Œä¸”$p$ä¸º$prime$çš„åŒä½™å¼çš„ç®—æ³•ã€‚</p>
<a id="more"></a>
<p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98---9cf.svg" alt></p>
<h1 id="rm-0x01-mathcal-Preface"><a href="#rm-0x01-mathcal-Preface" class="headerlink" title="$\rm{0x01}$  $\mathcal{Preface}$"></a>$\rm{0x01}$  $\mathcal{Preface}$</h1><p><strong>$\rm{BSGS}(Baby~Step~Giant~Step)$, å¤§æ­¥å°æ­¥æ³•</strong>ã€‚å½“ç„¶ä¹Ÿä¼šè¢«å«åš<strong>æ‹”å±±ç›–ä¸–</strong>ã€<strong>åŒ—ä¸Šå¹¿æ·±</strong>ç®—æ³•â€¦â€¦å’³ï¼Œè¿™å¹¶ä¸é‡è¦ã€‚å½¢å¼åŒ–åœ°è®²ï¼Œ $\rm{BSGS}$ç®—æ³•ä¸»è¦ç”¨æ¥è§£å†³ä»¥ä¸‹é—®é¢˜ : </p>
<blockquote>
<p>ç»™å®šè´¨æ•°$p$, æ•´æ•°$a, b$, $(a, p)=1$.æ±‚æœ€å°çš„éè´Ÿæ•´æ•°$x$, ä½¿å¾—$a^xâ‰¡ b~(\mod p)$</p>
</blockquote>
<p>è€Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“çš„ï¼Œæ˜¯ç”±æ¬§æ‹‰å®šç†$a ^{\varphi(p)} â‰¡ 1 ~(\mod p)$ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜çŸ¥é“$a^0=1â‰¡1  ~(\mod p)$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªæ–­è¨€ï¼š</p>
<p><strong>å¦‚æœæ–¹ç¨‹$a^xâ‰¡ b~(\mod p)$æœ‰æœ€å°éè´Ÿæ•´æ•°è§£ï¼Œé‚£ä¹ˆæœ€å°éè´Ÿæ•´æ•°è§£ä¸€å®šåœ¨$[0, \varphi(p))$ä¸­</strong> $\qquad \qquad(1) $</p>
<p>æ­¤å¤„è‚‰çœ¼å¯ä»¥çœ‹å‡ºå…¶å¾ªç¯èŠ‚ä¸º$\varphi(p)$ï¼Œä¸å†è¯æ˜ã€‚</p>
<p>ä¹‹åæˆ‘ä»¬å°†ä»¥æ­¤ä¸ºåŸºç¡€è¿›è¡Œç±»ä¼¼åˆ†å—çš„æ“ä½œâ€”â€”</p>
<h1 id="rm-0x02-Baby-Step-Giant-Step"><a href="#rm-0x02-Baby-Step-Giant-Step" class="headerlink" title="$\rm{0x02~~Baby~Step~Giant~Step}$"></a>$\rm{0x02~~Baby~Step~Giant~Step}$</h1><p>é¦–å…ˆæˆ‘ä»¬è®°$n=\sqrt {\varphi(p)}$ï¼Œé‚£ä¹ˆ$\forall x \in [0, \varphi(p))$, $x = i\times m+j$, $i \leq  \lfloor \frac{pâˆ’1-m}{m} \rfloor,~~ 0â‰¤j &lt;m$ ã€‚é‚£ä¹ˆå¯¹äºåŸæ–¹ç¨‹æˆ‘ä»¬å¯ä»¥æŠŠå…¶æ”¹ä¸ºï¼š<script type="math/tex">a^{i\cdot n+j}â‰¡ b~(\mod p)</script>ç§»ä¸€ä¸‹é¡¹å°±å¯ä»¥å˜æˆ<script type="math/tex">a^j â‰¡b \cdot a^{-i\cdot n} (\mod p)</script>é‚£ä¹ˆç°åœ¨æˆ‘ä»¬çš„ç­–ç•¥æ˜¯ç®—å‡ºæ‰€æœ‰$a^j$æ¥ï¼Œåœ¨$\mod p$  æ„ä¹‰ä¸‹è§‚å¯Ÿæ˜¯å¦æœ‰ä¸€ä¸ª$i$ä½¿å¾—$a^j â‰¡b \cdot a^{-i\cdot n} (\mod p)$ã€‚æˆ‘ä»¬ç§°å·¦è¾¹æšä¸¾$a^j$å«åš<strong>å°æ­¥$(\rm{Baby~Step})$</strong>ï¼Œ  ç§°å³è¾¹æšä¸¾$b \cdot a^{-i\cdot n}$å«åš<strong>å¤§æ­¥$~(\rm{Giant~Step})$</strong>ã€‚</p>
<p>é‚£ä¹ˆå…¶å®ç®—æ³•æµç¨‹å¾ˆæ˜æ™°äº†ï¼Œæˆ‘ä»¬åªéœ€è¦å¾ªç¯ä¸¤æ¬¡ã€ç¬¬ä¸€æ¬¡è®°å½•çš„$a^j$ç”¨å“ˆå¸Œè¡¨ï¼ˆ$STL$è‡ªå¸¦$unordered$_ $map$ï¼‰è®°å½•ä¸€ä¸‹å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL a, LL b, LL p)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) </span><br><span class="line">            (res *= a) %= p ;</span><br><span class="line">        (a *= a) %= p, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res % p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">bsgs</span><span class="params">(LL x, LL y, LL p)</span></span>&#123;</span><br><span class="line">    P = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p)), Hash.clear(), Q = expow(x, -P + <span class="number">2</span> *(p - <span class="number">1</span>), p) ;</span><br><span class="line">    <span class="comment">//a ^ (p-1) = 1 (mod p) =&gt; Q = a^(-P) = a ^(-P + p -1) ;</span></span><br><span class="line">    <span class="keyword">for</span> (LL i = <span class="number">1</span>, j = <span class="number">0</span> ; j &lt; P ; ++ j, (i *= x) %= p) </span><br><span class="line">        <span class="keyword">if</span> (!Hash.count(i)) Hash[i] = j ; <span class="comment">// Push them into hash_table</span></span><br><span class="line">    <span class="keyword">for</span> (LL i = y, j = <span class="number">0</span>  ; j &lt;= P ; ++ j, (i *= Q) %= p) </span><br><span class="line">        <span class="keyword">if</span> (Hash.count(i))&#123; <span class="built_in">cout</span> &lt;&lt; Hash[i] + j * P &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"-1"</span> &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ç»†èŠ‚è¿˜æ˜¯æœ‰çš„ï¼š</p>
<ul>
<li><p>è®¡ç®—<code>sqrt</code>æ—¶è¦ä¸Š<strong>å–æ•´</strong>ã€‚</p>
</li>
<li><p>æˆ‘ä»¬åœ¨æ±‚$a^{-i\cdot n}$æ—¶ç”¨çš„åº•å˜é‡éœ€è¦ç”±è´¹é©¬å°å®šç†æ±‚å¿«é€Ÿå¹‚å¾—å‡ºã€‚ä½†æ˜¯æ­¤æ—¶æŒ‡æ•°ä¸Šå¯èƒ½ä¸ºè´Ÿæ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©åŠ ä¸Šä¸€ä¸ªæ¨¡æ•°ï¼Œä¸å½±å“ç»“æœã€‚</p>
</li>
<li>ä¸¤æ¬¡å¾ªç¯æšä¸¾çš„è¾¹ç•Œè¦æ³¨æ„æœ‰çš„æ˜¯$\leq$æœ‰çš„æ˜¯$&lt;$</li>
<li>ç®—æ³•è¿˜æ²¡å¼€å§‹æ—¶ï¼Œè¦åˆ¤æ–­æœ¬èº«$a$æ˜¯å¦å¯ä»¥è¢«$P$æ•´é™¤ã€‚å¦‚æœä¸ç‰¹åˆ¤è¿™ç§æƒ…å†µçš„è¯ï¼Œæˆ‘ä»¬ä¸Šé¢ä»£ç ä¸­çš„<code>Q</code>å°±ä¼š<code>=0</code>ï¼Œä»è€Œåœ¨ä¸‹é¢çš„ç¬¬äºŒä¸ªå¾ªç¯å¤„å‡ºé”™â€”â€”æˆ‘ä»¬çš„<code>hash[i]</code>å’Œ<code>j</code>ä¸èƒ½åŒæ—¶ä¸º$0$ï¼Œä»è€Œè¾“å‡ºé”™è¯¯çš„ç­”æ¡ˆã€‚</li>
</ul>
<h1 id="rm-0x03-ä¾‹é¢˜"><a href="#rm-0x03-ä¾‹é¢˜" class="headerlink" title="$\rm{0x03}$   ä¾‹é¢˜"></a>$\rm{0x03}$   ä¾‹é¢˜</h1><p>$T1~$<a href="https://www.luogu.org/problemnew/show/P4028" target="_blank" rel="noopener">$LuoguP4028$</a></p>
<p>è£¸é¢˜ï¼Œä½†æ˜¯æœ‰å¾ˆå¤šå‘â€¦â€¦æˆ–è€…è¯´ä¸Šé¢åˆ—ä¸¾çš„ç»†èŠ‚éƒ½æ¶µç›–äº†qaq</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> tr1 ; <span class="keyword">int</span> T ;</span><br><span class="line">LL A, B, M, P, Q ; <span class="built_in">unordered_map</span> &lt;LL, LL&gt; Hash ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL a, LL b, LL p)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) </span><br><span class="line">            (res *= a) %= p ;</span><br><span class="line">        (a *= a) %= p, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res % p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">bsgs</span><span class="params">(LL x, LL y, LL p)</span></span>&#123;</span><br><span class="line">    P = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p)), Hash.clear(), Q = expow(x, -P + <span class="number">2</span> *(p - <span class="number">1</span>), p) ;</span><br><span class="line">    <span class="comment">//a ^ (p-1) = 1 (mod p) =&gt; Q = a^(-P) = a ^(-P + p -1) ;</span></span><br><span class="line">    <span class="keyword">for</span> (LL i = <span class="number">1</span>, j = <span class="number">0</span> ; j &lt; P ; ++ j, (i *= x) %= p) </span><br><span class="line">        <span class="keyword">if</span> (!Hash.count(i)) Hash[i] = j ; <span class="comment">// Push them into hash_table</span></span><br><span class="line">    <span class="keyword">for</span> (LL i = y, j = <span class="number">0</span>  ; j &lt;= P ; ++ j, (i *= Q) %= p) </span><br><span class="line">        <span class="keyword">if</span> (Hash.count(i))&#123; <span class="built_in">cout</span> &lt;&lt; Hash[i] + j * P &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Couldn't Produce!"</span> &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ; <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) res = (res &lt;&lt; <span class="number">1</span>) + (res &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        M = qr(), A = qr(), B = qr() ;</span><br><span class="line">        <span class="keyword">if</span> ((!(A % M == <span class="number">0</span> &amp;&amp; B))) bsgs(A, B, M) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="string">"Couldn't Produce!"</span> &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$T2~$ <a href="https://www.luogu.org/problemnew/show/P3846" target="_blank" rel="noopener">$TJOI2007~Cute~Prime$</a></p>
<p>æœ€è£¸æœ€è£¸çš„ã€æ— ç‰¹åˆ¤çš„é¢˜â€¦â€¦å¯ä»¥æ°´ä¸€ä¸‹åŒå€ç»éªŒã€‚</p>
<h1 id="mathfrak-writter-pks"><a href="#mathfrak-writter-pks" class="headerlink" title="$\mathfrak{writter: pks}$"></a>$\mathfrak{writter: pks}$</h1>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>BSGS</category>
      </categories>
      <tags>
        <tag>BSGS/exBSGS</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘LCTåˆæ­¥</title>
    <url>/2019/02/04/LCT-s-Junior-Intro/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸€ç§ä»¥ $ \rm Splay $ ä½œä¸ºè¾…åŠ©æ ‘çš„ã€åŠ¨æ€ç»´æŠ¤æ£®æ—è¿é€šæ€§çš„ç®—æ³•ã€‚</p>
<a id="more"></a>
<p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt></p>
<h1 id="rm-0x01-é—²è¯-Â·-rm-LCT-çš„ç”¨é€”ä»¥åŠå…·ä½“æ€è·¯"><a href="#rm-0x01-é—²è¯-Â·-rm-LCT-çš„ç”¨é€”ä»¥åŠå…·ä½“æ€è·¯" class="headerlink" title="$ \rm{0x01} $  é—²è¯ Â·  $\rm LCT$ çš„ç”¨é€”ä»¥åŠå…·ä½“æ€è·¯"></a>$ \rm{0x01} $  é—²è¯ Â·  $\rm LCT$ çš„ç”¨é€”ä»¥åŠå…·ä½“æ€è·¯</h1><p>å’³ï¼Œå…¶å®åœ¨æˆ‘æœ€è¿‘åªæ˜¯æµ…æµ…åœ°å­¦äº†ä¸€éƒ¨åˆ†çš„åŸºç¡€ä¸Šï¼Œçªè§‰å¾— $\rm LCT$ å…¶å®å°±æ˜¯ä¸€ä¸ªç”¨æ¥ç»´æŠ¤<strong>æ£®æ—è¿é€šæ€§</strong>çš„ã€‚</p>
<p>å—¯â€¦â€¦å› ä¸ºå…¶ç‹¬ç‰¹çš„æ€§è´¨æ‰€ä»¥ä¹Ÿå¯ä»¥é¡ºä¾¿ç»´æŠ¤å¥½å¤šä¸œè¥¿ï¼Œä»€ä¹ˆé“¾ä¸Šçš„æœ€å¤§å€¼å•Šï¼Œé“¾ä¸Šçš„æƒå€¼å’Œå•Šâ€¦â€¦éƒ½å¯ä»¥ç»´æŠ¤â€”â€”æˆ–è€…è¯´ï¼Œ$\rm LCT$ æ˜¯æ›´åŠ å…¨èƒ½çš„æ ‘å‰–ã€‚</p>
<p>ä½†å…¶å®å§â€¦â€¦ $ \rm LCT $ æ‰“æ¿å­æ˜¯å¾ˆç®€å•çš„ï¼Œä½†æ˜¯çœŸæ­£ç†è§£å´ä¸€ç‚¹å„¿ä¹Ÿä¸ç®€å•ã€‚å› ä¸ºæœ¬èº« $\rm splay$ å°±å¾ˆéº»çƒ¦äº†ï¼Œå†µä¸” $\rm splay$ ä¹‹å‰ä¸€ç›´ç”¨äºç»´æŠ¤æ•°åˆ—ã€‚è¦çŸ¥é“ï¼Œæ­¤å¤„çš„ $\rm splay$ å¯æ˜¯ä½œä¸º<strong>è¾…åŠ©æ ‘</strong>ï¼Œç»´æŠ¤ä¸€æ•´ä¸ªæ£®æ—ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒåºåˆ—ä¸­å‡ ä¹å…¨éƒ¨æ“ä½œâ€”â€”è¿™å°±å¤§å¤§å¢é«˜äº†ç†è§£éš¾åº¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½ æ›¾ç»è®¤ä¸ºå·²ç»éš¾ä»¥ç†è§£ã€æˆ–è€…è¯´ä¸å¯ä»¥åšçš„ã€æ¯”è¾ƒå¤æ‚çš„åŒºé—´ç¿»è½¬<a href="https://www.luogu.org/problemnew/show/P3391" target="_blank" rel="noopener"> $\rm Luogu3391 $ </a>ï¼Œåœ¨ $\rm LCT$ é‡Œé¢æœ‰ååˆ†å…¨é¢çš„æ¶‰åŠï¼Œä½†æ˜¯è¢«ç²¾ç®€åˆ°äº†åªæœ‰ä¸¤è¡Œæ˜¯ç”¨æ¥æè¿°è¿™ä¸ªå†…å®¹çš„ã€‚æ˜¾è€Œæ˜“è§çš„æ˜¯ï¼Œ $\rm LCT $ è™½ç„¶å¸¸æ•°ååˆ†çš„å¤§ï¼Œä½†ä»£ç ååˆ†çš„çŸ­ï¼Œæ¯”ä¸€æ£µå®Œæ•´çš„å¹³è¡¡æ ‘çŸ­äº†ä¸å°‘ï¼ˆå®æµ‹50+è¡Œï¼‰ï¼Œä¸ $ \rm FFT $ ä¸€æ ·å…·æœ‰ç€åä¸½çš„å¯è§‚èµæ€§ï¼Œä½†æ˜¯éšè—åœ¨ä¹‹åçš„æ€ç»´éš¾åº¦åŒæ ·ä¸å¯å°è§‘ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ˜¯ä¸æ˜¯å­¦çš„å¤ªè‰ç‡ã€å¤ªæµ®èºäº†å‘¢ï¼Ÿå¿«é¤å¼åœ°å­¦å®Œ $\rm LCT$ ï¼Œç½‘ä¸Šçš„æ¯ä¸€ç¯‡åšå®¢éƒ½åŒ…æ•™åŒ…ä¼šã€‚ä½†æ˜¯æˆ‘ä»Šå¤©è¦æ•´ç†çš„ï¼Œæ˜¯å¯¹äº $ \rm LCT $ çœŸæ­£çš„ç†è§£ã€‚å¸Œæœ›å„ä½çœ‹åˆ°è¿™ç¯‡æ‹™ä½œçš„äººå¯ä»¥è·å¾—ä¸€äº›ä»€ä¹ˆã€‚</p>
<h1 id="rm-0x02-é—²è¯-Â·-å…³äº-rm-splay"><a href="#rm-0x02-é—²è¯-Â·-å…³äº-rm-splay" class="headerlink" title="$ \rm{0x02} $  é—²è¯ Â· å…³äº $ \rm{splay} $"></a>$ \rm{0x02} $  é—²è¯ Â· å…³äº $ \rm{splay} $</h1><p>é“ç†æˆ‘éƒ½æ‡‚ï¼Œè¦æƒ³åŠ¨æ€æ‹†åˆ ä¸€äº›ä¸œè¥¿ï¼Œè¾…åŠ©æ ‘çš„å½¢æ€å¯ä»¥æ”¹å˜æ˜¯å…ˆå†³æ¡ä»¶ã€‚çœ‹ä¸Šå»å¹³è¡¡æ ‘å¥½åƒæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä½†æ˜¯ï¼Œé€‰å“ªä¸ªä½œä¸ºè¾…åŠ©æ ‘å‘¢ï¼Ÿ<del>åå®«ä½³ä¸½ä¸‰åƒæˆ‘è¯¥ç¿»è°çš„ç‰Œå­å‘¢</del></p>
<p>å†å²çš„é‡ä»»æœ€åè½åˆ°äº† $ \rm{splay} $ çš„èº«ä¸Šã€‚ç„¶å $ \rm{splay} $ ä»–å±…ç„¶ï¼š</p>
<p><img src="t1.jpg" alt></p>
<p>ä»–ç”šè‡³è¿˜ï¼š</p>
<p><img src="t2.png" alt></p>
<p>â€¦â€¦</p>
<p>å¥½å§ï¼Œç”±äºæŸäº›<del>rqyä¹Ÿä¸çŸ¥é“çš„</del>åŸå› ï¼Œå¦‚æœä¸ç”¨ $ \rm{splay} $ çš„è¯ï¼Œå¤æ‚åº¦æ˜¯å‡æ‘Š $ \Theta(\rm{nlog^2n}) $ , è€Œç”¨ $ \rm{splay} $ å°±å¯ä»¥åšåˆ°å‡æ‘Š $ \Theta(\rm{nlogn}) $  â€¦â€¦ä½†äº‹å®ä¸Šï¼Œsplayç¡®å®æœ‰ä»–ç‹¬ç‰¹çš„æ€§è´¨ï¼Œæ¯”å¦‚æ—‹è½¬åˆ°æ ¹å•Šä¹‹ç±»çš„ï¼Œæ¯”èµ·å…¶ä»–ç§ç±»çš„å¹³è¡¡æ ‘è€Œè¨€ï¼Œæ›´åŠ é€‚åˆ $\rm LCT$ </p>
<h1 id="rm-0x03-rm-LCT-çš„æ€è·¯å’ŒåŸºç¡€æ“ä½œ"><a href="#rm-0x03-rm-LCT-çš„æ€è·¯å’ŒåŸºç¡€æ“ä½œ" class="headerlink" title="$ \rm{0x03} $     $\rm LCT$ çš„æ€è·¯å’ŒåŸºç¡€æ“ä½œ"></a>$ \rm{0x03} $     $\rm LCT$ çš„æ€è·¯å’ŒåŸºç¡€æ“ä½œ</h1><h2 id="ä¸€-ä¸»è¦æ€è·¯"><a href="#ä¸€-ä¸»è¦æ€è·¯" class="headerlink" title="ä¸€ ä¸»è¦æ€è·¯"></a>ä¸€ ä¸»è¦æ€è·¯</h2><p>ä¸»è¦æ€è·¯å˜›â€¦â€¦å¤§æ¦‚æ˜¯åŸºäº<strong>å®é“¾å‰–åˆ†</strong>çš„æ“ä½œã€‚</p>
<p><strong>æœ´ç´ çš„æ ‘å‰–æ˜¯é‡é“¾å‰–åˆ†</strong>ï¼Œå¤§ä½“ä¸Šå°±æ˜¯å°†æ•´æ£µæ ‘çš„é“¾åˆ’åˆ†ä¸ºè½»è¾¹å’Œé‡é“¾ï¼Œè¿ç”¨å·§å¦™çš„æ€§è´¨åšåˆ° $ log $ çº§åˆ«ã€‚è€Œé—æ†¾çš„æ˜¯ $\rm LCT$ ç»´æŠ¤çš„æ˜¯æ£®æ—çš„è¿é€šæ€§ï¼Œæ‰€ä»¥åªèƒ½é‡‡ç”¨å®é“¾å‰–åˆ†ã€‚</p>
<p>è€Œå®é“¾å‰–åˆ†å¤§ä½“ä¸Šå°±æ˜¯æŠŠè¾¹åˆ†ä¸º<strong>è™šè¾¹</strong>å’Œ<strong>å®è¾¹</strong>ã€‚å…¶ä¸­å®è¾¹ä¸²è”èµ·ä¸€ä¸ªè”é€šå—ï¼ŒåŒä¸€ç»„å®è¾¹å­˜åœ¨ã€ä¸”ä»…å­˜åœ¨äºä¸€æ£µ $ \rm{splay} $ ä¸­ã€‚ $ \rm{splay} $ å’Œ $ \rm{splay} $ ä¹‹é—´ç”±è™šè¾¹ç›¸è¿ã€‚</p>
<p>å®é“¾å‰–åˆ†çš„å¥½å¤„å‘¢ï¼Ÿåœ¨äº<strong>å®é“¾å‰–åˆ†æ˜¯ä¸€ç§åŠ¨æ€å‰–åˆ†</strong>ï¼Œä»–å¯ä»¥<strong>éšæ„æ”¹å˜è¾¹çš„è™šå®å±æ€§</strong>ã€‚è€Œæ˜¾ç„¶ï¼Œé‡é“¾å‰–åˆ†ç”±äºæœ‰ç€è¶³å¤Ÿçš„ç†è®ºä¾æ®å’Œé€»è¾‘æ¨æ¼”ï¼Œæ‰€ä»¥è½»é‡é“¾æ˜¯éš¾ä»¥æ›´æ”¹ï¼Œæˆ–è€…è¯´ï¼Œä¸å¯æ›´æ”¹çš„ã€‚Soï¼Œå®é“¾å‰–åˆ†ä¸ºåŠ¨æ€æ ‘çš„åŠ¨æ€æ‰“ä¸‹äº†åŸºç¡€ã€‚</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª $\rm LCT$ æ˜¯å¦‚ä½•å®šä¹‰çš„:</p>
<ul>
<li><p>0ã€æœ¬è´¨ä¸Šï¼Œ $\rm LCT$  æ˜¯ä¸€å †æ ‘ï¼Œæ­£å¦‚å®ƒçš„å…¨ç§°ã€Œ$\rm Link-Cut~Trees$ã€ï¼Œé‡Œé¢å……æ–¥ç€å®è¾¹å’Œè™šè¾¹ã€‚æ¯ä¸€æ£µå•ç‹¬çš„ $\rm Link-Cut ~Tree$ ç”¨æ¥ç»´æŠ¤ä¸€ä¸ªè¿é€šå—ï¼ˆåŸå›¾ä¸­è¿é€šï¼‰ã€‚</p>
</li>
<li><p>1ã€é¦–å…ˆï¼Œä¸€æ£µ  $\rm LCT$  ç®¡æ§çš„æ˜¯ä¸€å †åˆ†æ•£çš„ç‚¹ï¼Œç‚¹ä»¥å‡ æ£µåˆ†æ•£çš„ $\rm splay$ çš„å½¢å¼èšé›†ã€‚èµ·åˆæ•´æ£µ $\rm LCT$ æ˜¯æ²¡æœ‰ä»»ä½•è”ç³»çš„ï¼Œå„è‡ªä¸ºæˆ˜ï¼Œå„è‡ªä¸ºæ ¹ã€‚æ¥ä¸‹æ¥çœ‹åˆ°çš„ $ access $ ã€ $ makeroot $ ç­‰æ“ä½œï¼Œéƒ½æ˜¯åœ¨è‡ªå·±çš„è”é€šå—å„¿å†…éƒ¨è¿›è¡Œçš„æ“ä½œã€‚æ¢å¥è¯è®²ï¼Œ $\rm LCT$ ç»´æŠ¤çš„æ˜¯æœ‰æ ¹æ£®æ—ï¼Œå³ç»„æˆæ£®æ—çš„æ¯ä¸ªè”é€šå—éƒ½æœ‰å…¶å”¯ä¸€çš„æ ¹ã€‚</p>
</li>
<li><p>2ã€å®è¾¹ä¸²è”èµ·ä¸€ä¸ªè”é€šå—ï¼ŒåŒä¸€ç»„å®è¾¹å­˜åœ¨ã€ä¸”ä»…å­˜åœ¨äºä¸€æ£µ $ \rm{splay} $ ä¸­ã€‚ $ \rm{splay} $ å’Œ $ \rm{splay} $ ä¹‹é—´ç”±è™šè¾¹ç›¸è¿ã€‚åªæœ‰å®è¾¹æ˜¯æœ‰æ•ˆçš„ï¼Œè™šè¾¹å¯ä»¥è¢«è®¤ä¸ºä¸å­˜åœ¨ã€‚<strong>ä½†æ˜¯ä¸¤ç§è¾¹éƒ½æ²¡æœ‰ç”¨åˆ°æ˜¾å¼å­˜å‚¨</strong>ï¼Œéƒ½æ˜¯é€šè¿‡splayä¸­çš„ $ Son $ æ•°ç»„å’Œ $ Fa $ æ•°ç»„è®¿é—®çš„ã€‚ä½†è™šè¾¹å’Œå®è¾¹çš„å­˜å‚¨æœ‰åŒºåˆ«ï¼š</p>
</li>
<li><p>3ã€è™šè¾¹æ˜¯è®¤çˆ¶ä¸è®¤å­ï¼Œå³å¦‚æœ $ Fa[x]==y $ ï¼Œé‚£ä¹ˆ $ y $ ä¸å­˜ $ x $ è¿™ä¸ªå„¿å­ï¼Œä½†æ˜¯ $ x $ å­˜ $ y $ è¿™ä¸ªçˆ¶äº²ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†å¯ä»¥ $ Access $ â€”â€”å› ä¸ºå…¶å®åœ¨ $ Access $ çš„å­å‡½æ•° $\rm splay$ é‡Œï¼Œå‘æŒ¥ä½œç”¨çš„å®é™…ä¸Šæ˜¯ $ Fa $ æŒ‡é’ˆã€‚</p>
</li>
<li><p>4ã€å®è¾¹æ˜¯å®Œæ•´çš„åŒå‘å­˜å‚¨ã€‚</p>
</li>
<li><p>5ã€æ˜¾ç„¶çš„æ˜¯ï¼Œ $ \rm{splay} $ ä¸­ç»´æŠ¤çš„æ˜¯ä¸€æ¡ä»ä¸Šåˆ°ä¸‹æŒ‰åœ¨åŸæ ‘ä¸­æ·±åº¦ä¸¥æ ¼é€’å¢çš„è·¯å¾„ï¼Œä¸”ä¸­åºéå† $ \rm{splay} $ å¾—åˆ°çš„æ¯ä¸ªç‚¹çš„æ·±åº¦åºåˆ—ä¸¥æ ¼é€’å¢ã€‚æ¢å¥è¯è®²ï¼Œä¸€ä¸ª $ \rm{splay} $ é‡Œé¢ä¸ä¼šå‡ºç°åœ¨åŸè”é€šå—å„¿ï¼ˆæ ‘ï¼‰ä¸­æ·±åº¦ç›¸åŒçš„ä¸¤ä¸ªç‚¹ã€‚åœ¨ä¸€æ£µ $ \rm{splay} $ ä¸­ï¼Œé”®å€¼å°±æ˜¯åŸæ ‘ä¸­çš„æ·±åº¦ã€‚</p>
</li>
<li><p>6ã€å¦‚æœ  $ x $  æ˜¯å®ƒæ‰€åœ¨  $\rm splay$  çš„æœ€å·¦è¾¹çš„ç‚¹ï¼Œé‚£ä¹ˆå®ƒåœ¨åŸæ£®æ—é‡Œçš„çˆ¶äº²æ˜¯  $ x $  æ‰€åœ¨  $\rm splay$  çš„æ ¹çš„  $ fa $ , å¦åˆ™å°±æ˜¯  $ x $  åœ¨  $\rm splay$  ä¸Šçš„å‰é©±ã€‚</p>
</li>
</ul>
<h2 id="äºŒ-åŸºç¡€æ“ä½œ"><a href="#äºŒ-åŸºç¡€æ“ä½œ" class="headerlink" title="äºŒ åŸºç¡€æ“ä½œ"></a>äºŒ åŸºç¡€æ“ä½œ</h2><p> $ emm $ æ‰€è°“åŸºç¡€æ“ä½œå¤§æ¦‚å°±æ˜¯æ¯ä¸ªç”¨åˆ° $\rm LCT$ çš„é¢˜å‡ ä¹éƒ½è¦ç”¨åˆ°çš„æ“ä½œã€‚æˆ‘ä»¬æŠŠ  $ n $  ä»¥å®è¾¹ç›¸è¿çš„å„¿å­è®°ä½œå®å„¿å­ï¼Œå¦åˆ™è®°ä¸ºè™šå„¿å­ã€‚</p>
<p>åŒæ—¶å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ$\rm Access$ã€$\rm Make~Root$ ã€$\rm Find~Root$ å’Œ $\rm Merge$ æ“ä½œéƒ½æ˜¯é’ˆå¯¹<strong>ä¸€æ£µ</strong> $lct$ çš„æ“ä½œï¼Œè€Œ $\rm Link$ å’Œ $\rm Cut$ åˆ™æ˜¯é’ˆå¯¹ä¸€æ•´ç‰‡ $lct$ æ£®æ—ï¼Œå¯ä»¥çœ‹åšâ€œåˆ†è£‚/åˆå¹¶ä¸¤ä¸ª $\rm LCT$â€ã€‚    </p>
<p>è‡³äºè¿é€šå—çš„æ ¹ï¼Œå¯ä»¥çœ‹åšæ˜¯ç»™æ— æ ¹æ ‘å¼ºè¡Œé’¦å®šçš„ä¸€ä¸ªæ ¹ï¼Œå³åŸå›¾é‡Œçš„æ ¹ï¼ˆä¼¼ä¹å¯ä»¥ç»“åˆå¹¶æŸ¥é›†ç†è§£ï¼Ÿ</p>
<ul>
<li><h2 id="rm-1-rm-Access"><a href="#rm-1-rm-Access" class="headerlink" title="$ \rm{1} $ $\rm Access $"></a>$ \rm{1} $ $\rm Access $</h2></li>
</ul>
<p>è¿™ä¸ªæ“ä½œæœ‰ç€å¾ˆè¿·çš„æ€§è´¨ï¼Œå…¶æ—¶é—´å¤æ‚åº¦æ˜¯å‡æ‘Š  $ \log n $  çš„ã€‚è€Œè¿™ä¸ªæ“ä½œçš„ç›®çš„æ˜¯ <strong>$ Access(n) $  è¡¨ç¤ºä»  $ root $  å‘  $ n $  æ‰“é€šä¸€æ¡å®é“¾ï¼Œå¹¶ä»¥  $ n $  ç‚¹ä¸ºæœ€æ·±åº¦æœ€å¤§çš„ç‚¹ã€ $ root $  ä¸ºæ·±åº¦æœ€å°çš„ç‚¹å½¢æˆä¸€æ£µ $ \rm{splay} $ </strong>ã€‚</p>
<p>ä¸éš¾çœ‹å‡ºï¼Œè¿™ä¸ªæ“ä½œå…¶å®å°±æ˜¯æŠŠåŸæ¥  $\rm splay$  çš„å‰²æ®ç»™æ”¹å˜äº†ã€‚</p>
<p>æˆ‘ä»¬æ€è€ƒï¼Œå¦‚æœæ­¤æ—¶æˆ‘ä»¬  $ Access $  å®Œç‚¹  $ n $  ä¹‹åï¼Œç†è®ºä¸Šæ¥è®²ï¼Œ $ n $  ç‚¹åº”è¯¥ä¸å†æœ‰å®å„¿å­äº†â€”â€”æ˜¾ç„¶ï¼Œå¦‚æœæœ‰å®å„¿å­çš„è¯ï¼Œ $\rm splay$  ä¸­æ˜¯åº”è¯¥åŒ…å«è¿™ä¸ªå®å„¿å­çš„â€”â€”è€Œè¿™å°±ä¸ç¬¦åˆ  $ n $  æ˜¯  $ \rm{splay} $  ä¸­æ·±åº¦æœ€å¤§çš„ç‚¹çš„æ€§è´¨äº†ã€‚è€Œå› ä¸ºåœ¨  $ \rm splay $  ä¸­ï¼Œç‚¹æ˜¯ä»¥æ·±åº¦ä¸ºé”®å€¼çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ¯æ¬¡ç æ‰ $ \rm{splay} $ ä¸­çš„å³å„¿å­â€”â€”å³ç æ‰åŸæ¥çš„å®å„¿å­ï¼Œå¹¶æŠŠåˆšåˆšè¯ç”Ÿçš„  $ \rm{splay} $  è¿ä¸Šã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Access</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; </span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> qwq = <span class="number">0</span> ; x ; x = T[qwq = x].F) </span><br><span class="line">		splay(x), rc = qwq, update(x) ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿™å°±æ˜¯ $\rm Access $ äº†ã€‚</p>
<ul>
<li><h2 id="rm-2-Make-Root"><a href="#rm-2-Make-Root" class="headerlink" title="$\rm 2 ~Make~ Root~ $"></a>$\rm 2 ~Make~ Root~ $</h2></li>
</ul>
<p>è¿™ä¸ªæ“ä½œçš„ç›®çš„æ˜¯æŠŠä¸€ä¸ªèŠ‚ç‚¹å˜æˆ  $ lct$  çš„æ ¹èŠ‚ç‚¹ã€‚</p>
<p>å…ˆä»  $ root $  å‘  $ n $  æ‰“é€šä¸€æ¡è·¯å¾„ï¼Œç„¶å  $\rm splay$  ä¸Šå»ï¼Œæœ€å  $ reverse $  ä¸€ä¸‹ã€‚æ­¤å¤„ç”±äºä¸€å¼€å§‹  $ n $  çš„æ·±åº¦æœ€å¤§ï¼Œ $\rm splay$  ä¹‹åæ·±åº¦ä¾æ—§æœ€å¤§ï¼Œä½†æ­¤æ—¶  $ n $  æ˜¯  $\rm splay$  çš„æ ¹ï¼Œæ‰€ä»¥  $ reverse(n) $  å°±ç›¸å½“äºç¿»è½¬äº†æ•´æ¡æ ‘ä¸Šçš„é“¾ï¼Œé‚£ä¹ˆç¿»è½¬ä¹‹åï¼Œ $ n $  çš„æ·±åº¦å°±å˜æˆäº†æœ€å°ï¼Œäºæ˜¯å°±æ˜¯è¿™ä¸ªè”é€šå—å„¿çš„æ ¹èŠ‚ç‚¹äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc T[x].Son[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc T[x].Son[1]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LCT</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> F, Son[<span class="number">2</span>], R, S ;</span><br><span class="line">&#125;T[MAXN] ; </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span> </span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; lc ^= rc ^= lc ^= rc, T[x].R ^= <span class="number">1</span> ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">if</span> (!T[x].R) <span class="keyword">return</span> ; T[x].R = <span class="number">0</span> ; <span class="keyword">if</span> (lc) reverse(lc) ; <span class="keyword">if</span> (rc) reverse(rc) ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Rooten</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; Access(x), splay(x), reverse(x) ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> qwq = x ; stk.push(qwq) ;</span><br><span class="line">	<span class="keyword">while</span>(check(qwq)) qwq = T[qwq].F, stk.push(qwq) ;</span><br><span class="line">	<span class="keyword">while</span>(!stk.empty()) push_down(stk.top()), stk.pop() ;</span><br><span class="line">	<span class="keyword">while</span>(check(x))&#123;</span><br><span class="line">	<span class="keyword">int</span> fa = T[x].F, g_fa = T[fa].F ;</span><br><span class="line">	<span class="keyword">if</span> (check(fa)) rotate((T[g_fa].Son[<span class="number">1</span>] == fa) == (T[fa].Son[<span class="number">1</span>] == x) ? fa : x) ; rotate(x) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„ $\rm splay$ ä¸­ç”±äº<strong>è¦ä¸‹æ”¾æ ‡è®°ï¼Œéœ€è¦ä¿è¯æ ‘çš„å½¢æ€æ˜¯æ­£ç¡®</strong>çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€ä¸ª $ stack $ å­˜ä¸€ä¸‹ï¼Œé¡ºåºä¸‹æ”¾æ ‡è®°ã€‚</p>
<ul>
<li><h2 id="rm-3-Merge"><a href="#rm-3-Merge" class="headerlink" title="$\rm 3 ~Merge~ $"></a>$\rm 3 ~Merge~ $</h2></li>
</ul>
<p>æ­¤å¤„çš„ $\rm Merge(x, y) $ çš„æ„ä¹‰æ˜¯ï¼Œæ‹‰èµ· $ x,y $ ä¸­é—´çš„é“¾ï¼Œå½¢æˆä¸€ä¸ª $\rm splay$ ã€‚è¿™é‡Œå°±ç›´æ¥ $ Mkroot $ ä¸€éï¼Œç„¶å $ Access $ å³å¯ã€‚è®©å“ªä¸ªç‚¹å½“æ ¹åº”è¯¥éƒ½å¯ä»¥ï¼Œåªä¸è¿‡å¤š $\rm splay$ å‡ æ¬¡å¯ä»¥ä¿è¯ä¼˜ï¼ˆæ¯’ï¼‰ç§€ï¼ˆç˜¤ï¼‰çš„å¤ï¼ˆå¤§ï¼‰æ‚ï¼ˆå¸¸ï¼‰åº¦ï¼ˆæ•°ï¼‰ã€‚</p>
<p>updï¼šæ­¤å¤„ $\rm splay$ è¿˜æœ‰æ·±å±‚æ¬¡çš„æ„å›¾ï¼Œå°±æ˜¯å¯ä»¥ä¿è¯ç°åœ¨ $ x $ å’Œ $ y $ æ˜¯ç›¸é‚»çš„ï¼Œè¿™æ ·åœ¨cutçš„æ—¶å€™å°±ä¼šå¾ˆæ–¹ä¾¿äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; Rooten(x), Access(y), splay(y) ; &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><h2 id="rm-4-Link-amp-Cut"><a href="#rm-4-Link-amp-Cut" class="headerlink" title="$\rm 4~Link~\&amp;~Cut $"></a>$\rm 4~Link~\&amp;~Cut $</h2></li>
</ul>
<p>å¦‚æœä¿è¯ $ \rm Link $ å’Œ $ \rm Cut $ éƒ½æ˜¯åˆæ³•çš„æ“ä½œçš„è¯ï¼Œ $ \rm Link $ ç›´æ¥è¿ï¼Œ $ \rm Cut $ ç›´æ¥åˆ å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; Rooten(x) ; T[x].F = y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Cut</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; Merge(x, y) ; T[x].F = T[y].Son[<span class="number">0</span>] = <span class="number">0</span> ;&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„ $\rm Link$ å¿…é¡»å…ˆ $ \rm Mkroot $ ä¸€ä¸‹ï¼Œå¦åˆ™æ ‘é“¾å°±æ–­äº†ã€‚è¿çš„æ˜¯è™šè¾¹ï¼ˆå› ä¸ºè¿å®è¾¹å°±ä¼šæ”¹å˜åŸæ¥ $\rm splay$ çš„å‰²æ®ï¼‰ï¼› $ \rm Cut $ å¿…é¡»å…ˆ $\rm Merge$ ä¸€ä¸‹ï¼Œä¿è¯ä¸¤ä¸ªç‚¹ä¹‹é—´åœ¨åŒä¸€æ£µ $\rm splay$ ä¸­ï¼ŒåŠ ä¹‹æˆ‘ä»¬çš„ $ Merge $ æ“ä½œä¸­ï¼Œä¸€å¼€å§‹æŠŠ $ x $ ç»™ $ mkroot $ äº†ï¼Œå†æŠŠ $ y $ ç‚¹ $\rm splay$ ä¸Šå»ï¼Œç›´æ¥å¯¼è‡´äº†ç°åœ¨ $ x $ åº”è¯¥æ˜¯ $ y $ çš„å­©å­â€”â€”äºæ˜¯å°±å¾ˆå¼€å¿ƒçš„ï¼Œå¯ä»¥ç›´æ¥ $\rm Cut$ äº†ã€‚       </p>
<p>ä½†äº‹å®ä¸Šï¼Œå¤©ä¸é‚äººæ„â€¦â€¦æœ‰æ—¶å€™è¿™æ¡è¾¹å¹¶ä¸å­˜åœ¨ï¼Œç›²ç›®åˆ é™¤çš„è¯ä¼šå¯¼è‡´ $ GG $ ï¼Œç›²ç›®è¿è¾¹çš„è¯ä¹Ÿä¼šå¯¼è‡´æ ‘çš„å½¢æ€çˆ†ç‚¸ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œä¸€æ³¢æ“ä½œâ€¦â€¦</p>
<ul>
<li>1ã€ $\text{ New-Link }$  </li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; Rooten(x) ; <span class="keyword">if</span>(Find(y) != x) T[x].F = y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; Access(x), splay(x) ; <span class="keyword">while</span>(lc) push_down(x), x = lc ; splay(x) ; <span class="keyword">return</span> x ;&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„çš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœæˆ‘ä»¬å‘ç°ä¸¤ä¸ªç‚¹åœ¨ä¸€ä¸ªå­æ ‘é‡Œé¢ï¼Œè¿æ¥å®ƒä»¬å°±ç ´åäº†æ ‘çš„æ€§è´¨ã€‚ $ \rm Find $ åˆ™æ˜¯æ‰¾åˆ°è¿™ä¸ª $lct$ ç»´æŠ¤çš„è¿é€šå—å†…çš„æ ¹ã€‚ </p>
<p>ä½†è¦æ³¨æ„å•Šï¼Œ $ Find $ æ‰¾çš„æ˜¯åŸæ ‘ä¸­çš„æ ¹ï¼Œä¸æ˜¯ $\rm splay$ ã€‚ç”±äºåŸæ ‘ä¸­æ ¹çš„æ·±åº¦ä¸€å®šæœ€å°ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ $\rm splay$ ä¸­æœ€é å·¦çš„ç‚¹â€¦â€¦æ‰€ä»¥ä¸æ–­æ‰¾å·¦å„¿å­ã€‚</p>
<p>å¤š $ BB $ ä¸€å¥ï¼Œè¿™ä¸ªåœ°æ–¹ä¸€å®šæ³¨æ„å•Šï¼ $ Find $ åªæ”¹å˜äº† $\rm splay$ çš„å½¢æ€ï¼Œ $ mkroot $ æ”¹å˜çš„æ˜¯åŸæ ‘ä¸­çš„æ ¹</p>
<ul>
<li>2ã€ $\text{New-Cut}$ </li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Cut</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; </span><br><span class="line">	Rooten(x) ; </span><br><span class="line">	<span class="keyword">if</span> (Find(y) != x || T[y].Son[<span class="number">0</span>] || T[y].F != x) <span class="keyword">return</span> ; </span><br><span class="line">	T[y].F = T[x].Son[<span class="number">1</span>] = <span class="number">0</span>, update(x) ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„é¦–å…ˆæˆ‘ä»¬è¦åˆ¤ä¸€ä¸‹è¿™ä¸¤ä¸ªç‚¹æ˜¯ä¸æ˜¯ç›´æ¥ç›¸è¿ã€‚æ˜¯å¦ç›´æ¥ç›¸è¿â€¦â€¦åœ¨ä¸€æ£µ $\rm splay$ ä¸­çš„ä½“ç°ï¼Œè¦å…‹æœä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€æ˜¯è¦åˆ¤æ–­æ˜¯å¦è¿é€šï¼Œè¿˜æ˜¯ $ Find $ æ“ä½œã€‚</p>
<p>ä¹‹åæˆ‘ä»¬éœ€è¦åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ°å¥½ç›¸éš”ä¸€æ¡è¾¹â€”â€”æ³¨æ„ï¼Œé¦–å…ˆå› ä¸ºä»£ç ä¸­çš„ $ x $ æ¯” $ y $ åœ¨åŸæ ‘ä½ç½®é ä¸Šï¼ˆ $ Rooten $ äº† $ x $ ï¼‰ï¼Œåœ¨ $\rm splay$ ä¸­é å·¦ï¼Œé‚£ä¹ˆå¦‚æœ $ y $ æœ‰å·¦å„¿å­çš„è¯ï¼Œè¯´æ˜ä¸€å®šæœ‰</p>
<script type="math/tex; mode=display">
\rm Depth(x) < Depth(y\text{çš„å·¦å„¿å­ä»¬})  < Depth(y)</script><p>å…¶ä¸­ $\rm depth$ è¡¨ç¤ºåŸæ ‘æ·±åº¦ã€‚é‚£ä¹ˆæ­¤æ—¶åŸæ ‘ä¸­ $ x $ å’Œ $ y $ ä¹‹é—´ï¼Œä¸€å®šéš”ç€ä¸€äº›èŠ‚ç‚¹ã€‚è€ƒè™‘æ ‘çš„æ€§è´¨ï¼Œä¸¤ç‚¹ä¹‹é—´æœ‰ä¸”ä»…æœ‰ä¸€æ¡ç®€å•è·¯å¾„â€”â€”æ‰€ä»¥å½“ $\rm T[y].son[0] $ ä¸æŒ‡å‘ $ Null $ æ—¶ï¼Œ $ x $ å’Œ $ y $ ä¹‹é—´æ²¡æœ‰ä¸€æ¡è¾¹ï¼Œä¸èƒ½ç›´æ¥ $\rm Cut$ ã€‚</p>
<p>å‰©ä¸‹çš„å°±å¾ˆç®€å•äº†ï¼Œ $\rm T[y].F $ åº”è¯¥æ˜¯ $ x $ ï¼Œå¦åˆ™ä¹Ÿä¸æ˜¯ç›´æ¥ç›¸è¿ã€‚</p>
<ul>
<li><h2 id="5-rm-Rotate-ä¸­çš„å‘ç‚¹"><a href="#5-rm-Rotate-ä¸­çš„å‘ç‚¹" class="headerlink" title="5  $\rm ~Rotate $ ä¸­çš„å‘ç‚¹"></a>5  $\rm ~Rotate $ ä¸­çš„å‘ç‚¹</h2></li>
</ul>
<p>å‘ƒâ€¦â€¦å…¶å®å°±ä¸€å¤„è€Œå·²ã€‚å°±æ˜¯ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> T[T[x].F].Son[<span class="number">0</span>] == x || T[T[x].F].Son[<span class="number">1</span>] == x ;  &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> fa = T[x].F, g_fa = T[fa].F, W = x == T[fa].Son[<span class="number">1</span>] ;</span><br><span class="line">	<span class="keyword">if</span> (check(fa)) T[g_fa].Son[T[g_fa].Son[<span class="number">1</span>] == fa] = x ; T[x].F = g_fa ;</span><br><span class="line">	T[fa].Son[W] = T[x].Son[W ^ <span class="number">1</span>], T[T[x].Son[W ^ <span class="number">1</span>]].F = fa, T[fa].F = x</span><br><span class="line">  T[x].Son[W ^ <span class="number">1</span>] = fa, update(fa), update(x) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªåœ°æ–¹ $\rm splay$ åŒæ—‹åˆ¤æ–­ç¥–çˆ¶çš„æ—¶å€™ï¼Œä¸å†ç”¨ $ \rm{if(g\text{_}fa)} $ ï¼Œè€Œæ˜¯ç”¨ $ \rm{if(check(fa))} $ ã€‚åŸå› å¾ˆç®€å•ï¼Œæˆ‘ä»¬çš„è™šè¾¹ä¹Ÿæ˜¯æœ‰æŒ‡å‘çˆ¶äº²çš„æŒ‡é’ˆçš„ï¼Œä½†æ˜¯è¿æ¥ä¸¤ä¸ªä¸åŒçš„ $\rm splay$ </p>
<p>å‰©ä¸‹çš„â€¦â€¦å¤§æ¦‚å°±æ²¡äº†å§â€¦â€¦</p>
<p>äºæ˜¯â€”â€”</p>
<h1 id="color-red-C-color-cyan-o-color-gold-d-color-green-e"><a href="#color-red-C-color-cyan-o-color-gold-d-color-green-e" class="headerlink" title="$ \color{red}{C}\color{cyan}{o}\color{gold}{d}\color{green}{e} $"></a>$ \color{red}{C}\color{cyan}{o}\color{gold}{d}\color{green}{e} $</h1><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é¢˜ç›®åç§°ï¼šUOJ#3 ã€ŒNOI2014ã€é­”æ³•æ£®æ—</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rg register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gcr getchar</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr(k) E[k].fr</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> va(k) E[k].va</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vb(k) E[k].vb</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fa(x) t[x].fa</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rv(x) t[x].rev</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc(x) t[x].son[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc(x) t[x].son[1]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">400010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">1000000008</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LCT</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> fa ;</span><br><span class="line">    <span class="keyword">bool</span> rev ;</span><br><span class="line">    <span class="keyword">int</span> son[<span class="number">2</span>] ;</span><br><span class="line">&#125;t[N] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> va, vb ;</span><br><span class="line">    <span class="keyword">int</span> fr, to ;</span><br><span class="line">&#125;E[M] ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> f[N] ;</span><br><span class="line"><span class="keyword">int</span> sz[N] ;</span><br><span class="line"><span class="keyword">int</span> val[N] ;</span><br><span class="line"><span class="keyword">int</span> stk[N], tp ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(Edge a, Edge b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.va &lt; b.va ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">notroot</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (lc(fa(x)) == x) || (rc(fa(x)) == x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    rv(x) ^= <span class="number">1</span> ; swap(lc(x), rc(x)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    val[x] = x ;</span><br><span class="line">    <span class="keyword">if</span> (vb(val[x]) &lt; vb(val[lc(x)])) val[x] = val[lc(x)] ;</span><br><span class="line">    <span class="keyword">if</span> (vb(val[x]) &lt; vb(val[rc(x)])) val[x] = val[rc(x)] ;</span><br><span class="line">&#125;</span><br><span class="line">il <span class="keyword">void</span> _down(<span class="keyword">int</span> x)&#123;</span><br><span class="line">    <span class="keyword">if</span> (rv(x))&#123;</span><br><span class="line">        rv(x) = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">if</span> (lc(x)) reverse(lc(x)) ;</span><br><span class="line">        <span class="keyword">if</span> (rc(x)) reverse(rc(x)) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> w = x == rc(fa(x)) ;</span><br><span class="line">    <span class="keyword">int</span> f1 = fa(x), f2 = fa(f1) ;</span><br><span class="line">    <span class="keyword">if</span> (notroot(f1))</span><br><span class="line">        t[f2].son[f1 == rc(f2)] = x ;</span><br><span class="line">    fa(x) = f2 ; fa(f1) = x ;</span><br><span class="line">    fa(t[x].son[w ^ <span class="number">1</span>]) = f1 ;</span><br><span class="line">    t[f1].son[w] = t[x].son[w ^ <span class="number">1</span>] ;</span><br><span class="line">    t[x].son[w ^ <span class="number">1</span>] = f1 ;</span><br><span class="line">    update(f1), update(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y ;</span><br><span class="line">    stk[++ tp] = y = x ;</span><br><span class="line">    <span class="keyword">while</span> (notroot(y))</span><br><span class="line">        y = fa(y), stk[++ tp] = y ;</span><br><span class="line">    <span class="keyword">while</span> (tp) _down(stk[tp --]) ;</span><br><span class="line">    <span class="keyword">while</span> (notroot(x))&#123;</span><br><span class="line">        <span class="keyword">int</span> f1 = fa(x) ;</span><br><span class="line">        <span class="keyword">int</span> f2 = fa(f1) ;</span><br><span class="line">        <span class="keyword">if</span> (notroot(f1))&#123;</span><br><span class="line">            <span class="keyword">if</span> ((f1 == rc(f2)) == (rc(f1) == x))</span><br><span class="line">                rotate(f1) ; <span class="keyword">else</span> rotate(x) ;</span><br><span class="line">        &#125;</span><br><span class="line">        rotate(x) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">qr</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    x = <span class="number">0</span> ; <span class="keyword">char</span> c = gcr() ;</span><br><span class="line">    <span class="keyword">while</span> (c &gt; <span class="string">'9'</span> || c &lt; <span class="string">'0'</span>) c = gcr() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) x = x * <span class="number">10</span> + c - <span class="number">48</span>, c = gcr() ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> ( ; x ; x = fa(y = x))</span><br><span class="line">        splay(x), rc(x) = y, update(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">find_root</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    access(x) ; splay(x) ;</span><br><span class="line">    <span class="keyword">while</span> (lc(x)) x = lc(x) ;</span><br><span class="line">    <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">make_root</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    access(x) ;</span><br><span class="line">    splay(x) ; reverse(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    make_root(x) ;</span><br><span class="line">    <span class="keyword">if</span> (find_root(y) != x)</span><br><span class="line">        <span class="keyword">return</span> fa(x) = y, <span class="keyword">void</span>() ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    make_root(x) ;</span><br><span class="line">    access(y) ; splay(y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">cut</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    access(to(x)) ; splay(x) ;</span><br><span class="line">    lc(x) = rc(x) = fa(lc(x)) = fa(rc(x)) = <span class="number">0</span> ;</span><br><span class="line">    update(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">Min</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;x, <span class="keyword">const</span> <span class="keyword">int</span> &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &lt; y ? x : y ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x == f[x] ? x : f[x] = find(f[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; ans = MAX ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        qr(fr(i)), qr(to(i)), qr(va(i)), qr(vb(i)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) fr(i) += m, to(i) += m ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n + m + <span class="number">1</span> ; ++ i) f[i] = i ;</span><br><span class="line">    sort(E + <span class="number">1</span>, E + m + <span class="number">1</span>, comp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        rg <span class="keyword">int</span> f1, f2 ;</span><br><span class="line">        rg <span class="keyword">int</span> u = fr(i), v = to(i) ;</span><br><span class="line">        <span class="keyword">if</span> (u == v) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; val[i] &lt;&lt; endl ;</span></span><br><span class="line">        split(v, u) ;</span><br><span class="line">        f1 = find(u), f2 = find(v) ;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; f1 &lt;&lt; " " &lt;&lt; f2 &lt;&lt; endl ;</span></span><br><span class="line">        <span class="keyword">if</span> (f1 != f2)&#123;</span><br><span class="line">            link(u, i), link(v, i) ;</span><br><span class="line">            <span class="keyword">if</span> (sz[f1] &lt; sz[f2])</span><br><span class="line">                f[f1] = f2, sz[f2] += sz[f1] ;</span><br><span class="line">            <span class="keyword">else</span> f[f2] = f1, sz[f1] += sz[f2] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (vb(i) &lt; vb(val[u]))</span><br><span class="line">            cut(val[u]), link(u, i), link(v, i) ;</span><br><span class="line">        <span class="keyword">if</span> (find(m + <span class="number">1</span>) == find(m + n))</span><br><span class="line">            split(m + <span class="number">1</span>, n + m),</span><br><span class="line">            ans = Min(ans, va(i) + vb(val[n + m]) ) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; (ans == MAX ? <span class="number">-1</span> : ans) &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-0x00-åè®°å’Œå‚è€ƒ"><a href="#rm-0x00-åè®°å’Œå‚è€ƒ" class="headerlink" title="$ \rm{0x00} $    åè®°å’Œå‚è€ƒ"></a>$ \rm{0x00} $    åè®°å’Œå‚è€ƒ</h1><p>å¯å†™å®Œäº†â€¦â€¦å—â€¦â€¦<del>æ‰“ä¸ªè‚¥å®…å—çŠ’åŠ³çŠ’åŠ³è‡ªå·±</del></p>
<p>æ€ä¹ˆè¯´å‘¢ï¼Œè‡ªä»æˆ‘å¼€å§‹å­¦ $\rm LCT$ åˆ°æˆ‘å†™å®Œè¿™ç¯‡ $ blog $ ä¸ºæ­¢ï¼Œæ˜¯æˆ‘ååˆ†éš¾ç†¬çš„æ—¶é—´ï¼Œæ€»æ—¶é•¿æ¥è¿‘ä¸€å‘¨ã€‚ä¸€å¼€å§‹çœ‹åˆ«äººå†™çš„ $\rm LCT$ ï¼Œæƒ³å½“ç„¶åœ°ã€è‰ç‡åœ°ç†è§£äº†ç†è§£ï¼Œå°±å¼€å§‹æ‰“æ¿å­ï¼Œå¯¹ $\rm LCT$ ä¸€ç›´æ˜¯æä¸ºè‚¤æµ…çš„è®¤è¯†ã€‚ç›´åˆ°å¼€å§‹å†™ï¼Œæ‰å‘ç°è‡ªå·±å“ªä¸ªåœ°æ–¹éƒ½ä¸ä¼šï¼Œç†è§£çš„åŠç”Ÿä¸ç†Ÿï¼Œæ€»ä¹‹å¾ˆæƒ¨â€¦â€¦</p>
<p>å†™åšå®¢çœŸæ˜¯ä¸€ä¸ªé™¶å†¶æƒ…æ“çš„è¿‡ç¨‹å•Šâ€¦â€¦<del>åŒ…æ‹¬åšè¡¨æƒ…åŒ…</del></p>
<p>åŠ æ²¹å§ï¼Œ $ pks $ ï¼</p>
<h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$ \rm{Reference} $"></a>$ \rm{Reference} $</h2><ul>
<li>$ [1] $  : $\rm Flash\text{_}Hu $ çš„ $ blog $  <a href="http://www.cnblogs.com/flashhu/p/8324551.html" target="_blank" rel="noopener"> $ ^{^{[\nearrow ]}} $ </a></li>
<li>$ [2] $  :æŸç¯‡è®ºæ–‡ï¼Œç»“åˆé£Ÿç”¨æ•ˆæœæ˜¾è‘— <a href="https://wenku.baidu.com/view/75906f160b4e767f5acfcedb.html" target="_blank" rel="noopener"> $ ^{^{[\nearrow]}} $ </a></li>
</ul>
<h2 id="mathfrak-writter-pks"><a href="#mathfrak-writter-pks" class="headerlink" title="$ \mathfrak{writter:pks} $"></a>$ \mathfrak{writter:pks} $</h2>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>Link-Cut Trees</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„/LCT</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å·¦åæ ‘</title>
    <url>/2019/01/27/%E5%B7%A6%E5%81%8F%E6%A0%91/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>åªä¼šå†™ä¸ä¼šç”¨ç³»åˆ—.jpeg</p>
<a id="more"></a>
<p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98-skyblue.svg" alt></p>
<p>å—¯â€¦å°±å½“ä½œæ˜¯å¤ä¹ äº†233â€¦æ—¶éš”å¥½å‡ ä¸ªæœˆï¼ˆå…¶å®å°±ä¸¤ä¸ªæœˆï¼‰æ‰æƒ³èµ·æ¥è¦æ•´ç†ã€‚</p>
<h1 id="rm-0x01-å…³äºå·¦åæ ‘"><a href="#rm-0x01-å…³äºå·¦åæ ‘" class="headerlink" title="$\rm{0x01}$  å…³äºå·¦åæ ‘"></a>$\rm{0x01}$  å…³äºå·¦åæ ‘</h1><p>é¦–å…ˆæ˜¯æ•´ç†è‡ªå·±æƒ³å‡ºæ¥çš„å‡ ä¸ªæ¢—</p>
<ul>
<li>$\mathcal{To~be~(left) ~or~not ~to~be~(left), this~is ~a~question}$ å·¦åè¿˜æ˜¯å³åï¼Œè¿™æ˜¯ä¸ªé—®é¢˜ã€‚ï¼ˆå“ˆå§†é›·ç‰¹æ¢—ï¼‰</li>
<li>$Hell~!~Where~is~my~Left~Leaning~Tree?$ è¯¥æ­»ï¼Œæˆ‘çš„å·¦åæ ‘å‘å³åäº†ã€‚</li>
<li>å·¦åæ ‘æ˜¯1ä¸ªlogï¼Œå³åæ ‘ä¹Ÿæ˜¯1ä¸ªlogï¼Œé‚£æˆ‘å·¦å³éƒ½åæ˜¯ä¸æ˜¯å°±ä¼šæ›´å¿«ï¼ï¼ˆæ­å–œä½ å»ºå‡ºäº†ä¸€æ£µæ»¡äºŒå‰æ ‘ï¼‰</li>
<li>è®²ä¸ªé¬¼æ•…äº‹ï¼šæ¯æ£µæ ‘éƒ½æ˜¯ä¸‹åæ ‘ã€‚</li>
<li>å…¶å®ï¼Œå·¦è€³ç¦»å¿ƒè„æ›´è¿‘ï¼Œæ‰€ä»¥ç”œè¨€èœœè¯­éº»çƒ¦åˆå¹¶åˆ°å·¦åæ ‘é‡Œå§ã€‚ï¼ˆã€Šå·¦è€³ã€‹æ¢—ï¼‰<br><del>å¥½å§æˆ‘æ‰¿è®¤ä¸æ˜¯å¾ˆå¥½ç¬‘</del></li>
</ul>
<p>å‘ï¼Œä¸‹é¢è¿›å…¥æ­£é¢˜ã€‚å·¦åæ ‘ï¼Œä¸€ç§<strong>å¯ä»¥åˆå¹¶çš„å †çŠ¶ç»“æ„</strong>ï¼Œæ”¯æŒ$insert/remove/merge$ç­‰æ“ä½œã€‚ç¨³å®šçš„æ—¶é—´å¤æ‚åº¦åœ¨$\Theta(\log n)$çš„çº§åˆ«ã€‚å¯¹äºä¸€ä¸ªå·¦åæ ‘ä¸­çš„èŠ‚ç‚¹ï¼Œéœ€è¦ç»´æŠ¤çš„å€¼æœ‰$dist$å’Œ$value$ã€‚å…¶ä¸­$value$ä¸å¿…å¤šè¯´ï¼Œ$dist$è®°å½•è¿™ä¸ªèŠ‚ç‚¹åˆ°å®ƒå­æ ‘é‡Œé¢æœ€è¿‘çš„å¶å­èŠ‚ç‚¹çš„è·ç¦»ï¼Œå¶å­èŠ‚ç‚¹è·ç¦»ä¸º$0$ã€‚</p>
<p>é¦–å…ˆï¼Œä»–æœ‰ä»¥ä¸‹å‡ ä¸ªå–œé—»ä¹è§çš„æ€§è´¨ï¼š</p>
<blockquote>
<p>ä¸€ä¸ªèŠ‚ç‚¹çš„$value$å¿…å®šï¼ˆæˆ–å°äºï¼‰å·¦ã€å³å„¿å­çš„$value$ <strong>ï¼ˆå †æ€§è´¨ï¼‰</strong><br>ä¸€ä¸ªèŠ‚ç‚¹çš„å·¦å„¿å­çš„$dist$ä¸å°äºå³å„¿å­çš„$dist$ <strong>ï¼ˆå·¦åæ€§è´¨ï¼‰</strong><br>ä¸€ä¸ªèŠ‚ç‚¹çš„è·ç¦»å§‹ç»ˆç­‰äºå³å„¿å­$+1$</p>
</blockquote>
<p>é‚£ä¹ˆè¿™å°±å¯ä»¥æ¨å‡ºä»¥ä¸‹æ€§è´¨ï¼š</p>
<blockquote>
<p>æ¨è®ºï¼šä»»ä½•æ—¶å€™ï¼ŒèŠ‚ç‚¹æ•°ä¸º$n$çš„å·¦åæ ‘ï¼Œè·ç¦»æœ€å¤§ä¸º$\log (n+1)-1$</p>
</blockquote>
<script type="math/tex; mode=display">
\mathcal{Proof.}</script><p>å¯¹äºä¸€æ£µè·ç¦»ä¸ºå®šå€¼$k$çš„æ ‘ï¼Œç‚¹æ•°æœ€å°‘æ—¶ï¼Œä¸€å®šæ˜¯ä¸€æ£µæ»¡äºŒå‰æ ‘ã€‚è¿™æ˜¯æ˜¾ç„¶çš„ã€‚å› ä¸ºå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæƒ³è¦æœ‰æœ€å°‘çš„å„¿å­ï¼Œé‚£ä¹ˆèµ·ç è¦åšåˆ°å·¦å„¿å­çš„æ•°é‡ç­‰äºå³å„¿å­çš„æ•°é‡ã€‚é‚£ä¹ˆå¯¹äºä»–çš„é€†å‘½é¢˜ä¹Ÿæ˜¯æˆç«‹çš„â€”â€”â€œè‹¥ä¸€æ£µå·¦åæ ‘çš„è·ç¦»ä¸º$k$ï¼Œåˆ™è¿™æ£µå·¦åæ ‘è‡³å°‘æœ‰$2^{k+1}-1$ä¸ªèŠ‚ç‚¹ã€‚â€<br>æ‰€ä»¥ä¼šæœ‰</p>
<script type="math/tex; mode=display">
n \geq 2^{k+1}-1\\\ \log_2{(n+1)} \geq k+1\\\ \log_2{(n+1)}-1 \geq k</script><script type="math/tex; mode=display">
\mathcal{Q.E.D}</script><p>$emmm$è¿™å¯æ˜¯ä¸€ä¸ªå¾ˆç¾å¦™çš„æ€§è´¨å•Šã€‚</p>
<h1 id="rm-0x02-åŸºæœ¬æ“ä½œ"><a href="#rm-0x02-åŸºæœ¬æ“ä½œ" class="headerlink" title="$\rm{0x02}~~$åŸºæœ¬æ“ä½œ"></a>$\rm{0x02}~~$åŸºæœ¬æ“ä½œ</h1><ul>
<li><h2 id="Merge"><a href="#Merge" class="headerlink" title="$Merge$"></a>$Merge$</h2></li>
</ul>
<p>è¿™æ˜¯æ•´ä¸ªå·¦åæ ‘çš„é‡å¤´æˆï¼Œæ—¶é—´å¤æ‚åº¦ç¨³å®šåœ¨ä¸€ä¸ª$log$ï¼Œå…¶ä¸»è¦æ€æƒ³å°±æ˜¯ä¸æ–­æŠŠæ–°çš„å †åˆå¹¶åˆ°æ–°çš„æ ¹èŠ‚ç‚¹çš„å³å­æ ‘ä¸­â€”â€”å› ä¸ºæˆ‘ä»¬çš„å³å­æ ‘å†³å®šâ€œè·ç¦»â€è¿™ä¸ªå˜é‡ï¼Œè€Œè·ç¦»åˆä¸€å®šä¿è¯åœ¨$~\log~$çš„å¤æ‚åº¦å†…ï¼Œæ‰€ä»¥ä¸æ–­å‘å³å­æ ‘åˆå¹¶ã€‚</p>
<p>å¤§ä½“æ€è·¯ï¼ˆä»¥å°æ ¹å †ä¸ºä¾‹ï¼‰ï¼Œé¦–å…ˆæˆ‘ä»¬å‡è®¾ä¸¤ä¸ªèŠ‚ç‚¹$x$å’Œ$y$ï¼Œ$x$çš„æ ¹èŠ‚ç‚¹çš„æƒå€¼å°äºç­‰äº$y$çš„æ ¹èŠ‚ç‚¹ï¼ˆå¦åˆ™$swap(x,y)$ï¼‰ï¼ŒæŠŠ$x$çš„æ ¹èŠ‚ç‚¹ä½œä¸ºæ–°æ ‘$Z$çš„æ ¹èŠ‚ç‚¹ï¼Œå‰©ä¸‹çš„äº‹å°±æ˜¯åˆå¹¶$x$çš„å³å­æ ‘å’Œ$y$äº†ã€‚</p>
<p>åˆå¹¶äº†$x$çš„å³å­æ ‘å’Œ$y$ä¹‹åï¼Œ$x$å½“$x$çš„å³å­æ ‘çš„è·ç¦»å¤§äº$x$çš„å·¦å­æ ‘çš„è·ç¦»æ—¶ï¼Œä¸ºäº†ç»´æŠ¤æ€§è´¨äºŒï¼Œæˆ‘ä»¬è¦äº¤æ¢$x$çš„å³å­æ ‘å’Œå·¦å­æ ‘ã€‚é¡ºä¾¿ç»´æŠ¤æ€§è´¨ä¸‰ï¼Œæ‰€ä»¥ç›´æ¥$dist_x = dist_{rson(x)}+1$.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y ; </span><br><span class="line">    <span class="keyword">if</span> (S[x].val &gt; S[y].val || (S[x].val == S[y].val &amp;&amp; x &gt; y)) swap(x, y) ;</span><br><span class="line">	rs = Merge(rs, y) ; <span class="keyword">if</span> (S[ls].dis &lt; S[rs].dis) swap(ls, rs) ; </span><br><span class="line">    S[ls].rt = S[rs].rt = S[x].rt = x, S[x].dis = S[rs].dis + <span class="number">1</span> ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è§‚å¯Ÿï¼Œæˆ‘ä»¬æ˜¯ä¸æ–­äº¤æ›¿æ‹†åˆ†å³å­æ ‘ï¼Œç”±æ¨è®ºå¯å¾—æˆ‘ä»¬çš„è·ç¦»ä¸ä¼šå¤§äº$\Theta(\log(n_x+1))+\Theta(\log(n_y+1))-2 =O(\log n_x+ \log n_y) $ </p>
<p>è¿™ä¸ªåœ°æ–¹æ¯”è¾ƒå–œé—»ä¹è§çš„æ˜¯éœ€è¦å­˜$root$ï¼Œå³éœ€è¦è·¯å¾„å‹ç¼©ã€‚ä¸è·¯å¾„å‹ç¼©çš„è¯ï¼Œå¯»ä¸€æ¬¡$rt$å°±æ˜¯$\Theta(n)$çš„äº†ï¼Œå¤æ‚åº¦æ˜¯ä¸å¯¹çš„<del>ä½†ä¼¼ä¹Luoguçš„æ¨¡æ¿ï¼Œä¸è·¯å¾„å‹ç¼©ä¼šæ›´å¿«</del></p>
<ul>
<li><h2 id="Pop"><a href="#Pop" class="headerlink" title="$Pop$"></a>$Pop$</h2></li>
</ul>
<p>â€¦â€¦$pop$çš„è¯ï¼Œä¹±æå°±å¥½äº†$233$</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pop</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; S[x].val = <span class="number">-1</span>, S[ls].rt = ls, S[rs].rt = rs, S[x].rt = Merge(ls, rs) ; &#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±æ˜¯æ€»ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> dis, val, Son[<span class="number">2</span>], rt ;</span><br><span class="line">&#125;S[MAXN] ; <span class="keyword">int</span> N, T, A, B, C, i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">my_swap</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span>&#123; x ^= y ^= x ^= y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> S[x].rt == x ? x : S[x].rt = Get(S[x].rt) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pop</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; S[x].val = <span class="number">-1</span>, S[ls].rt = ls, S[rs].rt = rs, S[x].rt = Merge(ls, rs) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y ; <span class="keyword">if</span> (S[x].val &gt; S[y].val || (S[x].val == S[y].val &amp;&amp; x &gt; y)) swap(x, y) ;</span><br><span class="line">	rs = Merge(rs, y) ; <span class="keyword">if</span> (S[ls].dis &lt; S[rs].dis) swap(ls, rs) ; S[ls].rt = S[rs].rt = S[x].rt = x, S[x].dis = S[rs].dis + <span class="number">1</span> ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; T ; S[<span class="number">0</span>].dis = <span class="number">-1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		S[i].rt = i, <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;S[i].val) ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= T ; ++ i)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B) ;</span><br><span class="line">		<span class="keyword">if</span> (A == <span class="number">1</span>)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;C) ;</span><br><span class="line">			<span class="keyword">if</span> (S[B].val == <span class="number">-1</span> || S[C].val == <span class="number">-1</span>) <span class="keyword">continue</span> ;</span><br><span class="line">			<span class="keyword">int</span> f1 = Get(B), f2 = Get(C) ; <span class="keyword">if</span> (f1 != f2) S[f1].rt = S[f2].rt = Merge(f1, f2) ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(S[B].val == <span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>) ;</span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, S[Get(B)].val), Pop(Get(B)) ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-0x03-ä¸€ç‚¹é—®é¢˜"><a href="#rm-0x03-ä¸€ç‚¹é—®é¢˜" class="headerlink" title="$\rm{0x03}$    ä¸€ç‚¹é—®é¢˜"></a>$\rm{0x03}$    ä¸€ç‚¹é—®é¢˜</h1><p>é—®é¢˜å¤§æ¦‚å°±æ˜¯è·¯å¾„å‹ç¼©â€¦â€¦</p>
<p><a href="https://www.luogu.org/problemnew/show/P3377" target="_blank" rel="noopener">$LuoguP3377$</a>å¾ˆä¸è´Ÿè´£ä»»åœ°å¤„äº†æ•°æ®ï¼Œå¯¼è‡´ä»¥ä¸‹è¿™ä»½ä»£ç å¯ä»¥è¿‡ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> dis, val, F, Son[<span class="number">2</span>] ;</span><br><span class="line">&#125;S[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, T, A, B, C, i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">my_swap</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span>&#123; x ^= y ^= x ^= y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">while</span>(S[x].F) x = S[x].F ; <span class="keyword">return</span> x ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pop</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; S[x].val = <span class="number">-1</span>, S[ls].F = S[rs].F = <span class="number">0</span>, Merge(ls, rs) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y ; <span class="keyword">if</span> (S[x].val &gt; S[y].val || (S[x].val == S[y].val &amp;&amp; x &gt; y)) swap(x, y) ;</span><br><span class="line">    rs = Merge(rs, y), S[rs].F = x ; <span class="keyword">if</span> (S[ls].dis &lt; S[rs].dis) swap(ls, rs) ; S[x].dis = S[rs].dis + <span class="number">1</span> ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; T ; S[<span class="number">0</span>].dis = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;S[i].val) ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= T ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B) ;</span><br><span class="line">        <span class="keyword">if</span> (A == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;C) ;</span><br><span class="line">            <span class="keyword">if</span> (S[B].val == <span class="number">-1</span> || S[C].val == <span class="number">-1</span> || B == C) <span class="keyword">continue</span> ;</span><br><span class="line">            <span class="keyword">int</span> f1 = Get(B), f2 = Get(C) ; Merge(f1, f2) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(S[B].val == <span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>) ;</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, S[Get(B)].val), Pop(Get(B)) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€åˆ‡éƒ½å¾ˆæ­£å¸¸ï¼Œä½†é—®é¢˜åœ¨äºä»–å¤æ‚åº¦ä¸å¯¹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">while</span>(S[x].F) x = S[x].F ; <span class="keyword">return</span> x ; &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¾ç„¶æ˜¯ä¸ªä¸Šç•Œä¸º$O(n)$çš„å‡½æ•°â€¦â€¦ä¸å¯’è€Œæ —â€¦â€¦</p>
<p>æ‰€ä»¥ä»–æ˜¯ä¸å¯¹çš„ï¼Œ<a href="https://www.luogu.org/discuss/show/96561" target="_blank" rel="noopener">è¿™ç»„æ•°æ®</a>å¯ä»¥å¾ˆå¥½çš„å¡æ‰ï¼ˆç”±å·¨ä½¬å°ç²‰å…”åˆ¶ä½œï¼‰ã€‚</p>
<p>æ‰€ä»¥åº”è¯¥ç”¨ä¸€ä¸ªå¹¶æŸ¥é›†ç»´æŠ¤ã€‚è€Œæˆ‘ä»¬åœ¨è·¯å¾„å‹ç¼©ä¹‹åï¼Œå¿…é¡»è¦åœ¨$pop$åï¼Œç»™$pop$æ‰çš„ç‚¹ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æ–°çš„æ ¹ï¼Œæ‰€ä»¥ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> S[x].rt == x ? x : S[x].rt = Get(S[x].rt) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pop</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; S[x].val = <span class="number">-1</span>, S[ls].rt = ls, S[rs].rt = rs, S[x].rt = Merge(ls, rs) ; &#125;</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯æœ€åçš„ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 150010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> swap my_swap</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls S[x].Son[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs S[x].Son[1]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> dis, val, Son[<span class="number">2</span>], rt ;</span><br><span class="line">&#125;S[MAXN] ; <span class="keyword">int</span> N, T, A, B, C, i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">my_swap</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span>&#123; x ^= y ^= x ^= y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> S[x].rt == x ? x : S[x].rt = Get(S[x].rt) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pop</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; S[x].val = <span class="number">-1</span>, S[ls].rt = ls, S[rs].rt = rs, S[x].rt = Merge(ls, rs) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y ; <span class="keyword">if</span> (S[x].val &gt; S[y].val || (S[x].val == S[y].val &amp;&amp; x &gt; y)) swap(x, y) ;</span><br><span class="line">	rs = Merge(rs, y) ; <span class="keyword">if</span> (S[ls].dis &lt; S[rs].dis) swap(ls, rs) ; S[ls].rt = S[rs].rt = S[x].rt = x, S[x].dis = S[rs].dis + <span class="number">1</span> ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; T ; S[<span class="number">0</span>].dis = <span class="number">-1</span> ;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">		S[i].rt = i, <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;S[i].val) ; </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= T ; ++ i)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B) ;</span><br><span class="line">		<span class="keyword">if</span> (A == <span class="number">1</span>)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;C) ;</span><br><span class="line">			<span class="keyword">if</span> (S[B].val == <span class="number">-1</span> || S[C].val == <span class="number">-1</span>) <span class="keyword">continue</span> ;</span><br><span class="line">			<span class="keyword">int</span> f1 = Get(B), f2 = Get(C) ; <span class="keyword">if</span> (f1 != f2) S[f1].rt = S[f2].rt = Merge(f1, f2) ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(S[B].val == <span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>) ;</span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, S[Get(B)].val), Pop(Get(B)) ;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="rm-0x04-ä¸€é“æ°´é¢˜"><a href="#rm-0x04-ä¸€é“æ°´é¢˜" class="headerlink" title="$\rm{0x04}$    ä¸€é“æ°´é¢˜"></a>$\rm{0x04}$    ä¸€é“æ°´é¢˜</h1><p>æ— è®ºæ€ä¹ˆè¯´ï¼Œå•ç‹¬ç”¨ä¸€ç¯‡åšå®¢æ¥æ•´ç†æ¿å­é¢˜å®åœ¨æ˜¯å¤ª$Low$äº†ï¼ˆå°¤å…¶æ˜¯æ˜¾å¾—ç¬”è€…å¾ˆæ²¡å“ä½ï¼‰ï¼Œäºæ˜¯å°±ç›´æ¥æ‹¼åˆ°ä¸€èµ·å§qwq</p>
<p><strong>[LuoguP1456]Monkey King</strong> <a href="https://www.luogu.org/problemnew/show/P1456" target="_blank" rel="noopener">é“¾æ¥</a></p>
<p>è¿™ç©æ„å„¿çœŸtmæ°´çˆ†å•Šâ€¦ç›´æ¥å­˜ä¸ªä»£ç è¯æ˜æˆ‘åšè¿‡è¿™é“é¢˜å§qaqï¼š</p>
<p>ç­‰ä¼šå„¿ï¼Œçªç„¶æƒ³èµ·æ¥è¿™é“é¢˜çš„å‘ç‚¹æ¥ã€‚å°±æ˜¯åŸæ¥çš„æ¿å­é¢˜ï¼Œéƒ½æ˜¯ç»´æŠ¤åºåˆ—é‚£ç§æ„Ÿè§‰ï¼Œä¸€ä¸ªå…ƒç´ popæ‰ä¹‹ååˆå°±ä¸ç”¨ç®¡å®ƒäº†ã€‚ä½†æ˜¯è¿™é“é¢˜æ˜¯ä¸€é“åº”ç”¨é¢˜ï¼Œæ‰€ä»¥ä¸åº”è¯¥åˆ å®Œä¸ç®¡ï¼Œåº”è¯¥æ¸…ç©ºqwqã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 200010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc T[x].Son[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc T[x].Son[1]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(a, i, b) for(i = a ; i &lt;= b ; ++ i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Heap</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> val, dis, Son[<span class="number">2</span>], rt ;</span><br><span class="line">&#125;T[MAXN] ; <span class="keyword">int</span> N, M, A, B, i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (x == T[x].rt)  <span class="keyword">return</span> x ;</span><br><span class="line">	<span class="keyword">return</span> T[x].rt = get(T[x].rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y ;</span><br><span class="line">	<span class="keyword">if</span> (T[x].val &lt; T[y].val) x ^= y ^= x ^= y ;</span><br><span class="line">	rc = Merge(rc, y) ; <span class="keyword">if</span> (T[lc].dis &lt; T[rc].dis) lc ^= rc ^= lc ^= rc ;</span><br><span class="line">	T[lc].rt = T[rc].rt = T[x].rt = x, T[x].dis = T[rc].dis + <span class="number">1</span> ; <span class="keyword">return</span> x ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N))&#123;</span><br><span class="line">		<span class="built_in">memset</span>(T, <span class="number">0</span>, <span class="keyword">sizeof</span>(T)) ;</span><br><span class="line">		rep(<span class="number">1</span>, i, N) T[i].rt = i, <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T[i].val) ; <span class="built_in">cin</span> &gt;&gt; M ;</span><br><span class="line">		rep(<span class="number">1</span>, i, M)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B) ; <span class="keyword">int</span> rt1, rt2 ;</span><br><span class="line">			<span class="keyword">int</span> f1 = get(A), f2 = get(B) ; <span class="keyword">int</span> ff1, ff2 ;  </span><br><span class="line">			<span class="keyword">if</span> (f1 == f2) &#123; <span class="built_in">puts</span>(<span class="string">"-1"</span>) ; <span class="keyword">continue</span> ; &#125;</span><br><span class="line">			T[f1].val &gt;&gt;= <span class="number">1</span>, T[f2].val &gt;&gt;= <span class="number">1</span> ;  </span><br><span class="line">			rt1 = Merge(T[f1].Son[<span class="number">0</span>], T[f1].Son[<span class="number">1</span>]) ; </span><br><span class="line">			T[f1].Son[<span class="number">0</span>] = T[f1].Son[<span class="number">1</span>] = T[f1].dis = <span class="number">0</span> ; </span><br><span class="line">			rt2 = Merge(T[f2].Son[<span class="number">0</span>], T[f2].Son[<span class="number">1</span>]) ; </span><br><span class="line">			T[f2].Son[<span class="number">0</span>] = T[f2].Son[<span class="number">1</span>] = T[f2].dis = <span class="number">0</span> ; </span><br><span class="line">			ff1 = Merge(f1, rt1), ff2 = Merge(f2, rt2) ;</span><br><span class="line">			T[ff2].rt = T[ff1].rt = Merge(ff1, ff2), <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, T[get(T[ff1].rt)].val) ; 	</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>å·¦åæ ‘</category>
      </categories>
      <tags>
        <tag>å¯å¹¶å †/å·¦åæ ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘HLPP+ä¸§å¿ƒç—…ç‹‚çš„ä¼˜åŒ–</title>
    <url>/2019/01/11/HLPP/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89-darkviolet.svg" alt></p>
<blockquote>
<p>#define  $ u $ çš„ä¼´ç‚¹é›†åˆ     ä¸ $ u $ ç›¸éš”ä¸€æ¡è¾¹çš„ä¸” $ u $ èƒ½è¾¾åˆ°çš„ç‚¹çš„é›†åˆ </p>
</blockquote>
<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>é¢„æµæ¨è¿›çš„å¤§ä½“æ€è·¯æ˜¯ï¼Œå¯¹æ¯ä¸ªç‚¹è®°å½•<strong>è¶…é¢æµ( $ \mathrm{Extra~Flow} $ )</strong> ï¼Œå³<strong>å…è®¸æµåœ¨éæºç‚¹æš‚æ—¶å­˜å‚¨</strong>ï¼Œå¹¶<strong>ä¼ºæœºå°†è¶…é¢æµæ¨é€å‡ºå»</strong>ã€‚ä¸å¯æ¨é€çš„ï¼Œå°±ä¼šæµå›æºç‚¹ã€‚é‚£ä¹ˆæœ€ç»ˆç­”æ¡ˆæ˜¾ç„¶å­˜å‚¨åœ¨ $\rm Extra[T] $ é‡Œé¢ã€‚</p>
<p>ä½†åŒæ—¶è¿™ä¹Ÿæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¼šå‡ºç°ä¸¤ä¸ªç‚¹ç›¸äº’æ¨é€ä¸åœçš„æƒ…å†µã€‚ä¸ºäº†é˜²æ­¢è¿™æ ·ï¼Œæˆ‘ä»¬é‡‡ç”¨<strong>æœ€é«˜æ ‡å·</strong>çš„ç­–ç•¥ï¼Œç»™æ¯ä¸ªç‚¹ä¸€ä¸ªé«˜åº¦ï¼Œå¯¹äºä¸€ä¸ªç‚¹ $ u $ ä»¥åŠå®ƒçš„ä¼´ç‚¹é›†åˆ $ \{v\} $ ï¼Œå½“ä¸”ä»…å½“ $ h_u = h_v + 1 $  æ—¶æ‰å¯ä»¥æ¨é€æµã€‚å¹¶ä¸”æˆ‘ä»¬å¯¹äºæºç‚¹ $\mathrm{S} $ ï¼Œè®¾ç½® $ h_{\rm S} = N $ ï¼Œå¹¶å¯¹äº $\mathrm{S} $ å®è¡Œ<strong>æ— é™åˆ¶æ¨é€</strong>ã€‚é‚£ä¹ˆæœ€åçš„ç­”æ¡ˆå°±ä¿å­˜åœ¨ $ Extra[T] $ é‡Œé¢ ã€‚</p>
<p>ä½†æœ‰æ—¶ï¼Œæˆ‘ä»¬å‘ç°æœ‰ä¸ªç‚¹æ˜¯â€è°·â€œï¼Œå³å‘¨å›´ç‚¹çš„é«˜åº¦éƒ½æ¯”å®ƒé«˜ï¼Œä½†æ˜¯å®ƒæœ‰è¶…é¢æµã€‚é‚£ä¹ˆæˆ‘ä»¬æ­¤æ—¶è€ƒè™‘<strong>æ‹”é«˜å®ƒçš„é«˜åº¦</strong>ï¼Œå³ <strong>é‡è´´æ ‡ç­¾( $ relabel $ )</strong> æ“ä½œã€‚</p>
<h1 id="åˆæ­¥çš„ç®—æ³•æµç¨‹"><a href="#åˆæ­¥çš„ç®—æ³•æµç¨‹" class="headerlink" title="åˆæ­¥çš„ç®—æ³•æµç¨‹"></a>åˆæ­¥çš„ç®—æ³•æµç¨‹</h1><p>ä»¥ä¸‹æˆ‘ä»¬ç”¨  $ \mathrm{Extra}_u $  è¡¨ç¤º  $ u $  çš„è¶…é¢æµï¼Œ $ h_u $  è¡¨ç¤º  $ u $  çš„é«˜åº¦ï¼Œç”¨  $ f_k $  è¡¨ç¤ºè¾¹ $ k $ çš„å®¹é‡ã€‚</p>
<ul>
<li><p>é¦–å…ˆæŠŠæ‰€æœ‰çš„ $ h_i $ éƒ½ç½®ä¸ºé›¶ï¼Œå¹¶æŠŠ $ h_s $ ç½®ä¸º $ N $ ï¼ˆç‚¹æ•°ï¼‰ã€‚</p>
</li>
<li><p>å°† $\mathrm{S} $ çš„æµæ¨é€åˆ°æ¯ä¸ªä¸ $\mathrm{S} $ ç›¸é‚»çš„ç‚¹ï¼ŒåŒæ—¶æŠŠä»–ä»¬åŠ å…¥ä¸€ä¸ªä»¥é«˜åº¦ä¸ºé”®å€¼å¾—å¤§æ ¹å †ï¼Œæ‰€ä»¥æ¯æ¬¡å–å‡ºçš„åº”è¯¥æ˜¯é«˜åº¦æœ€é«˜çš„ã€ä¸”è¶…é¢æµä¸ä¸ºé›¶çš„ç‚¹ï¼Œå¹¶æ‰§è¡Œæ¨é€æ“ä½œã€‚</p>
</li>
<li><p>å¯¹äºç‚¹ $ u $ æ¨é€è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ $ \mathrm{Extra}_u $ å‡åˆ°äº† $ 0 $ ï¼Œå°±ç«‹å³é€€å‡º<strong>ï¼ˆä¼˜åŒ–ä¸€ï¼‰</strong></p>
</li>
<li><p>å¯¹äºæ¯æ¡å‡ºè¾¹ $ k $ ï¼Œæ¨é€çš„æµé‡ $ F = min(f_k,\mathrm{Extra}_u) $ å¹¶æ‰§è¡Œä¸¤ä¸ªç‚¹ï¼ˆ $ u,v $ ï¼‰çš„è¶…é¢æµå¢å‡ã€‚<strong>å¦‚æœ $ v $ ä¸åœ¨å †é‡Œé¢</strong>ï¼Œè¦æŠŠ $ v $ æ”¾åˆ°å †é‡Œé¢ã€‚</p>
</li>
<li><p>å¦‚æœæ¨é€å®Œæ¯• $ Extra[u] $ ä¸ä¸ºé›¶ï¼Œé‚£ä¹ˆä»ä»–çš„ä¼´ç‚¹é›†åˆé€‰å–ä¸€ä¸ªé«˜åº¦æœ€å°çš„ç‚¹å¹¶è®°å½•å®ƒçš„é«˜åº¦ $ h_{min} $ ï¼Œåˆ™æ–°çš„ $ h_u = h_{min}+1 $ ï¼Œå¹¶æŠŠ $ u $ å…¥å †ã€‚</p>
</li>
</ul>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å‘ç°ï¼Œé‡è´´æ ‡ç­¾çš„è¿‡ç¨‹ä¼¼ä¹ä¸ $\rm ISAP $ æœ‰ç‚¹ç‚¹åƒâ€¦â€¦æ‰€ä»¥æˆ‘ä»¬ä¸å¦¨é€šè¿‡ä¸€ä¸ª $\rm Gap $ æ•°ç»„æ¥è®°å½•â€æ–­å±‚æƒ…å†µâ€œã€‚å³å¦‚æœå¯¹äºä¸€ä¸ªç‚¹ $ u $ æ¥è¯´ï¼Œä»–çš„ä¼´ç‚¹é›† $ \{v\} $ å·²ç»ä¸å­˜åœ¨ $ h_u = h_v + 1 $ çš„ç‚¹äº†ï¼Œå¹¶ä¸”ä¹Ÿä¸å­˜åœ¨ä¸€ä¸ªç‚¹ $ j $ ä½¿å¾— $ h_j = h_u $ é‚£ä¹ˆè¿™ä¸ªåœ°æ–¹å°±æ˜¯ä¸€ä¸ª<strong>æ–­å±‚ $ (\rm Gap) $ </strong> ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ‰€æœ‰ $ h_i&gt; h_u $ çš„ç‚¹æ¥è¯´ï¼Œå®ƒä»¬æŠŠæµæ¨é€åˆ° $ h_u $ çš„é«˜åº¦å°±ä¸èƒ½ç»§ç»­æ¨é€äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ $ h_i = N + 1 $ ï¼Œè®©ä»–ä»¬å›æµåˆ°æºç‚¹ã€‚<strong>ï¼ˆä¼˜åŒ–äºŒï¼‰</strong></p>
<p>æ¥ä¸‹æ¥è¿™ä¸ªä¼˜åŒ–ï¼Œäº²æµ‹å¯ä»¥<strong>æé€Ÿ $ 4000ms $ </strong>ï¼Œå¹³å‡æ¯ä¸ªæµ‹è¯•ç‚¹æé€Ÿ $ 700 $  ~  $ 800ms $ ï¼Œå»æ‰æ•°æ®æœ€å°çš„ç‚¹ï¼Œæ¯ä¸ªç‚¹å¹³å‡æé€Ÿ $ 1000ms $ ã€‚è¿™å°±æ˜¯â€”â€” $\rm BFS $ ! ä¸å¦¨ä¸€å¼€å§‹å°±å€’ç€ $ \rm BFS $ ä¸€éï¼Œæœå‡ºæ¯ä¸ªç‚¹ç¦»æ±‡ç‚¹çš„æœ€çŸ­è·ç¦»ä½œä¸ºåˆå§‹é«˜åº¦è€Œä¸æ˜¯æŠŠé›¶ä½œä¸ºåˆå§‹é«˜åº¦(æºç‚¹é«˜åº¦è¿˜æ˜¯ $N$) ã€‚</p>
<p>å—¯ï¼Œ $\rm Mr_Spade $ å¤§ä½¬å®åœ¨å¤ªå¼ºäº† ã€‚</p>
<p>å¯¹äº†ï¼Œä»£ç å®ç°æ–¹é¢ï¼Œéœ€è¦å¥½å¤šåˆ¤æ–­ä¸æ˜¯æºç‚¹å’Œæ±‡ç‚¹çš„å°ç»†èŠ‚â€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">state</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> num, h ;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> state &amp; now) </span><br><span class="line">    <span class="keyword">const</span>&#123;  <span class="keyword">return</span> h &lt; now.h ; &#125;</span><br><span class="line">&#125; ; priority_queue &lt;state&gt; heap ; </span><br><span class="line">BFS init ;</span><br><span class="line"><span class="keyword">int</span> N, M, S, T, cnt = <span class="number">-1</span>, A, B, C, D, t, min_h ;</span><br><span class="line"><span class="keyword">int</span> head[MAXN], Extra[MAXN], H[MAXN], Gap[MAXN], node ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Preflow_Push</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> i, k ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">        <span class="keyword">if</span>(H[i] &lt; Inf) ++ Gap[H[i]] ;</span><br><span class="line">    <span class="keyword">for</span>(k = head[S]; k != <span class="number">-1</span> ; k = E[k].next)</span><br><span class="line">        <span class="keyword">if</span> (t = E[k].f)&#123;</span><br><span class="line">            E[k].f -= t, E[k ^ <span class="number">1</span>].f += t ;</span><br><span class="line">          	Extra[S] -= t, Extra[to(k)] += t ;</span><br><span class="line">            <span class="keyword">if</span>(to(k) != T &amp;&amp; !vis[to(k)])</span><br><span class="line">                heap.push((state)&#123;to(k), H[to(k)]&#125;), vis[to(k)] = <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">while</span>(!heap.empty())&#123;</span><br><span class="line">        vis[node = heap.top().num] = <span class="number">0</span>, min_h = Inf, heap.pop() ;</span><br><span class="line">        <span class="keyword">for</span>(k = head[node] ; k != <span class="number">-1</span> ; k = E[k].next)&#123;</span><br><span class="line">            <span class="keyword">if</span>(E[k].f &amp;&amp; H[node] == H[to(k)] + <span class="number">1</span>)&#123;</span><br><span class="line">                t = min(Extra[node], E[k].f) ;</span><br><span class="line">                E[k].f -= t, E[k ^ <span class="number">1</span>].f += t ;</span><br><span class="line">              	Extra[node] -= t, Extra&#125;[to(k)] += t ;</span><br><span class="line">                <span class="keyword">if</span>(!vis[to(k)] &amp;&amp; to(k) != S &amp;&amp; to(k) != T)</span><br><span class="line">                    heap.push((state)&#123;to(k), H[to(k)]&#125;), vis[to(k)] = <span class="number">1</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (E[k].f) min_h = min(min_h, H[to(k)]) ;</span><br><span class="line">            <span class="keyword">if</span> (!Extra[node]) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(Extra[node]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!-- Gap[H[node]])    </span><br><span class="line">                <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= N ; ++ i)</span><br><span class="line">                    <span class="keyword">if</span>(i != S &amp;&amp; i != T &amp;&amp; H[i] &gt; H[node] &amp;&amp; H[i] &lt; N + <span class="number">1</span>) H[i] = N + <span class="number">1</span> ;</span><br><span class="line">            H[node] = Inf; H[node] = min_h + <span class="number">1</span> ; </span><br><span class="line">            heap.push((state)&#123;node, H[node]&#125;), vis[node] = <span class="number">1</span>, ++ Gap[H[node]] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;fast;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Input() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">        head[i] = <span class="number">-1</span>, H[i] = Inf ;</span><br><span class="line">    <span class="keyword">while</span>(M --)&#123;Add; &#125;</span><br><span class="line">    q.push(T), H[T] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> now = q.front() ; q.pop() ;</span><br><span class="line">        <span class="keyword">for</span>(k = head[now] ; k != <span class="number">-1</span> ; k = E[k].next)</span><br><span class="line">            <span class="keyword">if</span> (H[to(k)] &gt; H[now] + <span class="number">1</span>)</span><br><span class="line">                H[E[k].to] = H[now] + <span class="number">1</span>, q.push(E[k].to) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (H[S] == <span class="number">0</span>) &#123; <span class="built_in">cout</span> &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; &#125; </span><br><span class="line">    H[S] = N, Preflow_Push() ; <span class="built_in">cout</span> &lt;&lt; Extra[T] &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·æ¥æˆ‘ä»¬åŠ ä¸Šä¸‹é¢è¿™ä¸€å¥è¯çš„æ¯’ç˜¤å¡å¸¸å°±å¯ä»¥æœ‰ $ 4000ms $ å·¦å³çš„å¥½æˆç»©ï¼Œä½†äº‹å®ä¸Šï¼Œè¿™ä¸ªé€Ÿåº¦ä¾æ—§æ…¢çš„è¦æ­»ã€‚</p>
<p>æ³¨æ„ï¼è¿™ä¸ªå†™æ³•æ˜¯ç»å…¸å†™æ³•ï¼Œå…¶æ—¶é—´å¤æ‚åº¦æ˜¯ $ \boldsymbol{\Theta(n^2m\log n)} $ çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ $ \boldsymbol{n=1200} $ æ—¶ä¼šå¸¦ä¸€ä¸ª $ \boldsymbol{10} $ å€çš„é•¿ğŸŒ²</p>
<p>æ€ä¹ˆä¼˜åŒ–å‘¢â€”â€”</p>
<h1 id="ç¥å¥‡çš„ä¼˜åŒ–"><a href="#ç¥å¥‡çš„ä¼˜åŒ–" class="headerlink" title="ç¥å¥‡çš„ä¼˜åŒ–"></a>ç¥å¥‡çš„ä¼˜åŒ–</h1><p>å„ä½ï¼Œä½ ä»¬å°†ä¼šè§åˆ°è¿„ä»Šä¸ºæ­¢OIç•Œæœ€ä¸§å¿ƒç—…ç‹‚çš„ä¼˜åŒ–ï¼ˆä¹‹ä¸€ï¼‰â€¦â€¦</p>
<p>æ¥ï¼Œæˆ‘ä»¬é¦–å…ˆæ€è€ƒæ€è€ƒæ™®é€šçš„HLPPåˆ°åº•ä¼šæ…¢åœ¨å“ªé‡Œï¼š</p>
<ul>
<li><p>$ \rm STL $ æ”¯æŒçš„ $ heap $ ï¼ˆæ¯”å¦‚ä¼˜å…ˆé˜Ÿåˆ—ï¼‰å®åœ¨æ˜¯å¤ªå¤ªå¤ªâ€¦å¤ªæ…¢äº†ï¼</p>
</li>
<li><p>æ¯æ¬¡  $ \rm Gap $  ä¼˜åŒ–ï¼Œæˆ‘ä»¬çš„æ—¶é—´å¤æ‚åº¦æ˜¯<strong>ç´§ç¡®</strong>çš„ $ \Theta(n) $ ã€‚çš„è¿™æ˜¾ç„¶ä¸åˆç®—ï¼Œå› ä¸ºå‡è®¾æˆ‘å½“å‰çš„ $ \boldsymbol{gap} $ ï¼ˆæ–­å±‚ï¼‰æ­£å¥½ä½äºå€’æ•°ç¬¬ä¸€é«˜çš„ç‚¹å’Œå€’æ•°ç¬¬äºŒé«˜çš„ç‚¹ï¼Œé‚£ä¹ˆä¹Ÿå°±ç›¸å½“äºæˆ‘å•æ¬¡ä¼š<strong>æµªè´¹ $ \boldsymbol{\Theta(n)} $ çš„æ—¶é—´</strong>ã€‚</p>
</li>
</ul>
<p>äº‹å®ä¸Šâ€¦æ™®é€šçš„  $ \rm HLPP $  ä»£ç å¹¶ä¸é•¿ï¼Œä¸»è¦é—®é¢˜å°±æ˜¯è¿™ä¸¤ä¸ªã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘ï¼Œå¦‚æœä¸ç”¨å †çš„è¯æ€ä¹ˆåšå‘¢ï¼Ÿ</p>
<p>å‘ƒâ€¦ä¸ç”¨å †çš„æ„æ€å¹¶ä¸æ˜¯æˆ‘ä»¬ä¸ä»é«˜åº¦æœ€å¤§çš„ç‚¹å¼€å§‹æ¨é€ã€‚è¿™ä¸ªåœ°æ–¹éœ€è¦ä¸€ä¸ª $ idea $ â€”â€”åœ¨ $ HLPP $ ä¸­ï¼Œ<strong>é«˜åº¦å‡½æ•° $ \boldsymbol{H(x)} $ å’Œç‚¹æ•°é›†å¤§å° $ \boldsymbol{N(x)} $ æ˜¯å¹¿ä¹‰åŒé˜¶çš„ã€‚</strong> æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä»é«˜åº¦å…¥æ‰‹ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åŸæ¥æ˜¯é€šè¿‡èŠ‚ç‚¹ç¼–å·è®¿é—®èŠ‚ç‚¹ä»¥åŠå…¶é«˜åº¦ï¼Œç°åœ¨æˆ‘ä»¬å¦‚æœä»é«˜åº¦å…¥æ‰‹ï¼Œå†å»è®¿é—®èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥åšåˆ° $ \boldsymbol{O(n)} $ è€Œä¸æ˜¯ $ \boldsymbol{O(n\log n)} $  ã€‚ é‚£ä¹ˆç”±äºåŒä¸€é«˜åº¦çš„èŠ‚ç‚¹æˆ–è®¸æœ‰å¾ˆå¤šï¼Œç›´æ¥å¼€ä¸€ä¸ª $ vector $ ã€‚åœ¨è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬ç”¨ $ vector $ è€Œä¸ç”¨äºŒç»´æ•°ç»„å»ºç«‹äºŒç»´å…³ç³»çš„åŸå› ï¼Œä¸»è¦æ˜¯æˆ‘ä»¬åˆå§‹åŒ–éº»çƒ¦å¾—å¾ˆï¼Œå¦‚æœå¥—ç”¨ $ memset $ æˆ–è€… $ fill $ çš„è¯ï¼Œå¸¸æ•°ä¹‹å¤§å¯æƒ³è€ŒçŸ¥ã€‚</p>
<p>é‚£ä¹ˆè¿™ä¸¤ä¸ªé—®é¢˜å°±é¡ºç†æˆç« åœ°è§£å†³äº†ã€‚ä½†è¿™ä¸ªåœ°æ–¹è¿˜æœ‰ä¸€ä¸ªä¼˜åŒ–ï¼Œå°±æ˜¯è™½ç„¶ $ vector $ å’Œ $ list $ éƒ½æ˜¯çº¿æ€§å®¹å™¨ï¼Œä½†æ˜¯ $ list $ çš„æœ¬è´¨æ˜¯åŒå‘é“¾è¡¨ï¼Œé¢‘ç¹å¤„ç†æ’å…¥åˆ é™¤æ“ä½œæ—¶ä¼šå…·æœ‰æ›´ä¼˜ç§€çš„è¡¨ç°ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸæ¥çš„ $ Gap $ æ•°ç»„æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ $ list $ åšï¼Œä»¥å›¾æ›´å°çš„å¸¸æ•°ã€‚é‚£ä¹ˆè¿™æ—¶å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è™½ç„¶æœ¬è´¨ä¸Šåˆ é™¤æ˜¯å®¹æ˜“çš„ï¼Œä½†æ˜¯ä½ æ€ä¹ˆçŸ¥é“è¦åˆ åŒä¸€é«˜åº¦ä¸‹çš„å“ªä¸ªå…ƒç´ (=@__@=)ï¼Ÿå°±ç®—ä½ çŸ¥é“ï¼Œ $ list $ ä¹Ÿä¸çŸ¥é“å•Š2333</p>
<p>hhhä¸çš®äº†ï¼Œå…¶å®æˆ‘ä»¬è®°å½•ä¸€ä¸‹ä½ç½®å°±å¥½ï¼Œå³è®°å½•ä¸€ä¸‹æ¯ä¸ªèŠ‚ç‚¹åœ¨ $ list $ ä¸­çš„ä½ç½®ï¼Œå•ç‹¬å¼€ä¸€ä¸ª $ Iterator $ ç±»å‹çš„ $ vector $ è®°å½•å³å¯ã€‚</p>
<p>å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬è·å¾—äº† $ 10 $ å€ $ + $ çš„å¸¸æ•°ä¼˜åŠ¿qwqï¼Œæ’’èŠ±èŠ±â€¦</p>
<p>å“¦å¯¹ï¼Œè¿˜æœ‰å‡ ç‚¹æˆ‘debugçš„æ—¶å€™è¢«å‘æ­»çš„ç‚¹ï¼š</p>
<ul>
<li>é‚£ä¸ª $\rm Iterator $ ç±»å‹çš„ $ vector $ å¯¹è±¡æ˜¯ç‚¹çš„ç¼–å·ä¸æ˜¯é«˜åº¦ï¼</li>
<li>æ³¨æ„ä½ çš„ä¸‹æ ‡ï¼ä¸‹æ ‡ï¼å†è¯´ä¸€éï¼Œä¸‹æ ‡ï¼å› ä¸ºSTLè‡ªå¸¦å·¦é—­å³å¼€çš„æ€§è´¨<del>wrnm</del>ï¼Œæ‰€ä»¥ä¸€å®šè¦æ³¨æ„ï¼Œå¦‚æœä½ æ˜¯ $ [1,n] $ é€‰æ‰‹ï¼Œæ³¨æ„ä½ çš„ $ assign $ å‡½æ•°ï¼</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">list</span>&lt;<span class="keyword">int</span>&gt; List ; </span><br><span class="line"><span class="keyword">int</span> step ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, f, next ;</span><br><span class="line">    Edge(<span class="keyword">int</span> to,<span class="keyword">int</span> f,<span class="keyword">int</span> next):to(to),f(f),next(next)&#123;&#125;<span class="comment">//æ²¡æœ‰äººå‘ç°æ­£ä¸‹æ–¹è¿™å¥æ³¨é‡Šå‰åŠå¥å’ŒååŠå¥éƒ½æ˜¯ä¸‰ä¸ªéŸ³èŠ‚çš„å—qaq</span></span><br><span class="line">&#125; ; <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; q, H, \mathrm&#123;Extra&#125;, Set[MAXN], cnt ; List Gap[MAXN] ;<span class="comment">//listï¼Œå°±æ˜¯å¿«ï¼ˆ</span></span><br><span class="line"><span class="comment">//q:é˜Ÿåˆ—ï¼ŒH:é«˜åº¦ï¼Œ\mathrm&#123;Extra&#125;ï¼šæ¯ä¸ªç‚¹çš„è¶…é¢æµï¼ŒSet:â€¦å°±æ˜¯é‚£ä¸ªç»å…¸ç‰ˆHLPPé‡Œçš„å †ï¼Œé«˜åº¦åšç¬¬ä¸€ç»´</span></span><br><span class="line"><span class="keyword">int</span> Ans, N, M, S, T, max_H, now_H ; <span class="built_in">vector</span> &lt;Edge&gt; E[MAXN] ; <span class="comment">/*vectorå­˜è¾¹ï¼ˆæ®è¯´ä¼šå¿«ï¼‰*/</span><span class="built_in">vector</span>&lt;List::iterator&gt; Era_pos ; <span class="comment">//è¾…åŠ©å®šä½+åˆ é™¤</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">eggs</span><span class="params">()</span> </span>&#123; ;&#125;<span class="comment">//for free~</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">my_min</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> a &amp; ((a - b) &gt;&gt; <span class="number">31</span>) | b &amp; ( ~ (a - b) &gt;&gt; <span class="number">31</span>) ;&#125;<span class="comment">//é»‘ç§‘æŠ€</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> f, <span class="keyword">int</span> v, <span class="keyword">int</span> u)</span></span>&#123; E[u].push_back(Edge(v, f, E[v].size())), E[v].push_back(Edge(u, <span class="number">0</span>, E[u].size() - <span class="number">1</span>)) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123; rr <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = gc() ; <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = gc() ;<span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = gc() ; <span class="keyword">return</span> k ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Init_label</span><span class="params">()</span></span>&#123;<span class="comment">//ç­‰ä»·äºä¸€å¼€å§‹çš„é‚£ä¸ªBFSï¼Œåªæ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">    rr <span class="keyword">int</span> i, h = <span class="number">0</span>, t = <span class="number">0</span> ;q.clear(), q.resize(N) ; </span><br><span class="line">    H.assign(N + <span class="number">1</span>, N + <span class="number">1</span>) ; H[T] = <span class="number">0</span> ; q[t ++] = T ;<span class="comment">//ä»Tï¼ˆé«˜åº¦å°çš„ï¼‰å‘å‰æ ‡å·</span></span><br><span class="line">    <span class="keyword">while</span> (h &lt; t)&#123;<span class="comment">//é˜Ÿåˆ—â€¦â€¦BFSâ€¦â€¦çœŸç†Ÿæ‚‰å•Šâ€¦â€¦å—â€¦â€¦</span></span><br><span class="line">        rr <span class="keyword">int</span> now = q[h] ; ++ h ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">vector</span> &lt;Edge&gt; :: Iter k = E[now].begin() ; k != E[now].end() ; ++ k)</span><br><span class="line">            <span class="keyword">if</span> (H[k-&gt;to] == N + <span class="number">1</span> &amp;&amp; E[k-&gt;to][k-&gt;next].f) H[k-&gt;to] = H[now] + <span class="number">1</span>, ++ cnt[H[k-&gt;to]], q[t ++] = k-&gt;to ;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">0</span>, N + <span class="number">1</span>) Set[i].clear(), Gap[i].clear() ;<span class="comment">//è¿˜æ˜¯æ¸…ç©ºä¸€ä¸‹æ¯”è¾ƒå¥½å§</span></span><br><span class="line">    rep(i, <span class="number">0</span>, N) </span><br><span class="line">        <span class="keyword">if</span> (H[i]  &lt;N + <span class="number">1</span>)  </span><br><span class="line">            Era_pos[i] = Gap[H[i]].insert(Gap[H[i]].BG, i), <span class="comment">//ç–‘ä¼¼insertå‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæŒ‡é’ˆqaq</span></span><br><span class="line">            (Extra[i]&gt;<span class="number">0</span>) ? Set[H[i]].push_back(i) : eggs() ;<span class="comment">//è¿™ä¸ªå½©è›‹ï¼ˆeggsï¼‰æ˜¯å› ä¸ºï¼Œä¸‰ç›®è¿ç®—ç¬¦":"ä¸¤è¾¹ç±»å‹éœ€è¦å½¢åŒâ€¦</span></span><br><span class="line">    max_H = now_H = H[q[-- t]] ; <span class="comment">//æ›´æ–°ï¼ŒBFSçš„æ€§è´¨ï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¸€å®šé«˜åº¦æœ€å¤§ï¼ˆé™¤äº†æºç‚¹ï¼‰</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Push</span><span class="params">(<span class="keyword">int</span> x, Edge &amp;e)</span></span>&#123;<span class="comment">//å•ç‹¬å†™å‡ºæ¥çš„pushå‡½æ•°ï¼Œå¥½åƒå¾ˆæ–¹ä¾¿ï¼Ÿ</span></span><br><span class="line">    rr <span class="keyword">int</span> now_flow = min(Extra[x], e.f) ;</span><br><span class="line">    Extra[x] -= now_flow, e.f -= now_flow, Extra[e.to] += now_flow, E[e.to][e.next].f += now_flow ;</span><br><span class="line">    <span class="keyword">if</span> (Extra[e.to] &gt; <span class="number">0</span> &amp;&amp; Extra[e.to] &lt;= now_flow) Set[H[e.to]].push_back(e.to) ;  <span class="comment">// push it into "heap"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Push(<span class="keyword">int</span> x)&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, x_h = N, t = H[x] ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span> &lt;Edge&gt; :: Iter k = E[x].BG ; k != E[x].end() ; ++ k)</span><br><span class="line">        <span class="keyword">if</span> (k-&gt;f &gt; <span class="number">0</span>)<span class="comment">//å¦‚æœå¯ä»¥æµ</span></span><br><span class="line">            <span class="keyword">if</span> (H[k-&gt;to] == H[x] - <span class="number">1</span>) &#123; Push(x, *k) ; <span class="keyword">if</span> (!Extra[x]) <span class="keyword">return</span> ;&#125; <span class="keyword">else</span> x_h = min(x_h, H[k-&gt;to] + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">if</span> (cnt[H[x]] &lt;= <span class="number">1</span>)&#123;<span class="comment">//å¦‚æœå‡ºç°æ–­å±‚äº†</span></span><br><span class="line">        <span class="keyword">for</span>(i = t ; i &lt;= max_H ; Gap[i].clear(), ++ i)<span class="comment">//è¿™ä¸ªgapçš„forè‚¯å®šæ¯”O(n)ä¼˜ç§€</span></span><br><span class="line">            <span class="keyword">for</span>(List::Iter k = Gap[i].BG ; k != Gap[i].end() ; ++ k) cnt[H[*k]] --, H[*k] = N ; </span><br><span class="line">        max_H = t - <span class="number">1</span> ; <span class="comment">/*æ–­å±‚ä»¥ä¸Šçš„é«˜åº¦éƒ½æ²¡ç”¨äº†*/</span><span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    -- cnt[t], Era_pos[x] = Gap[t].erase(Era_pos[x]) ; H[x] = x_h ; <span class="keyword">if</span> (x_h == N) <span class="keyword">return</span> ; <span class="comment">//é‡è´´æ ‡ç­¾æ“ä½œï¼Œä¸ºå½“å‰ç‚¹åˆ é™¤åŸæ¥çš„é«˜åº¦</span></span><br><span class="line">    ++ cnt[x_h], Era_pos[x] = Gap[x_h].insert(Gap[x_h].begin(), x), max_H = max(now_H = x_h, max_H), Set[x_h].push_back(x) ;<span class="comment">//å¢æ·»æ–°çš„é«˜åº¦</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">HLPP</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, now ; H.assign(N, <span class="number">0</span>) ; H[S] = N ; Era_pos.resize(N)  ;</span><br><span class="line">    rep(i, <span class="number">0</span>, N - <span class="number">1</span>) <span class="keyword">if</span> (i != S) Era_pos[i] = Gap[H[i]].insert(Gap[H[i]].BG, i) ; </span><br><span class="line">    cnt.assign(N, <span class="number">0</span>), cnt[<span class="number">0</span>] = N - <span class="number">1</span> ; Extra.assign(N, <span class="number">0</span>), Extra[S] = INF, Extra[T] =- INF ;</span><br><span class="line">    rep(i, <span class="number">0</span>, E[S].size() - <span class="number">1</span>) Push(S, E[S][i]) ;  <span class="comment">//ä¸‹é¢æºç‚¹è¦å•ç‹¬æ‹¿å‡ºæ¥æ¨é€ï¼Œå› ä¸ºæºç‚¹æ¨é€æ—¶é«˜åº¦å·®ä¸éœ€è¦=1.</span></span><br><span class="line">    Init_label() ; <span class="comment">//åˆå§‹åŒ–ï¼ˆBFSï¼‰</span></span><br><span class="line">    <span class="keyword">while</span> (now_H &gt;= <span class="number">0</span>) <span class="comment">//æ­£å¼å¼€å§‹HLPPï¼ˆæ³ªç›®ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (Set[now_H].empty()) now_H -- ; <span class="comment">//é«˜åº¦é€’å‡ï¼Œå®ç°ä¸€ä¸ªå †çš„æ•ˆæœ</span></span><br><span class="line">        <span class="keyword">else</span> now = Set[now_H].back(), Set[now_H].pop_back(), _Push(now) ;</span><br><span class="line">    <span class="keyword">return</span> Extra[T] + INF ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    N = qr(),; rr <span class="keyword">int</span> i ;<span class="comment">//ä¸‹é¢çš„++Næ˜¯ä¸ºäº†æ—¥åå¥½æ“ä½œqaq</span></span><br><span class="line">    rep(i, <span class="number">1</span>, M) Add(qr(), qr(), qr()) ; ++ N, Ans = HLPP() ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ’’fa~</strong></p>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><ul>
<li>è¿™é“é¢˜çš„ç»å…¸ç‰ˆæœ¬å¥½å‡ ä¸ªæœˆä¹‹å‰æˆ‘å†™äº†ä¸€å¤©â€¦â€¦ç„¶åä»Šå¤©åˆç¿»å‡ºæ¥ï¼Œå‘ç°äº†å·¨ä½¬<code>KevinYu</code>æŠ›äº†ä¸€ä¸ªç‰ï¼Œæˆ‘å°±æ‰“ç®—ä¼˜åŒ–ä¸€æ³¢â€¦â€¦æ¯’ç˜¤å•Šï¼Œä»€ä¹ˆ $ vector $ å­˜è¾¹ã€ $ list $ æˆ‘éƒ½æ˜¯ç¬¬ä¸€æ¬¡ç”¨å‘œå‘œâ€¦â€¦</li>
<li>ä¸å¾—ä¸è¯´â€¦æŸäº›å¤§ä½¬çš„ç é£çœŸæ˜¯ä¸å¯çœ‹å•Šâ€¦éƒ½å†™é¢˜è§£äº†æ€ä¹ˆè¿˜è¿™ä¹ˆâ€¦è¿™ä¹ˆâ€¦ï¼ˆè™½ç„¶è‡ªå·±çš„ä¹Ÿä¸å’‹åœ°qaqï¼‰ </li>
<li>æœ€åï¼Œäººè‰°ä¸æ‹†ï¼Œäººè‰°ä¸æ‹†â€¦</li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>ç½‘ç»œæµ</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œæµ/æœ€å¤§æµ</tag>
        <tag>ç›®æµ‹ç”¨ä¸åˆ°çš„ç®—æ³•ç³»åˆ—</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘Dinic&amp;è´¹ç”¨æµ</title>
    <url>/2018/08/20/net-work-flow%E5%88%9D%E6%AD%A5/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>$2333$è¿™æ˜¯å¥½ä¹…ä¹‹å‰å­¦çš„äº†ï¼Œä¸è¿‡ä¸€ç›´åœ¨å’•å’•å’•å’•ã€‚</p>
<p>ä¸€èˆ¬æ¥è®²ï¼Œæ­£å¸¸çš„ç½‘ç»œæµç¬”è®°ä¸€å¼€å§‹éƒ½æ˜¯è¦ç»™ç½‘ç»œæµå›¾ä¸‹å®šä¹‰çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¸å¦¨ä¹Ÿæ¥å…ˆè¿›è¡Œä¸€æ³¢è¿™ç§æ“ä½œã€‚</p>
<p>é‚£ä¹ˆç½‘ç»œæµå›¾ï¼Œç±»ä¼¼äºæœ‰å‘å›¾ï¼Œè¾¹ä¸Šå¸¦æƒï¼Œä½†æ˜¯è¿™ä¸ªæƒå€¼å˜æˆäº†â€œå®¹é‡â€ã€‚å®šä¹‰å®¹é‡ä¸º $c(u,v) \in E ? c(u,v) : 0$ã€‚åœ¨æ•´å¼ å›¾ä¸­æœ‰ä¸€ä¸ªæºç‚¹å’Œä¸€ä¸ªæ±‡ç‚¹ï¼Œä¸”å¯¹äºæ¯ä¸ªç‚¹æ¥è¯´æœ‰ $\sum f_{in} = \sum f_{out}$ ã€‚å¹¶ä¸”æˆ‘ä»¬äººä¸ºçš„å°† $\rm S$ çš„$f_{in}$ è®¾ç½®ä¸º $0$ ï¼Œ$f_{out}$ è®¾ç½®ä¸º $+\infty$ã€‚$\rm T$ æ­£å¥½ç›¸åã€‚</p>
<h1 id="EK-ç®—æ³•"><a href="#EK-ç®—æ³•" class="headerlink" title="EK ç®—æ³•"></a>EK ç®—æ³•</h1><p>å…¶å®ï¼ŒEK èº«ä¸ºå¤§å®¶çœ¼ä¸­çš„åŸºç¡€ç®—æ³•ï¼Œä»–å±…ç„¶æ˜¯æ¯” Dinicæ™šå‘è¡¨çš„â€¦â€¦</p>
<p>å…¨ç§°æ˜¯ $\rm Edmond-Karp$ ï¼Œç”±ä¸¤ä½ç§‘å­¦å®¶ä¸€èµ·å‘è¡¨çš„ï¼Œå¤æ‚åº¦ä¸Šç•Œå¤§çº¦åœ¨$\Theta(nm^2)$å·¦å³ï¼Œ<del>æ˜¯ä¸ªæ¯”è¾ƒæ²¡ç”¨çš„ç®—æ³•</del>ã€‚</p>
<p>ä»–çš„åŸç†å¦‚ä¸‹ï¼š</p>
<p>1ã€å¢å¹¿è·¯</p>
<p>è¿™ä¸ªä¸œè¥¿å°±æ˜¯æˆ‘ä»¬ä¸æ–­å¯»æ‰¾ä»æºç‚¹åˆ°æ±‡ç‚¹çš„å¯è¡Œè·¯å¾„ï¼Œä¸æ–­æµç›´åˆ°ä¸èƒ½æµä¸ºæ­¢ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆæŠ€å·§å¯è¨€ï¼Œæ¯•ç«Ÿç½‘ç»œæµæ˜¯çº¿æ€§è§„åˆ’è€Œä¸æ˜¯åŠ¨æ€è§„åˆ’ï¼Œå›¾é›†ä¸è§£æ˜¯å•å°„çš„é€»è¾‘å…³ç³»è€Œä¸æ˜¯ä¸€å¯¹å¤šçš„éæ˜ å°„å…³ç³»ã€‚</p>
<p>2ã€ åå‘è¾¹</p>
<p>è™½ç„¶å›¾é›†ä¸è§£æ˜¯å•å°„çš„é€»è¾‘å…³ç³»ï¼Œå³è™½ç„¶å¯¹äºåŒä¸€å¼ å›¾ $\rm G(V, E)$ æ— è®ºæ€ä¹ˆèµ°ï¼Œæœ€ä¼˜è§£ï¼ˆæœ€å¤§æµï¼‰æ€»æ˜¯ä¸€ä¸ªå®šå€¼ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨æ‰§è¡Œç®—æ³•çš„æ—¶å€™å¯èƒ½ä¼šå› ä¸ºé€‰æ‹©äº†é”™è¯¯çš„å¢å¹¿è·¯ç»è€Œå¯¼è‡´ç®—æ³•çš„é”™è¯¯ã€‚æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬è€ƒè™‘å»ºç«‹åå‘è¾¹ã€‚å…¶å®è¿™å°±æ˜¯ä¸€ä¸ªå°å°çš„åæ‚”æ“ä½œã€‚è¿™ä¸ªæ­£ç¡®æ€§åœ¨äºæˆ‘ä»¬å»ºç«‹äº†åå‘è¾¹ï¼Œå¯¹äºæ‰§è¡Œåæ‚”æ“ä½œå¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå¯¹äºæ‰§è¡Œæ­£å¸¸çš„å¢å¹¿æ“ä½œä¹Ÿä¸ä¼šå½±å“ä»€ä¹ˆç»“æœï¼Œå› ä¸ºæ¯•ç«Ÿæ˜¯åå‘è¾¹â€”â€”æ˜¯ä» $\rm T$ è¿å‘ $\rm S$ çš„ï¼Œç­‰åŒäºåŸæ¥æ²¡åå‘è¾¹æ—¶çš„æƒ…å†µã€‚</p>
<p>å—¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç¨‹åºå®ç°çš„æ—¶å€™ï¼Œå¤§æ¦‚å°±æ˜¯è¿™æ ·</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line">    fill(_F, _F + N + <span class="number">1</span>, Inf) ;</span><br><span class="line">    fill(dis, dis + N + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    q.push(S), dis[S] = <span class="number">1</span>, pre[T] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        now = q.front() ; q.pop() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now]; k != <span class="number">-1</span> ; k = e[k].next)&#123;</span><br><span class="line">                <span class="keyword">if</span>(e[k].v &amp;&amp; !dis[e[k].to])&#123;</span><br><span class="line">                    dis[e[k].to] = dis[now] + <span class="number">1</span> ;</span><br><span class="line">                    _F[e[k].to] = min(e[k].v, _F[now]) ;</span><br><span class="line">                    pre[e[k].to] = now, Last[e[k].to] = k ;</span><br><span class="line">                    q.push(e[k].to) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dis[T] != <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _EK()&#123;</span><br><span class="line">    <span class="keyword">while</span>(BFS())&#123;</span><br><span class="line">        now = T, MAX_F += _F[T] ;</span><br><span class="line">        <span class="keyword">while</span>(now != S)</span><br><span class="line">            e[Last[now]].v -= _F[T], e[Last[now] ^ <span class="number">1</span>].v += _F[T], now = pre[now] ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ <code>Last</code> è®°å½•å‰é©±ï¼Œ<code>dis</code> å°±æ˜¯ä¸ªmarkï¼Œ<code>_F</code> æ•°ç»„è®°å½•å¢å¹¿è·¯ä¸Šæœ€å¤§çš„æµé‡ ã€‚</p>
<p>é‚£æˆ‘ä»¬æ¥ä¸‹æ¥åˆ†æå¤æ‚åº¦ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ$\rm EK$ ç”±äºé‡‡ç”¨ $\rm BFS$ï¼Œæ‰€ä»¥æ¯æ¬¡æ‰¾çš„ä¸€å®šæ˜¯æœ€çŸ­è·¯ã€‚è€Œåœ¨æœ€çŸ­è·¯ä¸å˜çš„ä¸€æ®µæ—¶é—´å†…ä¸€æ¡è¾¹å’Œå®ƒçš„åå‘è¾¹ä¸å¯èƒ½éƒ½è¢«å¢å¹¿ï¼ˆå¦‚æœå¢å¹¿åå‘è¾¹çš„è¯ï¼Œ$dis_{min}$ ä¼šåŠ ä¸€ï¼‰ï¼Œæ‰€ä»¥åœ¨æ¯æ¡è¾¹éƒ½ä½œä¸ºæ®‹é‡æœ€å°å€¼å¢å¹¿ä¸€æ¬¡ä¹‹åï¼ˆè‡³å¤š $m$ æ¬¡ï¼‰æœ€çŸ­è·¯å°±ä¼šå¢åŠ ã€‚è€Œæœ€çŸ­è·¯æœ€å¤šä» $2$ å¢åˆ° $n$ ï¼Œæ‰€ä»¥æœ€å¤šå¢å¹¿ $n \times m$ æ¬¡ã€‚è€Œæ¯æ¬¡ $bfs$ è‡³å¤šæ˜¯ $\Theta(m)$ çš„ï¼Œæ‰€ä»¥æ€»å¤æ‚åº¦ä¸Šç•Œæ˜¯ $O(nm^2)$.</p>
<p>ä½†äº‹å®ä¸Šï¼Œéšæœºçš„æ•°æ®å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯è¦è¿œè¿œå°äºè¿™ä¸ªå¤æ‚åº¦ä¸Šç•Œçš„ï¼Œæ‰€ä»¥ $\rm EK$ å¯ä»¥è§£å†³æœ´ç´ çš„æœ€å¤§æµé—®é¢˜ã€‚</p>
<p>å…¨éƒ¨çš„ä»£ç å­˜æ¡£ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">int</span> N, M, S, T ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edges</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next, v ;</span><br><span class="line">&#125;e[MAX &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">int</span> MAX_F, i ;</span><br><span class="line"><span class="keyword">int</span> head[MAX], cnt = <span class="number">-1</span>, pre[MAX], now ;</span><br><span class="line"><span class="keyword">int</span> A, B, C, Last[MAX], _F[MAX], dis[MAX] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &lt;= <span class="string">'9'</span> &amp;&amp; c &gt;= <span class="string">'0'</span>) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    e[++ cnt].to = v, e[cnt].v = w ;</span><br><span class="line">    e[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">    e[++ cnt].to = u, e[cnt].v = <span class="number">0</span> ;</span><br><span class="line">    e[cnt].next = head[v],  head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line">    fill(_F, _F + N + <span class="number">1</span>, Inf) ;</span><br><span class="line">    fill(dis, dis + N + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    q.push(S), dis[S] = <span class="number">1</span>, pre[T] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        now = q.front() ; q.pop() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now]; k != <span class="number">-1</span> ; k = e[k].next)&#123;</span><br><span class="line">                <span class="keyword">if</span>(e[k].v &amp;&amp; !dis[e[k].to])&#123;</span><br><span class="line">                    dis[e[k].to] = dis[now] + <span class="number">1</span> ;</span><br><span class="line">                    _F[e[k].to] = min(e[k].v, _F[now]) ;</span><br><span class="line">                    pre[e[k].to] = now, Last[e[k].to] = k ;</span><br><span class="line">                    q.push(e[k].to) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dis[T] != <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _EK()&#123;</span><br><span class="line">    <span class="keyword">while</span>(BFS())&#123;</span><br><span class="line">        now = T, MAX_F += _F[T] ;</span><br><span class="line">        <span class="keyword">while</span>(now != S)</span><br><span class="line">            e[Last[now]].v -= _F[T], e[Last[now] ^ <span class="number">1</span>].v += _F[T], now = pre[now] ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; S &gt;&gt; T ;</span><br><span class="line">    fill (head + <span class="number">1</span>, head + N + <span class="number">1</span>, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= M; ++ i)</span><br><span class="line">        A = qr(), B = qr(), C = qr(), add(A, B, C) ;</span><br><span class="line">    _EK() ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; MAX_F &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Dinicç®—æ³•"><a href="#Dinicç®—æ³•" class="headerlink" title="Dinicç®—æ³•"></a>Dinicç®—æ³•</h1><p>Dinicåœ¨ EK çš„åŸºç¡€ä¸Šï¼Œé‡‡ç”¨äº†ä¸¤ä¸ªæ–°çš„ä¼˜åŒ–æ–¹æ¡ˆï¼š</p>
<p>$Case1:$ åˆ†å±‚å›¾</p>
<p>æ¯æ¬¡æˆ‘ä»¬é€‰æ‹©ç”¨ $\rm bfs + dfs$ å»å¢å¹¿ä¸€å¼ â€œå¢å¹¿ç½‘â€ï¼Œå¤§ä½“ä¸Šå°±æ˜¯æˆ‘ä»¬è®°å½•æ·±åº¦ï¼ˆæˆ–è€…è¯´æ˜¯ç¦»æºç‚¹çš„æœ€å°è·ç¦»ï¼‰ï¼Œç„¶åæˆ‘ä»¬ç”¨ $\rm dfs$ éå†è¿™å¼ å¢å¹¿ç½‘ã€‚</p>
<p>$Case2:$å½“å‰å¼§</p>
<p>æˆ‘ä»¬ä¾ä»—çš„æ˜¯è¿™ä¸€æ®µï¼ˆå¥ï¼‰ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> &amp;i = cur[now] ; i != <span class="number">-1</span> ; i = line[i].nxt)</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­æ¯”è¾ƒé‡è¦çš„æ˜¯å¼•ç”¨ç¬¦å·ï¼Œæ­¤å¤„å¼•ç”¨çš„ç›®çš„æ˜¯ä¸æ–­æ›´æ–° $cur$ï¼Œè¾¾åˆ°ä¸é‡å¤æšä¸¾å·²ç»æ²¡æœ‰å®¹é‡çš„è¾¹çš„ç›®çš„ã€‚</p>
<p>é‚£ä¹ˆæ•´ä½“ä»£ç å°±æ˜¯ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX 100010</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">int</span> N, M, S, T ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edges</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next, v ; </span><br><span class="line">&#125;e[MAX &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> A, B, C, i ;</span><br><span class="line"><span class="keyword">int</span> head[MAX], cnt = <span class="number">-1</span>, now, cur[MAX], dis[MAX] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &lt;= <span class="string">'9'</span> &amp;&amp; c &gt;= <span class="string">'0'</span>) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    e[++ cnt].to = v, e[cnt].v = w ;</span><br><span class="line">    e[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">    e[++ cnt].to = u, e[cnt].v = <span class="number">0</span> ;</span><br><span class="line">    e[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line">    fill(dis, dis + N + <span class="number">23</span>, <span class="number">0</span>) ;</span><br><span class="line">    q.push(S), dis[S] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        now = q.front() ; q.pop() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now]; k != <span class="number">-1</span> ; k = e[k].next)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!dis[e[k].to] &amp;&amp; e[k].v)</span><br><span class="line">                dis[e[k].to] = dis[now] + <span class="number">1</span>, q.push(e[k].to) ; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dis[T] ? <span class="number">1</span> : <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> St, <span class="keyword">int</span> Aim, <span class="keyword">int</span> Flow)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (St == Aim || !Flow) <span class="keyword">return</span> Flow ; <span class="keyword">int</span> Fl, res = <span class="number">0</span> ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> &amp;k = cur[St] ; k != <span class="number">-1</span>; k = e[k].next)</span><br><span class="line">        <span class="keyword">if</span> (dis[e[k].to] == dis[St] + <span class="number">1</span> &amp;&amp; (Fl = dfs(e[k].to, Aim, min(Flow, e[k].v))))&#123;</span><br><span class="line">            res += Fl, e[k].v -= Fl, e[k ^ <span class="number">1</span>].v+= Fl ;</span><br><span class="line">            Flow -= Fl ; <span class="keyword">if</span> (!Flow) <span class="keyword">break</span> ; </span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dinic</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span>(bfs())&#123;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= N; ++ i) cur[i] = head[i] ;</span><br><span class="line">        res += dfs(S, T, <span class="number">0x7fffffff</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; S &gt;&gt; T ;</span><br><span class="line">    fill (head + <span class="number">1</span>, head + N + <span class="number">1</span>, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= M;  ++ i) </span><br><span class="line">        A = qr(), B = qr(), C = qr(), add(A, B, C) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; Dinic() &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºå¯¹äºä¸€æ¬¡$dfs$ï¼Œåœ¨åŒä¸€å¼ åˆ†å¥½å±‚æ¬¡çš„å›¾ä¸Šæ‰§è¡Œï¼Œä¸ä¼šå‡ºç°é‡å¤ç”¨ä¸€æ¡è¾¹çš„æƒ…å†µâ€”â€”æˆ‘ä»¬è®¤ä¸ºæ¯æ¡è¾¹å·²ç»æµæ»¡ã€‚é‚£ä¹ˆå½“å‰å¼§å¯ä»¥ä¿è¯ä¸ä¼šé‡å¤èµ°ï¼Œä¹Ÿå°±æ˜¯ä¿è¯äº† Dinic çš„å¤æ‚åº¦ã€‚</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥è¯æ˜ä¸€ä¸‹ Dinicâ€‹ çš„æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p>æ ¹æ®åˆ†å±‚å›¾è€Œè¨€ï¼Œ$t$ çš„å±‚æ¬¡æ˜¯å•è°ƒå¢é•¿çš„â€”â€”å› ä¸ºæ¯æ¬¡å¢å¹¿å®Œæ¯•ä¹‹åå¯¹äºæ¯æ¡å¯è¡Œçš„å¢å¹¿è·¯ï¼Œéƒ½æ€»ä¼šæœ‰è‡³å°‘ä¸€æ¡è¾¹å®¹é‡ä¸ºé›¶ï¼Œæ‰€ä»¥æœ€å¤šä¼šæœ‰ $n$ æ¬¡é‡æ–°åˆ†å±‚ã€‚è€Œå¯¹äºæ¯æ¬¡åœ¨å¢å¹¿ç½‘ä¸Šçš„æ“ä½œï¼Œè‡³å¤šæœ‰ $m$ æ¡å¢å¹¿è·¯ï¼ˆæ¯æ¡è¾¹è‡³å¤šæœ‰ä¸€æ¬¡æœºä¼šç½®é›¶ï¼‰ï¼Œæ¯æ¡å¢å¹¿è·¯è¦å›æº¯+æœç´¢æ€»å…± $2n$ çš„æ“ä½œã€‚é‚£ä¹ˆæ¸è¿›æ„ä¹‰ä¸Šå¤æ‚åº¦å°±æ˜¯$\Theta(n^2m)$çš„ã€‚</p>
<p>å¾ˆæ˜¾ç„¶ï¼Œè¿™åœ¨éšæœºæ•°æ®çš„æƒ…å†µä¸‹ä¹Ÿæ˜¯è·‘ä¸æ»¡çš„ã€‚è€ŒåŠ äº†å½“å‰å¼§ä¼˜åŒ–ï¼Œå¤æ‚åº¦ç†è®ºä¸Šè¿˜æ˜¯ä¸å˜çš„ï¼Œæˆ–è€…è¯´ï¼Œåœ¨è·‘æ»¡çš„æƒ…å†µä¸‹ï¼Œå¤æ‚åº¦æ›´æ¥è¿‘ä¸Šé™å¤æ‚åº¦$\Theta(n^2m)$ ã€‚</p>
<p>æ®è¯´éšæœºå›¾ä¸Šè·‘ä¸ª$1 \cdot 1e4$~$5 \cdot 1e4$æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜çš„ã€‚</p>
<h1 id="æœ€å°è´¹ç”¨æœ€å¤§æµ"><a href="#æœ€å°è´¹ç”¨æœ€å¤§æµ" class="headerlink" title="æœ€å°è´¹ç”¨æœ€å¤§æµ"></a>æœ€å°è´¹ç”¨æœ€å¤§æµ</h1><p>å…¶å®è´¹ç”¨æµâ€¦â€¦å¸¸è§çš„ï¼Œå°±æ˜¯åœ¨æœ€å¤§æµçš„å‰æä¸‹è´¹ç”¨æœ€å°ã€‚é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥æŠŠ EK çš„ $bfs$ æ¢æˆ $\rm SPFA$ å°±è¡Œäº†233</p>
<p>è‡³äºä¸ºä»€ä¹ˆä¸èƒ½ dinicï¼Œå¾ˆæ˜¾ç„¶æ˜¯å› ä¸ºæ²¡æ³•åˆ†å±‚å•Šâ€¦</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> N, M, S, T ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edges</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next, v, c ;</span><br><span class="line">&#125;e[MAX &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">bool</span> mark[MAX] ; <span class="keyword">int</span> MAX_F, MAX_C, i ;</span><br><span class="line"><span class="keyword">int</span> head[MAX], cnt = <span class="number">-1</span>, pre[MAX], now ;</span><br><span class="line"><span class="keyword">int</span> A, B, C, D, Last[MAX], _F[MAX], dis[MAX] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &lt;= <span class="string">'9'</span> &amp;&amp; c &gt;= <span class="string">'0'</span>) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    e[++ cnt].to = v, e[cnt].v = w ;</span><br><span class="line">    e[cnt].next = head[u], e[cnt].c = c, head[u] = cnt ;</span><br><span class="line">    e[++ cnt].to = u, e[cnt].v = <span class="number">0</span> ;</span><br><span class="line">    e[cnt].next = head[v], e[cnt].c = <span class="number">-1</span> * c, head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">SPFA</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line">    fill(_F, _F + N + <span class="number">1</span>, Inf) ;</span><br><span class="line">    fill(dis, dis + N + <span class="number">1</span>, Inf) ;</span><br><span class="line">    fill(mark, mark + N + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">	q.push(S), dis[S] = <span class="number">0</span>, mark[S] = <span class="number">1</span>, pre[T] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        now = q.front() ; q.pop() ; mark[now] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now]; k != <span class="number">-1</span> ; k = e[k].next)</span><br><span class="line">			<span class="keyword">if</span> (dis[e[k].to] &gt; dis[now] + e[k].c &amp;&amp; e[k].v)&#123;</span><br><span class="line">                dis[e[k].to] = dis[now] + e[k].c ;</span><br><span class="line">                _F[e[k].to] = min(e[k].v, _F[now]) ;</span><br><span class="line">                pre[e[k].to] = now, Last[e[k].to] = k ;</span><br><span class="line">				<span class="keyword">if</span>(!mark[e[k].to])&#123;</span><br><span class="line">					q.push(e[k].to) ;</span><br><span class="line">					mark[e[k].to] = <span class="number">1</span> ;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> dis[T] != Inf;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _EK()&#123;</span><br><span class="line">    <span class="keyword">while</span>(SPFA())&#123;</span><br><span class="line">        now = T, MAX_F += _F[T], MAX_C += dis[T] * _F[T] ;</span><br><span class="line">        <span class="keyword">while</span>(now != S)</span><br><span class="line">            e[Last[now]].v -= _F[T], e[Last[now] ^ <span class="number">1</span>].v += _F[T], now = pre[now] ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; S &gt;&gt; T ;</span><br><span class="line">    fill (head + <span class="number">1</span>, head + N + <span class="number">1</span>, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= M; ++ i)</span><br><span class="line">        A = qr(), B = qr(), C = qr(), D = qr(), add(A, B, C, D) ;</span><br><span class="line">    _EK() ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; MAX_F &lt;&lt;<span class="string">" "</span>&lt;&lt; MAX_C &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€ƒè™‘æ˜¯å¦èƒ½ç”¨$dijkstra$æ¥åšã€‚å› ä¸ºå»ºåå‘è¾¹æ˜¯è¦æŠŠä»£ä»·å–è´Ÿï¼Œæ‰€ä»¥éœ€è¦è§£å†³è´Ÿæƒè¾¹é—®é¢˜ã€‚$rqy$ å½“æ—¶æ˜¯è¿™ä¹ˆç»™æˆ‘ä»¬è®²çš„ï¼š</p>
<blockquote>
<p>è€ƒè™‘ç»™æ¯ä¸ªç‚¹åŠ ä¸€ä¸ªâ€œåŠ¿â€$h$ ã€‚ä¸€æ¡$u$ â†’ $v$ çš„è´¹ç”¨ä¸º $c$ çš„è¾¹å˜æˆä¸€æ¡$u$â†’$v$è´¹ç”¨æ˜¯$câˆ’h_v+h_u$ çš„è¾¹ã€‚</p>
</blockquote>
<p>é‚£ä¹ˆæˆ‘ä»¬ä»ç‚¹ $\rm S$ åˆ°ç‚¹ $\rm B$ ç‚¹çš„è·ç¦»ä¾¿ä» $dis_B$ å˜æˆäº† $dis_B + h_s- h_B$ï¼Œæˆ‘ä»¬æœ€ååªéœ€è¦æŠŠåŸæ¥çš„åŠ¿å‡½æ•°å‡å»å³å¯ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬æ€è€ƒåˆ°åº•è¦é€‰å–ä»€ä¹ˆä½œä¸ºåŠ¿å‡½æ•°å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬è€ƒè™‘å°†ä¸Šæ¬¡æ±‚å‡ºçš„æœ€çŸ­è·¯ä½œä¸ºåŠ¿å‡½æ•°ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ$rqy$æ˜¯è¿™ä¹ˆè¯´çš„ï¼š</p>
<blockquote>
<p>è¿™ä¸ºä»€ä¹ˆæ˜¯å¯¹çš„å‘¢? </p>
<p>è€ƒè™‘ä¸€æ¡è¾¹ $uâ†’v$ ï¼Œè´¹ç”¨ä¸º $c$ ã€‚</p>
<p>å¦‚æœå®ƒä¸Šä¸€æ¬¡å¢å¹¿æ—¶æ®‹é‡ä¸ä¸º $0$ ï¼Œé‚£ä¹ˆæ ¹æ®æœ€çŸ­è·¯çš„æ€§è´¨æœ‰$dis_u + c â‰¥ dis_v$ (ä¸ç„¶çš„è¯è¯´æ˜æœ€çŸ­è·¯æ±‚é”™äº†)ã€‚ å¦‚æœå®ƒä¸Šæ¬¡å¢å¹¿æ—¶æ®‹é‡ä¸º $0$ è€Œç°åœ¨ä¸ä¸º $0$ ï¼Œé‚£è¯´æ˜å®ƒçš„åå‘è¾¹è¢«å¢å¹¿äº†ã€‚è€Œå¢å¹¿çš„è·¯å¾„æ˜¯æœ€çŸ­è·¯å¾„ï¼Œåå‘è¾¹æ˜¯ $v â†’ u$ï¼Œè´¹ç”¨ $âˆ’c$ ã€‚æ‰€ä»¥$dis_v$ =$dis_u âˆ’c$ ï¼Œä¹Ÿå°±æ˜¯è¯´ $-c+dis_u âˆ’dis_v = 0$ ä¹Ÿæ˜¯éè´Ÿçš„ï¼Œé‚£ä¹ˆ$w+h_u âˆ’h_v$å°±æ˜¯éè´Ÿçš„ã€‚ </p>
</blockquote>
<p>äºæ˜¯ç°åœ¨å¯ä»¥ç”¨ Dijkstraâ€‹ å¢å¹¿ï¼Œå¾ˆå¿«è€Œä¸”æ›´éš¾å¡ã€‚</p>
<p>è‡³äºä»£ç ï¼Œå¤§æ¦‚é•¿è¿™æ ·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next, c, f ;</span><br><span class="line">&#125;e[MAX &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> H[MAX], S ;</span><br><span class="line"><span class="keyword">int</span> dist[MAX], _F[MAX], Pre[MAX], i, k ;</span><br><span class="line"><span class="keyword">int</span> N, M, A, B, C, D, cnt = <span class="number">-1</span>, x1, x2, head[MAX] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> dist, num ;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> node &amp; now) <span class="keyword">const</span>&#123;<span class="keyword">return</span> dist &gt; now.dist ; &#125;</span><br><span class="line">&#125;; priority_queue&lt;node&gt; q ; <span class="keyword">bool</span> vis[MAX] ; <span class="keyword">int</span> Last[MAX], MAX_F, MAX_C, t, ww ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &lt;= <span class="string">'9'</span> &amp;&amp; c &gt;= <span class="string">'0'</span>) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> f, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    e[++ cnt].to = v, e[cnt].f = f ;</span><br><span class="line">    e[cnt].next = head[u], e[cnt].c = c, head[u] = cnt ;</span><br><span class="line">    e[++ cnt].to = u, e[cnt].f = <span class="number">0</span> ;</span><br><span class="line">    e[cnt].next = head[v], e[cnt].c = <span class="number">-1</span> * c, head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dijkstra</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N; ++ i) dist[i] = _F[i] = Inf, vis[i] = <span class="number">0</span> ;</span><br><span class="line">    q.push((node)&#123;<span class="number">0</span>, S&#125;) ; dist[S] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        node now = q.top() ; q.pop() ; </span><br><span class="line">        <span class="keyword">while</span>(vis[now.num]&amp;&amp;!q.empty()) now = q.top(), q.pop();</span><br><span class="line">        x1 = now.num, x2 = now.dist ; <span class="keyword">if</span>(vis[x1]) <span class="keyword">continue</span> ; </span><br><span class="line">        vis[x1] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span>(k = head[x1] ; k != <span class="number">-1</span> ; k = e[k].next)</span><br><span class="line">            <span class="keyword">if</span> (e[k].f &gt; <span class="number">0</span> &amp;&amp; !vis[e[k].to] &amp;&amp; dist[e[k].to] &gt; x2 + e[k].c + H[x1] - H[e[k].to])&#123;</span><br><span class="line">                <span class="keyword">int</span> T = e[k].to ; dist[T] = x2 + e[k].c + H[x1] - H[T] ;</span><br><span class="line">                _F[T] = min(_F[x1], e[k].f), Pre[T] = x1, Last[T] = k, q.push((node)&#123;dist[T], T&#125;) ;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dist[t] &lt; Inf ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _EK()&#123;</span><br><span class="line">    <span class="keyword">while</span>(dijkstra())&#123;</span><br><span class="line">        ww = t, MAX_F += _F[t], MAX_C += (dist[t] - H[S] + H[t]) * _F[t] ;</span><br><span class="line">        <span class="keyword">while</span>(ww != S)</span><br><span class="line">            e[Last[ww]].f -= _F[t], e[Last[ww] ^ <span class="number">1</span>].f += _F[t], ww = Pre[ww] ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) H[i] += dist[i] ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; S &gt;&gt; t ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) head[i] = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)</span><br><span class="line">        A = qr(), B = qr(), C = qr(), D = qr(), Add(A, B, C, D) ;</span><br><span class="line">    _EK() ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; MAX_F &lt;&lt; <span class="string">" "</span> &lt;&lt; MAX_C &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
        <category>ç½‘ç»œæµ</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œæµ/æœ€å¤§æµ</tag>
        <tag>ç½‘ç»œæµ/è´¹ç”¨æµ</tag>
      </tags>
  </entry>
  <entry>
    <title>éšæƒ³äºŒ Â· ä¸˜å‰å°”</title>
    <url>/2018/08/08/%E9%9A%8F%E6%83%B3%E4%BA%8C/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸€ç‚¹åŠŸåˆ©çš„éæƒ³ï¼Ÿ</p>
<a id="more"></a>
<hr>
<p>â€œéšæƒ³â€ç³»åˆ—ç´¢å¼•ï¼š<a href="http://www.orchidany.cf/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/" target="_blank" rel="noopener">æˆ³æˆ‘</a></p>
<hr>
<p>å•Šâ€¦â€¦è¿˜æœ‰å‡ åå¤©å°±$NOIp$äº†å•Šâ€¦â€¦</p>
<p>ç°åœ¨æ˜¯ä¸‹åˆå››ç‚¹ï¼Œæœºæˆ¿ã€‚</p>
<p>æ¯”æˆ‘å¼±çš„éƒ½åœ¨é¢“åºŸï¼Œæ¯”æˆ‘å¼ºçš„éƒ½åœ¨åšé¢˜ã€‚</p>
<p>å”¯ç‹¬æˆ‘åœ¨å†™åšå®¢ã€‚</p>
<p>æˆ‘åœ¨æƒ³äº›ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<hr>
<p>æˆ‘æ˜¯$pks$ï¼Œæ²¡é”™ï¼Œæˆ‘ä¸æ•¢ç§°è‡ªå·±ä¸º$Flower_pks$ï¼Œä¸æ•¢ç§°è‡ªå·±ä¸ºâ€œèŠ±â€ï¼Œå› ä¸ºè¿™è·Ÿæˆ‘å®åŠ›ä¸ç¬¦â€”â€”æˆ‘ä¸æ˜¯é‚£ä¸ªåœ¨$Luogu$è¿™ä¸ª$OJ$ä¸Šå°æœ‰åæ°”çš„å¤§ä½¬ï¼Œä¸æ˜¯é‚£ä¸ªé¢˜è§£å†™å¾—ååˆ†è¯¦ç»†çš„ä½œè€…ï¼Œæ›´ä¸æ˜¯$SD$é›†è®­é‡Œé¢æ’çš„ä¸Šå·çš„äººã€‚</p>
<p>æ²¡é”™ï¼Œæˆ‘ä¸é…å•Šã€‚</p>
<p>ä¸Šåˆ$rqy$å‡ºé¢˜ï¼Œå¤§æ¦‚æ˜¯è¢«å…¨æ–¹é¢ç¢¾å‹äº†å§ã€‚çœé˜ŸåŸ¹è®­æ—¶è™½ç„¶ä¹Ÿè€ƒä¸å¤šå¥½ï¼Œä½†æ˜¯åœ¨å­¦æ ¡é‡Œè¢«å¹³æ—¥é‡Œç©çš„å¾ˆå¥½çš„æœ‹å‹ç¢¾å‹å´æ˜¯æ›´åŠ ç—›è‹¦â€”â€”æˆ‘çœ‹ä¸è§è·¯ã€‚</p>
<p>æ—è¾¹çš„çª—å¸˜ç´§ç´§åœ°é—­ç€ã€è´´ç€çª—æˆ·ï¼Œå¤šäº‘çš„æ—¥å­é‡Œï¼ŒæŒ¤è¿›æ¥é˜³å…‰æ€»æ˜¯ç»™äººä¸€ç§å¼‚æ ·çš„æ„Ÿè§‰ï¼Œæ´’åœ¨æˆ‘çš„å³è‚©ä¸Šã€‚</p>
<p>æ’‡è¿‡å¤´æ¥çœ‹é”®ç›˜ä¸Šå‘ç€å…‰çš„$w$é”®ï¼Œçªç„¶æœ‰ç§æƒ³å“­çš„æ¬²æœ›ã€‚</p>
<hr>
<p>æˆ‘æ˜¯çœŸå¼±å•Šã€‚</p>
<p>$NOIp$ç°åœ¨çœä¸€éƒ½ä¸ç¨³å§ï¼Œä¹Ÿå°±ä¼šå†™å‡ ä¸ªçœé€‰æ‰ä¼šè€ƒåˆ°çš„æ¿å­äº†ï¼›æ¿å­ä¹Ÿä¸æ€ä¹ˆå¯ä»¥æ‰“å‡ºæ¥å§ï¼Œæ¯•ç«Ÿæ²¡æœ‰å¾ˆå¼ºçš„è®°å¿†åŠ›â€”â€”å¤©ç”Ÿå°±æ˜¯ä¸ªå¼±è€…å•Šã€‚</p>
<p>æˆ‘æ€»æ˜¯ç‰¹åˆ«ç¾¡æ…•åˆ«äººæ•é”çš„ååº”èƒ½äº†ï¼Œç¾¡æ…•ç‹¬åˆ°çš„æ•°å­¦å¤©èµ‹ï¼Œç¾¡æ…•ç¨³é‡çš„ç­”é¢˜ä¹ æƒ¯ï¼Œç¾¡æ…•â€¦â€¦</p>
<p>ä½†æˆ‘ä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚æˆ‘ä¹Ÿä¸æ˜¯ä¸ªå¯Œæœ‰æ¯…åŠ›çš„äººã€‚</p>
<hr>
<p>æˆ‘ä¸€ç›´æå…¶å¯Œæœ‰è‡ªå°Šï¼Œååˆ†çš„è‡ªå°Šã€‚æ‰€ä»¥æˆ‘ä¼šæ‹¼äº†å‘½åœ°å­¦åˆ«äººä¸ä¼šçš„ç®—æ³•ï¼Œå¹¶ä¸”ååˆ†ä¸å–œæ¬¢åˆ«äººå–„æ„çš„å’Œæˆ‘å…±åŒè¿›æ­¥ï¼Œæ¯•ç«Ÿå› ä¸ºæˆ‘å¤ªå¼±å¤ªå¼±ã€‚</p>
<p>æˆ‘å‘ç°æˆ‘è¿™ä¸ªäººå¥½è¯¡å¼‚å•Šâ€¦â€¦å…¶ä½™èµ°$OI$è·¯çš„äººéƒ½æ²¡æœ‰è¿™ç§å¿ƒç†æ³¢åŠ¨ï¼Œåªæœ‰æˆ‘ä¼šæŠŠæ—¶é—´æ”¾åœ¨è¿™ä¸Šé¢å§ã€‚</p>
<p>ä¼°è®¡æ˜¯æˆ‘ä»€ä¹ˆéƒ½ä¸é€‚åˆå§ã€‚</p>
<hr>
<p>å…¶å®æˆ‘ä¸æ˜¯ç‰¹åˆ«å–œæ¬¢å»æ¥è¿‘é‚£äº›å¾ˆå¼ºçš„äººï¼Œå› ä¸ºä»–ä»¬æ€»æ˜¯å‡­ç€è‡ªå·±çš„å®åŠ›ä¸é¡¾åˆ«äººçš„æ„Ÿå—ã€‚å¤§æ¦‚åœ¨è¿™æ ·çš„æ•™è‚²åˆ¶åº¦ä¸‹ï¼Œå­¦ä¹ å¥½ã€å¾—äº†é“¶ç‰Œæˆ–è€…æ€æ ·ï¼Œæ‰ä¼šæœ‰å‘è¨€æƒå§ã€‚</p>
<p>è¿™ç§äººå¼ºåˆ°è®©æˆ‘åŒæ¶ã€‚ä¹Ÿè®©æˆ‘æ‚²å“€ã€‚</p>
<p>å¥½å•¦å¥½å•¦ä½ å¼ºå¥½å•¦â€¦â€¦æˆ‘æ»šç²—å¥½äº†å§â€¦â€¦</p>
<p>æˆ‘å¹¶ä¸æ˜¯å¾ˆæœæ°”ï¼Œä½†æ˜¯ç°å®å´æ€»æ˜¯ä¸å°½äººæ„ã€‚</p>
<p>è¿‡å»æˆ‘ä¸€ç›´èƒ½ä¾é ç€çš„ã€å¯ä»¥åŒ…å®¹æˆ‘çš„äººå·²ç»ä¸æˆ‘ä¸€åˆ«ä¸¤å®½äº†ï¼Œ  ä¼°è®¡ä»¥åä¹Ÿåªèƒ½é è‡ªå·±äº†å§ã€‚</p>
<p>æˆ‘å¹¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘è¦é€‰æ‹©æ‰¿å—è¿™ä¹ˆå¤šï¼Œå¤§æ¦‚æ˜¯å¤©æ€§ä½¿ç„¶å§ã€‚</p>
<hr>
<p>æˆ‘æŠŠä¸˜å‰å°”çš„ä¸€å¥è¯å½“ä½œäººç”Ÿçš„ä¿¡æ¡â€”â€”å½“ç„¶ä¸æ˜¯å”¯ä¸€çš„ä¿¡æ¡ã€‚</p>
<blockquote>
<p>äºŒæˆ˜ç»“æŸåçš„ä¸€å¤©ï¼Œå¹´è€çš„ä¸˜å‰å°”æ¥åˆ°è‹±å›½ä¸‹è®®é™¢ï¼Œååœ¨ä¸€ä¸ªå¹´è½»çš„è®®å‘˜æ—è¾¹ï¼Œçªç„¶é—®é“ï¼šâ€œå¹´è½»äººï¼Œä½ çŸ¥é“æ˜¯ä»€ä¹ˆä¸œè¥¿æ”¯æ’‘æˆ‘åœ¨å„æ–¹é¢éƒ½å–å¾—äº†å¦‚æ­¤å·¨å¤§çš„æˆå°±å—ï¼Ÿâ€è¿™ä¸ªå¹´è½»çš„ä¸€å‘˜ç”¨éå¸¸æ¸´æœ›çš„çœ¼ç¥ç­‰å¾…ç€è¿™ä½å¾·é«˜æœ›ä¼—çš„ä¼Ÿå¤§äººç‰©çš„æ•™è¯²ï¼Œä»–è¯´ï¼šâ€œæˆ‘éå¸¸æƒ³çŸ¥é“ã€‚â€<br>â€œè™šè£å¿ƒï¼å¼ºçƒˆçš„è™šè£å¿ƒï¼â€ä¸˜å‰å°”å¤§å£°è¯´é“ï¼Œéšå³å“ˆå“ˆå¤§ç¬‘ï¼Œèµ·èº«è€Œå»ã€‚</p>
</blockquote>
<p>è·¯åœ¨å“ªå‘¢â€¦â€¦</p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>éšæƒ³/ä¸‹ä¸‹ç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>éšæƒ³ä¸€ Â· å±±ä¸˜</title>
    <url>/2018/08/02/%E9%9A%8F%E6%83%B3%E4%B8%80/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Helloï¼ŒWorldï¼</p>
<a id="more"></a>
<p>â€œéšæƒ³â€ç³»åˆ—ç´¢å¼•ï¼š<a href="http://www.orchidany.cf/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/" target="_blank" rel="noopener">æˆ³æˆ‘</a></p>
<hr>
<p>æˆ‘æ˜¯èŠ±ï¼Œæ¥è‡ªå±±ä¸œï¼Œä»Šæ—¶ä»Šæ—¥å†™ä¸‹è¿™ä¸€ç¯‡ï¼Œåªæ˜¯ä¸ºäº†ç»™å¹¶è‚©çš„$Oiers$ä¸€ä¸ªä¸ç®—å¤šç¾çš„æ•…äº‹ï¼Œä¸ºäº†ç»™åæ¥çš„$Oiers$ä¸€ä¸ªå¯¹æœªæ¥æœ‰æ‰€æœŸæœ›çš„æ„¿æ™¯ã€‚</p>
<p>çœ‹ç€çœ¼å‰å‘é»„çš„ç”µè„‘å±å¹•ï¼Œä¸çŸ¥é“è¯¥è¯´äº›ä»€ä¹ˆã€‚</p>
<p>ç°åœ¨çš„æˆ‘å³å°†é«˜ä¸€ï¼Œæœ‰ç€æ¯”è¾ƒå‰å®³çš„å­¦é•¿ï¼Œå’Œä»€ä¹ˆéƒ½ä¸ä¼šçš„æ•™ç»ƒï¼Œæ¯å¤©æ¥æœºæˆ¿å°±æ˜¯åˆ·é¢˜-&gt;ä¸ä¼š-&gt;åˆ·é¢˜-&gt;ä¸ä¼šã€‚</p>
<p>å¤§æ¦‚æˆ‘é©¬ä¸Šå°±è¦ä¹ æƒ¯äº†å§ã€‚</p>
<p>é—·çƒ­çš„å…«æœˆè®©äººæœ‰ä¸€ç§è¯´ä¸å‡ºçš„æƒ†æ€…ï¼Œå¤§æ¦‚æ˜¯åˆä¸­æ¯•ä¸šæ—§äº‹æœªäº†ï¼Œæˆ–è€…æ˜¯å³å°†$NOIp$ä½†å´å¹¶æ²¡å¤ªå¤§ä¿¡å¿ƒï¼Œæˆ–è€…æ˜¯æ•™ç»ƒæ€»æ˜¯ç»™å‡ºä¸å°½äººæ„çš„å®‰æ’æ‰“ä¹±è®¡åˆ’ã€‚</p>
<p>æˆ‘æç€æ‰‹è¾¹æ–°æ¢ä¸Šçš„çœ¼é•œè…¿å„¿ï¼Œé»˜é»˜åœ°æƒ³åˆ°ã€‚</p>
<p>æˆ‘ä¾ç¨€è®°å¾—å‡ ä¸ªæœˆå‰çš„å¿«ä¹åœºæ™¯ï¼šæ¯å¤©éƒ½åœ¨å­¦æ–°ç®—æ³•ã€ä¸äº¦ä¹ä¹åœ°å­¦ã€åºŸå¯å¿˜é£Ÿåœ°å­¦ã€‚æœ€è®¨åŒåšæ¨¡æ‹Ÿé¢˜ã€ç›ä¸½é¢˜æˆ–è€…æœç´¢é¢˜ã€‚æœ€å–œæ¬¢å»å­¦ä¹ æ–°çš„ç®—æ³•ï¼Œæ‰€ä»¥å¯¼è‡´æˆ‘æ•´å¤©åˆ·æ¨¡æ¿é¢˜ï¼šçº¿æ®µæ ‘ã€$Splay$ã€$LCA$â€¦â€¦å¶å°”ä¼šå…´è‡´ç›ç„¶åœ°å‘å‡ ç¯‡é¢˜è§£ï¼Œä¹Ÿæ€»æ˜¯ä¼šç”¨æœ€ç”ŸåŠ¨çš„è¯­è¨€ï¼Œç›¯ç€$luogu$çš„$markdown$é‚£æ–¹å°å°çš„ç¼–è¾‘æ¡†ï¼Œä¸€ä¸ªå­—ä¸€ä¸ªå­—åœ°ç ç€ã€‚äºŒæœˆçš„åŸ¹è®­è®©æˆ‘è§‰å¾—æ˜¯æœ€æœ‰æ„ä¹‰çš„ä¸€æ¬¡åŸ¹è®­äº†ï¼Œå¤§å¤šæ•°ç²¾è‡´çš„$blog$éƒ½å‡ºè‡ªé‚£æ—¶ã€‚ä¸€èˆ¬éƒ½æ˜¯å›åˆ°å®¾é¦†åï¼Œå¼€å§‹è”æœºé¢“åºŸï¼Œç­‰åˆ°åŠå¤œå‡Œæ™¨å¼€å§‹å†™åšå®¢ï¼Œå†™åˆ°é±¼è‚šæ³›ç™½æˆ–è€…å›°æ„è¢­æ¥æ‰ç½¢ä¼‘ã€‚</p>
<p>å¯çœŸæ˜¯è®©äººé«˜å…´çš„å›å¿†å•Šâ€¦â€¦</p>
<p>å›æƒ³è¿™å‡ ä¸ªæœˆï¼Œå˜åŒ–æ˜¯æ—¥æ–°æœˆå¼‚çš„â€”â€”å°±å¦‚åŒæŠŠä¸€é¢—å°å°çš„çŸ³å­æ‰”è¿›ä¸€æ± é™æ°´ï¼Œèµ·åˆä¸è§å¤šå¤§å£°åŠ¿ï¼Œé™å€™æ‰å¯è§å…¶æ—©å·²æ¶¤è¡äº†åŠæ± â€”â€”æ˜¯æ³¢çº¹å±•å¼€äº†ã€‚ä¸€å¼€å§‹æ¥è¿™å„¿ï¼Œæ˜¯å®åŠ›æ‚¬æ®Šçš„â€”â€”åˆä¸­æœ‰äººåŠªåŠ›ã€ä¹Ÿæœ‰äººä¸åŠªåŠ›ï¼›åˆä¸­æ—¶éƒ½æŒºèªæ˜ï¼Œåœ¨ç­é‡Œéƒ½ååˆ—å‰èŒ…ï¼›åˆä¸­æ—¶ä¸Šå¥¥èµ›å‡ ä¹ç­‰äºé¢“åºŸï¼Œå› ä¸ºæ²¡å¤šå°‘äººçœŸæ­£åœ°åœ¨åšé¢˜â€¦â€¦</p>
<p>å¯æƒœæ—¶å…‰ä¸å®¹è®¸ä¿ç•™åŸæ¥çš„æ¨¡æ ·ã€‚</p>
<p>ä¸»ä»»ç›¯å¾—ç´§ï¼Œæ•™ç»ƒæ€‚ä¸»ä»»ä»è€Œä¹Ÿç›¯å¾—ç´§ï¼›å¤§å¤šæ•°äººéƒ½å› ä¸ºå¤–åŠ›çš„å› ç´ å¿…é¡»è¦åŠªåŠ›ï¼Œä½†ä¹Ÿæœ‰æ ¹æœ¬ä¸æƒ³åŠªåŠ›çš„äººï¼›ä»¥å‰å¯ä»¥éª„å‚²çš„èµ„æœ¬ã€è­¬å¦‚æ–‡åŒ–è¯¾ï¼Œç°åœ¨æ—©å°±å˜æˆäº†ä¸€çº¸ç©ºè°ˆâ€”â€”ä½œä¸ºæ‰€è°“â€œå¥¥èµ›è´Ÿè´£äººâ€çš„æˆ‘ï¼Œçœ‹åˆ°æ¥åˆ°å®éªŒéƒ¨ç¬¬ä¸€æ¬¡çš„æœˆè€ƒæˆç»©æ—¶ï¼Œçœ‹åˆ°çº§éƒ¨å‰äºŒåï¼ˆè¿™ä¸€çº§å®éªŒéƒ¨ä¸€å…±$116$ä¸ªäººï¼‰å……æ–¥ç€æ•°å­¦ç‰©ç†åŒ–å­¦ç”Ÿç‰©å¥¥èµ›çš„äººã€å´åˆè·Ÿä¿¡æ¯å­¦å¥¥èµ›æ²¡æœ‰ä»»ä½•å…³ç³»æ—¶ï¼Œæˆ‘ä¸çŸ¥é“è¯¥æ€ä¹ˆåšã€‚</p>
<p>äºæ˜¯æˆ‘ä¾¿å¼€å§‹åŠ å¤§å‹åŠ›ï¼šç»„ç»‡å­¦ç”Ÿå®šæœŸè®²è¯¾ã€å®šæœŸæ¯”èµ›ã€‚ç”¨è¿™ç§ç©ºæ³›çš„å‹æ¦¨æ—¶é—´çš„è¡Œä¸ºæ¥å‹æ¦¨æ•ˆç‡æ— ç–‘æ˜¯å¯ç¬‘çš„ï¼Œä½†æ˜¯ä¹Ÿèµ·äº†ä¸€éƒ¨åˆ†å¥½çš„æ•ˆæœï¼šå‡ ä¸ª$NOIp$å†…å®¹éƒ½æ²¡ä¼šç†Ÿç»ƒçš„å®¶ä¼™å¼€å§‹è·ƒè·ƒæ¬²è¯•åœ°å­¦ä¹ $Splay$ã€å­¦ä¹ ç½‘ç»œæµâ€¦â€¦æˆ‘ä¸çŸ¥é“è¿™æ ·åšæ˜¯å¦çœŸçš„å¥½ï¼Œå°±å¦‚åŒæˆ‘ä¸çŸ¥é“æˆ‘å­¦ä¹ æ–°ä¸œè¥¿æ˜¯å¦ä¼šåœ¨åæœˆã€ç”šè‡³åä¸€æœˆä¹‹å‰å‹å®æ‰€æœ‰äººçš„ç¥ç»â€”â€”å­¦å®Œæ–°ä¸œè¥¿ã€åè¿‡å¤´æ¥å‘ç°åŸºç¡€å´æ ¹æœ¬ä¸ç‰¢å›ºâ€”â€”å°±å¦‚åŒä¸ºäº†å­¦æ–°çŸ¥è¯†ï¼Œè€Œå»å­¦æ–°çŸ¥è¯†ã€‚è¿™ç§åŠŸåˆ©è®©æˆ‘ä¸çŸ¥é“ç°åœ¨åœ¨èµ°ç€ä¸€æ¡æ€æ ·çš„è·¯ã€‚</p>
<p>ç»ˆäºï¼Œå·®è·å‡ºæ¥äº†ã€‚ç»è¿‡å‡ ä¸ªæœˆè®­ç»ƒã€å®åŠ›å¼ºåŠ²çš„äººè‡ªç„¶æ¶Œäº†ä¸Šæ¥ï¼Œä¹Ÿæœ‰æ ¹æœ¬ä¸è¡Œçš„äººå…‰è¾‰é€æ¸é»¯æ·¡ã€‚äºŒæœˆæ—¶çš„èƒ½åŠ›å±€é¢ç°åœ¨æ—©å°±ä¼šç„•ç„¶ä¸€æ–°ï¼Œæœ‰äººé€‰æ‹©èµ°ï¼Œæœ‰äººé€‰æ‹©è‹Ÿæ´»ã€‚æˆ‘ä¸æ¸…æ¥šåŸæ¥é‚£äº›å……æ»¡éª„å‚²çš„ã€æƒ¬æ„çš„è„¸åºå¦‚ä»Šå»äº†å“ªé‡Œï¼Œæˆ‘åªçŸ¥é“æˆ‘ç»™ä»–ä»¬å®šçš„ç›®æ ‡æ˜¯ä»Šå¹´å…¨éƒ¨çœä¸€ã€æˆ‘åªçŸ¥é“æ¥åˆ°å®éªŒéƒ¨ä¹‹åï¼Œåªèƒ½é€‰æ‹©è´Ÿé‡å‰è¡Œã€‚</p>
<p>çœ‹ç€æœºæˆ¿é‡Œå…¶ä»–äººçš„å˜åŒ–ï¼Œå°±å®›å¦‚ç¿»å®Œäº†ä¸€éƒ¨å°è¯´ä¸€èˆ¬ï¼Œè·Œå®•è€Œç¬¦åˆé€»è¾‘ã€‚</p>
<hr>
<p>å‘Šåˆ«äº†åˆä¸­ï¼Œç•™ä¸‹äº†ä»€ä¹ˆå‘¢ï¼Ÿæˆ–è®¸æ˜¯ç”±äºè‡ªèº«æ„æ°”ç”¨äº‹è€Œç ´åäº†åŸæœ¬çº¯æ´çš„å‹æƒ…ï¼Œä½†æ˜¯æˆ‘ä¸èƒ½â€”â€”çœŸçš„ä¸èƒ½ä»…ä»…æŠŠ$Ta$å½“ä½œä¸€ä¸ªä¸ä¸–å‡ºçš„å¥½æœ‹å‹ã€‚ä½†å½“æˆ‘è·¨è¶Šäº†è‡ªèº«çš„é‚£ä¸€æ­¥ä¹‹åæ‰å‘ç°åŸæ¥æ— äººç­‰å€™ï¼Œæ‰å‘ç°æˆ‘åªèƒ½æŠŠä¸€äº›äº‹æƒ…æŠ›æ’’åœ¨é£é‡Œï¼Œç„¶åå®‰æ…°è‡ªå·±â€œæ²¡äº‹â€ã€‚</p>
<hr>
<p>æˆ‘å–œæ¬¢æå®—ç››ï¼Œå–œæ¬¢ä»–çš„æ­Œé‡Œé¢å”±å‡ºçš„äººé—´æ— å¥ˆã€‚è€Œæœ€å–œæ¬¢çš„æ˜¯ä»–çš„ã€Šå±±ä¸˜ã€‹:</p>
<blockquote>
<p>ç»™è‡ªå·±éšä¾¿æ‰¾äº†ä¸ªç†ç”±ï¼Œ<br> å‘æƒ…çˆ±çš„æŒ‘é€—ï¼Œå‘½è¿çš„å·¦å³ã€‚<br> ä¸è‡ªé‡åŠ›åœ°è¿˜æ‰‹ï¼Œç›´è‡³æ­»æ–¹ä¼‘â€”â€”<br> è¶Šè¿‡å±±ä¸˜â€”â€”è™½ç„¶å·²ç™½äº†å¤´ï¼›<br> å–‹å–‹ä¸ä¼‘â€”â€”æ—¶ä¸æˆ‘äºˆçš„å“€æ„ï¼›<br> è¿˜æœªå¦‚æ„¿è§ç€ä¸æœ½<br> å°±æŠŠè‡ªå·±å…ˆæä¸¢â€”â€”<br> è¶Šè¿‡å±±ä¸˜â€”â€”æ‰å‘ç°æ— äººç­‰å€™ï¼›<br> å–‹å–‹ä¸ä¼‘â€”â€”å†ä¹Ÿå”¤ä¸å›äº†æ¸©æŸ”ï¼›<br> ä¸ºä½•è®°ä¸å¾—ä¸Šä¸€æ¬¡æ˜¯è°ç»™çš„æ‹¥æŠ±<br> åœ¨ä»€ä¹ˆæ—¶å€™ã€‚</p>
</blockquote>
<p>å¤§æ¦‚æ˜¯èƒ½å”±å‡ºæŸ³æ°¸â€œæ¨æŸ³å²¸æ™“é£æ®‹æœˆâ€å‡ åˆ†æ„å‘³çš„å§ã€‚</p>
<p>$2018/8/4$</p>
]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>éšæƒ³/ä¸‹ä¸‹ç¬”</tag>
      </tags>
  </entry>
</search>
