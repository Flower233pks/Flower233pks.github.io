<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Orchidany&#39;w blog</title>
  
  <subtitle>Love is a touch but yet not a touch</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.orchidany.cf/"/>
  <updated>2019-03-20T08:36:32.000Z</updated>
  <id>http://www.orchidany.cf/</id>
  
  <author>
    <name>Orchidany</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>éšæƒ³Â·ç›®æ¬¡è¡¨</title>
    <link href="http://www.orchidany.cf/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/"/>
    <id>http://www.orchidany.cf/2050/12/31/éšæƒ³Â·ç›®æ¬¡è¡¨/</id>
    <published>2050-12-31T14:24:26.000Z</published>
    <updated>2019-03-20T08:36:32.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç»ˆäºåˆå¼€å§‹äº†ã€‚</p><p>æ¢äº†æ–°çš„åšå®¢ï¼ŒæŠŠä¹‹å‰åšå®¢å›­é‡Œçš„ä¸‰ç¯‡æ¬äº†ä¸‹æ¥ã€‚</p><p>æ¯æ¬¡åªè¦æˆ‘å†™ï¼Œä¸€å®šæ˜¯æœ‰ä»€ä¹ˆå¥‡å¦™/ç‰¹æ®Š/æ‚²ä¼¤çš„äº‹æƒ…å‘ç”Ÿï¼Œæˆ–è€…æ˜¯æˆ‘å†…å¿ƒé¢‡ä¸å®é™ã€‚å½“ç„¶ï¼Œå¾€å¾€æ˜¯åè€…èµ·å†³å®šæ€§å› ç´ ã€‚</p><p>æ—¶éš”å‡ ä¸ªæœˆï¼Œæˆ‘è¯»åˆ°ç¬¬ä¸€ç¯‡éšæƒ³æ—¶ï¼Œè™½ç„¶èƒ½æ„Ÿå—å‡ºæš®å¤æ—¶çš„æ— å¥ˆä¸æ‡µæ‡‚ï¼Œä½†æ˜¯è¿˜æ˜¯ååˆ†å¹¸ç¦çš„ã€‚</p><p>è¯»ç¬¬äºŒç¯‡ä¸˜å‰å°”æ—¶ï¼Œæˆ‘å†…å¿ƒåœ¨æ’•è£‚ã€åœ¨çº ç»“ï¼Œæ˜”æ—¥å›°é¡¿éº»æœ¨å´åˆæ•æ„Ÿçš„æˆ‘ï¼Œå†ä¸€æ¬¡å‘ˆç°åœ¨è‡ªå·±çœ¼å‰ï¼Œä»¿ä½›è‡ªå·±ç»å†äº†è¿™ä¹ˆå¤šï¼Œè¿˜æ˜¯åŸæ¥é‚£ä¸ªä¸å˜çš„å°‘å¹´ã€‚</p><p>è¯»æˆ‘$NOIP$çš„å¯ç¤ºå½•çš„æ—¶å€™ï¼Œæˆ‘èƒ½æ„Ÿå—åˆ°æˆ‘æ˜¯å¤šä¹ˆç»æœ›â€”â€”æˆ‘ä¸æ„¿æ„æåŠè¿™ä»¶äº‹ã€‚ä½†æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»é‚£é‡Œé¢è¯»å‡ºäº†æœ€è®©äººåŠ¨å®¹çš„ä¸œè¥¿â€”â€”ç»å¤„é€¢ç”Ÿçš„å¾®èŠ’å¸Œæœ›ä¸é“ºå¤©ç›–åœ°çš„ç»æœ›ï¼Œæ‡µæ‡‚çš„çˆ±ä¸åˆ‡éª¨çš„æ¨ï¼Œç¼ ç»µæ‚ é•¿ï¼Œæ—¶è‡³ä»Šæ—¥ä»ç„¶éœ‡æ‰£æˆ‘çš„çµé­‚ã€‚</p><p>æ˜¯çš„ï¼Œæˆ‘æ˜¯èŠ±ï¼Œä¸€ä¸ªä¸ç†æ™ºçš„$Oier$ã€‚æˆ‘ä¹Ÿæƒ³æ¯å¤©24å°æ—¶æ‹¼å‡º48å°æ—¶çš„æ•ˆç‡ä¸€å¿ƒåšé¢˜ï¼Œä½†æ˜¯æˆ‘åšä¸åˆ°ï¼Œæˆ‘è¡€æ¶²ä¸­å‡ç»“ç€çš„ï¼Œåœ¨å‚¬ä¿ƒæˆ‘å†™ä¸‹æ¥ï¼Œå¿…é¡»è¦å†™ä¸‹æ¥ã€‚</p><p>åœ¨è¿™äº›æ–‡ç« é‡Œï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªè¿·èŒ«çš„é’å¹´å¦‚ä½•æ»¡æ€€çƒ­è¡€ä¸ç»æœ›ï¼Œçœ¼é‡Œé—ªçƒç€æ²§æ¡‘ä¸å¸Œæœ›ï¼Œæ€€é‡Œæ£ç€åæ‰çš„ç²®é£Ÿå’Œå´­æ–°çš„è®ºæ–‡ï¼Œè„šä¸‹è¸ç€å´å²–ä¸å¹³çš„è·¯ï¼Œå‘æ˜å¤©èµ°å»ã€‚</p><p>æ˜¯çš„ï¼Œæˆ‘æ˜¯èŠ±ï¼Œæ¥è‡ªå±±ä¸œï¼Œä½ ç›´æ¥å«æˆ‘èŠ±è¿™ä¸ªIDæˆ–è®¸æˆ‘ä¼šå¾ˆé«˜å…´ï¼Œä½†æ˜¯å¦‚æœä½ è®¤è¯†æˆ‘ä¹Ÿå¯ä»¥ä¸è¿™ä¹ˆæ‹˜æŸã€‚</p>        <div id="aplayer-KLKBhOjo" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-KLKBhOjo"),            narrow: false,            autoplay: false,            showlrc: false,            music: {              title: "èŠ±",              author: "Hello Nico",              url: "Hello Nico-èŠ±.flac",              pic: "/2050/12/31/éšæƒ³Â·ç›®æ¬¡è¡¨/qwq.png",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script><p>ä»¥ä¸‹æ˜¯ç›®å½•ï¼š</p><table><thead><tr><th style="text-align:center">é¢˜ç›®</th><th style="text-align:center">é“¾æ¥ï¼ˆç‚¹å‡»å³å¯ï¼‰</th></tr></thead><tbody><tr><td style="text-align:center">éšæƒ³ä¸€ Â· æ¨æŸ³å²¸æ™“é£æ®‹æœˆ</td><td style="text-align:center"><a href="http://www.orchidany.cf/2018/08/02/%E9%9A%8F%E6%83%B3%E4%B8%80/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³äºŒ Â· ä¸˜å‰å°”</td><td style="text-align:center"><a href="http://www.orchidany.cf/2018/08/08/%E9%9A%8F%E6%83%B3%E4%BA%8C/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³ä¸‰ Â· æœ¬èµ›å­£æœ€åçš„éšæƒ³/å¯ç¤ºå½•</td><td style="text-align:center"><a href="http://www.orchidany.cf/2019/02/14/%E9%9A%8F%E6%83%B3%E4%B8%89%C2%B7NOIP/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³å›› Â· æ•…äººä»Šå®‰å¦ï¼Ÿ</td><td style="text-align:center"><a href="http://www.orchidany.cf/2019/01/01/%E9%9A%8F%E6%83%B3%E5%9B%9B%C2%B7%E6%95%85%E4%BA%BA/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³äº” Â· æ‰‹ä¸­æ²¡æœ‰çº¢ç«ç‘°</td><td style="text-align:center"><a href="http://www.orchidany.cf/2019/02/14/%E9%9A%8F%E6%83%B3%E4%BA%94%C2%B7%E6%83%85%E4%BA%BA%E8%8A%82/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³å…­ Â· éš¾</td><td style="text-align:center"><a href="http://www.orchidany.cf/2019/03/10/%E9%9A%8F%E6%83%B3%E5%85%AD%C2%B7Hard/">$Link$</a></td></tr><tr><td style="text-align:center">$\rm{empty}$</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$\rm{empty}$</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$\rm{empty}$</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="éšæƒ³/ä¸‹ä¸‹ç¬”" scheme="http://www.orchidany.cf/tags/%E9%9A%8F%E6%83%B3-%E4%B8%8B%E4%B8%8B%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>å¤šé¡¹å¼2Â·NTTä»¥åŠä»»æ„æ¨¡æ•°NTT</title>
    <link href="http://www.orchidany.cf/2019/03/17/NTT1-2/"/>
    <id>http://www.orchidany.cf/2019/03/17/NTT1-2/</id>
    <published>2019-03-17T13:13:33.000Z</published>
    <updated>2019-03-19T07:22:16.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="0x01-quad-rm-Preface"><a href="#0x01-quad-rm-Preface" class="headerlink" title="$0x01\quad \rm{Preface}$"></a>$0x01\quad \rm{Preface}$</h1><p>æ— ç‰¹åˆ«è¯´æ˜ï¼Œæœ¬æ–‡ä¸åŒºåˆ†$n$å’Œ$N$ä¸¤ç§ç¬¦å·ï¼Œå‡è¡¨ç¤ºå½¢å¼ä¸º$2^j(j \in \mathbb{N+})$çš„å¤šé¡¹å¼é•¿åº¦ï¼ˆæˆ–è€…ï¼Œæ¬¡æ•°ï¼‰ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äº$FFTâ€‹$è€Œè¨€ï¼Œå…¶å¾—ä»¥ä¼˜åŒ–æˆ$\logâ€‹$çš„æ ¹æœ¬åŸå› æ˜¯æ‰¾åˆ°äº†å•ä½å¤æ ¹è¿™ä¸ªä¸œè¥¿ï¼Œå¯ä»¥æ–¹ä¾¿å¤„ç†+è®¡ç®—ã€‚è€Œå¦ä¸€ç§æ–¹æ³•åˆ™æ˜¯åœ¨æ¨¡æ„ä¹‰ä¸‹ï¼Œåˆ©ç”¨åŸæ ¹çš„ç¾å¦™æ€§è´¨ï¼Œè¿›è¡Œå¤šé¡¹å¼å·ç§¯ã€‚</p><p>$\boldsymbol{NTT~\text{(Fast Number-Theoreti Transform)}}$ï¼Œ<strong>å¿«é€Ÿæ•°è®ºå˜æ¢</strong>ã€‚åœ¨åˆ†æ$NTT$æ˜¯å¦‚ä½•åˆ©ç”¨åŸæ ¹ä¹‹å‰ï¼Œéœ€è¦å…ˆåˆ†æ$FFT$æ˜¯å¦‚ä½•åˆ©ç”¨çš„å•ä½å¤æ ¹$^{[1]}$ï¼š</p><ul><li><p>$\omega_n^n = 1$ã€‚</p></li><li><p>$\omega_n^1,\omega_n^2, \omega_n^3\cdots\omega_n^{n-1}$æ˜¯äº’ä¸ç›¸åŒçš„ï¼Œè¿™æ ·å¸¦å…¥è®¡ç®—æ‰èƒ½ä¿è¯æ’å‡ºä¸€ä¸ªå®Œæ•´çš„$n$æ¬¡å¤šé¡¹å¼ã€‚</p></li><li><p>{$\omega_n^2$} = {$\omega_{\frac{n}{2}}^{2}â€‹$}ï¼Œè¿™ä½¿å¾—é—®é¢˜è§„æ¨¡å¯ä»¥åœ¨è®¡ç®—çš„æ—¶å€™å‡åŠã€‚</p></li><li><p>$$<br>\sum \limits _{k=0}^{n-1} (\omega_n^{j-i})^k =<br> \begin{cases} 0 \quad i \neq j \newline n \quad i = j \newline \end{cases}<br>$$</p></li></ul><p>è¿™æ ·å¯ä»¥ä¿è¯æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ç›¸åŒçš„æ–¹æ³•è¿›è¡Œé€†å˜æ¢ã€‚</p><hr><p>é¦–å…ˆï¼ŒåŸæ ¹çš„åŸºæœ¬å®šä¹‰ï¼šè®¾$g$ä¸º$p$çš„ä¸€ä¸ªåŸæ ¹ï¼Œåˆ™æ»¡è¶³ï¼š<br>$$<br>ğ‘”^{ğ‘âˆ’1}  \equiv 1(\mod p) \\<br>âˆ€1â‰¤ğ‘˜&lt;ğ‘âˆ’1, ğ‘”^ğ‘˜ \not \equiv 1(\mod p)<br>$$<br>æ¢å¥è¯è¯´$g^0,g^1,g^2\cdots,g^{p-2} \quad (\bmod p)$ æ˜¯äº’ä¸ç›¸åŒçš„æ•°ï¼Œæ»¡è¶³æ€§è´¨äºŒã€‚</p><p>åŒæ—¶å¦‚æœæˆ‘ä»¬ä»¤$p-2$ä½œä¸ºè¿™ä¸ªç¾¤çš„é˜¶ï¼Œé‚£ä¹ˆ$g^{p-1}$å’Œ$\omega_n^n$ï¼Œå…¶å®å°±æ˜¯ç­‰ä»·çš„ï¼Œåªä¸è¿‡<br>$$<br>g^{p-1} \equiv1(\bmod~p) \ \omega_n^n=1<br>$$<br>è€Œå·²ã€‚äºæ˜¯å°±æ»¡è¶³æ€§è´¨ä¸€ã€‚</p><p>  è€Œå¯¹äºæ€§è´¨ä¸‰ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘ä¸€ä¸ªè½¬åŒ–ã€‚æˆ‘ä»¬å¦‚æœè¦å°†$gâ€‹$ä½œä¸ºå•ä½æ ¹çš„æ›¿ä»£çš„è¯ï¼Œå°±éœ€è¦ç”¨åˆ°$g^{\frac{p-1}{N}}â€‹$ã€‚æ¢å¥è¯è¯´ï¼Œ$N | (p-1)â€‹$ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥ä»¤$g_n^k \equiv g^{\frac{k(p-1)}{N}} (\bmod~p)â€‹$ï¼Œå¾—åˆ°ä¸€ä¸ªå’Œå•ä½æ ¹ç›¸ä¼¼çš„å½¢å¼ã€‚</p><p>  é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œå› ä¸º$pâ€‹$æ˜¯ç´ æ•°ï¼Œæ‰€ä»¥åœ¨$g_n^n\equiv g^{\frac{N(p-1)}{N}}\equiv g^{p-1} \equiv 1 (\bmod ~p)â€‹$çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$g_{2n}^{n} \equiv1\quad\text{or}\quad \text{-1} (\bmod~ p)â€‹$ï¼Œé‚£ä¹ˆå¹³æ–¹ä¹‹åæ€§è´¨ä¸‰ä¾¿æ˜¾è€Œæ˜“è§ï¼›æˆ–è€…è€ƒè™‘å¦ä¸€ç§æ€è·¯ï¼Œæˆ‘ä»¬æ ¹æ®åˆšæ‰å¾—å‡ºçš„ã€è·ŸäºŒæ¬¡å‰©ä½™æœ‰äº›ç›¸ä¼¼çš„å¼å­ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ç»“è®ºï¼š<br>$$<br>  g_n^{\frac{n}{2}+k}=-g_n^k (\bmod~p)<br>$$<br>  å†ç»“åˆ<del>æ˜¾è€Œæ˜“è¯çš„</del>æ¶ˆå»å¼•ç†$g_n^k \equiv g_{jn}^{jk}$ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè‡ªç„¶åƒ$FFT$è¯æ˜å•ä½å¤æ ¹çš„æŠ˜åŠæ€§ä¸€æ ·ï¼Œè¯å‡ºè¿™ä¸ªç»“è®ºã€‚</p><p>  è‡³äºæ€§è´¨å››ï¼Œè¯æ˜çš„å¤§ä½“ç›¸ä¼¼äºå•ä½å•ä½å¤æ ¹ã€‚å³ï¼š<br>$$<br>  \sum\limits_{j =0}^{n-1}{(g_n^k)^j} \equiv \frac{(g_n^k)^n -1}{g_n^k -1} \Longrightarrow  \frac{(g_n^n)^k -1}{g_n^k -1} \equiv  \frac{(1)^k -1}{g_n^k -1} = 0<br>$$<br>  è€Œå¯¹äº$n=k$çš„æƒ…å†µï¼Œä¸é€‚ç”¨äºæ™®é€šçš„å‡ ä½•çº§æ•°æ±‚å’Œï¼Œæ‰€ä»¥ç›´æ¥å°±æ˜¯$\sum 1 =n$ ã€‚</p><h1 id="0x02-quad-rm-Codes"><a href="#0x02-quad-rm-Codes" class="headerlink" title="$0x02\quad \rm{Codes}$"></a>$0x02\quad \rm{Codes}$</h1><p>å‘ƒï¼Œäºæ˜¯NTTå°±å®Œäº†ã€‚æ³¨æ„å› ä¸ºè¦ä¿è¯$N | (p-1)$ï¼Œä¸”$N$æ˜¯$2$çš„å¹‚æ¬¡ï¼Œæ‰€ä»¥ç´ æ•°$p$ä¸€å®šè¦æ˜¯$2^j+1$çš„å½¢å¼ã€‚</p><p>è‡³äºæ±‚åŸæ ¹ï¼Œä¸æ˜¯æœ¬ç•Œæ¢è®¨çš„å†…å®¹ã€‚æ™®é€šçš„NTTæ¨¡æ•°ï¼ŒåŸæ ¹å¯ä»¥èƒŒè¿‡ï¼›å…¶ä½™æƒ…å†µæš´åŠ›æ±‚+éªŒè¯å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> N, M, K, qaq ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3000010</span> ;</span><br><span class="line">LL A[MAXN], B[MAXN], Inv ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>) ;</span><br><span class="line"><span class="keyword">int</span> i, j, k, l, Lim = <span class="number">1</span>, L, R[MAXN] ; </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span>, G = <span class="number">3</span>, Gi = <span class="number">332748118</span> ; </span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IO&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> ch_top=<span class="number">4e7</span>+<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">char</span> ch[ch_top],*now_r=ch<span class="number">-1</span>,*now_w=ch<span class="number">-1</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(*++now_r&lt;<span class="string">'0'</span>);</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=*now_r-<span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">while</span>(*++now_r&gt;=<span class="string">'0'</span>)x=x*<span class="number">10</span>+*now_r-<span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">char</span> st[<span class="number">20</span>];<span class="keyword">static</span> <span class="keyword">int</span> top;</span><br><span class="line">    <span class="keyword">while</span>(st[++top]=<span class="string">'0'</span>+x%<span class="number">10</span>,x/=<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">while</span>(*++now_w=st[top],--top);</span><br><span class="line">    *++now_w=<span class="string">' '</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL a, LL b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) (res *= a) %= P ;</span><br><span class="line">        (a *= a) %= P, b &gt;&gt;= <span class="number">1</span> ; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(LL *J, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; R[i]) swap(J[i], J[R[i]]) ;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; Lim; j &lt;&lt;= <span class="number">1</span>)&#123;</span><br><span class="line">    LL Gn = expow(flag == <span class="number">1</span> ? G : Gi, (P - <span class="number">1</span>) / (j &lt;&lt; <span class="number">1</span>)) ;</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; Lim; k += (j &lt;&lt; <span class="number">1</span>) )&#123;</span><br><span class="line">        LL g = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j ; l ++, g = (g * Gn) % P)&#123;</span><br><span class="line">                LL Nx = J[k + l], Ny = g * J[k + j + l] % P ;</span><br><span class="line">                J[k + l] = (Nx + Ny) % P, J[k + j + l] = (Nx - Ny + P) % P ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> IO ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fread(ch,<span class="number">1</span>,ch_top,<span class="built_in">stdin</span>); </span><br><span class="line">    N = read(), M = read() ;</span><br><span class="line">    <span class="keyword">while</span>(Lim &lt;= N + M) Lim &lt;&lt;= <span class="number">1</span>, L ++ ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= N; i ++) A[i] = (read() + P) % P ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= M; i ++) B[i] = (read() + P) % P ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++ ) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>)) ;</span><br><span class="line">    NTT(A, <span class="number">1</span>), NTT(B, <span class="number">1</span>);<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= Lim; i ++) A[i] = (A[i] * B[i]) % P ; Inv = expow(Lim, P - <span class="number">2</span>) ;</span><br><span class="line">    NTT(A, <span class="number">-1</span>) ; <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= N + M; i ++) write((<span class="keyword">long</span> <span class="keyword">long</span>) (A[i] * Inv + P) % P) ; fwrite(ch, <span class="number">1</span>, now_w - ch, <span class="built_in">stdout</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>Gi</code>è¡¨ç¤º$998244353$çš„åŸæ ¹çš„é€†å…ƒã€‚</p><h1 id="0x03-quad-rm-Extending"><a href="#0x03-quad-rm-Extending" class="headerlink" title="$0x03\quad \rm{Extending}$"></a>$0x03\quad \rm{Extending}$</h1><p>æ¥ä¸ŠèŠ‚å†…å®¹ï¼Œ$NTT$æœ¬è´¨ä¸Šæ˜¯åªèƒ½å¤„ç†â€œ$NTT$æ¨¡æ•°ï¼ˆ$p=2^k+1$ï¼‰â€ã€‚ä½†æ˜¯å½“æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œä»»æ„æ¨¡æ•°å–æ¨¡æ—¶ï¼Œå°±éœ€è¦æˆ‘ä»¬ç”¨$CRT$åˆå¹¶ã€‚</p><p>å…ˆå’•ç€qwqâ€¦â€¦</p>]]></content>
    
    <summary type="html">
    
      å¦ä¸€ç§ç¥å¥‡çš„å¤šé¡¹å¼å·ç§¯æ±‚æ³•ï¼Œæ¯”FFTåº”ç”¨è¦å¹¿æ³›ã€‚
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="å¤šé¡¹å¼" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="å¤šé¡¹å¼-NTT" scheme="http://www.orchidany.cf/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F-NTT/"/>
    
  </entry>
  
  <entry>
    <title>æœ‰è¶£çš„æ•°å­¦é¢˜ Â· [NOI2002]Savage/[Violet Â· 5]æ¨±èŠ±</title>
    <link href="http://www.orchidany.cf/2019/03/17/Math1/"/>
    <id>http://www.orchidany.cf/2019/03/17/Math1/</id>
    <published>2019-03-17T10:36:37.000Z</published>
    <updated>2019-03-17T11:51:04.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98-skyblue.svg" alt=""></p><h2 id="rm-NOI2002-Savage"><a href="#rm-NOI2002-Savage" class="headerlink" title="$\rm{[NOI2002]}$ Savage"></a>$\rm{[NOI2002]}$ Savage</h2><p>é“¾æ¥ï¼š<a href="https://www.lydsy.com/JudgeOnline/problem.php?id=1407" target="_blank" rel="noopener">$\color{violet}{Link}â€‹$</a> </p><h3 id="rm-Sol"><a href="#rm-Sol" class="headerlink" title="$\rm{Sol}$"></a>$\rm{Sol}$</h3><p>ä¸ç®—ç‰¹åˆ«éš¾â€¦å…¶å®å°±æ˜¯æ±‚æ–¹ç¨‹$$C_{i}+P_{i}x \equiv C_j+P_jx ~(\bmod ~M)$$ä¸å­˜åœ¨ä¸€ä¸ªè§£ä½¿å¾—$x \leq min(L_i,L_j)$æ—¶ï¼Œ$M$çš„æœ€å°å€¼ã€‚ç„¶åå› ä¸ºé¢˜ç›®ä¸­çš„æ•°æ®ï¼Œå‡è®¾æˆ‘ä»¬ä»¤æ¯ä¸ªé‡äººéƒ½åªæ˜¯ç»•ç€åœˆèµ°è€Œä¸é‡å¤ç»è¿‡å¯¹æ–¹çš„è·¯å¾„â€”â€”å³$M$çš„æœ€å¤§å€¼ï¼Œä¹Ÿä¸è¿‡æ˜¯$100\times 106\times 100 = O(1e6)$çš„çº§åˆ«ï¼Œäºæ˜¯è€ƒè™‘ç›´æ¥æšä¸¾$M$, ç„¶åcheckã€‚ç”±äºæœ€å¤šå…±æœ‰$15$ä¸ªé‡äººï¼Œä¸”å•æ¬¡exgcdæ˜¯$\log n $çº§åˆ«çš„ï¼Œæ‰€ä»¥å¤æ‚åº¦ä¸Šé™æ˜¯$O (Mn^2 \log C_{max}) &lt; \Omega(1e8)$çº§åˆ«çš„ã€‚å¦‚æœä¸æ˜¯ç²¾å¿ƒæ„é€ æ•°æ®çš„è¯ï¼Œå¯ä»¥ç›´æ¥è‰¹è¿‡å»ã€‚</p><p>å–œé—»ä¹è§çš„æ˜¯â€¦â€¦æˆ‘çš„exgcdä¼¼ä¹ä¸€å¼€å§‹æœ‰é—®é¢˜ï¼Ÿæˆ‘ä¸€å¼€å§‹æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span>(j = i + <span class="number">1</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">int</span> a = P[i] - P[j], b = M, x, y, w = C[j] - C[i] ;</span><br><span class="line">            <span class="keyword">int</span> qwq = exgcd(x, y, a, b) ; <span class="keyword">if</span> (w % qwq) <span class="keyword">continue</span> ;</span><br><span class="line">            x = x * w / qwq ; <span class="keyword">while</span> (x &lt;= <span class="number">0</span>) x += M ; <span class="keyword">if</span> (x &lt;= min(L[i], L[j])) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åè§‰å¾—ä¸€ç‚¹é—®é¢˜éƒ½æ²¡æœ‰ï¼Œ$40pts$ä¹‹åæ„£äº†å¤§åŠå¤©ã€‚</p><p>è€Œäº‹å®ä¸Šè¿™ä¸ªåœ°æ–¹$x$åº”è¯¥æ˜¯ä¸€ä¸ªç‰¹è§£ï¼Œè€Œä¸æ˜¯æœ€å°è§£ã€‚æ¢å¥è¯è¯´æˆ‘ä¸ºäº†æ±‚å‡ºå‡†ç¡®çš„$x$ï¼Œåº”è¯¥ä¸æ–­å–æ¨¡$b/ \gcd(a,b)$</p><p>ä¸ºä»€ä¹ˆï¼Ÿè‡³äºä¸ºä»€ä¹ˆï¼Œä¸€å¼€å§‹æˆ‘ä¹Ÿæ‡µçš„å¾ˆã€‚ç›´åˆ°æˆ‘ç¿»å‡ºæ¥å¾ˆä¹…ä¹‹å‰æˆ‘çš„ä¸€ç¯‡é¢˜è§£ï¼š</p><blockquote><p>_è¿™æ˜¯ä¸Šé¢è¿™ä¸ªå¼å­ä¸ºä»€ä¹ˆå¯ä»¥è¿™ä¹ˆåšçš„è¯æ˜ï¼š_</p><p>è‹¥æœ‰$ax+by=c$ä¸”$a_0x+b_0y=c$</p><p>é‚£ä¹ˆä¾¿æœ‰$a(x-x_0)+b(y-y_0)=0$<br>ä¸¤è¾¹åŒæ—¶é™¤ä»¥$gcd(a,b)$å¯å¾—ï¼š<br>$\frac{a}{gcd(a,b)}(x-x_0)=-\frac{b}{gcd(a,b)}(y-y_0)$ $ \quad$ $(1)$</p><p>è€Œå› ä¸º</p><p>$(\frac{a}{gcd(a,b)},\frac{b}{gcd(a,b)})=1$</p><p>æ‰€ä»¥ç”±$(1)$å¯å¾—$\frac{b}{gcd(a,b)}$æ•´é™¤$(x-x_0)$</p><p>æ‰€ä»¥å¾ˆæ˜¾ç„¶æœ‰$\frac{b}{gcd(a,b)}\times{t}={(x-x_0)},t \in Z$</p><p>é‚£ä¹ˆå°±æœ‰å¯¹äºä»»æ„ä¸€ä¸ª$x_i$ï¼Œæœ‰</p><p>$ x_i=x_0+\frac{b}{gcd(a,b)} \times{t} $</p></blockquote><p>æˆ‘ç‰¹ä¹ˆâ€¦æ™ºå•†å·²ç»å›é€€åˆ°ä¸Šä¸ªä¸–çºªäº†å§$\rm{qaq}$ï¼Œè‡ªé—­äº†ã€‚</p><p>è¿™å°±æ˜¯æˆ‘æ•´ç†è¿™é“é¢˜çš„åŸå› â€¦â€¦è¿˜æœ‰ï¼Œä¸Šé¢$P_i-P_j$ä¼¼ä¹éœ€è¦å–æ¨¡å¹¶ä½¿å…¶å˜æˆæ­£çš„ï¼Œå› ä¸ºå¥½åƒæˆ‘çš„$exgcd$é‡Œé¢é™åˆ¶äº†$A&gt;0$çš„ç¼˜æ•…ã€‚</p><p>å¿ƒå¾—ï¼šæˆ‘é€€å½¹å§å˜¤ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i, j, N, M, C[MAXN], P[MAXN], L[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y, <span class="keyword">int</span> A, <span class="keyword">int</span> B)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!B) &#123; x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> A ;&#125;</span><br><span class="line">    <span class="keyword">int</span> t = exgcd(y, x, B, A % B) ; y -= A / B * x ; <span class="keyword">return</span> t ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">        <span class="keyword">for</span>(j = i + <span class="number">1</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">int</span> a = (P[i] - P[j] + M) % M + M, b = M, x, y, w = C[j] - C[i], qwq = exgcd(x, y, a, b) ; <span class="keyword">if</span> (w % qwq) <span class="keyword">continue</span> ; </span><br><span class="line">            x = x * w / qwq ; x = (x % (M / qwq) + (M / qwq)) % (M / qwq) ; <span class="keyword">if</span> (!x) x += (M / qwq) ; <span class="keyword">if</span> (x &lt;= min(L[i], L[j])) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;C[i], &amp;P[i], &amp;L[i]), M = max(M, C[i]) ;</span><br><span class="line">    <span class="keyword">for</span> ( M ; ; ++ M) <span class="keyword">if</span> (check()) &#123; <span class="built_in">cout</span> &lt;&lt; M &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="rm-Violetï½5-æ¨±èŠ±"><a href="#rm-Violetï½5-æ¨±èŠ±" class="headerlink" title="$\rm{[Violetï½5]}$ æ¨±èŠ±"></a>$\rm{[Violetï½5]}$ æ¨±èŠ±</h2><p>é“¾æ¥ï¼š<a href="https://www.lydsy.com/JudgeOnline/problem.php?id=2721" target="_blank" rel="noopener">$\color{violet}{Link}â€‹$</a> </p><p>è¿™æ˜¯å¥½ä¹…ä¹‹å‰åšçš„ä¸€é“é¢˜ï¼Œçªç„¶è¢«æˆ‘å‘ç°äº†ã€‚å¤§æ¦‚å°±æ˜¯æ±‚æ–¹ç¨‹$$\frac{1}{x}+\frac{1}{y} = \frac{1}{n!}\quad (n \leq 1e6)$$çš„è§£çš„ç»„æ•°ã€‚</p><h3 id="rm-Sol-1"><a href="#rm-Sol-1" class="headerlink" title="$\rm{Sol}$"></a>$\rm{Sol}$</h3><p>ä¸æƒ³æ€è€ƒç³»åˆ—é—®é¢˜ï¼Œæˆ‘è¿™ä¹ˆæ‡’è¿˜æ˜¯é€€å½¹å§ã€‚(sigh)</p><p>æˆ‘ä»¬å°†æŸ¿å­å˜ä¸ªå½¢ï¼š<br>$$<br>\frac{x+y}{xy} = \frac{1}{n!} \\<br>n!x + n!y = xy<br>$$<br><del>ç„¶åæˆ‘å°±ä¸ä¼šäº†ï¼Œæ­¤é¢˜å®Œç»“</del></p><p>ç„¶åæœ‰ä¸€æ­¥å¾ˆå¦™çš„æ˜¯ä¸¤è¾¹åŒæ—¶$+(n!)^2$å¾—åˆ°ï¼š<br>$$<br>(n!)^2 + n!(x+y) -n!(xy) = (n!)^2\\<br>(n!-x)(n!-y)=(n!)^2<br>$$<br>ç„¶åå°±ä¼šå‘ç°æˆ‘ä»¬åªéœ€è¦æ‰¾å‡º$(n!)^2$çš„å› å­ä¸ªæ•°å°±å¥½äº†â€¦</p><p>å¥½åƒæˆ‘ä»æ¥æ²¡æœ‰å†™è¿‡$\tau$çš„æ ·å­ï¼Œæ—¢ç„¶è¿™æ ·æˆ‘å°±é¡ºä¾¿è®°ä¸€ä¸ªç®—å› å­ä¸ªæ•°çš„å…¬å¼å§ï¼ˆå…¶å®å°±æ˜¯ä¹˜æ³•åŸç†å•¦ï¼‰<br>$$<br>x = \prod p_ix^{a_i} \longleftrightarrow\tau(x) = \prod (a_i+1)<br>$$<br><del>å…¶å®å°±æ˜¯ä¸ºäº†æ°´å­—æ•°</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10000100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Prime[MAXN] ;</span><br><span class="line"><span class="built_in">std</span> :: <span class="built_in">bitset</span> &lt;MAXN&gt; vis ; </span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> N, i, j, cnt, Ans, Cnt[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Ego</span><span class="params">()</span></span>&#123;</span><br><span class="line">vis[<span class="number">1</span>] = vis[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line"><span class="keyword">if</span> (!vis[i]) Prime[++ cnt] = i ;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line"><span class="keyword">if</span> (i * Prime[j] &gt; N) <span class="keyword">break</span> ;</span><br><span class="line">vis[i * Prime[j]] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (!(i % Prime[j])) <span class="keyword">break</span> ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">    <span class="keyword">for</span> (j = Prime[i] ; j &lt;= N ; j *= Prime[i])</span><br><span class="line">        ( Cnt[i] += (N / j) ) %= Mod ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">std</span> :: <span class="built_in">cin</span> &gt;&gt; N ; Ans = <span class="number">1l</span>l, Ego() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= cnt ; ++ i) </span><br><span class="line">        (Ans *= (Cnt[i] &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>) %= Mod ;</span><br><span class="line">    <span class="built_in">std</span> :: <span class="built_in">cout</span> &lt;&lt; Ans % Mod &lt;&lt; <span class="built_in">std</span> :: <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      ä¸¤é“å°æ¸…æ–°æ•°å­¦é¢˜
    
    </summary>
    
      <category term="é¢˜è§£" scheme="http://www.orchidany.cf/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="æ•°å­¦/æ‰©å±•æ¬§å‡ é‡Œå¾·" scheme="http://www.orchidany.cf/tags/%E6%95%B0%E5%AD%A6-%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%B7/"/>
    
      <category term="æ•°å­¦/ç´ æ•°/ç´ æ•°ç­›æ³•" scheme="http://www.orchidany.cf/tags/%E6%95%B0%E5%AD%A6-%E7%B4%A0%E6%95%B0-%E7%B4%A0%E6%95%B0%E7%AD%9B%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>å¥‡å¥‡æ€ªæ€ªçš„çº¿æ®µæ ‘1ï¼ˆå­æ®µå’Œ+æœ€é•¿è¿ç»­ï¼‰</title>
    <link href="http://www.orchidany.cf/2019/03/17/Segment-Tree1/"/>
    <id>http://www.orchidany.cf/2019/03/17/Segment-Tree1/</id>
    <published>2019-03-17T08:52:02.000Z</published>
    <updated>2019-03-17T10:28:16.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt=""></p><p>æœ€è¿‘å¤§æ¦‚æ˜¯æ³›åšäº†çº¿æ®µæ ‘ç›¸å…³é¢˜ç›®ï¼Œä½†æ˜¯è¿™äº›çº¿æ®µæ ‘å¤§æ¦‚éƒ½éœ€è¦æ¯”è¾ƒå¼ºçš„æ€ç»´å’Œæ¯”è¾ƒé•¿çš„ä»£ç â€¦â€¦$2333$</p><h1 id="rm-Task1-å­æ®µå’Œ"><a href="#rm-Task1-å­æ®µå’Œ" class="headerlink" title="$\rm{Task1} $å­æ®µå’Œ"></a>$\rm{Task1} $å­æ®µå’Œ</h1><p>å…¶å®è¿™ä¸ªç®—æ˜¯æ¯”è¾ƒç®€å•çš„äº†ï¼Œæ¯•ç«Ÿ$qyfâ€‹$æ›¾ç»ç»™æˆ‘ä»¬è®²è¿‡ï¼Œå½“æ—¶æˆ‘å°±è§‰å¾—ååˆ†çš„â€¦â€¦éº»çƒ¦233.</p><p>é‚£ä¹ˆä¾‹é¢˜å…¶å®å°±æ˜¯$\rm{SPOJ}$çš„$GSS$ç³»åˆ—â€”â€”çš„å‰ä¸‰é“é¢˜<del>(åå‡ é“é¢˜éƒ½ä¸ä¼šåš)</del></p><h2 id="GSS1-åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ-ä¸å¸¦ä¿®"><a href="#GSS1-åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ-ä¸å¸¦ä¿®" class="headerlink" title="$GSS1$åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ(ä¸å¸¦ä¿®)"></a>$GSS1$åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ(ä¸å¸¦ä¿®)</h2><p><a href="https://www.luogu.org/problemnew/show/SP1043" target="_blank" rel="noopener">$\color{violet}{Link}â€‹$</a></p><p>$2333$åº”è¯¥ç®—æ˜¯æ¯”è¾ƒç®€å•çš„äº†ã€‚æˆ‘ä»¬å¯¹äºæ¯ä¸ªåŒºé—´ç»´æŠ¤ä¸€ä¸ª<strong>åŒºé—´å’Œ</strong>ï¼Œç»´æŠ¤ä¸€ä¸ª<strong>ä»æœ€å·¦ç«¯å¼€å§‹ä¸”å¿…é¡»åŒ…å«æœ€å·¦ç«¯å…ƒç´ çš„æœ€å¤§å­æ®µå’Œ</strong>ï¼Œå†ç»´æŠ¤ä¸€ä¸ª<strong>ä»æœ€å³ç«¯å¼€å§‹ä¸”å¿…é¡»åŒ…å«æœ€å³ç«¯å…ƒç´ çš„æœ€å¤§å­æ®µå’Œ</strong>ï¼Œæœ€åç»´æŠ¤ä¸€ä¸ª<strong>åŒºé—´æœ€å¤§å­æ®µå’Œ</strong>ã€‚</p><p>é‚£ä¹ˆè½¬ç§»($push$_$up$)æ—¶å°±æ˜¾å¾—ååˆ†æ–¹ä¾¿ã€‚æˆ‘ä»¬çš„çˆ¶åŒºé—´çš„$Lmax$åªå–å†³äºå·¦å­åŒºé—´çš„$Lmax$å’Œ<strong>å½“å·¦åŒºé—´çš„$Sum$ç­‰äº$Max$æ—¶ï¼ˆå³å·¦åŒºé—´å…¨éƒ¨éƒ½è¦çº³å…¥åˆ°å…¶æœ€å¤§å­æ®µå’Œä¸­æ—¶ï¼‰</strong>ï¼Œå·¦åŒºé—´çš„$Sum$ä¸å³åŒºé—´çš„$Lmax$çš„å’Œã€‚é‚£ä¹ˆå¯¹äºåŒºé—´çš„$Rsum$ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé“ç†ã€‚æœ€ç»ˆå¯¹äºè¯¥åŒºé—´çš„æœ€å¤§å­æ®µå’Œï¼Œæˆ‘ä»¬<strong>ä¸è€ƒè™‘</strong>ä»å·²ç»è½¬ç§»æ¥çš„$Lmax/Rmax$ï¼Œè€Œæ˜¯è€ƒè™‘ä»å·¦å³åŒºé—´çš„$Max$ä»¥åŠå·¦å³åŒºé—´çš„å’Œæ¥è½¬ç§»ã€‚å¤§ä½“ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_u</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">S(rt) = S(ls(rt)) + S(rs(rt)) ;</span><br><span class="line">Lsum(rt) = max(Lsum(ls(rt)), S(ls(rt)) + Lsum(rs(rt))) ;</span><br><span class="line">Rsum(rt) = max(Rsum(rs(rt)), S(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">Sum(rt) = max(max(Sum(ls(rt)), Sum(rs(rt))), Lsum(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹ï¼šåœ¨è¯¢é—®çš„æ—¶å€™ï¼Œå®ƒæ¯”è¾ƒè†ˆåº”â€¦â€¦å°±æ˜¯ç”±äºæ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥ä½ ä¸èƒ½ç›´æ¥åƒæ™®é€šçš„çº¿æ®µæ ‘ä¸€æ ·è¯¢é—®ç„¶ååŠ èµ·æ¥â€¦â€¦æ‰€ä»¥æ‰€å°±è¦ç±»ä¼¼äºè¾¹è¯¢é—®ï¼Œè¾¹$push_up$è¿™ç§æ„Ÿè§‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Tree <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) <span class="keyword">return</span> T[rt] ; </span><br><span class="line">Tree res, A, B ;</span><br><span class="line"><span class="keyword">if</span> (mid &gt;= R) <span class="keyword">return</span> query(ls(rt), l, mid) ;</span><br><span class="line"><span class="keyword">if</span> (mid &lt; L) <span class="keyword">return</span> query(rs(rt), mid + <span class="number">1</span>, r) ; </span><br><span class="line">A = query(ls(rt), l, mid), B = query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">res.Lsum = max(A.Lsum, A.S + B.Lsum) ; res.Rsum = max(B.Rsum, B.S + A.Rsum) ;</span><br><span class="line">res.Sum = max(max(A.Sum, B.Sum), A.Rsum + B.Lsum) ; res.S = A.S + B.S ; <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ€»ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 200010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max my_Fuckmax</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls(rt) rt &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs(rt) rt &lt;&lt; 1 | 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>  mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">LL S, Sum, Lsum, Rsum ;</span><br><span class="line">&#125;T[MAXN &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> N, M, L, R, base[MAXN] ; </span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> S(x) T[x].S</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Sum(x) T[x].Sum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Lsum(x) T[x].Lsum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Rsum(x) T[x].Rsum</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">my_Fuckmax</span><span class="params">(LL A, LL B)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> A &amp; ((B - A) &gt;&gt; <span class="number">63</span>) | B &amp; ((~(B - A)) &gt;&gt; <span class="number">63</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_u</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">S(rt) = S(ls(rt)) + S(rs(rt)) ;</span><br><span class="line">Lsum(rt) = max(Lsum(ls(rt)), S(ls(rt)) + Lsum(rs(rt))) ;</span><br><span class="line">Rsum(rt) = max(Rsum(rs(rt)), S(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">Sum(rt) = max(max(Sum(ls(rt)), Sum(rs(rt))), Lsum(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">T[rt].Lsum = T[rt].Rsum = </span><br><span class="line">T[rt].S = T[rt].Sum = base[l] ; <span class="keyword">return</span>  ;</span><br><span class="line">&#125; build(ls(rt), l, mid), build(rs(rt), mid + <span class="number">1</span>, r), P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Tree <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) </span><br><span class="line"><span class="keyword">return</span> T[rt] ; </span><br><span class="line">Tree res, A, B ;</span><br><span class="line"><span class="keyword">if</span> (mid &gt;= R) <span class="keyword">return</span> query(ls(rt), l, mid) ;</span><br><span class="line"><span class="keyword">if</span> (mid &lt; L) <span class="keyword">return</span> query(rs(rt), mid + <span class="number">1</span>, r) ; </span><br><span class="line">A = query(ls(rt), l, mid), B = query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">res.Lsum = max(A.Lsum, A.S + B.Lsum) ; res.Rsum = max(B.Rsum, B.S + A.Rsum) ;</span><br><span class="line">res.Sum = max(max(A.Sum, B.Sum), A.Rsum + B.Lsum) ; res.S = A.S + B.S ; <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">register</span> <span class="keyword">int</span> i ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; build(<span class="number">1</span>, <span class="number">1</span>, N) ; <span class="built_in">cin</span> &gt;&gt; M ;</span><br><span class="line"><span class="keyword">while</span> (M --) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;L, &amp;R), <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, query(<span class="number">1</span>, <span class="number">1</span>, N).Sum) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="GSS3-åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ-å¸¦ä¿®"><a href="#GSS3-åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ-å¸¦ä¿®" class="headerlink" title="$GSS3$ åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ(å¸¦ä¿®)"></a>$GSS3$ åŒºé—´æ±‚æœ€å¤§å­æ®µå’Œ(å¸¦ä¿®)</h2><p><a href="https://www.luogu.org/problemnew/show/SP1716" target="_blank" rel="noopener">$\color{violet}{Link}$</a></p><p>â€¦â€¦å…¶å®å§ï¼Œè¿™ä¸ªå¸¦ä¿®ä¸å¸¦ä¿®â€¦â€¦å¥½åƒå½±å“å¹¶ä¸å¤§ï¼Ÿ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 200010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max my_Fuckmax</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls(rt) rt &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs(rt) rt &lt;&lt; 1 | 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>  mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">bool</span> MArk ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">LL S, Sum, Lsum, Rsum ;</span><br><span class="line">&#125;T[MAXN &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> N, M, L, R, base[MAXN] ; </span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> S(x) T[x].S</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Sum(x) T[x].Sum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Lsum(x) T[x].Lsum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Rsum(x) T[x].Rsum</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">my_Fuckmax</span><span class="params">(LL A, LL B)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> A &amp; ((B - A) &gt;&gt; <span class="number">63</span>) | B &amp; ((~(B - A)) &gt;&gt; <span class="number">63</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_u</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">S(rt) = S(ls(rt)) + S(rs(rt)) ;</span><br><span class="line">Lsum(rt) = max(Lsum(ls(rt)), S(ls(rt)) + Lsum(rs(rt))) ;</span><br><span class="line">Rsum(rt) = max(Rsum(rs(rt)), S(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">Sum(rt) = max(max(Sum(ls(rt)), Sum(rs(rt))), Lsum(rs(rt)) + Rsum(ls(rt))) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">T[rt].Lsum = T[rt].Rsum = </span><br><span class="line">T[rt].S = T[rt].Sum = base[l] ; <span class="keyword">return</span>  ;</span><br><span class="line">&#125; build(ls(rt), l, mid), build(rs(rt), mid + <span class="number">1</span>, r), P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Tree <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) </span><br><span class="line"><span class="keyword">return</span> T[rt] ; </span><br><span class="line">Tree res, A, B ;</span><br><span class="line"><span class="keyword">if</span> (mid &gt;= R) <span class="keyword">return</span> query(ls(rt), l, mid) ;</span><br><span class="line"><span class="keyword">if</span> (mid &lt; L) <span class="keyword">return</span> query(rs(rt), mid + <span class="number">1</span>, r) ; </span><br><span class="line">A = query(ls(rt), l, mid), B = query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">res.Lsum = max(A.Lsum, A.S + B.Lsum) ; res.Rsum = max(B.Rsum, B.S + A.Rsum) ;</span><br><span class="line">res.Sum = max(max(A.Sum, B.Sum), A.Rsum + B.Lsum) ; res.S = A.S + B.S ; <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L == l &amp;&amp; L == r)&#123;</span><br><span class="line">T[rt].Sum = T[rt].Lsum = T[rt].Rsum = T[rt].S = k ; <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) change(ls(rt), l, mid, k) ;</span><br><span class="line"><span class="keyword">else</span> change(rs(rt), mid + <span class="number">1</span>, r, k ) ; P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">register</span> <span class="keyword">int</span> i ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; build(<span class="number">1</span>, <span class="number">1</span>, N) ; <span class="built_in">cin</span> &gt;&gt; M ;</span><br><span class="line"><span class="keyword">while</span> (M --) &#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;MArk, &amp;L, &amp;R) ;</span><br><span class="line"><span class="keyword">if</span> (!MArk) change(<span class="number">1</span>, <span class="number">1</span>, N, R) ;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, query(<span class="number">1</span>, <span class="number">1</span>, N).Sum) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="GSS4-åŒºé—´å¼€æ ¹é—®é¢˜"><a href="#GSS4-åŒºé—´å¼€æ ¹é—®é¢˜" class="headerlink" title="$GSS4$ åŒºé—´å¼€æ ¹é—®é¢˜"></a>$GSS4$ åŒºé—´å¼€æ ¹é—®é¢˜</h2><p><a href="https://www.luogu.org/problemnew/show/SP2713" target="_blank" rel="noopener">$\color{violet}{Link}$</a></p><p>è¿™ä¸ªå’Œå­æ®µå’Œä¸€ç‚¹å„¿å…³ç³»éƒ½æ²¡æœ‰ï¼Œé¡ºä¾¿æ•´ä¸€ä¸‹233.</p><p>å°±æ˜¯è®©ä½ åŒºé—´å¼€æ ¹ï¼ˆå‘ä¸‹å–æ•´ï¼‰+æŸ¥è¯¢â€¦â€¦è¿™ä¸ªä¸œè¥¿å¤§æ¦‚å°±æ˜¯å¯¹äºä¸€ä¸ª$2^{63}$å†…çš„æ•°å€¼$N$ï¼Œæˆ‘ä»¬å‡è®¾å…¶å¼€æ ¹$k$æ¬¡å¯ä»¥å¾—åˆ°$N &lt; 2$â€”â€”åªè¦$N &lt; 2$ä¹‹åçš„è®¡ç®—å°±ä¼šé›†ä¸­åœ¨ä¸€ä¸ªç´§ç¡®çš„èŒƒå›´$(1,2)$å†…ï¼Œå‘ä¸‹å–æ•´ä¹‹åæ°¸è¿œéƒ½ä¼šæ˜¯$1$ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦å†å»è€ƒè™‘ã€‚</p><p>é‚£ä¹ˆç°åœ¨ï¼Œæˆ‘ä»¬è‡´åŠ›äºå»ç¡®å®š$k$çš„å€¼åŸŸã€‚æˆ‘ä»¬ä¸å¾—ä¸æ‰¿è®¤ï¼Œ$\sqrt n$åœ¨$[0,+\infty]$æ˜¯å•è°ƒé€’å¢çš„ï¼ŒåŒç†ä¸‰æ¬¡æ–¹æ ¹ä¹Ÿæ˜¯ï¼Œå››æ¬¡æ–¹æ ¹ä¹Ÿæ˜¯â€¦â€¦æ‰€ä»¥æˆ‘ä»¬ä¸å¦¨å–æœ€å¤§å€¼ï¼Œè€ƒè™‘$N=2^{63}$æ—¶ï¼Œ$k$å€¼çš„å¤§å°ã€‚è€Œå¾ˆæ˜¾ç„¶ï¼Œæ­¤æ—¶çš„$k$åº”è¯¥ä¸º$\log _263+1 â‰ˆ 6.978$â€”â€”è¿™ä¼¼ä¹æ˜¯ååˆ†å¹³å‡¡çš„ç»“è®ºã€‚</p><p>æ€»ä¹‹ï¼Œæˆ‘ä»¬å¾—å‡ºï¼Œä¼¼ä¹è¿ç®—æ¬¡æ•°çš„ä¸Šç•Œå°±æ˜¯$kâ‰ˆ7$ï¼Œæ‰€ä»¥è¯´æˆ‘ä»¬ç›´æ¥æš´åŠ›é™¤å°±å¥½äº†ï¼Œèšåˆåˆ†æä¸€ä¸‹ï¼Œå¤æ‚åº¦çš„ä¸Šç•Œä¼¼ä¹æ˜¯$\Omega(7n)$çš„æ ·å­ï¼Œæ— éå°±æ˜¯å¤šå‡ ä¸ªå¸¸æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">ll N, M, K, i, L, R ; </span><br><span class="line">ll base[MAXN], T[MAXN], tot ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">p_u</span><span class="params">(ll rt)</span></span>&#123; ;&#125;</span><br><span class="line"><span class="keyword">void</span> _Build(ll rt, ll l, ll r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)&#123;T[rt] = base[l] ; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    _Build(ls(rt), l, mid) ;</span><br><span class="line">    _Build(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">    T[rt] = T[ls(rt)] + T[rs(rt)] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> ll _query(ll rt, ll l, ll r, ll sl, ll sr)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= sl &amp;&amp; r &lt;= sr) <span class="keyword">return</span> T[rt] ;</span><br><span class="line">    ll ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (mid &gt;= sl) ret += _query(ls(rt), l, mid, sl, sr) ;</span><br><span class="line">    <span class="keyword">if</span> (mid &lt; sr) ret += _query(rs(rt), mid + <span class="number">1</span>, r, sl, sr) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Sqrt(ll rt, ll l, ll r, ll sl, ll sr)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= sl &amp;&amp; r &lt;= sr)&#123;</span><br><span class="line">        <span class="keyword">if</span> (T[rt] &lt;= (r - l + <span class="number">1</span>)) <span class="keyword">return</span> ; </span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">                T[rt] = (<span class="keyword">int</span>)(<span class="built_in">pow</span>((<span class="keyword">double</span>)T[rt], <span class="number">0.5</span>)) ;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (mid &gt;= sl) _Sqrt(ls(rt), l, mid, sl, sr), </span><br><span class="line">   T[rt] = T[ls(rt)] + T[rs(rt)] ;</span><br><span class="line">    <span class="keyword">if</span> (mid &lt; sr) _Sqrt(rs(rt), mid + <span class="number">1</span>, r, sl, sr), </span><br><span class="line">   T[rt] = T[ls(rt)] + T[rs(rt)] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; N)&#123;</span><br><span class="line">    ++ tot, <span class="built_in">printf</span>(<span class="string">"Case #%d:\n"</span>, tot) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= N ; ++ i) base[i] = qr() ;</span><br><span class="line">    _Build(<span class="number">1</span>, <span class="number">1</span>, N) ; <span class="built_in">cin</span> &gt;&gt; M ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        K = qr(), L = qr(), R = qr() ;</span><br><span class="line">        <span class="keyword">if</span> (L &gt; R) swap(L, R) ;</span><br><span class="line">       <span class="keyword">if</span> (K)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, _query(<span class="number">1</span>, <span class="number">1</span>, N, L, R)) ;</span><br><span class="line">            <span class="keyword">continue</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        _Sqrt(<span class="number">1</span>, <span class="number">1</span>, N, L, R) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="rm-Task2-æœ€é•¿è¿ç»­é—®é¢˜"><a href="#rm-Task2-æœ€é•¿è¿ç»­é—®é¢˜" class="headerlink" title="$\rm{Task2}$ æœ€é•¿è¿ç»­é—®é¢˜"></a>$\rm{Task2}$ æœ€é•¿è¿ç»­é—®é¢˜</h1><p>è¿™ä¸ªä¸œè¥¿å…¶å®åº”è¯¥è·Ÿæœ€å¤§å­æ®µå’Œå·®ä¸å¤šâ€”â€”è¦æ±‚çš„éƒ½æ˜¯è¿ç»­çš„ä¸œè¥¿ã€‚å¯¹äºæ‰€æœ‰åŒ…æ‹¬<strong>è¿ç»­</strong>å­—æ ·çš„ä¸œè¥¿ï¼ŒåŸºæœ¬çš„æ€è·¯å¤§æ¦‚éƒ½æ˜¯ç»´æŠ¤ä¸€ä¸ªä»å·¦ç«¯å¼€å§‹çš„ï¼Œç»´æŠ¤ä¸€ä¸ªä»å³ç«¯å¼€å§‹çš„ï¼Œç„¶åä»ä¸‹å‘ä¸Šä¸æ–­$push_up$å³å¯ã€‚</p><p>$emmm$åœ¨è¿™è¾¹æ•´ç†å‡ é“æ€è·¯ä¸é”™çš„é¢˜å§ï¼š</p><h2 id="rm-USACO-é…’åº—-hotel"><a href="#rm-USACO-é…’åº—-hotel" class="headerlink" title="$\rm{USACO}$ é…’åº—($hotel$)"></a>$\rm{USACO}$ é…’åº—($hotel$)</h2><p><a href="https://www.luogu.org/problemnew/show/P2894" target="_blank" rel="noopener">$\color{violet}{Link}$</a></p><p>åˆå§‹çš„ä¸€ä¸ªå…¨é›¶çš„åºåˆ—ï¼Œæˆ‘ä»¬å¯¹å®ƒå‡†ç¡®æ¥è¯´æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ“ä½œï¼š</p><ul><li>åŒºé—´ç½®$0$</li><li>åŒºé—´ç½®$1$</li><li>è¯¢é—®æ˜¯å¦æœ‰ä¸€æ®µé•¿åº¦ä¸º$k$çš„è¿ç»­çš„é›¶åŒºé—´ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œé€‰å–æœ€é å·¦çš„ï¼Œè¾“å‡ºå…¶å·¦ç«¯ç‚¹å¹¶æ‰§è¡Œæ“ä½œâ‘¡</li></ul><hr><p>è¿™ä¸ªé¢˜åœ¨æˆ‘çœ‹æ¥ï¼Œåº”è¯¥ç®—æ˜¯ä¸€ä¸ªæ€ç»´é¢˜ã€‚å¯¹äºæœ€åä¸€ä¸ªæ“ä½œï¼Œæˆ‘ååˆ†åœ°æ‡µé€¼â€”â€”å› ä¸ºæˆ‘å‹æ ¹ä¸çŸ¥é“è¯¥æ€ä¹ˆç»´æŠ¤ã€‚</p><p>ä½†äº‹å®ä¸Šâ€¦â€¦è¿™å°±æ˜¯å­¦æ•°æ®ç»“æ„å­¦å‚»äº†çš„åæœâ€¦â€¦æ¯•ç«Ÿæ•°æ®ç»“æ„åªä¼šæ˜¯ä¸€ä¸ªè¾…åŠ©è€Œå·²ã€‚ä»”ç»†æƒ³æ¥ï¼Œå¥½åƒé™¤äº†æƒå€¼çº¿æ®µæ ‘èƒ½å¤Ÿç»´æŠ¤$\rm{DP}$ä¹‹å¤–ï¼Œæ²¡åšè¿‡ä»€ä¹ˆæ•°æ®ç»“æ„çš„å¥½é¢˜ï¼Œéƒ½æ˜¯ä¸€äº›æ•°æ®ç»“æ„çš„è£¸é¢˜â€¦â€¦å¤§æ¦‚è¿™å°±æ˜¯å­¦å‚»äº†å§ï¼Œåªä¼šä¸“ä¸€çš„ä¸€é—¨å­¦ç§‘ï¼Œæˆ–è€…è¯´åªä¼šä¸“ç²¾ä¸€ç§ä¸œè¥¿â€”â€”è¿˜æ˜¯ååˆ†è ¢ç¬¨è¿Ÿé’åœ°â€œä¸“ç²¾â€ã€‚</p><p>å”‰ï¼Œå¤§æ¦‚æ£€éªŒä¸€ä¸ªäººå­¦æ²¡å­¦è¿‡æ•°æ®ç»“æ„ï¼Œä¸æ˜¯é€šè¿‡ä»–ä¼šä¸ä¼šåšç±»ä¼¼äº$NOI2005$ç»´æŠ¤æ•°åˆ—é‚£æ ·çš„æ¯’ç˜¤è£¸é¢˜ï¼Œè€Œæ˜¯çœ‹ä»–åˆ°åº•å¯ä¸å¯ä»¥å’Œå…¶ä»–çš„ä¸œè¥¿ç»“åˆåœ¨ä¸€èµ·ã€‚å­¦ä¹ å¤§æŠµä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œä¸å¯ä»¥æŠŠå­¦çš„ä¸œè¥¿è¿ç§»åˆ°å…¶ä»–åœ°æ–¹ï¼Œç…§æ ·æ˜¯ç™½å­¦å§ã€‚</p><p>è¯¶ï¼Œå¥½åƒæ‰¯äº†ä»€ä¹ˆå¥‡æ€ªçš„ä¸œè¥¿â€¦â€¦</p><p>å›åˆ°æ­£é¢˜ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘ç›´æ¥ç»´æŠ¤è¿™ä¸ªä¸œè¥¿ï¼Œè€Œæ˜¯<strong>é€šè¿‡ç»´æŠ¤åŒºé—´å†…çš„æœ€é•¿è¿ç»­$0$çš„ä¸ªæ•°ï¼Œè¾¾åˆ°è¾…åŠ©æŸ¥æ‰¾åŒºé—´çš„ç›®çš„</strong>ã€‚é‚£ä¹ˆæˆ‘ä»¬æŸ¥æ‰¾åŒºé—´çš„æ—¶å€™ï¼Œå°±ç›´æ¥**æ‹©æœ€å·¦è¾¹çš„åŒºé—´ä¼˜å…ˆï¼Œå¹¶$check$å…¶æ˜¯å¦æœ‰è¶³å¤Ÿçš„$0$ã€‚</p><p>å¯¹äºæŸ¥è¯¢ï¼Œæˆ‘ä»¬å…ˆæŸ¥è¯¢å·¦åŒºé—´ï¼Œå†æŸ¥è¯¢ä¸­é—´ï¼ˆå·¦åŒºé—´çš„å³è¾¹ä¸å³åŒºé—´çš„å¹¶é›†ï¼‰ï¼Œæœ€åæŸ¥è¯¢å³åŒºé—´ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> Sum, Len, Lsum, Rsum, tag ; </span><br><span class="line">&#125;T[MAXN &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> A, B, N, M, MArk, i, t ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (T[rt].tag == <span class="number">-1</span>) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (T[rt].tag == <span class="number">0</span>)&#123;</span><br><span class="line">T[ls(rt)].tag = T[rs(rt)].tag = <span class="number">0</span> ;</span><br><span class="line">T[ls(rt)].Lsum = T[ls(rt)].Sum = T[ls(rt)].Rsum = <span class="number">0</span> ;</span><br><span class="line">T[rs(rt)].Lsum = T[rs(rt)].Sum = T[rs(rt)].Rsum = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">T[ls(rt)].tag = T[rs(rt)].tag = <span class="number">1</span> ;</span><br><span class="line">T[ls(rt)].Lsum = T[ls(rt)].Sum = T[ls(rt)].Rsum = T[ls(rt)].Len ;</span><br><span class="line">T[rs(rt)].Lsum = T[rs(rt)].Sum = T[rs(rt)].Rsum = T[rs(rt)].Len ;</span><br><span class="line">&#125;</span><br><span class="line">T[rt].tag = <span class="number">-1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (T[ls(rt)].Sum == T[ls(rt)].Len) </span><br><span class="line">T[rt].Lsum = T[ls(rt)].Len + T[rs(rt)].Lsum ;</span><br><span class="line"><span class="keyword">else</span> T[rt].Lsum = T[ls(rt)].Lsum ;</span><br><span class="line"><span class="keyword">if</span> (T[rs(rt)].Sum == T[rs(rt)].Len) </span><br><span class="line">T[rt].Rsum = T[rs(rt)].Len + T[ls(rt)].Rsum ;</span><br><span class="line"><span class="keyword">else</span> T[rt].Rsum = T[rs(rt)].Rsum ;</span><br><span class="line">T[rt].Sum = max(T[ls(rt)].Sum, T[rs(rt)].Sum), </span><br><span class="line">T[rt].Sum = max(T[rt].Sum, T[ls(rt)].Rsum + T[rs(rt)].Lsum) ;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">T[rt].tag = <span class="number">-1</span>,</span><br><span class="line">T[rt].Len = T[rt].Lsum = </span><br><span class="line">T[rt].Rsum = T[rt].Sum = r - l + <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (l == r)&#123; <span class="keyword">return</span> ; &#125;</span><br><span class="line">build(ls(rt), l, mid), build(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (ul &lt;= l &amp;&amp; ur &gt;= r)&#123;</span><br><span class="line">T[rt].tag = k ;</span><br><span class="line"><span class="keyword">if</span> (k == <span class="number">0</span>) T[rt].Lsum = T[rt].Rsum = T[rt].Sum = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">else</span> T[rt].Lsum = T[rt].Rsum = T[rt].Sum = T[rt].Len ;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">push_down(rt) ;</span><br><span class="line"><span class="keyword">if</span> (ul &lt;= mid) update(ls(rt), l, mid, ul, ur, k) ;</span><br><span class="line"><span class="keyword">if</span> (ur &gt; mid) update(rs(rt), mid + <span class="number">1</span>, r, ul, ur, k) ;</span><br><span class="line">push_up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">push_down(rt) ;</span><br><span class="line"><span class="keyword">if</span> (l == r) <span class="keyword">return</span> l ;</span><br><span class="line"><span class="keyword">if</span> (T[ls(rt)].Sum &gt;= A) <span class="keyword">return</span> query(ls(rt), l, mid) ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (T[ls(rt)].Rsum + T[rs(rt)].Lsum &gt;= A) <span class="keyword">return</span> mid - T[ls(rt)].Rsum + <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">return</span> query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">build(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line"><span class="keyword">while</span>(M --)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;MArk) ;</span><br><span class="line"><span class="keyword">if</span> (MArk == <span class="number">2</span>)  <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B), update(<span class="number">1</span>, <span class="number">1</span>, N, A, A + B - <span class="number">1</span>, <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;A) ;</span><br><span class="line"><span class="keyword">if</span> (T[<span class="number">1</span>].Sum &gt;= A)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, t = query(<span class="number">1</span>, <span class="number">1</span>, N)), update(<span class="number">1</span>, <span class="number">1</span>, N, t, t + A - <span class="number">1</span>, <span class="number">0</span>)  ;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'0'</span>), <span class="built_in">putchar</span>(<span class="string">'\n'</span>) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;  <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$emmm$è¿™ä¸ªé¢˜ç é‡å…¶å®ä¸å¤§ï¼Œæ€ç»´å«é‡ä¹Ÿä¸é«˜ï¼Œä½†æ˜¯æˆåŠŸåœ°æŠŠåšæ•°æ®ç»“æ„é¢˜åšå‚»äº†çš„æˆ‘æ‹‰å›äº†æ­£é€”ã€‚</p><h2 id="rm-SCOI-åºåˆ—æ“ä½œ"><a href="#rm-SCOI-åºåˆ—æ“ä½œ" class="headerlink" title="$\rm{SCOI}$ åºåˆ—æ“ä½œ"></a>$\rm{SCOI}$ åºåˆ—æ“ä½œ</h2><p><a href="https://www.luogu.org/problemnew/show/P2572" target="_blank" rel="noopener">$\color{violet}{Link}$</a></p><p>å¯¹äºä¸€ä¸ª$01$åºåˆ—ï¼Œå¤§ä½“æ˜¯è¿™å‡ ç§æ“ä½œï¼š</p><ul><li>åŒºé—´æ¸…é›¶</li><li>åŒºé—´ç½®ä¸º$1$</li><li>åŒºé—´å…¨éƒ¨å–é</li><li>åŒºé—´æŸ¥è¯¢$1$çš„ä¸ªæ•°</li><li>åŒºé—´æŸ¥è¯¢æœ€é•¿è¿ç»­çš„$1$çš„é•¿åº¦</li></ul><p>å¥½çš„ï¼Œè¿™é“é¢˜è¢«æˆ‘ç§’äº†ï¼Œçˆ½å•Šâ€¦â€¦ä¸è¿‡ç§’æ˜¯ç§’äº†ï¼Œå¯¹æ‹è°ƒè¯•æ³•è°ƒäº†å¥½ä¹…$233$ã€‚</p><p>å…¶å®å¯¹äº$1,2,4,5$éƒ½å¥½è¯´ï¼Œåªæ˜¯ç¬¬$3$ä¸ªæ“ä½œï¼Œéœ€è¦å†å¦ç»´æŠ¤åŒºé—´æœ€é•¿è¿ç»­çš„$0$çš„é•¿åº¦ï¼Œå¦‚æœå­˜åœ¨å–éæ ‡è®°ç”Ÿæ•ˆï¼Œå°±äº¤æ¢ä¸€ä¸‹å°±è¡Œã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> OS, OL, OR ;</span><br><span class="line"><span class="keyword">int</span> Sum, Lsum, Len, Rsum, S, tag, t ;</span><br><span class="line"><span class="comment">//tag = 1 -&gt; 1,tag = 0 -&gt; 0, tag = 2 -&gt; xor</span></span><br><span class="line">&#125;T[MAX &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> N, M, MArk, L, R, base[MAX], i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;<span class="comment">//</span></span><br><span class="line">T[rt].S = T[ls(rt)].S + T[rs(rt)].S ;</span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="keyword">if</span> (T[ls(rt)].S == T[ls(rt)].Len) </span><br><span class="line">  T[rt].Lsum = max(T[ls(rt)].Lsum, T[ls(rt)].Len + T[rs(rt)].Lsum) ;</span><br><span class="line"><span class="keyword">else</span>  T[rt].Lsum = T[ls(rt)].Lsum ;</span><br><span class="line"><span class="keyword">if</span> (T[rs(rt)].S == T[rs(rt)].Len) </span><br><span class="line">  T[rt].Rsum = max(T[rs(rt)].Rsum, T[rs(rt)].Len + T[ls(rt)].Rsum) ;</span><br><span class="line"><span class="keyword">else</span>  T[rt].Rsum = T[rs(rt)].Rsum ;</span><br><span class="line">T[rt].Sum = max(T[ls(rt)].Rsum + T[rs(rt)].Lsum, max(T[ls(rt)].Sum, T[rs(rt)].Sum)) ;</span><br><span class="line"><span class="comment">//0</span></span><br><span class="line"><span class="keyword">if</span> (!T[ls(rt)].S) </span><br><span class="line">  T[rt].OL = max(T[ls(rt)].OL, T[ls(rt)].Len + T[rs(rt)].OL) ;</span><br><span class="line"><span class="keyword">else</span>  T[rt].OL = T[ls(rt)].OL ;</span><br><span class="line"><span class="keyword">if</span> (!T[rs(rt)].S) </span><br><span class="line">  T[rt].OR = max(T[rs(rt)].OR, T[rs(rt)].Len + T[ls(rt)].OR) ;</span><br><span class="line"><span class="keyword">else</span>  T[rt].OR = T[rs(rt)].OR ;</span><br><span class="line">T[rt].OS = max(T[ls(rt)].OR + T[rs(rt)].OL, max(T[ls(rt)].OS, T[rs(rt)].OS)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">down</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;<span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (T[rt].tag == <span class="number">-1</span>) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">if</span> (T[rt].t == <span class="number">1</span>)&#123;</span><br><span class="line">T[ls(rt)].tag ^= <span class="number">1</span>, T[rs(rt)].tag ^= <span class="number">1</span> ;</span><br><span class="line">T[ls(rt)].S = T[ls(rt)].Len - T[ls(rt)].S ;</span><br><span class="line">T[rs(rt)].S = T[rs(rt)].Len - T[rs(rt)].S ;</span><br><span class="line"><span class="comment">//l</span></span><br><span class="line">T[ls(rt)].Sum ^= T[ls(rt)].OS ^= T[ls(rt)].Sum ^= T[ls(rt)].OS ;</span><br><span class="line">T[ls(rt)].Lsum ^= T[ls(rt)].OL ^= T[ls(rt)].Lsum ^= T[ls(rt)].OL ;</span><br><span class="line">T[ls(rt)].Rsum ^= T[ls(rt)].OR ^= T[ls(rt)].Rsum ^= T[ls(rt)].OR ;</span><br><span class="line"><span class="comment">//r</span></span><br><span class="line">T[rs(rt)].Sum ^= T[rs(rt)].OS ^= T[rs(rt)].Sum ^= T[rs(rt)].OS ;</span><br><span class="line">T[rs(rt)].Lsum ^= T[rs(rt)].OL ^= T[rs(rt)].Lsum ^= T[rs(rt)].OL ;</span><br><span class="line">T[rs(rt)].Rsum ^= T[rs(rt)].OR ^= T[rs(rt)].Rsum ^= T[rs(rt)].OR ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (T[rt].tag == <span class="number">0</span>)&#123;</span><br><span class="line">T[ls(rt)].tag = T[rs(rt)].tag = <span class="number">0</span> ;</span><br><span class="line">T[ls(rt)].OL = T[ls(rt)].OR = T[ls(rt)].OS = T[ls(rt)].Len ;</span><br><span class="line">T[rs(rt)].OL = T[rs(rt)].OR = T[rs(rt)].OS = T[rs(rt)].Len ;</span><br><span class="line">T[ls(rt)].Lsum = T[ls(rt)].Rsum = T[ls(rt)].Sum = T[ls(rt)].S = <span class="number">0</span> ;</span><br><span class="line">T[rs(rt)].Lsum = T[rs(rt)].Rsum = T[rs(rt)].Sum = T[rs(rt)].S = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (T[rt].tag == <span class="number">1</span>)&#123;</span><br><span class="line">T[ls(rt)].tag = T[rs(rt)].tag = <span class="number">1</span> ;</span><br><span class="line">T[ls(rt)].OL = T[ls(rt)].OR = T[ls(rt)].OS = <span class="number">0</span> ;</span><br><span class="line">T[rs(rt)].OL = T[rs(rt)].OR = T[rs(rt)].OS = <span class="number">0</span> ;</span><br><span class="line">T[ls(rt)].Lsum = T[ls(rt)].Rsum = T[ls(rt)].Sum = T[ls(rt)].S = T[ls(rt)].Len ;</span><br><span class="line">T[rs(rt)].Lsum = T[rs(rt)].Rsum = T[rs(rt)].Sum = T[rs(rt)].S = T[rs(rt)].Len ;</span><br><span class="line">&#125;</span><br><span class="line">T[rt].tag = <span class="number">-1</span>, T[rt].t = <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _change(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)&#123;<span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">T[rt].tag = k ;</span><br><span class="line"><span class="keyword">if</span> (!k)</span><br><span class="line">T[rt].OL = T[rt].OR = T[rt].OS = T[rt].Len, </span><br><span class="line">T[rt].Lsum = T[rt].Rsum = T[rt].Sum = T[rt].S = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">else</span>  T[rt].OL = T[rt].OR = T[rt].OS = <span class="number">0</span>, </span><br><span class="line">  T[rt].Lsum = T[rt].Rsum = T[rt].Sum = T[rt].S = T[rt].Len ;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">down(rt) ;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) _change(ls(rt), l, mid, k) ;</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) _change(rs(rt), mid + <span class="number">1</span>, r, k) ;</span><br><span class="line">up(rt) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _reverse(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;<span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R)&#123;</span><br><span class="line">T[rt].t = <span class="number">1</span> ;</span><br><span class="line">T[rt].Sum ^= T[rt].OS ^= T[rt].Sum ^= T[rt].OS ;</span><br><span class="line">T[rt].Lsum ^= T[rt].OL ^= T[rt].Lsum ^= T[rt].OL ;</span><br><span class="line">T[rt].Rsum ^= T[rt].OR ^= T[rt].Rsum ^= T[rt].OR ;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">down(rt) ;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) _reverse(ls(rt), l, mid) ;</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) _reverse(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">up(rt) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Sum</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;<span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (L &lt;= l &amp;&amp; R &gt;= r) <span class="keyword">return</span> T[rt].S ;</span><br><span class="line">down(rt) ; <span class="keyword">int</span> res = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= mid) res += Sum(ls(rt), l, mid) ;</span><br><span class="line"><span class="keyword">if</span> (R &gt; mid) res += Sum(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line"><span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;<span class="comment">//</span></span><br><span class="line">T[rt].tag = <span class="number">-1</span> ;</span><br><span class="line">T[rt].Len = r - l + <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (l == r)&#123;</span><br><span class="line"><span class="keyword">if</span> (!base[l]) T[rt].OL = T[rt].OR = T[rt].OS = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">else</span>  T[rt].Sum = T[rt].Lsum = T[rt].Rsum = T[rt].S = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">build(ls(rt), l, mid), build(rs(rt), mid + <span class="number">1</span>, r), up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Tree <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (L &lt;= l &amp;&amp; R &gt;= r) <span class="keyword">return</span> T[rt] ;</span><br><span class="line">Tree res, A, B ;</span><br><span class="line"><span class="keyword">if</span> (mid &gt;= R) <span class="keyword">return</span> query(ls(rt), l, mid) ;</span><br><span class="line"><span class="keyword">if</span> (mid &lt; L) <span class="keyword">return</span> query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">    A = query(ls(rt), l, mid), B = query(rs(rt), mid + <span class="number">1</span>, r) ;</span><br><span class="line">    res.Lsum = max(A.Lsum, A.S + B.Lsum) ; res.Rsum = max(B.Rsum, B.S + A.Rsum) ;</span><br><span class="line">    res.Sum = max(max(A.Sum, B.Sum), A.Rsum + B.Lsum) ; res.S = A.S + B.S ; </span><br><span class="line"><span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">build(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line"><span class="keyword">while</span> (M --)&#123;</span><br><span class="line"><span class="comment">//cout &lt;&lt; M &lt;&lt; " " &lt;&lt; "qwerweafasdfsdf" &lt;&lt; endl ;</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;MArk, &amp;L, &amp;R),</span><br><span class="line">++ L, ++ R ;</span><br><span class="line"><span class="keyword">if</span> (MArk == <span class="number">0</span>) _change(<span class="number">1</span>, <span class="number">1</span>, N, <span class="number">0</span>) ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (MArk == <span class="number">1</span>) _change(<span class="number">1</span>, <span class="number">1</span>, N, <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (MArk == <span class="number">2</span>) _reverse(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (MArk == <span class="number">3</span>) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Sum(<span class="number">1</span>, <span class="number">1</span>, N)) ;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d"</span>, query(<span class="number">1</span>, <span class="number">1</span>, N).Sum), <span class="built_in">putchar</span>(<span class="string">'\n'</span>) ;</span><br><span class="line"><span class="comment">//cout &lt;&lt; " qwerweafasdfsdf " &lt;&lt; endl ;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$push_up$çœŸé•¿å•Š$233$</p><p>è‰¹å®Œè¿™ä¸ªé¢˜æ˜¯çœŸçš„çˆ½å•Š~</p><h1 id="Task3-æ€»ç»“ä¸€ä¸‹"><a href="#Task3-æ€»ç»“ä¸€ä¸‹" class="headerlink" title="$Task3~$ æ€»ç»“ä¸€ä¸‹"></a>$Task3~$ æ€»ç»“ä¸€ä¸‹</h1><p>å…¶å®è¿™ä¸œè¥¿å’Œ$DP$æ˜¯ä¸€æ ·çš„å§ï¼Ÿä½ åªéœ€è¦ç¡®å®šä½ æƒ³è¦ç»´æŠ¤ä»€ä¹ˆ(ç­‰ä»·äºç¡®å®šçŠ¶æ€)ï¼Œç„¶åæ˜ç¡®çˆ¶å­åŒºé—´å¦‚ä½•å‘ä¸Šç»´æŠ¤(ç­‰ä»·äºçŠ¶æ€ä¹‹é—´å¦‚ä½•è½¬ç§»)ã€‚</p><p>å—¯ï¼Œä¸‡ç‰©ç›¸åŒã€‚</p><blockquote><p>é‡é©¬ä¹Ÿï¼Œå°˜åŸƒä¹Ÿï¼Œç”Ÿç‰©ä¹‹ä»¥æ¯å‘å¹ä¹Ÿã€‚å¤©ä¹‹è‹è‹ï¼Œå…¶æ­£è‰²è€¶ï¼Ÿå…¶è¿œè€Œæ— æ‰€è‡³æè€¶ï¼Ÿ</p></blockquote><p>ä¸çŸ¥ä¸ºä»€ä¹ˆï¼Œçªç„¶æƒ³åˆ°äº†è¿™å¥è¯ã€‚</p><h1 id="mathscr-The-End"><a href="#mathscr-The-End" class="headerlink" title="$\mathscr{The~End}$"></a>$\mathscr{The~End}$</h1>]]></content>
    
    <summary type="html">
    
      å¥‡å¥‡æ€ªæ€ªçš„çº¿æ®µæ ‘æ•£å‘ç€å¥‡å¥‡æ€ªæ€ªçš„é¦™æ°”ï¼ˆ
    
    </summary>
    
      <category term="é¢˜è§£" scheme="http://www.orchidany.cf/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ³›åš" scheme="http://www.orchidany.cf/categories/%E9%A2%98%E8%A7%A3/%E6%B3%9B%E5%81%9A/"/>
    
    
      <category term="çº¿æ®µæ ‘" scheme="http://www.orchidany.cf/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
      <category term="é¢˜è§£" scheme="http://www.orchidany.cf/tags/%E9%A2%98%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>è‡ªé€‚åº”Simpsonæ³•å…¥é—¨</title>
    <link href="http://www.orchidany.cf/2019/03/17/Simpson1/"/>
    <id>http://www.orchidany.cf/2019/03/17/Simpson1/</id>
    <published>2019-03-17T08:39:35.000Z</published>
    <updated>2019-03-17T10:18:14.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98%2B-blue.svg" alt=""></p><h1 id="rm-0x01-å‰è¨€"><a href="#rm-0x01-å‰è¨€" class="headerlink" title="$\rm{0x01}$  å‰è¨€"></a>$\rm{0x01}$  å‰è¨€</h1><p>é¦–å…ˆé˜æ˜ä¸€ç‚¹ï¼Œ<strong>è‡ªé€‚åº”è¾›æ™®æ£®ç®—æ³•($\rm{Adaptive ~Simpsonâ€™s~ rule}$ )</strong>æ˜¯ä¸€ç±»<strong>è¿‘ä¼¼ç®—æ³•($\rm{Approximation ~algorithm}$)</strong>ï¼Œä¸»è¦ç”¨äºæ±‚è¾ƒéš¾åå¯¼çš„å‡½æ•°çš„ç§¯åˆ†ã€‚å¤§æ¦‚åœ¨ä¿¡æ¯è®¡ç®—çš„æ—¶å€™ä¸­å¾ˆå¸¸ç”¨ï¼Ÿ</p><p>å…¶æ€æƒ³æ˜¯åˆ©ç”¨äºŒæ¬¡å‡½æ•°æ¥ä¸æ–­<strong>æ‹Ÿåˆ($\rm{Overfitting}$)</strong>æ‰€æ±‚æ›²çº¿ï¼Œè€Œæ‰€è°“çš„<strong>$Adapative$ï¼ˆè‡ªé€‚åº”ï¼‰</strong>åˆ™æ˜¯ç”¨äºä¼˜åŒ–æ—¶é—´å¤æ‚åº¦çš„æ–¹æ³•ã€‚</p><p>å—â€¦æ€»ä¹‹â€¦æ¯”è¾ƒç®€å•ï¼Ÿ</p><p>è¡¨ç¤ºçœ‹äº†ä¸¤ç¯‡å¤–å›½å­¦è€…çš„è®ºæ–‡ï¼Œæ„Ÿè§‰å¥½åƒæ€è·¯å·²ç»æ¯”è¾ƒæ¸…æ™°çš„æ ·å­ã€‚</p><h1 id="rm-0x02-mathcal-Simpson-Formula-è¾›æ™®æ£®å…¬å¼"><a href="#rm-0x02-mathcal-Simpson-Formula-è¾›æ™®æ£®å…¬å¼" class="headerlink" title="$\rm{0x02}$  $\mathcal{Simpson~Formula}$ è¾›æ™®æ£®å…¬å¼"></a>$\rm{0x02}$  $\mathcal{Simpson~Formula}$ è¾›æ™®æ£®å…¬å¼</h1><p>ç¨ç­‰ï¼Œè¿™ä¸ªè·Ÿç®—æ³•çš„å…³ç³»ä¸å¤§ï¼Œä¸»è¦æ˜¯å…¬å¼ï¼š$$\rm{\int _{l}^{r} f(x) \rm{dx}\approx \frac{f(r) +f(l)+ 4 \cdot f(m)}{6}} \,$$</p><p>äº‹å®ä¸Šå§ï¼Œæ±‚ç§¯åˆ†çš„è¯ï¼Œå¤§å¤šæ•°éƒ½æ˜¯ç›´æ¥å¥—è¾›æ™®æ£®å…¬å¼çš„ã€‚å¹¶ä¸”è¿™ä¸ªå…¬å¼æ˜¯å¹¿æ³›é€‚ç”¨çš„â€¦â€¦åªä¸è¿‡è¯¯å·®æœ‰ç‚¹å„¿äººå¤§$233â€‹$</p><p>è¿™å…¶å®æ˜¯æˆ‘ä»¬ç”¨äºŒæ¬¡å‡½æ•°ä¸æ–­æ‹Ÿåˆçš„ç»“æœï¼Œæ¨å¯¼è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹$^{[1]}$ï¼š</p><blockquote><p>å› ä¸º $g(x)$ æ˜¯ç”¨æ¥æ‹Ÿåˆ $f(x)$ çš„ï¼Œæ‰€ä»¥æœ‰ï¼š<br>$$\int\limits_L^Rf(x)dx\approx \int\limits_L^Rax^2+bx+c\space dx$$<br>æ±‚ $g(x)â€‹$ çš„ä¸å®šç§¯åˆ†ä¸ºï¼š<br>$$\int g(x)dx=\frac13ax^3+\frac12bx^2+cx+C$$<br>ç„¶åå†å¸¦å…¥ RR å’Œ LL ï¼š<br>$$\int\limits_L^Rf(x)dx=\frac13a(R^3-L^3)+\frac12b(R^2-L^2)+c(R-L)$$<br>ç„¶åæå…¬å› å¼ï¼ŒåŸå¼ä¸ºï¼š<br>$$\frac{R-L}{6}(2a(R^2+LR+L^2)+3b(R+L)+6c)6Râˆ’L(2a(R2+LR+L2)+3b(R+L)+6c)$$<br>æŠŠé‡Œé¢å±•å¼€æ¥ï¼š<br>$$\frac{R-L}{6}(2aR^2+2aLR+2aL^2+3bR+3bL+6c)$$<br>é‡æ–°æ•´ç†ä¸€ä¸‹å¼å­ï¼š<br>$$\frac{R-L}{6}((aR^2+bR+c)+(aL^2+bL+c)+aR^2+aL^2+2aLR+2bR+2bL+4c)$$<br>å†æ•´ç†ï¼š<br>$$\frac{R-L}{6}((aR^2+bR+c)+(aL^2+bL+c)+4(a(\frac{R+L}{2})^2+b(\frac{R+L}{2})+c))$$<br>ä»£æ¢å¯å¾—ï¼š<br>$$aR^2+bR+c\approx f(R)$$<br>$$aL^2+bL+c\approx f(L)$$<br>$$4(a(\frac{R+L}{2})^2+b(\frac{R+L}{2})+c)\approx 4f(\frac{R+L}{2})$$<br>æŠŠè¿™ä¸‰ä¸ªå¼å­å¸¦å›å»ï¼Œ æœ€åæˆ‘ä»¬å°±å¾—åˆ°äº†$\rm{Simpson}$ ç§¯åˆ†å…¬å¼ï¼š<br>$\int\limits_L^Rf(x)dx \approx \frac{R-L}{6}(f(L)+4f(\frac{L+R}{2})+f(R)))$</p></blockquote><p>äºæ˜¯æˆ‘ä»¬å°±å¾—åˆ°äº†æ‰€è°“çš„$\rm{Simpson~Fomula}$ã€‚ä½†äº‹å®ä¸Šï¼Œå¯¹äºä¸€æ®µâ€œè·Œå®•èµ·ä¼â€çš„å‡½æ•°ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ— æ³•å‡†ç¡®åœ°å»ç”¨ä¸€ä¸ªäºŒæ¬¡å‡½æ•°çš„æ‹Ÿåˆæ¥åˆ»ç”»ã€‚äºæ˜¯â€”â€”</p><h1 id="rm-0x03-mathcal-Adaptive-Simpson-Rule-è‡ªé€‚åº”è¾›æ™®æ£®æ³•"><a href="#rm-0x03-mathcal-Adaptive-Simpson-Rule-è‡ªé€‚åº”è¾›æ™®æ£®æ³•" class="headerlink" title="$\rm{0x03}$  $\mathcal{Adaptive~Simpson~Rule}$ è‡ªé€‚åº”è¾›æ™®æ£®æ³•"></a>$\rm{0x03}$  $\mathcal{Adaptive~Simpson~Rule}$ è‡ªé€‚åº”è¾›æ™®æ£®æ³•</h1><p>æˆ‘ä»¬è€ƒè™‘ï¼Œå¦‚æœæŠŠåŒºé—´ä»¬ç¨å¾®åˆ’åˆ†åœ°æ›´ç»†ä¸€ç‚¹ï¼Œé‚£æ˜¯ä¸æ˜¯ä¼šå¥½å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¸€å®šçš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘<strong>å®šå‘äºŒåˆ†</strong>ã€‚ä½†æ˜¯â€¦â€¦å®šå‘äºŒåˆ†å§‹ç»ˆå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å®ƒå¤ªç¬¨äº†ï¼Œç¬¨åˆ°å¦‚æœ$[l_1,r_1]$å·²ç»æ»¡è¶³ç²¾åº¦è¦æ±‚äº†ï¼Œæˆ‘ä»¬å´è¿˜è¦ä¸€ç›´åˆ†ï¼›ç¬¨åˆ°$[l_2,r_2]$åˆ†çš„æ¬¡æ•°æ ¹æœ¬ä¸å¤Ÿç”¨â€”â€”ä½†æˆ‘ä»¬å¹¶ä¸å¯ä»¥å¾—åˆ°åé¦ˆã€‚</p><p>äºæ˜¯è€ƒè™‘<strong>è‡ªé€‚åº”</strong>ã€‚</p><p>æ‰€è°“<strong>è‡ªé€‚åº”</strong>ï¼Œè¯´çš„ç›´ç™½ç‚¹ï¼Œæ— éå°±æ˜¯<strong>éœ€è¦å¤šåˆ†æ²»å‡ æ¬¡çš„åœ°æ–¹ï¼Œå¤šåˆ†æ²»å‡ æ¬¡ï¼›ä¸éœ€è¦çš„åˆ™å¯ä»¥å°‘åˆ†æ²»å‡ æ¬¡</strong></p><p>ä½ ä¼šå‘ç°ï¼Œå…¶å®ä»–èŠ‚çº¦çš„å°±æ˜¯ä¸€ä¸ªç‚¹â€”â€”<strong>æ—¶é—´æ•ˆç‡</strong>ã€‚</p><p>ä¸¾ä¸ªæ —å­$^{[2]}$ï¼š</p><p>æ¯”å¦‚æœ‰è¿™ä¹ˆä¸ªå‡½æ•°$\rm{f (x) = 13(x âˆ’ x^2)e^{\frac{âˆ’3x}{2}} }$ï¼Œæˆ‘ä»¬è¦æ±‚$\int_{0}^{4}f(x) \rm{~dx}$ å¹¶è¦æ±‚ç²¾åº¦è¯¯å·®åœ¨$1e-5$ ä»¥å†…ã€‚è€Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•å»è§£å†³ï¼š</p><ul><li>ä»¥å›ºå®šçš„æ¯”ä¾‹ä»¥åŠçº¦æŸäºŒåˆ†ã€‚</li><li>è¿ç”¨è‡ªé€‚åº”ç­–ç•¥åˆ†é…</li></ul><p>é‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“ä»–çœŸæ­£çš„$value:$</p><p><img src="https://img2018.cnblogs.com/blog/1337159/201901/1337159-20190116165543353-1446042218.png" alt=""></p><p>çœ‹èµ·æ¥å¥½åƒæµ·æ˜Ÿï¼Ÿç„¶åæˆ‘ä»¬ç”¨ä¸¤ç§æ–¹æ³•éƒ½è¯•ä¸€è¯•ï¼š</p><p>é¦–å…ˆæ˜¯è‡ªé€‚åº”æ³•ï¼Œæˆ‘ä»¬å‘ç°æœ€ååªéœ€è¦æ±‚$20$æ®µåŒºé—´ã€‚è¡¨ä¸­çš„$a_k \&amp; b_k$è¡¨ç¤ºå·¦å³åŒºé—´ï¼Œ$S(l,r)$è¡¨ç¤º$[l,r]$å†…ã€è¿ç”¨$0x01$ä¸­çš„å…¬å¼è®¡ç®—çš„ï¼Œ$\rm{Error~Bound}$è¡¨ç¤ºè¯¯å·®ç•Œï¼Œ$\rm{Tolerance}$è¡¨ç¤ºè®¡ç®—æ—¶<strong>éœ€è¦çš„è¯¯å·®</strong>(ç¨‹åºè®¾è®¡æ—¶ä¼šè®²)ã€‚</p><p><img src="https://img2018.cnblogs.com/blog/1337159/201901/1337159-20190116165550075-1102374096.png" alt=""></p><p>é‚£ä¹ˆæœ€åç®—å‡ºæ¥çš„å€¼æ˜¯$ âˆ’1.54878823413$ ï¼Œä¸çœŸå®å€¼è¯¯å·®ä¸º$0.00000013840 $ï¼Œä¸€å…±è°ƒç”¨äº†$79$æ¬¡<strong>å‡½æ•°ä¼°å€¼</strong>ï¼ˆç•™ä¸ªå‘ï¼Œåæ–‡ä¼šè®²ï¼‰ã€‚</p><p>é‚£ä¹ˆç»˜åˆ¶å‡ºæ¥çš„å‡½æ•°å›¾åƒå¤§æ¦‚é•¿è¿™æ ·ï¼š<img src="https://img2018.cnblogs.com/blog/1337159/201901/1337159-20190116165650450-478131070.png" alt=""></p><p>å¥½åƒå¾ˆæµç•…ï¼Ÿ$233$</p><p>é‚£ä¹ˆç¬¬äºŒç§æ–¹æ³•æ˜¯å®šå€¼åˆ†æ®µã€‚æˆ‘ä»¬è€ƒè™‘åˆ†æˆåŒºé—´$[0,4]$åˆ†ä¸ºé•¿åº¦ä¸º$0.03125$çš„$128$æ®µï¼Œå¹¶è¿ç”¨$0x01$çš„$Formula$ï¼Œæœ€åå¾—å‡ºçš„ç»“æœä¸º$âˆ’1.54878844029$ï¼Œè¯¯å·®ä¸º$0.00000006776$â€¦â€¦</p><p>å¥½åƒæ˜¯ç¬¬ä¸€ä¸ªè¯¯å·®çš„äºŒåˆ†ä¹‹ä¸€ï¼Ÿå¬èµ·æ¥å¥½åƒè¯¯å·®å°äº†ï¼Œä½†æ˜¯å´éœ€è¦$257$æ¬¡å‡½æ•°ä¼°å€¼çš„è°ƒç”¨â€¦â€¦ç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—æ›´ä¼˜è¶Šçš„æ€§èƒ½ï¼Œè€Œé‚£è¯¯å·®ä¹Ÿæ˜¯ä¸éœ€è¦è€ƒè™‘çš„å•¦çš„å•¦ï½</p><p>ä½†æ˜¯æ¯”èµ·$1e-5$ç²¾åº¦æ¥è¯´â€¦â€¦è¿™æ³¢ç¨³èµšå•Š$233$</p><h1 id="rm-0x04-mathcal-About-Code-ä»£ç å®ç°"><a href="#rm-0x04-mathcal-About-Code-ä»£ç å®ç°" class="headerlink" title="$\rm{0x04}$  $\mathcal{About~Code~}$ ä»£ç å®ç°"></a>$\rm{0x04}$  $\mathcal{About~Code~}$ ä»£ç å®ç°</h1><p>é¦–å…ˆæ˜¯<a href="https://www.luogu.org/problemnew/show/P4525" target="_blank" rel="noopener">$LuoguP4525$</a>çš„æš´åŠ›è§£æ³•ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid (l + r) / 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Eps = <span class="number">5e-8</span> ;</span><br><span class="line"><span class="keyword">double</span> Ans, A, B, C, D, L, R ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">F</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (C * x + D) / (A * x + B) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">Simp_calc</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (r - l) / <span class="number">6</span> * (F(l) + F(r) + <span class="number">4</span> * F(mid)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">do_divide</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> Lv, Rv, v, t ;</span><br><span class="line">    Lv = Simp_calc(l, mid), Rv = Simp_calc(mid, r), v = Simp_calc(l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(t = (Lv + Rv - v)) &lt;= Eps) <span class="keyword">return</span> Lv + Rv ; <span class="keyword">return</span> do_divide(l, mid) + do_divide(mid, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf%lf%lf%lf"</span>, &amp;A, &amp;B, &amp;C, &amp;D, &amp;L, &amp;R) ;</span><br><span class="line">    Ans = do_divide(L, R) ; <span class="built_in">printf</span>(<span class="string">"%.6lf"</span>, Ans) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™â€¦ä¸¥æ ¼æ„ä¹‰ä¸Šè®²ï¼Œä¸èƒ½ç®—æ˜¯è‡ªé€‚åº”è¾›æ™®æ£®æ³•â€”â€”æ›´å‡†ç¡®åœ°è¯´ï¼Œå››ä¸åƒï¼Œæˆ–è€…â€œä¸œæ–½æ•ˆé¢¦â€ä¹‹ç±»çš„ï¼Œéƒ½æŒºåˆé€‚ã€‚è¿™æ˜¯æˆ‘åœ¨åˆå­¦è¿™ä¸€å—å„¿å†…å®¹æ—¶çš„å†™æ³•ï¼Œä»–ä¸ä¸¥æ ¼æ­£ç¡®ï¼Œä½†æ˜¯â€¦â€¦ä»–å¯¹çš„å¾ˆï¼Ÿ</p><p>è‡³äºè¿›åŒ–ç‰ˆ<a href="https://www.luogu.org/problemnew/show/P4526" target="_blank" rel="noopener">$LuoguP4526$</a>ï¼Œä¹Ÿæ˜¯å®Œå…¨å¯ä»¥violentlyè‰¹è¿‡å»çš„ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid (l + r) / 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Eps = <span class="number">5e-8</span> ;</span><br><span class="line"><span class="keyword">double</span> Ans, A, B, C, D, L, R ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">F</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(x, A / x - x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">Simp_calc</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (r - l) / <span class="number">6</span> * (F(l) + F(r) + <span class="number">4</span> * F(mid)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">do_divide</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r, <span class="keyword">double</span> Lans)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> Lv, Rv, v, t ; Lv = Simp_calc(l, mid), Rv = Simp_calc(mid, r), v = Lans ;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(t = (Lv + Rv - v)) &lt;= Eps) <span class="keyword">return</span> Lv + Rv ; <span class="keyword">return</span> do_divide(l, mid, Lv) + do_divide(mid, r, Rv) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;A) ; L = Eps, R = <span class="number">23.3</span> ;</span><br><span class="line">    <span class="keyword">if</span> (A &lt; <span class="number">0</span>) &#123; <span class="built_in">puts</span>(<span class="string">"orz"</span>), <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;&#125;</span><br><span class="line">    Ans = do_divide(L, R, Simp_calc(L, R)) ; <span class="built_in">printf</span>(<span class="string">"%.5lf"</span>, Ans) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯ï¼Œå…¶çœŸæ­£çš„å®ç°åº”è¯¥æ˜¯è¿™æ ·ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> v Lans</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> hps eps * 0.5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid (l + r) * 0.5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">double</span> Ans, A, L, R ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Eps = <span class="number">1e-7</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Liu = <span class="number">1.0</span> / <span class="number">6</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">F</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(x, A / x - x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">Simp_calc</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (r - l) * Liu * (F(l) + F(r) + <span class="number">4.0</span> * F(mid)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">do_divide</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r, <span class="keyword">double</span> Lans, <span class="keyword">double</span> eps)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> Lv, Rv, t ; </span><br><span class="line">    Lv = Simp_calc(l, mid), Rv = Simp_calc(mid, r) ;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(t = (Lv + Rv - v)) &lt;= eps * <span class="number">15</span>) <span class="keyword">return</span> Lv + Rv + t / <span class="number">15</span> ; </span><br><span class="line">    <span class="keyword">return</span> do_divide(l, mid, Lv, hps) + do_divide(mid, r, Rv, hps) ; <span class="comment">//æ®è¯´epsÃ—15æ¥è‡ªäºWikiâ€¦â€¦</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;A) ; L = Eps, R = <span class="number">30</span> ; </span><br><span class="line">    <span class="keyword">if</span> (A &lt; <span class="number">0</span>) &#123; <span class="built_in">puts</span>(<span class="string">"orz"</span>), <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;&#125;</span><br><span class="line">    Ans = do_divide(L, R, Simp_calc(L, R), Eps) ; <span class="built_in">printf</span>(<span class="string">"%.5lf"</span>, Ans) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å‘ç°è¿™å°±å¯ä»¥è·Ÿæ–‡ç« ä¸Šé¢$0x03$ä¸­çš„ä¾‹å­å‘¼åº”äº†ï¼šæ¯æ¬¡åˆ†æ²»æ—¶è®¡ç®—ä¸¤æ¬¡ï¼Œæ€»å…±åˆ†æ²»äº†$39$æ¬¡ï¼Œæœ€ç»ˆä¸€å…±è®¡ç®—äº†$78+1=79$æ¬¡ï¼Œè€ŒäºŒåˆ†åˆ™æ˜¯ä¸€æ£µæœ‰$128$ä¸ªå¶å­èŠ‚ç‚¹çš„é€’å½’æ ‘ï¼Œæ€»å…±è®¡ç®—äº†$256 +1=257$æ¬¡ã€‚    </p><p>å¥½çš„ï¼Œç»ˆäºè¦æ‰¯æ­£é¢˜äº†ã€‚ç®—æ³•çš„å®ç°å…¶å®ç®€å•ï¼Œæˆ‘ä»¬ç”¨æ‹Ÿåˆæ€§ç®—æ³•ä¸æ–­$check\&amp;calc$, è€Œ$check$çš„æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åˆ¤æ–­ä¸€ä¸‹ä¸¤æ®µå­åŒºé—´çš„å‡½æ•°å€¼ä¹‹å’Œä¸æ•´ä¸ªåŒºé—´çš„å‡½æ•°å€¼ä¹‹å’Œçš„å·®å€¼æ˜¯å¦åœ¨ç²¾åº¦è¦æ±‚èŒƒå›´ä¹‹å†…ï¼Œä¹‹åå¦‚æœæ»¡è¶³ç²¾åº¦è¯¯å·®å°±ç›´æ¥$return$ï¼Œå¦åˆ™å¯¹äºè¿™æ®µåŒºé—´ç»§ç»­é€’å½’ä¸‹å»ã€‚</p><p>è€Œè¿™ä¸ªåœ°æ–¹æœ‰ä¸ªè¦æ±‚ï¼Œå°±æ˜¯å¯¹äº$eps$ï¼Œä½ éœ€è¦ä¸æ–­$half$ä»–ï¼ŒåŸå› å¾ˆç®€å•ï¼Œå¯¹äºä¸€æ•´æ®µåŒºé—´$U$ï¼Œè¦æ±‚ä»–çš„è¿”å›å€¼çš„$|eps(U)| \leq k$çš„è¯ï¼Œé‚£ä¹ˆå¯¹äºå…¶ä½œä¸ºå­é›†ä¸¤ä¸ªè¿ç»­åŒºé—´$A,B$ï¼Œå½“$A \bigcup B = U$æ—¶ï¼Œå¿…é¡»è¦æ»¡è¶³$|eps(A)| \leq \frac{k}{2}, |eps(B)| \leq  \frac{k}{2}$ï¼Œæ‰èƒ½ä¿è¯$|eps(U) = eps(A) + eps(B)| \leq k$ï¼Œæ‰€ä»¥è¦ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> hps eps * 0.5</span></span><br><span class="line">....................</span><br><span class="line"><span class="keyword">return</span> do_divide(l, mid, Lv, hps) + do_divide(mid, r, Rv, hps) ;</span><br></pre></td></tr></table></figure><p>å¥½äº†ï¼Œå”¯ä¸€çš„é—®é¢˜åœ¨äºæœ‰å¥è¯è¿·çš„å¾ˆï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">fabs</span>(t = (Lv + Rv - v)) &lt;= eps * <span class="number">15</span>) <span class="keyword">return</span> Lv + Rv + t / <span class="number">15</span> ;</span><br></pre></td></tr></table></figure><p><img src="nky.jpg" alt=""></p><p>è¿™ä¸ª$\leq 15 \cdot eps$æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</p><p>å¥½å§ï¼Œç¬”è€…ä¹Ÿä¸æ¸…æ¥šï¼Œä½†æ˜¯æœ‰ä¸ªç»“è®ºæ˜¯é•¿è¿™æ ·çš„ï¼š<img src="https://img2018.cnblogs.com/blog/1337159/201901/1337159-20190116165630989-1211570362.png" alt=""></p><p>ä»€ä¹ˆï¼Ÿä½ è¯´æ¨ä»€ä¹ˆå€’ï¼Ÿå°å°å¹´çºªæ•´å¤©æƒ³ç€æ¨å€’<del>å­¦å§</del>å¯ä¸å¥½å•Š$233$</p><p>ä»€ä¹ˆï¼Ÿä½ è¿˜æƒ³çœ‹æ¨å€’çš„è¿‡ç¨‹ï¼Ÿå•§å•§å•§ï¼Œå·¦è½¬çŸ¥ä¹æ„Ÿæƒ…ä¸“åŒºèŸ¹èŸ¹ï½</p><p>å¥½çš„ï¼Œä»¥ä¸Šä¸¤æ®µæ˜¯çæ‰¯çš„ï¼Œæ¨å¯¼è¿‡ç¨‹ååˆ†è¯¡å¼‚ï¼Œå¤§å®¶è‡ªå·±é£Ÿç”¨å¥½äº†â€¦â€¦</p><p>äºæ˜¯ç»“æŸï¼Œæ’’èŠ±èŠ±â€¦ï¼ˆä¸æ˜¯æ’’åšä¸»xï¼‰</p><h1 id="rm-Referance"><a href="#rm-Referance" class="headerlink" title="$\rm{Referance}$"></a>$\rm{Referance}$</h1><ul><li><p>$[1]$ :$NaCly_Fish$çš„$blog$ <a href="https://www.luogu.org/blog/NaCly-Fish-blog/SimpsonIntegral" target="_blank" rel="noopener">$^{^{[\nearrow]}}$</a></p></li><li><p>$[2]$ :æŸç¯‡è®ºæ–‡ <a href="https://files.cnblogs.com/files/pks-t/AdaptiveQuadProof.pdf" target="_blank" rel="noopener">$^{^{[\nearrow]}}$</a></p></li></ul><p>å¯¹äºç¬¬äºŒç¯‡$refer$ï¼Œå€Ÿé‰´çš„æ¯”è¾ƒå¤šï¼ˆè¯»ä¹¦äººçš„äº‹â€¦â€¦å’³å’³â€¦â€¦ï¼‰ï¼Œä½†æ˜¯æ”¹äº†ä¸€ä¸ªæ•°æ®ï¼Œå°±æ˜¯$81 \to 79$ï¼Œå› ä¸ºä»£ç éœ€è¦$233$</p><p>$Ps:$å²ä¸Šæœ€ä¸æ­£ç»çš„$reference$è¯ç”Ÿäº†â€¦â€¦</p>]]></content>
    
    <summary type="html">
    
      ä¸€ç§å¾ˆå¯çˆ±çš„ç§¯åˆ†è¿‘ä¼¼æ³•ï¼Œå­¦çš„æ—¶å€™é¡ºä¾¿çœ‹äº†å¥½å¤šè®ºæ–‡qaq
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="ç§¯åˆ†/ç§¯åˆ†è¿‘ä¼¼" scheme="http://www.orchidany.cf/tags/%E7%A7%AF%E5%88%86-%E7%A7%AF%E5%88%86%E8%BF%91%E4%BC%BC/"/>
    
      <category term="è®¡ç®—å‡ ä½•-Simpsonç§¯åˆ†" scheme="http://www.orchidany.cf/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95-Simpson%E7%A7%AF%E5%88%86/"/>
    
  </entry>
  
  <entry>
    <title>Calc on Trees (1)</title>
    <link href="http://www.orchidany.cf/2019/03/16/Cal-on-Tree1/"/>
    <id>http://www.orchidany.cf/2019/03/16/Cal-on-Tree1/</id>
    <published>2019-03-16T12:15:28.000Z</published>
    <updated>2019-03-17T11:40:04.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98%2B-blue.svg" alt=""></p><p>å¥½çš„ï¼Œä»Šå¤©æ•´ç†ä¸€ç±»è¾ƒä¸ºç®€å•çš„æ ‘ä¸Šé’ˆå¯¹è¾¹æƒçš„ä¿®æ”¹ã€æŸ¥è¯¢ã€æ“ä½œé¢˜ã€‚</p><p>é—®é¢˜å¤§æ¦‚æœ‰ä¸¤ç±»ï¼šåªæœ‰æŸ¥è¯¢$\&amp;â€‹$ä¿®æ”¹æŸ¥è¯¢éƒ½æœ‰</p><h2 id="mathscr-Task1-æ™®é€šçš„æŸ¥è¯¢é—®é¢˜"><a href="#mathscr-Task1-æ™®é€šçš„æŸ¥è¯¢é—®é¢˜" class="headerlink" title="$\mathscr{Task1}$æ™®é€šçš„æŸ¥è¯¢é—®é¢˜"></a>$\mathscr{Task1}$æ™®é€šçš„æŸ¥è¯¢é—®é¢˜</h2><p>å¤§æ¦‚é—®é¢˜å°±ç±»ä¼¼äºè¿™ä¸ªå…¸å‹çš„<a href="https://www.luogu.org/problemnew/show/P2420" target="_blank" rel="noopener">$XOR$é—®é¢˜</a> </p><p>å…¶å®è¯´ç™½äº†ï¼Œè¿™ä¸ªé¢˜çš„è§£æ³•ååˆ†ç®€å•â€”â€”$LCA$</p><p>ä½†å…¶å®â€¦â€¦æˆ‘ä¸€å¼€å§‹è€ƒè™‘$LCA$ï¼Œæ²¡æœ‰ç»†è‡´è€ƒè™‘ï¼Œåªæ˜¯è§‰å¾—å¦‚æœä»$u,v$åˆ†åˆ«å‘$LCA$è·³ï¼Œè¿™å¹¶ä¸å¯ä»¥æå‰å¤„ç†æˆ–è€…æå‰ç»´æŠ¤ï¼Œæ‰€ä»¥å’Œæš´åŠ›æ²¡æœ‰åŒºåˆ«ï¼Œäºæ˜¯å°±å¼ƒç–—ã€‚</p><p>ä½†æ˜¯è¿™ä¸ªåœ°æ–¹ï¼Œ$LCA$çš„ä½œç”¨ååˆ†å·§å¦™â€”â€”æˆ‘ä»¬è¯•å›¾å»æ‹“å±•è¿™ä¸ªé¢˜ã€‚æˆ‘ä»¬å®šä¹‰$D(\bigodot,r,u)$è¡¨ç¤ºåœ¨è¿ç®—$\bigodot$ä¸‹ï¼Œä»æ ¹$r$åˆ°æŸä¸€å›ºå®šç‚¹$u$çš„è¾¹æƒè¿ç®—ç»“æœï¼Œå…¶ä¸­é™å®šäº†è¿ç®—$\bigodot$å¿…é¡»ä¸ºå¯é€†è¿ç®—ï¼Œæ¯”å¦‚è¯´å¼‚æˆ–ã€åŠ æ³•ã€å‡æ³•â€”â€”æ³¨æ„ï¼Œæ­¤æ—¶çš„å¯é€†è¿ç®—ï¼Œå¯ä»¥æ˜¯<strong>è‡ªå¯é€†ï¼ˆè‡ªå·±å¯¹è‡ªå·±è¿ç®—æ˜¯é€†è¿ç®—ï¼Œæ¯”å¦‚$A~XOR ~A = 0$ï¼‰</strong>æˆ–è€…<strong>ä»–å¯é€†ï¼ˆå³å­˜åœ¨å¦ä¸€ç§è¿ç®—ï¼Œæ˜¯è¿™ç§è¿ç®—çš„é€†è¿ç®—ï¼Œæ¯”å¦‚åŠ æ³•ä¹‹äºå‡æ³•ï¼‰</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¾—å‡ºå®ƒçš„ä¸€èˆ¬å½¢å¼$$D(\bigodot,u,v) = D(\bigodot,r,u) \bigodot D(\bigodot,r,v) ~\bigoplus ~(~2 \cdot D(\bigodot,r,LCA(u,v)~)~)$$ ï¼Œå…¶ä¸­æˆ‘ä»¬å‡è®¾è¿ç®—$\bigodot$ä¸$\bigoplus$äº’é€†ã€‚æ ‘ä¸Šå‰ç¼€å’Œå¤§æŠµä¸Šå°±æ˜¯è¿™ä¸ªæ„æ€ã€‚</p><p>é‚£ä¹ˆå›åˆ°è¿™ä¸ªé¢˜ï¼Œæˆ‘ä»¬å¯¹äºæ¯ä¸€ä¸ªç‚¹çš„$D$ï¼Œéƒ½æ˜¯ååˆ†æ–¹ä¾¿è®¡ç®—çš„ï¼Œå› ä¸ºæ— æƒæ—¶ï¼Œ$D(r,t) = depth[t]$æ˜¯ä¸€ä¸ªç›¸å½“å¹³å‡¡çš„ç»“è®ºï¼›æœ‰æƒæ—¶ï¼Œåˆ™ç›´æ¥$dfs$ä¸€éå³å¯ã€‚æ¯æ¬¡æŸ¥è¯¢æ˜¯$log$çº§åˆ«çš„ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦çš„æ¸è¿›ä¸Šç•Œå°±æ˜¯æ¯”è¾ƒæ˜¾ç„¶çš„$O(\max(m \log_2n,n))$ã€‚</p><p>ä»£ç å¤§æ¦‚æ˜¯è¿™æ ·</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span> )+ (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    e[++cnt].t = v ;</span><br><span class="line">    e[cnt].next = head[u] ;</span><br><span class="line">    e[cnt].v = w ;</span><br><span class="line">head[u] = cnt ;</span><br><span class="line">    e[++cnt].t = u ;</span><br><span class="line">    e[cnt].next = head[v] ;</span><br><span class="line">    e[cnt].v = w ;</span><br><span class="line">head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _build(<span class="keyword">int</span> deep, <span class="keyword">int</span> now, <span class="keyword">int</span> f, <span class="keyword">int</span> _xor)&#123;</span><br><span class="line">    fa[now][<span class="number">0</span>] = f, dep[now] = deep, XOR[now] = _xor ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = head[now]; k ;k = e[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span>(e[k].t == f) <span class="keyword">continue</span> ;</span><br><span class="line">        _build(deep + <span class="number">1</span>, e[k].t, now, _xor ^ e[k].v) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Up = <span class="built_in">log</span>(N) / <span class="built_in">log</span>(<span class="number">2</span>) + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= Up; i ++)</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt;= N; j ++)</span><br><span class="line">            fa[j][i] = fa[fa[j][i - <span class="number">1</span>]][i - <span class="number">1</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[u] &lt; dep[v]) swap(u, v) ;</span><br><span class="line">    pre = dep[u] - dep[v] ;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt;= Up; j ++) <span class="keyword">if</span>((<span class="number">1</span> &lt;&lt; j) &amp; pre) u = fa[u][j] ;</span><br><span class="line">    <span class="keyword">if</span>(u == v) <span class="keyword">return</span> u ;</span><br><span class="line">    <span class="keyword">for</span>(j = Up; j &gt;= <span class="number">0</span>; j --) <span class="keyword">if</span>(fa[u][j] != fa[v][j]) u = fa[u][j], v = fa[v][j] ;</span><br><span class="line">    <span class="keyword">return</span> fa[v][<span class="number">0</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    N = qr() ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; N; i ++)&#123;</span><br><span class="line">        in1 = qr(), in2 = qr(), in3 = qr();</span><br><span class="line">        add(in1, in2, in3) ;</span><br><span class="line">    &#125;</span><br><span class="line">    M = qr() ;</span><br><span class="line">    _build(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>), init( );</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= M; i ++)&#123;</span><br><span class="line">        in1 = qr(), in2 = qr() ;</span><br><span class="line">        f1 = LCA(in1, in2) ;</span><br><span class="line">        <span class="keyword">int</span> t = XOR[in1]^XOR[f1]^XOR[in2]^XOR[f1] ;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; t &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="mathscr-Task-2-å¸¦æœ‰ä¿®æ”¹çš„æŸ¥è¯¢é—®é¢˜ï¼š"><a href="#mathscr-Task-2-å¸¦æœ‰ä¿®æ”¹çš„æŸ¥è¯¢é—®é¢˜ï¼š" class="headerlink" title="$\mathscr{Task~2}$å¸¦æœ‰ä¿®æ”¹çš„æŸ¥è¯¢é—®é¢˜ï¼š"></a>$\mathscr{Task~2}$å¸¦æœ‰ä¿®æ”¹çš„æŸ¥è¯¢é—®é¢˜ï¼š</h2><p>ä¹‹åæˆ‘ä»¬ç´§æ¥ç€å°è¯•å»æ¢è®¨ä¸€ç±»å¸¦æœ‰ä¿®æ”¹è¾¹æƒçš„æ ‘ä¸Šæ“ä½œï¼Œå¤§æ¦‚é¢˜ç›®å°±æ˜¯<a href="https://www.luogu.org/problemnew/show/P1505" target="_blank" rel="noopener">æŸå¹´å›½å®¶é›†è®­é˜Ÿçš„æ¿å­é¢˜</a>å’Œä¸€é“ç»å…¸çš„<a href="https://www.luogu.org/problemnew/show/P4315" target="_blank" rel="noopener">è¾¹æƒä¿®æ”¹å¯è’™é¢˜</a> </p><p>æˆ‘ä»¬è€ƒè™‘ï¼Œçº·ç¹çš„æ“ä½œï¼Œæ­¤æ—¶å¥½åƒæ ‘å‰–æ¯”è¾ƒåˆé€‚äº›ã€‚ä½†æ— è®ºæ€æ ·ï¼Œæ ‘å‰–æ˜¯å‰–ç‚¹çš„ï¼Œä¸æ˜¯å‰–è¾¹çš„ã€‚æ‰€ä»¥æˆ‘ä»¬è‡ªç„¶è€Œç„¶åœ°æƒ³åˆ°è¦å»æŠŠè¾¹æƒè½¬ç§»åˆ°ç‚¹æƒä¸Šé¢ã€‚è½¬ç§»åˆ°å“ªå„¿å»å‘¢ï¼Ÿæ˜¾ç„¶<strong>åªèƒ½è½¬ç§»åˆ°æ·±åº¦å¤§çš„ç‚¹ä¸Š</strong>ï¼Œå› ä¸ºåœ¨æ ‘è¿™ç§ç»“æ„é‡Œé¢ï¼Œä¸€å¯¹å¤šå†³å®šäº†æ¯ä¸ªèŠ‚ç‚¹å¦‚æœæƒ³è¦åªä¿ç•™ä¸€ä¸ªå±æ€§ï¼ˆæƒå€¼ï¼‰ï¼Œå°±ä¸èƒ½è®©çˆ¶èŠ‚ç‚¹ä¿ç•™è¾¹æƒâ€”â€”å¦åˆ™çˆ¶èŠ‚ç‚¹å°±ä¼šåŒæ—¶ä¿æœ‰è®¸å¤šå±æ€§ï¼Œå¹¶ä¸”å¶å­ç»“ç‚¹ä¼šæ²¡æœ‰å±æ€§ï¼Œå¯¼è‡´é€»è¾‘å…³ç³»ååˆ†æ··ä¹±ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±åº”è¯¥æŠŠè¾¹æƒæ”¾åˆ°æ·±åº¦å¤§çš„èŠ‚ç‚¹ä¸Šï¼Œå¯¹èŠ‚ç‚¹è¿›è¡Œæ“ä½œã€‚äº‹å®ä¸Šï¼Œæ­¤å¤„å”¯ä¸€éœ€è¦æ³¨æ„çš„é—®é¢˜å°±æ˜¯ï¼Œæˆ‘ä»¬åœ¨æ“ä½œçš„æ—¶å€™è¦<strong>å¿½ç•¥$LCA(u,v)$</strong>ï¼Œè¿™æ˜¯æ˜¾ç„¶çš„ã€‚å…³äºè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ˜¯æŠŠä¹‹å‰æ ‘å‰–é‡Œé¢çš„è¿™ä¸€å¥ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u], Id[v]) ;</span><br><span class="line">_update(<span class="number">1</span>, <span class="number">1</span>, N, Id[u], Id[v], d) ;</span><br></pre></td></tr></table></figure><p>æ”¹æˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v]) ;</span><br><span class="line">_update(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v], d) ;</span><br></pre></td></tr></table></figure><p>å³å¯ã€‚</p><p>è€Œå¯¹äºå¦‚ä½•è¾¹æƒè½¬ç‚¹æƒï¼Œæˆ‘ç”¨çš„æ€»æ—¶é—´å¤æ‚åº¦å¤§çº¦$O(n)$çš„åŒºé—´èµ‹å€¼å‡½æ•°ï¼Œå¥½åƒæ¯”è¾ƒæ–¹ä¾¿ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">    n[i].u = qr(), n[i].v = qr(), n[i].c = qr(), _Add(n[i].u, n[i].v, n[i].c) ;</span><br><span class="line">dfs1(<span class="number">1</span>, <span class="number">1</span>), dfs2(<span class="number">1</span>, <span class="number">1</span>), _build(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">    <span class="keyword">if</span> (Dep[n[i].u] &gt; Dep[n[i].v]) swap(n[i].u,n[i].v);</span><br><span class="line">    _change(<span class="number">1</span>, <span class="number">1</span>, N, Id[n[i].v], Id[n[i].v], n[i].c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å—¯ï¼Œ<del>é¢˜è§£å¥½å•Š</del></p><p>é‚£ä¹ˆä¸Šé¢ä¸¤ä¸ªé¢˜å°±æ¯”è¾ƒç®€å•äº†ï¼š</p><p>$\mathscr{T1 ~\text{ã®} ~code}$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, c ;</span><br><span class="line">&#125;n[MAX &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v, next, to ;</span><br><span class="line">&#125;e[MAX &lt;&lt; <span class="number">1</span>] ;  </span><br><span class="line"><span class="keyword">int</span> Id[MAX], M, N, tot, A, B, C, i ; <span class="keyword">char</span> STR[<span class="number">50</span>] ;</span><br><span class="line"><span class="keyword">int</span> Top[MAX], Fa[MAX], Sum[MAX], Son[MAX], Dep[MAX], head[MAX] ;</span><br><span class="line"><span class="keyword">int</span> Max[MAX &lt;&lt; <span class="number">1</span>], Min[MAX &lt;&lt; <span class="number">1</span>], S[MAX &lt;&lt; <span class="number">1</span>], T[MAX &lt;&lt; <span class="number">1</span>], cnt ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>, f = <span class="number">1</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) &#123;<span class="keyword">if</span> (c == <span class="string">'-'</span>) f = <span class="number">-1</span> ; c = getchar() ;&#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) res = (res &lt;&lt; <span class="number">1</span>) + (res &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> res * f ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Add(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)&#123;</span><br><span class="line">    e[++ cnt].v = c, e[cnt].to = v ;</span><br><span class="line">    e[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">    e[++ cnt].v = c, e[cnt].to = u ;</span><br><span class="line">    e[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> F, <span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    Sum[now] = <span class="number">1</span>, Fa[now] = F, Dep[now] = Dep[F] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = e[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span> (e[k].to == F) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs1(now, e[k].to) ;</span><br><span class="line">        Sum[now] += Sum[e[k].to] ;</span><br><span class="line">        <span class="keyword">if</span> (Sum[e[k].to] &gt; Sum[Son[now]]) Son[now] = e[k].to ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> Tp)</span></span>&#123;</span><br><span class="line">    Id[now] = ++ tot, Top[now] = Tp ;</span><br><span class="line">    <span class="keyword">if</span> (Son[now]) dfs2(Son[now], Tp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = e[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span> (e[k].to == Fa[now] || e[k].to == Son[now]) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs2(e[k].to, e[k].to) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_u</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    Max[rt] = max(Max[Rs(rt)], Max[Ls(rt)]) ;</span><br><span class="line">    Min[rt] = min(Min[Rs(rt)], Min[Ls(rt)]) ;</span><br><span class="line">    S[rt] = S[Ls(rt)] + S[Rs(rt)] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_d</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (T[rt])&#123;</span><br><span class="line">        <span class="keyword">int</span> t1 = Max[Ls(rt)], t2 = Max[Rs(rt)] ;</span><br><span class="line">        T[Ls(rt)] ^= <span class="number">1</span>, T[Rs(rt)] ^= <span class="number">1</span> ;</span><br><span class="line">        Max[Ls(rt)] = -Min[Ls(rt)], Max[Rs(rt)] = -Min[Rs(rt)] ;</span><br><span class="line">        Min[Ls(rt)] = -t1, Min[Rs(rt)] = -t2, S[Ls(rt)] = -S[Ls(rt)], S[Rs(rt)] = -S[Rs(rt)] ;</span><br><span class="line">        T[rt] = <span class="number">0</span> ;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span>  _build(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R)&#123;</span><br><span class="line">    <span class="keyword">if</span> (L == R) <span class="keyword">return</span> ;</span><br><span class="line">    _build(Ls(rt), L, Mid), _build(Rs(rt), Mid + <span class="number">1</span>, R) ;</span><br><span class="line">    P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _change(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r)&#123;</span><br><span class="line">        S[rt] = Max[rt] = Min[rt] = k, T[rt] = <span class="number">0</span> ; <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    P_d(rt, L, R) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) _change(Ls(rt), L, Mid, l, r, k) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) _change(Rs(rt), Mid + <span class="number">1</span>, R, l, r, k) ;</span><br><span class="line">    P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _update(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r)&#123;</span><br><span class="line">        <span class="keyword">int</span> t = Max[rt] ;</span><br><span class="line">        Max[rt] = -Min[rt], Min[rt] = -t ; </span><br><span class="line">        T[rt] ^= <span class="number">1</span>, S[rt] = -S[rt] ; <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    P_d(rt, L, R) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) _update(Ls(rt), L, Mid, l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) _update(Rs(rt), Mid + <span class="number">1</span>, R, l, r) ;</span><br><span class="line">    P_u(rt) ;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> _query(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r) <span class="keyword">return</span> Max[rt] ;</span><br><span class="line">    P_d(rt, L, R) ; <span class="keyword">int</span> Maxxxxx = -Inf ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) Maxxxxx = max(Maxxxxx, _query(Ls(rt), L, Mid, l, r)) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) Maxxxxx = max(Maxxxxx, _query(Rs(rt), Mid + <span class="number">1</span>, R, l, r)) ;</span><br><span class="line">    <span class="keyword">return</span> Maxxxxx ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> __query(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r) <span class="keyword">return</span> Min[rt] ;</span><br><span class="line">    P_d(rt, L, R) ; <span class="keyword">int</span> Minnnnn = Inf ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) Minnnnn = min(Minnnnn, __query(Ls(rt), L, Mid, l, r)) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) Minnnnn = min(Minnnnn, __query(Rs(rt), Mid + <span class="number">1</span>, R, l, r)) ;</span><br><span class="line">    <span class="keyword">return</span> Minnnnn ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ___query(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r) <span class="keyword">return</span> S[rt] ;</span><br><span class="line">    P_d(rt, L, R) ; <span class="keyword">int</span> Ssssss = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) Ssssss += ___query(Ls(rt), L, Mid, l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) Ssssss += ___query(Rs(rt), Mid + <span class="number">1</span>, R, l, r) ;</span><br><span class="line">    <span class="keyword">return</span> Ssssss ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Update(<span class="keyword">int</span> u, <span class="keyword">int</span> v)&#123;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        _update(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u]) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    _update(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get_Max</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = -Inf ;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        ret = max(ret, _query(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u])) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    ret = max(ret, _query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v])) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get_Min</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = Inf ;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        ret = min(ret, __query(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u])) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    ret = min(ret, __query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v])) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get_Sum</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        ret += ___query(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u]) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> ret ;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    ret += ___query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v]) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        n[i].u = qr() + <span class="number">1</span>, n[i].v = qr() + <span class="number">1</span>, n[i].c = qr(), _Add(n[i].u, n[i].v, n[i].c) ;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">1</span>), dfs2(<span class="number">1</span>, <span class="number">1</span>), _build(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (Dep[n[i].u] &gt; Dep[n[i].v]) swap(n[i].u,n[i].v);</span><br><span class="line">        _change(<span class="number">1</span>, <span class="number">1</span>, N, Id[n[i].v], Id[n[i].v], n[i].c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; M ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= M ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, STR) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'N'</span>) A = qr() + <span class="number">1</span>, B = qr() + <span class="number">1</span>, _Update(A, B) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'S'</span>) A = qr() + <span class="number">1</span>, B = qr() + <span class="number">1</span>, <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Get_Sum(A, B)) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'M'</span> &amp;&amp; STR[<span class="number">1</span>] == <span class="string">'A'</span>) A = qr() + <span class="number">1</span>, B = qr() + <span class="number">1</span>, <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Get_Max(A, B)) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'M'</span> &amp;&amp; STR[<span class="number">1</span>] == <span class="string">'I'</span>) A = qr() + <span class="number">1</span>, B = qr() + <span class="number">1</span>, <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Get_Min(A, B)) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'C'</span>) A = qr(), B = qr(), n[A].c = B, _change(<span class="number">1</span> ,<span class="number">1</span>, N, Id[n[A].v], Id[n[A].v], B) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜æœ‰ä¸€ä¸ªå–ç›¸åæ•°çš„æ“ä½œï¼Œé‡åˆ°è¿™ç§æ­£åéƒ½éœ€è¦è€ƒè™‘çš„ï¼Œ$tag$ä¸€å®šæ˜¯<strong>å¼‚æˆ–è€Œä¸æ˜¯è¦†ç›–</strong> â€¦â€¦æ˜¯ä¸€ä¸ªå‘ç‚¹</p><p>$\mathscr{T2 ~\text{ã®} ~code}$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, c ;</span><br><span class="line">&#125;n[MAX &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v, next, to ; <span class="comment">//0 = Change, 1 = Add .</span></span><br><span class="line">&#125;e[MAX &lt;&lt; <span class="number">1</span>] ; <span class="keyword">char</span> STR[<span class="number">50</span>] ; <span class="keyword">int</span> A, B, C ;</span><br><span class="line"><span class="keyword">int</span> Rec[MAX], Id[MAX], Aft[MAX] ;<span class="keyword">int</span> N, tot ;</span><br><span class="line"><span class="keyword">int</span> M[MAX &lt;&lt; <span class="number">1</span>], T[MAX &lt;&lt; <span class="number">1</span>][<span class="number">2</span>], head[MAX], cnt, i ;</span><br><span class="line"><span class="keyword">int</span> Top[MAX], Fa[MAX], Sum[MAX], Son[MAX], Dep[MAX];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>, f = <span class="number">1</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) &#123;<span class="keyword">if</span> (c == <span class="string">'-'</span>) f = <span class="number">-1</span> ; c = getchar() ;&#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) res = (res &lt;&lt; <span class="number">1</span>) + (res &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> res * f ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Add(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)&#123;</span><br><span class="line">    e[++ cnt].v = c, e[cnt].to = v ;</span><br><span class="line">    e[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">    e[++ cnt].v = c, e[cnt].to = u ;</span><br><span class="line">    e[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> F, <span class="keyword">int</span> now)</span></span>&#123;</span><br><span class="line">    Sum[now] = <span class="number">1</span>, Fa[now] = F, Dep[now] = Dep[F] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = e[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span> (e[k].to == F) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs1(now, e[k].to) ;</span><br><span class="line">        Sum[now] += Sum[e[k].to] ;</span><br><span class="line">        <span class="keyword">if</span> (Sum[e[k].to] &gt; Sum[Son[now]]) Son[now] = e[k].to ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> Tp)</span></span>&#123;</span><br><span class="line">    Id[now] = ++ tot, Top[now] = Tp ;</span><br><span class="line">    <span class="keyword">if</span> (Son[now]) dfs2(Son[now], Tp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = e[k].next)&#123;</span><br><span class="line">        <span class="keyword">if</span> (e[k].to == Fa[now] || e[k].to == Son[now]) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs2(e[k].to, e[k].to) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">P_u</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;M[rt] = max(M[Rs(rt)], M[Ls(rt)]) ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">P_d</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L == R) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (T[rt][<span class="number">0</span>] != <span class="number">-1</span>)&#123;</span><br><span class="line">        M[Ls(rt)] = T[rt][<span class="number">0</span>], M[Rs(rt)] = T[rt][<span class="number">0</span>] ;</span><br><span class="line">        T[Rs(rt)][<span class="number">0</span>] = T[rt][<span class="number">0</span>], T[Ls(rt)][<span class="number">0</span>] = T[rt][<span class="number">0</span>]; </span><br><span class="line">        T[rt][<span class="number">0</span>] = <span class="number">-1</span>, T[Rs(rt)][<span class="number">1</span>] = <span class="number">0</span>, T[Ls(rt)][<span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (T[rt][<span class="number">1</span>])&#123;</span><br><span class="line">        M[Ls(rt)] += T[rt][<span class="number">1</span>], M[Rs(rt)] += T[rt][<span class="number">1</span>] ;</span><br><span class="line">        T[Rs(rt)][<span class="number">1</span>] += T[rt][<span class="number">1</span>], T[Ls(rt)][<span class="number">1</span>] += T[rt][<span class="number">1</span>] ; </span><br><span class="line">        T[rt][<span class="number">1</span>] = <span class="number">0</span> ;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span>  _build(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R)&#123;</span><br><span class="line">    T[rt][<span class="number">0</span>] = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (L == R) &#123;M[rt] = <span class="number">0</span> ; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    _build(Ls(rt), L, Mid), _build(Rs(rt), Mid + <span class="number">1</span>, R) ;</span><br><span class="line">    P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _change(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r)&#123;T[rt][<span class="number">0</span>] = M[rt] = k, T[rt][<span class="number">1</span>] = <span class="number">0</span> ; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    P_d(rt, L, R) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) _change(Ls(rt), L, Mid, l, r, k) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) _change(Rs(rt), Mid + <span class="number">1</span>, R, l, r, k) ;</span><br><span class="line">    P_u(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _update(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r)&#123;T[rt][<span class="number">1</span>] += k, M[rt] += k ; <span class="keyword">return</span> ;&#125;</span><br><span class="line">    P_d(rt, L, R) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) _update(Ls(rt), L, Mid, l, r, k) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) _update(Rs(rt), Mid + <span class="number">1</span>, R, l, r, k) ;</span><br><span class="line">    P_u(rt) ;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> _query(<span class="keyword">int</span> rt, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= L &amp;&amp; R &lt;= r) <span class="keyword">return</span> M[rt] ;</span><br><span class="line">    P_d(rt, L, R) ; <span class="keyword">int</span> Maxxxxx = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &gt;= l) Maxxxxx = max(Maxxxxx, _query(Ls(rt), L, Mid, l, r)) ;</span><br><span class="line">    <span class="keyword">if</span> (Mid &lt; r) Maxxxxx = max(Maxxxxx, _query(Rs(rt), Mid + <span class="number">1</span>, R, l, r)) ;</span><br><span class="line">    <span class="keyword">return</span> Maxxxxx ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Update(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> d)&#123;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        _update(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u], d) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    _update(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v], d) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get_Max</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        ret = max(ret, _query(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u])) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> ret ;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    ret = max(ret, _query(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v])) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Cover(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> d)&#123;</span><br><span class="line">    <span class="keyword">while</span>(Top[u] != Top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(Dep[Top[u]] &lt; Dep[Top[v]]) swap(u, v) ;</span><br><span class="line">        _change(<span class="number">1</span>, <span class="number">1</span>, N, Id[Top[u]], Id[u], d) ;</span><br><span class="line">        u = Fa[Top[u]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == v) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (Dep[u] &gt; Dep[v]) swap(u, v) ;</span><br><span class="line">    _change(<span class="number">1</span>, <span class="number">1</span>, N, Id[u] + <span class="number">1</span>, Id[v], d) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        n[i].u = qr(), n[i].v = qr(), n[i].c = qr(), _Add(n[i].u, n[i].v, n[i].c) ;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">1</span>), dfs2(<span class="number">1</span>, <span class="number">1</span>), _build(<span class="number">1</span>, <span class="number">1</span>, N) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (Dep[n[i].u] &gt; Dep[n[i].v]) swap(n[i].u,n[i].v);</span><br><span class="line">        _change(<span class="number">1</span>, <span class="number">1</span>, N, Id[n[i].v], Id[n[i].v], n[i].c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; STR ;</span><br><span class="line">    <span class="keyword">while</span>(STR[<span class="number">0</span>] != <span class="string">'S'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'A'</span>) A = qr(), B = qr(), C = qr(), _Update(A, B, C) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'M'</span>) A = qr(), B = qr(), <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Get_Max(A, B)) ;</span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'C'</span> &amp;&amp; STR[<span class="number">1</span>] == <span class="string">'o'</span>) A = qr(), B = qr(), C = qr(), _Cover(A, B, C) ;    </span><br><span class="line">        <span class="keyword">if</span> (STR[<span class="number">0</span>] == <span class="string">'C'</span> &amp;&amp; STR[<span class="number">1</span>] == <span class="string">'h'</span>) A = qr(), B = qr(), n[A].c = B, _change(<span class="number">1</span> ,<span class="number">1</span>, N, Id[n[A].v], Id[n[A].v], B) ;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, STR) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜ä¹Ÿæœ‰ä¸€ä¸ªå‘ç‚¹ï¼Œä¸è¿‡æˆ‘ä¼¼ä¹æ³¨æ„åˆ°äº†ï¼Œå°±æ˜¯å®ƒå®é™…ä¸Šæœ‰ä¸¤ç§éœ€è¦ä¸‹ä¼ çš„æ ‡è®°ï¼Œä¸€ç§æ˜¯èµ‹å€¼ï¼Œä¸€ç§æ˜¯åŠ ï¼Œåœ¨ç®—æ ‡è®°çš„æ—¶å€™æ³¨æ„ä¸€ä¸‹å°±å¥½äº† ã€‚</p><h2 id="ä¸æ ‘å½¢-mathbb-DP-çš„å·§å¦™ç»“åˆ"><a href="#ä¸æ ‘å½¢-mathbb-DP-çš„å·§å¦™ç»“åˆ" class="headerlink" title="ä¸æ ‘å½¢$\mathbb{DP}$ çš„å·§å¦™ç»“åˆ"></a>ä¸æ ‘å½¢$\mathbb{DP}$ çš„å·§å¦™ç»“åˆ</h2><p>è¿™ä¸ªåœ°æ–¹å…¶å®è¯´çš„æ˜¯ä¸€ç±»é—®é¢˜ã€‚ã€‚ã€‚æ¯”å¦‚ä¸€é“<del>æˆ‘æ ¹æœ¬ä¸ä¼šçš„</del> ç»å…¸é¢˜ï¼š</p><p>$Description$</p><p>ä¸€æ£µå¸¦æƒæ ‘ï¼Œ$n$ä¸ªç‚¹$q$æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ä¸€ä¸ªç‚¹çš„$\sum dis_{odd}$å’Œ$\sum dis_{even}$ã€‚</p><p>$\mathcal{Solution}$</p><p>å…¶å®è¿™ä¸ªé¢˜çš„é¢˜ç›®æ„æ€æ˜¯è®©æˆ‘ä»¬æ±‚ï¼š</p><blockquote><p>$R$å›æƒ³çŸ¥é“å¯¹äºæ¯ä¸ªç‚¹æ¥è¯´ï¼Œåˆ°è¿™ä¸ªç‚¹æ˜¯è·ç¦»å¥‡æ•°çš„èŠ‚ç‚¹çš„è·ç¦»å’Œï¼Œä¸åˆ°è¿™ä¸ªç‚¹è·ç¦»æ˜¯å¶æ•°çš„èŠ‚ç‚¹çš„è·ç¦»å’Œã€‚    </p></blockquote><p>é‚£ä¹ˆæˆ‘ä»¬ä¸å¦¨å…ˆä»ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„é—®é¢˜å¼€å§‹è€ƒè™‘ï¼šå¦‚ä½•æ±‚ä¸€ä¸ªç‚¹åˆ°å®ƒå­æ ‘çš„è·ç¦»å’Œå‘¢ï¼Ÿ</p><p>è¿™ä¸ªä¸œè¥¿æ¯”è¾ƒç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ç›´æ¥$dfs$ã€‚</p><p>é‚£ä¹ˆå¦‚æœæ˜¯æ±‚æ‰€æœ‰ç‚¹åˆ°æ‰€æœ‰ç‚¹çš„è·ç¦»å’Œå‘¢ï¼Ÿ</p><p>æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåˆšæ‰è¿™ä¸ªååˆ†ç®€å•çš„é—®é¢˜ï¼Œå‡åæˆä¸ºä¸€ä¸ªç¨å¾®å›°éš¾ä¸€äº›çš„é—®é¢˜ï¼šå¯¹äºæ¯ä¸ªç‚¹$u$ï¼Œæ±‚æ‰€æœ‰ç‚¹ä¸å®ƒçš„è·ç¦»ä¹‹å’Œï¼Œè·ç¦»ä¾è¾¹æƒè€Œå®šã€‚</p><p>æˆ‘é¦–å…ˆå¿½ç•¥è¾¹æƒï¼Œä»¤è¾¹æƒéƒ½æ˜¯$1$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€è€ƒï¼Œæˆ‘ä»¬æ ¹æ®å·²çŸ¥æ¡ä»¶ï¼Œå¾ˆå®¹æ˜“çŸ¥é“çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¸€ä¸ªé—®é¢˜çŸ¥é“<strong>æ ¹èŠ‚ç‚¹åˆ°æ‰€æœ‰ç‚¹çš„è·ç¦»ä¹‹å’Œ</strong>ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥çŸ¥é“æ¯ä¸ªèŠ‚ç‚¹å­æ ‘å†…çš„è¾¹æƒä¹‹å’Œï¼Œé‚£ä¹ˆå¦‚ä½•åˆ©ç”¨è¿™äº›å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œæ­¤æ—¶æˆ‘ä»¬çŸ¥é“çš„é‡ï¼ŒåŒä¸€èˆ¬çš„æ ‘å½¢$DP$æˆ–è€…è¯´æ ‘å½¢ç»“æ„ä¸åŒï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“äº†<strong>æ¯ä¸€ä¸ªå­æ ‘çš„æ ¹èŠ‚ç‚¹çš„è®¯æ¯ï¼›</strong>è€Œå¹³å¸¸çš„æ ‘å½¢ç»“æ„ï¼Œæˆ‘ä»¬çŸ¥é“çš„åˆ™æ˜¯<strong>å­èŠ‚ç‚¹çš„è®¯æ¯$or$å­æ ‘çš„è®¯æ¯</strong>ï¼Œè¿™ä¸€ç‚¹æç¤ºæˆ‘ä»¬ï¼š<strong>åå‘$DP$</strong></p><p>æˆ‘ä»¬ä¸å¦¨è®¾$dp_u$è¡¨ç¤º$\sum \limits_{i \in T}^{}{dist(i,u)}$ é‚£ä¹ˆæˆ‘ä»¬æ€è€ƒå¦‚ä½•æ„é€ ç›¸é‚»ä¸¤å±‚çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å·²ç»å†³å®šåå‘$DP$ï¼Œæ¢å¥è¯è¯´å°±æ˜¯<strong>ç”¨çˆ¶äº²æ¨å‡ºå„¿å­</strong>ï¼›å¹¶ä¸”æˆ‘ä»¬äº†è§£åˆ°ï¼Œå¯¹äºæŸä¸€ä¸ªç‚¹$u$ï¼Œä»–çš„<strong>æ‰€æœ‰å­èŠ‚ç‚¹åˆ°ä»–çš„è·ç¦»è¦æ¯”åˆ°ä»–çš„çˆ¶äº²çš„è·ç¦»å°‘$1$</strong>ï¼ˆå‡è®¾è¾¹æƒ$=1$ï¼‰ï¼ŒåŒæ—¶æ‰€æœ‰<strong>é™¤å…¶å­æ ‘ä¹‹å¤–çš„æ‰€æœ‰ç‚¹åˆ°ä»–çš„è·ç¦»ä¼šå¤š$1$</strong>.é‚£ä¹ˆè½¬ç§»æ–¹ç¨‹æ—§é¡ºæ°´æ¨èˆŸåœ°ï¼š</p><h3 id="dp-v-dp-u-subsize-v-n-subsize-v-v-in-son-u"><a href="#dp-v-dp-u-subsize-v-n-subsize-v-v-in-son-u" class="headerlink" title="$dp_v = dp_u - subsize_v + (n - subsize_v), v \in son_u$"></a>$dp_v = dp_u - subsize_v + (n - subsize_v), v \in son_u$</h3><p>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬æ€è€ƒï¼Œå½“è¾¹æƒä¸ä¸º$1$çš„æ—¶å€™å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç¨å¾®é­”æ”¹ä¸€ä¸‹ä¸Šå¼ï¼Œäºæ˜¯å°±å¾—åˆ°</p><h3 id="dp-v-dp-u-2-cdot-pre-v-cdot-subsize-v-N-cdot-pre-v"><a href="#dp-v-dp-u-2-cdot-pre-v-cdot-subsize-v-N-cdot-pre-v" class="headerlink" title="$dp_v = dp_u - 2 \cdot pre_v \cdot  subsize_v + N \cdot pre_v$"></a>$dp_v = dp_u - 2 \cdot pre_v \cdot  subsize_v + N \cdot pre_v$</h3><p>å…¶ä¸­$pre_i$è¡¨ç¤ºèŠ‚ç‚¹$i$çš„ä¸Šè¡Œè¾¹ï¼Œå³çˆ¶äº²ä¸å®ƒç›¸è¿çš„é‚£æ¡è¾¹ã€‚</p><p>é‚£ä¹ˆä»¥ä¸Šç®€å•ç‰ˆæœ¬çš„ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> to, next ;</span><br><span class="line">&#125;E[MAX] ; <span class="keyword">int</span> head[MAX], cnt ; </span><br><span class="line"><span class="keyword">int</span> N, A, B, i, j, dp[MAX], sub[MAX], Pre[MAX] ; </span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _Add(<span class="keyword">int</span> u, <span class="keyword">int</span> v)&#123;</span><br><span class="line">E[++ cnt].to = v, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">E[++ cnt].to = u, E[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">sub[now] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)&#123;</span><br><span class="line"><span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ;</span><br><span class="line">build(to(k), now) ;  </span><br><span class="line">sub[now] += sub[E[k].to], dp[<span class="number">1</span>] += sub[E[k].to] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fwork</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)&#123;</span><br><span class="line"><span class="keyword">if</span> (E[k].to == f) <span class="keyword">continue</span> ;</span><br><span class="line">dp[E[k].to] = dp[now] - <span class="number">2</span> * sub[E[k].to] + N ;</span><br><span class="line">fwork(to(k), now) ; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) </span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B), _Add(A, B) ;</span><br><span class="line">build(<span class="number">1</span>, <span class="number">0</span>) ; fwork(<span class="number">1</span>, <span class="number">0</span>) ; </span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dp[i]) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å”¯ä¸€å€¼å¾—æ³¨æ„çš„åœ°æ–¹å°±æ˜¯å…¶ä¸­$dp_1$æˆ–è€…è¯´$dp_{root}$çš„å¤„ç†ã€‚é‚£ä¹ˆå…¶å®è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬åªéœ€è¦ä¸æ–­åŠ $size$å³å¯ã€‚</p><p>é«˜ç«¯ç‰ˆæœ¬çš„é—®é¢˜ï¼Œä»£ç ç±»ä¼¼ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> to, next, v ;</span><br><span class="line">&#125;E[MAX &lt;&lt; <span class="number">1</span>] ; <span class="keyword">int</span> head[MAX], cnt, i ;</span><br><span class="line"><span class="keyword">int</span> N, Sub[MAX], Pre[MAX], dp[MAX], Sum, A, B, C ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">Sub[now] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)&#123;</span><br><span class="line"><span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ;</span><br><span class="line">build(to(k), now) ;  Pre[to(k)] = E[k].v ;</span><br><span class="line">Sub[now] += Sub[to(k)], dp[<span class="number">1</span>] += Pre[to(k)] * Sub[to(k)] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp_work</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[now] ; k ; k = E[k].next)&#123;</span><br><span class="line"><span class="keyword">if</span> (to(k) == f) <span class="keyword">continue</span> ;</span><br><span class="line">dp[to(k)] = dp[now] - <span class="number">2</span> * Pre[to(k)] * Sub[to(k)] + N * Pre[to(k)] ; dp_work(to(k), now) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">E[++ cnt].to = v, E[cnt].v = w, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">E[++ cnt].to = u, E[cnt].v = w, E[cnt].next = head[v], head[v] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N ; </span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) </span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;A, &amp;B, &amp;C), Add(A, B, C) ;;</span><br><span class="line">build(<span class="number">1</span>, <span class="number">0</span>) ; dp_work(<span class="number">1</span>, <span class="number">0</span>) ; </span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">cout</span> &lt;&lt; dp[i] &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå›å½’åˆ°æˆ‘ä»¬çš„é—®é¢˜ï¼Œæˆ‘ä»¬è¦æ±‚çš„æ˜¯å¥‡æ•°è·ç¦»$\&amp;$å¶æ•°è·ç¦»ï¼Œå¾ˆç®€å•ï¼Œå†åŠ ä¸€ç»´å³å¯ã€‚</p><p>æˆ‘ä»¬è‡´åŠ›äºç»´æŠ¤è¿™æ ·ä¸€ä¸ªä¸œè¥¿ï¼šå¯¹äºæ¯ä¸ª$u \in T$ï¼Œ æˆ‘ä»¬è¯•å›¾ç¡®å®šé™¤$u$åŠå…¶å­æ ‘å¤–ï¼Œåˆ°$u$ç‚¹è·ç¦»æ˜¯å¥‡æ•°çš„ç‚¹çš„ä¸ªæ•°$S0$$\&amp;$è·ç¦»æ˜¯å¶æ•°çš„ç‚¹çš„ä¸ªæ•°$S1$ï¼Œä»¥ä¾¿äºçŠ¶æ€è½¬ç§»æ—¶ï¼Œä½œä¸ºç¬¬äºŒéƒ¨åˆ†ã€‚é‚£ä¹ˆå¹³å‡æ ‘é«˜ä¸‹ï¼Œç›´æ¥åœ¨$dfs/bfs$é‡Œé¢æ¥å›èµ‹å€¼å³å¯ã€‚ä½†æ˜¯è¿˜æ˜¯æœ‰éœ€è¦æ³¨æ„çš„åœ°æ–¹â€”â€”æ¯”å¦‚è¯´è¾¹ä¸ºå¥‡æ•°çš„æ—¶å€™ï¼Œçˆ¶å­èŠ‚ç‚¹çš„ä¸¤ä¸ªå€¼éœ€è¦$swap$ä¸€ä¸‹ï¼Œå¹¶ä¸”è¾¹æƒä¸ºå¥‡æ•°çš„æ—¶å€™ï¼Œæ˜¯äº¤å‰è½¬ç§»çš„ï¼ˆå¥‡æ•°çŠ¶æ€è½¬ç§»ç»™å¶æ•°çŠ¶æ€ï¼‰ï¼š</p><p>$$dp[to(k)][0] = dp[now][1] - Sub[to(k)][0] <em> Pre[to(k)] \ dp[to(k)][1] = dp[now][0] - Sub[to(k)][1] </em> Pre[to(k)] ï¼Œ\ dp[to(k)][0] += S0 <em> Pre[to(k)] , \ dp[to(k)][1] += S1 </em> Pre[to(k)] ;$$</p><p>å…¶ä¸­$to(k) \in son_{now}$</p><p>è€Œå¶æ•°çš„æ—¶å€™ï¼Œæ˜¾ç„¶ä¸æ˜¯äº¤å‰è½¬ç§»çš„ï¼ˆå¥‡æ•°çŠ¶æ€è½¬ç§»ç»™å¥‡æ•°çŠ¶æ€ï¼‰ï¼š</p><p>$$dp[to(k)][1] = dp[now][1] - Sub[to(k)][1] <em> Pre[to(k)] ;\ dp[to(k)][0] = dp[now][0] - Sub[to(k)][0] </em> Pre[to(k)] ;\        dp[to(k)][1] += S1 <em> Pre[to(k)],\         dp[to(k)][0] += S0 </em> Pre[to(k)] ;$$</p><p>äºæ˜¯å°±ç»“æŸäº†ã€‚å…¶å®è¿™ä¸ªåœ°æ–¹è½¬ç§»æ–¹å¼ååˆ†çš„å¤šï¼Œä½†æ˜¯å…³é”®çš„è£…å¥—è½¬ç§»æ–¹ç¨‹å…¶å®å°±æ˜¯ä¸€å¥ï¼š</p><h3 id="dp-v-dp-u-2-cdot-pre-v-cdot-subsize-v-Count-cdot-pre-v"><a href="#dp-v-dp-u-2-cdot-pre-v-cdot-subsize-v-Count-cdot-pre-v" class="headerlink" title="$dp_v = dp_u - 2 \cdot pre_v \cdot  subsize_v + Count \cdot pre_v$"></a>$dp_v = dp_u - 2 \cdot pre_v \cdot  subsize_v + Count \cdot pre_v$</h3><p>å…¶ä¸­$Count$è¡¨ç¤ºæŸç§ç¥ç§˜çš„è®¡æ•°ã€‚ã€‚ã€‚ã€‚</p><p>é‚£ä¹ˆå…¶å®è¿™ç§é—®é¢˜è¿˜å¯ä»¥æ‹“å±•åˆ°â€œæ±‚å¯¹äºæ¯ä¸€ä¸ªç‚¹$u$ï¼Œ$dist(u,v) \mod n =k$çš„ç‚¹çš„ä¸ªæ•°ï¼Œå…¶ä¸­$k \in [0,k-1]$ï¼Œæˆ‘æ„Ÿè§‰åšæ³•åº”è¯¥ä¼šç±»ä¼¼å§<del>ï¼ˆä½†æ˜¯æˆ‘è‚¯å®šä¸ä¼šåšå› ä¸ºæ ¹æœ¬ä¸å¯èƒ½è°ƒçš„å‡ºæ¥ï¼‰</del></p><h1 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h1><ul><li>æ²¡å•¥å¥½è¯´çš„ï¼Œåªè§‰å¾—ç¬¬ä¸‰æ¨¡å—çš„ä¾‹é¢˜ååˆ†éš¾è°ƒï¼ååˆ†éš¾è°ƒï¼ï¼ï¼å¹¶ä¸”â€¦â€¦æˆ‘ä¸€å¼€å§‹æ²¡ç”¨$S0$æˆ–è€…$S1$ï¼Œç›´æ¥ç”¨çš„æ ¹èŠ‚ç‚¹çš„$sub_0$å’Œ$sub_1$ï¼Œæœ€åæ‰æ³•æ¡ˆæ ¹æœ¬ä¸å’Œé€»è¾‘ã€‚ã€‚ã€‚ä½†ä»–å±…ç„¶è¿‡æ ·ä¾‹äº†ã€‚ã€‚ã€‚</li><li>è½¬ç§»çš„æ—¶å€™è¿˜æ˜¯éœ€è¦æœ‰ä¸€ä¸ªæ¸…é†’çš„æ€è·¯å†codeå•Šï¼</li><li>$DP$å¥½å•Šï¼</li></ul>]]></content>
    
    <summary type="html">
    
      ä¸€ç±»æ¯”è¾ƒç®€å•çš„æ ‘ä¸Šè·¯å¾„ç»Ÿè®¡é—®é¢˜
    
    </summary>
    
      <category term="é¢˜è§£" scheme="http://www.orchidany.cf/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ¨¡å‹" scheme="http://www.orchidany.cf/categories/%E9%A2%98%E8%A7%A3/%E6%A8%A1%E5%9E%8B/"/>
    
    
      <category term="æ ‘å½¢DP" scheme="http://www.orchidany.cf/tags/%E6%A0%91%E5%BD%A2DP/"/>
    
      <category term="æ ‘æ¨¡å‹" scheme="http://www.orchidany.cf/tags/%E6%A0%91%E6%A8%A1%E5%9E%8B/"/>
    
      <category term="è½»é‡é“¾å‰–åˆ†" scheme="http://www.orchidany.cf/tags/%E8%BD%BB%E9%87%8D%E9%93%BE%E5%89%96%E5%88%86/"/>
    
  </entry>
  
  <entry>
    <title>éšæƒ³å…­Â·éš¾</title>
    <link href="http://www.orchidany.cf/2019/03/10/%E9%9A%8F%E6%83%B3%E5%85%AD%C2%B7Hard/"/>
    <id>http://www.orchidany.cf/2019/03/10/éšæƒ³å…­Â·Hard/</id>
    <published>2019-03-10T08:06:42.000Z</published>
    <updated>2019-03-20T08:38:30.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ã€Šéšæƒ³ã€‹ç³»åˆ—ç›®æ¬¡è¡¨ï¼š<a href="http://www.orchidany.cf/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/">$Link$</a></p><h2 id="text-Part0"><a href="#text-Part0" class="headerlink" title="$\text{Part0}$"></a>$\text{Part0}$</h2><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæœ€è¿‘çš„å¿ƒç»ªé¢‡ä¸å®é™ã€‚</p><p>é‚£æ˜¯ä¸€ç§è¯´ä¸å‡ºæ¥çš„ç—›è‹¦ä¸å¯‚å¯ï¼Œæˆ–è®¸å¤¹æ‚ç€ä¸€äº›çˆ½å¿«ã€‚çœé€‰å°†è¿‘ï¼Œæˆ‘ä¸çŸ¥é“è‡ªå·±ä¼šæœ‰ä»€ä¹ˆæ ·çš„ä¸‹åœºã€‚æˆ‘åªçŸ¥é“è‡ªå·±ç åŠ›ä¾æ—§å¾ˆå¼±ã€è„‘å­ä¾æ—§å¾ˆç¬¨ã€‚æ¯”èµ·å‡ ä¸ªæœˆä¹‹å‰é€€å½¹ä¹‹åèé¡ä¸æŒ¯çš„è‡ªå·±ï¼Œæ²¡æœ‰ä»€ä¹ˆé•¿è¿›ã€‚</p><p>æˆ‘æ›´æ˜¯çŸ¥é“ï¼Œæˆ‘åŸæœ¬çš„æƒ³æ³•æ˜¯å¤šä¹ˆçš„å¹¼ç¨šã€‚æˆ–è®¸æˆ‘ä¸€ç›´åœ¨éª—è‡ªå·±å§ï¼Œéª—è‡ªå·±â€œçœé€‰ä¹‹å‰çš„ä¸€ä¸¤ä¸ªæœˆï¼Œæ‹¼ä¸€æ‹¼ã€æŒ¤ä¸€æŒ¤æ—¶é—´ï¼Œæˆ–è®¸å°±èƒ½æ€æ ·æ€æ ·â€â€”â€”åŸæ¥$\rm{NOIP}$çˆ†é”¤æˆ‘çš„äººï¼Œä¸æ­¢æ¯”æˆ‘èªæ˜ï¼Œè¿˜æ¯”æˆ‘å‹¤å¥‹ï¼Œè¿˜æ¯”æˆ‘è®¤çœŸï¼Œè¿˜æ¯”æˆ‘åŠªåŠ›ã€‚æˆ‘æœ‰ä»€ä¹ˆèµ„æœ¬å»åŒå°ç«æŠ€å‘¢ï¼Ÿåˆ°æœ€åï¼Œçœé€‰å¯¹æˆ‘æ¥è¯´ï¼Œä¹Ÿä¸è¿‡åªæ˜¯ä¸ªç¬‘è¯å§ã€‚</p><p>è¿™äº›å¤©æˆ‘ä¸€ç›´è§‰å¾—è‡ªå·±å·²ç»è¶³å¤ŸåŠªåŠ›äº†ï¼Œä½†æ˜¯å‘ç°æ°¸è¿œéƒ½æ˜¯â€œè¿œè¿œä¸å¤Ÿâ€ã€‚å°±å¥½æ¯”æˆ‘æƒ³è¦è§¦åŠ$\infin$ï¼Œè€Œæˆ‘æ¯å¤©å°±ç®—æ˜¯ä»¥$100$ã€$1000$ã€$10000$â€¦â€¦ çš„é€Ÿç‡å¢é•¿ï¼Œä¹Ÿæ°¸è¿œæ²¡æœ‰æŠµè¾¾çš„é‚£ä¸€å¤©ã€‚</p><p>æ¯•ç«Ÿå•Šï¼Œä¸Šè‹çš„ç¬”ä¸‹ï¼Œæ—©å·²ç»å†™ä¸‹äº†è§„åˆ™ï¼šæ— è®º$1$åé¢å¤šå°‘ä¸ª$0$ï¼Œéƒ½è‡³å¤šæ˜¯ä¸€ä¸ªååˆ†å¤§çš„å¸¸æ•°è€Œå·²ã€‚</p><p>å°±å¥½åƒæˆ‘è‡ªå·±ï¼Œæ— è®ºå¤šä¹ˆåŠªåŠ›ï¼ŒåŠªåŠ›åˆ°æ„ŸåŠ¨è‡ªå·±ï¼Œä¹Ÿè‡³å¤šæ˜¯ä¸€ä¸ªç¬‘è¯è€Œå·²ã€‚</p><h2 id="text-Part1-cdot-Her"><a href="#text-Part1-cdot-Her" class="headerlink" title="$\text{Part1}\cdot Her$"></a>$\text{Part1}\cdot Her$</h2><p>â€œå¥¹â€æ˜¯è°ï¼Ÿ</p><p>æˆ‘æ›¾åœ¨$qq$ç©ºé—´ä¸­å‘è¿‡ä¸€ç¯‡è¯´è¯´ï¼Œè°ƒä¾ƒæˆ‘ä»¬å¥¥èµ›ç”Ÿä¸èƒ½æ”¾å‡ï¼Œä½†æ˜¯ä¸»ä½“éƒ¨åˆ†å´æ˜¯ä¸å‡æœŸæ¯«æ— å…³ç³»ï¼š</p><blockquote><p>å¤´ä¸€æ¬¡æ¸…æ™¨åœ¨æ— äººçš„æ ¡å›­é‡Œé—²é€›ï¼Œ<br>è€³ç•”æ˜¯é’é¸Ÿåœ¨æ­Œå”±ç€ç¤¼èµï¼Œä»¥åŠå¤¹æ‚åœ¨æ¸…é£ä¸­çš„å¾å¾å›éŸ³ï¼Œ<br>çœ¼å‰æ˜¯æ¾„ç¢§è‰²çš„å¤©ç©ºï¼Œè¿œå¤„ä»¿ä½›é™ä¸‹ä¸€é“è‹¥éšè‹¥ç°çš„å¤©ä¸Šè™¹ã€‚<br>ä¸€åˆ‡éƒ½æ…¢ä¸‹æ¥äº†ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æµäº‘åœ¨èˆ’å¼ ã€å·ç¼©ï¼Œåˆèˆ’å¼ ï¼Œæˆ‘å¯ä»¥å¬åˆ°æ¸ºèŒ«çš„æ­Œå£°ï¼Œæˆ‘ç”šè‡³å¯ä»¥æƒ³åˆ°ä½ çš„æ¨¡æ ·â€”â€”é‚£åœ¨æš–é˜³ä¸‹ç† ç† é—ªå…‰çš„ç»†æ¡†çœ¼é•œå’Œæ¸…äº®çš„çœ¸å­ï¼Œä»¥åŠå¦‚æ¡ƒèŠ±ä¸€æ ·ç»¯çº¢çš„é¢é¢Šã€‚<br>å¥½åƒæ•´ä¸ªä¸–ç•Œéƒ½åœä¸‹æ¥äº†ï¼Œåªæœ‰æˆ‘å’Œåœ¨çƒŸé›¾ä¸­å¹»åŒ–å‡ºç¥å½¢çš„ä½ ï¼Œå’Œèº«æ—ææ¢¢ä¸Šçš„é’é¸Ÿï¼Œä»¥åŠæŒ‡å°–æµæ çš„æ¸…é£ä¸é˜³å…‰â€”â€”</p></blockquote><p>æœ€åä¸€å¥æœ¬æ¥æ˜¯<code>ä½†æ˜¯è¿™TMè·Ÿæˆ‘åªèƒ½å¾…åœ¨å­¦æ ¡ä¸èƒ½å›å®¶å¹¶ä¸”ä½ ä»¬åœ¨å®¶é‡Œå—¨æ²¡æœ‰ä»»ä½•å…³ç³»</code>ï¼Œæ¯•ç«Ÿæ˜¯ä¸ºäº†é€—ä¹ï¼Œæˆ‘ä¹Ÿä¸æƒ³è¢«å½“æˆä»€ä¹ˆä¸ºæ„Ÿæƒ…çƒ¦æ¼çš„æ„£å¤´é’ã€‚ä½†æ˜¯åœ¨æˆ‘çœ‹æ¥ï¼Œä¸»ä½“éƒ¨åˆ†åº”è¯¥æ˜¯ä¸Šé¢å¼•ç”¨æ¡†é‡Œçš„å†…å®¹ã€‚</p><p>æˆ‘æ›¾ç»è§‰å¾—åªè¦å¥¥èµ›æ‹¿äº†è€€çœ¼çš„æˆç»©ï¼Œå°±å¯ä»¥ååˆ†éª„å‚²åœ°å»è¿½æ±‚æˆ‘æƒ³è¦çš„ã€‚ä½†å°±ç°åœ¨çš„æƒ…å†µè€Œè¨€ï¼Œä¸æ˜¯å¾ˆä¹è§‚ã€‚</p><p>æˆ‘ä¸æƒ³è®©å¥¹çŸ¥é“è¿™ä»¶äº‹ï¼Œå› ä¸ºè¿™ä¸–ç•Œä¸Šæ— ç–¾è€Œç»ˆçš„äº‹æƒ…å¤ªå¤šäº†ï¼Œæˆ–è®¸è¿™å°±æ˜¯ä¸‹ä¸€ä»¶ã€‚ä½†å…¶å®æ€æ¥æƒ³å»ï¼Œä¼¼ä¹è¿™ä»½è–„è–„çš„æ„Ÿæƒ…å¹¶ä¸é‚£ä¹ˆé‡è¦ï¼Œå› ä¸ºæ¯”èµ·è¿™äº‹å„¿æ¥ï¼Œæˆ‘éœ€è¦æ‹…å¿ƒçš„ä¸œè¥¿è¿˜æœ‰å¤ªå¤šå¤ªå¤šâ€”â€”æ˜å¤©è·‘æ“ä¼šä¸ä¼šå¾ˆç´¯ï¼Ÿæ–‡åŒ–è¯¾ä¼šä¸ä¼šç»§ç»­è·ªï¼Ÿæ–‡åŒ–è¯¾è·ªå®Œç­ä¸»ä»»æ˜¯å¦ä¼šä¸§å¤±å¯¹æˆ‘çš„æœ€åä¸€ç‚¹ä¿¡ä»»ï¼Ÿæˆ‘çš„OIç»ˆç‚¹åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿâ€¦â€¦</p><p>ä»¥å‰ä»æ²¡è§‰å¾—åšäººè¿™ä¹ˆéš¾ã€‚ä½†æˆ‘å¹¶ä¸æƒ³è¯´â€œæˆ‘æˆé•¿äº†â€è¿™ç§è‡ªæˆ‘æ»¡è¶³å¼çš„è¯è¯­ï¼Œæˆ‘æ›´æƒ³å¯¹æˆ‘è‡ªå·±è¯´ï¼š</p><blockquote><p>å¤§æ¦‚æ˜¯åªæœ‰å¼±è€…æ‰ä¼šè§‰å¾—äººç”Ÿè‰°éš¾å§ã€‚ä½ çœ‹ä½ ç°æš—çš„çœ¼çœ¸ä¸­çš„å¯¹å²¸ï¼Œæ­£æœ‰ä¸ªé’å¹´ï¼Œçœ¼é‡Œå…¨æ˜¯å±±æ°´è¯—ç”»ã€‚å¯æƒœé‚£ä¸ªé’å¹´ï¼Œä¸æ˜¯ä½ ã€‚</p></blockquote><p>å¥¹å­¦ä¹ æˆç»©å¾ˆå¥½ï¼Œæ¯•ç«Ÿä¸å­¦å¥¥èµ›ï¼Œæœ‰å¤§æŠŠçš„æ—¶é—´å»ææ–‡åŒ–è¯¾ã€‚è€Œæˆ‘æˆ–è®¸åªæ˜¯ç­çº§è§’è½é‡Œä¸€ä¸ªå–œæ¬¢æ ‡æ–°ç«‹å¼‚çš„å¼±è€…å§ã€‚</p><h2 id="rm-Part3"><a href="#rm-Part3" class="headerlink" title="$\rm{Part3}$"></a>$\rm{Part3}$</h2><p>æˆ‘å¾ˆçƒ¦ã€‚</p><p>æœºæˆ¿é‡Œå»å¹´çœä¸€çš„å°ä¼™ä¼´ä»¬ä¼¼ä¹å¹¶ä¸æ˜¯å¤šåœ¨æ„çœé€‰ï¼Œå°±åªæœ‰æˆ‘åœ¨æ‹¼å¾—å¤´æ˜è„‘èƒ€ã€‚</p><p>æˆ‘å¥½ä¸çˆ½å•Šï¼Œå‡­ä»€ä¹ˆæˆ‘å¦‚æ­¤çè§†çš„ä¸œè¥¿ï¼Œä»–ä»¬å¯ä»¥èƒ¡ä¹±è¹‚èºã€æµªè´¹ã€ç·æ±¡â€”â€”å†µä¸”è¿„ä»Šä¸ºæ­¢è¿™ä¸ªæœºä¼šå¯¹äºå»å¹´<code>NOIP</code>è€ƒæŒ‚çš„æˆ‘ï¼Œè¿˜ä¸ä¸€å®šæœ‰è¿™ä¸ªæœºä¼šå»çœé€‰ã€‚è¿™å°±å¥½åƒæˆ‘çš„å¥³ç¥ä¸å±äºæˆ‘ï¼Œä½†æ˜¯å´è¢«å¦ä¸€ä¸ªäººåˆæ€åˆå‰â€”â€”æˆ‘æ€èƒ½ä¸ç”Ÿæ°”+å¯’å¿ƒå‘¢ï¼Ÿ</p><p>å¥½åœ¨è¿™ä¸ªç²¾ç¥çŠ¶æ€æŒç»­äº†ä¸¤å¤©å°±å¥½è½¬äº†â€”â€”ä¸»è¦åŸå› æ˜¯æˆ‘å¾—çŸ¥$SD$çš„çœé€‰æ”¿ç­–ï¼Œåªæ˜¯é™åˆ¶äº†åŸºå‡†çº¿è€Œå·²â€”â€”æˆ–è®¸è¿˜æœ‰æœºä¼šï¼Ÿæˆ‘ä¸çŸ¥é“ï¼Œå› ä¸ºæˆ‘çš„æ™ºå•†åœ¨æ‰€æœ‰çš„$Oier$é‡Œé¢ï¼Œå¤§æ¦‚ç®—æ˜¯ä¸ªä¸­ä¸‹ï¼Œæ‰€ä»¥æˆ‘å³ä½¿æ‹¼å°½å…¨åŠ›ä¹Ÿä¸èƒ½ä¿è¯å¼ºè¿‡è°â€”â€”å†µä¸”æˆ‘æ ¹æœ¬ä¸å¯ä»¥æ‹¼å°½å…¨åŠ›å•Šâ€¦</p><p>æœ€è¿‘ä¸€ç›´åœ¨ç¿˜è€ƒè¯•ã€ç¿˜ç¾æœ¯éŸ³ä¹è¯¾â€¦â€¦å„ç§ç¿˜ï¼Œæˆ‘ä¼°è®¡ç­ä¸»ä»»é©¬ä¸Šå°±è¦é€šè¿‡å¯¹æˆ‘çš„ä¸ä¿¡ä»»æ¡ˆäº†â€¦â€¦</p><h2 id="rm-Part4"><a href="#rm-Part4" class="headerlink" title="$\rm{Part4}$"></a>$\rm{Part4}$</h2><p>ä¸å¾—ä¸è¯´è¿™ç¯‡éšæƒ³æ¯”ä¹‹å‰çš„éšæƒ³æ°´å¤šäº†â€¦â€¦äºæ˜¯ç³Šä¸€ç¯‡æˆ‘åœ¨çŸ¥ä¹ä¸Šçš„å›ç­”å§ã€‚å½“æ—¶æœ‰ä¸ªé¢˜ä¸»é—®ï¼Œå¦‚æœä»é«˜ä¸€ä¸‹å­¦æœŸå·¦å³å¼€å§‹ï¼Œæ¯å¤©å­¦å¥¥èµ›å‡ ä¸ªå°æ—¶ï¼Œèƒ½ä¸èƒ½æ‹¿é‡‘ç‰Œã€‚</p><p>å…¶å®æœ¬æ¥æ˜¯æ— æ‰€è°“çš„â€”â€”äºæˆ‘è€Œè¨€æ— æ‰€è°“ã€‚å› ä¸ºä»–å¿—å‘å®å¤§æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œè‡³äºèƒ½å¦æˆçœŸï¼Œæˆ‘ä¹Ÿæ²¡æœ‰è¯„è®ºçš„æƒåˆ©ã€‚ä½†æ˜¯æˆ‘ç¡®ä¹æ˜¯å‘ç°ï¼Œä»–å¿ƒé‡Œä¸€ç›´æ˜¯è§‰å¾—â€œæˆ‘è¿˜æœ‰ä¸¤æŠŠåˆ·å­çš„â€ï¼Œâ€œåªæ˜¯æ—¶è¿ä¸æµç½¢äº†â€ã€‚ä¸çŸ¥æ€çš„ï¼Œçªç„¶æˆ‘å°±æœ‰äº†æƒ³å¤šè¯´ä¸¤å¥çš„æ¬²æœ›ï¼š</p><blockquote><p>æˆ‘ç»™ä½ è®²ï¼Œç›®æ ‡è·Ÿçœ¼ç•Œå’Œå®åŠ›æœ‰å…³ã€‚çœ¼ç•Œè¶Šå¤§ã€å®åŠ›è¶Šå¼ºï¼Œç›®æ ‡è¶Šå°ã€‚</p><p>åŒæ—¶ï¼Œæˆ‘å¯ä»¥å¾ˆè´Ÿè´£ä»»çš„è·Ÿä½ è®²ï¼šä½ ç»å¯¹ä¸çŸ¥é“çš„æ¥ä¸‹æ¥ä½ é¢ä¸´çš„æ˜¯ä»€ä¹ˆã€‚</p><p>å¦‚æœè¯´ä½ å‡†å¤‡æé«˜ç»„çš„è€ƒè¯•ä¹‹å‰ï¼Œæœ‰ä»€ä¹ˆé¢˜ä¸ä¼šçœ‹é¢˜è§£ï¼Œç†è§£èµ·æ¥çš„ç—›è‹¦ç¨‹åº¦æ˜¯1çš„è¯ï¼Œé‚£ä¹ˆä½ æƒ³ç»§ç»­å‘ä¸Šèµ°ã€æƒ³å»çœé€‰ã€æƒ³å»NOIï¼Œç†è§£èµ·æ¥çš„ç—›è‹¦ç¨‹åº¦å°†ä¼šæ˜¯1e5ä»¥ä¸Šã€‚</p><p>æ²¡é”™ï¼Œ10ä¸‡å€â€”â€”å¦‚æœä½ æƒ³è‡ªå­¦çš„è¯ã€‚ç›¸ä¿¡æˆ‘ï¼ŒNOIPçº§åˆ«çš„è€ƒè¯•ï¼Œåªæ˜¯è€ƒä»£ç ç´ è´¨/ç¨‹åºè®¾è®¡èƒ½åŠ›ï¼Œæ ¹æœ¬ä¸è€ƒå¯Ÿç†è§£èƒ½åŠ›ã€‚</p><p>ä¿é€â€”â€”æ˜¯çš„ï¼Œè¿™æ˜¯å¥¥èµ›çš„ç»ˆæç›®æ ‡ä¹‹ä¸€ã€‚ä½†æ˜¯å‘æ¥ä¸ä¼šæœ‰äººä¸»åŠ¨è°ˆèµ·è¿™ä»¶äº‹ï¼Œå³ä½¿ä»–å†NBã€‚ä½ ç°åœ¨è¿˜å¯ä»¥æå‡ºè¿™ä¸ªé—®é¢˜ï¼Œåªæ˜¯è¯´æ˜ä½ è¿˜ä¸äº†è§£è¡Œæƒ…ã€‚æŠ±æ­‰ï¼Œå¦‚æœä½ ç°åœ¨è§‰å¾—ä½ è‡ªå·±å¾ˆæœ‰å¤©åˆ†ï¼Œä½ è§‰å¾—ä½ ç°åœ¨å¯ä»¥æ‹¿â€œå•Šâ€¦æˆ‘å½“æ—¶åªæ˜¯å› ä¸ºæŸäº›è·Ÿæˆ‘è‡ªå·±æ²¡æœ‰å…³ç³»çš„åŸå› å¤±è´¥äº†â€è¿™ç§å¹¼å„¿å›­æ™ºå•†çš„ç†ç”±æ¥éª—è‡ªå·±â€”â€”æˆ‘åªèƒ½è·Ÿä½ è¯´ï¼Œä½ ä¸çŸ¥é“å…¶å®ƒäººæœ‰å¤šå‰å®³ï¼Œè¯´å¾—éš¾å¬äº›ï¼Œå°±æ˜¯äº•åº•ä¹‹è›™â€”â€”</p><p>ä½ çŸ¥é“å…¨ä¸­å›½æœ‰æ— ç©·æ— å°½çš„æ™ºå•†å¯ä»¥åŠæ‰“ä½ çš„äººï¼Œä»–ä»¬æ¯å¤©å¯ä»¥æœ‰å¤§åŠå¤©çš„æ—¶é—´å­¦OIå—ï¼Ÿ</p><p>ä½ çŸ¥é“æ¯å¹´æœ‰å¤šå°‘åˆä¸­ç”Ÿåœ¨NOIpä¸­ç¢¾å‹é«˜ä¸­ç”Ÿå—ï¼Ÿ</p><p>ä½ ä¸çŸ¥é“ã€‚</p><p>æ¯å¤©å‡ ä¸ªå°æ—¶ï¼Ÿ</p><p>åšå­¦é—®æœ€éœ€è¦çš„æ˜¯è°¦å‘ï¼Œç»™è‡ªå·±æ‰¾ç†ç”±ã€æ²‰æµ¸åœ¨â€œæˆ‘åº”è¯¥å¤šä¹ˆå¤šä¹ˆå‰å®³â€çš„å¹»æƒ³é‡Œç»ˆç©¶ä¼šå¤±è´¥ã€‚</p><p>ä½ ç›¸ä¿¡æˆ‘ï¼Œæˆ‘è¯´çš„éƒ½æ˜¯åˆ‡å®çš„ä½“ä¼šã€‚ä½ ä½“ä¼šä¸åˆ°æ˜¯å› ä¸ºä½ ä¸çŸ¥é“ä½ æ‰€åœ¨å››å·åˆ°åº•æœ‰å¤šä¹ˆææ€–â€”â€”åŸºæœ¬æ˜¯æˆéƒ½ä¸ƒä¸­åˆ¶éœ¸ï¼›NOIPå…¨çœå‰40äººå‡460+ï¼Œå…¨çœå‰90äººå‡400+ã€‚</p><p>æˆ‘çŸ¥é“æˆ‘æ²¡æœ‰å¾ˆå‰å®³ï¼Œæ‰€ä»¥æˆ‘çš„è¯ä½ ä¸ä¼šä¿¡å¤šå°‘ã€‚ä½†æ˜¯å¦‚æœè¯´å¥¥èµ›ç»™äº†æˆ‘ä»€ä¹ˆï¼Œæœ€å¤§çš„æ”¶è·å°±æ˜¯åœ¨å­¦æœ¯ä¸Šé¢çš„è™”è¯šâ€”â€”åšå­¦é—®å°±å¥½å¥½åšå­¦é—®ï¼Œä¸å»è¿½æ±‚é™„åŠ ä»·å€¼ï¼Œä»¥åŠåœ¨å­¦æœ¯ä¸Šæ°¸è¿œè°¦å‘çš„æ€åº¦ã€‚</p></blockquote><p>çœ‹èµ·æ¥ä¼¼ä¹æˆ‘å¾ˆåˆšçš„æ ·å­ï¼Œä½†æ˜¯è¿™æ ·åšä¸æ˜¯æ¯«æ— ç¼˜ç”±çš„â€”â€”æˆ‘å…¶å®ï¼Œä¹Ÿæ˜¯åœ¨å¯¹è‡ªå·±è¯´å§ã€‚</p><p>ä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆéš¾å‘¢ï¼Ÿæˆ‘ä¸çŸ¥é“å•Šã€‚</p><p>æˆ‘åªçŸ¥é“æˆ‘çš„æœºä¼šç¡®ä¹æ˜¯ä¸å¤šäº†ã€‚</p><p>ä»Šå¹´çœé€‰è¿˜æœ‰æ²¡æœ‰æˆå‘¢ï¼Ÿæˆ‘ä¹Ÿä¸çŸ¥é“ã€‚</p><p>æˆ‘åªçŸ¥é“æˆ‘çš„æ—¶é—´ä¸å¤šäº†ã€‚</p><p>ä¸çŸ¥æ€çš„ï¼Œçœ¼å‰ä»¿ä½›æœ‰ä¸€æ¡å®½é˜”çš„å¤§æ²³ï¼Œæµ©è¡æ— é™…ã€‚æˆ‘æ— è®ºåšä»€ä¹ˆï¼Œéƒ½åªèƒ½åœ¨ä¸Šé¢æº…èµ·ä¸€åœˆçª„çª„çš„æ³¢çº¹è€Œå·²ã€‚æˆ‘åœ¨å°å°çš„æ²™æ´²ä¸Šä¼«ç«‹ç€ï¼Œè¿œæœ›æ˜¯å¦ä¸€ä¸ªå°å°çš„æ²™ä¸˜ï¼Œä¸Šé¢ç«™ç€å¥¹ã€‚æˆ‘æ— æ³•ä¸ˆé‡å‡ºæˆ‘ä»¬å½¼æ­¤ä¹‹é—´çš„è·ç¦»ï¼Œå¥½åƒå¾ˆè¿‘ï¼Œè¿‘åˆ°æˆ‘èƒ½çœ‹æ¸…å¥¹çš„ä¸€é¢¦ä¸€ç°‡ï¼Œå¯ä»¥çœ‹æ¸…å¥¹çœ‰ä¸Šæ–°æ·»çš„éœ²ç ï¼›å¥½åƒä¹Ÿå¾ˆè¿œï¼Œå› ä¸ºæˆ‘ä¸çŸ¥é“å¥¹åœ¨æƒ³ä»€ä¹ˆã€å¥¹è¦åšä»€ä¹ˆã€‚</p><p>å‘µï¼Œæ‰è®°èµ·æ¥æ›¾ç»æœ‰ä¸€éƒ¨æ—¶ä¸‹è¾ƒç«çš„å‰§é‡Œï¼Œç§°â€œæš—æ‹â€æˆ–è€…â€œå•ç›¸æ€â€ï¼Œæ˜¯æœ€çœé’±çš„æ‹çˆ±ã€‚æˆ‘ç¡®ä¹æ˜¯è®°ä½è¿™ä¸€ç‚¹äº†ã€‚ä½†æ˜¯æˆ‘æ›´æƒ³è¯´ï¼Œå®ƒä¸ä»…æ˜¯æœ€çœé’±çš„ï¼Œä¹Ÿæ˜¯æœ€ç¾çš„ã€æœ€å¯Œæœ‰å˜åŒ–çš„ã€æœ€æ¢¦å¹»çš„ã€‚</p><p>è¿™æ˜¯ä¸€ç‰‡æ— å çš„æœ¦èƒ§ï¼Œå¤œå¹•ä¸­é¥é¥çš„ï¼Œä»¿ä½›é—ªç€ä¸¤é¢—æ‘‡æ›³çš„æ˜Ÿã€‚</p>]]></content>
    
    <summary type="html">
    
      æœ€è¿‘å¿ƒç»ªé¢‡ä¸å®é™ã€‚
    
    </summary>
    
      <category term="Life" scheme="http://www.orchidany.cf/categories/Life/"/>
    
    
      <category term="éšæƒ³/ä¸‹ä¸‹ç¬”" scheme="http://www.orchidany.cf/tags/%E9%9A%8F%E6%83%B3-%E4%B8%8B%E4%B8%8B%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>BSGS-SeniorÂ·æ‰©å±•çš„BSGS</title>
    <link href="http://www.orchidany.cf/2019/02/22/exBSGS/"/>
    <id>http://www.orchidany.cf/2019/02/22/exBSGS/</id>
    <published>2019-02-22T13:10:55.000Z</published>
    <updated>2019-03-16T13:11:58.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt=""></p><hr><h1 id="rm-0x01-quad-Preface"><a href="#rm-0x01-quad-Preface" class="headerlink" title="$\rm{0x01\quad Preface}$"></a>$\rm{0x01\quad Preface}$</h1><p>$emmm$ä¸¥æ ¼æ¥è®²ï¼Œä¸åº”è¯¥è¢«ç®—åˆ°ä¸€ä¸ªæ¨¡æ¿é‡Œé¢ã€‚å› ä¸ºåœ¨æˆ‘çœ‹æ¥<strong>æ¨¡æ¿</strong>æ˜¯äººæ„é€ å‡ºæ¥çš„ï¼Œä½†æ˜¯è¿™ä¸ªç®—æ³•åº”è¯¥æ˜¯ä¸€ä¸ªè§£å†³é—®é¢˜çš„$process$â€¦æ›´åƒæ˜¯åœ¨è§£ä¸€é“æ•°å­¦é¢˜ï¼Œå¦‚æœ$BSGS$æ˜¯å®šç†çš„è¯ï¼Œ$exBSGS$æ›´åƒæ˜¯ä¸€ä¸ªä¸æ–­è½¬åŒ–çš„è¿‡ç¨‹233ï¼ˆæ‰‹åŠ¨@lxaå¹¶ä¸”æºœ</p><h1 id="rm-0x02-quad-Algorithm-Process"><a href="#rm-0x02-quad-Algorithm-Process" class="headerlink" title="$\rm{0x02\quad Algorithm~Process}$"></a>$\rm{0x02\quad Algorithm~Process}$</h1><p>ä»Šå¤©æ‰å‘ç°åŸæ¥$\rm{BSGS}$æœ‰ä¸¤ç§å†™æ³•â€¦â€¦å¹¶ä¸”è§‰å¾—å‰©ä¸‹çš„é¢˜è§£è®²çš„éƒ½è®²çš„ä¸æ˜¯å¾ˆå…¨çš„æ ·å­233ã€‚</p><p>å…¶å®æœ¬è´¨ä¸Šï¼Œå½“$p$ä¸ä¸ºç´ æ•°æ—¶ï¼Œæˆ‘ä»¬æ— æ³•è¿›è¡Œæœ´ç´ $\rm{BSGS}$çš„åŸå› æ˜¯æˆ‘ä»¬çš„æ¬§æ‹‰å®šç†$a^{\varphi(p)} \equiv b(\bmod p)$ åªèƒ½å¤„ç†$(a,p)=1$çš„æƒ…å†µã€‚é‚£ä¹ˆæˆ‘ä»¬çŸ¥é“ï¼Œæœ´ç´ çš„$\rm{BSGS}$çš„å…³é”®åœ¨äºï¼Œå¯ä»¥ä¿è¯æœ€å°è§£æ˜¯æœ‰ç•Œçš„â€”â€”$x$ä¸€å®šåœ¨$[1,\varphi(p)]$ä¸­ã€‚æ‰€ä»¥æœ€å$BSGS$çš„å¤æ‚åº¦æ‰ä¼šæ˜¯$\Theta(\sqrt{\varphi(p)})$ çš„â€”â€”æ¯”å¦‚è¯´æ¯”è¾ƒå¸¸è§çš„$p$æ˜¯ç´ æ•°çš„æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$\Theta(p)$ã€‚</p><p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦è¿›è¡Œä¸€äº›æ“ä½œï¼Œä¿è¯$(a,p)=1 $å³å¯$^{[1]}$ã€‚</p><p>æˆ‘ä»¬æ€è€ƒï¼Œå¯¹äºåŒä½™å¼$a^x\equiv b~(\bmod p)â€‹$è€Œè¨€ï¼Œæˆ‘ä»¬å…ˆå‡å®š$(a,p)&gt;1 â€‹$ã€‚è€Œæ­¤æ—¶å¦‚æœæœ‰$((a,p), b)=1â€‹$ï¼Œé‚£ä¹ˆè¯´æ˜æ­¤å¼åªæœ‰å¯èƒ½åœ¨$x=0,b=1 â€‹$çš„æ—¶å€™æœ‰è§£â€”â€”è¿™ä¸ªç»“è®ºæ˜¯å¹³å‡¡çš„ã€‚å› ä¸ºå‡è®¾æˆ‘ä»¬æŠŠå®ƒå±•å¼€æˆ$a\cdot a^{x-1} +kp=b â€‹$çš„å½¢å¼ï¼Œå¿…é¡»è¦æœ‰$(a,p)  ~|~ bâ€‹$çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½ä¿è¯$a^{x-1}â€‹$å’Œ$k â€‹$éƒ½æ˜¯æ•´æ•°ã€‚</p><p>é‚£ä¹ˆå¯¹äº$(a,p)&gt;1$ä¸”$(a,p)~|~b $ï¼Œæˆ‘ä»¬ä»¤åŸå¼å˜æˆ</p><p>$$<br>a^{x-1}\cdot \frac{a}{(a,p)} \equiv \frac{b}{(a,p)} (\bmod \frac{p}{(a,p)})<br>$$<br>çš„æ ·å­ï¼Œå¦‚æœæ­¤æ—¶$(a^{x-1},\frac{p}{(a,p)})=1$ çš„è¯ï¼Œæˆ‘ä»¬å°±ç›´æ¥è§£</p><p>$$<br>a^{x-1}\equiv \frac{\frac{b}{(a,p)}} {\frac{a}{(a,p)} }(\bmod \frac{p}{(a,p)})<br>$$<br>è¿™ä¸ªæ–¹ç¨‹å³å¯ã€‚å¦åˆ™æˆ‘ä»¬ç»§ç»­åˆ†è§£ç›´è‡³$(pâ€™,a)=1$ã€‚</p><p>é‚£ä¹ˆæ­¤æ—¶æœ‰ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼Œå°±æ˜¯å¦‚æœä»¬åœ¨è§£è¿™ä¸ªæ–¹ç¨‹æ—¶ï¼Œå‡ºç°äº†</p><p>$$<br>(a^{x-1}, \frac{p}{(a,p)})\nmid \frac{\frac{b}{(a,p)}} {\frac{a}{(a,p)} }<br>$$<br>çš„æƒ…å†µï¼Œé‚£æˆ‘ä»¬éœ€è¦ç‰¹åˆ¤å¹¶<code>return -1</code> ï¼›å¦ä¸€ç§æƒ…å†µï¼Œå¦‚æœæˆ‘ä»¬å‡ºç°äº†</p><p>$$<br>a^{x-1}\equiv \frac{\frac{b}{(a,p)}} {\frac{a}{(a,p)} } \equiv1(\bmod \frac{p}{(a,p)})<br>$$<br>çš„æƒ…å†µï¼Œä¹Ÿéœ€è¦ç‰¹åˆ¤å¹¶è¾“å‡ºæ­¤$k$ï¼ˆæ­¤æ—¶åŒä½™å¼å·¦è¾¹æ˜¯$a^{x-k}$ï¼Œå› ä¸º$a^{x-k}\equiv1~(\bmod p)$æ‰€ä»¥ç›´æ¥è¾“å‡º$k$ï¼‰ï¼Œä¸è¿‡ä¹Ÿæœ‰å¯èƒ½ä¸éœ€è¦ï¼Œå®Œå…¨çœ‹ä½ å†™çš„$BSGS$èƒ½ä¸èƒ½åˆ¤æ–­$x=0$çš„æƒ…å†µâ€¦â€¦ä¸€èˆ¬æƒ…å†µä¸‹ä¸èƒ½ã€‚</p><p>æ­¤æ—¶<strong>ç”±äº$\boldsymbol{p}$ä¸å†æ˜¯ç´ æ•°ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨è´¹é©¬å°å®šç†ï¼Œéœ€è¦æˆ‘ä»¬ç”¨$exgcd$çš„æ–¹æ³•æ±‚é€†å…ƒï¼ŒåŒ…æ‹¬ä½†ä¸é™äº$\frac{b}{(a,p)}$çš„é€†å…ƒå’Œ$a^{-im}$ã€‚</strong></p><p>ä»¥ä¸‹æ˜¯å®Œæ•´ç‰ˆä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; </span><br><span class="line"><span class="built_in">unordered_map</span>&lt;ll, <span class="keyword">int</span>&gt; H ;</span><br><span class="line"><span class="keyword">int</span> N, M, P, ans ; <span class="comment">// N ^x = M (mod P)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">gcd</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) <span class="keyword">return</span> a ;</span><br><span class="line">    <span class="keyword">return</span> gcd(b, a % b) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">expow</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b) res = ((b &amp; <span class="number">1</span>)?res * a % mod : res), a = a * a % mod, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">exgcd</span><span class="params">(ll &amp;x, ll &amp;y, ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b)&#123; x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> a ; &#125;</span><br><span class="line"> ll t = exgcd(y, x, b, a % b) ; y -= x * (a / b) ; <span class="keyword">return</span> t ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">BSGS</span><span class="params">(ll a, ll b, ll mod, ll qaq)</span></span>&#123;</span><br><span class="line">    H.clear() ; ll Q, p = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(mod)), x, y ; </span><br><span class="line">    exgcd(x, y, qaq, mod), b = (b * x % mod + mod) % mod, </span><br><span class="line">    Q = expow(a, p, mod), exgcd(x, y, Q, mod), Q = (x % mod + mod) % mod ;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>, j = <span class="number">0</span> ; j &lt;= p ; ++ j, i = i * a % mod)  <span class="keyword">if</span> (!H.count(i)) H[i] = j ;</span><br><span class="line">    <span class="keyword">for</span> (ll i = b, j = <span class="number">0</span> ; j &lt;= p ; ++ j, i = i * Q % mod)  <span class="keyword">if</span> (H[i]) <span class="keyword">return</span> j * p + H[i] ; <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">exBSGS</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll qaq = <span class="number">1</span> ;</span><br><span class="line">    ll k = <span class="number">0</span>, qwq = <span class="number">1</span> ; </span><br><span class="line">    <span class="keyword">if</span> (M == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">    <span class="keyword">while</span> ((qwq = gcd(N, P)) &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (M % qwq) <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">        ++ k, M /= qwq, P /= qwq, qaq = qaq * (N / qwq) % P ;</span><br><span class="line">        <span class="keyword">if</span> (qaq == M) <span class="keyword">return</span> k ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (qwq = BSGS(N, M, P, qaq)) == <span class="number">-1</span> ? <span class="number">-1</span> : qwq + k ;</span><br><span class="line">&#125;                    </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; N)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;P, &amp;M); <span class="keyword">if</span> (!N &amp;&amp; !M &amp;&amp; !P) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        N %= P, M %= P, ans = exBSGS() ; <span class="keyword">if</span> (ans &lt; <span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">"No Solution"</span>) ; <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="rm-0x03-quad-Afterword"><a href="#rm-0x03-quad-Afterword" class="headerlink" title="$\rm{0x03\quad Afterword}$"></a>$\rm{0x03\quad Afterword}$</h1><p>ä»Šå¤©æ‰çŸ¥é“åŸæ¥$BSGS$æœ‰ä¸¤ç§å†™æ³•qaq</p><p>$zyf2000$å¥½åƒå’Œæˆ‘å†™çš„$BSGS$å¯¹â€œå¤§æ­¥â€å’Œâ€œå°æ­¥â€çš„å®šä¹‰ä¸æ˜¯å¾ˆä¸€æ ·â€¦äºæ˜¯æœ€åè¿˜æ˜¯è‡ªå·±$\rm{yy}$çš„233</p><h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$\rm{Reference}$"></a>$\rm{Reference}$</h2><ul><li>$[1]$ :$zyf2000$çš„$blog$ <a href="https://blog.csdn.net/clove_unique/article/details/51227328" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li></ul>]]></content>
    
    <summary type="html">
    
      ä¼—æ‰€å‘¨çŸ¥ï¼Œæœ´ç´ çš„$BSGS$å¹¶ä¸å¯ä»¥è§£å†³$pâ€‹$ä¸ä¸ºç´ æ•°çš„é—®é¢˜ã€‚
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="BSGS/exBSGS" scheme="http://www.orchidany.cf/tags/BSGS-exBSGS/"/>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>å¤šé¡¹å¼1.5Â·æ‹†ç³»æ•°FFT</title>
    <link href="http://www.orchidany.cf/2019/02/19/FFT2/"/>
    <id>http://www.orchidany.cf/2019/02/19/FFT2/</id>
    <published>2019-02-19T14:00:05.000Z</published>
    <updated>2019-03-17T13:11:52.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89-darkviolet.svg" alt=""></p><p>ä¸Šä¸€ç¯‡å¤šé¡¹å¼ï¼š<a href="http://www.orchidany.cf/2019/02/19/FFT1/">å¤šé¡¹å¼1Â·æ™®é€šçš„FFT</a></p><hr><h1 id="rm-0x01-quad-Preface"><a href="#rm-0x01-quad-Preface" class="headerlink" title="$\rm{0x01\quad Preface}$"></a>$\rm{0x01\quad Preface}$</h1><p>ä»Šå¤©æ˜¯$Feb.19^{th}$ï¼Œå¼€å­¦å‰ä¸€å¤©ï¼Œç°åœ¨æ˜¯åŒ—äº¬æ—¶é—´ä¸‹åˆ$10:05$ï¼Œæˆ‘è¿˜å‰©é™¤äº†è‹±è¯­ç‰©ç†çš„æ‰€æœ‰ä½œä¸šæ²¡åš â€¦ è€¶ï¼ŒçœŸå¼€å¿ƒã€‚</p><p>ç”±äºç‰¹æ®ŠåŸå› å˜›ï¼Œæˆ‘æš‚æ—¶ä¸ä¼šå†™çš„ç‰¹åˆ«è¯¦ç»†â€”â€”æ¯•ç«Ÿè¿˜æœ‰ä½œä¸šæ²¡æœ‰åš<del>æŠ„</del>å®Œï¼Œæ‰€ä»¥å°±å…ˆæ•´ç†åœ°ä»“ä¿ƒä¸€ç‚¹ã€‚</p><p>é¦–å…ˆï¼Œä¸ºä»€ä¹ˆè¦æ‹†ç³»æ•°ï¼Ÿè¿™æ˜¯ä¸€ä¸ªé—®é¢˜â€”â€”ç›´æ¥$FFT$ä¹‹ååˆ¤ä¸ªç²¾åº¦å†å–æ¨¡ä¸å°±å¾—äº†ï¼Ÿå¾ˆå–œé—»ä¹è§çš„æ˜¯ï¼Œè¿™ä¸ªé¢˜ä¸­çš„$value_{max}$åˆ°è¾¾äº†$1e9\cdot1e9 \cdot 1e5 = 1e23$çš„çº§åˆ«ï¼Œä¸å¯ä»¥ç›´æ¥<code>long long</code>çˆ†è‰¹ã€‚</p><h1 id="rm-0x02-Normal-Coefficient-Spliting-FFT"><a href="#rm-0x02-Normal-Coefficient-Spliting-FFT" class="headerlink" title="$\rm{0x02~Normal-Coefficient-Spliting~FFT}$"></a>$\rm{0x02~Normal-Coefficient-Spliting~FFT}$</h1><p>é¦–å…ˆæ˜¯æœ€æœ´ç´ çš„æ‹†ç³»æ•°æ³•ã€‚å…¶åŸç†ç®€å•å¾—å¾ˆï¼Œå°±æ˜¯é€‰æ‹©ä¸€ä¸ª$M$ï¼ŒæŠŠ$A(x)$å’Œ$B(x)$çš„å„é¡¹ç³»æ•°è¡¨ç¤ºæˆ<br>$$<br>A_i = a_iM+b_i~(0\leq b_i &lt;a_i) \\<br>B_i = c_iM+d_i~(0\leq d_i &lt;c_i)<br>$$<br>çš„å½¢å¼ã€‚ç„¶åæˆ‘ä»¬åšä¹˜æ³•çš„è¯ï¼Œä¼šæœ‰<br>$$<br>A_i\cdot B_i = a_ic_iM^2+(a_id_i+c_ib_i)M+b_id_i<br>$$<br>é‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘ï¼Œå¯¹äºç¬¬ä¸€éƒ¨åˆ†$a_ic_iM^2$æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€æ¬¡$DFT$ã€ä¸€æ¬¡$IDFT$ç®—å‡ºæ¥ï¼Œï¼›å¯¹äºç¬¬äºŒéƒ¨åˆ†$(a_id_i+c_ib_i)M$ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤æ¬¡$DFT$åˆ†åˆ«ç®—å‡º$a_id_i$ã€$c_ib_i$ç„¶ååˆå¹¶ï¼Œä¹‹åä¸€æ¬¡$IDFT$æ±‚å‡ºæ¥ï¼›å¯¹äºæœ€åä¸€éƒ¨åˆ†åˆ™åªéœ€è¦ä¸€æ¬¡$DFT$ã€ä¸€æ¬¡$IDFT$æ±‚å‡ºã€‚æ‰€ä»¥ç®—æ³•æµç¨‹ä¸€å…±$7$æ¬¡$FFT$ã€‚</p><p>é‚£æˆ‘ä»¬è€ƒè™‘ä¼°è®¡ä¸€ä¸‹èŒƒå›´ï¼Œæ­¤å¤„ä¸ç”šä¸¥è°¨åœ°ä½¿ç”¨$\Theta$ä½œä¸ºåŒé˜¶çš„ç¬¦å·$^{[1]}$</p><p>$$b_i\cdot d_i \approx \Theta(M^2)$$</p><p>$$a_i\cdot c_i =\lfloor \frac{P}{M}\rfloor \cdot \lfloor \frac{P}{M}\rfloor = \Theta(\lfloor \frac{P^2}{M^2}\rfloor)$$</p><p>$$(a_id_i + c_ib_i)\cdot M =\Theta( M \cdot \lfloor \frac{P}{M}\rfloor) $$</p><p>é‚£ä¹ˆæˆ‘ä»¬å–$M = \Theta(\sqrt P)$çº§åˆ«çš„ï¼Œå¯ä»¥ä¿è¯ä¸‰ä¸ªå€¼çš„é˜¶ä¸º$\Theta(P)$ï¼Œå¤§æ¦‚æ˜¯$1e9 \cdot 1e5 = 1e14$çº§åˆ«çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 423333</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(i = a ; i &lt;= b ; ++ i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1</span>) ;</span><br><span class="line"><span class="keyword">int</span> R[MAXN], L, x ; <span class="keyword">long</span> <span class="keyword">long</span> Ans[MAXN] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">double</span> x, y ;</span><br><span class="line">    node (<span class="keyword">long</span> <span class="keyword">double</span> xx = <span class="number">0</span>, <span class="keyword">long</span> <span class="keyword">double</span> yy = <span class="number">0</span>)&#123;</span><br><span class="line">        x = xx, y = yy ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;A[MAXN], B[MAXN], C[MAXN], D[MAXN], F[MAXN], G[MAXN] ;</span><br><span class="line">node H1[MAXN], H2[MAXN], H3[MAXN] ; <span class="keyword">int</span> L1, L2, P, N, M ;</span><br><span class="line">node <span class="keyword">operator</span> + (node J, node Q)&#123; <span class="keyword">return</span> node(J.x + Q.x , J.y + Q.y); &#125;</span><br><span class="line">node <span class="keyword">operator</span> - (node J, node Q)&#123; <span class="keyword">return</span> node(J.x - Q.x , J.y - Q.y); &#125;</span><br><span class="line">node <span class="keyword">operator</span> * (node J, node Q)&#123; <span class="keyword">return</span> node(J.x * Q.x - J.y * Q.y , J.x * Q.y + J.y * Q.x) ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(node *J, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, j, k, l ; </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; R[i]) swap(J[i], J[R[i]]) ;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; N; j &lt;&lt;= <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="function">node <span class="title">T</span><span class="params">(<span class="built_in">cos</span>(Pi / j), flag * <span class="built_in">sin</span>(Pi / j))</span> </span>;</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; N; k += (j &lt;&lt; <span class="number">1</span>) )&#123;</span><br><span class="line">            <span class="function">node <span class="title">t</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span> </span>;</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j; l ++, t = t * T)&#123;</span><br><span class="line">                node Nx = J[k + l], Ny = t * J[k + j + l] ;</span><br><span class="line">                J[k + l] = Nx + Ny ;</span><br><span class="line">                J[k + j + l] = Nx - Ny ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag &lt; <span class="number">0</span>) <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) J[i].x = J[i].x / N + <span class="number">0.5</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123; </span><br><span class="line">    rr <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ; </span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ; </span><br><span class="line">    <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, t ; <span class="built_in">cin</span> &gt;&gt; L1 &gt;&gt; L2 &gt;&gt; P, M = <span class="number">32767</span> ; N = <span class="number">1</span>, t = L1 + L2 ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 ; ++ i) x = qr(), A[i].x = x / M, B[i].x = x % M ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L2 ; ++ i) x = qr(), C[i].x = x / M, D[i].x = x % M ; </span><br><span class="line">    <span class="keyword">while</span>(N &lt;= t) N &lt;&lt;= <span class="number">1</span>, ++ L ; rep(i, <span class="number">0</span>, N) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>)) ;</span><br><span class="line">    FFT(A, <span class="number">1</span>), FFT(B, <span class="number">1</span>), FFT(C, <span class="number">1</span>), FFT(D, <span class="number">1</span>) ;</span><br><span class="line">    rep(i, <span class="number">0</span>, N) H1[i] = A[i] * C[i], H2[i] = B[i] * D[i], H3[i] = A[i] * D[i]+ C[i] * B[i] ; </span><br><span class="line">    FFT(H1, <span class="number">-1</span>), FFT(H2, <span class="number">-1</span>), FFT(H3, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= N ; ++ i) </span><br><span class="line">        Ans[i] = ((<span class="keyword">long</span> <span class="keyword">long</span>)H1[i].x * M % P * M % P + (<span class="keyword">long</span> <span class="keyword">long</span>)H2[i].x % P + (<span class="keyword">long</span> <span class="keyword">long</span>)H3[i].x * M % P) % P ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 + L2 ; ++ i) <span class="built_in">printf</span>(<span class="string">"%lld "</span>, Ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æœ€ç»ˆçš„å¤æ‚åº¦æ˜¯$\boldsymbol{O(7\cdot P(n) \cdot n \log n)}$ï¼Œå…¶ä¸­$P(n)$æ˜¯$FFT$è‡ªå¸¦çš„ã€å¤§åˆ°ä¸å¯å¿½ç•¥çš„å¸¸é‡å› å­ã€‚</p><p>ä½†æ˜¯â€¦â€¦å¥½åƒè¿™ä¸ªå¸¸æ•°æœ‰ç‚¹å¤§è¯¶ï¼Œç®—ä¸Šå¸¸æ•°çš„è¯å·²ç»æ˜¯$O(n \log^2n)$çš„çº§åˆ«äº†ï¼Œäºæ˜¯â€”â€”</p><h1 id="rm-0x03-Conjugate-Optimization"><a href="#rm-0x03-Conjugate-Optimization" class="headerlink" title="$\rm{0x03~Conjugate~Optimization}$"></a>$\rm{0x03~Conjugate~Optimization}$</h1><p>æºè‡ªæ¯›å•¸çš„ã€Šå†æ¢å¿«é€Ÿå‚…ç«‹å¶å˜æ¢ã€‹ã€‚</p><p>æˆ‘ä»¬æ€è€ƒè¿™æ ·ä¸¤ä¸ªå¤šé¡¹å¼$\boldsymbol{P, Q} \in \mathbb{C}$<br>$$<br>\rm{P(x) = A(x) + iB(x)} \\<br>\rm{Q(x) = A(x) - iB(x)}<br>$$<br>æˆ‘ä»¬ä¸å¦¨ä»¤$Pâ€™[k]$å’Œ$Qâ€™[k]$ä¸ºå…¶$\text{DFT}$ä¹‹åçš„åºåˆ—ï¼Œå³$Pâ€™[k] =P(\omega_n^k),Qâ€™[k] =Q(\omega_n^k) $ã€‚</p><p>åŒæ—¶ï¼Œä»¤$\text{conj(x)}$è¡¨ç¤ºå¯¹$x$å–å…±è½­ã€‚</p><p>é‚£ä¹ˆä¼šæœ‰$^{[5]}$ï¼š<br>$$<br>\begin{align}<br>Pâ€™[k] &amp;= A(\omega_{n}^{k}) + i B(\omega_{n}^{k}) \\<br>&amp; = \sum_{j=0}^{n-1} A_{j} \omega_{n}^{jk} + i B_{j} \omega_{n}^{jk} \\<br>&amp; = \sum_{j=0}^{n-1} (A_{j} + i B_{j}) \left(\cos \left(\frac{2 \pi jk}{n}\right) + i \sin \left(\frac{2 \pi jk}{n}\right)\right) \\<br>&amp; =  \sum_{j=0}^{n-1} (A_{j} + i B_{j}) \omega_{n}^{kj}<br>\\<br>Qâ€™[k] &amp;= A(\omega_{n}^{k}) - i B(\omega_{n}^{k}) \\<br>&amp; = \sum_{j=0}^{n-1} A_{j} \omega_{n}^{jk} - i B_{j} \omega_{n}^{jk} \\<br>&amp; = \sum_{j=0}^{n-1} (A_{j} - i B_{j}) \left(\cos \left(\frac{2 \pi jk}{n}\right) + i \sin \left(\frac{2 \pi jk}{n}\right)\right) \\<br>&amp; = \sum_{j=0}^{n-1} \left(A_{j} \cos \left(\frac{2 \pi jk}{n}\right) + B_{j} \sin \left(\frac{2 \pi jk}{n}\right)\right) + i \left(A_{j} \sin \left(\frac{2 \pi jk}{n}\right) - B_{j} \cos \left(\frac{2 \pi jk}{n}\right)\right) \\<br>&amp; = \text{conj} \left( \sum_{j=0}^{n-1} \left(A_{j} \cos \left(\frac{2 \pi jk}{n}\right) + B_{j} \sin \left(\frac{2 \pi jk}{n}\right)\right) - i \left(A_{j} \sin \left(\frac{2 \pi jk}{n}\right) - B_{j} \cos \left(\frac{2 \pi jk}{n}\right)\right) \right) \\<br>&amp; = \text{conj} \left( \sum_{j=0}^{n-1} \left(A_{j} \cos \left(\frac{-2 \pi jk}{n}\right) - B_{j} \sin \left(\frac{-2 \pi jk}{n}\right)\right) + i \left(A_{j} \sin \left(\frac{-2 \pi jk}{n}\right) + B_{j} \cos \left(\frac{-2 \pi jk}{n}\right)\right) \right) \\<br>&amp; = \text{conj} \left( \sum_{j=0}^{n-1} (A_{j} + i B_{j}) \left(\cos \left(\frac{-2 \pi jk}{n}\right) + i \sin \left(\frac{-2 \pi jk}{n}\right)\right)\right) \\<br>&amp; = \text{conj} \left( \sum_{j=0}^{n-1} (A_{j} + i B_{j}) \omega_{n}^{-jk} \right) \\<br>&amp; = \text{conj} \left( \sum_{j=0}^{n-1} (A_{j} + i B_{j}) \omega_{n}^{(n-k)j} \right) \\<br>&amp; = \text{conj} \left( Pâ€™[n-k] \right)<br>\end{align}<br>$$<br>å¥½å§æˆ‘æ‰¿è®¤è¿™æ®µæ¨å¯¼è¿‡ç¨‹çš„ä»£ç ç”šæ˜¯å£®è§‚ï¼Œäºæ˜¯å¹¶ä¸æ˜¯æˆ‘è‡ªå·±å†™çš„qwqã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å‘ç°å…¶ä¸­$A(x)$å’Œ$B(x)$å¯ä»¥é€šè¿‡$P,Q$æ¨å‡ºæ¥ï¼š<br>$$<br>Aâ€™[k] = \frac{Pâ€™[k] + Qâ€™[k]}{2} \\<br>Bâ€™[k] = \frac{Pâ€™[k] - Qâ€™[k]}{2i}<br>$$<br>å“¦ï¼Œå¯¹äº†ï¼Œå½“$k=0$æ—¶ï¼Œç”±äºä¸å­˜åœ¨è¿™ä¸€é¡¹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç‰¹åˆ¤ä¸€ä¸‹ã€‚å¹¶ä¸”ç”±äºæˆ‘ä»¬çš„$P(x)$å’Œ$Q(x)$çš„å®éƒ¨å’Œè™šéƒ¨éƒ½å¯ä»¥åˆ©ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹äºä¸ƒæ¬¡$DFT$å¯ä»¥ä¼˜åŒ–åˆ°$4$æ¬¡$DFT$.</p><p>ä»¥ä¸‹æ˜¯å…±è½­ä¼˜åŒ–$FFT$çš„åˆå·æœºï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 423333</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(i = a ; i &lt;= b ; ++ i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">int</span> f[MAXN], g[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> R[MAXN], Len, x, Ans[MAXN] ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1</span>) ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">double</span> r, i ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="title">node</span> <span class="params">(<span class="keyword">long</span> <span class="keyword">double</span> xx = <span class="number">0</span>, <span class="keyword">long</span> <span class="keyword">double</span> yy = <span class="number">0</span>)</span></span>&#123;</span><br><span class="line">        r = xx, i = yy ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> node <span class="title">Conj</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> node(r, -i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;A[MAXN], B[MAXN], w[MAXN], t1[MAXN], t2[MAXN] ;</span><br><span class="line">node H1[MAXN], H2[MAXN], H3[MAXN] ; <span class="keyword">int</span> L1, L2, P, N, M ;</span><br><span class="line">node <span class="keyword">operator</span> + (node J, node Q)&#123; <span class="keyword">return</span> node(J.r + Q.r , J.i + Q.i); &#125;</span><br><span class="line">node <span class="keyword">operator</span> - (node J, node Q)&#123; <span class="keyword">return</span> node(J.r - Q.r , J.i - Q.i); &#125;</span><br><span class="line">node <span class="keyword">operator</span> * (node J, node Q)&#123; <span class="keyword">return</span> node(J.r * Q.r - J.i * Q.i , J.r * Q.i + J.i * Q.r) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123; </span><br><span class="line">    rr <span class="keyword">int</span> k = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ; <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ; <span class="keyword">return</span> k ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(node *J, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i, j, k, l ; </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; R[i]) swap(J[i], J[R[i]]) ;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; N; j &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; N; k += (j &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j; ++ l)&#123;</span><br><span class="line">                node T = w[N / j * l] ; T.i *= flag ;</span><br><span class="line">                node Nx = J[k + l], Ny = T * J[k + j + l] ;</span><br><span class="line">                J[k + l] = Nx + Ny, J[k + j + l] = Nx - Ny ;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">int</span> L)</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i ; <span class="keyword">while</span> (N &lt;= L) N &lt;&lt;= <span class="number">1</span>, ++ Len ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) A[i] = node(f[i] &amp; <span class="number">32767</span>, f[i] &gt;&gt; <span class="number">15</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) B[i] = node(g[i] &amp; <span class="number">32767</span>, g[i] &gt;&gt; <span class="number">15</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) w[i] = node(<span class="built_in">cos</span>(Pi * i / N), <span class="built_in">sin</span>(Pi * i / N)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (Len - <span class="number">1</span>)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MTT</span><span class="params">()</span></span>&#123;</span><br><span class="line">    node ia, ib, a1, a2, b1, b2 ;</span><br><span class="line">    rr <span class="keyword">int</span> i, k, t = L1 + L2, q1, q2, q3 ; Init(t) ;</span><br><span class="line">    <span class="comment">// for (i = 0 ; i &lt;= N ; ++ i) cout &lt;&lt; A[i].r &lt;&lt; " "; cout &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">// for (i = 0 ; i &lt;= N ; ++ i) cout &lt;&lt; B[i].r &lt;&lt; " "; cout &lt;&lt; endl ;</span></span><br><span class="line">    FFT(A, <span class="number">1</span>), FFT(B, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">        k = (N - i) &amp; (N - <span class="number">1</span>), ia = A[k].Conj(), ib = B[k].Conj() ;<span class="comment">//(ia,ib) = Q</span></span><br><span class="line">        a1 = (ia + A[i]) * node(<span class="number">0.5</span>, <span class="number">0</span>), a2 = (A[i] - ia) * node(<span class="number">0</span>, <span class="number">-0.5</span>) ;</span><br><span class="line">        b1 = (ib + B[i]) * node(<span class="number">0.5</span>, <span class="number">0</span>), b2 = (B[i] - ib) * node(<span class="number">0</span>, <span class="number">-0.5</span>) ;</span><br><span class="line">        t1[i] = a1 * b1 + (a1 * b2 + b1 * a2) * node(<span class="number">0</span>, <span class="number">1</span>), t2[i] = a2 * b2 ;</span><br><span class="line">    &#125;  FFT(t1, <span class="number">-1</span>), FFT(t2, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="comment">// for (i = 0 ; i &lt;= N ; ++ i) cout &lt;&lt; w[i].r &lt;&lt; " "; cout &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">// for (i = 0 ; i &lt;= N ; ++ i) cout &lt;&lt; A[i].r &lt;&lt; " "; cout &lt;&lt; endl ;</span></span><br><span class="line">    <span class="comment">// for (i = 0 ; i &lt;= N ; ++ i) cout &lt;&lt; B[i].r &lt;&lt; " "; cout &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">        q1 = (<span class="keyword">long</span> <span class="keyword">long</span>)(t1[i].r / N + <span class="number">0.5</span>) % P, q2 = (<span class="keyword">long</span> <span class="keyword">long</span>)(t1[i].i / N + <span class="number">0.5</span>) % P ;</span><br><span class="line">        q3 = (<span class="keyword">long</span> <span class="keyword">long</span>)(t2[i].r / N + <span class="number">0.5</span>) % P, Ans[i] = ((((<span class="keyword">long</span> <span class="keyword">long</span>)q3 &lt;&lt; <span class="number">30</span>) % P + ((<span class="keyword">long</span> <span class="keyword">long</span>)q2 &lt;&lt; <span class="number">15</span>) % P + q1) % P + P) % P ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rr <span class="keyword">int</span> i ; </span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; L1 &gt;&gt; L2 &gt;&gt; P ; N = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 ; ++ i) f[i] = qr() % P ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L2 ; ++ i) g[i] = qr() % P ; MTT() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 + L2 ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d "</span>, Ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="rm-0x04-quad-æ‹¼å‘½å¡å¸¸"><a href="#rm-0x04-quad-æ‹¼å‘½å¡å¸¸" class="headerlink" title="$\rm{0x04\quad}$æ‹¼å‘½å¡å¸¸"></a>$\rm{0x04\quad}$æ‹¼å‘½å¡å¸¸</h1><p>å¥½çš„ï¼Œé¦–å…ˆæˆ‘ä»¬å¯ä»¥æ¬£èµä¸€ä¸‹æœ€åˆçš„ç‰ˆæœ¬ï¼ˆç”¨å°å·äº¤çš„æ‹†ç³»æ•°$FFT$ + $O2$ï¼‰</p><p><img src="1.png" alt=""></p><p>ç„¶åæ˜¯å¤§å·çš„å…±è½­ä¼˜åŒ–$FFT$ï¼ˆä¸åŠ $O2$ï¼Œå³ä¸Šæ–¹ä»£ç ï¼‰ï¼š</p><p><img src="2.png" alt=""></p><p>ç‰¹åˆ«çš„ï¼Œä»¥ä¸‹æ˜¯æ— å…±è½­ä¼˜åŒ–çš„æ‹†ç³»æ•°$FFT$ï¼Œä¸å¼€$O2$:</p><p><img src="3.png" alt=""></p><p><img src="4.png" alt=""></p><p>å¥½å§ï¼Œä»–çœ‹èµ·æ¥æ²¡æœ‰å¿«å¤šå°‘ã€‚æ¯•ç«Ÿéƒ½æ˜¯åŒé˜¶çš„å¤æ‚åº¦ï¼Œå¥½åƒåè€…çš„å¸¸æ•°æ›´å¤§é‚£ä¹ˆä¸€ç‚¹â€¦â€¦</p><p>äºæ˜¯è€ƒè™‘å¯¹å…±è½­ä¼˜åŒ–çš„è¿›è¡Œå¤§åŠ›å¡å¸¸ï¼š</p><ul><li>å¤šæ¬¡ä½¿ç”¨çš„éå…¨å±€å˜é‡ã€‚ä½¿ç”¨<code>register</code>ä¿®é¥°ç¬¦ã€‚</li><li>å°†$double$è½¬æ¢æˆä¸º$long~double$ ã€‚</li><li>å‡å°‘å–æ¨¡æ¬¡æ•°ã€‚</li><li>ä»yjké‚£é‡Œå·æ¥çš„$\rm{fread/fwrite}$</li></ul><p>ä¸€ç•ªæ“ä½œä¹‹åï¼Œæˆ‘ä»¬æˆåŠŸåœ°å¡åˆ°äº†ç¬¬äº”é¡µä¸Šâ€¦â€¦</p><p><img src="5.png" alt=""></p><p>æœ€åå¥‰ä¸Šæœ€å¿«çš„ä»£ç qwqï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// luogu-judger-enable-o2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"Ofast"</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 102333</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 272333</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr register </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(i = a ; i &lt;= b ; ++ i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IO&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> ch_top=<span class="number">4e7</span>+<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">char</span> ch[ch_top],*now_r=ch<span class="number">-1</span>,*now_w=ch<span class="number">-1</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(*++now_r&lt;<span class="string">'0'</span>);</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> x=*now_r-<span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">while</span>(*++now_r&gt;=<span class="string">'0'</span>)x=x*<span class="number">10</span>+*now_r-<span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">char</span> st[<span class="number">20</span>];<span class="keyword">static</span> <span class="keyword">int</span> top;</span><br><span class="line">    <span class="keyword">while</span>(st[++top]=<span class="string">'0'</span>+x%<span class="number">10</span>,x/=<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">while</span>(*++now_w=st[top],--top);</span><br><span class="line">    *++now_w=<span class="string">' '</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> R[MAXM], Len, x, Ans[MAXN &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> r, i ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> node <span class="title">Conj</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> node(r, -i); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="title">node</span> <span class="params">(<span class="keyword">double</span> xx = <span class="number">0</span>, <span class="keyword">double</span> yy = <span class="number">0</span>)</span></span>&#123;</span><br><span class="line">        r = xx, i = yy ;</span><br><span class="line">    &#125;<span class="comment">//å®šä¹‰çš„Complexå‹æ˜¯ç”¨æ¥è¿›è¡Œå¤æ•°è¿ç®—çš„ </span></span><br><span class="line">&#125;A[MAXM], B[MAXM], w[MAXM], t1[MAXM], t2[MAXM] ; <span class="keyword">int</span> L1, L2, P, N, M ;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> + (<span class="keyword">const</span> node &amp;J, <span class="keyword">const</span> node &amp;Q) &#123; <span class="keyword">return</span> node(J.r + Q.r , J.i + Q.i); &#125;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> - (<span class="keyword">const</span> node &amp;J, <span class="keyword">const</span> node &amp;Q) &#123; <span class="keyword">return</span> node(J.r - Q.r , J.i - Q.i); &#125;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> * (<span class="keyword">const</span> node &amp;J, <span class="keyword">const</span> <span class="keyword">double</span> &amp;Q) &#123; <span class="keyword">return</span> (node) &#123;J.r * Q, J.i * Q&#125; ; &#125;</span><br><span class="line"><span class="keyword">inline</span> node <span class="keyword">operator</span> * (<span class="keyword">const</span> node &amp;J, <span class="keyword">const</span> node &amp;Q) &#123; <span class="keyword">return</span> node(J.r * Q.r - J.i * Q.i , J.r * Q.i + J.i * Q.r) ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">FFT</span><span class="params">(node *J)</span></span>&#123;</span><br><span class="line">    rr node t ;</span><br><span class="line">    rr <span class="keyword">int</span> i, j, k, l ; </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; R[i]) t = J[i], J[i] = J[R[i]], J[R[i]] = t ;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; N; j &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; N; k += (j &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j; ++ l)&#123;</span><br><span class="line">                rr node T = w[N / j * l] ;</span><br><span class="line">            rr node Nx = J[k + l], Ny = T * J[k + j + l] ;</span><br><span class="line">                J[k + l] = Nx + Ny, J[k + j + l] = Nx - Ny ;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IFFT</span><span class="params">(node *J)</span></span>&#123;</span><br><span class="line">    reverse(J + <span class="number">1</span>, J + N), FFT(J) ; </span><br><span class="line">    rr <span class="keyword">int</span> i ; rr <span class="keyword">double</span> qwq = <span class="number">1.0</span> / N ; </span><br><span class="line">    rep(i, <span class="number">0</span>, N - <span class="number">1</span>) J[i] = J[i] * qwq ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> IO ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fread(ch,<span class="number">1</span>,ch_top,<span class="built_in">stdin</span>); </span><br><span class="line">    rr <span class="keyword">int</span> i, k, t ; rr node ia, ib, a1, a2, b1, b2 ; </span><br><span class="line">    t = ((L1 = read()) + (L2 = read())), P = read(), N = <span class="number">1</span> ; </span><br><span class="line">    <span class="keyword">while</span> (N &lt;= t) N &lt;&lt;= <span class="number">1</span>, ++ Len ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L1 ; ++ i) x = read(), A[i] = node(x &amp; <span class="number">32767</span>, x &gt;&gt; <span class="number">15</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= L2 ; ++ i) x = read(), B[i] = node(x &amp; <span class="number">32767</span>, x &gt;&gt; <span class="number">15</span>) ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i) w[i] = node(<span class="built_in">cos</span>(Pi * i / N), <span class="built_in">sin</span>(Pi * i / N)), R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (Len - <span class="number">1</span>)) ;</span><br><span class="line">    FFT(A), FFT(B) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; N ; ++ i)&#123;</span><br><span class="line">        k = (N - i) &amp; (N - <span class="number">1</span>), ia = A[k].Conj(), ib = B[k].Conj() ;<span class="comment">//(ia,ib) = Q</span></span><br><span class="line">        a1 = (ia + A[i]) * node(<span class="number">0.5</span>, <span class="number">0</span>), a2 = (A[i] - ia) * node(<span class="number">0</span>, <span class="number">-0.5</span>) ;</span><br><span class="line">        b1 = (ib + B[i]) * node(<span class="number">0.5</span>, <span class="number">0</span>), b2 = (B[i] - ib) * node(<span class="number">0</span>, <span class="number">-0.5</span>) ;</span><br><span class="line">        t1[i] = a1 * b1 + (a1 * b2 + b1 * a2) * node(<span class="number">0</span>, <span class="number">1</span>), t2[i] = a2 * b2 ;</span><br><span class="line">    &#125;  </span><br><span class="line">    IFFT(t1), IFFT(t2) ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= t ; ++ i)</span><br><span class="line">        write(((ll)(t1[i].r + <span class="number">0.5</span>) + ((ll)(t1[i].i + <span class="number">0.5</span>) % P &lt;&lt; <span class="number">15</span>) + ((ll)(t2[i].r + <span class="number">0.5</span>) % P &lt;&lt; <span class="number">30</span>)) % P) ;</span><br><span class="line">    fwrite(ch,<span class="number">1</span>,now_w-ch,<span class="built_in">stdout</span>); <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®è·µè¯æ˜ï¼Œä»¥ä¸Šä»£ç ä¸åŠ ä»»ä½•ä¼˜åŒ–ï¼ˆä¸å¼€$\rm{O2/3/fast}$ï¼‰ç”šè‡³å¯ä»¥å¿«$4ms$ï¼<br><img src="6.png" alt=""></p><h1 id="rm-0x00-quad-Afterword"><a href="#rm-0x00-quad-Afterword" class="headerlink" title="$\rm{0x00\quad Afterword}$"></a>$\rm{0x00\quad Afterword}$</h1><p>å—¯ï¼Œå…¶å®æŒ‰é“ç†æ¥è®²ï¼Œä¸æ˜¯ç‰¹åˆ«éš¾ã€‚ä½†æ˜¯è¿™è·Ÿ$HLPP$ä¸€æ ·ï¼Œéƒ½æ˜¯æ‰“æ­»éƒ½ä¸ä¼šè€ƒçš„ç®—æ³•ï¼Œæ‰€ä»¥å­¦è¿™äº›åªæ˜¯ä¸ºäº†å¨±ä¹â€¦â€¦å¬èµ·æ¥æŒºè‹å‡‰ï¼Ÿ</p><p>ä½†ä¼¼ä¹ï¼Œä»ä¸€å¼€å§‹å°±ä¸åº”è¯¥æŠŠåº”ä»˜è€ƒç‚¹ä½œä¸ºOIçš„åˆè¡·å§ï¼Œè™½ç„¶å¦‚æœæ²¡æœ‰è·åˆ©ï¼Œæ²¡æœ‰å¤šå°‘äººä¼šå»å­¦ï¼Œä½†æ˜¯ä¸æ²¾æŸ“åŠŸåˆ©çš„OIï¼Œä¼¼ä¹å¯çˆ±äº†é‚£ä¹ˆå‡ åˆ†å‘¢â€¦â€¦</p><p>å¹¶ä¸”åœ¨å­¦çš„è¿‡ç¨‹ä¸­é¡ºä¾¿è®¤è¯†äº†ä¸€ä¸ªå·¨ä½¬<code>CMXRYNP</code>ï¼Œå˜¿å˜¿ï¼Œä¹Ÿç®—ä¸äºå•¦ã€‚</p><p>æœ¬ç¯‡æ–‡ç« çœŸå®å®Œç¨¿æ—¶é—´æ˜¯$2019/3/17$ï¼Œå› ä¸ºå¤ªæ‡’+å¤ªå¿™ï¼Œé¸½äº†ä¸€ä¸ªæœˆ$\rm{qaq}$.</p><h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$\rm{Reference}$"></a>$\rm{Reference}$</h2><ul><li>$[1]$ :$lvzelong2014$çš„$blog$ <a href="https://blog.csdn.net/lvzelong2014/article/details/80156989" target="_blank" rel="noopener">$^{^{[\nearrow ]}}â€‹$</a></li><li>$[2]$:<code>æ— æ¢¦ä¹‹æ¢¦</code>çš„$blog$ <a href="https://www.cnblogs.com/DreamlessDreams/p/10241267.html" target="_blank" rel="noopener">$^{^{[\nearrow ]}}â€‹$</a></li><li>$[3]$:$Cyhlnj$çš„$blog$ <a href="https://www.cnblogs.com/cjoieryl/p/10114614.html" target="_blank" rel="noopener">$^{^{[\nearrow ]}}â€‹$</a></li><li>$[4]$:$litble$çš„$blog$ <a href="https://blog.csdn.net/litble/article/details/84864516" target="_blank" rel="noopener">$^{^{[\nearrow ]}}â€‹$</a></li><li>$[5]â€‹$:$CMXRYNPâ€‹$çš„$blogâ€‹$ <a href="https://cmxrynp.github.io/2019/01/07/fft-optimization/" target="_blank" rel="noopener">$^{^{[\nearrow ]}}â€‹$</a></li><li>$[6]$ :2016å›½å®¶é›†è®­é˜Ÿè®ºæ–‡ã€Šå†æ¢å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ã€‹æ¯›å•¸Â· <a href="https://pan.baidu.com/s/1aN2L7DAm_RY2GeN5Snxj1A" target="_blank" rel="noopener">$^{^{[\nearrow]}}$</a> æå–ç ï¼švua4</li></ul>]]></content>
    
    <summary type="html">
    
      æ‹†ç³»æ•°FFTä¸»è¦ç”¨äºè§£å†³ä¸å¯æ€è®®çš„ä»»æ„æ¨¡æ•°$NTT/FFT$é—®é¢˜ï¼Œä¸»è¦é’ˆå¯¹çš„å°±æ˜¯ã€$Luogu4245Â·$ä»»æ„æ¨¡æ•°NTTã€‘è¿™é“é¢˜ã€‚
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="å¤šé¡¹å¼" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="å¤šé¡¹å¼-FFT" scheme="http://www.orchidany.cf/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F-FFT/"/>
    
  </entry>
  
  <entry>
    <title>å¤šé¡¹å¼1Â·æ™®é€šçš„FFT</title>
    <link href="http://www.orchidany.cf/2019/02/19/FFT1/"/>
    <id>http://www.orchidany.cf/2019/02/19/FFT1/</id>
    <published>2019-02-19T03:26:08.000Z</published>
    <updated>2019-03-18T08:51:56.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt=""></p><h1 id="rm-0x01-quad-Preface"><a href="#rm-0x01-quad-Preface" class="headerlink" title="$\rm{0x01\quad Preface}$"></a>$\rm{0x01\quad Preface}$</h1><p>è¿™ç¯‡æ–‡ç« åˆå†™äº$7/1/2018$ï¼Œæ˜¯åœ¨é™ªåŒå¥½å‹$yjk$ä¸$wx$ä»¥åŠå­¦é•¿$rqy$ä¸€èµ·å»å‚åŠ çœé˜Ÿé›†è®­æ—¶å†™çš„ã€‚ä»Šå¤©çªç„¶æ¥äº†å…´è‡´ï¼Œæ‰“ç®—é‡æ–°å¤ä¹ ä¸€é$FFT$å¹¶ä¸”å†™$MTT$ï¼Œäºæ˜¯ä¾¿æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚</p><p>å…¶å®ä¸€å¼€å§‹æˆ‘æ˜¯ä¸æƒ…æ„¿æŠŠè¿™ç¯‡æ–‡ç« æ¬åˆ°è¿™å„¿æ¥çš„â€”â€”è¿™å¥½åƒæ˜¯ä¸€ä¸ªæ—¶ä»£çš„ç¼©å½±ï¼Œé‚£ä¸ªæ—¶ä»£çš„<code>orchidany</code>ç‰¹åˆ«å–œæ¬¢æ‰®æ¼”è€å¸ˆï¼Œæ¯å¤©ä»¿ä½›æ¥åˆ°å¥¥èµ›å®¤åªæ˜¯ä¸ºäº†â€œä¸ºäººå¸ˆâ€çš„ï¼šå¿ƒæ€§æµ®èºï¼Œå­¦ä¹ åŠŸåˆ©ã€‚ä½†ç°åœ¨æˆ‘åˆ™æ˜¯æƒ³æ²‰ä¸‹å¿ƒæ¥ï¼Œè®¤çœŸåšå­¦é—®ã€‚</p><p>ä½†æ— è®ºå¦‚ä½•ï¼Œæˆ‘å¸Œæœ›è¿™ç¯‡åŸæœ¬å†—æ‚ç¹é•¿çš„æ–‡ç« å¯ä»¥æ›´çŸ­ã€æ›´æ–°é¢–ã€ä»æ›´é«˜çš„è§’åº¦å®¡è§†ä¸€äº›é—®é¢˜ã€‚</p><h1 id="rm-0x02-quad-Convolution"><a href="#rm-0x02-quad-Convolution" class="headerlink" title="$\rm{0x02\quad Convolution}$"></a>$\rm{0x02\quad Convolution}$</h1><p><strong>å·ç§¯$\boldsymbol{(Convolution)}$</strong>ï¼Œå‡†ç¡®æ¥è¯´æ˜¯ä¸€ç§<strong>é€šè¿‡ä¸¤ä¸ªå‡½æ•°$\boldsymbol f$ å’Œ$\boldsymbol gâ€‹$ ç”Ÿæˆç¬¬ä¸‰ä¸ªå‡½æ•°çš„ä¸€ç§æ•°å­¦ç®—å­.</strong></p><p>è€Œå¹¿ä¹‰ä¸Šå…¶å®šä¹‰ä¸ºï¼š$$\boldsymbol{h(x) = \int _{- \infty} ^{\infty}g(\tau) \cdot f(x - \tau)} \rm{d\tau}$$</p><p>æˆ‘ä»¬ç§°$h(x)$æ˜¯$g(x)$ä¸$f(x)$çš„<strong>å·ç§¯</strong>ã€‚</p><p>è€Œæ­¤å¤„æˆ‘ä»¬è®¨è®ºçš„æ˜¯æ•´æ¬¡å¤šé¡¹å¼åŸŸï¼Œé‚£ä¹ˆå°±æŠŠå…¶å®šä¹‰åˆ’å½’è¿›å¤šé¡¹å¼ï¼Œå¾—åˆ°</p><p>$$A(x) \cdot B(x) =\sum\limits_{i = 0}^{n} \sum\limits_{j=0}^{i}{a_jb_{i-j}} $$<br>å…¶ä¸­$A(x)$å’Œ$B(x)$å‡ä¸º$N-1$æ¬¡å¤šé¡¹å¼<br>æ¯”è¾ƒæ˜¾ç„¶çš„æ˜¯ï¼Œåœ¨æˆ‘ä»¬åˆå¹¶åŒç±»é¡¹çš„æƒ…å†µä¸‹ï¼Œæœ€ç»ˆå·å‡ºæ¥çš„ç»“æœåº”è¯¥æœ‰$2n+1$é¡¹ã€‚</p><h1 id="rm-0x03-quad-Dot-Method"><a href="#rm-0x03-quad-Dot-Method" class="headerlink" title="$\rm{0x03\quad Dot~Method}$"></a>$\rm{0x03\quad Dot~Method}$</h1><p>æˆ‘ä»¬çŸ¥é“ï¼ŒåŸæœ¬çš„å¤šé¡¹å¼æ˜¯ç³»æ•°è¡¨ç¤ºæ³•ï¼Œç°åœ¨æˆ‘ä»¬å°†å…¶è½¬åŒ–ä¸º<strong>ç‚¹å€¼è¡¨ç¤ºæ³•$(\boldsymbol{dot~method} )$</strong>ã€‚å³æˆ‘ä»¬å¯ä»¥æŠŠå¤šé¡¹å¼$F(x)$è½¬åŒ–ä¸ºå¤šé¡¹å¼å‡½æ•°$f(x)$ï¼Œé‚£ä¹ˆè¿™ä¸ª$n$é˜¶å‡½æ•°å°±å¯ä»¥ç”±$n+1$ä¸ªç‚¹å”¯ä¸€ç¡®å®šã€‚å³$$f(x)\Longleftrightarrow{(x_0,y_0),(x_1,y_1),(x_2,y_2)â€¦.(x_n,y_n)}$$é‚£ä¹ˆ$$\forall k,y_k = f(x_k)$$è¿™æ˜¯å¾ˆæ˜¾ç„¶çš„ï¼Œå¹¶ä¸”è¿™$n+$ä¸ªç‚¹æ˜¯éšæ„é€‰å–çš„â€”â€”åªè¦æ±‚å®ƒä»¬ç›¸å¼‚å³å¯ã€‚</p><ul><li><h2 id="rm-Advanced-Trick-Point-color-red-1-rm-Multiplication"><a href="#rm-Advanced-Trick-Point-color-red-1-rm-Multiplication" class="headerlink" title="$\rm{Advanced~Trick~Point}$ $\color{red}{1}$ $\rm{Multiplication}$"></a>$\rm{Advanced~Trick~Point}$ $\color{red}{1}$ $\rm{Multiplication}$</h2></li></ul><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªå…³äº$x$çš„$n+1$æ¬¡å¤šé¡¹å¼$A(x)$å’Œ$B(x)$ï¼Œæˆ‘ä»¬è¦å¯¹å®ƒçš„ç‚¹å€¼è¡¨è¾¾å¼è¿›è¡Œä¹˜æ³•æ“ä½œã€‚ç”±äºç»“æœæœ‰$2n+1$é¡¹ï¼Œæˆ‘ä»¬è€ƒè™‘è¡¥ä¸Šä¸€å †é¡¹ï¼Œå¹¶å¯¹$$A(x) = {(x_0,y_0),(x_1,y_1)â€¦.(x_{2n},y_{2n})}$$ $$B(x) = {(x_0,y_0â€™),(x_1,y_1â€™)â€¦.(x_{2n},y_{2n})}$$ åšä¹˜æ³•å¯å¾— $$A(x)B(x) = {(x_0,y_0y_0â€™),(x_1,y_1y_1â€™)(x_{2n},y_{2n}y_{2n}â€™)}$$  </p><p>æˆ‘ä»¬è§‚å¯Ÿç‚¹ä¹˜æ³•ï¼Œå®ƒçš„æ—¶é—´å¤æ‚åº¦è¾¾åˆ°äº†$\Theta(n)$ï¼Œå®Œå…¨å¯ä»¥æ¥å—ã€‚é‚£ä¹ˆä¸å¦¨å…ˆçœ‹ä¸€ä¸‹ç®—æ³•çš„å¤§ä½“æ€è·¯ï¼š</p><blockquote><p>å¯¹äºæ¯ä¸ªå› å­å¤šé¡¹å¼ï¼Œé€‰å–$n+1$ä¸ªç‚¹ï¼Œå¾—å‡ºç‚¹å€¼è¡¨è¾¾å¼ï¼ˆå¤æ‚åº¦$\Theta(n^2)$ï¼‰ $\longrightarrow$ç‚¹ä¹˜æ³•(æ—¶é—´å¤æ‚åº¦$\Theta(n)$)â€”â€”&gt;å°†å¾—å‡ºæ¥çš„$C(x)$çš„ç‚¹å€¼è¡¨è¾¾å¼å†è½¬æ¢æˆç³»æ•°è¡¨è¾¾å¼(å¤æ‚åº¦$\Theta(n^2)$)</p></blockquote><p>è¿™å°±æ˜¯$FFT$çš„å¤§ä½“æµç¨‹ã€‚<del>è½¬åŒ–ä¹‹åæ€ä¹ˆæ²¡å¤šå¿«å¸¸æ•°è¿˜å¤§äº†</del></p><p>è™½ç„¶å…¶ä½™éƒ¨åˆ†çš„æ—¶é—´å¤æ‚åº¦è¿˜æ˜¯å¾ˆéº»çƒ¦çš„$O(n^2)$ï¼Œä½†æ˜¯éƒ½æ˜¯å¯ä»¥ä¼˜åŒ–æˆ$O(nlogn)$çš„ã€‚</p><hr><p>æœ¬è´¨ä¸Šçš„$FFT$åŒ…å«<strong>$\boldsymbol{DFT}$ï¼ˆç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼‰</strong>å’Œ<strong>$\boldsymbol{IDFT}$ï¼ˆé€†ç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼‰</strong>å®é™…ä¸Šï¼Œ<strong>$DFT$</strong>å¯¹åº”ç€çš„å°±æ˜¯<strong>æŠŠç³»æ•°è¡¨è¾¾å¼æ˜ å°„åˆ°ç‚¹å€¼è¡¨è¾¾å¼</strong>çš„è¿‡ç¨‹ï¼Œ<strong>$IDFT$</strong>å¯¹åº”ç€çš„å°±æ˜¯æˆ‘ä»¬<strong>æŠŠç‚¹å€¼è¡¨è¾¾å¼æ˜ å°„åˆ°ç³»æ•°è¡¨è¾¾å¼</strong>çš„è¿‡ç¨‹ã€‚</p><h1 id="rm-0x04-Base-of-Optimization"><a href="#rm-0x04-Base-of-Optimization" class="headerlink" title="$\rm{0x04~Base ~of~Optimization}$"></a>$\rm{0x04~Base ~of~Optimization}$</h1><p>å› ä¸ºå®é™…ä¸Šï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€æ­¥â€”â€”æ±‚å€¼ï¼ˆç³»æ•°è½¬ç‚¹å€¼ï¼‰å’Œæˆ‘ä»¬çš„ç¬¬ä¸‰æ­¥ï¼ˆç‚¹å€¼è½¬ç³»æ•°ï¼‰éƒ½æ˜¯å¯ä»¥åšåˆ°$nlogn$çš„ï¼Œé‚£ä¹ˆæ€»çš„æ—¶é—´å¤æ‚åº¦ï¼Œæ¸è¿›æ„ä¹‰ä¸‹å°±æ˜¯$O(nlogn)$çš„ã€‚</p><p>ä¸‹é¢å°±è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä¼˜åŒ–ï¼š</p><ul><li><h2 id="rm-Advanced-Trick-Point-color-red-2-rm-Unit-Complex-Root"><a href="#rm-Advanced-Trick-Point-color-red-2-rm-Unit-Complex-Root" class="headerlink" title="$\rm{Advanced~Trick~Point}$ $\color{red}{2}$ $\rm{Unit ~Complex ~Root}$"></a>$\rm{Advanced~Trick~Point}$ $\color{red}{2}$ $\rm{Unit ~Complex ~Root}$</h2></li></ul><p>$n$æ¬¡å•ä½å¤æ ¹æ˜¯æ»¡è¶³$\omega^n = 1$ çš„å¤æ•°$\omega$ï¼Œå…¶ä¸­æˆ‘ä»¬å¯ä»¥ç”±å¤æ•°çš„è¿ç®—æ³•åˆ™ï¼ˆè¾è§’ç›¸åŠ ï¼Œæ¨¡ç›¸ä¹˜ï¼‰å¾ˆç®€å•åœ°å¾—å‡º<strong>$n$æ¬¡å•ä½æ ¹æœ‰$n$ä¸ª</strong>è¿™ä¸ªç»“è®ºâ€”â€”äº¦æˆ–è€…æ˜¯ç”¨ä»£æ•°åŸºæœ¬å®šç†è¯ï¼Œéƒ½å¯ä»¥ã€‚è€Œåˆå› ä¸ºå¤æ•°$\omega^n$åœ¨å¤æ•°å¹³é¢ä¸Šçš„æ¨¡éƒ½æ˜¯ä¸€ï¼Œæ‰€ä»¥ç›¸ä¹˜ä¹‹åè¿˜ä¼šæ˜¯ä¸€ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„$\omega_i,1 \leq i \leq n$å°±ä¼šå‡åŒ€åˆ†å¸ƒåœ¨å•ä½åœ†ä¸Šï¼Œç±»ä¼¼å½“$n = 8â€‹$æ—¶å®ƒæ˜¯è¿™æ ·çš„ï¼š</p><p><img src="1.png" alt=""></p><p>æˆ‘ä»¬è€ƒè™‘æ¬§æ‹‰å…¬å¼ï¼š</p><p>$$e^{ix} = cosx + isinx$$</p><p>æˆ‘ä»¬å–$x =2\pi$ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹å…³ç³»å¼ï¼š$$e^{2 \pi i} = 1 = \omega^n \Longleftrightarrow \omega = e^{\frac{2\pi i}{n}}$$</p><p>ä»¬æŠŠæ­¤æ—¶çš„å•ä½æ ¹ç§°ä¹‹ä¸º<strong>ä¸»æ¬¡å•ä½æ ¹</strong>ï¼Œè®°ä½œ$$\omega_n = e^{\frac{2\pi i}{n}} $$</p><p>é‚£ä¹ˆå¯¹äºå…¶ä»–çš„å•ä½æ ¹ï¼Œè®°ä½œ$$\omega_n^k=e^{\frac{2\pi ik}{n}},0 \leq k &lt; n$$éƒ½æ˜¯ä¸»æ¬¡å•ä½æ ¹çš„æ•´æ¬¡å¹‚ï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸­çš„ä¸€åœˆã€‚</p><hr><p>è¯¶ï¼Œè¿™ä¸ªæœ‰å•¥ç”¨å•Š$QAQ$?</p><p>é‚£æ˜¯å› ä¸ºå•ä½æ ¹ä»¬æœ‰ä¸€å †ç‰¹åˆ«å¥½ç”¨çš„æ€§è´¨ï¼Œè®©æˆ‘ä»¬å¯ä»¥å°†æ•°æ®è§„æ¨¡ä¸æ–­æŠ˜åŠï¼Œä½¿å¾—å…¶è¾¾åˆ°$nlogn$çš„å¤æ‚åº¦â€¦â€¦</p><p>é‚£ä¹ˆæˆ‘ä»¬å…ˆæ¥çœ‹å…¶æ”¯æŒå…¶è§„æ¨¡å‡åŠçš„å¼•ç†ï¼š</p><ul><li><h3 id="frak-Elimination-Lemma-quad-æ¶ˆå»å¼•ç†"><a href="#frak-Elimination-Lemma-quad-æ¶ˆå»å¼•ç†" class="headerlink" title="$\frak{Elimination ~Lemma\quad}$æ¶ˆå»å¼•ç†"></a>$\frak{Elimination ~Lemma\quad}$æ¶ˆå»å¼•ç†</h3></li></ul><hr><blockquote><p><strong>å¼•ç†ï¼šå¯¹ä»»ä½•æ•´æ•°$n \geq 0,k \geq 0,d &gt;0$,æœ‰$$\omega_{dn}^{dk} = \omega_n^k$$</strong></p></blockquote><p>$\mathcal{Proof.}$</p><p>è¿™ä¸ªå¥½åƒå¾ˆå¥½è¯çš„æ ·å­â€¦â€¦ä»£å…¥å®šä¹‰å¯ä»¥è·å¾—$$\omega_{dn}^{dk} = \omega^{\frac{2\pi dk}{dn}} = e^{\frac{2\pi ik}{n}} = \omega_n^k$$<br>$\mathcal{Q.E.D.}$</p><hr><ul><li><h3 id="frak-Binary-Lemma-quad-æŠ˜åŠå¼•ç†"><a href="#frak-Binary-Lemma-quad-æŠ˜åŠå¼•ç†" class="headerlink" title="$\frak{Binary~Lemma\quad}$ æŠ˜åŠå¼•ç†"></a>$\frak{Binary~Lemma\quad}$ æŠ˜åŠå¼•ç†</h3></li></ul><hr><blockquote><p><strong>å¼•ç†ï¼šå¯¹äºä»»ä½•å¤§äº$0$çš„å¶æ•°$n$ï¼Œéƒ½æœ‰$n$ä¸ª$n$æ¬¡å•ä½å¤æ ¹çš„å¹³æ–¹çš„é›†åˆï¼Œç­‰äº$\frac{n}{2}$ä¸ª$\frac{n}{2}$æ¬¡å•ä½å¤æ ¹çš„é›†åˆã€‚</strong></p></blockquote><p>$\mathcal{Proof.}$</p><p>æˆ‘ä»¬å¯ä»¥ç”±æ¶ˆå»å¼•ç†å¾—åˆ°$$(\omega _n^k)^2 = \omega^{2k}_n=\omega_{n/2}^k$$é‚£ä¹ˆ</p><p>$$(\omega_n^{k + \frac{n}{2}})^2 = \omega_n^{2k + n} \Longrightarrow \omega_n^{2k} \cdot \omega_n^n \Longrightarrow \omega_n^{2k} = (\omega_n^k)^2â€‹$$</p><p>$\mathcal{Q.E.D.}$</p><hr><p>é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œå¦‚æœå¯¹æ‰€æœ‰çš„$n$æ¬¡å•ä½è·Ÿå¹³æ–¹ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°$\frac{n}{2}$æ¬¡å•ä½æ ¹æ¯ä¸ªéƒ½æ°å¥½å‡ºç°äº†ä¸¤æ¬¡â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨$n$ä¸ª$n$æ­¤å•ä½å¤æ•°æ ¹çš„é›†åˆï¼ˆæœ´ç´ çš„é›†åˆï¼Œå³ä¸å¯é‡é›†ï¼‰é‡Œï¼Œåªæœ‰$\frac{n}{2}$ä¸ªå…ƒç´ ã€‚æˆ‘ä»¬å‚è€ƒä¸Šé¢é‚£å¼ å›¾ï¼Œå®ƒçš„æ„ä¹‰å°±åœ¨äºæ–¹å‘ç›¸å¯¹çš„ä¸¤åªå‘é‡ï¼Œå…¶å¹³æ–¹ç›¸ç­‰ã€‚</p><p>é‚£ä¹ˆæŠŠæ‰€æœ‰$n$å•ä½æ ¹çš„å¹³æ–¹ç”»åˆ°ä¸€ä¸ªæ•°åˆ—ä¸Šå°±æ˜¯è¿™æ ·ã€‚</p><p><img src="2.png" alt=""></p><p>è¿™ä¸ªå¼•ç†ç›´æ¥ä¿è¯äº†æˆ‘ä»¬æ±‚å€¼çš„å¤æ‚åº¦ä¸º$\Theta(n \log n)$</p><p>è€Œæˆ‘ä»¬åœ¨ä»£ç å®ç°ä¸­ï¼Œ<strong>ä¸èƒ½ç›´æ¥å¾—åˆ°$e$æˆ–è€…è™šæ•°$i$</strong>ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æ±‚å•ä½æ ¹çš„ä»»åŠ¡å°±äº¤ç»™äº†æˆ‘ä»¬ä¸Šæ–‡ä¸­æåˆ°è¿‡çš„<strong>æ¬§æ‹‰å…¬å¼</strong>ã€‚</p><ul><li><h3 id="frak-Sum-Lemma-quad-æ±‚å’Œå¼•ç†"><a href="#frak-Sum-Lemma-quad-æ±‚å’Œå¼•ç†" class="headerlink" title="$\frak{Sum~Lemma\quad}$æ±‚å’Œå¼•ç†"></a>$\frak{Sum~Lemma\quad}$æ±‚å’Œå¼•ç†</h3></li></ul><hr><blockquote><p><strong>å¼•ç†ï¼šå¯¹äºä»»æ„$n&gt;0$ä¸”$k$ä¸èƒ½æ•´é™¤$n$ï¼Œæˆ‘ä»¬éƒ½æœ‰$$\sum\limits_{j =0}^{n-1}{(\omega_n^k)^j} = 0$$</strong></p></blockquote><p>$Proof.$</p><p>ç”±å‡ ä½•çº§æ•°çš„æ±‚å’Œå…¬å¼ï¼ˆç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼)$$\sum\limits_{j = 0}^{n}{x^j} = \frac{x^{j +1} -1}{x -1}$$å¯å¾—$$\sum\limits_{j =0}^{n-1}{(\omega_n^k)^j} = \frac{(\omega_n^k)^n -1}{\omega_n^k -1} \Longrightarrow  \frac{(\omega_n^n)^k -1}{\omega_n^k -1} =  \frac{(1)^k -1}{\omega_n^k -1}$$ç”±äºä¿è¯äº†$k$ä¸å¯æ•´é™¤$n$æ‰€ä»¥åˆ†æ¯ä¸€å®šä¸ä¸º$0.$</p><p>$\mathcal{Q.E.D}$</p><hr><h1 id="rm-0x05-quad-DFT-to-FFT"><a href="#rm-0x05-quad-DFT-to-FFT" class="headerlink" title="$\rm{0x05\quad DFT \to FFT}$"></a>$\rm{0x05\quad DFT \to FFT}$</h1><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨äº†è§£å®Œå•ä½å¤æ•°æ ¹ä¹‹åï¼Œä¾¿å¯ä»¥æ­£å¼åœ°å¯¹$DFT$ç»™å‡ºå®šä¹‰ä¸æ“ä½œæ–¹æ¡ˆäº†ã€‚</p><ul><li><h2 id="DFT"><a href="#DFT" class="headerlink" title="$DFT$"></a>$DFT$</h2></li></ul><p>å¯¹äºæˆ‘ä»¬å·²çŸ¥çš„ä¸€ä¸ªå¤šé¡¹å¼$$A(x) = \sum\limits_{i =0}^{n - 1}{a_ix^i}$$åœ¨$\omega_n^0,\omega_n^1,\omega_n^2 \cdots \omega_n^{n-1}$å¤„çš„å–å€¼ï¼Œæˆ‘ä»¬å¯ä»¥å‡å®š$n$æ˜¯$2$çš„å¹‚ï¼Œå› ä¸ºå³ä½¿å®ƒæœ¬èº«ä¸æ˜¯$2$çš„å¹‚ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å‘é«˜æ¬¡å¹‚è¡¥å€¼ä¸º$0$çš„é¡¹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è€Œè¡¥è¶³$2$çš„å¹‚çš„ç›®çš„ï¼Œå°±æ˜¯ä¸ºäº†åœ¨$FFT$åˆ†æ²»çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ä¹‹å¯ä»¥ä¸€ç›´åˆ†æ²»ä¸‹å»ä¸”æ¯æ¬¡åˆ†æ²»å¾—å‡ºçš„ä¸¤åŠå¯ä»¥è¿›è¡Œè¿ç®—ã€‚</p><p>é‚£æˆ‘ä»¬ç°åœ¨ä¼šæœ‰ä¸€ä¸ª$A$çš„å‘é‡ç»„$\vec{a} = {a_1, a_2, a_3 \cdots a_{n-1}}$ï¼Œå¯¹äº$k = 0, 1, 2, \cdots n -1$ï¼Œå®šä¹‰$y_k$å¦‚ä¸‹ï¼š$$y_k = A(\omega_n^k)=\sum\limits_{j =0}^{n -1}{a_j \cdot \omega_n^{kj}}$$ï¼Œé‚£ä¹ˆå‘é‡$$\vec{y} = {y_0, y_1, y_2 \cdots y_{n-1}}$$å°±ç§°ä½œç³»æ•°å‘é‡$\vec{a} = {a_1, a_2, a_3 \cdots a_{n-1}}$çš„<strong>ç¦»æ•£å‹å‚…ç«‹å¶å˜æ¢ï¼ˆ$\boldsymbol{Discrete   Fourier   Transformation}$ï¼‰</strong>ã€‚</p><p>å—¯ï¼Œè¿™ä¸ª<strong>ç¦»æ•£å‹</strong>æˆ‘ä»¬å¯ä»¥ç”±ç‚¹ä¹˜æ³•è”æƒ³æ„ä¼šä¸€ä¸‹ï¼šæœ¬æ¥$A(x)$æ˜¯ä¸€ä¸ªä¼˜ç¾çš„å¤šé¡¹å¼ï¼Œè½¬å˜æˆå‡½æ•°ä¹‹åæ˜¯ä¸€æ¡ä¼˜ç¾çš„æ›²çº¿ï¼ˆä¼˜ç¾åªæ˜¯å®šè¯­â€¦â€¦ä¸æ˜¯é‡è¦å†…å®¹$qwq$ï¼‰ï¼Œç»“æœä½ çªç„¶æŠŠå®ƒæ‹†æˆäº†ä¸€å †ç¦»æ•£çš„ç‚¹ï¼ŒæŠŠå®ƒç”¨ç‚¹å€¼æ³•è¡¨ç¤ºï¼Œæ•…ç§°ä¹‹æ›°ï¼šâ€œç¦»æ•£å‹â€ ã€‚</p><ul><li><h2 id="FFT-ä¼˜åŒ–-DFT"><a href="#FFT-ä¼˜åŒ–-DFT" class="headerlink" title="$FFT$ä¼˜åŒ–$DFT$"></a>$FFT$ä¼˜åŒ–$DFT$</h2></li></ul><p>åœ¨ä¸Šæ–‡ä¸­æˆ‘ä»¬åˆ†æè¿‡ï¼Œå°†ç³»æ•°è¡¨è¾¾å¼è½¬åŒ–ä¸ºç‚¹å€¼è¡¨è¾¾å¼éœ€è¦çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n^2)$ï¼Œè¿™æ˜¯æœ´ç´ ç®—æ³•ã€‚è€Œæˆ‘ä»¬åªéœ€è¦ç”¨ä¸€ç§è¢«ç§°ä½œ<strong>å¿«é€Ÿå‚…ç«‹å¶å˜æ¢ï¼ˆ$\boldsymbol{Fast   Fourier   Transformation}$ï¼‰</strong>çš„æ–¹å¼ï¼Œå°±å¯ä»¥å°†å…¶æ—¶é—´å¤æ‚åº¦å‹ç¼©æˆ$O(nlogn)$ã€‚è€Œåœ¨è¿™é‡Œæˆ‘ä»¬å°±ç”¨åˆ°äº†åˆšæ‰è¯æ˜çš„å¼•ç†â€”â€”<strong>æŠ˜åŠå¼•ç†</strong>ã€‚</p><p>æˆ‘ä»¬è€ƒè™‘å°†åŸæ¥çš„å¤šé¡¹å¼$$A(x) = a_0+a_1x+ a_2x^2 \cdots +a_{n-1}x^{n-1}$$é‡å®šä¹‰æˆä¸¤ä¸ªæ¬¡æ•°ä¸º$\frac{n}{2}$çš„å°å¤šé¡¹å¼$A^{[0]}(x)$å’Œ$A^{[1]}(x)$ï¼š </p><p>$$A^{[0]}(x) = a_0 + a_2x+a_4x^2 \cdots +a_{n-2}x^{\frac{n}{2} - 1}$$ $$ A^{[1]}(x) = a_1 + a_3x+a_5x^2 \cdots +a_{n-1}x^{\frac{n}{2} - 1}$$    é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œ$A^{[0]}(x)$å­˜å‚¨çš„æ˜¯æ‰€æœ‰å¶æ•°ä½ï¼ˆäºŒè¿›åˆ¶ä½æœ€åä¸€ä½æ˜¯$0$ï¼‰ï¼Œè€Œ$A^{[1]}(x)$å­˜å‚¨çš„æ˜¯æ‰€æœ‰çš„å¥‡æ•°ä½ï¼ˆäºŒè¿›åˆ¶ä½æœ€åä¸€ä½æ˜¯$1$ï¼‰ï¼Œé‚£ä¹ˆæœ‰ä¸‹å¼ï¼š$$A(x) = A^{[0]}(x^2)+xA^{[1]}(x^2)$$é‚£æˆ‘ä»¬æ±‚$A(x)$åœ¨å•ä½æ ¹ä»¬$\omega_n^0,\omega_n^1,\omega_n^2 \cdots ,\omega_n^{n-1}$å¤„çš„å€¼ï¼Œå°±å˜æˆäº†å…ˆæ±‚å‡º$A^{[0]}(x^2)$å’Œ$A^{[1]}(x^2)$çš„å€¼ï¼Œç„¶åæ ¹æ®ä¸Šå¼è¿›è¡Œåˆå¹¶å³å¯ã€‚</p><p>è€Œæ˜¾ç„¶çš„æ˜¯ï¼Œæ ¹æ®æŠ˜åŠå¼•ç†ï¼Œæˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦$O(n)$æ±‚ï¼Œè€Œæ˜¯é€šè¿‡æ•°æ®è§„æ¨¡ä¸æ–­å‡å°ä½¿ä¹‹æˆä¸º$O(\log n)$ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬æˆåŠŸé€šè¿‡$FFT$ä¼˜åŒ–äº†æ±‚å€¼çš„å¤æ‚åº¦ã€‚</p><p>é‚£ä¹ˆåŒæ—¶å¯¹äºå¦ä¸€è¾¹ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®</p><p>$$A(\omega_n^{k+\frac{n}{2}}) = A^{[0]}(\omega_n^{2k+n})+\omega_n^{k+\frac{n}{2}}A^{[1]}(\omega_n^{2k+n}) \Longrightarrow A^{[0]}(\omega_n^{2k}\cdot \omega_n^{n})-\omega_n^{k}A^{[1]}(\omega_n^{2k}\cdot \omega_n^{n})$$</p><p>å¾—åˆ°</p><p>$$A(\omega_n^{k+\frac{n}{2}})=A^{[0]}(\omega_n^{2k})-\omega_n^{k}A^{[1]}(\omega_n^{2k})$$</p><p>ä»è€Œæœ‰ä¼ªä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> Lim = <span class="number">1</span>, N, M ;</span><br><span class="line"><span class="function">function <span class="title">FFT</span><span class="params">(<span class="keyword">int</span> lenth, <span class="keyword">complex</span> *A, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">IF (Lim == <span class="number">1</span>) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">complex</span> A0[lenth &gt;&gt; <span class="number">1</span>], A1[lenth &gt;&gt; <span class="number">1</span>] ;<span class="comment">//åˆ†æˆä¸¤éƒ¨åˆ†</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j : <span class="number">0</span> to lenth by_grow <span class="number">2</span>) A0[j &gt;&gt; <span class="number">1</span>] = A[j], A1[j &gt;&gt; <span class="number">1</span>] = A[j + <span class="number">1</span>] ;</span><br><span class="line">FFT(lenth &gt;&gt; <span class="number">1</span>, A0, flag) ;</span><br><span class="line">FFT(lenth &gt;&gt; <span class="number">1</span>, A1, flag) ;</span><br><span class="line"><span class="keyword">complex</span> Wn = unit(,) , w = (<span class="number">1</span>, <span class="number">0</span>) ;<span class="comment">//Wnæ˜¯å•ä½æ ¹ï¼Œwç”¨æ¥æšä¸¾å¹‚ï¼Œå³æˆ‘ä»¬ä»¤ä¸»æ¬¡å•ä½æ ¹ä¸å˜ï¼Œç”±äºå…¶ä½™å•ä½æ ¹éƒ½æ˜¯å…¶æ•´æ¬¡å¹‚ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¸€ä¸ªwæ¥è®°å½•åˆ°ç¬¬å‡ æ¬¡å¹‚</span></span><br><span class="line">        <span class="comment">/*æ­¤å¤„æ±‚å•ä½æ ¹çš„æ—¶å€™ä¼šç”¨åˆ°æˆ‘ä»¬çš„å‚æ•°flagâ€¦â€¦å—¯æ²¡é”™å°±ç”¨è¿™ä¸€æ¬¡ï¼Œå¹¶ä¸”flagçš„å€¼åŸŸä¸º(-1, 1)â€¦â€¦æ˜¯çš„ï¼Œåªä¼šæœ‰ä¸¤ä¸ªå€¼*/</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j : <span class="number">0</span> to (lenth &gt;&gt; <span class="number">1</span>) by_grow <span class="number">1</span> with w = w * Wn)&#123;</span><br><span class="line">A[i] = A0[i] + A1[i] * w ;<span class="comment">//åº”ç”¨å…¬å¼ï¼Œä¸‹åŒ </span></span><br><span class="line">A[i + (lenth &gt;&gt; <span class="number">1</span>)] = A0[i] - A1[i] * w ; <span class="comment">//é¡ºä¾¿æ±‚å‡ºå¦ä¸€åŠï¼Œç”±æŠ˜åŠå¼•ç†å¯æ˜¾ç„¶ã€‚ </span></span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">function Main&#123;</span><br><span class="line">input(N), input(M) ;</span><br><span class="line"><span class="keyword">for</span>(i : <span class="number">0</span> to N by_grow <span class="number">1</span>) =&gt; input(A) ;</span><br><span class="line"><span class="keyword">for</span>(i : <span class="number">0</span> to M by_grow <span class="number">1</span>) =&gt; input(B) ; </span><br><span class="line"><span class="keyword">while</span>(Lim &lt; N + M) Lim &lt;&lt;= <span class="number">1</span> ;<span class="comment">//Limä¸ºç»“æœå¤šé¡¹å¼çš„é•¿åº¦ï¼ˆæš‚æ—¶ï¼‰ï¼ŒåŒ–ä¸º2çš„å¹‚çš„ä¾¿äºåˆ†æ²»ï¼ˆäºŒåˆ†ï¼‰</span></span><br><span class="line">FFT(Lim, A, <span class="number">1</span>) ;<span class="comment">//ä¸¤éFFTè¡¨ç¤ºä»ç³»æ•°åŒ–ä¸ºç‚¹å€¼ </span></span><br><span class="line">FFT(Lim, B, <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">for</span>(i : <span class="number">0</span> to Lim by_grow <span class="number">2</span>) =&gt; A[i] *= B[i] ;<span class="comment">//ç‚¹ä¹˜æ³•ï¼Œæ­¤å¤„éœ€è¦é‡å®šä¹‰ä¹˜å·ï¼Œå› ä¸ºæ¯ä¸€é¡¹ç°åœ¨è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªç‚¹ï¼Œæœ‰xå’Œyä¸¤ä¸ªå±æ€§qwq </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæ˜¯åŸºäº$pks$æ ‡å‡†ä¸‹çš„ä¼ªä»£ç <del>ä½ å¯ä»¥è¯•è¯•åœ¨c++æ ‡å‡†ä¸‹è¿è¡Œ</del>ï¼Œå…¶ä¸­$for$å¾ªç¯éƒ¨åˆ†ï¼Œ$grow$è¡¨ç¤ºå½“å‰å¾ªç¯å˜é‡çš„<strong>å•æ¬¡å¢é‡</strong>ï¼Œä¹‹åå¸¦æœ‰$with$è¡¨ç¤ºæ¯æ¬¡å¾ªç¯ç»“æŸéƒ½ä¼šè¿›è¡Œçš„è¿ç®—ï¼ˆä¸‹åŒ</p><p>å—¯ï¼Œè¿™å°±æ˜¯æ±‚å€¼çš„æ–¹æ³•ï¼Œå¥½åƒå¾ˆ$nice$åœ°è¾¾åˆ°äº†$O(n \log n)$</p><ul><li><h2 id="FFT-ä¼˜åŒ–-IDFT"><a href="#FFT-ä¼˜åŒ–-IDFT" class="headerlink" title="$FFT$ä¼˜åŒ–$IDFT$"></a>$FFT$ä¼˜åŒ–$IDFT$</h2></li></ul><p>ä¸Šæ–‡ä¸­æˆ‘ä»¬æ›¾ç»æåŠè¿‡çš„<strong>èŒƒå¾·è’™å¾·çŸ©é˜µ</strong>å¯ä»¥æ”¾åˆ°è¿™å„¿ç”¨ï¼š</p><p>$\begin{vmatrix}  1         &amp;  1  &amp; 1   &amp; \cdots &amp; 1      \newline 1         &amp;  \omega_n  &amp; \omega_n^2   &amp; \cdots &amp; w_n^{n-1}      \\newline1         &amp;  \omega_n^2  &amp; \omega_n^4   &amp; \cdots &amp; \omega_n^{2(n-1)}      \newline \vdots  &amp; \vdots &amp; \vdots  &amp;  \ddots &amp; \vdots \newline 1    &amp;  \omega_n^{n-1}  &amp; \omega_n^{2(n-1)}   &amp; \cdots &amp; \omega_n^{(n-1)(n-1)}        \newline  \end{vmatrix}$  $\begin{vmatrix}  a_0  \newline a_1 \newline a_2 \newline \vdots \newline a_{n-1} \end{vmatrix}$ = $\begin{vmatrix}  y_0  \newline y_1 \newline y_2 \newline \vdots \newline y_{n-1} \end{vmatrix}$</p><p>é‚£ä¸ºäº†æ±‚å‡ºæˆ‘ä»¬çš„$\vec{a} = {a_0, a_1 \cdots ,a_{n-1}}$æˆ‘ä»¬åº”è¯¥è®©åˆšåˆšæ±‚å€¼ç®—å‡ºçš„$\vec{y}$ä¹˜ä¸Šæˆ‘ä»¬$\vec{V}^{~-1}$ï¼ˆ$\vec{V}$çš„é€†çŸ©é˜µï¼‰å³å¯ã€‚ä½†æ˜¯æ¡¥è±†éº»è¢‹~~~ä¸éœ€è¦ç”¨ä»€ä¹ˆé«˜æ¶ˆå•Šâ€¦ä½™å­å¼å•Šâ€¦æˆ‘ä»¬åªéœ€è¦ä»¥ä¸‹ï¼š</p><hr><blockquote><p><strong>æ¨è®º</strong>ï¼šå¯¹äº$j,k = 0,1, 2 \cdots n-1,V_n^{-1}$çš„$(j, k)$å¤„çš„å€¼ä¸º$\omega_n^{-kj}/n$</p></blockquote><p>$Proof.$</p><p>æˆ‘ä»¬è€ƒè™‘åå‘è¯æ˜ï¼Œå·²çŸ¥$V_nâ€™$æ˜¯ä¸€ä¸ª$(j,k)$å¤„å€¼ä¸º$\omega_n^{-kj}/n$çš„ã€ä¸$V$å½¢æ€ç›¸åŒçš„çŸ©é˜µï¼Œé‚£æˆ‘ä»¬åªéœ€è¦è¯æ˜$Vâ€™ \cdot V = I_n$å³å¯ï¼Œå…¶ä¸­$I_n$æ˜¯$n$é˜¶å•ä½çŸ©é˜µï¼Œå³ä¸»å¯¹è§’çº¿éƒ½æ˜¯$1$ï¼Œå…¶ä½™ä½ç½®ä¸Šæ˜¯$0$çš„çŸ©é˜µã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬è€ƒå¯Ÿ$Vâ€™ V$ä¸­çš„å…ƒç´ $(i, j)$ï¼Œæœ‰å¦‚ä¸‹çš„å¼å­$$Vâ€™V = \sum\limits^ {n-1}_{k=0}{(\omega_n^{-ki}/n)} \cdot {\omega_n^{kj}} = \frac{1}{n} \sum\limits^ {n-1}_{k=0}{\omega_n^{k(j-i)}}$$</p><p>ç”±<strong>æ±‚å’Œå¼•ç†</strong>å½“ä¸”ä»…å½“$i=j$æ—¶å…¶å€¼ä¸ºä¸€ï¼Œå…¶ä½™çš„æ—¶åˆ»å‡ä¸ºé›¶ï¼Œæ‰€ä»¥æœ‰$Vâ€™V = I_n$</p><p>$\mathcal{Q.E.D}$</p><hr><p>é‚£ä¹ˆæˆ‘ä»¬æŠŠæˆ‘ä»¬åˆšåˆšæ±‚å‡ºæ¥çš„é€†çŸ©é˜µ$V^{-1}$ç¾åŒ–ä¸€ä¸‹ï¼Œæå‡ºæ¯ä¸€é¡¹æ‰€é™¤çš„$n$ï¼Œå¯ä»¥å¾—åˆ°$IDFT$å¯ä»¥å¦‚æ­¤è®¡ç®—ï¼š$$IDFT_n(y) = \frac{1}{n}\sum\limits_{k = 0}^{n-1}{y_k\omega_n^{-kj}},j\in [0,n-1]$$è¯¶ï¼Œè¿™ä¸ªå¥½åƒâ€¦â€¦è·Ÿæˆ‘ä»¬æ±‚å€¼æ—¶çš„å…¬å¼å·®ä¸å¤šï¼Ÿæ²¡é”™ï¼Œé™¤äº†å¸¦ä¸ªè´Ÿå·ï¼Œå…¶ä½™çš„éƒ½å·®ä¸å¤šã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æ‰“ä¸ªæ ‡è®°ï¼šå½“$flag=1$æ—¶ï¼Œä»–æ˜¯æ­£å‘$DFT$ï¼›å½“å®ƒç­‰äº$-1$æ—¶ï¼Œå®ƒæ˜¯é€†å‘çš„$ IDFT$ã€‚è¿™å¯ä»¥è®©æˆ‘ä»¬é€šè¿‡è¿™ä¸€ä¸ªå‡½æ•°è§£å†³ä¸¤ä¸ªè¿‡ç¨‹ã€‚æˆ‘ä»¬åªéœ€è¦ç”¨$y$æ›¿æ¢$a$ï¼Œç”¨$\omega_n^{-1}$æ›¿æ¢$\omega_n$ï¼Œå…¶ä½™çš„æ²¡ä»€ä¹ˆå·®åˆ«ï¼Œäºæ˜¯â€¦â€¦æ—¶é—´å¤æ‚åº¦è¿˜æ˜¯$O(n \log n)$çš„!</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(<span class="keyword">int</span> Lim,<span class="keyword">complex</span> *A,<span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Lim == <span class="number">1</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">complex</span> A0[Lim &gt;&gt; <span class="number">1</span>], A1[Lim &gt;&gt; <span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= Lim ; i += <span class="number">2</span>)</span><br><span class="line">        A0[i &gt;&gt; <span class="number">1</span>] = A[i], A1[i &gt;&gt; <span class="number">1</span>] = A[i+<span class="number">1</span>] ;</span><br><span class="line">    FFT(Lim &gt;&gt; <span class="number">1</span>, A0, flag) ;</span><br><span class="line">    FFT(Lim &gt;&gt; <span class="number">1</span>, A1, flag) ;</span><br><span class="line">    <span class="keyword">complex</span> unit = (<span class="keyword">complex</span>)&#123;<span class="built_in">cos</span>(<span class="number">2.0</span> * Pi / Lim) , flag * <span class="built_in">sin</span>(<span class="number">2.0</span> * Pi / Lim)&#125;, w = <span class="keyword">complex</span>(<span class="number">1</span>, <span class="number">0</span>) ;<span class="comment">//æ¬§æ‹‰å…¬å¼ </span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; (Lim &gt;&gt; <span class="number">1</span>) ; i ++, w = w * unit) &#123;</span><br><span class="line">        A[i] = A0[i] + w * A1[i] ;</span><br><span class="line">        A[i + (Lim&gt;&gt;<span class="number">1</span>)] = A0[i] - w*A1[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">......................</span><br><span class="line">FFT(A, <span class="number">1</span>), FFT(B, <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= Lim; i ++) A[i] = A[i] * B[i] ;</span><br><span class="line">FFT(A, <span class="number">-1</span>) ;</span><br><span class="line">......................</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥½çš„ï¼Œç°åœ¨å˜›â€¦â€¦å¯ä»¥è€ƒè™‘æ’’èŠ±èŠ±å•¦ï¼å› ä¸ºæˆ‘ä»¬çš„$FFT$å®é™…ä¸Šå·²ç»ç»“æŸäº†ï¼$But$ï¼Œè¿™ä¸ªé€’å½’ç‰ˆæœ¬çš„$FFT$ç”±äºç‰µæ‰¯åˆ°$sin/cos$çš„è¿ç®—ã€$double$ã€é€’å½’æ—¶çš„å…¥æ ˆå‡ºæ ˆï¼ˆåº•å±‚ï¼‰ï¼Œæ‰€ä»¥å¸¸æ•°ç‰¹åˆ«çš„å¤§$emmmmm$ï¼Œé‚£ä¹ˆâ€”â€”</p><h1 id="rm-0x06-Iterative-Optimization"><a href="#rm-0x06-Iterative-Optimization" class="headerlink" title="$\rm{0x06~Iterative~ Optimization}$"></a>$\rm{0x06~Iterative~ Optimization}$</h1><p>æˆ‘ä»¬ç°åœ¨è¦å¼•å‡ºçš„å°±æ˜¯è¿­ä»£ç‰ˆçš„$FFTqwq$</p><h2 id="Â·-rm-Advanced-Trick-Point-color-red-3-rm-The-Butterfly-Operation"><a href="#Â·-rm-Advanced-Trick-Point-color-red-3-rm-The-Butterfly-Operation" class="headerlink" title="Â· $\rm{Advanced~Trick~Point}$ $\color{red}{3}$ $\rm{The~Butterfly ~Operation}$"></a>Â· $\rm{Advanced~Trick~Point}$ $\color{red}{3}$ $\rm{The~Butterfly ~Operation}$</h2><p>$emmm$å…ˆä¸Šä¸€ä¸ªä¸æ˜¯ç‰¹åˆ«å¡å¸¸æ•°çš„ä¼˜åŒ–ã€‚æˆ‘ä»¬è§‚å¯Ÿä¹‹å‰çš„ä»£ç ä¸­ï¼Œæœ‰è¿™ä¹ˆä¸€æ­¥ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; (Lim &gt;&gt; <span class="number">1</span>) ; i ++, w = w * unit) &#123;</span><br><span class="line">        a[i] = A0[i] + w * A1[i] ;</span><br><span class="line">        a[i + (Lim&gt;&gt;<span class="number">1</span>)] = A0[i] - w*A1[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬ä¼šå‘ç°â€¦â€¦$\omega \cdot A^{[1]}[i]$è¢«æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¦¨ç”¨ä¸ªå˜é‡è®°å½•å®ƒï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; (Lim &gt;&gt; <span class="number">1</span>) ; i ++, w = w * unit) &#123;</span><br><span class="line">       <span class="keyword">int</span> temp = w * A1[i] ;</span><br><span class="line">a[i] = A0[i] + t ;</span><br><span class="line">       a[i + (Lim&gt;&gt;<span class="number">1</span>)] = A0[i] - t ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><del>å—¯ï¼Œè¿™å°±æ˜¯å…¨éƒ¨çš„ä¼˜åŒ–å•¦ï¼é‚£ä¹ˆï¼ŒFFTï¼Œå®Œï¼</del></p><p>$qwq$è¿™åˆ†æ˜æ˜¯éª—å°å­©å­çš„å•¦â€¦â€¦å¦‚æœå•å•è¿™ä¸€æ­¥å°±å¯ä»¥å¡å¸¸æ•°çš„è¯ï¼Œé‚£è¿™ä¸ªä¸–ç•Œè¯¥å¤šä¹ˆç¾å¥½$\mathcal{QAQ}$ã€‚å¥½å§ï¼Œè¯´è¿™ä¸ªçš„åŸå› ï¼Œåªæ˜¯ä¸ºäº†å¼•å‡ºæˆ‘ä»¬å…³äº<strong>è´è¶æ“ä½œ</strong>çš„å®šä¹‰ï¼š</p><blockquote><p>æˆ‘ä»¬å®šä¹‰$\omega_n^k$ä¸º<strong>æ—‹è½¬å› å­</strong>ï¼Œé‚£ä¹ˆæ¯ä¸€æ¬¡æˆ‘ä»¬å…ˆå°†$y_k^{[1]}$ä¸æ—‹è½¬å› å­çš„ä¹˜ç§¯å­˜å‚¨åœ¨ä¸€ä¸ªå˜é‡$t$é‡Œï¼Œå¹¶åœ¨$y_k^{[0]}$å¢åŠ ã€å‡å»$t$çš„æ“ä½œç§°ä¸ºä¸€æ¬¡è´è¶æ“ä½œã€‚</p></blockquote><p>è¯´ç™½äº†ï¼Œè´è¶æ“ä½œæ˜¯ä¸€æ¬¡$O(2)$çš„æ±‚å‡º$A^{[0]}_k$ä¸$A^{[1]}_k$çš„æ“ä½œã€‚</p><hr><p>æˆ‘ä»¬é¦–å…ˆè€ƒè™‘æŒ‰ç…§é€’å½’çš„æ€è·¯ï¼Œå°†$FFT$çš„åˆ†æ²»æµç¨‹åˆ»ç”»ä¸€ä¸‹ï¼š</p><p><img src="3.png" alt=""></p><p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œå…¶å®æˆ‘ä»¬æ˜¯å¯ä»¥å¯¹å®ƒè¿›è¡Œåå‘è¿­ä»£çš„ã€‚ä»¥ä¸Šé¢çš„è¿­ä»£æ ‘ä¸ºä¾‹ï¼Œæˆ‘ä»¬çš„æ­¥éª¤å¤§ä½“å¦‚ä¸‹ï¼š</p><blockquote><p>$step   1$  æˆå¯¹åœ°å–å‡ºå„¿å­èŠ‚ç‚¹ï¼Œç”¨è´è¶æ“ä½œè®¡ç®—å‡ºå…¶$DFT$ã€‚<br>$step   2$  ç”¨è¿™ä¸€æ­¥çš„$DFT$æ›¿æ¢ä¹‹å‰çš„ï¼›<br>$step   3$  ç›´åˆ°æˆ‘ä»¬è¿­ä»£åˆ°æ ¹èŠ‚ç‚¹ä¸ºæ­¢ï¼Œå¦åˆ™è¿”å›$step   1$</p></blockquote><p>è€Œåå‘è¿­ä»£ä¼¼ä¹æœ‰è§„å¾‹å¯å¾ªã€‚æˆ‘ä»¬å‘ç°åªè¦æˆ‘ä»¬ç”¨è¿­ä»£çš„è¿‡ç¨‹æ¨¡æ‹Ÿå‡ºå›æº¯çš„è¿‡ç¨‹å³å¯ã€‚é‚£ä¹ˆæ€è·¯ä¾¿æœ‰äº†ï¼šä¸‰å±‚$for$ï¼Œå…ˆæšä¸¾åŒºé—´é•¿åº¦ï¼ˆ1ï¼Œ2ï¼Œ4ï¼Œ8â€¦â€¦ï¼‰ï¼Œç¬¬äºŒå±‚æšä¸¾é•¿åº¦ä¸º$j*2$çš„æ¯ä¸ªåŒºé—´çš„èµ·ç‚¹â€”â€”æ„å›¾ä¸ºåŒæ—¶æšä¸¾ä¸¤ä¸ªç›¸é‚»åŒºé—´ï¼Œä¾¿äºç›¸é‚»åŒºé—´ä¹‹é—´$DFT$çš„åˆå¹¶ï¼Œç¬¬ä¸‰å±‚è´Ÿè´£éå†æ¯æ®µåŒºé—´ï¼Œè¿ç”¨è´è¶æ“ä½œé€ä¸ªåˆå¹¶ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; Lim; j &lt;&lt;= <span class="number">1</span>)&#123;<span class="comment">//æšä¸¾åŒºé—´é•¿åº¦ï¼Œä»å°åŒºé—´åˆ°å¤§åŒºé—´ä¾æ¬¡åˆå¹¶ã€‚</span></span><br><span class="line">        <span class="function">node <span class="title">T</span><span class="params">(<span class="built_in">cos</span>(Pi / j), flag * <span class="built_in">sin</span>(Pi / j))</span> </span>;</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; Lim; k += (j &lt;&lt; <span class="number">1</span>) )&#123;<span class="comment">//ä¸¤æ®µåŒºé—´ä¸¤æ®µåŒºé—´çš„æšä¸¾ï¼Œç”¨äºåˆå¹¶</span></span><br><span class="line">            <span class="function">node <span class="title">t</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span> </span>;</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j; l ++, t = t * T)&#123;<span class="comment">//æšä¸¾kæ‰€æšä¸¾çš„ä¸¤ä¸ªåŒºé—´å†…çš„å€¼ï¼Œå¹¶è¿›è¡Œè´è¶æ“ä½œã€‚</span></span><br><span class="line">                node Nx = J[k + l], Ny = t * J[k + j + l] ;</span><br><span class="line">                J[k + l] = Nx + Ny ; J[k + j + l] = Nx - Ny ;<span class="comment">//ä¸€æ¬¡è´è¶æ“ä½œ</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å—¯ï¼Œå¥½åƒâ€¦â€¦æµ·æ˜Ÿï¼Ÿå“ˆï¼Œæ€ç»´ä¸ä¸¥è°¨çš„æˆ‘ä»¬æ¼äº†ä¸€ä¸ªåœ°æ–¹ï¼šæˆ‘ä»¬åœ¨$DFT$çš„æ—¶å€™ï¼Œä¸ºäº†ä¿è¯æ—¶é—´å¤æ‚åº¦æ˜¯$\Theta(\log n)$ï¼Œæˆ‘ä»¬æ›¾ç»è¿›è¡Œè¿‡ä¸€æ¬¡$A(x) = A^{[0]}(x^2)+xA^{[1]}(x^2)$çš„æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªåŠ¨è°ƒæ•´é¡ºåºã€‚é€šä¿—ä¸€ç‚¹ï¼Œå°±æ˜¯æˆ‘ä»¬åŸæ¥çš„åºåˆ—é¡ºåºæ˜¯$0,1,2,3,4,5,6,7$ï¼Œä½†æ˜¯è¿­ä»£ç‰ˆçš„$FFT$å´éœ€è¦çš„é¡ºåºåº”è¯¥è·Ÿå¶å­ç»“ç‚¹çš„é¡ºåºå»åˆï¼Œå³$0, 4, 2, 6, 1, 5,3,7$ã€‚æ‰€ä»¥â€”â€”</p><ul><li><h2 id="Â·-rm-Trick-Point-color-red-4-rm-The-Butterfly-Law"><a href="#Â·-rm-Trick-Point-color-red-4-rm-The-Butterfly-Law" class="headerlink" title="Â· $\rm{Trick~Point}$ $\color{red}{4}$ $\rm{The~Butterfly ~Law}$"></a>Â· $\rm{Trick~Point}$ $\color{red}{4}$ $\rm{The~Butterfly ~Law}$</h2></li></ul><p>è¿™ä¸ªå˜›â€¦â€¦æˆ‘ä»¬å¯ä»¥é€‰æ‹©æ‰“ä¸ªè¡¨è§‚å¯Ÿï¼š<br>åŸæ¥çš„åºå· $0        1        2        3        4        5        6         7$<br>ç°åœ¨çš„åºå· $0        4        2        6        1        5        3        7$<br>åŸæ¥çš„äºŒè¿›åˆ¶è¡¨ç¤º $000        001        010        011        100        101        110        111$<br>ç°åœ¨çš„äºŒè¿›åˆ¶è¡¨ç¤º $000        100        010        110        100        101        011        111$</p><p>è¯¶ï¼ŒäºŒè¿›åˆ¶å¥½åƒæ˜¯ååºçš„å—·~~è¿™ä¾¿æ˜¯æˆ‘ä»¬çš„æœ€åä¸€ä¸ª$trick$ï¼Œè´è¶å®šç†ã€‚è€Œå› ä¸ºæˆ‘ä»¬è§‚å¯Ÿåˆ°çš„è´è¶å®šç†æ˜¯æ»¡è¶³ä¸€ä¸€å¯¹åº”æ€§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨$FFT$ä¹‹å‰$swap$ä¸€éå³å¯ã€‚</p><p>å—¯ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªååºå­˜åœ¨ä¸€ä¸ªæ•°ç»„é‡Œé¢ã€‚ç±»ä¼¼è¿™æ ·æ±‚å‡ºæ¥ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++ ) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>)) ;</span><br></pre></td></tr></table></figure></p><p>å‘ƒï¼Œè¿™ä¸ªäºŒè¿›åˆ¶è®¡ç®—è‡ªå·±æ¨ä¸€ä¸‹å°±å¥½ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™å°±ç®€åŒ–äº†å¾ˆå¤šå†—ä½™çš„æ­¥éª¤ï¼Œå¹¶è®©æˆ‘ä»¬è„±ç¦»é€’å½’çš„å¤§å¸¸æ•°ã€‚<del>çœŸå¼€æ£®å•Š</del></p><p>æœ€åé™„è¿­ä»£ç‰ˆçš„ä»£ç (æˆ‘å†™çš„å¸¸æ•°å¥½åƒæœ‰ç‚¹å„¿å¤§$QAQ$)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="keyword">int</span> N, M, K ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3000100</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> Pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>) ;</span><br><span class="line"><span class="keyword">int</span> i, j, k, l, Lim = <span class="number">1</span>, L, R[MAXN] ; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y ;</span><br><span class="line">    node (<span class="keyword">double</span> xx = <span class="number">0</span>, <span class="keyword">double</span> yy = <span class="number">0</span>)&#123;</span><br><span class="line">        x = xx, y = yy ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;A[MAXN], B[MAXN] ;</span><br><span class="line">node <span class="keyword">operator</span> * (node J, node Q)&#123;</span><br><span class="line">    <span class="keyword">return</span> node(J.x * Q.x - J.y * Q.y , J.x * Q.y + J.y * Q.x);</span><br><span class="line">&#125;</span><br><span class="line">node <span class="keyword">operator</span> + (node J, node Q)&#123;</span><br><span class="line">    <span class="keyword">return</span> node(J.x + Q.x , J.y + Q.y);</span><br><span class="line">&#125;</span><br><span class="line">node <span class="keyword">operator</span> - (node J, node Q)&#123;</span><br><span class="line">    <span class="keyword">return</span> node(J.x - Q.x , J.y - Q.y );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>, f = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c))&#123;<span class="keyword">if</span>(c == <span class="string">'-'</span>) f = <span class="number">-1</span> ;c = getchar() ;&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(c)) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span> ,c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k * f ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(node *J, <span class="keyword">int</span> flag)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++)</span><br><span class="line">        <span class="keyword">if</span>(i &lt; R[i]) swap(J[i], J[R[i]]) ;<span class="comment">//å‰é¢çš„ifä¿è¯åªæ¢ä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; Lim; j &lt;&lt;= <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="function">node <span class="title">T</span><span class="params">(<span class="built_in">cos</span>(Pi / j), flag * <span class="built_in">sin</span>(Pi / j))</span> </span>;</span><br><span class="line">        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; Lim; k += (j &lt;&lt; <span class="number">1</span>) )&#123;</span><br><span class="line">            <span class="function">node <span class="title">t</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span> </span>;</span><br><span class="line">            <span class="keyword">for</span>(l = <span class="number">0</span> ; l &lt; j; l ++, t = t * T)&#123;</span><br><span class="line">                node Nx = J[k + l], Ny = t * J[k + j + l] ;</span><br><span class="line">                J[k + l] = Nx + Ny ;</span><br><span class="line">                J[k + j + l] = Nx - Ny ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    N = qr(), M = qr() ; </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= N; i ++) A[i].x = qr() ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= M; i ++) B[i].x = qr() ;</span><br><span class="line">    <span class="keyword">while</span>(Lim &lt;= N + M) Lim &lt;&lt;= <span class="number">1</span>, L ++ ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; Lim; i ++ ) R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>)) ;</span><br><span class="line">    FFT(A, <span class="number">1</span>), FFT(B, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= Lim; i ++) A[i] = A[i] * B[i] ;</span><br><span class="line">    FFT(A, <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= N + M; i ++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, (<span class="keyword">int</span>)(A[i].x / Lim + <span class="number">0.5</span>)) ;<span class="comment">//æˆ‘ä»¬æ¨è¿‡çš„å…¬å¼é‡Œé¢æœ‰ä¸€ä¸ª1/nè¿™ä¸€é¡¹ï¼Œæœ€åè¾“å‡ºçš„æ—¶å€™æ·»ä¸Šå³å¯ </span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å•Šâ€¦â€¦é‚£å°±æ’’èŠ±èŠ±å§ï¼ï¼</p><h1 id="rm-0x00-quad-Afterword"><a href="#rm-0x00-quad-Afterword" class="headerlink" title="$\rm{0x00\quad Afterword}$"></a>$\rm{0x00\quad Afterword}$</h1><p>ä»¥ä¸‹æ˜¯åŸå°¾è¯­ï¼Œä¿ç•™äº†ä¸‹æ¥ï¼š</p><blockquote><p>å—¯â€¦â€¦æ€ä¹ˆè¯´å‘¢ï¼Œç°åœ¨çœ‹è¿™ä¸ªç®—æ³•ï¼ŒçœŸæ˜¯ç®€å•çš„ä¸€åŒ¹å•Šâ€¦â€¦ä»£ç è¿™ä¹ˆçŸ­<del>è¿™ä¹ˆå®¹æ˜“èƒŒè¿‡</del>ã€‚ä½†æ˜¯å½“æ—¶ç†è§£èµ·æ¥å´èŠ±äº†å¾ˆå¤§å¿ƒæ€å‘¢ï¼è¿™ç¯‡åšå®¢æˆ‘å†™äº†æ•´æ•´ä¸‰å¤©$qwq$ï¼Œç”±äºè¦åŸ¹è®­å’Œè€ƒè¯•ï¼Œæ‰€ä»¥æ‹–æ‹–æ²“æ²“åœ°å†™äº†ä¸‰å¤©ï¼Œä¸€è¾¹å†™ä¸€è¾¹æ„Ÿå¹è‡ªå·±ç†è§£çš„ç®€ç›´å¤ªæµ…æ˜¾äº†ã€‚æ¯ä¸€ä¸ªè¯æ˜ã€æ¯ä¸€ä¸ªå¼•ç†ã€ç”šè‡³æ¯ä¸€ä¸ªç¬¦å·ï¼Œæˆ‘éƒ½éœ€è¦å»å’Œå…¶ä»–$DALAO$æ¯”å¯¹å®¡æ ¸ã€æˆ–è€…ç¼ ç€$rqy$é—®ä¸ªæ²¡å®Œï¼›æ¯æ¬¡ä¸€è®²åˆ°åŸç†ï¼Œæˆ‘éƒ½å‘ç°è‡ªå·±åŸæ¥å¹¶ä¸ç†è§£é‚£äº›ï¼Œäºæ˜¯ä¸å¾—ä¸æ¨å€’é‡æ¥ã€‚è¿™ç¯‡åšå®¢ä¼šæŒç»­æ›´æ–°ï¼Œè¡¥å……è¯­æ„ä¸æ˜ã€è¯æ˜éš¾ä»¥ç†è§£çš„åœ°æ–¹ã€‚</p><p>ä»¥ä¸‹æ˜¯æ¸©é¦¨æç¤ºï¼š</p><ul><li>å¥½å¤šè‡ªå·±å½“åˆä¸ç†è§£çš„åœ°æ–¹åœ¨ä»£ç é‡Œå°±åªæœ‰åŠè¡Œqaq</li><li>ä¸‰ä¸ªå¼•ç†ä¸­ï¼Œåªæœ‰æ¶ˆå»å¼•ç†è·Ÿç®—æ³•çš„å®ç°æ²¡æœ‰å…³ç³»â€”â€”æ¶ˆå»å¼•ç†ä¸»è¦æ˜¯ç”¨æ¥è¯æ˜å…¶ä»–å¼•ç†çš„</li></ul></blockquote><p>çœŸ Â· ç»“æŸè¯­ï¼š</p><p>å…¶å®æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œä»Šå¤©é‡æ–°å¤ä¹ äº†ä¸€éï¼Œå‘ç°è‡ªå·±ä»¥å‰æœ‰å¥½å¤šå†…å®¹è™½ç„¶å¦‚åŸå°¾è¯­æ‰€è¨€ï¼Œçœ‹ä¸Šå»<code>ç°åœ¨çœ‹è¿™ä¸ªç®—æ³•ï¼ŒçœŸæ˜¯ç®€å•çš„ä¸€åŒ¹å•Š</code>ï¼Œä½†å®é™…ä¸Šå¿½ç•¥äº†å¥½å¤šä¸œè¥¿ã€‚æˆ‘æƒ³å¤§æ¦‚åªæœ‰ä¸€éä¸€éåœ°é’»ç ”æ‰èƒ½äº†è§£å®Œå…¨ä¸€ä»¶äº‹æƒ…å§ã€‚</p><h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$\rm{Reference}$"></a>$\rm{Reference}$</h2><ul><li>$[1]$ :$rvalue$çš„$blog$ <a href="https://www.cnblogs.com/rvalue/p/7351400.html" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li><li>$[2]$ :ç®—æ³•å¯¼è®º <a href="https://pan.baidu.com/s/13PRy8pPn__zGj3UfOTX8Ew" target="_blank" rel="noopener">$^{^{[\nearrow]}}$</a> æå–ç : txs2 </li><li>[3]*ï¼šé¸£è°¢rqy</li></ul><h2 id="mathfrak-writter-pks"><a href="#mathfrak-writter-pks" class="headerlink" title="$\mathfrak{writter:pks}$"></a>$\mathfrak{writter:pks}$</h2>]]></content>
    
    <summary type="html">
    
      ä¸€ç±»åœ¨$\Theta(nlogn)$æ—¶é—´å¤æ‚åº¦å†…è§£å†³å¹³å‡¡å·ç§¯çš„ç®—æ³•ï¼Œç›¸å¯¹æ¥è¯´æ¯”è¾ƒå…¥é—¨ã€‚
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="å¤šé¡¹å¼" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="å¤šé¡¹å¼-FFT" scheme="http://www.orchidany.cf/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F-FFT/"/>
    
  </entry>
  
  <entry>
    <title>éšæƒ³äº”Â·æ‰‹ä¸­æ²¡æœ‰çº¢ç«ç‘°</title>
    <link href="http://www.orchidany.cf/2019/02/14/%E9%9A%8F%E6%83%B3%E4%BA%94%C2%B7%E6%83%85%E4%BA%BA%E8%8A%82/"/>
    <id>http://www.orchidany.cf/2019/02/14/éšæƒ³äº”Â·æƒ…äººèŠ‚/</id>
    <published>2019-02-14T14:14:41.000Z</published>
    <updated>2019-03-10T08:15:16.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>â€œéšæƒ³â€ç³»åˆ—ç´¢å¼•ï¼š<a href="http://www.orchidany.cf/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/">æˆ³æˆ‘</a></p><hr><p>ä»Šå¤©ä¸‹äº†ä¸€å¤©çš„é›ªã€‚</p><p>æˆ‘æ˜¯éš”ç€çª—æˆ·æœ›çš„ï¼Œç›´åˆ°ç°åœ¨æˆ‘è¿˜æ²¡æœ‰çœŸæ­£è§¦æ‘¸åˆ°ä¹…è¿çš„é›ªèŠ±ã€‚ä¸€å¹´å¤šäº†ï¼Ÿæˆ–è®¸å§ã€‚æˆ‘è½»åº¦è¿‘è§†ï¼Œä½†æ˜¯ç™½å¤©åœ¨çª—è¾¹çš„ä¹¦æ¡Œæ—ä¹ ä½œæ—¶ï¼Œä¸æˆ´çœ¼é•œçš„ï¼Œè¿˜æ˜¯èƒ½çœ‹åˆ°çº·é£çš„ç™½çµ®â€”â€”è™½ç„¶æœ‰äº›æ¨¡ç³Šã€‚å®ƒä»¬ç»å¸¸æƒ³æˆ‘æŒ¥æ‰‹è‡´æ„ï¼Œæˆ‘ä¹Ÿæ»¡è¶³äº†ã€‚</p><p>â€œæƒ…äººèŠ‚å‘¢â€¦â€æˆ‘æƒ³ç€ã€‚å½“ç„¶ï¼Œäººç±»åœ¨æ€è€ƒä¸€ä»¶äº‹çš„æ—¶å€™ä¸å¯é¿å…çš„è¦è”æƒ³ï¼Œæˆ‘è”æƒ³åˆ°çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯æˆ‘æ²¡å†™å®Œä¹Ÿå‹æ ¹ä¸æƒ³å†™çš„ä½œä¸šï¼Œæ˜¯å¦‚æœæœ‰äº†æ‹äººä¹‹åè€å¸ˆä»¬çš„ç«­åŠ›åå¯¹ã€åœ¨åŒå­¦ä¸­æ˜¾å¾—é¹¤ç«‹é¸¡ç¾¤ä»¥åŠåœ¨å­¦ä¸šä¸å¤„ç†æ‹çˆ±å…³ç³»çš„æ¼©æ¶¡äº¤å‰ä¸­æŠ½ä¸å¼€èº«â€”â€”å¤§æŠµå°±æ˜¯è¿™äº›å§ã€‚æˆ‘ä¸æ•¢æƒ³äº†ï¼Œå› ä¸ºæˆ‘æƒ³åˆ°ä¸€æ¡©ç¾å¥½çš„äº‹æƒ…ï¼Œä»¿ä½›å°±ä¼šè”æƒ³åˆ°åä»¶ã€ä¸Šç™¾ä»¶ä»¤äººä¸å¯’è€Œæ —çš„äº‹æƒ…â€”â€”è¿™è®©æˆ‘æ„Ÿåˆ°ææƒ§ã€‚</p><p>é›ªçœŸç¾å•Šã€‚</p><hr>        <div id="aplayer-rbhJVjxY" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-rbhJVjxY"),            narrow: false,            autoplay: false,            showlrc: false,            music: {              title: "ç©ºã‚‚é£ã¹ã‚‹ã¯ãš",              author: "å®šèƒ½é£å‘å¤©ç©º",              url: "å¤è°·æ‹³-ç©ºã‚‚é£›ã¹ã‚‹ã¯ãš (å®šèƒ½é£å‘å¤©ç©º).mp3",              pic: "/2019/02/14/éšæƒ³äº”Â·æƒ…äººèŠ‚/ggq.jpg",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script><p>æ—©æ‹ï¼Ÿ</p><p>â€œä¸¥æ‰“ï¼â€ï¼Œ â€œå¥½å­©å­ä¸æ—©æ‹ï¼â€ï¼Œ â€œæ—©æ‹è‚¯å®šæ²¡æˆï¼Œå¥½å¥½å­¦ä¹ å§â€ï¼Œâ€œä»€ä¹ˆå¹´é¾„å°±è¯¥å¹²ä»€ä¹ˆå¹´é¾„è¯¥å¹²çš„äº‹å„¿â€â€¦â€¦</p><p>è¯´çœŸçš„ï¼Œæˆ‘å¾ˆéš¾å¯é½¿ï¼Œå“ªæ€•æ˜¯åœ¨è¦å¥½çš„æœ‹å‹é¢å‰â€”â€”å½“æˆ‘è¯´å‡ºæˆ‘å¯¹å“ªä¸ªå¥³å­©å­æœ‰å¥½æ„Ÿçš„æ—¶å€™ï¼Œæˆ‘éƒ½æ˜¯æ€¯æ€¯çš„ã€‚</p><p>ç›´åˆ°åˆšåˆšçœ‹åˆ°äº†è¿™æ ·ä¸€ç¯‡æ–‡ç« ï¼Œæ˜¯ä¸€ä¸ªç½‘ç»œä½œå®¶è‹è§ç¥ˆå†™çš„ï¼ŒæŒºæ—©çš„ä¸€ç¯‡æ–‡ç« äº†ï¼š</p><blockquote><p>å°å­¦äº”å¹´çº§çš„æ—¶å€™ï¼Œæˆ‘å–œæ¬¢ç­ä¸Šçš„ä¸€ä¸ªå¥³å­©å­ã€‚<br>é‚£æ—¶å€™æƒ³çš„å¾ˆå¤šã€‚<br>æ¯”å¦‚æœ‰ä¸€å¤©çœ‹ç”µè§†å‰§ï¼Œç”·ä¸»æ‰‘è¿‡æ¥æ›¿å¥³ä¸»æŒ¡äº†ä¸€æªï¼ŒæŒ‚äº†ã€‚<br>é‚£å¤©æˆ‘è¾—è½¬åä¾§äº†ä¸€å¤œï¼Œè´¨é—®è‡ªå·±å¦‚æœæœ‰äººç”¨æªæŒ‡ç€æˆ‘å–œæ¬¢çš„å°å¥³å­©ï¼Œæˆ‘æ•¢ä¸æ•¢æ‰‘è¿‡å»èµ´æ­»ã€‚<br>è¿™çŠ¹è±«è®©12å²çš„æˆ‘éå¸¸ç¾æ„§ã€‚æˆ‘è§‰å¾—è¿™æ ·è‡ªç§çš„æˆ‘ï¼Œä¸é…å–œæ¬¢å¥¹ã€‚<br>æˆ‘å¼€å§‹è´¨ç–‘è‡ªå·±ï¼Œæˆ‘è‡ªä»¥ä¸ºçš„å–œæ¬¢æ˜¯ä¸æ˜¯çœŸçš„åƒå¤§äººè¯´çš„é‚£æ ·ï¼Œåªæ˜¯ä¸æ‡‚äº‹çš„å°å­©é—¹ç€ç©ã€‚</p></blockquote><blockquote><p>å¦‚ä»Šæˆ‘çŸ¥é“è¿™è‡ªè´£æ¯«æ— å¿…è¦ã€‚åœ¨æ„Ÿæƒ…é‡Œé—¹ç€ç©ï¼Œè¿™äº‹å„¿åœ¨å¤§äººçš„ä¸–ç•Œé‡Œè¦æµè¡Œçš„å¤šã€‚</p></blockquote><blockquote><p>æˆ‘æƒ³å¾—å¤šè¿˜ä½“ç°åœ¨äº†åˆ«çš„æ–¹é¢ã€‚æ¯”å¦‚è€å¸ˆè¯´å¥½å¥½å­¦ä¹ ï¼Œå¯æˆ‘ä¸€ç›´ä¸æ˜ç™½ä¸ºä»€ä¹ˆã€‚<br>ä»–ä»¬çš„é‚£äº›ç†ç”±ï¼Œæ¯”å¦‚æ‰¾ä¸ªå¥½å·¥ä½œå•Šï¼Œå‡ºäººå¤´åœ°å•Šï¼Œå¬èµ·æ¥å°±å¾ˆæ— èŠï¼Œä½•å¿…å‘¢ã€‚</p></blockquote><blockquote><p>äºæ˜¯ä»åˆä¸€å¼€å§‹ï¼ŒåŸæœ¬ä¸‰å¥½å­¦ç”Ÿçš„æˆ‘æˆç»©ä¸€è½åƒä¸ˆï¼Œå‹‰å¼ºåªèƒ½ä¸Šä¸ªæœ«æµé«˜ä¸­ã€‚<br>å®¶é•¿è€å¸ˆå…¨éƒ½æ€¥æ­»äº†ï¼Œæˆ–å¨é€¼åˆ©è¯±ï¼Œæˆ–è‹¦å£å©†å¿ƒï¼Œæˆ‘ä¸€æ¦‚æ²¹ç›ä¸è¿›ã€‚å½“ç„¶ç°åœ¨çš„æˆ‘çŸ¥é“äº†è¯»ä¹¦çš„ç†ç”±ï¼Œå¯æ˜¯å›é€†æœŸçš„å°‘å¹´ä»€ä¹ˆä¹Ÿä¸æƒ³å¬ã€‚</p></blockquote><blockquote><p>åæ¥åˆä¸‰å¼€å­¦ï¼Œæˆ‘æ”¶åˆ°äº†ä¸€å°ä¿¡ã€‚<br>æ¥è‡ªé‚£ä¸ªå°å­¦æ—¶å€™å–œæ¬¢çš„å¥³å­©å­ã€‚<br>ä¿¡çš„æœ«å°¾æœ‰ä¸€å¥è¯ï¼šæˆ‘å‡†å¤‡æŠ¥è€ƒXä¸­ï¼Œä½ è¦ä¸è¦ä¸€èµ·ï¼Ÿ</p></blockquote><blockquote><p>æˆ‘çš„æ‰‹ä¸å—æ§åˆ¶åœ°é¢¤æŠ–ã€‚<br>çƒˆç„°åœ¨çµé­‚çš„æ·±å¤„ç‡ƒèµ·ï¼Œç¼äººçš„çƒ­æµªå¸­å·äº†å…¨èº«æ¯ä¸€ä¸ªç»†èƒã€‚</p></blockquote><blockquote><p>ä¸ºä»€ä¹ˆè¦è¯»ä¹¦å‘¢ï¼Ÿ<br>16å²çš„æˆ‘è·å¾—äº†å”¯ä¸€çš„ç­”æ¡ˆâ€”â€”ä¸ºäº†å’Œå–œæ¬¢çš„äººåœ¨ä¸€èµ·ã€‚<br>æˆ‘å¼€å§‹ç–¯äº†ä¸€æ ·åœ°å¤ä¹ ï¼Œæ¶è¡¥è¿™ä¸¤å¹´è½ä¸‹çš„çŸ¥è¯†ç‚¹ã€‚ä¹¦æ¡Œè¾¹ä¸Šæ”¾äº†ä¸€ç›†æ°´ï¼Œå›°äº†å°±ç”¨æ°´æ³¼è‡ªå·±çš„è„¸ã€‚<br>å¯¹äºæˆ‘ä¸€å¤œä¹‹é—´çš„å‰§å˜ï¼Œå¤§äººä»¬ä¸€ä¸ªä¸ªå–œç¬‘é¢œå¼€ï¼Œè¯´å­©å­ç»ˆäºæ‡‚äº‹äº†ã€‚<br>æ˜¯å•¦ï¼Œä»–ä»¬æ€»ä»¥ä¸ºè‡ªå·±å¾ˆæ‡‚ã€‚</p></blockquote><blockquote><p>å¾ˆå¤šäººè¯´ï¼Œå°å­©å­ä¸è¦è°ˆæ„Ÿæƒ…ï¼Œå› ä¸ºåæ­£ä¸ä¼šæœ‰ç»“æœã€‚<br>æ˜¯ï¼Œçš„ç¡®ä¸ä¼šæœ‰ç»“æœã€‚<br>å°±åƒå“ªæ€•åæ¥æˆ‘å¦‚æ„¿è€ƒä¸Šäº†Xä¸­ï¼Œè¿™ä¾ç„¶ä¸æ˜¯æŸ¯æ™¯è…¾æ²ˆä½³å®œé‚£æ ·çš„æ•…äº‹ã€‚ä»å§‹è‡³ç»ˆï¼Œæˆ‘éƒ½æ²¡èƒ½åœ¨å¥³å­©çš„äººç”Ÿé‡Œæ‰®æ¼”è¿‡å“ªæ€•ä¸€ä¸ªé…è§’ã€‚</p></blockquote><blockquote><p>å¯æ˜¯å¦‚ä»Šæˆ‘ç«™åœ¨æ—¶é—´çš„å½¼ç«¯å›æœ›ï¼Œå¦‚æœé‚£ä¸ªåå‡ å²çš„å­©å­æ²¡æœ‰çˆ±ä¸Šè¿‡ä»€ä¹ˆäººï¼Œé‚£ä¹ˆä»–ä¹‹åçš„äººç”Ÿï¼Œå°†æ— æ³•æŒ½å›åœ°æ»‘å…¥æ·±æ¸Šã€‚<br>çˆ±è¿‡ä¸€ä¸ªäººï¼Œæ˜¯æˆ‘å°‘å¹´æ—¶æœ€å¤§çš„å¹¸è¿ã€‚</p></blockquote><blockquote><p>æ‰€ä»¥ï¼Œå½“æ‰€æœ‰å¤§äººè§†æ—©æ‹ä¸ºæ´ªæ°´çŒ›å…½çš„æ—¶å€™ï¼Œæˆ‘å®Œå…¨ä¸æ•¢è‹ŸåŒã€‚è€Œå½“ä»–ä»¬è¨€ä¹‹å‡¿å‡¿åœ°è¯´â€œè°ˆæ‹çˆ±å½±å“å­¦ä¹ â€çš„æ—¶å€™ï¼Œæˆ‘æ›´åªèƒ½æŠ¥ä»¥ç™½çœ¼ã€‚<br>æ˜¯ï¼Œè°ˆæ‹çˆ±å½±å“å­¦ä¹ ã€‚åªæ˜¯å¾ˆå¤šæ—¶å€™ï¼Œè¿™â€œå½±å“â€å¯ä»¥è¢«ç§°ä¸ºâ€œæ¿€åŠ±â€ã€‚</p></blockquote><blockquote><p>æœ‰å¯èƒ½å½±å“å­¦ä¹ çš„ä¸œè¥¿å¾ˆå¤šï¼Œç”µè§†å‰§å¯ä»¥ï¼Œå°è¯´å¯ä»¥ï¼Œç³Ÿç³•çš„è€å¸ˆå’Œä¸åˆæ ¼çš„çˆ¶æ¯æ›´åŠ å¯ä»¥ã€‚è€Œåœ¨æ‰€æœ‰çš„å› å­é‡Œï¼Œæ‹çˆ±æœ€æœ‰å¯èƒ½æŠŠå›é€†çš„å°‘å¹´å˜æˆæ›´å¥½çš„äººã€‚<br>ç»“æœæ‰€æœ‰çš„å¤§äººï¼Œååç”¨å°½æ‰€æœ‰åŠ›æ°”ï¼Œæªç€è¿™æŸ„åŒåˆƒå‰‘çº ç¼ ä¸æ¸…ã€‚</p></blockquote><blockquote><p>æˆ‘ç”šè‡³æ€€ç–‘ï¼Œæ¯”èµ·é‚£äº›é«˜å¤§ä¸Šçš„â€œä¸ºä½ å¥½â€ï¼Œä»–ä»¬åªæ˜¯ææƒ§å¦ä¸€ä¸ªäººæˆä¸ºè‡ªå·±å­©å­çš„ç²¾ç¥å¯„æ‰˜ï¼Œææƒ§å­©å­è„±ç¦»è‡ªå·±çš„æŒæ§â€”â€”å’Œå©†å©†åˆéš¾åª³å¦‡çš„å¿ƒç†ç›¸åŒã€‚</p></blockquote><blockquote><p>ä»–ä»¬è½»è”‘åœ°è¯´ï¼Œå°å­©å­æ‡‚ä»€ä¹ˆæ‹çˆ±ã€‚<br>å¥½ï¼Œé‚£æˆ‘ä»¬æ¥çœ‹çœ‹å¤§äººä»¬æœ‰å¤šä¹ˆæ‡‚çˆ±æƒ…ã€‚<br>ç›¸äº²çš„ç”·å¥³å°†å„è‡ªçš„ç­¹ç æ‘†ä¸Šå¤©å¹³ï¼Œæˆ¿ï¼Œè½¦ï¼Œè¡Œä¸šï¼Œå®¶åº­ï¼Œæ”¶å…¥ï¼Œåƒä¸€åœºç­‰ä»·äº¤æ¢çš„ç”Ÿæ„ã€‚<br>å¤œåœºé‡Œä¹å£°éœ‡è€³æ¬²è‹ï¼Œç”·äººåœ¨åˆšè®¤è¯†åŠå°æ—¶çš„å¥³äººè€³è¾¹å¤§å–Šï¼Œæ˜å¤©ä¸Šåˆæˆ‘é€ä½ å›å­¦æ ¡å¥½å—ã€‚<br>å¤«å¦»äºŒäººååœ¨æ²™å‘çš„ä¸¤ç«¯ç©ç€å„è‡ªçš„æ‰‹æœºï¼Œä¸€æ™šä¸Šéƒ½æ‡’å¾—æŠ¬å¤´çœ‹å¯¹æ–¹ä¸€çœ¼ã€‚</p></blockquote><blockquote><p>æ‰€ä»¥æˆ‘ä¸€ç›´æ— æ³•ç†è§£ï¼Œæˆå¹´äººåœ¨å­©å­çš„çˆ±æƒ…é¢å‰ï¼Œé‚£ä»½ä¼˜è¶Šæ„Ÿåˆ°åº•ä»ä½•è€Œæ¥ã€‚ä»–ä»¬è¶¾é«˜æ°”æ‰¬åœ°è¯´ç€â€œå°å­©æ‡‚ä»€ä¹ˆæ‹çˆ±â€ï¼Œå´ä¸æ‹¿é•œå­ç…§ç…§è‡ªå·±çš„ä¸€åœ°é¸¡æ¯›ã€‚<br>éš¾é“ä»¥ä¸Šè¿™äº›ç”»é¢ï¼Œæ¯”ç©¿ç€æ ¡æœçš„å¥³å­©å‡è£…è·¯è¿‡çƒåœºï¼Œåªä¸ºå·çœ‹ä¸€çœ¼å–œæ¬¢çš„ç”·ç”Ÿæ‰“çƒï¼Œæ›´èƒ½ç§°ä¸ºçˆ±æƒ…ï¼Ÿ</p></blockquote><blockquote><p>è¿˜æœ‰ä¸€ç§æ¯”è¾ƒæ¸©å’Œçš„åå¯¹ï¼Œè¯´èµ·æ¥è¯­é‡å¿ƒé•¿ï¼šâ€œä½ ä»¬è¿˜å¹´è½»ï¼Œåˆ«ç€æ€¥ï¼Œè°ˆæ‹çˆ±ä»¥åæœ‰çš„æ˜¯æœºä¼šã€‚â€<br>ä»”ç»†å›æƒ³ï¼Œè¿™ç§è¿‡æ¥äººç°èº«è¯´æ³•çš„æ–¹å¼ï¼Œå¯¹å­©å­çš„ç¡®å¾ˆæœ‰è¯´æœåŠ›ã€‚å­©å­æ€»æ˜¯ç›¸ä¿¡ç¾å¥½çš„ï¼Œç›¸ä¿¡ä¹…åˆ«é‡é€¢ï¼Œç›¸ä¿¡å§»ç¼˜ä¸€çº¿ï¼Œç›¸ä¿¡åå¹´ä¹‹åæˆ‘ä»¬è‡³å°‘è¿˜æ˜¯æœ‹å‹ã€‚</p></blockquote><blockquote><p>å¯æ˜¯ï¼Œè¯·å¦‚ä»Šå·²ç»é•¿å¤§çš„å¤§å®¶é—®é—®è‡ªå·±ï¼Œå½“å¹´é­‚ç‰µæ¢¦è¦çš„é‚£ä¸ªäººï¼Œå¦‚ä»Šè¿˜åœ¨å—ï¼Ÿ<br>ä½ ä»¬æ˜¯çœŸçš„æœ‰çš„æ˜¯ä»¥åï¼Œè¿˜æ˜¯æ—©å·²ç¦»æ•£åœ¨äººæµ·ï¼Ÿ<br>è€Œåæ¥é‡åˆ°çš„é‚£äº›äººï¼ŒçœŸèƒ½æ¨¡ç³Šäº†åå…­å²ç•™åœ¨å¿ƒé‡Œçš„çœ‰çœ¼å—ï¼Ÿ</p></blockquote><blockquote><p>å¾ˆä¹…ä»¥åæˆ‘ä»¬ç»ˆäºçŸ¥é“ï¼Œå¤§äººéƒ½åœ¨è¯´è°ã€‚<br>å°‘å¹´çš„é”™è¿‡æ˜¯ä¸€ç”Ÿçš„æ±‚ä¸å¾—ï¼Œæ˜¯å“ªæ€•åŠŸæˆåå°±å’Œå¯Œå¯æ•Œå›½éƒ½æ— æ³•æŒ½å›çš„é—æ†¾ã€‚æˆ–è®¸æœªæ¥çš„ä½ é£å…‰æ— é™ï¼Œå¯ä½ æ°¸è¿œæ— æ³•é€†è½¬æ—¶é—´ã€‚æ²¡æœ‰ä»€ä¹ˆâ€œæœ‰çš„æ˜¯æœºä¼šâ€ï¼Œé”™è¿‡æ­¤åˆ»ï¼Œå°±æ˜¯é”™è¿‡ä¸€ç”Ÿã€‚</p></blockquote><blockquote><p>å¦‚æœæœ‰è¿˜åœ¨ä¸Šå­¦çš„è¯»è€…çœ‹åˆ°è¿™é‡Œï¼Œè¯·è®°ä½ï¼Œäººç”Ÿæ²¡æœ‰é‚£ä¹ˆå¤šä»¥åã€‚<br>æœ‰å–œæ¬¢çš„äººå°±å»è¿½ï¼Œä½ ä¸è¿½ä¸Štaï¼Œåˆ†ç¦»å°±ä¼šè¿½ä¸Šä½ ï¼Œæ²¡æœ‰ä¾‹å¤–ã€‚å½“ç„¶å•¦ï¼Œä¸ºäº†ä½ ä»¬çš„æ‰‹èƒ½ç‰µå¾—ä¹…ä¸€äº›ï¼Œæˆç»©ä¸€å®šä¸èƒ½è½ä¸‹ã€‚</p></blockquote><blockquote><p>è‡³äºé‚£äº›ä¹‰æ­£è¾ä¸¥æ£’æ‰“é¸³é¸¯çš„é•¿è¾ˆâ€¦â€¦ç›¸ä¿¡æˆ‘ï¼Œåå¹´åä»–ä»¬ä¸ä¼šç†ä¼šä½ çš„é—æ†¾å’Œæ€…æƒ˜ï¼Œä»–ä»¬ä¼šå‚¬ä½ éšä¾¿æ‰¾ä¸ªäººç»“å©šï¼Œå¹¶ä¸”ä¸æ¯«ä¸è§‰å¾—åœ¨æ‰“è‡ªå·±çš„è„¸ã€‚</p></blockquote><blockquote><p>æˆ‘æœ‰ä¸ªæœ‰ç‚¹å„¿ä¸§çš„æœ‹å‹ï¼Œå«å°æ€ªã€‚å…³äºå°‘å¹´çš„çˆ±æ‹ä»–è¯´è¿‡ä¸€æ®µè¯ï¼Œæˆ‘è§‰å¾—æˆ‘ä¸èƒ½è¯´å¾—æ›´å¥½äº†ï¼Œå€ŸèŠ±çŒ®ä½›é€ç»™å¤§å®¶ã€‚</p></blockquote><blockquote><p>â€ å¾ˆå¤šäººå³ä½¿åªè§è¿‡ä¸€é¢ï¼Œå·²ç»ç®—è§è¿‡äº†æœ€åä¸€é¢ã€‚â€œ</p></blockquote><blockquote><p>åå…«å²å‰ä¸æ—©æ‹ï¼Œè¿™è¾ˆå­éƒ½æ¥ä¸åŠæ—©æ‹ã€‚<br>ä½ çš„äººç”Ÿçœ‹èµ·æ¥å¾ˆé•¿ï¼Œæ¯ä¸€ç§’éƒ½æ— æ³•æŒ½å›ã€‚</p></blockquote><p>è™½ç„¶ä¸æ’é™¤æœ‰â€œç«™ç€è¯´è¯ä¸è…°ç–¼â€çš„å«Œç–‘ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™æˆ–è®¸æé†’äº†æˆ‘ä»€ä¹ˆã€‚</p><p>æˆ‘ä»Šå¤©åœ¨è¿™é‡Œå¯ä»¥å¼€è¯šå¸ƒå…¬åœ°è·Ÿå„ä½è®²æˆ‘æ‰€è°“çš„â€æ„Ÿæƒ…ç»å†â€œï¼Œâ€å¿ƒè·¯å†ç¨‹â€œã€‚</p><p>å½“ç„¶ï¼Œä¹Ÿæ˜¯ç»™æˆ‘è‡ªå·±è®²ã€‚</p><p>å…³äºè¿™ä»¶äº‹ï¼Œæˆ‘ä¸€ç›´çº ç»“çš„å¾ˆã€‚å› ä¸ºèº«æ—æˆ–è®¸æœ‰äº†å–œæ¬¢çš„å¥³ç”Ÿï¼Œä½†æ˜¯æˆ–å› ä¸ºå¥¹æœ‰ç”·æœ‹å‹äº†ï¼Œæˆ–å› ä¸ºåˆ«çš„ä»€ä¹ˆåŸå› ï¼Œæˆ‘ä¸èƒ½å¾ˆé¡ºåˆ©åœ°å®ç°ã€‚æ˜¯åšæŒå‘¢ï¼Œè¿˜æ˜¯ä¸åšæŒå‘¢ï¼Ÿæˆ‘ä¸çŸ¥é“ã€‚ä»¥å‰åœ¨åˆä¸­ï¼Œé‡åˆ°ä¸€ä¸ªå¥³å­©å°±ç—´ç—´åœ°è§‰å¾—å¯ä»¥æºæ‰‹ä¸€ç”Ÿï¼Œä½†æœ€åå´æ˜¯è¿ç‰µæ‰‹çš„æœºä¼šéƒ½æ²¡æœ‰ã€‚</p><p>ç°åœ¨ä¸ä¸€æ ·äº†å§ï¼Œä¸€ç”Ÿï¼Œå¤šé•¿å•Šã€‚</p><p>æˆ‘æ˜¯åœ¨æ‹…å¿ƒè¿™ä¸ªå—ï¼Ÿæˆ‘ä¹Ÿä¸çŸ¥é“ã€‚å¤§æ¦‚æ˜¯ä»æ¥æ²¡æœ‰ä»€ä¹ˆäººæ”¯æŒè¿‡æˆ‘ï¼ŒåŒ…æ‹¬æˆ‘è‡ªå·±ï¼Œä¹Ÿä»æ¥æ²¡æœ‰æ”¯æŒè¿‡æˆ‘è‡ªå·±ã€‚</p><p>æ²¡æèµ·è¿™ä»¶äº‹ï¼Œé‡è§å¥¹ï¼Œæ€»ä¼šæ„Ÿè§‰å†…å¿ƒæ— æ¯”çº ç»“ï¼Œä¼šå› ä¸ºå¥¹ä¸€é¢¦ä¸€ç°‡å¿ƒé‡Œç¿»è…¾å¥½ä¹…ï¼Œä¹Ÿä¼šå› ä¸ºå…¶ä»–çš„åŸå› æ„Ÿåˆ°ç•¥ç•¥å‹æŠ‘ã€‚å¥½åƒæˆ‘å·²ç»æŠŠå¥¹å½“æˆäº†ä»€ä¹ˆæ´ªæ°´çŒ›å…½ã€‚å› è€Œæˆ‘ä¹Ÿå¸¸å¸¸çº ç»“ä¸å·²ã€‚</p><p>ç­‰ä¼šå„¿ï¼Œéš¾é“æ¯å¤©çº ç»“çš„è¦æ­»å°±æ˜¯æˆ‘æƒ³è¦çš„å—ï¼Ÿç†æ€§åˆ†æä¸€ä¸‹ï¼Œæˆ‘æƒ³è¦å¥¹æˆä¸ºæˆ‘çš„æ‹äººæ˜¯æˆ‘å–œæ¬¢å¥¹çš„å¿…ç„¶ç»“æœï¼Œä½†æ˜¯è¿™ä¸¤ç§çŠ¶æ€æˆ‘çœŸçš„å¯ä»¥æƒè¡¡çš„å¾ˆå¥½å—ï¼Ÿæ¢å¥è¯è¯´ï¼Œæˆ‘å…³äºå¥¹çš„çš„å–œæ€’å“€ä¹è¿˜æ˜¯å› ä¸ºæˆ‘å–œæ¬¢å¥¹å—ï¼Ÿ</p><p>ä¸ï¼Œæˆ‘è§‰å¾—ä¸æ˜¯ã€‚</p><p>æˆ‘æ˜¯åœ¨äºµæ¸ä¸€ç§æ„Ÿæƒ…ï¼Œæ˜¯åœ¨ä¾®è¾±ä¸€ä¸ªäººã€‚</p><p>çˆ±ä»æ¥éƒ½æ˜¯æ— ç§åœ°ä»˜å‡ºï¼Œè€Œä¸æ˜¯æ‹¼å‘½çš„å æœ‰å•Šã€‚</p><p>æˆ‘ä»¿ä½›æŠŠå¥¹å½“åšäº†ä¸€ç§å•†å“ï¼Œä¸€ç§ååˆ†æƒ³å¾—åˆ°æ‰‹çš„å•†å“ã€‚æˆ‘ç°åœ¨ä¼šå±•ç°ç»™è‡ªå·±ã€ä¹Ÿå±•ç°ç»™å…¶ä»–äººä¸€å‰¯ååˆ†æ¸´æ±‚ã€ååˆ†çœŸè¯šçš„é¢å­”ï¼Œæˆ–è®¸ä¹Ÿä¸è¿‡æ˜¯å¸Œæœ›å¾—åˆ°å¥¹çš„ä¸€ç§æ‰‹æ®µã€‚å½“æˆ‘ä»¬çœŸæ­£å±äºå½¼æ­¤åï¼Œæˆ‘ä¸èƒ½ä¿è¯åœ¨é‚£å±‚çš®æ’•å¼€ä¹‹åï¼Œæˆ‘è¿˜ä¼šä¸€å¦‚æ—¢å¾€åœ°çæƒœè¿™ä»½æƒ…æ„«ï¼Œä½ ä¹Ÿä¸èƒ½ä¿è¯ï¼ŒåŒæ ·ï¼Œå¥¹ä¹Ÿä¸èƒ½ä¿è¯ã€‚</p><p>ä½ çœ‹ï¼Œå°±è¿™ä¹ˆç‚¹å„¿äº‹æƒ…æˆ‘çº ç»“äº†è¿™ä¹ˆé•¿çš„ç¯‡å¹…ã€‚ä»€ä¹ˆçº ç»“å•Šï¼Œå æœ‰å•Šï¼ŒçœŸçˆ±å•Šï¼Œä¸€ç”Ÿå•Šï¼Œ</p><p>éƒ½ä¸è¿‡æ˜¯æ‹¼å‘½åœ°æƒ³è¢«çˆ±è€Œå·²ã€‚</p>        <div id="aplayer-HbiQvKcv" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-HbiQvKcv"),            narrow: false,            autoplay: false,            showlrc: false,            music: {              title: "clammbon-ã‚½ãƒŠã‚¿",              author: "(å¥é¸£æ›²)",              url: "clammbon-ã‚½ãƒŠã‚¿ (å¥é¸£æ›²).mp3",              pic: "/2019/02/14/éšæƒ³äº”Â·æƒ…äººèŠ‚/zmq.jpg",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script><hr><p>ä¸çŸ¥é“ç°åœ¨çœ‹åˆ°è¿™å„¿çš„ä½ æ˜¯å¦å’Œæˆ‘ä¸€æ ·å­¤ç‹¬ï¼Ÿå­¤ç‹¬å¹¶ä¸æ˜¯æ¯ä¸ªäººéƒ½æœ‰çš„æƒ…æ„Ÿï¼Œæœ‰äº›äººï¼Œå¾ˆå¤šäººä»æ¥éƒ½ä¸ä¼šæ„Ÿåˆ°å­¤ç‹¬â€”â€”æˆ‘å¤šç¾¡æ…•ä»–ä»¬å•Šâ€¦â€¦</p><p>å­¤ç‹¬ï¼Œæˆ–è®¸ä¹Ÿæ˜¯å¦ä¸€ç§ç¨‹åº¦ä¸Šçš„çº¯ç²¹ã€‚æˆ‘è‡³ä»Šä»è§‰å¾—æˆ‘æœ‰ç€æœ€çº¯ç²¹çš„æ„Ÿæƒ…ï¼Œæ˜¯å°‘å¹´ä¸€æ ·çš„æ„Ÿæƒ…ï¼Œä¸æ˜¯å‘å‚æš®è€äººä¸€æ ·çš„ã€åªå¯ç‹¬è‡ªæ€€å¿µçš„æƒ…æ„Ÿã€‚è¿™ç§æ„Ÿæƒ…æ˜¯çƒ­åˆ‡çš„ã€ç”ŸåŠ¨çš„ã€‚</p><p>æˆ‘å¾ˆå–œæ¬¢ä¸€é¦–åˆå”±æ›²ç›®ï¼Œå«åšâ€æˆ‘å–œæ¬¢â€œã€‚æ­Œè¯ååˆ†åŠ¨äººï¼Œæ—‹å¾‹ä¼˜ç¾åŠ¨å¬ï¼Œæ¾å¼›æ°åˆ°å¥½å¤„ã€‚</p><p>ä¸‹é¢æ˜¯æ­Œè¯ï¼š</p><blockquote><p>æˆ‘å–œæ¬¢æš–å†¬çš„å¤ªé˜³<br>æˆ‘å–œæ¬¢åˆæ˜¥çš„é’è‰<br>æˆ‘å–œæ¬¢åˆåçš„åº­é™¢å’Œä¸€æ—å‘å‘†çš„ç§‹åƒ<br>æˆ‘å–œæ¬¢ä»²å¤çš„å†°æ²™<br>æˆ‘å–œæ¬¢æ¸…ç§‹çš„æ˜æœˆ<br>è‰¯å®µçš„å¤œç©º æ¼«å¤©æ˜Ÿè¾°<br>æˆ‘å–œæ¬¢é›¨åçš„é’è›™<br>æˆ‘å–œæ¬¢å±±å‰çš„æ<br>æˆ‘å–œæ¬¢å‘¨ä¸‰çš„å‚æ™šè¢«éœå…‰äº²å»çš„æ°´æ—é¦†<br>æˆ‘å–œæ¬¢æˆç¾¤çš„é‡<br>æˆ‘å–œæ¬¢å‡Œä¹±çš„ä¹¦æ¶<br>æ¸…é£çš„éœ²å°è¿œå¤„çš„ç¯æµ·<br>æˆ‘å–œæ¬¢ èµ°åœ¨æ— äººçš„ä¹åå…­å·å…¬è·¯<br>æˆ‘å–œæ¬¢ æœ¨æ‘æ‹“å“‰é•¿é•¿çš„å¤´å‘<br>æˆ‘å–œæ¬¢ æ— å°½ç”°é‡ä¸Šå¥”è·‘çš„éº‹é¹¿<br>æˆ‘å–œæ¬¢ å¤–å©†é—¨å‰çš„æ¦•æ ‘<br>æˆ‘å–œæ¬¢æ¯äº²çš„ä¾¿å½“<br>å–œæ¬¢çˆ¶äº²çš„èƒ¡æ¸£<br>æˆ‘å–œæ¬¢å…«æœˆçš„å¤œæ™šè¿˜åœ¨è¥ä¸šçš„æ¸¸ä¹åœº<br>æˆ‘å–œæ¬¢æ”¾å­¦çš„é“ƒé“›<br>æˆ‘å–œæ¬¢åœç”µçš„å¤œæ™š<br>ç‚¹ä¸€å¯¹èœ¡çƒ› åœ¨å¹½é™çš„ç„å…³<br>æˆ‘å–œæ¬¢ åŸå¸‚å°½å¤´é‚£è¿œè¿œçš„é’å±±<br>æˆ‘å–œæ¬¢ çƒ­æ°”çƒé£ä¸Šè¥¿è¾¹çš„å¤©ç©º<br>æˆ‘å–œæ¬¢ æ¸…æ™¨çš„çŸ³æ¿è·¯<br>é›¾è…¾è…¾çš„æ—©é¤åº— é˜¿å…¬çš„æ¡‚èŠ±ç³•<br>æˆ‘å–œæ¬¢ æ¯ä¸€æœµæš®äº‘ æ¯ä¸€æ ªç»¿æ ‘<br>æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“<br>æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“</p></blockquote><p>ä¼˜ç¾çš„æ—‹å¾‹ï¼Œé…ä¸Šæœ€åä¸¤å¥ç”œç”œçš„å‘Šç™½ã€‚æˆ–è®¸æˆ‘ä»¬å¼€æ¥ï¼Œä¼¼ä¹æœ‰ç‚¹æ‰­æâ€”â€”æ‰¯è¿™ä¹ˆå¤šåªä¸ºäº†è¡¨è¾¾æœ€åä¸¤å¥â€”â€”</p><blockquote><p>æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“.</p><p>æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“ã€‚</p></blockquote><p>å¾ˆå¹³å¸¸ï¼Ÿç¡®å®å¾ˆå¹³å¸¸ã€‚ä½†æ˜¯æˆ‘è®¤ä¸ºè¿™ä¸¤å¥æ°åˆ°å¥½å¤„ã€‚å‰é¢å¤§æ®µå¤§æ®µçš„é“ºå«ï¼Œå™è¿°äº†è®¸è®¸å¤šå¤šç¾å¥½ã€æ¬é™çš„äº‹ç‰©ï¼Œä½†æ˜¯è¿™ä¸€åˆ‡æˆ–è®¸éƒ½æ¯”ä¸è¿‡ä½ ã€‚</p><p>ä½ å¯ä»¥æƒ³è±¡ï¼Œåœ¨ä¸€ç‰‡åŠ¨äººçš„å¤•é˜³ä¸‹ï¼Œå¤©ç©ºä¸­æ˜¯å¤§ç‰‡å¤§ç‰‡çš„å¥¶èŒ¶çº¢ï¼Œä¸€ä¸ªæ†¨æ†¨çš„å¤§ç”·å­©ï¼Œçªç„¶å«ä½ä½ ï¼Œçº¢ç€è„¸è·‘åˆ°ä½ é¢å‰ï¼Œæ‹¿ç€çš±çš±å·´å·´çš„ç¨¿å­ï¼Œé¢¤é¢¤åœ°æœ—è¯µç€è¿™äº›â€”â€”ä»–å®åœ¨å¤ªåŠ¨æƒ…äº†ï¼Œå¿µç€å¿µç€çªç„¶å£°è°ƒæ”¾é«˜ï¼Œå£°éŸ³å˜å¤§â€”â€”ä»–æ˜¯æ‰“å¿ƒçœ¼é‡Œå–œæ¬¢ä½ ï¼Œè¶Šè¯»è¶Šæœ‰æ„Ÿæƒ…ï¼Œè¶Šè¯»ä»–è¶Šè‡ªä¿¡â€”â€”ä½†æ˜¯çªç„¶ä»–åˆç•ç¼©èµ·æ¥ï¼Œå£°éŸ³ä½ä½åœ°å‘ä½ è¯´å‡ºäº†æœ€åä¸€å¥æœ€åŠ¨äººçš„è¯ï¼šâ€æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“â€œã€‚</p><p>æœ‰å¯èƒ½ä½ æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„æ„Ÿè§‰ï¼Œä½†åœ¨æˆ‘å¿ƒé‡Œï¼Œè¿™å°±æ˜¯æœ€çº¯ç²¹çš„ä¸œè¥¿â€”â€”æ˜¯ä¸å¥¢æ±‚çš„æœ´å®çš„çˆ±ï¼Œæ˜¯ä¸è€ƒè™‘ç‰©è´¨åªæ‹¿ææ„Ÿæƒ…çš„çˆ±ï¼Œæ˜¯æ— è¯­å‡å™ä½†å¿ƒä¸­é‡å¤åƒåƒä¸‡ä¸‡æ¬¡çš„çˆ±ï¼Œæ˜¯çœŸæŒšçš„çˆ±â€”â€”è¿™æ˜¯å±äºæˆ‘ä»¬è¿™ä¸ªå¹´çºªæœ€ç¾å¥½çš„ä¸œè¥¿ï¼Œè™½ç„¶æœ‰å­¦ä¸šç¹å¿™ç­‰è¯¸å¤šå› ç´ é˜»æŒ ï¼Œæ— æ³•å®Œæ•´åœ°å¾—åˆ°â€”â€”ä½†æˆ–è®¸åªæ˜¯ä¸€ç‰‡ã€ä¸¤ç‰‡è¿™æ ·çš„æœ‰ç€äº®æš–è‰²è°ƒçš„æ«å¶ï¼Œå°±å¯ä»¥ç‚¹äº®ä¸€æ•´ç‰‡æ¯è´¥çš„æ«æ—ã€‚</p><p>æˆ‘å¤§æ¦‚åœ¨å¬è¿™é¦–æ­Œä¹‹å‰ï¼Œä»æ¥æ²¡æœ‰çœŸæ­£çŸ¥é“åŸæ¥â€å–œæ¬¢â€œè¿™ä¸ªå·²ç»çƒ‚å¤§è¡—çš„è¯ã€è¿™ä¸ªç°å¦‚ä»Šå¯ä»¥éšä¾¿è¯´å‡ºå£åˆå¯ä»¥éšä¾¿å¿˜è®°çš„è¯ã€è¿™ä¸ªåœ¨æˆ‘ä¸Šè¿‡çš„æ‰€æœ‰å­¦æ ¡é‡Œä»æ¥æ²¡æœ‰äººæ•¢å…‰æ˜æ­£å¤§è¯´å‡ºæ¥çš„è¯ã€è¿™ä¸ªç°åœ¨åœ¨èŠ¸èŠ¸ä¼—ç”Ÿä¸­å·²ç»è¢«ç·æ±¡çš„ã€è¢«äººä»¬è®¤ä¸ºè¿˜æ²¡æœ‰ä¸€å—é’±æ¥çš„å®åœ¨çš„è¯ï¼Œç«Ÿç„¶å¦‚æ­¤çš„å¯çˆ±ï¼Œç«Ÿç„¶å¦‚æ­¤çš„å€¼å¾—äººä»¬å°Šæ•¬ï¼Œç«Ÿç„¶å¯ä»¥åœ¨å†°å†·çš„å¯’å¤œæ•£å‘å‡ºå¦‚æ­¤è€€çœ¼çš„å…‰èŠ’ã€‚</p><p>æˆ‘å–œæ¬¢ä½ ï¼Œä½ åº”è¯¥ï¼Œä¹ŸçŸ¥é“ã€‚</p>        <div id="aplayer-VpSpPhdG" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-VpSpPhdG"),            narrow: false,            autoplay: false,            showlrc: false,            music: {              title: "æˆ‘å–œæ¬¢",              author: "å½©è™¹åˆå”±å›¢",              url: "ä¸Šæµ·å½©è™¹å®¤å†…åˆå”±å›¢-æˆ‘å–œæ¬¢ (åˆå”±ç‰ˆ).flac",              pic: "/2019/02/14/éšæƒ³äº”Â·æƒ…äººèŠ‚/wxh.jpg",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script><hr><p>å¿ƒåœ¨æµæµªçš„äººå•Šï¼Œåœ¨è¿™åç¯éè¡—çš„æƒ…äººèŠ‚ï¼Œä½ æ˜¯å¦ä¹Ÿè·Ÿæˆ‘ä¸€æ ·ï¼Œè·Ÿè‡ªå·±çš„çµé­‚å½¢å½±ç›¸åŠå‘¢ï¼Ÿ</p><p>å¦‚æœä½ å·²ç»æœ‰äº†å¿ƒä¸Šäººï¼Œæˆ‘ç¥ç¦ä½ ï¼›å¦‚æœä½ å·²ç»æœ‰äº†æ‰“ç®—æºæ‰‹ä¸€ç”Ÿçš„äººï¼Œæˆ‘ä¹Ÿç¥ç¦ä½ ã€‚å”¯æœ‰é‚£äº›éƒ½å¸‚é‡Œæœ€è§’è½çš„å­¤ç‹¬è€…ï¼Œæˆ‘ä»¬çš„é‚‚é€…æˆ–è®¸æ˜¯ä¸€ç§ç¼˜åˆ†å§ï¼Œæˆ–è®¸æˆ‘ä»¬ç´ æœªè°‹é¢ï¼Œæˆ–è®¸æˆ‘ä»¬å¹¶ä¸ç†Ÿè¯†ï¼Œä½†åœ¨è¿™æµå…‰æ å½±çš„æ¼†é»‘å¤œç©ºä¸‹ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½è·¨è¿‡ä¸€åˆ‡ï¼Œè·¨è¿‡æ—¶é—´â€”â€”çœ‹è¿™ç¯‡æ–‡ç« æ—¶çš„ä½ ï¼Œä¼¸å‡ºä½ çš„å³æ‰‹ï¼Œæˆ–è®¸å°±å¯ä»¥è·Ÿåœ¨è¿™ä¸€æ™šä¼æ¡ˆæ²‰æ€å†™ä¸‹è¿™ç¯‡æ–‡ç« çš„æˆ‘ï¼Œè½»è½»å‡»æŒï¼Œæ„Ÿå—å¯¹æ–¹çš„ä½“æ¸©ä¸çµé­‚ã€‚</p><p>æˆ‘ä¼¸å‡ºæ‰‹äº†å•Šï¼Œä½ å‘¢ï¼Ÿå—¯â€¦æŠ±æ­‰å•¦ï¼Œæˆ‘æ‰‹ä¸­ä»Šå¤©æ²¡æœ‰çº¢ç«ç‘°å¯ä»¥é€ä½ ã€‚è¿™ç¿©é£çš„é›ªèŠ±ï¼Œå°±å½“åšæ˜¯æˆ‘é€ä½ æœ€å¥½çš„ç¤¼ç‰©å§ã€‚</p><p>ç›¸ä¿¡æˆ‘ï¼Œè¿™ä¸ªä¸–ç•Œä¸Šç»å¯¹æœ‰äººå·å·åœ°çˆ±ç€ä½ ï¼Œå³ä½¿ä½ è§‰å¾—è‡ªå·±å¾ˆä¸å ªã€‚æ¯”å¦‚ä½ ç­é‡Œçš„æŸä¸ªäººï¼Œæ¯”å¦‚ä½ å¯¹é—¨ï¼Œæ¯”å¦‚ä½ åŒäº‹ï¼Œæ¯”å¦‚ä½ çš„åæ¡Œï¼Œæ¯”å¦‚ï¼Œæˆ‘ã€‚</p><p>$19/2/14$ </p><hr><p>æœ¬æ¥æ‰“ç®—è¿™ç¯‡æ°´æ–‡å°±è¿™ä¹ˆç»“æŸï¼Œç•™ä¸‹ä¸€ä¸ªæ¸©é¦¨é¸¡æ±¤ç»“å°¾ï¼ŒæŒºå¥½çš„ã€‚ä½†çªç„¶æƒ³äº†æƒ³ï¼Œè‡ªå¤ä»¥æ¥èƒ½ç»™äººç•™ä¸‹å°è±¡çš„ä»æ¥ä¸æ˜¯å–œå‰§ç»“å°¾ï¼ŒçŸ­æš‚çš„æ¬¢æ„‰ä¼šè®©äººå¿˜è®°ã€‚</p><p>é‚£ä¹ˆå°±è¡¥ä¸€ä¸ªæ·±æ²‰ä¸€ç‚¹çš„ç»“å°¾å§ã€‚</p><p>æˆ‘ä¸€ç›´ä¸çŸ¥é“æˆ‘ç°åœ¨æœ‰å¥½æ„Ÿçš„é‚£ä¸ªäººï¼Œç©¶ç«Ÿæ˜¯è‡ªå·±æ„è¯†æµå¼ºåŠ çš„ï¼Œè¿˜æ˜¯çœŸçš„å‘è‡ªå†…å¿ƒçš„å–œæ¬¢ã€‚æˆ‘çº ç»“ã€‚æˆ‘æ— æ³•çŸ¥é“å°†æ¥æ˜¯å¦ä¼šé‡åˆ°ä¸€è§é’Ÿæƒ…çš„äººâ€”â€”æˆ‘å¸Œæœ›è¿™æ ·ï¼Œè€Œä¸æ˜¯ä¸ºäº†æ•è·çˆ±æƒ…è€Œå»æ•è·å¾—æ¥çš„æ„Ÿæƒ…ã€‚æˆ‘æƒ¶æã€‚</p><p>ä½†å…¶å®æ²¡å‡†æ‰€è°“ä¸€è§é’Ÿæƒ…+ä¿®æˆæ­£æœä¸€ç›´æ˜¯æ–‡å­¦ä½œå“é‡Œé¢ç”¨æ¥æŠ“è¯»è€…çœ¼çƒçš„å·¥å…·è€Œå·²ï¼Œå¤§å®¶æˆ–è®¸éƒ½ä¸å¯èƒ½æ‰¾åˆ°è‡ªå·±çš„â€œæœ€çˆ±â€ï¼Œåªèƒ½æ‰¾åˆ°ä¸€ä¸ªâ€œå·®ä¸å¤šâ€ï¼Œè¿›è€Œä¸æ–­åœ°ç£¨åˆï¼Œç›´è‡³ç£¨æˆâ€œæœ€çˆ±â€ã€‚ä½†è¿™æ ·çš„æƒ…èŠ‚ï¼Œè¯´ä»€ä¹ˆéƒ½ä¸ä¼šè®©äººæ»¡æ„å§â€¦â€¦</p><p>è·¯åœ¨å“ªå‘¢ï¼Ÿå½¼å²¸åˆåœ¨å“ªå‘¢ï¼Ÿæˆ‘å·²ç»å—å¤Ÿä¸€ä¸ªäººå½¢å½±ç›¸åŠçš„å­¤ç‹¬ç”Ÿæ´»äº†ï¼Œä½†åœ¨è¿™æµ©å¦‚çƒŸæµ·çš„æ±‚å­¦ä¹‹æ—…ä¸­ï¼Œä¼¼ä¹æ¥å—å­¤ç‹¬ã€ä½“å‘³å­¤ç‹¬ã€å¹¶æœ€ç»ˆçƒ­çˆ±å­¤ç‹¬æ‰æ˜¯æœ€å¥½çš„æ³•å­å§ã€‚</p><p>å¯æ˜¯é¢å¯¹ç€æ— å¥ˆçš„æ˜å¤©çš„æˆ‘ï¼Œä»€ä¹ˆéƒ½ä¸èƒ½åšã€‚</p><hr><p>é›ªï¼Œç»ˆäºåœäº†å•Šã€‚ç°åœ¨å·²ç»åˆå¤œäº†ï¼Œè¡—ä¸Šä¸€ä¸ªäººéƒ½æ²¡æœ‰ï¼Œå¤©ç©ºåœ¨ç§¯é›ªçš„æ˜ ç…§ä¸‹ï¼Œæ˜¯è®©äººç€è¿·çš„ç´«çº¢è‰²ã€‚</p>        <div id="aplayer-ZGOtuBpv" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-ZGOtuBpv"),            narrow: false,            autoplay: false,            showlrc: false,            music: {              title: "é‡è§",              author: "å­™ç‡•å§¿",              url: "å­™ç‡•å§¿-é‡è§.flac",              pic: "/2019/02/14/éšæƒ³äº”Â·æƒ…äººèŠ‚/yj.jpg",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script>]]></content>
    
    <summary type="html">
    
      åˆæ˜¯ä¸€å¹´æƒ…äººèŠ‚å•Šã€‚
    
    </summary>
    
      <category term="Life" scheme="http://www.orchidany.cf/categories/Life/"/>
    
    
      <category term="éšæƒ³/ä¸‹ä¸‹ç¬”" scheme="http://www.orchidany.cf/tags/%E9%9A%8F%E6%83%B3-%E4%B8%8B%E4%B8%8B%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>2018-2019èµ›å­£æœ€åçš„éšæƒ³/NOIP2018æ¸¸è®°Â·å¯ç¤ºå½•</title>
    <link href="http://www.orchidany.cf/2019/02/14/%E9%9A%8F%E6%83%B3%E4%B8%89%C2%B7NOIP/"/>
    <id>http://www.orchidany.cf/2019/02/14/éšæƒ³ä¸‰Â·NOIP/</id>
    <published>2019-02-14T14:11:50.000Z</published>
    <updated>2019-03-10T08:14:54.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>â€œéšæƒ³â€ç³»åˆ—ç´¢å¼•ï¼š<a href="http://www.orchidany.cf/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/">æˆ³æˆ‘</a></p><hr><p>ä»–çœ‹ç€çœ¼å‰çš„å±å¹•ï¼Œé™é™åœ°å‘å‘†ã€‚</p><p>ä»–ä¸çŸ¥é“è¿æ¥ä»–çš„å°†ä¼šæ˜¯ä»€ä¹ˆï¼Œåå¤©çš„$\rm{NOIp}$ç»ˆç©¶æ˜¯ä¸ªè°œã€‚</p><p>åˆšåˆšç»™æœºæˆ¿é‡Œå…¶ä»–äººè®²å®ŒæœŸæœ›çš„ä»–ï¼Œæ‰“å¿ƒåº•è§‰å¾—è‡ªå·±æ²¡æœ‰è®²å¥½ï¼Œä½†æ•ˆæœä¼¼ä¹è¿˜å¯ä»¥ã€‚</p><p>â€œå¸Œæœ›åˆ«è€ƒæœŸæœ›å§ï¼Œå˜¿å˜¿â€¦â€¦â€ä»–å¿ƒé‡Œè¿™ä¹ˆæƒ³ç€ã€‚</p><p>æ™šä¸Šï¼Œä»–ä¸€ç›´åœ¨è¡¥ä»–å‡ºçš„é¢˜çš„é”…ã€‚é¸½äº†è¿™ä¹ˆä¹…ï¼Œä¹Ÿè¯¥å†™ä¸€å†™é¢˜è§£äº†å•Šã€‚</p><p>ä»–ä¸çŸ¥é“æ˜¯å¦è¯¥å‘èº«æ—çš„åŒåƒšä»¬ä¸€æ ·ç»§ç»­æ‰“æ¿å­â€”â€”ä¸Šåˆæ‰“çš„æ¿å­è®©ä»–å¾ˆæ»¡æ„ï¼Œè™½ç„¶éƒ½æ˜¯å¾ˆç®€å•çš„ä¸œè¥¿ï¼Œä½†æ˜¯ä»–å´è§‰å¾—è‡ªå·±å†™çš„å¾ˆç²¾å½©ï¼Œéƒ½æ˜¯ä¸€é$AC$ã€‚å¤§æ¦‚è¿™æ ·ï¼Œä»–è§‰å¾—ä¼¼ä¹æ²¡ä»€ä¹ˆé—®é¢˜ã€‚</p><p>ä»ä¸‹åˆå°±å¼€å§‹æœ‰ç©ºè°ƒæš–é£äº†ï¼Œè¿™å€’æ˜¯è®©ä»–ååˆ†æ¬£å–œã€‚å‰å‡ å¤©ï¼Œæˆ–è€…è¯´æ˜¨å¤©ï¼Œåœ¨æœºæˆ¿ç©¿ç€åšåšçš„ç¾½ç»’æœï¼Œæ‰‹é¢¤æŠ–ç€ï¼Œè„‘è¢‹ååˆ†æ˜æ²‰åœ°æ‰“ä»£ç ï¼Œä»–ä¸æ„¿æ„å†å›æƒ³èµ·è¿™äº›ã€‚</p><hr><p>æ—©ä¸Šååˆ†ç€æ€¥åœ°ä¹°äº†æ—©é¥­ï¼Œä¹‹å‰åƒå­¦æ ¡é‡Œçš„ç¾Šæ±¤éƒ½åƒçš„æ˜¯ç¾Šæ‚æ±¤ï¼Œä»Šå¤©å†³å®šå°è¯•ä¸€ä¸‹è´µä¸‰å—é’±çš„ç¾Šè‚‰æ±¤çš„ä»–æ„Ÿåˆ°å¾ˆå¤±æœ›â€”â€”ç¾Šè‚‰åˆè‚¥åˆè…»åˆè†»è…¥ã€‚ä»–ä¸€ç‚¹æ²¡åƒï¼Œä¹°äº†ä¸€å—è„†é¦™ç±³å°±èµ°å‡ºäº†é£Ÿå ‚ã€‚å»å¥¥èµ›å®¤æ”¶æ‹¾äº†ä¸€ä¸‹ä¸œè¥¿ï¼Œæœ¬æ¥è¿˜æƒ³ç¦»çº¿ä¸‹æ¥å‡ é›†æœ€è¿‘åœ¨è¿½çš„ç•ªå‰§ï¼Œæ‰å‘ç°åŸæ¥$\rm{Bilibili}$æ²¡æœ‰$Mac$ç‰ˆï¼Œè¿ç¡•é¼ ä¹Ÿä¸èƒ½ç”¨äº†ï¼Œä¾¿åªå¾—ä½œç½¢ã€‚</p><p>ç»ˆäºè¦èµ°äº†ã€‚è¸ä¸Šå»æ˜Œé‚‘ä¸€ä¸­çš„è½¦çš„å‰ä¸€åˆ»ï¼Œä»–å›å¤´çœ‹äº†ä¸€çœ¼å­¦æ ¡ã€‚ä»–è®°å¾—é‚£ä¸ªå¼€æœ—çš„ã€ä½†æ˜¯å®é™…ä¸Šå¹¶ä¸æ˜¯å¾ˆç†Ÿçš„å¥³å­©åœ¨å¬è¯¾ä¹‹å‰ä¸ºä»–åŠ©å¨çš„åœºæ™¯ï¼›ä»–è®°å¾—ä»–è‡ªå·±è®¡åˆ’çš„æ˜¯ï¼Œ$NOIP$å¥½å¥½è€ƒï¼Œå‚åŠ å®Œå†¬ä»¤è¥ï¼Œç­¾ä¸€ä¸ªæ¸…åŒ—çº¦ï¼Œå¸¦ç€è¿˜ç®—ä¸é”™çš„æˆç»©è¿æ¥å¯’å‡ï¼Œç„¶ååœ¨å¯’å‡é‡Œå»æ‰¾ä»–çš„å¥³ç¥â€”â€”é«˜ä¸­æ–°è®¤è¯†çš„ã€ä¸€ä¸ªçˆ±ç¬‘çš„ã€åŠªåŠ›çš„ã€å¯çˆ±çš„å¥³ç”Ÿï¼Œæ’©å¥¹å‡ºå»ç©å„¿ï¼Œæœ€å¥½æ˜¯èƒ½åœ¨ä¸€èµ·å§â€”â€”ä½†æ˜¯å­¦æ ¡è§„åˆ™æ˜¯ä¸ä¼šå…è®¸çš„å§ã€‚ä¸è¿‡ä»–è®¤ä¸ºï¼Œåªè¦å½¼æ­¤éƒ½åœ¨å­¦æ ¡é‡Œæ•°ä¸€æ•°äºŒï¼Œåªè¦å½¼æ­¤éƒ½èƒ½æ¯”è¾ƒè½»æ¾åœ°ä¸Šæ¸…åŒ—ï¼Œå­¦æ ¡æˆ–è®¸ä¼šçä¸€åªçœ¼é—­ä¸€åªçœ¼ã€‚ä»–ä¼¼ä¹å¯¹å°†æ¥ä»–ä»¬ä¸€èµ·åŠªåŠ›çš„åœºæ™¯å……æ»¡äº†ä¿¡å¿ƒã€‚</p><p>â€œå¤§æ¦‚åªéœ€è¦400åˆ†ï¼Œæˆ–è€…ä»¥ä¸Šï¼Ÿæ€»ä¹‹ä¸æ˜¯ç‰¹åˆ«éš¾å§ã€‚â€ä»–è¿™ä¹ˆæƒ³ç€ï¼Œçœ¼é‡Œå‘å‡ºæ™¶è“è‰²çš„å…‰ï¼Œæˆ–è®¸æ˜¯åå°„çš„å¤ªé˜³å…‰å§ã€‚</p><p>çœ‹äº†çœ‹å¤©ç©ºï¼Œä»–ä¸Šäº†å¤§å·´è½¦ã€‚</p><hr><p>â€æ˜Œé‚‘ä¸€ä¸­çœŸå¤§å•Šâ€œè¿™æ˜¯ä»–åˆ°è¿™å„¿åçš„ç¬¬ä¸€æƒ³æ³•ã€‚</p><p>åˆ°è¾¾æ˜Œé‚‘ä¸€ä¸­å·²ç»æ˜¯ä¸­åˆã€‚é¥­èœæ¯”è¾ƒå¯å£ï¼Œåœ¨ä»–å¿ƒé‡Œå¤§æ¦‚æ¯”æ—¥ç…§ä¸€ä¸­çš„é¥­èœ$better$å‡ å€ã€‚ä¸‹åˆåŸæœ¬æƒ³å‡ºå»æ‰¾åŒåƒšä»¬è¹­ä¸€ä¸‹ç½‘ï¼ŒæŠŠæ¿å­æ‰“å®Œï¼Œä½†è°çŸ¥é“ä¸€ç¡å°±ç¡åˆ°äº†å››ç‚¹ã€‚åŒ†åŒ†å¿™å¿™åœ°çœ‹å®Œè€ƒåœºä½ç½®ï¼Œåœ¨è·¯ä¸Šé‡åˆ°äº†åŒåƒšå’Œå‰åŒåƒšã€‚çä¾ƒäº†å‡ å¥ä¹‹åå‘ç°åˆ°é¥­ç‚¹å„¿äº†ï¼Œäºæ˜¯å°±åªèƒ½é€‰æ‹©å»åƒæ™šé¥­äº†ã€‚æ™šé¥­ç»™ä»–çš„æ„Ÿè§‰ä¼¼ä¹æ²¡æœ‰åˆé¥­é‚£ä¹ˆæƒŠè‰³ï¼Œâ€œæˆ–è®¸æ˜¯å¤ªç´¯äº†å§â€ï¼Œä»–è¿™ä¹ˆæƒ³ã€‚åƒé¥­çš„æ—¶å€™å’Œ$rqy$çä¾ƒï¼Œæ„Ÿè§‰æµ·æ˜Ÿã€‚</p><p>å®¿ç®¡è¯´$6$ç‚¹ä»¥åæ¥ç”µï¼Œç»“æœå’•å’•å’•ã€‚æˆ‘ä»¬äºæ˜¯å°±ç”¨ç©ºè°ƒæ’å¤´æ¥ä¸Šæ’æ’å‡‘æ´»äº†ä¸€æ™šä¸Šã€‚</p><p>ä»–åäºŒç‚¹å·¦å³æ‰ç¡ä¸‹â€”â€”è™½ç„¶ä»–çŸ¥é“è¿™ä¹ˆæ™šç¡ä¸è¡Œï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•ï¼Œæ¿å­æ²¡æ‰“å®Œçš„è¯ï¼Œå¿ƒä¸­åƒæ˜¯æœ‰ä»€ä¹ˆè´Ÿæ‹…ä¸€æ ·â€”â€”å½“åˆä»–æ‰§ç€äºè¡¥ä¸€æ™šä¸Šè‡ªå·±çš„é”…è€Œä¸æ˜¯å»æ‰“æ¿å­å¤§æ¦‚ä¹Ÿæ˜¯è¿™ä¸ªç¼˜ç”±ã€‚ä»–æƒ³æ”¾å¿ƒåœ°è¿›å…¥è€ƒåœºï¼Œè¿™æ˜¯ä»–è€ƒè¯•çš„ä¹ æƒ¯ã€‚</p><hr><h2 id="rm-Day-1"><a href="#rm-Day-1" class="headerlink" title="$\rm{Day~1}$"></a>$\rm{Day~1}$</h2><p>çªç„¶ä¸è®©åç”µæ¢¯ï¼Œå…­æ¥¼è®©ä»–æ°”å–˜ååã€‚â€œè¯¥å‡è‚¥äº†â€¦â€¦ä¸è¿‡ç°åœ¨æˆ–è®¸ä¸æ˜¯æƒ³è¿™ä¸ªçš„æ—¶å€™â€ã€‚</p><p>è€ƒåœºåœ¨å…­æ¥¼ï¼Œæ˜¨æ™šè¯•æœºçš„æ—¶å€™ï¼Œä»–å†™äº†ä¸€ä¸ª$dijkstra$ï¼Œå†™äº†ä¸ª$ST$è¡¨åˆå†™äº†ä¸ªæš´åŠ›$n^2 ~\rm{RMQ}$ ï¼Œå¹¶å†™äº†ä¸ªå¯¹æ‹ã€‚éƒ½æ˜¯ä¸€æ¬¡æˆåŠŸã€‚è®©ä»–æ„Ÿè§‰å¾ˆå¥½ã€‚</p><p>å…¥åœºäº†ï¼Œä»–å¸¦äº†ä¸¤å—æ©¡çš®ç³–ï¼Œä¸¤å°å—è„†é¦™ç±³ï¼Œéƒ½æ˜¯æ—©å…ˆä»å­¦æ ¡ä¹°å¥½çš„ã€‚</p><p>$T1$ä»–è§‰å¾—ä¼¼æ›¾ç›¸è¯†ï¼Œå¤§æ¦‚æ˜¯ä»€ä¹ˆç§¯æœ¨å¤§èµ›è¿˜æ˜¯ç§¯æœ¨å¤§ä¼šå•¥çš„ï¼Œä»–è®°ä¸æ¸…äº†ã€‚è€ƒåœºçš„æ—¶å€™ä»–ä¸€èµ°ç¥å°±ä¼šä¸è‡ªè§‰åœ°å»æƒ³æœ€åä¸€ä¸ªå­—åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œä½†å°±æ˜¯æƒ³ä¸èµ·æ¥ã€‚æœ€åä»–å†™äº†ä¸€ä¸ªå¤æ‚åº¦$n\log^2n$çš„çº¿æ®µæ ‘å’Œä¸€ä¸ª$n\log n$çš„$ST$è¡¨ï¼Œåˆå†™äº†ä¸ªå¯¹æ‹å•¥çš„è®©ä»–ä¿©æ‹ï¼Œæ­¤æ—¶å·²ç»$9:15$äº†ã€‚</p><p>$T2$ä»–ä»ç¬¬ä¸€çœ¼å¼€å§‹å°±å·²ç»è¾“äº†ã€‚ä»–è§‰å¾—åº”è¯¥æ˜¯ä»€ä¹ˆæ•°å­¦é¢˜æˆ–è€…ç»“è®ºé¢˜ï¼ŒèŠ±äº†$10min$å†™äº†ä¸ªæš´åŠ›ï¼Œè¿‡ä¸äº†å¤§æ ·ä¾‹çš„æœ€åä¸€ä¸ªç‚¹ï¼Œåˆæƒ³äº†$10min$ä»–æ‰å‘ç°åŸæ¥ä¸æ­¢å¯ä»¥ç”±ä¸¤ä¸ªæ¨å‡ºæ–°çš„ï¼Œå¯èƒ½æ˜¯ä¸‰ä¸ªæˆ–è€…æ›´å¤šã€‚$DP$è¿™ä¸ªæƒ³æ³•åœ¨ä»–è„‘å­é‡Œä¸€é—ªè€Œè¿‡ï¼Œä»–æ²¡æœ‰é€‰æ‹©æ•æ‰ã€‚æœ€ç»ˆä»–å±…ç„¶åªå†™äº†ä¸€ä¸ªæš´åŠ›+éª—åˆ†ã€‚</p><p>$T3$å¤§æ¦‚åªä¼šæ±‚ç›´å¾„â€”â€”ä½†æ˜¯ä»–åªè®°å¾—æ˜¯ä»€ä¹ˆä¸¤é$dfs$æˆ–è€…$bfs$ï¼Œå› ä¸ºä»–ä»æ²¡åšè¿‡æ±‚ç›´å¾„çš„é¢˜ã€‚è€ƒè¯•ä¹‹å‰$qbxt$çš„æ—¶å€™ï¼Œä»–ç”šè‡³è®©åˆ«äººç»™ä»–æ¨èå‡ é“ç›´å¾„çš„é¢˜ï¼Œä½†ç»ˆç©¶æ˜¯æ²¡æ¥å¾—åŠåšã€‚ä»–å¾ˆåæ‚”ã€‚æœ€ç»ˆå†™äº†ä¸€ä¸ªæš´åŠ›éª—åˆ†ã€‚</p><p>æœŸæœ›å¾—åˆ†$100pts + random(0,100)+random(10,20) $</p><p>$Luogu$æ•°æ®$100pts + 65pts + 15pts = 180pts$</p><p>å¬è¯´ä»Šå¤©ä¸‰é“é¢˜éƒ½æ˜¯åŸé¢˜ï¼Œä»–å¾ˆæ„¤æ‡‘ï¼Œå¸Œæœ›æ²¡å‡†å¯ä»¥è®©$CCF$é‡è€ƒä¸€ä¸‹ä¹‹ç±»çš„ã€‚ä½†æ˜¯è¿™æ ¹æœ¬æ˜¯æ— ç¨½ä¹‹è°ˆã€‚</p><p>ä¸‹åˆä»–å’ŒåŒåƒšå»é€›äº†é€›æ˜Œé‚‘ä¸€ä¸­ï¼Œå¹¶ä¸”ä¹°äº†ä¸‰æœ¬ä¸œé‡åœ­å¾çš„ä¹¦ï¼Œåº—ä¸»å¯¹ä»–ä¸é”™ï¼Œç»™ä»–æ‰“äº†ä¸ƒæŠ˜ã€‚</p><p>è€ƒæŒ‚äº†ï¼Œä»–æƒ³åˆ°ã€‚</p><p>è¿™ä¸–ç•Œä¸Šä¼¼ä¹å°±ä»–ä¸€ä¸ªä¸ä¼š$T2$çš„äººã€‚</p><p>ä»–å¯¹å¥½å¤šäººçš„è¨€è¡Œæ„Ÿåˆ°åŒçƒ¦ï¼šæœ‰äººè¯´â€œå®Œäº†ï¼Œå¤§ä¼—åˆ†160â€ï¼Œæ¥ç€ä¾¿æœ‰äººå›é©³ä»–â€œæ˜æ˜å¤§ä¼—åˆ†220â€ï¼Œä½†æ¥ç€åˆæœ‰äººå¤§å£°åœ°è¯´â€œå¤§ä¼—åˆ†æ˜æ˜255å¥½å§â€ã€‚</p><p>è™½ç„¶å¤§å®¶å¹³å¸¸éƒ½äº’%ï¼Œä½†æ˜¯æ€»æ„Ÿè§‰é‚£äº›å¼±å°çš„äººæ˜¯å¤šä¹ˆçš„æ— åŠ©å•Šâ€”â€”ä»–ä»¬åªä¼šæ„Ÿåˆ°è™šä¼ªã€æ— åŠ©ã€ç»æœ›ã€‚åƒæˆ‘ä¸€æ ·ã€‚</p><p>æˆ–è®¸ä»–æœŸæœ›ç€æ˜å¤©èƒ½ç¿»ç›˜ï¼Ÿ</p><p>æ™šä¸Šä»–å½»åº•é¢“åºŸäº†ï¼Œè¦æ±‚ç†„ç¯åï¼Œä»–ç”¨åŒå­¦çš„çƒ­ç‚¹çœ‹äº†ã€Šé’æ˜¥æœŸçŒªå¤´å°‘å¹´XXXXã€‹çš„æœ€æ–°ä¸‰é›†ï¼Œæ„Ÿåˆ°æµ·æ˜Ÿã€‚ä¾æ—§ç¡å¾—ä¸æ—©ã€‚$11ï¼š30$å·¦å³å§ã€‚</p><hr><h2 id="rm-Day-2"><a href="#rm-Day-2" class="headerlink" title="$\rm{Day~2}$"></a>$\rm{Day~2}$</h2><p>ä»Šå¤©ä»–æ²¡æœ‰å¸¦ä»€ä¹ˆåƒçš„ã€‚</p><p>$T1$åªä¼š$60$åˆ†ï¼Œè½¬çœ¼å»çœ‹$T2$</p><p>å†™äº†å¥½é•¿æ—¶é—´çš„æš´åŠ›å¹¶ä¸”è°ƒäº†å¥½ä¹…ï¼Œåœ¨è€ƒè¯•ç»“æŸå‰$30min$ä»–å†™å¥½äº†çˆ†æœï¼Œæ‰¾å‡ºäº†è§„å¾‹ï¼Œ$65pts$å·¦å³ã€‚</p><p>$T3$è¿æƒ³çš„æ—¶é—´éƒ½æ²¡æœ‰ã€‚</p><p>é€€å½¹äº†ã€‚</p><hr><p>ä»–å¾ˆä¼¤å¿ƒã€‚</p><p>å›å®¶ä¹‹åä»–å’Œå…¶ä»–çœå¸‚çš„$Oier$äº¤æµä¹‹åå‘ç°å¤§æ¦‚éƒ½æŒ‚äº†ã€‚æ— å¥ˆçš„ä¸–ç•Œã€‚</p><p>ä»–æœ¬æ¥ä¸æƒ³æœŸä¸­è€ƒè¯•ï¼Œä½†æ˜¯å´åˆæƒ³ä¸å‡ºä»€ä¹ˆç†ç”±æ¥ä¸å»è€ƒè¯•ã€‚æ¯•ç«Ÿåˆšè€ƒå®Œ$NOIp$çš„å…¶ä»–äººéƒ½ç…§å¸¸æœŸä¸­è€ƒè¯•ã€‚</p><p>ä»–è§‰å¾—è‡ªå·±è¯­æ–‡å‘æŒ¥çš„ä¸€èˆ¬ï¼Œç‰©ç†å‘æŒ¥çš„æ­£å¸¸ï¼Œé™¤äº†ç‰©ç†çš„æŸä¸ªå‚»ç‹—å¡«ç©ºé¢˜è®©ä¿ç•™ä¸€ä½å°æ•°è‡ªå·±çœ¼çäº†è€Œå·²ã€‚</p><p>å…¶ä½™çš„éƒ½è€ƒç‚¸äº†ã€‚</p><p>åˆå›æ–‡åŒ–è¯¾ï¼Œç­é‡Œçš„äººå¹¶ä¸é™Œç”Ÿã€‚è¯­æ–‡è€å¸ˆä¼¼ä¹å¯¹ä»–çš„è¿™ä¸ªè¯­æ–‡è¯¾ä»£è¡¨çš„å›å½’æ„Ÿåˆ°å¾ˆé«˜å…´ã€‚</p><p>ä»–ä¸€å¼€å§‹ä¹Ÿå¹¶ä¸æ€æ ·ï¼Œæ²¡å•¥æ„Ÿè§‰ã€‚</p><p>ç›´åˆ°é‚£å¤©ä¸‹åˆã€‚</p><hr><p>ä»–å…´é«˜é‡‡çƒˆåœ°å»å¥¥èµ›å®¤çœ‹æ°‘é—´æµ‹è¯•æ•°æ®çš„æˆç»©ã€‚ä¸­åˆé«˜äºŒçš„æŸä¸ªå­¦é•¿å‘Šè¯‰ä»–çš„ï¼Œä»–è€ƒäº†å…¨æ ¡ç¬¬å››ï¼Œæ¥è¿‘$400$åˆ†ã€‚è™½ç„¶å¯ä¿¡åº¦ä¸é«˜ï¼Œæ¯•ç«Ÿè‡ªå·±ä»€ä¹ˆé€¼æ•°ä»–è‡ªå·±å¿ƒé‡Œæ¸…æ¥šã€‚ä¸è¿‡è¿˜æ˜¯æœŸå¾…äº†ä¸€ä¸‹åˆã€‚</p><p>å…´å¥‹çš„ä»–å»å¥¥èµ›å®¤çœ‹æˆç»©ã€‚</p><p>å­¦é•¿çœ‹é”™äº†ã€‚</p><p>ä»–çš„ä¸¤ä¸ªåŒåƒšéƒ½æ˜¯$370/380+$çš„æ ·å­ã€‚</p><p>åªæœ‰ä»–ä¸åˆ°.</p><p>å…¶ä»–äººçš„åˆ†æ•°ä¹Ÿæ¯”ä»–é«˜ã€‚</p><p>ä»–å¤§æ¦‚å…¨æ ¡ç¬¬åå‡ å§ã€‚</p><p>ä»–æ„Ÿåˆ°äº†ç»æœ›ã€‚</p><p>æœ¬æ¥ä»¥ä¸ºçš„ä¸‰äººè¡Œï¼ˆä¸‰ä¸ªäººä¸€èµ·å‚åŠ è¿‡ä¸¤å±Šçœé˜Ÿé›†è®­ï¼‰ï¼Œå…¶å®æ˜¯ä¸åŒ…æ‹¬ä»–çš„ä¸¤äººè¡Œã€‚</p><p>ä»–æ³¨å®šæ˜¯å¤±è´¥è€…ã€‚</p><p>ä»–ä¼¤å¿ƒæäº†ã€‚</p><hr><p>ä»–å¼€å§‹æ„ˆå‘æ¶ˆæ²‰ï¼Œæ™šè‡ªä¹ çœ‹äº†ä¸€æ™šä¸Šçš„æ–‡å­¦ç´ æèŸèƒé‚£ç§ä¸œè¥¿ï¼Œéƒ½æ˜¯äº›é¸¡æ±¤ä¹‹ç±»çš„è ¢æ–‡ç« ã€‚ä½†ä»–ä»€ä¹ˆéƒ½ä¸æƒ³å¹²ã€‚ä»–æƒ³åœ¨å­¦æ ¡è¯»é‚£å‡ æœ¬ä»æ˜Œé‚‘ä¹°å›æ¥çš„ä¹¦ï¼Œä½†æ˜¯æ€•è¢«æŠ“åªå¥½ä½œç½¢ã€‚</p><p>ä»–è§‰å¾—ä¸€å¹´æ¥ï¼Œä»–ä¸€äº‹æ— æˆã€‚</p><p>æˆ–è®¸è¿›å®éªŒéƒ¨åªæ˜¯ä¸ªé”™è¯¯ã€‚ä½†ä»–æ˜¯ä¸ä¼šé€€å‡ºçš„ã€‚å³ä½¿æ˜¯ä¸ºäº†é¢å­ä¹Ÿä¸ä¼šã€‚</p><p>ä»–åŸæœ¬è®¡åˆ’å¥½çš„ä¸€åˆ‡éƒ½æ²¡æœ‰æˆåŠŸã€‚ç°åœ¨æœ€åä¸€æ¬¡æœºä¼šï¼Œä»–ä¾æ—§å¤±è´¥äº†ã€‚äººç”Ÿè¾“å®¶ï¼Œå¤§æŠµå°±æ˜¯è¿™æ ·ã€‚ä»–ä¸æ„¿æ„å»é¢å¯¹ä»–çš„å¥¥èµ›åŒåƒšä»¬ã€‚ä»–å¤§æ¦‚å°±åƒæ˜¯$EDG$â€”â€”å›½å†…èµ›å¦‚åŒæˆ˜ç¥ä¸€èˆ¬ï¼Œä¸€åˆ°å›½é™…æ¯”èµ›å°±æ­»ã€‚</p><p>ä»–çš„å¥³ç¥è¶Šå¼€å¿ƒï¼Œä»–è¶Šå¯’å¿ƒã€‚å€’ä¸æ˜¯å› ä¸ºåˆ«çš„ï¼Œåªæ˜¯ä»–çš„å¥³ç¥è¶Šå¯çˆ±ï¼Œä»–è¶Šè§‰å¾—æ›¾ç»åšç™½æ—¥æ¢¦çš„è‡ªå·±æ˜¯ä¸ªä¸æ›¾è®¤æ¸…ç°å®çš„å‚»$B$ï¼Œä»–è¶Šå‘æ„Ÿåˆ°è½å·®çš„ä¸å¯é€¾è¶Šã€‚ä»–ç»æœ›äº†ã€‚</p><p>æœŸä¸­è€ƒè¯•æˆç»©å‘ä¸‹æ¥äº†ï¼Œä»–ä»åœè¯¾ä¹‹å‰çš„ç­é‡Œç¬¬äº”ï¼Œå¹´çº§ç¬¬äºŒåæ»‘åˆ°äº†ç­é‡Œç¬¬å››åï¼Œå¹´çº§ç¬¬$289$ã€‚è¿™æ¬¡ä»–ä»¬ç­è€ƒå¾—å¾ˆå¥½ã€‚å¹´çº§å‰å››ï¼Œä»–çš„ç­é‡Œæœ‰ä¸‰ä¸ªï¼›å¹´çº§å‰20æœ‰10ä¸ªï¼Œå¹´çº§å‰400æœ‰46ä¸ªã€‚å¹´çº§å…±æœ‰1640å·¦å³çš„äººã€‚</p><p>è¿™ä¼¼ä¹æ˜¯å®éªŒéƒ¨è¯¥æœ‰çš„æˆç»©ã€‚å¯æ˜¯è·Ÿä»–æ²¡æœ‰å…³ç³»ã€‚</p><p>ç‰¹åˆ«çš„ï¼Œä»–çš„å¥³ç¥è€ƒäº†å¹´çº§28ï¼Œç­é‡Œç¬¬13ã€‚ä»–æ¯”å¥¹å·®åå€ã€‚è™½ç„¶åœè¯¾äº†ä¸€æ®µæ—¶é—´æ²¡ä¸Šå¥½åƒæ˜¯ä¸ªä¸é”™çš„ç†ç”±ï¼Œä½†ä»–ä¾æ—§è§‰å¾—ï¼Œè‡ªå·±å¤ªå¤±è´¥äº†ã€‚</p><p>å¤ªå¤±è´¥äº†ã€‚</p><p>å¤ªå¤±è´¥äº†ã€‚</p><hr><p>å¤§ä¼‘å›å®¶ï¼Œç°åœ¨æ˜¯$11.17$æ™šï¼Œæˆ‘ç”¨ç¬¬ä¸‰äººç§°è¯´å®Œäº†è¿™ä¸ªæ•…äº‹ï¼Œæ„Ÿè§‰â€¦â€¦å¹¶æ²¡æœ‰ä»€ä¹ˆæ„Ÿè§‰ã€‚</p><p>æˆ‘å‘ç°æˆ‘ç°åœ¨å¿ƒæƒ…è™½ç„¶å¾ˆæ²‰é‡ï¼Œä½†æ˜¯åŒæ ·å¾ˆæ”¾æ¾ã€‚æˆ‘å¤§æ¦‚ä¸ä¼šå†å‚åŠ ä»€ä¹ˆ$OI$äº†å§â€”â€”è¿™è®©æˆ‘æ„Ÿåˆ°è½»æ¾æ— æ¯”ã€‚ä¸éœ€è¦é¢å¯¹å…¶ä»–å¾ˆå¼ºçš„äººè€Œæœ‰å¿ƒç†è´Ÿæ‹…ï¼Œä¸å¿…é¢å¯¹æ•™ç»ƒä¸»ä»»å»æ‰¿å—ä»–ä»¬çš„â€œé«˜ç›®æ ‡â€ï¼Œä¸å¿…æ¯æ¬¡fakeæ—¶è¿˜ä¼šçº ç»“æˆ‘è‡ªå·±åˆ°åº•å¼ºä¸å¼ºï¼Œä¸å¿…å†å»äº‰å¼ºå¥½èƒœã€‚è™½ç„¶æœ€ç»ˆå…ä¸äº†è¢«å½“åšåé¢æ•™æè¯´ä¸ª$OI$çš„å­¦å¼Ÿä»¬ï¼Œè™½ç„¶å…ä¸äº†æ˜¯è¦ä¸»ä»»è¢«æ‰¹ä¸€é¡¿å¹¶ä¸”è®©ä½ æ€»ç»“ä¸ªä»€ä¹ˆå‚»é€¼é”™å› æˆ–è€…æ„Ÿæ‚Ÿå¹¶è®©ä½ å£°æ³ªä¿±ä¸‹åœ°å»åçœå¹¶ä¸”ä¿è¯ä»¥åå¥½å¥½å­¦$OI$ï¼Œä½†ï¼Œæˆ‘è½»æ¾çš„å¾ˆã€‚</p><p>è¿™çœŸæ˜¯ä»æœªæœ‰è¿‡çš„è½»æ¾çš„æ„Ÿè§‰ã€‚</p><p>æˆ–è®¸æˆ‘æœ¬æ¥æ²¡æœ‰ä»€ä¹ˆå¤©èµ‹ï¼Œåªæ˜¯åœ¨é ä¸ªäººç´ è´¨ç¡¬åˆšè€Œå·²ã€‚ä¹Ÿè®¸ä¿¡ç«ç»™æˆ‘çš„ç»ˆç©¶æ˜¯é™¤äº†æˆåŠŸä¹‹å¤–çš„ä¸€åˆ‡ï¼Œæ¯”å¦‚æ¯…åŠ›ï¼Œæ¯”å¦‚åšäººã€‚</p><p>æˆ‘æ„Ÿåˆ°æ— æ¯”çš„è½»æ¾ã€‚</p><p>ä»¥åå¤§æ¦‚ä¸ä¼šå­¦ä¿¡ç«äº†å§ã€‚æ¯•ç«Ÿå‹æ ¹æ²¡æœ‰ä»€ä¹ˆè½¬æœºã€‚è·¯çš„è¯ï¼Œè¾¹èµ°è¾¹æƒ³å§ã€‚</p><p>æˆ‘ç°åœ¨ååˆ†åœ°æƒ³å­¦$CNAO$ï¼Œä¹‹å‰ç”±äºè¦å‡†å¤‡$NOIp$ï¼Œä»å›¾ä¹¦é¦†å€Ÿæ¥çš„ä¹¦æ²¡æ¥å¾—åŠçœ‹ã€‚ç°åœ¨ç»ˆäºæœ‰æ—¶é—´äº†ã€‚</p><p>å—¯ï¼Œå¤§æ¦‚å¤©æ–‡æ‰æ˜¯æˆ‘çœŸæ­£å–œæ¬¢çš„å§ã€‚ä»¥å‰æ¯æ¬¡ä¸ºäº†$OI$å¥‹æ–—çš„æ—¶å€™æ€»è¦æƒ³æƒ³è‡ªå·±åˆ°åº•æ˜¯ä¸æ˜¯çœŸæ­£å–œæ¬¢$OI$ï¼Œå…¶å®è¯´ä¸ä¸Šå–œæ¬¢å§ï¼Œæ¯•ç«Ÿæ²¡æœ‰çœŸçš„ä»éª¨å­é‡Œå–œæ¬¢è¿™ä¸œè¥¿ã€‚</p><p>ä½†æ˜¯å…¶å®å±±ä¸œæ²¡æœ‰å¼€å±•$AO$çš„ï¼Œä¸è¿‡æˆ‘æƒ³å½“è¿™ä¸ªç¬¬ä¸€äººã€‚</p><p>æˆ‘çªç„¶å¾ˆæ„Ÿæ¿€è¿™ä¸€åˆ‡ï¼Œæ„Ÿæ¿€æ›¾ç»çš„å¤±è´¥ä¸æˆåŠŸã€æ”¶è·ä¸æ„ŸåŠ¨ã€‚å›ä¸æˆ‘ä¹‹æ©ï¼Œæ¯•ç”Ÿéš¾å¿˜ã€‚</p><p>åˆ°äº†è¯´å†è§çš„æ—¶å€™äº†ï¼Œå“ˆï¼Œæˆ‘çš„ä½œä¸šè¿˜æ²¡å†™å‘¢ã€‚æˆ‘å¯è¦å­¦å¥½æ–‡åŒ–è¯¾ï¼Œåšçš„æ»´æ°´ä¸æ¼æ‰èƒ½å»å­¦$AO$å•Šï¼Œè™½ç„¶è¿™æ˜¯ä¸€æ®µæœªçŸ¥çš„æ—…ç¨‹ï¼Œä½†æ˜¯æˆ‘ä¹æ„å»é—¯ã€‚</p><hr><p>åœ¨æˆç»©å•ä¸Šçœ‹åˆ°äº†å¥½å¤šå±±ä¸œçš„å·¨ä½¬â€¦â€¦æ›¾ç»åœ¨æˆ‘çœ‹æ¥ä¸æˆ‘æ°´å¹³å·®ä¸å¤šçš„äººï¼Œå¤§æ¦‚éƒ½ä»¥å‹å€’æ€§çš„ä¼˜åŠ¿å‡»è´¥äº†æˆ‘å§ã€‚</p><p>æ²¡å‡†å­¦$OI$çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä¸€ç›´æ˜¯ä¸ºäº†åŠŸååˆ©ç¦„è€Œå­¦ï¼Œä¸ºäº†è·å¾—è¿›å…¥æŸä¸¤æ‰€å¤§å­¦çš„æœºä¼šè€Œå­¦ï¼Œç»ˆç©¶æ˜¯è‚¯å®šä¸ä¼šæˆåŠŸçš„å§â€”â€”åˆ°ä¸æ˜¯è¯´ä¸€å®šè¦å»å–œæ¬¢è¿™é—¨å¥¥èµ›ï¼Œåªæ˜¯åœ¨å¥‹æ–—çš„æ—¶å€™ï¼Œè¿˜æ˜¯åªä¸ºäº†å¥‹æ–—è€Œå¥‹æ–—æ¯”è¾ƒå¥½å§ã€‚</p><p>æˆ‘è¯¥è¯´ä»€ä¹ˆï¼Ÿå¼ºå¤§çš„ç†è§£èƒ½åŠ›æˆ–è€…æ¨ç†èƒ½åŠ›ï¼Œç»ˆæ˜¯ä¸æ˜¯OIçš„æ ¸å¿ƒç´ å…»â€”â€”åˆ›é€ åŠ›æ‰æ˜¯ã€‚å½“ç„¶å•¦ï¼Œæ•°å­¦æœ‰å¤Ÿå¥½çš„è¯+å¼ºå¤§çš„ç†è§£èƒ½åŠ›=rqyè¿™ä¸ªç­‰å¼ä¹Ÿæ˜¯æˆç«‹çš„ã€‚</p><p>å½“ç„¶ï¼Œä¸å±äºæˆ‘å•¦ã€‚</p><p>è™½ç„¶ç°åœ¨å¾ˆä¸ç”˜â€¦â€¦ä½†æ˜¯æ²¡æœ‰åŠæ³•ï¼Œå¤§æ¦‚è¿™å°±æ˜¯äººç”Ÿå§ã€‚</p><p>å¦‚æœè¯´â€¦â€¦é€€å½¹åçš„å‡ å¤©æ„Ÿè§‰æ€ä¹ˆæ ·â€¦â€¦è¿˜å¥½å§ï¼Œæ²¡æˆ‘æƒ³è±¡çš„ç—›è‹¦ã€‚åªä¸è¿‡ä¹‹å‰ä¸€ç›´æ†§æ†¬çš„æ‰€è°“â€œå¦¹å­â€ä¹Ÿå¥½ï¼Œâ€œå¥³ç¥â€ä¹Ÿå¥½ï¼ŒåŸæ¥ä¸€ç›´æœ‰ç”·æœ‹å‹åªä¸è¿‡æˆ‘ä¸çŸ¥é“ï¼›åªä¸è¿‡å¹²èµ·ä»€ä¹ˆäº‹æƒ…æ¥éƒ½åŠ›ä¸ä»å¿ƒè€Œå·²ï¼›åªä¸è¿‡é‡æ–°ç‡ƒèµ·çš„å¸Œæœ›ä¹‹ç«åˆè¢«æµ‡ç­äº†è€Œå·²å§ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¿…è¦å»ä¸ºä¹‹ä¼¤å¿ƒâ€”â€”è¿™æ‰æ˜¯äººç”Ÿå§ã€‚</p><p>å¬è¯´ä½ è°·æœ‰ä¸ªOIerè‡ªæ€äº†â€¦â€¦ä¸çŸ¥é“è¿™ä¸ªä¼ é—»æ˜¯çœŸæ˜¯å‡ï¼Œæ¯•ç«Ÿä¹Ÿæ²¡æ³•å»ç¡®è®¤ã€‚æˆ‘åªæ˜¯ä¸ºæ­¤æ„Ÿåˆ°ä¼¤å¿ƒè€Œå·²â€”â€”æ— è®ºåˆ°åº•æœ‰æ²¡æœ‰è‡ªæ€ï¼Œæˆ‘åªæƒ³ç”¨é‚£å¥è¯æ¥è¯„è®ºâ€œå®åŠ›å¦‚æœå¼ºåˆ°ç‹¬æ­¥å¤©ä¸‹ï¼Œæƒ³æ€ä¹ˆå­¦å°±æ€ä¹ˆå­¦ï¼›å¦åˆ™åªèƒ½æ¯«æ— ä¿ç•™åœ°ã€çº¯ç²¹åœ°å»åŠªåŠ›ï¼Œè€Œä¸æ˜¯ä¸ºäº†å»è·å¾—åŠŸåã€å°ä½›å°ç¥ â€”â€” ä¸å¿˜åˆå¿ƒåœ¨ä»€ä¹ˆæ—¶å€™éƒ½æ˜¯æœ€é‡è¦çš„ã€‚â€æ‰€ä»¥ï¼Œå¿ƒæ— æ—éª›ï¼Œä»€ä¹ˆæ—¶å€™éƒ½æ˜¯æœ€é‡è¦çš„ã€‚</p><p>æ€»ä¹‹å‘¢ï¼Œæˆ‘æŠŠè¿™ç¯‡æ–‡ç« ç§°ä¹‹ä¸ºâ€œå¯ç¤ºå½•â€ï¼Œåªæ˜¯å¸Œæœ›åæ¥çš„Oieræˆ–å¯ä»¥ä»æˆ‘çš„è¿™ä¸€äº›æ‚æ‚Ÿé‡Œè·å¾—äº›ä»€ä¹ˆï¼š</p><h2 id="åšä»€ä¹ˆäº‹æƒ…ï¼Œéƒ½è¦å…ˆä»è‡ªå·±çš„çµé­‚å‡ºå‘ï¼Œè€Œä¸æ˜¯ä»åˆ©ç›Šå‡ºå‘ã€‚"><a href="#åšä»€ä¹ˆäº‹æƒ…ï¼Œéƒ½è¦å…ˆä»è‡ªå·±çš„çµé­‚å‡ºå‘ï¼Œè€Œä¸æ˜¯ä»åˆ©ç›Šå‡ºå‘ã€‚" class="headerlink" title="åšä»€ä¹ˆäº‹æƒ…ï¼Œéƒ½è¦å…ˆä»è‡ªå·±çš„çµé­‚å‡ºå‘ï¼Œè€Œä¸æ˜¯ä»åˆ©ç›Šå‡ºå‘ã€‚"></a>åšä»€ä¹ˆäº‹æƒ…ï¼Œéƒ½è¦å…ˆä»è‡ªå·±çš„çµé­‚å‡ºå‘ï¼Œè€Œä¸æ˜¯ä»åˆ©ç›Šå‡ºå‘ã€‚</h2><p>ä¹‹ç±»çš„å§ã€‚</p><p>æˆ‘æƒ³å¼•ç”¨ä¸€å¥ï¼ˆæ®µï¼‰è¯ï¼Œæ¥è‡ªã€Šæœ¬æ°æ˜å·´é¡¿å¥‡äº‹ã€‹ï¼š</p><blockquote><p>æœ‰äº›äººï¼Œæ³¨å®šå¯ä»¥äºæ²³è¾¹é—²åã€‚<br>æœ‰äº›äººè¢«é—ªç”µå‡»ä¸­è¿‡ä¸ƒæ¬¡ã€‚<br>æœ‰äº›äººå¯¹éŸ³ä¹æœ‰ç€éå‡¡çš„å¤©èµ‹ã€‚<br>æœ‰äº›äººæ˜¯è‰ºæœ¯å®¶ã€‚<br>æœ‰äº›äººæ˜¯æ¸¸æ³³å¥å°†ã€‚<br>æœ‰äº›äººæ‡‚å¾—åˆ¶ä½œçº½æ‰£ã€‚<br>æœ‰äº›äººæ‡‚èå£«æ¯”äºšã€‚<br>æœ‰äº›äººæ˜¯å¦ˆå¦ˆã€‚<br>è¿˜æœ‰äº›äººï¼Œæ˜¯èˆè€…ã€‚<br>æˆ‘ä»¬æ³¨å®šè¦å¤±å»æˆ‘ä»¬æ‰€çˆ±çš„äººï¼Œ<br>è¦ä¸ç„¶æˆ‘ä»¬æ€ä¹ˆçŸ¥é“ä»–ä»¬å¯¹æˆ‘ä»¬æœ‰å¤šä¹ˆçš„é‡è¦ã€‚</p></blockquote><p>åä¼šæœ‰æœŸã€‚</p><h1 id="mathscr-THE-END"><a href="#mathscr-THE-END" class="headerlink" title="$\mathscr{THE~~~END}$"></a>$\mathscr{THE~~~END}$</h1>]]></content>
    
    <summary type="html">
    
      æˆ‘ä¸æƒ³é€€å½¹ã€‚
    
    </summary>
    
      <category term="Life" scheme="http://www.orchidany.cf/categories/Life/"/>
    
    
      <category term="éšæƒ³/ä¸‹ä¸‹ç¬”" scheme="http://www.orchidany.cf/tags/%E9%9A%8F%E6%83%B3-%E4%B8%8B%E4%B8%8B%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>ç¬™ä¸ŠæœˆProject</title>
    <link href="http://www.orchidany.cf/2019/02/14/%E7%AC%99%E4%B8%8A%E6%9C%88/"/>
    <id>http://www.orchidany.cf/2019/02/14/ç¬™ä¸Šæœˆ/</id>
    <published>2019-02-14T07:48:12.000Z</published>
    <updated>2019-03-10T08:15:56.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å‡†ç¡®æ¥è¯´è¿™æ˜¯ä¸€ä¸ª$project$ï¼Œä¸“é—¨ä»¥$art/painting$ã€$music$ä¸ºä¸»ã€‚</p><p>ç°åœ¨å·²ç»åœ¨åŸåšå®¢ä¸Šæ›´äº†ä¸¤æœŸäº†ï¼Œå› ä¸ºå®åœ¨æ‡’å¾—å†å»æ¯é¥¬å›¾ç‰‡çš„äº‹å„¿ï¼Œäºæ˜¯å°±ç›´æ¥é“¾è¿‡æ¥å¥½äº†ï¼š</p><p><a href="https://www.cnblogs.com/pks-t/p/9349900.html" target="_blank" rel="noopener">ArseniXC &amp; è«å¥ˆ</a></p>        <div id="aplayer-IQEvyQoY" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-IQEvyQoY"),            narrow: false,            autoplay: false,            showlrc: false,            music: {              title: "äººå•Š",              author: "å¾ä½³è¹",              url: "å¾ä½³è¹-äººå•Š.mp3",              pic: "/2019/02/14/ç¬™ä¸Šæœˆ/rena.png",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script>]]></content>
    
    <summary type="html">
    
      é™¶å†¶æƒ…æ“233
    
    </summary>
    
    
      <category term="ç¬™ä¸Šæœˆ" scheme="http://www.orchidany.cf/tags/%E7%AC%99%E4%B8%8A%E6%9C%88/"/>
    
  </entry>
  
  <entry>
    <title>CF#536Div2ã®é¢˜è§£(E&amp;F)</title>
    <link href="http://www.orchidany.cf/2019/02/08/CF-536Div2%E3%81%AE%E9%A2%98%E8%A7%A3-E-F/"/>
    <id>http://www.orchidany.cf/2019/02/08/CF-536Div2ã®é¢˜è§£-E-F/</id>
    <published>2019-02-07T16:11:14.000Z</published>
    <updated>2019-03-16T13:10:06.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89--%2F%E7%9C%81%E9%80%89-blueviolet.svg" alt=""></p><h2 id="0x01-Preface"><a href="#0x01-Preface" class="headerlink" title="$0x01~~Preface$"></a>$0x01~~Preface$</h2><p>$emmm$è¿™æ¬¡CFæœ¬èº«æ‰“çš„å¾ˆé¡ºç•…ï¼Œä½†æ˜¯å±…ç„¶unratedäº†â€¦â€¦å’•å’•å’•å’•</p><p>è¿™æ˜¯å¤´ä¸€æ¬¡CFæœ‰æ¯”èµ›æˆ‘å…¨éƒ¨é¢˜ç›®éƒ½åšäº†â€¦â€¦å¯å–œå¯è´ºå¯å–œå¯è´º233</p><p>ç®€å•æ€»ç»“ä¸€ä¸‹å‰é¢å››é“é¢˜<a href="http://codeforces.com/contest/1106" target="_blank" rel="noopener">$\color{red}{Link}$</a>ï¼š</p><ul><li><p>Aé¢˜ï¼šsbé¢˜ï¼Œ$O(n^2)$æšä¸¾çš„çº¢é¢˜ï¼ˆæˆ–è®¸éƒ½ä¸åˆ°ï¼‰ï¼Œä½†æ˜¯æˆ‘$check$çš„æ—¶å€™å¤ªç²—å¿ƒWAäº†ä¸€æ¬¡<del>èº«è´¥åè£‚XD</del></p></li><li><p>Bé¢˜ï¼šsbé¢˜ï¼Œä¸€ä¸ªæ¨¡æ‹Ÿï¼Œéœ€è¦ä¸€ä¸ªå¯ä»¥å¤„ç†ä¼˜å…ˆçº§çš„æ•°æ®ç»“æ„ï¼ˆå…¶å®å°±æ˜¯å †ä½†æ˜¯æˆ‘ä¸€å¼€å§‹æƒ³çš„æ˜¯çº¿æ®µæ ‘ï¼‰</p></li><li>Cé¢˜ï¼šsbé¢˜ï¼Œä¸€ä¸ªè´ªå¿ƒï¼ˆå…¶å®æ˜¯æ•°å­¦ä¸Šå¯proofçš„æ•°å­¦é¢˜ä½†è¢«æˆ‘å½“è´ªå¿ƒé¢˜åšäº†XDï¼‰ï¼Œå¤§æ¦‚å°±æ˜¯ä½ èƒ¡ä¹±æ’ä¸ªåºä¹‹åèƒ¡æä¸€ä¸‹å°±å¥½ã€‚</li><li>Dé¢˜ï¼šæ°´é¢˜ï¼Œæ€è€ƒä¸€ä¸‹å¯å¾—ï¼Œæˆ‘ä»¬åªéœ€è¦å†™ä¸€ä¸ªBFS+ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—å³å¯ï¼Œå› ä¸ºæ— å‘å›¾+éšä¾¿èµ°=èƒ¡æå…«æ</li></ul><p>ä¸‹é¢ä¸¤é“é¢˜å°±å¥½åƒä¸æ˜¯é‚£ä¹ˆæ°´äº†qaq</p><h2 id="0x02-E-cdot-text-Lunar-New-Year-and-Red-Envelopes"><a href="#0x02-E-cdot-text-Lunar-New-Year-and-Red-Envelopes" class="headerlink" title="$0x02~~E\cdot \text{Lunar New Year and Red Envelopes}$"></a>$0x02~~E\cdot \text{Lunar New Year and Red Envelopes}$</h2><h3 id="color-red-Link"><a href="#color-red-Link" class="headerlink" title="$\color{red}{Link}$"></a><a href="http://codeforces.com/contest/1106/problem/E" target="_blank" rel="noopener">$\color{red}{Link}$</a></h3><p>ç®€å•æ¥è¯´å°±æ˜¯ç»™$k$ä¸ªåŒºé—´ï¼Œæ¯ä¸ªåŒºé—´ä¸€ä¸ªå·¦ç«¯ç‚¹$s$ä¸€ä¸ªå³ç«¯ç‚¹$e$ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªèœœæ±Â·å³ç«¯ç‚¹$t$ã€‚é¡ºç€æ—¶é—´çº¿$1$~$n$ï¼Œå¯ä»¥ä»$s_i$åˆ°$e_i$çš„æ—¶é—´å†…é€‰æ‹©è·å¾—$w_i$çš„æ”¶ç›Šï¼Œä½†åŒæ—¶ä¸‹æ¬¡çš„é€‰æ‹©å¿…é¡»åœ¨$t_i$ä¹‹åã€‚</p><p>æœ€å¤§åŒ–æ”¶ç›Šçš„æ€è·¯ä¸‹ï¼Œæœ‰$m$æ¬¡æœºä¼šè®©é€‰æ‹©è€…åœ¨æŸä¸ªæ—¶é—´ç‚¹å•¥éƒ½ä¸å¹²ã€‚æ±‚æœ€å°çš„æ”¶ç›Šã€‚</p><h3 id="mathfrak-Solution"><a href="#mathfrak-Solution" class="headerlink" title="$\mathfrak {Solution}$"></a>$\mathfrak {Solution}$</h3><p>å‘ƒï¼Œå…¶å®æ¯”è¾ƒå®¹æ˜“çš„å‘ç°å°±æ˜¯ä¸ªæ—¶é—´çº¿$DP$ã€‚æ ¹æ®â€$n$ä¸å¤§å°±DP$n$â€çš„æ˜¯æŒ‡å¯¼æ€æƒ³ï¼ˆçæ‰¯çš„ï¼‰ï¼Œæˆ‘ä»¬åº”è¯¥æŒ‰æ—¶é—´$DP$ã€‚é‚£ä¹ˆç¬¬ä¸€æ­¥å°±æ˜¯æŠŠæ¯ä¸ªåŒºé—´çš„ä¿¡æ¯æ˜ å°„åˆ°æ—¶é—´çº¿ä¸Šå»ã€‚è¿™ä¸ªæ—¶å€™æœ‰ä¸€ä¸ªæ¯”è¾ƒå¦™çš„$idea$ã€‚é¦–å…ˆæˆ‘ä»¬ç»™æ¯ä¸ªåŒºé—´çš„$s$å’Œ$e+1$åœ¨æ—¶é—´çº¿ä¸Šåˆ†åˆ«æ‰“ä¸Šä¸åŒçš„æ ‡è®°ï¼Œä¹‹åæˆ‘ä»¬è€ƒè™‘æ²¿æ—¶é—´çº¿ä»å‰å‘åæ‰«ææ¯ä¸€æ®µåŒºé—´ï¼Œæ¯å½“é‡åˆ°ä¸€ä¸ªåŒºé—´çš„$s$æ—¶å°±ä¸¢åˆ°ä¸€ä¸ª$multiset$é‡Œé¢ï¼Œåä¹‹é‡åˆ°$e+1$æ—¶å°±$erase$ã€‚ç„¶åè¿™æ ·æˆ‘ä»¬åªé¡ºä¾¿ä¹±æä¸€ä¸‹å°±å¯ä»¥å¾—å‡ºæ¯ä¸ªæ—¶é—´ç‚¹æœ€ä¼˜çš„æ–¹æ¡ˆã€‚</p><p>ä¹‹åï¼Ÿä¹‹åå°±ç›´æ¥$nm$çš„DPå•Šï¼Œæ¯•ç«Ÿ$nm$åªæœ‰$20million$é‚£ä¹ˆå¤§ã€‚</p><p>Ps:ç”±äºSTLä¸­multisetä¸€åˆ åˆ ä¸€ä¸²çš„zzæ€§è´¨ï¼Œæ”¹ç”¨mapæƒ¹qaq</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 233</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 100010</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">time_node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> mark, d, w ;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> time_node &amp;T) <span class="keyword">const</span> &#123;</span><br><span class="line"><span class="keyword">return</span> w &gt; T.w || (w == T.w &amp;&amp; d &gt; T.d);</span><br><span class="line">&#125;</span><br><span class="line">&#125; base[MAXN] ; </span><br><span class="line"><span class="built_in">map</span> &lt;time_node, <span class="keyword">int</span>&gt; M_set ; </span><br><span class="line"><span class="built_in">vector</span>&lt;time_node&gt;Time[MAXN] ; <span class="keyword">long</span> <span class="keyword">long</span> Ans ;</span><br><span class="line"><span class="keyword">int</span> N, M, K, A, B, C, D, i, j ; <span class="keyword">long</span> <span class="keyword">long</span> dp[MAXN][MAXM] ;  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; K ;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">63</span>, <span class="keyword">sizeof</span>(dp)) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= K ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;A, &amp;B, &amp;C, &amp;D), </span><br><span class="line">        Time[A].push_back((time_node)&#123;<span class="number">1</span>, C, D&#125;) ;</span><br><span class="line">        Time[B + <span class="number">1</span>].push_back((time_node)&#123;<span class="number">2</span>, C, D&#125;) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">register</span> <span class="keyword">int</span> tot = Time[i].size() ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt; tot ; ++ j) </span><br><span class="line">            <span class="keyword">if</span> (Time[i][j].mark == <span class="number">1</span>) ++ M_set[Time[i][j]] ; </span><br><span class="line">            <span class="keyword">else</span> M_set[Time[i][j]] &gt; <span class="number">1</span> ? M_set[Time[i][j]] -- : M_set.erase(Time[i][j]) ;</span><br><span class="line">        <span class="keyword">if</span> (M_set.size()) base[i] = (*M_set.begin()).first ; <span class="keyword">else</span> base[i] = (time_node)&#123;<span class="number">0</span>, i, <span class="number">0</span>&#125; ;</span><br><span class="line">    &#125;dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>, Ans = dp[<span class="number">1</span>][<span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= M ; ++ j)&#123;</span><br><span class="line">            j &gt; <span class="number">0</span> ? dp[i][j] = min(dp[i - <span class="number">1</span>][j - <span class="number">1</span>], dp[i][j]) : <span class="number">1</span> ;</span><br><span class="line">            dp[base[i].d][j] = min(dp[base[i].d][j], dp[i - <span class="number">1</span>][j] + base[i].w) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= M ; ++ i) Ans = min(Ans, dp[N][i]) ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="0x03-F-cdot-text-Lunar-New-Year-and-a-Recursive-Sequence"><a href="#0x03-F-cdot-text-Lunar-New-Year-and-a-Recursive-Sequence" class="headerlink" title="$0x03~~F\cdot \text{Lunar New Year and a Recursive Sequence}$"></a>$0x03~~F\cdot \text{Lunar New Year and a Recursive Sequence}$</h2><p><a href="http://codeforces.com/contest/1106/problem/E" target="_blank" rel="noopener">$Link$</a></p><p>ç®€å•æ¥è¯´å°±æ˜¯ç»™ä½ ä¸€ä¸ªåºåˆ—$F_x$çš„$k$é¡¹çš„é€’æ¨æ³•åˆ™ï¼ˆå¹‚æ¬¡ç§¯å¼é€’æ¨ï¼‰ï¼Œåœ¨è®¤å®šå‰$k-1$é¡¹éƒ½æ»¡è¶³$F_x=1$çš„åŸºç¡€ä¸Šç»™å®š$F_n$ï¼Œè®©ä½ å€’æ¨å‡º$F_k$æ¥ã€‚</p><h3 id="mathfrak-Solution-1"><a href="#mathfrak-Solution-1" class="headerlink" title="$\mathfrak {Solution}$"></a>$\mathfrak {Solution}$</h3><p>æ•æˆ‘ç›´è¨€â€¦è¿™é“é¢˜æˆ‘è€ƒåœºä¸Šæ˜¯ä¸å¯èƒ½ä¼šçš„â€¦ï¼ˆå·²æ‰‘è¡—</p><p>é¦–å…ˆæˆ‘ä»¬è§‚å¯Ÿä¸€èˆ¬å½¢å¼ï¼š$$F_x = \begin{cases}1~, &amp;\rm{x&lt;k} \newline ?~, &amp; \rm{x = k} \newline \prod\limits_{j=1}^kF_{x-j}^{b_j}  ,  &amp; \rm{x&gt;k}\end{cases}~ (\mod 998,244,353)$$</p><p>å¤§ä½“ä¸Šè¿™ä¸ªå¼å­æ˜¯æ²¡æ³•åšçš„ï¼Œå› ä¸ºæ¯•ç«Ÿæ˜¯ä¹˜ç§¯+å¹‚æ¬¡æ–¹é€’æ¨çš„å½¢å¼ã€‚ä½†æ˜¯è¿™ä¸ªåœ°æ–¹æœ‰ä¸ª<del>æˆ‘æ²¡æƒ³å‡ºæ¥ã€æƒ³å‡ºæ¥ä¹Ÿä¸ä¼šç”¨çš„</del>$Ideaâ€‹$ï¼Œå°±æ˜¯æˆ‘ä»¬æ—¢ç„¶è¦æŠŠä¹˜ç§¯è½¬åŒ–æˆæ±‚å’Œçš„å½¢å¼ï¼Œé‚£å°±åªèƒ½åœ¨æŒ‡æ•°ä¸Šä¹±æã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠå®ƒçš„æ¯ä¸€é¡¹éƒ½å†™æˆåŒä¸€ä¸ªæ•°çš„å¹‚æ¬¡ï¼Œé‚£ä¹ˆé€’æ¨çš„æ—¶å€™åªéœ€è¦åšåŠ æ³•å°±å¯ä»¥äº†ã€‚</p><p>æ¬¡æˆ‘ä»¬é€‰æ‹©$998,244,353â€‹$çš„<strong>åŸæ ¹</strong>ä½œä¸ºåº•æ•°ã€‚å› ä¸ºåŸæ ¹æœ‰ä¸€ä¸ªå¾ˆä¼˜ç¾çš„æ€§è´¨ï¼Œå°±æ˜¯<strong>$pâ€‹$çš„åŸæ ¹çš„å¹‚æ¬¡å¯ä»¥éå†$pâ€‹$çš„ç®€åŒ–å‰©ä½™ç³»ã€‚</strong>è€Œç”±$NTTâ€‹$é‡Œå¾—åˆ°çš„ç»éªŒï¼Œè¿™ä¸ªæ¨¡æ•°çš„æœ€å°åŸæ ¹æ˜¯$3â€‹$ã€‚</p><hr><p>åŸæ ¹çš„åŸºæœ¬å®šä¹‰ï¼šè®¾$g$ä¸º$p$çš„ä¸€ä¸ªåŸæ ¹ï¼Œåˆ™æ»¡è¶³ï¼š<br>$$ğ‘”^{ğ‘âˆ’1}  \equiv 1(\mod p)$$<br>$$âˆ€1â‰¤ğ‘˜&lt;ğ‘âˆ’1, ğ‘”^ğ‘˜ \not \equiv 1(\mod p)$$</p><hr><p>ä¹‹åå‘¢ï¼Ÿä¹‹åæˆ‘ä»¬å°±æ‰¾ä¸€ä¸ªå‡½æ•°$q(x)$ï¼Œä»¤$$g^{q(x)} \equiv x(\bmod p)$$ ç›®çš„æ˜¯ä¸ºäº†æ„é€ ä¸€ä¸ª$l_x = q(F_x)$ï¼Œä½¿å¾—ç­‰å¼$$g^{l_x} \equiv \prod \limits_{i=1}^{k}g^{b_il_{x-i}}( \mod p)$$æˆç«‹ã€‚è€Œæ¯”è¾ƒç‰¹æ®Šçš„æ˜¯ï¼Œå› ä¸º$F_1$~$F_{k-1}$éƒ½ä¸º$1$ï¼Œæ‰€ä»¥$l_i=0\quad(1 \leq i &lt;k)$ ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´å¯¹äºæŒ‡æ•°ä¸Šçš„$l_x$æ»¡è¶³$$l_x \equiv \sum\limits_{i=1}^{k}b_il_{x-i}( \mod p-1)$$è¿™å°±æ˜¯ä¸€ä¸ªçº¿æ€§é€’æ¨çš„å½¢å¼äº†ã€‚</p><p>æ­¤å¤„æœ‰ä¸ªå°$trick$ï¼Œå°±æ˜¯æˆ‘ä»¬ä¸ºäº†é˜²æ­¢$l_x$è¿‡å¤§ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å®ƒå–æ¨¡ï¼Œæ­¤æ—¶ç›´æ¥ä¾æ®è´¹é©¬å°å®šç†ï¼Œå–$p-1$åšæ¨¡æ•°å³å¯ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªååˆ†å·§å¦™çš„$Idea$ï¼Œæˆ‘ä»¬è™½ç„¶ä¸çŸ¥é“$l_k$ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çŸ¥é“$l_k$åˆ°$l_n$æ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚è§‚å¯Ÿé¢˜ç›®æ€§è´¨ï¼Œ$$l_j = \omega_j l_k \mod(p-1)$$å…¶ä¸­çš„$\omega_j$æ˜¯ä¸€ä¸ªå…³äº$b_k$çš„å¸¸é‡å› å­ã€‚è¯æ˜ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå› ä¸º$l_i=0\quad(1 \leq i &lt; k) $æ˜¯æ˜¾ç„¶çš„ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åšä¸€ä¸‹çŸ©é˜µå¿«é€Ÿå¹‚â€”â€”å¹‚æ¬¡ä¸Šæ˜¯$n-k$â€”â€”å°±å¯ä»¥å¾—å‡º$\omega_n$æ¥ã€‚è€Œæˆ‘ä»¬çš„$l_n$æ˜¯å¯ä»¥é€šè¿‡å¯¹åŸæ ¹$g$æ±‚$BSGS$è§£å¾—çš„ã€‚é‚£ä¹ˆç°åœ¨å°±æ˜¯$$l_k\omega_n = l_n \mod (p-1)$$ç§»ä¸ªé¡¹å¯ä»¥å¾—åˆ°$$l_k \omega_n + t(p-1)= l_n$$ç”±äºåŸé¢˜è®©æ±‚çš„æ˜¯æœ€å°çš„æ­£æ•´æ•°è§£ï¼Œæ‰€ä»¥åº”ç”¨ä¸€ä¸‹$exgcd$åˆ¤ä¸€ä¸‹æ˜¯å¦æœ‰è§£å°±è§£å†³äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 108</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>&lt;LL, LL&gt; Hash ;</span><br><span class="line"><span class="keyword">int</span> N, T, base[MAXN] ;</span><br><span class="line">LL Ft, Hn, Xs, Ans, X, Y, G  ; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span>&#123;</span></span><br><span class="line">    LL M[MAXN][MAXN] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123; <span class="built_in">memset</span>(M, <span class="number">0</span>, <span class="keyword">sizeof</span>(M)) ;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        clear() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i) M[i][i] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">friend</span> <span class="keyword">operator</span> *(<span class="keyword">const</span> Matrix&amp;A, <span class="keyword">const</span> Matrix &amp;B)&#123;</span><br><span class="line">        Matrix Ans ; Ans.clear() ; </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span> ; k &lt;= N; ++ k)</span><br><span class="line">                    Ans.M[i][j] = (Ans.M[i][j] + A.M[i][k] * B.M[k][j]) % (Mod - <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">return</span> Ans ;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">friend</span> <span class="keyword">operator</span> +(<span class="keyword">const</span> Matrix&amp;A, <span class="keyword">const</span> Matrix &amp;B)&#123;</span><br><span class="line">        Matrix Ans ; Ans.clear() ; </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= N ; ++ j)</span><br><span class="line">                    Ans.M[i][j] = (A.M[i][j] + B.M[i][j]) % (Mod - <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">return</span> Ans ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> Matrix <span class="title">expow</span><span class="params">(Matrix T, LL P)</span></span>&#123;</span><br><span class="line">    Matrix Ans ; Ans.reset() ;</span><br><span class="line">    <span class="keyword">while</span> (P)&#123;</span><br><span class="line">        <span class="keyword">if</span> (P &amp; <span class="number">1</span>) Ans = Ans * T ;</span><br><span class="line">        T = T * T, P &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Ans ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL a, LL b, LL p)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) </span><br><span class="line">            (res *= a) %= p ;</span><br><span class="line">        (a *= a) %= p, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res % p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">bsgs</span><span class="params">(LL x, LL y, LL p)</span></span>&#123;</span><br><span class="line">    LL P = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p - <span class="number">1</span>)), Q = expow(x, -P + <span class="number">2</span> *(p - <span class="number">1</span>), p) ;</span><br><span class="line">    <span class="keyword">for</span> (LL i = <span class="number">1</span>, j = <span class="number">0</span> ; j &lt;= P ; ++ j, (i *= x) %= p)  <span class="keyword">if</span> (!Hash.count(i)) Hash[i] = j ; </span><br><span class="line">    <span class="keyword">for</span> (LL i = y, j = <span class="number">0</span>  ; j &lt;= P ; ++ j, (i *= Q) %= p)  <span class="keyword">if</span> (Hash.count(i)) <span class="keyword">return</span> Hash[i] + j * P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">exgcd</span><span class="params">(LL a, LL b, LL &amp;x, LL &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b) &#123;x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> a ;&#125;</span><br><span class="line">    LL t = exgcd(b, a % b, y, x) ;  y -=  a / b * x ; <span class="keyword">return</span> t ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> LL k = <span class="number">0</span>, p = <span class="number">1</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="string">'0'</span> || c &gt; <span class="string">'9'</span>) &#123; c = getchar() ; <span class="keyword">if</span> (c == <span class="string">'-'</span>) p = <span class="number">-1</span> ;&#125;</span><br><span class="line">    <span class="keyword">while</span> (c &lt;= <span class="string">'9'</span> &amp;&amp; c &gt;= <span class="string">'0'</span>) k = (k &lt;&lt; <span class="number">1</span>) + (k &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> k * p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">register</span> <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) base[i] = qr() ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T &gt;&gt; Ft ;  Matrix lab ;  lab.clear() ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">2</span> ; i &lt;= N ; ++ i) lab.M[i][i - <span class="number">1</span>] = <span class="number">1l</span>l  ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) lab.M[i][N] = <span class="number">1l</span>l * base[N -i + <span class="number">1</span>] ;</span><br><span class="line">    lab = expow(lab, T - N), Hn = bsgs(<span class="number">3</span>,Ft, Mod), Xs = lab.M[N][N] ; </span><br><span class="line">    G = exgcd(Xs, Mod - <span class="number">1</span>, X, Y) ; <span class="keyword">if</span> (Hn % G) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ;</span><br><span class="line">    X = (X % (Mod - <span class="number">1</span>) * (Hn / G) % (Mod - <span class="number">1</span>) + Mod - <span class="number">1</span>) % (Mod - <span class="number">1</span>) ;</span><br><span class="line">    Ans = expow(<span class="number">3</span>, X, Mod) ; <span class="built_in">cout</span> &lt;&lt; Ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="0x00-quad-åè®°"><a href="#0x00-quad-åè®°" class="headerlink" title="$0x00\quad$åè®°"></a>$0x00\quad$åè®°</h2><p>è¯´å®è¯ï¼Œè¿™æ˜¯ç¬¬ä¸€æ¬¡åšæ•´å¥—CFçš„é¢˜ç›®â€¦ç¡®å®ï¼Œåƒé‡ŒæŒ‘ä¸€çš„é¢˜ç›®å°±æ˜¯æ¯”ä½ è°·ä¸Šéšä¾¿æ‰¾å‡ é“é¢˜åšæ¥åŠ²ã€‚$A$~$E$éƒ½è¿˜å¥½ï¼Œä½†æ˜¯$F$å®åœ¨æ˜¯â€¦â€¦çœ‹é¢˜è§£éƒ½è¦æƒ³åŠå¤©çš„é‚£ç§â€¦â€¦å°¤å…¶æ˜¯è¿™ä¸ªè§£ç¦»æ•£æ–¹æ ¹çš„ä¸œè¥¿â€¦â€¦å“‡å¡æ¶å¿ƒæ­»äº†ä»æ²¡å¬è¯´è¿‡è¿˜æœ‰è¿™ä¸œè¥¿qaq</p><p>rqyè¯´$F$é¢˜æ˜¯çœé€‰ä¸€è½®çš„éš¾åº¦â€”â€”è™½ç„¶æ²¡è¯´æ˜¯$D$å‡ $T$å‡ ï¼Œä½†æˆ‘æ„Ÿè§‰ä»–çš„è¯­æ°”ä¸åƒæ˜¯åœ¨è¯´ä¸€é“å¾ˆéš¾çš„é¢˜â€¦â€¦</p><p>å®Œäº†ï¼Œè¦è·ªäº†ã€‚</p><blockquote><p>å¥¥èµ›æ–‡åŒ–è¯¾ä¸¤çˆ†ç‚¸ï¼Œçœé€‰è¿›é˜Ÿè¿›ä½ maï¼ŒæŒ‡æœ›ç€å°†æ¥æ²¡å­¦ä¸Šï¼Œè¿˜ä¸å¦‚æ”¶æ‹¾å¥½é“ºç›–æ—©å›å®¶ ã€‚</p><p>â€‹                                                    â€”â€”ï¼ˆpksã€Šæ˜¥æ—¥ç»å¥ã€‹ï¼‰</p></blockquote>]]></content>
    
    <summary type="html">
    
      æ˜¥èŠ‚å‰çš„ä¸€åœº$CF$ï½åå­—å¾ˆ$nice$çš„è¯´ï½
    
    </summary>
    
      <category term="é¢˜è§£" scheme="http://www.orchidany.cf/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’-æ™®é€šDP" scheme="http://www.orchidany.cf/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%99%AE%E9%80%9ADP/"/>
    
      <category term="BSGS" scheme="http://www.orchidany.cf/tags/BSGS/"/>
    
      <category term="çº¿æ€§ä»£æ•°-çŸ©é˜µ" scheme="http://www.orchidany.cf/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0-%E7%9F%A9%E9%98%B5/"/>
    
      <category term="CodeForces" scheme="http://www.orchidany.cf/tags/CodeForces/"/>
    
  </entry>
  
  <entry>
    <title>Lagrange FormulaÂ·æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•</title>
    <link href="http://www.orchidany.cf/2019/02/07/Lagrange-Formula/"/>
    <id>http://www.orchidany.cf/2019/02/07/Lagrange-Formula/</id>
    <published>2019-02-07T10:06:40.000Z</published>
    <updated>2019-03-16T13:16:44.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98---9cf.svg" alt=""></p><h2 id="rm-0x01-Preface"><a href="#rm-0x01-Preface" class="headerlink" title="$\rm{0x01~~} Preface$"></a>$\rm{0x01~~} Preface$</h2><p><strong>æ’å€¼($Interpolaton$)</strong> åœ¨å¤šé¡¹å¼åŸŸä¸­å¯ä»¥çœ‹åšæ˜¯<strong>æ±‚å€¼$(Evaluation)$</strong>çš„é€†è¿ç®—ï¼Œå³ç»™å®š$n$ç»„ç¡®å®šçš„æœ¬è´¨ä¸åŒçš„äºŒå…ƒç»„$(x_i, y_i)$ï¼Œæ»¡è¶³$F(x_i) = y_i$ï¼Œå¯ä»¥é€†å‘æ±‚å‡ºåŸ$n$æ¬¡å¤šé¡¹å¼ã€‚</p><p>è€Œå…¶å®ï¼Œæ‹‰æ ¼æœ—æ—¥æ’å€¼å…¬å¼æœ¬èº«æ˜¯æ ‡å‡†çš„$\Theta(n^2)$ç®—æ³•â€”â€”æˆ–è€…ä¸èƒ½ç§°å…¶ä¸ºç®—æ³•ï¼Œè¿ç®—è¿‡ç¨‹$\Theta(n^2)$æˆ–è®¸ä¼šæ›´å‡†ç¡®ä¸€äº›ã€‚$Indeed$ï¼Œè¯¥å…¬å¼æ˜¯æ„é€ å‡ºæ¥çš„ï¼Œæ‰€ä»¥æ²¡æœ‰å¤šä¹ˆç¹ççš„è¯æ˜â€”â€”</p><h2 id="rm-0x02-rm-Proof"><a href="#rm-0x02-rm-Proof" class="headerlink" title="$\rm{0x02}~~\rm{Proof}$"></a>$\rm{0x02}~~\rm{Proof}$</h2><h3 id="Proof-of-Existence"><a href="#Proof-of-Existence" class="headerlink" title="$Proof ~of~Existence$"></a>$Proof ~of~Existence$</h3><p>â€‹    æˆ‘ä»¬å®šä¹‰$F(x)$ä¸ºä¸€åœ¨å®æ•°åŸŸä¸Šçš„å¹³å‡¡$n-1$æ¬¡å¤šé¡¹å¼ã€‚</p><p>â€‹    é¦–å…ˆæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªå¯¹äºç¬¬$i$ä¸ªäºŒå…ƒç»„çš„ç‰¹æ®Šå¤šé¡¹å¼$L_i(x)$ï¼Œæ»¡è¶³$$L_i(x_j) = \begin{cases}1, &amp;\rm{i=j} \newline 0, &amp; \rm{i \neq j}\end{cases}$$</p><p>é‚£ä¹ˆæˆ‘ä»¬æ‰€æ±‚çš„å¤šé¡¹å¼$F(x)â€‹$å°±å¯ä»¥å†™ä½œ$$F(x)  = \sum L_i(x_i)\cdot y_iâ€‹$$è¿™ä¸ªå¼å­ä¿è¯äº†æˆ‘ä»¬å¯¹åº”çš„$nâ€‹$ä¸ªäºŒå…ƒç»„ï¼Œ$F(x)=yâ€‹$æ’æˆç«‹ã€‚</p><p>â€‹    é‚£ä¹ˆå¯¹äº$L_i(x)$ï¼Œæˆ‘ä»¬è€ƒè™‘ç”±æˆ‘ä»¬å¯¹$L_i(x)$çš„å®šä¹‰å¯ä»¥å¾—å‡º$$L_i(x) = k_i(x-x_1)(x-x_2)\cdots(x-x_n)$$å…¶ä¸­ä¸åŒ…å«$x-x_i$è¿™ä¸€å› å¼ã€‚è€Œç”±$L_i(x_i)=1$å¯çŸ¥æˆ‘ä»¬çš„æ¯”ä¾‹ç³»æ•°$$k_i=\frac{1}{(x_i-x_1)(x_i-x_2)\cdots(x_i - x_{i-1})(x_i - x_{i+1})\cdots(x_i-x_n)}$$é‚£ä¹ˆ$$L_i(x) = \prod\limits_{i=1, i \neq j}^{n}\frac{x - x_j}{x_i-x_j}$$ä»è€Œ$$F(x)=\sum L_i(x)\cdot y_i(x) = \sum y_i \cdot \prod\limits_{i=1, i \neq j}^{n}\frac{x - x_j}{x_i-x_j}$$</p><h3 id="mathcal-Q-E-D"><a href="#mathcal-Q-E-D" class="headerlink" title="$\mathcal{Q.E.D.}$"></a>$\mathcal{Q.E.D.}$</h3><hr><h3 id="Proof-of-Uniqueness-1"><a href="#Proof-of-Uniqueness-1" class="headerlink" title="$Proof~of~Uniqueness^{[1]}$"></a>$Proof~of~Uniqueness^{[1]}$</h3><p>â€‹    æˆ‘ä»¬æ¥ä¸‹æ¥è¦è¯æ˜çš„æ˜¯å¤šé¡¹å¼$L_i(x)â€‹$çš„å”¯ä¸€æ€§</p><p>â€‹    æˆ‘ä»¬å‡è®¾åŒæ—¶æœ‰ä¸¤ä¸ªå®æ•°åŸŸä¸Šçš„$n-1â€‹$æ¬¡å¤šé¡¹å¼$L_1(x),L_2(x)â€‹$æ»¡è¶³$L_i(x_j) = \begin{cases}1, &amp;\rm{i=j} \ 0, &amp; \rm{i \neq j}\end{cases}â€‹$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”±ä½œå·®æ³•å¯ä»¥å¾—å‡ºå¤šé¡¹å¼$L_{\Delta} = L_1 - L_2â€‹$åœ¨å–æ‰€æœ‰çš„$x_iâ€‹$æ—¶ï¼Œå…¶å€¼å‡ä¸º$0â€‹$ã€‚é‚£ä¹ˆä¸€å®šä¼šæœ‰å¤šé¡¹å¼$$Lâ€™(x) = \prod\limits_{i=1}^{n}(x - x_i)â€‹$$æ»¡è¶³$$Lâ€™|L_{\Delta}â€‹$$ å…¶ä¸­$|â€‹$è¡¨ç¤ºå¤šé¡¹å¼æ•´é™¤ã€‚ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äº$Lâ€™â€‹$è¿™ä¸ªå¤šé¡¹å¼ï¼Œå…¶æ¬¡æ•°ä¸º$n-1â€‹$ï¼›è€Œå¯¹äºæˆ‘ä»¬æ‰€å®šä¹‰çš„$L_i(x)â€‹$ï¼Œå‡ä¸º$(n-2)â€‹$æ¬¡çš„ï¼Œä»è€Œ$L_{\Delta}â€‹$ä¹Ÿæ˜¯$n-2â€‹$æ¬¡å¤šé¡¹å¼ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡º$$L_{\Delta} = 0â€‹$$ä»è€Œæœ‰$$L_1=L_2â€‹$$</p><h3 id="mathcal-Q-E-D-1"><a href="#mathcal-Q-E-D-1" class="headerlink" title="$\mathcal{Q.E.D.}$"></a>$\mathcal{Q.E.D.}$</h3><h2 id="rm-0x03-color-red-C-color-cyan-o-color-gold-d-color-green-e"><a href="#rm-0x03-color-red-C-color-cyan-o-color-gold-d-color-green-e" class="headerlink" title="$\rm{0x03~\color{red}{C}\color{cyan}{o}\color{gold}{d}\color{green}{e}}$"></a>$\rm{0x03~\color{red}{C}\color{cyan}{o}\color{gold}{d}\color{green}{e}}$</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">é¢˜å·ï¼šLuogu4781</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 2020</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 998244353</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; LL Ans, xs ;</span><br><span class="line"><span class="keyword">int</span> N, i, j ; LL T, t, xv[MAXN], yv[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL A, LL B)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (B)&#123;</span><br><span class="line">        <span class="keyword">if</span> (B &amp; <span class="number">1</span>) (res *= A) %= Mod ; </span><br><span class="line">        B &gt;&gt;= <span class="number">1</span>, (A *= A) %= Mod ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;xv[i], &amp;yv[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">        t = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i == j) <span class="keyword">continue</span> ;</span><br><span class="line">            (t *= (xv[i] - xv[j] + Mod)) %= Mod ;</span><br><span class="line">        &#125;</span><br><span class="line">        t = expow(t, Mod - <span class="number">2</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i == j) <span class="keyword">continue</span> ;</span><br><span class="line">            (t *= (T - xv[j] + Mod)) %= Mod ;</span><br><span class="line">        &#125;</span><br><span class="line">        (t *= yv[i]) %= Mod, (Ans += t) %= Mod ;</span><br><span class="line"><span class="comment">//cout &lt;&lt; Ans &lt;&lt; endl ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, Ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$\rm{Reference}$"></a>$\rm{Reference}$</h2><ul><li>$[1] $:Angel_Kittyçš„$blog$ã€Šæ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•ã€‹ <a href="https://www.cnblogs.com/ECJTUACM-873284962/p/6833391.html" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li></ul><h2 id="mathfrak-writter-pks"><a href="#mathfrak-writter-pks" class="headerlink" title="$\mathfrak{writter:pks}$"></a>$\mathfrak{writter:pks}$</h2>]]></content>
    
    <summary type="html">
    
      ä¸€ç§å¸¸è§çš„å‡½æ•°æ’å€¼æ³•ã€‚
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="Math - Lagrange Formula" scheme="http://www.orchidany.cf/tags/Math-Lagrange-Formula/"/>
    
  </entry>
  
  <entry>
    <title>ç¾¤è®ºå…¥é—¨</title>
    <link href="http://www.orchidany.cf/2019/02/06/%E7%BE%A4%E8%AE%BA%E5%85%A5%E9%97%A8/"/>
    <id>http://www.orchidany.cf/2019/02/06/ç¾¤è®ºå…¥é—¨/</id>
    <published>2019-02-06T01:55:55.000Z</published>
    <updated>2019-02-19T15:43:48.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å†™åœ¨å‰é¢ï¼šç¾¤ä½œä¸ºæŠ½è±¡ä»£æ•°é¢†åŸŸä¸­æ¯”è¾ƒåŸºç¡€çš„ä¸€ç¯ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æ²Ÿé€šåˆç­‰ä»£æ•°ã€åˆç­‰å‡ ä½•ä¸æŠ½è±¡ä»£æ•°çš„æ¡¥æ¢ï¼Œç€å®æ‰“å¼€äº†ç¬”è€…çš„çœ¼ç•Œã€‚æ­¤ç¯‡blogæ—¨åœ¨æ³›æ³›è°ˆä¸€äº›æ¯”è¾ƒåŸºç¡€çš„ç¾¤è®ºå†…å®¹ï¼ŒåŒ…æ‹¬ç¾¤çš„åŸºæœ¬å®šä¹‰ï¼Œå­ç¾¤çš„æ¦‚å¿µï¼Œé˜¶çš„æ¦‚å¿µç­‰ç­‰ï¼Œä¸å­˜åœ¨è¾ƒä¸ºè‰°æ·±çš„å†…å®¹ã€‚</p><h1 id="ç¾¤"><a href="#ç¾¤" class="headerlink" title="ç¾¤"></a>ç¾¤</h1><h2 id="1-ç¾¤çš„å®šä¹‰"><a href="#1-ç¾¤çš„å®šä¹‰" class="headerlink" title="$1~)~$ç¾¤çš„å®šä¹‰"></a>$1~)~$ç¾¤çš„å®šä¹‰</h2><p>æ¯”è¾ƒç®€å•çš„æ¥è®²ï¼Œæ‰€è°“<strong>ç¾¤$(\rm{group})$</strong>æŒ‡çš„æ˜¯ä¸€ç±»ç‰¹æ®Šçš„é›†åˆï¼Œè¿™ä¸ªé›†åˆåŒ…å«ä¸€ç»„å…ƒç´ å’Œå¤§äºç­‰äºä¸€ä¸ªçš„è¿ç®—ï¼Œæ¯”å¦‚ä¹˜æ³•ç¾¤æ•‘è®°ä½œ$(G,\cdot)$ã€‚é‚£ä¹ˆå¹³å‡¡æ¥è®²ï¼Œç¾¤æ»¡è¶³ä¸‹åˆ—å‡ ä¸ªæ€§è´¨ï¼š</p><p>æˆ‘ä»¬å‡å®šä¸€ä¸ªå¹³å‡¡çš„ç¾¤$G$æ”¯æŒ$\color{purple}{qwq}$è¿™ç§è¿ç®—ï¼š</p><h4 id="Property1-å°é—­æ€§-forall-a-in-G-b-in-G-a-color-purple-qwq-b-in-G"><a href="#Property1-å°é—­æ€§-forall-a-in-G-b-in-G-a-color-purple-qwq-b-in-G" class="headerlink" title="$Property1~~$å°é—­æ€§$\forall a\in G, b\in G, a~\color{purple}{qwq}~b \in G$"></a>$Property1~~$å°é—­æ€§$\forall a\in G, b\in G, a~\color{purple}{qwq}~b \in G$</h4><h4 id="Property2-è¿ç®—çš„ç»“åˆæ€§-a-color-purple-qwq-b-color-purple-qwq-c-a-color-purple-qwq-b-qwq-c"><a href="#Property2-è¿ç®—çš„ç»“åˆæ€§-a-color-purple-qwq-b-color-purple-qwq-c-a-color-purple-qwq-b-qwq-c" class="headerlink" title="$Property2~~$è¿ç®—çš„ç»“åˆæ€§$(a~\color{purple}{qwq}~b) ~\color{purple}{qwq}~ c=a~\color{purple}{qwq}~ (b ~qwq~ c)$"></a>$Property2~~$è¿ç®—çš„ç»“åˆæ€§$(a~\color{purple}{qwq}~b) ~\color{purple}{qwq}~ c=a~\color{purple}{qwq}~ (b ~qwq~ c)$</h4><h4 id="Property3-å­˜åœ¨å•ä½å…ƒï¼ˆå¹ºå…ƒï¼‰æ»¡è¶³ä»¥ä¸‹å®šä¹‰ï¼š-exists-e-in-G-s-t-forall-a-in-G-e-color-purple-qwq-a-a-color-purple-qwq-e-a"><a href="#Property3-å­˜åœ¨å•ä½å…ƒï¼ˆå¹ºå…ƒï¼‰æ»¡è¶³ä»¥ä¸‹å®šä¹‰ï¼š-exists-e-in-G-s-t-forall-a-in-G-e-color-purple-qwq-a-a-color-purple-qwq-e-a" class="headerlink" title="$Property3~~$å­˜åœ¨å•ä½å…ƒï¼ˆå¹ºå…ƒï¼‰æ»¡è¶³ä»¥ä¸‹å®šä¹‰ï¼š$\exists e\in G, s.t. \forall a\in G, e~\color{purple}{qwq}~ a=a~\color{purple}{qwq}~e=a$"></a>$Property3~~$å­˜åœ¨å•ä½å…ƒï¼ˆå¹ºå…ƒï¼‰æ»¡è¶³ä»¥ä¸‹å®šä¹‰ï¼š$\exists e\in G, s.t. \forall a\in G, e~\color{purple}{qwq}~ a=a~\color{purple}{qwq}~e=a$</h4><h4 id="Property4-å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œå­˜åœ¨é€†å…ƒï¼Œå³æ»¡è¶³-forall-a-in-G-exists-b-in-G-s-t-a-color-purple-qwq-b-b-color-purple-qwq-a-e"><a href="#Property4-å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œå­˜åœ¨é€†å…ƒï¼Œå³æ»¡è¶³-forall-a-in-G-exists-b-in-G-s-t-a-color-purple-qwq-b-b-color-purple-qwq-a-e" class="headerlink" title="$Property4~~$å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œå­˜åœ¨é€†å…ƒï¼Œå³æ»¡è¶³ $\forall a\in G, \exists b\in G, s.t. a~\color{purple}{qwq}~ b=b~\color{purple}{qwq}~a=e$"></a>$Property4~~$å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œå­˜åœ¨é€†å…ƒï¼Œå³æ»¡è¶³ $\forall a\in G, \exists b\in G, s.t. a~\color{purple}{qwq}~ b=b~\color{purple}{qwq}~a=e$</h4><p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´çš„ç›´ç™½ç‚¹å§ï¼Œå¯¹æ‰€æœ‰çš„å…ƒç´ ï¼Œåšå®Œè¯¥ç¾¤æ‰€å¸¦æœ‰çš„<strong>å¸¦æœ‰ç»“åˆå¾‹çš„è¿ç®—</strong>ä¹‹åï¼Œæ‰€å¾—ç»“æœ<strong>ä»ç„¶å±äºè¯¥ç¾¤</strong>ä¸”ä¸€å®šå­˜åœ¨å•ä½å…ƒï¼Œå¯¹äºæ¯ä¸ªå…ƒç´ å­˜åœ¨è¿ç®—é€†å…ƒã€‚</p><p>é‚£æˆ‘ä»¬ä¸å¦¨å®šä¹‰ä¸€äº›å…¶ä»–çš„ï¼š</p><ul><li><h3 id="é˜¿è´å°”ç¾¤-Abel-Group-ï¼šå³äº¤æ¢ç¾¤â€”â€”è¿ç®—æ»¡è¶³äº¤æ¢å¾‹çš„ç¾¤ã€‚"><a href="#é˜¿è´å°”ç¾¤-Abel-Group-ï¼šå³äº¤æ¢ç¾¤â€”â€”è¿ç®—æ»¡è¶³äº¤æ¢å¾‹çš„ç¾¤ã€‚" class="headerlink" title="é˜¿è´å°”ç¾¤$(Abel~ Group)$ï¼šå³äº¤æ¢ç¾¤â€”â€”è¿ç®—æ»¡è¶³äº¤æ¢å¾‹çš„ç¾¤ã€‚"></a>é˜¿è´å°”ç¾¤$(Abel~ Group)$ï¼šå³äº¤æ¢ç¾¤â€”â€”è¿ç®—æ»¡è¶³äº¤æ¢å¾‹çš„ç¾¤ã€‚</h3></li><li><h3 id="åŠç¾¤ï¼šæ»¡è¶³å°é—­æ€§å’Œç»“åˆå¾‹çš„ç¾¤ã€‚"><a href="#åŠç¾¤ï¼šæ»¡è¶³å°é—­æ€§å’Œç»“åˆå¾‹çš„ç¾¤ã€‚" class="headerlink" title="åŠç¾¤ï¼šæ»¡è¶³å°é—­æ€§å’Œç»“åˆå¾‹çš„ç¾¤ã€‚"></a>åŠç¾¤ï¼šæ»¡è¶³å°é—­æ€§å’Œç»“åˆå¾‹çš„ç¾¤ã€‚</h3></li><li><h3 id="æœ‰é™ç¾¤-Finite-Group-ï¼šå…ƒç´ ä¸ªæ•°æœ‰é™çš„ç¾¤ç§°ä¸ºæœ‰é™ç¾¤-è€Œæœ‰é™ç¾¤çš„å…ƒç´ ä¸ªæ•°ç§°ä½œæœ‰é™ç¾¤çš„é˜¶"><a href="#æœ‰é™ç¾¤-Finite-Group-ï¼šå…ƒç´ ä¸ªæ•°æœ‰é™çš„ç¾¤ç§°ä¸ºæœ‰é™ç¾¤-è€Œæœ‰é™ç¾¤çš„å…ƒç´ ä¸ªæ•°ç§°ä½œæœ‰é™ç¾¤çš„é˜¶" class="headerlink" title="æœ‰é™ç¾¤$(Finite~Group)$ï¼šå…ƒç´ ä¸ªæ•°æœ‰é™çš„ç¾¤ç§°ä¸ºæœ‰é™ç¾¤,è€Œæœ‰é™ç¾¤çš„å…ƒç´ ä¸ªæ•°ç§°ä½œæœ‰é™ç¾¤çš„é˜¶"></a>æœ‰é™ç¾¤$(Finite~Group)$ï¼šå…ƒç´ ä¸ªæ•°æœ‰é™çš„ç¾¤ç§°ä¸ºæœ‰é™ç¾¤,è€Œæœ‰é™ç¾¤çš„å…ƒç´ ä¸ªæ•°ç§°ä½œæœ‰é™ç¾¤çš„é˜¶</h3></li></ul><p>ç»“åˆå‡ ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ï¼š</p><p>æ¯”å¦‚ä»¥ä¸‹æ˜¯å‡ ä¸ªä¹˜æ³•ç¾¤ $$ (Q\setminus{0}~,~\cdot)â€‹$$ $$(R\setminus{0}~, ~\cdot)â€‹$$$$ (C\setminus{0}~,~\cdot)â€‹$$</p><p>ä»–ä»¬éƒ½ä¸èƒ½åŒ…æ‹¬$0$è¿™ä¸ªå…ƒç´ ï¼Œå› ä¸ºè¿™ä¸ªå…ƒç´ æ˜¾ç„¶æ˜¯æ²¡æœ‰é€†å…ƒçš„ã€‚</p><p>æˆ–è€…ä¸€ä¸ªå¥½ç©å„¿çš„ä¹˜æ³•ç¾¤$$((1, -1)~~, ~~\cdot)$$æˆ–è€…æ˜¯æ‰€æœ‰<strong>éå¥‡å¼‚çš„$n$é˜¶çŸ©é˜µ</strong>ä¹Ÿå¯ä»¥ç»„æˆä¸€ä¸ªä¹˜æ³•ç¾¤ã€‚</p><p>æˆ–è€…æ˜¯$$(Z~,~+)$$è¿™ä¸ªç¾¤æ¯”è¾ƒç»å…¸$233$ï¼Œå…¶ä¸­æˆ‘ä»¬å€ŸåŠ©è¿™ä¸ªæ¥ç»ƒä¹ ä¸€ä¸‹å¦‚ä½•åˆ¤æ–­<strong>æ˜¯å¦æˆç¾¤</strong>,é¦–å…ˆæ€è€ƒï¼Œè¿™ä¸ªä¸œè¥¿ä¸€å®šæ˜¯å°é—­çš„ï¼Œå› ä¸ºæœ€åä¼šæ”¶æ•›äº$\pm \inf$æ‰€ä»¥ä¸€å®šå°é—­ï¼Œå…¶æ¬¡è¿ç®—æ˜¯ä¸€å®šç¬¦åˆç»“åˆå¾‹çš„ï¼Œç„¶åå•ä½å…ƒè‚¯å®šå°±æ˜¯$0$ï¼Œæœ€åé€†å…ƒçš„è¯ï¼Œå¯¹äº$n$é‚£å°±ä¸€å®šæ˜¯$-n$äº†ï¼ˆç´§æ‰£å®šä¹‰å³å¯ï¼‰ã€‚</p><hr><p>$Extra   Things :$</p><p>ä»¥ä¸‹æ˜¯ä¸¤ç§å¤åˆæŠ½ä»£æ•°æ®ç»“æ„ï¼ˆåå­—è‡ªå·±èµ·çš„$233$ï¼‰ï¼š</p><h3 id="ç¯ï¼šå®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ-G-cdot-å…¶ä¸­-G-æ˜¯é˜¿è´å°”ç¾¤ï¼Œ-G-cdot-æ˜¯åŠç¾¤"><a href="#ç¯ï¼šå®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ-G-cdot-å…¶ä¸­-G-æ˜¯é˜¿è´å°”ç¾¤ï¼Œ-G-cdot-æ˜¯åŠç¾¤" class="headerlink" title="ç¯ï¼šå®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ$(G,+,\cdot)$å…¶ä¸­$(G,+)$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$(G,\cdot)$æ˜¯åŠç¾¤"></a>ç¯ï¼šå®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ$(G,+,\cdot)$å…¶ä¸­$(G,+)$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$(G,\cdot)$æ˜¯åŠç¾¤</h3><p>ä¸¾ä¾‹å­ï¼š$Z$, $R[x]$ï¼Œå³æ•´æ•°ç¯å’Œ$R$ä¸Šçš„æ‰€æœ‰å¤šé¡¹å¼çš„é›†åˆã€‚</p><h3 id="åŸŸï¼šåŒæ ·å®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ-F-cdot-å…¶ä¸­-F-æ˜¯é˜¿è´å°”ç¾¤ï¼Œ-F-setminus-0-cdot-æ˜¯é˜¿è´å°”ç¾¤"><a href="#åŸŸï¼šåŒæ ·å®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ-F-cdot-å…¶ä¸­-F-æ˜¯é˜¿è´å°”ç¾¤ï¼Œ-F-setminus-0-cdot-æ˜¯é˜¿è´å°”ç¾¤" class="headerlink" title="åŸŸï¼šåŒæ ·å®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ$(F,+,\cdot)$å…¶ä¸­$(F,+)$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$(F\setminus{0},\cdot)$æ˜¯é˜¿è´å°”ç¾¤"></a>åŸŸï¼šåŒæ ·å®šä¹‰åœ¨ä¸¤ä¸ªè¿ç®—ä¸Šï¼Œ$(F,+,\cdot)$å…¶ä¸­$(F,+)$æ˜¯é˜¿è´å°”ç¾¤ï¼Œ$(F\setminus{0},\cdot)$æ˜¯é˜¿è´å°”ç¾¤</h3><p>ä¸¾ä¾‹å­ ï¼š$Q,R,C$å³æœ‰ç†æ•°åŸŸã€å®æ•°åŸŸå’Œå¤æ•°åŸŸã€‚</p><hr><p>å¥½çš„ï¼Œé‚£æˆ‘ä»¬å°è¯•è¯æ˜ä¸¤ä¸ªå‘½é¢˜ï¼š</p><h3 id="Proposition1-ä¸€ä¸ªç¾¤ä¸­çš„å•ä½å…ƒå”¯ä¸€"><a href="#Proposition1-ä¸€ä¸ªç¾¤ä¸­çš„å•ä½å…ƒå”¯ä¸€" class="headerlink" title="$Proposition1~~~~$ä¸€ä¸ªç¾¤ä¸­çš„å•ä½å…ƒå”¯ä¸€"></a>$Proposition1~~~~$ä¸€ä¸ªç¾¤ä¸­çš„å•ä½å…ƒå”¯ä¸€</h3><p>è®¾æœ‰ä¸¤ä¸ªå•ä½å…ƒ$e_1,e_2$</p><p>é‚£ä¹ˆ$e_1=e_1e_2=e_2$ï¼Œå…¶å®æ˜¯ä¸€ä¸ª$233$</p><h3 id="Proposition2-ç¾¤ä¸­å…ƒç´ çš„é€†å…ƒå”¯ä¸€"><a href="#Proposition2-ç¾¤ä¸­å…ƒç´ çš„é€†å…ƒå”¯ä¸€" class="headerlink" title="$Proposition2~~~~$ç¾¤ä¸­å…ƒç´ çš„é€†å…ƒå”¯ä¸€"></a>$Proposition2~~~~$ç¾¤ä¸­å…ƒç´ çš„é€†å…ƒå”¯ä¸€</h3><p>ä»¥ä¹˜æ³•ç¾¤ä¸ºä¾‹ï¼Œå‡è®¾$a$æœ‰ä¸¤ä¸ªé€†å…ƒ$b,c$ï¼Œé‚£ä¹ˆä¸€å®šä¼šæœ‰$$b = b \cdot(a \cdot c) = (b \cdot a) \cdot c = c$$</p><p>æ˜¾ç„¶ä¹Ÿæ˜¯åŒä¸€ä¸ªã€‚</p><p>é‚£ä¹ˆæ­¤æ—¶æˆ‘æ‰“ç®—æ•´ç†ä¸€ä¸ªç¾¤çš„å…±æ€§ç‰¹å¾ï¼š<br>$$(ab)^{-1}=b^{-1}a^{-1}$$</p><p>å¾ˆæ˜¾ç„¶ï¼Œè¯æ˜å¦‚ä¸‹ï¼š<br>$$ab(b^{-1}a^{-1})=b^{-1}a^{-1})ab=e$$</p><p>æè¿™ä¸ªçš„ç›®çš„å°±æ˜¯ï¼Œæˆ‘ä»¬å‘ç°åœ¨çŸ©é˜µçš„ç›¸å…³å†…å®¹é‡Œé¢ä¹Ÿæœ‰è¿™ä»¶äº‹å„¿~æ‰€ä»¥å°±å¾ˆå¼€å¿ƒ</p><p>é‚£ä¹ˆä¹‹åæˆ‘ä»¬è®¨è®º<strong>å‘¨æœŸ</strong></p><p>å¯¹äºä¸€ä¸ªå…ƒç´ $a \in G$è€Œè¨€ï¼Œæˆ‘ä»¬è®°$a$çš„å‘¨æœŸæ˜¯$o(a)$</p><p>$o(a)$è¡¨ç¤ºæœ€å°æ­£æ•´æ•°ï¼Œä½¿å¾—$a^{o(a)}=e$</p><hr><h2 id="2-å­ç¾¤åŠè¡ç”Ÿ"><a href="#2-å­ç¾¤åŠè¡ç”Ÿ" class="headerlink" title="$2~)~$å­ç¾¤åŠè¡ç”Ÿ"></a>$2~)~$å­ç¾¤åŠè¡ç”Ÿ</h2><p>æœ¬èŠ‚æ‰€æŒ‡<strong>â€œç¾¤â€</strong>æ²¡æœ‰ç‰¹åˆ«è¯´æ˜ä¾¿å‡ä¸º<strong>æœ‰é™ç¾¤</strong></p><p>ä¸å¦¨å…ˆç»™å‡ºå­ç¾¤çš„æµ…æ˜¾ç‰ˆå®šä¹‰ï¼š</p><h3 id="å¦‚æœå¯¹äºä¸€ä¸ªç¾¤-G-C-ï¼Œå…¶ä¸­-H-subseteq-G-ï¼Œä¸”-H-C-æ˜¯ç¾¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°åœ¨è¿ç®—-C-ä¸‹ï¼Œ-H-æ˜¯-G-çš„å­ç¾¤ï¼Œç”¨-H-leq-G-è¡¨ç¤º"><a href="#å¦‚æœå¯¹äºä¸€ä¸ªç¾¤-G-C-ï¼Œå…¶ä¸­-H-subseteq-G-ï¼Œä¸”-H-C-æ˜¯ç¾¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°åœ¨è¿ç®—-C-ä¸‹ï¼Œ-H-æ˜¯-G-çš„å­ç¾¤ï¼Œç”¨-H-leq-G-è¡¨ç¤º" class="headerlink" title="å¦‚æœå¯¹äºä¸€ä¸ªç¾¤$(G, C)$ ï¼Œå…¶ä¸­$H\subseteq G$,ï¼Œä¸” $(H,C)$æ˜¯ç¾¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°åœ¨è¿ç®—$C$ä¸‹ï¼Œ$H$æ˜¯$G$çš„å­ç¾¤ï¼Œç”¨$H\leq G$è¡¨ç¤º"></a>å¦‚æœå¯¹äºä¸€ä¸ªç¾¤$(G, C)$ ï¼Œå…¶ä¸­$H\subseteq G$,ï¼Œä¸” $(H,C)$æ˜¯ç¾¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°åœ¨è¿ç®—$C$ä¸‹ï¼Œ$H$æ˜¯$G$çš„å­ç¾¤ï¼Œç”¨$H\leq G$è¡¨ç¤º</h3><p>é‚£ä¹ˆä»è€Œæˆ‘ä»¬å¯ä»¥å®šä¹‰<strong>ç”Ÿæˆå­ç¾¤</strong>è¿™ä¸ªä¸œè¥¿ï¼š</p><p><strong>ç”Ÿæˆå­ç¾¤ï¼šè‹¥$S \subseteq Gâ€‹$ï¼Œ å¹¶ä¸”å¯¹äºè¿ç®—$Câ€‹$è€Œè¨€ï¼Œ$(G,C)â€‹$ä¹Ÿæ˜¯ä¸€ä¸ªç¾¤ï¼Œé‚£ä¹ˆå°±ç§°$Gâ€‹$ä¸ºé›†åˆ$Sâ€‹$åœ¨è¿ç®—$Câ€‹$ä¸‹çš„ç”Ÿæˆå­ç¾¤ã€‚é›†åˆ$Sâ€‹$çš„ç”Ÿæˆå­ç¾¤ç”¨$&lt;â€‹$$Sâ€‹$$&gt;â€‹$è¡¨ç¤º</strong></p><p>è¿™ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å®šä¹‰<strong>é™ªé›†</strong>è¿™ä¸ªæ¦‚å¿µ</p><p>é™ªé›†ä¸€èˆ¬ä¸ŠåŒ…å«<strong>å·¦é™ªé›†</strong>å’Œ<strong>å³é™ªé›†</strong>ã€‚</p><h3 id="å·¦é™ªé›†ï¼šå¦‚æœ-H-leq-G-ï¼Œå¯¹äº-a-in-G-ï¼Œå®šä¹‰é›†åˆ-H-a-x-in-G-exists-h-in-H-ah-x-ä¸º-H-çš„ä¸å…ƒç´ -a-å·¦é™ªé›†ã€‚"><a href="#å·¦é™ªé›†ï¼šå¦‚æœ-H-leq-G-ï¼Œå¯¹äº-a-in-G-ï¼Œå®šä¹‰é›†åˆ-H-a-x-in-G-exists-h-in-H-ah-x-ä¸º-H-çš„ä¸å…ƒç´ -a-å·¦é™ªé›†ã€‚" class="headerlink" title="å·¦é™ªé›†ï¼šå¦‚æœ$H \leq G$ï¼Œå¯¹äº$a \in G$ï¼Œå®šä¹‰é›†åˆ$H_a = {x\in G~|~ \exists h\in H, ah=x}$ä¸º$H$çš„ä¸å…ƒç´ $a$å·¦é™ªé›†ã€‚"></a>å·¦é™ªé›†ï¼šå¦‚æœ$H \leq G$ï¼Œå¯¹äº$a \in G$ï¼Œå®šä¹‰é›†åˆ$H_a = {x\in G~|~ \exists h\in H, ah=x}$ä¸º$H$çš„ä¸å…ƒç´ $a$å·¦é™ªé›†ã€‚</h3><h3 id="å³é™ªé›†ï¼š-å¦‚æœ-H-leq-G-ï¼Œå¯¹äº-a-in-G-ï¼Œå®šä¹‰é›†åˆ-H-a-x-in-G-exists-h-in-H-ha-x-ä¸º-H-çš„å³é™ªé›†ã€‚"><a href="#å³é™ªé›†ï¼š-å¦‚æœ-H-leq-G-ï¼Œå¯¹äº-a-in-G-ï¼Œå®šä¹‰é›†åˆ-H-a-x-in-G-exists-h-in-H-ha-x-ä¸º-H-çš„å³é™ªé›†ã€‚" class="headerlink" title="å³é™ªé›†ï¼š å¦‚æœ$H \leq G$ï¼Œå¯¹äº$a \in G$ï¼Œå®šä¹‰é›†åˆ$H_a = {x\in G~|~ \exists h\in H, ha=x}$ä¸º$H$çš„å³é™ªé›†ã€‚"></a>å³é™ªé›†ï¼š å¦‚æœ$H \leq G$ï¼Œå¯¹äº$a \in G$ï¼Œå®šä¹‰é›†åˆ$H_a = {x\in G~|~ \exists h\in H, ha=x}$ä¸º$H$çš„å³é™ªé›†ã€‚</h3><p>$233$ä¹Ÿå¯ä»¥å«åš<strong>å‚é›†</strong>æˆ–è€…<strong>æ—ç³»</strong>ä¹‹ç±»çš„~</p><p>é‚£ä¹ˆæˆ‘ä»¬è¿™ä¸ªåœ°æ–¹å…ˆåªç ”ç©¶å³é™ªé›†$233$</p><h4 id="Lemma1"><a href="#Lemma1" class="headerlink" title="$Lemma1:$"></a>$Lemma1:$</h4><p>æˆ‘ä»¬é¦–å…ˆè¯æ˜ä¸€ç‚¹ï¼š$|H|=|H_a|$ï¼Œå…¶ä¸­é•¿å¾—åƒç»å¯¹å€¼ç¬¦å·çš„ç«–çº¿è¡¨ç¤ºçš„æ˜¯æœ‰é™ç¾¤çš„<strong>ç¾¤ä¸­å…ƒç´ æ•°é‡</strong>ã€‚ </p><p>è¿™ä¸ªå…¶å®æ¯”è¾ƒæ˜¾ç„¶ï¼Œå› ä¸ºäº‹å®ä¸Šç¾¤éƒ½æ˜¯å®šä¹‰åœ¨<strong>éå¯é‡é›†</strong>ä¸Šé¢çš„ã€‚</p><p>è¾ƒä¸ºä¸¥è°¨çš„è¯æ˜å¦‚ä¸‹ï¼š</p><hr><p>$Proof.$</p><p>å¯¹äº$H \leq G$ï¼Œå¦‚æœ$h_1\neq h_2 \in H$ï¼Œé‚£ä¹ˆ$h_1a\neq h_2a$</p><p>åè¯ï¼šè‹¥$h_1a=h_2a$ï¼Œ$h_1aa^{-1}=h_2aa^{-1},~h_1=h_2$çŸ›ç›¾</p><p>å¯¹äºä¸åŒçš„$h$ï¼Œ$ha$äº’ä¸ç›¸åŒï¼Œå› æ­¤$|H_a|=|H|$</p><hr><h4 id="Lemma2"><a href="#Lemma2" class="headerlink" title="$Lemma2:$"></a>$Lemma2:$</h4><p>ä¹‹åæˆ‘ä»¬å†è¯æ˜ä¸€äº›å¥½ç©å„¿çš„ï¼š</p><p>å‘½é¢˜ï¼š$H_a=H_b$å½“ä¸”ä»…å½“$ab^{-1}\in H$ </p><p>çœ‹èµ·æ¥å¥½åƒä¸æ˜¯é‚£ä¹ˆå¥½ç©â€¦â€¦</p><hr><p>$Proof.$</p><p>è‹¥$H_a=H_b$ï¼Œåˆ™$ea\in H_a$ï¼Œå³$a\in H_b$ï¼Œé‚£ä¹ˆ$\exists h\in H,~a=hb$,é‚£ä¹ˆ$ab^{-1}=h$</p><p>è‹¥$ab^{-1}\in H$ï¼Œé‚£ä¹ˆ$ha=ha(b^{-1}b)=(hab^{-1})b\in Hb$ï¼Œå› æ­¤$H_a\subseteq H_b$</p><p>$hb=hb(a^{-1}a)=h(ab^{-1})^{-1}a\in H_a$ï¼Œæ•…$H_b\subseteq H_a$</p><p>å› æ­¤$H_a=H_b$</p><hr><p>é‚£ä¹ˆæˆ‘ä»¬è¿˜å¯ä»¥æœ‰ä¸€ä¸ªæ¨è®ºï¼š</p><p>è‹¥$H_a\neq H_b$ï¼Œé‚£ä¹ˆ$H_a\cap H_b = \emptyset$</p><hr><p>$Proof.$</p><p>å‡è®¾$x\in H_a\cap H_b$ï¼Œ åˆ™$\exists h_1,h_2\in H$ï¼Œ$h_1a=h_2b=x$ ï¼Œ é‚£ä¹ˆ$ab^{-1}=h_1^{-1}h_2\in H$ï¼Œé‚£ä¹ˆ$H_a=H_b$ï¼ŒçŸ›ç›¾</p><hr><p>ä»è€Œè¿˜å¯ä»¥æœ‰ä¸ªå®šç†ï¼ˆ$Lagrange$å®šç†ï¼‰ï¼š</p><p>ç”±äº$\forall g\in G$ï¼Œ $g\in Hg$ï¼Œæ‰€ä»¥$G$ä¸­æ¯ä¸ªå…ƒç´ éƒ½åœ¨æŸä¸ªå‚é›†ä¸­ã€‚ç”¨$[G:H]$è¡¨ç¤ºä¸åŒçš„å‚é›†æ•°ï¼Œé‚£ä¹ˆ</p><p>$$|G|=|H|\cdot [G:H]$$</p><p>ä¹Ÿå°±æ˜¯è¯´$|H|$æ˜¯$|G|$çš„çº¦æ•°ã€‚</p><p>è¿™ä¸ªå…¶å®å¾ˆæ˜¾ç„¶ï¼Œå› ä¸ºä¸åŒå…ƒç´ çš„å‚é›†å¦‚æœä¸åŒå°±ä¸ä¼šæœ‰äº¤é›†ï¼Œå¦‚æœç›¸åŒå°±ä¸ä¼šè¢«è€ƒè™‘åˆ°$[G:H]$é‡Œé¢ã€‚æ‰€ä»¥ç»“è®ºå¹³å‡¡ã€‚</p><p>ä½†æ˜¯å…¶å®è¿™æ˜¯ä¸ªå¾ˆä¼Ÿå¤§çš„å®šç†$233$ </p><hr><p>å¥½çš„ï¼Œé‚£ä¹ˆä»è€Œå°±ä¼šæœ‰ä¸€äº›ç¥å¥‡çš„æ¨è®ºï¼š</p><p><strong>æ¨è®ºä¸€ ï¼š å¯¹äºä¸€ä¸ªå…ƒç´ $a \in G$ï¼Œ$G$æ˜¯ä¸€ä¸ªç¾¤ï¼Œé‚£ä¹ˆ$o(a) | |G|$ </strong></p><p><strong>$Proof.$</strong> å› ä¸º$o(a) = |$$&lt;$$a$$&gt;$$|$ï¼Œç”±æˆ‘ä»¬åˆšåˆšè¯æ˜çš„å®šç†å¯ä»¥å¾—å‡º$o(a) | |G|$ </p><p><strong>æ¨è®ºäºŒï¼šå¯¹ä»»æ„çš„$a \in G,a ^{|G|} = e$</strong></p><p>$Proof.$ æ¯”è¾ƒæ˜¾ç„¶ï¼Œç”±æ¨è®ºä¸€å¯çŸ¥ã€‚</p><p><strong>æ¨è®ºä¸‰ï¼šè‹¥$|G|$ä¸ºç´ æ•°ï¼Œåˆ™$G$æ˜¯å¾ªç¯ç¾¤</strong></p><p>$Proof.$ è‹¥$a \neq e$ï¼Œé‚£ä¹ˆä¼šæœ‰$|$$&lt;$$a$$&gt;$$|$æ•´é™¤$|G|$ã€‚è€Œç”±äº$|G|$æ˜¯ä¸ªç´ æ•°ï¼Œæ‰€ä»¥åªæœ‰å¯èƒ½$|G| = |$$&lt;$$a$$&gt;$$|$ ï¼Œæ‰€ä»¥$G$æ˜¯ä¸ªå¾ªç¯ç¾¤ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœŸçš„è¦å»åšäº›å¥½ç©çš„äº†~</p><hr><h3 id="å®šç†-1-Â·-Fermat-å°å®šç†"><a href="#å®šç†-1-Â·-Fermat-å°å®šç†" class="headerlink" title="å®šç†$1$Â·$Fermat$å°å®šç†"></a>å®šç†$1$Â·$Fermat$å°å®šç†</h3><p>å¦‚æœ$p$ä¸ºç´ æ•°ï¼Œé‚£ä¹ˆå­˜åœ¨$a^{p-1} \equiv 1 (\mod p) $</p><h3 id="Proof"><a href="#Proof" class="headerlink" title="$Proof. $"></a>$Proof. $</h3><p>è€ƒè™‘è´¨æ•°$p$ï¼Œè€ƒè™‘ç¾¤$G=${$1,2,\dots,p-1$}ï¼Œç¾¤çš„è¿ç®—å®šä¹‰ä¸ºå¯¹$p$å–æ¨¡çš„ä¹˜æ³•ï¼Œé‚£ä¹ˆç”±$Lagrange$å¯çŸ¥ï¼š</p><p>$$\forall a\in G, a^{p-1}=1(\mod p)$$ </p><h3 id="å®šç†2Â·-Euler-å®šç†"><a href="#å®šç†2Â·-Euler-å®šç†" class="headerlink" title="å®šç†2Â·$Euler$å®šç†"></a>å®šç†2Â·$Euler$å®šç†</h3><p>$a^{\phi(n)}=1 (\mod n)$</p><h3 id="Proof-1"><a href="#Proof-1" class="headerlink" title="$Proof.$"></a>$Proof.$</h3><p>è€ƒè™‘$n\in N^{+}$ï¼Œè€ƒè™‘ç¾¤$G=$ {$1\leq x\leq n~|~gcd(x,n)=1$ },ç¾¤çš„è¿ç®—å®šä¹‰ä¸ºå¯¹$n$å–æ¨¡çš„ä¹˜æ³•</p><p>é‚£ä¹ˆä¼šæœ‰$|G|=\phi(n)$ï¼Œä»è€Œæœ‰ï¼š</p><p>$$\forall a\in G, a^{\phi(n)}=1 (\mod n)$$</p><hr><p>æ²¡é”™ï¼Œè¯æ˜ååˆ†çš„ç®€æ´ç¾è§‚ã€‚</p><p>ä½œè€…è¢«è¿™ç§ç¥å¥‡çš„è¯æ˜ç»™æŠ˜æœäº†$stO$.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="æŠ½è±¡ä»£æ•°-ç¾¤è®º" scheme="http://www.orchidany.cf/tags/%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0-%E7%BE%A4%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>BSGS-JuniorÂ·BSGSç®—æ³•åˆæ¢</title>
    <link href="http://www.orchidany.cf/2019/02/06/BSGS-junior/"/>
    <id>http://www.orchidany.cf/2019/02/06/BSGS-junior/</id>
    <published>2019-02-05T23:48:17.000Z</published>
    <updated>2019-03-16T13:08:58.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98---9cf.svg" alt=""></p><h1 id="rm-0x01-mathcal-Preface"><a href="#rm-0x01-mathcal-Preface" class="headerlink" title="$\rm{0x01}$  $\mathcal{Preface}$"></a>$\rm{0x01}$  $\mathcal{Preface}$</h1><p><strong>$\rm{BSGS}(Baby~Step~Giant~Step)$, å¤§æ­¥å°æ­¥æ³•</strong>ã€‚å½“ç„¶ä¹Ÿä¼šè¢«å«åš<strong>æ‹”å±±ç›–ä¸–</strong>ã€<strong>åŒ—ä¸Šå¹¿æ·±</strong>ç®—æ³•â€¦â€¦å’³ï¼Œè¿™å¹¶ä¸é‡è¦ã€‚å½¢å¼åŒ–åœ°è®²ï¼Œ $\rm{BSGS}$ç®—æ³•ä¸»è¦ç”¨æ¥è§£å†³ä»¥ä¸‹é—®é¢˜ : </p><blockquote><p>ç»™å®šè´¨æ•°$p$, æ•´æ•°$a, b$, $(a, p)=1$.æ±‚æœ€å°çš„éè´Ÿæ•´æ•°$x$, ä½¿å¾—$a^xâ‰¡ b~(\mod p)$</p></blockquote><p>è€Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“çš„ï¼Œæ˜¯ç”±æ¬§æ‹‰å®šç†$a ^{\varphi(p)} â‰¡ 1 ~(\mod p)â€‹$ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜çŸ¥é“$a^0=1â‰¡1  ~(\mod p)â€‹$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªæ–­è¨€ï¼š</p><p><strong>å¦‚æœæ–¹ç¨‹$a^xâ‰¡ b~(\mod p)â€‹$æœ‰æœ€å°éè´Ÿæ•´æ•°è§£ï¼Œé‚£ä¹ˆæœ€å°éè´Ÿæ•´æ•°è§£ä¸€å®šåœ¨$[0, \varphi(p))â€‹$ä¸­</strong> $\qquad \qquad(1) â€‹$</p><p>æ­¤å¤„è‚‰çœ¼å¯ä»¥çœ‹å‡ºå…¶å¾ªç¯èŠ‚ä¸º$\varphi(p)$ï¼Œä¸å†è¯æ˜ã€‚</p><p>ä¹‹åæˆ‘ä»¬å°†ä»¥æ­¤ä¸ºåŸºç¡€è¿›è¡Œç±»ä¼¼åˆ†å—çš„æ“ä½œâ€”â€”</p><h1 id="rm-0x02-Baby-Step-Giant-Step"><a href="#rm-0x02-Baby-Step-Giant-Step" class="headerlink" title="$\rm{0x02~~Baby~Step~Giant~Step}$"></a>$\rm{0x02~~Baby~Step~Giant~Step}$</h1><p>é¦–å…ˆæˆ‘ä»¬è®°$n=\sqrt {\varphi(p)}$ï¼Œé‚£ä¹ˆ$\forall x \in [0, \varphi(p))$, $x = i\times m+j$, $i \leq  \lfloor \frac{pâˆ’1-m}{m} \rfloor,~~ 0â‰¤j &lt;m$ ã€‚é‚£ä¹ˆå¯¹äºåŸæ–¹ç¨‹æˆ‘ä»¬å¯ä»¥æŠŠå…¶æ”¹ä¸ºï¼š$$a^{i\cdot n+j}â‰¡ b~(\mod p)$$ç§»ä¸€ä¸‹é¡¹å°±å¯ä»¥å˜æˆ$$a^j â‰¡b \cdot a^{-i\cdot n} (\mod p)$$é‚£ä¹ˆç°åœ¨æˆ‘ä»¬çš„ç­–ç•¥æ˜¯ç®—å‡ºæ‰€æœ‰$a^j$æ¥ï¼Œåœ¨$\mod p$  æ„ä¹‰ä¸‹è§‚å¯Ÿæ˜¯å¦æœ‰ä¸€ä¸ª$i$ä½¿å¾—$a^j â‰¡b \cdot a^{-i\cdot n} (\mod p)$ã€‚æˆ‘ä»¬ç§°å·¦è¾¹æšä¸¾$a^j$å«åš<strong>å°æ­¥$(\rm{Baby~Step})$</strong>ï¼Œ  ç§°å³è¾¹æšä¸¾$b \cdot a^{-i\cdot n}$å«åš<strong>å¤§æ­¥$~(\rm{Giant~Step})$</strong>ã€‚</p><p>é‚£ä¹ˆå…¶å®ç®—æ³•æµç¨‹å¾ˆæ˜æ™°äº†ï¼Œæˆ‘ä»¬åªéœ€è¦å¾ªç¯ä¸¤æ¬¡ã€ç¬¬ä¸€æ¬¡è®°å½•çš„$a^j$ç”¨å“ˆå¸Œè¡¨ï¼ˆ$STL$è‡ªå¸¦$unordered$_ $map$ï¼‰è®°å½•ä¸€ä¸‹å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL a, LL b, LL p)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) </span><br><span class="line">            (res *= a) %= p ;</span><br><span class="line">        (a *= a) %= p, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res % p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">bsgs</span><span class="params">(LL x, LL y, LL p)</span></span>&#123;</span><br><span class="line">    P = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p)), Hash.clear(), Q = expow(x, -P + <span class="number">2</span> *(p - <span class="number">1</span>), p) ;</span><br><span class="line">    <span class="comment">//a ^ (p-1) = 1 (mod p) =&gt; Q = a^(-P) = a ^(-P + p -1) ;</span></span><br><span class="line">    <span class="keyword">for</span> (LL i = <span class="number">1</span>, j = <span class="number">0</span> ; j &lt; P ; ++ j, (i *= x) %= p) </span><br><span class="line">        <span class="keyword">if</span> (!Hash.count(i)) Hash[i] = j ; <span class="comment">// Push them into hash_table</span></span><br><span class="line">    <span class="keyword">for</span> (LL i = y, j = <span class="number">0</span>  ; j &lt;= P ; ++ j, (i *= Q) %= p) </span><br><span class="line">        <span class="keyword">if</span> (Hash.count(i))&#123; <span class="built_in">cout</span> &lt;&lt; Hash[i] + j * P &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"-1"</span> &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ç»†èŠ‚è¿˜æ˜¯æœ‰çš„ï¼š</p><ul><li><p>è®¡ç®—<code>sqrt</code>æ—¶è¦ä¸Š<strong>å–æ•´</strong>ã€‚</p></li><li><p>æˆ‘ä»¬åœ¨æ±‚$a^{-i\cdot n}â€‹$æ—¶ç”¨çš„åº•å˜é‡éœ€è¦ç”±è´¹é©¬å°å®šç†æ±‚å¿«é€Ÿå¹‚å¾—å‡ºã€‚ä½†æ˜¯æ­¤æ—¶æŒ‡æ•°ä¸Šå¯èƒ½ä¸ºè´Ÿæ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©åŠ ä¸Šä¸€ä¸ªæ¨¡æ•°ï¼Œä¸å½±å“ç»“æœã€‚</p></li><li>ä¸¤æ¬¡å¾ªç¯æšä¸¾çš„è¾¹ç•Œè¦æ³¨æ„æœ‰çš„æ˜¯$\leq$æœ‰çš„æ˜¯$&lt;$</li><li>ç®—æ³•è¿˜æ²¡å¼€å§‹æ—¶ï¼Œè¦åˆ¤æ–­æœ¬èº«$a$æ˜¯å¦å¯ä»¥è¢«$P$æ•´é™¤ã€‚å¦‚æœä¸ç‰¹åˆ¤è¿™ç§æƒ…å†µçš„è¯ï¼Œæˆ‘ä»¬ä¸Šé¢ä»£ç ä¸­çš„<code>Q</code>å°±ä¼š<code>=0</code>ï¼Œä»è€Œåœ¨ä¸‹é¢çš„ç¬¬äºŒä¸ªå¾ªç¯å¤„å‡ºé”™â€”â€”æˆ‘ä»¬çš„<code>hash[i]</code>å’Œ<code>j</code>ä¸èƒ½åŒæ—¶ä¸º$0$ï¼Œä»è€Œè¾“å‡ºé”™è¯¯çš„ç­”æ¡ˆã€‚</li></ul><h1 id="rm-0x03-ä¾‹é¢˜"><a href="#rm-0x03-ä¾‹é¢˜" class="headerlink" title="$\rm{0x03}$   ä¾‹é¢˜"></a>$\rm{0x03}$   ä¾‹é¢˜</h1><p>$T1~$<a href="https://www.luogu.org/problemnew/show/P4028" target="_blank" rel="noopener">$LuoguP4028$</a></p><p>è£¸é¢˜ï¼Œä½†æ˜¯æœ‰å¾ˆå¤šå‘â€¦â€¦æˆ–è€…è¯´ä¸Šé¢åˆ—ä¸¾çš„ç»†èŠ‚éƒ½æ¶µç›–äº†qaq</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> tr1 ; <span class="keyword">int</span> T ;</span><br><span class="line">LL A, B, M, P, Q ; <span class="built_in">unordered_map</span> &lt;LL, LL&gt; Hash ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">expow</span><span class="params">(LL a, LL b, LL p)</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) </span><br><span class="line">            (res *= a) %= p ;</span><br><span class="line">        (a *= a) %= p, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res % p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">bsgs</span><span class="params">(LL x, LL y, LL p)</span></span>&#123;</span><br><span class="line">    P = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p)), Hash.clear(), Q = expow(x, -P + <span class="number">2</span> *(p - <span class="number">1</span>), p) ;</span><br><span class="line">    <span class="comment">//a ^ (p-1) = 1 (mod p) =&gt; Q = a^(-P) = a ^(-P + p -1) ;</span></span><br><span class="line">    <span class="keyword">for</span> (LL i = <span class="number">1</span>, j = <span class="number">0</span> ; j &lt; P ; ++ j, (i *= x) %= p) </span><br><span class="line">        <span class="keyword">if</span> (!Hash.count(i)) Hash[i] = j ; <span class="comment">// Push them into hash_table</span></span><br><span class="line">    <span class="keyword">for</span> (LL i = y, j = <span class="number">0</span>  ; j &lt;= P ; ++ j, (i *= Q) %= p) </span><br><span class="line">        <span class="keyword">if</span> (Hash.count(i))&#123; <span class="built_in">cout</span> &lt;&lt; Hash[i] + j * P &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> ; &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Couldn't Produce!"</span> &lt;&lt; <span class="built_in">endl</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    LL res = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ; <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) res = (res &lt;&lt; <span class="number">1</span>) + (res &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        M = qr(), A = qr(), B = qr() ;</span><br><span class="line">        <span class="keyword">if</span> ((!(A % M == <span class="number">0</span> &amp;&amp; B))) bsgs(A, B, M) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="string">"Couldn't Produce!"</span> &lt;&lt; <span class="built_in">endl</span> ; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$T2~$ <a href="https://www.luogu.org/problemnew/show/P3846" target="_blank" rel="noopener">$TJOI2007~Cute~Primeâ€‹$</a></p><p>æœ€è£¸æœ€è£¸çš„ã€æ— ç‰¹åˆ¤çš„é¢˜â€¦â€¦å¯ä»¥æ°´ä¸€ä¸‹åŒå€ç»éªŒã€‚</p><h1 id="mathfrak-writter-pks"><a href="#mathfrak-writter-pks" class="headerlink" title="$\mathfrak{writter: pks}$"></a>$\mathfrak{writter: pks}$</h1>]]></content>
    
    <summary type="html">
    
      ä¸€ç±»è§£å†³$a^x\equiv b(~\bmod~p)$ï¼Œä¸”$p$ä¸º$prime$çš„åŒä½™å¼çš„ç®—æ³•ã€‚
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="BSGS/exBSGS" scheme="http://www.orchidany.cf/tags/BSGS-exBSGS/"/>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>LCT&#39;s Junior Intro</title>
    <link href="http://www.orchidany.cf/2019/02/04/LCT-s-Junior-Intro/"/>
    <id>http://www.orchidany.cf/2019/02/04/LCT-s-Junior-Intro/</id>
    <published>2019-02-04T15:18:58.000Z</published>
    <updated>2019-03-16T13:17:16.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E7%9C%81%E9%80%89---purple.svg" alt=""></p><h1 id="rm-0x01-é—²è¯-Â·-LCT-çš„ç”¨é€”ä»¥åŠå…·ä½“æ€è·¯"><a href="#rm-0x01-é—²è¯-Â·-LCT-çš„ç”¨é€”ä»¥åŠå…·ä½“æ€è·¯" class="headerlink" title="$\rm{0x01}$ é—²è¯ Â· $LCT$çš„ç”¨é€”ä»¥åŠå…·ä½“æ€è·¯"></a>$\rm{0x01}$ é—²è¯ Â· $LCT$çš„ç”¨é€”ä»¥åŠå…·ä½“æ€è·¯</h1><p>å’³ï¼Œå…¶å®åœ¨æˆ‘æœ€è¿‘åªæ˜¯æµ…æµ…åœ°å­¦äº†ä¸€éƒ¨åˆ†çš„åŸºç¡€ä¸Šï¼Œçªè§‰å¾—$LCT$å…¶å®å°±æ˜¯ä¸€ä¸ªç”¨æ¥ç»´æŠ¤<strong>æ£®æ—è¿é€šæ€§</strong>çš„ã€‚</p><p>å—¯â€¦â€¦å› ä¸ºå…¶ç‹¬ç‰¹çš„æ€§è´¨æ‰€ä»¥ä¹Ÿå¯ä»¥é¡ºä¾¿ç»´æŠ¤å¥½å¤šä¸œè¥¿ï¼Œä»€ä¹ˆé“¾ä¸Šçš„æœ€å¤§å€¼å•Šï¼Œé“¾ä¸Šçš„æƒå€¼å’Œå•Šâ€¦â€¦éƒ½å¯ä»¥ç»´æŠ¤â€”â€”æˆ–è€…è¯´ï¼ŒLCTæ˜¯æ›´åŠ å…¨èƒ½çš„æ ‘å‰–ã€‚</p><p>ä½†å…¶å®å§â€¦â€¦$LCT$æ‰“æ¿å­æ˜¯å¾ˆç®€å•çš„ï¼Œä½†æ˜¯çœŸæ­£ç†è§£å´ä¸€ç‚¹å„¿ä¹Ÿä¸ç®€å•ã€‚å› ä¸ºæœ¬èº«$splay$å°±å¾ˆéº»çƒ¦äº†ï¼Œå†µä¸”$splay$ä¹‹å‰ä¸€ç›´ç”¨äºç»´æŠ¤æ•°åˆ—ã€‚è¦çŸ¥é“ï¼Œæ­¤å¤„çš„$splay$å¯æ˜¯ä½œä¸º<strong>è¾…åŠ©æ ‘</strong>ï¼Œç»´æŠ¤ä¸€æ•´ä¸ªæ£®æ—ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒåºåˆ—ä¸­å‡ ä¹å…¨éƒ¨æ“ä½œâ€”â€”è¿™å°±å¤§å¤§å¢é«˜äº†ç†è§£éš¾åº¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½ æ›¾ç»è®¤ä¸ºå·²ç»éš¾ä»¥ç†è§£ã€æˆ–è€…è¯´ä¸å¯ä»¥åšçš„ã€æ¯”è¾ƒå¤æ‚çš„åŒºé—´ç¿»è½¬<a href="https://www.luogu.org/problemnew/show/P3391" target="_blank" rel="noopener">$Luogu3391$</a>ï¼Œåœ¨$LCT$é‡Œé¢æœ‰ååˆ†å…¨é¢çš„æ¶‰åŠï¼Œä½†æ˜¯è¢«ç²¾ç®€åˆ°äº†åªæœ‰ä¸¤è¡Œæ˜¯ç”¨æ¥æè¿°è¿™ä¸ªå†…å®¹çš„ã€‚æ˜¾è€Œæ˜“è§çš„æ˜¯ï¼Œ$LCT$è™½ç„¶å¸¸æ•°ååˆ†çš„å¤§ï¼Œä½†ä»£ç ååˆ†çš„çŸ­ï¼Œæ¯”ä¸€æ£µå®Œæ•´çš„å¹³è¡¡æ ‘çŸ­äº†ä¸å°‘ï¼ˆå®æµ‹50+è¡Œï¼‰ï¼Œä¸$FFT$ä¸€æ ·å…·æœ‰ç€åä¸½çš„å¯è§‚èµæ€§ï¼Œä½†æ˜¯éšè—åœ¨ä¹‹åçš„æ€ç»´éš¾åº¦åŒæ ·ä¸å¯å°è§‘ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ˜¯ä¸æ˜¯å­¦çš„å¤ªè‰ç‡ã€å¤ªæµ®èºäº†å‘¢ï¼Ÿå¿«é¤å¼åœ°å­¦å®Œ$LCT$ï¼Œç½‘ä¸Šçš„æ¯ä¸€ç¯‡åšå®¢éƒ½åŒ…æ•™åŒ…ä¼šã€‚ä½†æ˜¯æˆ‘ä»Šå¤©è¦æ•´ç†çš„ï¼Œæ˜¯å¯¹äº$LCT$çœŸæ­£çš„ç†è§£ã€‚å¸Œæœ›å„ä½çœ‹åˆ°è¿™ç¯‡æ‹™ä½œçš„äººå¯ä»¥è·å¾—ä¸€äº›ä»€ä¹ˆã€‚</p><h1 id="rm-0x02-é—²è¯-Â·-å…³äº-rm-splay"><a href="#rm-0x02-é—²è¯-Â·-å…³äº-rm-splay" class="headerlink" title="$\rm{0x02}$ é—²è¯ Â· å…³äº$\rm{splay}$"></a>$\rm{0x02}$ é—²è¯ Â· å…³äº$\rm{splay}$</h1><p>é“ç†æˆ‘éƒ½æ‡‚ï¼Œè¦æƒ³åŠ¨æ€æ‹†åˆ ä¸€äº›ä¸œè¥¿ï¼Œè¾…åŠ©æ ‘çš„å½¢æ€å¯ä»¥æ”¹å˜æ˜¯å…ˆå†³æ¡ä»¶ã€‚çœ‹ä¸Šå»å¹³è¡¡æ ‘å¥½åƒæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä½†æ˜¯ï¼Œé€‰å“ªä¸ªä½œä¸ºè¾…åŠ©æ ‘å‘¢ï¼Ÿ<del>åå®«ä½³ä¸½ä¸‰åƒæˆ‘è¯¥ç¿»è°çš„ç‰Œå­å‘¢</del></p><p>å†å²çš„é‡ä»»æœ€åè½åˆ°äº†$\rm{splay}â€‹$çš„èº«ä¸Šã€‚ç„¶å$\rm{splay}â€‹$ä»–å±…ç„¶ï¼š</p><p><img src="t1.jpg" alt=""></p><p>ä»–ç”šè‡³è¿˜ï¼š</p><p><img src="t2.png" alt=""></p><p>â€¦â€¦</p><p>å¥½å§ï¼Œç”±äºæŸäº›<del>rqyä¹Ÿä¸çŸ¥é“çš„</del>åŸå› ï¼Œå¦‚æœä¸ç”¨$\rm{splay}$çš„è¯ï¼Œå¤æ‚åº¦æ˜¯å‡æ‘Š$\Theta(\rm{nlog^2n})$, è€Œç”¨$\rm{splay}$å°±å¯ä»¥åšåˆ°å‡æ‘Š$\Theta(\rm{nlogn})$ â€¦â€¦ä½†äº‹å®ä¸Šï¼Œsplayç¡®å®æœ‰ä»–ç‹¬ç‰¹çš„æ€§è´¨ï¼Œæ¯”å¦‚æ—‹è½¬åˆ°æ ¹å•Šä¹‹ç±»çš„ï¼Œæ¯”èµ·å…¶ä»–ç§ç±»çš„å¹³è¡¡æ ‘è€Œè¨€ï¼Œæ›´åŠ é€‚åˆ$LCT$</p><h1 id="rm-0x03-LCT-çš„æ€è·¯å’ŒåŸºç¡€æ“ä½œ"><a href="#rm-0x03-LCT-çš„æ€è·¯å’ŒåŸºç¡€æ“ä½œ" class="headerlink" title="$\rm{0x03}$   $LCT$çš„æ€è·¯å’ŒåŸºç¡€æ“ä½œ"></a>$\rm{0x03}$   $LCT$çš„æ€è·¯å’ŒåŸºç¡€æ“ä½œ</h1><h2 id="ä¸€-ä¸»è¦æ€è·¯"><a href="#ä¸€-ä¸»è¦æ€è·¯" class="headerlink" title="ä¸€ ä¸»è¦æ€è·¯"></a>ä¸€ ä¸»è¦æ€è·¯</h2><p>ä¸»è¦æ€è·¯å˜›â€¦â€¦å¤§æ¦‚æ˜¯åŸºäº<strong>å®é“¾å‰–åˆ†</strong>çš„æ“ä½œã€‚</p><p><strong>æœ´ç´ çš„æ ‘å‰–æ˜¯é‡é“¾å‰–åˆ†</strong>ï¼Œå¤§ä½“ä¸Šå°±æ˜¯å°†æ•´æ£µæ ‘çš„é“¾åˆ’åˆ†ä¸ºè½»è¾¹å’Œé‡é“¾ï¼Œè¿ç”¨å·§å¦™çš„æ€§è´¨åšåˆ°$log$çº§åˆ«ã€‚è€Œé—æ†¾çš„æ˜¯$LCT$ç»´æŠ¤çš„æ˜¯æ£®æ—çš„è¿é€šæ€§ï¼Œæ‰€ä»¥åªèƒ½é‡‡ç”¨å®é“¾å‰–åˆ†ã€‚</p><p>è€Œå®é“¾å‰–åˆ†å¤§ä½“ä¸Šå°±æ˜¯æŠŠè¾¹åˆ†ä¸º<strong>è™šè¾¹</strong>å’Œ<strong>å®è¾¹</strong>ã€‚å…¶ä¸­å®è¾¹ä¸²è”èµ·ä¸€ä¸ªè”é€šå—ï¼ŒåŒä¸€ç»„å®è¾¹å­˜åœ¨ã€ä¸”ä»…å­˜åœ¨äºä¸€æ£µ$\rm{splay}$ä¸­ã€‚$\rm{splay}$å’Œ$\rm{splay}$ä¹‹é—´ç”±è™šè¾¹ç›¸è¿ã€‚</p><p>å®é“¾å‰–åˆ†çš„å¥½å¤„å‘¢ï¼Ÿåœ¨äº<strong>å®é“¾å‰–åˆ†æ˜¯ä¸€ç§åŠ¨æ€å‰–åˆ†</strong>ï¼Œä»–å¯ä»¥<strong>éšæ„æ”¹å˜è¾¹çš„è™šå®å±æ€§</strong>ã€‚è€Œæ˜¾ç„¶ï¼Œé‡é“¾å‰–åˆ†ç”±äºæœ‰ç€è¶³å¤Ÿçš„ç†è®ºä¾æ®å’Œé€»è¾‘æ¨æ¼”ï¼Œæ‰€ä»¥è½»é‡é“¾æ˜¯éš¾ä»¥æ›´æ”¹ï¼Œæˆ–è€…è¯´ï¼Œä¸å¯æ›´æ”¹çš„ã€‚Soï¼Œå®é“¾å‰–åˆ†ä¸ºåŠ¨æ€æ ‘çš„åŠ¨æ€æ‰“ä¸‹äº†åŸºç¡€ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª$LCTâ€‹$æ˜¯å¦‚ä½•å®šä¹‰çš„:</p><ul><li>é¦–å…ˆï¼Œä¸€æ£µ$LCTâ€‹$ç®¡æ§çš„æ˜¯ä¸€å¯¹åˆ†æ•£çš„ç‚¹ï¼Œç‚¹ä»¥å‡ æ£µåˆ†æ•£çš„$splayâ€‹$çš„å½¢å¼èšé›†ã€‚èµ·åˆæ•´æ£µ$LCTâ€‹$æ˜¯æ²¡æœ‰ä»»ä½•è”ç³»çš„ï¼Œå„è‡ªä¸ºæˆ˜ï¼Œå„è‡ªä¸ºæ ¹ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥ä¼šçœ‹åˆ°çš„$accessâ€‹$ã€$makerootâ€‹$ç­‰æ“ä½œï¼Œéƒ½æ˜¯åœ¨è‡ªå·±çš„è”é€šå—å„¿å†…éƒ¨è¿›è¡Œçš„æ“ä½œã€‚æ¢å¥è¯è®²ï¼Œ$LCTâ€‹$ç»´æŠ¤çš„æ˜¯æœ‰æ ¹æ£®æ—ï¼Œå³ç»„æˆæ£®æ—çš„æ¯ä¸ªè”é€šå—éƒ½æœ‰å…¶å”¯ä¸€çš„æ ¹ã€‚</li><li>å®è¾¹ä¸²è”èµ·ä¸€ä¸ªè”é€šå—ï¼ŒåŒä¸€ç»„å®è¾¹å­˜åœ¨ã€ä¸”ä»…å­˜åœ¨äºä¸€æ£µ$\rm{splay}$ä¸­ã€‚$\rm{splay}$å’Œ$\rm{splay}$ä¹‹é—´ç”±è™šè¾¹ç›¸è¿ã€‚åªæœ‰å®è¾¹æ˜¯æœ‰æ•ˆçš„ï¼Œè™šè¾¹å¯ä»¥è¢«è®¤ä¸ºä¸å­˜åœ¨ã€‚<strong>ä½†æ˜¯ä¸¤ç§è¾¹éƒ½æ²¡æœ‰ç”¨åˆ°æ˜¾å¼å­˜å‚¨</strong>ï¼Œéƒ½æ˜¯é€šè¿‡splayä¸­çš„$Son$æ•°ç»„å’Œ$Fa$æ•°ç»„è®¿é—®çš„ã€‚ä½†è™šè¾¹å’Œå®è¾¹çš„å­˜å‚¨æœ‰åŒºåˆ«ï¼š</li><li>è™šè¾¹æ˜¯è®¤çˆ¶ä¸è®¤å­ï¼Œå³å¦‚æœ$Fa[x]==y$ï¼Œé‚£ä¹ˆ$y$ä¸å­˜$x$è¿™ä¸ªå„¿å­ï¼Œä½†æ˜¯$x$å­˜$y$è¿™ä¸ªçˆ¶äº²ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†å¯ä»¥$Access$â€”â€”å› ä¸ºå…¶å®åœ¨$Access$çš„å­å‡½æ•°$splay$é‡Œï¼Œå‘æŒ¥ä½œç”¨çš„å®é™…ä¸Šæ˜¯$Fa$æŒ‡é’ˆã€‚</li><li>å®è¾¹æ˜¯å®Œæ•´çš„åŒå‘å­˜å‚¨ã€‚</li><li>$\rm{splay}$ä¸­ç»´æŠ¤çš„æ˜¯ä¸€æ¡ä»å­˜å‚¨ä¸Šåˆ°ä¸‹æŒ‰åœ¨åŸæ ‘ä¸­æ·±åº¦ä¸¥æ ¼é€’å¢çš„è·¯å¾„ï¼Œä¸”ä¸­åºéå†$\rm{splay}$å¾—åˆ°çš„æ¯ä¸ªç‚¹çš„æ·±åº¦åºåˆ—ä¸¥æ ¼é€’å¢ã€‚æ¢å¥è¯è®²ï¼Œä¸€ä¸ª$\rm{splay}$é‡Œé¢ä¸ä¼šå‡ºç°åœ¨åŸè”é€šå—å„¿ï¼ˆæ ‘ï¼‰ä¸­æ·±åº¦ç›¸åŒçš„ä¸¤ä¸ªç‚¹ã€‚åœ¨ä¸€æ£µ$\rm{splay}$ä¸­ï¼Œé”®å€¼å°±æ˜¯åŸæ ‘ä¸­çš„æ·±åº¦ã€‚</li><li>å¦‚æœ$x$æ˜¯å®ƒæ‰€åœ¨$splay$çš„æœ€å·¦è¾¹çš„ç‚¹ï¼Œé‚£ä¹ˆå®ƒåœ¨åŸæ£®æ—é‡Œçš„çˆ¶äº²æ˜¯$x$æ‰€åœ¨$splay$çš„æ ¹çš„$fa$, å¦åˆ™å°±æ˜¯$x$åœ¨$splay$ä¸Šçš„å‰é©±.</li></ul><h2 id="äºŒ-åŸºç¡€æ“ä½œ"><a href="#äºŒ-åŸºç¡€æ“ä½œ" class="headerlink" title="äºŒ åŸºç¡€æ“ä½œ"></a>äºŒ åŸºç¡€æ“ä½œ</h2><p>$emm$æ‰€è°“åŸºç¡€æ“ä½œå¤§æ¦‚å°±æ˜¯æ¯ä¸ªç”¨åˆ°$LCT$çš„é¢˜å‡ ä¹éƒ½è¦ç”¨åˆ°çš„æ“ä½œï¼Œæˆ‘ä»¬è¿™ä¸ªåœ°æ–¹å…ˆæŠŠç‚¹$n$æ‰€åœ¨è”é€šå—å„¿å†…çš„æ ‘çš„æ ¹è®°ä½œ$root(n) $ï¼ŒæŠŠä¸$n$ä»¥å®è¾¹ç›¸è¿çš„å„¿å­è®°ä½œå®å„¿å­ã€‚</p><ul><li><h2 id="rm-1-Access"><a href="#rm-1-Access" class="headerlink" title="$\rm{1}$  $Access$"></a>$\rm{1}$  $Access$</h2></li></ul><p>è¿™ä¸ªæ“ä½œæœ‰ç€å¾ˆè¿·çš„æ€§è´¨ï¼Œå…¶æ—¶é—´å¤æ‚åº¦æ˜¯å‡æ‘Š$\log n$çš„ã€‚è€Œè¿™ä¸ªæ“ä½œçš„ç›®çš„æ˜¯<strong>$Access(n)$è¡¨ç¤ºä»$root(n)$å‘$n$æ‰“é€šä¸€æ¡å®é“¾ï¼Œå¹¶ä»¥$n$ç‚¹ä¸ºæœ€æ·±åº¦æœ€å¤§çš„ç‚¹ã€$root(n)$ä¸ºæ·±åº¦æœ€å°çš„ç‚¹å½¢æˆä¸€æ£µ$\rm{splay}$</strong>ã€‚</p><p>ä¸éš¾çœ‹å‡ºï¼Œè¿™ä¸ªæ“ä½œå…¶å®è·Ÿæ˜¯ä¸€ç§<strong>é€»è¾‘å±‚é¢çš„è‡ªæˆ‘è°ƒæ§ï¼Œæ²¡æœ‰æ”¹å˜åŸæ ‘çš„ç»“æ„ã€‚</strong></p><p>æˆ‘ä»¬æ€è€ƒï¼Œå¦‚æœæ­¤æ—¶æˆ‘ä»¬$Accessâ€‹$å®Œç‚¹$nâ€‹$ä¹‹åï¼Œç†è®ºä¸Šæ¥è®²ï¼Œ$nâ€‹$ç‚¹åº”è¯¥ä¸å†æœ‰å®å„¿å­äº†â€”â€”æ˜¾ç„¶ï¼Œå¦‚æœæœ‰å®å„¿å­çš„è¯ï¼Œ$splayâ€‹$ä¸­æ˜¯åº”è¯¥åŒ…å«è¿™ä¸ªå®å„¿å­çš„â€”â€”è€Œè¿™å°±ä¸ç¬¦åˆ$nâ€‹$æ˜¯$\rm{splay}â€‹$ä¸­æ·±åº¦æœ€å¤§çš„ç‚¹çš„æ€§è´¨äº†ã€‚è€Œå› ä¸ºåœ¨splayä¸­ï¼Œç‚¹æ˜¯ä»¥æ·±åº¦ä¸ºé”®å€¼çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ¯æ¬¡ç æ‰$\rm{splay}â€‹$ä¸­çš„å³å„¿å­â€”â€”å³ç æ‰åŸæ¥çš„å®å„¿å­ï¼Œå¹¶æŠŠåˆšåˆšè¯ç”Ÿçš„$\rm{splay}â€‹$è¿ä¸Šã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Access</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> qwq = <span class="number">0</span> ; x ; x = T[qwq = x].F) </span><br><span class="line">splay(x), rc = qwq, update(x) ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åè¿™å°±æ˜¯$Accessâ€‹$äº†ã€‚</p><ul><li><h2 id="2-Make-Root"><a href="#2-Make-Root" class="headerlink" title="$2 ~~Make~ Root~$"></a>$2 ~~Make~ Root~$</h2></li></ul><p>$make_rootâ€‹$å…ˆä»åŸæ¥çš„æ ¹å‘$nâ€‹$æ‰“é€šä¸€æ¡è·¯å¾„ï¼Œç„¶å$splayâ€‹$ä¸Šå»ï¼Œæœ€å$reverseâ€‹$ä¸€ä¸‹ã€‚æ­¤å¤„ç”±äºä¸€å¼€å§‹$nâ€‹$çš„æ·±åº¦æœ€å¤§ï¼Œ$splayâ€‹$ä¹‹åæ·±åº¦ä¾æ—§æœ€å¤§ï¼Œä½†æ­¤æ—¶$nâ€‹$æ˜¯$splayâ€‹$çš„æ ¹ï¼Œæ‰€ä»¥$reverse(n)â€‹$å°±ç›¸å½“äºç¿»è½¬äº†æ•´æ¡æ ‘ä¸Šçš„é“¾ï¼Œé‚£ä¹ˆç¿»è½¬ä¹‹åï¼Œ$nâ€‹$çš„æ·±åº¦å°±å˜æˆäº†æœ€å°ï¼Œäºæ˜¯å°±æ˜¯è¿™ä¸ªè”é€šå—å„¿çš„æ ¹èŠ‚ç‚¹äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc T[x].Son[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc T[x].Son[1]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LCT</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> F, Son[<span class="number">2</span>], R, S ;</span><br><span class="line">&#125;T[MAXN] ; </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span> </span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; lc ^= rc ^= lc ^= rc, T[x].R ^= <span class="number">1</span> ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">if</span> (!T[x].R) <span class="keyword">return</span> ; T[x].R = <span class="number">0</span> ; <span class="keyword">if</span> (lc) reverse(lc) ; <span class="keyword">if</span> (rc) reverse(rc) ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Rooten</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; Access(x), splay(x), reverse(x) ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> qwq = x ; stk.push(qwq) ;</span><br><span class="line"><span class="keyword">while</span>(check(qwq)) qwq = T[qwq].F, stk.push(qwq) ;</span><br><span class="line"><span class="keyword">while</span>(!stk.empty()) push_down(stk.top()), stk.pop() ;</span><br><span class="line"><span class="keyword">while</span>(check(x))&#123;</span><br><span class="line"><span class="keyword">int</span> fa = T[x].F, g_fa = T[fa].F ;</span><br><span class="line"><span class="keyword">if</span> (check(fa)) rotate((T[g_fa].Son[<span class="number">1</span>] == fa) == (T[fa].Son[<span class="number">1</span>] == x) ? fa : x) ; rotate(x) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„$splay$ä¸­ç”±äºè¦ä¸‹æ”¾æ ‡è®°ï¼Œä¿è¯æ ‘çš„å½¢æ€æ˜¯æ­£ç¡®çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€ä¸ª$stack$å­˜ä¸€ä¸‹ï¼Œé¡ºåºä¸‹æ”¾æ ‡è®°ã€‚</p><ul><li><h2 id="3-Merge"><a href="#3-Merge" class="headerlink" title="$3 ~Merge~$"></a>$3 ~Merge~$</h2></li></ul><p>æ­¤å¤„çš„$Merge(x, y)$çš„æ„ä¹‰æ˜¯ï¼Œæ‹‰èµ·$x,y$ä¸­é—´çš„é“¾ï¼Œå½¢æˆä¸€ä¸ª$splay$ã€‚è¿™é‡Œå°±ç›´æ¥$Mkroot$ä¸€éï¼Œç„¶å$Access$å³å¯ã€‚è®©å“ªä¸ªç‚¹å½“æ ¹åº”è¯¥éƒ½å¯ä»¥ï¼Œåªä¸è¿‡å¤š$splay$å‡ æ¬¡å¯ä»¥ä¿è¯ä¼˜ï¼ˆæ¯’ï¼‰ç§€ï¼ˆç˜¤ï¼‰çš„å¤ï¼ˆå¤§ï¼‰æ‚ï¼ˆå¸¸ï¼‰åº¦ï¼ˆæ•°ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; Rooten(x), Access(y), splay(y) ; &#125;</span><br></pre></td></tr></table></figure><ul><li><h2 id="4-Link-amp-Cut"><a href="#4-Link-amp-Cut" class="headerlink" title="$4~~Link~\&amp;~Cut$"></a>$4~~Link~\&amp;~Cut$</h2></li></ul><p>å¦‚æœä¿è¯$Link$å’Œ$Cut$éƒ½æ˜¯åˆæ³•çš„æ“ä½œçš„è¯ï¼Œ$Link$ç›´æ¥è¿ï¼Œ$Cut$ç›´æ¥åˆ å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; Rooten(x) ;  T[x].F = y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Cut</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; Merge(x, y) ; T[x].F = T[y].Son[<span class="number">0</span>] = <span class="number">0</span> ;&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„$Link$å¿…é¡»å…ˆ$Mkroot$ä¸€ä¸‹ï¼Œå¦åˆ™æ ‘é“¾å°±æ–­äº†ã€‚è¿çš„æ˜¯è™šè¾¹ï¼ˆå› ä¸ºè¿å®è¾¹å°±ä¼šæ”¹å˜åŸæ¥$splay$çš„å‰²æ®ï¼‰ï¼›$Cut$å¿…é¡»å…ˆ$split$ä¸€ä¸‹ï¼Œä¿è¯ä¸¤ä¸ªç‚¹ä¹‹é—´åœ¨åŒä¸€æ£µ$splay$ä¸­ï¼ŒåŠ ä¹‹æˆ‘ä»¬çš„$Merge$æ“ä½œä¸­ï¼Œä¸€å¼€å§‹æŠŠ$x$ç»™$mkroot$äº†ï¼Œå†æŠŠ$y$ç‚¹$splay$ä¸Šå»ï¼Œç›´æ¥å¯¼è‡´äº†ç°åœ¨$x$åº”è¯¥æ˜¯$y$çš„å­©å­â€”â€”äºæ˜¯å°±å¾ˆå¼€å¿ƒçš„ï¼Œå¯ä»¥ç›´æ¥$cut$äº†ã€‚        </p><p>ä½†äº‹å®ä¸Šï¼Œå¤©ä¸é‚äººæ„â€¦â€¦æœ‰æ—¶å€™è¿™æ¡è¾¹å¹¶ä¸å­˜åœ¨ï¼Œç›²ç›®åˆ é™¤çš„è¯ä¼šå¯¼è‡´$GG$ï¼Œç›²ç›®è¿è¾¹çš„è¯ä¹Ÿä¼šå¯¼è‡´æ ‘çš„å½¢æ€çˆ†ç‚¸ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œä¸€æ³¢æ“ä½œâ€¦â€¦</p><ul><li>$New-Link$ </li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; Rooten(x) ; <span class="keyword">if</span>(Find(y) != x) T[x].F = y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; Access(x), splay(x) ; <span class="keyword">while</span>(lc) push_down(x), x = lc ; splay(x) ; <span class="keyword">return</span> x ;&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„çš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœæˆ‘ä»¬å‘ç°ä¸¤ä¸ªç‚¹åœ¨ä¸€ä¸ªå­æ ‘é‡Œé¢ï¼Œè¿æ¥å®ƒä»¬å°±ç ´åäº†æ ‘çš„æ€§è´¨ã€‚$Find$å°±æ˜¯æ— æ¯”æ™®é€šçš„$Find$ã€‚ã€‚ã€‚ã€‚233</p><p>ä½†è¦æ³¨æ„å•Šï¼Œ$Find$æ‰¾çš„æ˜¯åŸæ ‘ä¸­çš„æ ¹ï¼Œä¸æ˜¯$splay$ã€‚ç”±äºåŸæ ‘ä¸­æ ¹çš„æ·±åº¦ä¸€å®šæœ€å°ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯$splay$ä¸­æœ€é å·¦çš„ç‚¹â€¦â€¦æ‰€ä»¥ä¸æ–­æ‰¾å·¦å„¿å­ã€‚</p><p>å¤š$BB$ä¸€å¥ï¼Œè¿™ä¸ªåœ°æ–¹ä¸€å®šæ³¨æ„å•Šï¼$Find$åªæ”¹å˜äº†$splay$çš„å½¢æ€ï¼Œ$mkroot$æ”¹å˜çš„æ˜¯åŸæ ‘ä¸­çš„æ ¹</p><ul><li>$New-Cut$</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Cut</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; </span><br><span class="line">Rooten(x) ; </span><br><span class="line"><span class="keyword">if</span> (Find(y) != x || T[y].Son[<span class="number">0</span>] || T[y].F != x) <span class="keyword">return</span> ; </span><br><span class="line">T[y].F = T[x].Son[<span class="number">1</span>] = <span class="number">0</span>, update(x) ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„é¦–å…ˆæˆ‘ä»¬è¦åˆ¤ä¸€ä¸‹è¿™ä¸¤ä¸ªç‚¹æ˜¯ä¸æ˜¯ç›´æ¥ç›¸è¿ã€‚æ˜¯å¦ç›´æ¥ç›¸è¿â€¦â€¦åœ¨ä¸€æ£µ$splay$ä¸­çš„ä½“ç°ï¼Œè¦å…‹æœä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€æ˜¯è¦åˆ¤æ–­æ˜¯å¦è¿é€šï¼Œè¿˜æ˜¯$Find$æ“ä½œã€‚</p><p>ä¹‹åæˆ‘ä»¬éœ€è¦åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ°å¥½ç›¸éš”ä¸€æ¡è¾¹â€”â€”æ³¨æ„ï¼Œé¦–å…ˆå› ä¸ºä»£ç ä¸­çš„$x$æ¯”$y$åœ¨åŸæ ‘ä½ç½®é ä¸Šï¼ˆ$Rooten$äº†$x$ï¼‰ï¼Œåœ¨$splay$ä¸­é å·¦ï¼Œé‚£ä¹ˆå¦‚æœ$y$æœ‰å·¦å„¿å­çš„è¯ï¼Œè¯´æ˜ä¸€å®šæœ‰$Depth(x) &lt; Depth(y\text{çš„å·¦å„¿å­ä»¬})  &lt; Depth(y)$ï¼Œå…¶ä¸­$Depth$è¡¨ç¤ºåŸæ ‘æ·±åº¦ã€‚é‚£ä¹ˆæ­¤æ—¶åŸæ ‘ä¸­$x$å’Œ$y$ä¹‹é—´ï¼Œä¸€å®šéš”ç€ä¸€äº›èŠ‚ç‚¹ã€‚è€ƒè™‘æ ‘çš„æ€§è´¨ï¼Œä¸¤ç‚¹ä¹‹é—´æœ‰ä¸”ä»…æœ‰ä¸€æ¡ç®€å•è·¯å¾„â€”â€”æ‰€ä»¥å½“$T[y].Son[0]$ä¸æŒ‡å‘$Null$æ—¶ï¼Œ$x$å’Œ$y$ä¹‹é—´æ²¡æœ‰ä¸€æ¡è¾¹ï¼Œä¸èƒ½ç›´æ¥$Cut$ã€‚</p><p>å‰©ä¸‹çš„å°±å¾ˆç®€å•äº†ï¼Œ$T[y].F$åº”è¯¥æ˜¯$x$ï¼Œå¦åˆ™ä¹Ÿä¸æ˜¯ç›´æ¥ç›¸è¿ã€‚</p><ul><li><h2 id="5-Rotate-ä¸­çš„å‘ç‚¹"><a href="#5-Rotate-ä¸­çš„å‘ç‚¹" class="headerlink" title="5 $~Rotate$ä¸­çš„å‘ç‚¹"></a>5 $~Rotate$ä¸­çš„å‘ç‚¹</h2></li></ul><p>å‘ƒâ€¦â€¦å…¶å®å°±ä¸€å¤„è€Œå·²ã€‚å°±æ˜¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> T[T[x].F].Son[<span class="number">0</span>] == x || T[T[x].F].Son[<span class="number">1</span>] == x ;  &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fa = T[x].F, g_fa = T[fa].F, W = x == T[fa].Son[<span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">if</span> (check(fa)) T[g_fa].Son[T[g_fa].Son[<span class="number">1</span>] == fa] = x ; T[x].F = g_fa ;</span><br><span class="line">T[fa].Son[W] = T[x].Son[W ^ <span class="number">1</span>], T[T[x].Son[W ^ <span class="number">1</span>]].F = fa, T[fa].F = x, T[x].Son[W ^ <span class="number">1</span>] = fa, update(fa), update(x) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåœ°æ–¹$splay$åŒæ—‹åˆ¤æ–­ç¥–çˆ¶çš„æ—¶å€™ï¼Œä¸å†ç”¨$\rm{if(g_fa)}$ï¼Œè€Œæ˜¯ç”¨$\rm{if(check(fa))}$ã€‚åŸå› å¾ˆç®€å•ï¼Œæˆ‘ä»¬çš„è™šè¾¹ä¹Ÿæ˜¯æœ‰æŒ‡å‘çˆ¶äº²çš„æŒ‡é’ˆçš„ï¼Œä½†æ˜¯è¿æ¥ä¸¤ä¸ªä¸åŒçš„$splay$</p><p>å‰©ä¸‹çš„â€¦â€¦å¤§æ¦‚å°±æ²¡äº†å§â€¦â€¦</p><p>äºæ˜¯â€”â€”</p><h1 id="color-red-C-color-cyan-o-color-gold-d-color-green-e"><a href="#color-red-C-color-cyan-o-color-gold-d-color-green-e" class="headerlink" title="$\color{red}{C}\color{cyan}{o}\color{gold}{d}\color{green}{e}$"></a>$\color{red}{C}\color{cyan}{o}\color{gold}{d}\color{green}{e}$</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 300233</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc T[x].Son[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc T[x].Son[1]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(a, b, c) for(a = b ; a &lt;= c ; ++ a)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LCT</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> F, Son[<span class="number">2</span>], R, S ;</span><br><span class="line">&#125;T[MAXN] ; <span class="built_in">stack</span> &lt;<span class="keyword">int</span>&gt; stk ;</span><br><span class="line"><span class="keyword">int</span> base[MAXN], N, M, A, B, C, i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span> </span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span> </span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span> </span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; T[x].S = T[lc].S ^ T[rc].S ^ base[x] ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; lc ^= rc ^= lc ^= rc, T[x].R ^= <span class="number">1</span> ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> T[T[x].F].Son[<span class="number">0</span>] == x || T[T[x].F].Son[<span class="number">1</span>] == x ;  &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Access</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">for</span> (<span class="keyword">int</span> qwq = <span class="number">0</span> ; x ; x = T[qwq = x].F) splay(x), rc = qwq, update(x) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> fa = T[x].F, g_fa = T[fa].F, W = x == T[fa].Son[<span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">if</span> (check(fa)) T[g_fa].Son[T[g_fa].Son[<span class="number">1</span>] == fa] = x ; T[x].F = g_fa ;</span><br><span class="line">T[fa].Son[W] = T[x].Son[W ^ <span class="number">1</span>], T[T[x].Son[W ^ <span class="number">1</span>]].F = fa, T[fa].F = x, T[x].Son[W ^ <span class="number">1</span>] = fa, update(fa), update(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> qwq = x ; stk.push(qwq) ;</span><br><span class="line"><span class="keyword">while</span>(check(qwq)) qwq = T[qwq].F, stk.push(qwq) ;</span><br><span class="line"><span class="keyword">while</span>(!stk.empty()) push_down(stk.top()), stk.pop() ;</span><br><span class="line"><span class="keyword">while</span>(check(x))&#123;</span><br><span class="line"><span class="keyword">int</span> fa = T[x].F, g_fa = T[fa].F ;</span><br><span class="line"><span class="keyword">if</span> (check(fa)) &#123;</span><br><span class="line">        rotate((T[g_fa].Son[<span class="number">1</span>] == fa) == (T[fa].Son[<span class="number">1</span>] == x) ? fa : x) ; rotate(x) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Rooten</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; Access(x), splay(x), reverse(x) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; Rooten(x), Access(y), splay(y) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; Rooten(x) ; <span class="keyword">if</span>(Find(y) != x) T[x].F = y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; Access(x), splay(x) ; <span class="keyword">while</span>(lc) push_down(x), x = lc ; splay(x) ; <span class="keyword">return</span> x ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">if</span> (!T[x].R) <span class="keyword">return</span> ; T[x].R = <span class="number">0</span> ; <span class="keyword">if</span> (lc) reverse(lc) ; <span class="keyword">if</span> (rc) reverse(rc) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Cut</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; Rooten(x) ; <span class="keyword">if</span> (Find(y) != x || T[y].Son[<span class="number">0</span>] || T[y].F != x) <span class="keyword">return</span> ; T[y].F = T[x].Son[<span class="number">1</span>] = <span class="number">0</span>, update(x) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ;</span><br><span class="line">rep(i, <span class="number">1</span>, N) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i]) ;</span><br><span class="line">rep(i, <span class="number">1</span>, M)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;A, &amp;B, &amp;C) ;</span><br><span class="line"><span class="keyword">if</span> (A == <span class="number">0</span>) split(B, C), <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, T[C].S) ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (A == <span class="number">1</span>) Link(B, C) ; <span class="keyword">else</span> <span class="keyword">if</span> (A == <span class="number">2</span>) Cut(B, C) ; <span class="keyword">else</span> splay(B), base[B] = C ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="rm-0x00-åè®°å’Œå‚è€ƒ"><a href="#rm-0x00-åè®°å’Œå‚è€ƒ" class="headerlink" title="$\rm{0x00}$   åè®°å’Œå‚è€ƒ"></a>$\rm{0x00}$   åè®°å’Œå‚è€ƒ</h1><p>å¯å†™å®Œäº†â€¦â€¦å—â€¦â€¦<del>æ‰“ä¸ªè‚¥å®…å—çŠ’åŠ³çŠ’åŠ³è‡ªå·±</del></p><p>æ€ä¹ˆè¯´å‘¢ï¼Œè‡ªä»æˆ‘å¼€å§‹å­¦$LCT$åˆ°æˆ‘å†™å®Œè¿™ç¯‡$blog$ä¸ºæ­¢ï¼Œæ˜¯æˆ‘ååˆ†éš¾ç†¬çš„æ—¶é—´ï¼Œæ€»æ—¶é•¿æ¥è¿‘ä¸€å‘¨ã€‚ä¸€å¼€å§‹çœ‹åˆ«äººå†™çš„$LCT$ï¼Œæƒ³å½“ç„¶åœ°ã€è‰ç‡åœ°ç†è§£äº†ç†è§£ï¼Œå°±å¼€å§‹æ‰“æ¿å­ï¼Œå¯¹$LCT$ä¸€ç›´æ˜¯æä¸ºè‚¤æµ…çš„è®¤è¯†ã€‚ç›´åˆ°å¼€å§‹å†™ï¼Œæ‰å‘ç°è‡ªå·±å“ªä¸ªåœ°æ–¹éƒ½ä¸ä¼šï¼Œç†è§£çš„åŠç”Ÿä¸ç†Ÿï¼Œæ€»ä¹‹å¾ˆæƒ¨â€¦â€¦</p><p>å†™åšå®¢çœŸæ˜¯ä¸€ä¸ªé™¶å†¶æƒ…æ“çš„è¿‡ç¨‹å•Šâ€¦â€¦<del>åŒ…æ‹¬åšè¡¨æƒ…åŒ…</del></p><p>åŠ æ²¹å§ï¼Œ$pks$ï¼</p><h2 id="rm-Reference"><a href="#rm-Reference" class="headerlink" title="$\rm{Reference}$"></a>$\rm{Reference}$</h2><ul><li>$[1]$ :$Flash_Hu$çš„$blog$ <a href="http://www.cnblogs.com/flashhu/p/8324551.html" target="_blank" rel="noopener">$^{^{[\nearrow ]}}$</a></li><li>$[2]$ :æŸç¯‡è®ºæ–‡ï¼Œç»“åˆé£Ÿç”¨æ•ˆæœæ˜¾è‘— <a href="https://wenku.baidu.com/view/75906f160b4e767f5acfcedb.html" target="_blank" rel="noopener">$^{^{[\nearrow]}}$</a></li></ul><h2 id="mathfrak-writter-pks"><a href="#mathfrak-writter-pks" class="headerlink" title="$\mathfrak{writter:pks}$"></a>$\mathfrak{writter:pks}$</h2>]]></content>
    
    <summary type="html">
    
      ä¸€ç§ä»¥$Splay$ä½œä¸ºè¾…åŠ©æ ‘çš„ã€åŠ¨æ€ç»´æŠ¤è¿é€šæ€§çš„ç®—æ³•ã€‚
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="LCT-Link Cut Tree" scheme="http://www.orchidany.cf/tags/LCT-Link-Cut-Tree/"/>
    
  </entry>
  
  <entry>
    <title>Intro</title>
    <link href="http://www.orchidany.cf/2019/02/04/Intro-1/"/>
    <id>http://www.orchidany.cf/2019/02/04/Intro-1/</id>
    <published>2019-02-04T15:13:49.000Z</published>
    <updated>2019-03-10T08:16:36.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Hello, here is <strong>Orchidany</strong>, a high-school student from S.D., China.</p><p>Algorithms, astrophysics, technology, thatâ€™s what I love. Perhaps sometimes Iâ€˜m fond of painting, music and modern art appreciation. Anyhow, recently my first mission is <strong>Olympiad in Informatics</strong>ï¼Œshorthanded for <strong>OI</strong>.  And this blog is mainly gonna to record my Learning Steps. </p><p>Although Iâ€™m a bit weak in OI by now, but I shall catch the glimmer and keep getting stronger!</p><p>During daliy lives, I shall also write some about my own emotion, music &amp; artâ€¦it seems like Iâ€™m a chairwamrer in OI hhhhhâ€¦</p><p>See you soon in my articles !</p><p><strong>Somthing Special</strong></p><p>Errrâ€¦About this ID _Orchidany_, there is a theory about that:</p><p>My Chinese Id is çšæœˆåŠæ´’èŠ±ï¼Œ which is from the poem (Writter is myself) :</p><blockquote><h4 id="é¹ƒä½è½è‹±æ»¡ï¼ŒæŸ³æ‹‚æºªç•”æ²™ã€‚"><a href="#é¹ƒä½è½è‹±æ»¡ï¼ŒæŸ³æ‹‚æºªç•”æ²™ã€‚" class="headerlink" title="é¹ƒä½è½è‹±æ»¡ï¼ŒæŸ³æ‹‚æºªç•”æ²™ã€‚"></a>é¹ƒä½è½è‹±æ»¡ï¼ŒæŸ³æ‹‚æºªç•”æ²™ã€‚</h4><h4 id="å—åŸç•¥ç‚ŠçƒŸï¼Œæµ£å¥³å¾å½’å®¶ã€‚"><a href="#å—åŸç•¥ç‚ŠçƒŸï¼Œæµ£å¥³å¾å½’å®¶ã€‚" class="headerlink" title="å—åŸç•¥ç‚ŠçƒŸï¼Œæµ£å¥³å¾å½’å®¶ã€‚"></a>å—åŸç•¥ç‚ŠçƒŸï¼Œæµ£å¥³å¾å½’å®¶ã€‚</h4><h4 id="æ•…äººä»Šå®‰å¦ï¼Œæ¬²æ­Œå£åå“‘ã€‚"><a href="#æ•…äººä»Šå®‰å¦ï¼Œæ¬²æ­Œå£åå“‘ã€‚" class="headerlink" title="æ•…äººä»Šå®‰å¦ï¼Œæ¬²æ­Œå£åå“‘ã€‚"></a>æ•…äººä»Šå®‰å¦ï¼Œæ¬²æ­Œå£åå“‘ã€‚</h4><h4 id="ç¬”å¯’ä¸‹æ¢…å»ï¼ŒçšæœˆåŠæ´’èŠ±ã€‚"><a href="#ç¬”å¯’ä¸‹æ¢…å»ï¼ŒçšæœˆåŠæ´’èŠ±ã€‚" class="headerlink" title="ç¬”å¯’ä¸‹æ¢…å»ï¼ŒçšæœˆåŠæ´’èŠ±ã€‚"></a>ç¬”å¯’ä¸‹æ¢…å»ï¼ŒçšæœˆåŠæ´’èŠ±ã€‚</h4></blockquote><p>Soâ€¦â€¦Iâ€™ m glad to encounter you!</p>]]></content>
    
    <summary type="html">
    
      $\rm{Introduction~with~poor~English}$
    
    </summary>
    
      <category term="æ‚è®°" scheme="http://www.orchidany.cf/categories/%E6%9D%82%E8%AE%B0/"/>
    
    
      <category term="ç¬”å°–ç”ŸèŠ±" scheme="http://www.orchidany.cf/tags/%E7%AC%94%E5%B0%96%E7%94%9F%E8%8A%B1/"/>
    
  </entry>
  
  <entry>
    <title>å¯å¹¶å †Â·å·¦åæ ‘ï¼ˆ1ï¼‰</title>
    <link href="http://www.orchidany.cf/2019/01/27/%E5%B7%A6%E5%81%8F%E6%A0%91/"/>
    <id>http://www.orchidany.cf/2019/01/27/å·¦åæ ‘/</id>
    <published>2019-01-27T08:00:31.000Z</published>
    <updated>2019-03-17T10:20:30.000Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://img.shields.io/badge/%E9%9A%BE%E5%BA%A6-%E6%8F%90%E9%AB%98-skyblue.svg" alt=""></p><p>å—¯â€¦å°±å½“ä½œæ˜¯å¤ä¹ äº†233â€¦æ—¶éš”å¥½å‡ ä¸ªæœˆï¼ˆå…¶å®å°±ä¸¤ä¸ªæœˆï¼‰æ‰æƒ³èµ·æ¥è¦æ•´ç†ã€‚</p><h1 id="rm-0x01-å…³äºå·¦åæ ‘"><a href="#rm-0x01-å…³äºå·¦åæ ‘" class="headerlink" title="$\rm{0x01}$  å…³äºå·¦åæ ‘"></a>$\rm{0x01}$  å…³äºå·¦åæ ‘</h1><p>é¦–å…ˆæ˜¯æ•´ç†è‡ªå·±æƒ³å‡ºæ¥çš„å‡ ä¸ªæ¢—</p><ul><li><p>$\mathcal{To~be~(left) ~or~not ~to~be~(left), this~is ~a~question}$ å·¦åè¿˜æ˜¯å³åï¼Œè¿™æ˜¯ä¸ªé—®é¢˜ã€‚ï¼ˆå“ˆå§†é›·ç‰¹æ¢—ï¼‰</p></li><li><p>$Hell~!~Where~is~my~Left~Leaning~Tree?$ è¯¥æ­»ï¼Œæˆ‘çš„å·¦åæ ‘å‘å³åäº†ã€‚</p></li><li><p>å·¦åæ ‘æ˜¯1ä¸ªlogï¼Œå³åæ ‘ä¹Ÿæ˜¯1ä¸ªlogï¼Œé‚£æˆ‘å·¦å³éƒ½åæ˜¯ä¸æ˜¯å°±ä¼šæ›´å¿«ï¼ï¼ˆæ­å–œä½ å»ºå‡ºäº†ä¸€æ£µæ»¡äºŒå‰æ ‘ï¼‰</p></li><li><p>è®²ä¸ªé¬¼æ•…äº‹ï¼šæ¯æ£µæ ‘éƒ½æ˜¯ä¸‹åæ ‘ã€‚</p></li><li><p>å…¶å®ï¼Œå·¦è€³ç¦»å¿ƒè„æ›´è¿‘ï¼Œæ‰€ä»¥ç”œè¨€èœœè¯­éº»çƒ¦åˆå¹¶åˆ°å·¦åæ ‘é‡Œå§ã€‚ï¼ˆã€Šå·¦è€³ã€‹æ¢—ï¼‰</p></li></ul><p><del>å¥½å§æˆ‘æ‰¿è®¤ä¸æ˜¯å¾ˆå¥½ç¬‘</del></p><p>å‘ï¼Œä¸‹é¢è¿›å…¥æ­£é¢˜ã€‚å·¦åæ ‘ï¼Œä¸€ç§<strong>å¯ä»¥åˆå¹¶çš„å †çŠ¶ç»“æ„</strong>ï¼Œæ”¯æŒ$insert/remove/merge$ç­‰æ“ä½œã€‚ç¨³å®šçš„æ—¶é—´å¤æ‚åº¦åœ¨$\Theta(\log n)$çš„çº§åˆ«ã€‚å¯¹äºä¸€ä¸ªå·¦åæ ‘ä¸­çš„èŠ‚ç‚¹ï¼Œéœ€è¦ç»´æŠ¤çš„å€¼æœ‰$dist$å’Œ$value$ã€‚å…¶ä¸­$value$ä¸å¿…å¤šè¯´ï¼Œ$dist$è®°å½•è¿™ä¸ªèŠ‚ç‚¹åˆ°å®ƒå­æ ‘é‡Œé¢æœ€è¿‘çš„å¶å­èŠ‚ç‚¹çš„è·ç¦»ï¼Œå¶å­èŠ‚ç‚¹è·ç¦»ä¸º$0$ã€‚</p><p>é¦–å…ˆï¼Œä»–æœ‰ä»¥ä¸‹å‡ ä¸ªå–œé—»ä¹è§çš„æ€§è´¨ï¼š</p><ul><li>ä¸€ä¸ªèŠ‚ç‚¹çš„$value$å¿…å®šï¼ˆæˆ–å°äºï¼‰å·¦ã€å³å„¿å­çš„$value$                     <strong>ï¼ˆå †æ€§è´¨ï¼‰</strong></li><li>ä¸€ä¸ªèŠ‚ç‚¹çš„å·¦å„¿å­çš„$dist$ä¸å°äºå³å„¿å­çš„$dist$                           <strong>ï¼ˆå·¦åæ€§è´¨ï¼‰</strong></li><li>ä¸€ä¸ªèŠ‚ç‚¹çš„è·ç¦»å§‹ç»ˆç­‰äºå³å„¿å­$+1$</li></ul><p>é‚£ä¹ˆè¿™å°±å¯ä»¥æ¨å‡ºä»¥ä¸‹æ€§è´¨ï¼š</p><ul><li>æ¨è®ºï¼šä»»ä½•æ—¶å€™ï¼ŒèŠ‚ç‚¹æ•°ä¸º$n$çš„å·¦åæ ‘ï¼Œè·ç¦»æœ€å¤§ä¸º$\log (n+1)-1$<br>$$<br>Proof.<br>$$<pre><code>        å¯¹äºä¸€æ£µè·ç¦»ä¸ºå®šå€¼$k$çš„æ ‘ï¼Œç‚¹æ•°æœ€å°‘æ—¶ï¼Œä¸€å®šæ˜¯ä¸€æ£µæ»¡äºŒå‰æ ‘ã€‚è¿™æ˜¯æ˜¾ç„¶çš„ã€‚å› ä¸ºå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæƒ³è¦æœ‰æœ€å°‘çš„å„¿å­ï¼Œé‚£ä¹ˆèµ·ç è¦åšåˆ°å·¦å„¿å­çš„æ•°é‡ç­‰äºå³å„¿å­çš„æ•°é‡ã€‚é‚£ä¹ˆå¯¹äºä»–çš„é€†å‘½é¢˜ä¹Ÿæ˜¯æˆç«‹çš„â€”â€”â€œè‹¥ä¸€æ£µå·¦åæ ‘çš„è·ç¦»ä¸º$k$ï¼Œåˆ™è¿™æ£µå·¦åæ ‘è‡³å°‘æœ‰$2^{k+1}-1$ä¸ªèŠ‚ç‚¹ã€‚â€    æ‰€ä»¥ä¼šæœ‰$$n \geq 2^{k+1}-1$$,$$\log_2{(n+1)} \geq k+1$$, $$\log_2{(n+1)}-1 \geq k$$ </code></pre>$$<br>\mathcal{Q.E.D}<br>$$</li></ul><p>$emmm$è¿™å¯æ˜¯ä¸€ä¸ªå¾ˆç¾å¦™çš„æ€§è´¨å•Šã€‚</p><h1 id="rm-0x02-åŸºæœ¬æ“ä½œ"><a href="#rm-0x02-åŸºæœ¬æ“ä½œ" class="headerlink" title="$\rm{0x02}~~$åŸºæœ¬æ“ä½œ"></a>$\rm{0x02}~~$åŸºæœ¬æ“ä½œ</h1><ul><li><h2 id="Merge"><a href="#Merge" class="headerlink" title="$Merge$"></a>$Merge$</h2></li></ul><p>è¿™æ˜¯æ•´ä¸ªå·¦åæ ‘çš„é‡å¤´æˆï¼Œæ—¶é—´å¤æ‚åº¦ç¨³å®šåœ¨ä¸€ä¸ª$log$ï¼Œå…¶ä¸»è¦æ€æƒ³å°±æ˜¯ä¸æ–­æŠŠæ–°çš„å †åˆå¹¶åˆ°æ–°çš„æ ¹èŠ‚ç‚¹çš„å³å­æ ‘ä¸­â€”â€”å› ä¸ºæˆ‘ä»¬çš„å³å­æ ‘å†³å®šâ€œè·ç¦»â€è¿™ä¸ªå˜é‡ï¼Œè€Œè·ç¦»åˆä¸€å®šä¿è¯åœ¨$~\log~$çš„å¤æ‚åº¦å†…ï¼Œæ‰€ä»¥ä¸æ–­å‘å³å­æ ‘åˆå¹¶ã€‚</p><p>å¤§ä½“æ€è·¯ï¼ˆä»¥å°æ ¹å †ä¸ºä¾‹ï¼‰ï¼Œé¦–å…ˆæˆ‘ä»¬å‡è®¾ä¸¤ä¸ªèŠ‚ç‚¹$x$å’Œ$y$ï¼Œ$x$çš„æ ¹èŠ‚ç‚¹çš„æƒå€¼å°äºç­‰äº$y$çš„æ ¹èŠ‚ç‚¹ï¼ˆå¦åˆ™$swap(x,y)$ï¼‰ï¼ŒæŠŠ$x$çš„æ ¹èŠ‚ç‚¹ä½œä¸ºæ–°æ ‘$Z$çš„æ ¹èŠ‚ç‚¹ï¼Œå‰©ä¸‹çš„äº‹å°±æ˜¯åˆå¹¶$x$çš„å³å­æ ‘å’Œ$y$äº†ã€‚</p><p>åˆå¹¶äº†$x$çš„å³å­æ ‘å’Œ$y$ä¹‹åï¼Œ$x$å½“$x$çš„å³å­æ ‘çš„è·ç¦»å¤§äº$x$çš„å·¦å­æ ‘çš„è·ç¦»æ—¶ï¼Œä¸ºäº†ç»´æŠ¤æ€§è´¨äºŒï¼Œæˆ‘ä»¬è¦äº¤æ¢$x$çš„å³å­æ ‘å’Œå·¦å­æ ‘ã€‚é¡ºä¾¿ç»´æŠ¤æ€§è´¨ä¸‰ï¼Œæ‰€ä»¥ç›´æ¥$dist_x = dist_{rson(x)}+1$.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y ; </span><br><span class="line">    <span class="keyword">if</span> (S[x].val &gt; S[y].val || (S[x].val == S[y].val &amp;&amp; x &gt; y)) swap(x, y) ;</span><br><span class="line">rs = Merge(rs, y) ; <span class="keyword">if</span> (S[ls].dis &lt; S[rs].dis) swap(ls, rs) ; </span><br><span class="line">    S[ls].rt = S[rs].rt = S[x].rt = x, S[x].dis = S[rs].dis + <span class="number">1</span> ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è§‚å¯Ÿï¼Œæˆ‘ä»¬æ˜¯ä¸æ–­äº¤æ›¿æ‹†åˆ†å³å­æ ‘ï¼Œç”±æ¨è®ºå¯å¾—æˆ‘ä»¬çš„è·ç¦»ä¸ä¼šå¤§äº$\Theta(\log(n_x+1))+\Theta(\log(n_y+1))-2 =O(\log n_x+ \log n_y) $ </p><p>è¿™ä¸ªåœ°æ–¹æ¯”è¾ƒå–œé—»ä¹è§çš„æ˜¯éœ€è¦å­˜$root$ï¼Œå³éœ€è¦è·¯å¾„å‹ç¼©ã€‚ä¸è·¯å¾„å‹ç¼©çš„è¯ï¼Œå¯»ä¸€æ¬¡$rt$å°±æ˜¯$\Theta(n)$çš„äº†ï¼Œå¤æ‚åº¦æ˜¯ä¸å¯¹çš„<del>ä½†ä¼¼ä¹Luoguçš„æ¨¡æ¿ï¼Œä¸è·¯å¾„å‹ç¼©ä¼šæ›´å¿«</del></p><ul><li><h2 id="Pop"><a href="#Pop" class="headerlink" title="$Pop$"></a>$Pop$</h2></li></ul><p>â€¦â€¦$pop$çš„è¯ï¼Œä¹±æå°±å¥½äº†$233$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pop</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; S[x].val = <span class="number">-1</span>, S[ls].rt = ls, S[rs].rt = rs, S[x].rt = Merge(ls, rs) ; &#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯æ€»ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> dis, val, Son[<span class="number">2</span>], rt ;</span><br><span class="line">&#125;S[MAXN] ; <span class="keyword">int</span> N, T, A, B, C, i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">my_swap</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span>&#123; x ^= y ^= x ^= y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> S[x].rt == x ? x : S[x].rt = Get(S[x].rt) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pop</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; S[x].val = <span class="number">-1</span>, S[ls].rt = ls, S[rs].rt = rs, S[x].rt = Merge(ls, rs) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y ; <span class="keyword">if</span> (S[x].val &gt; S[y].val || (S[x].val == S[y].val &amp;&amp; x &gt; y)) swap(x, y) ;</span><br><span class="line">rs = Merge(rs, y) ; <span class="keyword">if</span> (S[ls].dis &lt; S[rs].dis) swap(ls, rs) ; S[ls].rt = S[rs].rt = S[x].rt = x, S[x].dis = S[rs].dis + <span class="number">1</span> ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; T ; S[<span class="number">0</span>].dis = <span class="number">-1</span> ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">S[i].rt = i, <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;S[i].val) ; </span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= T ; ++ i)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B) ;</span><br><span class="line"><span class="keyword">if</span> (A == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;C) ;</span><br><span class="line"><span class="keyword">if</span> (S[B].val == <span class="number">-1</span> || S[C].val == <span class="number">-1</span>) <span class="keyword">continue</span> ;</span><br><span class="line"><span class="keyword">int</span> f1 = Get(B), f2 = Get(C) ; <span class="keyword">if</span> (f1 != f2) S[f1].rt = S[f2].rt = Merge(f1, f2) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(S[B].val == <span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>) ;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, S[Get(B)].val), Pop(Get(B)) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="rm-0x03-ä¸€ç‚¹é—®é¢˜"><a href="#rm-0x03-ä¸€ç‚¹é—®é¢˜" class="headerlink" title="$\rm{0x03}$    ä¸€ç‚¹é—®é¢˜"></a>$\rm{0x03}$    ä¸€ç‚¹é—®é¢˜</h1><p>é—®é¢˜å¤§æ¦‚å°±æ˜¯è·¯å¾„å‹ç¼©â€¦â€¦</p><p><a href="https://www.luogu.org/problemnew/show/P3377" target="_blank" rel="noopener">$LuoguP3377$</a>å¾ˆä¸è´Ÿè´£ä»»åœ°å¤„äº†æ•°æ®ï¼Œå¯¼è‡´ä»¥ä¸‹è¿™ä»½ä»£ç å¯ä»¥è¿‡ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> dis, val, F, Son[<span class="number">2</span>] ;</span><br><span class="line">&#125;S[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> N, T, A, B, C, i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">my_swap</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span>&#123; x ^= y ^= x ^= y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">while</span>(S[x].F) x = S[x].F ; <span class="keyword">return</span> x ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pop</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; S[x].val = <span class="number">-1</span>, S[ls].F = S[rs].F = <span class="number">0</span>, Merge(ls, rs) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y ; <span class="keyword">if</span> (S[x].val &gt; S[y].val || (S[x].val == S[y].val &amp;&amp; x &gt; y)) swap(x, y) ;</span><br><span class="line">    rs = Merge(rs, y), S[rs].F = x ; <span class="keyword">if</span> (S[ls].dis &lt; S[rs].dis) swap(ls, rs) ; S[x].dis = S[rs].dis + <span class="number">1</span> ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; T ; S[<span class="number">0</span>].dis = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;S[i].val) ; </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= T ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B) ;</span><br><span class="line">        <span class="keyword">if</span> (A == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;C) ;</span><br><span class="line">            <span class="keyword">if</span> (S[B].val == <span class="number">-1</span> || S[C].val == <span class="number">-1</span> || B == C) <span class="keyword">continue</span> ;</span><br><span class="line">            <span class="keyword">int</span> f1 = Get(B), f2 = Get(C) ; Merge(f1, f2) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(S[B].val == <span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>) ;</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, S[Get(B)].val), Pop(Get(B)) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€åˆ‡éƒ½å¾ˆæ­£å¸¸ï¼Œä½†é—®é¢˜åœ¨äºä»–å¤æ‚åº¦ä¸å¯¹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">while</span>(S[x].F) x = S[x].F ; <span class="keyword">return</span> x ; &#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¾ç„¶æ˜¯ä¸ªä¸Šç•Œä¸º$O(n)$çš„å‡½æ•°â€¦â€¦ä¸å¯’è€Œæ —â€¦â€¦</p><p>æ‰€ä»¥ä»–æ˜¯ä¸å¯¹çš„ï¼Œ<a href="https://www.luogu.org/discuss/show/96561" target="_blank" rel="noopener">è¿™ç»„æ•°æ®</a>å¯ä»¥å¾ˆå¥½çš„å¡æ‰ï¼ˆç”±å·¨ä½¬å°ç²‰å…”åˆ¶ä½œï¼‰ã€‚</p><p>æ‰€ä»¥åº”è¯¥ç”¨ä¸€ä¸ªå¹¶æŸ¥é›†ç»´æŠ¤ã€‚è€Œæˆ‘ä»¬åœ¨è·¯å¾„å‹ç¼©ä¹‹åï¼Œå¿…é¡»è¦åœ¨$pop$åï¼Œç»™$pop$æ‰çš„ç‚¹ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æ–°çš„æ ¹ï¼Œæ‰€ä»¥ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> S[x].rt == x ? x : S[x].rt = Get(S[x].rt) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pop</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; S[x].val = <span class="number">-1</span>, S[ls].rt = ls, S[rs].rt = rs, S[x].rt = Merge(ls, rs) ; &#125;</span><br></pre></td></tr></table></figure><p>äºæ˜¯æœ€åçš„ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 150010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> swap my_swap</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls S[x].Son[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs S[x].Son[1]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> dis, val, Son[<span class="number">2</span>], rt ;</span><br><span class="line">&#125;S[MAXN] ; <span class="keyword">int</span> N, T, A, B, C, i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">my_swap</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span>&#123; x ^= y ^= x ^= y ;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> S[x].rt == x ? x : S[x].rt = Get(S[x].rt) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Pop</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; S[x].val = <span class="number">-1</span>, S[ls].rt = ls, S[rs].rt = rs, S[x].rt = Merge(ls, rs) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y ; <span class="keyword">if</span> (S[x].val &gt; S[y].val || (S[x].val == S[y].val &amp;&amp; x &gt; y)) swap(x, y) ;</span><br><span class="line">rs = Merge(rs, y) ; <span class="keyword">if</span> (S[ls].dis &lt; S[rs].dis) swap(ls, rs) ; S[ls].rt = S[rs].rt = S[x].rt = x, S[x].dis = S[rs].dis + <span class="number">1</span> ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; T ; S[<span class="number">0</span>].dis = <span class="number">-1</span> ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) </span><br><span class="line">S[i].rt = i, <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;S[i].val) ; </span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= T ; ++ i)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B) ;</span><br><span class="line"><span class="keyword">if</span> (A == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;C) ;</span><br><span class="line"><span class="keyword">if</span> (S[B].val == <span class="number">-1</span> || S[C].val == <span class="number">-1</span>) <span class="keyword">continue</span> ;</span><br><span class="line"><span class="keyword">int</span> f1 = Get(B), f2 = Get(C) ; <span class="keyword">if</span> (f1 != f2) S[f1].rt = S[f2].rt = Merge(f1, f2) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(S[B].val == <span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>) ;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, S[Get(B)].val), Pop(Get(B)) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="rm-0x04-ä¸€é“æ°´é¢˜"><a href="#rm-0x04-ä¸€é“æ°´é¢˜" class="headerlink" title="$\rm{0x04}$    ä¸€é“æ°´é¢˜"></a>$\rm{0x04}$    ä¸€é“æ°´é¢˜</h1><p>æ— è®ºæ€ä¹ˆè¯´ï¼Œå•ç‹¬ç”¨ä¸€ç¯‡åšå®¢æ¥æ•´ç†æ¿å­é¢˜å®åœ¨æ˜¯å¤ª$Low$äº†ï¼ˆå°¤å…¶æ˜¯æ˜¾å¾—ç¬”è€…å¾ˆæ²¡å“ä½ï¼‰ï¼Œäºæ˜¯å°±ç›´æ¥æ‹¼åˆ°ä¸€èµ·å§qwq</p><p><strong>[LuoguP1456]Monkey King</strong> <a href="https://www.luogu.org/problemnew/show/P1456" target="_blank" rel="noopener">é“¾æ¥</a></p><p>è¿™ç©æ„å„¿çœŸtmæ°´çˆ†å•Šâ€¦ç›´æ¥å­˜ä¸ªä»£ç è¯æ˜æˆ‘åšè¿‡è¿™é“é¢˜å§qaqï¼š</p><p>ç­‰ä¼šå„¿ï¼Œçªç„¶æƒ³èµ·æ¥è¿™é“é¢˜çš„å‘ç‚¹æ¥ã€‚å°±æ˜¯åŸæ¥çš„æ¿å­é¢˜ï¼Œéƒ½æ˜¯ç»´æŠ¤åºåˆ—é‚£ç§æ„Ÿè§‰ï¼Œä¸€ä¸ªå…ƒç´ popæ‰ä¹‹ååˆå°±ä¸ç”¨ç®¡å®ƒäº†ã€‚ä½†æ˜¯è¿™é“é¢˜æ˜¯ä¸€é“åº”ç”¨é¢˜ï¼Œæ‰€ä»¥ä¸åº”è¯¥åˆ å®Œä¸ç®¡ï¼Œåº”è¯¥æ¸…ç©ºqwqã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 200010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc T[x].Son[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc T[x].Son[1]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(a, i, b) for(i = a ; i &lt;= b ; ++ i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Heap</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> val, dis, Son[<span class="number">2</span>], rt ;</span><br><span class="line">&#125;T[MAXN] ; <span class="keyword">int</span> N, M, A, B, i ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x == T[x].rt)  <span class="keyword">return</span> x ;</span><br><span class="line"><span class="keyword">return</span> T[x].rt = get(T[x].rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x + y ;</span><br><span class="line"><span class="keyword">if</span> (T[x].val &lt; T[y].val) x ^= y ^= x ^= y ;</span><br><span class="line">rc = Merge(rc, y) ; <span class="keyword">if</span> (T[lc].dis &lt; T[rc].dis) lc ^= rc ^= lc ^= rc ;</span><br><span class="line">T[lc].rt = T[rc].rt = T[x].rt = x, T[x].dis = T[rc].dis + <span class="number">1</span> ; <span class="keyword">return</span> x ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N))&#123;</span><br><span class="line"><span class="built_in">memset</span>(T, <span class="number">0</span>, <span class="keyword">sizeof</span>(T)) ;</span><br><span class="line">rep(<span class="number">1</span>, i, N) T[i].rt = i, <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T[i].val) ; <span class="built_in">cin</span> &gt;&gt; M ;</span><br><span class="line">rep(<span class="number">1</span>, i, M)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;A, &amp;B) ; <span class="keyword">int</span> rt1, rt2 ;</span><br><span class="line"><span class="keyword">int</span> f1 = get(A), f2 = get(B) ; <span class="keyword">int</span> ff1, ff2 ;  </span><br><span class="line"><span class="keyword">if</span> (f1 == f2) &#123; <span class="built_in">puts</span>(<span class="string">"-1"</span>) ; <span class="keyword">continue</span> ; &#125;</span><br><span class="line">T[f1].val &gt;&gt;= <span class="number">1</span>, T[f2].val &gt;&gt;= <span class="number">1</span> ;  </span><br><span class="line">rt1 = Merge(T[f1].Son[<span class="number">0</span>], T[f1].Son[<span class="number">1</span>]) ; </span><br><span class="line">T[f1].Son[<span class="number">0</span>] = T[f1].Son[<span class="number">1</span>] = T[f1].dis = <span class="number">0</span> ; </span><br><span class="line">rt2 = Merge(T[f2].Son[<span class="number">0</span>], T[f2].Son[<span class="number">1</span>]) ; </span><br><span class="line">T[f2].Son[<span class="number">0</span>] = T[f2].Son[<span class="number">1</span>] = T[f2].dis = <span class="number">0</span> ; </span><br><span class="line">ff1 = Merge(f1, rt1), ff2 = Merge(f2, rt2) ;</span><br><span class="line">T[ff2].rt = T[ff1].rt = Merge(ff1, ff2), <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, T[get(T[ff1].rt)].val) ; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$\rm{writter:Flower_pks}$</p>]]></content>
    
    <summary type="html">
    
      ä¸€ç§æ”¯æŒnlognåˆå¹¶çš„å †ç»“æ„
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="http://www.orchidany.cf/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="å¯å¹¶å †/å·¦åæ ‘" scheme="http://www.orchidany.cf/tags/%E5%8F%AF%E5%B9%B6%E5%A0%86-%E5%B7%A6%E5%81%8F%E6%A0%91/"/>
    
  </entry>
  
</feed>
