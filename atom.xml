<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ğ“ğ“»ğ“¬ğ“±ğ“²ğ“­ğ“ªğ“·ğ”‚&#39;ğ”€ ğ“«ğ“µğ“¸ğ“°</title>
  
  <subtitle>A Soul Tune against Fate Should Be Played, now.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.orchidany.cn/"/>
  <updated>2020-02-08T03:43:10.984Z</updated>
  <id>https://www.orchidany.cn/</id>
  
  <author>
    <name>Orchidany</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>éšæƒ³ Â· ç›®æ¬¡è¡¨</title>
    <link href="https://www.orchidany.cn/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/"/>
    <id>https://www.orchidany.cn/2050/12/31/éšæƒ³Â·ç›®æ¬¡è¡¨/</id>
    <published>2050-12-31T14:24:26.000Z</published>
    <updated>2020-02-08T03:43:10.984Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç»ˆäºåˆå¼€å§‹äº†ã€‚</p><a id="more"></a><p>æˆ‘æ˜¯èŠ±ï¼Œä¸€ä¸ªä¸ç†æ™ºçš„$\rm{Oier}$ã€‚æˆ‘ä¹Ÿæƒ³æ¯å¤©24å°æ—¶æ‹¼å‡º48å°æ—¶çš„æ•ˆç‡ä¸€å¿ƒåšé¢˜ï¼Œä½†æ˜¯æˆ‘åšä¸åˆ°ï¼Œæˆ‘è¡€æ¶²ä¸­å‡ç»“ç€çš„ï¼Œåœ¨å‚¬ä¿ƒæˆ‘å†™ä¸‹æ¥ï¼Œå¿…é¡»è¦å†™ä¸‹æ¥ã€‚</p><p>åœ¨è¿™äº›æ–‡ç« é‡Œï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªè¿·èŒ«çš„é’å¹´å¦‚ä½•æ»¡æ€€çƒ­è¡€ä¸ç»æœ›ï¼Œçœ¼é‡Œé—ªçƒç€æ²§æ¡‘ä¸å¸Œæœ›ï¼Œæ€€é‡Œæ£ç€åæ‰çš„ç²®é£Ÿå’Œå´­æ–°çš„è®ºæ–‡ï¼Œè„šä¸‹è¸ç€å´å²–ä¸å¹³çš„è·¯ï¼Œå‘æ˜å¤©èµ°å»ã€‚</p><p>æ˜¯çš„ï¼Œæˆ‘æ˜¯èŠ±ï¼Œæ¥è‡ªå±±ä¸œï¼Œä½ ç›´æ¥å«æˆ‘èŠ±è¿™ä¸ªIDæˆ–è®¸æˆ‘ä¼šå¾ˆé«˜å…´ï¼Œä½†æ˜¯å¦‚æœä½ è®¤è¯†æˆ‘ä¹Ÿå¯ä»¥ä¸è¿™ä¹ˆæ‹˜æŸã€‚</p>        <div id="aplayer-WwwbwDOP" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-WwwbwDOP"),            narrow: false,            autoplay: false,            showlrc: false,            music: {              title: "èŠ±",              author: "Hello Nico",              url: "Hello Nico-èŠ±.flac",              pic: "/2050/12/31/éšæƒ³Â·ç›®æ¬¡è¡¨/qwq.png",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script><p>ä»¥ä¸‹æ˜¯ç›®å½•ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:center">ç¯‡ç›®</th><th style="text-align:center">é“¾æ¥ï¼ˆç‚¹å‡»å³å¯ï¼‰</th></tr></thead><tbody><tr><td style="text-align:center">éšæƒ³ä¸€ Â· å±±ä¸˜</td><td style="text-align:center"><a href="https://www.orchidany.cn/2018/08/02/%E9%9A%8F%E6%83%B3%E4%B8%80/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³äºŒ Â· ä¸˜å‰å°”</td><td style="text-align:center"><a href="https://www.orchidany.cn/2018/08/08/%E9%9A%8F%E6%83%B3%E4%BA%8C/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³ä¸‰ Â· æœ¬èµ›å­£æœ€åçš„éšæƒ³/å¯ç¤ºå½•</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/02/14/%E9%9A%8F%E6%83%B3%E4%B8%89%C2%B7NOIP/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³å›› Â· æ•…äºº</td><td style="text-align:center"><a href="[https://www.orchidany.cn/2019/03/01/%E9%9A%8F%E6%83%B3%E5%9B%9B%C2%B7%E6%95%85%E4%BA%BA/](https://www.orchidany.cn/2019/03/01/éšæƒ³å››Â·æ•…äºº/">$Link$</a>)</td></tr><tr><td style="text-align:center">éšæƒ³äº” Â· æ‰‹ä¸­æ²¡æœ‰çº¢ç«ç‘°</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/02/14/%E9%9A%8F%E6%83%B3%E4%BA%94%C2%B7%E6%83%85%E4%BA%BA%E8%8A%82/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³å…­ Â· éš¾</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/03/10/%E9%9A%8F%E6%83%B3%E5%85%AD%C2%B7Hard/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³ä¸ƒ Â· è¨€å¶ä¹‹åº­</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/03/28/%E9%9A%8F%E6%83%B3%E4%B8%83%C2%B7%E8%A8%80%E5%8F%B6%E4%B9%8B%E5%BA%AD/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³å…« Â· é€ƒå§</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/06/11/8/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³ä¹ Â· æ„ä¹‰</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/07/18/Nine/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³å Â· ç¹æ˜Ÿ</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/08/20/10/">$Link$</a></td></tr></tbody></table></div><p>ç¬¬ä¸€ç¯‡å¤§æ¦‚æ˜¯å¼€å§‹ï¼Ÿ</p><p>ç¬¬äºŒç¯‡å¤§æ¦‚æ˜¯åœ¨è€æ ¡æœºæˆ¿å†™çš„ã€‚å½“æ—¶è‡ªå·±å’Œå‘¨å›´äººçš„å…³ç³»å¹¶ä¸å¥½ã€‚</p><p>ç¬¬ä¸‰ç¯‡å°±æ˜¯2018è€ƒå®ŒNOIPå†™çš„å•¦ã€‚</p><p>ç¬¬å››ç¯‡ç”±äºä¸ªäººååˆ†å–œçˆ±å›å¿†å¾€äº‹ï¼Œæ‰€ä»¥æ˜¯æ¯”è¾ƒé‡è¦çš„ä¸€ç¯‡ï¼Œä½†ç°åœ¨è¿˜æ²¡æœ‰æ›´å®Œã€‚ï¼ˆå› ä¸ºè¦è¯´çš„å¤ªå¤šäº†</p><p>ç¬¬äº”ç¯‡æ˜¯è°ˆæ„Ÿæƒ…çš„å•¦ï¼Œä¼¼ä¹æ˜¯æ¯”è¾ƒå‡ºåçš„ä¸€ç¯‡(?)</p><p>ç¬¬å…­ç¯‡å¤§æ¦‚æ˜¯çå†™çš„ã€‚å¦‚æœæ¯æ¬¡è§‰å¾—å¾ˆéš¾éƒ½è¦å†™ä¸€ç¯‡ï¼Œé‚£ä¼°è®¡åªæœ‰ä¸“èŒä½œå®¶æ‰èƒ½å†™å®Œã€‚</p><p>ç¬¬ä¸ƒç¯‡å¤§æ¦‚æ˜¯çœ‹å®Œã€Šè¨€å¶ä¹‹åº­ã€‹å°±ç«‹å³åœ¨æœºæˆ¿å†™çš„ï¼Œä»£è¡¨çš„å¤§æ¦‚æ˜¯æˆ‘ç†æƒ³ä¸­çˆ±æƒ…çš„æ¨¡æ ·å§ã€‚</p><p>ç¬¬å…«ç¯‡ä¹Ÿå¾ˆé‡è¦ï¼Œæˆ‘çš„å…¨éƒ¨å‹æŠ‘æƒ…ç»ªéƒ½ä¼šå†™è¿›å»ã€‚å½“ç„¶ï¼Œå’Œç¬¬å››ç¯‡ä¸€æ ·ï¼Œè¦è¯´çš„è¯å¤ªå¤šäº†ï¼Œæ‰€ä»¥å†™ä¸å®Œ/kk</p><p>ç¬¬ä¹ç¯‡å¤§æ¦‚æ˜¯ã€Œå¥‡å¼‚äººç”Ÿã€çš„è¯»/è§‚åæ„Ÿï¼Ÿ</p><p>æœ€åä¸€ç¯‡â€¦æ˜¯ç§˜å¯†ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»ˆäºåˆå¼€å§‹äº†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Life" scheme="https://www.orchidany.cn/categories/Life/"/>
    
    
      <category term="éšæƒ³/ä¸‹ä¸‹ç¬”" scheme="https://www.orchidany.cn/tags/%E9%9A%8F%E6%83%B3-%E4%B8%8B%E4%B8%8B%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>ã€å…¬å‘Šã€‘å…³äºè¿™ä¸ªblog</title>
    <link href="https://www.orchidany.cn/2050/02/05/%E3%80%90%E5%85%AC%E5%91%8A%E3%80%91%E5%8D%9A%E5%AE%A2%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    <id>https://www.orchidany.cn/2050/02/05/ã€å…¬å‘Šã€‘åšå®¢ä½¿ç”¨æŒ‡å—/</id>
    <published>2050-02-05T09:51:27.000Z</published>
    <updated>2020-04-16T11:37:33.571Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¤§æ¦‚æ˜¯ä¸€ä¸ªæœ¬blogçš„è§‚å…‰æŒ‡å—ï¼Ÿ<del>è™½ç„¶å¯èƒ½å¹¶æ²¡æœ‰äººæ¥é€›QAQ</del></p><p>å¦‚æœå¯ä»¥çš„è¯ï¼Œè°¢è°¢ä½ å–œæ¬¢æˆ‘ï¼</p><p>2020.3.25 upd: æœ€è¿‘å› ä¸ºæœ‰æ–°çš„ä¸œè¥¿æƒ³ç½®é¡¶ï¼Œäºæ˜¯å°±æŠŠç•™è¨€æ¿æ¢ä¸‹æ¥äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æ¬¢è¿å¤§å®¶æ¥ç•™è¨€ï¼š<a href="https://www.orchidany.cn/2019/08/09/ç•™è¨€æ¿/#more">æˆ³æˆ‘</a> ï¼</p><a id="more"></a><h1 id="å…³äºè‡ªå·±"><a href="#å…³äºè‡ªå·±" class="headerlink" title="å…³äºè‡ªå·±"></a>å…³äºè‡ªå·±</h1><p>ç°åœ¨é«˜äºŒå•¦ï¼Œåæ ‡SDå¼±æ ¡ï¼Œé©¬ä¸Šé€€å½¹å•¦ã€‚</p><p>CSP-2019è€ƒçš„å¤ªèœï¼Œå¯¼è‡´ç°åœ¨ååˆ†è¢«åŠ¨ã€‚</p><p>å¹³æ—¶åœ¨å­¦æ ¡å¤„äºåœè¯¾çŠ¶æ€ã€‚ç”±äºæˆ‘ä»¬ç­å¤§æ¦‚éƒ½åœè¯¾äº†ï¼Œæ‰€ä»¥ä¸æ˜¯å¾ˆæ‹…å¿ƒã€‚</p><p>å…¶å®æŒºçƒ­çˆ±ç®—æ³•çš„å§ï¼Ÿ</p><p>CFå¹³æ—¶çœŸçš„ä¸æ˜¯å¾ˆå¸¸æ‰“ï¼Œæ‰€ä»¥å¹¶ä¸æƒ³ç»™CFçš„IDã€‚sorryå•¦ã€‚</p><p>ä¼¼ä¹å…·æœ‰é²œæ˜çš„å–·å­å±æ€§ï¼Œååˆ†æƒ³æ‘†è„±è¿™ä¸ª <code>tag</code> ã€‚</p><p>QQ:2836531293</p><h1 id="å…³äºé—²æ‰¯"><a href="#å…³äºé—²æ‰¯" class="headerlink" title="å…³äºé—²æ‰¯"></a>å…³äºé—²æ‰¯</h1><p><del>å…³äºå¦‚ä½•åˆ·è®¿é—®é‡</del></p><p>é¦–å…ˆæ˜¯<strong>ã€Œéšæƒ³ã€</strong> ç³»åˆ—ã€‚è¿™ä¸ªç³»åˆ—ï¼Œä»ç”Ÿç†å­¦ä¸Šåˆ†æï¼Œå¤§æ¦‚æ˜¯ä½“å†…é›Œæ€§æ¿€ç´ æ°´å¹³æé«˜çš„æ—¶å€™æ‰ä¼šå†™å‡ºæ¥çš„ä¸œè¥¿ï¼Œéƒ½å¾ˆæ„Ÿæ€§ï¼Œéƒ½æœ‰ç€ä¸°å¯Œçš„æƒ…æ„Ÿå–·è–„ã€‚æ‰€ä»¥å†™è¿™äº›ä¸œè¥¿çš„æ—¶å€™ï¼Œæˆ‘å¤§æ¦‚éƒ½è«å¾—ç†æ™ºã€‚</p><p>ã€Œéšæƒ³ã€ç³»åˆ—ç›®å½•ï¼š<a href="https://www.orchidany.cn/2050/12/31/éšæƒ³Â·ç›®æ¬¡è¡¨">æˆ³</a></p><p>ç„¶åæ˜¯æ–°å¼€çš„ã€Œç”Ÿæ´»ç¢ç‰‡ã€ç³»åˆ—ã€‚å¤§æ¦‚è¿˜æ˜¯é—²æ‰¯ã€‚ä½†æ˜¯è¿™å…¶ä¸­ä¸ä¼šè¿‡å¤šåœ°æºæ‚å¾ˆå¤æ‚çš„æ„Ÿæƒ…ï¼Œæ›´åƒæ˜¯æµæ°´è´¦ã€‚ä»¥åå¤§éƒ¨åˆ†æ—¶é—´å¯èƒ½åªæœ‰è¿™ä¸ªä¼šæ›´æ–°äº†ã€‚</p><p>ã€Œç”Ÿæ´»ç¢ç‰‡ã€ç³»åˆ—ç›®å½•ï¼š<a href="https://www.orchidany.cn/2020/02/07/ç”Ÿæ´»ç¢ç‰‡ç›®å½•/">æˆ³</a></p><p>3.22upd: æœ€è¿‘åˆæŠŠæ›¾ç»è¿ç»­è®°äº†å¥½é•¿ä¸€æ®µæ—¶é—´ã€åŸæ¥æ˜¯ç½®é¡¶çš„ã€Œé—²æ‰¯ã€ç»™å½’æ¡£äº†ï¼š<a href="[https://www.orchidany.cn/2019/12/15/%E9%97%B2%E6%89%AF/](https://www.orchidany.cn/2019/12/15/é—²æ‰¯/">æˆ³</a>)</p><h1 id="å…³äºOI"><a href="#å…³äºOI" class="headerlink" title="å…³äºOI"></a>å…³äºOI</h1><p>å¤§æ¦‚ä»¥åç®—æ³•å­¦ä¹ å°±ä¸ä¼šå¾ˆæ¶‰åŠäº†ï¼Ÿå¤§éƒ¨åˆ†éƒ½ä¼šæ˜¯åšé¢˜ã€‚æœ‰äº› blog å¯èƒ½æœ‰å¯†ç ï¼Œéœ€è¦çš„è¯å¯ä»¥æ¥æ‰¾æˆ‘è¦ã€‚</p><p>ä¸ªäººæ¯”è¾ƒè®¨åŒä¸€ä¸ªé¢˜çœ‹ä¸€ç¯‡blogï¼Œå¤ªæµªè´¹ç©ºé—´<del>é™¤äº†æˆ‘æƒ³æ°´blogçš„æ—¶å€™ç¡®å®ä¼šè¿™ä¹ˆåš</del>ã€‚</p><h1 id="å…³äºå‹é“¾"><a href="#å…³äºå‹é“¾" class="headerlink" title="å…³äºå‹é“¾"></a>å…³äºå‹é“¾</h1><p>å‹é“¾çš„è¯ï¼Œå¯ä»¥åŠ æˆ‘çš„ä¼é¹…å·ç”³è¯·ï¼Œæˆ–è€…ç›´æ¥å»ä¾§è¾¹æ çš„ <code>Friends</code> é‚£ä¸€æ è¯„è®ºç”³è¯·ã€‚</p><p>æ‰€æœ‰çš„æœ‹å‹éƒ½ä¼šå¾…åœ¨ä¾§è¾¹æ  <code>Friends</code> çš„é¡µé¢ä¸­å“¦ã€‚</p><h1 id="å…³äºç•™è¨€"><a href="#å…³äºç•™è¨€" class="headerlink" title="å…³äºç•™è¨€"></a>å…³äºç•™è¨€</h1><p>è¯·è®¿é—®è¿™ä¸ªblogçš„äººï¼ŒåŠ¡å¿…å»ç•™è¨€æ¿ç•™ä¸ªè¨€å•ŠQAQ</p><p>æˆ‘ä¸€ä¸ªäººå¾ˆæ— èŠçš„è¯´QAQ</p><h1 id="å…³äºç¼ºçœæº"><a href="#å…³äºç¼ºçœæº" class="headerlink" title="å…³äºç¼ºçœæº"></a>å…³äºç¼ºçœæº</h1><p>è¿™ä¸€éƒ¨åˆ†æ›´æ–°äº 2020.4.16</p><p>æƒ³äº†æƒ³å…¶å®è‡ªå·±ä¹Ÿæ²¡å•¥ç¼ºçœçš„ï¼Œäºæ˜¯ä¼¼ä¹ç¼ºçœæºä¹Ÿä¸é•¿çš„æ ·å­ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr firsr</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (rt &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs (rt &lt;&lt; 1 | 1)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> val(k) E[k].val</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rg register</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db ;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vint ;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mint ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> db eps = <span class="number">1e-7</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">100010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">0</span>, f = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &gt; <span class="string">'9'</span> || c &lt; <span class="string">'0'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>) f = <span class="number">-1</span> ; c = getchar() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &lt;= <span class="string">'9'</span> &amp;&amp; c &gt;= <span class="string">'0'</span>)&#123;</span><br><span class="line">        r = (r &lt;&lt; <span class="number">1</span>) + (r &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r * f ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(T *<span class="keyword">const</span> tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> v = <span class="string">' '</span>, <span class="keyword">char</span> c = <span class="string">'\n'</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i) <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; v ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¤§æ¦‚æ˜¯ä¸€ä¸ªæœ¬blogçš„è§‚å…‰æŒ‡å—ï¼Ÿ&lt;del&gt;è™½ç„¶å¯èƒ½å¹¶æ²¡æœ‰äººæ¥é€›QAQ&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœå¯ä»¥çš„è¯ï¼Œè°¢è°¢ä½ å–œæ¬¢æˆ‘ï¼&lt;/p&gt;
&lt;p&gt;2020.3.25 upd: æœ€è¿‘å› ä¸ºæœ‰æ–°çš„ä¸œè¥¿æƒ³ç½®é¡¶ï¼Œäºæ˜¯å°±æŠŠç•™è¨€æ¿æ¢ä¸‹æ¥äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æ¬¢è¿å¤§å®¶æ¥ç•™è¨€ï¼š&lt;a href=&quot;https://www.orchidany.cn/2019/08/09/ç•™è¨€æ¿/#more&quot;&gt;æˆ³æˆ‘&lt;/a&gt; ï¼&lt;/p&gt;
    
    </summary>
    
      <category term="Life" scheme="https://www.orchidany.cn/categories/Life/"/>
    
    
      <category term="ç¬”å°–ç”ŸèŠ±" scheme="https://www.orchidany.cn/tags/%E7%AC%94%E5%B0%96%E7%94%9F%E8%8A%B1/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘[CF671E] Organizing a Race</title>
    <link href="https://www.orchidany.cn/2020/04/17/CF671E/"/>
    <id>https://www.orchidany.cn/2020/04/17/CF671E/</id>
    <published>2020-04-17T08:24:56.000Z</published>
    <updated>2020-04-17T11:09:30.578Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>æœ‰ $n$ ä¸ªç‚¹ä¾æ¬¡æ’æˆä¸€åˆ—ï¼Œç¬¬ $i$ ä¸ªç‚¹ä¸ç¬¬ $i + 1$ ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ä¸º $w_i$ ä¸ªå•ä½ã€‚ç¬¬ $i$ ä¸ªç‚¹æœ‰ä¸€ä¸ªåŠ æ²¹ç«™ï¼Œå¯ä»¥ç»™ä½ çš„è½¦åŠ èƒ½è·‘ $g_i$ ä¸ªå•ä½çš„æ²¹ã€‚</p><p>ä½ éœ€è¦åœ¨ $l, r$ ä¹‹é—´å¾€è¿”ï¼ˆ$l \le r$ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦æ»¡è¶³ä¸€è¾†æ²¡æœ‰æ²¹çš„è½¦èƒ½ä» $l$ ä¸€è·¯å‘å³å¼€åˆ° $r$ï¼Œä¹Ÿèƒ½ä» $r$ ä¸€è·¯å‘å·¦å¼€åˆ° $l$ã€‚è½¦ä¼šåœ¨èµ·ç‚¹åŠ å¥½æ²¹ï¼Œä½ å¯ä»¥åœ¨ä¸­é€”åŠ æ²¹ï¼Œä½†æ˜¯æ–¹å‘æ˜¯ä¸èƒ½æ”¹å˜çš„ã€‚ä½ å¯ä»¥å‡è®¾è½¦çš„æ²¹ç®±æ˜¯æ— é™å¤§çš„ã€‚</p><p>ä½ è¿˜æ²¡é€‰å¥½ $l, r$ çš„å…·ä½“å–å€¼ï¼Œä¸è¿‡ä½ å¸Œæœ›è®©ä½ ç»è¿‡çš„ç‚¹æ•°å°½é‡å¤šï¼Œä¹Ÿå°±æ˜¯è®© $r - l + 1$ å°½é‡å¤§ã€‚</p><p>ä½ ç°åœ¨æœ‰ $k$ ä¸ªæœºä¼šï¼Œæ¯ä¸ªæœºä¼šå¯ä»¥å°†ä»»æ„ä¸€ä¸ª $g_i$ å¢åŠ  $1$ã€‚é—®ï¼šä½¿ç”¨ $k$ æ¬¡æœºä¼šåï¼Œèƒ½å¾—åˆ°çš„æœ€å¤§çš„ $r - l + 1$ æ˜¯å¤šå°‘ï¼Ÿ</p></blockquote><p>å† æ”¾ é€ </p><p>è¿™é¢˜æ˜¯ååˆ†çš„ç¥â€¦æ‰€ä»¥ä¹Ÿéš¾æ€ª $4$ å¹´å‰çš„é¢˜ç›®ä¼šè¢«é€‰å…¥ä»Šå¹´çš„é›†è®­é˜Ÿä½œä¸šã€‚</p><p>åšè¿™é¢˜ï¼Œé‚£å¿…ç„¶å°±æ˜¯çœ‹é¢˜è§£â€¦è¿™é¢˜éš¾ç‚¹ç”±ä¸¤éƒ¨åˆ†ï¼Œã€Œè½¬åŒ–æˆæŠ½è±¡æ¨¡å‹ã€å’Œã€Œç”¨çº¿æ®µæ ‘ç»´æŠ¤ã€ï¼Œæ¯”è¾ƒç¥å¥‡çš„æ˜¯è¿™é¢˜é‡Œè¿™ä¸¤éƒ¨åˆ†å‡ ä¹åŒç­‰éš¾åº¦ï¼Œå¹¶ä¸”éƒ½æ˜¯æˆ‘éš¾ä»¥æœ›è§çš„é«˜åº¦â€¦</p><p>æ¥ä¸‹æ¥åº”è¯¥ä¸å¤ªä¼šåšè¿™ç§éš¾åº¦çš„é¢˜äº†ã€‚æ„Ÿè§‰å¾ˆä¸å¥½ã€‚è™½ç„¶è¿™é¢˜ç¡®å®ååˆ†çš„å¥½ï¼Œæ–°é¢–æœ‰è¶£ä¸”ç»å…¸ï¼Œä½†æˆ‘è¿˜æ˜¯é©¾é©­ä¸äº†è¿™ç§é¢˜ç›®å§â€¦ </p><a id="more"></a><p>XXXXXXXXXXXX æ­£æ–‡ XXXXXXXXXXXX</p><p>é¦–å…ˆè€ƒè™‘ï¼Œå¯¹äºä¸€æ®µåŒºé—´è€Œè¨€ï¼Œéœ€è¦å¤šå°‘æ“ä½œå¤šå°‘æ¬¡ï¼Œæ‰èƒ½ä¿è¯æ­£ç€èµ°å®Œå¹¶ä¸”åç€èµ°å®Œã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯éœ€è¦ç®—å‡ºæ­£ç€èµ°å’Œåç€èµ°éƒ½éœ€è¦é¢å¤–çš„å¤šå°‘ä»£ä»·ã€‚</p><p>è¿™ä¸ªåœ°æ–¹æœ‰ä¸ªè´ªå¿ƒã€‚è€ƒè™‘å®šã€Œå‘å³èµ°ã€ä¸ºæ­£æ–¹å‘ã€‚é‚£ä¹ˆå‡è®¾ä» $i$ å¼€å§‹èµ°ï¼Œå¦‚æœé‡åˆ°æŸä¸ª $j&gt;i$ å‘ç°èµ°ä¸å¾—ï¼Œé‚£ä¹ˆåº”è¯¥åœ¨ä½•å¤„åŠ æ²¹ï¼Ÿå› ä¸ºè¿˜è¦è€ƒè™‘åç€èµ°å›æ¥ï¼Œæ‰€ä»¥å¿…ç„¶æ˜¯åŠ åœ¨æœ€é å³çš„åœ°æ–¹æœ€ä¼˜ï¼Œæ‰€ä»¥å°±ä¼šé€‰æ‹©çš„åœ¨ $j-1$ å¤„åŠ æ²¹ã€‚è®° $i$ å‘å³èµ°é‡åˆ°çš„ç¬¬ä¸€ä¸ªè¿™æ ·çš„ $j$ ä¸º $stop_i$  ã€‚</p><p>äºæ˜¯æ ¹æ®è¿™ä¸ªè´ªå¿ƒå°±å¯ä»¥æ±‚å‡º $need(i,j)$ ï¼Œè¡¨ç¤ºä» $i$ èµ°åˆ° $j$ éœ€è¦å¤šå°‘ä»£ä»·ã€‚ä½†è¿™æ ·ä¹Ÿæ˜¯åªæ˜¯ä¿è¯äº†æ­£ç€å¯ä»¥èµ°ã€‚ä¸å¦¨ä»¤ $p_{i}$ è¡¨ç¤ºä» $1$ èµ°åˆ° $i$ èŠ±è´¹çš„æ²¹é‡ï¼Œ$q_i$ è¡¨ç¤ºä» $i$ èµ°åˆ° $1$ èŠ±è´¹çš„æ²¹é‡ã€‚ é‚£ä¹ˆå¯çŸ¥æœ‰é€’æ¨ï¼š</p><script type="math/tex; mode=display">\begin{aligned}p_i&=p_{i-1}+g_{i-1}-w_{i-1}\\q_i&=q_{i-1}+g_{i-1}-w_i\end{aligned}</script><p>é‚£ä¹ˆå¯ä»¥çŸ¥é“ï¼Œåœ¨èµ° $i\to j$ è¿™æ¡è·¯çº¿æ—¶ï¼ŒåŒæ—¶ä¹Ÿåœ¨è¿›è¡Œå¯¹ </p><script type="math/tex; mode=display">g_{stop_i},g_{stop_{stop_i}},g_{stop_{stop_{stop_i}}}\cdots</script><p>è¿™äº›ä½ç½®è¿›è¡Œå•ç‚¹åŠ ï¼Œé‚£ä¹ˆå¯¹ $q$ çš„å½±å“å°±æ˜¯ä¸€ä¸ªåç¼€åŠ ã€‚è®°åç¼€åŠ å®Œä¹‹åçš„ $\{q_n\}$ ä¸º $\{\tau_n\}$ ã€‚åˆ™å¦‚æœä¸èƒ½ä» $j$ å›åˆ° $i$ ï¼Œå°±æ„å‘³ç€ç€å­˜åœ¨ä¸€ä¸ª $i\leq k&lt;j$ ï¼Œä½¿å¾— $q_{k}-q_{j}&lt;0$ ã€‚æ€ä¹ˆé‡åŒ–è¿™ä¸ªä¸œè¥¿å‘¢ï¼Ÿè€ƒè™‘è¿˜æ˜¯è´ªå¿ƒï¼Œå¦‚æœä» $j$ åˆ° $i$ èµ°ä¸äº†ï¼Œé‚£ä¹ˆä¸€å®šä¼šè¦æŠŠè´¡çŒ®ç´¯åŠ åˆ° $j$ ä¸Šï¼Œé‚£éœ€è¦ç´¯åŠ çš„é‡å°±æ˜¯ $q_{j}-\min_{k=i}^{j-1}\{q_{k}\}$ ã€‚è¿™ä¹Ÿå°±æ˜¯å¦‚æœæƒ³è¦ $[i,j]$ è¿™ä¸ªåŒºé—´å˜å¾—åˆæ³•çš„æœ€å°è´¡çŒ®ã€‚</p><p>è€ƒè™‘å¦‚ä½•è®¡ç®—è¿™ä¸ªä¸œè¥¿ã€‚æ¯”è¾ƒæš´åŠ›çš„è§£æ³•é‚£å¿…ç„¶æ˜¯æšä¸¾ä¸€ä¸ªå·¦ç«¯ç‚¹ï¼Œç„¶åå‘å³èµ°æ›´æ–°å³ç«¯ç‚¹ã€‚è¿™æ ·æ˜¯ $n^2$ çš„ã€‚å‘ç°å¦‚æœæƒ³è¦ä¼˜åŒ–ï¼Œåªèƒ½é€‰æ‹©åŠ é€Ÿå¯»æ‰¾å³ç«¯ç‚¹è¿™ä¸ªè¿‡ç¨‹ã€‚ä½†æ˜¯æœ‰ä¸ªé—®é¢˜åœ¨äºï¼Œå¯¹äºå›ºå®šçš„ $i$ ï¼Œå’Œæƒ³è¦äºŒåˆ†å‡ºçš„ $jâ€™$ï¼Œè¦ç»è¿‡ä¸åŒçš„ $stop$ é›†åˆï¼ŒåŒæ—¶æœ‰ç€ä¸åŒçš„ $q_{jâ€™}-\min_{k=i}^{jâ€™-1}\{q_{k}\}$ ï¼Œæ±‚ä¸€æ¬¡æ˜¯ $O(n)$ çš„ï¼Œåè€ŒæŠŠå¤æ‚åº¦ææˆäº† $n^2\log n$ ã€‚</p><p>åˆ†å¼€è€ƒè™‘è¿™ä¸¤ç‚¹ã€‚å¯¹äºç»è¿‡ä¸åŒ $stop$ é›†åˆè¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç»§ç»­æ·±å…¥æŒ–æ˜æ€§è´¨ã€‚å‘ç°å¯¹äºä¸€ä¸ª $j$ï¼Œå¯èƒ½å­˜åœ¨ä¸€ä¸ªè¿ç»­æ®µ $[k_1,k_2]$ æ»¡è¶³ $\forall z\in[k_1,k_2]\cap\mathbb{Z_+}$ ï¼Œ$stop_z=j$ ã€‚è¿™ç§ä¸€å¯¹å¤šçš„é€»è¾‘ç»“æ„ä¸éš¾æƒ³åˆ°è¦ç”¨æ£®æ—å»è¡¨å¾ã€‚é‚£ä¹ˆè¿™ä¸ªé—®é¢˜æ¯”è¾ƒå¥½è§£å†³äº†ã€‚å»ºå‡ºä¸€æ£µæ£®æ— $T$ ï¼Œè¿è¾¹ $i\leftrightarrow stop_i$ ã€‚å†å»ºç«‹ä¸€ä¸ªè™šæ ¹ $root$ ï¼Œä¸æ‰€æœ‰ $stop_i$ æœªå®šä¹‰çš„ç»“ç‚¹ç›¸è¿ã€‚è¿™æ ·åªè¦ä» $root$ å¼€å§‹ dfsï¼Œç”¨é€€æ ˆçš„æ–¹å¼è¾…åŠ©äºŒåˆ†å³å¯å¿«é€Ÿä¿®æ”¹ã€‚</p><p>å¯¹äºç¬¬äºŒç‚¹ï¼Œè€ƒè™‘å¯¹äºä¸€ä¸ªå›ºå®šçš„ $i$ ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨ç»´æŠ¤è¿™ä¹ˆä¸€ä¸ªå¼å­ï¼š</p><script type="math/tex; mode=display">t_{j'}=q_{j'}-\min_{k=i}^{j'}\{\tau_k \}</script><p>é¦–å…ˆå˜ä¸€ä¸‹å½¢ï¼š</p><script type="math/tex; mode=display">t_{j'}=q_{j'}-\min_{k=1}^{j'}\{\tau_k \}</script><p>è¿™æ ·åšçš„æ­£ç¡®æ€§åœ¨äºï¼Œåªè¦æ¯æ¬¡å°† $&lt;i$ çš„é‚£äº› $k$ çš„ $\tau_k$ éƒ½ç½®ä¸º $+\infty$ å°±å¯ä»¥äº†ã€‚</p><p>è€ƒè™‘åˆ°åº•è¦æ€ä¹ˆç»´æŠ¤è¿™ä¸ªä¸œè¥¿ã€‚å‘ç°åœ¨æŸ¥è¯¢çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å•ç‚¹ä¿®æ”¹ $g_i$ ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯åŒºé—´ä¿®æ”¹ $q_j$ å’Œ $\tau_k$ ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´è¦æ”¯æŒï¼š1ã€ç»´æŠ¤å‰ç¼€æœ€å°å€¼ 2ã€åŒºé—´åŠ /å‡ 3ã€æŸ¥è¯¢å‡ºæŸä¸ªæœ€å°å€¼çš„ä½ç½®ã€‚é‚£è‡ªç„¶å°±æ˜¯çº¿æ®µæ ‘äº†ã€‚</p><p>è€ƒè™‘åä¸€åŠçš„å‰ç¼€æœ€å°å€¼ï¼Œå› ä¸ºå¸¦ä¸Šä¿®æ”¹æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥ç»´æŠ¤èµ·æ¥ä¾ç„¶è¦é€‰æ‹©æ¥¼æˆ¿é‡å»ºçš„æ–¹å¼ï¼Œæ‹¿å·¦åŒºé—´çš„æœ€å°å€¼å»äºŒåˆ†å³åŒºé—´çš„å‰ç¼€ã€‚äºæ˜¯å¯ä»¥æ¯”è¾ƒç®€å•åœ°ç»´æŠ¤å‡ºä¸€ä¸ªåŒºé—´çš„ $\min\{t_i\}$ ã€‚</p><p>è€ƒè™‘ä¿®æ”¹ã€‚ä¿®æ”¹çš„è¯å°±æ˜¯æš´åŠ›æ‰“æ ‡è®°ï¼Œæ³¨æ„åˆ° $t_i$ ä¸­çš„ $\tau_k$ æ˜¯è´Ÿè´¡çŒ®ï¼Œè¢« $\min$ å¥—ç€ï¼Œä½†ç”±äºæ˜¯åŒºé—´ä¿®æ”¹æ‰€ä»¥å¯ä»¥ç›´æ¥å‡ã€‚</p><p>è€ƒè™‘å¦‚ä½•æŸ¥è¯¢ã€‚è¯¢é—®æ¯”è¾ƒéº»çƒ¦ï¼Œå› ä¸ºç›¸å½“äºæŸ¥è¯¢æ—¶è¦åˆå¹¶å¤šä¸ªåŒºé—´çš„å•è°ƒæ ˆï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥çº¿æ®µæ ‘äºŒåˆ†ã€‚æˆ–è€…è¯´ï¼Œéœ€è¦é­”æ”¹ä¸€ä¸‹äºŒåˆ†ï¼Œè®©è¿™ä¸ªäºŒåˆ†å¯ä»¥ã€Œè¾¹äºŒåˆ†ï¼Œè¾¹åˆå¹¶ã€ã€‚</p><p>è€ƒè™‘ä¸€ç§æ¯”è¾ƒç¥ç§˜çš„æ–¹å¼å»æ‰¾ã€‚<code>query(root, l, r, val)</code> æŸ¥è¯¢çš„æ˜¯åŒºé—´ $[1,l-1]$ å†…æŸä¸ªæ•° <code>val</code>ï¼Œä½œä¸ºå‰ç¼€æœ€å°å€¼å¯¹åŒºé—´ $[l,r]$ æœ‰å½±å“æ—¶ï¼Œæœ€é å³çš„ $\leq m$ çš„ä½ç½®ã€‚é‚£ä¹ˆè€ƒè™‘åˆ†ç±»ï¼š</p><p>1ã€å¦‚æœå½“å‰å·¦å­©å­åŒºé—´çš„ $\min\{\tau_k\}$ æ¯” $val$ è¦å°ï¼Œè¯´æ˜å½“å‰çš„å‰ç¼€æœ€å°å€¼ä¸ä¼šå¯¹å³åŒºé—´äº§ç”Ÿå½±å“(å› ä¸ºå·¦å³åŒºé—´å·²ç»åˆå¹¶äº†)ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥åˆ¤æ–­åœ¨ç®—ä¸Šå·¦åŒºé—´å¯¹å³åŒºé—´è´¡çŒ®æ—¶ï¼Œå³åŒºé—´ $t$ çš„æœ€å°å€¼æ˜¯å¦ $\leq m$  â€”â€” è¿™å°±æ˜¯æ¯”è¾ƒæœ´ç´ çš„çº¿æ®µæ ‘ä¸ŠäºŒåˆ† â€”â€” å¦‚æœæ˜¯çš„è¯å°±åº”è¯¥å»å³å„¿å­é‡Œé¢æ‰¾ï¼Œå¦åˆ™å»å·¦å„¿å­é‡Œæ‰¾ã€‚</p><p>2ã€å¦‚æœå½“å‰å·¦å­©å­åŒºé—´çš„ $\min\{\tau_k\}$ æ¯” $val$ è¦å¤§ï¼Œè¯´æ˜å·¦åŒºé—´å¯¹å³åŒºé—´äº§ç”Ÿçš„è´¡çŒ®ä¼šè¢« $val$ äº§ç”Ÿçš„è´¡çŒ®ä»£æ›¿ï¼Œæ‰€ä»¥ç›´æ¥é€’å½’è¿›å³å­©å­ã€‚å¹¶ä¸”ç”±äº $val$ å·²ç»å˜æˆäº†å½“å‰å·¦åŒºé—´çš„å‰ç¼€æœ€å°å€¼ï¼Œæ‰€ä»¥å·¦åŒºé—´çš„ $\min\{\tau_k\}$ å°±å˜æˆäº†æ— ç”¨ä¿¡æ¯(å› ä¸ºè‚¯å®šéƒ½æ¯” $val$ å¤§)ï¼Œåªéœ€è¦æŸ¥è¯¢åœ¨ $q_i+val\leq m$ æ—¶çš„æœ€å¤§ä¸‹æ ‡å³å¯ï¼Œè¿™ä¸€éƒ¨åˆ†å¯ä»¥ç›´æ¥çº¿æ®µæ ‘äºŒåˆ†ã€‚</p><p>ä½†â€¦è¿™ä¼¼ä¹ä¹Ÿä¸æ˜¯æœ€ç»ˆçš„æŸ¥è¯¢ã€‚è€ƒè™‘ä¸ºäº†è®©æœ€åçš„ $\min_{k=1}^{jâ€™}\{\tau_k\}$ çœŸçš„å˜æˆä» $1$ å¼€å§‹åˆ° $i$ ç»“æŸçš„æœ€å°å€¼ï¼Œ æ‰€ä»¥éœ€è¦åŠ¨æ€ä¿®æ”¹ $val$ çš„å€¼ã€‚å…ˆåºéå†çº¿æ®µæ ‘å³å¯ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥ç»´æŠ¤ä¸€ä¸ªå‰ç¼€æœ€å° $\tau_k$ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr firsr</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (rt &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs (rt &lt;&lt; 1 | 1)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> val(k) E[k].val</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rg register</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vint ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mint ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> db eps = <span class="number">1e-7</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ll Inf = (<span class="number">1l</span>l &lt;&lt; <span class="number">60</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ll Fni = -(<span class="number">1l</span>l &lt;&lt; <span class="number">60</span>);</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">0</span>, f = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &gt; <span class="string">'9'</span> || c &lt; <span class="string">'0'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>) f = <span class="number">-1</span> ; c = getchar() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &lt;= <span class="string">'9'</span> &amp;&amp; c &gt;= <span class="string">'0'</span>)&#123;</span><br><span class="line">        r = (r &lt;&lt; <span class="number">1</span>) + (r &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r * f ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(T *<span class="keyword">const</span> tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> v = <span class="string">' '</span>, <span class="keyword">char</span> c = <span class="string">'\n'</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i) <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; v ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to ;</span><br><span class="line">    <span class="keyword">int</span> val ;</span><br><span class="line">    <span class="keyword">int</span> next ;</span><br><span class="line">&#125;E[N * <span class="number">2</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_e</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> w = <span class="number">0</span>)</span></span>&#123;</span><br><span class="line">    to(++ cnt) = y ; val(cnt) = w ;</span><br><span class="line">    next(cnt) = head[x] ; head[x] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> top ;</span><br><span class="line">ll sp[N] ;</span><br><span class="line">ll ss[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> w[N] ;</span><br><span class="line"><span class="keyword">int</span> g[N] ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">int</span> stk[N] ;</span><br><span class="line"></span><br><span class="line">ll s[N * <span class="number">3</span>] ;</span><br><span class="line">ll sa[N * <span class="number">3</span>] ;</span><br><span class="line">ll sb[N * <span class="number">3</span>] ;</span><br><span class="line">ll tag[N * <span class="number">3</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _down(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line"><span class="keyword">if</span> (tag[rt])&#123;</span><br><span class="line">s[ls] -= tag[rt] ;</span><br><span class="line">s[rs] -= tag[rt] ;</span><br><span class="line">sb[ls] += tag[rt] ;</span><br><span class="line">sb[rs] += tag[rt] ;</span><br><span class="line">tag[ls] += tag[rt] ;</span><br><span class="line">tag[rs] += tag[rt] ;</span><br><span class="line">tag[rt] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(<span class="keyword">int</span> rt ,<span class="keyword">int</span> l, <span class="keyword">int</span> r, ll v)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)</span><br><span class="line"><span class="keyword">return</span> sa[rt] - v ;</span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt, l, r) ;</span><br><span class="line"><span class="keyword">if</span> (sb[ls] &lt; v)</span><br><span class="line"><span class="keyword">return</span> min(solve(ls, l, mid, v), s[rt]) ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> min(solve(rs, mid + <span class="number">1</span>, r, v), sa[ls] - v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">void</span>(sa[rt] = sb[rt] = ss[l]) ;</span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">build(ls, l, mid) ;</span><br><span class="line">build(rs, mid + <span class="number">1</span>, r) ;</span><br><span class="line">sa[rt] = min(sa[ls], sa[rs]) ;</span><br><span class="line">sb[rt] = min(sb[ls], sb[rs]) ;</span><br><span class="line">s[rt] = solve(rs, mid + <span class="number">1</span>, r, sb[ls]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, ll v)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (ul &lt;= l &amp;&amp; r &lt;= ur)&#123;</span><br><span class="line">tag[rt] += v ;</span><br><span class="line">sb[rt] += v ;</span><br><span class="line">s[rt] -= v ; <span class="comment">//1</span></span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">_down(rt, l, r) ;</span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (ul &lt;= mid)</span><br><span class="line">update(ls, l, mid, ul, ur, v) ;</span><br><span class="line"><span class="keyword">if</span> (ur &gt; mid)</span><br><span class="line">update(rs, mid + <span class="number">1</span>, r, ul, ur, v) ;</span><br><span class="line">sb[rt] = min(sb[ls], sb[rs]) ;</span><br><span class="line">s[rt] = solve(rs, mid + <span class="number">1</span>, r, sb[ls]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, ll v)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r) <span class="keyword">return</span> l ;</span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (sa[rs] &gt; v)</span><br><span class="line"><span class="keyword">return</span> ask(ls, l, mid, v) ;</span><br><span class="line"><span class="keyword">return</span> ask(rs, mid + <span class="number">1</span>, r, v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, ll &amp;v)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)&#123;</span><br><span class="line"><span class="keyword">int</span> ret ;</span><br><span class="line">ret = sa[rt] - v &lt;= m ? l : <span class="number">0</span> ;</span><br><span class="line">v = min(v, sb[rt]) ;</span><br><span class="line"><span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt, l, r) ;</span><br><span class="line"><span class="keyword">if</span> (sb[ls] &lt; v)&#123;</span><br><span class="line"><span class="keyword">if</span> (s[rt] &lt;= m)&#123;</span><br><span class="line">v = sb[ls] ;</span><br><span class="line"><span class="keyword">return</span> query(rs, mid + <span class="number">1</span>, r, v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> ret ;</span><br><span class="line">ret = query(ls, l, mid, v) ;</span><br><span class="line">v = min(v, sb[rt]) ; <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">if</span> (sa[rt] - v &lt;= m)</span><br><span class="line">ret = ask(ls, l, mid, m + v) ;</span><br><span class="line"><span class="keyword">return</span> max(ret, query(rs, mid + <span class="number">1</span>, r, v)) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">stk[++ top] = x ;</span><br><span class="line"><span class="keyword">if</span> (fa[x] &lt;= n)</span><br><span class="line">update(<span class="number">1</span>, <span class="number">1</span>, n, fa[x] - <span class="number">1</span>, n, - sp[fa[x]] + sp[x]) ;</span><br><span class="line"><span class="keyword">if</span> (x &lt;= n)&#123;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">2</span>, r = top - <span class="number">1</span>, ans = <span class="number">1</span>, mid ;</span><br><span class="line"><span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line">            mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (sp[stk[mid]] - sp[x] &gt; m)</span><br><span class="line">ans = mid, l = mid + <span class="number">1</span> ; <span class="keyword">else</span> r = mid - <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line">ll tmp = Inf ; ans = stk[ans] - <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (x &gt; <span class="number">1</span>) update(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>, x - <span class="number">1</span>, Inf) ;</span><br><span class="line"><span class="keyword">if</span> (ans &lt;= n) update(<span class="number">1</span>, <span class="number">1</span>, n, ans, n, Fni) ;</span><br><span class="line">res = max(res, query(<span class="number">1</span>, <span class="number">1</span>, n, tmp) - x + <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">if</span> (x &gt; <span class="number">1</span>) update(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>, x - <span class="number">1</span>, Fni) ;</span><br><span class="line"><span class="keyword">if</span> (ans &lt;= n) update(<span class="number">1</span>, <span class="number">1</span>, n, ans, n, Inf) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k)) dfs(to(k)) ;</span><br><span class="line">stk[top --] = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">if</span> (fa[x] &lt;= n)</span><br><span class="line">update(<span class="number">1</span>, <span class="number">1</span>, n, fa[x] - <span class="number">1</span>, n, sp[fa[x]] - sp[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; w[n] = Inf ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i) w[i] = qr() ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) g[i] = qr() ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">sp[i] = sp[i - <span class="number">1</span>] - g[i - <span class="number">1</span>] + w[i - <span class="number">1</span>] ;</span><br><span class="line">ss[i] = ss[i - <span class="number">1</span>] - g[i] + w[i - <span class="number">1</span>] ;</span><br><span class="line">&#125;</span><br><span class="line">stk[++ top] = n + <span class="number">1</span> ;</span><br><span class="line">    sp[n + <span class="number">1</span>] = Inf ; fa[n + <span class="number">1</span>] = n + <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)&#123;</span><br><span class="line"><span class="keyword">while</span> (top &amp;&amp; sp[stk[top]] &lt;= sp[i]) -- top ;</span><br><span class="line">fa[i] = stk[top] ; stk[++ top] = i ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) add_e(fa[i], i) ;</span><br><span class="line">build(<span class="number">1</span>, <span class="number">1</span>, n) ; top = <span class="number">0</span> ; dfs(n + <span class="number">1</span>) ;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;s</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ‰ $n$ ä¸ªç‚¹ä¾æ¬¡æ’æˆä¸€åˆ—ï¼Œç¬¬ $i$ ä¸ªç‚¹ä¸ç¬¬ $i + 1$ ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ä¸º $w_i$ ä¸ªå•ä½ã€‚ç¬¬ $i$ ä¸ªç‚¹æœ‰ä¸€ä¸ªåŠ æ²¹ç«™ï¼Œå¯ä»¥ç»™ä½ çš„è½¦åŠ èƒ½è·‘ $g_i$ ä¸ªå•ä½çš„æ²¹ã€‚&lt;/p&gt;
&lt;p&gt;ä½ éœ€è¦åœ¨ $l, r$ ä¹‹é—´å¾€è¿”ï¼ˆ$l \le r$ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦æ»¡è¶³ä¸€è¾†æ²¡æœ‰æ²¹çš„è½¦èƒ½ä» $l$ ä¸€è·¯å‘å³å¼€åˆ° $r$ï¼Œä¹Ÿèƒ½ä» $r$ ä¸€è·¯å‘å·¦å¼€åˆ° $l$ã€‚è½¦ä¼šåœ¨èµ·ç‚¹åŠ å¥½æ²¹ï¼Œä½ å¯ä»¥åœ¨ä¸­é€”åŠ æ²¹ï¼Œä½†æ˜¯æ–¹å‘æ˜¯ä¸èƒ½æ”¹å˜çš„ã€‚ä½ å¯ä»¥å‡è®¾è½¦çš„æ²¹ç®±æ˜¯æ— é™å¤§çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä½ è¿˜æ²¡é€‰å¥½ $l, r$ çš„å…·ä½“å–å€¼ï¼Œä¸è¿‡ä½ å¸Œæœ›è®©ä½ ç»è¿‡çš„ç‚¹æ•°å°½é‡å¤šï¼Œä¹Ÿå°±æ˜¯è®© $r - l + 1$ å°½é‡å¤§ã€‚&lt;/p&gt;
&lt;p&gt;ä½ ç°åœ¨æœ‰ $k$ ä¸ªæœºä¼šï¼Œæ¯ä¸ªæœºä¼šå¯ä»¥å°†ä»»æ„ä¸€ä¸ª $g_i$ å¢åŠ  $1$ã€‚é—®ï¼šä½¿ç”¨ $k$ æ¬¡æœºä¼šåï¼Œèƒ½å¾—åˆ°çš„æœ€å¤§çš„ $r - l + 1$ æ˜¯å¤šå°‘ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å† æ”¾ é€ &lt;/p&gt;
&lt;p&gt;è¿™é¢˜æ˜¯ååˆ†çš„ç¥â€¦æ‰€ä»¥ä¹Ÿéš¾æ€ª $4$ å¹´å‰çš„é¢˜ç›®ä¼šè¢«é€‰å…¥ä»Šå¹´çš„é›†è®­é˜Ÿä½œä¸šã€‚&lt;/p&gt;
&lt;p&gt;åšè¿™é¢˜ï¼Œé‚£å¿…ç„¶å°±æ˜¯çœ‹é¢˜è§£â€¦è¿™é¢˜éš¾ç‚¹ç”±ä¸¤éƒ¨åˆ†ï¼Œã€Œè½¬åŒ–æˆæŠ½è±¡æ¨¡å‹ã€å’Œã€Œç”¨çº¿æ®µæ ‘ç»´æŠ¤ã€ï¼Œæ¯”è¾ƒç¥å¥‡çš„æ˜¯è¿™é¢˜é‡Œè¿™ä¸¤éƒ¨åˆ†å‡ ä¹åŒç­‰éš¾åº¦ï¼Œå¹¶ä¸”éƒ½æ˜¯æˆ‘éš¾ä»¥æœ›è§çš„é«˜åº¦â€¦&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥åº”è¯¥ä¸å¤ªä¼šåšè¿™ç§éš¾åº¦çš„é¢˜äº†ã€‚æ„Ÿè§‰å¾ˆä¸å¥½ã€‚è™½ç„¶è¿™é¢˜ç¡®å®ååˆ†çš„å¥½ï¼Œæ–°é¢–æœ‰è¶£ä¸”ç»å…¸ï¼Œä½†æˆ‘è¿˜æ˜¯é©¾é©­ä¸äº†è¿™ç§é¢˜ç›®å§â€¦ &lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="Codeforces" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/Codeforces/"/>
    
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="æ ‘æ¨¡å‹" scheme="https://www.orchidany.cn/tags/%E6%A0%91%E6%A8%A1%E5%9E%8B/"/>
    
      <category term="è´ªå¿ƒ" scheme="https://www.orchidany.cn/tags/%E8%B4%AA%E5%BF%83/"/>
    
      <category term="æ•°æ®ç»“æ„/çº¿æ®µæ ‘" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
      <category term="å•è°ƒé˜Ÿåˆ—/å•è°ƒæ ˆ" scheme="https://www.orchidany.cn/tags/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘å…”é˜Ÿçº¿æ®µæ ‘</title>
    <link href="https://www.orchidany.cn/2020/04/16/%E5%85%94%E9%98%9F%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    <id>https://www.orchidany.cn/2020/04/16/å…”é˜Ÿçº¿æ®µæ ‘/</id>
    <published>2020-04-16T12:38:44.000Z</published>
    <updated>2020-04-17T08:17:06.009Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å…¶å®çœŸæ­£çš„é¢˜ç›®åº”è¯¥æ˜¯ã€Œå°ç²‰å…”æ•™ä½ å¦‚ä½•ç©è½¬çº¿æ®µæ ‘ã€ã€‚è¿™ä»¶äº‹è¦å›æº¯åˆ°å»å¹´ CSP ä¹‹å‰ï¼Œæœ‰äººåœ¨ uoj ç¾¤é‡Œé—®äº†ä¸€é“é¢˜çš„åšæ³•ï¼š<a href="https://www.luogu.com.cn/problem/U96354" target="_blank" rel="noopener">Luogu U96354</a> ã€‚ç„¶åå…”é˜Ÿé£å¿«çš„ A äº†è¿™é“é¢˜å¹¶åœ¨ uoj ç¾¤ç»™å‡ºäº†ä»£ç é“¾æ¥ã€‚å½“æ—¶å°±å¸¦ç€æœºæˆ¿å°ä¼™ä¼´å­¦ä¹ äº†ä¸€æ³¢â€¦233</p><p>ç„¶åä»Šå¤©åˆçœ‹åˆ°äº†å…”çš„åšæ–‡ï¼š<a href="https://www.cnblogs.com/PinkRabbit/p/Segment-Tree-and-Prefix-Maximums.html" target="_blank" rel="noopener">ä»ã€Šæ¥¼æˆ¿é‡å»ºã€‹å‡ºå‘æµ…è°ˆä¸€ç±»ä½¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤å‰ç¼€æœ€å¤§å€¼çš„ç®—æ³•</a>ã€‚ æ„Ÿè§‰å¾ˆç¥ä»™ï¼Œç„¶åå°±æ‰“ç®—æŠŠè¿™ä¸‰é“é¢˜éƒ½æ•´ç†ä¸€ä¸‹ã€‚</p><p><del>æ‰€ä»¥å°±æ˜¯ç±»ä¼¼äºå¤åˆ»äº†ä¸€ä¸‹å…”ç§’æ‰oræ¨èçš„é¢˜</del>ã€‚</p><p>åˆ†åˆ«æ˜¯ä¸‰é“é¢˜ï¼š<code>LGU96354 é­”èƒ½é˜µåˆ—</code>ï¼Œ<code>BZOJ2957 æ¥¼æˆ¿é‡å»º</code> å’Œ <code>CF671E Organizing a Race</code> .</p><a id="more"></a><h1 id="LGU96354-é­”èƒ½é˜µåˆ—"><a href="#LGU96354-é­”èƒ½é˜µåˆ—" class="headerlink" title="LGU96354 é­”èƒ½é˜µåˆ—"></a>LGU96354 é­”èƒ½é˜µåˆ—</h1><blockquote><p>ç»™å®šä¸¤ä¸ªåºåˆ— $\{a_n\},\{b_n\}$ï¼Œå®šä¹‰ä¸€æ®µåŒºé—´ $[l,r]$ çš„æƒå€¼ä¸º</p><script type="math/tex; mode=display">\sum_{i=l}^r[b_i>0]a_i</script><p>ç°åœ¨ç»™å®šä¸¤ç§æ“ä½œï¼Œå¯¹ $\{b_n\}$ åŒºé—´åŠ  $x$ (å¯æ­£å¯è´Ÿ) å’Œè¯¢é—®æŸä¸ªåŒºé—´çš„æƒå€¼ã€‚ä¿è¯ä»»ä½•æ—¶åˆ» $b_i\geq 0$ ã€‚</p><p>$1 \leq n,m\leq 2 \times 10^5$   </p></blockquote><p>ä¸€ä¸ªæ¯”è¾ƒè‡ªç„¶çš„æƒ³æ³•ï¼Œæ˜¯åˆ†åˆ«ç»´æŠ¤åŒºé—´ $b_i=0$ çš„å’Œ and åŒºé—´ $b_i\not = 0$ çš„å’Œã€‚ä½†æ˜¯è¿™ä¸ªä¸œè¥¿ç»´æŠ¤èµ·æ¥å¤æ‚åº¦å¹¶ä¸å¯¹ã€‚æ‰€ä»¥è€ƒè™‘æ¢ä¸€ä¸‹ï¼Œç”±äºä¿è¯ä»»æ„æ—¶åˆ» $b_i\geq 0$ ï¼Œæ‰€ä»¥ç»´æŠ¤åŒºé—´æœ€å°å€¼ï¼Œ åŒºé—´ $b_i$ çš„å€¼ = æœ€å°å€¼çš„æƒå€¼ andåŒºé—´ $b_i$ çš„å€¼ $\not =$ æœ€å°å€¼çš„æƒå€¼å’Œã€‚é‚£ä¹ˆè½¬ç§»å°±åˆ†ç±»è®¨è®ºä¸€ä¸‹å³å¯ã€‚å›ç­”è¯¢é—®çš„æ—¶å€™åªéœ€è¦å†å»ºç«‹ä¸€ä¸ªè™šç‚¹ï¼Œå¯¹è¯¢é—®åŒºé—´è¿›è¡Œåˆå¹¶ï¼Œæœ€ååªéœ€è¦åˆ¤æ–­è¯¥åŒºé—´æœ€å°å€¼æ˜¯å¦æ˜¯ $0$ å³å¯ã€‚</p><p>å¤§æ¦‚é¦–å…ˆç»´æŠ¤åŒºé—´æœ€å°å€¼æ˜¯ä¸ª trick ï¼Œå»ºä¸€ä¸ªè™šç‚¹å¯¹ $\log n$ ä¸ªåŒºé—´è¿›è¡Œåˆå¹¶ä¹Ÿæ˜¯ä¸€ä¸ª trick ã€‚ä½†æ˜¯è¿™ä¿©ä¼¼ä¹æˆ‘éƒ½ä¸æ˜¯å¾ˆç†Ÿï¼Œå¯¼è‡´æˆ‘å½“æ—¶ä¸å¤ªä¼šåš.jpg</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; </span><br><span class="line"><span class="keyword">int</span> cnt, _tag[MAXN &lt;&lt; <span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> s[MAXN &lt;&lt; <span class="number">2</span>], v[MAXN &lt;&lt; <span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> N, M, base[MAXN], mnx[MAXN &lt;&lt; <span class="number">2</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ; <span class="keyword">int</span> res = <span class="number">0</span>, fg = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) &#123; <span class="keyword">if</span> (c == <span class="string">'-'</span>) fg = <span class="number">-1</span> ;  c = getchar() ;&#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) res = (res &lt;&lt; <span class="number">1</span>) + (res &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> res * fg ;</span><br><span class="line">&#125;</span><br><span class="line">il <span class="keyword">void</span> _merge(<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123;</span><br><span class="line">    <span class="keyword">if</span> (mnx[x] == mnx[y])</span><br><span class="line">        s[x] = s[x] + s[y], v[x] = v[x] + v[y] ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (mnx[x] &lt; mnx[y]) s[x] = s[x] + s[y] + v[y] ;</span><br><span class="line">    <span class="keyword">else</span> mnx[x] = mnx[y], s[x] = s[x] + s[y] + v[x], v[x] = v[y] ;</span><br><span class="line">&#125;</span><br><span class="line">il <span class="keyword">void</span> _merge(<span class="keyword">int</span> rt, <span class="keyword">int</span> ls, <span class="keyword">int</span> rs)&#123;</span><br><span class="line">    <span class="keyword">if</span> (mnx[ls] == mnx[rs])</span><br><span class="line">        mnx[rt] = mnx[ls], s[rt] = s[ls] + s[rs], v[rt] = v[ls] + v[rs] ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (mnx[ls] &gt; mnx[rs])</span><br><span class="line">        mnx[rt] = mnx[rs], s[rt] = s[ls] + s[rs] + v[ls], v[rt] = v[rs] ;</span><br><span class="line">    <span class="keyword">else</span> mnx[rt] = mnx[ls], s[rt] = s[ls] + s[rs] + v[rs], v[rt] = v[ls] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">pdown</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (_tag[rt])&#123;</span><br><span class="line">    mnx[rt &lt;&lt; <span class="number">1</span>] += _tag[rt] ;</span><br><span class="line">    mnx[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += _tag[rt] ;</span><br><span class="line">    _tag[rt &lt;&lt; <span class="number">1</span>] += _tag[rt] ;</span><br><span class="line">   _tag[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += _tag[rt] ;</span><br><span class="line">   _tag[rt] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    mnx[rt] = Inf, s[rt] = <span class="number">0</span>, v[rt] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; ++ cnt ;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> v[rt] = base[l], <span class="keyword">void</span>() ;</span><br><span class="line">    build(rt &lt;&lt; <span class="number">1</span>, l, mid), build(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r) ;</span><br><span class="line">    _merge(rt, rt &lt;&lt; <span class="number">1</span>, rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= ul &amp;&amp; r &lt;= ur) </span><br><span class="line"><span class="keyword">return</span> <span class="keyword">void</span>(mnx[rt] += x, _tag[rt] += x) ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; pdown(rt) ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) update(rt &lt;&lt; <span class="number">1</span>, l, mid, ul, ur, x) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid) update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ul, ur, x) ;</span><br><span class="line">    _merge(rt, rt &lt;&lt; <span class="number">1</span>, rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, <span class="keyword">int</span> ans)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= ql &amp;&amp; r &lt;= qr) </span><br><span class="line"><span class="keyword">return</span> _merge(ans, rt), <span class="keyword">void</span>() ;</span><br><span class="line">    pdown(rt) ; <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= mid) query(rt &lt;&lt; <span class="number">1</span>, l, mid, ql, qr, ans) ;</span><br><span class="line">    <span class="keyword">if</span> (qr &gt; mid) query(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, ql, qr, ans) ;</span><br><span class="line">    _merge(rt, rt &lt;&lt; <span class="number">1</span>, rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M ; <span class="keyword">int</span> i ;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) base[i] = qr() ;</span><br><span class="line">    build(<span class="number">1</span>, <span class="number">1</span>, N) ; (cnt *= <span class="number">2</span>) += <span class="number">1</span> ; <span class="keyword">int</span> l, r, x, opt ;</span><br><span class="line">    <span class="keyword">while</span> (M --)&#123;</span><br><span class="line">        opt = qr() ;</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">1</span>)&#123;</span><br><span class="line">            l = qr(), r = qr(), x = qr(), update(<span class="number">1</span>, <span class="number">1</span>, N, l, r, x) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ++ cnt, l = qr(), r = qr() ;</span><br><span class="line">            init(cnt), query(<span class="number">1</span>, <span class="number">1</span>, N, l, r, cnt) ;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, mnx[cnt] ? s[cnt] + v[cnt] : s[cnt]) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="bzoj2957-æ¥¼æˆ¿é‡å»º"><a href="#bzoj2957-æ¥¼æˆ¿é‡å»º" class="headerlink" title="bzoj2957 æ¥¼æˆ¿é‡å»º"></a>bzoj2957 æ¥¼æˆ¿é‡å»º</h1><blockquote><p>å•ç‚¹ä¿®æ”¹ï¼ŒæŸ¥è¯¢æ•´ä¸ªåºåˆ—æœ‰å¤šä¸ªå‰ç¼€æœ€å¤§å€¼ã€‚</p><p>$1\leq n,m\leq 10^5$</p></blockquote><p>sto å…”ã€‚</p><p>é¦–å…ˆè€ƒè™‘è¿™ä¸œè¥¿æš´åŠ›åšçš„è¯ï¼Œå°±æ˜¯åœ¨æ¨¡æ‹Ÿä¸€ä¸ªå•è°ƒæ ˆçš„è¿‡ç¨‹ã€‚å¸¦ä¿®çš„è¯å°±è¦è€ƒè™‘å¥—ä¸€ä¸ª dsã€‚è€ƒè™‘ ds çš„ä½œç”¨ï¼Œæœ¬è´¨ä¸Šæ˜¯è¦åœ¨æ¯æ¬¡ä¿®æ”¹å®Œ $x$ ä¹‹åï¼Œå°† $[1,x-1]$ å’Œ $[x+1,n]$ è¿™ä¸¤ä¸ªåŒºé—´çš„å•è°ƒæ ˆå’Œ $x$ æ”¾åœ¨ä¸€èµ·åˆå¹¶ã€‚äºæ˜¯ä¸éš¾æƒ³åˆ°è¦ç”¨çº¿æ®µæ ‘ã€‚</p><p>ä½†â€¦çº¿æ®µæ ‘ä¼¼ä¹ä¹Ÿæ²¡æ³•å¿«é€Ÿåˆå¹¶ã€‚è€ƒè™‘æ¯æ¬¡ <code>push_up</code> æš´åŠ›æŠŠå³åŒºé—´åˆå¹¶åˆ°å·¦åŒºé—´é‡Œé¢ï¼Œè¿™æ ·åšæ˜¾ç„¶æ˜¯å•æ¬¡ $O(n)$ çš„ã€‚è€ƒè™‘å‘æ˜æ›´æ·±ä¸€äº›ï¼Œæ¯æ¬¡åˆå¹¶å·¦å³åŒºé—´æ—¶ï¼Œå·¦åŒºé—´æ˜¯ä¸å—å½±å“çš„ï¼Œåªéœ€è¦ç»Ÿè®¡å·¦åŒºé—´æœ€å¤§å€¼å¯¹å³åŒºé—´ç­”æ¡ˆçš„è´¡çŒ®ã€‚è€ƒè™‘æ¯æ¬¡åˆå¹¶ï¼Œå·¦åŒºé—´æœ€å¤§å€¼å¯¹å³åŒºé—´çš„å½±å“ä¸€å®šæ˜¯ä¸€ä¸ªå³åŒºé—´çš„ä¸€ä¸ªå‰ç¼€ã€‚æ‰€ä»¥åªéœ€è¦æ¯æ¬¡åˆå¹¶æ—¶ï¼Œçº¿æ®µæ ‘ä¸ŠäºŒåˆ†å‡ºè¿™ä¸ªå‰ç¼€çš„ä½ç½®æ¥å³å¯ã€‚</p><p>ç„¶åå®ç°çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼ŒäºŒåˆ†å®Œå‰ç¼€ä¹‹åï¼Œå‰ç¼€çš„è´¡çŒ®æ˜¯ $1$ ï¼Œå‰©ä¸‹çš„åç¼€è´¡çŒ®ä¸æ˜¯ $cnt_{rc}$ è€Œæ˜¯ $cnt_{root}-cnt_{lc}$ ã€‚å› ä¸ºæ­¤æ—¶éœ€è¦åŠ ä¸Šçš„æ˜¯<strong>åˆå¹¶ä¹‹å</strong>å³åŒºé—´å¯¹æ•´ä½“æœ‰å¤šå°‘è´¡çŒ®ã€‚</p><p>è¿™æ ·çº¿æ®µæ ‘äºŒåˆ† $1$ ä¸ª $\log $ ï¼Œæœ¬èº« <code>update</code> åˆæ˜¯ $1$ ä¸ª $\log $ ã€‚å¤æ‚åº¦ $m\log ^2 n$ ã€‚ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n, m ; </span><br><span class="line">db base[N] ;</span><br><span class="line">db s[N * <span class="number">3</span>] ; </span><br><span class="line"><span class="keyword">int</span> cnt[N * <span class="number">3</span>] ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">s[rt] = <span class="number">0</span> ; </span><br><span class="line">cnt[rt] = <span class="number">1</span> ; <span class="keyword">return</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">build(ls, l, mid) ; </span><br><span class="line">build(rs, mid + <span class="number">1</span>, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, db v)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)</span><br><span class="line"><span class="keyword">return</span> (s[rt] &gt; v) ;</span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">if</span> (s[ls] &gt; v) </span><br><span class="line"><span class="keyword">return</span> query(ls, l, mid, v) + cnt[rt] - cnt[ls] ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> query(rs, mid + <span class="number">1</span>, r, v) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">void</span>(s[rt] = base[l]) ; </span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (mid &gt;= p) </span><br><span class="line">update(ls, l, mid, p) ; </span><br><span class="line"><span class="keyword">else</span> update(rs, mid + <span class="number">1</span>, r, p) ; </span><br><span class="line">s[rt] = max(s[ls], s[rs]) ; </span><br><span class="line">cnt[rt] = cnt[ls] + query(rs, mid + <span class="number">1</span>, r, s[ls]) ;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; </span><br><span class="line">build(<span class="number">1</span>, <span class="number">1</span>, n) ; <span class="keyword">int</span> x ; db y ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">x = qr(), y = qr(), base[x] = (<span class="number">1.0</span> * y) / (<span class="number">1.0</span> * x) ; </span><br><span class="line">update(<span class="number">1</span>, <span class="number">1</span>, n, x) ; <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, query(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">0</span>)) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="CF671E-Organizing-a-Race"><a href="#CF671E-Organizing-a-Race" class="headerlink" title="CF671E Organizing a Race"></a>CF671E Organizing a Race</h1><blockquote><p>æœ‰ $n$ ä¸ªç‚¹ä¾æ¬¡æ’æˆä¸€åˆ—ï¼Œç¬¬ $i$ ä¸ªç‚¹ä¸ç¬¬ $i + 1$ ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ä¸º $w_i$ ä¸ªå•ä½ã€‚</p><p>ç¬¬ $i$ ä¸ªç‚¹æœ‰ä¸€ä¸ªåŠ æ²¹ç«™ï¼Œå¯ä»¥ç»™ä½ çš„è½¦åŠ èƒ½è·‘ $g_i$ ä¸ªå•ä½çš„æ²¹ã€‚</p><p>ä½ éœ€è¦åœ¨ $l, r$ ä¹‹é—´å¾€è¿”ï¼ˆ$l \le r$ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦æ»¡è¶³ä¸€è¾†æ²¡æœ‰æ²¹çš„è½¦èƒ½ä» $l$ ä¸€è·¯å‘å³å¼€åˆ° $r$ï¼Œä¹Ÿèƒ½ä» $r$ ä¸€è·¯å‘å·¦å¼€åˆ° $l$ã€‚</p><p>è½¦ä¼šåœ¨èµ·ç‚¹åŠ å¥½æ²¹ï¼Œä½ å¯ä»¥åœ¨ä¸­é€”åŠ æ²¹ï¼Œä½†æ˜¯æ–¹å‘æ˜¯ä¸èƒ½æ”¹å˜çš„ã€‚ä½ å¯ä»¥å‡è®¾è½¦çš„æ²¹ç®±æ˜¯æ— é™å¤§çš„ã€‚</p><p>ä½ è¿˜æ²¡é€‰å¥½ $l, r$ çš„å…·ä½“å–å€¼ï¼Œä¸è¿‡ä½ å¸Œæœ›è®©ä½ ç»è¿‡çš„ç‚¹æ•°å°½é‡å¤šï¼Œä¹Ÿå°±æ˜¯è®© $r - l + 1$ å°½é‡å¤§ã€‚</p><p>ä½ ç°åœ¨æœ‰ $k$ ä¸ªæœºä¼šï¼Œæ¯ä¸ªæœºä¼šå¯ä»¥å°†ä»»æ„ä¸€ä¸ª $g_i$ å¢åŠ  $1$ã€‚</p><p>é—®ï¼šä½¿ç”¨ $k$ æ¬¡æœºä¼šåï¼Œèƒ½å¾—åˆ°çš„æœ€å¤§çš„ $r - l + 1$ æ˜¯å¤šå°‘ï¼Ÿ</p></blockquote><p>è¿™ä¸ªåœ°æ–¹çš„è½¬åŒ–ä¼šå•ç‹¬å¼€ä¸€ç¯‡æ–°çš„ $blog$ï¼Œå› ä¸ºæ¯”è¾ƒæ¯’ç˜¤ã€‚å¤§æ¦‚æœ€åå°±æ˜¯è½¬åŒ–æˆäº†ä»¤</p><script type="math/tex; mode=display">t_i=suf_i-\min_{j=1}^i\{suf'_j\}</script><p>æ±‚æœ€å¤§çš„ $i$ æ»¡è¶³ $t_i\leq k$ ã€‚ç„¶åè¦æ”¯æŒ $sufâ€™_i$ çš„åŒºé—´åŠ /å‡ä»¥åŠå¤šæ¬¡è¯¢é—®ã€‚</p><p>è€ƒè™‘åä¸€åŠå°±æ˜¯å‰ç¼€æœ€å°å€¼ï¼Œå› ä¸ºå¸¦ä¸Šä¿®æ”¹æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥ç»´æŠ¤èµ·æ¥ä¾ç„¶è¦é€‰æ‹©æ¥¼æˆ¿é‡å»ºçš„æ–¹å¼ï¼Œæ‹¿å·¦åŒºé—´çš„æœ€å°å€¼å»äºŒåˆ†å³åŒºé—´çš„å‰ç¼€ã€‚äºæ˜¯å¯ä»¥æ¯”è¾ƒç®€å•åœ°ç»´æŠ¤å‡ºä¸€ä¸ªåŒºé—´çš„ $\min\{t_i\}$ ã€‚</p><p>è€ƒè™‘ä¿®æ”¹ã€‚ä¿®æ”¹çš„è¯å°±æ˜¯æš´åŠ›æ‰“æ ‡è®°ï¼Œæ³¨æ„åˆ° $t_i$ ä¸­çš„ $sufâ€™$ æ˜¯è´Ÿè´¡çŒ®ï¼Œè¢« $\min$ å¥—ç€ï¼Œä½†ç”±äºæ˜¯åŒºé—´ä¿®æ”¹æ‰€ä»¥å¯ä»¥ç›´æ¥å‡ã€‚</p><p>è€ƒè™‘å¦‚ä½•æŸ¥è¯¢ã€‚è¯¢é—®æ¯”è¾ƒéº»çƒ¦ï¼Œå› ä¸ºç›¸å½“äºæŸ¥è¯¢æ—¶è¦åˆå¹¶å¤šä¸ªåŒºé—´çš„å•è°ƒæ ˆï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥çº¿æ®µæ ‘äºŒåˆ†ã€‚æˆ–è€…è¯´ï¼Œéœ€è¦é­”æ”¹ä¸€ä¸‹äºŒåˆ†ï¼Œè®©è¿™ä¸ªäºŒåˆ†å¯ä»¥ã€Œè¾¹äºŒåˆ†ï¼Œè¾¹åˆå¹¶ã€ã€‚</p><p>è€ƒè™‘ä¸€ç§æ¯”è¾ƒç¥ç§˜çš„æ–¹å¼å»æ‰¾ã€‚<code>query(root, l, r, val)</code> æŸ¥è¯¢çš„æ˜¯åŒºé—´ $[1,l-1]$ å†…æŸä¸ªæ•° <code>val</code>ï¼Œä½œä¸ºå‰ç¼€æœ€å°å€¼å¯¹åŒºé—´ $[l,r]$ æœ‰å½±å“æ—¶ï¼Œæœ€é å³çš„ $\leq m$ çš„ä½ç½®ã€‚é‚£ä¹ˆè€ƒè™‘åˆ†ç±»ï¼š</p><p>1ã€å¦‚æœå½“å‰å·¦å­©å­åŒºé—´çš„ $\min\{suf_jâ€™\}$ æ¯” $val$ è¦å°ï¼Œè¯´æ˜å½“å‰çš„å‰ç¼€æœ€å°å€¼ä¸ä¼šå¯¹å³åŒºé—´äº§ç”Ÿå½±å“(å› ä¸ºå·¦å³åŒºé—´å·²ç»åˆå¹¶äº†)ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥åˆ¤æ–­åœ¨ç®—ä¸Šå·¦åŒºé—´å¯¹å³åŒºé—´è´¡çŒ®æ—¶ï¼Œå³åŒºé—´ $t$ çš„æœ€å°å€¼æ˜¯å¦ $\leq m$  â€”â€” è¿™å°±æ˜¯æ¯”è¾ƒæœ´ç´ çš„çº¿æ®µæ ‘ä¸ŠäºŒåˆ† â€”â€” å¦‚æœæ˜¯çš„è¯å°±åº”è¯¥å»å³å„¿å­é‡Œé¢æ‰¾ï¼Œå¦åˆ™å»å·¦å„¿å­é‡Œæ‰¾ã€‚</p><p>2ã€å¦‚æœå½“å‰å·¦å­©å­åŒºé—´çš„ $\min\{suf_jâ€™\}$ æ¯” $val$ è¦å¤§ï¼Œè¯´æ˜å·¦åŒºé—´å¯¹å³åŒºé—´äº§ç”Ÿçš„è´¡çŒ®ä¼šè¢« $val$ äº§ç”Ÿçš„è´¡çŒ®ä»£æ›¿ï¼Œæ‰€ä»¥ç›´æ¥é€’å½’è¿›å³å­©å­ã€‚å¹¶ä¸”ç”±äº $val$ å·²ç»å˜æˆäº†å½“å‰å·¦åŒºé—´çš„å‰ç¼€æœ€å°å€¼ï¼Œæ‰€ä»¥å·¦åŒºé—´çš„ $\min\{suf_jâ€™\}$ å°±å˜æˆäº†æ— ç”¨ä¿¡æ¯(å› ä¸ºè‚¯å®šéƒ½æ¯” $val$ å¤§)ï¼Œåªéœ€è¦æŸ¥è¯¢åœ¨ $a_i+val\leq m$ æ—¶çš„æœ€å¤§ä¸‹æ ‡å³å¯ï¼Œè¿™ä¸€éƒ¨åˆ†å¯ä»¥ç›´æ¥çº¿æ®µæ ‘äºŒåˆ†ã€‚</p><p>ä½†â€¦è¿™ä¼¼ä¹ä¹Ÿä¸æ˜¯æœ€ç»ˆçš„æŸ¥è¯¢ã€‚è€ƒè™‘ä¸ºäº†è®©æœ€åçš„ $\min_{j=1}^i\{sufâ€™_j\}$ çœŸçš„å˜æˆä» $1$ å¼€å§‹åˆ° $i$ ç»“æŸçš„æœ€å°å€¼ï¼Œ æ‰€ä»¥éœ€è¦åŠ¨æ€ä¿®æ”¹ $val$ çš„å€¼ã€‚å…ˆåºéå†çº¿æ®µæ ‘å³å¯ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥ç»´æŠ¤ä¸€ä¸ªå‰ç¼€æœ€å° $sufâ€™$ ã€‚</p><p>è¿™é‡Œå°±å…ˆåªç»™å‡ºçº¿æ®µæ ‘éƒ¨åˆ†çš„ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">ll s[N * <span class="number">3</span>] ;</span><br><span class="line">ll sa[N * <span class="number">3</span>] ;</span><br><span class="line">ll sb[N * <span class="number">3</span>] ;</span><br><span class="line">ll tag[N * <span class="number">3</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _down(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;<span class="comment">//bingo</span></span><br><span class="line"><span class="keyword">if</span> (tag[rt])&#123;</span><br><span class="line">s[ls] -= tag[rt] ;</span><br><span class="line">s[rs] -= tag[rt] ;</span><br><span class="line">sb[ls] += tag[rt] ;</span><br><span class="line">sb[rs] += tag[rt] ;</span><br><span class="line">tag[ls] += tag[rt] ;</span><br><span class="line">tag[rs] += tag[rt] ;</span><br><span class="line">tag[rt] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(<span class="keyword">int</span> rt ,<span class="keyword">int</span> l, <span class="keyword">int</span> r, ll v)</span></span>&#123;<span class="comment">//bingo</span></span><br><span class="line"><span class="keyword">if</span> (l == r)</span><br><span class="line"><span class="keyword">return</span> sa[rt] - v ; <span class="comment">// 2</span></span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt, l, r) ;</span><br><span class="line"><span class="keyword">if</span> (sb[ls] &gt;= v)</span><br><span class="line">    <span class="keyword">return</span> min(solve(rs, mid + <span class="number">1</span>, r, v), sa[ls] - v) ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> min(solve(ls, l, mid, v), s[rt]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">sa[rt] = ss[l] ; </span><br><span class="line">    sb[rt] = ss[l]</span><br><span class="line">    <span class="keyword">return</span>  ;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">build(ls, l, mid) ;</span><br><span class="line">build(rs, mid + <span class="number">1</span>, r) ;</span><br><span class="line">sa[rt] = min(sa[ls], sa[rs]) ;</span><br><span class="line">sb[rt] = min(sb[ls], sb[rs]) ;</span><br><span class="line">s[rt] = solve(rs, mid + <span class="number">1</span>, r, sb[ls]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, ll v)</span></span>&#123;<span class="comment">//bingo</span></span><br><span class="line"><span class="keyword">if</span> (ul &lt;= l &amp;&amp; r &lt;= ur)&#123;</span><br><span class="line">tag[rt] += v ;</span><br><span class="line">sb[rt] += v ;</span><br><span class="line">s[rt] -= v ; <span class="comment">//1</span></span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">_down(rt, l, r) ;</span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (ul &lt;= mid)</span><br><span class="line">update(ls, l, mid, ul, ur, v) ;</span><br><span class="line"><span class="keyword">if</span> (ur &gt; mid)</span><br><span class="line">update(rs, mid + <span class="number">1</span>, r, ul, ur, v) ;</span><br><span class="line">sb[rt] = min(sb[ls], sb[rs]) ;</span><br><span class="line">s[rt] = solve(rs, mid + <span class="number">1</span>, r, sb[ls]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, ll v)</span></span>&#123;<span class="comment">//bingo</span></span><br><span class="line"><span class="keyword">if</span> (l == r) <span class="keyword">return</span> l ;</span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (sa[rs] &gt; v)</span><br><span class="line"><span class="keyword">return</span> ask(ls, l, mid, v) ;</span><br><span class="line"><span class="keyword">return</span> ask(rs, mid + <span class="number">1</span>, r, v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, ll &amp;v)</span></span>&#123;<span class="comment">//bingo</span></span><br><span class="line"><span class="keyword">if</span> (l == r)&#123;</span><br><span class="line"><span class="keyword">int</span> ret ;</span><br><span class="line">ret = sa[rt] - v &lt;= m ? l : <span class="number">0</span> ;</span><br><span class="line">v = min(v, sb[rt]) ;</span><br><span class="line"><span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt, l, r) ;</span><br><span class="line"><span class="keyword">if</span> (sb[ls] &lt; v)&#123;</span><br><span class="line"><span class="keyword">if</span> (s[rt] &lt;= m)&#123;</span><br><span class="line">v = sb[ls] ;</span><br><span class="line"><span class="keyword">return</span> query(rs, mid + <span class="number">1</span>, r, v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> ret ;</span><br><span class="line">ret = query(ls, l, mid, v) ;</span><br><span class="line">v = min(v, sb[rt]) ; <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">if</span> (sa[rt] - v &lt;= m)</span><br><span class="line">ret = ask(ls, l, mid, m + v) ;</span><br><span class="line"><span class="keyword">return</span> max(ret, query(rs, mid + <span class="number">1</span>, r, v)) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¶å®çœŸæ­£çš„é¢˜ç›®åº”è¯¥æ˜¯ã€Œå°ç²‰å…”æ•™ä½ å¦‚ä½•ç©è½¬çº¿æ®µæ ‘ã€ã€‚è¿™ä»¶äº‹è¦å›æº¯åˆ°å»å¹´ CSP ä¹‹å‰ï¼Œæœ‰äººåœ¨ uoj ç¾¤é‡Œé—®äº†ä¸€é“é¢˜çš„åšæ³•ï¼š&lt;a href=&quot;https://www.luogu.com.cn/problem/U96354&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Luogu U96354&lt;/a&gt; ã€‚ç„¶åå…”é˜Ÿé£å¿«çš„ A äº†è¿™é“é¢˜å¹¶åœ¨ uoj ç¾¤ç»™å‡ºäº†ä»£ç é“¾æ¥ã€‚å½“æ—¶å°±å¸¦ç€æœºæˆ¿å°ä¼™ä¼´å­¦ä¹ äº†ä¸€æ³¢â€¦233&lt;/p&gt;
&lt;p&gt;ç„¶åä»Šå¤©åˆçœ‹åˆ°äº†å…”çš„åšæ–‡ï¼š&lt;a href=&quot;https://www.cnblogs.com/PinkRabbit/p/Segment-Tree-and-Prefix-Maximums.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä»ã€Šæ¥¼æˆ¿é‡å»ºã€‹å‡ºå‘æµ…è°ˆä¸€ç±»ä½¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤å‰ç¼€æœ€å¤§å€¼çš„ç®—æ³•&lt;/a&gt;ã€‚ æ„Ÿè§‰å¾ˆç¥ä»™ï¼Œç„¶åå°±æ‰“ç®—æŠŠè¿™ä¸‰é“é¢˜éƒ½æ•´ç†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;del&gt;æ‰€ä»¥å°±æ˜¯ç±»ä¼¼äºå¤åˆ»äº†ä¸€ä¸‹å…”ç§’æ‰oræ¨èçš„é¢˜&lt;/del&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†åˆ«æ˜¯ä¸‰é“é¢˜ï¼š&lt;code&gt;LGU96354 é­”èƒ½é˜µåˆ—&lt;/code&gt;ï¼Œ&lt;code&gt;BZOJ2957 æ¥¼æˆ¿é‡å»º&lt;/code&gt; å’Œ &lt;code&gt;CF671E Organizing a Race&lt;/code&gt; .&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="BZOJ" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/BZOJ/"/>
    
    
      <category term="æ•°æ®ç»“æ„/çº¿æ®µæ ‘" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘bzoj2391 Cirnoçš„å¿§éƒ</title>
    <link href="https://www.orchidany.cn/2020/04/15/Cirno-%E7%9A%84%E5%BF%A7%E9%83%81/"/>
    <id>https://www.orchidany.cn/2020/04/15/Cirno-çš„å¿§éƒ/</id>
    <published>2020-04-15T13:19:00.000Z</published>
    <updated>2020-04-16T01:34:32.956Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>Cirno é—²ç€æ— äº‹çš„æ—¶å€™å–œæ¬¢å†°å†»é’è›™ã€‚</p><p>é›¾ä¹‹æ¹–ç”Ÿæ´»ç€ $m$ åªé’è›™ï¼Œé’è›™æœ‰å¤§æœ‰å°ï¼Œæ‰€ä»¥æ¯åªé’è›™çš„ä»·å€¼ä¸ºä¸€ä¸ªä¸å¤§äº $10000$ çš„æ­£æ•´æ•°ã€‚</p><p>Cirno æ¯æ¬¡ä»é›¾ä¹‹æ¹–ä¸­å›ºå®šçš„ $n$ ä¸ªç»“ç‚¹ä¸­é€‰å‡ºä¸€äº›ç‚¹æ„æˆä¸€ä¸ªç®€å•å¤šè¾¹å½¢ï¼ŒCirno è¿ç”¨è‡ªå·±çš„èƒ½åŠ›èƒ½å°†æ­¤å¤šè¾¹å½¢å†…æ‰€æœ‰é’è›™å†°å†»ã€‚Cirno å¾ˆæƒ³çŸ¥é“æ¯æ¬¡å†»ä½çš„é’è›™çš„ä»·å€¼æ€»å’Œã€‚å› ä¸ºæ™ºå•†æœ‰é™ï¼ŒCirno å°†è¿™ä¸ªé—®é¢˜äº¤ç»™å®Œç¾ç®—æœ¯æ•™å®¤é‡Œçš„ä½ ã€‚</p><p>å› ä¸ºçˆ±æŠ¤åŠ¨ç‰©ï¼Œæ‰€ä»¥æ¯æ¬¡å†»ç»“çš„é’è›™ä¼šè¢«æ”¾ç”Ÿã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€åªé’è›™å¯ä»¥è¢«å¤šæ¬¡ç»Ÿè®¡ã€‚</p><p>å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$n,m\leq 10^3, q\leq 10^4,-10^4\leq x,y\leq 10^4,0&lt;v\leq 10^4$ ã€‚</p></blockquote><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ ¡å†…æµ‹è¯•ï¼ŒæŸ NOIP æ¨¡æ‹Ÿé¢˜è€ƒäº†ä¸‰è§’å‰–åˆ†â€¦ä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸€çœ¼å°±çœ‹å‡ºæ˜¯ä¸‰è§’å‰–åˆ†ã€‚</p><p>ç´§æ¥ç€å‘ç°æ˜¯ bzoj åŸé¢˜ï¼Œå­¦äº†ä¸€æ³¢ä¸‰è§’å‰–åˆ†+æ¸©ä¹ äº†ä¸€éå‘é‡ä¹‹åæ„Ÿè§‰è¿™é¢˜æœ‰ç‚¹çŒ›ç”·ã€‚</p><a id="more"></a><p>å¤§æ¦‚è€ƒè™‘ä¸‰è§’å‰–åˆ†æœ¬æ¥æ˜¯ç”¨äºæ±‚å¤šè¾¹å½¢é¢ç§¯ï¼Œæ–¹æ³•æ˜¯é€‰æ‹©ä¸€ä¸ªåŸç‚¹ï¼ŒæŒ‰ç…§é€†æ—¶é’ˆæˆ–è€…é¡ºæ—¶é’ˆçš„æ–¹å¼ï¼ŒæŠŠå¤šè¾¹å½¢é¡¶ç‚¹å‘é‡å‰ä¸€åœˆçš„ç»“æœã€‚å½¢å¼åŒ–åœ°è®²ï¼Œç»™å®šä¸€ä¸ªå¤šè¾¹å½¢ $A_1A_2A_3\ldots A_n$ ï¼Œé‚£ä¹ˆè¿™ä¸ªå¤šè¾¹å½¢çš„é¢ç§¯å°±æ˜¯</p><script type="math/tex; mode=display">\frac{\overrightarrow{O A_{n}}\times \overrightarrow{OA_1}}{2}+\sum_{i=1}^{n-1} \frac{\overrightarrow{O A_{i}}\times \overrightarrow{OA_{i+1}}}{2}</script><p>è¯æ˜çš„è¯å¯èƒ½å®¹æ–¥å¯è¯ï¼Œä½†æˆ‘ä¸ä¼šâ€¦æˆ‘åªçŸ¥é“ä¸¤ä¸ªå‘é‡çš„å‰ç§¯æ˜¯ä»¥è¿™ä¸¤ä¸ªå‘é‡ä¸ºä¸´è¾¹çš„å¹³è¡Œå››è¾¹å½¢çš„é¢ç§¯ã€‚</p><p><img src="http://www.wjyyy.top/wp-content/uploads/2019/02/201902140847.png" alt="wjyyyçš„å›¾"></p><p><img src="http://www.wjyyy.top/wp-content/uploads/2019/02/201902140906.png" alt="wjyyyçš„å›¾"></p><p>ç„¶åè¿™é‡Œæ”¾äº†ç¥ä»™ <code>wjyyy</code> çš„å›¾ï¼Œçœ‹ä¸Šå»æ¯”è¾ƒç›´è§‚ã€‚</p><p>ç„¶åè€ƒè™‘è¿™é¢˜æ€ä¹ˆåšã€‚å‘ç° $n+m$ ä¸å¤§ï¼Œäºæ˜¯è€ƒè™‘æ±‚ä¸€ä¸ª $f_{i,j}$ è¡¨ç¤ºå‘é‡ $\bf V_i$ ä¸ $\bf V_{j}$ ä¹‹é—´ï¼Œ$\bf V_{i}\to \bf V_{j}$ éœ€è¦é€†æ—¶é’ˆæ—‹è½¬æ—¶ï¼Œ$i,j$ ä¹‹é—´çš„ä»·å€¼å’Œã€‚é‚£ä¹ˆå¯¹äºæ¯ä¸€ä¸ªè¯¢é—® $\{s_n\}$ ï¼Œç­”æ¡ˆå°±æ˜¯ $\sum f_{s_i,s_{i+1}}$ ã€‚ </p><p>è€ƒè™‘å¦‚ä½•é¢„å¤„ç†è¿™ä¸ªä¸œè¥¿ã€‚é¦–å…ˆå¯¹æ‰€æœ‰å‘é‡æŒ‰ç…§æè§’é€†æ—¶é’ˆæ’åº(ç›¸ç­‰åˆ™æ¨¡é•¿å¤§è€…ä½æ¬¡é å)ï¼Œæšä¸¾ $i$ ï¼Œä¹‹åå°±éœ€è¦å–œé—»ä¹è§çš„å¹³è¡¡æ ‘äº†ã€‚å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p><p><img src="1.png" alt></p><p>å…¶ä¸­çº¢è‰²å‘é‡æ˜¯é¢˜ç›®æ‰€ç»™çš„å‘é‡ï¼Œè“è‰²å‘é‡æ˜¯è¾…åŠ©çº¿ã€‚å› ä¸ºä¸€å¼€å§‹å°±å·²ç»æ˜¯é€†æ—¶é’ˆæ’åºï¼Œæ‰€ä»¥åªéœ€è¦åˆ¤æ–­æ¯ä¸ªå‘é‡çš„ä¸­ç‚¹æ˜¯å¦è½åœ¨å‘é‡ $\bf i,j,t_2$ æ„æˆçš„ä¸‰è§’å½¢å³å¯ã€‚è§‚å¯Ÿè½åœ¨ä¸‰è§’å½¢å†…éƒ¨çš„å‘é‡ $\bf k$ å’Œè½åœ¨å¤–éƒ¨çš„å‘é‡ $\bf p$ ï¼Œä¼šå‘ç°æœ‰ </p><script type="math/tex; mode=display">\bf {\text{<}i,t_1\text{>} \geq \text{<}i,t_2\text{>}\geq \text{<}i,t_3\text{>}}</script><p>è€ƒè™‘å‘é‡å¤¹è§’æœ€å¤§ä¸º $\pi$ ï¼Œ$y=\cos x$ åœ¨ $[0,\pi]$ ä¸Šå•è°ƒé€’å‡ï¼Œäºæ˜¯å¯ä»¥çŸ¥é“è¦æ‹¿ $\cos x$ ä½œä¸ºé”®å€¼ï¼Œè¯¥å‘é‡çš„ $val$ ä½œä¸ºç‚¹å€¼æ’å…¥å¹³è¡¡æ ‘ã€‚å…¶ä¸­ $\cos x$ æ‹¿å‘é‡å†…ç§¯æ±‚å³å¯ã€‚ </p><p>æœ€ç»ˆå¤æ‚åº¦ $O(n^2\log n+ms)$ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> db eps = <span class="number">1e-9</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> L ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> n, m, q ;</span><br><span class="line"><span class="keyword">int</span> f[N][N] ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pts</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> id ; <span class="keyword">int</span> val ; db x, y ;</span><br><span class="line"><span class="function">il db <span class="title">mo</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>(x * x + y * y) ; &#125;</span><br><span class="line">il <span class="keyword">friend</span> pts <span class="keyword">operator</span> - (ct pts &amp;p, ct pts &amp;q)&#123;</span><br><span class="line"><span class="keyword">return</span> (pts)&#123;<span class="number">0</span>, <span class="number">0</span>, p.x - q.x, p.y - q.y&#125; ;</span><br><span class="line">&#125;</span><br><span class="line">il <span class="keyword">friend</span> db <span class="keyword">operator</span> * (ct pts &amp;p, ct pts &amp;q)&#123;</span><br><span class="line"><span class="keyword">return</span> p.x * q.y - p.y * q.x ;</span><br><span class="line">&#125;</span><br><span class="line">il <span class="keyword">friend</span> db <span class="keyword">operator</span> + (ct pts &amp;p, ct pts &amp;q)&#123;</span><br><span class="line"><span class="keyword">return</span> p.x * q.x + p.y * q.y ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;v[N], org, calc[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function">il db <span class="title">cosi</span><span class="params">(pts a, pts b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (a + b) / (a.mo() * b.mo()) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(pts a, pts b)</span></span>&#123;</span><br><span class="line">db ang = (a - org) * (b - org) ;</span><br><span class="line"><span class="comment">//cout &lt;&lt; ang &lt;&lt; '\n' ;</span></span><br><span class="line"><span class="keyword">if</span> (ang != eps) <span class="keyword">return</span> ang &gt; eps ;</span><br><span class="line"><span class="keyword">return</span> (a - org).mo() &lt; (b - org).mo() ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> _splay&#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> __<span class="title">splay</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> son[<span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> tot ;</span><br><span class="line"><span class="keyword">int</span> val ;</span><br><span class="line"><span class="keyword">int</span> sum ;</span><br><span class="line"><span class="keyword">int</span> fa ;</span><br><span class="line"><span class="keyword">int</span> sz ;</span><br><span class="line">db key ;</span><br><span class="line">&#125;s[N] ;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(x) s[x].sz</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fa(x) s[x].fa</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> val(x) s[x].val</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> key(x) s[x].key</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> tot(x) s[x].tot</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(x) s[x].sum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc(x) s[x].son[0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc(x) s[x].son[1]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> size ;</span><br><span class="line"><span class="keyword">int</span> root ;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">w</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (x == rc(fa(x))) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= size ; ++ i)&#123;</span><br><span class="line">sz(i) = lc(i) = rc(i) = fa(i) = <span class="number">0</span> ;</span><br><span class="line">tot(i) = val(i) = key(i) = sum(i) = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line">size = <span class="number">0</span> ; root = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">sz(x) = tot(x) ;</span><br><span class="line">sum(x) = val(x) ;</span><br><span class="line"><span class="keyword">if</span> (lc(x))&#123;</span><br><span class="line">sz(x) += sz(lc(x)) ;</span><br><span class="line">sum(x) += sum(lc(x)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (rc(x))&#123;</span><br><span class="line">sz(x) += sz(rc(x)) ;</span><br><span class="line">sum(x) += sum(rc(x)) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> c = w(x) ;</span><br><span class="line"><span class="keyword">int</span> f1 = fa(x) ;</span><br><span class="line"><span class="keyword">int</span> f2 = fa(f1) ;</span><br><span class="line"><span class="keyword">if</span> (!f2) root = x ;</span><br><span class="line"><span class="keyword">else</span> s[f2].son[w(f1)] = x ;</span><br><span class="line">fa(x) = f2 ; fa(f1) = x ;</span><br><span class="line">fa(s[x].son[c ^ <span class="number">1</span>]) = f1 ;</span><br><span class="line">s[f1].son[c] = s[x].son[c ^ <span class="number">1</span>] ;</span><br><span class="line">s[x].son[c ^ <span class="number">1</span>] = f1 ; upd(f1), upd(x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> aim)</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span> (fa(x) != aim)&#123;</span><br><span class="line"><span class="keyword">if</span> (fa(fa(x)) != aim)</span><br><span class="line">rotate(w(x) == w(fa(x)) ? fa(x) : x) ;</span><br><span class="line">rotate(x) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Ins</span><span class="params">(<span class="keyword">int</span> &amp;x, db ky, <span class="keyword">int</span> v, <span class="keyword">int</span> dad)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!x)&#123;</span><br><span class="line">x = ++ size ;</span><br><span class="line">fa(x) = dad ;</span><br><span class="line">key(x) = ky ;</span><br><span class="line">val(x) = sum(x) = v ;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (ky &lt; key(x))</span><br><span class="line">Ins(lc(x), ky, v, x) ;</span><br><span class="line"><span class="keyword">else</span> Ins(rc(x), ky, v, x) ; upd(x) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> _splay ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">org.x = <span class="number">-100000</span> ;</span><br><span class="line">org.y = <span class="number">-100000</span> ;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">db x, y, w ; <span class="keyword">int</span> z, h, r ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y, v[++ cnt] = (pts)&#123;i, <span class="number">0</span>, x, y&#125; ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n + <span class="number">1</span> ; i &lt;= n + m ; ++ i)</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; w, v[++ cnt] = (pts)&#123;i, w, x, y&#125; ;</span><br><span class="line">sort(v + <span class="number">1</span>, v + cnt + <span class="number">1</span>, comp) ; m = n ; n = cnt ; <span class="built_in">cin</span> &gt;&gt; q ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line"><span class="keyword">if</span> (v[i].id &gt; m) <span class="keyword">continue</span> ;</span><br><span class="line">clear() ; pts o = v[i] - org ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span> ; j &lt;= n ; ++ j)&#123;</span><br><span class="line">pts z = v[j] - v[i] ; db ky = cosi(o, z) ;</span><br><span class="line"><span class="comment">//cout &lt;&lt; root &lt;&lt; '\n' ;</span></span><br><span class="line">Ins(root, ky, v[j].val, <span class="number">0</span>) ; splay(size, <span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">if</span>(v[j].id &lt;= m)&#123;</span><br><span class="line">            f[v[i].id][v[j].id] = sum(lc(root)) ;</span><br><span class="line">            f[v[j].id][v[i].id] = - sum(lc(root)) ;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">for (int i = 1 ; i &lt;= n ; ++ i)</span></span><br><span class="line"><span class="comment">for (int j = 1 ; j &lt;= n ; ++ j)</span></span><br><span class="line"><span class="comment">cout &lt;&lt; f[i][j] &lt;&lt; " \n"[j == n] ; */</span></span><br><span class="line"><span class="keyword">while</span> (q --)&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; L ; <span class="built_in">cin</span> &gt;&gt; h ; r = h ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; L ; ++ i)</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; z, ans += f[h][z], h = z ;</span><br><span class="line">ans += f[h][r] ; <span class="built_in">printf</span> (<span class="string">"%d\n"</span>, <span class="built_in">abs</span>(ans)) ; ans = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡å†™äº†ä¸€é splayï¼Œå‘ç°æ˜¯çœŸçš„æ…¢+ç»´æŠ¤çš„ä¿¡æ¯çœŸçš„å¤šâ€¦</p><p>å¹¶ä¸”å‘ç°é€’å½’å¼çš„ splay æ’å…¥æ˜¯çœŸçš„å¥½å†™ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Cirno é—²ç€æ— äº‹çš„æ—¶å€™å–œæ¬¢å†°å†»é’è›™ã€‚&lt;/p&gt;
&lt;p&gt;é›¾ä¹‹æ¹–ç”Ÿæ´»ç€ $m$ åªé’è›™ï¼Œé’è›™æœ‰å¤§æœ‰å°ï¼Œæ‰€ä»¥æ¯åªé’è›™çš„ä»·å€¼ä¸ºä¸€ä¸ªä¸å¤§äº $10000$ çš„æ­£æ•´æ•°ã€‚&lt;/p&gt;
&lt;p&gt;Cirno æ¯æ¬¡ä»é›¾ä¹‹æ¹–ä¸­å›ºå®šçš„ $n$ ä¸ªç»“ç‚¹ä¸­é€‰å‡ºä¸€äº›ç‚¹æ„æˆä¸€ä¸ªç®€å•å¤šè¾¹å½¢ï¼ŒCirno è¿ç”¨è‡ªå·±çš„èƒ½åŠ›èƒ½å°†æ­¤å¤šè¾¹å½¢å†…æ‰€æœ‰é’è›™å†°å†»ã€‚Cirno å¾ˆæƒ³çŸ¥é“æ¯æ¬¡å†»ä½çš„é’è›™çš„ä»·å€¼æ€»å’Œã€‚å› ä¸ºæ™ºå•†æœ‰é™ï¼ŒCirno å°†è¿™ä¸ªé—®é¢˜äº¤ç»™å®Œç¾ç®—æœ¯æ•™å®¤é‡Œçš„ä½ ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºçˆ±æŠ¤åŠ¨ç‰©ï¼Œæ‰€ä»¥æ¯æ¬¡å†»ç»“çš„é’è›™ä¼šè¢«æ”¾ç”Ÿã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€åªé’è›™å¯ä»¥è¢«å¤šæ¬¡ç»Ÿè®¡ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$n,m\leq 10^3, q\leq 10^4,-10^4\leq x,y\leq 10^4,0&amp;lt;v\leq 10^4$ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ ¡å†…æµ‹è¯•ï¼ŒæŸ NOIP æ¨¡æ‹Ÿé¢˜è€ƒäº†ä¸‰è§’å‰–åˆ†â€¦ä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸€çœ¼å°±çœ‹å‡ºæ˜¯ä¸‰è§’å‰–åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ç´§æ¥ç€å‘ç°æ˜¯ bzoj åŸé¢˜ï¼Œå­¦äº†ä¸€æ³¢ä¸‰è§’å‰–åˆ†+æ¸©ä¹ äº†ä¸€éå‘é‡ä¹‹åæ„Ÿè§‰è¿™é¢˜æœ‰ç‚¹çŒ›ç”·ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="BZOJ" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/BZOJ/"/>
    
    
      <category term="è®¡ç®—å‡ ä½•/ä¸‰è§’å‰–åˆ†" scheme="https://www.orchidany.cn/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95-%E4%B8%89%E8%A7%92%E5%89%96%E5%88%86/"/>
    
      <category term="æ•°æ®ç»“æ„/å¹³è¡¡æ ‘/splay" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%B9%B3%E8%A1%A1%E6%A0%91-splay/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘bzoj3881[COCI2015] Divljak</title>
    <link href="https://www.orchidany.cn/2020/04/15/COCI2015-Divljak/"/>
    <id>https://www.orchidany.cn/2020/04/15/COCI2015-Divljak/</id>
    <published>2020-04-15T13:17:33.000Z</published>
    <updated>2020-04-16T00:22:25.489Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>Alice æœ‰ $n$ ä¸ªå­—ç¬¦ä¸² $\rm S_1,S_2,\dots,S_n$ï¼ŒBob æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²é›†åˆ $\rm T$ ï¼Œä¸€å¼€å§‹é›†åˆæ˜¯ç©ºçš„ã€‚</p><p>æ¥ä¸‹æ¥ä¼šå‘ç”Ÿ $q$ ä¸ªæ“ä½œï¼Œæ“ä½œæœ‰ä¸¤ç§å½¢å¼ï¼š</p><ol><li><code>1 P</code> Bob å¾€è‡ªå·±çš„é›†åˆé‡Œæ·»åŠ äº†ä¸€ä¸ªå­—ç¬¦ä¸² $\rm P$ã€‚</li><li><code>2 x</code> Alice è¯¢é—® Bobï¼Œé›†åˆ $\rm T$ ä¸­æœ‰å¤šå°‘ä¸ªå­—ç¬¦ä¸²åŒ…å«ä¸² $\rm S_x$ï¼ˆæˆ‘ä»¬ç§°ä¸² $\rm A$ åŒ…å«ä¸² $\rm B$ï¼Œå½“ä¸”ä»…å½“ $\rm B$ æ˜¯ $\rm A$ çš„å­ä¸²ï¼‰ã€‚</li></ol><p>å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1 \leq n,q \leq 10^5$ï¼Œå­—ç¬¦ä¸²ç”±å°å†™å­—æ¯æ„æˆï¼Œæ‰€æœ‰å­—ç¬¦ä¸²çš„æ€»é•¿ $\le 2 \times 10^6$ã€‚</p></blockquote><p>ä»Šå¤©çªç„¶å’Œ zay èŠèµ· ACAM æ¥ï¼Œäºæ˜¯æƒ³åˆ°è¿˜æœ‰è¿™é“å¥½é¢˜æ²¡æ•´ç†ã€‚</p><p>å•Šï¼Œè¿™é¢˜èƒŒåå¯æ˜¯è®°è½½ç€å…‰è£å²æœˆå•Šâ€¦ä½†è¿™æ˜¯åªæœ‰æˆ‘å’Œ zay çŸ¥é“çš„ç§˜å¯†/qq</p><a id="more"></a><p>å¤§æ¦‚æ˜¯è€ƒè™‘ï¼Œåæ­£æ˜¯åŒ¹é…é—®é¢˜â€”â€”é‚£ä¹ˆæ˜¯å¯¹ç€ $\rm T$ å»ºè‡ªåŠ¨æœºå‘¢ï¼Œè¿˜æ˜¯å¯¹ $\rm \{S_n\}$ å»ºã€‚ è€ƒè™‘ AC è‡ªåŠ¨æœºæ›´é€‚åˆåšè¿™ç§åŒ¹é…é¢˜ï¼Œäºæ˜¯å¤§æ¦‚æƒ³åˆ°è¦æ‹¿ AC è‡ªåŠ¨æœºåšï¼›è€ƒè™‘å¦‚æœå¯¹ç€ $\rm T$ å»ºè‡ªåŠ¨æœºï¼Œæ ‘çš„å½¢æ€ä¼šå˜ï¼Œ$\rm S$ çš„ä¿¡æ¯éœ€è¦åŠ¨æ€ç»´æŠ¤ï¼Œå¹¶ä¸å¾ˆå¥½åšï¼Œäºæ˜¯è€ƒè™‘å¯¹ $\rm S$ å»ºè‡ªåŠ¨æœº $\rm AC_s$ã€‚</p><p>è€ƒè™‘è¿™æ ·åšï¼Œå°±éœ€è¦åœ¨å·²ç»å»ºå¥½çš„è‡ªåŠ¨æœºä¸Šï¼Œå¯¹äºæ¯ä¸ªæ–°åŠ è¿›æ¥çš„ $P$ è®¡ç®—è´¡çŒ®ã€‚é‚£ä¹ˆä¼šè¢« $P$ åŒ…å«çš„å­—ç¬¦ä¸²ï¼Œä¸€å®šæ˜¯ $P$ åœ¨ $\rm AC_s$ é‡ŒåŒ¹é…çš„ $endpos$ åˆ°æ ¹çš„è·¯å¾„ä¸Šæ¯ä¸ªç‚¹ï¼Œåˆ°æ ¹çš„é“¾ä¸Šçš„ç‚¹é›†å¹¶ã€‚æš´åŠ›æ˜¯ $n^2$ çš„ï¼Œè€ƒè™‘å¦‚ä½•å¿«é€Ÿè®¡ç®—è¿™ä¸ªè´¡çŒ®ï¼Œå‘ç°èƒ½åšåˆ°æœ€å¿«çš„ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡ç»´æŠ¤ dfs åºçš„æ–¹å¼æ±‚å‡ºç‚¹é›†å¹¶ã€‚å¯¹äºæ¯ä¸€ä¸ªè¿™æ ·çš„é“¾çš„å¹¶æ‰“ä¸€ä¸ªæ ‡è®°ã€‚è¯¢é—®çš„æ—¶å€™åªéœ€è¦å›ç­”ä¸€ä¸‹å­æ ‘å†…æœ‰å¤šå°‘ä¸ªç‚¹è¢«æ‰“äº†ä¸åŒçš„æ ‡è®°ã€‚</p><p>å‘ç°ã€Œç»´æŠ¤æ ‘é“¾æ ‡è®°ã€+ã€Œå­æ ‘æ±‚å’Œã€ï¼Œæœ€å¿«é€Ÿçš„æ–¹æ³•æ˜¯ç»´æŠ¤å·®åˆ†ã€‚åŒæ—¶ç”±äºæ˜¯åŠ¨æ€çš„ï¼Œå¯ä»¥æƒ³åˆ°ç”¨çº¿æ®µæ ‘æˆ–è€… BIT å¿«é€Ÿç»´æŠ¤ã€‚</p><p>è€ƒè™‘ä¿®æ”¹å¦‚ä½•è¿›è¡Œã€‚å‘ç°ä¸ºäº†ä¿è¯ $\land$ å½¢æ€çš„é“¾åªä¼šè¢«è®¡æ•°ä¸€æ¬¡ï¼Œéœ€è¦åœ¨ $lca$ å¤„å·®åˆ†ã€‚æ­¤å¤„éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦å¯¹ $dfs$ åºæ’åºä¹‹åï¼Œå†é€ä¸ªå·®åˆ†ï¼Œæ–¹æ³•æ˜¯ $(i,+1),(i+1,+1),(lca_{i,i+1},-1)$ ã€‚</p><p>æƒ³äº†åŠå¤©æ‰å¤§çº¦æ˜ç™½ä¸ºä»€ä¹ˆè¦æŒ‰ dfs åºæ’ä¸€éåºã€‚å¤§æ¦‚æ˜¯å¦‚æœä¸æŒ‰ dfs åºçš„é¡ºåºæšä¸¾ï¼Œå¯èƒ½ä¼šå‡ºç°æŸä¸ªå­æ ‘æœªè¢«æˆåŠŸæ‰“ä¸Šæ ‡è®°çš„æƒ…å†µã€‚</p><p>æœ€ç»ˆå¤æ‚åº¦æ˜¯ $O(\rm |S|\log |S|)$ çš„ï¼Œè·‘çš„ä¸æ˜¯å¾ˆå¿«ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Sigma 27</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 2001010</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> S[MAXN] ;</span><br><span class="line"><span class="keyword">int</span> T, M, N, L[MAXN] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next ;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line">&#125;E[MAXN] ; <span class="keyword">int</span> head[MAXN], base[MAXN], cnt, tot ;</span><br><span class="line"><span class="keyword">int</span> _ed[MAXN], dfn[MAXN], rgl[MAXN], rgr[MAXN], tp ;</span><br><span class="line"><span class="keyword">int</span> sz[MAXN], dep[MAXN], fa[MAXN], top[MAXN], son[MAXN], val[MAXN &lt;&lt; <span class="number">2</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    E[++ cnt].to = v, E[cnt].next = head[u], head[u] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    sz[u] = <span class="number">1</span>, dep[u] = dep[fa[u]] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))&#123;</span><br><span class="line">        fa[to(k)] = u, dfs(to(k)), sz[u] += sz[to(k)] ;</span><br><span class="line">        <span class="keyword">if</span> (!son[u] || sz[to(k)] &gt; sz[son[u]]) son[u] = to(k) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> tp)</span></span>&#123;</span><br><span class="line">    top[u] = tp,</span><br><span class="line">    dfn[u] = rgl[u] = ++ tot ;</span><br><span class="line">    <span class="keyword">if</span> (son[u]) dfs2(son[u], tp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = head[u] ; k ; k = next(k))</span><br><span class="line">        <span class="keyword">if</span> (to(k) != son[u]) dfs2(to(k), to(k)) ;</span><br><span class="line">    rgr[u] = tot ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; <span class="keyword">return</span> dfn[x] &lt; dfn[y] ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (top[u] != top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[top[u]] &gt;= dep[top[v]]) u = fa[top[u]] ;</span><br><span class="line">        <span class="keyword">else</span> v = fa[top[v]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[u] &lt; dep[v] ? u : v ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _up(<span class="keyword">int</span> rt)&#123;</span><br><span class="line">    val[rt] = val[rt &lt;&lt; <span class="number">1</span>] + val[rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> val[rt] += v, <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (mid &gt;= p)</span><br><span class="line">        update(rt &lt;&lt; <span class="number">1</span>, l, mid, p, v) ;</span><br><span class="line">    <span class="keyword">else</span> update(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, p, v) ;</span><br><span class="line">    _up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> pl, <span class="keyword">int</span> pr)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (pl &gt; pr) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= pl &amp;&amp; pr &gt;= r) <span class="keyword">return</span> val[rt] ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (pl &lt;= mid) res += query(rt &lt;&lt; <span class="number">1</span>, l, mid, pl, pr) ;</span><br><span class="line">    <span class="keyword">if</span> (pr &gt; mid) res += query(rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, pl, pr) ;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ACAM</span>&#123;</span></span><br><span class="line">    <span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line">    <span class="keyword">int</span> _size, fail[MAXN] ;</span><br><span class="line">    <span class="keyword">int</span> trie[MAXN][Sigma] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rt = <span class="number">0</span>, x ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= L[n] ; ++ i)&#123;</span><br><span class="line">            x = s[i] - <span class="string">'a'</span> ;</span><br><span class="line">            <span class="keyword">if</span> (!trie[rt][x])</span><br><span class="line">                trie[rt][x] = ++ _size ;</span><br><span class="line">            rt = trie[rt][x] ;</span><br><span class="line">        &#125;</span><br><span class="line">        _ed[n] = rt ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; Sigma ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (trie[<span class="number">0</span>][i]) q.push(trie[<span class="number">0</span>][i]) ;</span><br><span class="line">        <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">            <span class="keyword">int</span> n = q.front() ; add(fail[n], n), q.pop() ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">26</span> ; ++ i)&#123;</span><br><span class="line">                <span class="keyword">if</span> (!trie[n][i]) trie[n][i] = trie[fail[n]][i] ;</span><br><span class="line">                <span class="keyword">else</span> fail[trie[n][i]] = trie[fail[n]][i], q.push(trie[n][i]) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">char</span> *S)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x, rt = <span class="number">0</span> ; tp = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)</span><br><span class="line">            x = S[i] - <span class="string">'a'</span>, rt = trie[rt][x], base[++ tp] = rt ;</span><br><span class="line">        sort(base + <span class="number">1</span>, base + tp + <span class="number">1</span>, comp),</span><br><span class="line">        tp = unique(base + <span class="number">1</span>, base + tp + <span class="number">1</span>) - base - <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tp ; ++ i)&#123;</span><br><span class="line">            update(<span class="number">1</span>, <span class="number">1</span>, tot, dfn[base[i]], <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; <span class="number">1</span>) update(<span class="number">1</span>, <span class="number">1</span>, tot, dfn[lca(base[i], base[i - <span class="number">1</span>])], <span class="number">-1</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;AC ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">0</span> ; <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) r = (r &lt;&lt; <span class="number">1</span>) + (r &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">    <span class="keyword">return</span> r ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// freopen("1.in", "r", stdin) ;</span></span><br><span class="line">    <span class="comment">// freopen("1.ans", "w", stdout) ;</span></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ; <span class="keyword">int</span> m, q ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= T ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, S + <span class="number">1</span>), L[i] = <span class="built_in">strlen</span>(S + <span class="number">1</span>), AC.insert(S, i) ;</span><br><span class="line">    AC.build() ; <span class="built_in">cin</span> &gt;&gt; M ; dfs(<span class="number">0</span>), dfs2(<span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= T ; ++ i) cout &lt;&lt; rgl[i] &lt;&lt; " " &lt;&lt; rgr[i] &lt;&lt; endl ;</span></span><br><span class="line">    <span class="keyword">while</span> (M --)&#123;</span><br><span class="line">        m = qr() ;</span><br><span class="line">        <span class="keyword">if</span> (m == <span class="number">1</span>) <span class="built_in">scanf</span>(<span class="string">"%s"</span>, S + <span class="number">1</span>), N = <span class="built_in">strlen</span>(S + <span class="number">1</span>), AC.solve(S) ;</span><br><span class="line">        <span class="keyword">else</span> q = qr(),</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, query(<span class="number">1</span>, <span class="number">1</span>, tot, <span class="number">1</span>, rgr[_ed[q]]) - query(<span class="number">1</span>, <span class="number">1</span>, tot, <span class="number">1</span>, rgl[_ed[q]] - <span class="number">1</span>)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Alice æœ‰ $n$ ä¸ªå­—ç¬¦ä¸² $\rm S_1,S_2,\dots,S_n$ï¼ŒBob æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²é›†åˆ $\rm T$ ï¼Œä¸€å¼€å§‹é›†åˆæ˜¯ç©ºçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ä¼šå‘ç”Ÿ $q$ ä¸ªæ“ä½œï¼Œæ“ä½œæœ‰ä¸¤ç§å½¢å¼ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;1 P&lt;/code&gt; Bob å¾€è‡ªå·±çš„é›†åˆé‡Œæ·»åŠ äº†ä¸€ä¸ªå­—ç¬¦ä¸² $\rm P$ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;2 x&lt;/code&gt; Alice è¯¢é—® Bobï¼Œé›†åˆ $\rm T$ ä¸­æœ‰å¤šå°‘ä¸ªå­—ç¬¦ä¸²åŒ…å«ä¸² $\rm S_x$ï¼ˆæˆ‘ä»¬ç§°ä¸² $\rm A$ åŒ…å«ä¸² $\rm B$ï¼Œå½“ä¸”ä»…å½“ $\rm B$ æ˜¯ $\rm A$ çš„å­ä¸²ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1 \leq n,q \leq 10^5$ï¼Œå­—ç¬¦ä¸²ç”±å°å†™å­—æ¯æ„æˆï¼Œæ‰€æœ‰å­—ç¬¦ä¸²çš„æ€»é•¿ $\le 2 \times 10^6$ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»Šå¤©çªç„¶å’Œ zay èŠèµ· ACAM æ¥ï¼Œäºæ˜¯æƒ³åˆ°è¿˜æœ‰è¿™é“å¥½é¢˜æ²¡æ•´ç†ã€‚&lt;/p&gt;
&lt;p&gt;å•Šï¼Œè¿™é¢˜èƒŒåå¯æ˜¯è®°è½½ç€å…‰è£å²æœˆå•Šâ€¦ä½†è¿™æ˜¯åªæœ‰æˆ‘å’Œ zay çŸ¥é“çš„ç§˜å¯†/qq&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="BZOJ" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/BZOJ/"/>
    
    
      <category term="æ ‘ä¸ŠæŠ€å·§/dfsåº+æ ‘çŠ¶æ•°ç»„" scheme="https://www.orchidany.cn/tags/%E6%A0%91%E4%B8%8A%E6%8A%80%E5%B7%A7-dfs%E5%BA%8F-%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"/>
    
      <category term="å­—ç¬¦ä¸²/ACè‡ªåŠ¨æœº" scheme="https://www.orchidany.cn/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2-AC%E8%87%AA%E5%8A%A8%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘[CF626F]Group Projects</title>
    <link href="https://www.orchidany.cn/2020/04/15/CF626F/"/>
    <id>https://www.orchidany.cn/2020/04/15/CF626F/</id>
    <published>2020-04-15T01:20:49.000Z</published>
    <updated>2020-04-15T02:33:02.498Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>æœ‰ $n$ ä¸ªå­¦ç”Ÿï¼Œæ¯ä¸ªå­¦ç”Ÿæœ‰ä¸€ä¸ªèƒ½åŠ›å€¼ $a_i$ã€‚ç°åœ¨è¦æŠŠè¿™äº›å­¦ç”Ÿåˆ†æˆä¸€äº›(ä»»æ„æ•°é‡çš„)ç»„ï¼Œæ¯ä¸€ç»„çš„â€œä¸å’Œè°åº¦â€æ˜¯è¯¥ç»„èƒ½åŠ›å€¼æœ€å¤§çš„å­¦ç”Ÿä¸èƒ½åŠ›å€¼æœ€å°çš„å­¦ç”Ÿçš„èƒ½åŠ›å€¼çš„å·®ã€‚æ±‚æ‰€æœ‰ä¸å’Œè°åº¦ä¹‹å’Œä¸è¶…è¿‡ $k$ çš„åˆ†ç»„æ–¹æ¡ˆæ€»æ•°å¯¹ $10^9+7$ å–æ¨¡ã€‚</p><p>$n\leq 200,k\leq 1000,0\leq a_i\leq 500$</p></blockquote><p>ä»å¤´å¼€å§‹çš„è®¡æ•°ç”Ÿæ´».png</p><a id="more"></a><p>è€ƒè™‘æš´åŠ›è®¡æ•°ï¼Œå¤§æ¦‚å°±æ˜¯ $f_{i,j,k}$ è¡¨ç¤ºè€ƒè™‘äº†å‰ $i$ ä¸ªå­¦ç”Ÿï¼Œåˆ†äº† $j$ ç»„ï¼Œå½“å‰ä¸å’Œè°åº¦æ€»å’Œä¸º $k$ çš„æ–¹æ¡ˆæ•°ã€‚å‘ç°è¿™æ ·æ²¡æ³•è½¬ç§»ï¼Œå› ä¸ºå¹¶ä¸çŸ¥é“è¯¥æ€ä¹ˆè€ƒè™‘æ’å…¥ä¸€ä¸ªå…ƒç´ æ—¶çš„è´¡çŒ®ã€‚è€ƒè™‘å¯¹äºä¸€ç§çŠ¶æ€ï¼Œå¦‚æœé’¦å®šäº†å…¶ä¸­æŸäº›é›†åˆçš„æœ€å¤§å€¼æˆ–è€…æœ€å°å€¼å·²ç»å›ºå®šï¼Œå¦‚æœå½“å‰å…ƒç´ è¶…è¿‡äº†è¿™ä¸ª bondï¼Œå°±ä¸èƒ½å†ç”¨å½“å‰å…ƒç´ æ›´æ–°ã€‚äºæ˜¯è€ƒè™‘å¦ä¸€ç§çŠ¶æ€ï¼Œ$f_{i,j,k}$ è¡¨ç¤ºè€ƒè™‘äº†å‰ $i$ ä¸ªå­¦ç”Ÿï¼Œåˆ†äº†ä¸çŸ¥é“ç»„ï¼Œä½†æ˜¯æœ‰ $j$ ç»„çš„æœ€å¤§å€¼è¿˜æ²¡ç¡®å®šï¼Œå½“å‰ä¸å’Œè°åº¦æ€»å’Œä¸º $k$ çš„æ–¹æ¡ˆæ•° ã€‚è¿™æ ·æ˜¾ç„¶æ˜¯éœ€è¦å°†æ‰€æœ‰æƒå€¼æ’åºä¹‹åå† $dp$ çš„ã€‚</p><p>è€ƒè™‘è½¬ç§»ã€‚æ¯æ¬¡é‡åˆ°ä¸€ä¸ªæ–°çš„å…ƒç´ ï¼Œå¯ä»¥å°†å…¶å’Œä¹‹å‰çš„æŸä¸€ç»„åˆå¹¶ï¼Œæˆ–è€…å•ç‹¬æ–°å¼€ä¸€ç»„ã€‚è®°æ²¡ç¡®å®šæœ€å¤§å€¼çš„é›†åˆä¸ºã€Œæœªé—­åˆé›†åˆã€ï¼Œé‚£ä¹ˆå°±æœ‰å››ç§æƒ…å†µï¼š</p><p>1ã€åˆå¹¶ï¼Œä½†æ˜¯é‚£ä¸ªé›†åˆä»æœªé—­åˆã€‚</p><p>2ã€åˆå¹¶ï¼Œé‚£ä¸ªé›†åˆé—­åˆäº†ã€‚</p><p>3ã€ä¸åˆå¹¶ï¼Œæ–°å¼€çš„é›†åˆæœªé—­åˆã€‚</p><p>4ã€ä¸åˆå¹¶ï¼Œæ–°å¼€çš„é›†åˆé—­åˆäº†ã€‚</p><p>äºæ˜¯è½¬ç§»å°±æ˜¯</p><script type="math/tex; mode=display">f_{i,j,k}=\sum \begin{cases}j\times f_{i-1,j,k}\\ (j+1)\times f_{i-1,j+1,k+a_i}\\ f_{i-1,j-1,k-a_i}\\f_{i-1,j,k}\end{cases}</script><p>åˆ†åˆ«å¯¹åº”å››ç§æƒ…å†µã€‚</p><p>è€ƒè™‘è¿™ä¹ˆåšçš„å¤æ‚åº¦ï¼Œä¼¼ä¹æ˜¯ $O(n^2k)$ ï¼Œä½†æ˜¯ç”±äºä¸­é—´è½¬ç§»è¿‡ç¨‹çš„ç¬¬ä¸‰ç»´å¯èƒ½ä¼šåˆ° $\pm 10^4$ ï¼Œå¤§å°æ— æ³•å‡†ç¡®é¢„ä¼°ï¼Œæ‰€ä»¥æ—¶ç©ºå¤æ‚åº¦éƒ½æ˜¯ $O(n^2\sum a_i)$ çš„ã€‚äºæ˜¯å°± gg ã€‚</p><p>è€ƒè™‘ç¨å¾®æŠ½è±¡ä¸€ä¸‹ï¼Œæ¯ä¸ªé›†åˆçš„ $min/max$ å¯ä»¥çœ‹åšåœ¨ä¸€æ¡å€¼åŸŸè½´ä¸Šçº¿æ®µçš„å·¦ã€å³ç«¯ç‚¹ï¼Œå¯¹äºæ¯ä¸ªæ—¶åˆ» $i$ ï¼Œæœªé—­åˆçš„é›†åˆå°±æ˜¯æŸäº›ä¼šè¢« $i$ æ¨ªåˆ‡æ‰çš„çº¿æ®µã€‚é‚£ä¹ˆå¯¹äºæŸæ¡ç›´çº¿ $(l,r)$ ï¼Œæ»¡è¶³ $l&lt;i&lt;r$ ï¼Œåœ¨ç¬¬ $i$ ä¸ªæ—¶åˆ»ï¼Œè®°å½•çš„æ˜¯ä»£ä»·æ˜¯ $-a_l$ï¼Œä½†è¿™ç§æ–¹æ³•å¹¶ä¸èªæ˜ï¼Œå› ä¸ºåªæœ‰å½“å–åˆ° $r$ æ—¶ï¼Œ$-a_l$ æ‰ä¼šè¢«ç”¨ä¸Šï¼Œæ‰€ä»¥å¯¹äºä»»æ„ä¸€ä¸ª $i,l&lt;i&lt;r$ è€Œè¨€ï¼Œ$-a_l$ éƒ½æ˜¯æ²¡å¿…è¦æ‰¿è½½çš„ç©ºé—´ã€‚äºæ˜¯è€ƒè™‘æ€ä¹ˆå°†ä¸€æ¡çº¿æ®µçš„è´¡çŒ®å¹³æ‘Šåˆ°æ¯ä¸ªç‚¹ä¸Šï¼Œè¿™æ ·æ¯ä¸€ç»´è½¬ç§»å°±ä¸å†æ˜¯ $O(\max\{\sum a_i,k\})$ è€Œæ˜¯ $O(\max\{a_i,k\})$ ã€‚</p><p>è€ƒè™‘å¹³æ‘Šçš„è¯ï¼Œå³å¦‚ä½•å°† $a_r-a_l$ å±•å¼€æˆæ¯ä¸€é¡¹éƒ½ $&lt;\max\{a_i,k\}$ çš„è¿™ä¹ˆä¸€ä¸ªæ•°åˆ—ã€‚ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ–¹æ³•å°±æ˜¯ï¼š</p><script type="math/tex; mode=display">a_r-a_l=\sum_{i=l+1}^r(a_i-a_{i-1})</script><p><del>ä¸€çœ‹å°±æ˜¯è€åˆ†å¼è£‚é¡¹äº†</del></p><p>äºæ˜¯æœ¬è´¨ä¸Šåªæ˜¯ä¼˜åŒ–äº†è½¬ç§»ã€‚ä»¤ $d=a_i-a_{i-1}$ å¯ä»¥å¾—åˆ°ï¼š</p><script type="math/tex; mode=display">f_{i,j,k}=\sum \begin{cases}j\times f_{i-1,j,k-j\times d}\\ (j+1)\times f_{i-1,j+1,k-(j+1)\times d}\\ f_{i-1,j-1,k-(j-1)\times d}\\f_{i-1,j,k-j \times d}\end{cases}</script><p>ç„¶åå°±æ²¡æœ‰ç„¶åäº†ï¼Œå¤æ‚åº¦ $O(n^2\max\{k,\max\{a_i\}\})$ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 510</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXK 1010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mod 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ; </span><br><span class="line">LL dp[<span class="number">2</span>][MAXN][MAXK], ans ;</span><br><span class="line"><span class="keyword">int</span> N, K, M, base[MAXN], dif[MAXN] ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">const</span> <span class="keyword">int</span> &amp;y)</span></span>&#123; x -= y ; <span class="keyword">if</span> (x &lt; <span class="number">0</span>) x += Mod ; &#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(LL &amp;x, <span class="keyword">const</span> LL &amp;y)</span></span>&#123; x += y ; <span class="keyword">if</span> (x &gt; Mod) x %= Mod ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K ; <span class="keyword">int</span> i, j, k, d ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; </span><br><span class="line"> sort(base + <span class="number">1</span>, base + N + <span class="number">1</span>), dp[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>] = dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt; N ; ++ i) dif[i] = base[i + <span class="number">1</span>] - base[i] ;</span><br><span class="line"><span class="keyword">for</span> (d = i = <span class="number">1</span> ; i &lt; N ; ++ i, d ^= <span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">int</span> o = d ^ <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= N ; ++ j)&#123;</span><br><span class="line"><span class="keyword">int</span> op = dif[i] * j ;</span><br><span class="line"><span class="keyword">for</span> (k = <span class="number">0</span> ; k &lt;= K ; ++ k)&#123;</span><br><span class="line"><span class="keyword">int</span> val = k + op ;</span><br><span class="line">LL res = dp[o][j][k], v = res * j % Mod ;</span><br><span class="line">dp[o][j][k] = <span class="number">0</span> ; <span class="keyword">if</span> (val &gt; K) <span class="keyword">continue</span> ;</span><br><span class="line"><span class="keyword">if</span> (j) add(dp[d][j - <span class="number">1</span>][val], v) ; </span><br><span class="line">add(dp[d][j][val], v + res), add(dp[d][j + <span class="number">1</span>][val], res) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt;= K ; ++ i) </span><br><span class="line">add(ans, dp[(N - <span class="number">1</span>) &amp; <span class="number">1</span>][<span class="number">0</span>][i]) ; </span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span> ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ‰ $n$ ä¸ªå­¦ç”Ÿï¼Œæ¯ä¸ªå­¦ç”Ÿæœ‰ä¸€ä¸ªèƒ½åŠ›å€¼ $a_i$ã€‚ç°åœ¨è¦æŠŠè¿™äº›å­¦ç”Ÿåˆ†æˆä¸€äº›(ä»»æ„æ•°é‡çš„)ç»„ï¼Œæ¯ä¸€ç»„çš„â€œä¸å’Œè°åº¦â€æ˜¯è¯¥ç»„èƒ½åŠ›å€¼æœ€å¤§çš„å­¦ç”Ÿä¸èƒ½åŠ›å€¼æœ€å°çš„å­¦ç”Ÿçš„èƒ½åŠ›å€¼çš„å·®ã€‚æ±‚æ‰€æœ‰ä¸å’Œè°åº¦ä¹‹å’Œä¸è¶…è¿‡ $k$ çš„åˆ†ç»„æ–¹æ¡ˆæ€»æ•°å¯¹ $10^9+7$ å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;$n\leq 200,k\leq 1000,0\leq a_i\leq 500$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»å¤´å¼€å§‹çš„è®¡æ•°ç”Ÿæ´».png&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="Codeforces" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/Codeforces/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’/æœ‰æŠ€å·§çš„DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84DP/"/>
    
      <category term="æ€ç»´é¢˜/è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E8%AE%A1%E6%95%B0/"/>
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘[Ynoi2019]Yuno loves sqrt technology II</title>
    <link href="https://www.orchidany.cn/2020/04/12/Ynoi2019%E6%A8%A1%E6%8B%9F%E8%B5%9B-Yuno-loves-sqrt-technology-II/"/>
    <id>https://www.orchidany.cn/2020/04/12/Ynoi2019æ¨¡æ‹Ÿèµ›-Yuno-loves-sqrt-technology-II/</id>
    <published>2020-04-12T13:46:29.000Z</published>
    <updated>2020-04-14T00:18:16.181Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>ç»™å®šä¸€ä¸ªåºåˆ— $\{a_n\}$ï¼Œå¤šæ¬¡è¯¢é—®æŸä¸ªåŒºé—´çš„é€†åºå¯¹æ•°ã€‚</p><p>$1\leq n,m\leq 10^5,|a_i|\leq 10^9$ ã€‚</p></blockquote><p>è¿™è¿˜æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è®¤çœŸåšäº† lxl çš„ç”±ä¹ƒ OI é¢˜ç›®ï¼Œ233.</p><a id="more"></a><p>è¿˜æ˜¯è€ƒè™‘äºŒæ¬¡ç¦»çº¿ï¼Œé‚£ä¹ˆéœ€è¦é¢„å¤„ç†</p><script type="math/tex; mode=display">\sum_{i=1}^k (i,i)(1,i-1)\quad | \quad \sum_{i=1}^k (i,i)(1,i)</script><p>å’Œ</p><script type="math/tex; mode=display">\sum_{i=k+1}^n (i,i)(i+1,n)\quad | \quad \sum_{i=k+1}^n (i,i)(i,n)</script><p>è¿™ $4$ ä¸ªä¿¡æ¯ï¼Œå› ä¸ºåœ¨è®¡ç®—é€†åºå¯¹çš„æ—¶å€™æ˜¯æœ‰æ–¹å‘æ€§çš„ï¼Œ$l$ å‘å·¦æ‰©å±•/å‘å³æ”¶ç¼©å¯¹åº”çš„æ˜¯ $(l+1,n)$ ä¹‹é—´çš„ä¿¡æ¯ï¼Œ$r$ å‘å³æ‰©å±•/å·¦æ”¶ç¼©å¯¹åº”çš„æ˜¯ $(1,r-1)$ ä¹‹é—´çš„ä¿¡æ¯ã€‚åŒæ—¶æ³¨æ„åˆ°ç”±äº $(i,i)(1,i)=(i,i)(1,i-1)$ ï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šæ˜¯ä¸¤ä¸ªä¿¡æ¯ã€‚è¿™ä¸ªå¯ä»¥ $O(n\log n)$ é¢„å¤„ç†ã€‚</p><p>åŒç†ï¼Œå¯¹äºä¸èƒ½é¢„å¤„ç†çš„åŒºé—´ï¼Œä¹Ÿæ˜¯è¦åˆ†å·¦è¾¹çš„è´¡çŒ®å’Œå³è¾¹çš„è´¡çŒ®æ¥åšã€‚æ ¹æ®æ–¹å‘ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ¤æ–­æ¯ç§æƒ…å†µè´¡çŒ®åº”è¯¥æ€ä¹ˆåŠ ï¼Œæ‹¿ä¸¤ç§å€¼åŸŸåˆ†å—ï¼Œåˆ†åˆ«ç»´æŠ¤å‰ç¼€å’Œ&amp;åç¼€å’Œå°±å¥½äº†ã€‚</p><p>å®ç°ç»†èŠ‚æ–¹é¢éœ€è¦æ³¨æ„ï¼š</p><p>1ã€æœ¬é¢˜æ•°æ®ä¸­å­˜åœ¨ $a_i$ ç›¸åŒçš„æƒ…å†µï¼Œè¿™ä¸ªåœ°æ–¹ä¼šå¡æ±‚é€†åºå¯¹æ—¶çš„è¾¹ç•Œï¼Œæ³¨æ„åˆ¤ä¸€ä¸‹å³å¯ã€‚</p><p>2ã€å€¼åŸŸåˆ†å—éœ€è¦æ³¨æ„ï¼Œåªéœ€è¦ä¿®æ”¹æ•´å—çš„ <code>sum</code>ï¼Œé›¶æ•£çš„ç‚¹å•ç‹¬ç®—è´¡çŒ®ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(fast)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> G++ optimize(fast)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lwb lower_bound</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100050</span> ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> B ;</span><br><span class="line"><span class="keyword">int</span> V ;</span><br><span class="line"><span class="keyword">int</span> L ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line">ll s1[N] ;</span><br><span class="line">ll s2[N] ;</span><br><span class="line">ll res[N] ;</span><br><span class="line">ll ans[N] ;</span><br><span class="line"><span class="keyword">int</span> bl[N] ;</span><br><span class="line"><span class="keyword">int</span> tmp[N] ;</span><br><span class="line"><span class="keyword">int</span> blv[N] ;</span><br><span class="line"><span class="keyword">int</span> _bit[N] ;</span><br><span class="line"><span class="keyword">int</span> sumb[N] ;</span><br><span class="line"><span class="keyword">int</span> sump[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, k ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IPT &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">1</span> &lt;&lt; <span class="number">21</span>;</span><br><span class="line"><span class="keyword">char</span> buf[L], *front=buf, *end=buf;</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">GetChar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (front == end) end = buf + fread(front = buf, <span class="number">1</span>, L, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">return</span> (front == end) ? <span class="number">-1</span> : *(front++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">qrd</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> ch = GetChar(), lst = x = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch)) lst = ch, ch = GetChar();</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch)) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = GetChar();</span><br><span class="line">  <span class="keyword">if</span> (lst == <span class="string">'-'</span>) x = -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qra</span><span class="params">(T *<span class="keyword">const</span> __ary, <span class="keyword">int</span> __n)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= __n; ++i) qrd(__ary[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qrs</span><span class="params">(T *p)</span> </span>&#123;</span><br><span class="line">  T *beg = p;</span><br><span class="line">  <span class="keyword">do</span> *p = GetChar(); <span class="keyword">while</span> (!<span class="built_in">isalnum</span>(*p));</span><br><span class="line">  <span class="keyword">do</span> *(++p) = GetChar(); <span class="keyword">while</span> (<span class="built_in">isalnum</span>(*p));</span><br><span class="line">  *p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> p - beg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qrdb</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> ch = GetChar(), lst = x = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch)) lst = ch, ch = GetChar();</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch)) &#123; x = x * <span class="number">10</span> + (ch - <span class="string">'0'</span>); ch = GetChar(); &#125;</span><br><span class="line">  <span class="keyword">if</span> (ch == <span class="string">'.'</span>) &#123;</span><br><span class="line">    ch = GetChar();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span> t = <span class="number">0.1</span>; <span class="built_in">isdigit</span>(ch); t *= <span class="number">0.1</span>) &#123;</span><br><span class="line">      x += (t * (ch - <span class="string">'0'</span>));</span><br><span class="line">      ch = GetChar();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (lst == <span class="string">'-'</span>) x = -x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OPT &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">char</span> buf[L];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">qw</span><span class="params">(T x, <span class="keyword">const</span> <span class="keyword">char</span> aft = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123; x = -x, <span class="built_in">putchar</span>(<span class="string">'-'</span>); &#125;</span><br><span class="line">  <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123; buf[++top] = <span class="keyword">static_cast</span>&lt;<span class="keyword">char</span>&gt;(x % <span class="number">10</span> + <span class="string">'0'</span>); &#125; <span class="keyword">while</span> (x /= <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">while</span> (top) <span class="built_in">putchar</span>(buf[top--]);</span><br><span class="line">  <span class="keyword">if</span> (aft) <span class="built_in">putchar</span>(aft);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qwa</span><span class="params">(T *<span class="keyword">const</span> __ary, <span class="keyword">int</span> __n, <span class="keyword">const</span> <span class="keyword">char</span> e1, <span class="keyword">const</span> <span class="keyword">char</span> e2)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; __n; ++i) qw(__ary[i], e1);</span><br><span class="line">  qw(__ary[__n], e2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qws</span><span class="params">(T *p, <span class="keyword">const</span> <span class="keyword">int</span> __n, <span class="keyword">const</span> <span class="keyword">char</span> ed)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; __n; ++i) <span class="built_in">putchar</span>(p[i]);</span><br><span class="line">  <span class="keyword">if</span> (ed) <span class="built_in">putchar</span>(ed);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qws</span><span class="params">(T *p, <span class="keyword">const</span> <span class="keyword">char</span> ed)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (*p) <span class="built_in">putchar</span>(*p++);</span><br><span class="line">  <span class="keyword">if</span>(ed) <span class="built_in">putchar</span>(ed);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> IPT::qrd;</span><br><span class="line"><span class="keyword">using</span> IPT::qra;</span><br><span class="line"><span class="keyword">using</span> IPT::qrs;</span><br><span class="line"><span class="keyword">using</span> IPT::qrdb;</span><br><span class="line"><span class="keyword">using</span> OPT::qw;</span><br><span class="line"><span class="keyword">using</span> OPT::qwa;</span><br><span class="line"><span class="keyword">using</span> OPT::qws;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt; tuple&lt;<span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; ql[N], qr[N] ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">query</span>&#123;</span> <span class="keyword">int</span> id, l, r ;&#125; q[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">const</span> query &amp;a, <span class="keyword">const</span> query &amp;b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (bl[a.l] ^ bl[b.l]) ? bl[a.l] &lt; bl[b.l] : </span><br><span class="line">   ((bl[a.l] &amp; <span class="number">1</span>) ? a.r &lt; b.r : a.r &gt; b.r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> ( ; p ; p -= p &amp; -p) ret += _bit[p] ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> ( ; p &lt;= V ; p += p &amp; -p) _bit[p] ++ ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">Inssuf</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = blv[x] + <span class="number">1</span> ; i &lt;= blv[V] ; ++ i) sumb[i] ++ ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = x ; blv[x] == blv[i] &amp;&amp; i &lt;= V ; ++ i) sump[i] ++ ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">Asksuf</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sump[x] + sumb[blv[x]] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">Inspre</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= blv[x] - <span class="number">1</span> ; ++ i) sumb[i] ++ ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = x ; blv[x] == blv[i] &amp;&amp; i &gt;= <span class="number">1</span> ; -- i) sump[i] ++ ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">Askpre</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sump[x] + sumb[blv[x]] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">qrd(n), qrd(m), B = n / <span class="built_in">sqrt</span>(m) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        qrd(base[i]), tmp[i] = base[i] ;</span><br><span class="line">    sort(tmp + <span class="number">1</span>, tmp + n + <span class="number">1</span>) ;</span><br><span class="line">    L = unique(tmp + <span class="number">1</span>, tmp + n + <span class="number">1</span>) - tmp - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        base[i] = lwb(tmp + <span class="number">1</span>, tmp + L + <span class="number">1</span>, base[i]) - tmp ;</span><br><span class="line">        V = max(base[i], V) ; bl[i] = i / B ;</span><br><span class="line">    &#125;</span><br><span class="line">    B = <span class="built_in">sqrt</span>(V) + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= V ; ++ i) blv[i] = i / B + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">        s2[i] = s2[i + <span class="number">1</span>] + ask(base[i] - <span class="number">1</span>), add(base[i]) ;</span><br><span class="line">    fill(_bit, _bit + V + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        s1[i] = s1[i - <span class="number">1</span>] + i - <span class="number">1</span> - ask(base[i]), add(base[i]) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">qrd(q[i].l), qrd(q[i].r), q[i].id = i ;</span><br><span class="line">sort(q + <span class="number">1</span>, q + m + <span class="number">1</span>, comp) ; q[<span class="number">0</span>].l = <span class="number">1</span>, q[<span class="number">0</span>].r = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line"><span class="keyword">int</span> newl = q[i].l ;</span><br><span class="line"><span class="keyword">int</span> newr = q[i].r ;</span><br><span class="line"><span class="keyword">int</span> l = q[i - <span class="number">1</span>].l ;</span><br><span class="line"><span class="keyword">int</span> r = q[i - <span class="number">1</span>].r ;</span><br><span class="line">ans[i] -= s2[l] + s1[r] ;<span class="comment">//l çš„è´¡çŒ®å˜æˆäº†ä¸€ä¸ªåç¼€ï¼ŒåŸæ¥æ˜¯ l'-(l-1),ç°åœ¨å˜æˆäº† l-l'</span></span><br><span class="line">ans[i] += s2[newl] + s1[newr] ;<span class="comment">//l å’Œ r è¦åˆ†å¼€è®¡ç®—è´¡çŒ®</span></span><br><span class="line"><span class="keyword">if</span> (newl &lt; l)</span><br><span class="line">qr[newr + <span class="number">1</span>].emplace_back(newl, l - <span class="number">1</span>, -i) ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (newl &gt; l)</span><br><span class="line">qr[newr + <span class="number">1</span>].emplace_back(l, newl - <span class="number">1</span>, i) ;</span><br><span class="line"><span class="keyword">if</span> (newr &lt; r)</span><br><span class="line">ql[l - <span class="number">1</span>].emplace_back(newr + <span class="number">1</span>, r, i) ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (newr &gt; r)</span><br><span class="line">ql[l - <span class="number">1</span>].emplace_back(r + <span class="number">1</span>, newr, -i) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        Inspre(base[i]) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;j : ql[i])&#123;</span><br><span class="line"><span class="keyword">int</span> l, r, id ;</span><br><span class="line">tie(l, r, id) = j ; ll tmp = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> o = l ; o &lt;= r ; ++ o)</span><br><span class="line">                tmp += Askpre(base[o] + <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">if</span> (id &lt; <span class="number">0</span>)</span><br><span class="line">                ans[id * (<span class="number">-1</span>)] -= tmp ;</span><br><span class="line">            <span class="keyword">else</span> ans[id] += tmp ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="built_in">memset</span>(sumb, <span class="number">0</span>, <span class="keyword">sizeof</span>(sumb)) ;</span><br><span class="line">    <span class="built_in">memset</span>(sump, <span class="number">0</span>, <span class="keyword">sizeof</span>(sump)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)&#123;</span><br><span class="line">        Inssuf(base[i]) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;j : qr[i])&#123;</span><br><span class="line"><span class="keyword">int</span> l, r, id ;</span><br><span class="line">tie(l, r, id) = j ; ll tmp = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> o = l ; o &lt;= r ; ++ o)</span><br><span class="line">                tmp += Asksuf(base[o] - <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">if</span> (id &lt; <span class="number">0</span>)</span><br><span class="line">                ans[id * (<span class="number">-1</span>)] -= tmp ;</span><br><span class="line">            <span class="keyword">else</span> ans[id] += tmp ;</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) ans[i] += ans[i - <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) res[q[i].id] = ans[i] ; </span><br><span class="line">qwa(res, n, <span class="string">'\n'</span>, <span class="string">'\n'</span>) ;<span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªåºåˆ— $\{a_n\}$ï¼Œå¤šæ¬¡è¯¢é—®æŸä¸ªåŒºé—´çš„é€†åºå¯¹æ•°ã€‚&lt;/p&gt;
&lt;p&gt;$1\leq n,m\leq 10^5,|a_i|\leq 10^9$ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™è¿˜æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è®¤çœŸåšäº† lxl çš„ç”±ä¹ƒ OI é¢˜ç›®ï¼Œ233.&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="Luogu" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/Luogu/"/>
    
    
      <category term="æŠ€å·§/äºŒæ¬¡ç¦»çº¿" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E4%BA%8C%E6%AC%A1%E7%A6%BB%E7%BA%BF/"/>
    
      <category term="æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è«é˜Ÿ" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%96%B9%E6%B3%95-%E8%8E%AB%E9%98%9F/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘è«é˜ŸäºŒæ¬¡ç¦»çº¿</title>
    <link href="https://www.orchidany.cn/2020/04/11/%E8%8E%AB%E9%9A%8A%E4%BA%8C%E6%AC%A1%E9%9B%A2%E7%B7%9A/"/>
    <id>https://www.orchidany.cn/2020/04/11/è«éšŠäºŒæ¬¡é›¢ç·š/</id>
    <published>2020-04-11T03:47:01.000Z</published>
    <updated>2020-04-12T14:40:33.163Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¹‹å‰ä¸€ç›´ä»¥ä¸ºä¼šå¾ˆéš¾ï¼Œä½†åœ¨é‡å¬äº† dls è®²çš„è¯¾ä¹‹åæ„Ÿè§‰å¥½åƒæœ‰ç‚¹æ·±åˆ»ï¼Œäºæ˜¯æ‰“ç®—æ•´ç†ä¸€ä¸‹ã€‚</p><p>å¦é™„ pks è¯å…¸ï¼š</p><blockquote><p>ã€æœ‰ç‚¹æ·±åˆ»ã€ï¼šæ„Ÿè§‰å¥½åƒå¬æ˜ç™½äº†ï¼Œä½†æ˜¯è¿˜æœ‰ç»†èŠ‚æ²¡å¤ªæ‡‚ï¼Œå¦‚æœè¦æ˜¯è®©æˆ‘å†™æˆ‘è‚¯å®šå†™ä¸å‡ºæ¥ã€‚</p><p>ã€æœ‰ç‚¹ç¥å¥‡ã€ï¼šå¤§è‡´éƒ½å¬æ˜ç™½äº†ï¼Œç²¾é«“ä»€éº½çš„éƒ½ç†è§£çš„ååˆ†é€å½»ï¼Œåªæ˜¯å®ç°æ–¹é¢è¿˜æ˜¯ä¸å¤ªä¼šã€‚</p><p>ã€ ã€(æ— è¯„ä»·) ï¼šå­¦ä¼šäº†ã€‚</p></blockquote><a id="more"></a><h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p>å¤§æ¦‚æ˜¯ä¸€ç§éœ€è¦ç»´æŠ¤ä¿¡æ¯å…·æœ‰å¯å‡æ€§çš„è«é˜Ÿã€‚åªè¦å…·å¯å‡æ€§ï¼Œå°±å¯ä»¥å®¹æ–¥ï¼Œå°±å¯ä»¥äºŒæ¬¡ç¦»çº¿ã€‚æ‰€è°“ã€äºŒæ¬¡ç¦»çº¿ã€ï¼Œå¤§æ¦‚æ˜¯æŒ‡ç”±äºæ™®é€šè«é˜Ÿæ— æ³•å¿«é€Ÿè®¡ç®—è´¡çŒ®ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡ç¦»çº¿æŠŠè¯¢é—®ç¦»çº¿ä¸‹æ¥ï¼Œç¬¬äºŒæ¬¡ç¦»çº¿æŠŠè«é˜Ÿçš„è½¬ç§»è¿‡ç¨‹ç¦»çº¿ä¸‹æ¥ã€‚ç„¶åç”±äºä¿¡æ¯å…·æœ‰å¯å‡æ€§(æ¯”å¦‚å¸¸è§çš„ã€Œç‚¹å¯¹æ•°ã€)ï¼Œé‚£ä¹ˆå¯ä»¥ï¼š</p><p>è®° $(a,b)(c,d)$ è¡¨ç¤ºåŒºé—´ $[a,b]$ å†…çš„ç‚¹å’ŒåŒºé—´ $[c,d]$ å†…çš„ç‚¹å¯¹å½¼æ­¤äº§ç”Ÿçš„è´¡çŒ®(åŒºé—´å†…éƒ¨ä¸ç®—)ã€‚ </p><p>1ã€å¦‚æœ $[l,r]\to [l+t,r]$ ï¼Œé‚£ä¹ˆå¯çŸ¥ </p><script type="math/tex; mode=display">\Delta ans=\sum_{i=l}^{l+t-1} (i,i)(i+1,r)=\sum_{i=l}^{l+t-1} \left((i,i)(1,r)-(i,i)(1,i)\right)=(l,l+t-1)(1,r)-\sum_{i=l}^{l+t-1}(i,i)(1,i)</script><p>2ã€å¦‚æœ $[l,r]\to [l-t,r]$ ï¼Œé‚£ä¹ˆå¯çŸ¥</p><script type="math/tex; mode=display">\Delta ans=\sum_{i=l-t}^{l-1} (i,i)(i+1,r)=\sum_{i=l-t}^{l-1} \left((i,i)(1,r)-(i,i)(1,i)\right)=(l-t,l-1)(1,r)-\sum_{i=l-t}^{l-1}(i,i)(1,i)</script><p>3ã€å¦‚æœ $[l,r]\to [l,r+t]$ ï¼Œé‚£ä¹ˆå¯çŸ¥</p><script type="math/tex; mode=display">\Delta ans=\sum_{i=r+1}^{r+t}(i,i)(l,i-1)=\sum_{i=r+1}^{r+t}((1,i-1)(i,i)-(1,l-1)(i,i))=-(1,l-1)(r+1,r+t)+\sum_{i=r+1}^{r+t}(i,i)(1,i-1)</script><p>4ã€å¦‚æœ $[l,r]\to [l,r-t]$ ï¼Œé‚£ä¹ˆå¯çŸ¥</p><script type="math/tex; mode=display">\Delta ans=\sum_{i=r-t+1}^{r}(i,i)(l,i-1)=\sum_{i=r-t+1}^{r}((1,i-1)(i,i)-(1,l-1)(i,i))=-(1,l-1)(r-t+1,r)+\sum_{i=r-t+1}^{r}(i,i)(1,i-1)</script><p>å…¶ä¸­ $\sum$ å¹¶ä¸æ˜¯çœŸæ­£çš„ $\sum$ ï¼Œä¸åŒæƒ…å†µä¸‹éœ€è¦æŒ‰é¡ºåº(å³ä¸å†æœ‰äº¤æ¢å¾‹)ï¼Œæ¯”å¦‚ $[l,r]\to [l,r-t]$ æ—¶å°±éœ€è¦ä» $r-1$ ç®—åˆ° $r-t$ ã€‚</p><p>ç„¶åè¿™æ ·å®¹æ–¥ä¹‹åï¼Œåé¢çš„ $\sum$ å°±å¯ä»¥é¢„å¤„ç†äº†ï¼Œå‰é¢çš„ $()()$ ï¼Œç”±äºè«é˜Ÿçš„å¤æ‚åº¦ï¼Œå¯ä»¥çŸ¥é“è‡³å¤šæœ‰ $n\sqrt m$ ä¸ªä¸åŒçš„è¯¢é—®ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠæ¯ä¸€ç»„è¯¢é—®æ‰“æ ‡è®°ï¼Œæ‰“åˆ°å·¦ç«¯ç‚¹æ˜¯ $1$ çš„é‚£ä¸ªè¯¢é—®ä¸Š (æ¯”å¦‚ $[l,r]\to [l,r-t]$ å°±æ‰“åˆ° $l-1$ ä¸Š)ã€‚æœ€åæ‰«ä¸€éå…¨éƒ¨çš„ $i\in[1,n]\cap\mathbb{Z_+}$ï¼Œè¿™æ ·æœ€ç»ˆå¤æ‚åº¦ $O(n\sqrt m)$ ã€‚å¯ä»¥çœ‹å‡ºæ¯”èµ·æ™®é€šçš„è«é˜Ÿï¼ŒäºŒæ¬¡ç¦»çº¿è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯åªæœ‰ $O(n)$ æ¬¡æ’å…¥ï¼Œäºæ˜¯å¯¹äºæŸäº›é¢˜å°±å¯ä»¥ç”¨å€¼åŸŸåˆ†å—çš„æŠ€å·§åšåˆ° $O(n\sqrt m+n\sqrt n)$ ã€‚</p><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><blockquote><p>LG 4887 ç¬¬åå››åˆ†å—(å‰ä½“)</p><p>ç‚æœµè‰ç»™äº†ä½ ä¸€ä¸ªåºåˆ— $a$ï¼Œæ¯æ¬¡æŸ¥è¯¢ç»™ä¸€ä¸ªåŒºé—´ $[l,r]$ </p><p>æŸ¥è¯¢ $l \leq i&lt; j \leq r$ ,ä¸” $a_i \oplus a_j$ çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹æœ‰ $k$ ä¸ª $1$ çš„äºŒå…ƒç»„ $(i,j)$ çš„ä¸ªæ•°ã€‚$\oplus$ æ˜¯æŒ‡æŒ‰ä½å¼‚æˆ–ã€‚</p></blockquote><p>ä¼¼ä¹å°±æ˜¯æ¿å­é¢˜ï¼Œç„¶åå¯¹äº $(i,i)(1,i-1)$ å’Œ $(i,i)(1,i)$ è¿™ä¸ªä¸œè¥¿çš„é¢„å¤„ç†å¯ä»¥æ‹¿ä¸€ä¸ªæ¡¶æ¥ç»´æŠ¤ï¼Œ$buc_x$ è¡¨ç¤ºæœ‰å¤šå°‘ä¸ªæ•° $\oplus x$ ä¹‹åäºŒè¿›åˆ¶ä½æœ‰ $k$ ä¸ª $1$ ï¼Œå‰©ä¸‹çš„å°±æ˜¯æ¯”è¾ƒå…¸å‹çš„è«é˜ŸäºŒæ¬¡ç¦»çº¿äº†ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯â€¦$\binom{14}{7}=3432$ ï¼Œå†ä¹˜ä¸Šä¸€ä¸ª $10^5$ ï¼Œæ—¶é—´æ ¹æœ¬æ‰¿å—ä¸äº†â€¦æ‰€ä»¥è¿™å°±å¾ˆç¥å¿…â€¦æ‰“ç®—å†™å®Œä¹‹åå‡ºä¸ªæ•°æ®å¡ä¸€å¡ï¼Œä¸çŸ¥é“èƒ½ä¸èƒ½æˆåŠŸã€‚ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">16385</span> ; </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> B ; </span><br><span class="line"><span class="keyword">int</span> cnt ;  </span><br><span class="line">ll s1[N] ; </span><br><span class="line">ll s2[N] ; </span><br><span class="line">ll res[N] ;</span><br><span class="line">ll ans[N] ;</span><br><span class="line"><span class="keyword">int</span> bl[N] ; </span><br><span class="line"><span class="keyword">int</span> bu[N] ;</span><br><span class="line"><span class="keyword">int</span> len[M] ;</span><br><span class="line"><span class="keyword">int</span> buc[M] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ; </span><br><span class="line"><span class="keyword">int</span> n, m, k ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(ll *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;tuple&lt;<span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; qs[N] ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">query</span>&#123;</span> <span class="keyword">int</span> id, l, r ;&#125; q[N] ; </span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(query a, query b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (bl[a.l] ^ bl[b.l]) ? bl[a.l] &lt; bl[b.l] : </span><br><span class="line">   ((bl[a.l] &amp; <span class="number">1</span>) ? a.r &lt; b.r : a.r &gt; b.r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k ;</span><br><span class="line">B = <span class="number">1.0</span> * n / <span class="built_in">sqrt</span>(m) ; </span><br><span class="line"><span class="keyword">if</span> (!k) bu[++ cnt] = <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; M ; ++ i)&#123;</span><br><span class="line">len[i] = len[i - (i &amp; -i)] + <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">if</span> (len[i] == k) bu[++ cnt] = i ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) bl[i] = i / B ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ; </span><br><span class="line">s1[i] = s1[i - <span class="number">1</span>] + (ll)buc[base[i]] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)</span><br><span class="line">buc[base[i]  ^  bu[j]] += <span class="number">1</span> ; </span><br><span class="line">s2[i] = s2[i - <span class="number">1</span>] + (ll)buc[base[i]] ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; s1[i] &lt;&lt; " " &lt;&lt; s2[i] &lt;&lt; '\n' ; </span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;q[i].l, &amp;q[i].r), q[i].id = i ; </span><br><span class="line">sort(q + <span class="number">1</span>, q + m + <span class="number">1</span>, comp) ; q[<span class="number">0</span>].l = <span class="number">1</span>, q[<span class="number">0</span>].r = <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line"><span class="comment">//emplace_back </span></span><br><span class="line"><span class="keyword">int</span> newl = q[i].l ;</span><br><span class="line"><span class="keyword">int</span> newr = q[i].r ;</span><br><span class="line"><span class="keyword">int</span> l = q[i - <span class="number">1</span>].l ;</span><br><span class="line"><span class="keyword">int</span> r = q[i - <span class="number">1</span>].r ;</span><br><span class="line">ans[i] -= s2[l - <span class="number">1</span>] + s1[r] ; </span><br><span class="line">ans[i] += s2[newl - <span class="number">1</span>] + s1[newr] ;</span><br><span class="line"><span class="keyword">if</span> (newl &lt; l)</span><br><span class="line">qs[newr].emplace_back(newl, l - <span class="number">1</span>, i) ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (newl &gt; l)</span><br><span class="line">qs[newr].emplace_back(l, newl - <span class="number">1</span>, -i) ;</span><br><span class="line"><span class="keyword">if</span> (newr &lt; r) </span><br><span class="line">qs[l - <span class="number">1</span>].emplace_back(newr + <span class="number">1</span>, r, i) ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (newr &gt; r) </span><br><span class="line">qs[l - <span class="number">1</span>].emplace_back(r + <span class="number">1</span>, newr, -i) ;</span><br><span class="line">&#125;</span><br><span class="line">debug(ans, <span class="number">1</span>, m, <span class="string">'\n'</span>) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; M ; ++ i) buc[i] = <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j) </span><br><span class="line">buc[base[i] ^ bu[j]] += <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;j : qs[i])&#123;</span><br><span class="line"><span class="keyword">int</span> l, r, id ;</span><br><span class="line">tie(l, r, id) = j ; ll tmp = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> o = l ; o &lt;= r ; ++ o) tmp += buc[base[o]] ;</span><br><span class="line"><span class="keyword">if</span> (id &lt; <span class="number">0</span>) ans[id * (<span class="number">-1</span>)] -= tmp ; <span class="keyword">else</span> ans[id] += tmp ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) ans[i] += ans[i - <span class="number">1</span>] ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) res[q[i].id] = ans[i] ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, res[i]) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¡ºä¾¿ç»“æŸä¹‹åå¡äº†ä¸€ä¸‹ï¼Œå†™äº†ä¸ªè§‰å¾—è‚¯å®šå¯ä»¥å¡çš„ genï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">16383</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">7</span> ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gene_Array</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)&#123;</span><br><span class="line"><span class="keyword">int</span> i = j ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> p = j ; (i - j) &lt; M &amp;&amp; p &lt;= n ; i ++, p += <span class="number">2</span>)</span><br><span class="line">base[p] = M - (i - j), base[p + <span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">j = i ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">freopen(<span class="string">"data.in"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>) ;</span><br><span class="line">srand(time(<span class="number">0</span>)) ; <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; n &lt;&lt; <span class="string">" "</span> &lt;&lt; m &lt;&lt; <span class="string">" "</span> &lt;&lt; k &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">gene_Array() ; <span class="keyword">int</span> B = <span class="number">1.0</span> * n / <span class="built_in">sqrt</span>(m) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">printf</span>(<span class="string">"%d%c"</span>, base[i], <span class="string">" \n"</span>[i == n]) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, p = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line"><span class="keyword">if</span> (i &gt; p) p += B ;</span><br><span class="line"><span class="keyword">int</span> l = p, r = n - p / <span class="number">2</span> ;</span><br><span class="line">        l %= n, r %= n ; <span class="keyword">if</span> (r &lt; <span class="number">0</span>) r += n ;</span><br><span class="line"><span class="keyword">if</span> (l &gt; r) swap(l, r) ;</span><br><span class="line">l += rand() % (r-l+<span class="number">1</span>) ;</span><br><span class="line">r += rand() % (n-r+<span class="number">1</span>) ;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, l, r) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src="233.jpeg" alt></p><p>å…¶ä¸­ç¬¬äºŒè¡Œæ˜¯æˆ‘æ‹¿ä¸€ä¸ªè®¡æ•°å™¨ï¼Œè®°äº†ä¸€ä¸‹è¿ç®—é‡ã€‚$7e8$ èƒ½ç¨³è¿‡ $1s$ï¼Œè¿™å°±å¾ˆç¿æ™ºï¼Œæˆ‘æœç„¶è·Ÿæ—¶ä»£è„±èŠ‚äº†ã€‚</p><h1 id="ä¾‹é¢˜-amp-æ€»ç»“"><a href="#ä¾‹é¢˜-amp-æ€»ç»“" class="headerlink" title="ä¾‹é¢˜&amp;æ€»ç»“"></a>ä¾‹é¢˜&amp;æ€»ç»“</h1><blockquote><p>ç”±äºä¸ªäººæ„Ÿè§‰å¾ˆæœ‰æ•´ç†ä»·å€¼ï¼Œäºæ˜¯å†³å®šæ–°å¼€ä¸€ç¯‡æ•´ç†ï¼ˆ</p></blockquote><p>ä¹‹å‰ä¸€ç›´è§‰å¾—äºŒæ¬¡ç¦»çº¿ä¼šå¾ˆéš¾ï¼Œå­¦äº†å­¦è§‰å¾—å…¶å®è¿˜å¯ä»¥ã€‚å¹¶ä¸”æ²¡å‡†äºŒæ¬¡ç¦»çº¿è¿™ä¸ªæŠ€å·§å¯ä»¥åˆ©ç”¨åˆ°å…¶å®ƒåœ°æ–¹ï¼Ÿæˆ–è®¸å§ã€‚</p><p>è«é˜Ÿç³»åˆ—ä¼¼ä¹æ˜¯éƒ½å­¦å®Œäº†ï¼Œçˆ·çš„é’æ˜¥ç»“æŸå•¦ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰ä¸€ç›´ä»¥ä¸ºä¼šå¾ˆéš¾ï¼Œä½†åœ¨é‡å¬äº† dls è®²çš„è¯¾ä¹‹åæ„Ÿè§‰å¥½åƒæœ‰ç‚¹æ·±åˆ»ï¼Œäºæ˜¯æ‰“ç®—æ•´ç†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;å¦é™„ pks è¯å…¸ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ã€æœ‰ç‚¹æ·±åˆ»ã€ï¼šæ„Ÿè§‰å¥½åƒå¬æ˜ç™½äº†ï¼Œä½†æ˜¯è¿˜æœ‰ç»†èŠ‚æ²¡å¤ªæ‡‚ï¼Œå¦‚æœè¦æ˜¯è®©æˆ‘å†™æˆ‘è‚¯å®šå†™ä¸å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;ã€æœ‰ç‚¹ç¥å¥‡ã€ï¼šå¤§è‡´éƒ½å¬æ˜ç™½äº†ï¼Œç²¾é«“ä»€éº½çš„éƒ½ç†è§£çš„ååˆ†é€å½»ï¼Œåªæ˜¯å®ç°æ–¹é¢è¿˜æ˜¯ä¸å¤ªä¼šã€‚&lt;/p&gt;
&lt;p&gt;ã€ ã€(æ— è¯„ä»·) ï¼šå­¦ä¼šäº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://www.orchidany.cn/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="è«é˜Ÿ" scheme="https://www.orchidany.cn/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%8E%AB%E9%98%9F/"/>
    
    
      <category term="æŠ€å·§/äºŒæ¬¡ç¦»çº¿" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E4%BA%8C%E6%AC%A1%E7%A6%BB%E7%BA%BF/"/>
    
      <category term="æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è«é˜Ÿ" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%96%B9%E6%B3%95-%E8%8E%AB%E9%98%9F/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¡Œè§£ã€‘[bzoj3730]éœ‡æ³¢</title>
    <link href="https://www.orchidany.cn/2020/04/09/%E9%9C%87%E6%B3%A2/"/>
    <id>https://www.orchidany.cn/2020/04/09/éœ‡æ³¢/</id>
    <published>2020-04-09T01:12:59.000Z</published>
    <updated>2020-04-09T15:46:31.195Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>åœ¨ä¸€ç‰‡åœŸåœ°ä¸Šæœ‰ $n$ ä¸ªåŸå¸‚ï¼Œé€šè¿‡ $n-1$ æ¡æ— å‘è¾¹äº’ç›¸è¿æ¥ï¼Œå½¢æˆä¸€æ£µæ ‘çš„ç»“æ„ï¼Œç›¸é‚»ä¸¤ä¸ªåŸå¸‚çš„è·ç¦»ä¸º $1$ï¼Œå…¶ä¸­ç¬¬ $i$ ä¸ªåŸå¸‚çš„ä»·å€¼ä¸º $value_i$ã€‚</p><p>ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç‰‡åœŸåœ°å¸¸å¸¸å‘ç”Ÿåœ°éœ‡ï¼Œå¹¶ä¸”éšç€æ—¶ä»£çš„å‘å±•ï¼ŒåŸå¸‚çš„ä»·å€¼ä¹Ÿå¾€å¾€ä¼šå‘ç”Ÿå˜åŠ¨ã€‚</p><p>æ¥ä¸‹æ¥ä½ éœ€è¦åœ¨çº¿å¤„ç† $m$ æ¬¡æ“ä½œï¼š</p><p><code>0 x k</code> è¡¨ç¤ºå‘ç”Ÿäº†ä¸€æ¬¡åœ°éœ‡ï¼Œéœ‡ä¸­åŸå¸‚ä¸º $x$ï¼Œå½±å“èŒƒå›´ä¸º $k$ï¼Œæ‰€æœ‰ä¸ $x$ è·ç¦»ä¸è¶…è¿‡ $k$ çš„åŸå¸‚éƒ½å°†å—åˆ°å½±å“ï¼Œè¯¥æ¬¡åœ°éœ‡é€ æˆçš„ç»æµæŸå¤±ä¸ºæ‰€æœ‰å—å½±å“åŸå¸‚çš„ä»·å€¼å’Œã€‚</p><p><code>1 x y</code> è¡¨ç¤ºç¬¬ $x$ ä¸ªåŸå¸‚çš„ä»·å€¼å˜æˆäº† $y$ ã€‚</p><p>ä¸ºäº†ä½“ç°ç¨‹åºçš„åœ¨çº¿æ€§ï¼Œæ“ä½œä¸­çš„ $x$ã€$y$ã€$k$ éƒ½éœ€è¦å¼‚æˆ–ä½ ç¨‹åºä¸Šä¸€æ¬¡çš„è¾“å‡ºæ¥è§£å¯†ï¼Œå¦‚æœä¹‹å‰æ²¡æœ‰è¾“å‡ºï¼Œåˆ™é»˜è®¤ä¸Šä¸€æ¬¡çš„è¾“å‡ºä¸º $0$ ã€‚</p></blockquote><p>é€™é¡Œæœ‰é»è‡ªé–‰ï¼Œå„ç¨® bug èª¿äº†å¥½ä¹…ã€‚æ˜¯é»åˆ†æ¨¹æ²’éŒ¯ï¼Œä½†æ˜¯ä¼¼ä¹ä¸æ˜¯å¾ˆç°¡å–®ï¼Œæœ‰ä¸€å †ç´°ç¯€â€¦</p><p>ä¸éæœ€å¾Œå¥½åƒå¯«äº†å€‹ $\log ^3$ ï¼Œæ­»å‘½å¡å¸¸æ‰çµ¦å¡éå»ã€‚</p><p>upd: å…¶å¯¦æ˜¯å¤§å¸¸æ•¸çš„ $\log ^2$ ï¼Œä¸çŸ¥é“æˆ‘ç®—è¤‡é›œåº¦çš„æ™‚å€™åœ¨çæƒ³ä»€éº¼ã€‚</p><a id="more"></a><p>å¤§æ¦‚å°±æ˜¯å¦‚æœæ²’æœ‰ä¿®æ”¹æ“ä½œçš„è©±ï¼Œå°±æ˜¯æ¯”è¼ƒè£¸çš„é»åˆ†æ¨¹ã€‚æ–¼æ˜¯å…ˆè€ƒæ…®æ²’æœ‰ä¿®æ”¹æ“ä½œçš„æƒ…æ³ã€‚</p><p>è€ƒæ…®æ€éº¼ç¶­è­·é€™å€‹æ±è¥¿ï¼Œè‡ªç„¶æ˜¯å¸Œæœ›å°æ¯å€‹é»éƒ½è¨˜éŒ„ä¸€å€‹æ¡¶ï¼Œä½†é€™æ¨£é¡¯ç„¶ç”±æ–¼æ¯å€‹é»çš„æ·±åº¦ä¸å¯æ§ï¼Œæœ€çµ‚éœ€è¦çš„ç©ºé–“ä»£åƒ¹æ˜¯ $O(n^2)$ çš„ã€‚æ–¼æ˜¯è€ƒæ…®æ€éº¼èª¿æ•´æ¨¹çš„é«˜åº¦ä½¿å¾—æœ€çµ‚ç¸½çš„ç©ºé–“è¤‡é›œåº¦å¯ä»¥æ¥å—ï¼Œé‚£è‡ªç„¶å°±æœƒæƒ³åˆ°é»åˆ†æ²»ã€‚æ³¨æ„åˆ°é»åˆ†æ²»æ™‚ï¼Œæ¯å€‹é»åœ¨åˆ†æ²»éç¨‹ä¸­ï¼Œã€é‚è¼¯æ¨¹é«˜ã€éƒ½åªæœ‰ $\log n$ ã€‚é€™å¤§æ¦‚å°±æ˜¯ç‚ºä»€éº¼ç”¨é»åˆ†æ¨¹çš„åŸå› ã€‚</p><p>æ‰€ä»¥å°±æ˜¯å»ºå‡ºé»åˆ†æ¨¹ä¾†ï¼Œæ¯å€‹é»ç¶­è­·ä¸€å€‹ <code>vector</code> ä½œç‚ºæ¡¶ï¼Œç¶­è­·é»åˆ†æ¨¹ä¸Šå­æ¨¹å…§åˆ°ç•¶å‰é»è·é›¢ç‚º $k$ çš„é»æ¬Šå’Œã€‚é€™æ¨£å°æ–¼è©¢å•ï¼Œæ¯æ¬¡åªéœ€è¦è·³é»åˆ†æ¨¹ï¼Œç„¶å¾Œå°æ–¼æ¯å€‹ $fa$ çµ±è¨ˆ $k-dis(fa,x)$ çš„é»å°çš„æ•¸é‡å°±å¥½äº†ã€‚ä½†æ˜¯é‚„æœ‰ä¸€å€‹å•é¡Œï¼Œå°±æ˜¯å°æ–¼ä»¥ç•¶å‰ $fa$ ç‚ºæ ¹çš„é‚£äº›å­æ¨¹ï¼Œåœ¨ç®—ä¸‹ä¸€å€‹ $fa$ çš„æ™‚å€™æœƒè¢«ç®—é‡ã€‚æ–¼æ˜¯å°±è¦å†ç¶­è­·ä¸€å€‹æ¡¶ï¼Œè¡¨ç¤º $x$ å­æ¨¹å…§çš„é»ï¼Œåˆ°é»åˆ†æ¨¹ä¸Š $x$ çš„çˆ¶è¦ªçš„è·é›¢ç‚º $k$ çš„é»æ¬Šå’Œã€‚ç”±æ–¼é‚Šæ¬Šéƒ½ç‚º $1$ ï¼Œé€™å€‹æ“ä½œå°±æœƒå¾ˆæ–¹ä¾¿ã€‚</p><p>è€ƒæ…®å¦‚æœå¸¶ä¿®æ”¹ï¼Œé‚£ç„¡éå°±æ˜¯æŠŠæ¡¶æ›æˆæ¨¹ç‹€æ•¸çµ„å³å¯ã€‚é€™æ¨£è¤‡é›œåº¦å°±æœƒæ˜¯ $O(m\log ^2 n)$ çš„äº†ã€‚å¯èƒ½æˆ‘å¯«çš„æ¯”è¼ƒé†œï¼Ÿé è™•ç†æ˜¯å¸¸æ•¸ä¸å°çš„ $O(n\log ^2 n)$ ï¼Œä¼¼ä¹æ¯”å…¶ä»–äººéƒ½æ…¢èª’â€¦</p><p>ç„¶å¾Œæ˜¯ bug é›†éŒ¦ï¼š</p><p>1ã€æœ€é–‹å§‹çš„æ™‚å€™ç¶­è­·çš„æ˜¯ <strong>é»åˆ†æ¨¹</strong> ä¸Šè·é›¢ç‚º $k$ çš„é»çš„é»æ¬Šå’Œã€‚</p><p>2ã€ç„¶å¾Œæ”¹äº†æ”¹ï¼Œä½†æ˜¯æŸ¥è©¢çš„æ™‚å€™æ²’æœ‰ç¶­è­·å…©å€‹ BITï¼Œåªç¶­è­·äº†ä¸€å€‹ï¼Œç„¶å¾Œæ¸›å»çš„æ˜¯æŸ¥è©¢ $x$ çš„é»åˆ†æ¨¹å­æ¨¹å…§åˆ° $x$ è·é›¢ $\leq k-2\times dis(fa_x,x)$ çš„é»æ¬Šå’Œã€‚çœ‹ä¸Šå»æœ‰é»æ±è¥¿ï¼Œä½†å•é¡Œåœ¨æ–¼åˆ° $x$ è·é›¢å’Œåˆ° $fa_x$ è·é›¢æ²’æœ‰æœ¬è³ªä¸Šçš„é—œä¿‚â€¦æ¯”å¦‚å¯ä»¥åœ¨æ¨¹çš„å°å´ã€‚</p><p>3ã€æœ€å¾Œé‚„æ˜¯å¯«äº†å…©å€‹ BITï¼Œä½†æ˜¯èª¿äº†å¾ˆä¹…ï¼ŒåŸå› æ˜¯å‘ä¸Šè·³é‡åˆ° $dis(fa_x,x)&gt;k$ æ‡‰è©² <code>continue</code> è€Œä¸æ˜¯ <code>break</code> ï¼Œå› ç‚ºé€™è·é›¢ä¸¦æ˜¯å¯¦éš›è·é›¢ï¼Œåœ¨é»åˆ†æ¨¹ä¸Šæ²’æœ‰å–®èª¿æ€§ã€‚ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> low(x) (x &amp; (-x))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">int</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> lans ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> f[N] ;</span><br><span class="line"><span class="keyword">int</span> d[N] ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> dep[N] ;</span><br><span class="line"><span class="keyword">int</span> mx_dep ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> to ;</span><br><span class="line"><span class="keyword">int</span> next ;</span><br><span class="line">&#125;E[N * <span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"><span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; Id[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; sub[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; buc[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">to(++ cnt) = b ;</span><br><span class="line">next(cnt) = head[a] ;</span><br><span class="line">head[a] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> findCG&#123;</span><br><span class="line"><span class="keyword">int</span> grt ;</span><br><span class="line"><span class="keyword">int</span> num ;</span><br><span class="line"><span class="keyword">int</span> g[N] ;</span><br><span class="line"><span class="keyword">int</span> size[N] ;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">a = b &lt;= a ? a : b ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span></span>&#123;</span><br><span class="line">g[grt = <span class="number">0</span>] = <span class="number">19690126</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">size[x] = <span class="number">1</span> ; g[x] = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))&#123;</span><br><span class="line"><span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)])&#123;</span><br><span class="line">dfs(to(k), x) ;</span><br><span class="line">size[x] += size[to(k)] ;</span><br><span class="line">g[x] = max(g[x], size[to(k)]) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">chk(g[x], num - size[x]) ;</span><br><span class="line"><span class="keyword">if</span> (g[x] &lt; g[grt]) grt = x ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> findCG ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= x ; ++ i)</span><br><span class="line">buc[root].push_back(<span class="number">0</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> x, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> t = buc[root].size() ;</span><br><span class="line"><span class="keyword">for</span> ( ; x &lt; t ; x += low(x)) buc[root][x] += p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= buc[root].size())</span><br><span class="line">x = (<span class="keyword">int</span>)buc[root].size() - <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> ( ; x ; x -= low(x)) ret += buc[root][x] ;</span><br><span class="line"><span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">init2</span><span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= x ; ++ i)</span><br><span class="line">sub[root].push_back(<span class="number">0</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add2</span><span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> x, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> t = sub[root].size() ;</span><br><span class="line"><span class="keyword">for</span> ( ; x &lt; t ; x += low(x)) sub[root][x] += p ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">ask2</span><span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">if</span> (x &gt;= sub[root].size())</span><br><span class="line">x = (<span class="keyword">int</span>)sub[root].size() - <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> ( ; x ; x -= low(x)) ret += sub[root][x] ;</span><br><span class="line"><span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> root)</span></span>&#123;</span><br><span class="line">size[x] = <span class="number">1</span> ;</span><br><span class="line">dep[x] = dep[fa] + <span class="number">1</span> ;</span><br><span class="line">Id[root][x] = dep[x] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = head[x] ; i ; i = next(i))</span><br><span class="line"><span class="keyword">if</span> (!vis[to(i)] &amp;&amp; to(i) != fa)</span><br><span class="line">calc(to(i), x, root), size[x] += size[to(i)] ;</span><br><span class="line">mx_dep = max(dep[x], mx_dep) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> root, <span class="keyword">int</span> frt)</span></span>&#123;</span><br><span class="line">add(root, dep[x], base[x]) ;</span><br><span class="line"><span class="keyword">if</span> (frt) add2(root, Id[frt][x], base[x]) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = head[x] ; i ; i = next(i))</span><br><span class="line"><span class="keyword">if</span> (!vis[to(i)] &amp;&amp; to(i) != fa) calc2(to(i), x, root, frt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">find_tree</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> h)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> mx ; vis[x] = <span class="number">1</span> ; mx_dep = <span class="number">0</span> ; </span><br><span class="line">calc(x, <span class="number">0</span>, x), init(x, mx_dep) ; </span><br><span class="line">init2(x, h) ; mx = mx_dep ; </span><br><span class="line">calc2(x, <span class="number">0</span>, x, fa) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))&#123;</span><br><span class="line"><span class="keyword">if</span> (vis[to(k)]) <span class="keyword">continue</span> ;</span><br><span class="line">num = size[to(k)] ; reset() ;</span><br><span class="line">dfs(to(k), x) ; f[grt] = x ;</span><br><span class="line">find_tree(grt, x, mx) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> r = <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">char</span> c = getchar() ; </span><br><span class="line"><span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ; </span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">isdigit</span>(c))</span><br><span class="line">r = r * <span class="number">10</span> + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line"><span class="keyword">return</span> r ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a, b, c ; <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) base[i] = qr() ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)</span><br><span class="line">a = qr(), b = qr(), add(a, b), add(b, a) ;</span><br><span class="line">reset() ; num = n ; dfs(<span class="number">1</span>, <span class="number">0</span>) ; find_tree(grt, <span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line"><span class="keyword">while</span> (m --)&#123;</span><br><span class="line">a = qr() ; </span><br><span class="line">b = qr() ^ lans ; </span><br><span class="line">c = qr() ^ lans ;</span><br><span class="line"><span class="keyword">if</span> (!a)&#123;</span><br><span class="line"><span class="keyword">int</span> fb = f[b] ;</span><br><span class="line"><span class="keyword">int</span> ob, lb = b, df ;</span><br><span class="line">ans += ask(lb, c + <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">while</span> (fb)&#123;</span><br><span class="line">df = Id[fb][b] - <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (c - df &lt; <span class="number">0</span>)&#123;</span><br><span class="line">lb = fb, fb = f[fb] ;</span><br><span class="line"><span class="keyword">continue</span> ;</span><br><span class="line">&#125;</span><br><span class="line">ans += ask(fb, c - df + <span class="number">1</span>) ;</span><br><span class="line">ans -= ask2(lb, c - df + <span class="number">1</span>) ;</span><br><span class="line">lb = fb, fb = f[fb] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, (lans = ans)) ; </span><br><span class="line">ans = <span class="number">0</span> ; <span class="built_in">putchar</span>(<span class="string">'\n'</span>) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> ob = b ;</span><br><span class="line">add(b, <span class="number">1</span>, -base[b] + c) ;</span><br><span class="line"><span class="keyword">while</span> (f[b])&#123;</span><br><span class="line"><span class="keyword">int</span> df = Id[f[b]][ob] ;</span><br><span class="line">add(f[b], df, -base[ob] + c) ;</span><br><span class="line">add2(b, df, -base[ob] + c) ; b = f[b] ;</span><br><span class="line">&#125;</span><br><span class="line">base[ob] = c ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;åœ¨ä¸€ç‰‡åœŸåœ°ä¸Šæœ‰ $n$ ä¸ªåŸå¸‚ï¼Œé€šè¿‡ $n-1$ æ¡æ— å‘è¾¹äº’ç›¸è¿æ¥ï¼Œå½¢æˆä¸€æ£µæ ‘çš„ç»“æ„ï¼Œç›¸é‚»ä¸¤ä¸ªåŸå¸‚çš„è·ç¦»ä¸º $1$ï¼Œå…¶ä¸­ç¬¬ $i$ ä¸ªåŸå¸‚çš„ä»·å€¼ä¸º $value_i$ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç‰‡åœŸåœ°å¸¸å¸¸å‘ç”Ÿåœ°éœ‡ï¼Œå¹¶ä¸”éšç€æ—¶ä»£çš„å‘å±•ï¼ŒåŸå¸‚çš„ä»·å€¼ä¹Ÿå¾€å¾€ä¼šå‘ç”Ÿå˜åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ä½ éœ€è¦åœ¨çº¿å¤„ç† $m$ æ¬¡æ“ä½œï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;0 x k&lt;/code&gt; è¡¨ç¤ºå‘ç”Ÿäº†ä¸€æ¬¡åœ°éœ‡ï¼Œéœ‡ä¸­åŸå¸‚ä¸º $x$ï¼Œå½±å“èŒƒå›´ä¸º $k$ï¼Œæ‰€æœ‰ä¸ $x$ è·ç¦»ä¸è¶…è¿‡ $k$ çš„åŸå¸‚éƒ½å°†å—åˆ°å½±å“ï¼Œè¯¥æ¬¡åœ°éœ‡é€ æˆçš„ç»æµæŸå¤±ä¸ºæ‰€æœ‰å—å½±å“åŸå¸‚çš„ä»·å€¼å’Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;1 x y&lt;/code&gt; è¡¨ç¤ºç¬¬ $x$ ä¸ªåŸå¸‚çš„ä»·å€¼å˜æˆäº† $y$ ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä½“ç°ç¨‹åºçš„åœ¨çº¿æ€§ï¼Œæ“ä½œä¸­çš„ $x$ã€$y$ã€$k$ éƒ½éœ€è¦å¼‚æˆ–ä½ ç¨‹åºä¸Šä¸€æ¬¡çš„è¾“å‡ºæ¥è§£å¯†ï¼Œå¦‚æœä¹‹å‰æ²¡æœ‰è¾“å‡ºï¼Œåˆ™é»˜è®¤ä¸Šä¸€æ¬¡çš„è¾“å‡ºä¸º $0$ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é€™é¡Œæœ‰é»è‡ªé–‰ï¼Œå„ç¨® bug èª¿äº†å¥½ä¹…ã€‚æ˜¯é»åˆ†æ¨¹æ²’éŒ¯ï¼Œä½†æ˜¯ä¼¼ä¹ä¸æ˜¯å¾ˆç°¡å–®ï¼Œæœ‰ä¸€å †ç´°ç¯€â€¦&lt;/p&gt;
&lt;p&gt;ä¸éæœ€å¾Œå¥½åƒå¯«äº†å€‹ $\log ^3$ ï¼Œæ­»å‘½å¡å¸¸æ‰çµ¦å¡éå»ã€‚&lt;/p&gt;
&lt;p&gt;upd: å…¶å¯¦æ˜¯å¤§å¸¸æ•¸çš„ $\log ^2$ ï¼Œä¸çŸ¥é“æˆ‘ç®—è¤‡é›œåº¦çš„æ™‚å€™åœ¨çæƒ³ä»€éº¼ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¡Œè§£" scheme="https://www.orchidany.cn/categories/%E9%A1%8C%E8%A7%A3/"/>
    
      <category term="BOZJ" scheme="https://www.orchidany.cn/categories/%E9%A1%8C%E8%A7%A3/BOZJ/"/>
    
    
      <category term="æ•°æ®ç»“æ„/ç‚¹åˆ†æ ‘" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%82%B9%E5%88%86%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¡Œè§£ã€‘[bzoj4182] Shopping</title>
    <link href="https://www.orchidany.cn/2020/04/09/shopping/"/>
    <id>https://www.orchidany.cn/2020/04/09/shopping/</id>
    <published>2020-04-09T01:01:10.000Z</published>
    <updated>2020-04-09T13:04:42.793Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>é©¬ä¸Šå°±æ˜¯å°è‹—çš„ç”Ÿæ—¥äº†ï¼Œä¸ºäº†ç»™å°è‹—å‡†å¤‡ç¤¼ç‰©ï¼Œå°è‘±å…´å†²å†²åœ°æ¥åˆ°äº†å•†åº—è¡—ã€‚å•†åº—è¡—æœ‰ $n$ ä¸ªå•†åº—ï¼Œå¹¶ä¸”å®ƒä»¬ä¹‹é—´çš„é“è·¯æ„æˆäº†ä¸€æ£µæ ‘çš„å½¢çŠ¶ã€‚</p><p>ç¬¬ $i$ ä¸ªå•†åº—åªå–ç¬¬ $i$ ç§ç‰©å“ï¼Œå°è‹—å¯¹äºè¿™ç§ç‰©å“çš„å–œçˆ±åº¦æ˜¯ $w_i$ï¼Œç‰©å“çš„ä»·æ ¼ä¸º $c_i$ï¼Œç‰©å“çš„åº“å­˜æ˜¯ $d_i$ã€‚ä½†æ˜¯å•†åº—è¡—æœ‰ä¸€é¡¹å¥‡æ€ªçš„è§„å®šï¼šå¦‚æœåœ¨å•†åº— $u,v$ ä¹°äº†ä¸œè¥¿ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªå•†åº— $w$ åœ¨ $u$ åˆ° $v$ çš„è·¯å¾„ä¸Šï¼Œé‚£ä¹ˆå¿…é¡»è¦åœ¨å•†åº— $w$ ä¹°ä¸œè¥¿ã€‚å°è‘±èº«ä¸Šæœ‰ $m$ å…ƒé’±ï¼Œä»–æƒ³è¦å°½é‡è®©å°è‹—å¼€å¿ƒï¼Œæ‰€ä»¥ä»–å¸Œæœ›æœ€å¤§åŒ–å°è‹—å¯¹ä¹°åˆ°ç‰©å“çš„å–œçˆ±åº¦ä¹‹å’Œã€‚</p><p>è¿™ç§å°é—®é¢˜å¯¹äºå°è‘±æ¥è¯´å½“ç„¶ä¸åœ¨è¯ä¸‹ï¼Œä½†æ˜¯ä»–çš„èº«è¾¹æ²¡æœ‰ç”µè„‘ï¼Œäºæ˜¯ä»–æ‰“ç”µè¯ç»™åŒä¸ºOIé€‰æ‰‹çš„ä½ ï¼Œä½ èƒ½å¸®å¸®ä»–å—ï¼Ÿ</p><p>å¯¹äºå…¨éƒ¨çš„æµ‹è¯•ç‚¹ï¼Œä¿è¯ $1\leq n\le 500$ï¼Œ$1\le m\le 4000$ï¼Œ$1\le T \le 5$ï¼Œ$0\le w_i\le 4000$ï¼Œ$1\le d_i\le 100$ ã€‚</p></blockquote><a id="more"></a><p>ç„¶å¾Œå¤§æ¦‚æ˜¯æ•´ç†éçš„é¡Œç›®ï¼Œä½†å€‹äººæ„Ÿè¦ºé‚„æ˜¯æœ‰å¿…è¦å†æ•´ç†ä¸€éçš„ã€‚</p><p>é¡Œæ„å¤§æ¦‚æ˜¯èªªï¼Œåœ¨æ¨¹ä¸ŠåšèƒŒåŒ…ï¼Œä½†æ˜¯ä¸å…è¨±é¸ä¸é€£é€šçš„é»ã€‚æ®è¯´æ˜¯ç»å…¸å¥—è·¯é¢˜ï¼Œä½†æˆ‘ä¸æ˜¯å¾ˆä¼šâ€¦</p><p>å…ˆè€ƒæ…®æ¯”è¼ƒç°¡å–®çš„ $01$ èƒŒåŒ…ã€‚è€ƒæ…®ä¸€èˆ¬é€™ç¨®æƒ…æ³éœ€è¦è¨˜éŒ„ä¸€ä¸‹æ¯å€‹é»ç”¨æ²’ç”¨ï¼Œæ‰€ä»¥æ¯”è¼ƒç›´æ¥çš„æƒ³æ³•æ˜¯æšèˆ‰æ¯å€‹é»ç•¶æ ¹ï¼Œç„¶å¾Œæ±‚ä¸€å€‹ä»¥è©²é»ç‚ºæ ¹æ™‚çš„é€£é€šå¡Šå‡ºä¾†ã€‚ä½†å•é¡Œå°±åœ¨æ–¼åˆä½µå­æ¨¹çš„è¤‡é›œåº¦æ˜¯ $O(V^2)$ ï¼ˆå€‹äººè¦ºå¾—å­˜åœ¨æŸç¨®æ–¹å¼çš„ $V\log V$ åˆä½µï¼Œç•¢ç«Ÿå½¢å¼ä¸Šååˆ†çš„NTTï¼‰ã€‚ä½†é€™æ¨£å°±æ˜¯ $n^2V^2$ çš„äº†ï¼Œæ‰€ä»¥è€ƒæ…®ä¸€å€‹æ¯”è¼ƒç¶“å…¸çš„å„ªåŒ–ï¼Œåœ¨ $dfs$ åºä¸Šåšï¼Œè¨˜éŒ„ä¸€ä¸‹æ¯å€‹é»å­æ¨¹å…§ $dfs$ åºçš„æœ€å¤§å€¼ $r_i$ ã€‚å®šç¾© $f_{i,v}$ è¡¨ç¤º $i\sim n$ éƒ½è¢«è€ƒæ…®å®Œäº†ï¼Œä»£åƒ¹ç‚º $v$ æ™‚çš„çµæœã€‚è½‰ç§»çš„è©±ï¼Œå¦‚æœé¸ $i$ å°±å¾ $i+1$ ä¾†è½‰ç§»ï¼Œä¸é¸ $i$ é‚£éº¼æ•´æ£µå­æ¨¹éƒ½ä¸èƒ½é¸ï¼Œå¾ $r_i+1$ è½‰ç§»ã€‚ </p><p>ç„¶å¾Œå¦‚æœæ˜¯å¤šé‡èƒŒåŒ…çš„è©±ï¼Œå¥—ä¸€å€‹å–®èª¿éšŠåˆ—å°±å¯ä»¥åšåˆ° $n^2V$ äº†ï¼Œä½†æ˜¯å¯¦éš›ä¸Šé€™é¡Œå¾ˆæ°´ï¼Œç›´æ¥ $O(nV\max\{c_i\})$ çš„å¤šé‡èƒŒåŒ…ä¹Ÿæ²’æœ‰å•é¡Œã€‚ç„¶å¾Œå°±æ˜¯åœ¨å¯«å¤šé‡èƒŒåŒ…çš„æ™‚å€™ï¼Œç™¼ç¾äº†å¾ˆå¼±æ™ºçš„ä¸€é»ï¼Œå°±æ˜¯ã€ç‰©å“å€‹æ•¸ã€å’Œã€é«”ç©ã€å“ªä¸€å€‹å…ˆæšèˆ‰çš„å•é¡Œâ€¦</p><p>é¡¯ç„¶çš„æ˜¯æ‡‰è©²å…ˆæšèˆ‰é«”ç©ï¼Œå¦å‰‡åŒä¸€å±¤çš„ç‹€æ…‹æœƒäº’ç›¸åµŒå¥—ã€‚æ‰€ä»¥æ‡‰è©²é€™éº¼å¯«ï¼š</p><p><img src="1.png" alt></p><p>ä½†æ˜¯é‚„æœ‰å¦ä¸€ç¨®å¯«æ³•ï¼Œç”¨åˆ°äº†ã€ç‹€æ…‹å †ç–Šã€é€™å€‹ trickï¼Œé›–ç„¶è¤‡é›œåº¦ä¸è®Šä½†æ˜¯çœ‹èµ·ä¾†æ›´å¸¥ä¸€é»</p><p><img src="2.jpg" alt></p><p>ç„¶å¾Œè€ƒæ…®å¦‚ä½•æ¶ˆæ‰ä¸€å€‹ $n$ ï¼Œç™¼ç¾é€™å€‹ $dp$ å¾ˆç¬¦åˆé»åˆ†æ²»çš„ç‰¹é»ï¼Œæ¯æ¬¡å°‡åˆ†æ²»ä¸­å¿ƒä½œç‚ºæ ¹ï¼Œé‚£éº¼é¸äº†æ ¹å°±æ˜¯ç¶“éåˆ†æ²»ä¸­å¿ƒï¼Œä¸ç¶“éè·Ÿå°±æ˜¯æ²’ç¶“éåˆ†æ²»ä¸­å¿ƒã€‚æ–¼æ˜¯æœ€å¾Œçš„è¤‡é›œåº¦æ˜¯ $nV\max\{c_i\}\log n $ ã€‚</p><p>ç„¶å¾Œå°±æ˜¯å–®èª¿éšŠåˆ—å„ªåŒ–å¤šé‡èƒŒåŒ…ï¼Œæ„Ÿè¦ºé€™å€‹æ±è¥¿å¾ˆç„å¦™ï¼Œååˆ†æ·±åˆ»<del>ï¼ˆè¢« uoj ç¾¤å‹æé†’ä¹‹å¾Œç™¼ç¾ä¼¼ä¹ä¸æ˜¯å¾ˆæ·±åˆ»ï¼Œåªæ˜¯è‡ªå·±åšé¡Œå°‘ï¼‰</del>ï¼š</p><p>è€ƒè™‘åŸæœ¬çš„è½¬ç§»</p><script type="math/tex; mode=display">f_{i,j}=\max\{f_{i-1,j-k\cdot w_i}\}+k\cdot v_i\quad (1\leq k\leq c_i)</script><p>å…¶ä¸­éœ€è¦ä¼˜åŒ–æ‰çš„æ˜¯ $k$ è¿™ä¸€ç»´ï¼Œå‘ç°ä»–åŸæœ¬å¹¶æ²¡æœ‰ä»»ä½•å¯¹äºè½¬ç§»å•è°ƒçš„é™åˆ¶ï¼Œäºæ˜¯è€ƒè™‘å˜ä¸€ä¸‹å½¢ã€‚</p><p>ä»¤ $d=j\bmod w_i$ï¼Œ$s=\lfloor\frac{j}{w_i}\rfloor$ï¼Œé‚£ä¹ˆè½¬ç§»å°±å¯ä»¥å†™ä½œ</p><script type="math/tex; mode=display">f_{i,j}=\max\{f_{i-1,d+k\cdot w_i}-k\cdot v_i\}+s\cdot v_i \quad (s-k\leq c_i)</script><p>å‘ç°è½¬ç§»æ¡ä»¶ $s-k\leq c_i\Longrightarrow k\geq s-c_i=\lfloor\frac{j}{w_i}\rfloor-c_i$ ï¼Œå¯çŸ¥å°æ–¼ä¸€å€‹ç›¸åŒçš„ $i$ï¼Œä¸åŒçš„ $j$ ï¼Œè½‰ç§»å€é–“çš„å·¦ç«¯é»æ˜¯ä¸é™çš„ï¼Œäºæ˜¯å°±å¯¹æ¯ä¸ª $d$ ç”¨å•è°ƒé˜Ÿåˆ—å³å¯ã€‚</p><p>ä»”ç´°æƒ³äº†æƒ³ï¼Œå¤§æ¦‚æ˜¯é€™éº¼ä¸€å€‹æ€è€ƒéç¨‹ï¼šè§€å¯Ÿä¸Šé¢é‚£å€‹å¼å­å¯ä»¥çŸ¥é“ï¼Œæ¯æ¬¡æšèˆ‰çš„æœƒæ˜¯ä¸€äº› $w_i$ çš„å€æ•¸ï¼Œé‚£éº¼å°æ–¼ä»»æ„ä¸€å€‹ $j$ ï¼Œè½‰ç§»è·¯å¾‘è£¡æœ€åˆçš„è½‰ç§»é»å°±ä¸€å®šåœ¨ $0\sim w_i-1$ ä¸­é€²è¡Œï¼Œæ³¨æ„åˆ°é€™ä¸€é»ä¹‹å¾Œè‡ªç„¶è€ƒæ…®å°æ–¼æ¯ä¸€å€‹ $d$ åˆ†åˆ¥åšã€‚é‚£éº¼å¯ä»¥ç™¼ç¾ï¼Œå°æ–¼æ¯å€‹ $d$ è€Œè¨€ï¼Œ$d+k<em>w$ çš„è½‰ç§»é»éƒ½æ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚ $d+7</em>w$ å°±åªèƒ½å¾ $d+w,d+2\cdot w,\cdots ,d+6*w$ ä¾†è½‰ç§»ï¼ŒåŒæ™‚ç”±æ–¼æ•¸é‡ $c_i$ çš„é™åˆ¶ï¼Œå¯ä»¥çŸ¥é“å°æ–¼æ¯å€‹ $j$ åªèƒ½å¾ $\geq \lfloor\frac{j}{w_i}\rfloor-c_i$ çš„å…¶å®ƒ $j$ ä¾†è½‰ç§»ï¼Œå°±è®Šæˆäº†ä¸€å€‹å€é–“å½¼æ­¤ä¸åŒ…å«çš„è½‰ç§»å•é¡Œï¼Œé¡¯ç„¶å¯ä»¥ç”¨å–®èª¿éšŠåˆ—ä¾†å„ªåŒ–ã€‚</p><p>ç„¶å¾Œæœ€å¾Œè¤‡é›œåº¦å°±è®Šæˆäº† $O(nV\log n )$ ã€‚</p><p>æ„Ÿè¦ºé€™å€‹å–®èª¿éšŠåˆ—çš„å¯¦ç¾æœ‰å„„é»ç´°ç¯€ï¼Œå¯èƒ½éœ€è¦å†ç¢ç£¨ä¸€ä¸‹ã€‚</p><hr><p>æ€è€ƒäº†ä¸€ä¸‹ï¼Œé †ä¾¿å»å•äº† zayï¼Œç™¼ç¾é€™å€‹è½‰ç§»æœ‰é»æ±è¥¿ï¼š</p><p>1ã€ç”±æ–¼è½‰ç§»æ™‚æ˜¯è¦å¾ $i-1$ çš„ç‹€æ…‹è½‰ç§»ï¼Œä¸€é–‹å§‹åˆå§‹è³¦å€¼å®Œç•¢ä¹‹å¾Œ $i$ å°±æ˜¯ $i-1$ çš„ç‹€æ…‹äº†ã€‚é‚£éº¼æ¯æ¬¡å…¥éšŠçš„æ™‚å€™è¦ä¿è­‰æŠŠ $i-1,j$ å…¥éšŠè€Œä¸æ˜¯ $i,j$ ã€‚æ‰€ä»¥å…¥éšŠçš„æ™‚å€™è¦æ˜¯è½‰ç§»å‰çš„çµæœã€‚</p><p>2ã€æ³¨æ„åˆ°å–®èª¿éšŠåˆ—æœ‰å€‹å•é¡Œï¼Œå°±æ˜¯å…©å€‹ç«¯é»ã€å·¦é–‰å³é–‰ã€å’Œã€å·¦é–‰å³é–‹ã€ã€‚å·¦é–‰å³é–‰çš„æ™‚å€™éœ€è¦æ³¨æ„åˆ¤æ–· <code>while (h &lt;= t)</code>ï¼Œå› ç‚ºç•¶ $h=t$ çš„æ™‚å€™é‚„æœƒæœ‰å…ƒç´ åœ¨éšŠä¼ç•¶ä¸­ã€‚</p><p>3ã€å¾ˆ sb çš„ä¸€é»ï¼Œå°±æ˜¯æ‰‹å¯«éšŠåˆ—ï¼Œå¦‚æœä¸èƒ½ä¿è­‰æ¯æ¬¡ $dp$ å‰éšŠåˆ—éƒ½æ˜¯ç©ºçš„ï¼Œé‚£éº¼è½‰ç§»çš„æ™‚å€™å°±éœ€è¦åˆ¤æ–·æ˜¯å¦ç‚ºç©ºï¼Œä¸ç„¶æœƒå¾ä¸åˆæ³•çš„ç‹€æ…‹é»è½‰ç§»ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> *dp, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> d, s = u[x] - <span class="number">1</span>, o, j ;</span><br><span class="line"><span class="keyword">if</span> (s &gt; m / w[x]) s = m / w[x] ;</span><br><span class="line"><span class="keyword">for</span> (d = <span class="number">0</span> ; d &lt; w[x] ; ++ d)&#123;</span><br><span class="line">h = <span class="number">1</span> ; t = <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= (m - d) / w[x] ; ++ j)&#123;</span><br><span class="line">o = dp[j * w[x] + d] - v[x] * j ; <span class="comment">//1</span></span><br><span class="line"><span class="keyword">while</span> (h &lt;= t &amp;&amp; q[t] &lt;= o) q[t --] = <span class="number">0</span> ; <span class="comment">//2</span></span><br><span class="line"><span class="keyword">while</span> (h &lt;= t &amp;&amp; j - q2[h] &gt; s) q[h ++] = <span class="number">0</span> ;<span class="comment">//2</span></span><br><span class="line"><span class="keyword">if</span> (h &lt;= t) dp[j * w[x] + d] = q[h] + v[x] * j ;<span class="comment">//3 </span></span><br><span class="line">q[++ t] = o ; q2[t] = j ; <span class="comment">//1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„Ÿè¦ºè‡ªå·±çœŸçš„æ²’æ€éº¼å¯«éå–®èª¿éšŠåˆ—ï¼ŒåŒæ™‚ä¹Ÿå°å–®èª¿éšŠåˆ—ç†è§£çš„ä¸æ˜¯å¾ˆå¥½çš„æ¨£å­ã€‚</p><p>ç¸½ä»£ç¢¼ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> to(k) E[k].to</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> next(k) E[k].next</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">int</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1050</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> V = <span class="number">5010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T ;</span><br><span class="line"><span class="keyword">int</span> id ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> h, t ;</span><br><span class="line"><span class="keyword">int</span> u[N] ;</span><br><span class="line"><span class="keyword">int</span> v[N] ;</span><br><span class="line"><span class="keyword">int</span> w[N] ;</span><br><span class="line"><span class="keyword">int</span> q[V] ;</span><br><span class="line"><span class="keyword">int</span> q2[V] ;</span><br><span class="line"><span class="keyword">int</span> rg[N] ;</span><br><span class="line"><span class="keyword">int</span> rev[N] ;</span><br><span class="line"><span class="keyword">int</span> dfn[N] ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> f[N][V] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> to ;</span><br><span class="line"><span class="keyword">int</span> next ;</span><br><span class="line">&#125;E[N * <span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> head[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">to(++ cnt) = b ;</span><br><span class="line">next(cnt) = head[a] ;</span><br><span class="line">head[a] = cnt ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> findCG&#123;</span><br><span class="line"><span class="keyword">int</span> grt ;</span><br><span class="line"><span class="keyword">int</span> num ;</span><br><span class="line"><span class="keyword">int</span> g[N] ;</span><br><span class="line"><span class="keyword">int</span> size[N] ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">a = b &lt;= a ? a : b ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span></span>&#123;</span><br><span class="line">g[grt = <span class="number">0</span>] = <span class="number">19690126</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">size[x] = <span class="number">1</span> ; g[x] = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))&#123;</span><br><span class="line"><span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)])&#123;</span><br><span class="line">dfs(to(k), x) ;</span><br><span class="line">size[x] += size[to(k)] ;</span><br><span class="line">g[x] = max(g[x], size[to(k)]) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">chk(g[x], num - size[x]) ;</span><br><span class="line"><span class="keyword">if</span> (g[x] &lt; g[grt]) grt = x ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">findCG :: size[x] = <span class="number">1</span> ;</span><br><span class="line">dfn[x] = ++ id ; rev[id] = x ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))</span><br><span class="line"><span class="keyword">if</span> (!vis[to(k)] &amp;&amp; to(k) != fa)</span><br><span class="line">dfs(to(k), x), findCG :: size[x] += findCG :: size[to(k)] ;</span><br><span class="line">rg[x] = id ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> *dp, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> d, s = u[x] - <span class="number">1</span>, o, j ;</span><br><span class="line"><span class="keyword">if</span> (s &gt; m / w[x]) s = m / w[x] ;</span><br><span class="line"><span class="keyword">for</span> (d = <span class="number">0</span> ; d &lt; w[x] ; ++ d)&#123;</span><br><span class="line">h = <span class="number">1</span> ; t = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span> ; j &lt;= (m - d) / w[x] ; ++ j)&#123;</span><br><span class="line">o = dp[j * w[x] + d] - v[x] * j ;</span><br><span class="line"><span class="keyword">while</span> (h &lt; t &amp;&amp; q[t - <span class="number">1</span>] &lt;= o) q[t --] = <span class="number">0</span> ;</span><br><span class="line">q[t] = o ; q2[t ++] = j ;</span><br><span class="line"><span class="keyword">while</span> (h &lt; t &amp;&amp; j - q2[h] &gt; s) q[h ++] = <span class="number">0</span> ;</span><br><span class="line">dp[j * w[x] + d] = max(dp[j * w[x] + d], q[h] + v[x] * j) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">vis[x] = <span class="number">1</span> ;</span><br><span class="line">id = <span class="number">0</span> ; dfs(x, <span class="number">0</span>) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= id + <span class="number">1</span> ; ++ i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= m ; ++ j) f[i][j] = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = id ; i &gt;= <span class="number">1</span> ; -- i)&#123;</span><br><span class="line"><span class="keyword">int</span> ii = rev[i] ;</span><br><span class="line"><span class="comment">//if(x == 2) cout &lt;&lt; w[ii] &lt;&lt; " " &lt;&lt; v[ii] &lt;&lt; " " &lt;&lt; ii &lt;&lt; " " &lt;&lt; rg[ii] + 1 &lt;&lt; endl ;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = m ; j &gt;= w[ii] ; -- j) f[i][j] = f[i + <span class="number">1</span>][j - w[ii]] + v[ii] ;</span><br><span class="line">calc(f[i], ii) ; <span class="keyword">for</span> (<span class="keyword">int</span> j = m ; j &gt;= <span class="number">0</span> ; -- j) f[i][j] = max(f[i][j], f[rg[ii] + <span class="number">1</span>][j]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//cout &lt;&lt; f[1][m] &lt;&lt; endl ;</span></span><br><span class="line">ans = max(f[<span class="number">1</span>][m], ans) ;</span><br><span class="line"><span class="comment">//cout &lt;&lt; ans &lt;&lt; " " &lt;&lt; x &lt;&lt; endl ;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))&#123;</span><br><span class="line"><span class="keyword">if</span> (!vis[to(k)])&#123;</span><br><span class="line">findCG :: reset() ;</span><br><span class="line">findCG :: num = findCG :: size[to(k)] ;</span><br><span class="line">findCG :: dfs(to(k), <span class="number">0</span>) ; solve(findCG :: grt) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line"><span class="keyword">while</span> (T --)&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line"><span class="keyword">int</span> a, b ; findCG :: num = n ;</span><br><span class="line">fill(vis + <span class="number">1</span>, vis + n + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">fill(head, head + n + <span class="number">1</span>, ans = cnt = <span class="number">0</span>) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">cin</span> &gt;&gt; v[i] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">cin</span> &gt;&gt; w[i] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">cin</span> &gt;&gt; u[i] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b, add(a, b), add(b, a) ;</span><br><span class="line">findCG :: reset() ; findCG :: dfs(<span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">solve(findCG :: grt) ; <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€çµ‚è¢« zay çš„äºŒé€²åˆ¶åˆ†çµ„åŠè‘—éŒ˜ï¼Œæ„Ÿè¦ºå¾ˆä¸çˆ½ QAQ</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;é©¬ä¸Šå°±æ˜¯å°è‹—çš„ç”Ÿæ—¥äº†ï¼Œä¸ºäº†ç»™å°è‹—å‡†å¤‡ç¤¼ç‰©ï¼Œå°è‘±å…´å†²å†²åœ°æ¥åˆ°äº†å•†åº—è¡—ã€‚å•†åº—è¡—æœ‰ $n$ ä¸ªå•†åº—ï¼Œå¹¶ä¸”å®ƒä»¬ä¹‹é—´çš„é“è·¯æ„æˆäº†ä¸€æ£µæ ‘çš„å½¢çŠ¶ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ $i$ ä¸ªå•†åº—åªå–ç¬¬ $i$ ç§ç‰©å“ï¼Œå°è‹—å¯¹äºè¿™ç§ç‰©å“çš„å–œçˆ±åº¦æ˜¯ $w_i$ï¼Œç‰©å“çš„ä»·æ ¼ä¸º $c_i$ï¼Œç‰©å“çš„åº“å­˜æ˜¯ $d_i$ã€‚ä½†æ˜¯å•†åº—è¡—æœ‰ä¸€é¡¹å¥‡æ€ªçš„è§„å®šï¼šå¦‚æœåœ¨å•†åº— $u,v$ ä¹°äº†ä¸œè¥¿ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªå•†åº— $w$ åœ¨ $u$ åˆ° $v$ çš„è·¯å¾„ä¸Šï¼Œé‚£ä¹ˆå¿…é¡»è¦åœ¨å•†åº— $w$ ä¹°ä¸œè¥¿ã€‚å°è‘±èº«ä¸Šæœ‰ $m$ å…ƒé’±ï¼Œä»–æƒ³è¦å°½é‡è®©å°è‹—å¼€å¿ƒï¼Œæ‰€ä»¥ä»–å¸Œæœ›æœ€å¤§åŒ–å°è‹—å¯¹ä¹°åˆ°ç‰©å“çš„å–œçˆ±åº¦ä¹‹å’Œã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§å°é—®é¢˜å¯¹äºå°è‘±æ¥è¯´å½“ç„¶ä¸åœ¨è¯ä¸‹ï¼Œä½†æ˜¯ä»–çš„èº«è¾¹æ²¡æœ‰ç”µè„‘ï¼Œäºæ˜¯ä»–æ‰“ç”µè¯ç»™åŒä¸ºOIé€‰æ‰‹çš„ä½ ï¼Œä½ èƒ½å¸®å¸®ä»–å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¯¹äºå…¨éƒ¨çš„æµ‹è¯•ç‚¹ï¼Œä¿è¯ $1\leq n\le 500$ï¼Œ$1\le m\le 4000$ï¼Œ$1\le T \le 5$ï¼Œ$0\le w_i\le 4000$ï¼Œ$1\le d_i\le 100$ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="BZOJ" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/BZOJ/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’/å•è°ƒé˜Ÿåˆ—" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/èƒŒåŒ…æ¨¡å‹" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E8%83%8C%E5%8C%85%E6%A8%A1%E5%9E%8B/"/>
    
      <category term="æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/ç‚¹åˆ†æ²»" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%96%B9%E6%B3%95-%E7%82%B9%E5%88%86%E6%B2%BB/"/>
    
  </entry>
  
  <entry>
    <title>ã€å¬è¯¾ç¬”è®°ã€‘åˆ†å—&amp;è«é˜Ÿ&amp;æ ¹å·åˆ†æ²»</title>
    <link href="https://www.orchidany.cn/2020/04/08/%E5%88%86%E5%9D%97%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/04/08/åˆ†å—å¬è¯¾ç¬”è®°/</id>
    <published>2020-04-08T03:49:07.000Z</published>
    <updated>2020-04-14T04:39:05.569Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å•Šï¼Œå…¶å®å°±æ˜¯ä¸€ç›´å¬è¯´åˆ†å—å¾ˆnbä½†æ˜¯ä¸€ç›´æ²¡æœ‰æ·±åˆ»ç†è§£ï¼Œäºæ˜¯å°±æ•´ç†äº†ä¸€ä¸‹â€¦</p><p>è¯è¯´æˆ‘åˆ†å—å†å²ä¸Šåªå†™è¿‡ä¸€é“é¢˜â€¦è’²å…¬è‹±é‚£é¢˜â€¦å½“æ—¶å†™çš„è¿˜ä¸€å †è¯¡å¼‚çš„è¾¹ç•Œï¼Œå¯¼è‡´æˆ‘æ¯«æ— å¤ç›˜çš„æ¬²æœ›â€¦</p><p>æ—¥å¸¸ä¸æƒ³å†™æ•°æ®ç»“æ„(1/1) ã€‚</p><p>ç„¶è€Œå†…å®¹å°±æ˜¯ lxl çš„ PPT ï¼Œå€‹äººæ„Ÿè¦ºé€€å½¹ä¹‹å‰é€™å€‹ PPT æ˜¯å­¸ä¸å®Œäº†ğŸ˜­</p><a id="more"></a><p>ä¸åšèªªæ˜çš„è©±ï¼Œå…¨éƒ¨æ•¸æ“šçš„ $n,m$ éƒ½æ˜¯ $10^5$ çš„ã€‚å—å¤§å°è®°ä½œ $B$ .</p><h1 id="åºåˆ—åˆ†å—"><a href="#åºåˆ—åˆ†å—" class="headerlink" title="åºåˆ—åˆ†å—"></a>åºåˆ—åˆ†å—</h1><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><blockquote><p>ç»´æŠ¤ä¸€ä¸ªåºåˆ—ï¼Œæ”¯æŒ</p><p>1.åŒºé—´åŠ ã€‚</p><p>2.æŸ¥è¯¢åŒºé—´å°äº $x$ çš„æ•°ä¸ªæ•°ã€‚</p></blockquote><p>å¯¹äºè¯¢é—®æ“ä½œè€Œè¨€ï¼Œå¯ä»¥å‘ç°åŒºé—´åŠ ä¸å½±å“å—å†…éƒ¨çš„é¡ºåºï¼Œæ‰€ä»¥è€ƒè™‘å¯¹äºæ¯ä¸ªå—ç»´æŠ¤å—å†…å…ƒç´ æ’å®Œåºä¹‹åçš„ç»“æœï¼Œå­˜åœ¨ä¸€ä¸ªå®¹å™¨é‡Œï¼Œè®°ä¸º $ov_x$ ã€‚</p><p>å¯¹äºä¿®æ”¹æ“ä½œï¼Œæ•´å—å°±ç›´æ¥æ‰“ä¸€ä¸ª $tag_x$ ï¼Œé›¶æ•£å—ç”±äºè‡³å¤šæœ‰ä¸¤å—å—å½±å“ï¼Œäºæ˜¯è€ƒè™‘æš´åŠ›é‡æ„ã€‚æš´åŠ›é‡æ„çš„æ–¹æ³•å¤§æ¦‚æ˜¯æŒ‰é¡ºåºå°† $ov_x$ é‡Œé‚£äº›è¦è¢«åŠ çš„å…ƒç´ å–å‡ºï¼Œå¯ä»¥çŸ¥é“è¿™æ · $ov_x$ å’Œè¢«å–å‡ºçš„é‚£äº›å…ƒç´ å°±éƒ½æ˜¯æœ‰åºçš„äº†ï¼Œå¯ä»¥å½’å¹¶æ’åºåšåˆ°çº¿æ€§ã€‚æ‰€ä»¥ä¿®æ”¹å¤æ‚åº¦æ˜¯ $O(B)+O(\frac{n}{B})$ çš„ã€‚</p><p>æŸ¥è¯¢æ“ä½œï¼Œé›¶æ•£å—å½“ç„¶æ˜¯æš´åŠ› forâ€‹ ï¼Œæ•´å—çš„è¯å¯ä»¥äºŒåˆ†ï¼ŒæŸ¥è¯¢å¤æ‚åº¦ $O(B)+O(\frac{n}{B}\log B)$ ã€‚å‘ç°å¦‚æœä»¤ $B = \sqrt{n\log B}$ ï¼Œé‚£ä¹ˆæ€»å¤æ‚åº¦ä¼šå˜æˆ $O(m\sqrt{n\log B})$ ï¼Œå¯èƒ½ä¼šæ›´ä¼˜ã€‚</p><p>åŒæ—¶ä¹Ÿå¯ä»¥æŠŠè¯¢é—®å¯¹äºæ¯ä¸€å—éƒ½ç¦»çº¿ä¸‹æ¥ï¼Œå¯¹äºæ¯ä¸ªå—ï¼Œåœ¨æ¯æ¬¡é‡æ„ä¹‹å‰å¯ä»¥å›ç­”ä¸Šä¸€æ¬¡é‡æ„ä¹‹åçš„é—®é¢˜ï¼Œç”¨åŸºæ•°æ’åºæŠŠè¿™äº›è¯¢é—®æ’åºä¹‹åï¼Œå’Œå—å†…å…ƒç´ ä¸€èµ·å½’å¹¶å¯ä»¥åšåˆ°çº¿æ€§ã€‚äºæ˜¯å°±å¯ä»¥ç¦»çº¿ $O(m\sqrt n)$ äº†ã€‚</p><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><blockquote><p>ç»´æŠ¤ä¸€ä¸ªåºåˆ—ï¼Œæ”¯æŒæŸ¥è¯¢</p><p>1.åŒºé—´åŠ </p><p>2.æŸ¥è¯¢åŒºé—´kå°</p></blockquote><p>è€ƒè™‘å’Œä¸Šä¸€é“é¢˜ä¸€æ ·çš„åšæ³•ï¼Œæ¯æ¬¡å¤–å±‚å¥—ä¸€ä¸ªäºŒåˆ†ï¼Œé‚£ä¹ˆå°±æ˜¯æŸ¥è¯¢æ¯ä¸ªå—å†… $&lt;x$ çš„æ•°çš„ä¸ªæ•°ï¼Œè¿™æ ·è¿˜éœ€è¦å†äºŒåˆ†ï¼Œè¯¢é—®å¤æ‚åº¦å˜æˆäº† $O(\frac{n}{B}\log B\log V)$ ï¼Œå¹³è¡¡ä¹‹åå°±æ˜¯ $O(\sqrt{n\log B}\log V)$ã€‚</p><p>â€¦â€¦ç„¶è€Œ lxl å‡ºçš„ YNOI æŠŠè¿™ä¸ª Sol ç»™å¡äº†ã€‚</p><p>è€ƒè™‘ä¸€ä¸ª $trick$ ï¼Œå°±æ˜¯è°ƒæ•´å—çš„å¤§å°ã€‚ä»¤ $B=\sqrt n \log n$ ï¼Œé‚£ä¹ˆæ¯æ¬¡ä¿®æ”¹æ˜¾ç„¶è¿˜æ˜¯ $O(B)&gt;O(\frac{n}{B})$ çš„ï¼ŒæŸ¥è¯¢è¿˜æ˜¯ç”¨äºŒåˆ†ï¼Œä½†æ˜¯ç”±äºæ•´å—çš„æ•°é‡ä¸‹é™åˆ°äº† $O(\frac{n}{\sqrt n \log n})=O(\frac{\sqrt n}{\log n})$ ï¼Œé‚£ä¹ˆè¿™éƒ¨åˆ†å¤æ‚åº¦å°±å˜æˆäº† $O(\sqrt n\log n)$ ã€‚çœ‹ä¸Šå»å¾ˆä¸é”™ï¼Ÿä½†æ˜¯é›¶æ•£å—æŸ¥è¯¢çš„æ—¶å€™ï¼Œç”±äºæœ‰ $O(\sqrt  n\log n)$ çš„é›¶æ•£ç‚¹ï¼Œæ‰€ä»¥å¦‚æœæš´åŠ›äºŒåˆ†å°±åˆå˜æˆä¿© $\log $ äº†ã€‚ä¸è¿‡æ˜¾ç„¶è¿™äº›é›¶æ•£ç‚¹æ˜¯å¯ä»¥å½’å¹¶çš„ï¼Œäºæ˜¯è¿™éƒ¨åˆ†çš„å¤æ‚åº¦å°±å˜æˆäº† $O(\sqrt n\log n+\log n)$ ã€‚</p><p>æœ€ç»ˆæ€»å¤æ‚åº¦ $O(m\sqrt n\log n)$ ã€‚</p><h1 id="æ ¹å·å¹³è¡¡"><a href="#æ ¹å·å¹³è¡¡" class="headerlink" title="æ ¹å·å¹³è¡¡"></a>æ ¹å·å¹³è¡¡</h1><h2 id="A-1"><a href="#A-1" class="headerlink" title="A"></a>A</h2><blockquote><p>ç»´æŠ¤åºåˆ—ï¼Œè¦æ±‚ $O(1)$ ä¿®æ”¹ï¼Œ $O(\sqrt n)$ æ±‚åŒºé—´å’Œã€‚</p></blockquote><p>ä¼¼ä¹å°±æ˜¯æœ€æ°´çš„åˆ†å—é¢˜ã€‚è€ƒè™‘åˆ†å—ç»´æŠ¤å—å†…å’Œï¼Œä¿®æ”¹çš„æ—¶å€™ $O(1)$ ä¿®æ”¹ç‚¹å€¼å’Œå—å€¼ï¼Œè¯¢é—®å°±æ˜¯æœ´ç´ è¯¢é—®å³å¯ã€‚</p><h2 id="B-1"><a href="#B-1" class="headerlink" title="B"></a>B</h2><blockquote><p> ç»´æŠ¤åºåˆ—ï¼Œè¦æ±‚ $O(\sqrt n)$  ä¿®æ”¹ï¼Œ $O(1)$ æ±‚åŒºé—´å’Œã€‚</p></blockquote><p>è¿™ä¸ªæ¯”è¾ƒæœ‰æ„æ€ã€‚å‘ç°è¦æ±‚ $O(1)$ æ±‚åŒºé—´å’Œï¼Œé‚£è‡ªç„¶å°±æ˜¯è¦ç»´æŠ¤å‰ç¼€å’Œã€‚äºæ˜¯å°±åˆ†åˆ«ç»´æŠ¤å—çš„å‰ç¼€å’Œ and å—å†…éƒ¨çš„å‰ç¼€å’Œï¼Œæ¯æ¬¡ä¿®æ”¹å°±æ˜¯è¦ä¿®æ”¹ä¹‹åçš„å—çš„å‰ç¼€å’Œ and æ•£ç‚¹æ‰€åœ¨å—å†…éƒ¨çš„å‰ç¼€å’Œï¼ŒæŸ¥è¯¢ä½œå·®å³å¯ã€‚</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><blockquote><p>ç»´æŠ¤åºåˆ—ï¼Œè¦æ±‚ $O(\sqrt n)$ åŒºé—´åŠ ï¼Œ$O(1)$ è¯¢é—®å•ç‚¹ã€‚</p></blockquote><p>æ”¹æˆç»´æŠ¤å·®åˆ†å°±å˜æˆ B çš„å†…å®¹äº†ã€‚</p><h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><blockquote><p>ç»´æŠ¤åºåˆ—ï¼Œè¦æ±‚ $O(1)$ åŒºé—´åŠ ï¼Œ$O(\sqrt n)$ è¯¢é—®å•ç‚¹ã€‚</p></blockquote><p>ç»´æŠ¤å·®åˆ†ï¼Œå°±å˜æˆ A äº†â€¦è¿™ä¸€æ³¢ï¼Œè¿™ä¸€æ³¢æ•´ç†é¡ºåºæ²¡æœ‰å†³ç­–å•è°ƒæ€§ï¼ˆé›¾ï¼‰ã€‚</p><h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><blockquote><p>ç»´æŠ¤ä¸€ä¸ªé›†åˆï¼Œæ”¯æŒ $O(1)$ æ’å…¥ä¸€ä¸ªæ•°ï¼Œ$O(\sqrt n)$ æŸ¥è¯¢ $k$ å°ã€‚</p></blockquote><p>å¤§æ¦‚å°±æ˜¯è€ƒè™‘å€¼åŸŸåˆ†å—ã€‚è€ƒè™‘æŠŠæ‰€æœ‰æ•°å­—ç¦»æ•£åŒ–ä¹‹åæ˜¯ $1\sim m$ ï¼Œç„¶åæŒ‰ç…§å€¼åŸŸåˆ†å—ï¼Œå¯¹äºæ¯ä¸ªå—è®°å½•ä¸€ä¸‹è¿™æ®µå€¼åŸŸå‡ºç°äº†å¤šå°‘ä¸ªæ•°ï¼Œæ¯ä¸ªä½ç½®å‡ºç°äº†å¤šå°‘ä¸ªæ•°ã€‚æ’å…¥å°±æ˜¯åœ¨å¯¹åº”ä½ç½® $+1$ï¼Œè¿™ä¸ªå— $+1$ï¼Œè¯¢é—®å°±æ˜¯ forforforã€‚</p><p>ä¼¼ä¹æœ‰ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯å¦‚æœå€¼åŸŸ $1e9$ å¯èƒ½è¦å¤šä¸€ä¸ªäºŒåˆ†çš„ logã€‚å¦‚æœä¸å¼ºåˆ¶åœ¨çº¿å¯ä»¥æŠŠè¯¢é—®ä¸€èµ·ç¦»æ•£åŒ–ï¼Œä½†æ˜¯å¦‚æœå¼ºåˆ¶åœ¨çº¿å¯èƒ½å°±å¿…é¡»è¦äºŒåˆ†äº†ã€‚</p><h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><blockquote><p>ç»´æŠ¤ä¸€ä¸ªé›†åˆï¼Œæ”¯æŒ $O(\sqrt n)$ æ’å…¥ä¸€ä¸ªæ•°ï¼Œ$O(1)$ æŸ¥è¯¢ $k$ å°ã€‚</p></blockquote><p>è¿˜æ˜¯æŒ‰å€¼åŸŸåˆ†å—ã€‚åŒæ—¶ç»´æŠ¤æ¯ä¸ªå—çš„ $ov$ã€‚</p><p>é‚£ä¹ˆå¦‚æœè¦æ’å…¥ä¸€ä¸ªæ•°ï¼Œé‚£ä¹ˆé‚£ä¸ªå—æœ¬èº«éœ€è¦é‡æ„ï¼Œç„¶åå¯¹äºè¿™ä¹‹åçš„æ‰€æœ‰æ•°éƒ½éœ€è¦åç§»ä¸€ä½ï¼Œç›¸å½“äºæ¯æ¬¡æ¯ä¸ªå—å¤´éƒ¨åˆ ä¸€ä¸ªå…ƒç´ ï¼Œå°¾éƒ¨åŠ å…¥ä¸€ä¸ªå…ƒç´ ã€‚æŸ¥è¯¢çš„æ—¶å€™ç›´æ¥å®šä½åˆ°é‚£ä¸ªå—å³å¯ã€‚</p><p>å®ç°æ–¹é¢ï¼Œæ¯ä¸ªå—çš„ $ov$ æ‹¿ä¸€ä¸ªæ”¯æŒåŒç«¯åˆ æ’çš„å®¹å™¨å³å¯ã€‚è¿™é¢˜çš„å…³é”®ç‚¹å°±åœ¨äºè¦ä¿è¯å‰ $k$ ä¸ªå—çš„å¤§å°å¯ä»¥å¿«é€ŸæŸ¥è¯¢ï¼Œé‚£ä¹ˆä»¤æ¯ä¸ªå—çš„å¤§å°ç›¸åŒå°±æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚</p><h2 id="CodeChef-Chef-and-Churu"><a href="#CodeChef-Chef-and-Churu" class="headerlink" title="[CodeChef] Chef and Churu"></a>[CodeChef] Chef and Churu</h2><blockquote><p>ç»™ $n$ ä¸ªæ•°ï¼Œç»™å®š $m$ ä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°ä¸ºåºåˆ—ä¸­ç¬¬ $l_i$ åˆ°ç¬¬ $r_i$ ä¸ªæ•°çš„å’Œã€‚æœ‰ $q$ ä¸ªè¯¢é—®ï¼Œä¸¤ç§ç±»å‹çš„æ“ä½œï¼š</p><p><code>1 x y</code> æŠŠåºåˆ—ä¸­çš„ç¬¬ $x$ ä¸ªæ•°æ”¹ä¸º $y$ ã€‚</p><p><code>2 x y</code> æ±‚ç¬¬ $x$ ä¸ªå‡½æ•°åˆ°ç¬¬ $y$ ä¸ªå‡½æ•°çš„å’Œã€‚</p></blockquote><p>ä¸€çœ¼æ„Ÿè§‰æ˜¯ä»€ä¹ˆ CDQ ğŸ‚ğŸºé¢˜.jpg</p><p>è‰ï¼ŒçŸ¥é“æ­£è§£çš„æˆ‘çœ¼æ·šæ‰ä¸‹ä¾†ï¼Œæ„Ÿè¦ºå¥½ç¥ä»™å•Šã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘è¿™äº›å‡½æ•°éƒ½æ˜¯é™æ€çš„ï¼Œæ‰€ä»¥å¯ä»¥å¯¹å‡½æ•°åˆ†å—ï¼Œç„¶åç»´æŠ¤å‰ $i$ ä¸ªå‡½æ•°é‡Œé¢ï¼Œåºåˆ—ä¸Šæ¯ä¸ªå…ƒç´ è¦è¢«ç®—å¤šå°‘æ¬¡ï¼Œå¹¶ä¸”ç»´æŠ¤å‰ç¼€å‡½æ•°çš„ç­”æ¡ˆå’Œã€‚é‚£ä¹ˆæ¯æ¬¡ä¿®æ”¹åªéœ€è¦ $\frac{n}{B}$ åœ°ä¿®æ”¹æ¯ä¸ªå‰ç¼€å’Œå³å¯ã€‚è¯¢é—®çš„æ—¶å€™ï¼Œæ•´å—å°±æ˜¯ç›´æ¥æ‹¿å‰ç¼€å’Œä½œå·®ï¼Œå¯¹äºæ•£ç‚¹è€Œè¨€ï¼Œè€ƒè™‘è‡³å¤šæ˜¯ $O(B)$ æ¬¡æŸ¥è¯¢ï¼Œæ¯æ¬¡æŸ¥è¯¢æœ¬è´¨ä¸Šæ˜¯å¯¹åºåˆ—ä¸Šä¸€ä¸ªåŒºé—´çš„æŸ¥è¯¢ã€‚æ‰€ä»¥ç”¨é‚£ä¸ª $O(\sqrt n)$ å•ç‚¹ä¿®æ”¹ $O(1)$ æŸ¥è¯¢åŒºé—´å’Œçš„æ–¹å¼ï¼Œå³ B ä¸­çš„æŠ€å·§å°±å¥½äº†ã€‚</p><p>æœ€ç»ˆå¤æ‚åº¦ $O(m\sqrt n)$ ã€‚ </p><h1 id="è«é˜Ÿ"><a href="#è«é˜Ÿ" class="headerlink" title="è«é˜Ÿ"></a>è«é˜Ÿ</h1><h2 id="AHOI2013-ä½œä¸š"><a href="#AHOI2013-ä½œä¸š" class="headerlink" title="[AHOI2013]ä½œä¸š"></a>[AHOI2013]ä½œä¸š</h2><blockquote><p>æŸ¥è¯¢åŒºé—´ $[l,r]$ ä¸­å€¼åœ¨ $[a,b]$ å†…çš„ä¸åŒæ•°ä¸ªæ•°</p><p>$n \leq 10^5 , m \leq 10^5$</p></blockquote><p>è€ƒè™‘ç›´æ¥è«é˜Ÿçš„è¯ï¼Œéœ€è¦æ”¯æŒæŸ¥è¯¢æŸä¸ªå€¼åŸŸä¸­çš„æ•°ï¼Œéœ€è¦ä¸Šæ ‘çŠ¶æ•°ç»„ï¼Œä½†è¿™æ ·å¸¦ $\log$ ã€‚</p><p>äºæ˜¯è€ƒè™‘ä¸€ä¸‹è«é˜Ÿçš„æœ¬è´¨ï¼Œå³è«é˜Ÿçš„å¤æ‚åº¦åˆ†æï¼Œæœ¬è´¨ä¸Šåˆ†æçš„æ˜¯ $l,r$ ç§»åŠ¨çš„å¤æ‚åº¦ï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹çš„å¤æ‚åº¦ã€‚æ‰€ä»¥è«é˜Ÿå¯ä»¥æœ¬è´¨ä¸Šçœ‹æˆä¸€ä¸ª $O(n\sqrt m)$ ä¿®æ”¹ï¼Œ$O(m)$ è¯¢é—®çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ç”¨ä¸€ä¸ªå¯ä»¥å¿«é€Ÿä¿®æ”¹ï¼Œä½é€ŸæŸ¥è¯¢çš„ ds æ¥ç»´æŠ¤å€¼åŸŸï¼Œé‚£è¿™è‡ªç„¶å°±æ˜¯å€¼åŸŸåˆ†å—ï¼Œæœ€ç»ˆå¤æ‚åº¦ $O(n\sqrt m+m\sqrt n)$ ã€‚</p><p>ç„¶åæœ¬é¢˜éœ€è¦åˆ†åˆ«ç»´æŠ¤å‡ºç°æ¬¡æ•°å’Œæ˜¯å¦å‡ºç°ï¼Œåˆ†åˆ«ç»´æŠ¤å³å¯ã€‚</p><p>ä¸è¿‡è¯è¯´å›æ¥ï¼Œè¿™ä¸œè¥¿æœ¬è´¨ä¸Šç­‰ä»·äºæŸ¥è¯¢ $pre_x&lt;l,pos_x\in[l,r],x\in[a,b]$ çš„è¿™æ ·çš„ $x$ çš„ä¸ªæ•°ã€‚é‚£ä¹ˆè¿™å°±æ˜¯ä¸€ä¸ªä¸‰ç»´æ•°ç‚¹ï¼ŒCDQ å¥—æ ‘çŠ¶æ•°ç»„å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> B ; </span><br><span class="line"><span class="keyword">int</span> V ; </span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> bl[N] ;</span><br><span class="line"><span class="keyword">int</span> blv[N] ;</span><br><span class="line"><span class="keyword">int</span> res[N] ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> sum[N] ;</span><br><span class="line"><span class="keyword">int</span> sumr[N] ;</span><br><span class="line"><span class="keyword">int</span> sump[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">query</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> id ; </span><br><span class="line"><span class="keyword">int</span> l, r ; </span><br><span class="line"><span class="keyword">int</span> a, b ; </span><br><span class="line">&#125;q[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(query a, query b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (bl[a.l] ^ bl[b.l]) ? bl[a.l] &lt; bl[b.l] : </span><br><span class="line">   ((bl[a.l] &amp; <span class="number">1</span>) ? a.r &lt; b.r : a.r &gt; b.r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">sump[base[p]] -- ; </span><br><span class="line">sumr[blv[base[p]]] -- ;</span><br><span class="line"><span class="keyword">if</span> (sump[base[p]] &lt;= <span class="number">0</span>) -- sum[blv[base[p]]]  ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">sump[base[p]] ++ ; </span><br><span class="line">sumr[blv[base[p]]] ++ ; </span><br><span class="line"><span class="keyword">if</span> (sump[base[p]] &lt;= <span class="number">1</span>) ++ sum[blv[base[p]]]  ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_ans</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span> ; </span><br><span class="line">r = min(r, V) ; </span><br><span class="line"><span class="keyword">if</span> (l &gt; V) <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">int</span> nl = blv[l] + <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">int</span> nr = blv[r] - <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (blv[l] == blv[r])&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">ret += (<span class="keyword">bool</span>)sump[i] ; <span class="keyword">return</span> ret ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = nl ; i &lt;= nr ; ++ i) ret += sum[i] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l ; blv[i] == blv[l] &amp;&amp; l &lt;= V ; ++ i) ret += (<span class="keyword">bool</span>)sump[i] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = r ; blv[i] == blv[r] &amp;&amp; r &gt;= <span class="number">0</span> ; -- i) ret += (<span class="keyword">bool</span>)sump[i] ;</span><br><span class="line"><span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_res</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ret = <span class="number">0</span> ; </span><br><span class="line">r = min(r, V) ; </span><br><span class="line"><span class="keyword">if</span> (l &gt; V) <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">int</span> nl = blv[l] + <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">int</span> nr = blv[r] - <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (blv[l] == blv[r])&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i)</span><br><span class="line">ret += sump[i] ; <span class="keyword">return</span> ret ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = nl ; i &lt;= nr ; ++ i) ret += sumr[i] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = l ; blv[i] == blv[l] &amp;&amp; l &lt;= V ; ++ i) ret += sump[i] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = r ; blv[i] == blv[r] &amp;&amp; r &gt;= <span class="number">0</span> ; -- i) ret += sump[i] ;</span><br><span class="line"><span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; </span><br><span class="line">B = <span class="number">1.0</span> * n / <span class="built_in">sqrt</span>(m) + <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), V = max(V, base[i]), bl[i] = i / B ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;q[i].l, &amp;q[i].r, &amp;q[i].a, &amp;q[i].b), q[i].id = i ; </span><br><span class="line">sort(q + <span class="number">1</span>, q + m + <span class="number">1</span>, comp) ; </span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">0</span> ; B = <span class="built_in">sqrt</span>(V) + <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= V ; ++ i) blv[i] = i / B ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line"><span class="keyword">int</span> a = q[i].a, b = q[i].b ; </span><br><span class="line"><span class="keyword">while</span> (l &lt; q[i].l) del(l ++) ; </span><br><span class="line"><span class="keyword">while</span> (l &gt; q[i].l) add(-- l) ; </span><br><span class="line"><span class="keyword">while</span> (r &lt; q[i].r) add(++ r) ;</span><br><span class="line"><span class="keyword">while</span> (r &gt; q[i].r) del(r --) ;</span><br><span class="line">res[q[i].id] = get_res(a, b) ;</span><br><span class="line">ans[q[i].id] = get_ans(a, b) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, res[i], ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="AT1219-æ­´å²ã®ç ”ç©¶"><a href="#AT1219-æ­´å²ã®ç ”ç©¶" class="headerlink" title="AT1219 æ­´å²ã®ç ”ç©¶"></a>AT1219 æ­´å²ã®ç ”ç©¶</h2><blockquote><p>çµ¦å®šåºåˆ—ï¼Œå®šä¹‰ $v_x$ ä¸º $x$ åœ¨åŒºé—´ $[l,r]$ ä¸­çš„å‡ºç°æ¬¡æ•°ï¼ŒæŸ¥è¯¢ä¸€ä¸ªåŒºé—´ä¸­æœ€å¤§çš„ $x\times v_x$ ã€‚</p></blockquote><p>ç™¼ç¾å°±æ˜¯è«éšŠï¼Œç„¶å¾Œè¦æ±‚æŸ¥è©¢æŸå€‹æ•¸çš„å‡ºç¾æ¬¡æ•¸ï¼Œè·Ÿä¸Šé¢ã€ä½œæ¥­ã€é‚£å€‹é¡Œä¸€æ¨£ï¼Œç›´æ¥å°å€¼åŸŸåˆ†å¡Šå°±å¥½äº†ã€‚</p><p>é è™•ç†èµ·ä¾†ä¼¼ä¹ä¹Ÿä¸æ˜¯å¾ˆé›£çš„æ¨£å­ï¼Œå°æ¯å€‹ $k\times x~(k=1,2,3,\cdots,cnt_x)$ æ”¾åˆ°ä¸€èµ·é›¢æ•£åŒ–å°±å¥½äº†ã€‚ äºæ˜¯æœ€åå¤æ‚åº¦æ˜¯ $O(n\sqrt m+m\sqrt n)$ ã€‚å› ä¸ºæ»¥ç”¨ <code>vector</code> ä»¥åŠ cache ååˆ†ä¸å‹å¥½å¯¼è‡´æ…¢çš„ä¸€åŒ¹ï¼Œç”¨äº† zay çš„å¿«è¯»ä¹Ÿæ¯›ç”¨æ²¡æœ‰/dkã€‚</p><p>å®ç°ç»†èŠ‚ï¼š</p><p>1ã€æŒ‰ç…§å¹³å¸¸è«é˜Ÿçš„å†™æ³•ï¼Œå¦‚æœå…ˆ <code>del</code> å† <code>add</code> ä¼šå‡ºç°æŸäº›æ•°å‡ºç°äº†è´Ÿæ•°æ¬¡ï¼Œè§£å†³æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œåˆ¤ä¸€ä¸‹å°±å¥½äº†ã€‚</p><p>2ã€ååˆ†ç¥å¿…çš„ä¸€ç‚¹ï¼Œä¸€å¼€å§‹æˆ‘æŠŠå¯¹æ¯ä¸ªç‚¹æ ‡å·æ”¾åˆ°äº†å¯¹è¯¢é—®æ’åºçš„åé¢ï¼Œæ‰€ä»¥ T äº†åŠå¤©ï¼Œå¹¶ä¸”è‡ªå·±ä»¥ä¸ºæ˜¯ç¼“å†²åŒºæº¢å‡ºçš„é”…â€¦</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> G++ optimize(fast)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(fast)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lwb lower_bound</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> upb upper_bound</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vint vector <span class="meta-string">&lt;int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mint map <span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> minttoll map <span class="meta-string">&lt;int, ll&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> v, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; v ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(ll *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> v, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; v ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">int</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> v, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; v ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IPT &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">1</span> &lt;&lt; <span class="number">21</span>;</span><br><span class="line"><span class="keyword">char</span> buf[L], *front=buf, *end=buf;</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">GetChar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (front == end) end = buf + fread(front = buf, <span class="number">1</span>, L, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">return</span> (front == end) ? <span class="number">-1</span> : *(front++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">qr</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> ch = GetChar(), lst = x = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch)) lst = ch, ch = GetChar();</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch)) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = GetChar();</span><br><span class="line">  <span class="keyword">if</span> (lst == <span class="string">'-'</span>) x = -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qra</span><span class="params">(T *<span class="keyword">const</span> __ary, <span class="keyword">int</span> __n)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= __n; ++i) qr(__ary[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qrs</span><span class="params">(T *p)</span> </span>&#123;</span><br><span class="line">  T *beg = p;</span><br><span class="line">  <span class="keyword">do</span> *p = GetChar(); <span class="keyword">while</span> (!<span class="built_in">isalnum</span>(*p));</span><br><span class="line">  <span class="keyword">do</span> *(++p) = GetChar(); <span class="keyword">while</span> (<span class="built_in">isalnum</span>(*p));</span><br><span class="line">  *p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> p - beg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qrdb</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> ch = GetChar(), lst = x = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch)) lst = ch, ch = GetChar();</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch)) &#123; x = x * <span class="number">10</span> + (ch - <span class="string">'0'</span>); ch = GetChar(); &#125;</span><br><span class="line">  <span class="keyword">if</span> (ch == <span class="string">'.'</span>) &#123;</span><br><span class="line">    ch = GetChar();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span> t = <span class="number">0.1</span>; <span class="built_in">isdigit</span>(ch); t *= <span class="number">0.1</span>) &#123;</span><br><span class="line">      x += (t * (ch - <span class="string">'0'</span>));</span><br><span class="line">      ch = GetChar();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (lst == <span class="string">'-'</span>) x = -x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OPT &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">char</span> buf[L];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">qw</span><span class="params">(T x, <span class="keyword">const</span> <span class="keyword">char</span> aft = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123; x = -x, <span class="built_in">putchar</span>(<span class="string">'-'</span>); &#125;</span><br><span class="line">  <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123; buf[++top] = <span class="keyword">static_cast</span>&lt;<span class="keyword">char</span>&gt;(x % <span class="number">10</span> + <span class="string">'0'</span>); &#125; <span class="keyword">while</span> (x /= <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">while</span> (top) <span class="built_in">putchar</span>(buf[top--]);</span><br><span class="line">  <span class="keyword">if</span> (aft) <span class="built_in">putchar</span>(aft);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qwa</span><span class="params">(T *<span class="keyword">const</span> __ary, <span class="keyword">int</span> __n, <span class="keyword">const</span> <span class="keyword">char</span> e1, <span class="keyword">const</span> <span class="keyword">char</span> e2)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; __n; ++i) qw(__ary[i], e1);</span><br><span class="line">  qw(__ary[__n], e2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qws</span><span class="params">(T *p, <span class="keyword">const</span> <span class="keyword">int</span> __n, <span class="keyword">const</span> <span class="keyword">char</span> ed)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; __n; ++i) <span class="built_in">putchar</span>(p[i]);</span><br><span class="line">  <span class="keyword">if</span> (ed) <span class="built_in">putchar</span>(ed);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qws</span><span class="params">(T *p, <span class="keyword">const</span> <span class="keyword">char</span> ed)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (*p) <span class="built_in">putchar</span>(*p++);</span><br><span class="line">  <span class="keyword">if</span>(ed) <span class="built_in">putchar</span>(ed);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> IPT::qr;</span><br><span class="line"><span class="keyword">using</span> IPT::qra;</span><br><span class="line"><span class="keyword">using</span> IPT::qrs;</span><br><span class="line"><span class="keyword">using</span> IPT::qrdb;</span><br><span class="line"><span class="keyword">using</span> OPT::qw;</span><br><span class="line"><span class="keyword">using</span> OPT::qwa;</span><br><span class="line"><span class="keyword">using</span> OPT::qws;</span><br><span class="line"><span class="keyword">int</span> B ; </span><br><span class="line"><span class="keyword">int</span> L ; </span><br><span class="line"><span class="keyword">int</span> V ; </span><br><span class="line">ll res ;</span><br><span class="line">ll t[N] ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> n, m ; </span><br><span class="line"><span class="keyword">int</span> g[N] ;</span><br><span class="line"><span class="keyword">int</span> bl[N] ;</span><br><span class="line">ll ans[M] ;</span><br><span class="line"><span class="keyword">int</span> vl[N] ; </span><br><span class="line"><span class="keyword">int</span> vr[N] ; </span><br><span class="line"><span class="keyword">int</span> buc[M] ;</span><br><span class="line"><span class="keyword">int</span> tmp[N] ; </span><br><span class="line"><span class="keyword">int</span> blv[N] ; </span><br><span class="line"><span class="keyword">int</span> sumb[N] ; </span><br><span class="line"><span class="keyword">int</span> sump[N] ;</span><br><span class="line">minttoll su ;</span><br><span class="line">mint bu, vu ;</span><br><span class="line">vint base[N] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">query</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> id ; </span><br><span class="line">    <span class="keyword">int</span> l, r ;</span><br><span class="line">&#125;q[M] ;  </span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">const</span> query &amp;a, <span class="keyword">const</span> query &amp;b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (bl[a.l] ^ bl[b.l]) ? bl[a.l] &lt; bl[b.l] : </span><br><span class="line">   ((bl[a.l] &amp; <span class="number">1</span>) ? a.r &lt; b.r : a.r &gt; b.r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;p)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (buc[tmp[p]] &lt; <span class="number">0</span>)&#123;</span><br><span class="line">++ buc[tmp[p]] ; <span class="keyword">return</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> lval = base[tmp[p]][buc[tmp[p]]] ;</span><br><span class="line"><span class="keyword">int</span> val = base[tmp[p]][++ buc[tmp[p]]] ; </span><br><span class="line"><span class="comment">//cout &lt;&lt; val &lt;&lt; " " &lt;&lt; lval &lt;&lt; endl ; </span></span><br><span class="line">sump[val] ++ ; sumb[ blv[val] ] ++ ;</span><br><span class="line">sump[lval] -- ; sumb[ blv[lval] ] -- ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;p)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (buc[tmp[p]] &lt;= <span class="number">0</span> )&#123;</span><br><span class="line">-- buc[tmp[p]] ; <span class="keyword">return</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//if (buc[tmp[p]] + 1 &gt;= base[tmp[p]].size()) cout &lt;&lt; base &lt;&lt;buc[tmp[p]] &lt;&lt; " " &lt;&lt; p &lt;&lt; ' ' &lt;&lt; tmp[p] &lt;&lt;'\n', exit(0) ; </span></span><br><span class="line"><span class="keyword">int</span> lval = base[tmp[p]][buc[tmp[p]]] ;</span><br><span class="line"><span class="keyword">int</span> val = base[tmp[p]][-- buc[tmp[p]]] ; </span><br><span class="line">sump[val] ++ ; sumb[ blv[val] ] ++ ;</span><br><span class="line">sump[lval] -- ; sumb[ blv[lval] ] -- ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">ask</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ob = <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> b = blv[V] ; b &gt;= <span class="number">0</span> ; -- b)</span><br><span class="line"><span class="keyword">if</span> (sumb[b] &gt; <span class="number">0</span>) &#123; ob = b ; <span class="keyword">break</span> ; &#125; <span class="keyword">if</span> (!ob) <span class="keyword">return</span> <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> p = vr[ob] ; p &gt;= vl[ob] ; -- p) <span class="keyword">if</span> (sump[p]) <span class="keyword">return</span> p ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    qr(n) ; qr(m) ; B = n / <span class="built_in">sqrt</span>(m) ;  </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) qr(g[i]) ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) </span><br><span class="line">bu[g[i]] ++, t[++ cnt] = <span class="number">1l</span>l * g[i] * bu[g[i]] ;</span><br><span class="line"><span class="comment">//debug(t, 1, cnt, ' ', '\n') ;</span></span><br><span class="line">sort(t + <span class="number">1</span>, t + cnt + <span class="number">1</span>) ; bu.clear() ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">bl[i] = i / B ; bu[g[i]] ++ ; <span class="keyword">int</span> w ; </span><br><span class="line">w = upb(t + <span class="number">1</span>, t + cnt + <span class="number">1</span>, <span class="number">1l</span>l * g[i] * bu[g[i]]) - t - <span class="number">1</span> ;</span><br><span class="line"><span class="comment">//cout &lt;&lt; g[i] &lt;&lt; " " &lt;&lt; w &lt;&lt; '\n' ;</span></span><br><span class="line"><span class="keyword">if</span> (bu[g[i]] == <span class="number">1</span>)&#123;</span><br><span class="line">base[w].push_back(<span class="number">0</span>) ; </span><br><span class="line">base[w].push_back(w) ; vu[g[i]] = w ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> base[vu[g[i]]].push_back(w) ; V = max(V, w) ;  </span><br><span class="line">su[w] = <span class="number">1l</span>l * g[i] * bu[g[i]] ; t[w] ++ ; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        qr(q[i].l), qr(q[i].r), q[i].id = i ;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + m + <span class="number">1</span>, comp) ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) tmp[i] = vu[g[i]] ;</span><br><span class="line"><span class="comment">//for (int i = 1 ; i &lt;= n ; ++ i) if(buc[tmp[i]]) return 0 ; else buc[tmp[i]] ++ ; </span></span><br><span class="line"><span class="comment">/*for (int i = 1 ; i &lt;= n ; ++ i)&#123;</span></span><br><span class="line"><span class="comment">cout &lt;&lt; g[i] &lt;&lt; " " &lt;&lt; tmp[i] &lt;&lt; '\n' ;</span></span><br><span class="line"><span class="comment">debug(base[tmp[i]], 0, base[tmp[i]].size() - 1, ' ', '\n') ;</span></span><br><span class="line"><span class="comment">&#125;return 0 ; */</span></span><br><span class="line"><span class="comment">//debug(tmp, 1, n, ' ', '\n') ;</span></span><br><span class="line">B = <span class="built_in">sqrt</span>(V) + <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= V ; ++ i)&#123;</span><br><span class="line">blv[i] = i / B + <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">if</span> (blv[i] != blv[i - <span class="number">1</span>])</span><br><span class="line">vr[blv[i - <span class="number">1</span>]] = i - <span class="number">1</span>, vl[blv[i]] = i ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">0</span> ; vr[blv[V]] = V ;</span><br><span class="line"><span class="comment">//debug(blv, 1, V, ' ',  '\n') ;</span></span><br><span class="line"><span class="comment">//debug(vl, 1, blv[V], ' ',  '\n') ;</span></span><br><span class="line"><span class="comment">//debug(vr, 1, blv[V], ' ',  '\n') ;</span></span><br><span class="line"><span class="comment">//while (l &lt;= n) add(l ++) ;// cout &lt;&lt; l &lt;&lt; '\n' ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line"><span class="keyword">while</span> (l &gt; q[i].l) add(-- l) ; </span><br><span class="line"><span class="keyword">while</span> (r &lt; q[i].r) add(++ r) ;</span><br><span class="line"><span class="keyword">while</span> (l &lt; q[i].l) del(l ++) ; </span><br><span class="line"><span class="keyword">while</span> (r &gt; q[i].r) del(r --) ;</span><br><span class="line">ans[q[i].id] = su[ ask() ] ; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        qw(ans[i], <span class="string">'\n'</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="SNOI2017-ä¸€ä¸ªç®€å•çš„è¯¢é—®"><a href="#SNOI2017-ä¸€ä¸ªç®€å•çš„è¯¢é—®" class="headerlink" title="[SNOI2017] ä¸€ä¸ªç®€å•çš„è¯¢é—®"></a>[SNOI2017] ä¸€ä¸ªç®€å•çš„è¯¢é—®</h2><blockquote><p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º $N$ çš„åºåˆ— $a_i$ï¼Œ$1\leq i\leq N$ï¼Œå’Œ $q$ ç»„è¯¢é—®ï¼Œæ¯ç»„è¯¢é—®è¯»å…¥ $l_1,r_1,l_2,r_2$ï¼Œéœ€è¾“å‡º</p><script type="math/tex; mode=display">\sum\limits_{x=0}^\infty \text{get}(l_1,r_1,x)\times \text{get}(l_2,r_2,x)</script><p>$ \text{get}(l,r,x)$ è¡¨ç¤ºè®¡ç®—åŒºé—´ $[l,r]$ ä¸­ï¼Œæ•°å­— $x$ å‡ºç°äº†å¤šå°‘æ¬¡ã€‚</p></blockquote><p>é¦–å…ˆå¯ä»¥ç™¼ç¾é€™æ±è¥¿å°±æ˜¯åœ¨æ±‚ $\sum\limits_{i=l_1}^{r_1}\sum\limits_{j=l_2}^{r_2}[a_i=a_j]$ ã€‚ç”±æ–¼æ˜¯ $\sum $ çš„å½¢å¼ï¼Œé‚£éº¼è‡ªç„¶å¯ä»¥æ‹†æˆå››å€‹è©¢å•ï¼Œå³è©¢å•</p><script type="math/tex; mode=display">\begin{aligned}&\sum\limits_{i=l_1}^{r_1}\sum\limits_{j=l_2}^{r_2}[a_i=a_j]\\=&\sum_{i=1}^{r_1}\sum_{j=1}^{r_2}[a_i=a_j]-\sum_{i=1}^{r_1}\sum_{j=1}^{l_2-1}[a_i=a_j]-\sum_{i=1}^{l_1-1}\sum_{j=1}^{r_2}[a_i=a_j]+\sum_{i=1}^{l_1-1}\sum_{j=1}^{l_2-1}[a_i=a_j]\end{aligned}</script><p>é‚£éº¼å°±è®Šæˆäº†å››å€‹é›™ç«¯é»è©¢å•çš„å•é¡Œäº†ã€‚æ³¨æ„åˆ°æ¯å¤šä¸€å€‹å…ƒç´  $x$ï¼Œå°±æœƒå¤š $buc_x$ å€‹ <code>pair</code>ï¼Œè«éšŠå³å¯ã€‚</p><h2 id="Ynoi2016-è¿™æ˜¯æˆ‘è‡ªå·±çš„å‘æ˜"><a href="#Ynoi2016-è¿™æ˜¯æˆ‘è‡ªå·±çš„å‘æ˜" class="headerlink" title="[Ynoi2016]è¿™æ˜¯æˆ‘è‡ªå·±çš„å‘æ˜"></a>[Ynoi2016]è¿™æ˜¯æˆ‘è‡ªå·±çš„å‘æ˜</h2><blockquote><p>ç»™ä¸€ä¸ªæ ‘ï¼Œ$n$ ä¸ªç‚¹ï¼Œæœ‰ç‚¹æƒï¼Œåˆå§‹æ ¹æ˜¯ $1$ ã€‚$m$ ä¸ªæ“ä½œï¼Œæ¯æ¬¡æ“ä½œï¼š</p><ol><li>å°†æ ‘æ ¹æ¢ä¸º $x$ ã€‚</li><li>ç»™å‡ºä¸¤ä¸ªç‚¹ $x$ï¼Œ$y$ï¼Œä» $x$ çš„å­æ ‘ä¸­é€‰ä¸€ä¸ªç‚¹ï¼Œ$y$ çš„å­æ ‘ä¸­é€‰ä¸€ä¸ªç‚¹ï¼Œå¦‚æœä¸¤ä¸ªç‚¹ç‚¹æƒç›¸ç­‰ï¼Œ<code>ans++</code>ï¼Œæ±‚ ansã€‚</li></ol><p>$n\leq 10^5,m\leq 5\times 10^5$ã€‚</p></blockquote><p>ç™¼ç¾â€¦ä¼¼ä¹æœ¬è³ªä¸Šå°±æ˜¯ä¸Šé¢é‚£å€‹é¡Œã€‚å› ç‚ºæ›æ ¹é€™å€‹åœ°æ–¹ï¼Œå°æ–¼æŸå€‹é»è‡³å¤šæœ‰å…©ç¨®å¯èƒ½ï¼Œå°±æ˜¯å­æ¨¹å…§çš„é»ç‚ºæ ¹ã€å­æ¨¹å¤–çš„é»ç‚ºæ ¹å’Œè‡ªå·±ç‚ºæ ¹ã€‚ç„¶å¾Œå°±å¯ä»¥ä¸€é–‹å§‹å…ˆæŒ‰ç…§æ“ä½œï¼ŒæŠŠæ‰€æœ‰è©¢å•è½‰åŒ–æˆä»¥ $1$ ç‚ºæ ¹ï¼Œ$dfs$ åºä¸Šçš„æ“ä½œã€‚ç„¶å¾Œå¤§æ¦‚å°±å’Œä¸Šä¸€é“é¡Œä¸€æ¨£äº†ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ˜¯é‡åˆ°å­æ¨¹å…§çš„é»ä½œç‚ºæ ¹ï¼Œé‚£éº¼æœ¬èº«å°±è¦å…©å€‹è©¢å•ï¼Œä¸€å€‹è©¢å•å…¨å±€çš„ï¼Œä¸€å€‹æ¸›å»é€™å€‹å­æ¨¹çš„ï¼Œæ³¨æ„åˆ°è©¢å•å…¨å±€çš„ä¸¦ä¸éœ€è¦æ‹†ï¼Œæ‰€ä»¥ä¸€å€‹è©¢å•æœ€å¤šæœƒè¢«æ‹†åˆ†æˆ $(2+1)\times (2+1)=9$ å€‹è©¢å•ï¼Œæœ€å¾Œ $m$ å¯ä»¥åˆ° $5\times 10^6$ å·¦å³ã€‚é›–ç„¶è«éšŠçš„è¤‡é›œåº¦å¯ä»¥æ¥å— $m$ æ¯”è¼ƒå¤§ï¼Œä½†æ˜¯ä¸€é–‹å§‹æ’åºçš„ $m\log m$ å°±æœƒå¾ˆæ…¢ã€‚æ‰€ä»¥å¯ä»¥ç”¨åŸºæ•¸æ’åºä¾†å¯¦ç¾é€™å€‹éç¨‹ã€‚</p><h2 id="BZOJ3920-Yunna-çš„ç¦®ç‰©"><a href="#BZOJ3920-Yunna-çš„ç¦®ç‰©" class="headerlink" title="[BZOJ3920] Yunna çš„ç¦®ç‰©"></a>[BZOJ3920] Yunna çš„ç¦®ç‰©</h2><blockquote><p>çµ¦å®šåºåˆ—ï¼Œæ¯æ¬¡æŸ¥è¯¢åŒºé—´ä¸­å‡ºç°æ¬¡æ•° $k_1$ å°çš„æ•°é‡Œé¢çš„ $k_2$ å°çš„æ•°ã€‚</p></blockquote><p>é ï¼Œä¸€é–‹å§‹æ²’çœ‹è¦‹ã€å€é–“ã€é€™å€‹é™åˆ¶ï¼Œé‚„å¾ˆå¥½å¥‡ç‚ºä»€éº¼è¦ä¸Šè«éšŠâ€¦è€äº†è€äº†ã€‚</p><p>çœ‹äº†åŠå¤©é¡Œè§£æ‰å¤§æ¦‚çœ‹æ˜ç™½ï¼Œä¼¼ä¹æ˜¯å€‹ä»€éº¼åˆ†å¡Šå¥—åˆ†å¡Šçš„æ“ä½œã€‚å¤§æ¦‚å°±æ˜¯å°æ–¼ã€å‡ºç¾æ¬¡æ•¸ã€çš„å‡ºç¾æ¬¡æ•¸é–‹ä¸€å€‹æ¡¶ï¼Œç„¶å¾Œæ‹¿å€¼åŸŸåˆ†å¡Šä¾†ç¶­è­·é€™å€‹æ±è¥¿ï¼Œä½†æ˜¯å°æ–¼æ¯å€‹ã€æ¬¡æ•¸ã€é‚„æ˜¯éœ€è¦æŸ¥è©¢ç¬¬ $k_2$ å°çš„æ•¸ï¼Œæ–¼æ˜¯å°±å°æ–¼é€™å€‹å¡Šå…§çš„æ¯å€‹ã€æ¬¡æ•¸ã€ï¼Œå¤–é¢å†å¥—ä¸€å±¤å€¼åŸŸåˆ†å¡Šä¾†ç¶­è­·ä¸€å€‹å›ºå®šæ¬¡æ•¸è™•çš„æ•¸çš„æ’åºã€‚</p><p>é€™æ¨£æ’å…¥å°±æ˜¯ $O(1)+O(1)$ ï¼ŒæŸ¥è©¢å°±æ˜¯ $O(\sqrt n) +O(\sqrt n)$ ã€‚çœ‹ä¸Šå»å¾ˆæ£’ï¼Œä½†æ˜¯ç©ºé–“ä¸Šæœƒè¢«å¡â€¦</p><p>é€™å€‹åœ°æ–¹æˆ‘å°±å¾ˆä¸ç†è§£â€¦ä¸çŸ¥é“ç‚ºå•¥æœƒè¢«å¡â€¦ä¸éé‚£å€‹ä»€éº¼ã€åˆ†æ®µé›¢æ•£åŒ–ã€çš„ trick å¤§æ¦‚æ˜¯é¢„å¤„ç†å‡ºå¯¹äºæŸä¸€ç§å‡ºç°æ¬¡æ•°ï¼Œæ‰€æœ‰å¯èƒ½çš„æ•°ï¼Œå†å°†å…¶ç¦»æ•£åŒ–ï¼Œå¯¹äºç¦»æ•£åŒ–åçš„æ•°å†ä¾†å€¼åŸŸåˆ†å¡Šç»´æŠ¤ã€‚é€™æ¨£è¤‡é›œåº¦å°±æ˜¯ç·šæ€§äº†ã€‚å¤§æ¦‚æ˜¯ä»€éº¼ vector ä¿å­˜æŸå€‹æ•¸å‡ºç¾ $k$ æ¬¡ä¹‹å¾Œçš„æ–°æ¬Šå€¼ï¼Ÿå¤§æ¦‚éç¨‹å°±å’Œå…¶ä»–åšå®¢è¬›çš„ï¼Œå¦‚æœæŸå€‹æ•¸çš„ç¸½å‡ºç¾æ¬¡æ•¸ $cnt_x&gt;i$ ï¼Œé‚£éº¼å°±è¦ç”¨ $x$ é è™•ç† $i$ ï¼Œé€™æ˜¯é¡¯ç„¶çš„ã€‚</p><p>ä¼¼ä¹ç©ºé–“è¢«å¡çš„åŸå› æ˜¯å€¼åŸŸåˆ†å¡Šçš„ size è¦é å…ˆç¢ºå®šï¼Œæ‰€ä»¥ä¸äºŒæ¬¡é›¢æ•£åŒ–ï¼Œè¤‡é›œåº¦å°±æœƒæ˜¯ $n^2$ çš„äº†ã€‚</p><h1 id="æ ¹å·åˆ†æ²»"><a href="#æ ¹å·åˆ†æ²»" class="headerlink" title="æ ¹å·åˆ†æ²»"></a>æ ¹å·åˆ†æ²»</h1><h2 id="A-2"><a href="#A-2" class="headerlink" title="A"></a>A</h2><blockquote><p>ç»™ä¸ªå›¾</p><ol><li>æŠŠ $x$ ç‚¹æƒåŠ  $y$ ã€‚</li></ol><p>2.æŸ¥è¯¢ $x$ ç›¸é‚»çš„ç‚¹æƒå’Œã€‚</p></blockquote><p>ç» å…¸ å¥— è·¯ . æ€»ç»“ä¸€ä¸‹çš„è¯ï¼Œå¤§æ¦‚å°±æ˜¯ã€Œå°çš„ç›´æ¥åšï¼Œå¤§çš„æ‰“æ ‡è®°ã€è¿™ä¹ˆä¸€ä¸ªå¥—è·¯ã€‚</p><p>å…·ä½“ä¸€ç‚¹ï¼Œæ¯ä¸ªç‚¹ç»´æŠ¤ä¸€ä¸‹è¯¢é—®çš„ $ans$ï¼Œå¯¹æ¯ä¸ªç‚¹å±•å¼€å…³äºåº¦æ•°çš„æ ¹å·åˆ†æ²»ï¼Œ$&lt;\sqrt m$ çš„ç‚¹ç›´æ¥åŠ ï¼Œ$&gt;\sqrt m$ çš„ç‚¹æ‰“æ ‡è®°ã€‚æ¯æ¬¡è¯¢é—®åˆ°ä¸€ä¸ªç‚¹ $x$ï¼Œç”±äº $\deg &gt; \sqrt m$ çš„ç‚¹ä¸è¶…è¿‡ $\sqrt m$ ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ $for$ è¿‡å»åˆ¤æ–­æ˜¯å¦ä¸ $x$ ç›¸é‚»ã€‚</p><h2 id="B-2"><a href="#B-2" class="headerlink" title="B"></a>B</h2><blockquote><p>è§„å®šåºåˆ— $a_n$ï¼Œæ¯æ¬¡ç»™å®š $x$ å’Œ $y$ ï¼š</p><p>æŸ¥è¯¢ä¸€ä¸ªåŒºé—´ä¸­æœ€å°çš„ $|i-j|$ï¼Œä½¿å¾— $a_i=x,a_j=y$ã€‚</p></blockquote><p>æœ‰è¶£çš„é¢˜ã€‚</p><p>è€ƒè™‘å¯¹äºæ¯ç§é¢œè‰²æŒ‰ç…§å‡ºç°æ¬¡æ•°åˆ†æ²»ã€‚æŸä¸ªé¢œè‰² $x$ çš„å‡ºç°æ¬¡æ•°è®°ä½œ $cnt_x$ã€‚å¯¹äº $cnt_x\leq \sqrt n$ çš„å¯ä»¥é¢„å¤„ç†æ‰€æœ‰ä½ç½®ï¼Œè¿™ä¸€éƒ¨åˆ†æ—¶ $O(n)$ ç©º $O(n\sqrt n)$ ï¼Œå¯¹äº $cnt_x&gt;\sqrt n$  çš„å¯ä»¥é¢„å¤„ç†åˆ°æ‰€æœ‰é¢œè‰²çš„æœ€å°è·ç¦»ï¼ˆç”±äºæ˜¯æœ€å°è·ç¦»æ‰€ä»¥å¯ä»¥å¿½ç•¥åŒºé—´é•¿åº¦çš„é™åˆ¶ï¼‰ï¼Œè¿™éƒ¨åˆ†æ—¶ $O(n\sqrt n)$ ç©º $O(n \sqrt n)$ ã€‚</p><p>è€ƒè™‘è¯¢é—® $(x,y)$ï¼Œå¦‚æœè‡³å°‘ä¸€ä¸ªé¢œè‰²çš„ $cnt&gt;\sqrt n$ é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥åšï¼Œå¦åˆ™è€ƒè™‘ç”±äºä¸¤ä¸ªé¢œè‰²çš„ä½ç½®éƒ½å·²çŸ¥ä¸”æ•°é‡ $&lt;\sqrt n$ï¼Œæ‰€ä»¥æŒ‰é¡ºåºæ‹¿å‡ºæ¥ï¼Œå¯¹è¿™ä¸¤ä¸ªåºåˆ—å½’å¹¶ä¸€ä¸‹å°±åšå®Œäº†ï¼Œå¤æ‚åº¦ $O(m\sqrt n+n\sqrt n)$ ã€‚</p><h2 id="C-1"><a href="#C-1" class="headerlink" title="C"></a>C</h2><blockquote><p>[Ynoi2015]ã„ã¾ã“ã®æ™‚ã®è¼ãã‚’</p><p>æŸ¥è¯¢ä¸€ä¸ªåŒºé—´ä¹˜ç§¯çš„çº¦æ•°ä¸ªæ•°ã€‚</p><p>å€¼åŸŸ $v\leq 10^9$ã€‚</p></blockquote><p>è€ƒè™‘ $\tau(x)=\prod (a_x+1)$ ï¼Œ åŒæ—¶å¯¹äºæŸä¸ª $v$ ï¼Œç´ å› æ•°ä¸ªæ•°æ˜¯ $\frac{\log v}{\log \log v}$ çš„ï¼Œæ‰€ä»¥å¦‚æœæš´åŠ›è«é˜Ÿè½¬ç§»çš„è¯ï¼Œæ¯æ¬¡è½¬ç§»çš„å¤æ‚åº¦æ˜¯ $O(\frac{\log v}{\log \log v})$ï¼Œè¿™æ ·æœ€åå¤æ‚åº¦æ˜¯ $O(nv^{\frac{1}{4}}+n\sqrt m\frac{\log v}{\log \log v})$ï¼Œä¸è¿‡è¢« lxl ç»™å¡æ‰äº†ã€‚</p><p>è€ƒè™‘ä¸€ä¸ªç¥å¥‡çš„æ ¹å·åˆ†æ²»ã€‚å¯¹äºæ¯ä¸ªæ•° $v$ è€Œè¨€ï¼Œ $&gt;\sqrt[3]v$ çš„ç´ å› å­è‡³å¤šåªä¼šæœ‰ä¸¤ä¸ªï¼Œåœ¨ $v=10^9$ æ—¶ï¼Œ$&lt;10^3$ çš„ç´ æ•°ä¹Ÿåªæœ‰ $168$ ä¸ªã€‚æ‰€ä»¥å¯ä»¥æš´åŠ›è½¬ç§»è¿™äº›å¤§ç´ æ•°çš„è´¡çŒ®ï¼Œè¿™æ ·è½¬ç§»å°±æ˜¯ $O(1)$ çš„ï¼›ç„¶åå¯¹äºæ¯æ¬¡è¯¢é—®ï¼Œåªéœ€è¦å†æš´åŠ›ç»Ÿè®¡å°ç´ æ•°çš„è´¡çŒ®å³å¯ã€‚æœ€ç»ˆå¤æ‚åº¦ $O(nv^{\frac{1}{4}}+m\frac{3\cdot v^{\frac{1}{3}}}{\ln v}+n\sqrt m)$ ã€‚</p><h2 id="D-1"><a href="#D-1" class="headerlink" title="D"></a>D</h2><blockquote><p>POI2015 Odwiedziny</p><p>æ ‘ï¼Œç‚¹æƒï¼Œå¤šæ¬¡æŸ¥è¯¢ï¼Œæ¯æ¬¡ç»™ <code>x,y,k</code>ã€‚</p><p>æ±‚ä» $x$ å¼€å§‹ï¼Œæ¯æ¬¡è·³è¿‡ $k$ ä¸ªèŠ‚ç‚¹è·³åˆ° $y$ æ‰€ç»è¿‡èŠ‚ç‚¹çš„å’Œã€‚</p></blockquote><p>è¿˜æ˜¯æ ¹å·åˆ†æ²»ã€‚è€ƒè™‘å¯¹äº $k\leq \sqrt n$ ï¼Œå¯ä»¥é¢„å¤„ç†å‡º $k=1,2,3\cdots \sqrt n$ ç„¶åæ¯æ¬¡æš´åŠ›å‘ä¸Šè·³ï¼Œå¯¹äº $k&gt;\sqrt n$ ï¼Œè‡³å¤šéœ€è¦è·³ $\sqrt n$ æ¬¡ï¼Œé‚£ä¹ˆå¯ä»¥å€å¢æ±‚å‡º k çº§ç¥–å…ˆåšåˆ° $O(m\sqrt n\log n)$ ï¼Œæˆ–è€…é•¿å‰–åšåˆ° $O(m\sqrt n)$ ã€‚å½“ç„¶ä¹Ÿå¯ä»¥è½»é‡é“¾å‰–ï¼Œç»´æŠ¤æ¯æ¡é‡é“¾ä¸Šæ·±åº¦ä»å¤§åˆ°å°çš„ç‚¹çš„åºåˆ—ï¼Œè¿™æ ·å•æ¬¡å¤æ‚åº¦å°±æ˜¯ $O(\log k+\frac{n}{k})$ äº†ã€‚</p><p>è¿˜æœ‰ä¸€ç§ zz åšæ³•ï¼Œè®°å½•æ¯ä¸ªç‚¹çš„ $1,2,3\cdots\sqrt n,2\sqrt n,3\sqrt n$ çº§ç¥–å…ˆï¼Œè¿™æ ·ä¹Ÿæ˜¯ $n\sqrt n + m\sqrt n$ çš„äº†ã€‚</p><h2 id="E-1"><a href="#E-1" class="headerlink" title="E"></a>E</h2><blockquote><p>Bzoj4320 ShangHai2006 Homework</p><p>1.åœ¨äººç‰©é›†åˆ S ä¸­åŠ å…¥ä¸€ä¸ª Xï¼Œä¿è¯ X åœ¨å½“å‰é›†åˆä¸­ä¸å­˜åœ¨ã€‚</p><p>2.åœ¨å½“å‰çš„äººç‰©é›†åˆä¸­è¯¢é—®æ‰€æœ‰X mod Y æœ€å°çš„å€¼</p><p>å€¼åŸŸ $&lt;300000$ ã€‚ </p></blockquote><p>è€ƒè™‘å¯¹äº $&lt;\sqrt V$ çš„æ‰€æœ‰ Y ï¼Œä»¤ $f_k$ è¡¨ç¤º Y = $k$ æ—¶çš„ç­”æ¡ˆï¼Œæ¯æ¬¡ä¿®æ”¹å¯ä»¥æš´åŠ›ç»´æŠ¤æ‰€æœ‰ $f$ï¼ŒæŸ¥è¯¢æ—¶ $O(1)$ ã€‚è¿™ä¸€éƒ¨åˆ†å¤æ‚åº¦ä¸º $m\sqrt V$ã€‚</p><p>è€ƒè™‘å¯¹äº $&gt;\sqrt V$ çš„æ‰€æœ‰ Yï¼Œå‘ç° $V$ ä»¥å†…è‡³å¤šæœ‰ $\sqrt V$ ä¸ª Y çš„å€æ•°ï¼Œé‚£ä¹ˆæ¯æ¬¡æŸ¥è¯¢ç›¸å½“äºåœ¨ä¸¤ä¸ªç›¸é‚»çš„ Y çš„å€æ•°ä¹‹é—´æŸ¥è¯¢åŒºé—´æœ€å°å€¼ã€‚æ³¨æ„åˆ°è¿™æ ·æœ€å¤šæœ‰ $m\sqrt V$ æ¬¡æŸ¥è¯¢ï¼Œ$m$ æ¬¡ä¿®æ”¹ï¼Œæ‰€ä»¥æ ¹å·å¹³è¡¡ä¸€ä¸‹ï¼Œæ‹¿ä¸€ä¸ªå€¼åŸŸåˆ†å—æ¥ç»´æŠ¤å³å¯ã€‚</p><p>æ€»å¤æ‚åº¦ $O(m\sqrt V)$ ã€‚ </p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>lxl çš„è¯¾ä»¶ç¡®å®éƒ½æ˜¯æ¯”è¾ƒæœ‰æ„æ€çš„é¢˜ç›®ï¼Œä¹Ÿç¡®å®å¼€äº†çœ¼ç•Œã€‚</p><p>æƒ³ç»§ç»­å­¦å•Šâ€¦å¯æƒœå®åŠ›ä¸å…è®¸å•Šâ€¦</p><p>ä¸çŸ¥é“é€€å½¹ä¹‹å‰èƒ½ä¸èƒ½å®Œæ•´åœ°æŠŠè¿™ä¸ªè¯¾ä»¶çœ‹ä¸€éäº†233</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å•Šï¼Œå…¶å®å°±æ˜¯ä¸€ç›´å¬è¯´åˆ†å—å¾ˆnbä½†æ˜¯ä¸€ç›´æ²¡æœ‰æ·±åˆ»ç†è§£ï¼Œäºæ˜¯å°±æ•´ç†äº†ä¸€ä¸‹â€¦&lt;/p&gt;
&lt;p&gt;è¯è¯´æˆ‘åˆ†å—å†å²ä¸Šåªå†™è¿‡ä¸€é“é¢˜â€¦è’²å…¬è‹±é‚£é¢˜â€¦å½“æ—¶å†™çš„è¿˜ä¸€å †è¯¡å¼‚çš„è¾¹ç•Œï¼Œå¯¼è‡´æˆ‘æ¯«æ— å¤ç›˜çš„æ¬²æœ›â€¦&lt;/p&gt;
&lt;p&gt;æ—¥å¸¸ä¸æƒ³å†™æ•°æ®ç»“æ„(1/1) ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œå†…å®¹å°±æ˜¯ lxl çš„ PPT ï¼Œå€‹äººæ„Ÿè¦ºé€€å½¹ä¹‹å‰é€™å€‹ PPT æ˜¯å­¸ä¸å®Œäº†ğŸ˜­&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://www.orchidany.cn/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è«é˜Ÿ" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%96%B9%E6%B3%95-%E8%8E%AB%E9%98%9F/"/>
    
      <category term="æŠ€å·§/æ ¹å·åˆ†æ²»" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E6%A0%B9%E5%8F%B7%E5%88%86%E6%B2%BB/"/>
    
      <category term="æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/åˆ†å—" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%96%B9%E6%B3%95-%E5%88%86%E5%9D%97/"/>
    
  </entry>
  
  <entry>
    <title>ã€å¬è¯¾ç¬”è®°ã€‘ç‚¹åˆ†æ²»/ç‚¹åˆ†æ ‘ç›¸å…³</title>
    <link href="https://www.orchidany.cn/2020/04/03/%E5%88%86%E6%B2%BB%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0-1/"/>
    <id>https://www.orchidany.cn/2020/04/03/åˆ†æ²»å¬è¯¾ç¬”è®°-1/</id>
    <published>2020-04-03T02:50:31.000Z</published>
    <updated>2020-04-09T01:42:55.471Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¼¼ä¹ä¸»è¦æ˜¯ç‚¹åˆ†æ²»çš„ç›¸å…³å†…å®¹ï¼Ÿ</p><a id="more"></a><h1 id="ç®€å•çš„å‰è¨€"><a href="#ç®€å•çš„å‰è¨€" class="headerlink" title="ç®€å•çš„å‰è¨€"></a>ç®€å•çš„å‰è¨€</h1><p>é¦–å…ˆå¯¹äºæ ‘çš„ç‚¹åˆ†æ²»æ‰€è¦è§£å†³çš„é—®é¢˜å’Œæ™®é€šåˆ†æ²»ä¸€æ ·ï¼Œåªéœ€è¦ç»Ÿè®¡ç»è¿‡åˆ†æ²»ä¸­å¿ƒçš„ä¿¡æ¯ï¼Œå‡è®¾å¯¹äº $k$ ä¸ªç‚¹è€Œè¨€ï¼Œç»Ÿè®¡ç»è¿‡åˆ†æ²»ä¸­å¿ƒçš„ä¿¡æ¯å¤æ‚åº¦æ˜¯ $O(\gamma(k))$ çš„ï¼Œé‚£ä¹ˆæœ€åçš„æ€»å¤æ‚åº¦å°±æ˜¯ $\gamma(n)\log n $ ã€‚</p><p>å¯¹äºæ ‘çš„è¾¹åˆ†æ²»è€Œè¨€ï¼Œé‡åˆ°èŠèŠ±å°±ä¼šå´©æ‰ã€‚äºæ˜¯è€ƒè™‘å¯¹æ¯ä¸ªç‚¹è¿›è¡Œ<strong>ä¸‰åº¦åŒ–</strong> ï¼Œæ„å³å»ºç«‹è™šç‚¹ä½¿å¾—æ¯ä¸ªç‚¹çš„åº¦æ•°éƒ½ä¸è¶…è¿‡ $3$ ï¼ˆäºŒåº¦åŒ–ä¹‹åè¦ä¹ˆæ˜¯é“¾è¦ä¹ˆæ˜¯ç¯ï¼‰ã€‚è¿™æ ·æœ€ç»ˆçš„ $size=k$ çš„ä¸€å±‚è‡³å¤šä¼šåˆ†æˆä¸€ä¸ª  $size=\frac{1}{3}k$ çš„å’Œä¸€ä¸ª $size=\frac{2}{3}k$ çš„ï¼Œå¯ä»¥çŸ¥é“å¦‚æœåº¦æ•° $\leq 3$ ï¼Œè¿™å°±æ˜¯èƒ½åšåˆ°çš„æœ€ä½³ä¸Šç•Œã€‚äºæ˜¯æœ€åçš„å¤æ‚åº¦å¤§æ¦‚æ˜¯ $\gamma(k)\log _{\frac{3}{2}}k$ ã€‚</p><p>å—¯ï¼Œå¯èƒ½è¾¹åˆ†æ²»å°±åªç”¨æ¥åˆ†æä¸ªå¤æ‚åº¦ï¼Œå¥½åƒå‡ ä¹æ²¡äººç”¨çš„æ ·å­ã€‚ä¸è¿‡ä¹Ÿæœ‰ä¸ªå¥½å¤„å§ï¼Œå°±æ˜¯ä¸ç”¨è€ƒè™‘å¯èƒ½å­˜åœ¨çš„åˆ†æ²»ä¸­å¿ƒçš„è¾¹ç•Œé—®é¢˜ã€‚</p><h1 id="å¸¸è§ç‚¹åˆ†æ²»"><a href="#å¸¸è§ç‚¹åˆ†æ²»" class="headerlink" title="å¸¸è§ç‚¹åˆ†æ²»"></a>å¸¸è§ç‚¹åˆ†æ²»</h1><h2 id="æ¯”è¾ƒå¸¸è§çš„æ•°æ®ç»“æ„"><a href="#æ¯”è¾ƒå¸¸è§çš„æ•°æ®ç»“æ„" class="headerlink" title="æ¯”è¾ƒå¸¸è§çš„æ•°æ®ç»“æ„"></a>æ¯”è¾ƒå¸¸è§çš„æ•°æ®ç»“æ„</h2><p>ä¸€èˆ¬è¿™ä¸ªä¸œè¥¿éƒ½æ¯”è¾ƒæ˜¾ç„¶â€¦å°±é¢˜è®ºé¢˜å§ã€‚</p><h2 id="å¦‚æœä¿¡æ¯å¯ä»¥å®¹æ–¥"><a href="#å¦‚æœä¿¡æ¯å¯ä»¥å®¹æ–¥" class="headerlink" title="å¦‚æœä¿¡æ¯å¯ä»¥å®¹æ–¥"></a>å¦‚æœä¿¡æ¯å¯ä»¥å®¹æ–¥</h2><p>è¿™ä¸€ç±»æ¯”è¾ƒå¸¸è§çš„æ˜¯ç»Ÿè®¡æ»¡è¶³æŸä¸ªæœ‰å¯å‡æ€§çš„ç‚¹å¯¹æ•°ï¼Œæ¯”å¦‚ç»Ÿè®¡è·¯å¾„é•¿åº¦/ç‚¹æƒå’Œ $&lt;k$ çš„è·¯å¾„ã€‚å¸¸è§„çš„å®¹æ–¥åšæ³•æ˜¯è€ƒè™‘å¯¹äºæ¯ä¸€å±‚ï¼Œè®¡ç®—å‡ºæ‰€æœ‰å¯èƒ½çš„ç‚¹å¯¹ï¼Œå¹¶ä¸”å‡å»é‚£äº› <code>belong(x)=belong(y)</code> çš„ç‚¹å¯¹ $(x,y)$ ã€‚</p><h2 id="ç±»å“ˆå¤«æ›¼æ ‘åˆå¹¶"><a href="#ç±»å“ˆå¤«æ›¼æ ‘åˆå¹¶" class="headerlink" title="ç±»å“ˆå¤«æ›¼æ ‘åˆå¹¶"></a>ç±»å“ˆå¤«æ›¼æ ‘åˆå¹¶</h2><p>æ¯æ¬¡é€‰æ‹©ä¸¤ä¸ªsizeæœ€å°çš„å­æ ‘è¿›è¡Œåˆå¹¶ï¼Œè¿™æ ·æœ€ååˆå¹¶çš„æ€»å¤æ‚åº¦æ‘Šä¸‹æ¥ä¹Ÿæ˜¯ $n \log n$ çš„ã€‚è¿™ä¸ªä¸»è¦ç”¨äºé‚£äº›ä¸å®¹æ˜“æ’å…¥åˆ é™¤ä½†æ˜¯å®¹æ˜“åˆå¹¶/é‡æ„çš„ä¿¡æ¯ç»Ÿè®¡ã€‚æ³¨æ„åˆ°å¿…é¡»æ˜¯ä»å°åˆå¹¶åˆ°å¤§ï¼Œè¿™æ ·æ¯æ¬¡å·²åˆå¹¶çš„ä¸¤ä¸ªé›†åˆ $size$ è‡³å°‘æ˜¯è¾ƒå°çš„é‚£ä¸ªçš„ä¸¤å€ï¼Œæ‰€ä»¥æ¯ä¸ªç‚¹è‡³å¤šåˆå¹¶ $\log n$ æ¬¡â€¦â€¦</p><p>ä»¥ä¸Šå¤æ‚åº¦åˆ†æä¼¼ä¹å¾ˆæœ‰é—®é¢˜ã€‚æˆ‘ä¹Ÿä¸çŸ¥é“è¯¥æ€ä¹ˆå»å®šé‡åˆ†æè¿™ä¸ªé—®é¢˜ã€‚</p><p>ä¸è¿‡uojç¾¤ç»™äº†ä¸€ç§å¾ˆå¦™çš„è¯æ³•ã€‚å°±æ˜¯è€ƒè™‘æ¯æ¬¡é€‰ä¸¤ä¸ªæœ€å°çš„åˆå¹¶ä¸€å®šå¯ä»¥è¾¾åˆ°å¤æ‚åº¦çš„ä¸‹ç•Œï¼Œå› ä¸ºå¯¹äºä¸€ä¸ªåˆå¹¶é¡ºåº $a&lt;b&lt;c$ï¼Œ<code>merge(a,b)</code> å† <code>merge(b,c)</code> çš„å¤æ‚åº¦æ˜¯ $O(2(a+b)+c)$ ï¼Œæ”¹å˜åˆå¹¶é¡ºåºï¼Œ<code>merge(a,c)</code> å† <code>merge(b,c)</code>çš„ å¤æ‚åº¦æ˜¯ $O(2(a+c)+b)$ï¼Œä¹Ÿå°±æ˜¯æ”¹å˜è¿™ä¸ªé¡ºåºè‡³å°‘ä¸ä¼šæ›´ä¼˜ã€‚æ‰€ä»¥å¦‚æœæƒ³è¦è¯æ˜è¿™ç§åˆå¹¶æ–¹å¼ä¼˜äºæŸä¸ªå¤æ‚åº¦ï¼Œé‚£ä¹ˆåªéœ€è¦éšä¾¿æ„é€ ä¸€ä¸ªè¿™ç§å¤æ‚åº¦çš„åˆå¹¶æ–¹å¼å³å¯ã€‚</p><p>é‚£ä¹ˆé—®é¢˜è½¬åŒ–åˆ°äº†å¦‚ä½•æ„é€ ä¸€ç§ $n\log n$ çš„åˆå¹¶ã€‚å‘ç°å¦‚æœæ¯æ¬¡åˆ†æˆå·®ä¸å¤šå¤§å°çš„ä¸¤å †ï¼Œé‚£ä¹ˆå¤æ‚åº¦çš„é€’æ¨å¼å°±æ˜¯</p><script type="math/tex; mode=display">T(n)=T(pn)+T(qn) + O(n)\quad (p+q=1,0<p,q<1)</script><p>ä½†æ˜¯è¿™ç§åˆ†æçš„æ–¹å¼å­˜åœ¨ä¸€å®šçš„é—®é¢˜ï¼Œå°±æ˜¯å•çº¯è¿™ä¹ˆå†™å¾ˆå®¹æ˜“æ„é€ å‡º $O(n)$ å±‚ï¼Œä½†æ˜¯ $O(n)$ å±‚æ˜¯ä¸ç¬¦åˆã€Œæ¯æ¬¡åˆ†æˆå·®ä¸å¤šä¸¤å †é€’å½’ã€è¿™ç§æƒ…å†µçš„ã€‚</p><p>ç„¶å uoj (æ²¡é”™æˆ‘å•¥éƒ½ä¸ä¼šåªèƒ½åˆ°å¤„é—®)é‡Œçš„ç¥ä»™å®šé‡åˆ†æäº†ä¸€æ³¢ï¼Œæ„Ÿè§‰ååˆ†æœ‰é“ç†ã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘å¦‚æœå­˜åœ¨æŸä¸ªç‰©å“çš„å¤§å° $\geq \frac{1}{3}$ï¼Œé‚£ä¹ˆç›´æ¥æŠŠè¿™ä¸ªç‰©å“å•ç‹¬æ‹¿å‡ºæ¥åˆ†æˆä¸€éƒ¨åˆ†ï¼Œå‰©ä¸‹çš„åˆ†æˆä¸€éƒ¨åˆ†ï¼›å¦åˆ™å¦‚æœå…¨éƒ¨çš„ç‰©å“çš„ $size$ éƒ½ $&lt;\frac{1}{3}$ ï¼Œé‚£ä¹ˆå¿…å®šå¯ä»¥åˆ†å‡ºä¸€å † $\frac{n}{3}\leq size&lt;\frac{2n}{3}$ çš„ç‰©å“ï¼ŒåŸå› åœ¨äºè¿™ç§æƒ…å†µä¸‹è‡³å°‘æœ‰ $&gt;3$ ç§ç‰©å“ï¼Œé‚£ä¹ˆå¦‚æœç‰©å“å†å¤šçš„è¯ï¼Œåªèƒ½æ˜¯ç±»ä¼¼äºæŠŠä¹‹å‰çš„æŸä¸ªç‰©å“æ‹†åˆ†(æ€»ä½“ç§¯ä¸å˜ä¸”æ¯ä¸ªç‰©å“è‡³å¤šå¤§å°ä¸º $\frac{1}{3}$)ã€‚è€Œåœ¨ä¸‰ä¸ªç‰©å“çš„æ—¶å€™ï¼Œæ˜¯ä¸€å®šå¯ä»¥åˆ’åˆ†å‡º $\frac{n}{3}$ æ¥çš„ï¼Œå¹¶ä¸”ç‰©å“æ•°å¦‚æœå¢å¤šï¼Œé‚£ä¹ˆç”±äºä½“ç§¯å‡å°ä¸€å®šå¯ä»¥è®©åˆ’åˆ†æ›´å¹³å‡ã€‚æ‰€ä»¥ä¸Šç•Œæ˜¯</p><script type="math/tex; mode=display">T(n)=T(\frac{1}{3}n)+T(\frac{2}{3}n)+O(n)</script><p>ç®—å‡ºæ¥å¤æ‚åº¦å°±æ˜¯ $O(n\log_{\frac{3}{2}} n)$ ã€‚</p><p>å—¯ï¼Œä½†æ˜¯è¿™æ ·ä¼¼ä¹å¹¶ä¸èƒ½è¯æ˜éšæœºé€‰ä¸¤å †åˆå¹¶çš„å¤æ‚åº¦â€¦é‚£å°±æœŸæœ› log å§ï¼</p><h1 id="ä¸€å †é¢˜"><a href="#ä¸€å †é¢˜" class="headerlink" title="ä¸€å †é¢˜"></a>ä¸€å †é¢˜</h1><h2 id="é™åˆ¶è·ç¦»çš„ç‚¹å¯¹æ•°"><a href="#é™åˆ¶è·ç¦»çš„ç‚¹å¯¹æ•°" class="headerlink" title="é™åˆ¶è·ç¦»çš„ç‚¹å¯¹æ•°"></a>é™åˆ¶è·ç¦»çš„ç‚¹å¯¹æ•°</h2><blockquote><p>æ±‚è·ç¦»ä¸è¶…è¿‡ $k$ çš„ç‚¹å¯¹æ•°ã€‚</p></blockquote><p>æ³¨æ„åˆ°å¯ä»¥ç”¨ç‚¹åˆ†æ²»ï¼Œåˆ†æ²»çš„æ—¶å€™åªéœ€è¦è€ƒè™‘ç»è¿‡åˆ†æ²»ä¸­å¿ƒçš„è·¯å¾„ï¼Œè¿™å°±æ˜¾ç„¶æ˜¯æšä¸¾æ¯æ£µå­æ ‘ï¼Œå¥—ä¸€ä¸ªæ ‘çŠ¶æ•°ç»„å°±åšå®Œäº†ã€‚ç›´æ¥åˆå¹¶ä¼¼ä¹ä¸æ˜¯å¾ˆç®€å•ã€‚æ‰€ä»¥è¿˜æ˜¯ä¸€ä¸ªç‚¹ä¸€ä¸ªç‚¹åœ°æ’å…¥å†™èµ·æ¥æ¯”è¾ƒç®€å•ä¸€ç‚¹ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">make_root</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">size[x] = g[x] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))</span><br><span class="line"><span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)])&#123;</span><br><span class="line">make_root(to(k), x) ;</span><br><span class="line">size[x] += size[to(k)] ;</span><br><span class="line">g[x] = max(g[x], size[to(k)]) ;</span><br><span class="line">&#125;</span><br><span class="line">chkmax(g[x], num - g[x]) ;</span><br><span class="line"><span class="keyword">if</span> (g[x] &lt; g[rt]) rt = x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">size[x] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (fa == rt)</span><br><span class="line">son[++ cnt] = x, lst[x] = v ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))</span><br><span class="line"><span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)])</span><br><span class="line">dfs(to(k), x, val(k)), size[x] += size[to(k)] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tot ;</span><br><span class="line"><span class="keyword">int</span> buc[N] ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">low</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> x &amp; (-x) ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> ( ; x &lt;= k ; x += low(x)) buc[x] += v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">ll ret = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> ( ; x ; x -= low(x)) ret += buc[x] ;</span><br><span class="line"><span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> dx)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (dx &gt; k) <span class="keyword">return</span> ; d[++ tot] = dx ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))</span><br><span class="line"><span class="keyword">if</span> (!vis[to(k)] &amp;&amp; to(k) != fa)</span><br><span class="line">calc(to(k), x, dx + val(k)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> root)</span></span>&#123;</span><br><span class="line">cnt = <span class="number">0</span> ;</span><br><span class="line">vis[root] = <span class="number">1</span> ; tot = <span class="number">0</span> ;</span><br><span class="line">rt = root ; dfs(root, <span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line"><span class="comment">//cout &lt;&lt; root &lt;&lt; '\n' ; debug(son, 1, cnt, '\n') ;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)&#123;</span><br><span class="line"><span class="keyword">int</span> otot = tot ; calc(son[i], <span class="number">0</span>, lst[son[i]]) ;</span><br><span class="line"><span class="comment">//for (int j = otot + 1 ; j &lt;= tot ; ++ j) cout &lt;&lt; d[j] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = otot + <span class="number">1</span> ; j &lt;= tot ; ++ j) ans += (ll)ask(k - d[j]) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = otot + <span class="number">1</span> ; j &lt;= tot ; ++ j) add(d[j], <span class="number">1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line">ans += ask(k) ; <span class="comment">// cout &lt;&lt; root &lt;&lt; " " &lt;&lt; ans &lt;&lt; endl ;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i) add(d[i], <span class="number">-1</span>) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[root] ; k ; k = next(k))</span><br><span class="line"><span class="keyword">if</span> (!vis[to(k)]) num = size[to(k)], make_root(to(k), rt), solve(to(k)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> u, v, w ;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n ; g[<span class="number">0</span>] = n ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; w ;</span><br><span class="line">add(u, v, w), add(v, u, w) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; k ; num = n ;</span><br><span class="line">make_root(<span class="number">1</span>, <span class="number">0</span>) ; solve(rt) ;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥½ä¹…æ²¡å†™äº†ï¼Œæ„Ÿè§‰å†™èµ·æ¥è¿˜å¯ä»¥ã€‚</p><h2 id="æ‹¬å·åºåˆ—é—®é¢˜"><a href="#æ‹¬å·åºåˆ—é—®é¢˜" class="headerlink" title="æ‹¬å·åºåˆ—é—®é¢˜"></a>æ‹¬å·åºåˆ—é—®é¢˜</h2><blockquote><p> æ ‘ä¸Šæ¯æ¡è¾¹æœ‰ä¸€ä¸ªæ‹¬å·ï¼Œç»Ÿè®¡æœ‰å¤šå°‘åˆæ³•çš„æ‹¬å·åºåˆ—è·¯å¾„ã€‚</p></blockquote><p>è¿˜æ˜¯ç›´æ¥ç‚¹åˆ†ï¼Œä¹‹åå°†ä» $root$ å»¶ä¼¸å‡ºçš„é“¾ä¸­ï¼Œå·¦æ‹¬å·æœªåŒ¹é…çš„å’Œå³æ‹¬å·æœªåŒ¹é…çš„ä¸ªæ•°ç›¸åŒçš„å¯ä»¥é…å¯¹ã€‚äºæ˜¯å°±è®°ä¸€ä¸‹å½“å‰åˆ†æ²»ä¸­å¿ƒåˆ°å„ä¸ªå­æ ‘å†…æ¯ä¸ªç‚¹è·¯å¾„ä¸Šçš„åŒ¹é…å€¼( <code>(</code> è´¡çŒ®ä¸º1, <code>)</code> ä¸º -1)ã€‚ç„¶åæ‹¿ä¸ªæ¡¶ç»´æŠ¤å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> dx)</span></span>&#123;</span><br><span class="line">d[++ tot] = dx ; q[tot] = x ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[x] ; k ; k = next(k))</span><br><span class="line"><span class="keyword">if</span> (to(k) != fa &amp;&amp; !vis[to(k)]) </span><br><span class="line">calc(to(k), x, dx + val(k)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> root)</span></span>&#123;</span><br><span class="line">vis[root] = <span class="number">1</span> ; </span><br><span class="line">tot = <span class="number">0</span> ; dfs(root, <span class="number">0</span>, <span class="number">0</span>) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = head[root] ; i ; i = next(i))&#123;</span><br><span class="line"><span class="keyword">if</span> (vis[to(i)]) <span class="keyword">continue</span> ; </span><br><span class="line"><span class="keyword">int</span> ot = tot ; calc(to(i), root, val(i)) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = ot + <span class="number">1</span> ; j &lt;= tot ; ++ j)</span><br><span class="line">ans += (ll)buc[- d[j] + M / <span class="number">2</span>] ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = ot + <span class="number">1</span> ; j &lt;= tot ; ++ j)</span><br><span class="line">buc[d[j] + M / <span class="number">2</span>] ++ ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//cout &lt;&lt; root &lt;&lt; " " &lt;&lt; ans &lt;&lt; endl ; </span></span><br><span class="line"><span class="comment">//for (int i = 1 ; i &lt;= tot ; ++ i) </span></span><br><span class="line"><span class="comment">//cout &lt;&lt; d[i] &lt;&lt; " " &lt;&lt; q[i] &lt;&lt; " &amp; " &lt;&lt; endl, </span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i) buc[d[i] + M / <span class="number">2</span>] = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = head[root] ; k ; k = next(k))&#123;</span><br><span class="line"><span class="keyword">if</span> (!vis[to(k)])&#123;</span><br><span class="line">num = size[to(k)] ; rt = <span class="number">0</span> ;</span><br><span class="line">make_root(to(k), rt) ; solve(rt) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è·¯å¾„æ•°é‡é—®é¢˜"><a href="#è·¯å¾„æ•°é‡é—®é¢˜" class="headerlink" title="è·¯å¾„æ•°é‡é—®é¢˜"></a>è·¯å¾„æ•°é‡é—®é¢˜</h2><blockquote><p>ç»™å®šä¸€æ£µæ ‘ï¼Œæ±‚é•¿åº¦åˆ†åˆ«ä¸º $1,2,3\ldots n$ çš„è·¯å¾„æ•°é‡ã€‚</p></blockquote><p>å‘ç°å¯ä»¥å¯¹æ¯ä¸ªå­æ ‘è®°ä¸€ä¸‹ $buc_i$ è¡¨ç¤ºæ·±åº¦ä¸º $i$ çš„ç‚¹çš„æ•°é‡ï¼Œå‘ç°ä¸¤æ£µå­æ ‘çš„ $buc$ å¯¹ç­”æ¡ˆçš„è´¡çŒ®æ˜¯ä¸€ä¸ªå·ç§¯çš„å½¢å¼ã€‚é‚£ä¹ˆè€ƒè™‘ç›´æ¥æšä¸¾æ¯æ£µå­æ ‘ï¼Œè®¡ç®—è´¡çŒ®æ—¶å¯¹å½“å‰æ¡¶å’Œå‰ç¼€æ¡¶ç”¨ $\rm NTT$ æ¥åˆå¹¶å³å¯ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸œè¥¿å¿…é¡»è¦ä»å°åˆ°å¤§æšä¸¾æ¯ä¸ªå­æ ‘è¿›è¡Œåˆå¹¶ï¼Œå¤æ‚åº¦æ‰æ˜¯å¯¹çš„ï¼ˆè¯æ˜å°±æ˜¯ä¸Šé¢é‚£ä¸ªç±»å“ˆå¤«æ›¼æ ‘åˆå¹¶çš„è¯æ˜ï¼‰</p><p>æœ€ç»ˆå¤æ‚åº¦ $n\log ^2 n$ ã€‚ä»£ç å°±ä¸å†™äº†ï¼Œå°±æ˜¯æ­»äº¡äºŒåˆä¸€ç½¢äº†ã€‚</p><h2 id="æ ‘ä¸ŠèƒŒåŒ…é—®é¢˜"><a href="#æ ‘ä¸ŠèƒŒåŒ…é—®é¢˜" class="headerlink" title="æ ‘ä¸ŠèƒŒåŒ…é—®é¢˜"></a>æ ‘ä¸ŠèƒŒåŒ…é—®é¢˜</h2><blockquote><p>ç»™å®šä¸€æ£µæ ‘ï¼Œæ ‘ä¸Šæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªæƒå€¼ä¸€ä¸ªé‡é‡ã€‚è¦æ±‚é€‰æ‹©ä¸€ä¸ª<strong>è¿é€šå­æ ‘</strong>ï¼Œä½¿å¾—é‡é‡å’Œå°äºæŸä¸ªç»™å®šçš„ $V$ ä¸”æƒå€¼å’Œæœ€å¤§ã€‚</p><p>$n\leq 5000,V\leq 3000$ </p></blockquote><p>æ®è¯´æ˜¯ç»å…¸å¥—è·¯é¢˜ï¼Œä½†æˆ‘ä¸ä¼šâ€¦</p><p>è€ƒè™‘å¼ºåˆ¶é€‰æ ¹æ€ä¹ˆåšã€‚è€ƒè™‘ç›´æ¥æ ‘å½¢dpï¼Œåˆå¹¶ä¸¤ä¸ªå­æ ‘çš„èƒŒåŒ…å¤æ‚åº¦æ˜¯ $V^2$ çš„ã€‚äºæ˜¯è€ƒè™‘æ¢ä¸€ç§å¯ä»¥ä¸å»åˆå¹¶å­æ ‘çš„ $dp$ æ–¹å¼ã€‚è€ƒè™‘åœ¨ dfs åºä¸Šå¯¹è¿™ä¸ªä¸œè¥¿è¿›è¡Œdpï¼Œè®¾ä¸€ä¸ªç‚¹ $u$ å­æ ‘çš„èŒƒå›´æ˜¯ $p_u\sim r_{u}$ ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¾ $f_{i,v}$ è¡¨ç¤ºè€ƒè™‘äº† $i\sim n$ çš„ç‰©å“ï¼Œæ ¹å¿…é€‰ä¸”å®¹ç§¯ä¸º $v$ çš„æœ€å¤§ä»·å€¼ã€‚è€ƒè™‘è½¬ç§»ï¼Œå¯¹äºä¸€ä¸ª $i$ è€Œè¨€ï¼Œå¦‚æœé€‰äº†ä»–ï¼Œå°±å¯ä»¥ä» $i+1$ è½¬ç§»ï¼Œå¦åˆ™ç”±äºæ ¹å¿…é¡»è¢«é€‰ï¼Œ$i$ ä¸é€‰ï¼Œæ•´æ£µå­æ ‘éƒ½ä¸èƒ½é€‰ï¼Œæ‰€ä»¥åªèƒ½ä» $r_i+1$ è½¬ç§»è¿‡æ¥ã€‚äºæ˜¯è¿™æ ·çš„å¤æ‚åº¦å°±æ˜¯ $O(nv)$ çš„äº†ã€‚ </p><p>æš´åŠ›åšæ˜¯ $O(n^2v)$ çš„ï¼Œå¤æ‚åº¦ç“¶é¢ˆåœ¨äºæšä¸¾æ ¹ã€‚è€ƒè™‘ä¸€ä¸ªæ€§è´¨ï¼Œå°±æ˜¯å¦‚æœç‚¹ $v$ ä¸åœ¨ç­”æ¡ˆä¸­ï¼Œé‚£ä¹ˆä¸å…¶ç›¸é‚»çš„è¿é€šå—ä¸ä¼šäº’ç›¸é€šè¾¾ï¼Œå› ä¸ºæ ‘ä¸Šè·¯å¾„å”¯ä¸€ã€‚äºæ˜¯å°±å¯ä»¥è€ƒè™‘ç‚¹åˆ†ï¼Œç»è¿‡/ä¸ç»è¿‡æ ¹åˆ†åˆ«å¯¹åº”åˆ†æ²»ä¸‹å»å’Œè·¨è¿‡åˆ†æ²»ä¸­å¿ƒä¸¤ç§æƒ…å†µã€‚æœ€ç»ˆå¤æ‚åº¦ $nv\log n$ ã€‚</p><p>åœ¨åˆå¹¶çš„æ—¶å€™å¯èƒ½æœ‰äº¿ç‚¹ç»†èŠ‚éœ€è¦å»å†™â€¦233</p><h1 id="ç‚¹åˆ†æ ‘"><a href="#ç‚¹åˆ†æ ‘" class="headerlink" title="ç‚¹åˆ†æ ‘"></a>ç‚¹åˆ†æ ‘</h1><h2 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h2><p>å¯¹äºç‚¹åˆ†æ ‘ï¼Œæœ‰ä¸€ä¸ªå¾ˆä¼˜ç§€çš„æ€§è´¨ï¼Œå°±æ˜¯æ ‘é«˜ä¸è¶…è¿‡ $\log n$ ï¼Œå¯¹äºä¸€äº›é¢˜ç›®å¯ä»¥ç”¨è¿™ä¸ªæ€§è´¨è¿›è¡Œè½¬åŒ–ã€‚</p><blockquote><p>ç»™å®šä¸€æ£µæ— æƒæ ‘ï¼Œå•ç‚¹ä¿®æ”¹ï¼Œæ±‚è·ç¦» $x$ ä¸è¶…è¿‡ $r$ çš„ç‚¹æƒå’Œã€‚</p></blockquote><p>è€ƒè™‘å¦‚æœæ²¡æœ‰ä¿®æ”¹æ“ä½œæ—¶ï¼Œç›´æ¥æ±‚ä¹Ÿæ˜¯ä¸å¤ªå¥½æ±‚çš„ã€‚äºæ˜¯è€ƒè™‘ç‚¹åˆ†æ²»ï¼Œå¯¹äºæ¯ä¸ªåˆ†æ²»ä¸­å¿ƒï¼Œé¢„å¤„ç†è®°å½•ä¸€ä¸‹å­æ ‘ä¸­è·ç¦» $\leq k\quad (k=1,2,3\cdots )$ çš„ç‚¹æƒå’Œã€‚ æ³¨æ„åˆ°è¿™æœ€å¤šéœ€è¦ $n \log n$ çš„ç©ºé—´ï¼Œæ‹¿ <code>vector</code> å®ç°å³å¯ã€‚</p><p>é‚£ä¹ˆå¯¹äºè¯¢é—®è€Œè¨€ï¼Œç›´æ¥ä»ç‚¹åˆ†æ ‘ä¸Šæš´è·³ï¼Œæ¯è·³åˆ°ä¸€ä¸ªç‚¹åˆ†ä¸­å¿ƒ $p$ï¼Œå°±å¯ä»¥åŠ ä¸Šè¿™ä¸ªç‚¹è®°å½•çš„ $\leq r-(dep_p-dep_x)$ çš„ç‚¹æƒå’Œï¼Œå¹¶ä¸”å‡å»ä¸Šä¸€ä¸ªç‚¹åˆ†ä¸­å¿ƒå­æ ‘å†…éƒ¨ $\leq r-(dep_p-dep_x)$ çš„ç‚¹æƒå’Œã€‚ç”±äºç‚¹åˆ†æ ‘æ ‘é«˜çš„é™åˆ¶ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ $\log n$ çš„ã€‚</p><p>è€ƒè™‘å¦‚ä½•ä¿®æ”¹ï¼Œå‘ç°æœ¬è´¨ä¸Šä¿®æ”¹+è¯¢é—®æ˜¯ä¸€ä¸ªå•ç‚¹ä¿®æ”¹ï¼Œå‰ç¼€æŸ¥è¯¢çš„è¿‡ç¨‹ï¼Œäºæ˜¯å°±å¯ä»¥æ¢ç”¨æ ‘çŠ¶æ•°ç»„æ¥ç»´æŠ¤ï¼Œä¿®æ”¹æ—¶åªéœ€è¦æš´åŠ›è·³å³å¯ï¼Œè¿™æ ·æœ€ç»ˆå¤æ‚åº¦å°±æ˜¯ $m\log ^2 n$ çš„äº†ã€‚</p><h2 id="æ ‘ä¸ŠèƒŒåŒ…é—®é¢˜2"><a href="#æ ‘ä¸ŠèƒŒåŒ…é—®é¢˜2" class="headerlink" title="æ ‘ä¸ŠèƒŒåŒ…é—®é¢˜2"></a>æ ‘ä¸ŠèƒŒåŒ…é—®é¢˜2</h2><blockquote><p>ç»™å®šä¸€æ£µæ ‘ï¼Œæ ‘ä¸Šæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªæƒå€¼ä¸€ä¸ªé‡é‡ã€‚è¦æ±‚é€‰æ‹©ä¸€ä¸ª<strong>ç‹¬ç«‹é›†</strong>ï¼Œä½¿å¾—é‡é‡å’Œå°äºæŸä¸ªç»™å®šçš„ $V$ ä¸”æƒå€¼å’Œæœ€å¤§ã€‚</p><p>$n\leq 100,V\leq 30000$ </p></blockquote><p>è€ƒè™‘ä¸€ä¸ªæ¯”è¾ƒ <code>general</code> çš„ $dp$ ï¼Œè¿˜æ˜¯è·Ÿä¸Šä¸ªé¢˜ä¸€æ ·ï¼Œç›´æ¥åˆå¹¶èƒŒåŒ…æ˜¯ $V^2$ çš„ï¼Œæ‰€ä»¥è€ƒè™‘æŠŠè¿™æ£µæ ‘çš„ $dfs$ åºå†™ä¸‹æ¥ï¼Œç„¶å $f_{i,j,s}$ è¡¨ç¤ºè€ƒè™‘äº†å‰ $i$ ä¸ªç‚¹ï¼Œå®¹é‡ä¸º $j$ ï¼Œæ¯ä¸ªç‚¹é€‰ä¸é€‰è¡¨ç¤ºä¸ºé›†åˆ $s$ ï¼Œæœ€ç»ˆå¤æ‚åº¦å°±æ˜¯ $nv2^n$ ã€‚</p><p>è€ƒè™‘å¦‚ä½•å°‘è®°ä¸€ç‚¹ä¸œè¥¿ï¼Œä¼¼ä¹éœ€è¦æŠŠè¿™ä¸ª $2^n$ ç»™é™ä¸‹æ¥ã€‚äºæ˜¯è€ƒè™‘ç‚¹åˆ†æ²»ã€‚å‘ç°ç‚¹åˆ†æ²»çš„æ¯ä¸€å±‚ï¼Œå­æ ‘ä¹‹é—´éƒ½æ˜¯äº’ä¸å½±å“çš„ï¼Œæ‰€ä»¥åªéœ€è¦æŠŠç‚¹åˆ†æ ‘æ‰¾å‡ºæ¥ï¼Œå¯¹ç‚¹åˆ†æ ‘è¿›è¡Œæ ‘å½¢ $dp$ ï¼Œè®° $s$ æ—¶åªéœ€è¦è®°æ¯ä¸€å±‚çš„ç‚¹åˆ†ä¸­å¿ƒçš„çŠ¶æ€å³å¯ã€‚è¿™æ ·ç”±äºç‚¹åˆ†æ ‘é«˜æ˜¯ $O(\log n)$ çš„ï¼Œæ‰€ä»¥æœ€ç»ˆå¤æ‚åº¦æ˜¯ $O(nv2^{\log n})=O(n^2v)$ ã€‚</p><h2 id="ZJOI-2007-æ‰è¿·è—"><a href="#ZJOI-2007-æ‰è¿·è—" class="headerlink" title="ZJOI 2007 æ‰è¿·è—"></a>ZJOI 2007 æ‰è¿·è—</h2><blockquote><p>ä¿®æ”¹â¼€ä¸ªç‚¹çš„â¿Šç™½ï¼Œæ±‚æœ€è¿œâ¿Šç‚¹ä¹‹é—´è·ç¦»ã€‚</p></blockquote><p>è€ƒè™‘å¤§è‡´æ€è·¯å’Œã€Œå¼•å…¥ã€ä¸­å·®ä¸å¤šï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ç”±äºæ˜¯ç»Ÿè®¡æœ€é•¿çš„ç‚¹å¯¹é—´è·ç¦»ï¼Œæ‰€ä»¥ç”¨è¾¹åˆ†æ²»ä¼šå¥½åšä¸€äº›ã€‚é‚£ä¹ˆåˆ†æ²»çš„æ—¶å€™è¿˜æ˜¯éœ€è¦æŒ‰æ˜¯å¦ç»è¿‡åˆ†æ²»ä¸­å¿ƒæ¥åˆ†ç±»ã€‚ä¹‹åæ‹¿ä¸€ä¸ª multiset æ¥ç»´æŠ¤å°±å¥½äº†ã€‚</p><p>å—¯ï¼Œé™¤äº†è¾¹åˆ†ä¸ä¼šå†™ä¹‹å¤–ï¼Œæ²¡å•¥å¯è¯´çš„ã€‚</p><p>æ®è¯´è¿˜æœ‰ $1$ ä¸ª $\log $ çš„åšæ³•ï¼Œé‚£å¿…ç„¶æ˜¯é¸½äº†ã€‚</p><h1 id="è¡¥å……é¢˜ç›®"><a href="#è¡¥å……é¢˜ç›®" class="headerlink" title="è¡¥å……é¢˜ç›®"></a>è¡¥å……é¢˜ç›®</h1><h2 id="æŸä¸çŸ¥åCFé¢˜"><a href="#æŸä¸çŸ¥åCFé¢˜" class="headerlink" title="æŸä¸çŸ¥åCFé¢˜"></a>æŸä¸çŸ¥åCFé¢˜</h2><blockquote><p>ç»™ä¸€æ£µæ ‘ï¼Œç‚¹ã€è¾¹å‡æœ‰æƒï¼Œæ±‚ç‚¹ $x$ï¼Œæœ€å°åŒ– $\sum_{i=1}^{n} a_{i} \cdot \operatorname{dis}^{1.5}(i, x)$ ã€‚  $n \leq 10^{5}$ ã€‚</p></blockquote><p>äº‹å®ä¸Šæ˜¯ CF566C (é›¾</p><p>é¦–å…ˆå¯¹äº $1.5$ æ¬¡æ–¹çš„ $\sum $ï¼Œç”±äºç›¸åŠ ä¹‹åäºŒé˜¶å¯¼ä¾æ—§ $&gt;0$ ï¼Œæ‰€ä»¥ç›¸åŠ ä¹‹åä¾æ—§æ˜¯å‡¸å‡½æ•°ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå‡è®¾ $x$ å¯ä»¥åœ¨è¾¹ä¸Šéšä¾¿å–ï¼Œé‚£ä¹ˆå¯¹äºä¸€æ¡å›ºå®šçš„è·¯å¾„ $x\in(u,v)$ ï¼Œ $\mathrm{dis}(x,u)^{1.5}$ å¿…å®šæ˜¯ä¸€ä¸ªä¸‹å‡¸å‡½æ•°ã€‚</p><p>è€ƒè™‘åœ¨é“¾ä¸Šå¿…ç„¶æ˜¯äºŒåˆ†ï¼Œé‚£ä¹ˆè°ƒæ•´åˆ°æ ‘ä¸Šå°±å¯ä»¥è¿›è¡Œç‚¹åˆ†ã€‚è€ƒè™‘å¯¹äºæ¯ä¸ªç‚¹åˆ†ä¸­å¿ƒï¼Œéƒ½åº”è¯¥æ‰¾å¯ä»¥ä½¿ç­”æ¡ˆå˜å°çš„é‚£ä¸ªå„¿å­æ‰€åœ¨å­æ ‘ç‚¹ä½œä¸ºä¸‹ä¸€ä¸ªè¿›è¡Œç‚¹åˆ†çš„è¿é€šå—ã€‚è€ƒè™‘å¦‚ä½•å»å®ç°åˆ¤æ–­è¿™ä¸ªè¿‡ç¨‹ã€‚å¦‚æœç­”æ¡ˆå˜å°ï¼Œé‚£ä¹ˆä¸€å®šæ˜¯å¯¼æ•°å‡å°ï¼Œäºæ˜¯å¯ä»¥æ±‚å‡ºå­æ ‘ä¸­æ¯ä¸ªç‚¹å¯¹åº”å€¼çš„å¯¼æ•° $df_x$ï¼Œé‚£ä¹ˆæ€»ä½“çš„å¯¼æ•°å°±æ˜¯ $\sum df_x-2\cdot df_v&lt;0$ ï¼Œ$v$ æ˜¯ä¸‹ä¸€ä¸ªè¦è¿›è¡Œç‚¹åˆ†çš„å­æ ‘ï¼ŒåŸå› æ˜¯é€šè¿‡è®¡ç®—åç§»é‡ï¼Œå‰©ä½™çš„ç‚¹çš„ $f$ éƒ½ä¼šå˜å¤§ï¼Œå½“å‰ç‚¹ä¼šå˜å°ã€‚è¿™ä¸ªæ±‚å¯¼çš„è¿‡ç¨‹æœ¬è´¨ä¸Šæ˜¯åœ¨æ¨¡æ‹Ÿï¼Œæˆ‘å‘æ¯æ¡è¾¹ç§»åŠ¨ä¸€ä¸ª $\epsilon$ ä¹‹åçš„ç»“æœã€‚</p><p>äºæ˜¯å°±ç‚¹åˆ†è¿›è¡Œè¿™ä¸ªè¿‡ç¨‹å³å¯ï¼Œç‚¹åˆ†æ˜¯ä¸ºäº†åŠ é€Ÿè®¡ç®—æ¯ä¸ªå­æ ‘çš„ $df$ ï¼Œä¿è¯æœ€ç»ˆè¿™ä¸€éƒ¨åˆ†çš„è®¡ç®—é‡æ˜¯ $n\log n$ çš„ã€‚</p><h2 id="å¯è¾¾æ€§ç»Ÿè®¡"><a href="#å¯è¾¾æ€§ç»Ÿè®¡" class="headerlink" title="å¯è¾¾æ€§ç»Ÿè®¡"></a>å¯è¾¾æ€§ç»Ÿè®¡</h2><blockquote><p>ç»™å®šä¸€ä¸ªæœ‰å‘å›¾ï¼Œæ¯æ¬¡åŠ å…¥ä¸€æ¡è¾¹ $(u,v)$ï¼Œæˆ–è€…è¯¢é—®æœ‰å¤šå°‘ç‚¹å¯¹ä¸¤ä¸¤å¯è¾¾ã€‚</p></blockquote><p>è€ƒè™‘ä¸€ä¸ª<del>æ·±åˆ»çš„</del>å•è°ƒæ€§ï¼Œå¦‚æœåœ¨æŸä¸€æ—¶åˆ»å‡ºç°äº†ä¸€ä¸ªSCCï¼ŒæŠŠå®ƒç¼©èµ·æ¥ï¼Œé‚£ä¹ˆä¹‹åå®ƒä¹Ÿä¼šä¸€ç›´è¢«ç¼©èµ·æ¥ã€‚</p><p>äºæ˜¯è€ƒè™‘æ•´ä½“äºŒåˆ†ï¼Œ<code>solve(l,r,E)</code> è¡¨ç¤º $E$ ä¸­çš„è¾¹ä¼šåœ¨æ—¶åˆ» $l\sim r$ ä¸­è¢«ç¼©èµ·æ¥ã€‚äºæ˜¯æ¯æ¬¡æŠŠ $[l,mid]$ è¿™äº›è¾¹è·‘ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ï¼Œé‚£ä¹ˆè¢«ç¼©èµ·æ¥çš„è¾¹é€’å½’åˆ° <code>solve(l,mid,E1)</code> é‡Œé¢ï¼Œæ²¡è¢«ç¼©èµ·æ¥çš„è¾¹é€’å½’åˆ° <code>solve(mid+1,r,E2)</code> é‡Œé¢ã€‚åŒæ—¶ä¸ºäº†è®©åˆ†æ²»çš„å¤æ‚åº¦æ˜¯å¯¹çš„ï¼Œæ¯æ¬¡ç‚¹é›†å¤§å°ä¸èƒ½è·Ÿ $n$ æœ‰å…³ï¼Œäºæ˜¯å°±éœ€è¦æ¯æ¬¡åœ¨ <code>solve(l,mid,E1)</code> ä¹‹åæŠŠ E1é‡Œçš„ç‚¹æ‹¿å¹¶æŸ¥é›†ç»™ç¼©èµ·æ¥ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯ <code>solve(mid+1,r,E2)</code> çš„å¤æ‚åº¦åªè·Ÿè¾¹æ•°æœ‰å…³ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>åŠ¨æ€ç‚¹åˆ†æ²»æ˜¯ä¸å¯èƒ½çš„ï¼Œè¿™è¾ˆå­éƒ½ä¸å¯èƒ½çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¼¼ä¹ä¸»è¦æ˜¯ç‚¹åˆ†æ²»çš„ç›¸å…³å†…å®¹ï¼Ÿ&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="æ•°æ®ç»“æ„/ç‚¹åˆ†æ ‘" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%82%B9%E5%88%86%E6%A0%91/"/>
    
      <category term="æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/ç‚¹åˆ†æ²»" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%96%B9%E6%B3%95-%E7%82%B9%E5%88%86%E6%B2%BB/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘ä»å‰©ä½™ç±»åˆ°æ¬§æ‹‰å®šç†</title>
    <link href="https://www.orchidany.cn/2020/04/02/%E5%89%A9%E4%BD%99%E7%B1%BB%E7%9B%B8%E5%85%B3%E5%86%85%E5%AE%B9/"/>
    <id>https://www.orchidany.cn/2020/04/02/å‰©ä½™ç±»ç›¸å…³å†…å®¹/</id>
    <published>2020-04-02T14:17:44.000Z</published>
    <updated>2020-04-02T16:49:26.820Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ã€Œé‡å­¦4-6ã€ç³»åˆ—çš„æœ€åä¸€ç¯‡æ–‡ç« ã€‚</p><p>æ„Ÿè§‰å‰©ä½™ç±»è¿™éƒ¨åˆ†å†…å®¹ï¼Œä»¥çº¯æ•°è®ºçš„çœ¼å…‰å»çœ‹å¾…ï¼Œæ˜¯ååˆ†ä¼˜ç¾çš„ã€‚</p><p>å—¯ï¼Œå°†æ¥è‡ªå·±æŠ½ä»£çœŸæ­£å…¥é—¨ä¹‹åï¼Œå¯èƒ½å°±ä¼šå¤šä¸€ç‚¹åˆ«çš„è§’åº¦äº†å§ã€‚</p><a id="more"></a><h1 id="å‰©ä½™ç±»ç›¸å…³å®šä¹‰"><a href="#å‰©ä½™ç±»ç›¸å…³å®šä¹‰" class="headerlink" title="å‰©ä½™ç±»ç›¸å…³å®šä¹‰"></a>å‰©ä½™ç±»ç›¸å…³å®šä¹‰</h1><h2 id="å‰©ä½™ç±»"><a href="#å‰©ä½™ç±»" class="headerlink" title="å‰©ä½™ç±»"></a>å‰©ä½™ç±»</h2><p>å®šä¹‰ 1.1</p><blockquote><p>è®°åœ¨æ¨¡ $m$ æ„ä¹‰ä¸‹ï¼Œå…¨éƒ¨å¯¹ $m$ åŒä½™çš„æ•´æ•°ç»„æˆçš„é›†åˆï¼Œå«åš $m$ çš„ä¸€ä¸ªå‰©ä½™ç±»ã€‚</p></blockquote><p>é‚£ä¹ˆæ˜¾ç„¶å¯¹äºä¸€ä¸ªå›ºå®šçš„æ¨¡ $m$ï¼Œæœ‰ $m$ ä¸ªå‰©ä½™ç±»ï¼Œåˆ†åˆ«åŒä½™ $0,1,2\cdots m-1$ï¼Œåˆ†åˆ«è®°ä½œ $\mathrm{ Z}_{m,0},\mathrm{ Z}_{m,1},\mathrm{ Z}_{m,2}\cdots,\mathrm{ Z}_{m,m-1}$ ã€‚è®°æ‰€ä»¥å‰©ä½™ç±»ç»„æˆçš„é›†åˆæ˜¯ $\mathrm{ Z}_{m}$ ã€‚</p><p>è€ƒè™‘å®šä¹‰å‰©ä½™ç±»ä¹‹é—´çš„è¿ç®— $+$ å’Œ $\times $ ï¼š</p><script type="math/tex; mode=display">\mathrm{ Z}_{m,a}+\mathrm{ Z}_{m,b}=\mathrm{ Z}_{m,a+b}\\\mathrm{ Z}_{m,a}\times \mathrm{ Z}_{m,b}=\mathrm{ Z}_{m,a\times b}</script><p>å…¶ä¸­ $a+b$ å’Œ $a\times b$ æ˜¯åœ¨æ¨¡ $m$ æ„ä¹‰ä¸‹çš„æ•°åŠ å’Œæ•°ä¹˜ã€‚å¹¶ä¸”å¯ä»¥çŸ¥é“ï¼Œå¯¹äºå…¨ä½“æ¨¡ $m$ æ„ä¹‰ä¸‹çš„å‰©ä½™ç±» $\mathrm{ Z}_{m}$ è€Œè¨€ï¼Œ$&lt;\mathrm{ Z}_{m},+,\times&gt;$ æœ¬èº«æ˜¯ä¸€ä¸ªç¯ã€‚è€ƒè™‘å¦‚ä¸‹ï¼š</p><p>1ã€é¦–å…ˆ $(\mathrm{ Z}_{m},+)$ æ˜¾ç„¶æ˜¯ä¸€ä¸ªé˜¿è´å°”ç¾¤ã€‚</p><p>2ã€å…¶æ¬¡ $(\mathrm{ Z}_{m},\times )$ æ˜¾ç„¶å…·æœ‰ç»“åˆå¾‹ï¼Œä½†æ˜¯å¦‚æœå¯¹äºæŸä¸ªå‰©ä½™ç±» $\mathrm{ Z}_{m,p}$ $(p,m)&gt;1$ ï¼Œå°±è¯´æ˜äº† $\mathrm{ Z}_{m,p}$ æœ¬èº«ä¸å­˜åœ¨é€†å…ƒ ï¼Œæ‰€ä»¥å¯çŸ¥é“ $(\mathrm{ Z}_{m},\times )$ æ˜¯ä¸€ä¸ªåŠç¾¤ã€‚</p><p>3ã€åŒæ—¶å¯çŸ¥åœ¨ $(\mathrm{ Z}_{m},\times )$ ä¸­ï¼Œé«˜ä¼˜å…ˆçº§è¿ç®— $\times $ å¯¹ä½ä¼˜å…ˆçº§è¿ç®— $+$ æœ‰åˆ†é…å¾‹ã€‚</p><p>ç»¼ä¸Šï¼Œ$(\mathrm{ Z}_{m},+,\times )$ æ˜¯ä¸€ä¸ªç¯ã€‚å¹¶ä¸”ä¸éš¾çŸ¥é“ $\mathrm{ Z}_{m,0}$ å°±æ˜¯è¿™ä¸ªç¯ä¸­çš„é›¶å…ƒã€‚</p><p>ä½†æ˜¯è¿™ä¸ªç¯å¹¶ä¸æ˜¯æ­£åˆ™ç¯ã€‚è€ƒè™‘æˆ‘ä»¬ç†ŸçŸ¥çš„æ­£åˆ™ç¯ $&lt;\mathbb Z,+,\times&gt;$ å’Œ $&lt;\mathbb R,+,\times &gt;$ å†…éƒ½ä¸å­˜åœ¨é›¶å› å­ $a,b$ ä½¿å¾— $a\not =0,b\not = 0$ ä¸” $a\times b=0$ ã€‚ä½†æ˜¯åœ¨æ¨¡è¿ç®—ä¸‹è¿™æ˜¯å¯èƒ½æˆç«‹çš„ï¼Œæ¯”å¦‚å¯ä»¥è®¾ $m=pq$ ï¼Œå…¶ä¸­ $p\not \equiv q\pmod m$ï¼Œé‚£ä¹ˆå°±æœ‰ $\mathrm{ Z}_{m,p} \times \mathrm{ Z}_{m,q}=\mathrm{ Z}_{m,0}$ ï¼Œæ­¤æ—¶ $p,q$ å°±å‡ä¸º $\mathrm{ Z}_{m}$ çš„é›¶å› å­ã€‚æ‰€ä»¥å¯çŸ¥å‰©ä½™ç±»ç¯å¹¶ä¸æ˜¯æ­£åˆ™çš„ã€‚</p><h2 id="äº’ç´ å‰©ä½™ç±»"><a href="#äº’ç´ å‰©ä½™ç±»" class="headerlink" title="äº’ç´ å‰©ä½™ç±»"></a>äº’ç´ å‰©ä½™ç±»</h2><h3 id="å®šä¹‰1-2"><a href="#å®šä¹‰1-2" class="headerlink" title="å®šä¹‰1.2"></a>å®šä¹‰1.2</h3><blockquote><p>è‹¥å¯¹äºä¸€ä¸ªæ¨¡ $m$ æ„ä¹‰ä¸‹çš„å‰©ä½™ç±» $\mathrm{ Z}_{m,k}$ æ»¡è¶³ $(m,k)=1$ ï¼Œé‚£ä¹ˆç§° $\mathrm{ Z}_{m,k}$ ä¸ºæ¨¡ $m$ çš„ä¸€ä¸ªäº’ç´ å‰©ä½™ç±»ã€‚</p></blockquote><p>ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œè®°æŸä¸ªäº’ç´ å‰©ä½™ç±» $\mathrm{ Z}_{m,k}$ ä¸º $\mathrm{\zeta}_{m,k}$ ã€‚åŒæ—¶å¯çŸ¥è¿™æ ·çš„ $\mathrm{\zeta}_{m,k}$ å…±æœ‰ $\varphi(m)$ ä¸ªã€‚</p><h1 id="å‰©ä½™ç³»"><a href="#å‰©ä½™ç³»" class="headerlink" title="å‰©ä½™ç³»"></a>å‰©ä½™ç³»</h1><h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><h3 id="å®šä¹‰2-1"><a href="#å®šä¹‰2-1" class="headerlink" title="å®šä¹‰2.1"></a>å®šä¹‰2.1</h3><blockquote><p>å¦‚æœå¯¹äºä¸€ä¸ªé›†åˆ $\rm S$ ï¼Œæ»¡è¶³ $\mathrm{|S|}=m$ ä¸” $\forall i\not=j,i\in \mathrm{S},j\in \mathrm{S}$ æœ‰</p><script type="math/tex; mode=display">i\in\mathrm{ Z}_{m,p}, j \in \mathrm{ Z}_{m,q}, \mathrm{ Z}_{m,p}\not=\mathrm{ Z}_{m,q}</script><p>é‚£ä¹ˆè®°è¿™ä¸ªé›†åˆä¸ºæ¨¡ $m$ çš„ä¸€ä¸ªå®Œå…¨å‰©ä½™ç³»ã€‚</p></blockquote><h3 id="å®šä¹‰2-2"><a href="#å®šä¹‰2-2" class="headerlink" title="å®šä¹‰2.2"></a>å®šä¹‰2.2</h3><blockquote><p>å¦‚æœå¯¹äºä¸€ä¸ªé›†åˆ $\rm S$ ï¼Œæ»¡è¶³ $\mathrm{|S|}=m$ ä¸” $\forall i\not=j,i\in \mathrm{S},j\in \mathrm{S}$ æœ‰</p><script type="math/tex; mode=display">i\in\mathrm{ \zeta}_{m,p}, j \in \mathrm{ \zeta}_{m,q}, \mathrm{ \zeta}_{m,p}\not=\mathrm{ \zeta}_{m,q}</script><p>é‚£ä¹ˆè®°è¿™ä¸ªé›†åˆä¸ºæ¨¡ $m$ çš„ä¸€ä¸ªç®€åŒ–å‰©ä½™ç³»ã€‚</p></blockquote><p>å¯çŸ¥æ¨¡ $m$ çš„ä¸€ä¸ªå®Œå…¨å‰©ä½™ç³»çš„å¤§å°æ˜¯ $m$ ï¼Œä¸€ä¸ªç®€åŒ–å‰©ä½™ç³»çš„å¤§å°æ˜¯ $\varphi(m)$ ã€‚</p><h2 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h2><h3 id="å®šç†2-1"><a href="#å®šç†2-1" class="headerlink" title="å®šç†2.1"></a>å®šç†2.1</h3><blockquote><p>è®¾ $m\in \mathbb Z_+$ï¼Œ$k,p\in \mathbb Z$ ä¸” $(k,m)=1$ ï¼Œåˆ™</p><p>ï¼ˆ1ï¼‰å½“ $x$ éå†æ¨¡ $m$ çš„ä¸€ä¸ªå®Œå…¨å‰©ä½™ç³» $\mathrm{S}$ æ—¶ï¼Œ$kx+p$ ä¹Ÿéå†æ¨¡ $m$ çš„ä¸€ä¸ªå®Œå…¨å‰©ä½™ç³» $\mathrm{Sâ€™}$ ã€‚</p><p>ï¼ˆ2ï¼‰å½“ $x$ éå†æ¨¡ $m$ çš„ä¸€ä¸ªç®€åŒ–å‰©ä½™ç³» $\mathrm{T}$ æ—¶ï¼Œ$kx$ ä¹Ÿéå†æ¨¡ $m$ çš„ä¸€ä¸ªç®€åŒ–å‰©ä½™ç³» $\mathrm{Tâ€™}$ ã€‚</p></blockquote><p>è¯ï¼š</p><p>ï¼ˆ1ï¼‰è€ƒè™‘åªéœ€è¦è¯å¯¹äºä»»æ„ä¸¤ä¸ªæ¨¡ $m$ ä¸‹ä¸åŒä½™çš„ $x_i,x_j$ ï¼Œ $kx_i+p,kx_j+p$ ä¹Ÿæ˜¯ä¸åŒä½™çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—è¯ã€‚</p><p>è€ƒè™‘åè¯æ³•ã€‚è‹¥ $kx_i+p\equiv kx_j+p\pmod m$ï¼Œåˆ™æœ‰</p><script type="math/tex; mode=display">kx_i\equiv kx_j\pmod m</script><p>é‚£ä¹ˆç”±äº $(k,m)=1$ ä¸”æ ¹æ®å®šç†</p><blockquote><p>è‹¥ $ac\equiv bc\pmod m$ï¼Œä¸” $(m,c)=d$ï¼Œåˆ™ $a\equiv b \pmod{\frac{m}{d}}$ ã€‚</p></blockquote><p>å¯çŸ¥ $x_i\equiv x_j\pmod m$ ã€‚çŸ›ç›¾ã€‚</p><p>ï¼ˆ2ï¼‰ç”±ï¼ˆ1ï¼‰å¯ä»¥çŸ¥é“ $kx_i$ å½¼æ­¤ä¹‹é—´ä¸åŒä½™ï¼Œä¸”å› ä¸º $(k,x_i)=(k,m)=1$ ï¼Œæ‰€ä»¥å¯çŸ¥éå†çš„æ˜¯ä¸€ä¸ªç®€åŒ–å‰©ä½™ç³»ã€‚</p><h3 id="å®šç†2-2"><a href="#å®šç†2-2" class="headerlink" title="å®šç†2.2"></a>å®šç†2.2</h3><blockquote><p>è®¾ $(m_1,m_2)=1$ ï¼Œåˆ™ï¼š</p><p>ï¼ˆ1ï¼‰å½“ $x,y$ åˆ†åˆ«éå†æ¨¡ $m_1,m_2$ çš„ä¸€ä¸ªå®Œå…¨å‰©ä½™ç³»æ—¶ï¼Œ$m_2x+m_1y$ ä¹Ÿéå†æ¨¡ $m_1m_2$ çš„ä¸€ä¸ªå®Œå…¨å‰©ä½™ç³»ã€‚</p><p>ï¼ˆ2ï¼‰å½“ $x,y$ åˆ†åˆ«éå†æ¨¡ $m_1,m_2$ çš„ä¸€ä¸ªç®€åŒ–å‰©ä½™ç³»æ—¶ï¼Œ$m_2x+m_1y$ ä¹Ÿéå†æ¨¡ $m_1m_2$ çš„ä¸€ä¸ªç®€åŒ–å‰©ä½™ç³»ã€‚</p></blockquote><p>è¯ï¼š</p><p>ï¼ˆ1ï¼‰</p><p>è¿˜æ˜¯ä»è¯æ˜äº’ä¸åŒä½™è¿™æ–¹é¢æ¥è€ƒè™‘ã€‚å¦‚æœå­˜åœ¨ $x_1,x_2,y_1,y_2$ ä½¿å¾—</p><script type="math/tex; mode=display">m_{2} x_{1}+m_{1} y_{1} \equiv m_{2} x_{2}+m_{1} y_{2}\pmod {m_{1} m_{2}}</script><p>é‚£ä¹ˆé¦–å…ˆæœ‰</p><script type="math/tex; mode=display">m_{2} x_{1}+m_{1} y_{1} \equiv m_{2} x_{2}+m_{1} y_{2}\pmod {m_{1}}</script><p>å³</p><script type="math/tex; mode=display">m_{2} x_{1} \equiv m_{2} x_{2}\pmod {m_{1}}</script><p>é‚£ä¹ˆå› ä¸º $(m_1,m_2)=1$ ï¼Œæ‰€ä»¥æœ‰</p><script type="math/tex; mode=display">x_{1} \equiv x_{2}\pmod {m_{1}}</script><p>åŒç†å¯çŸ¥</p><script type="math/tex; mode=display">y_{1} \equiv y_{2}\pmod {m_{1}}</script><p>é‚£ä¹ˆå°±å¯ä»¥çŸ¥é“ï¼Œå½“ $x_1,x_2$ ä¸åŒä½™ï¼Œ$y_1,y_2$ ä¸åŒä½™çš„æ—¶å€™ï¼Œ$m_2x+m_1y$ ä¹Ÿæ˜¯ä¸åŒä½™çš„ã€‚</p><p>ï¼ˆ2ï¼‰</p><p>é¦–å…ˆç”±äº $(x,m_1)=(y,m_2)=1$ ï¼Œæ‰€ä»¥ $(m_2x+m_1y,m_1)=1$ ä¸” $(m_2x+m_1y,m_2)=1$ï¼Œæ‰€ä»¥å¯çŸ¥ $m_2x+m_1y$ ä¸€å®šä¼šå±äº $m_1m_2$ çš„ç®€åŒ–å‰©ä½™ç³»ã€‚åŒæ—¶ç”±ï¼ˆ1ï¼‰ä¸­çš„ç»“è®ºå¯çŸ¥è¿™ $\varphi(n)\varphi(m)$ ä¸ªç»“æœæ˜¯ä¸¤ä¸¤ä¸åŒä½™çš„ã€‚äºæ˜¯å°±åªéœ€è¦è¯æ˜ $m_1m_2$ çš„ç®€åŒ–å‰©ä½™ç³»ä¸­ï¼Œå‡å±äºè¿™ $\varphi(n)\varphi(m)$ ä¸ªå…ƒç´ ç»„æˆçš„é›†åˆå³å¯ã€‚</p><p>å¯¹äºä»»æ„ä¸€ä¸ªä¸ $m_1m_2$ äº’è´¨çš„å…ƒç´  $q$ï¼Œç”±ï¼ˆ1ï¼‰å¯çŸ¥å¿…å®šå­˜åœ¨ä¸€ç»„ $(s,t)$ ä½¿å¾—</p><script type="math/tex; mode=display">q\equiv m_2s+m_1t\pmod {m_1m_2}</script><p>è€ƒè™‘è‹¥ $(s,m_1)&gt;1$ ï¼Œåˆ™æœ‰æŸä¸ª$d&gt;1,d|s$ æ»¡è¶³ $d|m_1\Longrightarrow d|m_1m_2$ çš„åŒæ—¶ $d|q$ ï¼Œé‚£ä¹ˆ $(m_1m_2,q)\geq d$ ï¼Œä¸ç¬¦åˆäº’è´¨çš„å‡è®¾ã€‚æ•…å¯çŸ¥ $(s,m_1)=1$ ï¼ŒåŒç† $(t,m_2)=1$ ï¼Œæ•…è¯æ¯•ã€‚</p><h2 id="æ¨è®º"><a href="#æ¨è®º" class="headerlink" title="æ¨è®º"></a>æ¨è®º</h2><p>ç”±å®šç† 2.2(2) å¯çŸ¥ï¼Œåˆ†åˆ«éå†æ¨¡ $m_1$ å’Œ $m_2$ çš„ç®€åŒ–å‰©ä½™ç³»çš„ $x$ å’Œ $y$ ï¼Œåœ¨ $(m_1,m_2)=1$ æ—¶ï¼Œ$m_1y+m_2x$ éå†æ¨¡ $m_1m_2$ çš„ä¸€ä¸ªç®€åŒ–å‰©ä½™ç³»ã€‚ æ ¹æ®ä¹˜æ³•åŸç†ï¼Œå¯ä»¥å¾—åˆ° $\varphi(m_1)\cdot \varphi(m_2)=\varphi(m_1m_2)$ ã€‚</p><p>è¿™ä¹Ÿå°±è¯æ˜äº†æ¬§æ‹‰å‡½æ•° $\varphi(x)$ æ˜¯ç§¯æ€§å‡½æ•°ã€‚</p><h1 id="æ¬§æ‹‰å®šç†"><a href="#æ¬§æ‹‰å®šç†" class="headerlink" title="æ¬§æ‹‰å®šç†"></a>æ¬§æ‹‰å®šç†</h1><blockquote><p>è‹¥ $(a,m)=1$ ï¼Œåˆ™æœ‰ $a^{\varphi(m)}\equiv 1\pmod m$ .</p></blockquote><p>è‹¥è®¾ $(x_1,x_2,x_3\cdots x_{\varphi(m)})$ æ˜¯æ¨¡ $m$ çš„ä¸€ä¸ªç®€åŒ–å‰©ä½™ç³»ï¼Œé‚£ä¹ˆç”±å®šç†2.1(2)å¯çŸ¥ $(ax_1,ax_2,ax_3\cdots ax_{\varphi(m)})$ ä¹Ÿæ˜¯æ¨¡ $m$ çš„ä¸€ä¸ªç®€åŒ–å‰©ä½™ç³»ã€‚æ‰€ä»¥æœ‰</p><script type="math/tex; mode=display">\prod_{i=1}^{\varphi(m)} x_i\equiv \prod_{i=1}^{\varphi(m)} ax_i\pmod m</script><p>é‚£ä¹ˆç”±äº $\forall i,(x_i,m)=1$ï¼Œæ‰€ä»¥ $(\prod x_i,m)=1$ ã€‚äºæ˜¯æ¶ˆä¸€ä¸‹å¯ä»¥å¾—åˆ°</p><script type="math/tex; mode=display">1\equiv a^{\varphi(m)}\pmod m</script><p>è¯æ¯•ã€‚</p><h1 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h1><p>ä¸ªäººæ„Ÿè§‰å‰©ä½™ç±»è¿™éƒ¨åˆ†æ˜¯å¾ˆæœ‰è¶£çš„ï¼Œè™½ç„¶ä»¥ä¸Šå†…å®¹å¤§éƒ¨åˆ†éƒ½æ˜¯4-6é‡Œé¢æç‚¼å‡ºæ¥çš„ã€‚å¯¹äºæ¬§æ‹‰å®šç†ï¼Œç”¨ç¾¤è®ºçŸ¥è¯†è¯æ˜åŒæ ·ååˆ†ç®€æ´ã€‚</p><p>æ€»ä¹‹ï¼Œå®Œç»“å•¦ï¼Œæ’’èŠ±èŠ±ã€‚</p><p>æ•°è®º4-6ï¼Œä¹Ÿç®—æ˜¯æˆ‘çš„ä¸€åœºæŒç»­äº†ä¸‰å¹´çš„æ˜¥èŠ±æ—§æ¢¦äº†å§ã€‚</p><p>ä¸çŸ¥é“å•¥æ—¶å€™èƒ½å’ŒEIå’Œrqyä¸€æ ·æœ‰å¯¹æ•°å­¦çŸ¥è¯†çš„æ·±åˆ»è®¤è¯†ã€‚æ…¢æ…¢æ¥å§ã€‚åªæœ‰ç«™åœ¨è¶Šé«˜å¤„ï¼Œæ‰èƒ½çœ‹åˆ°è¶Šå¹¿çš„é£æ™¯ï¼Œä¸æ˜¯å—ï¼Ÿ</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ã€Œé‡å­¦4-6ã€ç³»åˆ—çš„æœ€åä¸€ç¯‡æ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;æ„Ÿè§‰å‰©ä½™ç±»è¿™éƒ¨åˆ†å†…å®¹ï¼Œä»¥çº¯æ•°è®ºçš„çœ¼å…‰å»çœ‹å¾…ï¼Œæ˜¯ååˆ†ä¼˜ç¾çš„ã€‚&lt;/p&gt;
&lt;p&gt;å—¯ï¼Œå°†æ¥è‡ªå·±æŠ½ä»£çœŸæ­£å…¥é—¨ä¹‹åï¼Œå¯èƒ½å°±ä¼šå¤šä¸€ç‚¹åˆ«çš„è§’åº¦äº†å§ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://www.orchidany.cn/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="æ•°å­¦/æ•°è®º" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E6%95%B0%E8%AE%BA/"/>
    
      <category term="æ•°å­¦/æŠ½è±¡ä»£æ•°/ç¯è®º" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0-%E7%8E%AF%E8%AE%BA/"/>
    
      <category term="æ•°å­¦/ç§¯æ€§å‡½æ•°/æ¬§æ‹‰åæ¼”" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0-%E6%AC%A7%E6%8B%89%E5%8F%8D%E6%BC%94/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘[æ¹–åŒ—çœé˜Ÿäº’æµ‹2014week1 B] ä¸€ä¸ªäººçš„æ•°è®º</title>
    <link href="https://www.orchidany.cn/2020/04/01/%E4%B8%80%E4%B8%AA%E4%BA%BA%E7%9A%84%E6%95%B0%E8%AE%BA/"/>
    <id>https://www.orchidany.cn/2020/04/01/ä¸€ä¸ªäººçš„æ•°è®º/</id>
    <published>2020-04-01T14:26:51.000Z</published>
    <updated>2020-04-02T17:38:01.029Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>ç»™å®š $n$ çš„è´¨å› æ•°åˆ†è§£ $n= \prod _{i=1}^kp^{a_{i}}$ï¼Œæ±‚æ‰€æœ‰å°äº $n$ ä¸”ä¸ $n$ äº’è´¨çš„æ­£æ•´æ•°çš„ $m$ æ¬¡æ–¹ä¹‹å’Œæ¨¡ $10^9 +7$ çš„å€¼ã€‚å…¶ä¸­ $p_i$ ä¸ºè´¨æ•°ä¸”ä¸è¶…è¿‡ $10^9$ ã€‚</p><p>$a_i â‰¤ 10^9,k â‰¤ 1000,m â‰¤ 100$ã€‚</p></blockquote><a id="more"></a><p>å†™å‡ºå¼å­æ¥</p><script type="math/tex; mode=display">\begin{aligned}&\sum_{i=1}^n[(i,n)=1]i^m\\=&\sum_{i=1}^ni^m\sum_{d|i,d|n}\mu(d)\\=&\sum_{d|n}d^m\mu(d)\sum_{i=1}^{\lfloor \frac{n}{d}\rfloor}  i^m\end{aligned}</script><p>ç„¶åå‘ç°è¿™ä¸œè¥¿å¥½åƒä¸æ˜¯å®¹æ˜“æå‰é¢„å¤„ç†ã€‚æ ¹æ®ä¼¯åŠªåˆ©æ•°çš„æ¨è®ºï¼Œå¯ä»¥çŸ¥é“ $\sum i^m$ è¿™ä¸œè¥¿æ˜¯ä¸€ä¸ªå…³äºä¸Šç•Œ $n$ çš„ $m+1$ æ¬¡å¤šé¡¹å¼ã€‚å‘ç° $m$ å¹¶ä¸å¤§äºæ˜¯å¯ä»¥ $O(m^2)$ æ’å‡ºæ¥ã€‚ è‹¥è®°è¿™ä¸ªå¤šé¡¹å¼æ˜¯ $f$ ï¼Œé‚£ä¹ˆåŸå¼å°±ç­‰ä»·äº</p><script type="math/tex; mode=display">\sum_{d|n}d^m\mu(d)\sum_{i=1}^{m+1} f_i\left(\lfloor\frac{n}{d}\rfloor\right) ^ i</script><p>ç¨å¾®åŒ–ä¸€ä¸‹å°±æ˜¯</p><script type="math/tex; mode=display">=\sum_{i=0}^{m+1} f_{i} \sum_{d | n} d^{m} \mu(d)\left(\frac{n}{d}\right)^{i}</script><p>å‘ç°å¯¹äºåé¢çš„ $\sum $ åªéœ€è¦æ±‚å‡ºæ¯ä¸ª $p_i^{a_i}$ å¤„çš„å€¼ï¼Œç„¶åæ¯æ¬¡ $O(k)$ æš´åŠ›åˆå¹¶ï¼Œä¼¼ä¹ä¹Ÿæ²¡å•¥é—®é¢˜ã€‚è€ƒè™‘å¯¹äºæ¯ä¸ª $p_i^{a_{i}}$ æ€ä¹ˆæ±‚ã€‚è¿™ä¸ªåœ°æ–¹å¤§æ¦‚éœ€è¦æ¶¨ä¸ªç»éªŒï¼Œå°±æ˜¯ $\mu(d)$ è¿™ä¸œè¥¿åªæœ‰å½“ $d=1$ å’Œ $d=p_i$ çš„æ—¶å€™æ‰æœ‰å€¼(æ— å¹³æ–¹å› å­,å‰©ä¸‹çš„å› å­éƒ½æ˜¯ $p_i$ çš„æŸä¸ªæ¬¡æ•° $&gt;2$ çš„å¹‚)ï¼Œæ‰€ä»¥æ¯ä¸ªåªéœ€è¦ç®—ä¸¤æ¬¡ï¼Œæ˜¯ $O(1)$ çš„ã€‚äºæ˜¯æœ€åçš„å¤æ‚åº¦ $O(m(m+k))$ ã€‚</p><p>å¥½ç¥å•Šå¥½ç¥å•Šã€‚</p><p>å“ˆå“ˆå“ˆå“ˆå“ˆè‰è¿™ä¸ªé¢˜å±…ç„¶å…è®¸ç”¨é«˜æ–¯æ¶ˆå…ƒæ¥ä»£æ›¿æ’å€¼ã€‚æ¯•ç«Ÿ $m$ åªæœ‰ $100$ ã€‚</p><p>ç„¶åå…³äºæ‹‰æ’ï¼Œæ„Ÿè§‰å¾ˆggï¼Œå› ä¸ºä¸€å…±æœ‰ä¸‰ä¸ªç‰ˆæœ¬çš„æ‹‰æ’ï¼Œæ±‚å€¼å’Œæ±‚ç³»æ•°ï¼Œæ±‚å€¼çš„åˆåˆ†ä¸º $x$ è¿ç»­/ä¸è¿ç»­çš„ã€‚äºæ˜¯ä»Šå¤©å°±æŠŠä¸‰ä¸ªç‰ˆæœ¬éƒ½å†™äº†ä¸€éâ€¦â€¦</p><p>ä¸è¿‡æœ‰ä¸€è¯´ä¸€ï¼Œæ±‚ç³»æ•°çš„æ‹‰æ’æ„Ÿè§‰å°±æ˜¯åœ¨æ¨¡æ‹Ÿã€‚ç„¶åæˆ‘è¿˜å¯¹ç€å¤šé¡¹å¼é™¤æ³•(æ•´é™¤ä»¥ä¸€ä¸ªå½¢å¦‚ $(x+t)$ çš„å¤šé¡¹å¼)æ‘¸äº†å¥½ä¹…ï¼Œä¸€ç›´æ„Ÿè§‰å¾ˆè¿·ä¹±ï¼Œåæ¥ç”¨äº†ç”¨å¤§é™¤æ³•ï¼Œå‘ç°å°±æ˜¯åœ¨æ¨¡æ‹Ÿå¤§é™¤æ³•çš„è¿‡ç¨‹ç½¢äº†ã€‚</p><p>ç„¶åä¸€å¼€å§‹æˆ‘è¿˜æ†¨æ†¨çš„å†™äº†ä¸ªçº¿æ€§ç­›ï¼Œç„¶åå‘ç° $\mu(d)$ çš„ $d$ æ˜¯ $1e9$ çš„ï¼Œå°±æ‡µåœˆäº†ï¼Œç„¶ååˆå‘ç° $\mu(d)$ åªä¼šæ˜¯ $1/-1$ å¹¶ä¸”å¾ˆå¥½åˆ¤æ–­ï¼Œäºæ˜¯æ„Ÿè§‰è‡ªå·±æ˜¯ä¸ªsbã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ; </span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000010</span> ; </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1000000007</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, k ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">int</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Interpolation&#123;</span><br><span class="line"><span class="keyword">int</span> ans ; </span><br><span class="line"><span class="keyword">int</span> now ; </span><br><span class="line"><span class="keyword">int</span> x[N] ;</span><br><span class="line"><span class="keyword">int</span> y[N] ;</span><br><span class="line"><span class="keyword">int</span> fac[N] ; </span><br><span class="line"><span class="keyword">int</span> inv[N] ; </span><br><span class="line"><span class="keyword">int</span> pres[N] ; </span><br><span class="line"><span class="keyword">int</span> sufs[N] ; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span> ;</span><br><span class="line">a = (a % P + P) % P ;</span><br><span class="line"><span class="keyword">while</span> (b)&#123;</span><br><span class="line"><span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">res = (ll)res * a % P ; </span><br><span class="line">a = (ll)a * a % P ; b &gt;&gt;= <span class="number">1</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> fz[N] ;</span><br><span class="line"><span class="keyword">int</span> fm[N] ; </span><br><span class="line"><span class="keyword">int</span> tmp[N] ;</span><br><span class="line"><span class="keyword">int</span> res[N] ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">a += b ;</span><br><span class="line"><span class="keyword">if</span> (a &gt; P) a -= P ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">(a -= b) %= P ;</span><br><span class="line"><span class="keyword">if</span> (a &lt; <span class="number">0</span>) a += P ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fmul</span><span class="params">(<span class="keyword">int</span> *t, <span class="keyword">int</span> deg, <span class="keyword">int</span> opt)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = deg + <span class="number">1</span> ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">tmp[i] = t[i], t[i] = t[i - <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= deg + <span class="number">1</span> ; ++ i)</span><br><span class="line">add(t[i], (ll)opt * tmp[i] % P) ;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fdiv</span><span class="params">(<span class="keyword">int</span> *t, <span class="keyword">int</span> *ret, <span class="keyword">int</span> deg, <span class="keyword">int</span> opt)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= deg ; ++ i) tmp[i] = t[i] ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = deg - <span class="number">1</span> ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">ret[i] = tmp[i + <span class="number">1</span>], dec(tmp[i], (ll)tmp[i + <span class="number">1</span>] * opt % P) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_xs</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">fz[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">fmul(fz, i, (-x[i] + P) % P) ;</span><br><span class="line"><span class="comment">//debug(fz, 1, n + 1, '\n') ;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line"><span class="keyword">int</span> fenmu = <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line"><span class="keyword">if</span> (i != j) fenmu = (ll)fenmu * (x[i] - x[j] + P) % P ;</span><br><span class="line">fdiv(fz, fm, n + <span class="number">1</span>, -x[i]) ; </span><br><span class="line">fenmu = (ll)y[i] * expow(fenmu, P - <span class="number">2</span>) % P ;</span><br><span class="line"><span class="comment">//cout &lt;&lt; fenmu &lt;&lt; endl ; </span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">add(res[j], (ll)fenmu * fm[j] % P) ;</span><br><span class="line"><span class="comment">//debug(res, 1, n, '\n') ;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre_do</span><span class="params">(<span class="keyword">int</span> U)</span></span>&#123;</span><br><span class="line">fac[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line">fac[i] = (ll)fac[i - <span class="number">1</span>] * i % P ;</span><br><span class="line">inv[U] = expow(fac[U], P - <span class="number">2</span>) ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = U ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">inv[i - <span class="number">1</span>] = (ll)inv[i] * i % P ;</span><br><span class="line"><span class="comment">//debug(fac, 1, U, '\n') ;</span></span><br><span class="line"><span class="comment">//debug(inv, 1, U, '\n') ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">evenmark</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (x &amp; <span class="number">1</span>) ? <span class="number">-1</span> : <span class="number">1</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_dnx</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k, <span class="keyword">bool</span> m)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (m)&#123;</span><br><span class="line">pre_do(n) ;</span><br><span class="line">pres[<span class="number">0</span>] = <span class="number">1</span>, sufs[n + <span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">pres[i] = ((ll)pres[i - <span class="number">1</span>] * (k - x[i]) % P + P) % P ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">sufs[i] = ((ll)sufs[i + <span class="number">1</span>] * (k - x[i]) % P + P) % P ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">now = (ll)pres[i - <span class="number">1</span>] * sufs[i + <span class="number">1</span>] % P ;</span><br><span class="line">now = (ll)now * expow((ll)fac[i - <span class="number">1</span>] * fac[n - i] % P, P - <span class="number">2</span>) % P ;</span><br><span class="line">now = (ll)evenmark(n - i) * y[i] % P * now % P ; ans = (ll)(ans + now) % P ; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> inow = <span class="number">1</span> ;</span><br><span class="line">pres[<span class="number">0</span>] = <span class="number">1</span>, sufs[n + <span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">pres[i] = ((ll)pres[i - <span class="number">1</span>] * (k - x[i]) % P + P) % P ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">sufs[i] = ((ll)sufs[i + <span class="number">1</span>] * (k - x[i]) % P + P) % P ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">inow = <span class="number">1</span>, now = (ll)pres[i - <span class="number">1</span>] * sufs[i + <span class="number">1</span>] % P ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line"><span class="keyword">if</span> (i != j) inow = (ll)inow * ((x[i] - x[j]) % P + P) % P ; </span><br><span class="line">ans = (ans + (ll)now * expow(inow, P - <span class="number">2</span>) % P * y[i] % P) % P ; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="comment">/*</span></span><br><span class="line"><span class="comment">namespace Linear_sieve&#123;</span></span><br><span class="line"><span class="comment">int cnt ;</span></span><br><span class="line"><span class="comment">int pr[N] ; </span></span><br><span class="line"><span class="comment">int mu[N] ;</span></span><br><span class="line"><span class="comment">int vis[N] ;</span></span><br><span class="line"><span class="comment">void sieve(int U)&#123;</span></span><br><span class="line"><span class="comment">mu[1] = 1 ;</span></span><br><span class="line"><span class="comment">for (int i = 2 ; i &lt;= U ; ++ i)&#123;</span></span><br><span class="line"><span class="comment">if (!vis[i]) mu[i] = -1, pr[++ cnt] = i ; </span></span><br><span class="line"><span class="comment">for (int j = 1 ; j &lt;= cnt ; ++ j)&#123;</span></span><br><span class="line"><span class="comment">if (i * pr[j] &gt; U) break ; </span></span><br><span class="line"><span class="comment">vis[i * pr[j]] = 1 ; </span></span><br><span class="line"><span class="comment">if (i % pr[j] == 0) break ; </span></span><br><span class="line"><span class="comment">mu[i * pr[j]] = -mu[i] ; </span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="keyword">int</span> d, w, num ;</span><br><span class="line"><span class="keyword">int</span> base[N], cs[N] ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; d &gt;&gt; w ; n = d + <span class="number">2</span> ; </span><br><span class="line"><span class="comment">//using namespace Linear_sieve ; </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Interpolation ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) </span><br><span class="line">x[i] = i, y[i] = (y[i - <span class="number">1</span>] + expow(x[i], d)) % P ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= w ; ++ i)</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; base[i] &gt;&gt; cs[i] ; get_xs(n) ; </span><br><span class="line"><span class="comment">//debug(y, 1, n + 1, '\n') ;</span></span><br><span class="line"><span class="comment">//debug(res, 1, n + 1, '\n') ;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n + <span class="number">1</span> ; ++ i)&#123;</span><br><span class="line">now = <span class="number">0</span>, num = <span class="number">1</span> ;   </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= w ; ++ j)&#123;</span><br><span class="line">now = expow(expow(base[j], cs[j] - <span class="number">1</span>), i - <span class="number">1</span>) ;</span><br><span class="line">now = ((<span class="number">-1l</span>l * now * expow(base[j], d) % P) + P) % P ; </span><br><span class="line">now = (now + expow(expow(base[j], cs[j]), i - <span class="number">1</span>)) % P ; </span><br><span class="line">num = <span class="number">1l</span>l * num * now % P ; </span><br><span class="line">&#125;</span><br><span class="line">ans = (ans + (ll)num * res[i] % P) % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç»™å®š $n$ çš„è´¨å› æ•°åˆ†è§£ $n= \prod _{i=1}^kp^{a_{i}}$ï¼Œæ±‚æ‰€æœ‰å°äº $n$ ä¸”ä¸ $n$ äº’è´¨çš„æ­£æ•´æ•°çš„ $m$ æ¬¡æ–¹ä¹‹å’Œæ¨¡ $10^9 +7$ çš„å€¼ã€‚å…¶ä¸­ $p_i$ ä¸ºè´¨æ•°ä¸”ä¸è¶…è¿‡ $10^9$ ã€‚&lt;/p&gt;
&lt;p&gt;$a_i â‰¤ 10^9,k â‰¤ 1000,m â‰¤ 100$ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="BZOJ" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/BZOJ/"/>
    
    
      <category term="æ•°å­¦/ç§¯æ€§å‡½æ•°/è«æ¯”ä¹Œæ–¯åæ¼”" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0-%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
    
      <category term="å¤šé¡¹å¼çš„åº”ç”¨" scheme="https://www.orchidany.cn/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%9A%84%E5%BA%94%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘[bzoj3853] GCD Array</title>
    <link href="https://www.orchidany.cn/2020/03/31/GCD-Array/"/>
    <id>https://www.orchidany.cn/2020/03/31/GCD-Array/</id>
    <published>2020-03-31T14:18:24.000Z</published>
    <updated>2020-04-02T16:52:53.464Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>ç»´æŠ¤ä¸€ä¸ªåºåˆ—ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p><p>1ã€ç»™å®š $n,d,v$ ï¼Œå¯¹æ¯ä¸ª $(x,n)=d$ çš„ $a_x\text{+=}v$ ã€‚</p><p>2ã€è¯¢é—® $\sum _{i=1}^k a_i$</p><p>$n\leq 10^5$</p></blockquote><p>å¾ˆæœ‰æ„æ€çš„é¢˜ç›®ï¼Œè§£æ³•ä¹Ÿå¾ˆç®€æ´ã€‚</p><a id="more"></a><hr><p>å¦™å¦™é¢˜ï¼Œå»ºç«‹ä¸€ä¸ªè¾…åŠ©æ•°ç»„ $f$ï¼Œè®© $a_i=\sum _{d|i}f_d$ ã€‚</p><p>è€ƒè™‘æ¯æ¬¡åŠ çš„æ“ä½œï¼Œå¯¹äºæ¯ä¸ª $i$ å®é™…ä¸Šæ˜¯åŠ ä¸Šè¿™ä¸ªä¸œè¥¿ï¼š</p><script type="math/tex; mode=display">\begin{align*}&[(n,i)=d]v\\= &[(\frac{n}{d},\frac{n}{i})=1]v\\= &\sum_{k|\frac{n}{d},k|\frac{n}{i}}\mu(k)v\end{align*}</script><p>è€ƒè™‘å¯¹ $f$ åæ¼”:</p><script type="math/tex; mode=display">f_d=\sum_{k|d}\mu(k)a_{\frac{d}{k}}</script><p>é‚£ä¹ˆå¯ä»¥çœ‹å‡ºï¼Œå…¶å®æ¯æ¬¡æ“ä½œå°±æ˜¯å¯¹æ‰€æœ‰çš„ $k | \frac{n}{d}$ çš„ $f_{kd}$ åŠ ä¸Šäº† $\mu(k)\cdot v$ .</p><p>è€ƒè™‘è¯¢é—®æ“ä½œå°±æ˜¯åœ¨è¯¢é—®</p><script type="math/tex; mode=display">\sum_{i=1}^x\sum_{d|i}f_d=\sum_{d=1}^{x}\left[\frac{x}{d}\right] f_d</script><p>è¿™ä¸ªå¯ä»¥ $\sqrt n$ åˆ†å—æ¥åšã€‚äºæ˜¯æœ€åä¿®æ”¹å¤æ‚åº¦ $\sqrt[3] n\log n$ï¼Œè¯¢é—®å¤æ‚åº¦ $\sqrt n\log n$ ã€‚ æ³¨æ„åˆ°å¯ä»¥è°ƒæ•´å—çš„å¤§å°ï¼Œå¯¹äºæ‰€æœ‰ $&lt;\sqrt {x\log x}$ çš„ä½ç½®æš´åŠ›åŠ ï¼Œå¯¹äºæ‰€æœ‰ $&gt;\sqrt {x\log x}$ çš„ä½ç½®ï¼Œè‡³å¤šæœ‰ $\sqrt \frac{x}{\log x}$ ä¸ªã€‚æ‰€ä»¥å¯ä»¥æŠŠ $\log $ æ”¾åˆ°é‡Œé¢å»ã€‚</p><p>å½“ç„¶æˆ‘è‚¯å®šæ˜¯å†™ $\sqrt n\log n$ çš„å•¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200110</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> L_s&#123;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> pr[N] ; </span><br><span class="line"><span class="keyword">int</span> mu[N] ;</span><br><span class="line"><span class="keyword">int</span> smu[N] ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; fc[N] ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> U)</span></span>&#123;</span><br><span class="line">mu[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= U ; ++ i)&#123;</span><br><span class="line"><span class="keyword">if</span> (!vis[i]) mu[i] = <span class="number">-1</span>, pr[++ cnt] = i ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line"><span class="keyword">if</span> (i * pr[j] &gt; U) <span class="keyword">break</span> ; </span><br><span class="line">vis[i * pr[j]] = <span class="number">1</span> ; </span><br><span class="line"><span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ; </span><br><span class="line">mu[i * pr[j]] = -mu[i] ; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line">smu[i] = smu[i - <span class="number">1</span>] + mu[i] ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; i * j &lt;= U ; ++ j)</span><br><span class="line">fc[i * j].push_back(i) ; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T ; </span><br><span class="line">ll _bit[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, p ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">low</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (x &amp; (-x)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> ( ; x &lt;= n ; x += low(x)) _bit[x] += v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">ll ret = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> ( ; x ; x -= low(x)) ret += (ll)_bit[x] ;</span><br><span class="line"><span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> opt, x, d, v ; </span><br><span class="line">L_s :: sieve(N - <span class="number">10</span>) ; </span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; ++ T ;</span><br><span class="line"><span class="keyword">if</span> (!(m + n)) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Case #"</span> &lt;&lt; T &lt;&lt; <span class="string">": "</span> &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">fill(_bit + <span class="number">1</span>, _bit + n + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line"><span class="keyword">while</span> (m --)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;opt, &amp;x) ; </span><br><span class="line"><span class="keyword">if</span> (opt == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;d, &amp;v) ; <span class="keyword">if</span> (x % d != <span class="number">0</span>) <span class="keyword">continue</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L_s :: fc[x / d].size() ; ++ i)</span><br><span class="line">add(L_s :: fc[x / d][i] * d, L_s :: mu[L_s :: fc[x / d][i]] * v) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">ll ans = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r ; l &lt;= x ; l = r + <span class="number">1</span>)</span><br><span class="line">r = x / (x / l), ans += (ask(r) - ask(l - <span class="number">1</span>)) * (ll)(x / l) ;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç»´æŠ¤ä¸€ä¸ªåºåˆ—ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;p&gt;1ã€ç»™å®š $n,d,v$ ï¼Œå¯¹æ¯ä¸ª $(x,n)=d$ çš„ $a_x\text{+=}v$ ã€‚&lt;/p&gt;
&lt;p&gt;2ã€è¯¢é—® $\sum _{i=1}^k a_i$&lt;/p&gt;
&lt;p&gt;$n\leq 10^5$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¾ˆæœ‰æ„æ€çš„é¢˜ç›®ï¼Œè§£æ³•ä¹Ÿå¾ˆç®€æ´ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="BZOJ" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/BZOJ/"/>
    
    
      <category term="æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ " scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E8%A7%82%E5%AF%9F%E6%80%A7%E8%B4%A8-%E7%BB%93%E8%AE%BA%E4%B8%8E%E6%9E%84%E9%80%A0/"/>
    
      <category term="æ•°å­¦/ç§¯æ€§å‡½æ•°/è«æ¯”ä¹Œæ–¯åæ¼”" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0-%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
    
      <category term="åˆ†æ²»" scheme="https://www.orchidany.cn/tags/%E5%88%86%E6%B2%BB/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘[UR#5 C]æ€æ ·è·‘çš„æ›´å¿«</title>
    <link href="https://www.orchidany.cn/2020/03/31/UR5-%E6%80%8E%E6%A0%B7%E8%B7%91%E7%9A%84%E6%9B%B4%E5%BF%AB/"/>
    <id>https://www.orchidany.cn/2020/03/31/UR5-æ€æ ·è·‘çš„æ›´å¿«/</id>
    <published>2020-03-31T14:14:34.000Z</published>
    <updated>2020-04-02T16:53:03.859Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>ç»™å®š $n â‰¤ 10^5;c,d â‰¤ 10^9$ ã€‚</p><p>ç°æœ‰é•¿åº¦ä¸º $n$ çš„åºåˆ— $b$ æ»¡è¶³ $b_{i} \equiv \sum_{i=1}^{n} \operatorname{gcd}(i, j)^{c}  \mathrm{lcm}(i, j)^{d} z_{j}(\bmod 998244353)$ ã€‚</p><p>æ±‚ $\{z_n\}$ ã€‚</p></blockquote><p>è‰ï¼Œè¿™çœŸæ˜¯ä¸€é“ç¥ä»™é¢˜ã€‚é’›é’›é’›é’›æœ‰è¶£è¾£ï¼sto vfk .</p><a id="more"></a><p>å…ˆè½¬åŒ–ä¸€ä¸‹ï¼š</p><script type="math/tex; mode=display">b_{i} \equiv \sum_{i=1}^{n} \operatorname{gcd}(i, j)^{c-d}\cdot i^d\cdot j^d\cdot  z_{j}(\bmod 998244353)</script><p>è€ƒè™‘å½¢å¦‚ $\sum_{j=1}^{n}f(\gcd(i,j))\cdot g(i)\cdot h(j)\cdot z_j$ ç­‰äºæŸä¸ªå€¼çš„ä¸œè¥¿ï¼Œå¤§æ¦‚éƒ½æ˜¯å¯åšçš„ã€‚è€ƒè™‘å…ˆæ„é€ ä¸€ä¸ª $fâ€™$ æ»¡è¶³</p><script type="math/tex; mode=display">f(n)=\sum_{d|n}f'(d)</script><p>é‚£ä¹ˆå°±å¯ä»¥åŒ–ä¸€ä¸‹</p><script type="math/tex; mode=display">\begin{aligned}&\sum_{j=1}^{n}f(\gcd(i,j))\cdot g(i)\cdot h(j)\cdot z_j\\=&\sum_{j=1}^n\sum_{d}[d|i]\cdot [d|j]\cdot f'(d)\cdot g(i)\cdot h(j)\cdot z_j\\=&\sum_{d|i}f'(d)\sum_{j=1}^n[d|j]\cdot g(i)\cdot h(j)\cdot z_j\end{aligned}</script><p>é‚£ä¹ˆå°±ç›¸å½“äºè¦éªŒè¯</p><script type="math/tex; mode=display">\sum_{d|i}f'(d)\sum_{j=1}^n[d|j]\cdot h(j)\cdot z_j =\frac{b_i}{g(i)}</script><p>å¦‚æœèƒ½å¿«é€Ÿç®— $\zeta(d)=\sum_{j=1}^n[d|j]\cdot h(j)\cdot z_j $ çš„è¯ï¼Œé‚£ä¹ˆæœ‰</p><script type="math/tex; mode=display">\sum_{d|i}f'(d)\zeta(d)=\frac{b_i}{g(i)}</script><p>è€ƒè™‘å¯¹äºä¸€ä¸ªäºŒå…ƒå…³ç³»</p><script type="math/tex; mode=display">\sum_{d|n} p(d)=q(n)</script><p>è¿™ä¸œè¥¿ï¼ŒçŸ¥é“ $q$ ä¹‹åæ˜¯å¯ä»¥å¾ˆå®¹æ˜“åœ°å®¹æ–¥å‡º $p$ çš„ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´å¯ä»¥å¾ˆå®¹æ˜“åœ°å¾—åˆ° $fâ€™(k)\zeta(k)$ ã€‚é‚£ä¹ˆåŒæ—¶ç”±äºçŸ¥é“äº† $f(k)=k^{c-d}$ ï¼Œæ˜¯å¾ˆå®¹æ˜“ç›´æ¥å®¹æ–¥å‡º $fâ€™(k)$ çš„ã€‚ä¹Ÿå°±æ˜¯ç°åœ¨ $\zeta$ å˜æˆäº†å·²çŸ¥ã€‚</p><p>è€ƒè™‘å¦‚ä½•ä» $\zeta(d)=\sum_{j=1}^n[d|j]\cdot h(j)\cdot z_j $ åæ¨å‡º $z_j$ æ¥ï¼Œå‘ç°æœ¬è´¨ä¸Šæ˜¯è¿™æ ·çš„ï¼š</p><script type="math/tex; mode=display">\zeta(d)=\sum_{d|j} h(j)z_j</script><p>æ ¹æ®è«æ¯”ä¹Œæ–¯åæ¼”çš„å¦ä¸€ç§å½¢å¼</p><script type="math/tex; mode=display">F(n)=\sum_{n | d} f(d)\Longrightarrow f(n)=\sum_{n | d} \mu\left(\frac{d}{n}\right) F(d)</script><p>åæ¼”ä¸€ä¸‹å˜æˆ</p><script type="math/tex; mode=display">h(d)z_d=\sum_{d|j} \mu(\frac{j}{d})\zeta_j</script><p>ç„¶åå°±å¯ä»¥ç›´æ¥åšäº†ã€‚</p><p>æ³¨æ„åˆ°ä»¥ä¸Šæ¯ä¸ªæ¨å®Œçš„å¼å­ï¼Œæ±‚çš„æ—¶å€™éƒ½æ˜¯ $nH(n)$ çš„å¤æ‚åº¦ï¼Œ$O(n\ln n)$ ã€‚</p><p>ç¥é¢˜ç¥é¢˜ï¼Œå¯èƒ½è¿™æ˜¯æˆ‘æ¥è§¦è¿‡çš„æœ€åƒè«æ¯”ä¹Œæ–¯åæ¼”çš„è«æ¯”ä¹Œæ–¯é¢˜ã€‚å¹¶ä¸”æŠŠåæ¼”çš„å®¹æ–¥ä½œç”¨å¾ˆå¥½åœ°è¯ é‡Šäº†å‡ºæ¥ã€‚</p><p>è¿˜æœ‰æ³¨æ„æ— è§£çš„æƒ…å†µï¼Œç”±äº $0$ ä¸å­˜åœ¨é€†å…ƒï¼Œæ‰€ä»¥åœ¨æ±‚é€†å…ƒçš„æ—¶å€™éœ€è¦åˆ¤ä¸€ä¸‹æ˜¯å¦å­˜åœ¨ã€Œæ±‚äº†0çš„é€†å…ƒã€è¿™ç§æƒ…å†µï¼Œæœ‰å°±è¾“å‡ºæ— è§£å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">int</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> q ;</span><br><span class="line"><span class="keyword">int</span> b[N] ;</span><br><span class="line"><span class="keyword">int</span> g[N] ;</span><br><span class="line"><span class="keyword">int</span> f[N] ;</span><br><span class="line"><span class="keyword">int</span> hz[N] ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> n, c, d ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> zeta[N] ;</span><br><span class="line"><span class="keyword">int</span> fzeta[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">a += b ;</span><br><span class="line"><span class="keyword">if</span> (a &gt; P) a -= P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">(a -= b) %= P ;</span><br><span class="line"><span class="keyword">if</span> (a &lt; <span class="number">0</span>) a += P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (b &lt; <span class="number">0</span>) b += (P - <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            res = (ll)res * a % P ;</span><br><span class="line">        a = (ll)a * a % P ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Linear_s&#123;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> pr[N] ;</span><br><span class="line"><span class="keyword">int</span> mu[N] ;</span><br><span class="line"><span class="keyword">int</span> smu[N] ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; fc[N] ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> U)</span></span>&#123;</span><br><span class="line">mu[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= U ; ++ i)&#123;</span><br><span class="line"><span class="keyword">if</span> (!vis[i]) mu[i] = <span class="number">-1</span>, pr[++ cnt] = i ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line"><span class="keyword">if</span> (i * pr[j] &gt; U) <span class="keyword">break</span> ;</span><br><span class="line">vis[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">mu[i * pr[j]] = -mu[i] ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line">smu[i] = smu[i - <span class="number">1</span>] + mu[i] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; i * j &lt;= U ; ++ j)</span><br><span class="line">fc[i * j].push_back(i) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">ios::sync_with_stdio(<span class="number">0</span>) ;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Linear_s ; </span><br><span class="line"><span class="built_in">cin</span>.tie(<span class="number">0</span>) ; <span class="built_in">cout</span>.tie(<span class="number">0</span>) ;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n &gt;&gt; c &gt;&gt; d &gt;&gt; q ; sieve(n + <span class="number">10</span>) ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        g[i] = expow(i, d), f[i] = expow(i, c - d) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span> ; i * j &lt;= n ; ++ j)</span><br><span class="line">            dec(f[i * j], f[i]) ;</span><br><span class="line"><span class="keyword">while</span> (q --)&#123;</span><br><span class="line"><span class="keyword">int</span> hasans = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) </span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; b[i], hz[i] = <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">base[i] = (ll)expow(g[i], P - <span class="number">2</span>) * b[i] % P ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) fzeta[i] = base[i] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span> ; i * j &lt;= n ; ++ j)</span><br><span class="line">dec(fzeta[i * j], fzeta[i]) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line"><span class="keyword">if</span> (!f[i] &amp;&amp; fzeta[i]) &#123; hasans = <span class="number">0</span> ; <span class="keyword">break</span> ; &#125;</span><br><span class="line"><span class="keyword">if</span> (!hasans) &#123; <span class="built_in">cout</span> &lt;&lt; <span class="string">"-1"</span> &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">continue</span> ; &#125;</span><br><span class="line"><span class="comment">//debug(fzeta, 1, n, '\n') ; </span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            zeta[i] = (ll)fzeta[i] * expow(f[i], P - <span class="number">2</span>) % P ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; i * j &lt;= n ; ++ j)</span><br><span class="line">                add(hz[i], (mu[j] * zeta[i * j] % P + P) % P) ;</span><br><span class="line"><span class="comment">//debug(zeta, 1, n, '\n') ; </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            ans[i] = (ll)hz[i] * expow(g[i], P - <span class="number">2</span>) % P ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="string">" \n"</span>[i == n] ;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç»™å®š $n â‰¤ 10^5;c,d â‰¤ 10^9$ ã€‚&lt;/p&gt;
&lt;p&gt;ç°æœ‰é•¿åº¦ä¸º $n$ çš„åºåˆ— $b$ æ»¡è¶³ $b_{i} \equiv \sum_{i=1}^{n} \operatorname{gcd}(i, j)^{c}  \mathrm{lcm}(i, j)^{d} z_{j}(\bmod 998244353)$ ã€‚&lt;/p&gt;
&lt;p&gt;æ±‚ $\{z_n\}$ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è‰ï¼Œè¿™çœŸæ˜¯ä¸€é“ç¥ä»™é¢˜ã€‚é’›é’›é’›é’›æœ‰è¶£è¾£ï¼sto vfk .&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="uoj" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/uoj/"/>
    
    
      <category term="æ•°å­¦/ç§¯æ€§å‡½æ•°/è«æ¯”ä¹Œæ–¯åæ¼”" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0-%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
    
      <category term="æ•°å­¦/æ•°å€¼åˆ†æ/è°ƒå’Œçº§æ•°" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E8%B0%83%E5%92%8C%E7%BA%A7%E6%95%B0/"/>
    
      <category term="æ€ç»´é¢˜/å®¹æ–¥" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E5%AE%B9%E6%96%A5/"/>
    
  </entry>
  
  <entry>
    <title>ã€å¬è¯¾ç¬”è®°ã€‘MobiÃ¼såæ¼”å¬è¯¾ç¬”è®°</title>
    <link href="https://www.orchidany.cn/2020/03/30/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/03/30/è«æ¯”ä¹Œæ–¯åæ¼”å¬è¯¾ç¬”è®°/</id>
    <published>2020-03-30T10:44:57.000Z</published>
    <updated>2020-04-01T14:37:18.022Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸»è¦æ˜¯è«æ¯”ä¹Œæ–¯åæ¼”è¿™ä¸€å—çš„å¬è¯¾ç¬”è®°ï¼Œç”±äºè®°å½•çš„å¤ªé•¿äº†<del>(ä¸ä¼šçš„å¤ªå¤šäº†)</del> æ‰€ä»¥å°±åˆ†äº†ä¸€ä¸‹ã€‚</p><p>åæ¼”å¥½å•Šï¼Œæœ‰è¶£å•Šï¼Œä¸ä¼šå•Šï¼</p><a id="more"></a><h1 id="å…³äº-mu-çš„æœ‰è¶£è¯æ˜"><a href="#å…³äº-mu-çš„æœ‰è¶£è¯æ˜" class="headerlink" title="å…³äº $\mu$ çš„æœ‰è¶£è¯æ˜"></a>å…³äº $\mu$ çš„æœ‰è¶£è¯æ˜</h1><p>æ€è€ƒ $\mu$ çš„æœ¬è´¨ï¼Œå½“ $n$ å«æœ‰å¹³æ–¹å› å­çš„æ—¶å€™ï¼Œ$\mu(n)=0$ï¼›å¦åˆ™ $\mu(n)=(-1)^k$ï¼Œå…¶ä¸­ $k$ æ˜¯ $n$ çš„æœ¬è´¨ä¸åŒè´¨å› å­ä¸ªæ•°ã€‚</p><p>æ¥ä¸‹æ¥è€ƒè™‘ä¸€æ­¥è½¬åŒ–ã€‚è®¾ $n=\sum p_i^{e_i},nâ€™=\sum{p_i}$ ã€‚é‚£ä¹ˆæœ‰</p><script type="math/tex; mode=display">\begin{aligned}&\sum_{d|n}\mu(d)\\ = &\sum_{d|n'}\mu(d)\\= &\sum_{i=0}^k \binom{k}{i}(-1)^i\\= & ~(1+(-1))^k\\= & ~[k=0]\end{aligned}</script><h1 id="çåæ¼”è®°å½•"><a href="#çåæ¼”è®°å½•" class="headerlink" title="çåæ¼”è®°å½•"></a>çåæ¼”è®°å½•</h1><p>é‚£å¤§æ¦‚ä½¿ç”¨æ¥çƒ­èº«çš„ã€‚</p><ul><li>åæ¼”1</li></ul><script type="math/tex; mode=display">\begin{aligned}&\sum _{i=1}^n\sum_{j=1}^m[i,j]\\&=\sum _{d=1}^n\sum _{i=1}^n\sum_{j=1}^m\frac{i\cdot j}{d}[(i,j)=d]\\&=\sum _{d=1}^n\sum _{i=1}^{\lfloor\frac{n}{d} \rfloor}\sum_{j=1}^{\lfloor\frac{m}{d} \rfloor}i\cdot j\cdot d\cdot \sum_{p|i~\mathrm{and}~p|j}\mu(p) \\&=\sum _{d=1}^n d\sum_{p=1}^{\lfloor\frac{n}{d} \rfloor}\mu(p) \cdot p^2\sum_{i=1}^{\lfloor\frac{n}{pd} \rfloor}i\sum_{j=1}^{\lfloor\frac{m}{pd} \rfloor} j\end{aligned}</script><ul><li>åæ¼”2</li></ul><script type="math/tex; mode=display">\sum [n,i]\\= \sum \frac{n\cdot i}{(n,i)}\\= \sum_{d=1}^n\sum\frac{n\cdot i}{d}\cdot [(n,i)=d]\\= \sum_{d=1}^n n\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor} i \sum \mu(k)\\= \sum_{d=1}^nn\sum_{k=1}^{\lfloor\frac{n}{d}\rfloor}\mu(k)\cdot k\cdot \sum_{i=1}^{\lfloor\frac{n}{dk}\rfloor} i</script><h1 id="å„ç§é¢˜"><a href="#å„ç§é¢˜" class="headerlink" title="å„ç§é¢˜"></a>å„ç§é¢˜</h1><h2 id="SPOJ-LCMSUM"><a href="#SPOJ-LCMSUM" class="headerlink" title="SPOJ LCMSUM"></a>SPOJ LCMSUM</h2><blockquote><p>æ±‚ $\sum _{i=1}^n \mathrm{lcm}(n,i)$ .</p><p>$n\leq 10^6,T\leq 10^5$ </p></blockquote><p>è‰ï¼Œè¿™çœŸæ˜¯ä¸ªç¥ä»™é¢˜ã€‚è€ƒè™‘ $\rm lcm$ è‡ªç„¶æ˜¯è¦è½¬åŒ–æˆ</p><script type="math/tex; mode=display">\sum_{i=1}^{n} \operatorname{lcm}(i, n)=\sum_{i=1}^{n} \frac{i\cdot n}{\operatorname{gcd}(i, n)}</script><p>é‚£ä¹ˆè€ƒè™‘å¿«é€Ÿè®¡ç®—è¿™ä¸ªä¸œè¥¿ã€‚ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•è€ƒè™‘èƒ½ä¸èƒ½ç­›ï¼Œç­›å°±è¦æ±‚å¿…é¡»è¦æ˜¯ç‹„åˆ©å…‹é›·å·ç§¯çš„å½¢ä¼¼ã€‚æƒ³è¦è½¬åŒ–è¿‡å»çš„è¯å¿…é¡»æ˜¯å¯¹ $n$ çš„å› å­æ±‚å’Œï¼Œäºæ˜¯æƒ³åˆ°è¦æŒ‰ç…§ $\gcd $ åˆ†ç±»ï¼Œé‚£ä¹ˆ $\gcd(n,i)=d$ çš„ $i$ æ€»å…±æœ‰ $\varphi(\frac{n}{d})$ ä¸ªã€‚</p><p>ä½†æ˜¯æ³¨æ„åˆ°åˆ†ç±»ä¹‹åï¼Œç”±äºæ¯ä¸€é¡¹éƒ½å¸¦æœ‰ $i$ æ‰€ä»¥æ— æ³•å¿«é€Ÿè®¡ç®—ã€‚è€ƒè™‘ä¸€ä¸ªæ€§è´¨ï¼Œ$\gcd(n,k)=\gcd(n,n- k)$ ã€‚é‚£ä¹ˆå°±æ˜¯ï¼š</p><script type="math/tex; mode=display">n\sum_{i=1}^n\frac{i}{\gcd(i,n)}=n\cdot \frac{1}{2}\left(\sum_{i=1}^n\frac{i}{\gcd(i,n)}+\sum_{i=1}^n\frac{n-i}{\gcd(n-i,n)}\right)=\frac{n}{2}\left(\sum_{i=1}^n\frac{i+(n-i)}{\gcd(i,n)}\right)=\frac{n^2}{2}\left(\sum_{i=1}^n\frac{1}{\gcd(i,n)}\right)</script><p>å‘ç°åé¢é‚£ä¸€é¡¹å°±å¯ä»¥å¿«é€Ÿæ±‚å’Œäº†ï¼š</p><script type="math/tex; mode=display">\sum_{i=1}^{n} \frac{1}{\operatorname{gcd}(i, n)}=\sum_{d|n} \frac{\varphi(\frac{n}{d})}{d}</script><p>é‚£ä¹ˆç­”æ¡ˆå°±æ˜¯</p><script type="math/tex; mode=display">\frac{n}{2}\left(\sum_{d|n} \frac{n\cdot\varphi(\frac{n}{d})}{d}\right)=\frac{n}{2}\left(\sum_{d|n} d\cdot\varphi(d)\right)</script><p>å°±å¯ä»¥å¿«é€Ÿç­›å‡ºæ¥äº†ã€‚å¤æ‚åº¦ $O(n)-O(1)$ ã€‚</p><h2 id="HDU-4944"><a href="#HDU-4944" class="headerlink" title="HDU 4944"></a>HDU 4944</h2><blockquote><p>æ±‚</p><script type="math/tex; mode=display">\sum_{i=1}^{n} \sum_{j=i}^{n} \sum_{d | i, d|j} \frac{i j}{\operatorname{gcd}\left(\frac{i}{d}, \frac{j}{d}\right)}</script><p>$n,T\leq 5\times 10^5$</p></blockquote><p>é¦–å…ˆçœ‹åˆ° $d$ çŸ¥é“è¦æå‡ºæ¥</p><script type="math/tex; mode=display">\begin{aligned}&\sum_{i=1}^{n} \sum_{j=i}^{n} \sum_{d | i, d|j} \frac{i j}{\operatorname{gcd}\left(\frac{i}{d}, \frac{j}{d}\right)}\\=&\sum_{i=1}^{n} \sum_{j=i}^{n} \mathrm{lcm}(i,j)\sum_{d|i,d|j}d\\=&\sum_{d=1}^{n}d^2\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\sum_{j=i}^{\lfloor\frac{n}{d}\rfloor} \mathrm{lcm}(i,j)\end{aligned}</script><p>å‘ç°å¯¹äº $f(n)=\sum_{i=1}^n\sum_{j=i}^n \mathrm{lcm}(i,j)$ å¯ä»¥è½¬åŒ–æˆ</p><script type="math/tex; mode=display">\sum_{i=1}^n\sum_{j=1}^i \mathrm{lcm}(i,j)</script><p> ä¹Ÿå°±æ˜¯ä¸Šé¢LCMSUMé‡Œé¢æ±‚å¾—çš„ä¸œè¥¿ã€‚äºæ˜¯å°±å¯ä»¥æ•´é™¤åˆ†å—åšäº†ã€‚å¤æ‚åº¦ $O(n+T\sqrt n)$ ã€‚</p><p>æ³¨æ„åˆ°ï¼Œé¢„å¤„ç†çš„æ—¶å€™è¿˜å¯ä»¥è®¡ç®—æ¯ä¸ª $d$ å¯¹äºæ¯ä¸ª $n$ çš„è´¡çŒ®ã€‚å…·ä½“ä¸€ç‚¹ï¼Œè€ƒè™‘æœ¬è´¨ä¸Šå¯¹äºæ¯ä¸ª $n$ï¼Œ$d$ çš„è´¡çŒ®éƒ½æ˜¯ $d^{2} f\left(\left\lfloor\frac{n}{d}\right\rfloor\right)$ ï¼Œè‡³å¤šæœ‰ $\left\lfloor\frac{n}{d}\right\rfloor$ ç§ä¸åŒçš„å–å€¼ï¼Œä¸”æ¯ä¸ªå–å€¼å¯¹åº”çš„ $n$ çš„åŒºé—´æ˜¯è¿ç»­çš„ã€‚äºæ˜¯å°±ç”¨ä¸€äº›å·®åˆ†æŠ€å·§å·®åˆ†ä¸€ä¸‹è¿™ä¸ªä¿®æ”¹ã€‚æ³¨æ„åˆ°è¿™ä¸ªçš„å¤æ‚åº¦æ˜¯è°ƒå’Œçº§æ•°çš„ï¼Œæ‰€ä»¥æ€»å¤æ‚åº¦ $O(n\ln n)-O(1)$ ã€‚</p><p>å…¶å®è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹é¢˜ï¼Œä½†æ˜¯å› ä¸ºè§‰å¾—å¾ˆæœ‰è¶£å°±å•æ‹¿å‡ºæ¥äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸»è¦æ˜¯è«æ¯”ä¹Œæ–¯åæ¼”è¿™ä¸€å—çš„å¬è¯¾ç¬”è®°ï¼Œç”±äºè®°å½•çš„å¤ªé•¿äº†&lt;del&gt;(ä¸ä¼šçš„å¤ªå¤šäº†)&lt;/del&gt; æ‰€ä»¥å°±åˆ†äº†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;åæ¼”å¥½å•Šï¼Œæœ‰è¶£å•Šï¼Œä¸ä¼šå•Šï¼&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://www.orchidany.cn/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="æ•°å­¦/ç§¯æ€§å‡½æ•°/è«æ¯”ä¹Œæ–¯åæ¼”" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0-%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
    
      <category term="æ•°å­¦/ç§¯æ€§å‡½æ•°/æ¬§æ‹‰åæ¼”" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0-%E6%AC%A7%E6%8B%89%E5%8F%8D%E6%BC%94/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘åŒä½™</title>
    <link href="https://www.orchidany.cn/2020/03/29/%E6%95%B0%E8%AE%BA%E5%90%8C%E4%BD%99%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/03/29/æ•°è®ºåŒä½™å­¦ä¹ ç¬”è®°/</id>
    <published>2020-03-29T02:09:56.000Z</published>
    <updated>2020-04-02T14:17:02.944Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å‘ç°å½“å¹´å­¦æ•°è®ºï¼Œ4-6é‚£æœ¬ä¹¦ç¬¬äºŒä¸‰ç« åŸºæœ¬ä¸Šå°±æ˜¯æ²¡å­¦ä¼šï¼Œäºæ˜¯ä»Šå¤©æ‰“ç®—é‡å­¦ä¸€éã€‚</p><p>å‘ç°è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ã€‚å¹¶ä¸”å‘ç°è¯»è¿‡çš„MOğŸ“šè¶Šå¤šï¼Œè¿™ç§ä¸œè¥¿å°±è¶Šå¥½ç†è§£ã€‚</p><p>å—¯ï¼Œå¯“å¿«äºæ…¢ï¼Œè—å·§äºæ‹™ã€‚</p><a id="more"></a><p>å…ˆå®šä¹‰ä¸€ä¸‹è§£çš„ã€Œæœ¬è´¨ç›¸åŒã€ï¼šé€šå¸¸è®¤ä¸ºåœ¨æ¨¡ $m$ æ„ä¹‰ä¸‹çš„åŒä½™æ–¹ç¨‹ä¸­ $x$ å’Œ $x+km(k\in\mathbb{Z_+})$ æ˜¯æœ¬è´¨ç›¸åŒçš„ã€‚ </p><h1 id="åŒä½™çš„åŸºæœ¬æ€§è´¨"><a href="#åŒä½™çš„åŸºæœ¬æ€§è´¨" class="headerlink" title="åŒä½™çš„åŸºæœ¬æ€§è´¨"></a>åŒä½™çš„åŸºæœ¬æ€§è´¨</h1><p>1.</p><blockquote><p>è‹¥ $ac\equiv bc\pmod m$ï¼Œä¸” $(m,c)=d$ï¼Œåˆ™ $a\equiv b \pmod{\frac{m}{d}}$ ã€‚</p></blockquote><script type="math/tex; mode=display">ac\equiv bc\pmod m\Longrightarrow m|c(a-b)\Longrightarrow \frac{m}{d}|\frac{c}{d}(a-b)</script><p>å› ä¸º $(\frac{m}{d},\frac{c}{d})=1$ ï¼Œæ‰€ä»¥ $\frac{m}{d}|(a-b)$ ã€‚</p><p>2ã€</p><blockquote><p>è‹¥ç»™å®š $m_i(i=1,2,3\cdots)$ ï¼Œä¸” $\forall i$ æœ‰ $a\equiv b\pmod {m_i}$ï¼Œåˆ™æœ‰</p><script type="math/tex; mode=display">a\equiv b\pmod {[m_1,m_2,m_3\cdots ]}</script></blockquote><p>ç”± $\forall i,m_i|(a-b)$ å¯çŸ¥ $(a-b)$ æ˜¯ $m_1,m_2,m_3\cdots$ çš„ä¸€ä¸ªå…¬å€æ•°ã€‚æ‰€ä»¥ ${[m_1,m_2,m_3\cdots ]} |(a-b)$ ã€‚</p><h2 id="ç»ƒä¹ é¢˜"><a href="#ç»ƒä¹ é¢˜" class="headerlink" title="ç»ƒä¹ é¢˜"></a>ç»ƒä¹ é¢˜</h2><p>1ã€è¯æ˜</p><blockquote><p> $11$ æ•´é™¤ $a$ çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯ $a$ å†™æˆåè¿›åˆ¶è¡¨ç¤ºåï¼Œä»ä½ä½åˆ°é«˜ä½ï¼Œå¥‡æ•°ä½æ•°å­—å’Œå‡å»å¶æ•°ä½æ•°å­—å’Œå†…è¢« $11$ æ•´é™¤ã€‚</p></blockquote><p>æˆ‘ä¹Ÿä¸çŸ¥é“æœ‰å•¥å¥½æ–¹æ³•ï¼Œç¼–äº†ä¸€ä¼šå„¿è§‰å¾—ä¼¼ä¹ $100$ è¿›åˆ¶çš„è¯æ³•æ¯”è¾ƒç®€å•ã€‚å°±æ˜¯è€ƒè™‘å†™æˆç™¾è¿›åˆ¶çš„è¯ä¼šæ˜¯è¿™æ ·ï¼š</p><script type="math/tex; mode=display">\sum _{i=1}^ka_{i}100^{k-1}\equiv 0\pmod {11}</script><p>å‘ç° $100 \bmod 11$ æ˜¯ $1$ ï¼Œå°±å¾ˆå¿«ä¹ï¼š</p><script type="math/tex; mode=display">\sum_{i=1}^ka_i\equiv 0\pmod {11}</script><p>ç„¶åè€ƒè™‘ç™¾è¿›åˆ¶è½¬10è¿›åˆ¶ï¼Œå‘ç°æœ‰</p><script type="math/tex; mode=display">a_{i}=b^{2i-1}+10\cdot b^{2i}</script><p>é‚£ä¹ˆè€ƒè™‘ $10$ åœ¨ $\pmod {11}$ æ—¶ç­‰ä»·äº $-1$ ï¼Œäºæ˜¯å°±å¯ä»¥çŸ¥é“</p><script type="math/tex; mode=display">\sum_{i=1}^ka_i=\sum_{i=1}^k(b^{2i-1}- b^{2i})\equiv 0 \pmod {11}</script><p>äºæ˜¯å¾—è¯ã€‚</p><p>2ã€è¯æ˜</p><blockquote><p>$7/11/13$ æ•´é™¤ $a$ çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯ï¼Œæœ€åä¸‰ä½æ•°å­—ä¸åˆ å»æœ€åä¸‰ä½ä»¥åç»„æˆçš„æ•°ï¼Œæ‰€ä½œä¹‹å·®è¢« $7/11/13$ æ•´é™¤ã€‚</p></blockquote><p>è¯æ˜æ–¹æ³•å·®ä¸å¤šï¼Ÿè®¾åä¸‰ä½ç»„æˆçš„æ•°æ˜¯ $b$ ï¼Œåˆ å»æœ€åä¸‰ä½ä»¥åç»„æˆçš„æ•°æ˜¯ $c$ ï¼Œé‚£ä¹ˆæœ‰</p><script type="math/tex; mode=display">a=b+c\times 1000</script><p>è‹¥</p><script type="math/tex; mode=display">a\equiv 0\pmod k</script><p>é‚£ä¹ˆä¸€å®šæœ‰</p><script type="math/tex; mode=display">b+c\times (1000\bmod k)\equiv 0\pmod k</script><p>è€ƒè™‘ $1001=7\times 11\times 13$ ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“ $1000 \bmod k\equiv -1 \pmod k$ ã€‚äºæ˜¯å¾—è¯ã€‚</p><h1 id="å‰©ä½™ç±»ç›¸å…³ç†è®º"><a href="#å‰©ä½™ç±»ç›¸å…³ç†è®º" class="headerlink" title="å‰©ä½™ç±»ç›¸å…³ç†è®º"></a>å‰©ä½™ç±»ç›¸å…³ç†è®º</h1><p>è‰ï¼Œæˆ‘æ˜¯çœŸè§‰å¾—æŠ½ä»£å…¥å®Œé—¨å†æ¥å­¦è¿™ä¸ªæ¯”è¾ƒåˆé€‚ã€‚</p><p>äºæ˜¯å› ä¸ºå†…å®¹å¤ªå¤šäº†æˆ‘å°±å¦å¼€äº†ä¸€ç¯‡ï¼Œæƒ³ä¸åˆ°äº†å§ï¼Ÿ<del>æœºæ™ºå¦‚æˆ‘</del></p><h1 id="ä¸€æ¬¡åŒä½™æ–¹ç¨‹"><a href="#ä¸€æ¬¡åŒä½™æ–¹ç¨‹" class="headerlink" title="ä¸€æ¬¡åŒä½™æ–¹ç¨‹"></a>ä¸€æ¬¡åŒä½™æ–¹ç¨‹</h1><blockquote><p>å½¢å¦‚</p><script type="math/tex; mode=display">ax\equiv b\pmod m\qquad (1)</script><p>çš„æ–¹ç¨‹ã€‚</p></blockquote><h2 id="å®šç†1"><a href="#å®šç†1" class="headerlink" title="å®šç†1"></a>å®šç†1</h2><blockquote><p>è‹¥ $(a,m)=1$ ï¼Œåˆ™è¯¥å¼åªæœ‰ $1$ è§£ã€‚</p></blockquote><p>è¿™æ˜¯ä¸éš¾ç†è§£çš„ã€‚å› ä¸ºå¯ä»¥çŸ¥é“ $(1,2,3,\cdots m)$ æ„æˆäº†æ¨¡ $m$ çš„ä¸€ä¸ªå®Œå…¨å‰©ä½™ç³»ï¼ŒåŒæ—¶ $(a,2\cdot a,3\cdot a\cdots m\cdot a)$ åŒæ ·æ„æˆäº†æ¨¡ $m$ çš„ä¸€ä¸ªå®Œå…¨å‰©ä½™ç³»ã€‚é‚£ä¹ˆæ˜¾ç„¶æ°å¥½ä¸€ä¸ªæ•´æ•°ä½¿å¾— $aq\equiv b\pmod m$ . æ‰€ä»¥è§£å”¯ä¸€ã€‚</p><h2 id="å®šç†2"><a href="#å®šç†2" class="headerlink" title="å®šç†2"></a>å®šç†2</h2><blockquote><p>(2.1) è‹¥è®° $(a,m)=d$ ï¼Œä¸” $d|b$ ï¼Œé‚£ä¹ˆ(1)å¼å­˜åœ¨è§£ã€‚</p><p>(2.2) åœ¨(2.1)çš„å‡è®¾ä¸‹ï¼Œè‹¥(1)å¼å­˜åœ¨è§£ï¼Œé‚£ä¹ˆè§£çš„ä¸ªæ•°ä¸º $d$ ä¸ªã€‚</p></blockquote><p>é¦–å…ˆä¸éš¾çŸ¥é“(1)ç­‰ä»·äº $ax+my=b$ è¿™ä¸ªä¸å®šæ–¹ç¨‹ã€‚é‚£ä¹ˆ(2.1)æ˜¯æ˜¾ç„¶çš„ã€‚</p><p>å¯¹äº(2.2)ï¼Œè€ƒè™‘å°†(1)è½¬åŒ–æˆ</p><script type="math/tex; mode=display">\begin{aligned}\frac{a}{d}x+\frac{m}{d}y&=\frac{b}{d}\\\frac{a}{d}x&\equiv\frac{b}{d}\pmod {\frac{m}{d}}\qquad (2)\\\end{aligned}</script><p>å¯çŸ¥(1)å’Œ(2)çš„è§£æ˜¯ç›¸åŒçš„ã€‚ç”±å®šç†1ï¼Œä¸” $(\frac{a}{(a,m)},\frac{m}{(a,m)})=1$ å¯çŸ¥(2)çš„è§£æ˜¯å”¯ä¸€çš„ï¼Œè®¾ä¸º $t_0$</p><script type="math/tex; mode=display">x_0\equiv t_0\pmod{\frac{m}{d}}</script><p>å¯çŸ¥ä¸€å®šæœ‰ $0\leq t_0&lt;\frac{m}{d}$ ã€‚</p><p>å› æ­¤(1)çš„å…¨éƒ¨è§£ä¸€å®šéƒ½æ˜¯ $t_0+k\frac{m}{d} (k\in \mathbb{Z_+})$ çš„å½¢å¼ã€‚è€ƒè™‘ $k=0,1,2\cdots d-1$ çš„æ—¶å€™ï¼Œæœ‰</p><script type="math/tex; mode=display">t_0+k\frac{m}{d}<\frac{m}{d}</script><p>ä¸”ç”±äºå…¶å•è°ƒæ€§å¯çŸ¥è¿™å‡ ä¸ªè§£äº’å¼‚ã€‚å› æ­¤è¿™ $d$ ä¸ªæ•°åœ¨æ¨¡ $m$ ä¸‹ä¸åŒä½™ã€‚ï¼ˆè¯æ˜äº†è§£è‡³å°‘æœ‰ $d$ ä¸ªï¼‰</p><p>å¦ä¸€æ–¹é¢ï¼Œå¯¹(1)çš„ä»»æ„ä¸€è§£ $t_0+k_0\frac{m}{d}$ ï¼Œä»¤ $k_0=qd+r,0\leq r&lt;d$ ä»£å…¥å¾—ï¼š</p><script type="math/tex; mode=display">t_0+k_0\frac{m}{d}\equiv t_0+(qd+r)\frac{m}{d}\equiv t_0+r\frac{m}{d} \pmod m</script><p>å¯çŸ¥å¯¹äºæ¯ä¸ª $k_0$ï¼Œå‡ä¸æŸä¸ª $0\leq k&lt;d$ æ—¶çš„è§£æœ¬è´¨ç›¸åŒã€‚ï¼ˆè¯æ˜äº†è§£è‡³å¤šæœ‰ $d$ ä¸ªï¼‰ã€‚</p><p>å› æ­¤ï¼Œè¯¥å¼å…±æœ‰æ°å¥½ $d$ ä¸ªè§£ã€‚</p><h2 id="ä¸€èˆ¬è§£æ³•æŠ€å·§"><a href="#ä¸€èˆ¬è§£æ³•æŠ€å·§" class="headerlink" title="ä¸€èˆ¬è§£æ³•æŠ€å·§"></a>ä¸€èˆ¬è§£æ³•æŠ€å·§</h2><p>æœ‰ä¸¤ç§å¸¸ç”¨çš„æŠ€å·§ï¼Œéƒ½æ˜¯åŸºäºå°† $ax\equiv b\pmod m$ è½¬åŒ–ä¸ºå½¢å¼åˆ†å¼ $x\equiv \frac{b}{a}\pmod m$ çš„åŸºç¡€ä¸Šï¼š </p><blockquote><p>1ã€åˆ†å­åˆ†æ¯åŒä¹˜ä¸€ä¸ªä¸ $m$ äº’è´¨çš„æ•°ã€‚</p><p>2ã€å½“ $(a,m)=1$ æ—¶ï¼Œåˆ†å­å¯ä»¥åŠ ä¸Š $m$ çš„å€æ•°ã€‚</p></blockquote><p>æ³¨æ„åˆ°ï¼Œé™åˆ¶ã€Œä¸ $m$ äº’è´¨ã€çš„ç›®çš„æ˜¯ä¸ºäº†ä¿è¯å½¢å¼åˆ†å¼æœ‰æ„ä¹‰ï¼Œå³åªæœ‰ $(a,m)=1$ï¼Œ$a$ åœ¨æ¨¡ $m$ æ„ä¹‰ä¸‹çš„é€†å…ƒæ‰æœ‰æ„ä¹‰ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p>ä¸€é“æ¯’ç˜¤é¢˜</p><blockquote><p> è®¾ $p$ ä¸ºå¥‡ç´ æ•°ï¼Œ$1&lt;a&lt;p$ï¼Œåˆ™ $ax\equiv b\pmod p$ çš„è§£ä¸º</p><script type="math/tex; mode=display">x\equiv b (-1)^{a-1} \frac{(p-1)(p-2)\cdots (p-a+1)}{a!}\pmod p</script></blockquote><p>è€ƒè™‘æŠŠ $(-1)^{a-1}$ ä¹˜åˆ°ä¸Šé¢çš„æ‹¬å·é‡Œå»</p><script type="math/tex; mode=display">\begin{aligned}&(-1)^{a-1} \frac{(p-1)(p-2)\cdots (p-a+1)}{a!}\\ \equiv&\frac{(1-p)(2-p)\cdots (a-1-p)}{a!}\\\equiv&\frac{(1)\cdot (2)\cdots (a-1)}{a!} \equiv\frac{1}{a}\pmod p\end{aligned}</script><p>ç„¶åå°±è¯å®Œäº†ã€‚æ¯’ç˜¤å°±æ¯’ç˜¤åœ¨â€¦æˆ‘å¤ªä¸ä¼šâ€¦/dk</p><p>ä¸ªäººè®¤ä¸ºå†™æˆè¿™æ ·å¸…ä¸€ç‚¹</p><script type="math/tex; mode=display">x\equiv b (-1)^{a-1} \binom{p}{a}\pmod p</script><h1 id="ä¸­å›½å‰©ä½™å®šç†"><a href="#ä¸­å›½å‰©ä½™å®šç†" class="headerlink" title="ä¸­å›½å‰©ä½™å®šç†"></a>ä¸­å›½å‰©ä½™å®šç†</h1><blockquote><p>è‹¥ $m_1,m_2\cdots m_k$ ä¸ºä¸¤ä¸¤äº’ç´ çš„æ­£æ•´æ•°ï¼Œè®° $M=\prod m$ ï¼Œ$r_i=\frac{M}{m_i}$ ï¼Œåˆ™ä¸€æ¬¡åŒä½™æ–¹ç¨‹</p><script type="math/tex; mode=display">\left\{\begin{array}{cc}x \equiv a_{1} & \left(\bmod m_{1}\right) \\x \equiv a_{2} & \left(\bmod m_{2}\right) \\\vdots \\x \equiv a_{k} & \left(\bmod m_{k}\right)\end{array}\right.</script><p>æœ‰å”¯ä¸€è§£ $x\equiv t$ ï¼Œä¸”</p><script type="math/tex; mode=display">t\equiv\sum _{i=1}^ka_ir_iq_i\pmod M</script><p>å…¶ä¸­ $q_i=\frac{1}{r_i}\pmod {m_i}$ ã€‚</p></blockquote><p><del>å¥½éš¾èƒŒå•Š</del></p><p>ä¸è¿‡æ„é€ æ–¹å¼æ˜¯å¾ˆæœ‰è¶£çš„ã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘ç±»ä¼¼æ‹‰æ ¼æœ—æ—¥æ’å€¼çš„æ„é€ æ–¹æ³•ï¼Œè¦æ‰¾ä¸€å † $\zeta_i$ æ»¡è¶³ï¼š</p><script type="math/tex; mode=display">\zeta_i\equiv\left\{\begin{array}{cc}1\pmod {m_j},\qquad j=i\\0\pmod {m_j},\qquad j\not=i\\\end{array}\right.</script><p>åˆ™å¯å–</p><script type="math/tex; mode=display">x_0=\sum_{i=1}^k\zeta_ia_i</script><p>ä½œä¸ºä¸€ç»„è§£ã€‚é‚£ä¹ˆæ˜¾ç„¶æ®æ­¤æ„é€ çš„æ–¹æ¡ˆæ»¡è¶³è¿™ä¸ªæ¡ä»¶ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œå¯¹äºå¦ä¸€ä¸ªè§£ $x_1$ æœ‰</p><script type="math/tex; mode=display">\left\{\begin{array}{cc}x_0 \equiv x_{1} & \left(\bmod m_{1}\right) \\x_0 \equiv x_{1} & \left(\bmod m_{2}\right) \\\vdots \\x_0 \equiv x_{1} & \left(\bmod m_{k}\right)\end{array}\right.</script><p>ç”±äº $m_1,m_2\cdots m_k$ ä¸¤ä¸¤äº’ç´ ï¼Œå¯çŸ¥ $x_1\equiv x_0\pmod M$ã€‚å³å…¨éƒ¨çš„è§£éƒ½å¯ä»¥è¡¨ç¤ºæˆ</p><script type="math/tex; mode=display">x\equiv x_0\pmod M</script><p>â€‹                                                                              </p><h1 id="exCRT"><a href="#exCRT" class="headerlink" title="exCRT"></a>exCRT</h1><blockquote><p>å¤§æ¦‚å°±æ˜¯ç»™å‡ºçš„ $m_i$ ä¸å†äº’è´¨çš„æƒ…å†µã€‚</p></blockquote><p>è€ƒè™‘æ­¤æ—¶æ™®é€šçš„crtä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ã€‚åœ¨ $m_i$ å½¼æ­¤äº’è´¨çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥çŸ¥é“ $r_i=\frac{M}{m_i}$ ä¿è¯ $(m_i,r_i)=1$ï¼Œé‚£ä¹Ÿå°±ä¿è¯äº† $r_i$ åœ¨æ¨¡ $m_i$ æ„ä¹‰ä¸‹å­˜åœ¨é€†å…ƒã€‚ä½†æ˜¯å½“ $(m_i,r_i)&gt;1$ æ—¶ï¼Œ$q_i$ å°±æ²¡æœ‰æ„ä¹‰äº†ã€‚</p><p>è€ƒè™‘å¢é‡æ³•ã€‚ä¸€å¼€å§‹æœ‰ä¸¤ä¸ªæ–¹ç¨‹</p><script type="math/tex; mode=display">x\equiv a\pmod b\\x\equiv c\pmod d \\</script><p>é‚£ä¹ˆæœ‰ $bt+aâ‰¡c \pmod d$ ç”¨ exgcd è§£å‡º $tâ‰¡t_0 \pmod{\frac{d}{(b,d)}}$</p><p>ä»£å›å¾— $x â‰¡ x_0 \pmod{[b, d]} $ã€‚è¿™æ ·è¿­ä»£åšä¸‹å»å°±å¥½äº†ã€‚æ„Ÿè§‰å†™è¿™ç§ä»£ç è¿˜æ˜¯è¦æŠŠå˜é‡åˆ†æ¸…ï¼Œå°½é‡å†™çš„æ¸…æ¥šã€æ¾æ•£ä¸€ç‚¹ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ; </span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line">ll A[N] ;</span><br><span class="line">ll m[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll &amp;x, ll &amp;y, ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b)&#123; x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> a ; &#125;</span><br><span class="line">    ll g = exgcd(x, y, b, a % b), tmp = x ;</span><br><span class="line">    x = y ; y = tmp - a / b * y ; <span class="keyword">return</span> g ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">exmul</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">ll res = <span class="number">0</span> ; </span><br><span class="line"><span class="keyword">while</span> (b)&#123;</span><br><span class="line"><span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">(res += a) %= mod ;</span><br><span class="line">(a += a) %= mod ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">excrt</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll res, mod ;</span><br><span class="line">    ll a, b, c, d, M ;</span><br><span class="line">    ll x, y, t0, t, g, z ;</span><br><span class="line">    res = A[<span class="number">1</span>] ; mod = m[<span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        a = res, b = mod ;</span><br><span class="line">        c = A[i], d = m[i] ;</span><br><span class="line">        g = exgcd(x, y, b, d) ;</span><br><span class="line">z = ((c - a) % d + d) % d ;</span><br><span class="line">M = d / g ; <span class="keyword">if</span> (z % g &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">        t = exmul(x, (z / g), M) ; mod = mod * M ;</span><br><span class="line">        res = ((res + exmul(t, b, mod)) % mod + mod) % mod ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios :: sync_with_stdio(<span class="number">0</span>) ;</span><br><span class="line">    <span class="built_in">cin</span>.tie(<span class="number">0</span>) ; <span class="built_in">cout</span>.tie(<span class="number">0</span>) ; <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">cin</span> &gt;&gt; m[i] &gt;&gt; A[i] ;</span><br><span class="line">    ll op = excrt() ; <span class="keyword">if</span> (op &lt; <span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">"hahaha"</span>) ; <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; op ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ç¥å¥‡çš„ä¾‹é¢˜"><a href="#ç¥å¥‡çš„ä¾‹é¢˜" class="headerlink" title="ç¥å¥‡çš„ä¾‹é¢˜"></a>ç¥å¥‡çš„ä¾‹é¢˜</h1><h2 id="CF338D"><a href="#CF338D" class="headerlink" title="CF338D"></a>CF338D</h2><blockquote><p>ç»™å‡ºä¸€ä¸ª $n Ã— m$ çš„æ•°è¡¨, å…¶ä¸­ç¬¬ $i$ è¡Œç¬¬ $j$ ä¸ªæ•°æ˜¯ $\gcd(i, j)$ï¼Œå†ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $k$ çš„æ•°åˆ— $\{a_n\}$, åˆ¤æ–­å…¶æ˜¯å¦åœ¨æ•°è¡¨çš„æŸä¸€è¡Œå‡ºç°è¿‡ã€‚</p><p>$n,m â‰¤ 10^{12},k â‰¤ 10^4$</p></blockquote><p>ä¸€é“æœ‰æ„æ€çš„é¢˜ã€‚è€ƒè™‘ç”±äºæ˜¯è¦å»å¯»æ‰¾ä¸€è¡Œï¼Œæ‰€ä»¥è¡Œå·æ˜¯å›ºå®šçš„ã€‚é‚£ä¹ˆå¿…é¡»è¦æœ‰ $\mathrm{lcm}(a_1,a_2\cdots a_k)|x$ ã€‚</p><p>è€ƒè™‘æ˜¯å¦å¯ä»¥é€‰ç”¨ $x=\mathrm{lcm}(a_1,a_2\cdots a_k)$ åšç­”æ¡ˆã€‚æ³¨æ„åˆ°å¦‚æœ $x=p\cdot \mathrm{lcm}(a_1,a_2\cdots a_k)$ å¯è¡Œï¼Œé‚£ä¹ˆä¸€å®šæœ‰</p><script type="math/tex; mode=display">\gcd(p,y) = 1</script><p>é‚£ä¹ˆå‘ç°ï¼Œå¯¹äº $p$ çš„ä»»æ„ä¸€ä¸ªå› å­ï¼Œéƒ½æ»¡è¶³è¯¥æ€§è´¨ã€‚æ‰€ä»¥å– $p=1$ å®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚</p><p>ä¹‹åè€ƒè™‘å»æ£€éªŒ $y$ çš„åˆæ³•æ€§ã€‚ä»¤ç¬¬ä¸€ä¸ªå…ƒç´ ä¹‹å‰çš„é‚£ä¸ªå…ƒç´ (è·Ÿç­”æ¡ˆæ²¡å…³ç³»çš„)ä¸º $(x,y)$ ã€‚å‘ç° $y$ éœ€è¦æ»¡è¶³</p><script type="math/tex; mode=display">\gcd(y+1,x)=a_1,\gcd(y+2,x)=a_2,\gcd(y+3,x)=a_3\cdots</script><p>æ³¨æ„åˆ° $x$ æ˜¯æ‰€æœ‰ $a_i$ çš„ $\rm lcm$ ã€‚é‚£ä¹ˆå¯ä»¥çŸ¥é“ $y+i$ ä¸€å®šéœ€è¦æ˜¯ $a_i$ çš„å€æ•°ï¼Œä¹Ÿå°±æ˜¯</p><script type="math/tex; mode=display">\left\{\begin{array}{l}y+1\equiv 0\left(\bmod a_{1}\right) \\y+2\equiv 0\left(\bmod a_{2}\right) \\\vdots \\y+k\equiv 0\left(\bmod a_{k}\right)\end{array}\right.</script><p>é‚£ä¹ˆç”¨ excrt æ±‚å‡ºè¿™ä¸ª $y$ æ¥å³å¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™æ ·å¹¶ä¸ä»£è¡¨ $y$ åˆæ³•ï¼Œå› ä¸º $y+i$ æ˜¯ $a_i$ çš„å€æ•°ç­‰ä»·äº $\gcd(y+i,x)=a_i\cdot q$ ã€‚ æ‰€ä»¥ä¸ºäº†éªŒè¯æ˜¯å¦åˆæ³•ï¼Œéœ€è¦å†ä»å¤´åˆ¤ä¸€éã€‚</p><p>æ³¨æ„åˆ°å¦‚æœæ­¤æ—¶ä¸å­˜åœ¨ç­”æ¡ˆï¼Œé‚£ä¹ˆä¹Ÿä¸€å®šä¸å­˜åœ¨å…¶ä»–çš„ç­”æ¡ˆã€‚è¿™ä¸€ç‚¹æ˜¯æ¯”è¾ƒæ˜¾ç„¶çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Sunzi&#123;</span><br><span class="line">    ll A[N] ;</span><br><span class="line">    ll m[N] ;</span><br><span class="line">    <span class="function">ll <span class="title">exgcd</span><span class="params">(ll &amp;x, ll &amp;y, ll a, ll b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!b)&#123; x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> a ; &#125;</span><br><span class="line">        ll g = exgcd(x, y, b, a % b), tmp = x ;</span><br><span class="line">        x = y ; y = tmp - a / b * y ; <span class="keyword">return</span> g ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">exmul</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">    <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">    (res += a) %= mod ;</span><br><span class="line">    (a += a) %= mod ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">excrt</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ll res, mod ;</span><br><span class="line">        ll a, b, c, d, M ;</span><br><span class="line">        ll x, y, t0, t, g, z ;</span><br><span class="line">        res = A[<span class="number">1</span>] ; mod = m[<span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= k ; ++ i)&#123;</span><br><span class="line">            a = res, b = mod ;</span><br><span class="line">            c = A[i], d = m[i] ;</span><br><span class="line">            g = exgcd(x, y, b, d) ;</span><br><span class="line">    z = ((c - a) % d + d) % d ;</span><br><span class="line">    M = d / g ; <span class="keyword">if</span> (z % g &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">            t = exmul(x, (z / g), M) ; mod = mod * M ;</span><br><span class="line">            res = ((res + exmul(t, b, mod)) % mod + mod) % mod ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Sunzi ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; p &gt;&gt; k ; ll t = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;base[i]), m[i] = base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i) A[i] = -i ; lcm = m[<span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= k ; ++ i)&#123;</span><br><span class="line">t = m[i] * lcm, lcm = __gcd(lcm, m[i]), lcm = t / lcm  ;</span><br><span class="line"><span class="keyword">if</span> (lcm &gt; n) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>), <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//cout &lt;&lt; lcm &lt;&lt; " " &lt;&lt; t &lt;&lt; endl ; </span></span><br><span class="line">    t = excrt() ; <span class="keyword">if</span> (t &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (ll i = t + <span class="number">1</span> ; i &lt;= t + k ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (__gcd(i, lcm) != base[i - t]) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (t + k &lt;= p) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"YES"</span>), <span class="number">0</span> ; <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>), <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘ç°å½“å¹´å­¦æ•°è®ºï¼Œ4-6é‚£æœ¬ä¹¦ç¬¬äºŒä¸‰ç« åŸºæœ¬ä¸Šå°±æ˜¯æ²¡å­¦ä¼šï¼Œäºæ˜¯ä»Šå¤©æ‰“ç®—é‡å­¦ä¸€éã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ã€‚å¹¶ä¸”å‘ç°è¯»è¿‡çš„MOğŸ“šè¶Šå¤šï¼Œè¿™ç§ä¸œè¥¿å°±è¶Šå¥½ç†è§£ã€‚&lt;/p&gt;
&lt;p&gt;å—¯ï¼Œå¯“å¿«äºæ…¢ï¼Œè—å·§äºæ‹™ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://www.orchidany.cn/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="æ•°å­¦/æ•°è®º" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E6%95%B0%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>ã€å¬è¯¾ç¬”è®°ã€‘æ•°è®ºå¬è¯¾ç¬”è®°</title>
    <link href="https://www.orchidany.cn/2020/03/28/%E6%95%B0%E8%AE%BA%E5%90%AC%E8%AF%BE%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/03/28/æ•°è®ºå¬è¯¾ç¬”è®°/</id>
    <published>2020-03-28T14:29:00.000Z</published>
    <updated>2020-04-16T07:45:53.724Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å¬æ–¯ç»™æ™®è®²çš„æœ‰è¶£çš„æ•°è®ºé—®é¢˜ï¼Œæ„Ÿè§‰æµ·æ˜Ÿï¼Ÿ</p><p>é¡ºä¾¿åŠ ä¸Šäº†ä¸€ç‚¹è‡ªå·±ä¹‹å‰éšä¾¿æ•´ç†çš„ä¸œè¥¿ã€‚</p><a id="more"></a><h1 id="çæ•´ç†ç³»åˆ—"><a href="#çæ•´ç†ç³»åˆ—" class="headerlink" title="çæ•´ç†ç³»åˆ—"></a>çæ•´ç†ç³»åˆ—</h1><h2 id="gcd-çš„å®ç°"><a href="#gcd-çš„å®ç°" class="headerlink" title="gcd çš„å®ç°"></a>gcd çš„å®ç°</h2><h3 id="ä¸€ä¸ªå¿…è¦çš„å¼å­"><a href="#ä¸€ä¸ªå¿…è¦çš„å¼å­" class="headerlink" title="ä¸€ä¸ªå¿…è¦çš„å¼å­"></a>ä¸€ä¸ªå¿…è¦çš„å¼å­</h3><blockquote><p> $a\geq b\to (a,b)=(b,a \bmod ~b)$</p></blockquote><p>ä»¤$a=bp+q~(0\leq 1&lt;b)$ ã€‚è‹¥ $\exists d|a,d|b$ï¼Œåˆ™æœ‰ $daâ€™=dbâ€™p+q$ï¼Œç§»é¡¹å¾— $q=d(aâ€™-bâ€™p)$ï¼Œæ•…$d|q\Longrightarrow d|(a\bmod~b)$ã€‚</p><p>è€ƒè™‘æœ€åï¼Œ$bâ€™=0$ï¼Œæ­¤æ—¶æœ‰ $aâ€™=qâ€™$ï¼Œåˆå› ä¸º $\forall d$ æ»¡è¶³ $d|a,d|b$, $\exists d|qâ€™\to d|aâ€™$ï¼Œå³æ­¤æ—¶ $aâ€™$ æ˜¯æ‰€æœ‰å› å­çš„å€æ•°ï¼Œæ•… $aâ€™$ ä¸ºæœ€å¤§å…¬å› æ•°ã€‚</p><p>è¯´ç™½äº†å°±æ˜¯åˆ°æœ€åæœ‰ä»»æ„æ»¡è¶³ $d|a,d|b$ çš„ $d$ éƒ½æ•´é™¤ $ans$ ï¼Œæ‰€ä»¥ $ans$ æ˜¯æœ€å¤§å…¬å› æ•°ã€‚ </p><h3 id="å¤æ‚åº¦è¯æ˜"><a href="#å¤æ‚åº¦è¯æ˜" class="headerlink" title="å¤æ‚åº¦è¯æ˜"></a>å¤æ‚åº¦è¯æ˜</h3><p>è€ƒè™‘åˆ†ç±»è®¨è®ºï¼Œä¸å¦¨ä»¤ $a&gt;b$.</p><ul><li>å½“ $\frac{a}{2}&gt;b$ æ—¶ï¼Œæœ‰ $a\bmod b&lt;b&lt;\frac{a}{2}$</li><li>å½“ $\frac{a}{2}\leq b$ æ—¶ï¼Œæœ‰ $a\bmod ~b=a-b&lt;\frac{a}{2}$</li></ul><p>æ‰€ä»¥å¤æ‚åº¦æ˜¯ $\log(\max(a,b))$ çš„ã€‚</p><h2 id="exgcd-çš„å®ç°"><a href="#exgcd-çš„å®ç°" class="headerlink" title="exgcd çš„å®ç°"></a>exgcd çš„å®ç°</h2><p>è€ƒè™‘ä¸¢ç•ªå›¾æ–¹ç¨‹ $ax+by=(a,b)$ ã€‚</p><p>å‘ç°è¿­ä»£åˆ° $x=1,y=0$ æ—¶ï¼Œä¸Šå¼ä¾æ—§æˆç«‹ã€‚å› ä¸ºè¿­ä»£åˆ°æ­¤æ—¶ $aâ€™=(a,b),bâ€™=0$ ã€‚</p><p>åŒæ—¶å› ä¸º $(a,b)=(b,a\bmod b)$ï¼Œæ‰€ä»¥æœ‰ $bx+y\cdot (a\bmod ~b)=(a,b)$ ï¼ŒåŒ–ç®€ï¼š</p><script type="math/tex; mode=display">\begin{aligned}bx+y\cdot (a-b\cdot \lfloor \frac{a}{b}\rfloor)&= (a,b)\\ay+b(x-y\cdot \lfloor \frac{a}{b}\rfloor) &=(a,b)\end{aligned}</script><p>æŒ‰ç…§è¿™ç§å½¢å¼å‘ä¸Šé€’å½’åï¼Œå°±ä¼šå°‘ä¸€å±‚$\bmod$ ç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚ </p><h2 id="é˜¶"><a href="#é˜¶" class="headerlink" title="é˜¶"></a>é˜¶</h2><blockquote><p>ä½¿å¾—</p><script type="math/tex; mode=display">a^x\equiv 1(\bmod p)</script><p>çš„æœ€å°çš„ $x$ ç§°ä¸º $a$ å…³äº $p$ çš„<strong>é˜¶</strong>ã€‚</p></blockquote><p>é‚£ä¹ˆæœ‰ç»“è®º $x|\varphi(p)$ ã€‚</p><p>è€ƒè™‘åè¯æ³•ã€‚å› ä¸º</p><script type="math/tex; mode=display">a^x\equiv 1(\bmod p)\\a^{\varphi(p)} \equiv 1(\bmod p)</script><p>ä¸” $x$ æœ€å°ï¼Œæ•… $x&lt;\varphi(p)$ ï¼Œåˆå› ä¸ºå‡è®¾ $x$ ä¸æ˜¯ $\varphi(p)$ çš„çº¦æ•°ã€‚é‚£ä¹ˆä¸å¦¨ä»¤ $\varphi(p)\equiv kx+q(0\leq q&lt;x)$ ï¼Œåˆ™æœ‰</p><script type="math/tex; mode=display">\begin{aligned}\frac{a^{\varphi(p)}}{(a^{x})^k}& \equiv a^q\\&\equiv 1(\bmod p)\end{aligned}</script><p>ä½†è¿™æ˜¾ç„¶ä¸åˆç†ï¼Œå› ä¸º $x&gt;q$ ä½†æ ¹æ®å®šä¹‰ $x$ åº”è¯¥æ˜¯æœ€å°çš„æ»¡è¶³ $a^o\equiv 1(\bmod p)$ çš„æ•°ï¼ŒQEDã€‚</p><h2 id="å¨å°”é€Šå®šç†"><a href="#å¨å°”é€Šå®šç†" class="headerlink" title="å¨å°”é€Šå®šç†"></a>å¨å°”é€Šå®šç†</h2><blockquote><p>å¯¹äºç´ æ•° $p$ï¼Œæœ‰</p><script type="math/tex; mode=display">(p-1)!\equiv -1 (\bmod p)</script></blockquote><p>è¯æ˜å¤§æ¦‚å°±æ˜¯è€ƒè™‘ï¼Œåœ¨$2,3,â€¦,n-3,n-2$ä¸­ï¼Œæ¯ä¸ªæ•°æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªé€†å…ƒï¼Œä¸ä¼š $\geq p$ ä¸”å”¯ä¸€ï¼Œæ‰€ä»¥ä¼šäº’ç›¸æŠµæ¶ˆã€‚</p><h1 id="exgcdçš„åº”ç”¨"><a href="#exgcdçš„åº”ç”¨" class="headerlink" title="exgcdçš„åº”ç”¨"></a>exgcdçš„åº”ç”¨</h1><h2 id="ç±»æ¬§å‡ é‡Œå¾—é—®é¢˜"><a href="#ç±»æ¬§å‡ é‡Œå¾—é—®é¢˜" class="headerlink" title="ç±»æ¬§å‡ é‡Œå¾—é—®é¢˜"></a>ç±»æ¬§å‡ é‡Œå¾—é—®é¢˜</h2><script type="math/tex; mode=display">\sum_{x=1}^{n}\lfloor \frac{ax+b}{c}\rfloor</script><p>å‘ç°å…¶å®æœ¬è´¨ä¸Šæ±‚çš„æ˜¯ä¸€æ¡ç›´çº¿åœ¨ $x$ æ­£åŠè½´å’Œ $y$ çš„æ­£åŠè½´çš„æ•´ç‚¹æ•°é‡ã€‚é‚£ä¹ˆè€ƒè™‘å¯¹äºçŸ©å½¢åŒºåŸŸå¯ä»¥éšä¾¿æ±‚ï¼Œå¯¹äºä¸‰è§’å½¢åŒºåŸŸï¼Œå¯ä»¥è®© $a$ å¯¹ $c$ å–æ¨¡ä¹‹åä¾æ—§ä¸å½±å“ç»“æœï¼Œæ‰€ä»¥è€ƒè™‘æ²¿ç€ $y=x$ å¯¹ç§°ï¼Œé‚£ä¹ˆä¼šä½¿å¾— $\frac{a}{c}$ å˜æˆ $\frac{c}{a}$ ï¼Œè¿™æ ·å°±å¯ä»¥è¾¾åˆ°ä¸€ä¸ªè¾—è½¬ç›¸é™¤çš„æ•ˆæœï¼Œå¤æ‚åº¦ $\log n$ ã€‚</p><h2 id="æ‚é¢˜1"><a href="#æ‚é¢˜1" class="headerlink" title="æ‚é¢˜1"></a>æ‚é¢˜1</h2><p>å·²çŸ¥ $a_x=a_{x-1}+a_{x-2}$ ï¼Œç»™å®š $a_1$, æ±‚æœ‰å¤šå°‘ä¸ª $a_2\in[l,r]$ ä½¿å¾— $a_k=b~(\bmod p)$. $k,p=O(10^9)$ ã€‚</p><p>å‘ç°æœ€åçš„ $a_k$ ä¸€å®šå¯ä»¥å†™æˆ $ca_1+da_2=a_k=b(\mod p)$ ï¼Œç„¶åå°±è½¬åŒ–æˆä¸€ä¸ªç $exgcd$ é—®é¢˜äº†ã€‚</p><h1 id="å¤šé¡¹å¼å¤åˆ"><a href="#å¤šé¡¹å¼å¤åˆ" class="headerlink" title="å¤šé¡¹å¼å¤åˆ"></a>å¤šé¡¹å¼å¤åˆ</h1><blockquote><p> å·²çŸ¥ $f(x), g(x)$ï¼Œæ±‚ $f(g(x))\mod x^n$ ï¼Œ$1\leq n,m\leq 4000$ã€‚</p></blockquote><p>å› ä¸º</p><script type="math/tex; mode=display">f(g(x))=\sum_{i=0}^{n} f_{i} g(x)^{i}</script><p>äºæ˜¯è€ƒè™‘é¢„å¤„ç† $g(x),g^2(x)\cdots g^p(x)$ ï¼Œå’Œ $g^{2p}(x),g^{3p}(x)\cdots$ è¿™æ ·ï¼Œæ¯å—å…ˆå¯¹ $f_{i+kp}g(x)^i$ æ±‚å’Œå†åšå¤šé¡¹å¼ä¹˜æ³•ã€‚</p><p>æœ€åå¤æ‚åº¦å°±æ˜¯ $O(nm+\sqrt mn\log n)$</p><h1 id="Stern-brocot-Tree"><a href="#Stern-brocot-Tree" class="headerlink" title="Stern-brocot Tree"></a>Stern-brocot Tree</h1><p>å¤§æ¦‚æ˜¯æŠŠ $\frac{0}{1}$ å’Œ $\frac{1}{0}$ å½“åšä¸¤ä¸ªè™šæ ¹ã€‚ç„¶åæ¯æ¬¡åœ¨ä¸¤ä¸ªç‚¹ $\frac{n}{m}$ å’Œ $\frac{nâ€™}{mâ€™}$ ä¸­é—´æ’å…¥ä¸€ä¸ª $\frac{nâ€™+n}{mâ€™+m}$ ã€‚ä¹‹åå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="1.png" alt></p><blockquote><p>bzoj 2852</p><p>ç»™ä¸¤ä¸ªæœ‰ç†æ•° $a,b$ï¼Œæ±‚æœ€å°çš„æ­£æ•´æ•° $k$, ä½¿å¾— $(ak,bk)$ é‡Œæœ‰æ•´æ•°ã€‚</p><p>$a$, $b$ æ•´æ•°éƒ¨åˆ†ä¸è¶…è¿‡ $2^{31}$ , å°æ•°ä½æ•°ä¸è¶…è¿‡ $300$ ä½ã€‚</p></blockquote><p>å‘ç° $(a,b)$ çš„ç­”æ¡ˆå’Œ $(a-1,b-1)$ çš„ç­”æ¡ˆä¸€æ ·ã€‚æ‰€ä»¥è€ƒè™‘å°† $(ak,bk)$ ç§»åŠ¨åˆ° $[0,1)$ è¿™ä¸ªåŒºé—´ã€‚æ­¤æ—¶å¦‚æœ $b\geq 1$ æˆ–è€… $a=0$ é‚£ä¹ˆå°±å¯ä»¥æ‰¾ $0/1$ ã€‚å¦åˆ™å°±å˜æˆäº†è§£è¿™æ ·ä¸€ä¸ªä¸ç­‰å¼ï¼š</p><script type="math/tex; mode=display">a \times k \leq t \leq b \times k</script><p>ä¹Ÿå°±æ˜¯</p><script type="math/tex; mode=display">a \leq \frac{t}{k} \leq b</script><p>é‚£ä¹ˆå°±æ˜¯æ‰¾ä¸€ä¸ªåˆ†æ¯æœ€å°çš„å¤¹åœ¨ $a,b$ ä¹‹é—´çš„åˆ†æ•°ã€‚å¹¶ä¸”ç”±äº $b&lt;1$ æ‰€ä»¥ä¸€å®šæ˜¯ä¸ªçœŸåˆ†æ•°ã€‚é‚£ä¹ˆå°±å¯ä»¥åœ¨stern-brocot Treeæ ‘ä¸Šæ‰¾LCAå³å¯ã€‚</p><p>è¿™ä¸ªåœ°æ–¹ä¼¼ä¹æ˜¯ä¸ç”¨çœŸçš„å»ºå‡ºæ¥æ ‘ï¼Œå› ä¸ºå­˜åœ¨æŸç§ç¥ç§˜çš„æ ‘ä¸ŠäºŒåˆ†æ–¹å¼ï¼Œååˆ†é«˜å¦™ã€‚</p><h1 id="å¢å¡æ–¯å®šç†"><a href="#å¢å¡æ–¯å®šç†" class="headerlink" title="å¢å¡æ–¯å®šç†"></a>å¢å¡æ–¯å®šç†</h1><script type="math/tex; mode=display">\left(\begin{array}{l}n \\m\end{array}\right) \equiv\left(\begin{array}{l}n \bmod p \\m \bmod p\end{array}\right) \times\left(\begin{array}{l}\left\lfloor\frac{n}{p}\right\rfloor \\\left\lfloor\frac{m}{p}\right\rfloor\end{array}\right) \quad(\bmod p)</script><h2 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h2><p>ä»Šå¤©é‡å­¦äº†ä¸€éï¼Œå‘ç°è¯æ˜å¥½ç®€å•ï¼Ÿ</p><p>å¯¹äº $p$ æ˜¯è´¨æ•°è€Œè¨€ï¼Œæ ¹æ®è´¹é©¬å°å®šç†ä¸€å®šæœ‰</p><script type="math/tex; mode=display">(1+x)^p\equiv (1+x) \pmod p</script><p>å’Œ</p><script type="math/tex; mode=display">x\equiv x^p  \pmod p</script><p>æ‰€ä»¥æœ‰</p><script type="math/tex; mode=display">(1+x)^p\equiv 1+x^p \pmod p</script><p>å¦‚æœè®¾ $n=sp+t,~0\leq t&lt;p$ ã€‚é‚£ä¹ˆå°±æœ‰</p><script type="math/tex; mode=display">\begin{aligned}(1+x)^n\equiv &(1+x)^{sp+t}\\\equiv &(1+x)^{sp}\cdot (1+x)^t\\\equiv &(1+x^p)^s\cdot (1+x)^t\\\equiv &(1+x^p)^{\left\lfloor\frac{n}{p}\right\rfloor}\cdot (1+x)^{x\bmod p}\end{aligned}\pmod p</script><p>è€ƒè™‘ä¸¤è¾¹éƒ½æš´åŠ›äºŒé¡¹å¼å±•å¼€</p><script type="math/tex; mode=display">\sum_{i=0}^n\binom{n}{i}x^i=\left(\sum_{j=0}^{\left\lfloor\frac{n}{p}\right\rfloor}\binom{n}{j}x^{j\cdot p}\right)\times \left(\sum_{k=0}^{n\bmod p}\binom{n}{k}x^{k}\right)\pmod p</script><p>è§‚å¯Ÿå³è¾¹ã€‚å‘ç°å› ä¸ºåé¢é‚£ä¸ªæ‹¬å·é‡Œ $x$ çš„æ¬¡æ•° $&lt;p$ï¼Œå‰é¢ä¸€ä¸ªæ‹¬å·å†… $x$ çš„æ¬¡æ•°ä¸€å®šæ˜¯ $p$ çš„å€æ•° ã€‚æ‰€ä»¥å¯¹äºæ¯ä¸ª $i$ ï¼Œéƒ½æœ‰å”¯ä¸€çš„ $j\cdot p+k=i$ ï¼ˆå¸¦ä½™é™¤æ³•çš„å”¯ä¸€æ€§ï¼‰ã€‚æ‰€ä»¥å¯çŸ¥</p><script type="math/tex; mode=display">\left(\begin{array}{l}n\\m\end{array}\right) \equiv\left(\begin{array}{l}n \bmod p \\m \bmod p\end{array}\right) \times\left(\begin{array}{l}\left\lfloor\frac{n}{p}\right\rfloor \\\left\lfloor\frac{m}{p}\right\rfloor\end{array}\right) \quad(\bmod p)</script><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Lucas_T&#123;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line">ll ans, tn, tm, tp, fac[N], inv[N] ;</span><br><span class="line"><span class="function">ll <span class="title">expow</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">ll ret = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">while</span> (b)&#123;</span><br><span class="line"><span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">(ret *= a) %= mod ;</span><br><span class="line">(a *= a) %= mod ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">my_assign</span><span class="params">(ll x, ll y, ll z)</span></span>&#123;</span><br><span class="line">tn = x ; tm = y ; tp = z ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre_do</span><span class="params">(<span class="keyword">int</span> U)</span></span>&#123;</span><br><span class="line">fac[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line">fac[i] = fac[i - <span class="number">1</span>] * (ll)i % tp ;</span><br><span class="line">inv[U] = expow(fac[U], tp - <span class="number">2</span>, tp) ; </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = U ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">inv[i - <span class="number">1</span>] = inv[i] * (ll)i % tp ;</span><br><span class="line"><span class="comment">//debug(fac, 1, U, '\n') ;</span></span><br><span class="line"><span class="comment">//debug(inv, 1, U, '\n') ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">comb</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> fac[a] * inv[b] % tp * inv[a - b] % tp ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">do_do</span><span class="params">(ll x, ll y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &lt; y) <span class="keyword">return</span> <span class="number">0l</span>l ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (x &lt; tp) <span class="keyword">return</span> comb(x, y) ; </span><br><span class="line"><span class="keyword">return</span> do_do(x % tp, y % tp) * do_do(x / tp, y / tp) % tp ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Lucas</span><span class="params">()</span></span>&#123;</span><br><span class="line">my_assign(n + m, n, p) ; </span><br><span class="line">pre_do(tp - <span class="number">1</span>) ; ans = do_do(tn, tm) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çŸ¥é“çš„æ˜¯ï¼ŒLucaså®šç†è¿˜æœ‰å¦ä¸€ç§è¡¨ç¤ºæ–¹å¼ã€‚å¦‚æœæŠŠ $m,n$ éƒ½çœ‹ä½œ $p$ è¿›åˆ¶æ•°çš„è¯ï¼Œå³</p><script type="math/tex; mode=display">m=(\overline{m_1m_2\cdots m_k})_p\\n=(\overline{n_1n_2n_3\cdots n_k})_p</script><p>é‚£ä¹ˆæœ‰</p><script type="math/tex; mode=display">\binom{n}{m}\equiv\prod _{i=1}^k \binom{n_i}{m_i} \pmod p</script><p>å…¶å®ä¸éš¾ç†è§£ï¼Œå¯ä»¥è”æƒ³åè¿›åˆ¶æ•°æ‹†åˆ†å‡ºæ¯ä¸€ä½çš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯ $\bmod 10$ ä¹‹åå†é™¤ä»¥ $10$ ã€‚</p><h2 id="ä¾‹é¢˜ï¼šå¤ä»£çŒªæ–‡"><a href="#ä¾‹é¢˜ï¼šå¤ä»£çŒªæ–‡" class="headerlink" title="ä¾‹é¢˜ï¼šå¤ä»£çŒªæ–‡"></a>ä¾‹é¢˜ï¼šå¤ä»£çŒªæ–‡</h2><blockquote><p>æ±‚ $g^\sum\textstyle_{d|n}\binom{n}{d}\bmod 999911659$ ã€‚</p></blockquote><p>å‘ç° $999911658=2\times 3\times 4679\times 35617$ ï¼Œç„¶ååˆ†åˆ«åš Lucas å†æ‹¿crtåˆå¹¶èµ·æ¥å°±å¥½äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">999911659</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(ll *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(<span class="keyword">int</span> *tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; tp[i] &lt;&lt; <span class="string">" "</span> ;  <span class="built_in">cout</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000110</span> ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Lucas_T&#123;</span><br><span class="line">ll ans ;</span><br><span class="line">    ll tp, tn, tm ;</span><br><span class="line">    ll fac[N], inv[N] ;</span><br><span class="line"><span class="function">ll <span class="title">expow</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">ll ret = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">while</span> (b)&#123;</span><br><span class="line"><span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">(ret *= a) %= mod ;</span><br><span class="line">(a *= a) %= mod ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">my_assign</span><span class="params">(ll x, ll y, ll z)</span></span>&#123;</span><br><span class="line">tn = x ; tm = y ; tp = z ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre_do</span><span class="params">(<span class="keyword">int</span> U)</span></span>&#123;</span><br><span class="line">fac[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= U ; ++ i)</span><br><span class="line">fac[i] = fac[i - <span class="number">1</span>] * (ll)i % tp ;</span><br><span class="line">inv[U] = expow(fac[U], tp - <span class="number">2</span>, tp) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = U ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">inv[i - <span class="number">1</span>] = inv[i] * (ll)i % tp ;</span><br><span class="line"><span class="comment">//debug(fac, 1, U, '\n') ;</span></span><br><span class="line"><span class="comment">//debug(inv, 1, U, '\n') ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">comb</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> fac[a] * inv[b] % tp * inv[a - b] % tp ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">do_do</span><span class="params">(ll x, ll y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &lt; y) <span class="keyword">return</span> <span class="number">0l</span>l ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (x &lt; tp) <span class="keyword">return</span> comb(x, y) ;</span><br><span class="line"><span class="keyword">return</span> do_do(x % tp, y % tp) * do_do(x / tp, y / tp) % tp ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Lucas</span><span class="params">(ll x, ll y, ll z)</span></span>&#123;</span><br><span class="line">        my_assign(x, y, z) ;</span><br><span class="line">        ans = do_do(tn, tm) ; <span class="keyword">return</span> ans ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Sunzi&#123;</span><br><span class="line">    ll A[N], m[N] ;</span><br><span class="line">    <span class="function">ll <span class="title">exgcd</span><span class="params">(ll &amp;x, ll &amp;y, ll a, ll b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!b)&#123; x = <span class="number">1</span>, y = <span class="number">0</span> ; <span class="keyword">return</span> a ; &#125;</span><br><span class="line">        ll g = exgcd(x, y, b, a % b), tmp = x ;</span><br><span class="line">        x = y ; y = tmp - a / b * y ; <span class="keyword">return</span> g ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">exmul</span><span class="params">(ll a, ll b, ll mod)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">    <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">    (res += a) %= mod ;</span><br><span class="line">    (a += a) %= mod ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">excrt</span><span class="params">(<span class="keyword">int</span> pn)</span></span>&#123;</span><br><span class="line">        ll res, mod ;</span><br><span class="line">        ll a, b, c, d, M ;</span><br><span class="line">        ll x, y, t0, t, g, z ;</span><br><span class="line">        res = A[<span class="number">1</span>] ; mod = m[<span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= pn ; ++ i)&#123;</span><br><span class="line">            a = res, b = mod ;</span><br><span class="line">            c = A[i], d = m[i] ;</span><br><span class="line">            g = exgcd(x, y, b, d) ;</span><br><span class="line">    z = ((c - a) % d + d) % d ;</span><br><span class="line">    M = d / g ; <span class="keyword">if</span> (z % g &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span> ;</span><br><span class="line">            t = exmul(x, (z / g), M) ; mod = mod * M ;</span><br><span class="line">            res = ((res + exmul(t, b, mod)) % mod + mod) % mod ;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> k ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line">ll n, g ;</span><br><span class="line">ll res[N] ;</span><br><span class="line">ll base[N] ;</span><br><span class="line">ll p[<span class="number">4</span>] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4679</span>, <span class="number">35617</span>&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; g ;</span><br><span class="line">    <span class="keyword">if</span> (g % P == <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"0"</span>), <span class="number">0</span> ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="built_in">sqrt</span>(n) ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) base[++ cnt] = i ;</span><br><span class="line">    <span class="keyword">int</span> t = cnt ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= t ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (n / base[i] &gt; <span class="built_in">sqrt</span>(n))</span><br><span class="line">            base[++ cnt] = n / base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= <span class="number">3</span> ; ++ i)&#123;</span><br><span class="line">        Lucas_T :: tp = p[i] ;</span><br><span class="line">Lucas_T :: pre_do(p[i] - <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)</span><br><span class="line">            (res[i] += Lucas_T :: Lucas(n, base[j], p[i])) %= (P - <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= <span class="number">3</span> ; ++ i)</span><br><span class="line">        Sunzi :: A[i + <span class="number">1</span>] = res[i], Sunzi :: m[i + <span class="number">1</span>] = p[i] ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; Lucas_T :: expow(g, Sunzi :: excrt(<span class="number">4</span>), P) &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¾‹é¢˜ï¼šç»„åˆæ•°é—®é¢˜"><a href="#ä¾‹é¢˜ï¼šç»„åˆæ•°é—®é¢˜" class="headerlink" title="ä¾‹é¢˜ï¼šç»„åˆæ•°é—®é¢˜"></a>ä¾‹é¢˜ï¼šç»„åˆæ•°é—®é¢˜</h2><blockquote><p>æ±‚ $0â‰¤jâ‰¤iâ‰¤n$ ä¸” $jâ‰¤m$ çš„æ•°å¯¹ $(i,j)$ é‡Œæœ‰å¤šå°‘æ»¡è¶³ $\binom{i}{j}â‰¡0 \pmod p$</p><p>$T â‰¤ 100,n,m â‰¤ 10^{18},p â‰¤ 100$ ä¸”æ˜¯ä¸€ä¸ªè´¨æ•°.</p></blockquote><p>æ ¹æ®ä¸Šé¢é‚£ä¸ªæ€§è´¨ï¼Œåªè¦ $p$ è¿›åˆ¶ä¸‹ $i$ çš„ä»»ä½•ä¸€ä½ $&lt;j$ å°± $\equiv 0$ ã€‚ç„¶åå°±ç›´æ¥æ•°ä½dpå°±å®Œäº†ã€‚</p><h2 id="å°-Q-çš„é›†åˆ"><a href="#å°-Q-çš„é›†åˆ" class="headerlink" title="å° Q çš„é›†åˆ"></a>å° Q çš„é›†åˆ</h2><blockquote><p>æ±‚ä» $n$ å…ƒé›†åˆ $\rm S$ ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå­é›† $\rm T$ ã€‚æ±‚ $|\mathrm{Sâˆ’T}|^k âˆ’|\mathrm{T}|^k$ çš„æ–¹å·®ã€‚</p><p>$nâ‰¤10^{10^6},kâ‰¤10$ï¼Œç­”æ¡ˆå¯¹è´¨æ•° $mâ‰¤10^6$ å–æ¨¡ã€‚</p></blockquote><p>å—¯ï¼Œå­¦ä¹ äº†ä¸€ä¸‹æ–¹å·®çš„å®šä¹‰ã€‚è®°è¿™ä¸ªä¸œè¥¿çš„æœŸæœ›æ˜¯ $E(x)$ ï¼Œé‚£ä¹ˆæ–¹å·®å°±æ˜¯ $E([x-E(x)]^2)=E(x^2)-E^2(x)$ã€‚</p><p>å—¯ï¼Œå¾—å‡ºç»“è®ºï¼Œæ¦‚ç‡è®ºè¿™ä¸€å¥—æ˜¯å­¦ä¸æ‡‚çš„ã€‚</p><p>è¯´åšæ³•å§ã€‚æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§ï¼Œå¯ä»¥å¾—åˆ°è¿™ä¸ªä¸œè¥¿çš„æœŸæœ›æ˜¯</p><script type="math/tex; mode=display">E(|\mathrm{Sâˆ’T}|^k âˆ’|\mathrm{T}|^k)= E(|\mathrm{Sâˆ’T}|^k)-E(|\mathrm{T}|^k)</script><p>é‚£ä¹ˆæ˜¾ç„¶è¿™ä¸¤é¡¹æ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥è¿™ä¸ªä¸œè¥¿çš„æœŸæœ›å°±æ˜¯ $0$ ã€‚æ‰€ä»¥å°±åªéœ€è¦æ±‚ $|\mathrm{Sâˆ’T}|^k âˆ’|\mathrm{T}|^k$ çš„å¹³æ–¹çš„æœŸæœ›å°±å¯ä»¥äº†ã€‚é‚£ä¹ˆç­”æ¡ˆä¹Ÿå°±æ˜¯</p><script type="math/tex; mode=display">\frac{\sum\limits_{i=0}^{n}\binom{n}{i}\left(i^{k}-(n-i)^{k}\right)^{2}}{2^n}</script><p>emmmç„¶è€Œå¹¶ä¸å¯ä»¥ç›´æ¥åšã€‚ç„¶åæœ‰ä¸ªå¾ˆç¥ä»™çš„ç‚¹å°±æ˜¯è€ƒè™‘æ‹¿Lucaså®šç†æ¥å±•å¼€ä¸€å±‚å¾—åˆ°ï¼š</p><script type="math/tex; mode=display">\sum_{i=0}^{\lfloor \frac{n}{m}\rfloor}\left(\begin{array}{c}\left\lfloor\frac{n}{m}\right\rfloor \\i\end{array}\right) \sum_{j=0}^{n \bmod m}\left(\begin{array}{c}n \bmod m \\j\end{array}\right)\left(j^{k}-(n-j)^{k}\right)^{2}</script><p>è¿™ä¹ˆåšæ˜¯å¯¹çš„å°±åœ¨äºæ¯ä¸ª $\binom{n}{j}$ éƒ½è¢«åˆ†è§£æˆäº†å”¯ä¸€çš„ $\binom{\lfloor \frac{n}{m}\rfloor}{i}\cdot \binom{n\bmod m}{j}$ ï¼Œé‚£ä¹ˆè¿™ä¸¤éƒ¨åˆ†å°±å¯ä»¥<strong>åˆ†åˆ«ç®—äº†</strong>ã€‚ç¬¬ä¸€éƒ¨åˆ†å¾ˆæ˜¾ç„¶å°±æ˜¯ $2^n$ ï¼Œç¬¬äºŒéƒ¨åˆ†ç›´æ¥åšå°±å¯ä»¥äº†ã€‚</p><p>å—¯ï¼Œè¿™é¢˜çœŸæ˜¯ååˆ†é«˜å¦™ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ•°è®ºæœ‰æ„æ€ï¼</p><p>exLucasæ˜¯ä¸å¯èƒ½å­¦çš„â€¦</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¬æ–¯ç»™æ™®è®²çš„æœ‰è¶£çš„æ•°è®ºé—®é¢˜ï¼Œæ„Ÿè§‰æµ·æ˜Ÿï¼Ÿ&lt;/p&gt;
&lt;p&gt;é¡ºä¾¿åŠ ä¸Šäº†ä¸€ç‚¹è‡ªå·±ä¹‹å‰éšä¾¿æ•´ç†çš„ä¸œè¥¿ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://www.orchidany.cn/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="æ•°å­¦/æ‰©å±•æ¬§å‡ é‡Œå¾·" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%B7/"/>
    
      <category term="æ•°å­¦/æ•°è®º" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E6%95%B0%E8%AE%BA/"/>
    
      <category term="æ•°å­¦/é˜¶ä¸åŸæ ¹" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E9%98%B6%E4%B8%8E%E5%8E%9F%E6%A0%B9/"/>
    
  </entry>
  
</feed>
