<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ğ“ğ“»ğ“¬ğ“±ğ“²ğ“­ğ“ªğ“·ğ”‚&#39;ğ”€ ğ“«ğ“µğ“¸ğ“°</title>
  
  <subtitle>A Soul Tune against Fate Should Be Played, now.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.orchidany.cn/"/>
  <updated>2020-02-08T03:43:10.984Z</updated>
  <id>https://www.orchidany.cn/</id>
  
  <author>
    <name>Orchidany</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>éšæƒ³ Â· ç›®æ¬¡è¡¨</title>
    <link href="https://www.orchidany.cn/2050/12/31/%E9%9A%8F%E6%83%B3%C2%B7%E7%9B%AE%E6%AC%A1%E8%A1%A8/"/>
    <id>https://www.orchidany.cn/2050/12/31/éšæƒ³Â·ç›®æ¬¡è¡¨/</id>
    <published>2050-12-31T14:24:26.000Z</published>
    <updated>2020-02-08T03:43:10.984Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç»ˆäºåˆå¼€å§‹äº†ã€‚</p><a id="more"></a><p>æˆ‘æ˜¯èŠ±ï¼Œä¸€ä¸ªä¸ç†æ™ºçš„$\rm{Oier}$ã€‚æˆ‘ä¹Ÿæƒ³æ¯å¤©24å°æ—¶æ‹¼å‡º48å°æ—¶çš„æ•ˆç‡ä¸€å¿ƒåšé¢˜ï¼Œä½†æ˜¯æˆ‘åšä¸åˆ°ï¼Œæˆ‘è¡€æ¶²ä¸­å‡ç»“ç€çš„ï¼Œåœ¨å‚¬ä¿ƒæˆ‘å†™ä¸‹æ¥ï¼Œå¿…é¡»è¦å†™ä¸‹æ¥ã€‚</p><p>åœ¨è¿™äº›æ–‡ç« é‡Œï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªè¿·èŒ«çš„é’å¹´å¦‚ä½•æ»¡æ€€çƒ­è¡€ä¸ç»æœ›ï¼Œçœ¼é‡Œé—ªçƒç€æ²§æ¡‘ä¸å¸Œæœ›ï¼Œæ€€é‡Œæ£ç€åæ‰çš„ç²®é£Ÿå’Œå´­æ–°çš„è®ºæ–‡ï¼Œè„šä¸‹è¸ç€å´å²–ä¸å¹³çš„è·¯ï¼Œå‘æ˜å¤©èµ°å»ã€‚</p><p>æ˜¯çš„ï¼Œæˆ‘æ˜¯èŠ±ï¼Œæ¥è‡ªå±±ä¸œï¼Œä½ ç›´æ¥å«æˆ‘èŠ±è¿™ä¸ªIDæˆ–è®¸æˆ‘ä¼šå¾ˆé«˜å…´ï¼Œä½†æ˜¯å¦‚æœä½ è®¤è¯†æˆ‘ä¹Ÿå¯ä»¥ä¸è¿™ä¹ˆæ‹˜æŸã€‚</p>        <div id="aplayer-VqsxSNkv" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">            <pre class="aplayer-lrc-content"></pre>        </div>        <script>          var ap = new APlayer({            element: document.getElementById("aplayer-VqsxSNkv"),            narrow: false,            autoplay: false,            showlrc: false,            music: {              title: "èŠ±",              author: "Hello Nico",              url: "Hello Nico-èŠ±.flac",              pic: "/2050/12/31/éšæƒ³Â·ç›®æ¬¡è¡¨/qwq.png",              lrc: ""            }          });          window.aplayers || (window.aplayers = []);          window.aplayers.push(ap);        </script><p>ä»¥ä¸‹æ˜¯ç›®å½•ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:center">ç¯‡ç›®</th><th style="text-align:center">é“¾æ¥ï¼ˆç‚¹å‡»å³å¯ï¼‰</th></tr></thead><tbody><tr><td style="text-align:center">éšæƒ³ä¸€ Â· å±±ä¸˜</td><td style="text-align:center"><a href="https://www.orchidany.cn/2018/08/02/%E9%9A%8F%E6%83%B3%E4%B8%80/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³äºŒ Â· ä¸˜å‰å°”</td><td style="text-align:center"><a href="https://www.orchidany.cn/2018/08/08/%E9%9A%8F%E6%83%B3%E4%BA%8C/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³ä¸‰ Â· æœ¬èµ›å­£æœ€åçš„éšæƒ³/å¯ç¤ºå½•</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/02/14/%E9%9A%8F%E6%83%B3%E4%B8%89%C2%B7NOIP/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³å›› Â· æ•…äºº</td><td style="text-align:center"><a href="[https://www.orchidany.cn/2019/03/01/%E9%9A%8F%E6%83%B3%E5%9B%9B%C2%B7%E6%95%85%E4%BA%BA/](https://www.orchidany.cn/2019/03/01/éšæƒ³å››Â·æ•…äºº/">$Link$</a>)</td></tr><tr><td style="text-align:center">éšæƒ³äº” Â· æ‰‹ä¸­æ²¡æœ‰çº¢ç«ç‘°</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/02/14/%E9%9A%8F%E6%83%B3%E4%BA%94%C2%B7%E6%83%85%E4%BA%BA%E8%8A%82/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³å…­ Â· éš¾</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/03/10/%E9%9A%8F%E6%83%B3%E5%85%AD%C2%B7Hard/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³ä¸ƒ Â· è¨€å¶ä¹‹åº­</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/03/28/%E9%9A%8F%E6%83%B3%E4%B8%83%C2%B7%E8%A8%80%E5%8F%B6%E4%B9%8B%E5%BA%AD/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³å…« Â· é€ƒå§</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/06/11/8/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³ä¹ Â· æ„ä¹‰</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/07/18/Nine/">$Link$</a></td></tr><tr><td style="text-align:center">éšæƒ³å Â· ç¹æ˜Ÿ</td><td style="text-align:center"><a href="https://www.orchidany.cn/2019/08/20/10/">$Link$</a></td></tr></tbody></table></div><p>ç¬¬ä¸€ç¯‡å¤§æ¦‚æ˜¯å¼€å§‹ï¼Ÿ</p><p>ç¬¬äºŒç¯‡å¤§æ¦‚æ˜¯åœ¨è€æ ¡æœºæˆ¿å†™çš„ã€‚å½“æ—¶è‡ªå·±å’Œå‘¨å›´äººçš„å…³ç³»å¹¶ä¸å¥½ã€‚</p><p>ç¬¬ä¸‰ç¯‡å°±æ˜¯2018è€ƒå®ŒNOIPå†™çš„å•¦ã€‚</p><p>ç¬¬å››ç¯‡ç”±äºä¸ªäººååˆ†å–œçˆ±å›å¿†å¾€äº‹ï¼Œæ‰€ä»¥æ˜¯æ¯”è¾ƒé‡è¦çš„ä¸€ç¯‡ï¼Œä½†ç°åœ¨è¿˜æ²¡æœ‰æ›´å®Œã€‚ï¼ˆå› ä¸ºè¦è¯´çš„å¤ªå¤šäº†</p><p>ç¬¬äº”ç¯‡æ˜¯è°ˆæ„Ÿæƒ…çš„å•¦ï¼Œä¼¼ä¹æ˜¯æ¯”è¾ƒå‡ºåçš„ä¸€ç¯‡(?)</p><p>ç¬¬å…­ç¯‡å¤§æ¦‚æ˜¯çå†™çš„ã€‚å¦‚æœæ¯æ¬¡è§‰å¾—å¾ˆéš¾éƒ½è¦å†™ä¸€ç¯‡ï¼Œé‚£ä¼°è®¡åªæœ‰ä¸“èŒä½œå®¶æ‰èƒ½å†™å®Œã€‚</p><p>ç¬¬ä¸ƒç¯‡å¤§æ¦‚æ˜¯çœ‹å®Œã€Šè¨€å¶ä¹‹åº­ã€‹å°±ç«‹å³åœ¨æœºæˆ¿å†™çš„ï¼Œä»£è¡¨çš„å¤§æ¦‚æ˜¯æˆ‘ç†æƒ³ä¸­çˆ±æƒ…çš„æ¨¡æ ·å§ã€‚</p><p>ç¬¬å…«ç¯‡ä¹Ÿå¾ˆé‡è¦ï¼Œæˆ‘çš„å…¨éƒ¨å‹æŠ‘æƒ…ç»ªéƒ½ä¼šå†™è¿›å»ã€‚å½“ç„¶ï¼Œå’Œç¬¬å››ç¯‡ä¸€æ ·ï¼Œè¦è¯´çš„è¯å¤ªå¤šäº†ï¼Œæ‰€ä»¥å†™ä¸å®Œ/kk</p><p>ç¬¬ä¹ç¯‡å¤§æ¦‚æ˜¯ã€Œå¥‡å¼‚äººç”Ÿã€çš„è¯»/è§‚åæ„Ÿï¼Ÿ</p><p>æœ€åä¸€ç¯‡â€¦æ˜¯ç§˜å¯†ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»ˆäºåˆå¼€å§‹äº†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Life" scheme="https://www.orchidany.cn/categories/Life/"/>
    
    
      <category term="éšæƒ³/ä¸‹ä¸‹ç¬”" scheme="https://www.orchidany.cn/tags/%E9%9A%8F%E6%83%B3-%E4%B8%8B%E4%B8%8B%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>ã€å…¬å‘Šã€‘å…³äºè¿™ä¸ªblog</title>
    <link href="https://www.orchidany.cn/2050/02/05/%E3%80%90%E5%85%AC%E5%91%8A%E3%80%91%E5%8D%9A%E5%AE%A2%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    <id>https://www.orchidany.cn/2050/02/05/ã€å…¬å‘Šã€‘åšå®¢ä½¿ç”¨æŒ‡å—/</id>
    <published>2050-02-05T09:51:27.000Z</published>
    <updated>2020-04-29T12:34:46.897Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><a id="more"></a><p><del>æ­å–œä½ æ¥åˆ°äº†æ²¡æœ‰çŸ¥è¯†çš„è’åŸ.</del></p><p>è¿™ç¯‡æ–‡ç« å·²ç»ç§»æ­¥åˆ°ä¾§è¾¹æ çš„ã€Œ<code>Navigation</code>ã€é‡Œå•¦ï¼è¿˜ä¸å»çœ‹çœ‹ï¼Ÿ</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;/assets/css/APlayer.min.css&quot;&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="Life" scheme="https://www.orchidany.cn/categories/Life/"/>
    
    
      <category term="ç¬”å°–ç”ŸèŠ±" scheme="https://www.orchidany.cn/tags/%E7%AC%94%E5%B0%96%E7%94%9F%E8%8A%B1/"/>
    
  </entry>
  
  <entry>
    <title>SDOI2020 æ¸¸è®°</title>
    <link href="https://www.orchidany.cn/2020/06/19/SDOI2020-%E9%80%80%E5%BD%B9%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/06/19/SDOI2020-é€€å½¹è®°/</id>
    <published>2020-06-19T13:33:33.000Z</published>
    <updated>2020-06-19T13:38:45.755Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å…ˆé¸½äº†ã€‚</p><a id="more"></a>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…ˆé¸½äº†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Life" scheme="https://www.orchidany.cn/categories/Life/"/>
    
    
      <category term="éšæƒ³/ä¸‹ä¸‹ç¬”" scheme="https://www.orchidany.cn/tags/%E9%9A%8F%E6%83%B3-%E4%B8%8B%E4%B8%8B%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘å‰ä¸¤å¹´çœé€‰é¢˜é€‰åš</title>
    <link href="https://www.orchidany.cn/2020/06/19/%E5%89%8D%E4%B8%A4%E5%B9%B4%E7%9C%81%E9%80%89%E9%A2%98%E7%9E%8E%E5%81%9A/"/>
    <id>https://www.orchidany.cn/2020/06/19/å‰ä¸¤å¹´çœé€‰é¢˜çåš/</id>
    <published>2020-06-19T12:22:42.000Z</published>
    <updated>2020-06-19T13:30:50.649Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ¥è‡ªä¸€æ¡å’¸é±¼æœ€åçš„æŒ£æ‰ã€‚</p><p>å¤§æ¦‚æ˜¯è¡¥å®Œäº†ä¸€ä¸‹ã€Œä¹çœè”è€ƒ Day1ã€ çš„å…¨éƒ¨ï¼Œã€ŒåäºŒçœè”è€ƒ Day1T3 éª—åˆ†è¿‡æ ·ä¾‹ã€çš„ $75$ åˆ†å’Œã€ŒåäºŒçœè”è€ƒ Day2ã€ çš„ $70+100+36$ åˆ†ã€‚</p><p>æ„Ÿè§‰è‡ªå·±æ‰“å¾—ç¨³ä¸€ç‚¹ï¼Œåˆ†æ•°ä¹Ÿè¿˜å¯ä»¥ã€‚</p><p>å‰©ä¸‹çš„é¢˜å¯èƒ½æ˜¯è¦ç­‰åˆ°å¾ˆä¹…å¾ˆä¹…ä»¥åæ‰èƒ½åšäº†ã€‚</p><a id="more"></a><h1 id="ä¹çœè”è€ƒ-Day1"><a href="#ä¹çœè”è€ƒ-Day1" class="headerlink" title="ä¹çœè”è€ƒ Day1"></a>ä¹çœè”è€ƒ Day1</h1><h2 id="A-ä¸€åŒæœ¨æ£‹"><a href="#A-ä¸€åŒæœ¨æ£‹" class="headerlink" title="A ä¸€åŒæœ¨æ£‹"></a>A ä¸€åŒæœ¨æ£‹</h2><p>å»å¹´å†™è¿‡ä¸€ä¸ª alpha-beta å‰ªæçš„ç‰ˆæœ¬ï¼Œå–œæäº† 70ã€‚ç°åœ¨é€‰æ‹©é‡æ–°å†åšã€‚</p><p>ä¸€å¼€å§‹çš„æ—¶å€™å®Œå…¨æ²¡æœ‰ä»»ä½•æ€è·¯ï¼ŒåªçŸ¥é“ $2^{n\times m}$ å¤§æ¦‚æ˜¯å¯ä»¥æœ€å¤š $50pts$ã€‚ç„¶åæ€è€ƒäº†ä¸€ä¸‹ä¸€å®šæ˜¯çŠ¶æ€æ•°è¿‡å¤šï¼Œä½†æ˜¯æƒ³äº†åŠå¤©ä¹Ÿä¸çŸ¥é“æ€ä¹ˆå‹æˆä¸€ç»´çš„ã€‚ä¹‹åçªç„¶æƒ³åˆ°å¯èƒ½åˆæ³•çš„çŠ¶æ€æ•°å¹¶ä¸å¤šï¼Œç„¶è€Œè‡ªå·±å¹¶ä¸å¤ªä¼šç®—è¿™ä¸ªçŠ¶æ€æ•°ï¼Œäºæ˜¯å°±æ‰“äº†ä¸ªè¡¨å‘ç°ç¡®å®ä¸å¤šï¼Œæé™æ•°æ®åªæœ‰ä¸åˆ° $2\times 10^5$ ã€‚äºæ˜¯å°±æŠŠæ‰€æœ‰çŠ¶æ€éƒ½å­˜åˆ°äº† <code>vector</code> é‡Œã€‚</p><p>ä¹‹åå°±å–œæäº† 30 = =ã€‚åŸå› å¯èƒ½æ˜¯æˆ‘è¿™æ–¹é¢æ¯”è¾ƒè–„å¼±ã€‚å¤§æ¦‚æ˜¯è¯´è™½ç„¶åˆå§‹çŠ¶æ€å’Œç»ˆæ­¢çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€æ­¥å’Œæœ€åä¸€æ­¥çš„çŠ¶æ€(åŒ…æ‹¬ä½ç½®å’Œå…ˆåæ‰‹)éƒ½æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯ä¸èƒ½é¡ºæ¨ï¼Œè¿™æ ·å‡ºæ¥çš„æ˜¯é”™çš„ç»“æœã€‚åŸå› ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œé¡ºæ¨æ˜¯å‡çš„ã€Œç»é¡¶èªæ˜ã€ï¼ŒçœŸæ­£çš„ã€Œç»é¡¶èªæ˜ã€éƒ½ä¼šæ˜¯é€šè¿‡è§‚å¯Ÿå°†æ¥å±€é¢çš„å¯èƒ½ç»“æœå†å»åˆ¤æ–­å¦‚ä½•è¡ŒåŠ¨ã€‚æ‰€ä»¥åº”è¯¥é€†æ¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">11</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Base = <span class="number">233</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1000010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tot ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> cnt[N] ;</span><br><span class="line"><span class="keyword">int</span> A[N][N] ;</span><br><span class="line"><span class="keyword">int</span> B[N][N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="built_in">map</span> &lt;ll, <span class="keyword">int</span>&gt; h ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; s[M] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">get_s</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        ret = (ret * Base + cnt[i]) % P ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mn ;</span><br><span class="line"><span class="keyword">int</span> dep ;</span><br><span class="line"><span class="keyword">int</span> Id[M] ;</span><br><span class="line"><span class="keyword">int</span> rev[M] ;</span><br><span class="line"><span class="keyword">int</span> val[M] ;</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">2</span>][M] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ++ dep ;</span><br><span class="line">    <span class="keyword">if</span> (!h[get_s()])&#123;</span><br><span class="line">        ++ tot ;</span><br><span class="line">        mn = m + <span class="number">1</span> ;</span><br><span class="line">        h[get_s()] = tot ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">            s[tot].push_back(cnt[i]) ;</span><br><span class="line">            mn = min(mn, cnt[i]) ;</span><br><span class="line">            val[tot] += cnt[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (mn == m) <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (cnt[i] &gt;= m || cnt[i] &gt;= cnt[i - <span class="number">1</span>])</span><br><span class="line">            <span class="keyword">continue</span> ; cnt[i] ++ ; dfs() ; cnt[i] -- ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out_put</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; &amp; p, <span class="keyword">bool</span> q = <span class="number">0</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> t : p)&#123;</span><br><span class="line">        <span class="keyword">if</span> (q) <span class="built_in">putchar</span>(<span class="string">'#'</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= t ; ++ j) <span class="built_in">putchar</span>(<span class="string">'1'</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = t + <span class="number">1</span> ; j &lt;= m ; ++ j) <span class="built_in">putchar</span>(<span class="string">'0'</span>) ;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">'\n'</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    puts("- - - - - - - - - - - - -") ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; cnt[<span class="number">0</span>] = m + <span class="number">1</span> ; dfs() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i) Id[i] = i ;</span><br><span class="line">    sort(Id + <span class="number">1</span>, Id + tot + <span class="number">1</span>, [](<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123; <span class="keyword">return</span> val[x] &gt; val[y] ; &#125;) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= tot ; ++ i) rev[Id[i]] = i ;</span><br><span class="line"><span class="comment">//  for (int i = 1 ; i &lt;= tot ; ++ i) out_put(s[i]) ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= m ; ++ j)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;A[i][j]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= m ; ++ j)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;B[i][j]) ;</span><br><span class="line">    <span class="built_in">memset</span>(f[<span class="number">1</span>], <span class="number">63</span>, <span class="keyword">sizeof</span>(f[<span class="number">1</span>])) ;</span><br><span class="line">    <span class="built_in">memset</span>(f[<span class="number">0</span>], <span class="number">-63</span>, <span class="keyword">sizeof</span>(f[<span class="number">0</span>])) ;</span><br><span class="line">    <span class="keyword">if</span> ((n * m) &amp; <span class="number">1</span>)</span><br><span class="line">         f[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">else</span> f[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span> ; <span class="comment">//f[1][1] = 0 ; // 0æ˜¯å…ˆæ‰‹ï¼Œ1æ˜¯åæ‰‹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; tot ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">int</span> x = Id[i], y = <span class="number">0</span>, z, t = <span class="number">0</span>, o ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> p = s[x].begin() ; p != s[x].end() ; ++ p)&#123;</span><br><span class="line">            ++ t ; y = <span class="number">0</span> ; <span class="keyword">int</span> mv = m ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> q = s[x].begin() ; q != s[x].end() ; ++ q)&#123;</span><br><span class="line">                <span class="keyword">int</span> x = *q ; cnt[++ y] = x ;</span><br><span class="line">                <span class="keyword">if</span> (p == q) -- cnt[y], o = cnt[y] ;</span><br><span class="line">                <span class="keyword">if</span> (mv &lt; cnt[y]) <span class="keyword">goto</span> cccc ; mv = min(cnt[y], mv) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( !( z = h[get_s()] ) ) <span class="keyword">continue</span> ;</span><br><span class="line">            <span class="keyword">if</span> (f[<span class="number">0</span>][i] &lt; P) f[<span class="number">1</span>][rev[z]] = min(f[<span class="number">1</span>][rev[z]], f[<span class="number">0</span>][i] - B[t][o + <span class="number">1</span>]) ;</span><br><span class="line">            <span class="keyword">if</span> (f[<span class="number">1</span>][i] &lt; P) f[<span class="number">0</span>][rev[z]] = max(f[<span class="number">0</span>][rev[z]], f[<span class="number">1</span>][i] + A[t][o + <span class="number">1</span>]) ;</span><br><span class="line">            cccc : <span class="keyword">continue</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; tot &lt;&lt; '\n' ;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, f[<span class="number">0</span>][tot]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­£è§£ä¼¼ä¹æ˜¯è½®å»“çº¿ä»€ä¹ˆçš„= =ã€‚</p><h2 id="B-IIIDX"><a href="#B-IIIDX" class="headerlink" title="B IIIDX"></a>B IIIDX</h2><p>å¤§æ¦‚æ˜¯å…ˆæ‰“äº† $30pts$ çš„æš´åŠ›ã€‚ä¹‹åè«åå…¶å¦™åœ°æŠŠè¿™ä¸ªå›¾å»ºæˆäº†ä¸€ä¸ª DAG å¯¼è‡´ä¸å¯åšã€‚ç„¶åæˆ‘å°±è§‰å¾—ä¼¼ä¹æ˜¯åªæœ‰å¦å¤– $15pts$ çš„äºŒå‰æ ‘å’Œæ ‘æœ‰å…³ï¼Œæ¨äº†ä¸€ä¸‹ï¼Œå¤§æ¦‚æ˜¯æœ€å¤§åŒ–è¿™æ£µæ ‘çš„ BFS åºçš„ $val$ åºåˆ—çš„å­—å…¸åºâ€¦æ„Ÿè§‰å¹¶ä¸æ˜¯å¾ˆå¯åšã€‚ç„¶åå°±è·‘è·¯äº†ã€‚</p><p>ç„¶åå‘ç°æ˜¯ä¸ªååˆ†ç¥å¥‡çš„è´ªå¿ƒ+æ‰¾æ€§è´¨â€¦</p><p>å¤§æ¦‚æ˜¯è¯´å…ˆè€ƒè™‘ $d_i$ éƒ½ä¸ç›¸åŒçš„æƒ…å†µã€‚æ­¤æ—¶ç”±äºè¿™æ£µæ ‘æ»¡è¶³å †æ€§è´¨ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€ä¸ªè´ªå¿ƒï¼Œå°±æ˜¯ä¸€æ£µå­æ ‘å†…çš„æƒå€¼å¿…ç„¶åœ¨åŸåºåˆ—é‡Œé¢æ˜¯è¿ç»­çš„ï¼Œè¿™ä¸€ç‚¹ä¸éš¾è¯æ˜ï¼Œå› ä¸ºå¦‚æœè¦åœ¨æ»¡è¶³å †æ€§è´¨çš„å‰æä¸‹ä½¿å¾— BFS åºæœ€å¤§ï¼Œè¿ç»­æ˜¯æœ€å¥½çš„æ–¹æ¡ˆã€‚äºæ˜¯å°±å¯ä»¥ä»¥ $0$ ä¸ºæ ¹å»ºä¸ªæ ‘ï¼Œç„¶åæŠŠæ‰€æœ‰çš„æ•°ä»å°åˆ°å¤§æ’åºæ¥åšã€‚</p><p>ç„¶åè€ƒè™‘å¦‚æœå­˜åœ¨ $d_i$ ç›¸åŒï¼Œé‚£ä¹ˆè¿™ä¹ˆè´ªå¿ƒå°±ä¼šæœ‰é—®é¢˜ã€‚è€ƒè™‘æ­¤æ—¶çš„çˆ¶å­å…³ç³»å¯ä»¥å­˜åœ¨ $d_x=d_{fa_x}$ ï¼Œæ‰€ä»¥æœ‰æ—¶å€™å¯ä»¥æŠŠä¸€ä¸ªæ›´å¤§çš„æ•°ç§»åˆ°å¦ä¸€ä¸ªå’Œ $x$ æ·±åº¦ç›¸åŒä½†ç¼–å·é åçš„ä½ç½®ä¸Šã€‚ä½†è€ƒè™‘è´ªå¿ƒçš„æœ¬è´¨è¿˜æ˜¯ä¸å˜çš„ã€‚å³è€ƒè™‘æå‰è®¡ç®—è´¡çŒ®ï¼Œè€ƒè™‘å¯¹äºä¸€ä¸ª $x$ ï¼Œå¦‚æœä»–æƒ³é€‰çš„è¯ï¼Œè‡³å°‘è¦ç•™å‡º $size_x-1$ ä¸ªä½ç½®æ¥ç»™å®ƒçš„å­æ ‘ã€‚</p><p>è€ƒè™‘ç”¨çº¿æ®µæ ‘ç»´æŠ¤è¿™ä¸ªè¿‡ç¨‹ã€‚å…ˆå¯¹æ‰€æœ‰æ•°æ’ä¸ªåºï¼Œè€ƒè™‘ç”¨æ¯ä¸ªæ•°å»å¡«æ»¡ $1\sim n$ è¿™äº›ä½ç½®ã€‚çº¿æ®µæ ‘ä¸Šç»´æŠ¤ $seg_x$ è¡¨ç¤ºåŒºé—´å†… $v_i$ çš„æœ€å°å€¼ï¼Œå…¶ä¸­ $v_i$ æ˜¯ä½ç½® $i$ å·¦è¾¹è¿˜å¯ä»¥æ”¾çš„ä½ç½®ä¸ªæ•°ã€‚é‚£ä¹ˆæ¯æ¬¡å¯ä»¥çº¿æ®µæ ‘ä¸ŠäºŒåˆ†å‡ºæœ€é å·¦çš„åˆæ³•ä½ç½®ã€‚ç„¶åå°±æ˜¯ä¸€ä¸ªåç¼€åŠ æ“ä½œã€‚</p><p>æ³¨æ„æœ‰ä¸¤ä¸ªç»†èŠ‚ï¼š</p><p>1ã€äºŒåˆ†æ—¶å€™çš„è¾¹ç•Œé—®é¢˜ã€‚äºŒåˆ†å®Œäº†éœ€è¦åˆ¤ä¸€ä¸‹æ˜¯å¦åˆæ³•ã€‚</p><p>2ã€å¦‚æœå¤šä¸ªæ•°ç›¸åŒï¼Œé‚£ä¹ˆä¸ºäº†ä¿è¯é¡ºåºå›ºå®šï¼Œè€ƒè™‘æ¯æ¬¡é€‰åœ¨åŸåºåˆ—é‡Œé¢æœ€é å³çš„é‚£ä¸ªä½ç½®å°±å¥½äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500050</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">double</span> k ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> h, t ;</span><br><span class="line"><span class="keyword">int</span> q[N] ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">int</span> sz[N] ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> tmp[N] ;</span><br><span class="line"><span class="keyword">int</span> cnt[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; E[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">check_ans</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (ans[i] &gt; base[tmp[i]]) <span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ans[i] &lt; base[tmp[i]]) <span class="keyword">goto</span> ccc ;</span><br><span class="line">    ccc :</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        ans[i] = base[tmp[i]] ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> base[a] &lt; base[b] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    sz[x] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])</span><br><span class="line">        sz[x] += dfs(y) ;</span><br><span class="line">    <span class="keyword">return</span> sz[x] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">    sort(base + <span class="number">1</span>, base + n + <span class="number">1</span>, [](<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123; <span class="keyword">return</span> x &gt; y ; &#125;) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="keyword">if</span> (base[i] == base[i - <span class="number">1</span>]) <span class="keyword">return</span> <span class="number">0</span> ; <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    ans[x] = base[r --] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])</span><br><span class="line">        solve(l, l + sz[y] - <span class="number">1</span>, y), l += sz[y] ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tag[N * <span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">int</span> seg[N * <span class="number">3</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (rt &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc (rt &lt;&lt; 1 | 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _up(<span class="keyword">int</span> rt)&#123;</span><br><span class="line">    seg[rt] = seg[lc] &gt; seg[rc] ? seg[rc] : seg[lc] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _down(<span class="keyword">int</span> rt)&#123;</span><br><span class="line">    <span class="keyword">if</span> (tag[rt])&#123;</span><br><span class="line">        seg[lc] += tag[rt] ;</span><br><span class="line">        seg[rc] += tag[rt] ;</span><br><span class="line">        tag[lc] += tag[rt] ;</span><br><span class="line">        tag[rc] += tag[rt] ;</span><br><span class="line">        tag[rt] = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>(seg[rt] = r) ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    build (lc, l, mid) ;</span><br><span class="line">    build (rc, mid + <span class="number">1</span>, r) ; _up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= l &amp;&amp; r &lt;= ur)</span><br><span class="line">        <span class="keyword">return</span> seg[rt] += v, <span class="keyword">void</span>(tag[rt] += v) ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt) ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) upd(lc, l, mid, ul, ur, v) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid) upd(rc, mid + <span class="number">1</span>, r, ul, ur, v) ;</span><br><span class="line">    _up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qry</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l + (seg[rt] &lt; v) ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt) ; </span><br><span class="line">    <span class="keyword">if</span> (seg[rc] &gt;= v)</span><br><span class="line">         <span class="keyword">return</span> qry(lc, l, mid, v) ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> qry(rc, mid + <span class="number">1</span>, r, v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) tmp[i] = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), fa[i] = <span class="built_in">floor</span>(<span class="number">1.0</span> * i / k) ;</span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= n ; ++ i) printf("%d\n", fa[i]) ;</span></span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">10</span>)&#123;</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line"><span class="comment">//            for (int i = 1 ; i &lt;= n ; ++ i)</span></span><br><span class="line"><span class="comment">//                cout &lt;&lt; base[tmp[i]] &lt;&lt; ' ' ; //puts("") ;</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                <span class="keyword">if</span> (base[tmp[fa[i]]] &gt; base[tmp[i]]) <span class="keyword">goto</span> cccc ;</span><br><span class="line">            check_ans() ; <span class="comment">//cout &lt;&lt; 233 &lt;&lt; '\n' ;</span></span><br><span class="line">            cccc : <span class="keyword">continue</span> ;</span><br><span class="line">        &#125;<span class="keyword">while</span> (next_permutation(tmp + <span class="number">1</span>, tmp + n + <span class="number">1</span>)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (check())&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) E[fa[i]].push_back(i) ;</span><br><span class="line">        dfs(<span class="number">0</span>) ; solve(<span class="number">1</span>, n + <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//cout &lt;&lt; 233 &lt;&lt; '\n' ;         </span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) E[fa[i]].push_back(i) ;</span><br><span class="line">       dfs(<span class="number">0</span>) ; build(<span class="number">1</span>, <span class="number">1</span>, n) ; <span class="keyword">int</span> x, y, z ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span> ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">            <span class="keyword">if</span> (base[i] == base[i + <span class="number">1</span>])</span><br><span class="line">                cnt[i] = cnt[i + <span class="number">1</span>] + <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">            j = fa[i] ;</span><br><span class="line">            <span class="keyword">if</span> (j &amp;&amp; !vis[j])</span><br><span class="line">                vis[j] = <span class="number">1</span>, upd(<span class="number">1</span>, <span class="number">1</span>, n, ans[j], n, sz[j] - <span class="number">1</span>) ;</span><br><span class="line">            y = x = qry(<span class="number">1</span>, <span class="number">1</span>, n, sz[i]) ;</span><br><span class="line">            x += cnt[y] ; z = x ;</span><br><span class="line">            z -= cnt[x] ++ ;</span><br><span class="line">            ans[i] = z ;</span><br><span class="line">            upd(<span class="number">1</span>, <span class="number">1</span>, n, z, n, - sz[i]) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) ans[i] = base[ans[i]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="string">" "</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="C-ç§˜å¯†è¢­å‡»"><a href="#C-ç§˜å¯†è¢­å‡»" class="headerlink" title="C ç§˜å¯†è¢­å‡»"></a>C ç§˜å¯†è¢­å‡»</h2><p>æ¯’ç˜¤ DPâ€¦</p><p>ä¸€å¼€å§‹æƒ³çš„æ˜¯è¦æšä¸¾æ¯ä¸ªç‚¹è®¡ç®—è´¡çŒ®ï¼Œåæ¥å†™äº†åŠå¤©ä¸€ç›´æŒ‚â€¦ä¹Ÿä¸æ°‘ç™½ä¸ºå•¥ã€‚</p><p>ä¸è¿‡å­¦äº†ä¸€æ³¢ï¼Œè§‰å¾—å¯èƒ½è¿˜æ˜¯æšä¸¾æ¯ä¸ªæƒå€¼æ¥ DP æ›´æœ‰é“ç†ã€‚è€ƒè™‘å¯¹äºä¸€ä¸ªæƒå€¼ $w$ ï¼Œé—®é¢˜å˜æˆäº†æœ‰å¤šå°‘ç§é€‰æ‹©çš„æ–¹å¼ä½¿å¾—è¿é€šå—å†…å¤§äºç­‰äº $w$ çš„æƒå€¼æœ‰ $k$ ä¸ªã€‚è®¾ $f_{x,v}$ è¡¨ç¤ºåœ¨ç‚¹ $x$ çš„å­æ ‘å†…é€‰æ‹©ä¸€ä¸ªè¿é€šå—ï¼Œå¤§äºç­‰äº $w$ çš„æƒå€¼æœ‰ $v$ ä¸ªçš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»å°±æ˜¯æ¯”è¾ƒå¹³å¸¸çš„èƒŒåŒ…è½¬ç§»ã€‚ç„¶åç”¨ä¸€ç‚¹ä¸Šä¸‹ç•Œä¼˜åŒ–å¯ä»¥æŠŠå¤æ‚åº¦ä¼˜åŒ–åˆ° $O(n^2w)$ ã€‚</p><p>ç„¶åå¤§æ¦‚æ˜¯éœ€è¦ä¸€äº›æŠ€å·§æ‰èƒ½é€šè¿‡æ­¤é¢˜ã€‚éƒ½åœ¨ä»£ç é‡Œäº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_b push_back</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> ui ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">64123</span> ;</span><br><span class="line"></span><br><span class="line">ui ans ;</span><br><span class="line"><span class="keyword">int</span> num ;</span><br><span class="line"><span class="keyword">int</span> sz[N] ;</span><br><span class="line"><span class="keyword">int</span> cnt[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> n, k, m ;</span><br><span class="line"></span><br><span class="line">ui g[N] ;</span><br><span class="line">ui f[N][M] ; <span class="comment">// i is root, \leq j is k</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; E[N] ;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">void do_up(int x, int fa)&#123;</span></span><br><span class="line"><span class="comment">    sz[x] = 1 ;</span></span><br><span class="line"><span class="comment">    for (int i = 1 ; i &lt;= m ; ++ i)</span></span><br><span class="line"><span class="comment">        f[x][i][1] = (i &lt;= base[x]), f[x][i][0] = 1 ;</span></span><br><span class="line"><span class="comment">    for (auto y : E[x])&#123;</span></span><br><span class="line"><span class="comment">        if (y == fa) continue ;</span></span><br><span class="line"><span class="comment">        do_up(y, x) ; sz[x] += sz[y] ;</span></span><br><span class="line"><span class="comment">        memset(g, 0, sizeof(g)) ;</span></span><br><span class="line"><span class="comment">        for (int i = 1 ; i &lt;= base[x] ; ++ i)</span></span><br><span class="line"><span class="comment">            for (int j = 1 ; j &lt;= sz[x] ; ++ j)</span></span><br><span class="line"><span class="comment">                for (int k = 0 ; k &lt;= sz[y] ; ++ k)</span></span><br><span class="line"><span class="comment">                    (g[i][j + k + 1] += f[x][i][j] * f[y][i][k] % P) %= P ;</span></span><br><span class="line"><span class="comment">        for (int i = base[x] + 1 ; i &lt;= m ; ++ i)</span></span><br><span class="line"><span class="comment">            for (int j = 1 ; j &lt;= sz[x] ; ++ j)</span></span><br><span class="line"><span class="comment">                for (int k = 0 ; k &lt;= sz[y] ; ++ k)</span></span><br><span class="line"><span class="comment">                    (g[i][j + k] += f[x][i][j] * f[y][i][k] % P) %= P ;</span></span><br><span class="line"><span class="comment">        for (int i = 1 ; i &lt;= m ; ++ i)</span></span><br><span class="line"><span class="comment">            for (int j = 1 ; j &lt;= sz[x] ; ++ j)</span></span><br><span class="line"><span class="comment">                f[x][i][j] = g[i][j], g[i][j] = 0 ;</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        printf("###%d###\n", y) ;</span></span><br><span class="line"><span class="comment">        for (int i = 1 ; i &lt;= m ; ++ i)</span></span><br><span class="line"><span class="comment">            for (int j = 0 ; j &lt;= sz[x] ; ++ j)</span></span><br><span class="line"><span class="comment">                printf("%d %d %d %u\n", x, i, j, f[x][i][j]) ;</span></span><br><span class="line"><span class="comment">        puts("o o o o o o o o o o o o") ;</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    puts("- - - - - - - - - - - - - - -") ;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    sz[x] = cnt[x] ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= k ; ++ i) </span><br><span class="line">f[x][i] = <span class="number">0</span> ; f[x][cnt[x]] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (y == fa)</span><br><span class="line">            <span class="keyword">continue</span> ; solve(y, x) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= sz[x] ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= sz[y] ; ++ j)</span><br><span class="line">                (g[min(i + j, k)] += f[x][i] * f[y][j] % P) %= P ;</span><br><span class="line">        sz[x] += sz[y] ; sz[x] = min(sz[x], k) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= sz[x] ; ++ i) </span><br><span class="line">(f[x][i] += g[i]) %= P, g[i] = <span class="number">0</span> ; </span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    printf("%d- - - - - - - - - - - - - -\n", x) ;</span></span><br><span class="line"><span class="comment">//    for (int i = 0 ; i &lt;= k ; ++ i)</span></span><br><span class="line"><span class="comment">//        cout &lt;&lt; f[x][i] &lt;&lt; " " ; puts("") ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x, y ; <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k &gt;&gt; m ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y), E[x].p_b(y), E[y].p_b(x) ;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    for (int root = 1 ; root &lt;= n ; ++ root)&#123;</span></span><br><span class="line"><span class="comment">        memset(f, 0, sizeof(f)) ; do_up(root, 0) ;</span></span><br><span class="line"><span class="comment">        cout &lt;&lt; root &lt;&lt; " " &lt;&lt; f[root][base[root]][k] &lt;&lt; '\n' ;</span></span><br><span class="line"><span class="comment">        (ans += base[root] * f[root][base[root]][k] % P) %= P ;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">1</span> ; v &lt;= m ; ++ v)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (base[i] &gt;= v) ++ num, cnt[i] = <span class="number">1</span> ; <span class="keyword">else</span> cnt[i] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">if</span> (num &lt; k) <span class="keyword">break</span> ; solve(<span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) (ans += f[i][k]) %= P ; num = <span class="number">0</span> ; </span><br><span class="line"><span class="comment">//        puts("") ; puts("") ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="åäºŒçœè”è€ƒ-Day2"><a href="#åäºŒçœè”è€ƒ-Day2" class="headerlink" title="åäºŒçœè”è€ƒ Day2"></a>åäºŒçœè”è€ƒ Day2</h1><h2 id="A-çš®é…-70-åˆ†"><a href="#A-çš®é…-70-åˆ†" class="headerlink" title="A çš®é…(70 åˆ†)"></a>A çš®é…(70 åˆ†)</h2><p>$50$ åˆ†å¤§æ¦‚æ˜¯ $O(nM^2)$ çš„ DPã€‚ç„¶è€Œä¸€å¼€å§‹è‡ªå·±æƒ³çš„æ˜¯ $O(nM^3)$ çš„ï¼Œå†™ç€å†™ç€çªç„¶å‘ç° $c_0,c_1$ åªç”¨è®°ä¸€ä¸ªï¼Œ$d_0,d_1$ åªç”¨è®°ä¸€ä¸ªï¼Œç„¶åç›¸åŒé¢œè‰²çš„æ”¾åœ¨ä¸€èµ·åšèƒŒåŒ…å°±å¥½äº†ã€‚</p><p>$70$ åˆ†æ¯”è¾ƒç¥ä»™ï¼Œ$k=0$ ã€‚å­¦ä¹ äº†ä¸€æ³¢ã€‚å‘ç°æ­¤æ—¶ç›¸å½“äºç»™æ¯ä¸ªåŸå¸‚åˆ†é…ä¸€ä¸ªé˜µè¥ï¼Œç»™æ¯ä¸ªå­¦æ ¡åˆ†é…ä¸€ä¸ªæ´¾ç³»ï¼Œä¸”<strong>ä¸¤è€…æ— å…³</strong>ã€‚äºæ˜¯å°±å¯ä»¥åˆ†åˆ« dpã€‚è®¾ $f_{i,j}$ è¡¨ç¤ºå‰ $i$ ä¸ªå­¦æ ¡ï¼Œæœ‰ $j$ ä¸ªé€‰æ‰‹é€‰äº†é¸­æ´¾ç³»çš„æ–¹æ¡ˆæ•°ï¼›åŒç†è®¾ $g_{i,j}$ è¡¨ç¤ºå‰ $i$ ä¸ªåŸå¸‚ï¼Œæœ‰ $j$ ä¸ªåŸå¸‚é€‰äº†çº¢é˜µè¥çš„æ–¹æ¡ˆæ•°ã€‚è¿™å°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ™®é€šçš„èƒŒåŒ…è½¬ç§»ã€‚æœ€åç­”æ¡ˆå°±æ˜¯</p><script type="math/tex; mode=display">\left(\sum_{i=s-c_{1}}^{c_{0}} f_{n,i}\right) \times \left(\sum_{j=s-d_{1}}^{d_{0}}  g_{m,j}\right)</script><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr first</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1050</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2505</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(T x, <span class="keyword">char</span> c = <span class="string">'\n'</span>)</span></span>&#123; <span class="built_in">cerr</span> &lt;&lt; x &lt;&lt; c ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(T *<span class="keyword">const</span> tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> v = <span class="string">' '</span>, <span class="keyword">char</span> c = <span class="string">'\n'</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i) debug(tp[i], v) ;  <span class="built_in">cerr</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> T, d ;</span><br><span class="line"><span class="keyword">int</span> id[N] ;</span><br><span class="line"><span class="keyword">int</span> nl[N] ;</span><br><span class="line"><span class="keyword">int</span> sum[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, k ;</span><br><span class="line"><span class="keyword">int</span> c_0, c_1 ; <span class="comment">//0,1 2,3</span></span><br><span class="line"><span class="keyword">int</span> d_0, d_1 ; <span class="comment">//0,2 1,3</span></span><br><span class="line"><span class="comment">//d_1 = c_0 - d_0 + c_1 = sum - d_0</span></span><br><span class="line"><span class="keyword">int</span> f[<span class="number">2</span>][M][M] ;</span><br><span class="line"><span class="keyword">int</span> g[<span class="number">2</span>][M][M] ;</span><br><span class="line"><span class="built_in">map</span> &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ncol[N] ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">person</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id ;</span><br><span class="line">    <span class="keyword">int</span> col ;</span><br><span class="line">    <span class="keyword">int</span> val ;</span><br><span class="line">&#125; ;</span><br><span class="line">person tmp[N] ;</span><br><span class="line">person base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(T &amp;x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x += y ; x = x &gt;= mod ? x - mod : x ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">const</span> person &amp; a, <span class="keyword">const</span> person &amp; b)</span></span>&#123; <span class="keyword">return</span> a.col &lt; b.col ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">(<span class="keyword">int</span> t[<span class="number">2</span>][M][M])</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= c_0 ; ++ i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= d_0 ; ++ j)</span><br><span class="line">t[d][i][j] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_dp</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s, v, k, np, nq ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i, d ^= <span class="number">1</span>)&#123;</span><br><span class="line">        s = sum[i] ;</span><br><span class="line">        k = base[i].id ;</span><br><span class="line">        v = base[i].val ;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; i &lt;&lt; " " &lt;&lt; d &lt;&lt; '\n' ;</span></span><br><span class="line"><span class="keyword">if</span> (!c) clear(f) ; <span class="keyword">else</span> clear(g) ; </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p = c_0 ; p &gt;= <span class="number">0</span> ; -- p)&#123;</span><br><span class="line">            np = s - p ; <span class="keyword">if</span> (np &gt; c_1) <span class="keyword">break</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> q = d_0 ; q &gt;= <span class="number">0</span> ; -- q)&#123;</span><br><span class="line">                nq = s - q ; <span class="keyword">if</span> (nq &gt; d_1) <span class="keyword">break</span> ;</span><br><span class="line">                <span class="keyword">if</span> (c == <span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (nl[k] != <span class="number">0</span> &amp;&amp; p &gt;= v &amp;&amp; q &gt;= v)</span><br><span class="line">                        add(f[d][p][q], f[d ^ <span class="number">1</span>][p - v][q - v]) ;</span><br><span class="line">                    <span class="keyword">if</span> (nl[k] != <span class="number">1</span> &amp;&amp; nq &gt;= v &amp;&amp; p &gt;= v)</span><br><span class="line">                        add(f[d][p][q], f[d ^ <span class="number">1</span>][p - v][q]) ;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (c == <span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (nl[k] != <span class="number">2</span> &amp;&amp; np &gt;= v &amp;&amp; q &gt;= v)</span><br><span class="line">                        add(g[d][p][q], g[d ^ <span class="number">1</span>][p][q - v]) ;</span><br><span class="line">                    <span class="keyword">if</span> (nl[k] != <span class="number">3</span> &amp;&amp; np &gt;= v &amp;&amp; nq &gt;= v)</span><br><span class="line">                        add(g[d][p][q], g[d ^ <span class="number">1</span>][p][q]) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fs[M] ;</span><br><span class="line"><span class="keyword">int</span> gs[M] ;</span><br><span class="line"><span class="keyword">int</span> scol[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve0</span><span class="params">(<span class="keyword">int</span> o, <span class="keyword">int</span> oo)</span></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(fs, <span class="number">0</span>, <span class="keyword">sizeof</span>(fs)) ;</span><br><span class="line"><span class="built_in">memset</span>(gs, <span class="number">0</span>, <span class="keyword">sizeof</span>(gs)) ;</span><br><span class="line">    fs[<span class="number">0</span>] = gs[<span class="number">0</span>] = <span class="number">1</span> ; ans = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= oo ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = c_0 ; j &gt;= scol[i] ; -- j)</span><br><span class="line">            <span class="keyword">if</span> (scol[i]) add(fs[j], fs[j - scol[i]]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= o ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = d_0 ; j &gt;= base[i].val ; -- j)</span><br><span class="line">            add(gs[j], gs[j - base[i].val]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = max(sum[o] - c_1, <span class="number">0</span>) ; i &lt;= c_0 ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = max(sum[o] - d_1, <span class="number">0</span>) ; j &lt;= d_0 ; ++ j)</span><br><span class="line">            add(ans, <span class="number">1l</span>l * fs[i] * gs[j] % P) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f)) ;</span><br><span class="line">        <span class="built_in">memset</span>(g, <span class="number">0</span>, <span class="keyword">sizeof</span>(g)) ;</span><br><span class="line">        <span class="built_in">memset</span>(nl, <span class="number">-1</span>, <span class="keyword">sizeof</span>(nl)) ;</span><br><span class="line">        <span class="built_in">memset</span>(scol, <span class="number">0</span>, <span class="keyword">sizeof</span>(scol)) ;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m) ; <span class="keyword">int</span> x, z ;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;c_0, &amp;c_1, &amp;d_0, &amp;d_1) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            ncol[i].clear(), base[i].id = i ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;base[i].col, &amp;base[i].val) ;</span><br><span class="line">        <span class="built_in">memcpy</span>(tmp, base, <span class="keyword">sizeof</span>(base)) ;</span><br><span class="line">        sort(base + <span class="number">1</span>, base + n + <span class="number">1</span>, comp) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">            scol[base[i].col] += base[i].val ;</span><br><span class="line">            sum[i] = sum[i - <span class="number">1</span>] + base[i].val ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; k ; d = <span class="number">1</span> ; <span class="keyword">int</span> td ;</span><br><span class="line">        g[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">if</span> (k == <span class="number">0</span>)&#123; solve0(n, m) ; <span class="keyword">continue</span> ; &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; x, <span class="built_in">cin</span> &gt;&gt; nl[x], ncol[tmp[x].col][nl[x]] ++ ;</span><br><span class="line"><span class="comment">//        debug(nl, 1, n) ; debug(sum, 1, n) ;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r, c ; l &lt;= n ; l = r + <span class="number">1</span>)&#123;</span><br><span class="line">            r = l ; c = base[l].col ;</span><br><span class="line">            <span class="keyword">while</span> (base[r + <span class="number">1</span>].col == c) ++ r ;</span><br><span class="line">            td = d ; do_dp(l, r, <span class="number">1</span>) ;</span><br><span class="line">            d = td ; do_dp(l, r, <span class="number">0</span>) ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= c_0 ; ++ i)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= d_0 ; ++ j)&#123;</span><br><span class="line">                    add(f[r &amp; <span class="number">1</span>][i][j], g[r &amp; <span class="number">1</span>][i][j]) ;</span><br><span class="line">                    g[r &amp; <span class="number">1</span>][i][j] = f[r &amp; <span class="number">1</span>][i][j] ;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= c_0 ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= d_0 ; ++ j)</span><br><span class="line">                add(ans, f[n &amp; <span class="number">1</span>][i][j]) ; <span class="comment">//, cout &lt;&lt; f[n &amp; 1][i][j] &lt;&lt; '\n' ;</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="B-æ˜¥èŠ‚åäºŒå“"><a href="#B-æ˜¥èŠ‚åäºŒå“" class="headerlink" title="B æ˜¥èŠ‚åäºŒå“"></a>B æ˜¥èŠ‚åäºŒå“</h2><p>æš´åŠ›æ¯”è¾ƒå¥½æƒ³ã€‚å¤§å®¶éƒ½è¯´ä¸æ˜¯å¾ˆå®¹æ˜“è¯æ˜â€¦æˆ‘è¿˜çœŸæ²¡å‘ç°(x</p><p>å¤§æ¦‚é€šè¿‡é“¾çš„éƒ¨åˆ†åˆ†ï¼Œå¾ˆå®¹æ˜“å‘ç°åˆå¹¶ä¸¤æ¡é“¾çš„æ—¶å€™åº”è¯¥å¤§æ‰¾å¤§ï¼Œå°æ‰¾å°ã€‚ç„¶åæˆ‘æ˜¯ç›´æ¥æŠŠæ‰€æœ‰é“¾éƒ½æ‰¾äº†å‡ºæ¥ï¼Œæ’äº†ä¸ªåºç„¶åæ‹¿äº†ä¸ª <code>set</code> ç»´æŠ¤ã€‚ç„¶åè¯•å›¾åœ¨æ ‘ä¸Šç”¨ç¥å¿…çš„æ–¹å¼å¿½ç•¥ç›¸åŒçš„ä¿¡æ¯å‘ç°å¤±è´¥â€¦</p><p>ä¹‹åçŸ¥é“äº†æ­£ç¡®åšæ³•è§‰å¾—æŒº rzã€‚å¤§æ¦‚å°±æ˜¯æŠŠæˆ‘é‚£ä¸ªè¿‡ç¨‹æ¢æˆå¯¹ <code>set</code> çš„å¯å‘å¼åˆå¹¶å°±å¥½äº†ã€‚æƒ³äº†æƒ³æ„Ÿè§‰ååˆ†æœ‰é“ç†ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-75pts-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//75åˆ†</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> mxd ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">int</span> deg[N] ;</span><br><span class="line"><span class="keyword">int</span> val[N] ;</span><br><span class="line"><span class="keyword">int</span> tmp[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line"><span class="keyword">int</span> stk[N], tp ;</span><br><span class="line"><span class="built_in">multiset</span> &lt;<span class="keyword">int</span>&gt; s ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; E[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; L[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; zscv ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> _tree&#123;</span><br><span class="line">    <span class="keyword">int</span> sum ;</span><br><span class="line">    <span class="keyword">int</span> sz[N] ;</span><br><span class="line">    <span class="keyword">int</span> dep[N] ;</span><br><span class="line">    <span class="keyword">int</span> dfn[N] ;</span><br><span class="line">    <span class="keyword">int</span> son[N] ;</span><br><span class="line">    <span class="keyword">int</span> top[N] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> da)</span></span>&#123;</span><br><span class="line">        dep[x] = dep[da] + <span class="number">1</span>, sz[x] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">            <span class="keyword">if</span> (y == da) <span class="keyword">continue</span> ;</span><br><span class="line">            dfs1(y, x) ; sz[x] += sz[y] ;</span><br><span class="line">            <span class="keyword">if</span> (sz[y] &gt; sz[son[x]]) son[x] = y ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> tp)</span></span>&#123;</span><br><span class="line">        top[x] = tp ;</span><br><span class="line">        dfn[x] = ++ cnt ;</span><br><span class="line">        <span class="keyword">if</span> (son[x])</span><br><span class="line">            dfs2(son[x], tp) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])</span><br><span class="line">            <span class="keyword">if</span> (y != fa[x] &amp;&amp; y != son[x]) dfs2(y, y) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!y) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (top[x] != top[y])&#123;</span><br><span class="line">            <span class="keyword">if</span> (dep[top[x]] &lt; dep[top[y]])</span><br><span class="line">                <span class="built_in">std</span> :: swap(x, y) ; x = fa[top[x]] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (dep[x] &gt; dep[y])</span><br><span class="line">            <span class="built_in">std</span> :: swap(x, y) ; <span class="keyword">return</span> x ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> _tree ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs_l</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    tmp[++ cnt] = base[x] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x]) dfs_l(y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    stk[++ tp] = x ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x]) solve(y) ;</span><br><span class="line">    <span class="keyword">if</span> (deg[x] &lt;= <span class="number">1</span> &amp;&amp; x &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> t = tp ;</span><br><span class="line">        <span class="keyword">while</span> (stk[t]) L[x].push_back(stk[t --]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    stk[tp --] = <span class="number">0</span> ; mxd = max(mxd, dep[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123; <span class="keyword">return</span> a &gt; b ; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;fa[i]), E[fa[i]].push_back(i) ;</span><br><span class="line"><span class="comment">//        printf("%d %d\n", fa[i], i) ;</span></span><br><span class="line">        deg[i] ++, deg[fa[i]] ++, mxd = max(mxd, max(deg[fa[i]], deg[i])) ;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">0</span>) ; dfs2(<span class="number">1</span>, <span class="number">1</span>) ; cnt = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (mxd &lt;= <span class="number">0</span>)&#123;</span><br><span class="line">        dfs_l(E[<span class="number">1</span>][<span class="number">0</span>]) ;</span><br><span class="line">        <span class="built_in">memcpy</span>(val, tmp, <span class="keyword">sizeof</span>(tmp)) ;</span><br><span class="line">        <span class="built_in">memset</span>(tmp, <span class="number">0</span>, <span class="keyword">sizeof</span>(tmp)) ;</span><br><span class="line">        <span class="keyword">if</span> (E[<span class="number">1</span>].size() &lt;= <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">                ans += val[i] ; <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            mxd = cnt ;</span><br><span class="line">            cnt = <span class="number">0</span> ; dfs_l(E[<span class="number">1</span>][<span class="number">1</span>]) ;</span><br><span class="line">            sort(tmp + <span class="number">1</span>, tmp + cnt + <span class="number">1</span>, comp) ;</span><br><span class="line">            sort(val + <span class="number">1</span>, val + mxd + <span class="number">1</span>, comp) ;</span><br><span class="line">            <span class="keyword">if</span> (mxd &gt; cnt) swap(val, tmp), swap(mxd, cnt) ;</span><br><span class="line"><span class="comment">//            for (int i = 1 ; i &lt;= n ; ++ i)</span></span><br><span class="line"><span class="comment">//                printf("%d %d\n", tmp[i], val[i]) ;</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= mxd ; ++ i)</span><br><span class="line">                ans += max(tmp[i], val[i]) ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = mxd + <span class="number">1</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">                ans += tmp[i] ;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans + base[<span class="number">1</span>]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt;= <span class="number">300000</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (deg[i] &lt;= <span class="number">1</span>) val[++ cnt] = i ;</span><br><span class="line">        sort(val + <span class="number">1</span>, val + cnt + <span class="number">1</span>, [](<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123; <span class="keyword">return</span> dfn[x] &lt; dfn[y] ; &#125;) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">            tmp[val[i]] = lca(val[i], val[i - <span class="number">1</span>]) ;</span><br><span class="line">        solve(mxd = <span class="number">1</span>) ;</span><br><span class="line"><span class="comment">//        for (int i = 1 ; i &lt;= n ; ++ i) cout &lt;&lt; dep[i] &lt;&lt; '\n' ;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= mxd ; ++ i) s.insert(<span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">            sort(L[val[i]].begin(), L[val[i]].end(), [](<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123; <span class="keyword">return</span> base[x] &gt; base[y] ; &#125;) ;</span><br><span class="line"><span class="comment">//        for (int i = 1 ; i &lt;= cnt ; ++ i)&#123;</span></span><br><span class="line"><span class="comment">//            cout &lt;&lt; val[i] &lt;&lt; '\n' ;</span></span><br><span class="line"><span class="comment">//            for (auto t : L[val[i]]) cout &lt;&lt; t &lt;&lt; " " ; puts("") ;</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)&#123;</span><br><span class="line"><span class="comment">//            cout &lt;&lt; i &lt;&lt; '\n';</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> j : L[val[i]])&#123;</span><br><span class="line">                <span class="keyword">auto</span> p = s.lower_bound(base[j]) ;</span><br><span class="line">                <span class="keyword">if</span> (p == s.end())</span><br><span class="line">                    s.erase(-- p), zscv.push_back(base[j]) ;</span><br><span class="line">                <span class="keyword">else</span> s.erase(p), zscv.push_back(*p) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> j : zscv) s.insert(j) ; zscv.clear() ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> p : s) ans += p ; <span class="comment">//, cout &lt;&lt; p &lt;&lt; " " ;</span></span><br><span class="line">         <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line"><span class="keyword">int</span> n, base[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; E[N], mg ;</span><br><span class="line">priority_queue &lt;<span class="keyword">int</span>&gt; h[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        solve(y) ;</span><br><span class="line">        <span class="keyword">if</span> (h[y].size() &gt; h[x].size()) swap(h[x], h[y]) ;</span><br><span class="line">        <span class="keyword">while</span> (h[y].size())</span><br><span class="line">            mg.push_back(max(h[y].top(), h[x].top())), h[y].pop(), h[x].pop() ;</span><br><span class="line">        <span class="keyword">while</span> (mg.size()) h[x].push(mg.back()), mg.pop_back() ;</span><br><span class="line">    &#125;</span><br><span class="line">    h[x].push(base[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; <span class="keyword">int</span> x, y ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), E[x].push_back(i) ;</span><br><span class="line">    solve(<span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (h[<span class="number">1</span>].size())</span><br><span class="line">        ans += h[<span class="number">1</span>].top(), h[<span class="number">1</span>].pop() ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h1 id="C-å¸Œæœ›-36-åˆ†"><a href="#C-å¸Œæœ›-36-åˆ†" class="headerlink" title="C å¸Œæœ›(36 åˆ†)"></a>C å¸Œæœ›(36 åˆ†)</h1><p>é¸½äº†ã€‚</p><h1 id="åäºŒçœè”è€ƒ-éª—åˆ†è¿‡æ ·ä¾‹"><a href="#åäºŒçœè”è€ƒ-éª—åˆ†è¿‡æ ·ä¾‹" class="headerlink" title="åäºŒçœè”è€ƒ éª—åˆ†è¿‡æ ·ä¾‹"></a>åäºŒçœè”è€ƒ éª—åˆ†è¿‡æ ·ä¾‹</h1><p>è¿‡ç¨‹æ¯”è¾ƒæ›²æŠ˜ï¼Œæ²¡å•¥æ—¶é—´å†™äº†ã€‚å°±å…ˆæ”¾ä¸€ä¸‹ä»£ç å§ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> us unsigned</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rg register</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NR = <span class="number">1000010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">150000010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXP = <span class="number">10000100</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX2 = <span class="number">50000010</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span> ;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> phm = <span class="number">998244352</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N ;</span><br><span class="line"><span class="keyword">char</span> In[<span class="number">10000</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Sub1&#123;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">expow</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">        ll res = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (b)&#123;</span><br><span class="line">            <span class="keyword">if</span> (b &amp; <span class="number">1</span>) res = res * a % mod ;</span><br><span class="line">            a = a * a % mod, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res % mod ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//    const char *Muban = "1_998244353" ;</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check1</span><span class="params">(<span class="keyword">char</span> *A)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> Len = <span class="built_in">strlen</span>(A) ;</span><br><span class="line">        <span class="keyword">if</span> (Len == <span class="number">11</span>) <span class="keyword">return</span> <span class="number">1</span> ; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> c = getchar() ; ll ret = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c))&#123;</span><br><span class="line">            ret = (ret &lt;&lt; <span class="number">1</span>) + (ret &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">            <span class="keyword">if</span> (ret &gt; mod) ret = ret % phm + phm ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Solve1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">int</span> i ; ll q ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) q = qr(), <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, expow(<span class="number">19</span>, q)) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Sub2&#123;</span><br><span class="line">    <span class="keyword">int</span> mod = <span class="number">1145141</span>, phm = <span class="number">1145140</span> ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">expow</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">        ll res = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (b)&#123;</span><br><span class="line">            <span class="keyword">if</span> (b &amp; <span class="number">1</span>) res = res * a % mod ;</span><br><span class="line">            a = a * a % mod, b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res % mod ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">get_phi</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">        ll rt = <span class="built_in">sqrt</span>(x) + <span class="number">1</span>, ret = x ;</span><br><span class="line">        <span class="keyword">for</span> (ll p = <span class="number">2</span> ; p &lt;= rt ; ++ p)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!(x % p)) &#123; ret = ret * (p - <span class="number">1</span>) / p ; <span class="keyword">while</span> (!(x % p)) x /= p ;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">1</span>) ret = ret * (x - <span class="number">1</span>) / x ;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check2</span><span class="params">(<span class="keyword">char</span> *A)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> Len = <span class="built_in">strlen</span>(A) ;</span><br><span class="line">        <span class="keyword">if</span> (Len == <span class="number">2</span> &amp;&amp; In[<span class="number">1</span>] == <span class="string">'?'</span>) <span class="keyword">return</span> <span class="number">1</span> ; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> c = getchar() ; ll ret = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c))&#123;</span><br><span class="line">            ret = (ret &lt;&lt; <span class="number">1</span>) + (ret &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">            <span class="keyword">if</span> (ret &gt; mod) ret = ret % phm + phm ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Solve2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">int</span> i ; ll q ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) q = qr(), <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, expow(<span class="number">19</span>, q)) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Sub3&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line">    ull mod = <span class="number">5211600617818708273L</span>L, phm = mod - <span class="number">1</span> ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ull <span class="title">mul</span><span class="params">(ull a, ull b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">register</span> ull res = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (b)&#123;</span><br><span class="line">            <span class="keyword">if</span> (b &amp; <span class="number">1</span>) res = (res + a) % mod ;</span><br><span class="line">            a = (a + a) % mod, b &gt;&gt;= <span class="number">1u</span>ll ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res % mod ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ull <span class="title">expow</span><span class="params">(ull a, ull b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">register</span> ull res = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (b)&#123;</span><br><span class="line">            <span class="keyword">if</span> (b &amp; <span class="number">1</span>) res = mul(res, a) % mod ;</span><br><span class="line">            a = mul(a, a) % mod, b &gt;&gt;= <span class="number">1u</span>ll ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res % mod ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ull <span class="title">get_phi</span><span class="params">(ull x)</span></span>&#123;</span><br><span class="line">        ull rt = <span class="built_in">sqrt</span>(x) + <span class="number">1</span>, ret = x ;</span><br><span class="line">        <span class="keyword">for</span> (ull p = <span class="number">2</span> ; p &lt;= rt ; ++ p)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!(x % p)) &#123; ret = ret * (p - <span class="number">1</span>) / p ; <span class="keyword">while</span> (!(x % p)) x /= p ;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">1</span>) ret = ret * (x - <span class="number">1</span>) / x ;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check3</span><span class="params">(<span class="keyword">char</span> *A)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> Len = <span class="built_in">strlen</span>(A) ;</span><br><span class="line">        <span class="keyword">if</span> (Len == <span class="number">3</span> &amp;&amp; In[<span class="number">1</span>] == <span class="string">'?'</span> &amp;&amp; In[<span class="number">2</span>] == <span class="string">'+'</span>) <span class="keyword">return</span> <span class="number">1</span> ; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ull <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> c = getchar() ; ull ret = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) ret = (ret &lt;&lt; <span class="number">1</span>) + (ret &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Solve3</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; N ; <span class="keyword">int</span> i ; ull q ;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span> ; i &lt;= N ; ++ i) q = qr(), <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, expow(<span class="number">19</span>, q)) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">è¿™é‡Œæ˜¯ä¸€å¼ è¡¨ï¼Œé˜²æ­¢åšå®¢å¡é¡¿äºæ˜¯å¡åˆ°äº† paste bin é‡Œé¢ï¼Œé“¾æ¥ï¼š https:<span class="comment">//paste.ubuntu.com/p/WS9Vm2J3BR/</span></span><br><span class="line"><span class="keyword">namespace</span> Sub4&#123;</span><br><span class="line">    <span class="keyword">const</span> ll mod = <span class="number">998244353</span> ;</span><br><span class="line">    <span class="keyword">const</span> ll phm = mod - <span class="number">1</span> ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (b)&#123;</span><br><span class="line">            <span class="keyword">if</span> (b &amp; <span class="number">1</span>) res = (<span class="keyword">int</span>)((<span class="keyword">unsigned</span>)res * (<span class="keyword">unsigned</span>)a)  % mod;</span><br><span class="line">            a = (<span class="keyword">int</span>)(((<span class="keyword">unsigned</span>)a * (<span class="keyword">unsigned</span>)a) )% mod ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res % mod ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check4</span><span class="params">(<span class="keyword">char</span> *A)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> Len = <span class="built_in">strlen</span>(A) ;</span><br><span class="line">        <span class="keyword">if</span> (Len == <span class="number">13</span> &amp;&amp; In[<span class="number">1</span>] == <span class="string">'w'</span> &amp;&amp; In[<span class="number">2</span>] == <span class="string">'a'</span>) <span class="keyword">return</span> <span class="number">1</span> ; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> c = getchar() ; ll ret = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) ret = (ret &lt;&lt; <span class="number">1</span>) + (ret &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> pwp[NR] ;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> t ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Solve4</span><span class="params">()</span></span>&#123;<span class="comment">//55245 45699</span></span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; N ; pwp[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; NR ; ++ i)</span><br><span class="line">            pwp[i] = pwp[i - <span class="number">1</span>] * <span class="number">19</span> % mod ;</span><br><span class="line">        <span class="keyword">while</span> (N --)&#123;</span><br><span class="line">            t = qr() ;</span><br><span class="line">            <span class="keyword">if</span> (t &lt;= <span class="number">55245</span>)</span><br><span class="line">                 <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, pwp[t]) ;</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, pwp[(t - <span class="number">55245</span>) % <span class="number">45699</span> + <span class="number">55245</span>]) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> pr[MAXP + <span class="number">10</span>] ;</span><br><span class="line"><span class="keyword">int</span> phi[MAXP &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">bool</span> vis[MAX + <span class="number">10</span>] ;</span><br><span class="line"><span class="keyword">bool</span> vis2[NR + <span class="number">10</span>] ;</span><br><span class="line"><span class="keyword">bool</span> chk[MAXP &lt;&lt; <span class="number">1</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Sub5&#123;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check5</span><span class="params">(<span class="keyword">char</span> *A)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> Len = <span class="built_in">strlen</span>(A) ;</span><br><span class="line">        <span class="keyword">if</span> (Len == <span class="number">2</span> &amp;&amp; A[<span class="number">0</span>] == <span class="string">'2'</span> &amp;&amp; A[<span class="number">1</span>] == <span class="string">'p'</span>) <span class="keyword">return</span> <span class="number">1</span> ; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Euler</span><span class="params">()</span></span>&#123;</span><br><span class="line">        vis[<span class="number">0</span>] = vis[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= MAX ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis[i]) pr[++ cnt] = i ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">                <span class="keyword">if</span> (i * pr[j] &gt; MAX) <span class="keyword">break</span> ;</span><br><span class="line">                vis[i * pr[j]] = <span class="number">1</span> ; <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Jie</span><span class="params">(us ll L, us ll R)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (L &gt;= <span class="number">99999999999900000L</span>L)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= <span class="number">4370</span> ; ++ i) vis2[wa[i]] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">for</span> (us ll j = L / pr[i] - <span class="number">1</span> ; j &lt;= R / pr[i] + <span class="number">1</span> ; ++ j)&#123;</span><br><span class="line">                <span class="keyword">if</span> (j * pr[i] &gt; R || j * pr[i] &lt; L) <span class="keyword">continue</span> ;</span><br><span class="line">                vis2[j * pr[i]- L] = <span class="number">1</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> c = getchar() ; ll ret = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) ret = (ret &lt;&lt; <span class="number">1</span>) + (ret &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Solve5</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Euler() ;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; N ; us ll L, R ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">            L = qr() ;</span><br><span class="line">            R = qr() ;</span><br><span class="line">            <span class="keyword">if</span> (R &lt;= MAX)</span><br><span class="line">                <span class="keyword">for</span> (us ll j = L ; j &lt;= R ; ++ j)</span><br><span class="line">                    <span class="keyword">if</span> (vis[j]) <span class="built_in">putchar</span>(<span class="string">'.'</span>) ; <span class="keyword">else</span> <span class="built_in">putchar</span>(<span class="string">'p'</span>) ;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                Jie(L, R) ;</span><br><span class="line">                <span class="keyword">for</span> (us ll j = L ; j &lt;= R ; ++ j)</span><br><span class="line">                    <span class="keyword">if</span> (vis2[j - L]) <span class="built_in">putchar</span>(<span class="string">'.'</span>) ; <span class="keyword">else</span> <span class="built_in">putchar</span>(<span class="string">'p'</span>) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Sub6&#123;</span><br><span class="line"><span class="keyword">short</span> mu[MAX + <span class="number">10</span>] ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check6</span><span class="params">(<span class="keyword">char</span> *A)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> Len = <span class="built_in">strlen</span>(A) ;</span><br><span class="line">        <span class="keyword">if</span> (Len == <span class="number">2</span> &amp;&amp; A[<span class="number">0</span>] == <span class="string">'2'</span> &amp;&amp; A[<span class="number">1</span>] == <span class="string">'u'</span>) <span class="keyword">return</span> <span class="number">1</span> ; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Euler</span><span class="params">()</span></span>&#123;</span><br><span class="line">        vis[<span class="number">0</span>] = vis[<span class="number">1</span>] = <span class="number">1</span> ; mu[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= MAX2 ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis[i]) pr[++ cnt] = i, mu[i] = <span class="number">-1</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">                <span class="keyword">if</span> (i * pr[j] &gt; MAX2) <span class="keyword">break</span> ;</span><br><span class="line">                vis[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">            mu[i * pr[j]] = - mu[i] ;</span><br><span class="line">&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> trv[NR] ;</span><br><span class="line">    <span class="keyword">short</span> mu2[MAX + <span class="number">10</span>] ;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Jie</span><span class="params">(us ll L, us ll R)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (ll i = L ; i &lt;= R ; ++ i) trv[i - L] = i ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)&#123;</span><br><span class="line"><span class="keyword">for</span> (us ll j = L / pr[i] - <span class="number">1</span> ; j &lt;= R / pr[i] + <span class="number">1</span> ; ++ j)&#123;</span><br><span class="line">                <span class="keyword">if</span> (j * pr[i] &gt; R) <span class="keyword">continue</span> ;</span><br><span class="line">                <span class="keyword">if</span> (j * pr[i] &lt; L) <span class="keyword">continue</span> ;</span><br><span class="line">vis2[j * pr[i]- L] = <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">if</span> (j % pr[i] == <span class="number">0</span>)</span><br><span class="line"> mu2[j * pr[i] - L] = <span class="number">-10000</span> ;</span><br><span class="line"><span class="keyword">else</span> mu2[j * pr[i] - L] ++ ;</span><br><span class="line">            trv[j * pr[i] - L] /= pr[i] ;</span><br><span class="line">&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= (<span class="keyword">int</span>)(R - L + <span class="number">1</span>) ; ++ i)</span><br><span class="line"><span class="keyword">if</span> (!vis2[i]) mu2[i] = <span class="number">1</span>, trv[i] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> c = getchar() ; ll ret = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c)) c = getchar() ;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c)) ret = (ret &lt;&lt; <span class="number">1</span>) + (ret &lt;&lt; <span class="number">3</span>) + c - <span class="number">48</span>, c = getchar() ;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Solve6</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Euler() ;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; N ; us ll L, R ; <span class="comment">//return void() ;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= N ; ++ i)&#123;</span><br><span class="line">            L = qr(), R = qr() ;</span><br><span class="line">            <span class="comment">//cerr &lt;&lt; i &lt;&lt; " " &lt;&lt; L &lt;&lt; " " &lt;&lt; R &lt;&lt; '\n' ;</span></span><br><span class="line">            <span class="keyword">if</span> (R &lt;= MAX2)&#123;</span><br><span class="line">                <span class="keyword">for</span> (us ll j = L ; j &lt;= R ; ++ j)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (mu[j]) <span class="built_in">putchar</span>(~mu[j] ? <span class="string">'+'</span> : <span class="string">'-'</span>) ;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">putchar</span>(<span class="string">'0'</span>) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                Jie(L, R) ;</span><br><span class="line">                <span class="keyword">for</span> (us ll j = L ; j &lt;= R ; ++ j)&#123;</span><br><span class="line"><span class="comment">//                cerr &lt;&lt; trv[j - L] &lt;&lt; '\n' ;</span></span><br><span class="line">                    <span class="keyword">if</span> (mu2[j - L] &gt;= <span class="number">0</span>)</span><br><span class="line"><span class="built_in">putchar</span>(( ( mu2[j - L] + (trv[j - L] &gt; <span class="number">1</span>) ) &amp; <span class="number">1</span>) ? <span class="string">'-'</span> : <span class="string">'+'</span>) ;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">putchar</span>(<span class="string">'0'</span>) ;</span><br><span class="line">&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">putchar</span>(<span class="string">'\n'</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Sub7&#123;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check7</span><span class="params">(<span class="keyword">char</span> *A)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> Len = <span class="built_in">strlen</span>(A) ;</span><br><span class="line">        <span class="keyword">if</span> (Len == <span class="number">2</span> &amp;&amp; A[<span class="number">0</span>] == <span class="string">'2'</span> &amp;&amp; A[<span class="number">1</span>] == <span class="string">'g'</span>) <span class="keyword">return</span> <span class="number">1</span> ; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">   phi[<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= x ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">            pr[++ cnt] = i, phi[i] = i - <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i * pr[j] &gt; x) <span class="keyword">break</span> ;</span><br><span class="line">vis[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line">           <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                phi[i * pr[j]] = phi[i] * pr[j] ; <span class="keyword">break</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> phi[i * pr[j]] = phi[i] * (pr[j] - <span class="number">1</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ctz __builtin_ctz</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!(a * b)) <span class="keyword">return</span> a + b ;</span><br><span class="line">    <span class="keyword">int</span> t = ctz(a | b) ; a &gt;&gt;= ctz(a) ;</span><br><span class="line">    <span class="keyword">do</span> &#123; b &gt;&gt;= ctz(b) ; <span class="keyword">if</span> (a &gt; b) swap(a, b) ;  b -= a ; &#125; <span class="keyword">while</span>(b) ;</span><br><span class="line">    <span class="keyword">return</span> a &lt;&lt; t ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            res = <span class="number">1l</span>l * res * a % p ;</span><br><span class="line">        a = <span class="number">1l</span>l * a * a % p ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> L, R, P ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ctn, tot ;</span><br><span class="line"><span class="keyword">int</span> fac[NR], rt, po ;</span><br><span class="line"><span class="keyword">int</span> dmod[<span class="number">3</span>] = &#123;<span class="number">2</span>, <span class="number">7</span>, <span class="number">17</span>&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Solve7</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; N ;</span><br><span class="line">sieve((MAXP &lt;&lt; <span class="number">1</span>) - <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">while</span> (N --)&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; L &gt;&gt; R &gt;&gt; P ;</span><br><span class="line"><span class="keyword">if</span> (P == mod)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = L ; i &lt;= R ; ++ i)&#123;</span><br><span class="line"><span class="keyword">bool</span> rr = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">3</span> ; ++ j)</span><br><span class="line">rr |= (<span class="keyword">bool</span>)(expow(i, phm / dmod[j], mod) == <span class="number">1</span>) ;</span><br><span class="line"><span class="built_in">putchar</span>(rr ? <span class="string">'.'</span> : <span class="string">'g'</span>) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (P &lt; MAXP &lt;&lt; <span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">int</span> p = phi[P] ; ctn = tot = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">2</span> ; i * i &lt;= p ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (p % i == <span class="number">0</span>)&#123;</span><br><span class="line">                fac[++ tot] = i ;</span><br><span class="line">                <span class="keyword">while</span> (p % i == <span class="number">0</span>) p /= i ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">       <span class="keyword">if</span> (p &gt; <span class="number">1</span>) fac[++ tot] = p ; po = phi[P] ;</span><br><span class="line"><span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= P ; ++ i)&#123;</span><br><span class="line">         rg <span class="keyword">bool</span> ans = <span class="number">0</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= tot ; ++ j)</span><br><span class="line">                <span class="keyword">if</span> (expow(i, po / fac[j], P) == <span class="number">1</span>)&#123; ans = <span class="number">1</span> ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">            <span class="keyword">if</span> (!ans &amp;&amp; expow(i, po, P) == <span class="number">1</span>) &#123; rt = i ; <span class="keyword">break</span> ; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> j = <span class="number">1</span>, i = <span class="number">1</span> ; i &lt;= po ; ++ i)&#123;</span><br><span class="line">            j = <span class="number">1l</span>l * j * rt % P ;</span><br><span class="line">            <span class="keyword">if</span> (gcd(i, po) == <span class="number">1</span>) chk[j] = <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> i = L ; i &lt;= R ; ++ i)</span><br><span class="line">        <span class="built_in">putchar</span>(!chk[i] ? <span class="string">'.'</span> : <span class="string">'g'</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'\n'</span>) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, In) ;</span><br><span class="line">    <span class="keyword">if</span> (Sub1 :: check1(In)) Sub1 :: Solve1() ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (Sub2 :: check2(In)) Sub2 :: Solve2() ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (Sub3 :: check3(In)) Sub3 :: Solve3() ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (Sub4 :: check4(In)) Sub4 :: Solve4() ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (Sub5 :: check5(In)) Sub5 :: Solve5() ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (Sub6 :: check6(In)) Sub6 :: Solve6() ;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (Sub7 :: check7(In)) Sub7 :: Solve7() ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¥è‡ªä¸€æ¡å’¸é±¼æœ€åçš„æŒ£æ‰ã€‚&lt;/p&gt;
&lt;p&gt;å¤§æ¦‚æ˜¯è¡¥å®Œäº†ä¸€ä¸‹ã€Œä¹çœè”è€ƒ Day1ã€ çš„å…¨éƒ¨ï¼Œã€ŒåäºŒçœè”è€ƒ Day1T3 éª—åˆ†è¿‡æ ·ä¾‹ã€çš„ $75$ åˆ†å’Œã€ŒåäºŒçœè”è€ƒ Day2ã€ çš„ $70+100+36$ åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;æ„Ÿè§‰è‡ªå·±æ‰“å¾—ç¨³ä¸€ç‚¹ï¼Œåˆ†æ•°ä¹Ÿè¿˜å¯ä»¥ã€‚&lt;/p&gt;
&lt;p&gt;å‰©ä¸‹çš„é¢˜å¯èƒ½æ˜¯è¦ç­‰åˆ°å¾ˆä¹…å¾ˆä¹…ä»¥åæ‰èƒ½åšäº†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="loj" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/loj/"/>
    
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/çŠ¶å‹DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E7%8A%B6%E5%8E%8BDP/"/>
    
      <category term="å¥½å¤šå¥½å¤šç»†èŠ‚" scheme="https://www.orchidany.cn/tags/%E5%A5%BD%E5%A4%9A%E5%A5%BD%E5%A4%9A%E7%BB%86%E8%8A%82/"/>
    
      <category term="è´ªå¿ƒ" scheme="https://www.orchidany.cn/tags/%E8%B4%AA%E5%BF%83/"/>
    
      <category term="æ•°æ®ç»“æ„/çº¿æ®µæ ‘" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
      <category term="æš´åŠ›,brute-force" scheme="https://www.orchidany.cn/tags/%E6%9A%B4%E5%8A%9B-brute-force/"/>
    
      <category term="åšå¼ˆè®º/å¯¹ç§°åšå¼ˆ" scheme="https://www.orchidany.cn/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA-%E5%AF%B9%E7%A7%B0%E5%8D%9A%E5%BC%88/"/>
    
  </entry>
  
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘[Codeforces Round#584(Combined) A~G2] é¢˜è§£</title>
    <link href="https://www.orchidany.cn/2020/06/14/CF-Round-584/"/>
    <id>https://www.orchidany.cn/2020/06/14/CF-Round-584/</id>
    <published>2020-06-14T10:50:28.000Z</published>
    <updated>2020-06-19T12:13:44.280Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä¸å¾—ä¸è¯´ï¼Œè¿™åœºæ˜¯çœŸçš„çœŸçš„è‰¯å¿ƒï¼é¦–å…ˆçŸ¥è¯†ç‚¹è¦†ç›–å…¨é¢ï¼Œå„ç§é¢˜ç›®ä¹Ÿéƒ½æ¯”è¾ƒå¯Œæœ‰æ€ç»´å«é‡ï¼Œå¤§æ¦‚æ˜¯æˆ‘æ‰“è¿‡çš„ Combined åœºé‡Œé¢è´¨é‡æœ€é«˜çš„ä¸€åœºã€‚</p><p>ç„¶åå°± vp äº†ä¸€æ•´åœºï¼Œæœ€åçš„æˆ˜ç»©å¤§æ¦‚è¿˜ä¸é”™ï¼Ÿ</p><p>ä¸€å…±æœ‰ $9$ é“é¢˜ç›®ã€‚</p><a id="more"></a><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="1.png" alt=""></p><p>ä¸Šé¢é‚£ä¸ªæ˜¯æ‰˜ç¥ã€‚æœ€å rush äº†ä¸€ä¸ª $\rm G1$ ï¼Œç»“æœæŠŠ $y$ å†™æˆ $x$ å°±æŒ‚äº†ã€‚ç»“æŸä¹‹å $3\sim 5\min$ å·¦å³å°±è¿‡æ‰äº†å§ã€‚</p><h1 id="A-Paint-the-Numbers"><a href="#A-Paint-the-Numbers" class="headerlink" title="[A] Paint the Numbers"></a>[A] Paint the Numbers</h1><blockquote><p>ç»™å‡ºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åºåˆ— $a_1,a_2,a_3,â€¦ ,a_n$ï¼Œè¦æ±‚ä½ ä½¿ç”¨æœ€å°‘çš„é¢œè‰²å¯¹æ¯ä¸ªæŸ“è‰²ã€‚å¯¹äºä»»ä½•é¢œè‰²ï¼Œæ»¡è¶³ï¼šæŸ“æˆè¯¥é¢œè‰²çš„æ•°éƒ½èƒ½è¢«æŸ“æˆè¯¥é¢œè‰²çš„æœ€å°æ•°æ•´é™¤ã€‚</p><p>$1\leq n\leq 100$ ã€‚</p></blockquote><p>ä¸éš¾çŸ¥é“è¦æ’ä¸ªåºä¹‹åï¼Œå¯¹æ¯ä¸ªæ•°æ‰«ä¸€ä¸‹å®ƒçš„å€æ•°æ‰“ä¸Šæ ‡è®°ã€‚æœ€åæ²¡æœ‰è¢«æ ‡è®°çš„å°±æ˜¯æœ€å°‘çš„è‰²æ•°ã€‚</p><p>ä¸è¿‡æƒ³äº†ä¸€ä¸‹ï¼Œå¦‚æœ $a_i$ åœ¨ $10^6\sim 10^7$ å·¦å³ï¼Œé‚£ä¹ˆæ˜¯å¯ä»¥ $O(nd(n))$ åšçš„ã€‚</p><h1 id="B-Koala-and-Lights"><a href="#B-Koala-and-Lights" class="headerlink" title="[B] Koala and Lights"></a>[B] Koala and Lights</h1><blockquote><p>æœ‰ $n$ ç›ç¯ï¼Œç»™å®šåˆå§‹çŠ¶æ€ ã€‚<br>ç¬¬ $i$ç›ç¯ $a_i,a_i+b_i,a_i+2\times b_i,a_i+3\times b_i\cdots$ æ—¶åˆ»è¢«åˆ‡æ¢çŠ¶æ€ ã€‚<br>æ±‚ åŒä¸€æ—¶åˆ»äº®çš„ç¯æ•° çš„æœ€å¤§å€¼ã€‚<br>$n\leq 100,a_i,b_i\leq 5$ ã€‚</p></blockquote><p>ä¸€å¼€å§‹è§‰å¾—åˆæ˜¯ä»€ä¹ˆå¥‡æ€ªçš„ exgcd é¢˜ã€‚ç„¶åå‘ç° $a_i,b_i\leq 5$ ã€‚äºæ˜¯å°±å¯ä»¥æš´åŠ›ä¸Š $100$ ä¸‡å¤©å»æ‰¾æœ€å¤§å€¼ã€‚</p><p>ä¸€å¼€å§‹å› ä¸ºè°ƒè¯•ï¼ŒæŠŠå¤©æ•°è®¾ç½®ä¸ºäº† $20$ å¯¼è‡´æŒ‚äº†ä¸€å‘= =ã€‚</p><h1 id="C-Paint-the-Digits"><a href="#C-Paint-the-Digits" class="headerlink" title="[C] Paint the Digits"></a>[C] Paint the Digits</h1><blockquote><p>ç»™å®šä¸€ä¸ªæ•°å­—å­—ç¬¦ä¸² $s$ã€‚æŠŠå®ƒåˆ†å‰²ä¸ºä¸¤ä¸ªå­åºåˆ—(å¯ä»¥ä¸è¿ç»­)ã€‚æ»¡è¶³æŠŠç¬¬äºŒä¸ªå­åºåˆ—æ¥åœ¨ç¬¬ä¸€ä¸ªå­åºåˆ—ä¹‹åå½¢æˆçš„æ•°å­—ä¸²ä¸é™</p><p>$1\leq n\leq 10^6$ .</p></blockquote><p>ä¸€å¼€å§‹çŒœäº†ä¸€ä¸ªæŠŠ LIS æ‰¾å‡ºæ¥å°±å®Œäº†ã€‚ç„¶åå‘ç°å‡çš„ç¦»è°±ã€‚ç„¶åå°±è€ƒè™‘è§‚å¯Ÿæ€§è´¨ï¼Œå‘ç°å¦‚æœå­˜åœ¨åˆæ³•ç­”æ¡ˆï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ª $i$ å¦‚æœä½ç½®ä¸å˜ï¼Œä¼šæœ‰ $1\sim i-1$ éƒ½ $\leqslant i$ ã€‚ä¸éš¾å‘ç°è¿™æ˜¯ä¸ªååˆ†å¼ºçš„å¿…è¦æ¡ä»¶ã€‚äºæ˜¯å¯ä»¥è¿™ä¹ˆæŠŠç­”æ¡ˆå–å‡ºæ¥ï¼Œç„¶åå» check ä¸€ä¸‹å……åˆ†æ€§å°±å¥½äº†ã€‚å¤æ‚åº¦çº¿æ€§ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">301000</span> ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> n, T ;</span><br><span class="line"><span class="keyword">int</span> maxc ;</span><br><span class="line"><span class="keyword">int</span> maxv ;</span><br><span class="line"><span class="keyword">int</span> res[N] ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; ans1, ans2 ;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T) ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) ;</span><br><span class="line">        maxv = maxc = <span class="number">0</span> ;</span><br><span class="line">        ans2.clear() ; ans1.clear() ;</span><br><span class="line">        <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis)) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%1d"</span>, &amp;base[i]) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (maxv &gt; base[i])</span><br><span class="line">                 vis[i] = <span class="number">1</span>, maxc = max(base[i], maxc) ;</span><br><span class="line">            <span class="keyword">else</span> maxv = <span class="built_in">std</span> :: max(maxv, base[i]) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (vis[i] || base[i] &lt; maxc)</span><br><span class="line">                 ans1.push_back(i) ;</span><br><span class="line">            <span class="keyword">else</span> ans2.push_back(i) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> k : ans1) ans[k] = <span class="number">1</span>, res[++ cnt] = base[k] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> k : ans2) ans[k] = <span class="number">2</span>, res[++ cnt] = base[k] ;</span><br><span class="line">       <span class="comment">// for (int i = 1 ; i &lt;= n ; ++ i) printf("%d ", res[i]) ; puts("") ;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (res[i] &lt; res[i - <span class="number">1</span>]) <span class="keyword">goto</span> cc ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans[i]) ; <span class="built_in">puts</span>(<span class="string">""</span>) ; <span class="keyword">continue</span> ;</span><br><span class="line">        cc : <span class="built_in">puts</span>(<span class="string">"-"</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="D-Cow-and-Snacks"><a href="#D-Cow-and-Snacks" class="headerlink" title="[D] Cow and Snacks"></a>[D] Cow and Snacks</h1><blockquote><p>$n$ ç§èŠ±ï¼Œ$k$ ä¸ªå®¢äººï¼Œæ¯ä¸ªäººå–œæ¬¢ä¸¤ç§ç¼–å·ä¸åŒçš„èŠ±ã€‚ä½†æ˜¯æ¯ç§èŠ±åœ¨èŠ±åº—é‡Œåªæœ‰ä¸€æŸã€‚</p><p>å®¢äººæŒ‰é¡ºåºè¿›å…¥èŠ±åº—ï¼Œä¼šä¹°èµ°æ‰€æœ‰å¥¹å–œæ¬¢ä¸”ä»åœ¨åº—é“ºé‡Œçš„èŠ±ã€‚å¦‚æœä¸€ä¸ªå®¢äººä¹°ä¸åˆ°ä»»ä½•ä¸€æŸèŠ±ï¼Œé‚£ä¹ˆå¥¹å°±ä¼šååˆ†æ²®ä¸§å¯¼è‡´å˜æˆè‚¥å®…ã€‚ç°åœ¨ä½ å¯ä»¥è‡ªå·±å®‰æ’è¿™ $n$ ä¸ªäººçš„é¡ºåºï¼Œä½¿å¾—è‚¥å®…çš„æ•°é‡æœ€å°ã€‚</p><p>$1\leq n,k\leq 3\times 10^5$ ã€‚</p></blockquote><p>æˆ‘å°±æ˜¯ä¼ è¯´ä¸­çš„å›¾è®ºé»‘æ´å—ï¼Œè¿™é¢˜æ£é¼“äº†å¥½ä¹…å¥½ä¹… = =</p><p>å¤§æ¦‚å°±æ˜¯è¯´ï¼Œè€ƒè™‘æ¯ä¸€æ¬¡å®¢äººå¯èƒ½ä¼šä¹°èµ° $1$ æˆ–è€… $2$ ç§èŠ±ã€‚è€ƒç•¥ç”¨å›¾è®ºæ¨¡å‹å»åˆ»ç”»ä¹°èŠ±è¿™ä»¶äº‹æƒ…ã€‚è€ƒè™‘å¯ä»¥æŠŠèŠ±å½“åšç‚¹ï¼Œå®¢äººæ¯æ¬¡å°±æ˜¯è¦åˆ å» $(x_i,y_i)$ è¿™æ¡è¾¹çš„ä¸¤ä¸ªç«¯ç‚¹ï¼Œè€Œä¸€æ¡è¾¹ $(x,y)$ å¯ä»¥è¢«åˆ å½“ä¸”ä»…å½“å­˜åœ¨ä¸€ä¸ªç«¯ç‚¹æ²¡æœ‰è¢«åˆ æ‰ã€‚äºæ˜¯å¯ä»¥å‘ç°ï¼Œå¦‚æœä¸€ä¸ªè¿é€šå—å¤§å°ä¸º $B$ï¼Œé‚£ä¹ˆè‡³å¤šåªä¼šæœ‰ $B-1$ ä¸ªå®¢äººå¯ä»¥ä¸æ²®ä¸§ã€‚</p><p>è€ƒè™‘ç”¨å¹¶æŸ¥é›†å®ç°è¿™ä¸ªè¿‡ç¨‹ã€‚é‚£ä¹ˆå¹¶æŸ¥é›†ä¸­çš„è¾¹æ•°å³ä¸º $\sum (B-1)$ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">int</span> n, k, ans ;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (fa[x] == x) <span class="keyword">return</span> x ;</span><br><span class="line">    <span class="keyword">return</span> fa[x] = find(fa[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> f1 = find(x) ;</span><br><span class="line">    <span class="keyword">int</span> f2 = find(y) ;</span><br><span class="line">    <span class="keyword">if</span> (f1 != f2)&#123;</span><br><span class="line">        ++ cnt ;</span><br><span class="line">        fa[f1] = f2 ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k ; <span class="keyword">int</span> x, y ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) fa[i] = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y, merge(x, y) ;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, k - cnt) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="E1-Rotate-Columns-easy-version"><a href="#E1-Rotate-Columns-easy-version" class="headerlink" title="[E1] Rotate Columns (easy version)"></a>[E1] Rotate Columns (easy version)</h1><blockquote><p>ç»™å®šä¸€ä¸ª $nÃ—m$ çš„çŸ©é˜µï¼Œä½ å¯ä»¥å¯¹æ¯ä¸€åˆ—è¿›è¡Œè‹¥å¹²æ¬¡å¾ªç¯ç§»ä½ã€‚</p><p>æ±‚æ“ä½œå®Œæˆåæ¯ä¸€è¡Œçš„æœ€å¤§å€¼ä¹‹å’Œæœ€å¤§æ˜¯å¤šå°‘ã€‚</p><p>$1\leq n\leq 4,1\leq m\leq 100$ ã€‚</p></blockquote><p>å¤§æ¦‚æ˜¯éœ€è¦å…ˆèµ·æ‰‹æ‰¾ä¸€æ³¢æ€§è´¨ã€‚</p><p>å‘ç°ã€Œæ¯è¡Œå–æœ€å¤§å€¼ã€å¯ä»¥è½¬åŒ–æˆæ¯è¡Œå–ä¸€ä¸ªæ•°ï¼Œå› ä¸ºæ ¹æ® max çš„ç»“åˆå¾‹è¿™ä¸ªæœ€å¤§å€¼çš„é™åˆ¶å±å®æ²¡ç”¨ã€‚ç„¶åå°±å¯ä»¥è®¾ $f_{i,s}$ è¡¨ç¤ºè€ƒè™‘äº†å‰ $i$ åˆ—ï¼Œæ¯ä¸€è¡Œçš„å–æ•°çŠ¶æ€ä¸º $s$ æ—¶ç­”æ¡ˆçš„ maxã€‚è½¬ç§»å°±å¯ä»¥ç›´æ¥æšä¸¾å­é›†è½¬ç§»ã€‚éœ€è¦æ³¨æ„çš„æ˜¯åˆ—æ˜¯å…è®¸å¾ªç¯ç§»ä½çš„ï¼Œæ‰€ä»¥åœ¨é¢„å¤„ç† <code>sum[s]</code> æ—¶è¦è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ã€‚</p><p>äºæ˜¯æœ€åçš„å¤æ‚åº¦å°±æ˜¯ $O(T\cdot m\cdot 3^n)$ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> T, s ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> Id[S] ;</span><br><span class="line"><span class="keyword">int</span> sum[S] ;</span><br><span class="line"><span class="keyword">int</span> f[N][S] ;</span><br><span class="line"><span class="keyword">int</span> row[N][M] ;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> I = <span class="number">1000000007</span> ;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out_p</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (x)&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &amp; <span class="number">1</span>)</span><br><span class="line">             <span class="built_in">putchar</span>(<span class="string">'1'</span>) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">putchar</span>(<span class="string">'0'</span>) ;</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">' '</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= <span class="number">12</span> ; ++ i)</span><br><span class="line">        Id[<span class="number">1</span> &lt;&lt; i] = i + <span class="number">1</span> ; <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">        s = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span> ;</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">-63</span>, <span class="keyword">sizeof</span>(f)) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= m ; ++ j)</span><br><span class="line">                <span class="built_in">cin</span> &gt;&gt; row[j][i] ; f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">1</span> ; p &lt;= s ; ++ p)&#123;</span><br><span class="line">                sum[p] = sum[p - (p &amp; -p)] + row[i][Id[(p &amp; -p)]] ;</span><br><span class="line"><span class="comment">//                printf("%d %d\n", p, sum[p]) ;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">1</span> ; p &lt;= s ; ++ p)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> o = <span class="number">0</span> ; o &lt; n ; ++ o)&#123;</span><br><span class="line">                    <span class="keyword">int</span> q = ((p &gt;&gt; o) | (p &lt;&lt; (n - o))) &amp; s ;</span><br><span class="line"><span class="comment">//                    out_p(p), out_p(q), puts("") ;</span></span><br><span class="line">                    sum[p] = max(sum[p], sum[q]) ;</span><br><span class="line">                &#125;</span><br><span class="line">            f[i][<span class="number">0</span>] = f[i - <span class="number">1</span>][<span class="number">0</span>] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">1</span> ; p &lt;= s ; ++ p)&#123;</span><br><span class="line">            f[i][p] = f[i - <span class="number">1</span>][p] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = p ; q ; q = (q - <span class="number">1</span>) &amp; p)</span><br><span class="line">f[i][p] = max(f[i][p], f[i - <span class="number">1</span>][p ^ q] + sum[q]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//            printf("%d %d\n", s, f[i][s]) ;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, f[m][s]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="E2-Rotate-Columns-hard-version"><a href="#E2-Rotate-Columns-hard-version" class="headerlink" title="[E2] Rotate Columns (hard version)"></a>[E2] Rotate Columns (hard version)</h1><blockquote><p>$n\leq 12,m\leq 2000$ ã€‚</p></blockquote><p>å‘ç°ä¸Šé¢é‚£ä¸ªå¤æ‚åº¦è¦é€šè¿‡æœ‰ç‚¹å›°éš¾ï¼Œç®—äº†ä¸€æ³¢å¤§æ¦‚æ˜¯ $40\times 531441\times 2000&gt;10^{10}$ â€¦</p><p>ç„¶åè€ƒè™‘éœ€è¦çŒœä¸€ä¸ªç»“è®ºã€‚å°±æ˜¯ä¸€å®šä¼šå­˜åœ¨æŸäº›åˆ—æ˜¯æ ¹æœ¬ä¸ä¼šå¯¹ç­”æ¡ˆæœ‰è´¡çŒ®çš„ï¼Œä¸”è¿™äº›åˆ—çš„æ•°é‡æ˜¯ $m-n$ ã€‚é‚£ä¹ˆè€ƒè™‘å¦‚æœå­˜åœ¨æŸä¸€åˆ—ï¼Œè¯¥åˆ—çš„æœ€å¤§å€¼ $c$ åœ¨æ‰€æœ‰åˆ—ä¸­æ’å $&gt;n$ ï¼Œé‚£ä¹ˆç”±äºå¯ä»¥å¾ªç¯ç§»ä½ï¼Œå¯ä»¥çŸ¥é“ç­”æ¡ˆä¸€å®šä¸åœ¨è¿™ä¸€åˆ—ã€‚äºæ˜¯å°±å¯ä»¥æ’ä¸ªåºï¼Œå¤æ‚åº¦å°±å˜æˆäº† $O(T\times n\times 3^n)$ï¼Œå¤§æ¦‚æ˜¯ $40\times 531441\times 12&lt;2.5e8$ ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚</p><h1 id="F-Koala-and-Notebook"><a href="#F-Koala-and-Notebook" class="headerlink" title="[F] Koala and Notebook"></a>[F] Koala and Notebook</h1><blockquote><p>å®šä¹‰ä¸€æ¡è·¯å¾„çš„æƒå€¼ä¸ºè·¯å¾„ä¸Šæ‰€æœ‰è¾¹çš„ç¼–å·ç›´æ¥ç›¸è¿æ‰€å¾—åˆ°çš„åè¿›åˆ¶æ•°å­—çš„å¤§å° ã€‚</p><p>æ±‚ $1$ åˆ°æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯ $\pmod{10^9+7}$ ã€‚</p><p>$1\leq n,m\leq 100000$ã€‚</p></blockquote><p>è¿™é¢˜æ˜¯çœŸçš„æœ‰è¶£ã€‚è™½ç„¶åœºä¸Šå¹¶æ²¡æœ‰å»å†™ï¼ˆæ„Ÿè§‰å†™äº†ä¹Ÿæ˜¯ä¸å¯èƒ½è¿‡çš„ï¼‰ã€‚</p><p>ä¸€å¼€å§‹è§‰å¾—ã€Œéš¾é“ä¸æ˜¯æŠŠå‡ºè¾¹ xjb æ’ä¸ªåºå°±åšå®Œäº†å˜›ã€ã€‚ç„¶åå‘ç°è¢«å‰äº†ï¼Œå¿ƒæƒ…éƒé—·(x</p><p>è€ƒè™‘å¦‚ä½•æ¯”è¾ƒã€Œç¼–å·ç›¸è¿å¾—åˆ°çš„åè¿›åˆ¶æ•°ã€çš„å¤§å°ï¼Œé‚£å¿…ç„¶æ˜¯å…ˆæ¯”è¾ƒä½æ•°ï¼Œå†ä»å¤´å¼€å§‹æ¯”è¾ƒæƒå€¼ã€‚äºæ˜¯å°±æœ‰ä¸ªç‰¹åˆ«å¼ºçš„å»ºå›¾æŠ€å·§ï¼šæ‹†è¾¹ã€‚è€ƒè™‘æŠŠä¸€æ¡ç¼–å·ä¸º $(\overline{a_1a_2\cdots a_k})_{10}$ çš„è¾¹æ‹†æˆä¸¤æ¡æœ‰å‘é“¾ï¼Œé“¾ä¸Šçš„è¾¹çš„è¾¹æƒåˆ†åˆ«ä¸º $a_1,a_2\cdots a_k$ã€‚</p><p>ç„¶åè€ƒè™‘è¿›è¡Œç±»ä¼¼åˆ†å±‚å›¾çš„ BFSã€‚è¿™ä¸ªåˆ†å±‚å›¾çš„ç»†èŠ‚å¾ˆä¸°å¯Œï¼š</p><p>0ã€åˆ†å±‚çš„ç›®çš„æ˜¯ï¼Œæ§åˆ¶éå†é¡ºåºï¼Œä½¿å¾— BFS çš„æœ€ä¼˜æ€§ä¹Ÿåœ¨å½“å‰é—®é¢˜ä¸­ä½“ç°ã€‚å³ä½¿å¾—å¯¹äºæ¯ä¸ªç‚¹ï¼Œæœ€å…ˆè¢«éå†æ—¶ä¸€å®šæ˜¯æœ€çŸ­è·¯ã€‚</p><p>1ã€é¦–å…ˆè¦å…ˆå¿½ç•¥è¾¹æƒè¿›è¡Œåˆ†å±‚ã€‚</p><p>2ã€å…¶æ¬¡è€ƒè™‘å¦‚æœå­˜åœ¨å¤šæ¡å‡ºè¾¹ï¼Œå¿…ç„¶æ˜¯èµ°æƒæœ€å°çš„é‚£æ¡è¾¹ã€‚</p><p>3ã€åªç¬¦åˆä¸Šé¢ä¸¤æ¡è¿˜æ˜¯ä¸å¯¹çš„ã€‚å› ä¸ºè€ƒè™‘å¦‚æœæŸä¸ªç‚¹ $t$ æœ‰ä¸¤æ¡å…¥è¾¹ $e_1,e_2$ æ»¡è¶³ $val(e_1)&lt;val(e_2)$ï¼Œä»–ä»¬åœ¨ BFS æ ‘ä¸Šçš„æ·±åº¦ç›¸åŒï¼Œé‚£ä¹ˆå¦‚æœå•çº¯æŒ‰ç‚¹æ¥è½¬ç§»ï¼Œå¯èƒ½ä¼šå‡ºç°å…ˆèµ° $e_2$ å†èµ° $e_1$ çš„æƒ…å†µï¼Œè€Œæ­¤æ—¶ $t$ å·²ç»è¢«æ›´æ–°å®Œæ¯•å°±ä¼šå¯¼è‡´å‡ºé”™ã€‚æ‰€ä»¥è¿˜è¦æŒ‰ç…§è¾¹æƒä» $0$ åˆ° $9$ è¿›è¡Œå†åˆ†å±‚ã€‚</p><p>å¯ä»¥çŸ¥é“è¿™æ ·åšæœ€åå¤æ‚åº¦ä¸€å®šä¸ä¼šè¶…è¿‡ $O(10\times m)$ ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">int ob ;</span><br><span class="line">int cnt ;</span><br><span class="line">int n, m ;</span><br><span class="line">int arr[M] ;</span><br><span class="line">int f[N] ;</span><br><span class="line">int g[N] ;</span><br><span class="line">int T ;</span><br><span class="line"> </span><br><span class="line">vector &lt;int&gt; q[N] ;</span><br><span class="line">vector &lt;int&gt; E[N][10] ;</span><br><span class="line"> </span><br><span class="line">int main()&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    int x, y, z ; cnt &#x3D; n ;</span><br><span class="line">    for (int i &#x3D; 1 ; i &lt;&#x3D; m ; ++ i)&#123;</span><br><span class="line">        x &#x3D; qr(), y &#x3D; qr() ; ob &#x3D; 0 ; z &#x3D; i ;</span><br><span class="line">        while (z) arr[++ ob] &#x3D; z % 10, z &#x2F;&#x3D; 10 ; z &#x3D; x ;</span><br><span class="line">        for (int j &#x3D; ob ; j &gt; 1 ; -- j)</span><br><span class="line">            E[x][arr[j]].push_back(++ cnt), x &#x3D; cnt ;</span><br><span class="line">        E[x][arr[1]].push_back(y) ;</span><br><span class="line">        for (int j &#x3D; ob ; j &gt; 1 ; -- j)</span><br><span class="line">            E[y][arr[j]].push_back(++ cnt), y &#x3D; cnt ;</span><br><span class="line">        E[y][arr[1]].push_back(z) ;</span><br><span class="line">    &#125;</span><br><span class="line">    g[1] &#x3D; T &#x3D; 1 ;</span><br><span class="line">    q[1].push_back(1) ;</span><br><span class="line">    for (int d &#x3D; 1 ; d &lt;&#x3D; T ; ++ d)&#123;</span><br><span class="line">&#x2F;&#x2F;        if (!q[d].size()) break ;</span><br><span class="line">        for (z &#x3D; 0 ; z &lt; 10 ; ++ z)&#123;</span><br><span class="line">            auto t &#x3D; q[d].begin() ;</span><br><span class="line">            while (t !&#x3D; q[d].end())&#123;</span><br><span class="line">                x &#x3D; *t ;</span><br><span class="line">                for (auto y : E[x][z])&#123;</span><br><span class="line">                    if (g[y]) continue ;</span><br><span class="line">                    f[y] &#x3D; (f[x] * 10ll + z) % P ;</span><br><span class="line">                    g[y] &#x3D; 1, q[T + 1].push_back(y) ;</span><br><span class="line">                &#125;</span><br><span class="line">                ++ t ;</span><br><span class="line">            &#125;</span><br><span class="line">            if (q[T + 1].size()) ++ T ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for (int i &#x3D; 2 ; i &lt;&#x3D; n ; ++ i)</span><br><span class="line">        printf(&quot;%d\n&quot;, f[i]) ; return 0 ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="G1-Into-Blocks-easy-version"><a href="#G1-Into-Blocks-easy-version" class="headerlink" title="[G1] Into Blocks (easy version)"></a>[G1] Into Blocks (easy version)</h1><p>æ„Ÿè§‰è¿™ä¸ª G1 è¿˜æ˜¯æ¯”è¾ƒ naive çš„ï¼Ÿ</p><blockquote><p>ç»™ä½  $n~q$ï¼Œ$n$è¡¨ç¤ºåºåˆ—é•¿åº¦ï¼Œ$q$è¡¨ç¤ºæ“ä½œæ¬¡æ•°ï¼Œåœ¨è¯¥é¢˜ä¸­ $q$ ç­‰äº 0 ã€‚</p><p>æˆ‘ä»¬éœ€è¦è¾¾æˆè¿™ä¹ˆä¸€ä¸ªç›®æ ‡çŠ¶æ€ï¼š</p><blockquote><p>å¦‚æœå­˜åœ¨ $x$ è¿™ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆå¿…é¡»æ»¡è¶³æ‰€æœ‰ $x$ å…ƒç´ éƒ½å¿…é¡»åœ¨åºåˆ—ä¸­è¿ç»­ã€‚</p></blockquote><p>å¯ä»¥è¿›è¡Œè¿™ä¹ˆä¸€ç§æ“ä½œï¼š</p><p>å°†æ‰€æœ‰çš„ $x$ å…ƒç´ çš„å˜ä¸ºä»»æ„ä½ æŒ‡å®šçš„ $y$ å…ƒç´ ï¼Œå¹¶ä¸”èŠ±è´¹ $cnt_x$ çš„èŠ±è´¹ï¼Œ$cnt_x$ä»£è¡¨ $x$ å…ƒç´ çš„ä¸ªæ•°ã€‚</p><p>æ±‚æœ€å°èŠ±è´¹ä½¿å¾—åºåˆ—æ»¡è¶³ç›®æ ‡çŠ¶æ€ã€‚</p></blockquote><p>å¤§æ¦‚åšé¢˜æ—¶æœ‰è¿™ä¹ˆå‡ ä¸ª Observationï¼Œå½“æ—¶æ‹¿ç¬”å†™äº†ä¸‹æ¥ï¼Œæ„Ÿè§‰åº”è¯¥æ˜¯æ¯”è¾ƒæ­£å¸¸æ€è·¯ï¼š</p><p>1ã€ç­”æ¡ˆä¸Šç•Œä¸€å®šæ˜¯ $n-\max \{col{\rm num}\}$ .</p><p>2ã€å¦‚æœä¸€ä¸ªé¢œè‰²å­˜åœ¨ä¸ç›¸é‚»ï¼Œé‚£ä¹ˆè¦ä¹ˆä¼šè¢«å…¨éƒ¨æ¶‚æˆåˆ«çš„é¢œè‰²ï¼Œè¦ä¹ˆä¼šè¢«ä¿ç•™ã€‚</p><p>3ã€æ ¹æ® $2$ ä¸éš¾å‘ç°ï¼Œä¸€æ®µäº¤é”™æ’å¸ƒçš„å…ƒç´ æœ€åå¿…ç„¶åªä¼šä¿ç•™ä¸€ç§é¢œè‰²ã€‚</p><p>4ã€æ ¹æ® $3$ å¯ä»¥å¾—åˆ°ä¸€ä¸ªè´ªå¿ƒï¼šå°†æ‰€æœ‰é¢œè‰²æŒ‰ç…§å‡ºç°æ¬¡æ•°ä»å¤§åˆ°å°æ’åºã€‚ä¸€å¼€å§‹é¢„å¤„ç†å‡ºæ‰€æœ‰é¢œè‰²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® $s_i$ å’Œæœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® $t_i$ï¼Œé‚£ä¹ˆä¸éš¾çœ‹å‡ºè¦æŠŠ $[s_i,t_i]$ ä¹‹é—´çš„å…ƒç´ éƒ½æ¶‚æˆå½“å‰é¢œè‰²ã€‚ä¸éš¾çŸ¥é“è¿™æ ·æ˜¯æœ€ä¼˜çš„ã€‚</p><p>ç„¶åå®ç°ä¸Šé‡ä¸Šäº†ä¸€ç‚¹å°é˜»ç¢ã€‚å¤§æ¦‚å°±æ˜¯è¯´éšç€ä¸åœåœ°æŸ“è‰²ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›åˆ«çš„é¢œè‰²è¢«æŸ“æˆå½“å‰é¢œè‰²ï¼Œè¿™æ ·å°±è¦åŠ¨æ€æ›´æ–°å½“å‰é¢œè‰²çš„ $s_i$ å’Œ $t_i$ ã€‚ç„¶åå°±å› ä¸ºè§‰å¾—è¿™ä¸ªä¸å¥½ç»´æŠ¤å°±æ‘¸äº†ä¸€ä¼šå„¿â€¦ç»“æœå‘ç°å…¶å®æ˜¯å¾ˆå¥½ç»´æŠ¤çš„ã€‚å…·ä½“æ¥è¯´ï¼Œä»å¤§åˆ°å°åšä¸€å®šå¯ä»¥è®©æ¯ä¸ªç‚¹è‡³å¤šè¢«æŸ“ä¸€æ¬¡è‰²ï¼Œå¤æ‚åº¦å¯ä»¥ä¿è¯ï¼›åŒæ—¶å‘ç° $[s_i,t_i]$ åˆ†åˆ«æ»¡è¶³å•è°ƒæ€§ï¼Œå°±å¯ä»¥æš´åŠ› <code>while</code> åšäº†ã€‚</p><p>æœ€åå¤æ‚åº¦æ˜¾ç„¶æ’åºå¤–çº¿æ€§ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> n, q ;</span><br><span class="line"><span class="keyword">int</span> buc[N] ;</span><br><span class="line"><span class="keyword">int</span> fst[N] ;</span><br><span class="line"><span class="keyword">int</span> lst[N] ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line">pint ord[N] ;</span><br><span class="line">vint pos[N] ;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> m_k make_pair</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(pint a, pint b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.fr == b.fr ? a.sc &lt; b.sc : a.fr &gt; b.fr ;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q ; <span class="keyword">int</span> x, y ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        base[i] = qr(), buc[base[i]] ++ ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        pos[base[i]].push_back(i) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (!fst[base[i]]) fst[base[i]] = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">        <span class="keyword">if</span> (!lst[base[i]]) lst[base[i]] = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">200000</span> ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (buc[i]) ord[++ cnt] = m_k(buc[i], i) ;</span><br><span class="line">    sort(ord + <span class="number">1</span>, ord + cnt + <span class="number">1</span>, comp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)&#123;</span><br><span class="line">        x = ord[i].fr ; y = ord[i].sc ;</span><br><span class="line">        <span class="keyword">if</span> (vis[y]) <span class="keyword">continue</span> ; vis[y] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">if</span> (x == lst[y] - fst[y] + <span class="number">1</span>) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">int</span> l = fst[y], r = lst[y] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p = fst[y] ; p &lt;= lst[y] ; ++ p)&#123;</span><br><span class="line"><span class="comment">//            printf("%d ", p) ;</span></span><br><span class="line">            <span class="keyword">if</span> (base[p] != y &amp;&amp; !vis[base[p]])&#123;</span><br><span class="line">                vis[base[p]] = <span class="number">1</span> ;</span><br><span class="line"><span class="comment">//                printf("%d ", base[p]) ;</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">auto</span> k : pos[base[p]])&#123;</span><br><span class="line">                    chkmin(l, k) ;</span><br><span class="line">                    chkmax(r, k) ;</span><br><span class="line">                    base[k] = y, ++ ans ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//            puts("") ;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        printf("%d %d\n", l, r) ;</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> tl, tr ;</span><br><span class="line"><span class="comment">//            printf("%d %d\n", l, r) ;</span></span><br><span class="line">            tl = fst[y], tr = lst[y] ;</span><br><span class="line">            <span class="keyword">if</span> (l == fst[y] &amp;&amp; r == lst[y]) <span class="keyword">break</span> ;</span><br><span class="line">            fst[y] = l, lst[y] = r ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> p = tl - <span class="number">1</span> ; p &gt;= l ; -- p)&#123;</span><br><span class="line"><span class="comment">//                printf("(%d %d %d)", p, base[p], vis[base[p]]) ;</span></span><br><span class="line">                <span class="keyword">if</span> (base[p] != y &amp;&amp; !vis[base[p]])&#123;</span><br><span class="line">                    vis[base[p]] = <span class="number">1</span> ;</span><br><span class="line"><span class="comment">//                    printf("%d ", base[p]) ;</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">auto</span> k : pos[base[p]])&#123;</span><br><span class="line">                        chkmin(l, k) ;</span><br><span class="line">                        chkmax(r, k) ;</span><br><span class="line">                        base[k] = y, ++ ans ;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"><span class="comment">//                puts("") ;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> p = tr + <span class="number">1</span> ; p &lt;= r ; ++ p)&#123;</span><br><span class="line">                <span class="keyword">if</span> (base[p] != y &amp;&amp; !vis[base[p]])&#123;</span><br><span class="line">                    vis[base[p]] = <span class="number">1</span> ;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">auto</span> k : pos[base[p]])&#123;</span><br><span class="line">                        chkmin(l, k) ;</span><br><span class="line">                        chkmax(r, k) ;</span><br><span class="line">                        base[k] = y, ++ ans ;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        debug(base, 1, n) ;</span></span><br><span class="line"><span class="comment">//        printf("%d %d %d %d %d\n", x, y, fst[y], lst[y], ans) ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠŠæœ€åä¸€ä¸ª for é‡Œ if çš„ <code>y</code> å†™æˆäº† <code>x</code> å¯¼è‡´ <code>Wa On 7</code> å‘œå‘œå‘œã€‚</p><h1 id="G2-Into-Blocks-hard-version"><a href="#G2-Into-Blocks-hard-version" class="headerlink" title="[G2] Into Blocks (hard version)"></a>[G2] Into Blocks (hard version)</h1><blockquote><p>$q=3\times 10^5$ ã€‚</p></blockquote><p>è¿™é¢˜æ˜¯çœŸçš„ğŸ‚ğŸºï¼æ˜¯ååˆ†æœ‰è¶£ã€ååˆ†å¼ºçš„é¢˜ç›®ï¼</p><p>ä½†æ˜¯ç±»ä¼¼å¥—è·¯å¹¶ä¸æ˜¯æ²¡æœ‰è§è¿‡ã€‚æ›¾ç»å†™è¿‡ä¸€ç¯‡åšå®¢æ€»ç»“äº†ä¸€ä¸‹ã€Œå…”é˜Ÿçº¿æ®µæ ‘ã€ï¼Œè¿™é¢˜å¤§æ¦‚æ˜¯éœ€è¦ç”¨åˆ°é‚£é‡Œé¢ T1 çš„ç±»ä¼¼ trickã€‚</p><p>å¤§æ¦‚é¦–å…ˆæ˜¯è¦å¯¹ä¸Šé¢é‚£ä¸ª easy version çš„ä¸€äº›ç»“è®ºè¿›è¡Œå½¢å¼åŒ–çš„æç‚¼å’Œæ€»ç»“ã€‚è€ƒè™‘ç­”æ¡ˆçš„æœ¬è´¨ã€‚è€ƒè™‘æŠŠä¸€ä¸ªé¢œè‰² $c$ çš„å‡ºç°åŒºé—´åŒ–æˆå·¦å¼€å³é—­çš„å½¢å¼ $[s_c,t_c)$ï¼Œæ„æ€æ˜¯å¯¹äºåŒºé—´ä¸­çš„æ¯ä¸ª $i$ ï¼Œè¦æŠŠ $i,i+1$ æ¶‚æˆä¸€ä¸ªé¢œè‰²ã€‚é‚£ä¹ˆå¯ä»¥å‘ç°å¦‚æœå¯¹æ‰€æœ‰ $c$ çš„è¯¥åŒºé—´è¿›è¡ŒåŒºé—´ $+1$ ï¼Œé‚£ä¹ˆæœ€åå¯ä»¥ä¿ç•™çš„é¢œè‰²æ•°å°±æ˜¯ç›¸é‚»ä¸¤ä¸ª $0$ ä¹‹é—´å‡ºç°æœ€å¤šçš„é¢œè‰²çš„æ•°é‡å’Œã€‚æ­£ç¡®æ€§æ˜¾ç„¶ã€‚â€¦ä½†è¿™ä¸ªè½¬åŒ–ç¡®å®ååˆ†ç¥å¥‡ã€‚</p><p>è€ƒè™‘ç”¨çº¿æ®µæ ‘å¿«é€Ÿç»´æŠ¤è¿™ä¸ªä¸œè¥¿ã€‚è€ƒè™‘éœ€è¦ç»´æŠ¤ä»€ä¹ˆä¿¡æ¯ï¼š</p><p>1ã€éœ€è¦ç»´æŠ¤åˆ†ç•Œç‚¹ã€‚å³åŒºé—´ä¸­è¢«è¦†ç›–æ¬¡æ•°ä¸º $0$ çš„ç‚¹ã€‚</p><p>2ã€éœ€è¦ç»´æŠ¤é¢œè‰²æ•°ã€‚å³åŒºé—´ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„é¢œè‰²ã€‚</p><p>3ã€ä½†æ˜¯ $2$ ä¸­æœ‰è¦æ±‚ï¼Œè¦æ±‚å¿…é¡»æ˜¯è¿ç»­æ®µä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„é¢œè‰²ã€‚è€Œè¿™ä¸ªè¿ç»­æ®µçš„ã€Œè¿ç»­ã€å¯¹åº”äºä¸€æ®µè¿ç»­çš„ã€è¦†ç›–æ¬¡æ•° $&gt;0$ çš„æ®µã€‚</p><p>4ã€æ³¨æ„åˆ°è¦ç»´æŠ¤åŒºé—´ä¸­å‡ºç°æ¬¡æ•°çš„æœ€å¤§å€¼ï¼Œè¿˜è¦æ±‚è¿ç»­ä¸”åªæœ‰å…¨å±€è¯¢é—®çš„è¯ï¼Œæœ‰ä¸ªå°æŠ€å·§ã€‚è€ƒè™‘è®©é¢œè‰² $c$ çš„å‡ºç°æ¬¡æ•° $e(c)$ æ”¾åˆ° $s_c$ å¤„ç»´æŠ¤ï¼Œè®°ä½œ $w_{s_c}$ï¼Œè¿™æ ·å°±åªéœ€è¦ç»´æŠ¤ä¸€ä¸ª $\max \{w_i,w_{i+1}\}$ çŠ¶ç‰©ã€‚</p><p>å‘ç°éš¾ä»¥ç»´æŠ¤åˆ†ç•Œç‚¹ï¼Ÿä½†æ˜¯è€ƒè™‘åˆ°<strong>åªæœ‰å…¨å±€è¯¢é—®</strong>ï¼Œäºæ˜¯å¯ä»¥å€Ÿé‰´å…”é˜Ÿçº¿æ®µæ ‘é‡Œé‚£ä¸ªç±»ä¼¼çš„æ€æƒ³ã€‚å…·ä½“æ¥è¯´ï¼Œå‘ç°å¯¹äºçº¿æ®µæ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œæœ‰æ•ˆä¿¡æ¯æ˜¯åŒºé—´ $[1,n]$ ï¼Œè€Œ $n$ è¿™ä¸ªç‚¹å¿…ç„¶ä¸ä¼šè¢«ä»»ä½•ä¸€ä¸ªçº¿æ®µè¦†ç›–ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœç»Ÿè®¡å…¨å±€ä¿¡æ¯ï¼Œé‚£ä¹ˆå¿…ç„¶ä¼šå­˜åœ¨ $n$ ä¸º $0$ã€‚é‚£ä¹ˆå°±å¥½åŠäº†ï¼Œè€ƒè™‘ç”¨ç»´æŠ¤ã€ŒåŒºé—´æœ€å°å€¼ã€æ¥ä»£æ›¿ç»´æŠ¤ã€ŒåŒºé—´åˆ†ç•Œç‚¹ã€ã€‚</p><p>å…·ä½“ç»†èŠ‚æ–¹é¢ï¼Œè€ƒè™‘ç»´æŠ¤åŒºé—´ä¸­æ¯æ®µé‡Œé¢œè‰²å‡ºç°æ¬¡æ•°æœ€å¤§å€¼ ${\rm seg}_x$ï¼Œå·¦/å³ç«¯ç‚¹æ‰€åœ¨è¿ç»­åŒºé—´çš„æœ€å¤§å€¼ $\mathrm{lmax}_x,\mathrm{rmax}_x$ ã€‚è½¬ç§»æ—¶è€ƒè™‘ä¸¤ä¸ªåŒºé—´çš„ $\min v$ çš„å…³ç³»ï¼Œå…¶ä¸­ $v$ æ˜¯è¦†ç›–æ¬¡æ•°ã€‚</p><p>ç„¶åè€ƒè™‘ä¿®æ”¹æ“ä½œï¼Œå‘ç°å°±æ˜¯ä¸€ä¸ªåŒºé—´åŠ å†åŠ ä¸€ä¸ªå•ç‚¹ç»´æŠ¤ã€‚æ³¨æ„å½“ $l=r$ æ—¶ï¼Œæœ‰äº›é‡ä¸æ˜¯è‰¯å®šä¹‰ï¼Œå½“ä½œä¸çŸ¥é“å°±å¥½äº†ï¼ˆèµ‹å€¼ä¸º $0$ï¼‰ ã€‚</p><p>æ³¨æ„åˆ°é¢œè‰²çš„ä¿®æ”¹å¯ä»¥å†å•ç‹¬æ‹¿ä¸€ä¸ª set æ¥ç»´æŠ¤ã€‚æœ€ç»ˆå¤æ‚åº¦ $O(n\log n)$ ã€‚</p><p>ç„¶åå…·ä½“ä¸ºä»€ä¹ˆèƒ½æ¯” xyx çš„åšæ³•å°‘æ‰ä¸€ä¸ª logï¼Œä¸ªäººè®¤ä¸ºæ˜¯å……åˆ†åˆ©ç”¨äº†ã€åªæœ‰å…¨å±€è¯¢é—®ã€è¿™ä¸ªæ€§è´¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200005</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _be begin</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _en rbegin</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> era erase</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ins insert</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> &lt;<span class="keyword">int</span>&gt; col[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> seg[N * <span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">int</span> mnv[N * <span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">int</span> mxt[N * <span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">int</span> tag[N * <span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">int</span> lcon[N * <span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">int</span> rcon[N * <span class="number">3</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (rt &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc (rt &lt;&lt; 1 | 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _down(<span class="keyword">int</span> rt)&#123;</span><br><span class="line">    <span class="keyword">if</span> (tag[rt])&#123;</span><br><span class="line">        mnv[lc] += tag[rt] ;</span><br><span class="line">        mnv[rc] += tag[rt] ;</span><br><span class="line">        tag[lc] += tag[rt] ;</span><br><span class="line">        tag[rc] += tag[rt] ;</span><br><span class="line">        tag[rt] = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _up(<span class="keyword">int</span> rt)&#123;</span><br><span class="line">    <span class="keyword">int</span> ls = rt &lt;&lt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">int</span> rs = rt &lt;&lt; <span class="number">1</span> | <span class="number">1</span> ;</span><br><span class="line">    mxt[rt] = max(mxt[ls], mxt[rs]) ;</span><br><span class="line">    mnv[rt] = min(mnv[ls], mnv[rs]) ;</span><br><span class="line">    <span class="keyword">if</span> (mnv[ls] &lt; mnv[rs])&#123;</span><br><span class="line">        seg[rt] = seg[ls] ;</span><br><span class="line">        lcon[rt] = lcon[ls] ;</span><br><span class="line">        rcon[rt] = max(mxt[rs], rcon[ls]) ;</span><br><span class="line">        <span class="comment">//æ­¤å¤„ç”±äºæœ€åè¦è¦†ç›–ï¼Œæ‰€ä»¥ max_Time(rc) æœ¬è´¨ä¸Šå°±æ˜¯åŒ…å«å³ç«¯ç‚¹çš„å€¼ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (mnv[ls] &gt; mnv[rs])&#123;</span><br><span class="line">        seg[rt] = seg[rs] ;</span><br><span class="line">        rcon[rt] = rcon[rs] ;</span><br><span class="line">        lcon[rt] = max(mxt[ls], lcon[rs]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        lcon[rt] = lcon[ls] ; rcon[rt] = rcon[rs] ;</span><br><span class="line">        seg[rt] = seg[ls] + seg[rs] + max(lcon[rs], rcon[ls]) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ul, <span class="keyword">int</span> ur, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ul &gt; ur) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= l &amp;&amp; r &lt;= ur)</span><br><span class="line">        <span class="keyword">return</span> mnv[rt] += v, <span class="keyword">void</span>(tag[rt] += v) ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt) ;</span><br><span class="line">    <span class="keyword">if</span> (ul &lt;= mid) upd(lc, l, mid, ul, ur, v) ;</span><br><span class="line">    <span class="keyword">if</span> (ur &gt; mid)  upd(rc, mid + <span class="number">1</span>, r, ul, ur, v) ;</span><br><span class="line">    _up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cov</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>(mxt[rt] = lcon[rt] = v) ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt) ;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid) cov(lc, l, mid, p, v) ;</span><br><span class="line">    <span class="keyword">else</span> cov(rc, mid + <span class="number">1</span>, r, p, v) ; _up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n, q ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mdf</span><span class="params">(<span class="keyword">int</span> c, <span class="keyword">int</span> mk)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> w ;</span><br><span class="line">    <span class="keyword">if</span> (!(w = col[c].size())) <span class="keyword">return</span> ;</span><br><span class="line"><span class="comment">//printf("%d %d %d %d %d\n", c, mk, *col[c]._be(), *-- col[c]._en(), (int)col[c].size()) ;</span></span><br><span class="line">    cov(<span class="number">1</span>, <span class="number">1</span>, n, *col[c]._be(), mk &gt; <span class="number">0</span> ? w : <span class="number">0</span>) ;</span><br><span class="line">    upd(<span class="number">1</span>, <span class="number">1</span>, n, *col[c]._be(), *col[c]._en() - <span class="number">1</span>, mk) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">val_it</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> n - seg[<span class="number">1</span>] - lcon[<span class="number">1</span>] - rcon[<span class="number">1</span>] ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x, y, z ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;q) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]), col[base[i]].ins(i) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        mdf(i, <span class="number">1</span>) ; <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, val_it()) ;</span><br><span class="line">    <span class="keyword">while</span> (q --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y) ; z = base[x] ;</span><br><span class="line">        mdf(z, <span class="number">-1</span>) ; col[z].era(x) ; mdf(z, <span class="number">1</span>) ;</span><br><span class="line">        mdf(y, <span class="number">-1</span>) ; col[y].ins(x) ; mdf(y, <span class="number">1</span>) ;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, val_it()) ; base[x] = y ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸å¾—ä¸è¯´ï¼Œè¿™åœºæ˜¯çœŸçš„çœŸçš„è‰¯å¿ƒï¼é¦–å…ˆçŸ¥è¯†ç‚¹è¦†ç›–å…¨é¢ï¼Œå„ç§é¢˜ç›®ä¹Ÿéƒ½æ¯”è¾ƒå¯Œæœ‰æ€ç»´å«é‡ï¼Œå¤§æ¦‚æ˜¯æˆ‘æ‰“è¿‡çš„ Combined åœºé‡Œé¢è´¨é‡æœ€é«˜çš„ä¸€åœºã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°± vp äº†ä¸€æ•´åœºï¼Œæœ€åçš„æˆ˜ç»©å¤§æ¦‚è¿˜ä¸é”™ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸€å…±æœ‰ $9$ é“é¢˜ç›®ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="Codeforces" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/Codeforces/"/>
    
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/çŠ¶å‹DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E7%8A%B6%E5%8E%8BDP/"/>
    
      <category term="å¥½å¤šå¥½å¤šç»†èŠ‚" scheme="https://www.orchidany.cn/tags/%E5%A5%BD%E5%A4%9A%E5%A5%BD%E5%A4%9A%E7%BB%86%E8%8A%82/"/>
    
      <category term="æ•°æ®ç»“æ„/çº¿æ®µæ ‘" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
      <category term="å›¾è®º/æ™®é€šå»ºå›¾æŠ€å·§" scheme="https://www.orchidany.cn/tags/%E5%9B%BE%E8%AE%BA-%E6%99%AE%E9%80%9A%E5%BB%BA%E5%9B%BE%E6%8A%80%E5%B7%A7/"/>
    
      <category term="æš´åŠ›,brute-force" scheme="https://www.orchidany.cn/tags/%E6%9A%B4%E5%8A%9B-brute-force/"/>
    
      <category term="å›¾è®º/å¹¶æŸ¥é›†" scheme="https://www.orchidany.cn/tags/%E5%9B%BE%E8%AE%BA-%E5%B9%B6%E6%9F%A5%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘[æ´›è°· P5654] åŸºç¡€å‡½æ•°ç»ƒä¹ é¢˜</title>
    <link href="https://www.orchidany.cn/2020/06/14/%E6%B4%9B%E8%B0%B7P5654%E5%9F%BA%E7%A1%80%E5%87%BD%E6%95%B0%E7%BB%83%E4%B9%A0%E9%A2%98/"/>
    <id>https://www.orchidany.cn/2020/06/14/æ´›è°·P5654åŸºç¡€å‡½æ•°ç»ƒä¹ é¢˜/</id>
    <published>2020-06-14T10:50:03.000Z</published>
    <updated>2020-06-16T13:13:20.089Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ¯”è¾ƒæœ‰è¶£çš„é¢˜ç›®ã€‚å­¦åˆ°è®¸å¤šã€‚</p><blockquote><p>YSGH æœ‰ä¸€ä¸ª $1 \sim n$ çš„æ’åˆ— $p$ å’Œä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•´æ•°åºåˆ— $w$ã€‚<br>å®šä¹‰ï¼š</p><script type="math/tex; mode=display">F(l, r) = \begin{cases} \max(F(l, m - 1), F(m + 1, r)) + w_m & , l \le r \\ 0 & , l > r \end{cases}</script><p>å…¶ä¸­ $m$ ä¸º $p$ çš„åŒºé—´ $[l, r]$ çš„æœ€å¤§å€¼çš„ä¸‹æ ‡ã€‚</p><p>$q$ æ¬¡è¯¢é—® $F(l, r)$ çš„å€¼ã€‚</p><p>$1\leq n,q \leq 5\times 10^5$ ã€‚ </p></blockquote><a id="more"></a><p>å¤§æ¦‚æ˜¯æ¯”è¾ƒç¥çš„é¢˜ï¼Ÿé¦–å…ˆå¦‚æœè€ƒè™‘æ˜¯ $F(1,n)$ï¼Œé‚£ä¹ˆè½¬ç§»å°±æ˜¯ä¸€ä¸ªç¬›å¡å°”æ ‘çš„å½¢å¼ã€‚ç„¶åå¦‚æœæ”¾åˆ°åŒºé—´é‡Œæ¥ï¼Œå¯ä»¥å‘ç°å¯èƒ½ä¼šå­˜åœ¨ä» $l$ã€$r$ åˆ°æ ¹çš„é“¾è¢«ä¿®æ”¹ï¼Œä¸­é—´çš„é“¾ä¸ä¼šè¢«æ”¹å˜ã€‚</p><p>è€Œè¿™ä¸ªè¢«ä¿®æ”¹æˆçš„æ¨¡æ ·å¤§æ¦‚æ˜¯è¦ç¨å¾®æ‰¾ä¸€ä¸‹æ€§è´¨ã€‚å¯ä»¥å‘ç°å¯¹äº $l$ è€Œè¨€ï¼Œé¦–å…ˆä»–çš„å·¦å­æ ‘ä¼šè¢«ç æ‰ï¼Œå…¶æ¬¡è€ƒè™‘å¯¹ç¬›å¡å°”æ ‘çš„çˆ¶å­å…³ç³»åˆ†ç±»ï¼Œç§° ${\rm Lson}(x)=y$ çš„çˆ¶å­å…³ç³» $(y,x)$ ï¼Œå…¶ä¸­ $x$ æ˜¯ $y$ çš„å³è¡Œçˆ¶äº²ï¼Œ${\rm Rson}(x)=y$ çš„åˆ™ä¸ºå·¦è¡Œçˆ¶äº²ã€‚é‚£ä¹ˆä¸éš¾çœ‹å‡ºï¼Œå¯¹äº $l\to root$ è¿™æ¡é“¾ä¸Šï¼Œä»»ä½•ä¸€ä¸ªé”®å€¼(ä¸‹æ ‡)æ¯” $l$ å°çš„éƒ½éœ€è¦è¢«åˆ æ‰ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰å³è¡Œçˆ¶äº²éƒ½è¦è¢«åˆ æ‰ï¼›åŒç†å¯¹äº $r\to root$ è¿™æ¡è„¸ä¸Šï¼Œæ‰€æœ‰å·¦è¡Œçˆ¶äº²éœ€è¦è¢«åˆ æ‰ã€‚</p><p>å‘ç°è¯¢é—®å¯ä»¥ç¦»çº¿ï¼Œäºæ˜¯è€ƒè™‘æ‹†æˆä¸¤åŠåšã€‚è¿™ä¸ªåœ°æ–¹éœ€è¦ä¸€ä¸ªç¥å¥‡çš„ Observationã€‚è§‚å¯Ÿ $F$ åœ¨ç¬›å¡å°”æ ‘ä¸Šçš„å±•å¼€å¼ï¼š</p><script type="math/tex; mode=display">\begin{aligned}F(l, r)& = \max\{F(l, m - 1), F(m + 1, r)\} + w_m \\\\&= \max\{\max \{~F(l, m_1), F(m_1+1,m - 1)~\} + w_{m_1}, \max \{~F(m+1, m_2), F(m_2+1,r)~\} +w_{m_2} \} + w_m\\& \cdots\end{aligned}</script><p>ä¸éš¾å‘ç° $m_k$ åªä¼šä¸å¯¹åº”èŠ‚ç‚¹æœ‰å…³ï¼ŒåŒæ—¶ $\max$ æœ‰ç»“åˆå¾‹ï¼Œæ•´ä¸ªå¼å­éƒ½è¢« $\max$ åŒ…ä½äº†ï¼Œäºæ˜¯å°±å¯ä»¥ç›´æ¥å€å¢ã€‚</p><p>å…·ä½“çš„ï¼Œè€ƒè™‘è®¾ $g_{x,k}$ è¡¨ç¤º $x$ çš„ $2^{k-1}$ ç¥–å…ˆçš„<strong>å†…å‘å­æ ‘</strong>çš„è´¡çŒ®å’Œï¼Œ$f_{x,k}$ è¡¨ç¤ºä» $x$ åˆ° $x$ çš„ $2^{k-1}$ ç¥–å…ˆçš„ç‚¹æƒå’Œï¼Œ$fa_{x,k}$ è¡¨ç¤ºå¯¹ä¸€ä¸ªå›ºå®šçš„æ–¹å‘ï¼Œå³ä¸è€ƒè™‘ã€Œå·¦è¡Œã€æˆ–è€…ã€Œå³è¡Œã€çˆ¶äº²æ—¶çš„çˆ¶äº²ã€‚é‚£ä¹ˆé¢„å¤„ç†æ—¶ $f_{x,k}$ è¾ƒå®¹æ˜“ç»´æŠ¤ï¼Œè€ƒè™‘ $g_{x,k}$ ï¼Œå‘ç°å€å¢æ˜¯éœ€è¦è€ƒè™‘åˆ†æˆä¸¤ä¸ª $2^{k-1}$ è§„æ¨¡çš„å­é—®é¢˜å»è®¡ç®—ï¼Œä¹Ÿå°±æ˜¯æ­¤æ—¶éœ€è¦åˆ†åˆ«è®¡ç®— $2^{k-1}$ çº§ç¥–å…ˆä¸Šé¢çš„å’Œä¸‹é¢çš„è´¡çŒ®ï¼Œæ‹¼ä¸€ä¸‹çš„è¯æ¯”è¾ƒç›´è§‚ã€‚</p><p>ç„¶åå°±å¯ä»¥è€ƒè™‘å¦‚ä½•è®¡ç®—ç­”æ¡ˆã€‚å‘ç°ç”±äºä¸Šæ–‡æåˆ°è¿‡çš„ç»“åˆå¾‹ï¼Œå¯ä»¥å‘ç°åªéœ€è¦æ¯”è¾ƒé“¾ä¸Šçš„ç­”æ¡ˆå’Œå­æ ‘å†…çš„ç­”æ¡ˆçš„ $\max$ å°±å¥½äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500005</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ll I = <span class="number">1l</span>l &lt;&lt; <span class="number">50</span> ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">rd</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> r = <span class="number">0</span>, f = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &gt; <span class="string">'9'</span> || c &lt; <span class="string">'0'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>) f = <span class="number">-1</span> ; c = getchar() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &lt;= <span class="string">'9'</span> &amp;&amp; c &gt;= <span class="string">'0'</span>)&#123;</span><br><span class="line">        r = (r &lt;&lt; <span class="number">1</span>) + (r &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r * f ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> q ;</span><br><span class="line"><span class="keyword">int</span> rt ;</span><br><span class="line"><span class="keyword">int</span> tp ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p[N] ;</span><br><span class="line"><span class="keyword">int</span> w[N] ;</span><br><span class="line"><span class="keyword">int</span> ql[N] ;</span><br><span class="line"><span class="keyword">int</span> qr[N] ;</span><br><span class="line"><span class="keyword">int</span> qlca[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> lc[N] ;</span><br><span class="line"><span class="keyword">int</span> rc[N] ;</span><br><span class="line"><span class="keyword">int</span> dep[N] ;</span><br><span class="line"><span class="keyword">int</span> stk[N] ;</span><br><span class="line"></span><br><span class="line">ll ans[N] ;</span><br><span class="line">ll sum[N] ;</span><br><span class="line">ll f[N][<span class="number">19</span>] ;</span><br><span class="line">ll g[N][<span class="number">19</span>] ;</span><br><span class="line"><span class="keyword">int</span> fa[N][<span class="number">19</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    dep[x] = dep[fa[x][<span class="number">0</span>]] + <span class="number">1</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; <span class="number">19</span> ; ++ i)&#123;</span><br><span class="line"><span class="keyword">if</span> (!fa[x][i - <span class="number">1</span>]) <span class="keyword">break</span> ;</span><br><span class="line">fa[x][i] = fa[fa[x][i - <span class="number">1</span>]][i - <span class="number">1</span>] ;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">if</span> (lc[x]) dfs(lc[x]) ;</span><br><span class="line">    <span class="keyword">if</span> (rc[x]) dfs(rc[x]) ;</span><br><span class="line">    sum[x] = max(sum[lc[x]], sum[rc[x]]) + w[x] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> d = dep[x] - dep[y] ;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &lt; dep[y])</span><br><span class="line">        swap(x, y), d = -d ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; d ; ++ i, d &gt;&gt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> (d &amp; <span class="number">1</span>) x = fa[x][i] ;</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> x ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">18</span> ; ~ i ; -- i)</span><br><span class="line">        <span class="keyword">if</span> (fa[x][i] != fa[y][i])</span><br><span class="line">            x = fa[x][i], y = fa[y][i] ;</span><br><span class="line">    <span class="keyword">return</span> fa[x][<span class="number">0</span>] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_do</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> o ;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> p = lc[x] ;</span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">int</span> q = rc[x] ;</span><br><span class="line">    f[x][<span class="number">0</span>] = g[x][<span class="number">0</span>] = w[x] ;</span><br><span class="line">    g[x][<span class="number">0</span>] += v ? sum[p] : sum[q] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j ; i &lt; <span class="number">19</span> ; ++ i)&#123;</span><br><span class="line">        j = i - <span class="number">1</span> ;</span><br><span class="line">        o = fa[x][j] ;</span><br><span class="line">        fa[x][i] = fa[o][j] ;</span><br><span class="line">        <span class="keyword">if</span> (!fa[x][i]) <span class="keyword">break</span> ;</span><br><span class="line">        f[x][i] = f[x][j] + f[o][j] ;</span><br><span class="line">        g[x][i] = max(g[o][j], g[x][j] + f[o][j]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (lc[x]) fa[lc[x]][<span class="number">0</span>] = v ? fa[x][<span class="number">0</span>] : x ;</span><br><span class="line">    <span class="keyword">if</span> (rc[x]) fa[rc[x]][<span class="number">0</span>] = v ? x : fa[x][<span class="number">0</span>] ;</span><br><span class="line">    <span class="keyword">if</span> (lc[x]) do_do(lc[x], v) ;</span><br><span class="line">    <span class="keyword">if</span> (rc[x]) do_do(rc[x], v) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">register</span> ll ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">18</span> ; ~ i ; -- i)</span><br><span class="line">        <span class="keyword">if</span> (dep[fa[x][i]] &gt;= dep[y])</span><br><span class="line">            ret = max(ret + f[x][i], g[x][i]), x = fa[x][i] ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    n = rd() ; q = rd() ;</span><br><span class="line">    p[stk[tp = <span class="number">1</span>] = <span class="number">0</span>] = n + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) p[i] = rd() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) w[i] = rd() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (tp &amp;&amp; p[stk[tp]] &lt; p[i]) -- tp ;</span><br><span class="line">        fa[i][<span class="number">0</span>] = stk[tp] ; <span class="keyword">int</span> z = rc[stk[tp]] ;</span><br><span class="line">        fa[z][<span class="number">0</span>] = i ; lc[i] = z ; rc[fa[i][<span class="number">0</span>]] = i ;</span><br><span class="line">        stk[++ tp] = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(rt = lc[<span class="number">0</span>] + rc[<span class="number">0</span>]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)&#123;</span><br><span class="line">        ql[i] = rd() ; qr[i] = rd() ;</span><br><span class="line">        qlca[i] = lca(ql[i], qr[i]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(fa, <span class="number">0</span>, <span class="keyword">sizeof</span> fa) ; do_do(rt, <span class="number">0</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)</span><br><span class="line">        ans[i] = w[qlca[i]] + solve(ql[i], qlca[i]) ;</span><br><span class="line">    <span class="built_in">memset</span>(fa, <span class="number">0</span>, <span class="keyword">sizeof</span> fa) ; do_do(rt, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)</span><br><span class="line">        ans[i] = max(ans[i], w[qlca[i]] + solve(qr[i], qlca[i])) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¯”è¾ƒæœ‰è¶£çš„é¢˜ç›®ã€‚å­¦åˆ°è®¸å¤šã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;YSGH æœ‰ä¸€ä¸ª $1 \sim n$ çš„æ’åˆ— $p$ å’Œä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•´æ•°åºåˆ— $w$ã€‚&lt;br&gt;å®šä¹‰ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
F(l, r) = \begin{cases} \max(F(l, m - 1), F(m + 1, r)) + w_m &amp; , l \le r \\ 0 &amp; , l &gt; r \end{cases}&lt;/script&gt;&lt;p&gt;å…¶ä¸­ $m$ ä¸º $p$ çš„åŒºé—´ $[l, r]$ çš„æœ€å¤§å€¼çš„ä¸‹æ ‡ã€‚&lt;/p&gt;
&lt;p&gt;$q$ æ¬¡è¯¢é—® $F(l, r)$ çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;$1\leq n,q \leq 5\times 10^5$ ã€‚ &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="Luogu" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/Luogu/"/>
    
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="å¥½å¤šå¥½å¤šç»†èŠ‚" scheme="https://www.orchidany.cn/tags/%E5%A5%BD%E5%A4%9A%E5%A5%BD%E5%A4%9A%E7%BB%86%E8%8A%82/"/>
    
      <category term="æŠ€å·§/å€å¢" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E5%80%8D%E5%A2%9E/"/>
    
      <category term="æ•°æ®ç»“æ„/ç¬›å¡å°”æ ‘" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°&amp;é¢˜è§£ã€‘ä»ç¬›å¡å°”æ ‘åˆ°[SPOJ 3734] Periodni</title>
    <link href="https://www.orchidany.cn/2020/06/14/%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-and-SPOJ-Periodni/"/>
    <id>https://www.orchidany.cn/2020/06/14/ç¬›å¡å°”æ ‘å­¦ä¹ ç¬”è®°-and-SPOJ-Periodni/</id>
    <published>2020-06-14T10:49:37.000Z</published>
    <updated>2020-06-19T12:18:16.359Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç¬›å¡å°”æ ‘çš„æ€§è´¨æ¯”è¾ƒå•ä¸€ï¼Œä½†æ˜¯åº”ç”¨èµ·æ¥ä¹Ÿæ˜¯å¾ˆæœ‰è¶£çš„ã€‚</p><a id="more"></a><h1 id="ç¬›å¡å°”æ ‘å­¦ä¹ ç¬”è®°"><a href="#ç¬›å¡å°”æ ‘å­¦ä¹ ç¬”è®°" class="headerlink" title="ç¬›å¡å°”æ ‘å­¦ä¹ ç¬”è®°"></a>ç¬›å¡å°”æ ‘å­¦ä¹ ç¬”è®°</h1><p>å¤§æ¦‚å°±æ˜¯ç±»ä¼¼ treap çš„ä¸€ä¸ªä¸œè¥¿ã€‚é¦–å…ˆç¬›å¡å°”æ ‘æ˜¯äºŒå‰æœç´¢æ ‘ï¼Œå³ $lc,root,rc$ çš„é”®å€¼æ»¡è¶³å•è°ƒçš„ååºå…³ç³»ã€‚å…¶æ¬¡ç¬›å¡å°”æ ‘æ¯ä¸ªèŠ‚ç‚¹ä¹Ÿæœ‰ä¸€ä¸ªæƒå€¼ï¼Œè¿™ä¸ªæƒå€¼æ»¡è¶³å †æ€§è´¨ã€‚</p><p>ç„¶ååœ¨ä¿è¯äº†é”®å€¼å•è°ƒæ—¶ï¼Œå¯ä»¥ $O(n)$ å»ºæ ‘ï¼Œæ–¹å¼æ˜¯ç»´æŠ¤æœ€å³é“¾ã€‚å‡è®¾é”®å€¼å•è°ƒé€’å¢ï¼Œé‚£ä¹ˆè€ƒè™‘æ¯æ¬¡åŠ å…¥ä¸€ä¸ªæ–°èŠ‚ç‚¹ $x$ï¼Œè¦æŠŠæ ˆé‡Œé¢æ‰€æœ‰ $val_y&gt;val_x$ çš„ç‚¹éƒ½å¼¹å‡ºï¼Œç„¶åæŠŠå½“å‰æ ˆé¡¶å…ƒç´  $z$ çš„å³å„¿å­è®¾ç½®ä¸º $x$ ï¼Œ$x$ çš„å·¦å„¿å­è®¾ç½®ä¸ºåŸæ¥ $z$ çš„å³å„¿å­ã€‚</p><p>ä»¥ä¸‹æ˜¯æ´›è°· P5854 ç¬›å¡å°”æ ‘ã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæˆ‘å†™ç¬›å¡å°”æ ‘å¾ˆå®¹æ˜“å¿˜äº†æœ€åå…¥æ ˆ233</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) ;</span><br><span class="line">    stk[tp = <span class="number">1</span>] = <span class="number">0</span> ; base[<span class="number">0</span>] = -I ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) base[i] = qr() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (tp &amp;&amp; base[stk[tp]] &gt; base[i]) -- tp ;</span><br><span class="line">        fa[i] = stk[tp] ; <span class="keyword">int</span> x = rc[fa[i]] ;</span><br><span class="line">        fa[x] = i, lc[i] = x, rc[fa[i]] = i ;</span><br><span class="line"><span class="comment">//        for (int j = 1 ; j &lt;= n ; ++ j)</span></span><br><span class="line"><span class="comment">//            printf("%d %d\n", lc[j], rc[j]) ;</span></span><br><span class="line"><span class="comment">//        printf("%d\n", x) ;</span></span><br><span class="line"><span class="comment">//        puts("- - - - - - - - - - - - - -") ;</span></span><br><span class="line">        stk[++ tp] = i ;<span class="comment">//!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        ans1 ^= (<span class="number">1l</span>l * (lc[i] + <span class="number">1</span>) * i) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        ans2 ^= (<span class="number">1l</span>l * (rc[i] + <span class="number">1</span>) * i) ;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld %lld\n"</span>, ans1, ans2) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="SPOJ-3734-Periodni"><a href="#SPOJ-3734-Periodni" class="headerlink" title="[SPOJ 3734] Periodni"></a>[SPOJ 3734] Periodni</h1><blockquote><p>ç»™å®šä¸€ä¸ª $n$ åˆ—çš„è¡¨æ ¼ï¼Œæ¯åˆ—çš„é«˜åº¦å„ä¸ç›¸åŒï¼Œä½†åº•éƒ¨å¯¹é½ï¼Œç„¶åå‘è¡¨æ ¼ä¸­å¡«å…¥ $k$ ä¸ªç›¸åŒçš„æ•°ï¼Œå¡«å†™æ—¶è¦æ±‚ä¸èƒ½æœ‰ä¸¤ä¸ªæ•°åœ¨åŒä¸€åˆ—ï¼Œæˆ–åŒä¸€è¡Œã€‚</p><p>æ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªåŒä¸€è¡Œçš„ç‚¹ä¹‹é—´æœ‰ç©ºç™½ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸è®¤ä¸ºä»–ä»¬åœ¨åŒä¸€è¡Œã€‚</p><p>$1\le n,k\le 500$ ã€‚</p></blockquote><p>æ„Ÿè§‰è¿™é¢˜æ˜¯ä¸æ˜¯å¦‚æœçœ‹ä¸å‡ºæ¥è¦å»ºç¬›å¡å°”æ ‘ï¼Œäººå°±ç›´æ¥æ²¡äº†å•Šâ€¦</p><p>å¤§æ¦‚å°±æ˜¯è¯´æŒ‰ç…§é«˜åº¦ä¸ºæƒå€¼ï¼Œåºå·ä¸ºé”®å€¼å»ºç¬›å¡å°”æ ‘ã€‚å‘ç°è¿™æ ·çš„æ ‘æœ‰ç€è‰¯å¥½çš„æ€§è´¨ï¼Œå°±æ˜¯å¯¹äºä¸€ä¸ªç‚¹ $x$ ä¸åŒ…å«è‡ªå·±çš„å­æ ‘ï¼Œä»–ä»¬åœ¨ $h_x$ ä»¥ä¸Šçš„é‚£éƒ¨åˆ†é«˜åº¦äº’ç›¸ä¸å½±å“ï¼Œä¸”å¦‚æœä¿è¯ä¸è‡ªé€‰çš„è¯ä¸€å®šä¸ä¼šå‡ºç°åœ¨åŒä¸€åˆ—çš„æƒ…å†µã€‚</p><p>ç„¶åå°±è½¬åŒ–æˆäº†ä»å­æ ‘å†…é€‰æ‹© $k$ ä¸ªæ— åºç‚¹çš„æ–¹æ¡ˆæ•°äº†ã€‚è€ƒè™‘æ ‘ä¸ŠèƒŒåŒ…ã€‚ $f_{i,v}$ è¡¨ç¤ºä»¥ $i$ ä¸ºæ ¹ï¼Œåˆæ³•åœ°é€‰äº† $v$ ä¸ªç‚¹çš„æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆå…ˆè€ƒè™‘å­æ ‘å†…çš„è½¬ç§»ï¼Œå°±æ¯”è¾ƒæœ´ç´ ã€‚è¿™éƒ¨åˆ†å¯ä»¥éšä¾¿åšï¼Œå› ä¸ºå¹¶ä¸å…³å¿ƒæ˜¯ $O(nk)$ è¿˜æ˜¯ $O(nk^2)$ ã€‚ç„¶åè€ƒè™‘é€‰å®š $i$ æ—¶çš„æ–¹æ¡ˆæ•°ï¼Œä¹Ÿå°±æ˜¯ç®—ä¸Š $\leq h_x$ é‚£ä¸€å—å°çŸ©å½¢çš„æ–¹æ¡ˆæ•°ã€‚è¿™ä¸ªåœ°æ–¹å¤§æ¦‚å°±æ˜¯è¦è€ƒå¯Ÿä¸€ç‚¹<del>æˆ‘æ²¡æœ‰çš„</del>ç»„åˆèƒ½åŠ›äº†ã€‚è€ƒè™‘ä»ä¸€ä¸ª $n$ è¡Œ $m$ åˆ—çš„çŸ©å½¢é‡Œé€‰å‡º $k$ ä¸ªä¸åŒè¡Œã€ä¸åŒåˆ—çš„ç‚¹çš„æ–¹æ¡ˆæ•°ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯é€‰ $k$ ä¸ªè¡Œå·ã€$k$ ä¸ªåˆ—å·ï¼Œç„¶åå¯¹è¡Œå·å’Œåˆ—å·åšä¸ªåŒ¹é…ï¼Œå¯ä»¥çŸ¥é“æ–¹æ¡ˆæ•°æ˜¯</p><script type="math/tex; mode=display">c(n,m,k)=\binom{m}{k}\times \binom{n}{k}\times k!</script><p>é‚£ä¹ˆåŒç†ï¼Œå¦‚æœè¦ç®—è€ƒè™‘ $x$ çš„çŸ©å½¢çš„æ–¹æ¡ˆæ•°ï¼Œå°±æ˜¯åœ¨ç®—ä¸€ä¸ªæœ‰ $h_x$ è¡Œï¼Œ$sz_x-(i-j)$ åˆ—çš„çŸ©å½¢çš„æ–¹æ¡ˆæ•°ï¼Œå°±æ˜¯ $c(h_x,sz_x-(i-j),k)$ ã€‚</p><p>å®ç°ä¸Šæœ‰ä¸€ç‚¹ä¸‹ä¼ é«˜åº¦çš„å°ç»†èŠ‚ã€‚</p><p>å…¶å®è¿™é¢˜æœ¬è´¨ä¸Šæ˜¯åˆ†ç±»è®¨è®ºäº†ä¸€ä¸‹æ”¾çš„æƒ…å†µï¼Œå³åœ¨ $h_x$ çš„é«˜åº¦ä¸Šé¢æ”¾å’Œåœ¨ $h_x$ çš„é«˜åº¦ä¸‹é¢(å«)æ”¾ã€‚æ˜¯ä¸€é“ä¸é”™çš„è®¡æ•°é¢˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1050</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1000050</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1000000007</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rt ;</span><br><span class="line"><span class="keyword">int</span> tp ;</span><br><span class="line"><span class="keyword">int</span> n, k ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">int</span> lc[N] ;</span><br><span class="line"><span class="keyword">int</span> rc[N] ;</span><br><span class="line"><span class="keyword">int</span> sz[N] ;</span><br><span class="line"><span class="keyword">int</span> fac[M] ;</span><br><span class="line"><span class="keyword">int</span> inv[M] ;</span><br><span class="line"><span class="keyword">int</span> stk[N] ;</span><br><span class="line"><span class="keyword">int</span> tmp[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> f[N][N] ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; E[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">0</span>, f = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &gt; <span class="string">'9'</span> || c &lt; <span class="string">'0'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>) f = <span class="number">-1</span> ; c = getchar() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &lt;= <span class="string">'9'</span> &amp;&amp; c &gt;= <span class="string">'0'</span>)&#123;</span><br><span class="line">        r = (r &lt;&lt; <span class="number">1</span>) + (r &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r * f ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(T &amp;x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x += y ; x = x &gt;= mod ? x - mod : x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> T <span class="title">addn</span><span class="params">(T x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x += y ; <span class="keyword">return</span> (x = x &gt; mod ? x - mod : x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">expow</span><span class="params">(ll x, ll y)</span></span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (y)&#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            ret = ret * x % P ;</span><br><span class="line">        x = x * x % P ; y &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">comb</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1l</span>l * fac[a] * inv[a - b] % P * inv[b] % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span> || y &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1l</span>l * comb(x, z) * comb(y, z) % P * fac[z] % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_do</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> h)</span></span>&#123;</span><br><span class="line">    sz[x] = <span class="number">1</span> ;</span><br><span class="line">    f[x][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line"><span class="comment">//    printf("%d %d %d\n", k, x, h) ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        do_do(y, base[x]), sz[x] += sz[y] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= k ; ++ i)</span><br><span class="line">           <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= i ; ++ j)</span><br><span class="line">                add(tmp[i], <span class="number">1l</span>l * f[x][i - j] * f[y][j] % P) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= k ; ++ i)</span><br><span class="line">            f[x][i] = tmp[i], tmp[i] = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> nh = base[x] - h ;</span><br><span class="line"><span class="comment">//    printf("%d %d %d %d\n", k, x, h, nh) ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= min(sz[x], k) ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= min(nh, i) ; ++ j)</span><br><span class="line">            add(tmp[i], <span class="number">1l</span>l * f[x][i - j] * calc(sz[x] - i + j, nh, j) % P) ;</span><br><span class="line"><span class="comment">//    printf("%d %d %d\n", k, x, h) ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= k ; ++ i)</span><br><span class="line">        f[x][i] = tmp[i], tmp[i] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    freopen("1.in", "r", stdin) ;</span></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k ; fac[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    stk[tp = <span class="number">1</span>] = <span class="number">0</span> ; base[<span class="number">0</span>] = <span class="number">-1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; M ; ++ i)</span><br><span class="line">        fac[i] = <span class="number">1l</span>l * fac[i - <span class="number">1</span>] * i % P ;</span><br><span class="line">    inv[M - <span class="number">1</span>] = expow(fac[M - <span class="number">1</span>], P - <span class="number">2</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = M - <span class="number">2</span> ; i &gt;= <span class="number">0</span> ; -- i)</span><br><span class="line">        inv[i] = <span class="number">1l</span>l * inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % P ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) base[i] = qr() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">while</span> (tp &amp;&amp; base[stk[tp]] &gt; base[i]) -- tp ;</span><br><span class="line">        fa[i] = stk[tp] ; <span class="keyword">int</span> j = rc[stk[tp]] ; stk[++ tp] = i ;</span><br><span class="line">        fa[j] = i ; lc[i] = j ; rc[fa[i]] = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        E[fa[i]].push_back(i) ;</span><br><span class="line">        <span class="keyword">if</span> (!fa[i]) rt = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    do_do(rt, <span class="number">0</span>) ; <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, f[rt][k]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¬›å¡å°”æ ‘çš„æ€§è´¨æ¯”è¾ƒå•ä¸€ï¼Œä½†æ˜¯åº”ç”¨èµ·æ¥ä¹Ÿæ˜¯å¾ˆæœ‰è¶£çš„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="å­¦ä¹ ç¬”è®°" scheme="https://www.orchidany.cn/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
      <category term="ç¬›å¡å°”æ ‘" scheme="https://www.orchidany.cn/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91/"/>
    
    
      <category term="æ€ç»´é¢˜/è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E8%AE%A1%E6%95%B0/"/>
    
      <category term="ç»„åˆè®¡æ•°/æœ‰æŠ€å·§çš„è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84%E8%AE%A1%E6%95%B0/"/>
    
      <category term="æ€ç»´é¢˜/å¯¹åº”ä¸è½¬åŒ–" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E5%AF%B9%E5%BA%94%E4%B8%8E%E8%BD%AC%E5%8C%96/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/æ ‘å½¢DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%A0%91%E5%BD%A2DP/"/>
    
      <category term="æ•°æ®ç»“æ„/ç¬›å¡å°”æ ‘" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/èƒŒåŒ…æ¨¡å‹" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E8%83%8C%E5%8C%85%E6%A8%A1%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>ã€è®­ç»ƒè®°å½•ã€‘6.12 è®­ç»ƒç¬”è®°</title>
    <link href="https://www.orchidany.cn/2020/06/14/6-12-%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/06/14/6-12-è®­ç»ƒç¬”è®°/</id>
    <published>2020-06-14T10:48:54.000Z</published>
    <updated>2020-06-19T12:15:10.534Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ—¥å¸¸è¥ä¸š.png</p><p>ä»Šå¤©å¿ƒè¡€æ¥æ½®æ‰“äº†ä¸¤åœºã€‚è¿™äº›ä¸œè¥¿æ€»ç®—æ˜¯å‘Šä¸€æ®µè½äº†233 </p><a id="more"></a><h1 id="A-M"><a href="#A-M" class="headerlink" title="A.M."></a>A.M.</h1><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><blockquote><p>è®¾ $f_i$ ä¸ºæ–æ³¢é‚£åˆ‡æ•°åˆ—ç¬¬ $i$ é¡¹ã€‚å·²çŸ¥</p><script type="math/tex; mode=display">g_{n}=\sum_{i=0}^{n} f_{i} f_{n-i}</script><p>æ±‚ $\sum g_i$ .</p><p>$1\leq n\leq 10^{18}$ ã€‚ </p></blockquote><p>$O(n)$ çš„æš´åŠ›æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œåªéœ€è¦è€ƒè™‘å¯¹æ¯ä¸ª $f_i$ ï¼Œä¼šæœ‰ $f_1,f_2\cdots f_{n-i}$ è¿™äº›æ•°ä¸ä¹‹ç›¸ä¹˜äº§ç”Ÿè´¡çŒ®ã€‚è¿™æ ·å°±å¯ä»¥ç”¨ä¸€ä¸ªå‰ç¼€å’Œæ¥çº¿æ€§ç®—ã€‚</p><p>ç„¶åæ»¡åˆ†åšæ³•å½“ç„¶å°±æ˜¯è¦æ¨å¼å­ã€‚è€ƒè™‘ç”¨ $f_i=f_{i-1}+f_{i-2}$ è¿›è¡Œå±•å¼€å¯å¾—ï¼š</p><script type="math/tex; mode=display">\begin{aligned} g_{n} &=\sum_{i=0}^{n} f_{i} f_{n-i} \\ &=\sum_{i=2}^{n}\left(f_{i-1}+f_{i-2}\right) f_{n-i}+f_{1} f_{n-1}+f_{0} f_{n} \\ &=\sum_{i=0}^{n-1} f_{i} f_{n-i-1}-f_{0} f_{n-1}+\sum_{i=0}^{n-2} f_{i} f_{n-i-2}+f_{1} f_{n-1}+f_{0} f_{n} \\ &=g_{n-1}+g_{n-2}+f_{1} f_{n-1}-f_{0} f_{n-1}+f_{0} f_{n} \\ &=g_{n-1}+g_{n-2}+f_{n} \end{aligned}</script><p>äºæ˜¯å°±å¯ä»¥ç›´æ¥çŸ©é˜µå¿«é€Ÿå¹‚äº†ã€‚</p><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="3.png" alt=""><br>$1 \leq n \leq 10^{5}, 0 \leq l_{i} \leq r_{i}&lt;2^{31}$ã€‚</p></blockquote><p>å­¦ FWT çš„æ—¶å€™è®°ä½çš„ä¸€ä¸ªæ¨è®ºï¼š</p><script type="math/tex; mode=display">{\rm odd}({\rm count}(x\oplus y))={\rm odd}({\rm count}(x)+{\rm count}(y))</script><p>${\rm count}$ æ˜¯äºŒè¿›åˆ¶ä¸‹ $1$ çš„ä¸ªæ•°ã€‚è¿™ä¸ªä¸éš¾è¯ã€‚é‚£ä¹ˆé—®é¢˜å°±å¯ä»¥è½¬åŒ–æˆå¿«é€Ÿç»´æŠ¤åŒºé—´ä¸­ ${\rm count}$ ä¸ºå¥‡æ•°å’Œå¶æ•°çš„ä¸ªæ•°ã€‚å…³äºè¿™ä¸ªæœ‰ä¸¤ç§ä¸åŒçš„åšæ³•ï¼š</p><h3 id="Sol-1"><a href="#Sol-1" class="headerlink" title="Sol 1"></a>Sol 1</h3><p>è€ƒè™‘ç›´æ¥ç”¨ set ç»´æŠ¤åŒºé—´ï¼Œæ¯æ¬¡æ–°åŠ è¿›æ¥å¯¹éäº¤é›†éƒ¨åˆ†è¿›è¡Œæ•°ä½ DPã€‚å¤æ‚åº¦ $O(n\log V)$ ã€‚</p><h3 id="Sol-2"><a href="#Sol-2" class="headerlink" title="Sol 2"></a>Sol 2</h3><p>æ˜¯åˆ«äººæ¯”è¾ƒç¥å¥‡çš„åšæ³•ã€‚è€ƒè™‘ç›´æ¥ç»´æŠ¤ä¸€æ£µåŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘æ¥ç»´æŠ¤åŒºé—´ä¿¡æ¯ã€‚ç„¶åè€ƒè™‘ä¸€ä¸ªæ€§è´¨ï¼Œå¤§æ¦‚æ˜¯è¯´å‘ç°çº¿æ®µæ ‘åœ¨æ‹†åŒºé—´çš„æ—¶å€™æ˜¯äºŒè¿›åˆ¶æ‹†æ³•ï¼Œå¯¹äº $len=1$ çš„åŒºé—´å¯ä»¥ç›´æ¥ç®—ï¼Œ$len&gt;1$ çš„åŒºé—´å¿…ç„¶æ˜¯é•¿åº¦ä¸º $2^p$ çš„è¿ç»­æ®µï¼Œè€Œè¿™ä¸ªè¿ç»­æ®µä¸­å¯ä»¥çŸ¥é“ ${\rm count}$ ä¸ºå¥‡æ•°å’Œå¶æ•°çš„åˆ†åˆ«å ä¸€åŠä¸€åŠã€‚äºæ˜¯å°±å°±å¯ä»¥æ¯”è¾ƒç®€å•åœ°ç»´æŠ¤å‡ºæ¥ã€‚</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="9.png" alt=""></p><p>$2 \leq n \leq 10^{5}, 1 \leq q \leq 10^{5},\sum k\leq 2\times 10^5$ .</p></blockquote><p>æ¯”è¾ƒè€ƒå¯ŸåŸºæœ¬åŠŸçš„é¢˜ç›®ã€‚é¦–å…ˆå¯ä»¥çŸ¥é“ï¼Œè®¾ä¸€ä¸ªå­—ç¬¦ä¸²é‡Œ $0$ æœ€åå‡ºç°çš„ä½ç½®ä¸º $A$ï¼Œ$1$ æœ€åå‡ºç°çš„ä½ç½®ä¸º $B$ï¼Œé‚£ä¹ˆè¿™ä¸ªå­—ç¬¦ä¸²å‡ºç°çš„æ¦‚ç‡å°±æ˜¯ $2^{-\min(A,B)}$ ã€‚ä¹‹åè€ƒè™‘å¯¹æ¯ç»„è¯¢é—®ï¼Œé€šè¿‡æšä¸¾+åˆ†ç±»è®¨è®º $s=\min(A,B)$  æ¥è§£å†³ã€‚ä»¥ä¸‹é»˜è®¤å½“ä½œ $a_1,a_2\cdots a_k$ è¿™äº›ä½ç½®éƒ½å˜æˆ $0$ ï¼š</p><p>1ã€$s=a_k,s\neq n$ ã€‚è¿™æ ·ç›¸å½“äºè®¡ç®—å‰©ä¸‹çš„ä½ç½®åœ¨ä»€ä¹ˆåœ°æ–¹å‡ºç°ï¼Œæ‰€ä»¥ç­”æ¡ˆä¸º $\dbinom{s-k}{n-k}\times 2^{-s}$ ã€‚</p><p>2ã€$s=B,a_i\lt s\lt a_{i+1}$ ã€‚è¿™æ ·ç›¸å½“äºæ‹¿æ‰äº†ä¸€ä¸ª $1$ ï¼Œäºæ˜¯æ–¹æ¡ˆæ•°ä¸º $\dbinom{s-1-i}{n-i}$ ã€‚è¿™éƒ¨åˆ†å¯ä»¥è€ƒè™‘å¯¹æ‰€æœ‰è¿™æ ·çš„ $s$  åšä¸€ä¸ªå‰ç¼€å’Œï¼Œè¯¢é—®çš„æ—¶å€™å°±å¯ä»¥ $O(k)$ è®¡ç®—äº†ã€‚</p><p>3ã€$s&gt;a_k,s=A$ ã€‚è¿™æ ·ç›¸å½“äºæ‹¿æ‰äº†ä¸€ä¸ª $0$ ï¼Œæ–¹æ¡ˆæ•°å°±æ˜¯ $\dbinom{s-k-1}{n-k-1}$ ã€‚æ³¨æ„åˆ°è¿™æ˜¯å¯¹ä¸åŒçš„ $k$ éƒ½éœ€è¦é¢„å¤„ç†å¤„ä¸€ä¸ªå‰ç¼€å’Œï¼Œçœ‹ä¸Šå»å¤æ‚åº¦å¾ˆçˆ†ç‚¸ã€‚ä½†æ˜¯è€ƒè™‘ $\sum k\leq 2\times 10^5$ ï¼Œä¹Ÿå°±æ˜¯æœ¬è´¨ä¸åŒçš„ $k$ åªä¼šæœ‰è‡³å¤š $O(\sqrt {2e5})$ çš„æ ·å­ã€‚äºæ˜¯å¯ä»¥ç¦»çº¿ä¸‹æ¥åšã€‚</p><p>äºæ˜¯æœ€åå¤æ‚åº¦ $O\left(\sum k+n\sqrt n\right)$ ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">400050</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ll I2 = <span class="number">499122177</span> ;</span><br><span class="line"></span><br><span class="line">ll ans[N] ;</span><br><span class="line">ll fac[N] = &#123;<span class="number">1</span>&#125; ;</span><br><span class="line">ll inv[N] = &#123;<span class="number">1</span>&#125; ;</span><br><span class="line">ll pwi2[N] = &#123;<span class="number">1</span>&#125; ;</span><br><span class="line">ll s[N] ; <span class="comment">// \sum \binom&#123;n-1&#125;&#123;i&#125;\times \dfrac&#123;1&#125;&#123;2^&#123;j&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> &lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; qs[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(T x, <span class="keyword">char</span> c = <span class="string">'\n'</span>)</span></span>&#123; <span class="built_in">cerr</span> &lt;&lt; x &lt;&lt; c ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">debug</span><span class="params">(T *<span class="keyword">const</span> tp, <span class="keyword">int</span> minn, <span class="keyword">int</span> maxn, <span class="keyword">char</span> v = <span class="string">' '</span>, <span class="keyword">char</span> c = <span class="string">'\n'</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = minn ; i &lt;= maxn ; ++ i) debug(tp[i], v) ;  <span class="built_in">cerr</span> &lt;&lt; c ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> arr[N] ;</span><br><span class="line"><span class="keyword">int</span> n, bin ;</span><br><span class="line"><span class="keyword">int</span> q, k, m ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(T &amp;x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x += y ; x = x &gt;= mod ? x - mod : x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">dec</span><span class="params">(T &amp;x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x -= y ; x = x &lt; <span class="number">0</span> ? x + mod : x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il T <span class="title">addn</span><span class="params">(T x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x += y ; <span class="keyword">return</span> (x = x &gt; mod ? x - mod : x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il T <span class="title">decn</span><span class="params">(T x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x -= y ; <span class="keyword">return</span> (x = x &lt; <span class="number">0</span> ? x + mod : x) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">il ll <span class="title">expow</span><span class="params">(ll x, ll y, ll mod = P)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (y)&#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = res * x % mod ;</span><br><span class="line">        x = x * x % mod ; y &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">il ll <span class="title">sum</span><span class="params">(<span class="keyword">int</span> t)</span></span>&#123; <span class="keyword">return</span> t &lt; m ? <span class="number">0</span> : s[t] ; &#125;</span><br><span class="line"><span class="function">il ll <span class="title">comb</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> fac[x] * inv[y] % P * inv[x - y] % P ; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre_do</span><span class="params">()</span></span>&#123;</span><br><span class="line">    bin = n &lt;&lt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= bin ; ++ i)</span><br><span class="line">        fac[i] = fac[i - <span class="number">1</span>] * i % P ;</span><br><span class="line">    inv[bin] = expow(fac[bin], P - <span class="number">2</span>, P) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = bin ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">        inv[i - <span class="number">1</span>] = inv[i] * i % P ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= bin ; ++ i)</span><br><span class="line">        pwi2[i] = pwi2[i - <span class="number">1</span>] * I2 % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    m = x ; s[x] = pwi2[x] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = x + <span class="number">1</span> ; i &lt;= bin ; ++ i)</span><br><span class="line">        s[i] = (s[i - <span class="number">1</span>] + pwi2[i] * comb(i, x) % P) % P ;</span><br><span class="line"><span class="comment">//    debug(s, 1, n &lt;&lt; 1) ;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q ;</span><br><span class="line">    pre_do() ; solve(n - <span class="number">1</span>) ;</span><br><span class="line"><span class="comment">//    debug(fac, 1, n &lt;&lt; 1) ;</span></span><br><span class="line"><span class="comment">//    debug(inv, 1, n &lt;&lt; 1) ;</span></span><br><span class="line"><span class="comment">//    debug(pwi2, 1, n &lt;&lt; 1) ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> o = <span class="number">1</span> ; o &lt;= q ; ++ o)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;k) ; arr[k + <span class="number">1</span>] = bin ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;arr[i]) ;</span><br><span class="line">        qs[k].push_back(make_pair(o, arr[k])) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = k ; i &gt;= <span class="number">0</span> ; -- i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] != bin)&#123;</span><br><span class="line"><span class="comment">//                cout &lt;&lt; arr[i + 1] - (i + 1) - 1 &lt;&lt; " " &lt;&lt; arr[i] - i - 1 &lt;&lt; '\n' ;</span></span><br><span class="line">                add(ans[o], pwi2[i + <span class="number">1</span>] * decn(sum(arr[i + <span class="number">1</span>] - (i + <span class="number">1</span>) - <span class="number">1</span>), sum(arr[i] - i - <span class="number">1</span>)) % P) ;</span><br><span class="line">                <span class="keyword">if</span> (arr[i + <span class="number">1</span>] - (i + <span class="number">1</span>) - <span class="number">1</span> &lt; n - <span class="number">1</span>) <span class="keyword">break</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (arr[k] &lt; bin)</span><br><span class="line">            add(ans[o], pwi2[arr[k]] * comb(arr[k] - k, n - k) % P) ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; ans[1] &lt;&lt; '\n' ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!qs[i].size()) <span class="keyword">continue</span> ; <span class="keyword">else</span> solve(n - i - <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> t : qs[i])&#123;</span><br><span class="line">            <span class="keyword">int</span> x = t.fr, y = t.sc ; <span class="keyword">if</span> (x == bin) <span class="keyword">continue</span> ;</span><br><span class="line">            add(ans[x], pwi2[i + <span class="number">1</span>] * decn(sum(bin - (i + <span class="number">1</span>) - <span class="number">1</span>), sum(y - i - <span class="number">1</span>))) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (ans[i] &lt;&lt; <span class="number">1</span>) % P) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">15 1</span></span><br><span class="line"><span class="comment">15 1 4 6 10 13 14 15 19 20 21 22 25 26 29 30</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h1 id="P-M"><a href="#P-M" class="headerlink" title="P.M."></a>P.M.</h1><h2 id="A-1"><a href="#A-1" class="headerlink" title="A"></a>A</h2><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="7.png" alt=""></p><p>$n \leq 1000000 \leq|x_1|,|y_1|,|x_2|,|y_2| \leq 10^{9}$ ã€‚</p></blockquote><p>æ¯”è¾ƒæœ‰è¶£çš„ç»“è®ºé¢˜ï¼Ÿé‚£ä¹ˆå°±æ˜¯æœ‰ä¸ªç»“è®ºï¼šç­”æ¡ˆç»å¯¹ä¸ä¼šè¶…è¿‡ $3$ ã€‚</p><p>å¤§æ¦‚æ˜¯è€ƒè™‘ç”±äºæ²¡æœ‰ä¸‰ç›´çº¿å…±ç‚¹ï¼Œæ‰€ä»¥æ¯ä¸ªç‚¹ $o$ å¿…ç„¶åªè¢«ä¸¤æ¡ç›´çº¿ç»è¿‡ï¼Œç›¸é‚»ç‚¹çš„ä¸ªæ•°ä¸ä¼šè¶…è¿‡ $4$ã€‚ å¯ä»¥å°†äº¤ç‚¹æŒ‰xã€yåæ ‡æ’åºã€‚ä¸éš¾å‘ç°åœ¨è€ƒè™‘åˆ° $o$ æ—¶ï¼Œå®ƒæœ‰æ°å¥½ä¸¤ä¸ªä½äºä¸åŒç›´çº¿ä¸Šçš„ç›¸é‚»çš„ç‚¹è¢«èµ‹äº†é¢œè‰²ï¼Œè¿™æ—¶ä½¿ç”¨æ²¡ç”¨è¿‡çš„é¢œè‰²å³å¯ã€‚</p><p>ç„¶åè€ƒè™‘å¦‚æœåªæœ‰ä¸€ä¸ªäº¤ç‚¹ï¼Œé‚£ä¹ˆè‰²æ•°ä¸º $1$ ã€‚å¦åˆ™è€ƒè™‘å¦‚æœå…¨éƒ¨çš„ç›´çº¿åªæœ‰ä¸¤ç§æ–œç‡ï¼Œé‚£ä¹ˆè‰²æ•°ä¸º $2$ ï¼Œå› ä¸ºæ­¤æ—¶å¿…ç„¶ä¸ä¼šå½¢æˆä¸‰è§’å½¢ã€‚</p><h2 id="B-1"><a href="#B-1" class="headerlink" title="B"></a>B</h2><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="6.png" alt=""></p><p>$1\leq n\leq 1000,a_i,b_i\leq 10^5$ ã€‚</p></blockquote><p>æš´åŠ›æ˜¯å¯ä»¥æ‹¼ä¸€ä¸‹çš„ã€‚å¤§æ¦‚å°±æ˜¯è¯´å¯ä»¥ç”¨ $2^n$ åšå‰ $25$ åˆ†ï¼Œç„¶åæš´åŠ› dpï¼Œå³è®¾ $f_{i,p,q}$ è¡¨ç¤ºé‚£ä¸¤ä¸ªå¼å­çš„å€¼åˆ†åˆ«ä¸º $p,q$ æ—¶çš„æœ€å°å€¼ï¼Œå°±å¯ä»¥æ‹¿åˆ° $50$ ptsã€‚</p><p>ç„¶åè€ƒè™‘è¿˜æœ‰ä¸€æ¡£ $c_i=0$ çš„éƒ¨åˆ†åˆ†ã€‚å‘ç°è¿™ä¸€æ¡£éƒ¨åˆ†åˆ†æœ¬è´¨ä¸Šå°±æ˜¯åˆ¤æ–­æ˜¯å¦å¯ä»¥æ‰¾å‡ºä¸€ç§åˆæ³•çš„æ–¹æ¡ˆä½¿å¾—æ»¡è¶³é‚£ä¸¤ä¸ªå¼å­ã€‚é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è®¾ $f_{i,v}$ è¡¨ç¤ºè€ƒè™‘äº†å‰ $i$ ä¸ª $x$ ï¼Œç¬¬ä¸€ä¸ªå¼å­çš„å€¼ä¸º $v$ æ—¶ç¬¬äºŒä¸ªå¼å­çš„æœ€å¤§å€¼ã€‚ä¸éš¾çŸ¥é“è¿™æ ·æ˜¯ $O(nP)$ çš„ã€‚</p><p>ç„¶åè€ƒè™‘æ»¡åˆ†ï¼Œåˆåˆ°äº†å–œé—»ä¹è§çš„åˆå¹¶çŠ¶æ€ç¯èŠ‚ã€‚è€ƒè™‘è®¾ $f_{i,t}$ è¡¨ç¤ºç¡®å®šäº†å‰ $i$ ä¸ª $x_i$ï¼Œ$\sum_{j&lt;i} a_{j} x_{j} \leq t \leq \sum_{j&lt;i} b_{j} x_{j}$ æ—¶çš„æœ€å°å€¼ã€‚è¿™ä¸ªè½¬ç§»æœ¬è´¨æ˜¯å’Œæš´åŠ›ç›¸åŒçš„ï¼Œä½†æ˜¯æœ‰æ¯”è¾ƒå¥½çš„æ€§è´¨ï¼š</p><script type="math/tex; mode=display">f_{i,t}=\min \left\{f_{i-1,x}, \min _{x-b_{i} \leq j \leq x-a_{i}}\{f_{i-1,j}\}+c_{i}\right\}</script><p>ä¸éš¾å‘ç°åé¢é‚£ä¸€ç»´æ˜¯å¯ä»¥å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–æ‰çš„ã€‚äºæ˜¯å¤æ‚åº¦é™ä¸º $O(nP)$ ã€‚</p><h2 id="C-1"><a href="#C-1" class="headerlink" title="C"></a>C</h2><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="5.png" alt=""></p><p>$1 \leq n \leq 10^{9}, 1 \leq m \leq 3 \times 10^{5}$ ã€‚</p></blockquote><p>è¿™é“é¢˜ååˆ†å¼º and ååˆ†æœ‰è¶£ï¼</p><p>è‡ªå·±ä¸€å¼€å§‹çš„æƒ³æ³•è¿˜æ˜¯æŒºå¯ä»¥çš„ï¼Œè™½ç„¶åˆ°ä¸€åŠå°±ä¸ä¼šäº†ã€‚å¤§æ¦‚æ˜¯è¯´è€ƒè™‘è®¡ç®—å½“ä¸€ä¸ªåºåˆ—çš„ gcd æ˜¯ $x$ çš„æ—¶å€™ï¼Œå®ƒçš„ lcm å¯ä»¥æœ‰å¤šå°‘ç§æ–¹æ¡ˆã€‚ç„¶åâ€¦ç„¶åå°±ä¸ä¼šäº† (xã€‚</p><p>è€ƒè™‘è®¾ $f(d)$ è¡¨ç¤ºæœ‰ $\gcd=d$ çš„æ—¶å€™ï¼Œæ‰€æœ‰å¯èƒ½çš„ $\rm lcm$ ä¹‹ç§¯ã€‚ä½†è¿™ä¸ªå¹¶ä¸å¥½æ±‚ï¼Œäºæ˜¯è¿™ä¸ªåœ°æ–¹éœ€è¦åšä¸€æ­¥å®¹æ–¥çš„è½¬åŒ–ã€‚è®¾ $g(d)$ è¡¨ç¤ºåºåˆ—ä¸­çš„å…¨éƒ¨æ•°å­—éƒ½æ˜¯ $d$ çš„å€æ•°æ—¶ã€æ‰€æœ‰åºåˆ—çš„ $\rm lcm$ ä¹‹ç§¯ã€‚é‚£ä¹ˆä¸éš¾å‘ç°ä»–ä¿©ä¹‹é—´æœ‰è¿™æ ·çš„å…³ç³»ï¼š</p><script type="math/tex; mode=display">\prod_{k=1}^{\lfloor\frac{m}{d}\rfloor} f(d\times k)=g(d)</script><p>è€ƒè™‘å¦‚æœçŸ¥é“äº† $\{g\}$ ï¼Œé‚£ä¹ˆ $f$ æ˜¯å¾ˆå®¹æ˜“åœ¨ $O(m\times \tau(m))$ çš„æ—¶é—´å¤æ‚åº¦é‡Œç®—å‡ºæ¥çš„ï¼Œå³è€ƒè™‘ä»å¤§åˆ°å°æ‰«ï¼Œæ¯æ¬¡å¯¹æ‰€æœ‰ $d|x$ çš„ $g(d)$ é™¤ä»¥å½“å‰çš„ $f(x)$ ã€‚æ˜¯ä¸ªæ¯”è¾ƒç»å…¸çš„æŠ€å·§ã€‚</p><p>ç„¶åè€ƒè™‘å¦‚ä½•è®¡ç®— $g$ ã€‚å‘ç°æ­¤æ—¶æ¯ä¸ªåºåˆ—å¯ä»¥è¢«å®Œå…¨æ˜ å°„åˆ°ä¸€ä¸ªå€¼åŸŸä¸º $[1,V=\left\lfloor\frac{m}{d}\right\rfloor]$ çš„åŒºé—´ä¸Šã€‚äºæ˜¯å¯ä»¥è®¡ç®—å‡ºå…¨éƒ¨ä½äº $[1,V]$ ä¹‹é—´çš„åºåˆ—çš„ $\rm lcm$ ä¹‹ç§¯ $h(V)$ åï¼Œä¼šæœ‰</p><script type="math/tex; mode=display">g(d)=h(V)\times d^{V^n}</script><p>ç„¶åè€ƒè™‘ $h$ çš„æ±‚æ³•ã€‚å‘ç°ç”±äºç­”æ¡ˆæ˜¯ä¹˜ç§¯å½¢å¼ï¼Œæ‰€ä»¥å¯ä»¥å¯¹æ‰€æœ‰åœ¨ $1\sim V$ ä¹‹é—´çš„ç´ æ•°åˆ†åˆ«è®¡ç®—è´¡çŒ®ã€‚è€ƒè™‘å¯¹äºä¸€ä¸ªè´¨æ•° $p$ çš„æŸä¸€ä¸ªå¹‚ $p^e$ï¼Œå¦‚æœ $\rm lcm$ è‡³å°‘åŒ…å« $p_e$ çš„æ–¹æ¡ˆæ•°ä¸º $q$ ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ä¸€ä¸ªå·®åˆ†ã€æˆ–è€…æ˜¯è´¡çŒ®å¹³æ‘Šçš„æŠ€å·§ï¼Œä½¿ä¹‹å¯¹ç­”æ¡ˆäº§ç”Ÿ $p^q$ çš„è´¡çŒ®ã€‚ç„¶åè¿™éƒ¨åˆ†å¯ä»¥ç”¨æ€»æ–¹æ¡ˆæ•°å‡å»é‚£äº›æ‰€æœ‰ $p$ çš„å¹‚æ¬¡éƒ½ $<e$ çš„æƒ…å†µï¼Œå†å‡å» $p$ çš„å¹‚æ¬¡ $>e$ çš„æƒ…å†µå¾—åˆ°ã€‚</p><p>è€ƒè™‘è¿™ä¹ˆåšçš„å¤æ‚åº¦ã€‚é¦–å…ˆæœ‰ä¸ªæ¯›ä¼°ä¼°ç­‰å¼</p><script type="math/tex; mode=display">\sum_{i=1}^{V} \omega(i) \leq V \log V</script><p>è€Œç®—ä¸Šæšä¸¾è´¨å› æ•°å¹‚å°±è¦å†å¤šä¸€ä¸ª $\log $ ï¼Œå†ç®—ä¸Šæšä¸¾æœ¬è´¨ä¸åŒçš„ $V$ çš„æ—¶é—´ï¼Œå‘ç°å¤§æ¦‚æ˜¯</p><script type="math/tex; mode=display">O(\sqrt m\times \sqrt m\log \sqrt m\times \log m)\leq O(m\log ^2 m)</script><p>å¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> f[N] ;</span><br><span class="line"><span class="keyword">int</span> g[N] ;</span><br><span class="line"><span class="keyword">int</span> pr[N] ;</span><br><span class="line"><span class="keyword">int</span> pval[N] ;</span><br><span class="line"><span class="keyword">bool</span> chk[N] ;</span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; d_[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">expow</span><span class="params">(ll x, ll y, ll mod = P)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (y)&#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = res * x % mod ;</span><br><span class="line">        x = x * x % mod ; y &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> T)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= T ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!chk[i]) pr[++ cnt] = i ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= cnt ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (pr[j] * i &gt;= N) <span class="keyword">break</span> ;</span><br><span class="line">            chk[i * pr[j]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= T ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; i * j &lt;= T ; ++ j)</span><br><span class="line">            d_[i * j].push_back(i) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    x -= y ; <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + P - <span class="number">1</span> : x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> q ;</span><br><span class="line">    <span class="keyword">int</span> p, o, z, rr, po ;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; sieve(m) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        pval[i] = expow(i, n, P - <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> t = m, d = <span class="number">1</span> ; d &lt;= m ; ++ d, t = m / d)&#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[t]) <span class="keyword">continue</span> ;</span><br><span class="line">        vis[t] = <span class="number">1</span> ; g[t] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)&#123;</span><br><span class="line">            q = p = pr[i] ;</span><br><span class="line">            po = t - t / p ;</span><br><span class="line">            <span class="keyword">if</span> (p &gt; t) <span class="keyword">break</span> ;</span><br><span class="line">            o = pval[po], z = pval[t], rr = <span class="number">0</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> e = <span class="number">1</span> ; e &lt;= <span class="number">30</span> ; ++ e)&#123;</span><br><span class="line">                <span class="keyword">if</span> (q &gt; t) <span class="keyword">break</span> ;</span><br><span class="line">                rr = (rr + sub(z, o)) % (P - <span class="number">1</span>) ;</span><br><span class="line">                o = pval[po += t / q] ; q *= p ;</span><br><span class="line">                o = pval[po -= t / q] ;</span><br><span class="line">            &#125;</span><br><span class="line">            g[t] = g[t] * expow(p, rr) % P ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        f[i] = g[m / i] * expow(i, pval[m / i]) % P ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m ; i &gt;= <span class="number">1</span> ; -- i)&#123;</span><br><span class="line">        <span class="keyword">int</span> rv = expow(f[i], P - <span class="number">2</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> j : d_[i])</span><br><span class="line">            <span class="keyword">if</span> (i != j)</span><br><span class="line">                f[j] = <span class="number">1l</span>l * f[j] * rv % P ;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        ans = <span class="number">1l</span>l * ans * expow(f[i], i) % P ;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ—¥å¸¸è¥ä¸š.png&lt;/p&gt;
&lt;p&gt;ä»Šå¤©å¿ƒè¡€æ¥æ½®æ‰“äº†ä¸¤åœºã€‚è¿™äº›ä¸œè¥¿æ€»ç®—æ˜¯å‘Šä¸€æ®µè½äº†233 &lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ZROI" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/ZROI/"/>
    
    
      <category term="æ€ç»´é¢˜/è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E8%AE%A1%E6%95%B0/"/>
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="æ•°å­¦/æ¦‚ç‡,æœŸæœ›" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E6%A6%82%E7%8E%87-%E6%9C%9F%E6%9C%9B/"/>
    
      <category term="ç»„åˆè®¡æ•°/æœ‰æŠ€å·§çš„è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84%E8%AE%A1%E6%95%B0/"/>
    
      <category term="æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ " scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E8%A7%82%E5%AF%9F%E6%80%A7%E8%B4%A8-%E7%BB%93%E8%AE%BA%E4%B8%8E%E6%9E%84%E9%80%A0/"/>
    
      <category term="æ€ç»´é¢˜/å®¹æ–¥" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E5%AE%B9%E6%96%A5/"/>
    
      <category term="æ•°å­¦/çº¿æ€§ä»£æ•°/çŸ©é˜µ" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0-%E7%9F%A9%E9%98%B5/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/èƒŒåŒ…æ¨¡å‹" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E8%83%8C%E5%8C%85%E6%A8%A1%E5%9E%8B/"/>
    
      <category term="æŠ€å·§/çŠ¶æ€åˆå¹¶" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E7%8A%B6%E6%80%81%E5%90%88%E5%B9%B6/"/>
    
      <category term="å•è°ƒé˜Ÿåˆ—/å•è°ƒæ ˆ" scheme="https://www.orchidany.cn/tags/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88/"/>
    
  </entry>
  
  <entry>
    <title>ã€è®­ç»ƒè®°å½•ã€‘6.11 è®­ç»ƒç¬”è®°</title>
    <link href="https://www.orchidany.cn/2020/06/14/6-11-%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/06/14/6-11-è®­ç»ƒç¬”è®°/</id>
    <published>2020-06-14T10:48:48.000Z</published>
    <updated>2020-06-19T12:15:04.868Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>åˆæ˜¯è¥ä¸šçš„æ—¶å€™äº†.</p><a id="more"></a><h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="1.png" alt=""></p><p>$|T|\leq 10^6$ .</p></blockquote><p>å¤§æ¦‚å°±æ˜¯ä¸ªç®€å•æ‰¾æ€§è´¨é¢˜ã€‚é¦–å…ˆä¸éš¾å‘ç°ç­”æ¡ˆä¸Šç•Œä¸º $|T|-1$ ä¸”æœ€åˆç”Ÿæˆçš„ $k$ ä¸ªå­—ç¬¦ä¸€å®šä¼šæ˜¯æœ€ç»ˆçš„ä¸²çš„å‰ç¼€ï¼ŒåŒæ—¶å‘ç°è¿™ä¸ªè¿‡ç¨‹è‡³å¤šä¼šè¿›è¡Œ $O(\log_{k}|T| )$ æ¬¡ã€‚äºæ˜¯å°±å¯ä»¥ç›´æ¥æšä¸¾å‰ç¼€æ¨¡æ‹Ÿè¿™ä¸ªè¿‡ç¨‹ï¼Œå¤æ‚åº¦ $|T|\log |T|$ ã€‚å†™çš„æ—¶å€™æœ‰ç‚¹ç»†èŠ‚å•¥çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: min ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ll base = <span class="number">233</span> ;</span><br><span class="line"><span class="keyword">const</span> ll P = <span class="number">1000000009</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T ;</span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"></span><br><span class="line">ll L, B ;</span><br><span class="line">ll h[N] ;</span><br><span class="line">ll p[N] ;</span><br><span class="line"><span class="keyword">char</span> s[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ((a - b) % P + P) % P ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> l1, <span class="keyword">int</span> r1, <span class="keyword">int</span> l2, <span class="keyword">int</span> r2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (r2 - l2 != r1 - l1) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">int</span> len = r1 - l1 + <span class="number">1</span> ; l1 --, l2 -- ;</span><br><span class="line">    <span class="keyword">return</span> (sub(h[r1], p[len] * h[l1]) == sub(h[r2], p[len] * h[l2])) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d\n"</span>, &amp;T) ; p[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; N ; ++ i)</span><br><span class="line">        p[i] = p[i - <span class="number">1</span>] * base % P ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>) ;</span><br><span class="line">        n = <span class="built_in">strlen</span>(s + <span class="number">1</span>), ans = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            h[i] = h[i - <span class="number">1</span>] * base % P + s[i] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> ( ; ans &lt; n ; ++ ans)&#123;</span><br><span class="line">            L = ans, B = L + <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">while</span> (L &lt; n - <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">long</span> <span class="keyword">long</span> o = L * B + B ;</span><br><span class="line">                <span class="keyword">int</span> l = <span class="number">1</span>, r = L, rr ; -- o ;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; B ; ++ i)&#123;</span><br><span class="line">                    l = r + <span class="number">2</span>, r = l + L - <span class="number">1</span> ;</span><br><span class="line">                    rr = min(<span class="number">1l</span>l * n, min(<span class="number">1l</span>l * r, o)) ;</span><br><span class="line">                    <span class="keyword">if</span> (!chk(<span class="number">1</span>, L - (r - rr), l, rr))</span><br><span class="line">                        <span class="keyword">goto</span> not_ok ; <span class="keyword">if</span> (r &gt;= o - <span class="number">1</span> || r &gt;= n - <span class="number">1</span>) <span class="keyword">break</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">                L = o ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span> ;</span><br><span class="line">            not_ok : <span class="keyword">continue</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans + <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="4.png" alt=""></p><p>$1\leq n\leq 1000$ ã€‚</p></blockquote><p>æœ‰æ¬§æ‹‰å›è·¯ $\Longleftrightarrow$ å…¨éƒ¨çš„ç‚¹åº¦æ•°å‡ä¸ºå¶æ•°ã€‚ç„¶åå°±ä¸ä¼šäº†ã€å®³æ€•</p><p>æ­£è§£å¤§æ¦‚æ˜¯æ¯”è¾ƒéº»çƒ¦çš„æ„é€ é¢˜ã€‚è€ƒè™‘è¿™ä¹ˆä¸€ç§æ¯”è¾ƒè‡ªç„¶çš„æ„é€ æ€è·¯ï¼šå°è¯•æ„é€ ç”¨çš„è¾¹å°½é‡å°‘çš„æ–¹æ¡ˆã€‚ç”±äºé¢˜ç›®é‡Œæ²¡æœ‰é™åˆ¶æœ€å°‘ï¼Œæ‰€ä»¥è¿™ä¸ªã€Œå°½é‡å°‘ã€å°±åªæ˜¯å°½é‡å°‘ã€‚å¤§æ¦‚æ˜¯çç”»ç”»å¯ä»¥å‘ç°ï¼Œå¦‚æœä¸€ä¸ªå¥‡åº¦ç‚¹è¿æˆäº†å¶åº¦ç‚¹ï¼Œé‚£ä¹ˆå®ƒå¯èƒ½ä¼šå½±å“å¦å¤–ä¸€ä¸ªå¥‡åº¦ç‚¹ï¼Œé‚£ä¹ˆå¦å¤–çš„å¥‡åº¦ç‚¹å¯èƒ½ä¹‹å‰å˜æˆäº†å¶åº¦ç‚¹ä½†æ˜¯ç°åœ¨åˆå˜å›äº†å¥‡åº¦ç‚¹ã€‚äºæ˜¯å°±å¯ä»¥æƒ³åˆ°å»ºå‡º<strong>è¡¥å›¾çš„ä¸€æ£µç”Ÿæˆæ£®æ—</strong>æ¥ï¼Œä»å¶å­å¼€å§‹ä¸æ–­å’Œçˆ¶äº²è¿è¾¹+åˆ ç‚¹ï¼Œç›´åˆ°ä¸åˆæ³•ä¸ºæ­¢ã€‚ä¸éš¾çŸ¥é“è¿™æ ·åšæ˜¯å¯¹çš„ã€‚</p><p>é‚£ä¹ˆåœ¨ä¿è¯éƒ½æ˜¯å¶åº¦ç‚¹ä¹‹åï¼Œé—®é¢˜å°±å˜æˆäº†å¦‚ä½•è¿è¾¹ä½¿å¾—è¿™ä¸ªå›¾è¿é€šã€‚å‘ç°å¦‚æœæœ‰ $\geqslant 3$ ä¸ªè¿é€šå—ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ¯ä¸ªè¿é€šå—éšä¾¿é€‰ä¸ªç‚¹è¿ä¸€ä¸ªç¯å‡ºæ¥ã€‚å¦‚æœåªæœ‰ $2$ ä¸ªè¿é€šå—ï¼Œå¤§æ¦‚æ˜¯è¦æ¯”è¾ƒéº»çƒ¦åœ°è®¨è®ºä¸€æ³¢ï¼Œä½†ä¹Ÿä¸éš¾ã€‚</p><p>å—¯ï¼Œæ„Ÿè§‰æ˜¯ä¸ªæŒºéœ€è¦ç†Ÿç»ƒæŒæ¡æ„é€ æŠ€å·§çš„é¢˜ç›®ã€‚</p><h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="8.png" alt=""></p><p>$0 \leq x+y \leq \sum a_{i} \leq 100,x, y, z \geq 0, n, a_{i} \geq 1$ ã€‚</p></blockquote><p>ä¸‹æ–‡é»˜è®¤æŠŠé¢˜ç›®é‡Œçš„ $x,y,z$ æ›¿æ¢ä¸º $X,Y,Z$ ã€‚</p><p>å…·ä½“æ€è·¯å¤§æ¦‚æ˜¯åˆ†ä¸¤éƒ¨åˆ†åšã€‚é¦–å…ˆç®—å‡ºæ‹¿åˆ°æ¯ä¸ªèŠ±è‰²çš„æ¦‚ç‡ï¼Œç„¶åå†ç®—æ¯ä¸ªèŠ±è‰²è·èƒœçš„æ¦‚ç‡ã€‚</p><p>å…ˆè€ƒè™‘å¯¹äºä¸€ä¸ªå›ºå®šçš„èŠ±è‰² $x$  å¦‚ä½•è®¡ç®—å…¶è·èƒœçš„æ¦‚ç‡ã€‚ä»¤ $s=\sum a_i$ï¼Œå° E æ‹¿äº†$p_x$ ä¸ªï¼Œä¸éš¾çŸ¥é“åº”è¯¥æ˜¯</p><script type="math/tex; mode=display">\Pr(c=x,p_x)=\frac{\sum_i \binom{a_x-p_x}{i}\times \binom{s-(a_x-p_x)-X}{Y-i}\times [p_x\geq i+z]}{\binom{s-X}{Y}}</script><p>ç„¶åè€ƒè™‘è®¡ç®—å‘ç”Ÿçš„æ¦‚ç‡ã€‚å‘ç°å¦‚æœæƒ³è¦è®¡ç®—ä¸€ä¸ªæƒ…å†µçš„å‘ç”Ÿæ¦‚ç‡ï¼Œéœ€è¦ç¡®å®šæ‰€æœ‰é™¤ $x$ ä»¥å¤–çš„ $p_y$ ã€‚äºæ˜¯å¯ä»¥ç”¨ä¸€ä¸ªèƒŒåŒ… $f_{i,v}$ è¡¨ç¤ºè€ƒè™‘äº†å‰ $i$ ä¸ªèŠ±è‰²ã€å½“å‰èŠ±è‰² $x$ ä¸è®¡ç®—æ—¶ï¼Œä¸€å…±é€‰äº† $v$ å¼ å¡ç‰Œçš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»ä¸€æ³¢ä¹‹åå°±å¯ä»¥çŸ¥é“ç­”æ¡ˆåº”è¯¥ä¸º</p><script type="math/tex; mode=display">\sum \Pr (c=x,p_x)\times \binom{a_x}{p_x}\times f_{n,X-p_x}</script><p>ç„¶åé—®é¢˜å°±åœ¨å¦‚ä½•ä¿è¯ $dp$ çš„æ­£ç¡®æ€§ã€‚è€ƒè™‘å¦‚æœæŸç§ç±»åˆ«çš„ç‰Œæ‹¥æœ‰çš„è¶Šå¤šï¼Œè¿™ä¸ªé¢œè‰²çš„èƒœç‡å°±è¶Šå¤§ã€‚æ‰€ä»¥å¯ä»¥å…ˆæŠŠæ‰€æœ‰å¯èƒ½å‡ºç°çš„æ¦‚ç‡ä»å°åˆ°å¤§æ’ä¸ªåºâ€”â€”ä¸éš¾çŸ¥é“æœ¬è´¨ä¸åŒçš„æ¦‚ç‡æ˜¯ $O(s)$ çš„â€”â€”é‚£ä¹ˆè¿™æ ·å°±å¯ä»¥ä¿è¯æ‰€æœ‰é¢œè‰²å¯ä»¥å–åˆ°çš„èŒƒå›´å•è°ƒé€’å¢çš„ã€‚æ˜¯ä¸ªæŒºå¦™çš„ç¦»æ•£åŒ–æŠ€å·§ã€‚</p><p>ç„¶åè€ƒè™‘æœ¬è´¨ä¸åŒçš„æ¦‚ç‡ï¼Œæœ€å¤§ä¸ä¼šè¶…è¿‡åˆ†æ¯ï¼Œä¹Ÿå°±æ˜¯ $\dbinom{100}{50}$ ã€‚æ‰€ä»¥å¯ä»¥æ‹¿ <code>__int128</code> æ¥å­˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1050</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">__int128_t</span> bill ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> pair&lt; bill, pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; pbii ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line"><span class="keyword">int</span> mxu[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> f[N][N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, X, Y, Z ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> &lt;pbii&gt; All_pr ;</span><br><span class="line"></span><br><span class="line">ll fac[N] = &#123;<span class="number">1</span>&#125; ;</span><br><span class="line">ll inv[N] = &#123;<span class="number">1</span>&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(T &amp;x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x += y ; x = x &gt;= mod ? x - mod : x ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">il ll <span class="title">expow</span><span class="params">(ll x, ll y, ll mod = P)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (y)&#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = res * x % mod ;</span><br><span class="line">        x = x * x % mod ; y &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il ll <span class="title">comb</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; y) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">return</span> fac[x] * inv[y] % P * inv[x - y] % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il ll <span class="title">Pr</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line"><span class="comment">//æ€»å…±æœ‰ s ä¸ªï¼Œå° a æ‹¿äº† t ä¸ª.è¦æ»¡è¶³ i+Z&lt;=t i&lt;=t-Z</span></span><br><span class="line">    ll ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= t - Z &amp;&amp; i &lt;= Y ; ++ i)</span><br><span class="line">        add(ret, comb(s - t, i) * comb(n - X - (s - t), Y - i) % P) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il bill <span class="title">bicomb</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    bill ret = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; y) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (bill i = x - y + <span class="number">1</span> ; i &lt;= x ; ++ i) ret *= i ;</span><br><span class="line">    <span class="keyword">for</span> (bill i = <span class="number">1</span> ; i &lt;= y ; ++ i) ret /= i ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">il pbii <span class="title">Pr</span><span class="params">(<span class="keyword">int</span> col, <span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line">    bill ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= t - Z &amp;&amp; i &lt;= Y ; ++ i)</span><br><span class="line">        ret += bicomb(s - t, i) * bicomb(n - X - (s - t), Y - i) ;</span><br><span class="line">    <span class="keyword">return</span> make_pair(ret, make_pair(col, t)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(<span class="keyword">int</span> col, <span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f)) ; f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (i == col)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= s ; ++ j) f[i][j] = f[i - <span class="number">1</span>][j] ;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= s ; ++ j)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt;= min(j, mxu[i]) ; ++ k)</span><br><span class="line">                    add(f[i][j], f[i - <span class="number">1</span>][j - k] * comb(base[i], k) % P) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[m][s] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m &gt;&gt; X &gt;&gt; Y &gt;&gt; Z ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; base[i], n += base[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        fac[i] = fac[i - <span class="number">1</span>] * i % P ;</span><br><span class="line">    inv[n] = expow(fac[n], P - <span class="number">2</span>, P) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span> ; i ; -- i)</span><br><span class="line">        inv[i] = inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % P ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, k ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        k = min(X, base[i]) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = Z ; j &lt;= k ; ++ j)</span><br><span class="line">            All_pr.push_back(Pr(i, base[i], j)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(All_pr.begin(), All_pr.end()) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        mxu[i] = min(Z - <span class="number">1</span>, base[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> t : All_pr)&#123;</span><br><span class="line">        <span class="keyword">int</span> c = t.sc.fr ;</span><br><span class="line">        <span class="keyword">int</span> o = base[c] ;</span><br><span class="line">        <span class="keyword">int</span> u = t.sc.sc ;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; (ll)t.fr &lt;&lt; " " &lt;&lt; c &lt;&lt; " " &lt;&lt; u &lt;&lt; '\n' ;</span></span><br><span class="line">        add(ans, comb(o, u) * Pr(o, u) % P * solve(c, X - u) % P) ;</span><br><span class="line">        mxu[c] = u ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    printf("%lld\n", ans) ;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans * expow(comb(n, X) * comb(n - X, Y) % P, P - <span class="number">2</span>) % P) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åˆæ˜¯è¥ä¸šçš„æ—¶å€™äº†.&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ZROI" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/ZROI/"/>
    
    
      <category term="å­—ç¬¦ä¸²/å“ˆå¸Œ" scheme="https://www.orchidany.cn/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2-%E5%93%88%E5%B8%8C/"/>
    
      <category term="æ€ç»´é¢˜/è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E8%AE%A1%E6%95%B0/"/>
    
      <category term="æ€ç»´é¢˜/æ„é€ " scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%9E%84%E9%80%A0/"/>
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="æ•°å­¦/æ¦‚ç‡,æœŸæœ›" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E6%A6%82%E7%8E%87-%E6%9C%9F%E6%9C%9B/"/>
    
      <category term="ç»„åˆè®¡æ•°/æœ‰æŠ€å·§çš„è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84%E8%AE%A1%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>ã€èµ›é¢˜æ•´ç†ã€‘[Codeforces Round#502(Combined) A~G] é¢˜è§£</title>
    <link href="https://www.orchidany.cn/2020/06/14/CF-Round-502/"/>
    <id>https://www.orchidany.cn/2020/06/14/CF-Round-502/</id>
    <published>2020-06-14T10:47:01.000Z</published>
    <updated>2020-06-15T07:50:41.969Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¿™ä¸€åœºæ˜¯ SD çš„é™ˆé†‰å‰è¾ˆå’Œ lxl ä¸€èµ·åˆåŠçš„ã€‚æ„Ÿè§‰è´¨é‡è¿˜æ˜¯å¯ä»¥çš„ï¼Ÿè™½ç„¶æ„Ÿè§‰è¿™åœºæ¯”èµ›å”¯ä¸€çš„äº®ç‚¹å°±åœ¨äº Gâ€¦</p><a id="more"></a><h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><p>å°±çŸ¥é“è®©ä¸­å›½äººå‡ºè¿™ç§Aå°±ä¼šå‡ºå¥‡æ€ªçš„æ¨¡æ‹Ÿé¢˜ 233</p><h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><p>éœ€è¦ç‚¹æ€è€ƒçš„é¢˜ã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘åªæœ‰ $a$ ä¸­å½¢å¦‚ $0â€¦1$ å¯¹åº” $b$ ä¸­çš„ä¸€ä¸ª $0â€¦0$ æˆ–è€… $0â€¦1$ æ‰ä¼šäº§ç”Ÿè´¡çŒ®ã€‚ç„¶åå°±æ‰«ä¸€ä¸‹ $a$ çš„æ¯ä¸€ä½è®¡ä¸ªæ•°å°±å¥½äº†ã€‚</p><h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><p>æ„Ÿè§‰è¿™é¢˜å°±æ˜¯ååˆ†çš„ç‰›ã€‚</p><blockquote><p>ç»™å®šä¸€ä¸ªæ•° $n$ ã€‚æ±‚æ„é€ ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ’åˆ—ï¼Œä½¿ä¹‹ $\rm LIS+LDS$ æœ€å°ã€‚</p></blockquote><p>ä¸€å¼€å§‹è¯»é¢˜è¯»æˆäº†æœ€å¤§å€¼ã€‚ç„¶åéšä¾¿ç”»äº†ç”»å‘ç°ç­”æ¡ˆå°±æ˜¯ $n+1$ emmm</p><p>ç„¶åè¯»å®Œäº†éšä¾¿å†™äº†ä¸ªå¥‡æ€ªçš„ä¸œè¥¿è¢«è½»æ¾å‰äº†ï¼Œä¹‹åå‘ç°åŸæ¥æ˜¯ä¸ªæ¯”è¾ƒå¼ºçš„é¢˜ã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘ dilworth å®šç†ï¼Œæœ€é•¿ä¸Šå‡/ä¸‹é™å­åºåˆ—é•¿åº¦ç­‰äºå…¶åé“¾çš„æœ€å¤šåºåˆ—æ•°ã€‚é‚£ä¹ˆè€ƒè™‘å¦‚æœæ˜¯è¦ç®— LIS+LDS ä¹‹å’Œçš„è¯ï¼Œå¯¹äºä¸€ä¸ª LIS çš„å®šé•¿ $L$ ï¼Œæ ¹æ® dilworth å®šç†å¿…ç„¶ä¼šå­˜åœ¨ $L$ ä¸ªåé“¾ï¼Œä¹Ÿå°±æ˜¯ $L$ ä¸ª DS ã€‚äºæ˜¯å¯ä»¥çŸ¥é“æœ€åæœ‰</p><script type="math/tex; mode=display">{\rm LIS+LDS}=\left\lceil \frac{n}{L}\right\rceil+L</script><p>å³ä¸ºäº†ä½¿ $L$ ä¸ª DS çš„æœ€å¤§é•¿åº¦æœ€å°ï¼Œæ‰€ä»¥è¦å°½é‡åˆ†çš„å¹³å‡ä¸€ç‚¹ã€‚é‚£ä¹ˆå¯ä»¥çŸ¥é“è¿™ä¸ª $L$ åº”è¯¥å– $\sqrt n$ ã€‚</p><p>é‚£ä¹ˆä¹‹åå°±å˜æˆäº†å¦‚ä½•æ„é€ ä¸€ä¸ª LIS ä¸º $\sqrt n$ï¼ŒLDS ä¸º $\left\lceil\dfrac{n}{\sqrt n}\right\rceil$ çš„ä¸²ã€‚ä¸éš¾çŸ¥é“å¯ä»¥åˆ†æ®µæ„é€ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) ;</span><br><span class="line">    m = <span class="built_in">std</span> :: <span class="built_in">ceil</span>(<span class="built_in">std</span> :: <span class="built_in">sqrt</span>(n)) ;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    if (n &amp; 1)&#123;</span></span><br><span class="line"><span class="comment">        ans[(n &gt;&gt; 1) + 1] = n ;</span></span><br><span class="line"><span class="comment">        for (int i = 1 ; i &lt;= n &gt;&gt; 1 ; ++ i) ans[i] = i ;</span></span><br><span class="line"><span class="comment">        for (int i = (n &gt;&gt; 1) + 2 ; i &lt;= n ; ++ i) ans[i] = n - i + ((n &gt;&gt; 1) + 1) ;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    else &#123;</span></span><br><span class="line"><span class="comment">        for (int i = 1 ; i &lt;= (n &gt;&gt; 1) ; ++ i) ans[i] = i ;</span></span><br><span class="line"><span class="comment">        for (int i = (n &gt;&gt; 1) + 1 ; i &lt;= n ; ++ i) ans[i] = n - i + ((n &gt;&gt; 1) + 1) ;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    for (int i = 1 ; i &lt;= n &gt;&gt; 1 ; ++ i) res[i] = ans[i + (n &gt;&gt; 1)] ;</span></span><br><span class="line"><span class="comment">    for (int i = (n &gt;&gt; 1) + 1 ; i &lt;= n ; ++ i) res[i] = ans[i - (n &gt;&gt; 1)] ;*/</span></span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">0</span>, q, k = n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="built_in">std</span> :: <span class="built_in">ceil</span>(<span class="number">1.0</span> * n / m) ; ++ i)&#123;</span><br><span class="line">        q = p ; <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= m &amp;&amp; p &lt; n ; ++ j) ans[++ p] = k -- ;</span><br><span class="line">        <span class="built_in">std</span> :: reverse(ans + q + <span class="number">1</span>, ans + p + <span class="number">1</span>) ; <span class="comment">// printf("%d %d %d\n", i, q + 1, p) ;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[i]) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><p>ç®€å•é¢˜ã€‚å‘ç°å¯ä»¥ $(2^n)^2$ é¢„å¤„ç†ä¹‹åï¼Œè¯¢é—®å°±å¯ä»¥ $\log $ äº†ã€‚</p><h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><p>è®¡ç®—å‡ ä½•é¢˜ï¼Œè·³äº†ã€‚</p><h1 id="F"><a href="#F" class="headerlink" title="F"></a>F</h1><blockquote><p>å®šä¹‰ $\text{exlog} _ f(p _ 1^{a _ 1}p _ 2^{a _ 2}â€¦p _ k^{a _ 2}) = a _ 1 f(p _ 1) + a _ 2 f(p _ 2) + â€¦ + a _ k f(p _ k)$ï¼Œå…¶ä¸­ $f(x)=Ax^3+Bx^2+Cx+D$ ï¼Œæ±‚ $\sum _ {i=1} ^ n \text{exlog} _ f(i)$</p><p>$1 \le n \le 3 \times 10 ^ 8,0 \le A,B,C,D \le 10 ^ 6$ ã€‚</p><p>æ—¶é™ $5s$ï¼Œç©ºé—´é™åˆ¶ $16\rm Mib$ ã€‚</p></blockquote><p>é¦–å…ˆè¦æœ‰ä¸ª Observationï¼Œå¤§æ¦‚å°±æ˜¯è¯´å¯ä»¥å‘ç°å¯¹äºæ¯ä¸ªè´¨æ•°çš„å¹‚æ¬¡ $a_i$ï¼Œä½œä¸ºä¹˜æ³•ç³»æ•°æ˜¯ç‹¬ç«‹çš„ã€‚æ‰€ä»¥ä¼šæœ‰ $\text{exlog}_f(a\cdot b)=\text{exlog}_f(a)+\text{exlog}_f(b)$ ã€‚ä½†æ˜¯è¿™æ ·ç›´æ¥ç­›çš„å¤æ‚åº¦å¹¶ä¸èƒ½è¿‡ï¼Œç©ºé—´ä¼šçˆ†ã€‚ç„¶åè€ƒè™‘å¦‚ä½•ä¼˜åŒ–è¿™ä¸€è¿‡ç¨‹ã€‚</p><p>å¤§æ¦‚æ˜¯è¯´å¯ä»¥è€ƒè™‘æ¯ä¸ªè´¨å› æ•°äº§ç”Ÿçš„è´¡çŒ®ï¼Œå½¼æ­¤ä¹‹é—´æ˜¯<strong>çº¿æ€§æ— å…³</strong>çš„ ï¼Œæ‰€ä»¥å¯ä»¥åˆ†åˆ«è€ƒè™‘æ¯ä¸ªè´¨æ•°å¹‚çš„è´¡çŒ®ã€‚å…·ä½“çš„ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚å‡ºæ‰€æœ‰çš„è´¨æ•°ä»¥åŠè´¨æ•°çš„å¹‚å¯¹ç­”æ¡ˆçš„è´¡çŒ®å°±å¥½äº†ï¼Œè¿™éƒ¨åˆ†ä¸ºäº†å¡ç©ºé—´å¯ä»¥ç”¨åŸƒæ°ç­›ã€‚</p><p>ä½†æ˜¯å‘ç°è¿˜æ˜¯è¿‡ä¸å»ã€‚å› ä¸ºåŸƒæ°ç­›çš„å¤æ‚åº¦å¤ªé«˜äº†ã€‚ä¸è¿‡ä»”ç»†åˆ†æä¸€æ³¢ï¼Œå‘ç°æ…¢åœ¨è¯¸å¦‚ $2,3,5,7$ è¿™ç§æ¯”è¾ƒå°çš„è´¨å› å­ $p$ï¼Œä¼šè¿›è¡Œ $\left\lfloor\dfrac{n}{p}\right\rfloor$ æ¬¡ç­›é™¤æ“ä½œã€‚äºæ˜¯å¯ä»¥å…ˆæš´åŠ›è·‘å‡º $2,3,5,7$ çš„è´¡çŒ®ï¼Œç„¶åç®—å…¶ä»–çš„æ—¶å°±å¯ä»¥ä¸è€ƒè™‘è¿™äº›æ•°äº†ã€‚</p><p>ä½†æ˜¯å‘ç°è¿™æ ·ç©ºé—´è¿˜æ˜¯ä¼šæœ‰ç‚¹é—®é¢˜ã€‚äºæ˜¯å¯ä»¥ç”¨ <code>bitset</code> + åˆå¹¶çŠ¶æ€æ¥å‹ç¼©ã€‚åˆå¹¶çŠ¶æ€çš„åŸç†æ˜¯åˆ¨é™¤äº†æ‰€æœ‰ $2,3$ çš„å€æ•°ä¹‹åï¼Œç©ºé—´å°±å¯ä»¥åªå¼€ $\dfrac{1}{3}$ ã€‚</p><p>ä¸ªäººè§‰å¾—è¿™é¢˜èƒ½æ”¾åˆ° Fï¼Œå”¯ä¸€çš„åŸå› å°±æ˜¯å› ä¸ºéœ€è¦ååˆ†ä¼˜ç§€çš„å¡å¸¸ and å¡ç©ºé—´æŠ€æœ¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100000005</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: <span class="built_in">bitset</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> lint ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="built_in">bitset</span> &lt;N&gt; vis ;</span><br><span class="line"><span class="keyword">int</span> A, B, C, D ;</span><br><span class="line"></span><br><span class="line">lint ans ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> ((!(x &amp; <span class="number">1</span>)) || (x % <span class="number">3</span> == <span class="number">0</span>) || (x % <span class="number">5</span> == <span class="number">0</span>)) ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lint <span class="title">calc</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1u</span> * A * p * p * p + <span class="number">1u</span> * B * p * p + <span class="number">1u</span> * C * p + D ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">lint <span class="title">solve</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    lint ret = <span class="number">0</span>, v = calc(p) ;</span><br><span class="line">    <span class="keyword">for</span> (ll x = p ; x &lt;= n ; x *= p)</span><br><span class="line">        ret += <span class="number">1u</span> * (n / x) * v ; <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) ; ans = <span class="number">0</span> ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;A, &amp;B, &amp;C, &amp;D) ;</span><br><span class="line"><span class="keyword">if</span> (n &gt;= <span class="number">2</span>) ans += solve(<span class="number">2</span>) ; </span><br><span class="line"><span class="keyword">if</span> (n &gt;= <span class="number">3</span>) ans += solve(<span class="number">3</span>) ;</span><br><span class="line"><span class="keyword">if</span> (n &gt;= <span class="number">5</span>) ans += solve(<span class="number">5</span>) ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">7</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line"><span class="keyword">if</span> (chk(i)) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">if</span> (vis[i / <span class="number">3</span>]) <span class="keyword">continue</span> ; ans += solve(i) ; <span class="comment">//printf("%u\n", ans) ;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + i ; j &lt;= n ; j += i) </span><br><span class="line"><span class="keyword">if</span> (!chk(j)) vis[j / <span class="number">3</span>] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%u\n"</span>, ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="G"><a href="#G" class="headerlink" title="G"></a>G</h1><p>è¿™æ˜¯çœŸç¥é¢˜ã€‚</p><blockquote><p>ç»™å®šä¸€æ£µæ ‘ï¼Œç»´æŠ¤ä»¥ä¸‹ $3$ ä¸ªæ“ä½œï¼š</p><p>ï¼ˆ1ï¼‰<code>1 x</code> è¡¨ç¤ºå¦‚æœèŠ‚ç‚¹ $x$ ä¸ºç™½è‰²ï¼Œåˆ™å°†å…¶æŸ“é»‘ã€‚å¦åˆ™å¯¹è¿™ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å„¿å­é€’å½’è¿›è¡Œç›¸åŒæ“ä½œã€‚</p><p>ï¼ˆ2ï¼‰<code>2 x</code>è¡¨ç¤ºå°†ä»¥èŠ‚ç‚¹ $x$ ä¸º $root$ çš„å­æ ‘æŸ“ç™½ã€‚</p><p>ï¼ˆ3ï¼‰<code>3 x</code>è¡¨ç¤ºæŸ¥è¯¢èŠ‚ç‚¹ $x$ çš„é¢œè‰²</p><p>$1\leq n\leq 10^5$ ã€‚</p></blockquote><p>é¦–å…ˆè§‚å¯Ÿå‘ç°ï¼Œæ“ä½œçš„å¤æ‚åº¦å‘ä¿®æ”¹å€¾æ–œï¼Œå³è¯¢é—®å¤æ‚åº¦æ¯”è¾ƒä½ï¼Œå¯ä»¥è€ƒè™‘è¯¢é—®çš„æ—¶å€™æç‚¹äº‹æƒ…ã€‚</p><p>è€ƒè™‘ $(1)$ æ“ä½œçš„æœ¬è´¨ã€‚å› ä¸ºè¦å‘è¯¢é—®å€¾æ–œï¼Œæ‰€ä»¥è€ƒè™‘å¦‚æœæŸä¸ªç‚¹ $z$ ä¼šè¢« <code>1 x</code> å½±å“åˆ° ï¼Œé‚£ä¹ˆå¿…ç„¶æœ‰ $x\sim z$ è¿™æ¡è·¯å¾„ä¸Šé™¤äº† $x$ ä¹‹å¤–çš„æ‰€æœ‰ç‚¹éƒ½å·²ç»è¢«æŸ“é»‘äº†ã€‚</p><p>è€ƒè™‘å¿½ç•¥ $(2)$ æ“ä½œæ—¶ï¼Œå¦‚ä½•é€šè¿‡ç»´æŠ¤æƒå€¼å®ç°è¿™ä¸ªäº‹æƒ…ã€‚ä¸€å¼€å§‹å°†å…¨éƒ¨çš„ç‚¹æƒè®¾ä¸º $0$ï¼Œæ¯æ¬¡ $(1)$ æ“ä½œå°±æ˜¯å¯¹è¯¥ç‚¹è¿›è¡Œå•ç‚¹ $+1$ ã€‚è¿™æ ·è¯¢é—®å°±å¯ä»¥è€ƒè™‘è¯¢é—® $root\to x$ è¿™æ¡è·¯å¾„ä¸Šï¼Œæ˜¯å¦å­˜åœ¨ä¸€ä¸ªåç¼€ $(s,x)$ çš„æƒå’Œç­‰äº $(s,x)$ çš„é•¿åº¦ã€‚è¿™æ ·ç›´æ¥åšæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ ‘é“¾ä¸Šçš„çº¿æ®µæ ‘äºŒåˆ†ï¼Œä½†å…¶å®å¯ä»¥ç”¨ä¸€ä¸ªæ¯”è¾ƒä¼ ç»Ÿçš„æŠ€å·§ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œå³å·®åˆ†ã€‚è€ƒè™‘æŠŠæ¯ä¸ªç‚¹çš„åˆå§‹ç‚¹æƒè®¾ä¸º $-1$ ï¼Œè¿™æ ·å°±æ˜¯è¯¢é—®æ˜¯å¦å­˜åœ¨ä¸€ä¸ªåç¼€ï¼Œå…¶å’Œ $\geqslant 0$ ã€‚è¿™ä¸ªå¯ä»¥é€šè¿‡ç»´æŠ¤é“¾ä¸Šçš„æœ€å¤§åç¼€å’Œæ¥åšï¼Œå†™èµ·æ¥ç®€å•ä¸€äº›ã€‚</p><p>ç„¶åè€ƒè™‘åŠ ä¸Š $(2)$ æ“ä½œåå¦‚ä½•å¿«é€Ÿç»´æŠ¤ã€‚å‘ç° $(2)$ æ“ä½œçš„æœ¬è´¨æ˜¯è®©æ•´æ£µå­æ ‘çš„ç‚¹æƒå‡å˜ä¸º $-1$ ã€‚ä½†è¿™è¿˜ä¸å¤Ÿï¼Œå› ä¸º $(2)$ æœ¬è´¨ä¸Šæ˜¯å¼ºåˆ¶è®©æŸä¸ªç‚¹ $x$ å˜æˆç™½è‰²ï¼Œè€Œä¸Šé¢é‚£ä¸ªåšæ³•æœ¬è´¨ä¸Šæ˜¯å¯¹ä¿®æ”¹ç¦»çº¿ï¼Œæœ€åå†åˆ†åˆ«ç¡®å®šæ¯ä¸ªä¿®æ”¹å¯¹ç­”æ¡ˆçš„è´¡çŒ®ã€‚ä¸è¿‡ä¹Ÿæœ‰æ¯”è¾ƒç®€å•çš„è§£å†³æ–¹å¼ï¼Œå³è®© <code>2 x</code> ä¸­çš„ $x$ å•ç‚¹å‡ä¸€ä¸ªæƒå€¼ $v$ ï¼Œä½¿å¾— $root\to x$ ä¸Šçš„æœ€å¤§åç¼€å’Œä¹Ÿä¸º $-1$ ã€‚ä¸éš¾å‘ç° $v=qry(x)+1$ ã€‚</p><p>äºæ˜¯æœ€åå°±å¯ä»¥ç”¨ $n\log ^2n $ çš„å¤æ‚åº¦è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_b push_back</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: max ;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: min ;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: <span class="built_in">vector</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> n, q ;</span><br><span class="line"><span class="keyword">int</span> sz[N] ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">int</span> _id[N] ;</span><br><span class="line"><span class="keyword">int</span> dfn[N] ;</span><br><span class="line"><span class="keyword">int</span> son[N] ;</span><br><span class="line"><span class="keyword">int</span> dep[N] ;</span><br><span class="line"><span class="keyword">int</span> top[N] ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; E[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> da)</span></span>&#123;</span><br><span class="line">    dep[x] = dep[da] + <span class="number">1</span> ;</span><br><span class="line">    sz[x] = <span class="number">1</span>, fa[x] = da ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (y == da) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs1(y, x) ; sz[x] += sz[y] ;</span><br><span class="line">        <span class="keyword">if</span> (sz[y] &gt; sz[son[x]]) son[x] = y ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> tp)</span></span>&#123;</span><br><span class="line">    top[x] = tp ; ++ cnt ;</span><br><span class="line">    _id[dfn[x] = cnt] = x ;</span><br><span class="line">    <span class="keyword">if</span> (son[x])</span><br><span class="line">        dfs2(son[x], tp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])</span><br><span class="line">        <span class="keyword">if</span> (y != fa[x] &amp;&amp; y != son[x]) dfs2(y, y) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> seg[N * <span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">int</span> val[N * <span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">int</span> tag[N * <span class="number">3</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (rt &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc (rt &lt;&lt; 1 | 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _up(<span class="keyword">int</span> rt)&#123;</span><br><span class="line">    seg[rt] = seg[lc] + seg[rc] ;</span><br><span class="line">    val[rt] = max(val[rc], val[lc] + seg[rc]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _down(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)&#123;</span><br><span class="line">    <span class="keyword">if</span> (!tag[rt]) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    seg[rc] =  - (r - mid) ;</span><br><span class="line">    seg[lc] =  - (mid - l + <span class="number">1</span>) ;</span><br><span class="line">    val[lc] = <span class="number">-1</span>, val[rc] = <span class="number">-1</span> ;</span><br><span class="line">    tag[rc] = tag[lc] = <span class="number">1</span>, tag[rt] = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>(seg[rt] = val[rt] = <span class="number">-1</span>) ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    build(rc, mid + <span class="number">1</span>, r) ;</span><br><span class="line">    build(lc, l, mid) ; _up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">        seg[rt] += v ;</span><br><span class="line">        val[rt] += v ;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    _down(rt, l, r) ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid) upd(lc, l, mid, p, v) ;</span><br><span class="line">    <span class="keyword">else</span> upd(rc, mid + <span class="number">1</span>, r, p, v) ;</span><br><span class="line">    _up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cov</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> cl, <span class="keyword">int</span> cr)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (cl &lt;= l &amp;&amp; r &lt;= cr)&#123;</span><br><span class="line">        seg[rt] = - (r - l + <span class="number">1</span>) ;</span><br><span class="line">        val[rt] = <span class="number">-1</span> ; <span class="keyword">return</span> <span class="keyword">void</span>(tag[rt] = <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ; _down(rt, l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (cr &gt; mid) cov(rc, mid + <span class="number">1</span>, r, cl, cr) ;</span><br><span class="line">    <span class="keyword">if</span> (cl &lt;= mid) cov(lc, l, mid, cl, cr) ; _up(rt) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) <span class="keyword">return</span> seg[rt] ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = <span class="number">0</span> ; _down(rt, l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= mid) ret += sum(lc, l, mid, ql, qr) ;</span><br><span class="line">    <span class="keyword">if</span> (qr &gt; mid) ret += sum(rc, mid + <span class="number">1</span>, r, ql, qr) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qry</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span></span>&#123;</span><br><span class="line">     _down(rt, l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) <span class="keyword">return</span> val[rt] ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = - n ; _down(rt, l, r) ;</span><br><span class="line">    <span class="keyword">if</span> (ql &lt;= mid) ret = max(ret, qry(lc, l, mid, ql, qr)) ;</span><br><span class="line">    <span class="keyword">if</span> (qr &gt; mid) ret = max(ret + sum(rc, mid + <span class="number">1</span>, r, ql, qr), qry(rc, mid + <span class="number">1</span>, r, ql, qr)) ;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Q</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret, v = <span class="number">0</span> ;</span><br><span class="line">    ret = -(n + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (top[x] &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        ret = max(ret, v + qry(<span class="number">1</span>, <span class="number">1</span>, n, dfn[top[x]], dfn[x])) ;</span><br><span class="line">        v += sum(<span class="number">1</span>, <span class="number">1</span>, n, dfn[top[x]], dfn[x]) ; x = fa[top[x]] ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    printf("%d\n", qry(1, 1, n, dfn[top[x]], dfn[x])) ;</span></span><br><span class="line">    ret = max(ret, v + qry(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>, dfn[x])) ; <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;q) ; <span class="keyword">int</span> x, z ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">2</span> ; y &lt;= n ; ++ y)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), E[x].p_b(y), E[y].p_b(x) ;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">0</span>) ; dfs2(<span class="number">1</span>, <span class="number">1</span>) ; build(<span class="number">1</span>, <span class="number">1</span>, n) ;</span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= n ; ++ i) printf("%d%c", top[i], " \n"[i == n]) ;</span></span><br><span class="line"><span class="comment">//        printf("%d %d\n", i, sz[i]) ;</span></span><br><span class="line">    <span class="keyword">while</span> (q --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;z, &amp;x) ;</span><br><span class="line">        <span class="keyword">if</span> (z == <span class="number">1</span>) upd(<span class="number">1</span>, <span class="number">1</span>, n, dfn[x], <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (z == <span class="number">2</span>)&#123;</span><br><span class="line">            cov(<span class="number">1</span>, <span class="number">1</span>, n, dfn[x], dfn[x] + sz[x] - <span class="number">1</span>) ;</span><br><span class="line">            upd(<span class="number">1</span>, <span class="number">1</span>, n, dfn[x], - Q(x) - <span class="number">1</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (z == <span class="number">3</span>)&#123;</span><br><span class="line"><span class="comment">//            printf("%d\n", Q(x)) ;</span></span><br><span class="line">            ans = (<span class="keyword">bool</span>)(Q(x) &gt;= <span class="number">0</span>) ;</span><br><span class="line">            <span class="built_in">puts</span>(ans ? <span class="string">"black"</span> : <span class="string">"white"</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//for(int p=1;p&lt;=3 * n;++p)printf("%d%c", val[p], " \n"[p == 3 * n]);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™ä¸€åœºæ˜¯ SD çš„é™ˆé†‰å‰è¾ˆå’Œ lxl ä¸€èµ·åˆåŠçš„ã€‚æ„Ÿè§‰è´¨é‡è¿˜æ˜¯å¯ä»¥çš„ï¼Ÿè™½ç„¶æ„Ÿè§‰è¿™åœºæ¯”èµ›å”¯ä¸€çš„äº®ç‚¹å°±åœ¨äº Gâ€¦&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="Codeforces" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/Codeforces/"/>
    
    
      <category term="æŠ€å·§/åˆ†æ²»" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E5%88%86%E6%B2%BB/"/>
    
      <category term="æ•°å­¦/æ•°è®º" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E6%95%B0%E8%AE%BA/"/>
    
      <category term="è´ªå¿ƒ" scheme="https://www.orchidany.cn/tags/%E8%B4%AA%E5%BF%83/"/>
    
      <category term="æœ‰æŠ€å·§çš„å·®åˆ†" scheme="https://www.orchidany.cn/tags/%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84%E5%B7%AE%E5%88%86/"/>
    
      <category term="æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è½»é‡é“¾å‰–åˆ†" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%96%B9%E6%B3%95-%E8%BD%BB%E9%87%8D%E9%93%BE%E5%89%96%E5%88%86/"/>
    
      <category term="å›¾è®º/Dilworthå®šç†" scheme="https://www.orchidany.cn/tags/%E5%9B%BE%E8%AE%BA-Dilworth%E5%AE%9A%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>ã€è®­ç»ƒè®°å½•ã€‘6.10 è®­ç»ƒç¬”è®°</title>
    <link href="https://www.orchidany.cn/2020/06/14/6-10-%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/06/14/6-10-è®­ç»ƒç¬”è®°/</id>
    <published>2020-06-14T10:41:28.000Z</published>
    <updated>2020-06-19T12:07:46.059Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>lxl çš„é¢˜ï¼Œä¸å¯åšã€‚</p><a id="more"></a><h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><blockquote><p>æœ‰ä¸€å¤©ï¼Œä½ å¾—åˆ°äº†ä¸€ä¸ª $n$ ä¸ªç‚¹çš„æ ‘ã€‚</p><p>ä½ æ„Ÿåˆ°å¾ˆå¼€å¿ƒï¼Œäºæ˜¯è®°äº†ä¸‹æ¥å’Œæ¯ä¸€ä¸ªç‚¹ç›¸é‚»çš„æ‰€æœ‰ç‚¹ä¸­ï¼Œç¼–å·æœ€å°çš„é‚£ä¸ªç‚¹å’Œç¼–å·æœ€å¤§çš„é‚£ä¸ªç‚¹æ˜¯ä»€ä¹ˆã€‚</p><p>ç„¶è€Œä¸€æ®µæ—¶é—´åï¼Œä½ æŠŠé‚£æ£µæ ‘å¼„ä¸¢äº†ï¼Œä½†æ˜¯ä½ è®°å½•çš„ä¿¡æ¯è¿˜ä¿å­˜ç€ã€‚</p><p>ä½ æƒ³å¾—åˆ°åŸæ¥çš„é‚£æ£µæ ‘ï¼Œäºæ˜¯å°è¯•æ„é€ ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è§£ã€‚</p><p>$1\leq n\leq 1000$ ã€‚</p></blockquote><p>å†™äº†ä¸ªä¹±ææäº† $50$ åˆ†ï¼Œèµ›åç¨å¾®é­”æ”¹äº†ä¸€ä¸‹å°± $60$ äº†ã€‚æ€è·¯å¤§æ¦‚æ˜¯è·Ÿ spfa çš„æ¾å¼›ä¸€æ ·ï¼Œæ¯æ¬¡ç”¨åªå«ä¸€ä¸ªæœªç›–ä¿¡æ¯çš„ç‚¹å¢å¹¿ã€‚ä½†å¾ˆæ˜¾ç„¶è¿™ç§åšæ³•å¹¶ä¸å¯¹ã€‚å› ä¸ºå¯èƒ½ä¼šå­˜åœ¨ä¸€äº›ç‚¹å‹æ ¹æ²¡åœ¨ç»™å‡ºçš„ä¿¡æ¯è¡¨é‡Œå‡ºç°è¿‡ã€‚äºæ˜¯å°±å¯ä»¥å…ˆè¿å¿…è¦çš„ä¿¡æ¯ï¼Œç„¶åç›´æ¥ç›´æ¥æš´åŠ›è¿å‰©ä¸‹çš„è¾¹ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cassert&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1050</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> h, t ;</span><br><span class="line"><span class="keyword">int</span> q[N] ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> qnow[N] ;</span><br><span class="line"><span class="keyword">int</span> A[N][N] ;</span><br><span class="line"><span class="keyword">int</span> v[N][<span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> base[N][<span class="number">2</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">no_sol</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span> ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == fa[x]) <span class="keyword">return</span> x ;</span><br><span class="line">    <span class="keyword">return</span> fa[x] = find(fa[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> f1 = find(x) ;</span><br><span class="line">    <span class="keyword">int</span> f2 = find(y) ;</span><br><span class="line">    <span class="keyword">if</span> (f1 != f2)</span><br><span class="line">        fa[f2] = f1 ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> r1 = (base[a][<span class="number">1</span>] &gt; b &amp;&amp; base[a][<span class="number">0</span>] &lt; b) ;</span><br><span class="line">    <span class="keyword">bool</span> r2 = (base[b][<span class="number">1</span>] &gt; a &amp;&amp; base[b][<span class="number">0</span>] &lt; a) ;</span><br><span class="line">    <span class="keyword">return</span> (r1 &amp;&amp; r2) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) ; h = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;v[i][<span class="number">0</span>], &amp;v[i][<span class="number">1</span>]) ;</span><br><span class="line">        <span class="keyword">if</span> (v[i][<span class="number">0</span>] == v[i][<span class="number">1</span>]) q[++ t] = i ;</span><br><span class="line">        base[i][<span class="number">0</span>] = v[i][<span class="number">0</span>], base[i][<span class="number">1</span>] = v[i][<span class="number">1</span>] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> x, y ;</span><br><span class="line">    <span class="keyword">while</span> (h &lt;= t)&#123;</span><br><span class="line">        ++ cnt ;</span><br><span class="line">        x = q[h ++] ;</span><br><span class="line">        y = v[x][<span class="number">0</span>] ;</span><br><span class="line">        <span class="keyword">int</span> &amp;ya = v[y][<span class="number">0</span>] ;</span><br><span class="line">        <span class="keyword">int</span> &amp;yb = v[y][<span class="number">1</span>] ;</span><br><span class="line">        A[y][x] = A[x][y] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">if</span> (ya == yb) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">if</span> (ya == x) ya = yb, q[++ t] = y ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (yb == x) yb = ya, q[++ t] = y ;</span><br><span class="line">        <span class="keyword">if</span> (cnt &gt;= <span class="number">50000000</span>) <span class="keyword">return</span> no_sol() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) fa[i] = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">            <span class="keyword">if</span> (A[i][j]) ++ ans, merge(i, j) ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) &#123;</span><br><span class="line"><span class="keyword">if</span> (find(i) != find(base[i][<span class="number">0</span>]))&#123;</span><br><span class="line">merge(i, base[i][<span class="number">0</span>]), ++ ans ; <span class="comment">//printf("%d %d\n", i, base[i][0]) ;</span></span><br><span class="line">A[i][base[i][<span class="number">0</span>]] = A[base[i][<span class="number">0</span>]][i] = <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (find(i) != find(base[i][<span class="number">1</span>]))&#123;</span><br><span class="line">merge(i, base[i][<span class="number">1</span>]), ++ ans ; <span class="comment">//printf("%d %d\n", i, base[i][1]) ;</span></span><br><span class="line">A[i][base[i][<span class="number">1</span>]] = A[base[i][<span class="number">1</span>]][i] = <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!A[i][base[i][<span class="number">0</span>]]) <span class="keyword">return</span> no_sol() ;</span><br><span class="line">        <span class="keyword">if</span> (!A[i][base[i][<span class="number">1</span>]]) <span class="keyword">return</span> no_sol() ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">if</span> (ans == n - <span class="number">1</span>)&#123;</span><br><span class="line">        sol : ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">                <span class="keyword">if</span> (A[i][j]) <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, i, j) ;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = n - <span class="number">1</span> - ans ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span> ; j &lt;= n ; ++ j)&#123;</span><br><span class="line">            <span class="keyword">if</span> (chk(i, j) &amp;&amp; find(i) != find(j))</span><br><span class="line">                -- ans, A[i][j] = A[j][i] = <span class="number">1</span>, merge(i, j) ;</span><br><span class="line">            <span class="keyword">if</span> (!ans) <span class="keyword">break</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!A[i][base[i][<span class="number">0</span>]]) <span class="keyword">return</span> no_sol() ;</span><br><span class="line">        <span class="keyword">if</span> (!A[i][base[i][<span class="number">1</span>]]) <span class="keyword">return</span> no_sol() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ans) <span class="keyword">return</span> no_sol() ; <span class="keyword">else</span> <span class="keyword">goto</span> sol ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="2.png" alt=""></p><p>$2 \leq n \leq 10^{5}, 1 \leq m \leq 10^{5}$ ã€‚</p></blockquote><p>æš´åŠ›æ¯”è¾ƒå¥½å†™ï¼Œä¸éš¾å‘ç°å¯ä»¥æ ‘ä¸Šå·®åˆ†ï¼Œä¹‹åè‚¯å®šé€‰ç»è¿‡çš„æœ€å¤šçš„é‚£æ¡è¾¹ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯ä»¥æšä¸¾æ ¹ç„¶å dfsã€‚</p><p>ä½†æ˜¯ä¸éš¾å‘ç°è¿™ä¸œè¥¿æ˜¯å¯ä»¥ç®€å• up and down çš„ï¼Œé¢å¤–è®°å½•ä¸€ä¸ªæ¬¡å¤§å€¼å°±å¥½äº†ã€‚å†™çš„æ—¶å€™æœ‰ç‚¹å°ç»†èŠ‚ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="keyword">using</span> IPT::qr ;</span><br><span class="line"><span class="keyword">using</span> IPT::qra ;</span><br><span class="line"><span class="keyword">using</span> IPT::qrs ;</span><br><span class="line"><span class="keyword">using</span> IPT::qrdb ;</span><br><span class="line"><span class="keyword">using</span> OPT::qw ;</span><br><span class="line"><span class="keyword">using</span> OPT::qwa ;</span><br><span class="line"><span class="keyword">using</span> OPT::qws ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_b push_back</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span> :: <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; vint ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> sz[N] ;</span><br><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">int</span> son[N] ;</span><br><span class="line"><span class="keyword">int</span> dep[N] ;</span><br><span class="line"><span class="keyword">int</span> top[N] ;</span><br><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line">ll f[N] ;</span><br><span class="line">ll g[N] ;</span><br><span class="line"><span class="keyword">int</span> h[N] ;</span><br><span class="line"><span class="keyword">int</span> ch[N] ;</span><br><span class="line"><span class="keyword">int</span> tag[N] ;</span><br><span class="line"></span><br><span class="line">vint E[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> da)</span></span>&#123;</span><br><span class="line">    dep[x] = dep[da] + <span class="number">1</span> ;</span><br><span class="line">    sz[x] = <span class="number">1</span>, fa[x] = da ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (y == da) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs1(y, x) ; sz[x] += sz[y] ;</span><br><span class="line">        <span class="keyword">if</span> (sz[y] &gt; sz[son[x]]) son[x] = y ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> tp)</span></span>&#123;</span><br><span class="line">    top[x] = tp ;</span><br><span class="line">    <span class="keyword">if</span> (son[x])</span><br><span class="line">        dfs2(son[x], tp) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])</span><br><span class="line">        <span class="keyword">if</span> (y != fa[x] &amp;&amp; y != son[x]) dfs2(y, y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (top[x] != top[y])&#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[top[x]] &lt; dep[top[y]]) swap(x, y) ;</span><br><span class="line">        x = fa[top[x]] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &gt; dep[y])</span><br><span class="line">        swap(x, y) ; <span class="keyword">return</span> x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve1</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (y != fa[x])&#123;</span><br><span class="line">            solve1(y) ;</span><br><span class="line">            tag[x] += tag[y] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve2</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    ll sv = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">int</span> mv = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">int</span> cmv = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (y == fa[x])</span><br><span class="line">            <span class="keyword">continue</span> ; solve2(y) ;</span><br><span class="line">        f[x] += f[y], sv += tag[y] ;</span><br><span class="line">        <span class="keyword">if</span> (tag[y] &gt; tag[mv]) cmv = mv, mv = y ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (tag[y] &gt; tag[cmv]) cmv = y ;</span><br><span class="line">    &#125;</span><br><span class="line">    ch[x] = cmv, h[x] = mv ;</span><br><span class="line">    g[x] = sv, f[x] += sv - tag[mv] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve3</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    ans = min(ans, f[x]) ; ll t ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (y == fa[x]) <span class="keyword">continue</span> ;</span><br><span class="line">        <span class="keyword">if</span> (y == h[x])</span><br><span class="line">             t = -tag[ch[x]] ;</span><br><span class="line">        <span class="keyword">else</span> t = -tag[y] ;</span><br><span class="line">        t += f[x] - f[y] ;</span><br><span class="line">        <span class="keyword">if</span> (tag[y] &gt; tag[h[y]])</span><br><span class="line">            f[y] += tag[h[y]], ch[y] = h[y], h[y] = y ;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            f[y] += tag[y] ;</span><br><span class="line">            <span class="keyword">if</span> (tag[y] &gt; tag[ch[y]]) ch[y] = y ;</span><br><span class="line">        &#125;</span><br><span class="line">        f[y] += t ;</span><br><span class="line">        solve3(y) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    qr(n), qr(m) ;</span><br><span class="line">    <span class="keyword">int</span> x, y, z ; tag[<span class="number">0</span>] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)</span><br><span class="line">        qr(x), qr(y), E[x].p_b(y), E[y].p_b(x) ;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">0</span>), dfs2(<span class="number">1</span>, <span class="number">1</span>) ; ans = <span class="number">1l</span>l &lt;&lt; <span class="number">60</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        qr(x), qr(y) ; z = lca(x, y) ;</span><br><span class="line">        tag[z] --, tag[z] --, tag[x] ++, tag[y] ++ ;</span><br><span class="line">    &#125;</span><br><span class="line">    solve1(<span class="number">1</span>) ;</span><br><span class="line">    solve2(<span class="number">1</span>) ;</span><br><span class="line">    solve3(<span class="number">1</span>) ;</span><br><span class="line">    qw(ans) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote><p>å¯¹äºè¿™ä¸ªæ•°åˆ—çš„ä¸€æ®µè¿ç»­å­åºåˆ— $a_l,a_{l+1},â‹¯,a_r$ ï¼Œå¦‚æœå­˜åœ¨ä¸€ç»„æ•´æ•° $x&lt;y$ ä½¿å¾— $x$ å’Œ $y$ æ²¡æœ‰å‡ºç°åœ¨ $a_l$ åˆ° $a_r$ ä¸­ï¼Œå¹¶ä¸” $x+1,x+2,â‹¯,yâˆ’1x+1,x+2,â‹¯,yâˆ’1$ éƒ½å‡ºç°åœ¨äº† $a_l$ åˆ° $a_r$ ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§° $(x,y)$ æ˜¯ä¸€ä¸ªåˆæ³•çš„æ•°å¯¹ã€‚</p><p>ä½ éœ€è¦å¤„ç† $m$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—® $l,r,c$ ï¼Œä½ éœ€è¦å›ç­”å¯¹äº $a_l,a_{l+1},â‹¯,a_r$ æ»¡è¶³ $y=x+c$ çš„åˆæ³•çš„æ•°å¯¹æ•°é‡ã€‚</p><p>$1 \leq n, m, a_{i} \leq 1000000,2 \leq c \leq 10$ ã€‚</p></blockquote><p>æ¯’ç˜¤é¢˜â€¦æ®è¯´æ˜¯ lxl å‡ºç»™ SD çœé˜Ÿé›†è®­ 2019 çš„é¢˜ã€‚</p><p>å¤§æ¦‚æ˜¯æœ‰ $50$ åˆ†å·¦å³æ˜¯å¯ä»¥è«é˜Ÿçš„ï¼Ÿç„¶è€Œæ­£è§£æ˜¯ååˆ†å¼ºå¤§çš„çº¿æ®µæ ‘/BITç»´æŠ¤æ‰«æçº¿ã€‚</p><p>$9$ ä¸ªæ ‘çŠ¶æ•°ç»„ï¼Œåˆ†åˆ«ç»´æŠ¤å¯¹äºæ¯ä¸ªå·¦ç«¯ç‚¹ $c-1=1,2,3\cdots9$ æ—¶çš„ç­”æ¡ˆï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥ç”¨ BIT è®¡ç®—å‡ºå³ç«¯ç‚¹ã€‚è€ƒè™‘å·¦ç«¯ç‚¹ä»å³è¾¹åˆ°å·¦è¾¹ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œæ–°åŠ å…¥ä¸€ä¸ªæ•° $v$ çš„æ—¶å€™ï¼Œå¿…ç„¶æ˜¯åŸæ¥çš„æŸäº›é•¿åº¦ä¸º $t$ çš„è¿ç»­æ®µå˜æˆäº†é•¿åº¦ä¸º $t+k$ çš„è¿ç»­æ®µã€‚äºæ˜¯å°±è€ƒè™‘ç»´æŠ¤æ¯ä¸ªæ•°éšç€å·¦ç«¯ç‚¹ä»å³å¾€å·¦æ‰«ã€ä¸Šä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚è¿™æ ·æ¯æ¬¡å°±å¯ä»¥æŠŠ $v-10\sim v+10$ éƒ½æ‰«ä¸€éï¼Œè®°ä¸€ä¸‹æ•°å­—çš„å‡ºç°æƒ…å†µï¼Œç„¶åæ¯æ¬¡æš´åŠ›æ‰¾ä¸€ä¸‹æ–°äº§ç”Ÿçš„è¿ç»­æ®µï¼Œç»´æŠ¤ä¸€ä¸‹å°±å¥½äº†ã€‚</p><p>å†™çš„æ—¶å€™å¤§æ¦‚æœ‰ç‚¹ç»†èŠ‚ï¼Œæ¯”å¦‚è¯´æŒ‰ç…§ <code>last[c]</code> æ’åºåå¦‚æœåŒºé—´é‡Œå­˜åœ¨ä¸¤ä¸ª $v$ ï¼Œé‚£ä¹ˆä¹‹åçš„è´¡çŒ®ä¸€å®šç®—è¿‡äº†ã€‚</p><p>äºæ˜¯æœ€åçš„å¤æ‚åº¦å°±æ˜¯ $O(n\times c\log n)$ ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IPT &#123;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">1</span> &lt;&lt; <span class="number">21</span>;</span><br><span class="line"><span class="keyword">char</span> buf[L], *front=buf, *end=buf;</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">GetChar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (front == end) end = buf + fread(front = buf, <span class="number">1</span>, L, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">return</span> (front == end) ? <span class="number">-1</span> : *(front++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">qr</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> ch = GetChar(), lst = <span class="number">0</span>; x = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch)) lst = ch, ch = GetChar();</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch)) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = GetChar();</span><br><span class="line">  <span class="keyword">if</span> (lst == <span class="string">'-'</span>) x = -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qra</span><span class="params">(T *<span class="keyword">const</span> __ary, <span class="keyword">int</span> __n)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; __n; ++i) qr(__ary[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qrs</span><span class="params">(T *p)</span> </span>&#123;</span><br><span class="line">  T *beg = p;</span><br><span class="line">  <span class="keyword">do</span> *p = GetChar(); <span class="keyword">while</span> (!<span class="built_in">isalnum</span>(*p));</span><br><span class="line">  <span class="keyword">do</span> *(++p) = GetChar(); <span class="keyword">while</span> (<span class="built_in">isalnum</span>(*p));</span><br><span class="line">  *p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> p - beg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qrdb</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> ch = GetChar(), lst = <span class="number">0</span>; x = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch)) lst = ch, ch = GetChar();</span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch)) &#123; x = x * <span class="number">10</span> + (ch - <span class="string">'0'</span>); ch = GetChar(); &#125;</span><br><span class="line">  <span class="keyword">if</span> (ch == <span class="string">'.'</span>) &#123;</span><br><span class="line">    ch = GetChar();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span> t = <span class="number">0.1</span>; <span class="built_in">isdigit</span>(ch); t *= <span class="number">0.1</span>) &#123;</span><br><span class="line">      x += (t * (ch - <span class="string">'0'</span>));</span><br><span class="line">      ch = GetChar();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (lst == <span class="string">'-'</span>) x = -x;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125; <span class="comment">// namespace IPT</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> OPT &#123;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">char</span> buf[L];</span><br><span class="line"> </span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">qw</span><span class="params">(T x, <span class="keyword">const</span> <span class="keyword">char</span> aft = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123; x = -x, <span class="built_in">putchar</span>(<span class="string">'-'</span>); &#125;</span><br><span class="line">  <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123; buf[++top] = <span class="keyword">static_cast</span>&lt;<span class="keyword">char</span>&gt;(x % <span class="number">10</span> + <span class="string">'0'</span>); &#125; <span class="keyword">while</span> (x /= <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">while</span> (top) <span class="built_in">putchar</span>(buf[top--]);</span><br><span class="line">  <span class="keyword">if</span> (aft) <span class="built_in">putchar</span>(aft);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qwa</span><span class="params">(T *<span class="keyword">const</span> __ary, <span class="keyword">int</span> __n, <span class="keyword">const</span> <span class="keyword">char</span> e1, <span class="keyword">const</span> <span class="keyword">char</span> e2)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> __dn = __n - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; __dn; ++i) qw(__ary[i], e1);</span><br><span class="line">  qw(__ary[__dn], e2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qws</span><span class="params">(T *p, <span class="keyword">const</span> <span class="keyword">int</span> __n, <span class="keyword">const</span> <span class="keyword">char</span> ed)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; __n; ++i) <span class="built_in">putchar</span>(p[i]);</span><br><span class="line">  <span class="keyword">if</span> (ed) <span class="built_in">putchar</span>(ed);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qws</span><span class="params">(T *p, <span class="keyword">const</span> <span class="keyword">char</span> ed)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (*p) <span class="built_in">putchar</span>(*p++);</span><br><span class="line">  <span class="keyword">if</span>(ed) <span class="built_in">putchar</span>(ed);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125; <span class="comment">// namespace OPT</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> IPT::qr;</span><br><span class="line"><span class="keyword">using</span> IPT::qra;</span><br><span class="line"><span class="keyword">using</span> IPT::qrs;</span><br><span class="line"><span class="keyword">using</span> IPT::qrdb;</span><br><span class="line"><span class="keyword">using</span> OPT::qw;</span><br><span class="line"><span class="keyword">using</span> OPT::qwa;</span><br><span class="line"><span class="keyword">using</span> OPT::qws;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qs</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id ;</span><br><span class="line">    <span class="keyword">int</span> val ;</span><br><span class="line">    <span class="keyword">int</span> l, r ;</span><br><span class="line">&#125;q[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> last[N] ;</span><br><span class="line"><span class="keyword">int</span> _less[<span class="number">11</span>] ;</span><br><span class="line"><span class="keyword">int</span> _more[<span class="number">11</span>] ;</span><br><span class="line"><span class="keyword">int</span> _b[<span class="number">11</span>][N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; buc ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> m_k make_pair</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">const</span> qs &amp;a, <span class="keyword">const</span> qs &amp;b)</span></span>&#123; <span class="keyword">return</span> a.l &gt; b.l ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> c, <span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (c &gt; <span class="number">10</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">for</span> ( ; x &lt;= n ; x += (x &amp; -x)) _b[c][x] += v ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qry</span><span class="params">(<span class="keyword">int</span> c, <span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> ( ; x ; x -= (x &amp; -x)) ret += _b[c][x] ; <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> x, y, z, l, r ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    qr(n) ; qr(m) ;</span><br><span class="line">    fill(last, last + N, n + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) qr(base[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        q[i].id = i, qr(q[i].l), qr(q[i].r), qr(q[i].val), q[i].val -- ;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + m + <span class="number">1</span>, comp) ; <span class="keyword">int</span> p = <span class="number">1</span> ; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)&#123;</span><br><span class="line">        fill(_less, _less + <span class="number">11</span>, <span class="number">0</span>) ;</span><br><span class="line">        fill(_more, _more + <span class="number">11</span>, <span class="number">0</span>) ; buc.clear() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = max(<span class="number">0</span>, base[i] - <span class="number">10</span>) ; j &lt;= base[i] + <span class="number">10</span> ; ++ j)</span><br><span class="line">            buc.push_back(m_k(last[j], j)) ; buc.push_back(m_k(n + <span class="number">1</span>, <span class="number">0</span>)) ;</span><br><span class="line">        sort(buc.begin(), buc.end()) ; l = r = <span class="number">0</span> ; add(<span class="number">1</span>, i, <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> j : buc)&#123;</span><br><span class="line">            z = l + r + <span class="number">1</span> ;</span><br><span class="line">            x = j.fr, y = j.sc ;</span><br><span class="line">            <span class="keyword">if</span> (y == base[i] || x &gt; n)&#123;</span><br><span class="line">                add(l, x, <span class="number">1</span>), add(r, x, <span class="number">1</span>) ;</span><br><span class="line">                add(l + r + <span class="number">1</span>, x, <span class="number">-1</span>) ;</span><br><span class="line">                <span class="keyword">break</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (y &lt; base[i])</span><br><span class="line">                 _less[base[i] - y] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">else</span> _more[y - base[i]] = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span> (_less[l + <span class="number">1</span>])&#123;</span><br><span class="line">                add(l, x, <span class="number">1</span>) ;</span><br><span class="line">                <span class="keyword">while</span> (_less[l + <span class="number">1</span>]) ++ l ;</span><br><span class="line">                add(l, x, <span class="number">-1</span>) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (_more[r + <span class="number">1</span>])&#123;</span><br><span class="line">                add(r, x, <span class="number">1</span>) ;</span><br><span class="line">                <span class="keyword">while</span> (_more[r + <span class="number">1</span>]) ++ r ;</span><br><span class="line">                add(r, x, <span class="number">-1</span>) ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (z != l + r + <span class="number">1</span>)</span><br><span class="line">                add(z, x, <span class="number">-1</span>), add(l + r + <span class="number">1</span>, x, <span class="number">1</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (q[p].l == i &amp;&amp; p &lt;= m)</span><br><span class="line">            ans[q[p].id] = qry(q[p].val, q[p].r), ++ p ;</span><br><span class="line">        last[base[i]] = i ;</span><br><span class="line">    &#125;</span><br><span class="line">    qwa(ans + <span class="number">1</span>, m, <span class="string">'\n'</span>, <span class="string">'\n'</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;lxl çš„é¢˜ï¼Œä¸å¯åšã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ZROI" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/ZROI/"/>
    
    
      <category term="æ€ç»´é¢˜/æ„é€ " scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%9E%84%E9%80%A0/"/>
    
      <category term="æ•°æ®ç»“æ„/æ ‘çŠ¶æ•°ç»„" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/æ ‘å½¢DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%A0%91%E5%BD%A2DP/"/>
    
      <category term="æŠ€å·§/up and down" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-up-and-down/"/>
    
      <category term="æ•°æ®ç»“æ„æ–¹æ³•/æ‰«æçº¿" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%96%B9%E6%B3%95-%E6%89%AB%E6%8F%8F%E7%BA%BF/"/>
    
  </entry>
  
  <entry>
    <title>ã€è®­ç»ƒè®°å½•ã€‘6.9 è®­ç»ƒç¬”è®°</title>
    <link href="https://www.orchidany.cn/2020/06/14/6-9-%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/06/14/6-9-è®­ç»ƒç¬”è®°/</id>
    <published>2020-06-14T10:41:23.000Z</published>
    <updated>2020-06-19T12:13:53.346Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¥ä¸šï¼Œè¥ä¸šï¼</p><a id="more"></a><h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><blockquote><p>æœ‰ä¸€å¤©ï¼Œä¸»åŠ›æ‰‹é‡Œæœ‰ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åºåˆ— ${a1,a2,â€¦,an}$ ä¸ ä¸€ä¸ªé•¿åº¦ä¸º $m$ çš„æ•°åˆ— ${b1,b2,â€¦,bm}$, ä»–æƒ³çŸ¥é“æœ‰å¤šå°‘å¯¹ $(a_i,b_j){1â‰¤iâ‰¤n,1â‰¤jâ‰¤m}$ æ»¡è¶³ä¸¤ä¸ªæ•° <code>XOR</code> (å¼‚æˆ–) ä»¥åï¼Œåœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹æ°å¥½æœ‰ä¸¤ä¸ª $1$ã€‚</p><p>è¾“å‡ºè¿™ä¸ªå¯¹æ•°ã€‚</p><p>$1\leq n\leq 10^5,1\leq a_i\leq 2^{30}$ ã€‚</p></blockquote><p>æ¯”è¾ƒç®€å•çš„å¥—è·¯é¢˜ã€‚è€ƒè™‘æ°å¥½æœ‰ä¸¤ä¸ª $1$ ä¹Ÿå°±æ˜¯è¯´äºŒè¿›åˆ¶ä¸‹æ°å¥½æœ‰ä¸¤ä½ä¸åŒã€‚äºæ˜¯å¯ä»¥å¼€ä¸€ä¸ª <code>map</code> æ‰«ä¸€ä¸‹ $\{a_n\}$ï¼Œç„¶åå¯¹äº $\{b_n\}$ çš„æ¯ä¸ªæ•°ï¼Œ$\log ^2$ çš„å¤æ‚åº¦å»æšä¸¾ä¸€ä¸‹ $p,q$ ã€‚ä½†è¿™æ · $\log ^3$ å¹¶ä¸å¯è¿‡ã€‚äºæ˜¯å¯ä»¥ç”¨ä¸€ç‚¹ meet in middle çš„æ€æƒ³ï¼Œé¢„å¤„ç† $n\log n$ ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯ $a_i$ å¼‚æˆ– $1,2,4,8\cdots$ã€‚è¿™æ ·å°±å¯ä»¥æ¶ˆæ‰ä¸€ä¸ª logã€‚</p><h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote><p>æœ‰ä» 1 åˆ° n å…± nä¸ªæ•°ï¼Œä½ éœ€è¦å°†å®ƒä»¬æ’æˆä¸€åˆ—ï¼Œä½¿å¾—ä»»æ„ä¸¤ä¸ªç›¸é‚»çš„æ•°äº’è´¨ã€‚</p><p>æ±‚ä¸€å…±æœ‰å¤šå°‘ç§æ’åˆ—æ–¹å¼ã€‚</p><p>å…± $28$ ä¸ªæµ‹è¯•ç‚¹ï¼Œå¯¹ç¬¬ $n$ ä¸ªæµ‹è¯•ç‚¹æœ‰ $n=i$ ã€‚</p></blockquote><p>é¦–å…ˆå¤§æ¦‚æ˜¯ $30\sim 40$ å·¦å³çš„åˆ†æ•°å¯ä»¥ç›´æ¥æš´åŠ›å…¨æ’åˆ—å‡ºæ¥ã€‚ç„¶åå¦‚æœè€ƒè™‘æ›´é«˜ä¸€ç‚¹çš„è¯ï¼Œå°±å¯ä»¥è®¾ $f_{s,i}$ è¡¨ç¤ºè€ƒè™‘äº†é›†åˆ $s$ å†…çš„æ•°ï¼Œæœ€åä¸€ä¸ªæ•°æ˜¯ $i$ çš„æ–¹æ¡ˆæ•°ã€‚è¿™æ ·å¤æ‚åº¦å°±æ˜¯ $O(2^n\times n^2)$ çš„ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯ $O(2^n\times n)$ ã€‚å¯ä»¥è·å¾—å¤§æ¦‚ $80$ å·¦å³çš„æˆç»©ã€‚ä¸è¿‡ä¼¼ä¹æ˜¯å¯ä»¥å¤šæ’å‡ ä¸ªå†…å­˜æ¡æ¥ A æ‰è¿™é¢˜ï¼Œå¬ä¸Šå»å¾ˆçŒ›ç”·ã€‚</p><p>æ­£è§£è€ƒè™‘åˆå¹¶ä¸€äº›çŠ¶æ€ï¼Œå¤§æ¦‚æ˜¯è¯´å‘ç°è¯¸å¦‚ $3,9,27$ è¿™æ ·çš„æ•°å­—ï¼Œæœ¬è´¨ä¸Šæ˜¯ç­‰ä»·çš„ã€‚æ‰€ä»¥ $1\sim 28$ å°±å¯ä»¥åˆ’åˆ†æˆ $14$ ä¸ªå·¦å³çš„ç­‰ä»·ç±»ï¼Œå¯¹è¿™äº›ç­‰ä»·ç±» dp å°±å¥½äº†ï¼ŒçŠ¶æ€æ•°å¤§æ¦‚åœ¨ $2e7$ å·¦å³ã€‚å®ç°çš„æ—¶å€™ç¨æœ‰ç»†èŠ‚ã€‚</p><h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote><p>åˆå§‹æœ‰ n ä¸ªå°çƒï¼Œå°çƒæœ‰ 4 ç§é¢œè‰²ï¼Œåˆå§‹çš„ç­‰çº§ä¸º 1  </p><p>ä½ æ¯ä¸€æ¬¡å¯ä»¥é€‰æ‹©ä¸€ä¸ªå°çƒåˆ é™¤ï¼Œåˆ é™¤ååé¢çš„å°çƒä¼šå‘å‰ç§»åŠ¨ä¸€ä½ ã€‚å¦‚æœæœ‰è‡³å°‘ 3 ä¸ªç›¸åŒé¢œè‰²å’Œç­‰çº§çš„å°çƒè¿ç»­ï¼Œé‚£ä¹ˆå·¦ä¾§çš„ 3 ä¸ªä¼šåˆå¹¶æˆä¸€ä¸ªé¢œè‰²ç›¸åŒç­‰çº§+1çš„å°çƒï¼ˆå¯èƒ½æœ‰è¿é”ååº”ï¼‰ ã€‚</p><p>é—®æœ‰å¤šå°‘ç§èƒ½åˆ°è¾¾çš„å±€é¢ ã€‚ä¸¤ä¸ªå±€é¢æ˜¯ä¸åŒå½“ä¸”ä»…å½“é•¿åº¦ä¸åŒæˆ–å­˜åœ¨ä¸€ä¸ªä½ç½®å°çƒä¸åŒã€‚</p><p>$n \leq 1000000$ ã€‚</p></blockquote><p>ä¸€ä¸ªå¾ˆé‡è¦çš„ Observationï¼šåˆæˆä¸€ä¸ª $p$ çº§çƒï¼Œéœ€è¦ $3^p$ ä¸ª $1$ çº§çƒã€‚æ‰€ä»¥å¯ä»¥çŸ¥é“è‡³å¤šæœ‰ $\log $ ç§ä¸åŒçš„ç­‰çº§ã€‚ç„¶åå¯ä»¥å¯¹æ­¤è¿›è¡Œ dpã€‚è®¾ $f_{i,(c,L),1/2}$ è¡¨ç¤ºè€ƒè™‘äº†åŸåºåˆ—çš„å‰ $i$ ä½ï¼Œæœ€åä¸€ä¸ªé¢œè‰²çƒæ˜¯ $c$ï¼Œç­‰çº§ä¸º $L$ æ—¶ï¼Œæœ«å°¾æœ‰ $1/2$ ä¸ªç›¸åŒçš„çƒæœ‰å¤šå°‘ç§åˆæ³•çš„åºåˆ—ã€‚</p><p>é‚£ä¹ˆé¦–å…ˆä¸éš¾å‘ç° $c=col_i$ ã€‚å…¶æ¬¡è€ƒè™‘è½¬ç§»ï¼Œè€ƒè™‘ä¸€ä¸ª $(c,L_1)$ åé¢å¯ä»¥è½¬ç§»åˆ°ä¸€ä¸ªæ€æ ·çš„ $(d,L_2)$ã€‚è¿™ä¸ªåœ°æ–¹éœ€è¦åˆ†ç±»è®¨è®ºï¼š</p><p>1ã€$c\neq d$ ã€‚é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è½¬ç§» </p><script type="math/tex; mode=display">f_{i,(c,L_1),1}+f_{i,(c,L_1),2}\to f_{j,(c=d,L_2),1}</script><p>2ã€$c=d$ ã€‚è€ƒè™‘è¿™ä¸€éƒ¨åˆ†ç”±äºé¢˜ç›®ä¸­é™åˆ¶äº†ã€Œä»æœ€å·¦ç«¯å¼€å§‹åˆæˆã€ï¼Œæ‰€ä»¥å¯¹äºç±»ä¼¼ <code>aabaa</code> è¿™ç§åºåˆ—ï¼Œ<code>(1,2,3)(4)</code> æ˜¯åˆæ³•çš„ï¼Œè€Œ <code>(1)(2,3,4)</code> æ˜¯ä¸åˆæ³•çš„ã€‚æ‰€ä»¥éœ€è¦åˆ†ç±»è®¨è®ºä¸€æ³¢é•¿åº¦å…³ç³»ï¼š</p><p>ï¼ˆ1ï¼‰$L_1=L_2$ ã€‚æ­¤æ—¶å¯ä»¥ç›´æ¥è½¬ç§»ï¼Œä½†æ˜¯æ³¨æ„åˆ°ç”±äºä¸€ä¸ªç¨³å®šçš„ç»“æŸçŠ¶æ€ä¸ä¼šå‡ºç°è¿ç»­ä¸‰ä¸ªç›¸åŒçš„çƒï¼Œæ‰€ä»¥è½¬ç§»åº”è¯¥ä¸º</p><script type="math/tex; mode=display">f_{i,(c,L_1),1}\to f_{j,(c,L_2),2}</script><p>ï¼ˆ2ï¼‰$L_1\gt L_2$ ã€‚æ­¤æ—¶ä¸€å®šæœ‰ä¸€ç§åˆæ³•çš„æ–¹å¼æ˜¯å…ˆåˆå®Œå·¦è¾¹å†åˆå³è¾¹ã€‚æ‰€ä»¥å¯ä»¥æ­£å¸¸è½¬ç§»</p><script type="math/tex; mode=display">f_{i,(c,L_1),1}+f_{i,(c,L_1),2}\to f_{j,(c=d,L_2),1}</script><p>ï¼ˆ3ï¼‰$L_1\lt L_2$ ã€‚æ³¨æ„åˆ°æ­¤æ—¶ä¸èƒ½å†è¿™ä¹ˆåˆæˆäº†ï¼Œå› ä¸ºå¿…ç„¶ä¼šæœ‰ä¸€æ¬¡åˆå¹¶ä½¿å¾—å³è¾¹è¶…è¿‡å·¦è¾¹ï¼Œäºæ˜¯æ­¤æ—¶å°±éœ€è¦è°ƒæ•´åˆ†ç•Œçº¿ã€‚è€ƒè™‘æ‰¾åˆ° $i$ åé¢ç¬¬ä¸€ä¸ªé¢œè‰²ä¸ç­‰äº $c$ çš„ä½ç½® $k$ ï¼Œç„¶åä» $k$ å¼€å§‹æ‰¾ $3^j$ ä¸ª $c$ ã€‚è¿™æ ·å°±å¯ä»¥ç›´æ¥è½¬ç§»äº†ï¼Œå› ä¸ºæ­¤æ—¶ä¸å­˜åœ¨å·¦å³éƒ¨åˆ†äº’ç›¸å½±å“çš„é—®é¢˜ã€‚</p><p>äºæ˜¯å¯ä»¥å…ˆé¢„å¤„ç†å‡ºæ¥æ¯ä¸ªä½ç½®åé¢ç¬¬ä¸€ä¸ªå’Œå®ƒé¢œè‰²ä¸åŒçš„ä½ç½®ã€ä»¥åŠä»æ¯ä¸ªä½ç½®å¼€å§‹ç¬¬ $3^j$ ä¸ª $0/1/2/3$ åˆ†åˆ«åœ¨å“ªã€‚æœ€åè¿™æ ·åšçš„å¤æ‚åº¦æ˜¯ $O(nC\log^2n)$ çš„ã€‚é€šè¿‡ä¸€ç‚¹å°ä¼˜åŒ–å¯ä»¥ä¼˜åŒ–åˆ° $O(nC\log n)$ï¼Œä¸è¿‡æˆ‘è¿™é‡Œå·äº†ä¸€ä¸‹æ‡’ï¼Œä¼˜åŒ–åˆ°äº† $O(nC\log n+\dfrac{1}{4}nC\log ^2n)$ ï¼Œä¹Ÿæ˜¯å¯ä»¥è¿‡çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> C = <span class="number">4</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">13</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">chkmin</span><span class="params">(T &amp;x, T y)</span></span>&#123; x = x &gt; y ? y : x ; &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">chkmax</span><span class="params">(T &amp;x, T y)</span></span>&#123; x = x &lt; y ? y : x ; &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(T &amp;x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x += y ; x = x &gt;= mod ? x - mod : x ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">char</span> cc[N] ;</span><br><span class="line"><span class="keyword">int</span> buc[C] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> go_d[N] ;</span><br><span class="line"><span class="keyword">int</span> go_s[N][C][M] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> g[M] ;</span><br><span class="line"><span class="keyword">int</span> f[N][M][<span class="number">2</span>] ;</span><br><span class="line"><span class="comment">//think about the first i_th numbers, the last level is j, ths suffix sum is 1/2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, cc + <span class="number">1</span>) ;</span><br><span class="line">    fill(buc, buc + C, n + <span class="number">1</span>) ;</span><br><span class="line">    fill(go_d, go_d + n + <span class="number">1</span>, n + <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        base[i] = (<span class="keyword">int</span>)cc[i] - <span class="string">'A'</span> ;</span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= n ; ++ i)</span></span><br><span class="line"><span class="comment">//        base[i] = i &amp; 1 ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">0</span> ; -- i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span> ; c &lt; C ; ++ c)&#123;</span><br><span class="line">            go_s[i][c][<span class="number">0</span>] = buc[c] ;</span><br><span class="line">            <span class="keyword">if</span> (c != base[i])</span><br><span class="line">                 chkmin(go_d[i], buc[c]) ;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; go_d[i] &lt;&lt; '\n' ;</span></span><br><span class="line">        buc[base[i]] = i ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; C ; ++ i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; M ; ++ j)</span><br><span class="line">go_s[n][i][j] = go_s[n + <span class="number">1</span>][i][j] = n + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span> ; i &gt;= <span class="number">0</span> ; -- i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; C ; ++ k)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt; M ; ++ j)</span><br><span class="line">                go_s[i][k][j] = go_s[go_s[ go_s[i][k][j - <span class="number">1</span>] ][k][j - <span class="number">1</span>] ][k][j - <span class="number">1</span>] ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; C ; ++ i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; M ; ++ j)</span><br><span class="line">f[go_s[<span class="number">0</span>][i][j]][j][<span class="number">0</span>] = (go_s[<span class="number">0</span>][i][j] != n + <span class="number">1</span>) ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line"><span class="keyword">int</span> s = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">int</span> o = base[i], u = go_d[i], v, z ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt; M ; ++ k)</span><br><span class="line">add(s, (f[i][k][<span class="number">1</span>] + f[i][k][<span class="number">0</span>]) % P) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">4</span> ; ++ j) &#123;</span><br><span class="line"><span class="keyword">if</span> (j != o)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">0</span> ; q &lt; M ; ++ q)</span><br><span class="line">v = go_s[i][j][q], add(f[v][q][<span class="number">0</span>], s) ;</span><br><span class="line"><span class="keyword">continue</span> ;</span><br><span class="line">&#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">0</span> ; p &lt; M ; ++ p)&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">0</span> ; q &lt; M ; ++ q)&#123;</span><br><span class="line">                    v = go_s[i][j][q] ;</span><br><span class="line">z = go_s[u][j][q] ;</span><br><span class="line">                    <span class="keyword">if</span> (q &lt; p)</span><br><span class="line">                         add(f[v][q][<span class="number">0</span>], (f[i][p][<span class="number">1</span>] + f[i][p][<span class="number">0</span>]) % P) ;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (q &gt; p)</span><br><span class="line">                         add(f[z][q][<span class="number">0</span>], (f[i][p][<span class="number">0</span>] + f[i][p][<span class="number">1</span>]) % P) ;</span><br><span class="line">                 <span class="function">a   <span class="keyword">else</span> <span class="title">add</span><span class="params">(f[v][q][<span class="number">1</span>], f[i][p][<span class="number">0</span>])</span> </span>;</span><br><span class="line"><span class="comment">//                    if (v &lt;= n)&#123;</span></span><br><span class="line"><span class="comment">//                        cout &lt;&lt; i &lt;&lt; " " &lt;&lt; v &lt;&lt; " " &lt;&lt; p &lt;&lt; " " &lt;&lt; q &lt;&lt; '\n';</span></span><br><span class="line"><span class="comment">//                        cout &lt;&lt; f[v][q][0] &lt;&lt; " " &lt;&lt; f[v][q][1] &lt;&lt; '\n' ;</span></span><br><span class="line"><span class="comment">//                    &#125;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; M ; ++ j)</span><br><span class="line">            add(ans, (f[i][j][<span class="number">0</span>] + f[i][j][<span class="number">1</span>]) % P) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">"\n"</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¥ä¸šï¼Œè¥ä¸šï¼&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ZROI" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/ZROI/"/>
    
    
      <category term="æ€ç»´é¢˜/è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E8%AE%A1%E6%95%B0/"/>
    
      <category term="æŠ€å·§/meet in middle" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-meet-in-middle/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/æœ‰æŠ€å·§çš„DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84DP/"/>
    
      <category term="æ€ç»´é¢˜/å¯¹åº”ä¸è½¬åŒ–" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E5%AF%B9%E5%BA%94%E4%B8%8E%E8%BD%AC%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘LOJ#2206 [HNOI2014]ä¸–ç•Œæ ‘</title>
    <link href="https://www.orchidany.cn/2020/06/14/%E4%B8%96%E7%95%8C%E6%A0%91/"/>
    <id>https://www.orchidany.cn/2020/06/14/ä¸–ç•Œæ ‘/</id>
    <published>2020-06-14T10:40:54.000Z</published>
    <updated>2020-06-19T12:18:39.820Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ„Ÿè§‰æ˜¯æ¯”è¾ƒæœ‰éš¾åº¦çš„è™šæ ‘é¢˜äº†ã€‚</p><p>å€å¢æ˜¯ç”¨ä¸ä¼šäº†ï¼Œè¿™è¾ˆå­éƒ½ç”¨ä¸ä¼šäº†ã€‚</p><a id="more"></a><blockquote><p>ä¸–ç•Œæ ‘æ˜¯ä¸€æ£µæ— æ¯”å·¨å¤§çš„æ ‘ï¼Œå®ƒä¼¸å‡ºçš„æå¹²æ„æˆäº†æ•´ä¸ªä¸–ç•Œã€‚åœ¨è¿™é‡Œï¼Œç”Ÿå­˜ç€å„ç§å„æ ·çš„ç§æ—å’Œç”Ÿçµï¼Œä»–ä»¬å…±åŒä¿¡å¥‰ç€ç»å¯¹å…¬æ­£å…¬å¹³çš„å¥³ç¥è‰¾è‰æ£®ï¼Œåœ¨ä»–ä»¬çš„ä¿¡æ¡é‡Œï¼Œå…¬å¹³æ˜¯ä½¿ä¸–ç•Œæ ‘èƒ½å¤Ÿç”Ÿç”Ÿä¸æ¯ã€æŒç»­è¿è½¬çš„æ ¹æœ¬åŸºçŸ³ã€‚</p><p>ä¸–ç•Œæ ‘çš„å½¢æ€å¯ä»¥ç”¨ä¸€ä¸ªæ•°å­¦æ¨¡å‹æ¥æè¿°ï¼šä¸–ç•Œæ ‘ä¸­æœ‰ $n$ ä¸ªç§æ—ï¼Œç§æ—çš„ç¼–å·åˆ†åˆ«ä» $1$ åˆ° $n$ï¼Œåˆ†åˆ«ç”Ÿæ´»åœ¨ç¼–å·ä¸º $1$ åˆ° $n$ çš„èšå±…åœ°ä¸Šï¼Œç§æ—çš„ç¼–å·ä¸å…¶èšå±…åœ°çš„ç¼–å·ç›¸åŒã€‚æœ‰çš„èšå±…åœ°ä¹‹é—´æœ‰åŒå‘çš„é“è·¯ç›¸è¿ï¼Œé“è·¯çš„é•¿åº¦ä¸º $1$ã€‚ä¿è¯è¿æ¥çš„æ–¹å¼ä¼šå½¢æˆä¸€æ£µæ ‘ç»“æ„ï¼Œå³æ‰€æœ‰çš„èšå±…åœ°ä¹‹é—´å¯ä»¥äº’ç›¸åˆ°è¾¾ï¼Œå¹¶ä¸”ä¸ä¼šå‡ºç°ç¯ã€‚å®šä¹‰ä¸¤ä¸ªèšå±…åœ°ä¹‹é—´çš„è·ç¦»ä¸ºè¿æ¥ä»–ä»¬çš„é“è·¯çš„é•¿åº¦ï¼›ä¾‹å¦‚ï¼Œè‹¥èšå±…åœ° $a$ å’Œ $b$ ä¹‹é—´æœ‰é“è·¯ï¼Œ$b$ å’Œ $c$ ä¹‹é—´æœ‰é“è·¯ï¼Œå› ä¸ºæ¯æ¡é“è·¯é•¿åº¦ä¸º $1$ è€Œä¸”åˆä¸å¯èƒ½å‡ºç°ç¯ï¼Œæ‰€ä»¥ $a$ ä¸ $c$ ä¹‹é—´çš„è·ç¦»ä¸º $2$ã€‚</p><p>å‡ºäºå¯¹å…¬å¹³çš„è€ƒè™‘ï¼Œç¬¬ $i$ å¹´ï¼Œä¸–ç•Œæ ‘çš„å›½ç‹éœ€è¦æˆæƒ $m_i$ ä¸ªç§æ—çš„èšå±…åœ°ä¸ºä¸´æ—¶è®®äº‹å¤„ã€‚å¯¹äºæŸä¸ªç§æ— $x$ï¼ˆ$x$ ä¸ºç§æ—çš„ç¼–å·ï¼‰ï¼Œå¦‚æœè·ç¦»è¯¥ç§æ—æœ€è¿‘çš„ä¸´æ—¶è®®äº‹å¤„ä¸º $y$ï¼ˆ$y$ ä¸ºè®®äº‹å¤„æ‰€åœ¨èšå±…åœ°çš„ç¼–å·ï¼‰ï¼Œåˆ™ç§æ— $x$ å°†æ¥å— $y$ è®®äº‹å¤„çš„ç®¡è¾–ï¼ˆå¦‚æœæœ‰å¤šä¸ªä¸´æ—¶è®®äº‹å¤„åˆ°è¯¥èšå±…åœ°çš„è·ç¦»ä¸€æ ·ï¼Œåˆ™ $y$ ä¸ºå…¶ä¸­ç¼–å·æœ€å°çš„ä¸´æ—¶è®®äº‹å¤„ï¼‰ã€‚</p><p>ç°åœ¨å›½ç‹æƒ³çŸ¥é“ï¼Œåœ¨ $q$ å¹´çš„æ—¶é—´é‡Œï¼Œæ¯ä¸€å¹´å®Œæˆæˆæƒåï¼Œå½“å¹´æ¯ä¸ªä¸´æ—¶è®®äº‹å¤„å°†ä¼šç®¡ç†å¤šå°‘ä¸ªç§æ—ï¼ˆè®®äº‹å¤„æ‰€åœ¨çš„èšå±…åœ°ä¹Ÿå°†æ¥å—è¯¥è®®äº‹å¤„ç®¡ç†ï¼‰ã€‚ ç°åœ¨è¿™ä¸ªä»»åŠ¡äº¤ç»™äº†ä»¥æ™ºæ…§è‘—ç§°çš„çµé•¿ç±»çš„ä½ ï¼šç¨‹åºçŒ¿ã€‚è¯·å¸®å›½ç‹å®Œæˆè¿™ä¸ªä»»åŠ¡å§ã€‚</p><p>å¯¹äºæ‰€æœ‰çš„æ•°æ® $N\leq 300000, q\leq 300000, m_1+m_2+\ldots+m_q \leq 300000$ã€‚</p></blockquote><p>è¿™é¢˜å¤§æ¦‚å°±æ˜¯éš¾åœ¨ä¸èƒ½å¾ˆå¥½åœ°ç»´æŠ¤éå…³é”®ç‚¹ä¸å…³é”®ç‚¹ä¹‹é—´çš„å…³ç³»ã€‚ä½†æ˜¯æ€è·¯è¿˜æ˜¯æ¯”è¾ƒç›´è§‚æ¸…æ™°çš„ã€‚è€ƒè™‘å…ˆæ±‚å‡ºè™šæ ‘ä¸Šæ‰€æœ‰ç‚¹å¯¹çº¯è™šç‚¹çš„è´¡çŒ®ï¼Œç„¶åè€ƒè™‘ä¸åœ¨è™šæ ‘ä¸Šçš„ç‚¹å¿…ç„¶æ˜¯ä»¥ä¸¤ä¸ªè™šæ ‘ä¸Šç‚¹ä¹‹é—´çš„é“¾çš„å½¢å¼å­˜åœ¨ã€‚é‚£ä¹ˆå°±å¯ä»¥å€å¢å‡ºè¿™ä¸ªåˆ†ç•Œçº¿æ¥ï¼Œä¹‹æ‰€ä»¥é€‰ç”¨å€å¢è€Œä¸æ˜¯äºŒåˆ†çš„åŸå› æ˜¾ç„¶ï¼šä¸ç”¨é‡å¤ç´¯åŠ ä¿¡æ¯ã€‚</p><p>ç„¶åå…·ä½“è¿‡ç¨‹å°±æ˜¯å…ˆ up_down å‡ºè™šæ ‘ä¸Šç‚¹ä¹‹é—´çš„ä¿¡æ¯ï¼Œç„¶åå† solve ä¸€éï¼Œå¯¹äºè™šæ ‘ä¸Šæ¯æ¡è¾¹å»å€å¢å‡ºåˆ†ç•Œçº¿ã€‚ç„¶åè¿™ä¸ªåœ°æ–¹å­˜åœ¨ç»†èŠ‚ï¼š</p><p>0ã€å€å¢çš„æ—¶å€™å¯ä»¥è€ƒè™‘å»å€å¢ä»ä¸¤ä¸ªç‚¹å»¶ä¼¸å‡ºçš„èŒƒå›´ã€‚</p><p>1ã€ä¸è¦å¿˜äº†ç¼–å·çš„çº¦æŸï¼Œæœ€ååˆ¤ä¸€ä¸‹å°±å¥½äº†ã€‚</p><p>2ã€å¤§æ¦‚å°±æ˜¯è¯´å¦‚æœç”¨ size å»ç®—é“¾ä¹‹é—´çš„ç‚¹çš„åˆ†é…åŠ¿å¿…ä¼šç®—å¤šï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸ªå¥½å¤„å°±æ˜¯å¯ä»¥ç›´æ¥æ‹¿å­æ ‘ size å»å®¹æ–¥ï¼Œè¿™æ ·å°±å¯ä»¥ä¸€å¹¶ç®—å‡ºé‚£äº› $x$ åˆ°å¶å­ä¸Šæ²¡æœ‰å…¶ä»–å…³é”®ç‚¹çš„é“¾çš„ä¿¡æ¯äº†ã€‚</p><p>å”‰ï¼Œè¶Šæ¥è¶Šèœäº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: max ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: min ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: pair ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: swap ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: <span class="built_in">vector</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: make_pair ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> m_k make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_b push_back</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300005</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> I = <span class="number">1000000000</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">0</span>, f = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">char</span> c = getchar() ;</span><br><span class="line">    <span class="keyword">while</span> (c &gt; <span class="string">'9'</span> || c &lt; <span class="string">'0'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>) f = <span class="number">-1</span> ; c = getchar() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &lt;= <span class="string">'9'</span> &amp;&amp; c &gt;= <span class="string">'0'</span>)&#123;</span><br><span class="line">        r = (r &lt;&lt; <span class="number">1</span>) + (r &lt;&lt; <span class="number">3</span>) + c - <span class="string">'0'</span>, c = getchar() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r * f ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rt ;</span><br><span class="line"><span class="keyword">int</span> n, q, k ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; E[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> virtual_tree&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt ;</span><br><span class="line">    <span class="keyword">int</span> sum ;</span><br><span class="line">    <span class="keyword">int</span> sz[N] ;</span><br><span class="line">    <span class="keyword">int</span> fa[N] ;</span><br><span class="line">    <span class="keyword">int</span> nfa[N] ;</span><br><span class="line">    <span class="keyword">int</span> dep[N] ;</span><br><span class="line">    <span class="keyword">int</span> dfn[N] ;</span><br><span class="line">    <span class="keyword">int</span> son[N] ;</span><br><span class="line">    <span class="keyword">int</span> top[N] ;</span><br><span class="line">    <span class="keyword">int</span> anc[N][<span class="number">19</span>] ;</span><br><span class="line">    <span class="keyword">int</span> stk[N], tp ;</span><br><span class="line">    <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; a ;</span><br><span class="line">    <span class="built_in">vector</span> &lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; T[N] ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> da)</span></span>&#123;</span><br><span class="line">        anc[x][<span class="number">0</span>] = da ;</span><br><span class="line">        dep[x] = dep[da] + <span class="number">1</span> ;</span><br><span class="line">        sz[x] = <span class="number">1</span>, fa[x] = da ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= <span class="number">18</span> ; ++ i)</span><br><span class="line">            anc[x][i] = anc[anc[x][i - <span class="number">1</span>]][i - <span class="number">1</span>] ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">            <span class="keyword">if</span> (y == da) <span class="keyword">continue</span> ;</span><br><span class="line">            dfs1(y, x) ; sz[x] += sz[y] ;</span><br><span class="line">            <span class="keyword">if</span> (sz[y] &gt; sz[son[x]]) son[x] = y ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> tp)</span></span>&#123;</span><br><span class="line">        top[x] = tp ;</span><br><span class="line">        dfn[x] = ++ cnt ;</span><br><span class="line">        <span class="keyword">if</span> (son[x])</span><br><span class="line">            dfs2(son[x], tp) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])</span><br><span class="line">            <span class="keyword">if</span> (y != fa[x] &amp;&amp; y != son[x]) dfs2(y, y) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!y) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (top[x] != top[y])&#123;</span><br><span class="line">            <span class="keyword">if</span> (dep[top[x]] &lt; dep[top[y]])</span><br><span class="line">                <span class="built_in">std</span> :: swap(x, y) ; x = fa[top[x]] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (dep[x] &gt; dep[y])</span><br><span class="line">            <span class="built_in">std</span> :: swap(x, y) ; <span class="keyword">return</span> x ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dis</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!b) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">return</span> dep[a] + dep[b] - (dep[lca(a, b)] &lt;&lt; <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add_e</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="comment">//    printf("%d %d\n", x, y) ;</span></span><br><span class="line">        <span class="keyword">if</span> (x == y) <span class="keyword">return</span> ; nfa[x] = y ;</span><br><span class="line">T[y].p_b(m_k(x, dis(x, y))) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">()</span></span>&#123;</span><br><span class="line">        stk[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">        sort(a.begin(), a.end(), [](<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123; <span class="keyword">return</span> dfn[x] &lt; dfn[y] ; &#125;) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> x : a)&#123;</span><br><span class="line">            <span class="keyword">int</span> z = lca(x, stk[tp]) ;</span><br><span class="line">            <span class="keyword">if</span> (z != stk[tp])&#123;</span><br><span class="line">                <span class="keyword">while</span> (tp &amp;&amp; dep[stk[tp - <span class="number">1</span>]] &gt;= dep[z])</span><br><span class="line">                    add_e(stk[tp], stk[tp - <span class="number">1</span>]), -- tp ;</span><br><span class="line">                <span class="keyword">if</span> (stk[tp] != z) add_e(stk[tp], z), stk[tp] = z ;</span><br><span class="line">            &#125;</span><br><span class="line">            stk[++ tp] = x ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (tp)</span><br><span class="line">            add_e(stk[tp], stk[tp - <span class="number">1</span>]), -- tp ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> vis[N] ;</span><br><span class="line"><span class="keyword">int</span> minf[N] ;</span><br><span class="line"><span class="keyword">int</span> mind[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> virtual_tree ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : T[x]) clear(y.fr) ;</span><br><span class="line">    T[x].clear(), ans[x] = vis[x] = mind[x] = <span class="number">0</span>, minf[x] = I ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_up</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">//    printf("%d\n", x) ;</span></span><br><span class="line">    <span class="keyword">if</span> (vis[x])&#123;</span><br><span class="line">        minf[x] = <span class="number">0</span> ;</span><br><span class="line">        mind[x] = x ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> y, z ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> t : T[x])&#123;</span><br><span class="line">        y = t.fr ;</span><br><span class="line">        do_up(y) ;</span><br><span class="line">        z = minf[y] + dis(x, y) ;</span><br><span class="line">        <span class="keyword">if</span> (z &lt; minf[x])</span><br><span class="line">            minf[x] = z, mind[x] = mind[y] ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (z == minf[x] &amp;&amp; mind[x] &gt; mind[y])</span><br><span class="line">            mind[x] = mind[y] ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_down</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y, z ;</span><br><span class="line">    <span class="keyword">if</span> (nfa[x])&#123;</span><br><span class="line">        y = nfa[x] ;</span><br><span class="line">        z = minf[y] + v ;</span><br><span class="line">        <span class="keyword">if</span> (z &lt; minf[x])</span><br><span class="line">            minf[x] = z, mind[x] = mind[y] ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (z == minf[x] &amp;&amp; mind[x] &gt; mind[y])</span><br><span class="line">            mind[x] = mind[y] ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//printf("%d %d %d\n", x, mind[x], minf[x]) ;</span></span><br><span class="line">    ans[mind[x]] ++ ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> t : T[x])</span><br><span class="line">        do_down(t.fr, t.sc) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ancdis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dep[x] - dep[y] ;</span><br><span class="line">&#125;</span><br><span class="line">pair &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; do_find(<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123;</span><br><span class="line">    <span class="keyword">bool</span> ct = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &lt; dep[y])</span><br><span class="line">        swap(x, y), ct = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">int</span> dist = minf[x], z = x, nd = mind[x] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">18</span> ; i &gt;= <span class="number">0</span> ; -- i)</span><br><span class="line">        <span class="keyword">if</span> (dist + (<span class="number">1</span> &lt;&lt; (i + <span class="number">1</span>)) &lt; minf[y] + ancdis(x, y))</span><br><span class="line">            mind[x = anc[x][i]] = nd, dist += (<span class="number">1</span> &lt;&lt; i) ;</span><br><span class="line">    <span class="keyword">if</span> (dist + <span class="number">2</span> == minf[y] + ancdis(x, y) &amp;&amp; nd &lt; mind[y]) x = fa[x] ;</span><br><span class="line"><span class="comment">//printf("$ %d %d %d %d %d %d\n", y, x, z, sz[y], sz[x], sz[z]) ;</span></span><br><span class="line">    <span class="keyword">if</span> (ct)</span><br><span class="line">         <span class="keyword">return</span> m_k(sz[y] - sz[x], sz[x] - sz[z]) ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> m_k(sz[x] - sz[z], sz[y] - sz[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y, z = sz[x] ;</span><br><span class="line"><span class="comment">//printf("#%d %d\n", x, z) ;</span></span><br><span class="line">    pair &lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; res ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> t : T[x])&#123;</span><br><span class="line">        y = t.fr ;</span><br><span class="line">        res = do_find(x, y) ;</span><br><span class="line"><span class="comment">//if (!x) goto cccccc ;</span></span><br><span class="line">        ans[mind[x]] += res.fr ;</span><br><span class="line">        ans[mind[y]] += res.sc ;</span><br><span class="line"><span class="comment">//printf("* %d %d\n", res.fr, res.sc) ;</span></span><br><span class="line">        z -= (res.fr + res.sc + sz[y]) ;</span><br><span class="line">        solve(y) ;</span><br><span class="line">    &#125;</span><br><span class="line">    ans[mind[x]] += z - <span class="number">1</span> ;</span><br><span class="line"><span class="comment">//printf("#%d %d\n", x, z) ;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) ; <span class="keyword">int</span> x, y ;</span><br><span class="line">    <span class="built_in">memset</span>(minf, <span class="number">63</span>, <span class="keyword">sizeof</span>(minf)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)</span><br><span class="line">        x = qr(), y = qr(), E[x].p_b(y), E[y].p_b(x) ;</span><br><span class="line">    dfs1(rt = <span class="number">1</span>, <span class="number">0</span>), dfs2(rt, rt) ; q = qr() ;</span><br><span class="line">    <span class="keyword">while</span> (q --)&#123;</span><br><span class="line">        k = qr() ; a.clear() ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">            vis[base[i] = qr()] = <span class="number">1</span>, a.p_b(base[i]) ;</span><br><span class="line">        ins() ; do_up(<span class="number">1</span>) ; do_down(<span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">solve(<span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d%c"</span>, ans[base[i]], <span class="string">" \n"</span>[i == k]) ; clear(<span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ„Ÿè§‰æ˜¯æ¯”è¾ƒæœ‰éš¾åº¦çš„è™šæ ‘é¢˜äº†ã€‚&lt;/p&gt;
&lt;p&gt;å€å¢æ˜¯ç”¨ä¸ä¼šäº†ï¼Œè¿™è¾ˆå­éƒ½ç”¨ä¸ä¼šäº†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="loj" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/loj/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’/æœ‰æŠ€å·§çš„DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84DP/"/>
    
      <category term="æŠ€å·§/å€å¢" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E5%80%8D%E5%A2%9E/"/>
    
      <category term="è™šæ ‘" scheme="https://www.orchidany.cn/tags/%E8%99%9A%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ã€å­¦ä¹ ç¬”è®°ã€‘è™šæ ‘å­¦ä¹ &amp;åšé¢˜ç¬”è®°</title>
    <link href="https://www.orchidany.cn/2020/06/14/%E8%99%9A%E6%A0%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/06/14/è™šæ ‘å­¦ä¹ ç¬”è®°/</id>
    <published>2020-06-14T10:39:17.000Z</published>
    <updated>2020-06-14T12:36:38.533Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ£é¼“äº†æ£é¼“è™šæ ‘ï¼Œå‘ç°åŸæ¥éš¾ç‚¹åœ¨DP <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/volantis@1.0.6/img/qq/æŠ“ç‹‚.gif" alt=""></p><p>å‘ç°äº†ç½‘ä¸Šä¸€ä¸ª QQ è¡¨æƒ…çš„ CDNï¼Œæ„Ÿè§‰å¾ˆå¯çˆ±wã€‚</p><a id="more"></a><h1 id="è™šæ ‘å­¦ä¹ ç¬”è®°"><a href="#è™šæ ‘å­¦ä¹ ç¬”è®°" class="headerlink" title="è™šæ ‘å­¦ä¹ ç¬”è®°"></a>è™šæ ‘å­¦ä¹ ç¬”è®°</h1><p>å¤§æ¦‚å°±æ˜¯ä¸€ç§å¿«é€Ÿç»´æŠ¤å…³é”®ç‚¹ä¿¡æ¯çš„æ–¹å¼ã€‚å…·ä½“æ€æƒ³å¯ä»¥çœ‹åšç¼©ç‚¹(é“¾)ï¼Œå¯¹äº $k$ ä¸ªå…³é”®ç‚¹ï¼Œè™šæ ‘å¯ä»¥å°†é—®é¢˜è§„æ¨¡ç¼©å°è‡³ $O(k)$ è€Œä¸æ˜¯ $O(n)$ ã€‚</p><p>å»ºæ ‘æ–¹å¼æ¯”è¾ƒç›´è§‚ï¼Œè·Ÿç¬›å¡å°”æ ‘ä¸€æ ·æ˜¯ç»´æŠ¤å³é“¾ï¼Œä½†æ˜¯ç”±äºå­©å­å¯èƒ½å¾ˆå¤šæ‰€ä»¥å»ºæ ‘æ–¹å¼æ¯”ç¬›å¡å°”æ ‘è¦å¤æ‚ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè™šæ ‘éƒ½æ˜¯åœ¨é€€æ ˆçš„æ—¶å€™æ‰ä¼šè¿è¾¹ï¼Œå¹¶ä¸”è™šæ ‘å»ºç«‹æ—¶éœ€è¦è€ƒè™‘çš„ä¸»è¦çŸ›ç›¾å°±æ˜¯ LCA çš„å–èˆï¼Œå› ä¸ºç»´æŠ¤å…³é”®ç‚¹ä»ç„¶éœ€è¦ä¿æŒå…¶æ ‘å½¢ç»“æ„ã€‚</p><p>è€ƒè™‘æ•´æ£µè™šæ ‘æŠŠ $0$ å·ç‚¹ä½œä¸ºè™šæ ¹ $root$ï¼Œå°†å…³é”®ç‚¹æŒ‰ç…§ <code>dfn</code> ä»å°åˆ°å¤§æ’åºã€‚æ¯æ¬¡æ’å…¥ä¸€ä¸ªç‚¹ï¼Œä¼šé¦–å…ˆåˆ¤æ–­ä¸¤ä¸ª case:</p><p>0ã€å¦‚æœæ­¤æ—¶ä¸æ˜¯æ–°çš„ä¸€æ¡é“¾ï¼Œç›´æ¥å°†å½“å‰ç‚¹å…¥æ ˆã€‚</p><p>1ã€å¦‚æœæ­¤æ—¶æ˜¯æ–°çš„ä¸€æ¡é“¾ï¼Œé‚£ä¹ˆæŠŠæ‰€æœ‰æ·±åº¦æ¯”å½“å‰ç‚¹å¤§çš„ç‚¹éƒ½å‡ºæ ˆï¼Œç±»ä¼¼ä¸€ä¸ª <code>lower_bound</code> çš„è¿‡ç¨‹ï¼Œä¿ç•™åˆ°ã€Œå·¦é“¾ä¸­ç¬¬ä¸€ä¸ªæ·±åº¦æ¯”å½“å‰ç‚¹æ›´æ·±çš„ç‚¹ $t$ã€ä¸ºæ­¢ã€‚ä¹‹åè€ƒè™‘å¦‚æœå½“å‰å…ƒç´ ä¸åŸæ¥çš„æ ˆé¡¶å…ƒç´  $s$ çš„ LCAï¼Œè®¾ä¸º $o$ï¼Œ ä¸æ˜¯ $t$ï¼Œé‚£ä¹ˆå°±è¿è¾¹(o,t)$ å’Œè¯¥æŠŠ $t$ å‡ºæ ˆã€ $o$ å…¥æ ˆã€‚</p><p>è¿‡ç¨‹çš„å……åˆ†æ€§å’Œåˆæ³•æ€§æ˜¯æ˜¾ç„¶çš„ã€‚æœ€åä¸è¦å¿˜è®°æ ˆä¸­å‰©ä¸‹çš„æœ€å³é“¾ã€‚è¿™ä¸ªåœ°æ–¹ xls åœ¨æ´›è°·ä¸Šæ”¾äº†ä¸ªæ¿å­ï¼Œä½†æ˜¯æ•°æ®å¯èƒ½ä¸æ˜¯å¾ˆå¼ºï¼Œä½†æˆ‘è§‰å¾—è¿™ä¼¼ä¹ä¹Ÿæ²¡å¿…è¦å¾ˆå¼ºï¼š<a href="https://www.luogu.com.cn/problem/U108028" target="_blank" rel="noopener">æˆ³æˆ‘</a> ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> virtual_tree&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt ;</span><br><span class="line">    <span class="keyword">int</span> sz[N] ;</span><br><span class="line">    <span class="keyword">int</span> fa[N] </span><br><span class="line">    <span class="keyword">int</span> nfa[N] ;</span><br><span class="line">    <span class="keyword">int</span> dep[N] ;</span><br><span class="line">    <span class="keyword">int</span> dfn[N] ;</span><br><span class="line">    <span class="keyword">int</span> son[N] ;</span><br><span class="line">    <span class="keyword">int</span> top[N] ;</span><br><span class="line">    <span class="keyword">int</span> stk[N], tp ;</span><br><span class="line">    <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; a, T ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> da)</span></span>&#123;</span><br><span class="line">        dep[x] = dep[da] + <span class="number">1</span> ;</span><br><span class="line">        sz[x] = <span class="number">1</span>, fa[x] = da ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">            <span class="keyword">if</span> (y == da) <span class="keyword">continue</span> ;</span><br><span class="line">            dfs1(y, x) ; sz[x] += sz[y] ;</span><br><span class="line">            <span class="keyword">if</span> (sz[y] &gt; sz[son[x]]) son[x] = y ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> tp)</span></span>&#123;</span><br><span class="line">        top[x] = tp ;</span><br><span class="line">        dfn[x] = ++ cnt ;</span><br><span class="line">        <span class="keyword">if</span> (son[x])</span><br><span class="line">            dfs2(son[x], tp) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])</span><br><span class="line">            <span class="keyword">if</span> (y != fa[x] &amp;&amp; y != son[x]) dfs2(y, y) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!y) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (top[x] != top[y])&#123;</span><br><span class="line">            <span class="keyword">if</span> (dep[top[x]] &lt; dep[top[y]])</span><br><span class="line">                <span class="built_in">std</span> :: swap(x, y) ; x = fa[top[x]] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (dep[x] &gt; dep[y])</span><br><span class="line">            <span class="built_in">std</span> :: swap(x, y) ; <span class="keyword">return</span> x ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">()</span></span>&#123;</span><br><span class="line">        sort(a.begin(), a.end(), [](<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123; <span class="keyword">return</span> dfn[x] &lt; dfn[y] ; &#125;) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> x : a)&#123;</span><br><span class="line">            <span class="keyword">int</span> z = lca(x, stk[tp]) ;</span><br><span class="line">            <span class="keyword">if</span> (z != stk[tp])&#123;</span><br><span class="line">                <span class="keyword">while</span> (tp &amp;&amp; dep[stk[tp - <span class="number">1</span>]] &gt;= dep[z])</span><br><span class="line">                    nfa[stk[tp]] = stk[tp - <span class="number">1</span>], -- tp ; <span class="comment">//ç±»ä¼¼ lower_bound</span></span><br><span class="line">                <span class="keyword">if</span> (stk[tp] != z) nfa[stk[tp]] = z, stk[tp] = z ;</span><br><span class="line">            &#125;</span><br><span class="line">            stk[++ tp] = x ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (tp) nfa[stk[tp]] = stk[tp - <span class="number">1</span>], -- tp ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åä»¥åå°±ç®¡è™šæ ‘ä¸Šçš„å…³é”®ç‚¹å«åšã€Œçº¯è™šç‚¹ã€ï¼Œé‚£äº› LCA å«åšã€ŒåŠè™šç‚¹ã€å¥½äº†ã€‚</p><h1 id="è™šæ ‘ç»ƒä¹ ç¬”è®°"><a href="#è™šæ ‘ç»ƒä¹ ç¬”è®°" class="headerlink" title="è™šæ ‘ç»ƒä¹ ç¬”è®°"></a>è™šæ ‘ç»ƒä¹ ç¬”è®°</h1><h2 id="SDOI2011-æ¶ˆè€—æˆ˜"><a href="#SDOI2011-æ¶ˆè€—æˆ˜" class="headerlink" title="[SDOI2011] æ¶ˆè€—æˆ˜"></a>[SDOI2011] æ¶ˆè€—æˆ˜</h2><blockquote><p>å¤šç»„è¯¢é—®ã€‚æ¯æ¬¡ç»™å‡ºä¸€äº›æ ‘ä¸Šå…³é”®ç‚¹ï¼Œè¾¹å¸¦æƒï¼Œæ±‚ä½¿è¿™äº›ç‚¹å‡ä¸ä¸æ ¹èŠ‚ç‚¹è¿é€šçš„æœ€å°ä»£ä»·ã€‚</p></blockquote><p>è€ƒè™‘å»ºå‡ºè™šæ ‘ä¹‹åå˜æˆäº†è£¸ DPã€‚è®¾ $f_i$ ä¸ºæå®Œ $i$ å­æ ‘å†…çš„æ‰€æœ‰å…³é”®ç‚¹çš„æœ€å°ä»£ä»·ï¼Œé‚£ä¹ˆæœ‰è½¬ç§»</p><script type="math/tex; mode=display">f_i=\begin{cases} val(root\to i)&\mathrm{if~c}_i=1\\ \min\{\sum f_j, val(root\to i)\}&{\rm otherwith}\end{cases}</script><p>å…¶ä¸­ $val(root\to i)$ æ˜¯æ ¹èŠ‚ç‚¹åˆ° $i$ çš„è¾¹æƒæœ€å¤§å€¼ï¼Œ$c_i$ è¡¨ç¤º $i$ æ˜¯å¦ä¸ºå…³é”®ç‚¹ï¼Œè½¬ç§»å°±å¥½äº†ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_e</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; T[y].p_b(x) ; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : T[x]) clear(y) ;</span><br><span class="line">        T[x].clear() ; vis[x] = <span class="number">0</span> ; f[x] = <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">()</span></span>&#123;</span><br><span class="line">        sort(a.begin(), a.end(), [](<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123; <span class="keyword">return</span> dfn[x] &lt; dfn[y] ; &#125;) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> x : a)&#123;</span><br><span class="line">            <span class="keyword">int</span> z = lca(x, stk[tp]) ;</span><br><span class="line">            <span class="keyword">if</span> (z != stk[tp])&#123;</span><br><span class="line">                <span class="keyword">while</span> (tp &amp;&amp; dep[stk[tp - <span class="number">1</span>]] &gt;= dep[z])</span><br><span class="line">                    add_e(stk[tp], stk[tp - <span class="number">1</span>]),  -- tp ;</span><br><span class="line">                <span class="keyword">if</span> (stk[tp] != z) add_e(stk[tp], z), stk[tp] = z ;</span><br><span class="line">            &#125;</span><br><span class="line">            stk[++ tp] = x ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (tp)</span><br><span class="line">            add_e(stk[tp], stk[tp - <span class="number">1</span>]), -- tp ;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        ll tmp = <span class="number">0</span> ;</span><br><span class="line"><span class="comment">//        printf("%d\n", x) ;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : T[x])&#123;</span><br><span class="line">            solve(y) ;</span><br><span class="line">            tmp += f[y] ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!T[x].size() || vis[x])</span><br><span class="line">            tmp = I ; f[x] = min(val[x], tmp) ;</span><br><span class="line"><span class="comment">//        printf("%d %lld\n", x, f[x]) ;</span></span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure></div></div><h2 id="GZOI2017-å…±äº«å•è½¦"><a href="#GZOI2017-å…±äº«å•è½¦" class="headerlink" title="[GZOI2017]å…±äº«å•è½¦"></a>[GZOI2017]å…±äº«å•è½¦</h2><blockquote><p>æ±‚å‡ºè¿™ä¸ªå›¾çš„æœ€çŸ­è·¯å¾„ç”Ÿæˆæ ‘åï¼Œæ ‘ä¸Šæ¯ä¸ªç‚¹åˆå§‹é¢œè‰²ä¸º $0$ ã€‚æœ‰ä¸¤ç§æ“ä½œï¼š</p><p>1ã€å°†éƒ¨åˆ†ç‚¹é¢œè‰²å–å</p><p>2ã€ç»™å‡ºä¸€äº›ç‚¹ï¼Œå»ºå‡ºè™šæ ‘ï¼ˆè¾¹æƒä¸ºä¸¤ç‚¹æ ‘ä¸Šè·ç¦»ï¼‰ï¼Œæ±‚æœ€å°å‰²è¾¹ä»£ä»·ä½¿å¾—è™šæ ‘ä¸Šæ²¡æœ‰é¢œè‰²ä¸º $1$ çš„ç‚¹ä¸æ ¹è”é€šã€‚</p></blockquote><p>è¿™é¢˜æ˜¯ä¸ªååˆ†æ²¡æ„æ€çš„è¯»é¢˜é¢˜+äºŒåˆä¸€é¢˜ã€‚æ„Ÿè§‰éè¦æ±‚å‡ºæœ€çŸ­è·¯æ ‘æ¥å°±æ˜¯å¤šæ­¤ä¸€ä¸¾ã€‚ç„¶åä»–è¿™é¢˜ååˆ†æœ‰æ„æ€çš„ä¸€ç‚¹å°±æ˜¯æ˜ç¡®å‘Šè¯‰ä½ äº†è¿™æ˜¯æ£µè™šæ ‘ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤æ ‘ä¸Šå…¨éƒ¨çš„ç‚¹éƒ½æ˜¯çº¯è™šç‚¹ã€‚ç„¶å DP è¿‡ç¨‹å°±æ˜¯æ¶ˆè€—æˆ˜ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> rt ;</span><br><span class="line"><span class="keyword">int</span> col[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, Q, k ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dis[N] ;</span><br><span class="line"><span class="keyword">int</span> pre[N] ;</span><br><span class="line"><span class="keyword">int</span> prev[N] ;</span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"><span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">63</span>, <span class="keyword">sizeof</span>(dis)) ;</span><br><span class="line">    q.push(rt) ; vis[rt] = <span class="number">1</span> ; dis[rt] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front() ;</span><br><span class="line">        q.pop() ; vis[x] = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> t : E[x])&#123;</span><br><span class="line">            <span class="keyword">if</span> (dis[t.fr] &gt; dis[x] + t.sc)&#123;</span><br><span class="line">                dis[t.fr] = dis[x] + t.sc ;</span><br><span class="line">                pre[t.fr] = x, prev[t.fr] = t.sc ;</span><br><span class="line">                <span class="keyword">if</span> (!vis[t.fr])</span><br><span class="line">                    q.push(t.fr), vis[t.fr] = <span class="number">1</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) E[i].clear() ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span> ;</span><br><span class="line"><span class="comment">//printf("%d\n", x) ;</span></span><br><span class="line"><span class="keyword">if</span> (x == rt) val[x] = I ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : T[x])&#123;</span><br><span class="line">        val[y.fr] = min(val[x], y.sc) ;</span><br><span class="line">        solve(y.fr) ; res += f[y.fr] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (col[x]) res = I ;</span><br><span class="line">    f[x] = min(res, val[x]) ;</span><br><span class="line"><span class="comment">//printf("#%d %d %d\n", x, val[x], f[x]) ;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x, y, z ;</span><br><span class="line">    n = qr(), m = qr() ;</span><br><span class="line">rt = qr(), Q = qr() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        x = qr(), y = qr(), z = qr(),</span><br><span class="line">        E[x].p_b(m_k(y, z)), E[y].p_b(m_k(x, z)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    spfa() ; val[rt] = val[<span class="number">0</span>] = I ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (pre[i]) E[pre[i]].p_b(m_k(i, prev[i])) ;</span><br><span class="line">    dep[rt] = <span class="number">1</span>, dfs1(rt), dfs2(rt, rt) ;</span><br><span class="line"><span class="comment">//    for (int i = 1 ; i &lt;= n ; ++ i) printf("%d %d\n", i, prev[i]) ;</span></span><br><span class="line">    <span class="keyword">while</span> (Q --)&#123;</span><br><span class="line">        z = qr() ; k = qr() ;</span><br><span class="line">        <span class="keyword">if</span> (!z)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i) col[qr()] ^= <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            a.clear() ; col[rt] = <span class="number">0</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i) a.p_b(y = qr()), g[y] = <span class="number">1</span> ;</span><br><span class="line">            ins() ; solve(<span class="number">0</span>) ; <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, f[<span class="number">0</span>] ? f[<span class="number">0</span>] : <span class="number">-1</span>) ; clear(<span class="number">0</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h2 id="BOI-2017-Railway"><a href="#BOI-2017-Railway" class="headerlink" title="[BOI 2017] Railway"></a>[BOI 2017] Railway</h2><blockquote><p>ç»™å‡ºä¸€æ£µ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ã€‚æœ‰ $m$ æ¬¡æŸ“è‰²æ“ä½œï¼Œæ¯æ¬¡æ“ä½œç»™å‡ºä¸€äº›ç‚¹ï¼ŒæŠŠè¦†ç›–ä»–ä»¬çš„æœ€å°è¿é€šå—å†…çš„è¾¹æŸ“ä¸Šé¢œè‰²ã€‚æ±‚è¢«æŸ“è‰²æ¬¡æ•°ä¸å°äº $k$ çš„è¾¹æ•°ã€‚</p></blockquote><p>å¤§æ¦‚æ˜¯è€ƒå¯Ÿäº†è™šæ ‘çš„ä¸€ä¸ªæ€§è´¨ï¼Œå°±æ˜¯è™šæ ‘ä¸€å®šå¯ä»¥ä½¿å¾—å…³é”®ç‚¹ä¹‹é—´çš„è·¯å¾„é•¿åº¦ä»¥æœ€çŸ­çš„æ–¹å¼è¿è¾¹(è¿™ä¼¼ä¹åº”è¯¥æ˜¯æ ‘çš„æ€§è´¨)ã€‚ç„¶åå°±æ˜¯æ±‚ä¸€éè™šæ ‘ç„¶åå·®åˆ†ä¸€ä¸‹å°±å¥½äº†ã€‚</p><p>ä¸€ä¸ªå°å½©è›‹ï¼Œä¸€å¼€å§‹å°è¯•å¯¹ dfn æ’åºç›´æ¥å¯¹ä¸´ç‚¹å– LCA æ‰“ tag å‘ç°å¹¶ä¸å¯¹ xï¼Œæˆ‘å¯èƒ½æ˜¯æ™ºéšœäº†ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">do_tag</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="comment">//  printf("%d %d\n", x, y) ;</span></span><br><span class="line">    tag[x] ++, tag[y] -- ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dfn[x] &lt; dfn[y] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tot ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="comment">//  printf("%d\n", x) ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : T[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (x) </span><br><span class="line">do_tag(y, x) ;</span><br><span class="line">        dfs(y) ;</span><br><span class="line">    &#125;</span><br><span class="line">    T[x].clear() ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (y.fr == fa[x]) <span class="keyword">continue</span> ;</span><br><span class="line">        solve(y.fr) ; tag[x] += tag[y.fr] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tag[x] &gt;= k) ans[++ tot] = x ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h2 id="SDOI-2015-å¯»å®æ¸¸æˆ"><a href="#SDOI-2015-å¯»å®æ¸¸æˆ" class="headerlink" title="[SDOI 2015] å¯»å®æ¸¸æˆ"></a>[SDOI 2015] å¯»å®æ¸¸æˆ</h2><blockquote><p>æ²¡æ‰¾åˆ°ç®€åŒ–é¢˜é¢ï¼Œå’•äº†å’•äº†ã€‚</p></blockquote><p>è¿™ä¼¼ä¹è·Ÿè™šæ ‘æ²¡å•¥å…³ç³»ï¼Œåˆä¼¼ä¹æœ‰å•¥å…³ç³»ã€‚æœ¬è´¨ä¸Šæ˜¯è¦æ±‚åœ¨å…³é”®ç‚¹å˜åŒ–æ—¶ç»´æŠ¤è™šæ ‘çš„æƒå’Œï¼Œé‚£ä¹ˆå‘ç°å¯ä»¥ç›´æ¥æ‹¿ä¸ª set ç»´æŠ¤ dfnã€‚æœ‰ç‚¹å°å°çš„ç»†èŠ‚ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> &lt;<span class="keyword">int</span>&gt; s ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> virtual_tree ;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!y) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    x = Id[x] ; y = Id[y] ;</span><br><span class="line">    <span class="keyword">return</span> val[x] + val[y] - (val[lca(x, y)] &lt;&lt; <span class="number">1</span>) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x, y, z, p, q ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line">        x = qr(), y = qr(), z = qr() ;</span><br><span class="line">        E[y].p_b(mk(x, z)), E[x].p_b(mk(y, z)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    dfs2(<span class="number">1</span>, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">while</span> (m --)&#123;</span><br><span class="line">        x = qr() ; </span><br><span class="line">y = dfn[x] ;</span><br><span class="line">        <span class="keyword">if</span> (vis[x])</span><br><span class="line">             s.erase(y) ;</span><br><span class="line">        <span class="keyword">else</span> s.insert(y) ;</span><br><span class="line">        <span class="keyword">auto</span> f = s.lower_bound(y) ;</span><br><span class="line">        <span class="keyword">auto</span> g = s.upper_bound(y) ;</span><br><span class="line">        q = *(g == s.end() ? s.begin() : g) ;</span><br><span class="line">        p = *(f == s.begin() ? -- s.end() : -- f) ;</span><br><span class="line"><span class="comment">//        printf("%d %d\n", p, q) ;</span></span><br><span class="line">        <span class="keyword">if</span> (vis[x])&#123;</span><br><span class="line">            vis[x] = <span class="number">0</span> ;</span><br><span class="line">            ans -= calc(y, p) + calc(y, q) - calc(p, q) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            vis[x] = <span class="number">1</span> ;</span><br><span class="line">            ans += calc(y, p) + calc(y, q) - calc(p, q) ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h2 id="HEOI2014-å¤§å·¥ç¨‹"><a href="#HEOI2014-å¤§å·¥ç¨‹" class="headerlink" title="[HEOI2014] å¤§å·¥ç¨‹"></a>[HEOI2014] å¤§å·¥ç¨‹</h2><blockquote><p>å›½å®¶æœ‰ä¸€ä¸ªå¤§å·¥ç¨‹ï¼Œè¦ç»™ä¸€ä¸ªéå¸¸å¤§çš„äº¤é€šç½‘ç»œé‡Œå»ºä¸€äº›æ–°çš„é€šé“ã€‚</p><p>æˆ‘ä»¬è¿™ä¸ªå›½å®¶ä½ç½®éå¸¸ç‰¹æ®Šï¼Œå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªå•ä½è¾¹æƒçš„æ ‘ï¼ŒåŸå¸‚ä½äºé¡¶ç‚¹ä¸Šã€‚</p><p>åœ¨ 2 ä¸ªå›½å®¶ a,b ä¹‹é—´å»ºä¸€æ¡æ–°é€šé“éœ€è¦çš„ä»£ä»·ä¸ºæ ‘ä¸Š a,b çš„æœ€çŸ­è·¯å¾„ã€‚</p><p>ç°åœ¨å›½å®¶æœ‰å¾ˆå¤šä¸ªè®¡åˆ’ï¼Œæ¯ä¸ªè®¡åˆ’éƒ½æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬é€‰ä¸­äº† k ä¸ªç‚¹ï¼Œç„¶ååœ¨å®ƒä»¬ä¸¤ä¸¤ä¹‹é—´ æ–°å»º C(k,2)æ¡ æ–°é€šé“ã€‚ç°åœ¨å¯¹äºæ¯ä¸ªè®¡åˆ’ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ï¼š 1.è¿™äº›æ–°é€šé“çš„ä»£ä»·å’Œ  2.è¿™äº›æ–°é€šé“ä¸­ä»£ä»·æœ€å°çš„æ˜¯å¤šå°‘ 3.è¿™äº›æ–°é€šé“ä¸­ä»£ä»·æœ€å¤§çš„æ˜¯å¤šå°‘ã€‚</p></blockquote><p>ä¸éš¾å‘ç°åªè¦é¢„å¤„ç†äº†è™šæ ‘ä¸Šç‚¹ä¹‹é—´çš„è¾¹æƒå’Œå°±æ¯”è¾ƒç®€å•äº†ã€‚è€ƒè™‘ç¬¬ä¸€é—®å°±åªéœ€è¦ç®—æ¯æ¡è¾¹çš„è´¡çŒ®ï¼Œç¬¬ä¸‰é—®å°±åªéœ€è¦ç»´æŠ¤ä¸€ä¸ªæœ€å¤§å€¼ä¸€ä¸ªæ¬¡å¤§å€¼å°±å¥½äº†ã€‚ç„¶åç¬¬äºŒé—®æŒ‚äº†å¥½å‡ æ¬¡ï¼Œå› ä¸ºä¸€å¼€å§‹è§‰å¾—è¿™ä¸ªåªè¦å– dfs åºç›¸é‚»çš„ç‚¹å°±ä¸€å®šæœ€ä¼˜â€¦ç„¶åå°±äººæ²¡äº†ã€‚å¤§æ¦‚æœ€å°å€¼å°±éœ€è¦ç»´æŠ¤ä¸€ä¸ªæœ€è¿‘çš„çº¯è™šç‚¹åˆ°è‡ªå·±çš„è·ç¦»ï¼Œç„¶åæ ¹æ®çº¯è™šå’ŒåŠè™šåˆ†ç±»è®¨è®ºä¸€æ³¢å°±å¥½äº†ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dis</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (!b) <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">       <span class="keyword">return</span> dep[a] + dep[b] - (dep[lca(a, b)] &lt;&lt; <span class="number">1</span>) ;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">add_e</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">       T[y].p_b(m_k(x, dis(x, y))) ;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">auto</span> y : T[x]) clear(y.fr) ;</span><br><span class="line">       T[x].clear() ; f[x] = g[x] = h[x] = <span class="number">0</span> ;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">()</span></span>&#123;</span><br><span class="line">       sort(a.begin(), a.end(), [](<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123; <span class="keyword">return</span> dfn[x] &lt; dfn[y] ; &#125;) ;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">auto</span> x : a)&#123;</span><br><span class="line">           <span class="keyword">int</span> z = lca(x, stk[tp]) ;</span><br><span class="line">           <span class="keyword">if</span> (z != stk[tp])&#123;</span><br><span class="line">               <span class="keyword">while</span> (tp &amp;&amp; dep[stk[tp - <span class="number">1</span>]] &gt;= dep[z])</span><br><span class="line">                   add_e(stk[tp], stk[tp - <span class="number">1</span>]), -- tp ;</span><br><span class="line">               <span class="keyword">if</span> (stk[tp] != z) add_e(stk[tp], z), stk[tp] = z ;</span><br><span class="line">           &#125;</span><br><span class="line">           stk[++ tp] = x ;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">while</span> (tp)</span><br><span class="line">           add_e(stk[tp], stk[tp - <span class="number">1</span>]), -- tp ;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">dopre</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> mk = g[x], z ; </span><br><span class="line">       <span class="keyword">int</span> y, v = I, res = <span class="number">0</span> ;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">auto</span> t : T[x])&#123;</span><br><span class="line">           y = t.fr ; </span><br><span class="line">dopre(y) ; </span><br><span class="line">g[x] += g[y] ;</span><br><span class="line">z = dis(x, h[y]) ;</span><br><span class="line">ans3 = min(ans3, v + z) ; </span><br><span class="line"><span class="keyword">if</span> (z &lt; v) </span><br><span class="line">v = z, h[x] = h[y] ; </span><br><span class="line">           ans2 = max(ans2, f[y] + t.sc + res) ;</span><br><span class="line">           res = max(res, f[y] + t.sc) ;</span><br><span class="line">       &#125;</span><br><span class="line"><span class="keyword">if</span> (mk)</span><br><span class="line">ans3 = min(ans3, v), h[x] = x ; </span><br><span class="line">       f[x] = res ;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">       <span class="keyword">int</span> y ;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">auto</span> t : T[x])&#123;</span><br><span class="line">           y = t.fr ; solve(y) ;</span><br><span class="line">           ans1 += <span class="number">1l</span>l * t.sc * (sum - g[y]) * g[y] ;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div></div><h2 id="CF613D-Kingdom-and-its-Cities"><a href="#CF613D-Kingdom-and-its-Cities" class="headerlink" title="CF613D Kingdom and its Cities"></a>CF613D Kingdom and its Cities</h2><blockquote><p>ä¸€ä¸ªç‹å›½æœ‰ n åº§åŸå¸‚ï¼ŒåŸå¸‚ä¹‹é—´ç”± n-1æ¡é“è·¯ç›¸è¿ï¼Œå½¢æˆä¸€ä¸ªæ ‘ç»“æ„ï¼Œå›½ç‹å†³å®šå°†ä¸€äº›åŸå¸‚è®¾ä¸ºé‡è¦åŸå¸‚ã€‚</p><p>è¿™ä¸ªå›½å®¶æœ‰çš„æ—¶å€™ä¼šé­å—å¤–æ•Œå…¥ä¾µï¼Œé‡è¦åŸå¸‚ç”±äºåŠ å¼ºäº†é˜²æŠ¤ï¼Œä¸€å®šä¸ä¼šè¢«å é¢†ã€‚è€Œéé‡è¦åŸå¸‚ä¸€æ—¦è¢«å é¢†ï¼Œè¿™åº§åŸå¸‚å°±ä¸èƒ½é€šè¡Œã€‚</p><p>å›½ç‹å®šäº†è‹¥å¹²é€‰æ‹©é‡è¦åŸå¸‚çš„è®¡åˆ’ï¼Œä»–æƒ³çŸ¥é“ï¼Œå¯¹äºæ¯ä¸ªè®¡åˆ’ï¼Œå¤–æ•Œè‡³å°‘è¦å é¢†å¤šå°‘ä¸ªéé‡è¦åŸå¸‚ï¼Œæ‰ä¼šå¯¼è‡´é‡è¦åŸå¸‚ä¹‹é—´ä¸¤ä¸¤ä¸è¿é€šã€‚å¦‚æœå¤–æ•Œæ— è®ºå¦‚ä½•éƒ½ä¸å¯èƒ½å¯¼è‡´è¿™ç§å±€é¢ï¼Œè¾“å‡º -1ã€‚</p></blockquote><p>æƒ¨é­é™æ™º.png</p><p>æ„Ÿè§‰è¿™é¢˜ç»†èŠ‚æ¨èµ·æ¥æœ‰ç‚¹çƒ¦äººï¼Œä¸»è¦è€ƒå¯Ÿäº†ç»†å¿ƒè®¨è®ºçš„èƒ½åŠ›ã€‚ç›´æ¥æ”¾ä»£ç å§ã€‚å”¯ä¸€éœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯å¦‚æœå­æ ‘å†…åªæœ‰ä¸€ä¸ªå…³é”®ç‚¹ï¼Œå¯ä»¥é€‰æ‹©æš‚æ—¶ä¸å‰²ï¼Œç•™åˆ°ä»¥åã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">       <span class="keyword">int</span> re = <span class="number">0</span> ;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">auto</span> y : T[x])&#123;</span><br><span class="line">           solve(y) ;</span><br><span class="line">           re += g[y], f[x] += f[y] ;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (vis[x])</span><br><span class="line">           f[x] += re, g[x] = <span class="number">1</span> ;</span><br><span class="line">       <span class="keyword">else</span> <span class="keyword">if</span> (re &gt; <span class="number">1</span>) f[x] ++ ;</span><br><span class="line">       <span class="keyword">else</span> <span class="keyword">if</span> (re == <span class="number">1</span>) g[x] = <span class="number">1</span> ;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ£é¼“äº†æ£é¼“è™šæ ‘ï¼Œå‘ç°åŸæ¥éš¾ç‚¹åœ¨DP &lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==&quot; data-original=&quot;https://cdn.jsdelivr.net/gh/xaoxuu/volantis@1.0.6/img/qq/æŠ“ç‹‚.gif&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°äº†ç½‘ä¸Šä¸€ä¸ª QQ è¡¨æƒ…çš„ CDNï¼Œæ„Ÿè§‰å¾ˆå¯çˆ±wã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
    
      <category term="åŠ¨æ€è§„åˆ’/æœ‰æŠ€å·§çš„DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84DP/"/>
    
      <category term="å¥½å¤šå¥½å¤šç»†èŠ‚" scheme="https://www.orchidany.cn/tags/%E5%A5%BD%E5%A4%9A%E5%A5%BD%E5%A4%9A%E7%BB%86%E8%8A%82/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/æ ‘å½¢DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%A0%91%E5%BD%A2DP/"/>
    
      <category term="è™šæ ‘" scheme="https://www.orchidany.cn/tags/%E8%99%9A%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ã€è®­ç»ƒè®°å½•ã€‘6.8 è®­ç»ƒç¬”è®°</title>
    <link href="https://www.orchidany.cn/2020/06/09/6-8-%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/06/09/6-8-è®­ç»ƒç¬”è®°/</id>
    <published>2020-06-09T00:19:27.000Z</published>
    <updated>2020-06-09T03:50:26.108Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä»Šå¤©å› ä¸ºè¡¥ CF å°±åˆåªæ‰“äº†ä¸€åœºã€‚å’•å’•å’•ã€‚</p><a id="more"></a><h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><p>æ¯”è¾ƒä¼ ç»Ÿçš„ä¸€é“ç®€å•é¢˜ã€‚ä½†æ˜¯ä¿© log è¢«å¡äº†= =</p><p>å¤§æ¦‚å°±æ˜¯è¯´è€ƒè™‘æœ€å¤§å€¼æœ€å°ï¼Œå¯èƒ½å¯ä»¥æƒ³åˆ°è¦å»äºŒåˆ†ç­”æ¡ˆã€‚ç„¶åè€ƒè™‘åˆ¤å®šï¼Œè€ƒè™‘ä¸€ä¸ªæƒå€¼ $v$ åˆæ³•ï¼Œå½“ä¸”ä»…å½“å¯ä»¥é€‰å‡ºä¸€ä¸ªé•¿åº¦ $\geqslant k$ çš„å­åºåˆ—ä½¿ä¹‹å’Œ $\leq v$ ã€‚è¿™ä¸ªå¯ä»¥ç”¨ ds ç»´æŠ¤ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è´ªã€‚</p><p>æ„Ÿè§‰ä¸ªäººæ¯”è¾ƒçœ‹ä¸é€è¿™ä¸ªè´ªå¿ƒï¼Œæ¢å¥è¯è¯´ä½ è¦è®©æˆ‘å†™æˆ‘è‚¯å®šå†™ä¸å‡ºæ¥ï¼Œæœ‰ç‚¹åç›´è§‰ã€‚å…·ä½“æ¥è¯´å°±æ˜¯è€ƒè™‘æ¯æ¬¡å°†ä¸€ä¸ªå…ƒç´  <code>push</code> åˆ°ä¸€ä¸ªæ ˆé‡Œï¼Œç„¶åå¦‚æœå½“å‰å…ƒç´ ä¸æ ˆé¡¶å…ƒç´ ä¹‹å’Œ $\gt v$ å°±ä¸æŠŠå½“å‰å…ƒç´ å…¥æ ˆï¼Œå¦åˆ™å¦‚æœå½“å‰å…ƒç´  $\lt$ æ ˆé¡¶å…ƒç´ å°±å…ˆå¼¹æ ˆå†å…¥æ ˆã€‚æœ€ååˆ¤ä¸€ä¸‹å¤´å°¾å°±å¥½äº†ã€‚</p><p>æ„Ÿè§‰è¿™ä¹ˆè´ªå¿ƒçš„é“ç†åœ¨äºï¼Œ æœ€åä¸€ä¸ªå…ƒç´ è¦ä¹ˆæ˜¯åºåˆ—æœ«å°¾çš„å…ƒç´ ï¼Œè¦ä¹ˆå°±æ˜¯åç¼€ä¸­æœ€å°çš„é‚£ä¸ªã€‚æ‰€ä»¥åˆ¤å¤´å°¾æ‰ä¸ä¼šé”…ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: max ;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: min ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2000000001</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> n, k ;</span><br><span class="line"><span class="keyword">int</span> tmp[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> mxv, mnv ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    tmp[cnt = <span class="number">1</span>] = base[<span class="number">1</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1l</span>l * tmp[cnt] + base[i] &lt;= x) tmp[++ cnt] = base[i] ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (tmp[cnt] &gt; base[i]) tmp[cnt] = base[i] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (cnt &gt; k) <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (cnt == k &amp;&amp; <span class="number">1l</span>l * tmp[<span class="number">1</span>] + tmp[cnt] &lt;= x) <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k) ;</span><br><span class="line">    <span class="keyword">int</span> l, r, mid ; mnv = M ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">        mnv = min(mnv, base[i]) ;</span><br><span class="line">        mxv = max(mxv, base[i]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    l = mnv &lt;&lt; <span class="number">1</span> ;</span><br><span class="line">r = mxv &lt;&lt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r)&#123;</span><br><span class="line"><span class="comment">//        printf("%d %d\n", l, r) ;</span></span><br><span class="line">        mid = (<span class="number">1l</span>l * l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">if</span> (check(mid))</span><br><span class="line">             ans = mid, r = mid - <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">else</span> l = mid + <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="1.png" alt=""></p></blockquote><p>æŒºæœ‰æ„æ€çš„ä¸€é“ç»“è®ºé¢˜â€¦ä¸»è¦æ˜¯(æ ‡ç®—çš„)æ€è€ƒè¿‡ç¨‹æŒºå¦™<del>ï¼Œä¸è¿‡çŒœå®Œå°±èµ°äººäº†è°è¿˜è¯å•Šã€‚</del></p><p>å¤§æ¦‚æ˜¯è€ƒè™‘ä»äºŒåˆ†ç­”æ¡ˆå‡ºå‘ã€‚æŠŠ $\geqslant v$ çš„æ‰€æœ‰ä½ç½®ç½®ä¸º $1$ï¼Œå…¶ä½™ä½ç½®ç½®ä¸º $0$ ã€‚é‚£ä¹ˆç­”æ¡ˆ $v$ åˆæ³•<strong>å½“ä¸”ä»…å½“å­˜åœ¨ä¸€è¡Œçš„æ‰€æœ‰æ•°éƒ½ä¸º $1$</strong>ã€‚é¦–å…ˆå……åˆ†æ€§ä¸éš¾çŸ¥é“ï¼Œå° D åªè¦å¿½ç•¥è¿™ä¸€è¡Œï¼Œæ¯æ¬¡åˆ å…¶ä»–çš„ï¼Œè¿™æ ·å° Y ç”±äºæ¯æ¬¡åªèƒ½åˆ ä¸€åˆ—ï¼Œæ‰€ä»¥æœ€åå¿…ç„¶æ˜¯å° D è·èƒœã€‚</p><p>å¿…è¦æ€§è€ƒè™‘å½’çº³ã€‚$n=1$ ä¸éš¾çŸ¥é“ï¼Œç„¶åè€ƒè™‘ $n=k\to n=k+1$ ã€‚å‘ç°æ­¤æ—¶å‰©ä¸‹äº† $k$ è¡Œ $k+1$ åˆ—ï¼Œè½®åˆ°å° Y æ“ä½œï¼Œé‚£ä¹ˆè€ƒè™‘æ¯ä¸€è¡Œä»å·¦å¾€å³ç¬¬ä¸€ä¸ª $0$ï¼Œç”±é¸½ç¬¼åŸç†å¯çŸ¥ï¼Œå¿…å®šå­˜åœ¨ä¸€åˆ—ä¸åŒ…å«è¿™äº› $0$ ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚æ‰€ä»¥å‰©ä¸‹çš„å±€é¢å°±å¯ä»¥å½’çº³åˆ° $n=k$ é‡Œé¢ã€‚è¯æ¯•ã€‚</p><p>è§‚å¯Ÿè¿™ä¸ªè¿‡ç¨‹ï¼Œå‘ç°å…¶å®ä¸éœ€è¦äºŒåˆ†ï¼Œæ¯ä¸€è¡Œä¸­æœ€å°çš„æ•°ï¼Œæ‰€æœ‰è¡Œä¸­çš„æœ€å¤§å€¼å³ä¸ºç­”æ¡ˆã€‚æ‰«ä¸€éå°±å®Œäº†ã€‚</p><h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><p>è¿™é¢˜å¯¹æˆ‘è¿™ç§æ•°ä½ DP èŒæ–°å¾ˆä¸å‹å¥½â€¦</p><p>ä¸€å¼€å§‹æƒ³äº†ä¸ªæš´åŠ›æ±‚ <code>count_of_1</code> çš„ä¸œè¥¿ï¼Œå‘ç°å¹¶ä¸æ˜¯è¿™ä¹ˆç®—çš„â€¦å³å‘ç°æ”¹å˜çš„ä½ç½®æ˜¯ $r$ äºŒè¿›åˆ¶ä¸‹ $1$ çš„ä½æ•°å’Œ $l-1$ äºŒè¿›åˆ¶ä¸‹ $1$ çš„å’Œï¼Œä½†æ˜¯è¦å‡å»é‚£äº›æ”¹äº†ä¸¤éçš„ï¼Œç»è¿‡å†·é™æ‰¾æ€§è´¨å¯ä»¥å‘ç°ï¼Œè¿™éƒ¨åˆ†å°±æ˜¯ä¸¤è€…ä»é«˜ä½åˆ°ä½ä½çš„æœ€é•¿å…¬å…±å‰ç¼€é‡Œé¢ $1$ çš„æ•°é‡ä¹˜äºŒã€‚</p><p>ç„¶åå°±è€ƒè™‘åˆ†åˆ«å¯¹è¿™ä¸¤ä¸ªè¿›è¡Œæ•°ä½ $dp$ ã€‚å‘ç°å¯¹äº $r\geq l$ çš„é™åˆ¶å®Œå…¨å¯ä»¥å»æ‰ï¼Œå› ä¸ºå®¹æ–¥çš„æ—¶å€™ä¼šè¢«ç›´æ¥å®¹æ–¥æ‰ã€‚é‚£ä¹ˆæ€»æ–¹æ¡ˆæ•°å°±å¯ä»¥ç›´æ¥ä¹˜ä¸€ä¸ªç³»æ•° $n$ï¼Œå°±åªéœ€è¦è®¡ç®—ã€Œ$1\sim n$ ä¹‹é—´æ‰€æœ‰æ•°çš„äºŒè¿›åˆ¶ä¸‹ $1$ çš„ä¸ªæ•°ã€ å’Œ ã€Œ$1\sim n$ å†…æ‰€æœ‰çš„æ•°å¯¹ $(l,r)$ çš„ <code>count_of_1(</code>LCP<code>)</code> ã€ã€‚</p><p>è®¾  $g_{i,j,0/1}$ è¡¨ç¤ºä»é«˜åˆ°ä½è€ƒè™‘äº†å‰ $i$ ä½ï¼Œæœ‰ $j$ ä¸ª $1$ ï¼Œ $r$ æ˜¯å¦ç­‰äº $n$ çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»æ—¶éœ€è¦è€ƒè™‘åˆ†ç±»è®¨è®º $n$ çš„å½“å‰ä½æ˜¯å¦ä¸º $1$ ï¼Œå…·ä½“è½¬ç§»å¤§æ¦‚å°±æ˜¯åˆ¤æ–­ä¸€ä¸‹è½¬ç§»å‰å $r$ æ˜¯å¦ä¾æ—§ $=n$ ä¹‹ç±»çš„ã€‚åŒæ—¶è®¾ $f_{i,j,0/1,0/1}$ è¡¨ç¤ºè€ƒè™‘å‰ $i$ ä½ï¼Œæœ€å¤§å…¬å…±å‰ç¼€ä¸­ $1$ çš„ä¸ªæ•°ä¸º $j$ï¼Œ$l=r?,r=n?$ çš„æ–¹æ¡ˆæ•°ã€‚ç„¶åè½¬ç§»ä¾æ—§æ˜¯æ ¹æ®è¾¹ç•Œåˆ†ç±»è®¨è®ºå½“å‰ä½æ”¾ $1$ è¿˜æ˜¯ $0$ï¼Œæ³¨æ„åˆ°ç”±äºåŠ ä¸Šäº† $l,r$ çš„é™åˆ¶ï¼Œæ‰€ä»¥è¦åˆ†ç±»è®¨è®º $l,r$ åˆ†åˆ«æ”¾ä¸æ”¾ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸ªç³»æ•°ã€‚</p><p>ç„¶åæœ€åç­”æ¡ˆå°±æ˜¯</p><script type="math/tex; mode=display">ans=\left(n\times \sum g\right)-\sum f</script><p>å¤æ‚åº¦ $O(T\log n^2)$ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> T ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line">ll n, m ;</span><br><span class="line">ll ans1 ;</span><br><span class="line">ll ans2 ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"><span class="keyword">int</span> g[N][N][<span class="number">2</span>] ;</span><br><span class="line"><span class="keyword">int</span> f[N][N][<span class="number">2</span>][<span class="number">2</span>] ; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        ans1 = ans2 = <span class="number">0</span> ;</span><br><span class="line">        <span class="built_in">memset</span>(g, <span class="number">0</span>, <span class="keyword">sizeof</span>(g)) ;</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f)) ;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n ; m = n ; cnt = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (m) base[++ cnt] = m &amp; <span class="number">1</span>, m &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">        reverse(base + <span class="number">1</span>, base + cnt + <span class="number">1</span>) ;</span><br><span class="line">        g[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>, f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; cnt ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (base[i + <span class="number">1</span>])&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= i ; ++ j)&#123;</span><br><span class="line">                    add(g[i + <span class="number">1</span>][j][<span class="number">0</span>], g[i][j][<span class="number">0</span>]) ;</span><br><span class="line">                    add(g[i + <span class="number">1</span>][j][<span class="number">0</span>], g[i][j][<span class="number">1</span>]) ;</span><br><span class="line">                    add(g[i + <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">1</span>], g[i][j][<span class="number">1</span>]) ;</span><br><span class="line">                    add(g[i + <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">0</span>], g[i][j][<span class="number">0</span>]) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= i ; ++ j)&#123;</span><br><span class="line">                    add(g[i + <span class="number">1</span>][j][<span class="number">0</span>], g[i][j][<span class="number">0</span>]) ;</span><br><span class="line">                    add(g[i + <span class="number">1</span>][j][<span class="number">1</span>], g[i][j][<span class="number">1</span>]) ;</span><br><span class="line">                    add(g[i + <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">0</span>], g[i][j][<span class="number">0</span>]) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; cnt ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (base[i + <span class="number">1</span>])&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= i ; ++ j)&#123;</span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">0</span>][<span class="number">1</span>], f[i][j][<span class="number">1</span>][<span class="number">1</span>]) ;</span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">1</span>][<span class="number">0</span>], f[i][j][<span class="number">1</span>][<span class="number">1</span>]) ;</span><br><span class="line">                    add(f[i + <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>], f[i][j][<span class="number">1</span>][<span class="number">1</span>]) ;</span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">0</span>][<span class="number">0</span>], f[i][j][<span class="number">1</span>][<span class="number">0</span>]) ;</span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">1</span>][<span class="number">0</span>], f[i][j][<span class="number">1</span>][<span class="number">0</span>]) ;</span><br><span class="line">                    add(f[i + <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>], f[i][j][<span class="number">1</span>][<span class="number">0</span>]) ;</span><br><span class="line">                    </span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">0</span>][<span class="number">1</span>], <span class="number">2l</span>l * f[i][j][<span class="number">0</span>][<span class="number">1</span>] % P) ;</span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">0</span>][<span class="number">0</span>], <span class="number">2l</span>l * f[i][j][<span class="number">0</span>][<span class="number">1</span>] % P) ;</span><br><span class="line">                    </span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">0</span>][<span class="number">0</span>], <span class="number">4l</span>l * f[i][j][<span class="number">0</span>][<span class="number">0</span>] % P) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">               <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= i ; ++ j)&#123;</span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">1</span>][<span class="number">1</span>], f[i][j][<span class="number">1</span>][<span class="number">1</span>]) ;</span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">0</span>][<span class="number">0</span>], f[i][j][<span class="number">1</span>][<span class="number">0</span>]) ;</span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">1</span>][<span class="number">0</span>], f[i][j][<span class="number">1</span>][<span class="number">0</span>]) ;</span><br><span class="line">                    add(f[i + <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>], f[i][j][<span class="number">1</span>][<span class="number">0</span>]) ;</span><br><span class="line">                    </span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">0</span>][<span class="number">1</span>], <span class="number">2l</span>l * f[i][j][<span class="number">0</span>][<span class="number">1</span>] % P) ;</span><br><span class="line">                    </span><br><span class="line">                    add(f[i + <span class="number">1</span>][j][<span class="number">0</span>][<span class="number">0</span>], <span class="number">4l</span>l * f[i][j][<span class="number">0</span>][<span class="number">0</span>] % P) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">            add(ans1, <span class="number">1l</span>l * i * addn(g[cnt][i][<span class="number">1</span>], g[cnt][i][<span class="number">0</span>]) % P) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= cnt ; ++ i)</span><br><span class="line">            add(ans2, <span class="number">1l</span>l * i * addn(f[cnt][i][<span class="number">0</span>][<span class="number">1</span>], f[cnt][i][<span class="number">0</span>][<span class="number">0</span>]) % P) ;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; decn(<span class="number">1l</span>l * ans1 * (n % P) % P, <span class="number">2l</span>l * ans2 % P) &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="2.png" alt=""></p><p>$1\leq n\leq 100$ ã€‚</p><p>$1\leq X\leq 10^6$ ã€‚</p></blockquote><p>å‘ç°å˜é‡æœ‰ä¿©ï¼Œæ¥¼çš„é«˜åº¦å’Œæ¥¼ä¹‹é—´çš„è·ç¦»ã€‚å‘ç°é™åˆ¶ä¹‹é—´æ˜¯æœ‰å…³ç³»çš„ï¼Œäºæ˜¯è€ƒè™‘å®šä½ä¸€ä¸ªï¼Œæ¯”å¦‚æ¥¼çš„é«˜åº¦ã€‚è€ƒè™‘è®¾ä¸¤æ ‹æ¥¼ä¹‹é—´çš„è·ç¦»æ˜¯ $x_i$ ï¼Œé‚£ä¹ˆè¦æ»¡è¶³ $x_i\geqslant \max\{h_i,h_{i-1}\}$ ã€‚è®¾ </p><script type="math/tex; mode=display">s=\sum _{i=2}^n\max\{h_i,h_{i-1}\}</script><p>é‚£ä¹ˆå¯çŸ¥æ–¹æ¡ˆæ•°å°±æ˜¯</p><script type="math/tex; mode=display">\binom{X-1-s+n}{n}</script><p>è¿™å°±æ˜¯ä¸€ä¸ª $n+1$ å…ƒä¸€æ¬¡ä¸å®šæ–¹ç¨‹ç»„çš„é—®é¢˜ã€‚è¿™ä¸ªåœ°æ–¹æ¶‰åŠåˆ°ä¸€ä¸ªæŠ€å·§ã€‚å°±æ˜¯è€ƒè™‘é¦–å…ˆå€¼åŸŸæ˜¯ $[1,X]$ ï¼Œæ‰€ä»¥å–å€¼æœ‰ $X-1$ ä¸ªã€‚å…¶æ¬¡ç”±äºè¦æ±‚æ€»å’Œ $\leqslant X$ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘å¤šè®¾å‡ºä¸€ä¸ªå˜é‡ç”¨æ¥ä¿å­˜ä½™å‡ºå»çš„ $X-s$ï¼Œæ‰€ä»¥å°±æ˜¯ $n+1$ ä¸ªå…ƒç´ ã€‚</p><p>ç„¶åå°±æ˜¯è€ƒè™‘å¯¹ $s$ è¿›è¡Œ dpã€‚å…·ä½“çš„ï¼Œè®¾ $f_{i,j,k}$ è¡¨ç¤ºç°åœ¨è€ƒè™‘äº† $1\sim i$ çš„æ’åˆ—ï¼Œè¿˜æœ‰ $j$ ä¸ªä½ç½®æ²¡æœ‰é—­åˆï¼Œå³è¿˜æœ‰ $j$ ä¸ªä½ç½®å¯èƒ½è¿˜ä¼šæ’å…¥æ›´å¤§çš„æ•°ï¼Œå½“å‰ $s$ å€¼ä¸º $k$ çš„æ–¹æ¡ˆæ•°ã€‚ç„¶åè€ƒè™‘æ¯æ¬¡ç›¸å½“äºé€‰ä¸€ä¸ªä½ç½®æ’å…¥ä¸€ä¸ª $i$ ï¼Œæ­¤æ—¶ä¼šäº§ç”Ÿä¸¤ä¸ªæ–°çš„ç©ºä½ï¼Œç„¶ååˆ†ç±»è®¨è®ºä¸€æ³¢é—­åˆä¸é—­åˆå°±å¥½äº†ã€‚æ³¨æ„åˆ°å¦‚æœæ’å…¥å¼€å¤´æˆ–è€…ç»“å°¾ï¼Œé‚£ä¹ˆå°±åªä¼šäº§ç”Ÿ $1$ ä¸ªç©ºä½ï¼Œç‰¹åˆ¤ä¸€ä¸‹è¿™ä¸ªè¾¹ç•Œå°±å¥½äº†ã€‚æœ€åå¤æ‚åº¦ $O(n^4+X)$ ã€‚ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> inv[N] ;</span><br><span class="line"><span class="keyword">int</span> fac[N] ;</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">2</span>][M][N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">expow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">while</span> (b)&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            ret = (ll)ret * a % P ;</span><br><span class="line">        a = (ll)a * a % P ; b &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">binom</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;<span class="comment">//\binom&#123;x&#125;&#123;y&#125;</span></span><br><span class="line">    <span class="keyword">return</span> (ll)fac[x] * inv[y] % P * inv[x - y] % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prework</span><span class="params">(<span class="keyword">int</span> mx)</span></span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = inv[<span class="number">0</span>] = <span class="number">1</span> ; ans = res = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= mx + <span class="number">1</span> ; ++ i)</span><br><span class="line">        fac[i] = <span class="number">1l</span>l * fac[i - <span class="number">1</span>] * i % P ;</span><br><span class="line">    inv[mx + <span class="number">1</span>] = expow(fac[mx + <span class="number">1</span>], P - <span class="number">2</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = mx ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">        inv[i] = <span class="number">1l</span>l * inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; P ; <span class="keyword">int</span> t ;</span><br><span class="line">    prework(m) ; f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, d = <span class="number">0</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line">t = i * i ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= i ; ++ j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt;= t ; ++ k) f[d ^ <span class="number">1</span>][j][k] = <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= i ; ++ j)&#123;</span><br><span class="line"><span class="keyword">if</span> (j)&#123;</span><br><span class="line"><span class="keyword">int</span> p = j + <span class="number">1</span>, q = j + <span class="number">2</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt;= t ; ++ k)&#123;</span><br><span class="line">                add(f[d ^ <span class="number">1</span>][j - <span class="number">1</span>][k + (i + <span class="number">1</span>) * <span class="number">2</span>], <span class="number">1l</span>l * j * f[d][j][k] % P) ;</span><br><span class="line">               add(f[d ^ <span class="number">1</span>][j][k + i + <span class="number">1</span>], <span class="number">2l</span>l * p * f[d][j][k] % P) ;</span><br><span class="line">                add(f[d ^ <span class="number">1</span>][j + <span class="number">1</span>][k], <span class="number">1l</span>l * q * f[d][j][k] % P) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">int</span> p = j + <span class="number">1</span>, q = j + <span class="number">2</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span> ; k &lt;= t ; ++ k)&#123;</span><br><span class="line">               add(f[d ^ <span class="number">1</span>][j][k + i + <span class="number">1</span>], <span class="number">2l</span>l * p * f[d][j][k] % P) ;</span><br><span class="line">                add(f[d ^ <span class="number">1</span>][j + <span class="number">1</span>][k], <span class="number">1l</span>l * q * f[d][j][k] % P) ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">        d ^= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        add(ans, <span class="number">1l</span>l * f[!(n &amp; <span class="number">1</span>)][<span class="number">0</span>][i] * binom(m - i + n - <span class="number">1</span>, n) % P) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»Šå¤©å› ä¸ºè¡¥ CF å°±åˆåªæ‰“äº†ä¸€åœºã€‚å’•å’•å’•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ZROI" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/ZROI/"/>
    
    
      <category term="æ€ç»´é¢˜/è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E8%AE%A1%E6%95%B0/"/>
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="ç»„åˆè®¡æ•°/æœ‰æŠ€å·§çš„è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84%E8%AE%A1%E6%95%B0/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/æœ‰æŠ€å·§çš„DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84DP/"/>
    
      <category term="æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ " scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E8%A7%82%E5%AF%9F%E6%80%A7%E8%B4%A8-%E7%BB%93%E8%AE%BA%E4%B8%8E%E6%9E%84%E9%80%A0/"/>
    
      <category term="è´ªå¿ƒ" scheme="https://www.orchidany.cn/tags/%E8%B4%AA%E5%BF%83/"/>
    
      <category term="æœ‰è¶£çš„äºŒåˆ†ç­”æ¡ˆ" scheme="https://www.orchidany.cn/tags/%E6%9C%89%E8%B6%A3%E7%9A%84%E4%BA%8C%E5%88%86%E7%AD%94%E6%A1%88/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/æ•°ä½DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%95%B0%E4%BD%8DDP/"/>
    
  </entry>
  
  <entry>
    <title>ã€è®­ç»ƒè®°å½•ã€‘6.5 è®­ç»ƒç¬”è®°</title>
    <link href="https://www.orchidany.cn/2020/06/09/6-5-%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/06/09/6-5-è®­ç»ƒç¬”è®°/</id>
    <published>2020-06-09T00:19:13.000Z</published>
    <updated>2020-06-14T12:28:48.653Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å•¦å•¦å•¦å•¦</p><a id="more"></a><h1 id="A-M"><a href="#A-M" class="headerlink" title="A.M."></a>A.M.</h1><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><p>ç®€å•é¢˜ã€‚</p><p>å¤§æ¦‚æ˜¯è¯´å¦‚æœè¿ä¸Šäº†ä¸¤æ¡è¾¹ï¼Œé‚£ä¹ˆè¿™æ¡è¾¹è¿æ¥çš„ä¸¤ä¸ªç‚¹å°±å¯ä»¥ç›´æ¥åˆå¹¶èµ·æ¥ã€‚è€ƒè™‘ä¸ºäº†ä¿è¯å¤æ‚åº¦ï¼Œéœ€è¦è¿›è¡Œå¯å‘å¼åˆå¹¶ã€‚äºæ˜¯å°±å¯ä»¥æ‹¿ä¸€ä¸ª <code>set</code> ç»´æŠ¤ï¼Œä½†è¿™æ ·ä¼šå¤šä¸€ä¸ª logã€‚è€ƒè™‘ç›´æ¥æ‹¿ <code>vector</code> ç»´æŠ¤ï¼Œå¯¹æ¯ä¸ªç‚¹è®¾ä¸€ä¸ª <code>vis</code> å°±ä¸éœ€è¦åˆ é™¤äº†ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> fa[N] ;</span><br><span class="line"><span class="keyword">int</span> n, m, q ;</span><br><span class="line"><span class="keyword">bool</span> vis[N] ;</span><br><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; s[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (fa[x] == x) <span class="keyword">return</span> x ;</span><br><span class="line">    <span class="keyword">return</span> fa[x] = find(fa[x]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">void merge(int x, int y)&#123;</span></span><br><span class="line"><span class="comment">    int f1 = find(x) ;</span></span><br><span class="line"><span class="comment">    int f2 = find(y) ;</span></span><br><span class="line"><span class="comment">    if (f1 != f2)</span></span><br><span class="line"><span class="comment">        fa[f1] = f2 ;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; q ; <span class="keyword">int</span> x, y ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) fa[i] = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        x = qr(), y = qr(), s[x].p_b(y), s[y].p_b(x) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)&#123;</span><br><span class="line">        x = find(qr()) ;</span><br><span class="line">y = find(qr()) ;</span><br><span class="line">        <span class="keyword">if</span> (x == y)&#123;</span><br><span class="line">            <span class="built_in">putchar</span>(<span class="string">'1'</span>) ;</span><br><span class="line">            <span class="keyword">continue</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> z : s[x])</span><br><span class="line"><span class="keyword">if</span> (z == y) <span class="keyword">goto</span> fuck ;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">'1'</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (s[x].size() &gt; s[y].size())</span><br><span class="line">            swap(x, y) ; fa[x] = y ; vis[x] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> z : s[x])</span><br><span class="line">            <span class="keyword">if</span> (!vis[z]) s[z].p_b(y), s[y].p_b(z) ;</span><br><span class="line">      <span class="keyword">continue</span> ;</span><br><span class="line">        fuck : <span class="built_in">putchar</span>(<span class="string">'0'</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><p>ç®€å•é¢˜ã€‚</p><p>è€ƒè™‘ä¸€ä¸ªæ€§è´¨ï¼Œå¤§æ¦‚å°±æ˜¯è¯´å‰©ä¸‹æ²¡æœ‰è¿èµ·æ¥çš„å¼¦ï¼Œä¸ç›¸äº¤ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚äºæ˜¯å°±å¯ä»¥ç›´æ¥ dp äº†ã€‚è®¾ $f_{i,j}$ è¡¨ç¤ºè€ƒè™‘ $[i,j]$ ä¹‹é—´è¿˜æ²¡è¿çš„ç‚¹ï¼Œæœ€å°ä»£ä»·æ˜¯å¤šå°‘ã€‚è½¬ç§»å°±è€ƒè™‘æšä¸¾ä¸€ä¸ª $[i,j]$ ä¹‹é—´å’Œ $i$ ç›¸è¿çš„ç‚¹å³å¯ã€‚æ³¨æ„åˆ°è¿™æ ·å°±éœ€è¦ $[i,j]$ é‡Œæ²¡æœ‰é…å¯¹çš„ç‚¹ä¸ºå¶æ•°ã€‚</p><p>ç„¶åè€ƒè™‘æ–¹æ¡ˆæ•° $g_{i,j}$ï¼Œå°±åªéœ€è¦åœ¨ç»´æŠ¤ $f_{i,j}$ æ—¶é¡ºä¾¿è®¡æ•°ä¸€ä¸‹å°±å¥½äº†ã€‚å¤æ‚åº¦ $O(n^3)$ ã€‚</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><p>æ¯”è¾ƒç¥å¥‡çš„é¢˜ç›®â€¦</p><blockquote><p>ç»™å®šä¸€ä¸ªæ’å…¥åºåˆ—ã€‚ç¼–å·ä¸º $i$ çš„å…ƒç´ æœ‰ä¸€ä¸ªé¢œè‰² $col_i$ å’Œä¸€ä¸ªé˜ˆå€¼ $a_i$ã€‚æ’å…¥ $i$ çš„æ—¶å€™ï¼Œ$i$ åº”å½“æ”¾åˆ°æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æœ€é å‰çš„ä½ç½® $p$ï¼š</p><p>1ã€å½“å‰ä½äº $p$ æˆ–è€… $p+1$ çš„å…ƒç´ é¢œè‰²ä¸ $col_i$ ç›¸åŒã€‚</p><p>2ã€ä¸èƒ½æœ‰è¶…è¿‡ $a_i$ ä¸ªå…ƒç´ å› æ­¤è€Œåç§»ã€‚</p><p>æ±‚æœ€ç»ˆæ’å…¥å…¨éƒ¨å…ƒç´ åæ¯ä¸ªä½ç½®çš„å…ƒç´ ç¼–å·ã€‚$1\leq n\leq 3\times 10^5$ ã€‚</p></blockquote><p>é‚£å¿…ç„¶æ˜¯å…ˆè½ä¸€ä¸ª $50pts$ çš„ <code>vector</code> æš´åŠ›<del>ç„¶åå°± 250 æ»šç²—äº†</del> ã€‚</p><p>å¤§æ¦‚æ˜¯è€ƒè™‘å¦‚æœçŸ¥é“äº†æ¯ä¸ªå…ƒç´ åœ¨å½“æ—¶æ’å…¥å®Œæ¯•ååœ¨ç¬¬å‡ ä½ï¼Œå³ $rank_i$ ï¼Œå°±å¯ä»¥ç›´æ¥çº¿æ®µæ ‘äºŒåˆ†å‡ºæœ€åå®é™…çš„ rankã€‚å…·ä½“çš„ï¼Œè€ƒè™‘æŠŠæ•°ä»åå¾€å‰æ’å…¥çº¿æ®µæ ‘ï¼Œè¿™æ ·æ¯æ¬¡å°±éœ€è¦ä»çº¿æ®µæ ‘ä¸­äºŒåˆ†å‡ºç¬¬ä¸€ä¸ªä½ç½® $p$ ä½¿å¾— $p-sum_p=rank_i$ ï¼Œå…¶ä¸­ $sum_p$ æ˜¯å‰ç¼€å’Œã€‚ä¸éš¾çŸ¥é“è¿™æ ·åšæ˜¯å¯¹çš„ã€‚</p><p>ä¹‹åè€ƒè™‘æ€ä¹ˆæ±‚å‡º $rank_i$ ã€‚è¿™ä¸ªåœ°æ–¹æœ‰ä¸ªååˆ†æ·±åˆ»çš„æ€§è´¨ï¼Œå¤§æ¦‚æ˜¯è¯´è€ƒè™‘å¦‚æœæœ‰å¤šä¸ªç›¸é‚»é¢œè‰²çš„å…ƒç´ æ”¾åœ¨ç›¸é‚»çš„ä½ç½®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¹¶ä¸å…³å¿ƒé åçš„é‚£äº›å…ƒç´ ï¼Œå¯ä»¥ç›´æ¥åˆå¹¶ï¼Œå› ä¸ºè¾¹ç•Œæ¯”è¾ƒå¥½å¤„ç†ï¼Œå¹¶ä¸”è¿™æ ·è½¬åŒ–ä¹‹åå°±åªä¼šå‡ºç°åœ¨åé¢æ’å…¥æ–°çš„å…ƒç´ ï¼Œå¯ä»¥ç›´æ¥ <code>push_back</code>ã€‚é‚£ä¹ˆç°åœ¨å¦‚æœè¦æ’å…¥ä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆå¯ä»¥å…ˆæ‰¾åˆ°è¿™ä¸ªå…ƒç´ ä¸è€ƒè™‘é¢œè‰²æ—¶æœ€å°‘åº”è¯¥æ”¾åœ¨çš„ä½ç½® $p$ï¼Œç„¶åå»å¯¹åº”é¢œè‰²çš„ <code>vector</code> é‡ŒäºŒåˆ†å³å¯ã€‚è¿™æ ·æ¯æ¬¡æ’å…¥å°±å¯ä»¥æ¢æˆåœ¨çº¿æ®µæ ‘ä¸Šè¿›è¡Œå•ç‚¹åŠ ã€‚æ³¨æ„å¯èƒ½å­˜åœ¨ä¸€ä¸ªé¢œè‰²çš„è¿ç»­æ®µè·¨è¿‡ $p$ çš„æƒ…å†µï¼Œåˆ¤ä¸€ä¸‹è¾¹ç•Œå°±å¥½äº†ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">chkmax</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span></span>&#123; x = y &gt; x ? y : x ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line">vint col[N] ;</span><br><span class="line"><span class="keyword">int</span> org_rk[N] ;</span><br><span class="line"><span class="keyword">int</span> seg[N * <span class="number">3</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _ed end</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _bg begin</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_b push_back</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (rt &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc (rt &lt;&lt; 1 | 1)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>(seg[rt] += v) ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid) upd(lc, l, mid, p, v) ;</span><br><span class="line">    <span class="keyword">else</span> upd(rc, mid + <span class="number">1</span>, r, p, v) ;</span><br><span class="line">    seg[rt] = seg[lc] + seg[rc] ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fd</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (seg[lc] &gt;= p) <span class="keyword">return</span> fd(lc, l, mid, p) ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> fd(rc, mid + <span class="number">1</span>, r, p - seg[lc]) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qry</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> seg[rt] ;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid) <span class="keyword">return</span> qry(lc, l, mid, p) ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> seg[lc] + qry(rc, mid + <span class="number">1</span>, r, p) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    qr(n) ;</span><br><span class="line">    <span class="keyword">int</span> x, y, z, o, p, q ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        qr(x), qr(y) ; </span><br><span class="line">z = fd(<span class="number">1</span>, <span class="number">0</span>, n, i - y - <span class="number">1</span>) ;</span><br><span class="line">        o = lower_bound(col[x]._bg(), col[x]._ed(), z) - col[x]._bg() ;</span><br><span class="line">        <span class="keyword">if</span> (o == col[x].size()) col[x].p_b(++ m) ; o = col[x][o] ;</span><br><span class="line">        org_rk[i] = qry(<span class="number">1</span>, <span class="number">0</span>, n, o - <span class="number">1</span>) + <span class="number">1</span> ;</span><br><span class="line">        chkmax(org_rk[i], i - y) ;</span><br><span class="line">        upd(<span class="number">1</span>, <span class="number">0</span>, n, o, <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n * <span class="number">3</span> ; ++ i) seg[i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) upd(<span class="number">1</span>, <span class="number">1</span>, n, i, <span class="number">1</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)&#123;</span><br><span class="line">        p = fd(<span class="number">1</span>, <span class="number">1</span>, n, org_rk[i]) ;</span><br><span class="line">        ans[p] = i ; upd(<span class="number">1</span>, <span class="number">1</span>, n, p, <span class="number">-1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">qwa(ans + <span class="number">1</span>, n, <span class="string">' '</span>, <span class="string">'\n'</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><p>233</p><h1 id="P-M"><a href="#P-M" class="headerlink" title="P.M."></a>P.M.</h1><p>ä¸‹åˆçš„é¢˜æ¯”è¾ƒæ°´â€¦</p><h2 id="A-1"><a href="#A-1" class="headerlink" title="A"></a>A</h2><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="1.png" alt=""></p></blockquote><p>ç®€å•é¢˜ã€‚</p><p>ä¸€å¼€å§‹çš„æƒ³æ³•å°±æ˜¯æŠŠæ£‹ç›˜è½¬ä¸ª $45Â°$ å¯èƒ½ä¼šæ¯”è¾ƒå¥½åšã€‚åæ¥å‘ç°å®Œå…¨å¯ä»¥ç›´æ¥è®°ä¸€ä¸‹å¯¹è§’çº¿çš„ç¼–å·ã€‚ä¹‹åå°±è€ƒè™‘å…ˆç®—å‰¯å¯¹è§’çº¿ï¼Œç„¶åç®—ä¸»å¯¹è§’çº¿ã€‚è¿™æ ·çš„è¯ï¼Œç®—ä¸»å¯¹è§’çº¿æ—¶å°±éœ€è¦å¯¹ä¸æ‰€æœ‰å‰¯å¯¹è§’çº¿çš„äº¤ç‚¹çš„è´¡çŒ®è¿›è¡Œå®¹æ–¥ï¼Œä½†æ˜¯å‘ç°å’Œä¸€æ¡ä¸»å¯¹è§’çº¿çš„å‰¯å¯¹è§’çº¿ç¼–å·æ˜¯è¿ç»­çš„ï¼Œå°±æ¯”è¾ƒå¥½ç®—ã€‚</p><p>ç»†èŠ‚åœ¨äºï¼Œè¦è€ƒè™‘ç¼–å·å¥‡å¶æ€§ï¼Œå› ä¸ºç»è¿‡ $(1,2),(2,1)$ çš„å¯¹è§’çº¿å’Œç»è¿‡ $(1,1),(2,2)$ çš„å¯¹è§’çº¿è™½ç„¶ç›¸äº¤ï¼Œä½†æ˜¯äº¤ç‚¹ä¸æ˜¯æ•´ç‚¹ã€‚ç„¶åå¯¹å¥‡å¶ç¼–å·åˆ†åˆ«æ‹¿ä¸ªæ¡¶ç»´æŠ¤å°±å¥½äº†ã€‚å¤æ‚åº¦ $O(n+m)$ ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">abs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> x &gt; <span class="number">0</span> ? x : -x ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    qr(n), qr(m) ; <span class="keyword">int</span> z = <span class="number">3</span> * n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        qr(base[i].fr), qr(base[i].sc) ;</span><br><span class="line">        vis0[base[i].fr + base[i].sc - <span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">        vis1[n - base[i].sc + base[i].fr] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n + n - <span class="number">1</span> ; ++ i)&#123;</span><br><span class="line">        ans += vis0[i] * (n - <span class="built_in">abs</span>(n - i)) ;</span><br><span class="line">        buc1[i] = buc1[i - <span class="number">1</span>] + (i &amp; <span class="number">1</span>) * vis0[i] ;</span><br><span class="line">        buc0[i] = buc0[i - <span class="number">1</span>] + (!(i &amp; <span class="number">1</span>)) * vis0[i] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &amp; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis1[i])</span><br><span class="line">                <span class="keyword">continue</span> ;</span><br><span class="line">            ans += n - <span class="built_in">abs</span>(n - i) ;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">             ans -= buc1[i + n - <span class="number">1</span>] - buc1[n - i] ;</span><br><span class="line">        <span class="keyword">else</span> ans -= buc0[i + n - <span class="number">1</span>] - buc0[n - i] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n + <span class="number">1</span> ; i &lt;= n + n - <span class="number">1</span> ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis1[i])</span><br><span class="line">                <span class="keyword">continue</span> ;</span><br><span class="line">        ans += n - <span class="built_in">abs</span>(n - i) ;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">             ans -= buc1[z - i - <span class="number">1</span>] - buc1[i - n] ;</span><br><span class="line">        <span class="keyword">else</span> ans -= buc0[z - i - <span class="number">1</span>] - buc0[i - n] ;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis1[i])</span><br><span class="line">                <span class="keyword">continue</span> ;</span><br><span class="line">        ans += n - <span class="built_in">abs</span>(n - i) ;</span><br><span class="line">        <span class="keyword">if</span> (!(i &amp; <span class="number">1</span>))</span><br><span class="line">             ans -= buc1[i + n - <span class="number">1</span>] - buc1[n - i] ;</span><br><span class="line">        <span class="keyword">else</span> ans -= buc0[i + n - <span class="number">1</span>] - buc0[n - i] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n + <span class="number">1</span> ; i &lt;= n + n - <span class="number">1</span> ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis1[i])</span><br><span class="line">                <span class="keyword">continue</span> ;</span><br><span class="line">        ans += n - <span class="built_in">abs</span>(n - i) ;</span><br><span class="line">        <span class="keyword">if</span> (!(i &amp; <span class="number">1</span>))</span><br><span class="line">             ans -= buc1[z - i - <span class="number">1</span>] - buc1[i - n] ;</span><br><span class="line">        <span class="keyword">else</span> ans -= buc0[z - i - <span class="number">1</span>] - buc0[i - n] ;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    qw(ans, <span class="string">'\n'</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h2 id="B-1"><a href="#B-1" class="headerlink" title="B"></a>B</h2><p>æ¯”è¾ƒç®€å•çš„åˆ†ç±»è®¨è®ºé¢˜ã€‚</p><p>ä¸€å¼€å§‹è¯»é”™é¢˜äº†ï¼Œä»¥ä¸ºæ¯ä¸ªç‚¹çš„ç¼–å·éƒ½å¿…é¡»æ˜¯ $1\sim n$ â€¦åæ¥å‘ç°åªè¦ $\lt 10^6$ å°±å¥½äº†ã€‚ç„¶åå¦‚æœæ˜¯ $\lt n$ ä¹Ÿä¸æ˜¯æ²¡æœ‰åŠæ³•ï¼Œåªæ˜¯åªèƒ½åšå°ä¸€ç‚¹ï¼Œå¤§æ¦‚å°±æ˜¯è€ƒè™‘æ˜¾ç„¶åªéœ€è¦ç®¡é‚£äº› $\deg_x$ æ˜¯å¥‡æ•°çš„ $x$ ï¼Œç„¶åç›¸å½“äºä»è¿™äº›é‡Œé¢é€‰æ‹©æ°å¥½ $k$ ä¸ªå¯ä»¥æ”¹å˜ç¼–å·çš„å…ƒç´ ä½¿ä¹‹å¼‚æˆ–å’Œç­‰äºä¸€ä¸ªå®šå€¼ $c$ ã€‚è¿™æ˜¾ç„¶æ˜¯å¯ä»¥ $n^3$ dp çš„ã€‚</p><p>ç„¶åè€ƒè™‘æ­£å¸¸ç‰ˆæœ¬ï¼Œ$\lt 10^6$ çš„ã€‚è€ƒè™‘è¿™æ ·çš„è¯æƒå€¼ä¸€å®šç¨‹åº¦ä¸Šå°±å¯ä»¥ xjb æ‰¾ã€‚å…·ä½“çš„ï¼ŒæŠŠå¯ä»¥ä¿®æ”¹æƒå€¼å¹¶ä¸”åº¦æ•°ä¸ä¸ºå¶æ•°çš„èŠ‚ç‚¹ç§°ä½œ pks ç‚¹ï¼Œé‚£ä¹ˆåˆ†ç±»è®¨è®ºä¸€ä¸‹ pks ç‚¹çš„æ•°é‡(0/1/2/2+)ï¼Œç‰¹åˆ¤ä¸€äº›ä¸åˆæ³•çš„æƒ…å†µå°±å¥½äº†ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> col[N] ;</span><br><span class="line"><span class="keyword">int</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> deg[N] ;</span><br><span class="line"><span class="keyword">int</span> able[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">out_put</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Yes"</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        qw(ans[i], <span class="string">' '</span>) ; <span class="built_in">putchar</span>(<span class="string">'\n'</span>) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x, y, z ;</span><br><span class="line">    qr(n) ; res = n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        qr(col[i]), ans[i] = i ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line">        qr(x), qr(y), res ^= x ^ y ;</span><br><span class="line">        deg[x] ^= <span class="number">1</span>, deg[y] ^= <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!res) <span class="keyword">return</span> out_put() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (col[i] &amp;&amp; deg[i]) able[++ cnt] = i ;</span><br><span class="line">    <span class="keyword">if</span> (!cnt) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"No"</span>), <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cnt &lt;= <span class="number">1</span>)&#123;</span><br><span class="line">        x = able[<span class="number">1</span>] ;</span><br><span class="line">        y = res ^ x ; ans[x] = y ;</span><br><span class="line">        <span class="keyword">if</span> (y &lt;= n)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!col[y])</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"No"</span>), <span class="number">0</span> ;</span><br><span class="line">            ans[y] = MAXV ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> out_put() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        z = <span class="number">0</span> ;</span><br><span class="line">        x = able[++ z] ;</span><br><span class="line">        y = able[++ z] ;</span><br><span class="line">        <span class="keyword">if</span> (res == (x ^ y))&#123;</span><br><span class="line">            <span class="keyword">if</span> (z == cnt)</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"No"</span>), <span class="number">0</span> ;</span><br><span class="line">            <span class="keyword">else</span> y = able[++ z] ;</span><br><span class="line">        &#125;</span><br><span class="line">        z = x ^ y ^ res ;</span><br><span class="line">        ans[x] = MAXV ; ans[y] = MAXV ^ z ;</span><br><span class="line">        <span class="keyword">return</span> out_put() ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h2 id="C-1"><a href="#C-1" class="headerlink" title="C"></a>C</h2><blockquote><p>ç»™å®šä¸€ä¸ªåºåˆ—ï¼Œæ”¯æŒå¦‚ä¸‹ä¸¤ä¸ªæ“ä½œï¼š</p><p>1ã€å•ç‚¹ä¿®æ”¹ã€‚</p><p>2ã€ç»™å‡ºä¸€ä¸ª $x_i$ ã€‚å…¨å±€æŸ¥è¯¢æœ‰å¤šå°‘ä¸ªæé•¿çš„è¿ç»­æ®µï¼Œæ»¡è¶³è¿ç»­æ®µå†…çš„æ•°éƒ½ $\geqslant x_i$ </p><p>$5\times 10^5$  ã€‚</p></blockquote><p>æ„Ÿè§‰æ˜¯æ¯”è¾ƒç»å…¸çš„æ€è·¯ã€‚è€ƒè™‘è¿ç»­æ®µå¯ä»¥çœ‹åšè¿é€šå—ï¼Œæ›´è¿›ä¸€æ­¥æ˜¯ä¸€æ£µæ ‘ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰ $s$ ä¸ªç‚¹å’Œ $s-1$ æ¡è¾¹ã€‚äºæ˜¯è€ƒè™‘æ‰€æœ‰è¿é€šå—é‡Œç‚¹çš„æ•°é‡ä¹‹å’Œå‡å»è¾¹çš„æ•°é‡ä¹‹å’Œå°±æ˜¯è¿é€šå—ä¸ªæ•°ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥åˆ†åˆ«ç»´æŠ¤ã€Œæœ‰å¤šå°‘ä¸ª $a_i\geqslant x$ ã€å’Œæœ‰å¤šå°‘ä¸ªã€Œ $\min\{a_i,a_{i-1}\}\geqslant x$ã€ã€‚æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ä¸€æ³¢å°±å¥½äº†ã€‚éœ€è¦ç¦»æ•£åŒ–ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lwb lower_bound</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BIT</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> _b[N], v_max ;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> low(x) (x &amp; -x)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> ( ; p &lt;= v_max ; p += low(p)) _b[p] += v ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">qry</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> ( ; p ; p -= low(p)) ret += _b[p] ;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;_b1, _b2 ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> n, q ;</span><br><span class="line"><span class="keyword">int</span> v[N] ;</span><br><span class="line"><span class="keyword">int</span> qm[N] ;</span><br><span class="line"><span class="keyword">int</span> qp[N] ;</span><br><span class="line"><span class="keyword">int</span> qv[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q ; <span class="keyword">int</span> p ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        v[++ cnt] = base[i] = qr() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)&#123;</span><br><span class="line">        qm[i] = qr() ;</span><br><span class="line">        <span class="keyword">if</span> (qm[i] == <span class="number">1</span>) v[++ cnt] = qv[i] = qr() ;</span><br><span class="line">        <span class="keyword">else</span> qp[i] = qr(), v[++ cnt] = qv[i] = qr() ;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(v + <span class="number">1</span>, v + cnt + <span class="number">1</span>) ;</span><br><span class="line">    cnt = unique(v + <span class="number">1</span>, v + cnt + <span class="number">1</span>) - (v + <span class="number">1</span>) ;</span><br><span class="line">    _b1.v_max = _b2.v_max = cnt ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        base[i] = lwb(v + <span class="number">1</span>, v + cnt + <span class="number">1</span>, base[i]) - v ;</span><br><span class="line">        _b1.ins(base[i], <span class="number">1</span>) ; <span class="keyword">if</span> (i &gt; <span class="number">1</span>) _b2.ins(min(base[i], base[i - <span class="number">1</span>]), <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    debug(base, 1, n) ;</span></span><br><span class="line"><span class="comment">//    debug(_b1.qry(_b1.v_max)) ;</span></span><br><span class="line"><span class="comment">//    debug(_b2.qry(_b1.v_max)) ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= q ; ++ i)&#123;</span><br><span class="line">        qv[i] = lwb(v + <span class="number">1</span>, v + cnt + <span class="number">1</span>, qv[i]) - v ;</span><br><span class="line"><span class="comment">//        debug(qv[i]) ;</span></span><br><span class="line">        <span class="keyword">if</span> (qm[i] == <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, (n - _b1.qry(qv[i] - <span class="number">1</span>)) - (n - <span class="number">1</span> - _b2.qry(qv[i] - <span class="number">1</span>))) ;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            p = qp[i] ;</span><br><span class="line">            _b1.ins(qv[i], <span class="number">1</span>) ;</span><br><span class="line">            _b1.ins(base[p], <span class="number">-1</span>) ;</span><br><span class="line">            <span class="keyword">if</span> (p &lt; n) _b2.ins(min(qv[i], base[p + <span class="number">1</span>]), <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">if</span> (p &gt; <span class="number">1</span>) _b2.ins(min(qv[i], base[p - <span class="number">1</span>]), <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">if</span> (p &lt; n) _b2.ins(min(base[p], base[p + <span class="number">1</span>]), <span class="number">-1</span>) ;</span><br><span class="line">            <span class="keyword">if</span> (p &gt; <span class="number">1</span>) _b2.ins(min(base[p], base[p - <span class="number">1</span>]), <span class="number">-1</span>) ;</span><br><span class="line">            base[p] = qv[i] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹åˆå®Œå®Œå…¨å…¨å°±æ˜¯åœ¨åˆ’æ°´å•Šï¼ï¼Ÿ</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å•¦å•¦å•¦å•¦&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ZROI" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/ZROI/"/>
    
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="æ€ç»´é¢˜/å¯¹åº”ä¸è½¬åŒ–" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E5%AF%B9%E5%BA%94%E4%B8%8E%E8%BD%AC%E5%8C%96/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/æ™®é€šDP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%99%AE%E9%80%9ADP/"/>
    
      <category term="å¥½å¤šå¥½å¤šç»†èŠ‚" scheme="https://www.orchidany.cn/tags/%E5%A5%BD%E5%A4%9A%E5%A5%BD%E5%A4%9A%E7%BB%86%E8%8A%82/"/>
    
      <category term="æ•°æ®ç»“æ„/çº¿æ®µæ ‘" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘[CF Round#474(Combined) A~G] é¢˜è§£</title>
    <link href="https://www.orchidany.cn/2020/06/08/CF-474-Combined/"/>
    <id>https://www.orchidany.cn/2020/06/08/CF-474-Combined/</id>
    <published>2020-06-08T12:59:49.000Z</published>
    <updated>2020-06-09T00:08:55.923Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>æ„Ÿè§‰è¿™åœºçš„é¢˜ç›®è´¨é‡è¿˜æ˜¯ä¸é”™çš„ï¼Ÿç¡®å®æ¯”ä»¥å‰ vp è¿‡çš„å‡ åœº (Div1+Div2) è¦å¥½å¾ˆå¤šã€‚</p><p>å¤§æ¦‚æ˜¯æŠŠé™¤äº† H ä¹‹å¤–ä¸€æ•´åœºçš„é¢˜ç›®éƒ½åšæ‰äº†ã€‚æœ‰äº›ä¸æ˜¯ååˆ†å¿…è¦å†™çš„é¢˜ç›®å½“ç„¶å°±æ˜¯å£èƒ¡å•¦ã€‚</p><a id="more"></a><h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><p>ç§’äº†ã€‚</p><p>äººå£æ™®æŸ¥é¢˜ã€‚</p><h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote><p>æœ‰ä¸¤ä¸ªé•¿åº¦å‡ä¸º $n$ çš„åºåˆ— $a,b$ï¼Œå®šä¹‰ ${\rm cost}(a,b)$ ï¼š</p><script type="math/tex; mode=display">{\rm cost}(a,b)=\sum_{i=1}^{n}\left(a_{i}-b_{i}\right)^{2}</script><p>ç°åœ¨å¿…é¡»<strong>æ°å¥½</strong>å¯¹ $a$ è¿›è¡Œ $k_1$ æ¬¡æ“ä½œï¼Œå¯¹ $b$ è¿›è¡Œ $k_2$ æ¬¡æ“ä½œã€‚æ“ä½œå†…å®¹æ˜¯å°†æŸä¸€é¡¹åŠ ä¸€æˆ–è€…å‡ä¸€ã€‚æ±‚æ“ä½œåçš„æœ€å° $\rm cost$ã€‚</p><p>$1\leq n\leq 2000$ã€‚</p></blockquote><p>ç§’äº†ã€‚</p><p>é™æ™ºè´ªå¿ƒï¼Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆå°±æƒ³äº†ä¸€ä¼šå„¿ï¼Œå‘ç° $n=2000$ ä¹‹åå°±ç§’æ‰äº†= = </p><p>å¤§æ¦‚æ˜¯è€ƒè™‘åˆ†ç±»è®¨è®ºç°åœ¨æ“ä½œæ˜¯è®©ä¸¤ä¸ªæ•°åˆ—å°½é‡é è¿‘è¿˜æ˜¯å°½é‡è¿œç¦»ã€‚ç¬¬ä¸€ç§æƒ…å†µæ¯æ¬¡æ“ä½œå‰æ‰¾åˆ°å¯ä»¥ä½¿ $\Delta$ å˜å°æœ€å¤šçš„ï¼Œç¬¬äºŒç§æ‰¾åˆ°è®© $\Delta$ å˜å¤§æœ€å°çš„å°±å¯ä»¥äº†ã€‚</p><h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote><p>çš®å¡ä¸˜å’Œä»–æ’æˆä¸€åˆ—ã€‚ä»–åœ¨çº¸ä¸Šå†™ä¸‹äº†æ•°ç»„çš„æ‰€æœ‰éç©ºå­åºåˆ—ã€‚åŒæ—¶ä»–åˆ é™¤äº†æ‰€æœ‰çš„ã€Œå­åºåˆ—çš„æœ€å¤§å…ƒç´ -å­åºåˆ—çš„æœ€å°å…ƒç´  $\geq d$ã€çš„å­åºåˆ—ï¼Œæœ€ç»ˆå‰©ä¸‹ $X$ ä¸ªå­åºåˆ—ã€‚ç°åœ¨ç»™å‡º $X,d$ ï¼Œæ„é€ ä¸€ä¸ªåˆæ³•çš„åŸåºåˆ—ã€‚</p><p>è¾“å‡ºæ•°ç»„ä¸­çš„å…ƒç´ æ•°ä¸åº”å¤§äº $10^4$ï¼Œæ•°å€¼å¤§å°ä¸åº”è¶…è¿‡ $10^{18}$ ã€‚ä¿è¯ $1\leq X,d\leq 10^9$ ã€‚</p></blockquote><p>ç§’äº†ã€‚</p><p>æ¯”è¾ƒ naive çš„ä¸€é“æ„é€ é¢˜ã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘é•¿åº¦ä¸º $n$ çš„åºåˆ—ä¼šäº§ç”Ÿ $2^n-1$ ä¸ªå­åºåˆ—ï¼Œé‚£ä¹ˆè€ƒè™‘ç›´æ¥å¯¹ $X$ è¿›è¡ŒäºŒè¿›åˆ¶æ‹†åˆ†ï¼Œä¹‹åå°±æ˜¯ä¸€æ®µ $1$ ä¸€ä¸ª $d+1$ çš„å½¢å¼æ„é€ å°±å®Œäº†ã€‚</p><h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><blockquote><p>ç»™å‡ºä¸€é¢—æ— é™å±‚çš„æ»¡äºŒå‰æ ‘ã€‚ å¦‚æœ $x$ æ˜¯æ ¹ï¼Œå­©å­çš„å€¼æ˜¯ $2\times x$ï¼Œå³å­©å­çš„å€¼æ˜¯ $2\times x+1$ ã€‚</p><p>ç°åœ¨æœ‰ä¸‰ç§æ“ä½œï¼š</p><p>$(1,x,k)$ ï¼šå°† $x$ æ‰€åœ¨å±‚çš„æ‰€æœ‰èŠ‚ç‚¹æ•´ä½“å‘å³å¾ªç¯åœ°ç§»åŠ¨ $k$ ä¸ªå•ä½ã€‚</p><p>$(2,x,k)$ ï¼šå°† $x$ æ‰€åœ¨çš„å±‚çš„æ‰€æœ‰èŠ‚ç‚¹<strong>åŠå…¶å­æ ‘</strong>å‘å³å¾ªç¯åœ°ç§»åŠ¨ k ä¸ªå•ä½ã€‚</p><p>$(3,x)$ ï¼šè¾“å‡ºä» $x$ åˆ°æ ¹çš„è·¯å¾„ã€‚</p><p>$1\leq x,k,\leq 10^{18}$ ã€‚ </p></blockquote><p>æ¯”è¾ƒéº»çƒ¦çš„æ‰¾æ€§è´¨+æ¨¡æ‹Ÿé¢˜ï¼Œä½†è¿˜æ˜¯ç§’äº†ã€‚<del>ä½†æ˜¯ç”±äºå„ç§ç»†èŠ‚å®ç°ä¸ŠèŠ±äº†å¥½ä¹…</del></p><p>ä¸€å¼€å§‹çš„æƒ³æ³•å°±æ˜¯ï¼Œå¯¹æ“ä½œ $(1)$ çš„æ¯ä¸€å±‚æ‰“åå‘çš„æ ‡è®°ï¼Œç„¶åå‘ä¸Šè·³çš„æ—¶å€™é‡åˆ°è¿™ä¸€å±‚åå‘è·³ä¸€ä¸‹ï¼Œç¬¬äºŒä¸ªæ“ä½œæ‰“å¦ä¸€ç§æ­£å‘çš„æ ‡è®°å°±å¥½äº†ã€‚å†™äº†åŠå¤©æ‰å†™å‡ºæ¥ï¼Œè¿™é‡Œè¯´å‡ ä¸ªå°ç»†èŠ‚ï¼š</p><p>1ã€ä¸¤ä¸ªæ“ä½œçš„æ ‡è®°éƒ½æ‰“åœ¨å½“å‰å±‚è€Œä¸æ˜¯ä¸Šä¸€å±‚ã€‚ä½†æ˜¯ä¸¤ä¸ªæ ‡è®°é‡Šæ”¾çš„æ—¶åˆ»ä¸åŒã€‚ç¬¬äºŒä¸ªæ ‡è®°æ¯æ¬¡è¦åœ¨è·³ä¹‹å‰ä¸‹ä¼ å½“å‰å±‚çš„ï¼Œè€Œç¬¬ä¸€ä¸ªæ ‡è®°è¦åœ¨è·³ä¹‹åä¸‹ä¼ ä¸‹ä¸€å±‚çš„ã€‚åŸå› æ˜¯ç¬¬ä¸€ä¸ªæ ‡è®°æ˜¯æ•´ä½“æœ‰æ•ˆçš„ï¼Œç¬¬äºŒä¸ªæ ‡è®°æ˜¯æš‚æ—¶æœ‰æ•ˆçš„ã€‚</p><p>2ã€ç¬¬ä¸€ä¸ªæ ‡è®°åœ¨è¾“å‡ºä¹‹åè¦æ¸…é™¤ã€‚</p><p>3ã€æ³¨æ„åˆ°æ“ä½œ $(1)$ æ ‡è®°åå‘æ˜¯å› ä¸ºè·³çš„æ—¶å€™è¦èµ°ç›¸å¯¹ä½ç§»ã€‚ä½†æ˜¯å¦‚æœä¸€å¼€å§‹èµ·ç‚¹æ—¶å­˜åœ¨æ ‡è®°ï¼Œè¿™ä¸ªæ ‡è®°çš„ä½œç”¨åº”è¯¥æ˜¯æ­£å‘çš„ã€‚åˆ¤ä¸€ä¸‹å³å¯ã€‚</p><p>4ã€<code>&lt;cmath&gt; log2()</code> è´¼æ…¢ï¼Œç”šè‡³æ¯”æ‰‹å†™çš„è¿˜è¦æ…¢â€¦</p><p>äºæ˜¯æœ€åå°±åšåˆ°äº† <code>log_2</code> å¤–çº¿æ€§ã€‚è¿„ä»Šä¸ºæ­¢æ˜¯ Codeforces å…¨ç«™æœ€å¿«çš„ä»£ç ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> T ;</span><br><span class="line">ll buc1[<span class="number">70</span>] ;</span><br><span class="line">ll buc2[<span class="number">70</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="function">il <span class="keyword">int</span> <span class="title">i_lg2</span><span class="params">(ll n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">if</span> (n &gt;&gt; <span class="number">32</span>) m |= <span class="number">32</span>, n &gt;&gt;= <span class="number">32</span> ;</span><br><span class="line">    <span class="keyword">if</span> (n &gt;&gt; <span class="number">16</span>) m |= <span class="number">16</span>, n &gt;&gt;= <span class="number">16</span> ;</span><br><span class="line">    <span class="keyword">if</span> (n &gt;&gt; <span class="number">8</span>) m |= <span class="number">8</span>, n &gt;&gt;= <span class="number">8</span> ;</span><br><span class="line">    <span class="keyword">if</span> (n &gt;&gt; <span class="number">4</span>) m |= <span class="number">4</span>, n &gt;&gt;= <span class="number">4</span> ;</span><br><span class="line">    <span class="keyword">if</span> (n &gt;&gt; <span class="number">2</span>) m |= <span class="number">2</span>, n &gt;&gt;= <span class="number">2</span> ;</span><br><span class="line">    <span class="keyword">if</span> (n &gt;&gt; <span class="number">1</span>) m |= <span class="number">1</span>, n &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">return</span> m ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    qr(T) ; <span class="keyword">int</span> p ;</span><br><span class="line">    ll x, y, z, s, t, yf ;</span><br><span class="line">    <span class="keyword">while</span> (T --)&#123;</span><br><span class="line">        qr(x), qr(y) ;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">1</span>)</span><br><span class="line">            y = i_lg2(y), qr(z), buc1[y] -= z ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x == <span class="number">2</span>)</span><br><span class="line">            y = i_lg2(y), qr(z), buc2[y] += z ;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            qw(y, <span class="string">' '</span>) ;</span><br><span class="line">            p = i_lg2(y) ;</span><br><span class="line">            z = <span class="number">1l</span>l &lt;&lt; p ;</span><br><span class="line">            s = (z &lt;&lt; <span class="number">1</span>) - <span class="number">1</span> ;</span><br><span class="line">            t = - buc1[p] &amp; (z - <span class="number">1</span>) ;</span><br><span class="line">            <span class="keyword">if</span> (t &lt; <span class="number">0</span>)</span><br><span class="line">                t = (t + z) &amp; (z - <span class="number">1</span>) ;</span><br><span class="line">            x = y + t ;</span><br><span class="line">            <span class="keyword">if</span> (x &gt; s)</span><br><span class="line">                x = (x &amp; s) + z ;</span><br><span class="line">            y = x ;</span><br><span class="line">            <span class="keyword">while</span> (p &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                s = (z &lt;&lt; <span class="number">1</span>) - <span class="number">1</span> ;</span><br><span class="line">t = buc2[p] &amp; (z - <span class="number">1</span>) ;</span><br><span class="line">                <span class="keyword">if</span> (t &lt; <span class="number">0</span>)</span><br><span class="line">                    t = (t + z) &amp; (z - <span class="number">1</span>) ;</span><br><span class="line">                x = y + t ;</span><br><span class="line">                <span class="keyword">if</span> (x &gt; s)</span><br><span class="line">                    x = (x &amp; s) + z ;</span><br><span class="line">                y = x ;</span><br><span class="line">                </span><br><span class="line">                -- p ;</span><br><span class="line">                s = z - <span class="number">1</span> ;</span><br><span class="line">                z = z &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">                y = y &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">                t = buc1[p] &amp; (z - <span class="number">1</span>) ;</span><br><span class="line">                <span class="keyword">if</span> (t &lt; <span class="number">0</span>)</span><br><span class="line">                    t = (t + z) &amp; (z - <span class="number">1</span>) ;</span><br><span class="line">                x = y + t ;</span><br><span class="line">                <span class="keyword">if</span> (x &gt; s)</span><br><span class="line">                    x = (x &amp; s) + z ;</span><br><span class="line">                yf = y ; y = x ;</span><br><span class="line">                qw(y, <span class="string">' '</span>), y = yf ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">putchar</span>(<span class="string">'\n'</span>) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><blockquote><p>ç»™å®šä¸€æ£µå¸¦ç‚¹æƒçš„æ ‘ï¼Œæ±‚æ‰€æœ‰æœ‰å‘è·¯å¾„çš„æƒå€¼å’Œã€‚</p><p>ä¸€æ¡æœ‰å‘è·¯å¾„çš„æƒå€¼å¦‚ä¸‹å®šä¹‰ï¼š </p><p>è®¾è¿™æ¡è·¯å¾„ä¾æ¬¡ç»è¿‡çš„ç‚¹çš„æƒå€¼åˆ†åˆ«ä¸º $a_1, a_2, â€¦, a_k$ã€‚</p><p>åˆ™è·¯å¾„çš„æƒå€¼ä¸º $a_1\times (-1)^2+a_2\times (-1)^3+â€¦+a_n\times (-1)^{(n+1)}$ã€‚</p><p>ç­”æ¡ˆå¯¹ $10^9+7$ å–æ¨¡ã€‚</p></blockquote><p>ç§’äº†ã€‚<del>æŒ‡æƒ³å‡ºæ¥ä½†å†™äº†ä¸€å¹´</del></p><p>ç„¶åä¸€çœ¼å°±æ˜¯ç‚¹åˆ†â€¦ä¸è¿‡å¥½åƒæ¯”è¾ƒéº»çƒ¦çš„æ ·å­ã€‚</p><p>æˆ–è€…è€ƒè™‘ç›´æ¥æ ‘å½¢ $dp$ ã€‚å°±åªéœ€è¦ç»Ÿè®¡å‡ºæ¯ä¸ªç‚¹åœ¨å¤šå°‘æ¡è·¯å¾„ä¸Šæ˜¯å¥‡æ•°ä½ç½®ï¼Œå¤šå°‘æ¡è·¯å¾„ä¸Šæ˜¯å¶æ•°ä½ç½®ã€‚è¿™ä¸ªå¯ä»¥ç”¨æ¯”è¾ƒ trivial çš„ up_and_down æŠ€å·§æ¥åšã€‚å…·ä½“çš„ï¼Œè€ƒè™‘å¯¹äºå¥‡å¶ä½ç½®åˆ†åˆ«ç»´æŠ¤ä¸‰ä¸ªä¿¡æ¯ï¼Œ$f,g,h$ åˆ†åˆ«è¡¨ç¤ºã€Œèµ·ç‚¹åœ¨å­æ ‘å¤–ã€ç»ˆç‚¹åœ¨å­æ ‘å†…ã€ã€ã€Œèµ·ç‚¹åœ¨å­æ ‘å†…ï¼Œç»ˆç‚¹åœ¨å­æ ‘å¤–ã€ã€ã€Œèµ·ç‚¹åœ¨å­æ ‘å†…ï¼Œç»ˆç‚¹åœ¨å­æ ‘å†…ã€ä¸‰ç§ä¿¡æ¯ï¼Œå…¶ä¸­ç¬¬ä¸‰ç§ä¾èµ–äºç¬¬äºŒç§ï¼Œç¬¬ä¸€ç§éœ€è¦ç¬¬äºŒç§è¿›è¡Œ up_and_down ã€‚è¿™æ ·å°±å¯ä»¥ç»“åˆå­æ ‘ $size$ ç›´æ¥ç®—å‡ºè´¡çŒ®æ¥äº†ã€‚</p><p>æœ‰å°ç»†èŠ‚éœ€è¦æ³¨æ„ã€‚å°±æ˜¯ $f_x,g_x$ åœ¨å¤„ç†å¥‡æ•°çš„æ—¶å€™éœ€è¦åˆ¤ä¸€ä¸‹ $x$ çš„è¾¹ç•Œã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span> :: <span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; vint ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> p_b push_back</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1000000007</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line">ll f[N][<span class="number">3</span>] ;</span><br><span class="line">ll g[N][<span class="number">3</span>] ;</span><br><span class="line"><span class="keyword">int</span> size[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line">vint E[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(T &amp;x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x += y ; x = x &gt;= mod ? x - mod : x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">dec</span><span class="params">(T &amp;x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x -= y ; x = x &lt; <span class="number">0</span> ? x + mod : x ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    f[x][<span class="number">0</span>] = size[x] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span> ;</span><br><span class="line">        dfs(y, x) ; size[x] += size[y] ;</span><br><span class="line">        f[x][<span class="number">0</span>] += g[y][<span class="number">0</span>] ; g[x][<span class="number">0</span>] += f[y][<span class="number">0</span>] ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span> ;</span><br><span class="line">        add(f[x][<span class="number">2</span>], (size[x] - size[y] - <span class="number">1</span>) * g[y][<span class="number">0</span>] % P) ;</span><br><span class="line">        add(g[x][<span class="number">2</span>], (size[x] - size[y] - <span class="number">1</span>) * f[y][<span class="number">0</span>] % P) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span> ;</span><br><span class="line">        f[y][<span class="number">1</span>] = g[x][<span class="number">1</span>] ;</span><br><span class="line">        g[y][<span class="number">1</span>] = f[x][<span class="number">1</span>] ;</span><br><span class="line">        f[y][<span class="number">1</span>] += (g[x][<span class="number">0</span>] - f[y][<span class="number">0</span>]) ;</span><br><span class="line">        g[y][<span class="number">1</span>] += (f[x][<span class="number">0</span>] - g[y][<span class="number">0</span>]) ;</span><br><span class="line">        dfs2(y, x) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">1</span> ; x &lt;= n ; ++ x)&#123;</span><br><span class="line">        add(ans, f[x][<span class="number">2</span>] * base[x] % P) ;</span><br><span class="line">        dec(ans, g[x][<span class="number">2</span>] * base[x] % P) ;</span><br><span class="line">        dec(ans, base[x]) ;</span><br><span class="line"><span class="comment">//        printf("%lld\n", ans) ;</span></span><br><span class="line">        add(ans, (f[x][<span class="number">1</span>] + <span class="number">1</span>) * size[x] % P * base[x] % P) ;</span><br><span class="line"><span class="comment">//        printf("%lld\n", ans) ;</span></span><br><span class="line">        add(ans, f[x][<span class="number">0</span>] * (n - size[x] + <span class="number">1</span>) % P * base[x] % P) ;</span><br><span class="line"><span class="comment">//        printf("%lld\n", ans) ;</span></span><br><span class="line">        dec(ans, g[x][<span class="number">1</span>] * size[x] % P * base[x] % P) ;</span><br><span class="line"><span class="comment">//        printf("%lld\n", ans) ;</span></span><br><span class="line">        dec(ans, g[x][<span class="number">0</span>] * (n - size[x] + <span class="number">1</span>) % P * base[x] % P) ;</span><br><span class="line"><span class="comment">//        printf("%lld\n", ans) ; puts("-----------") ;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) ; <span class="keyword">int</span> x, y ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y), E[x].p_b(y), E[y].p_b(x) ;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>) ; dfs2(<span class="number">1</span>, <span class="number">0</span>) ; solve() ; <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans % P) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h1 id="F"><a href="#F" class="headerlink" title="F"></a>F</h1><blockquote><p>ç»™å®š $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æœ‰å‘å›¾ï¼Œå¯èƒ½ä¸è¿é€šï¼Œå¯èƒ½æœ‰é‡è¾¹ï¼Œä¹Ÿå¯èƒ½ä¼šæœ‰è‡ªç¯ã€‚æ±‚æœ€é•¿çš„è·¯å¾„(å¯ä»¥ç»è¿‡é‡å¤èŠ‚ç‚¹)ï¼Œä½¿å¾—è¿™æ¡è·¯å¾„çš„ç¼–å·å’Œæƒå€¼éƒ½<strong>ä¸¥æ ¼</strong>å•è°ƒé€’å¢ï¼Œå…¶ä¸­ç¼–å·æŒ‡è¾“å…¥çš„é¡ºåºã€‚</p><p>$1\leq n,m\leq 10^5$ ã€‚</p></blockquote><p>æ¯”è¾ƒå·§çš„ä¸€é“é¢˜ã€‚è€ƒè™‘è¿™é¢˜æœ¬è´¨å…¶å®æ˜¯ä¸€ä¸ªæœ‰å‘å›¾ä¸Šè¾¹çš„ LISã€‚å¯¹æ¯ä¸ª $x$ ç»´æŠ¤ä¸€ä¸ª <code>map</code> ï¼ˆæˆ–è€…åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼‰ï¼Œå­˜å…¥è¾¹æƒå€¼ä¸º $v$ æ—¶çš„æœ€é•¿é€’å¢è·¯å¾„ã€‚è€ƒè™‘æ¯æ¬¡åŠ è¿›æ¥ä¸€æ¡è¾¹ $(u,v,w)$ï¼Œç­”æ¡ˆå°±æ˜¯ä» $u$ çš„ map é‡Œæ‰¾å‡ºæœ€å¤§çš„å°äº $w$ çš„å€¼ï¼Œæ ¹æ®å•è°ƒæ€§å¯çŸ¥è¿™ä¸€å®šæ˜¯å°äº $w$ çš„é‚£ä¸ªæœ€å¤§å€¼ã€‚ç„¶åæš´åŠ›æ”¹å°±å¥½äº†ã€‚ä¸éš¾çŸ¥é“è¿™æ ·åšæ¯æ¡è¾¹è‡³å¤šè¢«åŠ ä¸€æ¬¡ã€åˆ ä¸€æ¬¡ï¼Œå¤æ‚åº¦æ˜¯ $O(m\log n)$ ã€‚</p><p>æ€è€ƒäº†ä¸€ä¸‹ï¼Œè¿™æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª DPã€‚è®¾ $f_k$ ä¸ºæœ€åä¸€æ¡è¾¹ä¸ºç¬¬ $k$ æ¡è¾¹çš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆè½¬ç§»å°±æ˜¯ä»ä»¥è¾¹ $k$ å§‹ç‚¹ä¸ºç»ˆç‚¹çš„æ‰€æœ‰è·¯å¾„é‡Œé€‰å‡ºä¸€ä¸ªæ¥è½¬ç§»ã€‚å…¶å®å¦‚æœè€ƒè™‘åˆ° DP çš„è¯ï¼Œå°±å˜æˆä¸€é“ä¸­è§„ä¸­çŸ©çš„é¢˜ç›®äº†ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: <span class="built_in">map</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span> :: lower_bound ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> en end</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> be begin</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lbd lower_bound</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300010</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> res ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span> &lt;<span class="keyword">int</span>, ll&gt; lis[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">auto</span> p = lis[x].lbd(v) ;</span><br><span class="line">    ret = (p == lis[x].be()) ? <span class="number">0</span> : ((-- p) -&gt; second) ; <span class="keyword">return</span> ret ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m) ; <span class="keyword">int</span> x, y, z ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;x, &amp;y, &amp;z) ;</span><br><span class="line">        res = search(x, z) ; ++ res ;</span><br><span class="line">        <span class="keyword">if</span> (res &gt; search(y, z))&#123;</span><br><span class="line">            <span class="keyword">auto</span> p = lis[y].lbd(z) ; lis[y][z] = res ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> q = p ; q != lis[y].en() ; )&#123;</span><br><span class="line">                <span class="keyword">if</span> ((q -&gt; second) &gt; res) <span class="keyword">break</span> ; q = lis[y].erase(q) ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans = <span class="built_in">std</span> :: max(ans, res) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h1 id="G"><a href="#G" class="headerlink" title="G"></a>G</h1><blockquote><p>ç»™ä½ ä¸‰ä¸ªæ­£æ•´æ•° $n$ï¼Œ$a$ï¼Œ$b$ï¼Œå®šä¹‰ $A$ ä¸ºä¸€ä¸ªæ’åˆ—ä¸­æ˜¯å‰ç¼€æœ€å¤§å€¼çš„æ•°çš„ä¸ªæ•°ï¼Œå®šä¹‰ $B$ ä¸ºä¸€ä¸ªæ’åˆ—ä¸­æ˜¯åç¼€æœ€å¤§å€¼çš„æ•°çš„ä¸ªæ•°ï¼Œæ±‚é•¿åº¦ä¸º $n$ çš„æ’åˆ—ä¸­æ»¡è¶³ $A = a$ ä¸” $B = b$ çš„æ’åˆ—ä¸ªæ•°ã€‚</p><p>$1\le n \le 10^5$ ã€‚ç­”æ¡ˆå¯¹ $998,244,353$ å–æ¨¡ã€‚</p></blockquote><p>æ„Ÿè§‰è¿™é¢˜æš´åŠ›çš„è¯æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰è¶£çš„è®¡æ•°é¢˜äº†ã€‚è‡ªå·±ä¸€å¼€å§‹è®¾çš„çŠ¶æ€æ˜¯ $f_{i,j,k}$ è¡¨ç¤ºè€ƒè™‘äº† $1\sim i$ çš„æ’åˆ—ï¼Œå‰ç¼€æœ€å¤§å€¼ä¸ªæ•°ä¸º $j$ï¼Œåç¼€æœ€å¤§å€¼ä¸ªæ•°ä¸º $k$ æ—¶æ–¹æ¡ˆæ•°ï¼Œä½†æ˜¯å‘ç°æ— è®ºæ˜¯æ’å…¥æœ€å¤§å€¼è¿˜æ˜¯æ’å…¥æœ€å°å€¼éƒ½ä¸æ˜¯å¾ˆå®¹æ˜“è½¬ç§»ã€‚</p><p>ä½†æ˜¯å‘ç°å¦‚æœç¡®å®šäº†æœ€å¤§å€¼åœ¨å“ªé‡Œï¼Œæœ€åçš„ç­”æ¡ˆå°±ä¼šæ¯”è¾ƒå®¹æ˜“è®¡ç®—ã€‚å…·ä½“çš„ï¼Œè®¾ $f_{i,j}$ è¡¨ç¤ºè€ƒè™‘äº† $1\sim i$ çš„æ’åˆ—ï¼Œå‰ç¼€æœ€å¤§å€¼ä¸ªæ•°ä¸º $j$ çš„æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆæœ€åç­”æ¡ˆå°±æ˜¯</p><script type="math/tex; mode=display">\sum_{i=1}^{n-1} \dbinom{n-1}{i}\times f_{i,a-1}\times f_{n-i-1,b-1}\qquad(1)</script><p>ç„¶åè€ƒè™‘ $f$ æ€ä¹ˆç®—ï¼Œå› ä¸ºæœ€å¤§å€¼ä¼šç›´æ¥å½±å“å‰ç¼€æœ€å¤§å€¼çš„ä¸ªæ•°ï¼Œæ‰€ä»¥è½¬ç§»è€ƒè™‘æ’å…¥æœ€å°å€¼ã€‚</p><script type="math/tex; mode=display">f_{i,j}=f_{i-1,j-1}+(i-1)\times f_{i-1,j}</script><p>åˆ†åˆ«å¯¹åº”äº†æ’åœ¨ç¬¬ä¸€ä½å’Œæ’åœ¨ä¸­é—´æˆ–è€…æœ«å°¾ã€‚</p><p>ä¸éš¾çœ‹å‡º $\{f\}$ å°±æ˜¯ $\begin{bmatrix} n \ k \end{bmatrix} $ ã€‚ç„¶åå¦‚æœç›´æ¥æš´åŠ›çš„è¯æ˜¯ $O(n^2)$ çš„ã€‚</p><p>è€ƒè™‘ç›´æ¥ä» $(1)$ å¼çš„ç»„åˆæ„ä¹‰å‡ºå‘è®¡ç®—è´¡çŒ®ã€‚å‘ç°å¯¹äºåé¢ä¸¤é¡¹ç¬¬ä¸€ç»´çš„æŒ‡æ ‡å’Œæ˜¯ä¸€å®šçš„ï¼Œæ¢å¥è¯è¯´åé¢ä¸¤é¡¹å¯ä»¥çœ‹åšå°±æ˜¯åœ¨ $n-1$ é‡Œæ‰¾å‡ºäº† $a+b-2$ ä¸ªåœˆæ¥ã€‚å‰é¢çš„é‚£ä¸ªäºŒé¡¹å¼ç³»æ•°å°±å¯ä»¥çœ‹åšæ˜¯å¯¹é€‰å–çš„ä¸€ä¸ªç»„åˆç³»æ•°ã€‚é‚£ä¹ˆå¯ä»¥çŸ¥é“æœ€åç­”æ¡ˆå°±åº”è¯¥æ˜¯</p><script type="math/tex; mode=display">\begin{bmatrix} n-1 \\ a+b-2 \end{bmatrix}\times \binom{a+b-2}{a-1}</script><p>äºæ˜¯å°±è½¬åŒ–æˆå¦‚ä½•å¿«é€Ÿæ±‚æ–¯ç‰¹æ—æ•°æŸä¸€é¡¹çš„é—®é¢˜äº†ã€‚ä½†æ˜¯è¿™ä¸ªå¹¶æ²¡æœ‰ä»€ä¹ˆå¿«é€Ÿçš„åšæ³•â€¦äºæ˜¯å°±åªèƒ½æ±‚å‡ºä¸€æ•´è¡Œã€‚</p><p>è¿™è¿˜æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å†™ $s_1$ æ±‚ä¸€è¡Œã€‚å¤§æ¦‚æ˜¯è¯´æœ‰æ’ç­‰å¼</p><script type="math/tex; mode=display">\sum _{k=0}^{n-1} \begin{bmatrix} n \\ k \end{bmatrix} =x^{\bar{n}}=\prod_{i=0}^{n-1} (x-i)</script><p>åé¢é‚£ä¸ªå•é¡¹å¼æ˜¾ç„¶æ˜¯å¯ä»¥åˆ†æ²»åšçš„ã€‚äºæ˜¯æœ€åå¤æ‚åº¦ $n\log ^2n$ ã€‚</p><p>ä¸è¿‡è¿™ä¸œè¥¿æ˜¯æœ‰å• $\log$ çš„å€å¢åšæ³•çš„ã€‚ä¸è¿‡æ„Ÿè§‰ä¸€èˆ¬è¿™ç§é¢˜ä¹Ÿæ²¡æœ‰å¡ $\log ^2$ çš„æ„å‘ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Poly&#123;</span><br><span class="line">    <span class="keyword">int</span> k, d ;</span><br><span class="line">    <span class="keyword">int</span> rev[N] ;</span><br><span class="line">    <span class="keyword">int</span> g[<span class="number">20</span>][N] ;</span><br><span class="line">    <span class="function">ll <span class="title">expow</span><span class="params">(ll x, ll y)</span></span>&#123;</span><br><span class="line">        ll ret = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">while</span> (y)&#123;</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                ret = ret * x % P ;</span><br><span class="line">            x = x * x % P ; y &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pre_rt</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">19</span> ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">int</span>* r = g[i], ut ; r[<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">            ut = r[<span class="number">1</span>] = expow(<span class="number">3</span>, <span class="number">998244352</span> / (<span class="number">1</span> &lt;&lt; (i + <span class="number">1</span>))) ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span> ; j &lt; (<span class="number">1</span> &lt;&lt; i) ; ++ j) r[j] = (ll)r[j - <span class="number">1</span>] * ut % P ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(T *f, <span class="keyword">int</span> L, <span class="keyword">bool</span> mk)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (rev[i] &lt; i) swap(f[i], f[rev[i]]) ;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; L ; i &lt;&lt;= <span class="number">1</span>, ++ l)&#123;</span><br><span class="line">            <span class="keyword">int</span> *r = g[l], o = i &lt;&lt; <span class="number">1</span>, rt, irt ;</span><br><span class="line">            <span class="keyword">for</span> (rg <span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; L ; j += o)</span><br><span class="line">                <span class="keyword">for</span> (rg <span class="keyword">int</span> k = j ; k &lt; i + j ; ++ k)&#123;</span><br><span class="line">                    rt = f[k], irt = f[k + i] * r[k - j] % P ;</span><br><span class="line">                    f[k] = addn(rt, irt), f[k + i] = decn(rt, irt) ;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!mk) <span class="keyword">return</span> ;</span><br><span class="line">        reverse(f + <span class="number">1</span>, f + L) ;</span><br><span class="line">        <span class="keyword">int</span> o = expow(L, P - <span class="number">2</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; L ; ++ i) (f[i] *= o) %= P ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getlen</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        d = <span class="number">1</span>, k = <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">while</span> (d &lt;= x) d &lt;&lt;= <span class="number">1</span>, ++ k ;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; d ; ++ i)</span><br><span class="line">            rev[i] = (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (k - <span class="number">1</span>)) ;</span><br><span class="line">    &#125;</span><br><span class="line">    ll tl[N] ;</span><br><span class="line">    ll tr[N] ;</span><br><span class="line">    <span class="keyword">int</span> len[N * <span class="number">3</span>] ;</span><br><span class="line">    vll poly[N * <span class="number">3</span>] ;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> lc (rt &lt;&lt; 1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rc (rt &lt;&lt; 1 | 1)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cdq</span><span class="params">(<span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r)&#123;</span><br><span class="line">            len[rt] = <span class="number">1</span> ;</span><br><span class="line">            poly[rt].p_b(<span class="number">1</span>) ;</span><br><span class="line">            poly[rt].p_b(l) ;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">        cdq(lc, l, mid) ;</span><br><span class="line">        cdq(rc, mid + <span class="number">1</span>, r) ;</span><br><span class="line">        getlen(len[rt] = len[lc] + len[rc]) ;</span><br><span class="line"><span class="built_in">memset</span>(tl + len[lc] + <span class="number">1</span>, <span class="number">0</span>, <span class="keyword">sizeof</span>(ll) * (d - len[lc])) ;</span><br><span class="line"><span class="built_in">memset</span>(tr + len[rc] + <span class="number">1</span>, <span class="number">0</span>, <span class="keyword">sizeof</span>(ll) * (d - len[rc])) ;</span><br><span class="line"><span class="comment">//        for (int i = len[lc] + 1 ; i &lt;= d ; ++ i) tl[i] = 0 ;</span></span><br><span class="line"><span class="comment">//        for (int i = len[rc] + 1 ; i &lt;= d ; ++ i) tr[i] = 0 ;</span></span><br><span class="line">rg <span class="keyword">auto</span> lp = poly[lc].begin(), rp = poly[rc].begin() ;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= len[lc] ; ++ i) tl[i] = *(lp ++) ;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= len[rc] ; ++ i) tr[i] = *(rp ++) ;</span><br><span class="line">        NTT(tl, d, <span class="number">0</span>) ; NTT(tr, d, <span class="number">0</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (rg <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= d ; ++ i) (tl[i] *= tr[i]) %= P ;</span><br><span class="line">        NTT(tl, d, <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= len[rt] ; ++ i) poly[rt].p_b(tl[i]) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> a, b ;</span><br><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line">ll fac[N] ;</span><br><span class="line">ll inv[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">binom</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;<span class="comment">//\binom&#123;x&#125;&#123;y&#125;</span></span><br><span class="line">    <span class="keyword">return</span> fac[x] * inv[y] % P * inv[x - y] % P ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prework</span><span class="params">(<span class="keyword">int</span> mx)</span></span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = inv[<span class="number">0</span>] = <span class="number">1</span> ; ans = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= mx + <span class="number">1</span> ; ++ i)</span><br><span class="line">        fac[i] = fac[i - <span class="number">1</span>] * i % P ;</span><br><span class="line">    inv[mx + <span class="number">1</span>] = Poly :: expow(fac[mx + <span class="number">1</span>], P - <span class="number">2</span>) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = mx ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">        inv[i] = inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % P ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    gi(n) ; gi(a) ; gi(b) ; prework(n &lt;&lt; <span class="number">1</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">1</span>) &#123; print(a &amp; b) ; <span class="keyword">return</span> <span class="number">0</span> ; &#125;  </span><br><span class="line"><span class="keyword">if</span> (!a || !b || a + b - <span class="number">1</span> &gt; n) &#123; pc(<span class="string">'0'</span>) ; <span class="keyword">return</span> <span class="number">0</span> ; &#125;</span><br><span class="line">    </span><br><span class="line">Poly :: pre_rt() ; Poly :: cdq(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">2</span>) ;</span><br><span class="line">    reverse(Poly :: poly[<span class="number">1</span>].begin(), Poly :: poly[<span class="number">1</span>].end()) ;</span><br><span class="line">    ans = Poly :: poly[<span class="number">1</span>][a + b - <span class="number">2</span>] * binom(a + b - <span class="number">2</span>, a - <span class="number">1</span>) % P ;</span><br><span class="line">    print(ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ„Ÿè§‰è¿™åœºçš„é¢˜ç›®è´¨é‡è¿˜æ˜¯ä¸é”™çš„ï¼Ÿç¡®å®æ¯”ä»¥å‰ vp è¿‡çš„å‡ åœº (Div1+Div2) è¦å¥½å¾ˆå¤šã€‚&lt;/p&gt;
&lt;p&gt;å¤§æ¦‚æ˜¯æŠŠé™¤äº† H ä¹‹å¤–ä¸€æ•´åœºçš„é¢˜ç›®éƒ½åšæ‰äº†ã€‚æœ‰äº›ä¸æ˜¯ååˆ†å¿…è¦å†™çš„é¢˜ç›®å½“ç„¶å°±æ˜¯å£èƒ¡å•¦ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="Codeforces" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/Codeforces/"/>
    
    
      <category term="æ€ç»´é¢˜/è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E8%AE%A1%E6%95%B0/"/>
    
      <category term="æ€ç»´é¢˜/æ„é€ " scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%9E%84%E9%80%A0/"/>
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/æœ‰æŠ€å·§çš„DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84DP/"/>
    
      <category term="å¥½å¤šå¥½å¤šç»†èŠ‚" scheme="https://www.orchidany.cn/tags/%E5%A5%BD%E5%A4%9A%E5%A5%BD%E5%A4%9A%E7%BB%86%E8%8A%82/"/>
    
      <category term="è´ªå¿ƒ" scheme="https://www.orchidany.cn/tags/%E8%B4%AA%E5%BF%83/"/>
    
      <category term="å¤šé¡¹å¼çš„åº”ç”¨/åˆ†æ²»FFT" scheme="https://www.orchidany.cn/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%9A%84%E5%BA%94%E7%94%A8-%E5%88%86%E6%B2%BBFFT/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/æ ‘å½¢DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%A0%91%E5%BD%A2DP/"/>
    
      <category term="ç»„åˆè®¡æ•°/æ–¯ç‰¹æ—æ•°" scheme="https://www.orchidany.cn/tags/%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0-%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/"/>
    
      <category term="æ•°æ®ç»“æ„/æ•°æ®ç»“æ„æ–¹æ³•/è½»é‡é“¾å‰–åˆ†" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%96%B9%E6%B3%95-%E8%BD%BB%E9%87%8D%E9%93%BE%E5%89%96%E5%88%86/"/>
    
  </entry>
  
  <entry>
    <title>ã€è®­ç»ƒè®°å½•ã€‘6.4 è®­ç»ƒç¬”è®°</title>
    <link href="https://www.orchidany.cn/2020/06/05/6-4-%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/06/05/6-4-è®­ç»ƒç¬”è®°/</id>
    <published>2020-06-04T23:49:54.000Z</published>
    <updated>2020-06-05T06:07:14.916Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç”±äºå¥‡å¥‡æ€ªæ€ªçš„åŸå› (å…¶å®æ˜¯å› ä¸ºå¤ªå›°+vp CF)ï¼Œäºæ˜¯å°±åˆæ‘¸äº†å¥½ä¹…â€¦</p><a id="more"></a><h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><p>çœ‹ä¸Šå»å°±æ˜¯ä¸€ä¸ªç»„åˆæ¸¸æˆï¼Œäºæ˜¯è€ƒè™‘å…ˆåˆ†ç±»å‡ºå±€é¢æ¥ã€‚å‘ç°ç¡®å®šçš„å¿…è´¥æ€å¿…ç„¶æ˜¯åªå‰©ä¸¤ä¸ªç‚¹ï¼Œè¿™æ—¶åæ‰‹å¿…èƒœã€‚é‚£ä¹ˆæ¥ç€è€ƒè™‘ä¸­é—´çš„æŸäº›å¿…è´¥å¿…èƒœæ€éƒ½æ˜¯æ€ä¹ˆäº’ç›¸è½¬ç§»çš„ã€‚</p><p>ç„¶åå¤§æ¦‚å°±æ˜¯é ä»€ä¹ˆå…ˆéªŒç›´è§‰æ¥è§‚å¯Ÿäº†ã€‚è€ƒè™‘åªå‰©ä¸¤ä¸ªç‚¹çš„æ—¶å€™ä¸å­˜åœ¨å¶åº¦ç‚¹ï¼ŒåŒæ—¶è¿™ä¸ªåšå¼ˆé•¿å¾—å°±è·Ÿåº¦æ•°ååˆ†æœ‰å…³ã€‚é‚£ä¹ˆå°±å¯ä»¥çŒœä¸€æ³¢åº¦æ•°ã€‚å…·ä½“çš„ï¼Œå°†å±€é¢åˆ†æˆä¸¤ç±»ï¼Œã€Œå…¨éƒ½æ˜¯å¥‡åº¦ç‚¹ $P$ã€å’Œã€Œè‡³å°‘å­˜åœ¨ä¸€ä¸ªå¶åº¦ç‚¹ $Q$ã€ã€‚å‘ç°å±€é¢ $Q$ è‡³å°‘å¯ä»¥ä¸“ç”¨åˆ°ä¸€ä¸ª $P$ ï¼Œè€Œå±€é¢ $P$ è½¬ç§»åˆ°çš„ä¸€å®šéƒ½æ˜¯å±€é¢ $Q$ ï¼Œå†åŠ ä¸Š $P$ ä¸€å®šåŒ…å«è‡³å°‘ä¸€ä¸ªå¿…è´¥æ€(å³ç»ˆæ€)ï¼Œæ‰€ä»¥ä¸éš¾çŸ¥é“è¿™ç§åˆ†ç±»è¿™ç¬¦åˆç»„åˆæ¸¸æˆå¯¹äºå¿…è´¥æ€å’Œå¿…èƒœæ€çš„å®šä¹‰ã€‚</p><p>äºæ˜¯å°±çåˆ¤ä¸€ä¸‹å°±å¥½äº†ã€‚</p><h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote><p>ç»™å‡ºä¸€æ£µäºŒå‰æ ‘ã€‚é—®èƒ½å¦ç»™æ‰€æœ‰ç‚¹é»‘ç™½æŸ“è‰²ï¼Œä½¿å¾—åœ¨å°†è¿™æ£µæ ‘çš„æ‰€æœ‰å¶å­ç”¨ç©ºèŠ‚ç‚¹è¡¥å…¨ä¹‹åæ»¡è¶³ï¼š</p><p>1ã€ä»»æ„ä¸¤ä¸ªç™½ç‚¹ä¸ç›¸é‚»ã€‚</p><p>2ã€ä»æ ¹èŠ‚ç‚¹åˆ°ä»»æ„ä¸€ä¸ªç©ºèŠ‚ç‚¹ç»è¿‡çš„é»‘ç‚¹ä¸ªæ•°ä¸€æ ·å¤šã€‚</p><p>$1\leq n\leq 5000$ ã€‚</p></blockquote><p>ä¸€å¼€æ—¶è§‰å¾—ä¸ºäº†ä½¿ä¹‹å°½é‡åˆæ³•ï¼Œæ‰€ä»¥åº”è¯¥è®©æœ€é•¿çš„é‚£æ¡é“¾ä¸Šé»‘ç‚¹ä¸ªæ•°æ°å¥½æ˜¯ä¸€åŠâ€¦åæ­£å°±æ˜¯æ¨äº†å‡ ä¸ªç±»ä¼¼çš„ç¿æ™ºç»“è®ºï¼Œç„¶åå°±å½“åœºå»ä¸–äº†QAQã€‚</p><h2 id="Sol-1"><a href="#Sol-1" class="headerlink" title="Sol 1"></a>Sol 1</h2><p>è€ƒè™‘ç›´æ¥ç”¨ dp ç¡®å®šåˆæ³•æ€§ã€‚è®¾ $f_{i,j,0/1}$ è¡¨ç¤ºä»¥ $i$ ä¸ºæ ¹çš„å­æ ‘ï¼Œæ¯æ¡æ ¹åˆ°ç©ºèŠ‚ç‚¹è·¯å¾„ä¸Šçš„é»‘ç‚¹ä¸ªæ•°ä¸º $j$ ï¼Œå½“å‰ç‚¹æ¶‚æˆé»‘/ç™½æ˜¯å¦å¯ä»¥ã€‚é‚£ä¹ˆè½¬ç§»å°±æ˜¯æšä¸¾ä¸€ä¸ªå·¦å­æ ‘è½¬ç§»ã€‚</p><script type="math/tex; mode=display">f_{i,j,0}=\bigcap f_{k,j,1}\\f_{i,j,1}=\bigcap \left(f_{k,j-1,1}\cup f_{k,j-1,0}\right)</script><p>ç„¶ååˆå€¼çš„è¯ï¼Œè€ƒè™‘å¦‚æœæŸä¸ªå¶å­æ²¡æœ‰å…„å¼Ÿçš„è¯å°±å¿…é¡»æ¶‚ç™½è‰²ã€‚</p><p>äºæ˜¯å°±å¯ä»¥ç›´æ¥å¯¹ç€ $\{f\}$ æ„é€ äº†ã€‚å¤æ‚åº¦ $O(n^2)$ ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> rt ;</span><br><span class="line">vint E[N] ;</span><br><span class="line"><span class="keyword">int</span> dep[N] ;</span><br><span class="line"><span class="keyword">bool</span> foc[N] ;</span><br><span class="line"><span class="keyword">char</span> ans[N] ;</span><br><span class="line"><span class="keyword">int</span> f[N][N][<span class="number">2</span>] ;<span class="comment">//0r1b</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> r = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (E[x].size() == <span class="number">1</span>) foc[y] = <span class="number">1</span> ;</span><br><span class="line">        dep[y] = dep[x] + <span class="number">1</span> ;</span><br><span class="line">        dfs(y) ; r = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!r)&#123;</span><br><span class="line">        <span class="keyword">if</span> (foc[x])</span><br><span class="line">            f[x][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            f[x][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">            f[x][<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (E[x].size())&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)</span><br><span class="line">            f[x][j][<span class="number">0</span>] = f[x][j][<span class="number">1</span>] = <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        solve(y) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= n ; ++ j)&#123;</span><br><span class="line">            f[x][j][<span class="number">0</span>] &amp;= f[y][j][<span class="number">1</span>] ;</span><br><span class="line">            f[x][j][<span class="number">1</span>] &amp;= f[y][j - <span class="number">1</span>][<span class="number">1</span>] | f[y][j - <span class="number">1</span>][<span class="number">0</span>] ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out_p</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> cnt_b, <span class="keyword">int</span> col)</span></span>&#123;</span><br><span class="line">    ans[x] = <span class="string">"RB"</span>[col] ;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; x &lt;&lt; " " &lt;&lt; cnt_b &lt;&lt; " " &lt;&lt; col &lt;&lt; '\n' ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : E[x])&#123;</span><br><span class="line">        <span class="keyword">if</span> (!col || !f[y][cnt_b - <span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">            out_p(y, cnt_b - col, <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">else</span> out_p(y, cnt_b - col, <span class="number">0</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ; <span class="keyword">int</span> x ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">1</span> ; y &lt;= n ; ++ y)</span><br><span class="line">        x = qr(), E[x].push_back(y) ;</span><br><span class="line">    rt = E[<span class="number">0</span>][<span class="number">0</span>] ; dfs(rt) ; solve(rt) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line"><span class="comment">//        cout &lt;&lt; f[rt][i][0] &lt;&lt; " " &lt;&lt; f[rt][i][1] &lt;&lt; '\n' ;</span></span><br><span class="line">        <span class="keyword">if</span> (f[rt][i][<span class="number">0</span>]) <span class="keyword">return</span> out_p(rt, i, <span class="number">0</span>), !<span class="built_in">puts</span>(ans + <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">if</span> (f[rt][i][<span class="number">1</span>]) <span class="keyword">return</span> out_p(rt, i, <span class="number">1</span>), !<span class="built_in">puts</span>(ans + <span class="number">1</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> !<span class="built_in">puts</span>(<span class="string">"Impossible"</span>) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h2 id="Sol-2"><a href="#Sol-2" class="headerlink" title="Sol 2"></a>Sol 2</h2><p>ä¸Šé¢é‚£ä¸ªåšæ³•æ˜¯èƒƒç–¼åšæ³•ï¼Œèƒƒç–¼åœ¨æ²¡æœ‰æ·±åˆ»å‘ç°æ€§è´¨ã€‚</p><p>é¦–å…ˆè®¾æ•´æ£µæ ‘é‡Œæ‰€æœ‰å¶å­å’Œåªæœ‰ä¸€ä¸ªå­©å­çš„ç‚¹ä¸ºå…³é”®ç‚¹ã€‚é‚£ä¹ˆå¦‚æœå…³é”®ç‚¹ä¸­æ·±åº¦æå·® $\geqslant 2$ å¯ä»¥çŸ¥é“å¿…ç„¶ä¸å­˜åœ¨è§£ï¼Œå› ä¸ºè¿™æ ·å¿…ç„¶ä¼šå¤šä¸€ä¸ªé»‘ç‚¹ã€‚ä¹‹åè€ƒè™‘è¿™æ˜¯ä¸€å®šå¯ä»¥é»‘ç™½æŸ“è‰²çš„ï¼Œå› ä¸ºçº¢é»‘æ ‘æœ¬è´¨ä¸Šæ¯”è¿™ä¸ªé™åˆ¶è¦å¤šä½†ä¾ç„¶å¯ä»¥çº¢é»‘æŸ“è‰²ã€‚å…·ä½“çš„å¯ä»¥è€ƒè™‘è®©æ‰€æœ‰å’Œæœ€å°æ·±åº¦å…³é”®ç‚¹æ·±åº¦çš„å¥‡å¶æ€§ç›¸åŒçš„ç‚¹éƒ½æŸ“æˆé»‘è‰²ï¼Œå¦åˆ™æŸ“æˆçº¢è‰²ã€‚ä¸éš¾çŸ¥é“è¿™æ˜¯åˆæ³•çš„ã€‚</p><h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote><p>å¯¹äºä»»æ„ $1â‰¤kâ‰¤n$ï¼Œ æ±‚æœ‰å¤šå°‘ä¸ªå·¦å³åŒºåˆ†çš„æ°æœ‰ $k$ ä¸ªå¶å­èŠ‚ç‚¹çš„äºŒå‰æ ‘ï¼Œ æ»¡è¶³å¯¹äºæ¯ä¸ªèŠ‚ç‚¹è¦ä¹ˆæ²¡æœ‰å¶å­èŠ‚ç‚¹è¦ä¹ˆæœ‰ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œ åŒæ—¶ä¸å­˜åœ¨ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œ ä½¿å¾—æ ¹åˆ°å®ƒçš„è·¯å¾„ä¸Šæœ‰ä¸å°‘äº $m$ æ¡å‘å·¦çš„è¾¹ã€‚</p><p>ä½ åªéœ€è¦æ±‚å‡ºç­”æ¡ˆå¯¹ $998244353$ å–æ¨¡çš„ç»“æœã€‚</p><p>$1\leq n\leq 5000$ ã€‚</p></blockquote><p>æ¯”è¾ƒè€ƒå¯ŸåŸºç¡€çš„ä¸€é“ç»å…¸ DPï¼Ÿè™½ç„¶ä¸æ˜¯å¾ˆéš¾ã€‚</p><h2 id="Sol-1-1"><a href="#Sol-1-1" class="headerlink" title="Sol 1"></a>Sol 1</h2><p>æ¯”è¾ƒæš´åŠ›çš„æƒ³æ³•å°±æ˜¯è®¾è®¡ä¸€ä¸ª $f_{i,j}$ è¡¨ç¤ºå½“å‰æœ‰äº† $i$ ä¸ªå¶å­èŠ‚ç‚¹ï¼Œåˆ°æ¯ä¸ªå¶å­å·¦è¾¹ä¸ªæ•°æœ€å¤šä¸º $j$ çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»çš„è¯è€ƒè™‘æšä¸¾å¶å­æ•°ï¼Œæ‹†å·¦å­æ ‘</p><script type="math/tex; mode=display">f_{i,j}=\sum _{k}f_{k,j-1}\times f_{i - k,j}</script><p>å³è€ƒè™‘æ‹†å‡ºæ¥çš„é‚£æ¡å·¦è¾¹å¯¹ç­”æ¡ˆçš„è´¡çŒ®ã€‚å¤æ‚åº¦ $O(n^3)$ ã€‚</p><p>ç„¶åå‘ç°è¿™æ˜¯ä¸ªå·ç§¯çš„å½¢å¼ï¼Œå¯ä»¥ä¿¡ä»°ä¸€æ³¢ä¼˜åŒ–åˆ° $O(n^2\log n)$ é€šè¿‡æ­¤é¢˜ã€‚</p><h2 id="Sol-2-1"><a href="#Sol-2-1" class="headerlink" title="Sol 2"></a>Sol 2</h2><p>è€ƒè™‘ä¸Šé¢é‚£ä¸ªåšæ³•å±å®èƒƒç–¼ã€‚è§‚å¯Ÿè½¬ç§»å¯ä»¥å‘ç°æ¯æ¬¡è½¬ç§»å·¦å­æ ‘å’Œå³å­æ ‘çš„ $j$ çš„å·®ä¸º $1$ ä¸”å›ºå®šã€‚äºæ˜¯å¯ä»¥æŠŠç¬¬äºŒç»´æ¢ä¸€ä¸‹ã€‚è®¾ $f_{i,k}$ è¡¨ç¤ºä»¥ $i$ ä¸ºæ ¹ï¼Œå·¦å³å­æ ‘çš„å·¦è¾¹ä¸ªæ•°ä¹‹å·®ä¸º $k$ çš„æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆè€ƒè™‘æ¯æ¬¡æŒ‰ç…§ $dfs$ åºçš„é¡ºåºï¼Œå³å…ˆå·¦åå³ï¼Œæ’å…¥ä¸€ä¸ªæ–°çš„å¶å­ï¼Œä¼šå¾—åˆ°</p><script type="math/tex; mode=display">\begin{aligned}f_{i,k}&\to f_{i,k+1}\\f_{i,k}&\to f_{i+1,k-1} \end{aligned}</script><p>å³åˆ†ç±»è®¨è®ºæ’å…¥çš„æ˜¯å·¦å¶å­è¿˜æ˜¯å³å¶å­ã€‚å¤æ‚åº¦ $O(n^2)$ ã€‚</p><h2 id="Sol-3-by-duye"><a href="#Sol-3-by-duye" class="headerlink" title="Sol 3 (by duye)"></a>Sol 3 (by duye)</h2><p>è€ƒè™‘ä¸€ä¸ªè·‘å¾—æ›´å¿«çš„åšæ³•ã€‚å¤§æ¦‚è¯´è®¾é™åˆ¶ä¸º $m$ æ—¶çš„è¿™ç§æ ‘çš„ OGF æ˜¯ $F_m(x)$ï¼Œå…¶ä¸­ $[x^n]F_m(x)$ è¡¨ç¤ºæœ‰ $n$ ä¸ªå¶å­çš„ç»“æœã€‚é‚£ä¹ˆæœ‰è½¬ç§»</p><script type="math/tex; mode=display">F_m(x)=x\cdot F_{m-1}(x)\cdot F_m(x)+1</script><p>æ„Ÿè§‰è¿˜æ˜¯æŒºæ˜¾ç„¶çš„ï¼Ÿæœ¬è´¨ä¸Šå°±æ˜¯åœ¨æ‹¼æ’ä¸€æ£µäºŒå‰æ ‘ã€‚å†™æˆé€’æ¨å½¢å¼å°±æ˜¯</p><script type="math/tex; mode=display">F_m(x)=\dfrac{1}{1-x\cdot F_{m-1}(x)}</script><p>å‘ç°å¯ä»¥åˆ†åˆ«ç»´æŠ¤åˆ†å­åˆ†æ¯ï¼Œæœ€åæ±‚é€†ä¸€æ¬¡å°±å¥½äº†ã€‚å¤æ‚åº¦ $O(n^2+n\log n)$ ã€‚ä½†å› ä¸ºå‰é¢ç»´æŠ¤åˆ†å­åˆ†æ¯åªç”¨ $\deg(F)$ æ¬¡è¿ç®—ï¼Œæ‰€ä»¥æœ€åå¸¦ä¸€ä¸ª $\dfrac{1}{2}$ çš„å¸¸æ•°ã€‚å®é™…æ•ˆç‡ä¼˜ç§€ã€‚</p><h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><p>æ¯”è¾ƒç®€å•çš„é¢˜ç›®ï¼Œä½†æ˜¯æ„Ÿè§‰ trick æŒºæ–°é¢–ã€‚</p><p>è€ƒè™‘é¦–å…ˆã€Œæœ€å°ã€ä¸€å®šæ˜¯å¯¹æ¯ä¸€è¶Ÿèˆªç­ä»å¤§åˆ°å°æ’åºæ¥åšï¼ŒåŒæ—¶ä¸åŒçš„èˆªç­ä¹‹é—´å½¼æ­¤æ²¡æœ‰å½±å“ã€‚ä¹‹åè€ƒè™‘å¦‚ä½•ç®—æœŸæœ›ã€‚ç”±äºç®—æœŸæœ›æ—¶ç»ˆæ€å›ºå®šï¼Œæ‰€ä»¥è€ƒè™‘å€’ç€åšã€‚è®¾ $\mathbb{E}_i$ è¡¨ç¤ºè€ƒè™‘ $i\sim n$ çš„èˆªç­çš„æœŸæœ›æœ€å°æ­¥æ•°ï¼Œå‘ç°æœ‰è½¬ç§»</p><script type="math/tex; mode=display">\mathbb{E}_i=\zeta(i)+\sum _{j=1}^{k_i}\left(\prod_{k=1}^{j-1} (1-p_{i,k})\right)\cdot p_{i,j} \cdot (\mathbb{E}_{i+1}+j)</script><p>å…¶ä¸­ $\zeta(i)$ æ˜¯è¿™è¶Ÿèˆªç­æ£€æŸ¥å®Œäº†ä¸€ä¸ªåæ‰çš„éƒ½æ²¡æœ‰çš„æœŸæœ›ï¼Œè½¬ç§»è·Ÿåé¢å·®ä¸å¤šä½†æ˜¯è¾¹ç•Œæ¯”è¾ƒå¥‡æ€ªå°±å•åˆ—å‡ºæ¥äº†ã€‚</p><p>é‚£ä¹ˆè€ƒè™‘ç­”æ¡ˆæœ¬è´¨ä¸Šå°±æ˜¯åœ¨æ±‚è¿™ä¸ªä¸œè¥¿çš„æœ€å°å€¼ã€‚è€ƒè™‘è¿™ç›¸å½“äºæ˜¯ä¸€ç³»åˆ—ä¸€æ¬¡å‡½æ•°çš„åµŒå¥—ï¼Œäºæ˜¯è€ƒè™‘æŒ‰ç…§ä»€ä¹ˆé¡ºåºå»åµŒå¥—è¿™ $n$ ä¸ªå‡½æ•°ã€‚è€ƒè™‘å¦‚ä¸‹ååºå…³ç³»ï¼š</p><script type="math/tex; mode=display">\tau_i(\tau_j+\epsilon_j)+\epsilon_i<\tau_j(\tau_i+\epsilon_i)+\epsilon_j</script><p>ç§»é¡¹å¯ä»¥å¾—åˆ°</p><script type="math/tex; mode=display">\frac{\tau_i-1}{\epsilon_i}<\frac{\tau_j-1}{\epsilon_j}</script><p>äºæ˜¯æŒ‰ç…§è¿™ä¸ªæ’åºå°±å¥½äº†ã€‚å¤æ‚åº¦ $O(\sum k_i+n\log n)$ ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n, k ;</span><br><span class="line"></span><br><span class="line">db ans ;</span><br><span class="line">db base[N] ;</span><br><span class="line">pdb func[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) ; db res, t ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;k) ; res = <span class="number">1.0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= k ; ++ j) <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;base[j]) ;</span><br><span class="line">        sort(base + <span class="number">1</span>, base + k + <span class="number">1</span>, [](db x, db y)&#123; <span class="keyword">return</span> x &gt; y ; &#125;) ;</span><br><span class="line">        <span class="keyword">while</span> (k &amp;&amp; base[k] &lt;= eps) k -- ;</span><br><span class="line">        <span class="keyword">if</span> (base[<span class="number">1</span>] &gt;= <span class="number">1.0</span> - eps) &#123; n --, i -- ; <span class="keyword">continue</span> ; &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= k ; ++ j)&#123;</span><br><span class="line">            t = res * base[j], res *= (<span class="number">1.0</span> - base[j]) ;</span><br><span class="line">            func[i].fr += t , func[i].sc += t * j ;</span><br><span class="line">        &#125;</span><br><span class="line">        func[i].sc += res * k ;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(func + <span class="number">1</span>, func + n + <span class="number">1</span>, [](pdb a, pdb b)&#123; <span class="keyword">return</span> a.fr * b.sc + a.sc &lt; b.sc + b.fr * a.sc ; &#125;) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n ; i &gt;= <span class="number">1</span> ; -- i)</span><br><span class="line">        ans = func[i].fr * ans + func[i].sc ;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.10lf"</span>, ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="1.png" alt=""></p><p>$1\leq m\leq 10^6,1\leq n\leq 30$ ã€‚</p></blockquote><p>é¦–å…ˆå…ˆçœ‹è¿™ä¸ªè¯¡å¼‚æ“ä½œï¼Œä¸éš¾å‘ç°å°±æ˜¯å·¦ç§»ï¼Œå¦‚æœ $2^{n-1}$ ä½æ˜¯ $1$ï¼Œé‚£ä¹ˆå°±æŠŠç¬¬ä¸€ä½æˆ–æˆ $1$ï¼Œå† $\rm and$ ä¸Š $2^{n}-1$ â€¦ç»“æœå‘ç°è¿™å°±æ˜¯ä¸€ä¸ªå¾ªç¯å·¦ç§»çš„æ“ä½œã€‚</p><p>ç„¶åä¸éš¾çœ‹å‡ºåˆå€¼æœ‰é™ã€‚ä½†æ˜¯å› ä¸ºåˆå€¼çš„é€‰å–å’Œå° Y çš„å†³ç­–éƒ½æ˜¯å˜é‡ï¼Œæ‰€ä»¥è€ƒè™‘å®šä½ä¸€è¾¹ã€‚å‘ç°è®© $x$ å¾ªç¯å·¦ç§»ä¹‹åå†å¼‚æˆ–ï¼Œç”±äºä½è¿ç®—çš„äº¤æ¢å¾‹ï¼Œæœ¬è´¨ä¸Šå¯ä»¥ç­‰ä»·äºè®©ç¬¬ $1\sim i$ çš„å‰ç¼€æ•´ä½“å¾ªç¯å·¦ç§»ä¸€ä½ç„¶åå†å¼‚æˆ–ä¸Š $x &lt;&lt; 1$ ï¼Œå³</p><script type="math/tex; mode=display">(a\operatorname{xor}b) \operatorname{<<}1=(a \operatorname{<<}1)\operatorname{xor}(b\operatorname{<<}1)</script><p>ç„¶åå°±å¯ä»¥é¢„å¤„ç†å¤„ä¸€ä¸ª $\{b_n\}$ è¡¨ç¤º</p><script type="math/tex; mode=display">(x<<1)\operatorname{xor} b_i=\left(x\operatorname{xor}{\left(\bigoplus_{j=1}^{i}a_i\right)}\right) <<1</script><p>ç„¶åè€ƒè™‘å¯¹äºä¸€ä¸ªå›ºå®šçš„ $x$ ï¼Œå° Y çš„ç­–ç•¥å°±ä¼šæ˜¯æ‰¾åˆ°å¯¹äºä¸€ä¸ªå›ºå®šçš„ $x$ çš„æœ€å°çš„ $b_i$ï¼Œè€Œå° D çš„ç­–ç•¥åˆ™æ˜¯é€‰æ‹©æœ€ä¼˜çš„åˆå€¼è¾¾åˆ°æœ€å¤§çš„ç»“æœã€‚</p><p>äºæ˜¯è€ƒè™‘æŒ‰ä½åˆ†æ²»ã€‚å…ˆå¯¹ $\{b_n\}$ æ’ä¸ªåºï¼Œè¿™æ ·å¯¹äºæ¯ä¸€ä½ä¸º $1$ æˆ–æ˜¯ä¸º $0$ å°±æ˜¯ä¸€ä¸ªè¿ç»­çš„åŒºé—´ã€‚é‚£ä¹ˆå¦‚æœæ•´ä¸ªåŒºé—´ä¸­çš„æ‰€æœ‰ $b_i$ ç¬¬ $p$ ä½å‡ä¸º $1$ ï¼Œé‚£ä¹ˆè¿™ä¸€ä½å°±å¿…é¡»è¦é€‰ $1$ ï¼Œå¦åˆ™å° Y å¯ä»¥åœ¨å° D é€‰ $0$ çš„æ—¶å€™ä¹Ÿé€‰ $0$ï¼Œé€‰ $1$ çš„æ—¶å€™ä¹Ÿé€‰ $1$ ä½¿å¾—ç­”æ¡ˆæœ€å°ã€‚</p><p>æ³¨æ„ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸éœ€è¦ä½“ç°å‡º $x$ ä¹Ÿè¦ $&lt;&lt;1$ è¿™ä¸€ç‚¹æ¥ï¼Œå› ä¸ºæ¯ä¸ª $x$ å¯¹åº”ç€å”¯ä¸€çš„ $x&lt;&lt;1$ ï¼Œè€Œæˆ‘ä»¬åªå…³å¿ƒæœ€åçš„æœ€å°ç­”æ¡ˆå’Œæ–¹æ¡ˆæ•°ï¼Œå¹¶ä¸å…³å¿ƒå…·ä½“é€‰äº†ä»€ä¹ˆ $x$ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> T ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> a[N] ;</span><br><span class="line"><span class="keyword">int</span> b[N] ;</span><br><span class="line"><span class="keyword">int</span> pre[N] ;</span><br><span class="line"><span class="keyword">int</span> suf[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> res)</span></span>&#123;</span><br><span class="line"><span class="comment">//    cout &lt;&lt; l &lt;&lt; " " &lt;&lt; r &lt;&lt; " " &lt;&lt; p &lt;&lt; " " &lt;&lt; res &lt;&lt; '\n' ;</span></span><br><span class="line">    <span class="keyword">if</span> (p &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (res &gt; ans)</span><br><span class="line">            ans = res, cnt = <span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (res == ans) ++ cnt ;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span>() ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l, now = <span class="number">1</span> &lt;&lt; p ;</span><br><span class="line">    <span class="keyword">while</span> (mid &lt;= r &amp;&amp; !(b[mid] &amp; now)) ++ mid ;</span><br><span class="line">    <span class="keyword">if</span> (mid == l || mid &gt; r)</span><br><span class="line">        <span class="keyword">return</span> solve(l, r, p - <span class="number">1</span>, res | now) ;</span><br><span class="line">    solve(l, mid - <span class="number">1</span>, p - <span class="number">1</span>, res) ;</span><br><span class="line">    solve(mid, r, p - <span class="number">1</span>, res) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; T ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) a[i] = qr() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i) pre[i] = pre[i - <span class="number">1</span>] ^ a[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m ; i &gt;= <span class="number">1</span> ; -- i) b[i - <span class="number">1</span>] = suf[i] = suf[i + <span class="number">1</span>] ^ a[i] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        b[i] ^= ((pre[i] &gt;&gt; (n - <span class="number">1</span>) | (pre[i] &lt;&lt; <span class="number">1</span>)) &amp; ((<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>)) ;</span><br><span class="line">    sort(b, b + m + <span class="number">1</span>) ; solve(<span class="number">0</span>, m, n - <span class="number">1</span>, <span class="number">0</span>) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">"\n"</span> ; <span class="keyword">if</span> (T) <span class="built_in">cout</span> &lt;&lt; cnt &lt;&lt; <span class="string">'\n'</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç”±äºå¥‡å¥‡æ€ªæ€ªçš„åŸå› (å…¶å®æ˜¯å› ä¸ºå¤ªå›°+vp CF)ï¼Œäºæ˜¯å°±åˆæ‘¸äº†å¥½ä¹…â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ZROI" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/ZROI/"/>
    
    
      <category term="æ€ç»´é¢˜/è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E8%AE%A1%E6%95%B0/"/>
    
      <category term="æ€ç»´é¢˜/æ„é€ " scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%9E%84%E9%80%A0/"/>
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="æ•°å­¦/æ¦‚ç‡,æœŸæœ›" scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E6%A6%82%E7%8E%87-%E6%9C%9F%E6%9C%9B/"/>
    
      <category term="æ€ç»´é¢˜/å¯¹åº”ä¸è½¬åŒ–" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E5%AF%B9%E5%BA%94%E4%B8%8E%E8%BD%AC%E5%8C%96/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/æ™®é€šDP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%99%AE%E9%80%9ADP/"/>
    
      <category term="æŠ€å·§/åˆ†æ²»" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E5%88%86%E6%B2%BB/"/>
    
      <category term="è´ªå¿ƒ" scheme="https://www.orchidany.cn/tags/%E8%B4%AA%E5%BF%83/"/>
    
      <category term="å¤šé¡¹å¼çš„åº”ç”¨" scheme="https://www.orchidany.cn/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%9A%84%E5%BA%94%E7%94%A8/"/>
    
      <category term="æŠ€å·§/çŠ¶æ€åˆå¹¶" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E7%8A%B6%E6%80%81%E5%90%88%E5%B9%B6/"/>
    
      <category term="æŠ€å·§/æŒ‰ä½è€ƒè™‘" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E6%8C%89%E4%BD%8D%E8%80%83%E8%99%91/"/>
    
      <category term="åšå¼ˆè®º/ç»„åˆæ¸¸æˆ" scheme="https://www.orchidany.cn/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA-%E7%BB%84%E5%90%88%E6%B8%B8%E6%88%8F/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘[Codeforces Global Round#5 A~F] å£èƒ¡è®°</title>
    <link href="https://www.orchidany.cn/2020/06/04/CF-Global-Round-5%E5%8F%A3%E8%83%A1%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/06/04/CF-Global-Round-5å£èƒ¡è®°/</id>
    <published>2020-06-04T07:54:22.000Z</published>
    <updated>2020-06-04T08:58:22.600Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å•ç‹¬æ•´ç†è¿™ä¸€åœºï¼Œä¸€æ˜¯å› ä¸ºè¿™ä¸€åœºçš„é¢˜ç›®è´¨é‡æ•´ä½“æ¯”è¾ƒé«˜ï¼ŒäºŒæ˜¯å› ä¸ºè¿™ä¸€åœºçš„ E æ˜¯å®åœ¨æ˜¯æœ‰ç‚¹ç¥ä»™â€¦</p><p>æ‰˜è€å¸ˆè¿˜æ˜¯å®åˆ€ä¸è€é¸­ï¼</p><p>ä»¥ä¸‹éƒ¨åˆ†ç®€å•é¢˜æ˜¯åœ¨å®¿èˆè‡ªä¹ å®¤é‡Œå£èƒ¡å‡ºæ¥çš„ã€‚</p><a id="more"></a><h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><p>ç§’äº†ã€‚é¢˜é¢å¤ªé•¿äº†ã€‚è€ƒè™‘ä¸€å®šå¯ä»¥è®©æ­£æ•°å’Œè´Ÿæ•°å„ä½™å‡º $1$ çš„è´¡çŒ®ï¼Œç„¶åå°±åšå®Œäº†ã€‚</p><h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><p>ç§’äº†ã€‚ä¸€å¼€å§‹è§‰å¾—å¯èƒ½æ˜¯ä»€ä¹ˆä¿©æ’åˆ—çš„ LCS ä¹‹ç±»çš„ã€‚åæ¥é‡è¯»äº†ä¸€éé¢˜å‘ç°åŸæ¥åªéœ€è¦è®°ä¸€ä¸ªå‰ç¼€ $\max$ å»åˆ¤æ–­æ˜¯å¦æœ‰è½¦è¢«è‡ªå·±ä¹‹åçš„è¶…äº†å°±å®Œäº†ã€‚</p><h1 id="C1-amp-C2"><a href="#C1-amp-C2" class="headerlink" title="C1 &amp; C2"></a>C1 &amp; C2</h1><p>è¿™ä¸ª C ä¸çŸ¥ä¸ºä½•æŠŠæˆ‘ç»™ç‹™äº†â€¦äºæ˜¯å°±åªèƒ¡å‡ºæ¥äº† C1ã€‚</p><p>C1 å¤§æ¦‚æ˜¯è€ƒè™‘å…ˆ $n^2$ æ±‚ä¸€éäº¤ï¼Œç„¶åä¸æ–­åˆ ç›¸è·æœ€è¿‘çš„ç›¸äº¤çš„å¼¦ï¼Œåˆ åˆ°éƒ½ä¸ç›¸äº¤ä¸ºæ­¢ï¼Œç„¶åéšä¾¿é…å¯¹å°±å¥½äº†ã€‚</p><p>C2 ç¿»è½¦çš„åŸå› æ˜¯æ¨äº†ä¸ªå‡ç»“è®ºâ€¦è§‰å¾—å¦‚æœæ’ä¸ªåºä¹‹åï¼Œä»æœ€ä¸­é—´çš„ä¸¤ä¸ªå¼€å§‹åŒ¹é…ï¼Œ<code>l--,r++</code> è¿™ç§å°±ä¸€å®šå¯ä»¥ã€‚ç„¶åå‘ç°ç†è§£é”™é¢˜æ„äº†â€¦ä¸‰ä¸ªç‚¹çš„ååºé¡ºåºå¹¶ä¸éœ€è¦ç›¸åŒã€‚</p><p>å†·é™ä¸‹æ¥å‘ç°ï¼Œå¯ä»¥å¯¹æ¯ä¸€ç»´åˆ†æ²»ã€‚å³ $x,y$ ç›¸åŒçš„å¯ä»¥ç›¸é‚»åŒ¹é…ï¼Œåˆ æ‰ä¹‹å $x$ ç›¸åŒçš„å¯ä»¥ç›¸é‚»åŒ¹é…ã€‚æ„Ÿè§‰è¢«é™æ™ºäº†ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">nd</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id ;</span><br><span class="line">    <span class="keyword">int</span> x, y, z ;</span><br><span class="line">&#125;base[N], re1[N], re2[N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> cnt ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">const</span> nd &amp;a, <span class="keyword">const</span> nd &amp;b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.x == b.x ? (a.y == b.y ? a.z &lt; b.z : a.y &lt; b.y) : a.x &lt; b.x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">x_y_equal</span><span class="params">(<span class="keyword">const</span> nd &amp;a, <span class="keyword">const</span> nd &amp;b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a.x == b.x &amp;&amp; a.y == b.y) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">x_equal</span><span class="params">(<span class="keyword">const</span> nd &amp;a, <span class="keyword">const</span> nd &amp;b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a.x == b.x) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        base[i].x = qr(), base[i].id = i ;</span><br><span class="line">        base[i].y = qr(), base[i].z = qr() ;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(base + <span class="number">1</span>, base + n + <span class="number">1</span>, comp) ;</span><br><span class="line">    base[n + <span class="number">1</span>] = (nd) &#123;<span class="number">0</span>, -P, -P, -P&#125; ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (x_y_equal(base[i], base[i + <span class="number">1</span>]))</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, base[i].id, base[i + <span class="number">1</span>].id), ++ i ;</span><br><span class="line">        <span class="keyword">else</span> re1[++ cnt] = base[i] ;</span><br><span class="line">    &#125;</span><br><span class="line">    swap(re1, base) ;</span><br><span class="line">    n = cnt ; cnt = <span class="number">0</span> ;</span><br><span class="line">    base[n + <span class="number">1</span>] = (nd)&#123;<span class="number">0</span>, -P, -P, -P&#125; ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">if</span> (x_equal(base[i], base[i + <span class="number">1</span>]))</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, base[i].id, base[i + <span class="number">1</span>].id), ++ i ;</span><br><span class="line">        <span class="keyword">else</span> re2[++ cnt] = base[i] ;</span><br><span class="line">    &#125;</span><br><span class="line">    swap(re2, base) ;</span><br><span class="line">    n = cnt ; cnt = <span class="number">0</span> ;</span><br><span class="line">    base[n + <span class="number">1</span>] = (nd)&#123;<span class="number">0</span>, -P, -P, -P&#125; ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; i += <span class="number">2</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, base[i].id, base[i + <span class="number">1</span>].id) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><p>ç§’äº†ã€‚è™½ç„¶ä¸€å¼€å§‹æ²¡å•¥æƒ³æ³•ï¼Œä½†æ˜¯ç›´è§‰å‘Šè¯‰æˆ‘åº”è¯¥æ‰¾ä¸Šç•Œï¼Œç„¶åå‘ç°ä¸Šç•Œæ˜¯ $2n$ ã€‚äºæ˜¯å°±å¯ä»¥æŠŠæ•°ç»„æ‹¼ä¸‰éï¼Œç„¶åå°±å¯ä»¥å¯¹æ¯ä¸ªä½ç½® $i$ï¼Œç”±äºéƒ½å…·æœ‰å•è°ƒæ€§ï¼ŒäºŒåˆ†å‡ºç¬¬ä¸€ä¸ª $k\in[i+1,i+2\cdot n]$ ä½¿å¾—åç¼€ $\min$ &lt; å‰ç¼€ $\max\times \dfrac{1}{2}$ çš„ä½ç½®å°±å¥½äº†ã€‚</p><h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><p>è¿™ä¸ªæ‰¾æ€§è´¨é¢˜â€¦æœ‰ç‚¹å¼ºã€‚</p><blockquote><p>æ±‚æœ‰å¤šå°‘æ£µç‚¹æ•°ä¸º $n(n\leqslant 10^6)$ çš„ï¼Œé”®å€¼ä¸º $1\sim n$ çš„æ’åˆ—çš„äºŒå‰æœç´¢æ ‘æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><p>$(1)$ <code>balanced</code>æ¯ä¸ªç‚¹çš„æ€»æ·±åº¦å’Œæœ€å°ã€‚</p><p>$(2)$ <code>striped.1</code> å¯¹äºæ¯ä¸ªç‚¹ï¼Œå¦‚æœå®ƒæœ‰å·¦å„¿å­ï¼Œé‚£ä¹ˆå·¦å„¿å­çš„é”®å€¼å’Œå®ƒçš„é”®å€¼å¥‡å¶æ€§<strong>ä¸åŒ</strong>ã€‚</p><p>$(3)$  <code>striped.2</code> å¯¹äºæ¯ä¸ªç‚¹ï¼Œå¦‚æœå®ƒæœ‰å³å„¿å­ï¼Œé‚£ä¹ˆå³å„¿å­çš„é”®å€¼å’Œå®ƒçš„é”®å€¼å¥‡å¶æ€§<strong>ç›¸åŒ</strong>ã€‚</p><p>ç­”æ¡ˆå¯¹ $998,244,353$ å–æ¨¡ã€‚</p></blockquote><div><div class="fold_hider"><div class="close hider_title">ã€ä»¥ä¸‹æ˜¯å¿ƒè·¯å†ç¨‹ã€‘</div></div><div class="fold"><hr><p>è¯»é¢˜çš„æ—¶å€™ç”±äºæ—è¾¹åªæœ‰è¿‡æ—¶çš„ç‰›æ´¥å­—å…¸ï¼Œäºæ˜¯æŸ¥äº†æŸ¥å‘ç° <code>parity</code> æ˜¯ä»€ä¹ˆ <code>å¹³ä»·</code> ï¼Œç„¶å <code>striped</code> æ˜¯ä»€ä¹ˆæœ‰æ¡çº¹çš„ã€‚æˆ‘å°± <code>???</code> ã€‚ä¸è¿‡æƒ³äº†ä¸€ä¼šå„¿å°±çŒœå‡ºæ¥åº”è¯¥æ˜¯åœ¨è¯´å¥‡å¶æ€§äº†ã€‚ </p><p>ç„¶åå°±å‘ç€è¦ä¸€ä¸ªä¸€ä¸ªæ¡ä»¶åœ°å»å®¹æ–¥â€¦å¤§æ¦‚æ˜¯é¦–å…ˆå‘ç°åˆæ³•çš„äºŒå‰æ’åºæ ‘ä¸¥æ ¼å¯¹åº”äºä¸åŒå½¢æ€çš„äºŒå‰æ ‘ï¼Œæ¢å¥è¯è¯´æ¯ä¸€ç§å½¢æ€çš„äºŒå‰æ ‘éƒ½æœ‰æ°å¥½ä¸€ä¸ªå¡«å……æ–¹å¼ä½¿ä¹‹æˆä¸ºäºŒå‰æœç´¢æ ‘ã€‚å°è¯•è¯æ˜å‘ç°æ˜¾ç„¶ï¼Œå› ä¸ºæ¯ç§å½¢æ€çš„äºŒå‰æ ‘çš„ä¸­åºéå†å”¯ä¸€ï¼Œè€ŒäºŒå‰æœç´¢æ ‘çš„ä¸­åºéå†çš„é”®å€¼åºåˆ—æ°å¥½æ˜¯ $1\sim n$ çš„æ’åˆ—ã€‚æ‰€ä»¥å‘ç°è¿™éƒ¨åˆ†ç­”æ¡ˆå°±æ˜¯å¡ç‰¹å…°æ•°ã€‚</p><p>â€¦äº‹å®è¯æ˜å¦‚æœåŸºç¡€æŒæ¡ä¸æ‰å®ï¼Œå°±å¯èƒ½ä¼šèŠ±ä¸Šé‚£ä¹ˆå‡ åç§’çš„æ—¶é—´å»ç°æ¨ä¸€æ³¢å·²çŸ¥ç»“è®ºâ€¦</p><p>ä½†ï¼Œè¿™ä¸ªç»“è®ºï¼Œæœ€åä¹Ÿæ ¹æœ¬æ²¡æœ‰ç”¨ä¸Šã€‚å› ä¸ºå‘ç°å‰©ä¸‹ä¸¤ä¸ªæ¡ä»¶æ ¹æœ¬æ²¡ä»€ä¹ˆç®€æ´çš„æ–¹æ³•ç›´æ¥å®¹æ–¥å‡ºæ¥ã€‚ç›´åˆ°ä»Šå¤©æ—©ä¸Šæ—©è¯»â€”â€”</p><hr></div></div><p>å‘ç°è¿™ä¸ª <code>balanced</code> æ˜¯ä¸ªå¾ˆå¼ºçš„çº¦æŸï¼Œå¯ä»¥è§‚å¯Ÿåˆ°åœ¨ç¬¬ä¸€ä¸ªæ¡ä»¶ä¸‹æ ¹èŠ‚ç‚¹åªèƒ½æ˜¯ $\left\lceil\dfrac{n}{2} \right\rceil$ æˆ–è€… $\left\lfloor\dfrac{n}{2} \right\rfloor$ ã€‚ç„¶åç´§æ¥ç€å¯ä»¥å‘ç°æ¯ä¸ªå­æ ‘åœ¨ç¬¬ä¸€ä¸ªçº¦æŸä¸‹éƒ½åªèƒ½æ˜¯ç±»ä¼¼çŠ¶æ€ã€‚ç„¶åè€ƒè™‘ç¬¬äºŒä¸ªæ¡ä»¶ï¼Œä¸€ä¸ªå¾ˆé‡è¦çš„äº‹å®åœ¨äºï¼Œå¯ä»¥å‘ç°é”®å€¼ $n$ æ°¸è¿œæ˜¯åœ¨æœ€å³ä¾§çš„é“¾ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“ $n$ ä¸€å®šå’Œ $root$ çš„é”®å€¼å¥‡å¶æ€§ç›¸åŒã€‚æ¥ç€ï¼Œç”±äºå³å­æ ‘çš„ç‚¹é›†æ˜¯ $[root,n]$ ï¼Œé‚£ä¹ˆä¸éš¾çŸ¥é“<strong>æ¯ä¸ªæ ¹çš„å³å­æ ‘ $size$ éƒ½å¿…ç„¶æ˜¯å¶æ•°</strong> ã€‚</p><p>æœ‰äº†è¿™äº›æ€§è´¨ï¼Œå¯ä»¥å‘ç°å¯¹äºæ¯ä¸ª $n$ ï¼Œç­”æ¡ˆè‡³å¤šä¸º $1$ ã€‚</p><p>è¯æ˜å¯ä»¥è€ƒè™‘å‡è®¾æœ‰ä¸¤ä¸ªå‡æ»¡è¶³æ¡ä»¶çš„æ ‘ $T_1,T_2$ ï¼Œé‚£ä¹ˆä»–ä»¬ä¸€å®šæœ‰æŸéƒ¨åˆ†åŒæ„ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†ä¸åŒæ„ã€‚è€ƒè™‘ä¸åŒæ„çš„é‚£éƒ¨åˆ†ï¼Œç”±äºè¦æ»¡è¶³ <code>perfect balanced</code> ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“ã€Œä¸åŒæ„ã€åªèƒ½æ˜¯æŠŠæŸä¸ªç‚¹çš„æŸä¸ªå­æ ‘çš„ä¸€ä¸ªç‚¹ç§»åˆ°å¦ä¸€é¢—å­æ ‘é‡Œï¼Œè¿™è¦æ»¡è¶³ä¸¤ä¸ªå­æ ‘ size ä¹‹å‰ç›¸å·® $1$ ï¼Œæ‰€ä»¥ $T_1,T_2$ ä¸­å¿…ç„¶æœ‰ä¸€æ£µæ ‘æ»¡è¶³å­˜åœ¨ä¸€ä¸ªç‚¹ï¼Œå…¶å³å­æ ‘çš„ size æ˜¯å¥‡æ•°ã€‚æ‰€ä»¥å¯çŸ¥ç­”æ¡ˆè‡³å¤šä¸º $1$ ã€‚</p><p>äºæ˜¯å°±å¯ä»¥ç›´æ¥ä» $size=1$ å¼€å§‹æ„é€ äº†ã€‚å¤æ‚åº¦ $\log n$ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n ;</span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ans = <span class="number">1</span> ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) ;</span><br><span class="line">    <span class="keyword">while</span> (ans &lt;= n)&#123;</span><br><span class="line">        <span class="keyword">if</span> (ans == n || ans == n - <span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"1"</span>), <span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">if</span> (ans &amp; <span class="number">1</span>) (ans &lt;&lt;= <span class="number">1</span>) += <span class="number">2</span> ; <span class="keyword">else</span> (ans &lt;&lt;= <span class="number">1</span>) += <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"0"</span>), <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="F"><a href="#F" class="headerlink" title="F"></a>F</h1><p>æ¯”è¾ƒç®€å•çš„è®¡æ•°é¢˜ï¼Ÿå¤§æ¦‚å°±æ˜¯è€ƒè™‘æ— è®ºæ˜¯æ¨ªç€çš„ç‰Œå äº†æŸä¸€åˆ—æˆ–ç«–ç€å äº†æŸä¸€åˆ—ï¼Œéƒ½æ˜¯å (<del>ä¹Ÿå«åšã€Œæ¨ªç«–éƒ½æ˜¯å ã€</del>)ï¼Œæ‰€ä»¥å¯ä»¥ç”¨è¡Œåˆ—æ— å…³çš„æ€æƒ³æ¥ DPã€‚å…·ä½“çš„ï¼Œè®¾ $f_{i,j}$ è¡¨ç¤ºå‰ $i$ è¡Œé€‰äº† $j$ å¯¹ç›¸é‚»çš„ä¸¤è¡Œï¼Œ$g_{i,j}$ è¡¨ç¤ºå‰ $i$ åˆ—é€‰äº† $j$ å¯¹ç›¸é‚»çš„ä¸¤åˆ—ã€‚é‚£ä¹ˆä¼šæœ‰è½¬ç§»</p><script type="math/tex; mode=display">\tau_{i,j}=\tau_{i-1,j}+\tau_{i-2,j-1}</script><p>å…¶ä¸­ $\{\tau\}$ å¯ä»¥çœ‹åšé€šé…ç¬¦ã€‚è½¬ç§»æ³¨æ„ç‰¹åˆ¤ä¸€ä¸‹åˆæ³•æ€§ã€‚ç„¶åå°±å¯ä»¥åˆå¹¶å‡ºç­”æ¡ˆæ¥</p><script type="math/tex; mode=display">ans=\sum_p\sum_q f_{n,p}\times g_{m,q}\times {\rm P}(m-2\cdot q,p)\times {\rm P}(n-2\cdot p,q)</script><p>å…¶ä¸­ ${\rm P}(n,m)$ æ˜¯ä» $n$ ä¸ªå…ƒç´ é‡Œé¢é€‰ $m$ ä¸ªå…ƒç´ çš„æ’åˆ—æ•°ã€‚ä¹‹æ‰€ä»¥æ˜¯æ’åˆ—æ•°æ˜¯å› ä¸ºå¯¹äºæŸäº›ç¡®å®šæ¨ªç€æ”¾çš„éª¨ç‰Œï¼Œ$dp$ æ•°ç»„åªæ˜¯ç¡®å®šäº†ä»–ä»¬çš„åˆ—è¯¥æ€ä¹ˆæ”¾ï¼Œæ‰€ä»¥ç›¸å½“äºç»™æ¯ä¸ªéª¨ç‰Œåˆ†é…ä¸€ä¸ªè¡Œå·ï¼Œæ‰€ä»¥æ˜¯æ’åˆ—æ•°ã€‚</p><div><div class="fold_hider"><div class="close hider_title">ã€ŒMy-Codeã€</div></div><div class="fold"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span> ;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> il inline</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5050</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans ;</span><br><span class="line"><span class="keyword">int</span> fac ;</span><br><span class="line"><span class="keyword">int</span> smax ;</span><br><span class="line"><span class="keyword">int</span> sn, sm ;</span><br><span class="line"><span class="keyword">int</span> n, m, k ;</span><br><span class="line"><span class="keyword">int</span> visr[N] ;</span><br><span class="line"><span class="keyword">int</span> visc[N] ;</span><br><span class="line"><span class="keyword">int</span> f[N][N] ;</span><br><span class="line"><span class="keyword">int</span> g[N][N] ;</span><br><span class="line"><span class="keyword">int</span> perm[N][N] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il <span class="keyword">void</span> <span class="title">add</span><span class="params">(T &amp;x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x += y ; x = x &gt;= mod ? x - mod : x ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">il T <span class="title">addn</span><span class="params">(T x, ll y, <span class="keyword">int</span> mod = P)</span></span>&#123;</span><br><span class="line">    x += y ; <span class="keyword">return</span> (x = x &gt; mod ? x - mod : x) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">chkr</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ((!visr[x] &amp;&amp; !visr[x - <span class="number">1</span>]) &amp;&amp; y &amp;&amp; (<span class="keyword">bool</span>)(x - <span class="number">1</span>)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">chkc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ((!visc[x] &amp;&amp; !visc[x - <span class="number">1</span>]) &amp;&amp; y &amp;&amp; (<span class="keyword">bool</span>)(x - <span class="number">1</span>)) ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a, b, c, d ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;k) ;</span><br><span class="line">    smax = max(sn = n, sm = m), fac = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= smax ; ++ i) perm[i][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= smax ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span> ; j &lt;= i ; ++ j)</span><br><span class="line">            perm[i][j] = addn(perm[i - <span class="number">1</span>][j], perm[i - <span class="number">1</span>][j - <span class="number">1</span>]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= smax ; ++ j)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = j ; i &lt;= smax ; ++ i)</span><br><span class="line">            perm[i][j] = <span class="number">1l</span>l * perm[i][j] * fac % P ;</span><br><span class="line">        fac = <span class="number">1l</span>l * fac * (j + <span class="number">1</span>) % P ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= k ; ++ i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a, &amp;b) ;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;c, &amp;d) ;</span><br><span class="line">        <span class="keyword">if</span> (a == c)&#123;</span><br><span class="line">            -- sn, -- sm, -- sm ;</span><br><span class="line">            visr[a] = <span class="number">1</span>, visc[b] = visc[d] = <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (b == d)&#123;</span><br><span class="line">            -- sm, -- sn, -- sn ;</span><br><span class="line">            visc[d] = <span class="number">1</span>, visr[a] = visr[c] = <span class="number">1</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>] = g[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= (sn &gt;&gt; <span class="number">1</span>) ; ++ j)</span><br><span class="line">            f[i][j] = addn(chkr(i, j) * f[i - <span class="number">2</span>][j - <span class="number">1</span>], f[i - <span class="number">1</span>][j]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= (sm &gt;&gt; <span class="number">1</span>) ; ++ j)</span><br><span class="line">            g[i][j] = addn(chkc(i, j) * g[i - <span class="number">2</span>][j - <span class="number">1</span>], g[i - <span class="number">1</span>][j]) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt;= (sn &gt;&gt; <span class="number">1</span>) ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt;= (sm &gt;&gt; <span class="number">1</span>) ; ++ j)</span><br><span class="line">            add(ans, <span class="number">1l</span>l * f[n][i] * g[m][j] % P * perm[sn - (i &lt;&lt; <span class="number">1</span>)][j] % P * perm[sm - (j &lt;&lt; <span class="number">1</span>)][i] % P) ;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><p>ç„¶åå°±æ²¡æœ‰ç„¶åäº†ï¼ŒGå’ŒHæ˜¯ä¸å¯èƒ½åšçš„ (x</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å•ç‹¬æ•´ç†è¿™ä¸€åœºï¼Œä¸€æ˜¯å› ä¸ºè¿™ä¸€åœºçš„é¢˜ç›®è´¨é‡æ•´ä½“æ¯”è¾ƒé«˜ï¼ŒäºŒæ˜¯å› ä¸ºè¿™ä¸€åœºçš„ E æ˜¯å®åœ¨æ˜¯æœ‰ç‚¹ç¥ä»™â€¦&lt;/p&gt;
&lt;p&gt;æ‰˜è€å¸ˆè¿˜æ˜¯å®åˆ€ä¸è€é¸­ï¼&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹éƒ¨åˆ†ç®€å•é¢˜æ˜¯åœ¨å®¿èˆè‡ªä¹ å®¤é‡Œå£èƒ¡å‡ºæ¥çš„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="Codeforces" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/Codeforces/"/>
    
    
      <category term="æ€ç»´é¢˜/æ„é€ " scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%9E%84%E9%80%A0/"/>
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="ç»„åˆè®¡æ•°/æœ‰æŠ€å·§çš„è®¡æ•°" scheme="https://www.orchidany.cn/tags/%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84%E8%AE%A1%E6%95%B0/"/>
    
      <category term="æ•°å­¦/è§‚å¯Ÿæ€§è´¨,ç»“è®ºä¸æ„é€ " scheme="https://www.orchidany.cn/tags/%E6%95%B0%E5%AD%A6-%E8%A7%82%E5%AF%9F%E6%80%A7%E8%B4%A8-%E7%BB%93%E8%AE%BA%E4%B8%8E%E6%9E%84%E9%80%A0/"/>
    
      <category term="æŠ€å·§/è¡Œåˆ—æ— å…³" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E8%A1%8C%E5%88%97%E6%97%A0%E5%85%B3/"/>
    
  </entry>
  
  <entry>
    <title>ã€è®­ç»ƒè®°å½•ã€‘6.3 è®­ç»ƒç¬”è®°</title>
    <link href="https://www.orchidany.cn/2020/06/03/6-3-%E8%AE%AD%E7%BB%83%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.orchidany.cn/2020/06/03/6-3-è®­ç»ƒç¬”è®°/</id>
    <published>2020-06-03T12:16:33.000Z</published>
    <updated>2020-06-03T13:11:20.285Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>å› ä¸ºå¥‡æ€ªçš„é—®é¢˜ï¼Œå¯¼è‡´å…¶å®æ˜¨å¤©ç¬¬ä¸‰åœºçš„ T3 å†™çš„å¤æ‚åº¦å¹¶ä¸å¯¹ã€‚äºæ˜¯ä»Šå¤©å°±èŠ±äº†å¾ˆå¤šæ—¶é—´ç ”ç©¶äº†ä¸€ä¸‹æ­£ç¡®çš„åšæ³•ï¼Œå¯¼è‡´åªæ‰“äº†ä¸€åœºâ€¦ï¼ˆå¹¶ä¸”åšå®Œæ²¡ç¡å¥½å¯¼è‡´ä¸Šåˆæ•ˆç‡æä½ï¼‰ã€‚</p><p>ä¸è¿‡æœ‰ä¸€è¯´ä¸€ï¼Œé¢˜ç›®è¿˜æ˜¯å¾ˆèµçš„ï¼æ„Ÿè§‰å­¦åˆ°äº†å¾ˆå¤šã€‚</p><a id="more"></a><h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><blockquote><p>ç»™å®šä¸¤ä¸ªé•¿åº¦åˆ†åˆ«ä¸º $n,m$ çš„ä¸² $s,t$ ã€‚æ±‚æœ‰å¤šå°‘ä¸ª $s$ çš„æœ¬è´¨ä¸åŒçš„å­ä¸²(èµ·å§‹ä½ç½®ä¸åŒ)åŒ…å« $t$ ä½œä¸ºå­åºåˆ—ã€‚</p><p>$1\leq n\leq 10^5,1\leq m\leq 100$ ã€‚</p></blockquote><p>æ‹¿äº†ä¸€ä¸ªæ¯” std æ›´æœ‰æŠ€æœ¯å«é‡çš„åšæ³•ç§’äº†è¿™é“é¢˜ã€‚å¤§æ¦‚æ˜¯è€ƒè™‘å¯ä»¥å…ˆé¢„å¤„ç†å‡º $s$ ä¸­æœ‰å“ªäº›æå°çš„åŒºé—´åŒ…å« $t$ ä½œä¸ºå­åºåˆ—ï¼Œè¿™éƒ¨åˆ†å¯ä»¥ç”¨å­åºåˆ—è‡ªåŠ¨æœºæ¥å®ç°ã€‚è§‚å¯Ÿåˆ° $m$ æ¯”è¾ƒå°ï¼Œå°±å¯ä»¥æšä¸¾æ¯ä¸€ä¸ª $s_i=t_1$ çš„ä½ç½® $i$ å¼€å§‹åœ¨è‡ªåŠ¨æœºä¸ŠåŒ¹é…ç›´åˆ°ç»“æŸã€‚</p><p>è¿™æ ·æœ€åä¸€å®šæ˜¯ä¸€å †åŒºé—´ã€‚è€ƒè™‘å¦‚æœä¸€ä¸ªåŒºé—´è¢«å¦ä¸€ä¸ªåŒºé—´å®Œå…¨åŒ…å«ï¼Œé‚£ä¹ˆé‚£ä¸ªå¤§åŒºé—´å°±æ²¡ç”¨äº†ï¼Œå¯ä»¥åˆ æ‰ã€‚äºæ˜¯å°±å¯ä»¥å¯¹ <code>vector</code> æ’ä¸ªåºç”¨ç±»ä¼¼å•è°ƒæ ˆçš„æ–¹æ³•åšè¿™ä¸ªè¿‡ç¨‹ã€‚ä¹‹åè€ƒè™‘ï¼Œå¯¹äºç›¸é‚»çš„ä¸¤ç«¯åŒºé—´ $[l_1,r_1],[l_2,r_2]$ï¼Œ$[l_2,r_2]$ å¯ä»¥äº§ç”Ÿçš„éƒ¨åˆ†è´¡çŒ® $[l_1,r_1]$ ä¹Ÿäº§ç”Ÿäº†ï¼Œä¸éš¾å‘ç°è¿™å°±æ˜¯é‚£äº›æ»¡è¶³ $[l_2,r_2]\subset [l,r]$ ä¸” $l\leq l_1$ çš„è´¡çŒ®ï¼Œäºæ˜¯å·¦ç«¯ç‚¹å°±åªå– $l_2-l_1$ è¿™äº›æ–¹æ¡ˆå°±å¥½äº†ã€‚å¤æ‚åº¦ $O(|\Sigma|\times n+nm)$ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">char</span> a[N] ;</span><br><span class="line"><span class="keyword">char</span> b[N] ;</span><br><span class="line"><span class="keyword">int</span> nxt[N][<span class="number">26</span>] ;</span><br><span class="line"></span><br><span class="line">vpint ant ;</span><br><span class="line">vpint range ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">26</span> ; ++ j) nxt[L + <span class="number">1</span>][j] = L + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = L ; i &gt;= <span class="number">1</span> ; -- i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; <span class="number">26</span> ; ++ j)</span><br><span class="line">            nxt[i][j] = nxt[i + <span class="number">1</span>][j] ;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; L)</span><br><span class="line">            nxt[i][s[i + <span class="number">1</span>] - <span class="string">'a'</span>] = i + <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_match</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> q = <span class="number">1</span>, o = p ;</span><br><span class="line">    <span class="keyword">while</span> (p &lt; n + <span class="number">1</span> &amp;&amp; q &lt; m)</span><br><span class="line">        ++ q, p = nxt[p][b[q] - <span class="string">'a'</span>] ;</span><br><span class="line">    range.p_b(make_pair(o, p)) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(pint a, pint b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.fr == b.fr ? a.sc &gt; b.sc : a.fr &lt; b.fr ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">r_include</span><span class="params">(pint a, pint b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.fr &lt;= b.fr &amp;&amp; a.sc &gt;= b.sc ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, a + <span class="number">1</span>) ;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>, b + <span class="number">1</span>) ; build(a, n) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (a[i] == b[<span class="number">1</span>]) do_match(i) ;</span><br><span class="line">    sort(range.begin(), range.end()) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; range.size() ; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = ant.size() - <span class="number">1</span> ; ~k ; -- k)</span><br><span class="line">            <span class="keyword">if</span> (r_include(ant[k], range[i])) ant.pop_back() ;</span><br><span class="line">        ant.push_back(range[i]) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; ant.size() ; ++ i)</span><br><span class="line">        ans += <span class="number">1l</span>l * (n - ant[i].sc + <span class="number">1</span>) * (ant[i].fr - l), l = ant[i].fr ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="1.png" alt=""></p><p>$1\leq m\leq 16$ ã€‚</p></blockquote><p>è¿™é¢˜æ˜¯çœŸçš„ç¥ç¥ç¥ç¥ç¥ã€‚ç„¶è€Œè‡ªå·±æ‰“äº†æš´åŠ›å°±è·‘äº†ã€‚</p><p>è€ƒè™‘æ‰¾æ€§è´¨+åˆ†æ²»ã€‚æœ‰è¿™ä¹ˆå‡ ä¸ª<del>æ‰¾ä¸å‡ºæ¥çš„</del>æ€§è´¨ï¼š</p><p>1ã€æ¯ä¸ª $1\sim n$ çš„æ•°è‡³å°‘ä¼šåœ¨ $p_0\sim p_{2^m-1}$ ä¸­å‡ºç°ä¸€æ¬¡ã€‚è€ƒè™‘å¯¹äºæŸä¸ª $a_i$ ï¼Œå°†å…¶å–åå¾—åˆ°çš„ $rev(a_i)$ä¸€å®šä¹Ÿæ˜¯ $[0,2^m-1]$ ä¹‹é—´çš„æ•°ï¼ŒåŒæ—¶å¿…ç„¶æœ‰ $a_i\operatorname{xor} rev(a_i)$ æœ€ä¼˜ï¼Œå¯ä»¥è¾¾åˆ° $2^m-1$ è¿™ä¸ªä¸Šç•Œ ã€‚</p><p>2ã€è€ƒè™‘å¯¹ $p$ æŒ‰ç…§<strong>äºŒè¿›åˆ¶(å½“å‰)æœ€é«˜ä½æ˜¯0/1</strong>è¿›è¡Œåˆ†æ²»ã€‚è€ƒè™‘åˆ†æ²»åˆ°æŸä¸ªæ—¶åˆ»çš„ $[l,r]$ã€‚è€ƒè™‘å¦‚æœå­˜åœ¨ $[l,mid]$ å’Œ $[mid+1,r]$ çš„æ‰€æœ‰ $p_i$ åˆ†åˆ«ç›¸åŒï¼Œé‚£ä¹ˆè¯´æ˜å½“å‰è¿™ä¸€ä½è®¾æˆ $0$ è¿˜æ˜¯ $1$ å¹¶æ²¡æœ‰ä»€ä¹ˆä»€ä¹ˆå½±å“ï¼Œæ‰€ä»¥æ­¤æ—¶å¯¹ç­”æ¡ˆä¼šäº§ç”Ÿ $2$ çš„è´¡çŒ®ã€‚å¹¶ä¸”ç”±äºå·¦å³åŒºé—´ç›¸åŒï¼Œéœ€è¦åªåˆ†æ²»ä¸€è¾¹ã€‚</p><p>3ã€å¦‚æœä¸åŒï¼Œé‚£ä¹ˆè€ƒè™‘å¦‚æœ $[l,mid]$ ä¸­çš„æŸä¸ª $p_i$ å‡ºç°åœ¨äº† $[mid+1,r]$ é‡Œé¢ï¼Œé‚£ä¹ˆæœ€åç­”æ¡ˆå°±æ˜¯ $0$ã€‚åŸå› æ˜¯å¦‚æœä¸æ»¡è¶³å½“å‰æœ€é«˜ä½å¡« $0/1$ éƒ½å¯ä»¥çš„è¯ï¼Œå°±å¯ä»¥å¯¹è¿™äº›æ•°æŒ‰ç…§å½“å‰äºŒè¿›åˆ¶ä½åˆ†ç»„ã€‚è€Œä¸€ä¸ªæ•°å­—ä¸å¯èƒ½å­˜åœ¨äºŒè¿›åˆ¶ä¸‹æŸä¸€ä½æ—¢æ˜¯ $0$ åˆæ˜¯ $1$ï¼Œæ‰€ä»¥æ— è§£ã€‚</p><p>4ã€å¦åˆ™åˆ†æ²»åˆ°æ›´å°çš„äºŒè¿›åˆ¶ä½å»è§‚å¯Ÿè´¡çŒ®ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> buc[N] ;</span><br><span class="line"><span class="keyword">int</span> base[N] ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="comment">//debug(l, ' '), debug(r) ;</span></span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l, j = mid + <span class="number">1</span> ; i &lt;= mid ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (base[i] != base[j]) <span class="keyword">goto</span> no_contribute ; <span class="keyword">else</span> ++ j ;</span><br><span class="line">    (ans *= <span class="number">2l</span>l) %= P ; solve(l, mid) ; <span class="keyword">return</span> ;</span><br><span class="line">    no_contribute : <span class="keyword">void</span>() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= r ; ++ i) buc[base[i]] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l ; i &lt;= mid ; ++ i) buc[base[i]] ++ ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = mid + <span class="number">1</span> ; i &lt;= r ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (buc[base[i]]) <span class="built_in">puts</span>(<span class="string">"0"</span>), <span class="built_in">exit</span>(<span class="number">0</span>) ;</span><br><span class="line">    solve(l, mid) ; solve(mid + <span class="number">1</span>, r) ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m ; m = <span class="number">1</span> &lt;&lt; m ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; m ; ++ i)</span><br><span class="line">        buc[base[i] = qr()] += <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n ; ++ i)</span><br><span class="line">        <span class="keyword">if</span> (!buc[i]) <span class="keyword">goto</span> fuck ;</span><br><span class="line">    ans = <span class="number">1</span> ; solve(<span class="number">0</span>, m - <span class="number">1</span>) ; <span class="comment">/* */</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    fuck : <span class="built_in">puts</span>(<span class="string">"0"</span>) ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><blockquote><p>ç»™å®šä¸€ä¸ªå®Œå…¨å›¾ã€‚æ±‚è¯¥å›¾çš„ã€Œæœ€å° xq ç”Ÿæˆæ ‘ã€çš„ xqã€‚</p><p>å®šä¹‰ä¸€æ£µæ ‘çš„ xqä¸º</p><script type="math/tex; mode=display">\sum_i\sum_j {\rm dist}(i,j)</script><p>å…¶ä¸­å…·æœ‰æœ€å°çš„ xq çš„é‚£æ£µæ ‘è¢«ç§°ä¸ºã€Œæœ€å° xq ç”Ÿæˆæ ‘ã€ã€‚</p><p>$1\leq n\leq 15$ ã€‚</p></blockquote><p>æ¯”è¾ƒæœ‰è¶£çš„ dp å§â€¦</p><p>è‡ªå·±ä¸€å¼€å§‹å†™äº†ä¸ªç‰¹åˆ«å¼±æ™ºçš„é”™è§£ã€‚å¤§æ¦‚æ˜¯å¯¹ç€æ¯ä¸ªç‚¹é›†è·‘ä¸€é Floydï¼Œç„¶åè®¾ $f_s$ è¡¨ç¤ºé›†åˆ $s$ ä¸­æœ€å° xq ç”Ÿæˆæ ‘çš„ xq å€¼ã€‚è½¬ç§»çš„æ—¶å€™æšä¸¾ä¸€ä¸ªç‚¹è¿›è¡Œè½¬ç§»ã€‚è¿™æ ·æ˜¾è€Œæ˜“è§åœ°å°±å¿½è§†äº†æ ‘çš„é™åˆ¶ã€‚äºæ˜¯è€ƒè™‘å¦‚ä½• dp å‡ºä¸€æ£µåˆç†çš„æ ‘ã€‚</p><p>å…·ä½“çš„ï¼Œè®¾ $f_{s,i}$ è¡¨ç¤ºä»¥ $i$ ä¸ºæ ¹ï¼Œæ ‘ä¸­çš„å…ƒç´ æ˜¯é›†åˆ $s$ çš„æœ€å° xq ç”Ÿæˆæ ‘çš„ xq å€¼ã€‚è€ƒè™‘æ€ä¹ˆè½¬ç§»ã€‚è½¬ç§»çš„æœ¬è´¨æ˜¯æšä¸¾ä¸€ä¸ªå­é—®é¢˜ï¼Œé‚£ä¹ˆå¦‚æœé’¦å®šäº†æ ¹æ˜¯è°ï¼Œå°±å¯ä»¥ç›´æ¥æšä¸¾æ€ä¹ˆä»æ ¹æ‹†å‡ºä¸€ä¸ªå­æ ‘æ¥ã€‚æ›´ä¸ºå…·ä½“çš„ï¼Œæœ‰è½¬ç§»</p><script type="math/tex; mode=display">f_{s,i}=\min_{t\subseteq s,j\in t}\{f_{t,j}+f_{s\setminus t,i}+val(i,j)\times {\rm card}(t)\times {\rm card}\left(\complement_Ut\right)\}</script><p>ä¹Ÿå°±æ˜¯è€ƒè™‘åˆ å»çš„ä¸æ ¹ $i$ ç›¸è¿çš„æŸæ¡è¾¹ $(i,j)$ å¯¹æ€»ç­”æ¡ˆçš„è´¡çŒ®ã€‚é‚£ä¹ˆå°±å¯ä»¥æœ‰ä¸€ä¸ª $O(3^n\times n^2)$ çš„åšæ³•ï¼Œå¯ä»¥é€šè¿‡ $n\le 13$ ã€‚</p><p>ä¹‹åè€ƒè™‘åé¢é‚£éƒ¨åˆ†å¥½åƒå¾ˆå¤šä½™ï¼Œå› ä¸ºåé¢é‚£éƒ¨åˆ†å°±æœ¬è´¨ä¸Šè·Ÿ $s\setminus t$ æ— å…³äº†ã€‚å…·ä½“çš„ï¼Œå¯¹äºæ¯ä¸ªé›†åˆ $s$ ï¼Œå¯ä»¥åˆ©ç”¨ $f_s$ é¢å¤– dp å‡ºä¸€ä¸ª $g_{s,i}(i\notin s)$ æ»¡è¶³å®šä¹‰å¦‚ä¸‹</p><script type="math/tex; mode=display">g_{s,i}=\min_{j\in s}\{f_{s,j}+val(i,j)\times {\rm card}(s)\times {\rm card}\left(\complement_Us\right)\}</script><p>äºæ˜¯è½¬ç§»å°±å¯ä»¥åªæ‹¿ $g$ è½¬ç§»äº†ã€‚å¤æ‚åº¦ $O(3^n\times n+2^n\times n^2)$ å¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">15</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">100000</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"></span><br><span class="line">ll sz[M] ;</span><br><span class="line">ll unsz[M] ;</span><br><span class="line">ll A[N][N] ;</span><br><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line">ll g[M][N] ;</span><br><span class="line">ll f[M][N] ;</span><br><span class="line"><span class="comment">//ll s[M][N] ;</span></span><br><span class="line"><span class="comment">//ll g[M][N][N] ;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">biout</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (x) <span class="built_in">cout</span> &lt;&lt; (x &amp; <span class="number">1</span>), x &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    m = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span> ;</span><br><span class="line">    <span class="built_in">memset</span>(g, <span class="number">63</span>, <span class="keyword">sizeof</span>(g)) ;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">63</span>, <span class="keyword">sizeof</span>(f)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i)</span><br><span class="line">        f[<span class="number">1</span> &lt;&lt; i][i] = g[<span class="number">1</span> &lt;&lt; i][i] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span> ; j &lt; n ; ++ j)</span><br><span class="line">            A[i][j] = A[j][i] = qr() ; unsz[<span class="number">0</span>] = n ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        sz[i] = sz[i ^ (i &amp; (-i))] + <span class="number">1</span>, unsz[i] = n - sz[i] ;</span><br><span class="line"><span class="comment">//    debug(sz, 1, m) ; debug(unsz, 1, m) ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">1</span> ; s &lt;= m ; ++ s)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t = s ; t ; t = (t - <span class="number">1</span>) &amp; s)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i)</span><br><span class="line">                <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; i &amp; t)</span><br><span class="line">                    chkmin(f[s][i], f[t][i] + g[s ^ t][i]) ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i)&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; i &amp; s) <span class="keyword">continue</span> ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; n ; ++ j)</span><br><span class="line">                <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; j &amp; s)</span><br><span class="line">                    chkmin(g[s][i], f[s][j] + A[i][j] * sz[s] * unsz[s]) ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = f[m][<span class="number">0</span>] ;</span><br><span class="line"><span class="comment">//    debug(f[m], 0, n) ;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i) chkmin(ans, f[m][i]) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯ $65$ åˆ†ï¼Œæ³¨é‡Šèµ·æ¥çš„æ˜¯ç¿»è½¦ç°åœºã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">15</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">100000</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m ;</span><br><span class="line"><span class="keyword">int</span> sz[M] ;</span><br><span class="line"><span class="keyword">int</span> A[N][N] ;</span><br><span class="line"></span><br><span class="line">ll ans ;</span><br><span class="line">ll f[M][N] ;</span><br><span class="line"><span class="comment">//ll s[M][N] ;</span></span><br><span class="line"><span class="comment">//ll g[M][N][N] ;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">biout</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (x) <span class="built_in">cout</span> &lt;&lt; (x &amp; <span class="number">1</span>), x &gt;&gt;= <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n ;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">63</span>, <span class="keyword">sizeof</span>(f)) ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i)</span><br><span class="line">        f[<span class="number">1</span> &lt;&lt; i][i] = <span class="number">0</span> ; m = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span> ; j &lt; n ; ++ j)</span><br><span class="line">            A[i][j] = A[j][i] = qr() ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= m ; ++ i)</span><br><span class="line">        sz[i] = sz[i ^ (i &amp; (-i))] + <span class="number">1</span> ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">1</span> ; s &lt;= m ; ++ s)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t = s ; t ; t = (t - <span class="number">1</span>) &amp; s)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; ++ i)</span><br><span class="line">                <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; i &amp; t)</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; n ; ++ j)</span><br><span class="line">                        <span class="keyword">if</span> (<span class="number">1</span> &lt;&lt; j &amp; (s ^ t))</span><br><span class="line">                            chkmin(f[s][i], f[t][i] + f[s ^ t][j] + <span class="number">1l</span>l * A[i][j] * sz[s ^ t] * (n - sz[s ^ t])) ;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    for (int o = 0 ; o &lt;= m ; ++ o)&#123;</span></span><br><span class="line"><span class="comment">        int stk[20], cnt = 0 ;</span></span><br><span class="line"><span class="comment">        for (int i = 0 ; i &lt; n ; ++ i)</span></span><br><span class="line"><span class="comment">            if (1 &lt;&lt; i &amp; o)&#123;</span></span><br><span class="line"><span class="comment">                stk[++ cnt] = i ;</span></span><br><span class="line"><span class="comment">                for (int j = 0 ; j &lt; n ; ++ j)</span></span><br><span class="line"><span class="comment">                    if (1 &lt;&lt; j &amp; o)</span></span><br><span class="line"><span class="comment">                        g[o][i][j] = g[o][j][i] = A[i][j] ;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        for (int k = 1 ; k &lt;= cnt ; ++ k)</span></span><br><span class="line"><span class="comment">            for (int i = 1 ; i &lt;= cnt ; ++ i)</span></span><br><span class="line"><span class="comment">                for (int j = 1 ; j &lt;= cnt ; ++ j)</span></span><br><span class="line"><span class="comment">                    if ((i ^ j) &amp;&amp; (j ^ k) &amp;&amp; (i ^ k))</span></span><br><span class="line"><span class="comment">                        chkmin(g[o][stk[i]][stk[j]], g[o][stk[i]][stk[k]] + g[o][stk[k]][stk[j]]) ;</span></span><br><span class="line"><span class="comment">        for (int i = 0 ; i &lt; n ; ++ i)</span></span><br><span class="line"><span class="comment">            if (1 &lt;&lt; i &amp; o)</span></span><br><span class="line"><span class="comment">                for (int j = 0 ; j &lt; n ; ++ j)</span></span><br><span class="line"><span class="comment">                    if (1 &lt;&lt; j &amp; o)</span></span><br><span class="line"><span class="comment">                        s[o][i] += g[o][i][j] ;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    for (int i = 1 ; i &lt;= m ; ++ i)</span></span><br><span class="line"><span class="comment">        for (int j = 0 ; j &lt; n ; ++ j)&#123;</span></span><br><span class="line"><span class="comment">            if (!(1 &lt;&lt; j &amp; i)) continue ;</span></span><br><span class="line"><span class="comment">            chkmin(f[i], f[i ^ (1 &lt;&lt; j)] + s[i][j]) ;</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    for (int i = 1 ; i &lt;= m ; ++ i)</span></span><br><span class="line"><span class="comment">        cout &lt;&lt; i &lt;&lt; " ", biout(i), cout &lt;&lt; " " &lt;&lt; f[i] &lt;&lt; '\n' ;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    ans = f[m][<span class="number">0</span>] ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt; n ; ++ i) chkmin(ans, f[m][i]) ;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">'\n'</span> ; <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å› ä¸ºå¥‡æ€ªçš„é—®é¢˜ï¼Œå¯¼è‡´å…¶å®æ˜¨å¤©ç¬¬ä¸‰åœºçš„ T3 å†™çš„å¤æ‚åº¦å¹¶ä¸å¯¹ã€‚äºæ˜¯ä»Šå¤©å°±èŠ±äº†å¾ˆå¤šæ—¶é—´ç ”ç©¶äº†ä¸€ä¸‹æ­£ç¡®çš„åšæ³•ï¼Œå¯¼è‡´åªæ‰“äº†ä¸€åœºâ€¦ï¼ˆå¹¶ä¸”åšå®Œæ²¡ç¡å¥½å¯¼è‡´ä¸Šåˆæ•ˆç‡æä½ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡æœ‰ä¸€è¯´ä¸€ï¼Œé¢˜ç›®è¿˜æ˜¯å¾ˆèµçš„ï¼æ„Ÿè§‰å­¦åˆ°äº†å¾ˆå¤šã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="é¢˜è§£" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ZROI" scheme="https://www.orchidany.cn/categories/%E9%A2%98%E8%A7%A3/ZROI/"/>
    
    
      <category term="æ€ç»´é¢˜/æ‰¾æ€§è´¨" scheme="https://www.orchidany.cn/tags/%E6%80%9D%E7%BB%B4%E9%A2%98-%E6%89%BE%E6%80%A7%E8%B4%A8/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/æœ‰æŠ€å·§çš„DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E6%9C%89%E6%8A%80%E5%B7%A7%E7%9A%84DP/"/>
    
      <category term="åŠ¨æ€è§„åˆ’/çŠ¶å‹DP" scheme="https://www.orchidany.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E7%8A%B6%E5%8E%8BDP/"/>
    
      <category term="æŠ€å·§/åˆ†æ²»" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E5%88%86%E6%B2%BB/"/>
    
      <category term="æŠ€å·§/æŒ‰ä½è€ƒè™‘" scheme="https://www.orchidany.cn/tags/%E6%8A%80%E5%B7%A7-%E6%8C%89%E4%BD%8D%E8%80%83%E8%99%91/"/>
    
      <category term="å­—ç¬¦ä¸²/å­åºåˆ—è‡ªåŠ¨æœº" scheme="https://www.orchidany.cn/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2-%E5%AD%90%E5%BA%8F%E5%88%97%E8%87%AA%E5%8A%A8%E6%9C%BA/"/>
    
  </entry>
  
</feed>
